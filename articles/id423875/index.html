<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍄 🐹 👨🏿‍🔧 Penyimpanan sejumlah besar file 😜 📐 👩🏾‍⚖️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kesehatan yang bagus, Penjaja! Dalam proses pengerjaan proyek situs kencan, menjadi perlu untuk mengatur penyimpanan foto pengguna. Menurut kerangka a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Penyimpanan sejumlah besar file</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423875/"><img src="https://habrastorage.org/webt/ti/up/px/tiuppxliueu75a1ycliw537yw-k.jpeg" alt="gambar"><br><br>  Kesehatan yang bagus, Penjaja!  Dalam proses pengerjaan proyek situs kencan, menjadi perlu untuk mengatur penyimpanan foto pengguna.  Menurut kerangka acuan, jumlah foto per pengguna dibatasi hingga 10 file.  Tetapi mungkin ada puluhan ribu pengguna.  Terutama mengingat bahwa proyek dalam bentuk saat ini sudah ada sejak awal "nol".  Artinya, sudah ada ribuan pengguna dalam database.  Hampir semua sistem file, sejauh yang saya tahu, bereaksi sangat negatif terhadap sejumlah besar simpul anak dalam folder.  Dari pengalaman, saya dapat mengatakan bahwa masalah dimulai setelah 1000-1500 file / folder di folder induk. <br><a name="habracut"></a><br>  <i>Penafian.</i>  <i>Saya mencari di Google sebelum menulis artikel dan menemukan beberapa solusi untuk masalah yang sedang dibahas (misalnya, di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> atau di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> ).</i>  <i>Tetapi saya tidak menemukan solusi tunggal yang sama persis dengan solusi saya.</i>  <i>Selain itu, dalam artikel ini saya hanya membagikan pengalaman saya sendiri dalam menyelesaikan masalah.</i> <br><br><h3>  Teori </h3><br>  Selain tugas penyimpanan seperti itu, ada juga kondisi dalam pernyataan kerja, yang menurutnya perlu meninggalkan keterangan dan keterangan untuk foto.  Tentu saja, Anda tidak dapat melakukannya tanpa basis data.  Artinya, hal pertama yang kita lakukan adalah membuat tabel di mana kita meresepkan pemetaan meta-data (tanda tangan, judul, dll.) Dengan file pada disk.  Setiap file sesuai dengan satu baris dalam database.  Dengan demikian, setiap file memiliki pengenal. <br><br>  Penyimpangan kecil.  Mari kita bicara tentang peningkatan otomatis.  Situs kencan mungkin memiliki selusin atau dua ribu pengguna.  Pertanyaannya adalah berapa banyak pengguna pada umumnya pergi melalui proyek selama seluruh keberadaannya.  Misalnya, khalayak aktif kencan-ru adalah beberapa ratus ribu.  Namun, bayangkan saja berapa banyak pengguna yang tersisa selama masa proyek ini;  berapa banyak pengguna yang belum diaktifkan sejauh ini.  Sekarang tambahkan ke undang-undang kami, yang mewajibkan kami untuk menyimpan informasi tentang pengguna selama setidaknya enam bulan ... Cepat atau lambat, 4 dengan satu sen dari <b>INT TANDA</b> akan berakhir.  Oleh karena itu, yang terbaik adalah mengambil <b>BIGINT</b> untuk kunci utama. <br><br>  Sekarang mari kita coba membayangkan sejumlah jenis <b>BIGINT</b> .  Ini adalah 8 byte.  Setiap byte dari 0 hingga 255. 255 node anak cukup normal untuk sistem file apa pun.  Artinya, kami mengambil pengidentifikasi file dalam representasi heksadesimal, kami memecahnya menjadi potongan dua karakter.  Kami menggunakan potongan ini sebagai nama folder, yang terakhir sebagai nama file fisik.  KEUNTUNGAN! <br><br> <code>0f/65/84/10/67/68/19/ff.file</code> <br> <br>  Elegan dan sederhana.  Ekstensi file tidak penting di sini.  Bagaimanapun, file tersebut akan diberikan oleh skrip yang akan memberikan browser tipe MIME tertentu, yang juga akan kami simpan dalam database.  Selain itu, menyimpan informasi tentang file di dalam basis data memungkinkan Anda untuk mendefinisikan kembali jalur ke sana untuk browser.  Katakanlah, file yang kita miliki sebenarnya terletak relatif terhadap direktori proyek di sepanjang path <code>/content/files/0f/65/84/10/67/68/19/ff.file</code> .  Dan dalam database Anda dapat menulis URL untuk itu, misalnya, <code>/content/users/678/files/somefile</code> .  SEO mungkin cukup tersenyum sekarang.  Semua ini memungkinkan kita untuk tidak khawatir lagi tentang di mana menempatkan file secara fisik. <br><br><h3>  Tabel dalam database </h3><br>  Selain pengenal, tipe MIME, URL, dan lokasi fisik, kami akan menyimpan file md5 dan sha1 dalam tabel untuk memfilter file yang sama jika perlu.  Tentu saja, kita juga perlu menyimpan hubungan entitas dalam tabel ini.  Misalkan ID pengguna tempat file tersebut berada.  Dan jika proyeknya tidak terlalu besar, maka dalam sistem yang sama kita dapat menyimpan, katakanlah, foto barang.  Oleh karena itu, kami juga akan menyimpan nama kelas entitas tempat catatan itu berada. <br><br>  Berbicara tentang burung.  Jika Anda menutup folder menggunakan .htaccess untuk akses eksternal, file hanya dapat diperoleh melalui skrip.  Dan dalam skrip akan dimungkinkan untuk menentukan akses ke file.  Ke depan sedikit, saya akan mengatakan bahwa dalam CMS saya (di mana proyek tersebut digergaji sekarang) akses ditentukan oleh grup pengguna dasar, yang saya punya 8 - tamu, pengguna, manajer, admin, tidak aktif, diblokir, dihapus dan admin super.  Super-admin dapat melakukan segalanya, sehingga tidak berpartisipasi dalam menentukan akses.  Jika pengguna memiliki bendera admin super, maka ia adalah admin super.  Semuanya sederhana.  Artinya, kami akan menentukan akses ke tujuh grup yang tersisa.  Akses sederhana - baik memberikan file atau tidak memberi.  Secara total, Anda dapat mengambil bidang tipe <b>TINYINT</b> . <br><br>  Dan satu hal lagi.  Menurut hukum kami, kami harus secara fisik menyimpan gambar khusus.  Artinya, kita perlu menandai gambar entah bagaimana terhapus, daripada menghapus secara fisik.  Akan lebih mudah untuk menggunakan bidang bit untuk keperluan ini.  Dalam kasus seperti itu, saya biasanya menggunakan bidang bertipe <b>INT</b> .  Untuk cadangan, untuk berbicara.  Selain itu, saya sudah memiliki tradisi menempatkan bendera <b>DIHAPUS</b> di bit ke-5 dari akhir.  Tapi itu tidak masalah lagi. <br><br>  Apa yang kita miliki sebagai hasilnya: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-string"><span class="hljs-string">`files`</span></span> ( <span class="hljs-string"><span class="hljs-string">`id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">bigint</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> auto_increment, <span class="hljs-comment"><span class="hljs-comment">--   `entity_type` char(32) not null default '', --   `entity` bigint null, -- ID  `mime` char(32) not null default '', -- MIME- `md5` char(32) not null default '', -- MD5 `sha1` char(40) not null default '', -- SHA1 `file` char(64) not null default '', --   `url` varchar(250) not null default '', -- URL `meta` text null, -- -   JSON    `size` bigint not null default '0', --  `created` datetime not null, --   `updated` datetime null, --   `access` tinyint not null default '0', --   `flags` int not null default '0', --  primary key (`id`), index (`entity_type`), index (`entity`), index (`mime`), index (`md5`), index (`sha1`), index (`url`) ) engine = InnoDB;</span></span></code> </pre> <br><h3>  Kelas operator </h3><br>  Sekarang kita perlu membuat kelas untuk mengunggah file.  Kelas harus menyediakan kemampuan untuk membuat file, mengganti / memodifikasi file, menghapus file.  Selain itu, ada baiknya mempertimbangkan dua poin.  Pertama, proyek dapat ditransfer dari server ke server.  Jadi di kelas Anda perlu mendefinisikan properti yang berisi direktori root file.  Kedua, akan sangat tidak menyenangkan jika seseorang membuat tabel dalam database.  Jadi, Anda perlu menyediakan kemungkinan pemulihan data.  Dengan yang pertama, semuanya umumnya jelas.  Adapun cadangan data, kami hanya akan memesan apa yang tidak dapat dipulihkan. <br><br>  <b>ID</b> - dipulihkan dari lokasi fisik file <br>  <b>entitas_type</b> - tidak dipulihkan <br>  <b>entitas</b> - tidak dipulihkan <br>  <b>mime</b> - dipulihkan menggunakan ekstensi finfo <br>  <b>md5</b> - dipulihkan dari file itu sendiri <br>  <b>sha1</b> - dipulihkan dari file itu sendiri <br>  <b>file</b> - dipulihkan dari lokasi fisik file <br>  <b>url</b> - tidak dikembalikan <br>  <b>meta</b> - tidak dikembalikan <br>  <b>ukuran</b> - dikembalikan dari file itu sendiri <br>  <b>dibuat</b> - Anda dapat mengambil informasi dari file <br>  <b>diperbarui</b> - Anda dapat mengambil informasi dari file <br>  <b>akses</b> - tidak dipulihkan <br>  <b>bendera</b> - tidak dipulihkan <br><br>  Anda dapat segera membuang informasi meta.  Itu tidak penting untuk fungsi sistem.  Dan untuk pemulihan yang lebih cepat, Anda masih perlu menyimpan tipe MIME.  Total: jenis entitas, ID entitas, MIME, URL, akses, dan bendera.  Untuk meningkatkan keandalan sistem, kami akan menyimpan informasi cadangan untuk setiap folder tujuan secara terpisah di folder itu sendiri. <br><br><div class="spoiler">  <b class="spoiler_title">Kode kelas</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BigFiles</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FLAG_DELETED = <span class="hljs-number"><span class="hljs-number">0x08000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    "" /** @var mysqli $_db */ protected $_db = null; protected $_webRoot = ''; protected $_realRoot = ''; function __construct(mysqli $db = null) { $this-&gt;_db = $db; } /** * /   URL- * @param string $v  * @return string */ public function webRoot($v = null) { if (!is_null($v)) { $this-&gt;_webRoot = $v; } return $this-&gt;_webRoot; } /** * /    * @param string $v  * @return string */ public function realRoot($v = null) { if (!is_null($v)) { $this-&gt;_realRoot = $v; } return $this-&gt;_realRoot; } /** *   * @param array $data   * @param string $url URL   * @param string $eType   * @param int $eID ID  * @param mixed $meta - * @param int $access  * @param int $flags  * @param int $fileID ID   * @return bool * @throws Exception */ public function upload(array $data, $url, $eType = '', $eID = null, $meta = null, $access = 127, $flags = 0, $fileID = 0) { $meta = is_array($meta) ? serialize($meta) : $meta; if (empty($data['tmp_name']) || empty($data['name'])) { $fid = intval($fileID); if (empty($fid)) { return false; } $meta = empty($meta) ? 'null' : "'" . $this-&gt;_db-&gt;real_escape_string($meta) . "'"; $q = "`meta`={$meta},`updated`=now()"; $this-&gt;_db-&gt;query("UPDATE `files` SET {$q} WHERE (`id` = {$fid}) AND (`entity_type` = '{$eType}')"); return $fid; } // File data $meta = empty($meta) ? 'null' : "'" . $this-&gt;_db-&gt;real_escape_string($meta) . "'"; $finfo = finfo_open(FILEINFO_MIME_TYPE); $mime = finfo_file($finfo , $data['tmp_name']); finfo_close($finfo); // FID, file name if (empty($fileID)) { $eID = empty($eID) ? 'null' : intval($eID); $q = &lt;&lt;&lt;sql insert into `files` set `mime` = '{$mime}', `entity` = {$eID}, `entityType` = '{$eType}', `created` = now(), `access` = {$access}, `flags` = {$flags} sql; $this-&gt;_db-&gt;query($q); $fid = $this-&gt;_db-&gt;insert_id; list($ffs, $fhn) = self::fid($fid); $url = $this-&gt;_webRoot . $url . '/' . $fid; $fdir = $this-&gt;_realRoot . $ffs; self::validateDir($fdir); $index = self::getIndex($fdir); $index[$fhn] = array($fhn, $mime, $url, ($eID == 'null' ? 0 : $eID), $access, $flags); self::setIndex($fdir, $index); $fname = $ffs . '/' . $fhn . '.file'; } else { $fid = intval($fileID); $fname = $this-&gt;fileName($fid); } // Move file $fdir = $this-&gt;_realRoot . $fname; if (!move_uploaded_file($data['tmp_name'], $fdir)) { throw new Exception('Upload error'); } $q = '`md5`=\'' . md5_file($fdir) . '\',`sha1`=\'' . sha1_file($fdir) . '\',' . '`size`=' . filesize($fdir) . ',`meta`=' . $meta . ',' . (empty($fileID) ? "`url`='{$url}',`file`='{$fname}'" : '`updated`=now()'); $this-&gt;_db-&gt;query("UPDATE `files` SET {$q} WHERE (`id` = {$fid}) AND (`entity_type` = '{$eType}')"); return $fid; } /** *   * @param string $url URL * @param string $basicGroup    * @throws Exception */ public function read($url, $basicGroup = 'anonimous') { if (!ctype_alnum(str_replace(array('/', '.', '-', '_'), '', $url))) { header('HTTP/1.1 400 Bad Request'); exit; } $url = $this-&gt;_db-&gt;real_escape_string($url); $q = "SELECT * FROM `files` WHERE `url` = '{$url}' ORDER BY `created` ASC"; if ($result = $this-&gt;_db-&gt;query($q)) { $vars = array(); $ints = array('id', 'entity', 'size', 'access', 'flags'); while ($row = $result-&gt;fetch_assoc()) { foreach ($ints as $i) { $row[$i] = intval($row[$i]); } $fid = $row['id']; $vars[$fid] = $row; } if (empty($vars)) { header('HTTP/1.1 404 Not Found'); exit; } $deleted = false; $access = true; $found = ''; $mime = ''; foreach ($vars as $fdata) { $flags = intval($fdata['flags']); $deleted = ($flags &amp; self::FLAG_DELETED) != 0; $access = self::granted($basicGroup, $fdata['access']); if (!$access || $deleted) { continue; } $found = $fdata['file']; $mime = $fdata['mime']; } if (empty($found)) { if ($deleted) { header('HTTP/1.1 410 Gone'); exit; } elseif (!$access) { header('HTTP/1.1 403 Forbidden'); exit; } } else { header('Content-type: ' . $mime . '; charset=utf-8'); readfile($this-&gt;_realRoot . $found); exit; } } header('HTTP/1.1 404 Not Found'); exit; } /** *   ()   * @param mixed $fid () * @return bool * @throws Exception */ public function delete($fid) { $fid = is_array($fid) ? implode(',', $fid) : $fid; $q = "delete from `table` where `id` in ({$fid})"; $this-&gt;_db-&gt;query($q); $result = true; foreach ($fid as $fid_i) { list($ffs, $fhn) = self::fid($fid_i); $fdir = $this-&gt;_realRoot . $ffs; $index = self::getIndex($fdir); unset($index[$fhn]); self::setIndex($fdir, $index); $result &amp;= unlink($fdir . '/'. $fhn . '.file'); } return $result; } /** *  ()  "" * @param int $fid () * @param bool $value   * @return bool */ public function setDeleted($fid, $value=true) { $fid = is_array($fid) ? implode(',', $fid) : $fid; $o = $value ? ' | ' . self::FLAG_DELETED : ' &amp; ' . (~self::FLAG_DELETED); $this-&gt;_db-&gt;query("update `files` set `flags` = `flags` {$o} where `id` in ({$fid})"); return true; } /** *   * @param int $fid  * @return string * @throws Exception */ public function fileName($fid) { list($ffs, $fhn) = self::fid($fid); self::validateDir($this-&gt;_realRoot . $ffs); return $ffs . '/' . $fhn . '.file'; } /** *   . *           . * @param int $fid   * @return array */ public static function fid($fid) { $ffs = str_split(str_pad(dechex($fid), 16, '0', STR_PAD_LEFT), 2); $fhn = array_pop($ffs); $ffs = implode('/', $ffs); return array($ffs, $fhn); } /** *    * @param string $f     * @return bool * @throws Exception */ public static function validateDir($f) { if (!is_dir($f)) { if (!mkdir($f, 0700, true)) { throw new Exception('cannot make dir: ' . $f); } } return true; } /** *    * @param string $f       * @return array */ public static function getIndex($f) { $index = array(); if (file_exists($f . '/.index')) { $_ = file($f . '/.index'); foreach ($_ as $_i) { $row = trim($_i); $row = explode('|', $row); array_walk($row, 'trim'); $rid = $row[0]; $index[$rid] = $row; } } return $index; } /** *    * @param string $f       * @param array $index    * @return bool */ public static function setIndex($f, array $index) { $_ = array(); foreach ($index as $row) { $_[] = implode('|', $row); } return file_put_contents($f . '/.index', implode("\r\n", $_)); } /** *   * @param string $group   (. ) * @param int $value   * @return bool */ public static function granted($group, $value=0) { $groups = array('anonimous', 'user', 'manager', 'admin', 'inactive', 'blocked', 'deleted'); if ($group == 'root') { return true; } foreach ($groups as $groupID =&gt; $groupName) { if ($groupName == $group) { return (((1 &lt;&lt; $groupID) &amp; $value) != 0); } } return false; } }</span></span></code> </pre> <br></div></div><br>  Pertimbangkan beberapa hal: <br><br>  - <b>realRoot</b> - path lengkap ke folder dengan sistem file berakhir dengan garis miring. <br>  - <b>webRoot</b> - lintasan dari root situs tanpa garis miring (lihat alasannya di bawah). <br>  - Sebagai DBMS, saya menggunakan ekstensi <b>MySQLi</b> . <br>  - Faktanya, informasi dari array <b>$ _FILES</b> diteruskan sebagai argumen pertama ke metode <b>unggah</b> . <br>  - Jika Anda memanggil metode <b>pembaruan</b> untuk meneruskan ID dari file yang ada, itu akan diganti jika array input di <b>tmp_name</b> tidak kosong. <br>  - Anda dapat menghapus dan mengubah flag beberapa file sekaligus.  Untuk melakukan ini, alih-alih meneruskan pengidentifikasi file, Anda harus meneruskan array dengan pengidentifikasi, atau string dengan mereka, dipisahkan dengan koma. <br><br><h3>  Routing </h3><br>  Sebenarnya, ia turun ke beberapa baris di htaccess di root situs (diasumsikan bahwa mod_rewrite diaktifkan): <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span></span></span> <span class="hljs-variable"><span class="hljs-variable">%{REQUEST_URI}</span></span> ^/content/(.*)$ RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{REQUEST_FILENAME}</span></span> !-f RewriteRule ^(.+)$ content/index.php?file=<span class="hljs-number"><span class="hljs-number">$1</span></span><span class="hljs-meta"><span class="hljs-meta"> [L,QSA]</span></span></code> </pre> <br>  "Konten" adalah folder di root situs dalam kasus saya.  Tentu saja Anda dapat memberi nama folder secara berbeda.  Dan tentu saja index.php sendiri, disimpan dalam case saya di folder konten: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $dbHost = <span class="hljs-string"><span class="hljs-string">'127.0.0.1'</span></span>; $dbUser = <span class="hljs-string"><span class="hljs-string">'user'</span></span>; $dbPass = <span class="hljs-string"><span class="hljs-string">'****'</span></span>; $dbName = <span class="hljs-string"><span class="hljs-string">'database'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($_REQUEST[<span class="hljs-string"><span class="hljs-string">'file'</span></span>])) { header(<span class="hljs-string"><span class="hljs-string">'HTTP/1.1 400 Bad Request'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>; } $userG = <span class="hljs-string"><span class="hljs-string">'anonimous'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      ;      $files = new BigFiles(new mysqli($dbHost,$dbUser,$dbPass,$dbName)); $files-&gt;realRoot(dirname(__FILE__).'/files/'); $files-&gt;read($_REQUEST['file'],$userG); } catch (Exception $e) { header('HTTP/1.1 500 Internal Error'); header('Content-Type: text/plain; charset=utf-8'); echo $e-&gt;getMessage(); exit; }</span></span></code> </pre><br>  Nah, dengan sendirinya, kita menutup sistem file itu sendiri dari akses eksternal.  Letakkan file <code>.htaccess</code> di root folder <code>content/files</code> dengan hanya satu baris: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Deny</span></span></span></span> from <span class="hljs-literal"><span class="hljs-literal">all</span></span></code> </pre> <br><h3>  Ringkasan </h3><br>  Solusi ini memungkinkan Anda untuk menghindari hilangnya kinerja sistem file karena peningkatan jumlah file.  Setidaknya masalah dalam bentuk ribuan file dalam satu folder pasti bisa dihindari.  Dan pada saat yang sama, kita dapat mengatur dan mengontrol akses ke file di alamat yang dapat dibaca manusia.  Ditambah kepatuhan dengan undang-undang suram kami.  Segera melakukan reservasi, solusi ini BUKAN cara lengkap untuk melindungi konten.  Ingat: jika sesuatu diputar di browser, itu dapat diunduh secara gratis. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id423875/">https://habr.com/ru/post/id423875/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id423865/index.html">Roskomnadzor dilaporkan secara publik</a></li>
<li><a href="../id423867/index.html">Pendiri studio pencetakan 3D - tentang pekerjaannya</a></li>
<li><a href="../id423869/index.html">Masa depan pekerjaan. Hal utama dari laporan World Economic Forum</a></li>
<li><a href="../id423871/index.html">Kami memecahkan masalah logis untuk siswa dalam SQL</a></li>
<li><a href="../id423873/index.html">Gambaran Umum PICASO 3D Designer X 3D Printer</a></li>
<li><a href="../id423877/index.html">29-31 Oktober: membuat kluster Kubernet yang siap produksi</a></li>
<li><a href="../id423879/index.html">Apakah mudah untuk menambahkan fitur baru ke kerangka lama? Pilihan tepung pada contoh pengembangan SObjectizer</a></li>
<li><a href="../id423881/index.html">Apa tukang las untuk optik (bagian dua)</a></li>
<li><a href="../id423885/index.html">Undangan untuk pertunjukan cahaya dan orang dalam kecil dari platform Circle of Light di Moskow</a></li>
<li><a href="../id423889/index.html">Kekecewaan saya pada perangkat lunak</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>