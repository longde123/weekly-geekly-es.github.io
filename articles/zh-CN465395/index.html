<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ¸ ğŸ‘¸ğŸ» ğŸ‘¨ğŸ¿â€ğŸŒ¾ ä¾èµ–æ³¨å…¥å’ŒæœåŠ¡å®šä½å™¨ä¹‹é—´çš„ä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ ğŸ’…ğŸ½ ğŸ‘¸ğŸ¾ ğŸ§œğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆï¼ŒDIä¸‹çš„æœåŠ¡å®šä½å™¨æ˜¯å¤šä¹ˆä¼˜ç¾çš„ä¼ªè£…ã€‚ ç”šè‡³çœ‹èµ·æ¥åƒDIï¼ :-) 

 è¿™æ˜¯æˆ‘ä»¥å‰çš„å‡ºç‰ˆç‰©Dependency Injectionï¼ŒJavaScriptå’ŒES6 Modulesçš„ç¬¬ä¸€ä¸ªè¯„è®ºã€‚ æ„Ÿè°¢åŒäº‹symbix'uçš„è¯„è®ºtkã€‚ æ­£æ˜¯ä»–æˆä¸ºäº†æ²‰æµ¸åœ¨å½¼æ­¤ä¹‹é—´å·®å¼‚å¾®å¦™ä¹‹å¤„çš„åŸå› ã€‚ åœ¨æ ‡é¢˜ä¸‹ï¼Œæˆ‘åˆ å‡äº†...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä¾èµ–æ³¨å…¥å’ŒæœåŠ¡å®šä½å™¨ä¹‹é—´çš„ä¸»è¦åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/465395/"><blockquote> å“ˆï¼ŒDIä¸‹çš„æœåŠ¡å®šä½å™¨æ˜¯å¤šä¹ˆä¼˜ç¾çš„ä¼ªè£…ã€‚ ç”šè‡³çœ‹èµ·æ¥åƒDIï¼  :-) </blockquote><p> è¿™æ˜¯æˆ‘ä»¥å‰çš„å‡ºç‰ˆç‰©<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Dependency Injectionï¼ŒJavaScriptå’ŒES6 Modules</a>çš„ç¬¬ä¸€ä¸ªè¯„è®ºã€‚ æ„Ÿè°¢åŒäº‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">symbix'u</a>çš„è¯„è®ºtkã€‚ æ­£æ˜¯ä»–æˆä¸ºäº†æ²‰æµ¸åœ¨å½¼æ­¤ä¹‹é—´å·®å¼‚å¾®å¦™ä¹‹å¤„çš„åŸå› ã€‚ åœ¨æ ‡é¢˜ä¸‹ï¼Œæˆ‘åˆ å‡äº†å¯¹é—®é¢˜çš„å›ç­”ã€‚ </p><br><p><img src="https://habrastorage.org/webt/v3/8k/ax/v38kaxu_rzz_k0hweljvwl5n6vi.jpeg" alt="å›¾ç‰‡"></p><br><p>  <em>ï¼ˆKDPVæ²¡æœ‰å¤šå¤§æ„ä¹‰ï¼Œä¸»è¦ç”¨äºè§†è§‰è¯†åˆ«è¯¥å‡ºç‰ˆç‰©ç­‰ï¼‰</em> </p><a name="habracut"></a><br><p> é¦–å…ˆï¼Œæˆ‘ä»¬å°†å¤„ç†è¿™äº›å®šä¹‰ï¼ˆ <em>æˆ‘å°†åœ¨PHPä¸­æä¾›ä¸€äº›ä»£ç ç¤ºä¾‹ï¼Œåœ¨JSä¸­æä¾›ä¸€äº›ä»£ç ç¤ºä¾‹ï¼Œå› ä¸ºè¿™ä¸¤ç§è¯­è¨€ç›®å‰éƒ½åœ¨æˆ‘çš„ä¹¦åŒ…ä¸­ï¼Œè€Œå…¶ä»–ä¸€äº›åˆ™æ˜¯å› ä¸ºæˆ‘ä»äº’è”ç½‘ä¸Šçªƒå–äº†è¿™äº›ç¤ºä¾‹</em> ï¼‰ã€‚ </p><br><h1 id="dependency-injection"> ä¾èµ–æ³¨å…¥ </h1><br><blockquote>ç®€è€Œè¨€ä¹‹ï¼ŒDI-è€Œä¸æ˜¯require / importæ¨¡å—ï¼Œè€Œæ˜¯é€šè¿‡æ„é€ å‡½æ•°å‚æ•°ï¼ˆæˆ–å±æ€§è®¾ç½®å™¨ï¼‰æ³¨å…¥ä¾èµ–é¡¹ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªå¤§è¯çš„èƒŒåæ˜¯ç®€å•çš„â€œé€šè¿‡æ„é€ å‡½æ•°å‚æ•°ä¼ é€’ç±»ä¾èµ–å…³ç³»â€ã€‚ </blockquote><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">Risedphantomçš„</a>åŒäº‹çš„è¿™ä¸€è¯„è®ºç›¸å½“å‡†ç¡®åœ°ä¼ è¾¾äº†è¿™ä¸€ç°è±¡çš„å®è´¨ã€‚ ä¸ºäº†ä¿ƒè¿›å¼€å‘äººå‘˜å¯¹ä»£ç çš„ç†è§£ï¼Œæ‰€æœ‰ä¾èµ–é¡¹éƒ½ä»¥æ„é€ å‡½æ•°å‚æ•°çš„å½¢å¼ï¼ˆé€šå¸¸ä½†å¹¶éæ€»æ˜¯å¦‚æ­¤ï¼‰è¿›è¡Œäº†æ˜ç¡®æè¿°ï¼š </p><br><pre><code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainClass</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($dep1, $dep2, $dep3)</span></span></span><span class="hljs-function"> </span></span>{} }</code> </pre> <br><p> ä»…æ­¤è€Œå·²ã€‚  DI-ä»–å°±æ˜¯è¿™æ ·ã€‚ æˆ‘ä»¬éœ€è¦çš„ä¾èµ–å…³ç³»ç”±é‚£é‡Œçš„æŸä¸ªäººæä¾›ã€‚ è¿™ä¸ªâ€œæœ‰äººåœ¨é‚£é‡Œâ€å°†ä»–ä»¬å¸¦åˆ°å“ªé‡Œ-DIä¸åœ¨ä¹ã€‚ </p><br><p> åœ¨åˆ†æä»£ç æ—¶ï¼Œé‡è¦çš„æ˜¯è¦äº†è§£ä»€ä¹ˆçœŸæ­£æ˜¯å®ƒçš„â€œå†…éƒ¨â€ï¼ˆä»¥åŠæˆ‘ä»¬å¯ä»¥å®‰å…¨æ›´æ”¹çš„å†…å®¹ï¼‰ï¼Œä»¥åŠè¶…å‡º/è¶…å‡ºæ­¤ä»£ç èŒè´£èŒƒå›´çš„å†…å®¹ã€‚ è¿™å°±æ˜¯æ¿€å‘DIçš„åŸå› ã€‚ ä¸ºä»€ä¹ˆä¾èµ–æ€§ä¸»è¦é€šè¿‡æ„é€ å‡½æ•°ä¼ é€’ï¼Œè€Œä¸æ˜¯é€šè¿‡setterä¼ é€’ï¼Ÿ å› ä¸ºè¿™å¯¹å¼€å‘äººå‘˜æ¥è¯´æ›´åŠ æ–¹ä¾¿-ä»–ç«‹å³åœ¨ä¸€ä¸ªåœ°æ–¹çœ‹åˆ°äº†æ‰€åˆ†æä»£ç çš„æ‰€æœ‰ä¾èµ–å…³ç³»ã€‚ æˆ‘ä»¬ä¹ æƒ¯äºè®¤ä¸ºDIæ˜¯ç±»çº§åˆ«çš„ä¸œè¥¿ï¼Œä½†æ˜¯å‡½æ•°/æ–¹æ³•å‚æ•°ä¹Ÿæ˜¯DIï¼š </p><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">dep1, dep2, dep3</span></span></span><span class="hljs-function">) </span></span>{}</code> </pre> <br><p> æ„é€ å™¨å°±æ˜¯è¿™æ ·ä¸€ç§ç‰¹æ®Šçš„æ–¹æ³•ã€‚ </p><br><h1 id="service-locator"> æœåŠ¡å®šä½å™¨ </h1><br><p> æœåŠ¡å®šä½å™¨æ˜¯ä¸€ç§è‘—åçš„åæ¨¡å¼ã€‚ ä»–æ˜¯åšä»€ä¹ˆçš„ï¼Ÿ æä¾›å¯¹ä¸€ä¸ªå¯¹è±¡ä¸å…¶ä»–å¯¹è±¡çš„è®¿é—®ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™æ˜¯</a>æ­¤ç±»å®šä½å™¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„</a>å…¸å‹ç•Œé¢ï¼š </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ServiceLocator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addInstance</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $class, Service $service)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addClass</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $class, array $params)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">has</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $interface)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $class)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Service</span></span></span></span>; }</code> </pre> <br><p> å®šä½å™¨æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä¸­æ”¾ç½®ç°æˆçš„å¯¹è±¡ï¼ˆæˆ–è®¾ç½®å…¶åˆ›å»ºè§„åˆ™ï¼‰ï¼Œç„¶åè®¿é—®è¿™äº›å¯¹è±¡ã€‚ å¯¹äºå®šä½å™¨è€Œè¨€ï¼Œå¯¹è±¡åœ¨å…¶ä¸­çš„æ˜¾ç¤ºæ–¹å¼åŸºæœ¬ä¸Šæ²¡æœ‰å…³ç³»-å®ƒä»¬æ˜¯ä»å¤–éƒ¨æ˜¾å¼åˆ›å»ºçš„ï¼Œå¹¶æ”¾ç½®åœ¨å®¹å™¨ä¸­ï¼Œæˆ–è€…ç”±å®¹å™¨æœ¬èº«æ ¹æ®ç»™å®šçš„è§„åˆ™åˆ›å»ºçš„ã€‚ </p><br><p> æœåŠ¡å®šä½å™¨è´Ÿè´£å­˜å‚¨å¯¹è±¡å¹¶æä¾›å¯¹å®ƒä»¬çš„è®¿é—®ã€‚ ä»…æ­¤è€Œå·²ã€‚ </p><br><h1 id="dependency-injection-container"> ä¾èµ–æ³¨å…¥å®¹å™¨ </h1><br><p> ä»€ä¹ˆæ˜¯DIå®¹å™¨ï¼Ÿ æ ¹æ®å¯¹â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¾èµ–æ³¨å…¥åŸç†ï¼Œå®è·µå’Œæ¨¡å¼</a> â€å†…å®¹çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è‡ªç”±ä»‹ç»ï¼Œè¯¥</a> <em>è½¯ä»¶åº“æä¾›äº†DIåŠŸèƒ½å¹¶å…è®¸è‡ªåŠ¨æ‰§è¡Œå¯¹è±¡ç»„æˆï¼Œæ‹¦æˆªå’Œç”Ÿå‘½å‘¨æœŸç®¡ç†ä¸­æ¶‰åŠçš„è®¸å¤šä»»åŠ¡ã€‚DIå®¹å™¨ä¹Ÿç§°ä¸ºInversion ofæ§åˆ¶ï¼ˆIoCï¼‰å®¹å™¨ã€‚ï¼ˆç¬¬3.2.2èŠ‚ï¼‰â€œ</em> </p><br><p> ä¹Ÿå°±æ˜¯è¯´ï¼ŒDIå®¹å™¨ä¸»è¦è´Ÿè´£åˆ›å»ºå¯¹è±¡ï¼Œä½†ä»…åœ¨ç¬¬äºŒä¸ªå¯¹è±¡ä¸­è´Ÿè´£å¯¹è±¡çš„å­˜å‚¨ã€‚ å¦‚æœåº”ç”¨ç¨‹åºæœ¬èº«ä¸éœ€è¦æ•´ä¸ªåº”ç”¨ç¨‹åºé€šç”¨çš„å¯¹è±¡ï¼ˆä¾‹å¦‚é…ç½®æˆ–è®°å½•å™¨ï¼‰ï¼Œé‚£ä¹ˆDIå®¹å™¨ç”šè‡³å¯èƒ½æ ¹æœ¬ä¸å­˜å‚¨ä»»ä½•åˆ›å»ºçš„å¯¹è±¡ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œè¿™é‡Œæ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Symfony</a> DIå®¹å™¨æ¥å£ï¼š </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContainerInterface</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PsrContainerInterface</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $id, ?object $service)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id, int $invalidBehavior = self::EXCEPTION_ON_INVALID_REFERENCE)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">has</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($id)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialized</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $id)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getParameter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $name)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasParameter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $name)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setParameter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(string $name, $value)</span></span></span></span>; }</code> </pre> <br><p> å¦‚æœ‰å¿…è¦ï¼Œæ‚¨å¯ä»¥è½»æ¾åœ°è¯´æœè‡ªå·±ï¼ŒDIå®¹å™¨çš„ç•Œé¢ä¸Locator Servicesçš„ç•Œé¢éå¸¸ç›¸ä¼¼-ç›¸åŒçš„<code>get</code> ï¼Œ <code>has</code>å’Œ<code>set</code> / <code>add</code> ã€‚ </p><br><h1 id="chem-zhe-ploh-service-locator"> ä¸ºä»€ä¹ˆæœåŠ¡å®šä½å™¨ä¸å¥½ï¼Ÿ </h1><br><p> ä½†æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚ æ¨¡æ¿æœ¬èº«ä¸æ˜¯å¾ˆç³Ÿç³•ï¼Œä½†æ˜¯æœ‰æ—¶ä¼šè¢«ä½¿ç”¨ã€‚ ç‰¹åˆ«æ˜¯ï¼Œæœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸€ç§è§‚ç‚¹</a>è®¤ä¸ºï¼šâ€œ <em>æœåŠ¡å®šä½å™¨è¿åäº†é™æ€ç±»å‹è¯­è¨€ä¸­çš„å°è£…ï¼Œå› ä¸ºæ­¤æ¨¡å¼ä¸èƒ½æ˜ç¡®è¡¨è¾¾å…ˆå†³æ¡ä»¶</em> ã€‚â€ è¿˜æœ‰ä¸€ä¸ªç¤ºä¾‹è¿è§„ï¼š </p><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> OrderProcessor : IOrderProcessor { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> void Process(Order order) { var validator = Locator.Resolve&lt;IOrderValidator&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (validator.Validate(order)) { var shipper = Locator.Resolve&lt;IOrderShipper&gt;(); shipper.Ship(order); } } }</code> </pre> <br><p> å°±åƒï¼Œé‚£å¤ªç³Ÿç³•äº†ï¼Œä½†æ˜¯ä¸é”™-åƒè¿™æ ·ï¼š </p><br><pre> <code class="vbscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> OrderProcessor : IOrderProcessor { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> OrderProcessor(IOrderValidator validator, IOrderShipper shipper) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> void Process(Order order) }</code> </pre> <br><p> å˜¿ï¼Œæˆ‘ä»¬åªæ˜¯<code>IOrderValidator</code>äº†ä½¿ç”¨<code>IOrderValidator</code>å’Œ<code>IOrderShipper</code>åˆ›å»ºå¯¹è±¡æœ¬èº«çš„<code>IOrderValidator</code> ï¼ åœ¨æ­¤åº”ç”¨ç¨‹åºçš„å…¶ä»–åœ°æ–¹å¯èƒ½æœ‰ç±»ä¼¼ä»¥ä¸‹ä»£ç çš„å†…å®¹ï¼š </p><br><pre> <code class="vbscript hljs">var validator = Locator.Resolve&lt;IOrderValidator&gt;(); var shipper = Locator.Resolve&lt;IOrderShipper&gt;(); var processor = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrderProcessor(validator, shipper); processor.Process(order);</code> </pre> <br><h1 id="composition-root"> æˆåˆ†æ ¹ </h1><br><p> è¯´åˆ°ä¾èµ–æ³¨å…¥ï¼Œæˆ‘ä»¬ä¸ç¦è¦æå‡ºä¸€ä¸ªæ¦‚å¿µï¼Œä¾‹å¦‚â€œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆæˆæ ¹â€</a> ï¼ˆåœ¨ä¸‹æ–‡ä¸­ï¼Œæˆ‘å°†å…¶ç§°ä¸ºâ€œé›†åˆç‚¹â€ï¼‰ã€‚ è¿™æ˜¯ä¸åˆ›å»ºä¾èµ–å…³ç³»åŠå…¶å®ç°çš„èŒè´£å§”æ´¾ç»™çš„åŒä¸€<em>ä¸ªäºº</em> ã€‚ </p><br><p> åœ¨ç»„è£…ç‚¹ï¼Œæ‰€æœ‰ä¾èµ–é¡¹éƒ½è¢«æ˜ç¡®å®šä¹‰ï¼Œç›¸åº”çš„å¯¹è±¡åœ¨ç­‰å¾…çš„åœ°æ–¹åˆ›å»ºå’Œå®ç°ã€‚ åœ¨è¿™é‡Œï¼ŒæœåŠ¡å®šä½å™¨å’ŒDIå®¹å™¨ä¹‹é—´çš„å·®å¼‚å¾ˆå°ã€‚ ä¸¤è€…éƒ½å…è®¸åˆ›å»ºæ–°å¯¹è±¡ï¼Œå­˜å‚¨åˆ›å»ºçš„å¯¹è±¡ï¼Œæå–å­˜å‚¨çš„å¯¹è±¡ã€‚ æˆ‘ä»€è‡³æ‰¿è¯ºè¦æ–­è¨€ï¼Œåœ¨è¿™ä¸ªåœ°æ–¹ï¼Œå®ƒä»¬ä¹‹é—´æ²¡æœ‰æ ¹æœ¬çš„åŒºåˆ«ã€‚ </p><br><h1 id="glavnoe-otlichie"> ä¸»è¦åŒºåˆ« </h1><br><p>  DIå®¹å™¨å’ŒServices Locatorçš„å®¹å™¨ä¹‹é—´æœ€æ˜æ˜¾çš„åŒºåˆ«åœ¨å“ªé‡Œï¼Ÿ åœ¨å…¶ä»–ä»»ä½•åœ°æ–¹ï¼Œå°¤å…¶æ˜¯åœ¨é™æ€è®¿é—®å®¹å™¨çš„æƒ…å†µä¸‹ï¼š </p><br><pre> <code class="php hljs">$obj = Container::getInstance()-&gt;get($objId);</code> </pre> <br><p> æ¥äº† ä»¥è¿™ç§å½¢å¼ï¼Œåœ¨ä»»ä½•åœ°æ–¹ï¼ˆé™¤éå®ƒæ˜¯ä¸€ä¸ªAssembly Pointï¼Œä½†æ˜¯åœ¨é‚£é‡Œä½¿ç”¨é™æ€è®¿é—®éƒ½æ˜¯éå¸¸å¯ç–‘çš„ï¼‰ï¼Œä»»ä½•å®¹å™¨éƒ½å°†æˆä¸ºç§°ä¸ºService Locatorçš„åæ¨¡å¼ã€‚ </p><br><p> ä¸€ä½<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">VolCh</a>åŒäº‹ç®€çŸ­è€Œç®€æ´åœ°å›ç­”äº†æˆ‘çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é—®é¢˜</a> ï¼š </p><br><blockquote> æ‚¨è®¤ä¸ºçœŸæ­£çš„DIä¸ä¼ªè£…æˆDIçš„æœåŠ¡å®šä½å™¨æœ‰ä½•ä¸åŒï¼Ÿ </blockquote><p> åƒè¿™æ ·ï¼š </p><br><blockquote> é›†è£…ç®±å‡ºå…¥ </blockquote><p> å®é™…ä¸Šï¼Œæ•´ä¸ªå‡ºç‰ˆç‰©åªæ˜¯ä»–çš„å›ç­”åœ¨è¿™é‡Œçš„æ›´è¯¦ç»†çš„éƒ¨ç½²ã€‚ </p><br><h1 id="legalnoe-primenenie-konteynera"> åˆæ³•ä½¿ç”¨å®¹å™¨ </h1><br><p> å› æ­¤ï¼Œå®¹å™¨æ˜¯DIå®¹å™¨è¿˜æ˜¯æœåŠ¡å®šä½å™¨çš„å®¹å™¨åœ¨å¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºæˆ‘ä»¬åœ¨ä½•å¤„ä»¥åŠå¦‚ä½•ä½¿ç”¨å®ƒã€‚ æ­£å¦‚æˆ‘åœ¨ä¸Šé¢æ‰€è¿°ï¼Œåœ¨ç»„è£…ç‚¹ï¼Œå®¹å™¨ç±»å‹ä¹‹é—´çš„å·®å¼‚æ¶ˆå¤±äº†ã€‚ ä½†æ˜¯ï¼Œå¦‚æœå®¹å™¨æœ¬èº«æ˜¯ä»»ä½•ç±»çš„ä¾èµ–é¡¹ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆåŠï¼Ÿ </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Container $container)</span></span></span></span>{} }</code> </pre> <br><p> åŒæ ·ï¼Œè¿™å®Œå…¨å–å†³äºæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®¹å™¨ã€‚ è¿™æ˜¯ä¸¤ä¸ªç¤ºä¾‹ï¼Œå…¶ä¸­ä¸€ä¸ªä¸æœåŠ¡å®šä½å™¨çš„å®¹å™¨å®Œå…¨åŒ¹é…å¹¶ä¸”æ˜¯åæ¨¡å¼ï¼Œè€Œå¦ä¸€ä¸ªåœ¨æŸäº›æ¡ä»¶ä¸‹æ‹¥æœ‰ç”Ÿå‘½æƒã€‚ </p><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $dep; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Container $container)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;dep = $container-&gt;get(<span class="hljs-string"><span class="hljs-string">'depId'</span></span>); } }</code> </pre> <br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Foo</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $container; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Container $container)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;container = $container; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initModules</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($modules)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> ($modules <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $initClassId) { $init= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;container-&gt;get($initClassId); $init-&gt;exec(); } } }</code> </pre> <br><h1 id="rezyume"> æ€»ç»“ </h1><br><p> å®é™…ä¸Šï¼Œæ‰€æœ‰äº‹æƒ…éƒ½æœ‰äº›å¤æ‚ï¼ŒDIå®¹å™¨åº”è¯¥æ¯”Services Locatorå…·æœ‰æ›´å¤šçš„åŠŸèƒ½ï¼Œä½†æ˜¯æ­¤å‡ºç‰ˆç‰©çš„æœ¬è´¨æ˜¯å³ä½¿æœ€å¤æ‚çš„DIå®¹å™¨ä¹Ÿå¯ä»¥è½»æ¾ç”¨ä½œServices Locatorï¼Œè€Œè¦ä½¿ç”¨Services Locatorä½œä¸ºDIå®¹å™¨-æ‚¨éœ€è¦å°è¯•ã€‚ </p><br><p> èšè‹¯ä¹™çƒ¯ <br> æˆ‘ä¸ç¦æä¾›Sergei Teplyakovçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¼–ç¨‹</a>åšå®¢çš„é“¾æ¥- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¿™äº›é—®é¢˜</a>åœ¨è¿™é‡Œå¾ˆå¥½åœ°ä»‹ç»äº†ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN465395/">https://habr.com/ru/post/zh-CN465395/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN465375/index.html">åœ¨è·å…°å’Œè«æ–¯ç§‘é”€å”®ä¸“ç”¨æœåŠ¡å™¨</a></li>
<li><a href="../zh-CN465377/index.html">è‡ªå·±åšSkype</a></li>
<li><a href="../zh-CN465379/index.html">è‡ªåˆ¶æ— çº¿ç‹¬ç«‹å¼èƒ°å²›ç´ æ³µæ§åˆ¶</a></li>
<li><a href="../zh-CN465391/index.html">åœ¨ä¿„ç½—æ–¯æ–¯å¡æ‹‰è¿åŠ¨çš„è„šæ­¥ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN465393/index.html">MySensorsè®¾å¤‡çš„ç”µæ± ç”µæº</a></li>
<li><a href="../zh-CN465397/index.html">Nitroè½¬æ¢å™¨çš„å¤–è§‚å¦‚ä½•ï¼Œå¯å¸®åŠ©å¼€å‘äººå‘˜è¿›è¡Œæœ¬åœ°åŒ–å’ŒæŠ€æœ¯æ”¯æŒ</a></li>
<li><a href="../zh-CN465399/index.html">éƒ¨ç½²CEPHåˆ†å¸ƒå¼å­˜å‚¨å¹¶å°†å…¶è¿æ¥åˆ°Kubernetes</a></li>
<li><a href="../zh-CN465401/index.html">åœ¨ä»»ä½•ITå›¢é˜Ÿä¸­åŠ é€Ÿè§£å†³é—®é¢˜çš„5é¡¹æ´»åŠ¨</a></li>
<li><a href="../zh-CN465403/index.html">å•Šï¼ å…¬è·¯ä¸Šçš„æ–°ç›¸æœºæˆ–æœ‰å…³é›·è¾¾å’Œé›·è¾¾æ¢æµ‹å™¨çš„æœ€æ–°ä¿¡æ¯</a></li>
<li><a href="../zh-CN465407/index.html">1.æé™ä¼ä¸šå±‚äº¤æ¢æœºæ¦‚è¿°</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>