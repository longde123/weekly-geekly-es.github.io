<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖖🏾 🌘 👩🏻‍🍳 Wir schaffen einen einfachen, kompakten und billigen Internetradiosender 📴 🤞🏼 ↩️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Linux wird die Softwareplattform sein. Der Einfachheit halber ist es besser, etwas Gemeinsames mit vielen Informationen im Internet zu verwenden, wenn...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir schaffen einen einfachen, kompakten und billigen Internetradiosender</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426349/"> Linux wird die Softwareplattform sein. Der Einfachheit halber ist es besser, etwas Gemeinsames mit vielen Informationen im Internet zu verwenden, wenn etwas schief geht.  Eisen für einen Internetradiosender kann alles sein, ein vollwertiger Server mit Ihren Projekten, ein alter Laptop oder ein Netbook, wir wollen billig, und wir brauchen keine besondere Leistung von Eisen. <br><br>  Wenn Sie nichts zur Hand haben oder wir einen völlig leisen Server benötigen, versuchen Sie es mit einem Mini-Computer. <br><br>  So etwas wie der Raspberry Pi 3? <br><br>  Nein, wir wollen billiger, also brauchen wir so etwas wie Orange Pi.  Ich habe ein Orange Pi Pc Plus-Modell mit 1 GB DDR3-RAM und 8 GB EMMC-Flash gefunden. <br><br><img src="https://habrastorage.org/webt/ew/ry/mf/ewrymf0vj-86hqfa2v8e7rrmjks.png"><a name="habracut"></a><br><br>  UPD: Gestern haben alle den Artikel irgendwie zu ernst genommen, aber tatsächlich wurde das Experiment zum Wohle des Fans durchgeführt, um zu sehen, ob es funktioniert oder nicht.  Natürlich ist von einer „industriellen“ Nutzung keine Rede, es ist wie der Versuch, das Stadion mit einem gewöhnlichen Musikzentrum zu erklingen. <br><br>  Was können wir noch brauchen? <br><br>  Ich möchte versuchen, alles auf einfache Weise zu konfigurieren. Daher benötige ich weiterhin ein Twisted-Pair-Kabel zum Router und eine Micro-SD-Speicherkarte, da ich das Betriebssystem nicht direkt auf dem Mikrocomputer installieren kann.  Ich habe eine Speicherkarte für 8 Gigabyte gefunden, diese Menge ist völlig ausreichend. <br><br>  Zunächst müssen Sie also das Image des Betriebssystems auf die Speicherkarte schreiben. <br>  Für Server bevorzuge ich das bewährte Debian (ja, die jüngere Generation bevorzugt höchstwahrscheinlich CentOS, aber der Graubärtige wird mir zustimmen, dass Debian immer noch sehr gut ist). <br><br>  Im Allgemeinen gibt es viele fertige Bilder für Orange Pi unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">www.orangepi.org/downloadresources</a> , aber ich gehe immer noch zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">www.armbian.com/download</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lade</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die</a> Torrent-Datei von armbian von dl.armbian.com/orangepipcplus (in meinem) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">herunter</a> Fall von Debian_stretch_next.7z). <br><br>  Ich habe Orange Pi Pc Plus, Sie können jeden anderen Mini-Computer haben, suchen Sie also nach dem passenden Bild. <br><br>  Entpacken Sie nach dem Herunterladen das Archiv und sehen Sie das Bild im IMG-Format.  Wer will, womit er das Bild füllt, bevorzuge ich persönlich Etcher (https://etcher.io).  Wir haben eine Speicherkarte eingelegt, sie ausgewählt, wenn Sie mehrere Medien angeschlossen haben, auf die Schaltfläche Nähen klicken und das Kennwort eingeben, wenn Sie auch Linux auf Ihrem Desktop oder Laptop haben. <br><br><img src="https://habrastorage.org/webt/lq/3w/3y/lq3w3yteie6cz8jage7vau5zssw.png"><br><br>  Die Karte mit dem Bild ist fertig, Sie können alles verbinden. <br>  Was brauchen wir, um unseren Server zu starten und einzurichten? <br>  Der Mini-Computer selbst, Internet über Ethernet-Kabel und Stromversorgung. <br>  Und alle. <br><br>  Nein, natürlich können Sie verwirrt sein, den Monitor und die Tastatur anschließen und alles direkt konfigurieren, aber die Tastatur meines Laptops gefällt mir besser, daher werde ich meinen Mini-Computer über SSH remote konfigurieren. <br><br>  Beginnen wir also mit dem Ethernet-Kabel, einer Micro-SD-Karte mit einem Armbian-Image. <br>  Es bleibt nur die Stromversorgung des Minicomputers. <br><br>  Aber mit der Leistung des Orange Pi ist alles sehr traurig.  Was ist auf einem normalen Mini-Computer?  Das stimmt, Micro-USB, aber wie kann ich den Orange Pi mit Strom versorgen?  Nur 5V über einen Pin-Stecker, der separat erhältlich ist. <br><br>  Ein Netzteil mit einem geeigneten Stecker kostet mehr als nur ein Kabel mit Standard-USB am Ende, sodass Sie es nehmen können. <br><br>  Wenn es keine freie Stromversorgung mit USB gibt (und wir brauchen sowieso nicht, aber für 2 Ampere), stöbern wir in unserer Box mit Drähten, Adaptern und Platinen für Computer (Sie haben eine solche Box, oder?) Und finden einen geeigneten Adapter von Einige alte, lange von einem Kindertablett zerbrochene, löten das Kabel und die Stromversorgung für unseren Server ist bereit. <br><br>  Oder nehmen Sie einfach das Ladegerät vom alten MP3-Player der iRiver-Festplatte (es ist nur 4,7 Volt und 1,2 Ampere, aber es funktioniert auch). <br><br>  Wir servieren Essen und sind bereit, tatsächlich zu dem zu wechseln, für den alles konzipiert wurde, zur Schaffung eines Internetradiosenders. <br><br>  Wenn Sie wie ich mit einem Minimum an Peripheriegeräten auskommen möchten, müssen wir herausfinden, welche IP-Adresse unser Mini-Computer erhalten hat.  Der einfachste Weg, dies herauszufinden, besteht darin, zu Ihrem Router zu gehen und zu sehen, welche IP-Adresse der Router unserem Server gegeben hat (Ihr Router kann DHCP ausführen, oder?). <br><br>  Jetzt können Sie sich über SSH bei unserem Server anmelden.  Wer den SSH-Client verwendet, muss ihn verwenden (Sie haben nie Windows, aber ich weiß nicht, was SSH-Clients tun). <br>  In meinem Fall hämmere ich einfach die Konsole ssh root@192.168.0.88 ein. Ich bin damit einverstanden, den ECDSA-Schlüssel hinzuzufügen. Das Standardkennwort für root ist "1234". Nach dem Anmelden befinden wir uns in der Konsole des Mikrocomputers, die sofort vorschlägt, das Root-Kennwort zu ändern. <br><br><img src="https://habrastorage.org/webt/gu/nz/c0/gunzc0ewl71jcxyhwrvoeegqpvc.png"><br><br>  Danach wird vorgeschlagen, ein nicht privilegiertes Benutzerkonto zu erstellen, wir erstellen es. <br>  Im Vergleich zu früheren Versionen des Betriebssystems ist die aktuelle Version in Bezug auf die Einstellungen etwas vereinfacht und viele Dinge werden bereits automatisch konfiguriert. <br><br>  Armbian hat ein sehr praktisches Konfigurationstool: <code>armbian-config</code> kopiert den Befehl auf die Konsole und sieht, was nützlich sein kann. <br><br><img src="https://habrastorage.org/webt/ow/nr/yi/ownryigiv-au8gowgrfhvcetduk.png"><br><br>  Wir benötigen die Systemeinstellungen noch nicht, sie können jedoch später benötigt werden, um beispielsweise das konfigurierte System von Micro SD auf den integrierten 8-GB-EMMC-Flash-Speicher eines Minicomputers zu übertragen. <br><br>  Der Abschnitt Netzwerk wird für uns nützlich sein, aber es wäre schön, eine statische IP-Adresse für den Server zu haben.  Unser Internetradiosender kann sogar über WLAN mit dem Netzwerk verbunden werden.  Jeder legt das Maß an Perversität für sich selbst fest. Wenn Sie jedoch das Internetradio nur für sich selbst erstellen und nicht mehr als 10 Hörer gleichzeitig planen, können Sie unseren Server dann über WLAN nutzen.  In extremen Fällen können Sie jederzeit ein Ethernet-Kabel anschließen. <br><br>  Also haben wir uns für die Art der Verbindung entschieden, jetzt müssen wir eine statische IP-Adresse konfigurieren. Dazu gehen wir zu den IP-Einstellungen und wählen die gewünschte Netzwerkschnittstelle aus. Danach sagen wir, dass wir eine statische Adresse wollen, starten sie und speichern die Einstellungen.  Maske und Gateway müssen nicht geändert werden, da sie von Ihrem Router über DHCP empfangen werden. <br><br><img src="https://habrastorage.org/webt/b0/gp/qv/b0gpqvib6trft_pkir827aj8d3m.png"><br><br>  Nachdem Sie eine neue IP-Adresse eingegeben und die Eingabetaste gedrückt haben, wird Ihre SSH-Sitzung sofort eingefroren, da das Gerät sofort eine neue IP-Adresse hat.  Deshalb schließen wir einfach das Fenster mit dem Terminal und gehen über SSH mit der neuen IP-Adresse zu unserem Mini-Computer. <br><br>  Übrigens, da alle Funktionen, die wir haben, administrativer Natur sind, um nicht ständig vor jedem sudo-Befehl zu schreiben, melde ich mich einfach als root beim Mini-Computer an. <br><br>  <code>armbian-config</code> wir durch <code>armbian-config</code> Ausführen von <code>armbian-config</code> sehen, was noch konfiguriert werden kann?  Im Bereich Persönlich können wir die Zeitzone, das Gebietsschema und den Hostnamen konfigurieren.  Ich habe das Gebietsschema ru_RU.UTF-8 UTF-8 hinzugefügt, das sich als nützlich erweisen wird. <br><br>  Damit die Einstellungen angewendet werden können, müssen Sie das Konfigurationsdienstprogramm beenden, sich abmelden und erneut anmelden oder den Server mit dem Befehl reboot neu starten. <br><br>  Ich habe den Befehl reboot verwendet, um sicherzustellen, dass die Einstellungen gespeichert wurden und der Server erfolgreich mit ihnen gestartet wurde. <br><br>  Die grundlegende Serverkonfiguration wurde vorgenommen und warum nicht das Betriebssystem mit MicroSD OS auf dem internen EMMC-Flash-Speicher installieren?  Natürlich, wenn Ihr Mini-Computer diesen Speicher an Bord hat. <br><br>  Gehen Sie dazu zu <code>armbian-config</code> - System - Install, wählen Sie das verfügbare Laufwerk aus, drücken Sie die Eingabetaste, holen Sie sich Grüße aus der Vergangenheit, stimmen Sie zu und wählen Sie den ext4-Dateisystemtyp aus. <br><br><img src="https://habrastorage.org/webt/yt/g4/ut/ytg4utinyttwtqoftarwnu-btv8.png"><br><br>  Jetzt können wir uns zurücklehnen und warten, bis das Betriebssystem auf den internen Speicher des Mini-Computers übertragen wird. <br><br><img src="https://habrastorage.org/webt/es/rz/0x/esrz0x4sqck7jn3sggbx6bba_yi.png"><br><br>  Schalten Sie nach Abschluss des Kopiervorgangs die Stromversorgung aus.  Wir warten einige Sekunden, bis die LED am Mini-Computer erlischt, ziehen Sie den Strom heraus, entfernen Sie die microSD-Karte, schließen Sie den Strom wieder an und schalten Sie den Computer ein. <br><br>  Ja, wenn Sie keinen internen Speicher haben und das Betriebssystem nicht darauf übertragen haben, ist das Herausziehen einer MicroSD höchstwahrscheinlich keine gute Idee. <br><br>  Nachdem Sie sich über SSH bei unserem Mini-Computer angemeldet und sichergestellt haben, dass alles funktioniert, können Sie den Radiosender selbst einstellen. <br><br>  Zunächst aktualisieren wir die Paketinformationen, indem wir <code>apt update</code> in die Serverkonsole einbinden. <br><br>  Ja, ich liebe Komfort, also installiere ich mc mit dem Befehl <code>apt install mc</code> . <br>  Ich mache gerne alles unter mc und wenn ich die Konsole sehen muss, drücke ich einfach Strg + o. <br><br>  Installieren Sie zuerst den Demon Music Player selbst: <code>apt install mpd</code> . <br>  Damit werden eine Reihe von Abhängigkeiten installiert. <br><br>  Fahren wir mit der Einrichtung fort.  Die Datei /etc/mpd.conf ist für die Konfiguration des Dämons verantwortlich. Öffnen Sie sie mit dem <code>nano /etc/mpd.conf</code> . <br><br>  Mein Benutzername hat keine hzs-Berechtigungen und meine Konfigurationsdatei sieht ungefähr so ​​aus: <br><br><pre> <code class="php hljs">music_directory <span class="hljs-string"><span class="hljs-string">"/home/hzs/music"</span></span> playlist_directory <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/playlists"</span></span> db_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/tag_cache"</span></span> log_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd.log"</span></span> pid_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/pid"</span></span> state_file <span class="hljs-string"><span class="hljs-string">"/home/hzs/.mpd/state"</span></span> sticker_file <span class="hljs-string"><span class="hljs-string">"/var/lib/mpd/sticker.sql"</span></span> user <span class="hljs-string"><span class="hljs-string">"hzs"</span></span> bind_to_address <span class="hljs-string"><span class="hljs-string">"localhost"</span></span> restore_paused <span class="hljs-string"><span class="hljs-string">"yes"</span></span> metadata_to_use <span class="hljs-string"><span class="hljs-string">"artist,title"</span></span> auto_update <span class="hljs-string"><span class="hljs-string">"yes"</span></span> audio_output { type <span class="hljs-string"><span class="hljs-string">"httpd"</span></span> name <span class="hljs-string"><span class="hljs-string">"My New Internet Radio Station!!!"</span></span> encoder <span class="hljs-string"><span class="hljs-string">"lame"</span></span> <span class="hljs-comment"><span class="hljs-comment"># optional, vorbis or lame port "8000" bind_to_address "0.0.0.0" # optional, IPv4 or IPv6 bitrate "256" # do not define if quality is defined format "44100:16:2" } volume_normalization "yes" filesystem_charset "UTF-8" id3v1_encoding "UTF-8"</span></span></code> </pre> <br>  Hier ist alles klar und ohne besondere Kommentare. <br><br>  Um zu arbeiten, müssen Sie oben in den Einstellungen eine Verzeichnisstruktur erstellen.  Bitte beachten Sie, dass der Eigentümer dieser Verzeichnisse ein nicht privilegierter Benutzer sein sollte, von dem aus alles funktioniert, in meinem Fall hzs. <br><br>  Führen Sie von root aus die folgenden Befehle aus: <br><br> <code>chown -cR hzs:hzs /home/hzs/music</code> <br> <code>chown -cR hzs:hzs /home/hzs/.mpd</code> <br> <br>  Es ist Zeit, Musik hochzuladen. Wir haben SSH auf dem Server, damit wir unseren bevorzugten FTP-Client mit unserem Server verbinden können. <br><br>  Wir wissen, dass die IP-Adresse, Port 22, der Benutzername und das Kennwort diejenigen sind, die Sie beim Erstellen des nicht privilegierten Benutzers angegeben haben, die Art der SSH-Verbindung.  Gießen Sie Musik für den Test in das in der Konfiguration angegebene Musikverzeichnis. <br><br><img src="https://habrastorage.org/webt/hs/x6/wy/hsx6wyhf98bmwv5bvy5kkpdvogi.png"><br><br>  Jetzt wird der Player mit der falschen Konfiguration gestartet, sodass wir den Daemon stoppen und erneut starten: <br><br> <code>service mpd stop</code> <br> <code>service mpd start</code> <br> <br>  Zur einfachsten Steuerung des Daemons <code>apt install mpc</code> wir <code>apt install mpc</code> Dienstprogramm <code>apt install mpc</code> console mit dem Befehl <code>apt install mpc</code> . <br><br>  Nach der Installation werden wir den Player ein wenig konfigurieren: <br><br> <code>mpc random on</code> <br> <code>mpc repeat on</code> <br> <br>  Jetzt müssen Sie Titel und eine Wiedergabeliste hinzufügen, in der Konsole ist es etwas Gimmorro, aber nichts kann getan werden. <br><br>  Wir sehen uns die uns zur Verfügung stehenden Dateien an, die wir der Wiedergabeliste hinzufügen können: <br><br> <code>mpc ls</code> <br> <br>  Um eine Datei zur Wiedergabeliste <code>mpc add</code> , müssen wir im Befehl <code>mpc add</code> den vollständigen Namen der hinzuzufügenden Datei angeben. Die Auswahl nach Maske funktioniert nicht: <br><br> <code>mpc add "01 Lost in Your Eyes.mp3"</code> <br> <br>  Wir sehen uns die resultierende Wiedergabeliste an: <br><br> <code>mpc playlist</code> <br> <br>  Es ist Zeit, unseren Radiosender zu starten: <br><br> <code>mpc play</code> <br> <br><img src="https://habrastorage.org/webt/8p/gc/j5/8pgcj5ce-fqssnegu8svkdjqxwu.png"><br><br>  Versuchen wir zuzuhören, dafür öffnen wir den Audiostream unseres Radiosenders in einem beliebigen Audio-Player.  Geben Sie dazu die Adresse des Streams <code>http://ip:port</code> , ich habe sie <code>http://192.168.0.90:8000</code> . <br><br>  Audacious spielte zeitweise, es gab ein Problem mit dem Caching, aber SMPlayer und VLC hatten keine Probleme. <br><br><img src="https://habrastorage.org/webt/do/y_/e8/doy_e8rrunt7km5_eqddovxtp0c.png"><br><br><img src="https://habrastorage.org/webt/pl/dc/ec/pldcecft-jdoram8ixgsqbupi7o.png"><br><br><img src="https://habrastorage.org/webt/ff/j4/np/ffj4nptgv3ma90bakt63oyciqys.png"><br><br>  Im Prinzip funktioniert unser Internetradiosender zu diesem Zeitpunkt bereits. Sie müssen der Wiedergabeliste Musik hinzufügen und die Anschlüsse am Router weiterleiten, damit unser Internetradiosender zu einem Internetradiosender und nicht zu einem Radio im lokalen Netzwerk wird. <br><br>  Ich habe mehrere Domänen, daher erstelle ich in den DNS-Einstellungen zunächst einen A-Eintrag mit Testradio und der statischen externen IP-Adresse meines Routers zu Hause.  Sie müssen dies nicht tun. <br><br>  Als nächstes konfiguriere ich auf meinem Router die Portweiterleitung. <br><br>  Da ich bereits einen eigenen Radiosender auf einem großen Server habe, gebe ich den externen Quellport 9000 und den internen lokalen Port 8000 an, sodass das Radio von außerhalb über <code>http://_ip:9000</code> sendet. <br><br><img src="https://habrastorage.org/webt/z5/h5/vf/z5h5vf6bgcfm0k1t464-y9e1dlq.png"><br><br>  Jetzt haben wir einen "echten" Internetradiosender. <br><br>  Wenn Sie dort nicht anhalten möchten, gehen Sie weiter. <br><br>  Wir senden nicht die Stimme des DJs, aber bei Bedarf kann sie implementiert werden. Was jedoch wirklich benötigt wird, ist eine praktische Oberfläche zur Verwaltung von Wiedergabelisten. <br><br>  Es gibt Unmengen von Verwaltungskonsolen, einige können hier <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">angezeigt werden</a> , aber ich werde den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pitchfork MPD Client verwenden</a> . <br><br>  Dies ist eine vollwertige Web-Schnauze, und ja, wir werden eine Waffe auf die Spatzen schießen und mit unserem Radiosender einen vollwertigen http-Server auf einem Minicomputer anheben: <br><br> <code>apt install apache2</code> <br> <br>  Wir werden auch PHP brauchen: <br><br> <code>apt-get install php</code> <br> <br>  Noch brauchen <br><br> <code>apt install php7.0-xml</code> <br> <br>  und <br><br> <code>apt install php-pear</code> <br> <br>  Wir erstellen das Verzeichnis / home / hzs / wwwroot / pf im Home-Ordner und entpacken den zuvor geladenen MPH-Client auf der SSH Pitchfork. <br><br><img src="https://habrastorage.org/webt/vt/3j/wh/vt3jwhnfoip8vuciat5mtbjja44.png"><br><br>  In der Apache2-Webserver-Konfigurationsdatei /etc/apache2/sites-available/000-default.conf <br> <code>nano /etc/apache2/sites-available/000-default.conf</code> <br>  wir mähen alles und schreiben (vergessen Sie nicht, "hzs" in Ihren Benutzernamen zu ändern): <br><br><pre> <code class="php hljs">&lt;VirtualHost *:<span class="hljs-number"><span class="hljs-number">80</span></span>&gt; ServerName localhost ServerAdmin webmaster@localhost DocumentRoot /home/hzs/wwwroot &lt;Directory /home/hzs/wwwroot/&gt; Options All AllowOverride All DirectoryIndex index.php index.html index.htm Order Allow,Deny Allow from All <span class="hljs-keyword"><span class="hljs-keyword">Require</span></span> all granted &lt;/Directory&gt; &lt;/VirtualHost&gt;</code> </pre> <br>  Dann starten wir den http-Server neu <br><br> <code>service apache2 restart</code> <br> <br>  Gehen Sie zur Adresse Ihres IP / pf-Servers (in meinem Fall: <code>http://192.168.0.90/pf</code> ) <br><br>  Wir werden das Bedienfeld sehen: <br><br><img src="https://habrastorage.org/webt/wf/ch/a-/wfcha-qsfl5kbftdhelmpue4a0s.png"><br><br>  Alles ist ganz einfach und intuitiv. <br><br>  Klicken Sie anschließend auf das Ordnersymbol rechts und auf die Registerkarte Dateisystem. <br><br>  Um die Liste der Dateien zu aktualisieren, klicken Sie auf die Schaltfläche DB aktualisieren, wählen Sie die verbleibenden Dateien aus, die noch nicht in der Wiedergabeliste enthalten sind, und klicken Sie etwas tiefer auf die Schaltfläche Hinzufügen. <br><br>  Wir aktualisieren die Seite und sehen, dass alle Dateien, die wir zur Wiedergabeliste hinzugefügt haben: <br><br><img src="https://habrastorage.org/webt/d4/iz/vm/d4izvmjxin4-aapy4fxwvelnbxk.png"><br><br>  Wenn Sie das Player-Steuerelement mit einem Kennwort ausblenden müssen, können Sie die Konfigurationsdatei bearbeiten: <br><br> <code>nano /home/hzs/wwwroot/pf/config/config.xml</code> <br> <br>  Es gibt eine völlig verständliche Struktur der Einstellungen. <br><br>  Wir haben also einen vollwertigen Internetradioserver mit einer Größe von 10 * 7 * 3 Zentimetern.  Natürlich zieht der verwendete Server mit geringem Stromverbrauch nicht Hunderte von Hörern an, aber zumindest lässt er Sie nicht ohne Ihre Lieblingsmusik zurück, wo immer Sie sind, wenn Internet in der Nähe ist. <br><br>  Grundsätzlich können Sie nicht weiterlesen, aber für diejenigen, die besonders hartnäckig sind, fahren wir fort. <br>  Wir haben einen vollständigen Webserver, warum ... <br>  Nun, du verstehst schon. <br><br>  Erstellen Sie das Verzeichnis testradio im Stammverzeichnis unseres Webservers und erstellen Sie die Datei <code>"index.php"</code> darin: <br><br><pre> <code class="php hljs">&lt;!DOCTYPE html&gt; &lt;html xmlns=<span class="hljs-string"><span class="hljs-string">"https://www.w3.org/1999/xhtml"</span></span> xml:lang=<span class="hljs-string"><span class="hljs-string">"ru-ru"</span></span> lang=<span class="hljs-string"><span class="hljs-string">"ru-ru"</span></span> dir=<span class="hljs-string"><span class="hljs-string">"ltr"</span></span>&gt; &lt;head&gt; &lt;meta http-equiv=<span class="hljs-string"><span class="hljs-string">"content-type"</span></span> content=<span class="hljs-string"><span class="hljs-string">"text/html; charset=utf-8"</span></span> /&gt; &lt;title&gt;My Test Radio&lt;/title&gt; &lt;script src=<span class="hljs-string"><span class="hljs-string">"jquery-3.3.1.min.js"</span></span>&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;My Test Radio&lt;/h1&gt; &lt;div id=<span class="hljs-string"><span class="hljs-string">"song"</span></span>&gt; now playing:&lt;br&gt; &lt;div id=<span class="hljs-string"><span class="hljs-string">"title"</span></span>&gt;now playing&lt;/div&gt; &lt;br&gt; &lt;div&gt; &lt;span id=<span class="hljs-string"><span class="hljs-string">"play"</span></span> type=<span class="hljs-string"><span class="hljs-string">"button"</span></span>&gt;Play&lt;/span&gt; &lt;span id=<span class="hljs-string"><span class="hljs-string">"pause"</span></span> type=<span class="hljs-string"><span class="hljs-string">"button"</span></span>&gt;Pause&lt;/span&gt; &lt;/div&gt; &lt;br&gt; &lt;div&gt; vol:&lt;br&gt; &lt;input id=<span class="hljs-string"><span class="hljs-string">"volume"</span></span> type=<span class="hljs-string"><span class="hljs-string">"range"</span></span> min=<span class="hljs-string"><span class="hljs-string">"0"</span></span> max=<span class="hljs-string"><span class="hljs-string">"10"</span></span> value=<span class="hljs-string"><span class="hljs-string">"5"</span></span> /&gt; &lt;/div&gt; &lt;span id=<span class="hljs-string"><span class="hljs-string">"duration"</span></span>&gt;&lt;/span&gt; &lt;br&gt; &lt;div&gt;<span class="hljs-number"><span class="hljs-number">256</span></span> kbps&lt;/div&gt; &lt;/div&gt; &lt;script language=<span class="hljs-string"><span class="hljs-string">"JavaScript"</span></span>&gt; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> audio = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Audio(<span class="hljs-string"><span class="hljs-string">'http://testradio.nisel.ru:9000'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> play = document.getElementById(<span class="hljs-string"><span class="hljs-string">'play'</span></span>); play.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ audio.play(); }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pause = document.getElementById(<span class="hljs-string"><span class="hljs-string">'pause'</span></span>); pause.addEventListener(<span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ audio.pause(); }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> volume = document.getElementById(<span class="hljs-string"><span class="hljs-string">'volume'</span></span>); volume.addEventListener(<span class="hljs-string"><span class="hljs-string">'change'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ audio.volume = parseFloat(this.value / <span class="hljs-number"><span class="hljs-number">10</span></span>); }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); audio.addEventListener(<span class="hljs-string"><span class="hljs-string">"timeupdate"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> duration = document.getElementById(<span class="hljs-string"><span class="hljs-string">'duration'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> s = parseInt(audio.currentTime % <span class="hljs-number"><span class="hljs-number">60</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> m = parseInt((audio.currentTime / <span class="hljs-number"><span class="hljs-number">60</span></span>) % <span class="hljs-number"><span class="hljs-number">60</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> h = parseInt((audio.currentTime / <span class="hljs-number"><span class="hljs-number">3600</span></span>) % <span class="hljs-number"><span class="hljs-number">60</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (s &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) s = <span class="hljs-string"><span class="hljs-string">'0'</span></span> + s; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) m = <span class="hljs-string"><span class="hljs-string">'0'</span></span> + m; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (h &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) h = <span class="hljs-string"><span class="hljs-string">'0'</span></span> + h; duration.innerHTML = h + <span class="hljs-string"><span class="hljs-string">':'</span></span> + m + <span class="hljs-string"><span class="hljs-string">':'</span></span> + s; }, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); &lt;/script&gt; &lt;script language=<span class="hljs-string"><span class="hljs-string">"JavaScript"</span></span>&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">show</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $.ajax({ url: <span class="hljs-string"><span class="hljs-string">"trackname.php"</span></span>, cache: <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, success: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(html)</span></span></span></span>{ $(<span class="hljs-string"><span class="hljs-string">"#title"</span></span>).html(html); } }); } $(document).ready(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ show(); setInterval(<span class="hljs-string"><span class="hljs-string">'show()'</span></span>,<span class="hljs-number"><span class="hljs-number">5000</span></span>); }); &lt;/script&gt; &lt;/body&gt; &lt;/html&gt;</code> </pre> <br>  Dies ist das einfachste Beispiel für das Erstellen eines Players für eine Site. Außerdem kann der Name der aktuellen Komposition angezeigt werden, die alle 5 Sekunden mit Ajax aktualisiert wird. <br><br>  Das Aussehen kann mit CSS nach Geschmack beendet werden. <br><br>  Der Code zeigt an, dass der Audiostream bereits an die im DNS meiner Domain angegebene Adresse gesendet wird. <br>  Vergessen Sie nicht, die jquery-Datei in das Verzeichnis zu legen (in meinem Fall jquery-3.3.1.min.js).  Im Allgemeinen ist jquery hier natürlich zu viel und man könnte eine Ajax-Anfrage ohne sie stellen, aber es stellte sich als zu faul zum Nachdenken heraus und ich verwendete einen vorgefertigten Code. <br><br>  Als nächstes erstellen Sie die Datei <code>"trackname.php"</code> : <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> file_get_contents(<span class="hljs-string"><span class="hljs-string">'http://192.168.0.90/mpc'</span></span>);<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Ebenfalls im Stammverzeichnis des Webservers erstellen wir das Verzeichnis "mpc" und die Datei <code>"index.php"</code> darin: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> exec(<span class="hljs-string"><span class="hljs-string">'mpc current'</span></span>);<span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre> <br>  Warum manche solche Krücken fragen, ist die Tatsache, dass sich in meinem Militärradiosender der Server des Spielers auf einem Server befindet und sich das Webface der Website auf einem physisch anderen Webserver befindet. <br><br><img src="https://habrastorage.org/webt/sl/mg/eq/slmgeqlpij1qqccf75z2yfurvy4.png"><br><br>  Da Sie den Titel, der direkt auf dem Server abgespielt wird, mit dem Player abfragen müssen, sollte sich das mpc-Webserververzeichnis darauf befinden. Die Datei <code>"trackname.php"</code> befindet sich auf dem Webserver der Site selbst und lädt die Datei mit der <code>"trackname.php"</code> von einem anderen Server auf ihre IP-Adresse <code>"trackname.php"</code> . <br><br>  Der Player selbst und der Standort des Radiosenders können sehr weit voneinander entfernt sein und sowohl über externe IP-Adressen als auch über mit DNS verstopfte Adressen kommunizieren.  Damit alles funktioniert, müssen Sie nur die Ports korrekt weiterleiten. <br><br>  Sie können das Projekt nach Ihren Wünschen ändern. Nun, ich hatte einen angenehmen Samstagnachmittag. <br>  Alle erfolgreichen Experimente! <br><br>  <b>UPD2: Ein einwöchiges Experiment kam zu seinem logischen Abschluss und ich schalte meinen Miniserver mit einem Radiosender aus.</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de426349/">https://habr.com/ru/post/de426349/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de426339/index.html">25. Oktober 2018 Treffen der Atlassian User Group in der Raiffeisenbank</a></li>
<li><a href="../de426341/index.html">Speichern von Standard-Warwar in Python</a></li>
<li><a href="../de426343/index.html">Gentleman-Verhaltensregeln in der IT: Die Geschichte von ITIL</a></li>
<li><a href="../de426345/index.html">Interessante Rätsel aus technischen Interviews</a></li>
<li><a href="../de426347/index.html">ITMO University Digest: Neue Studien, Alumni-Erfahrung und internationale Projekte</a></li>
<li><a href="../de426351/index.html">Änderungen an Microsoft-Zertifizierungen und -Prüfungen</a></li>
<li><a href="../de426355/index.html">Math.Sin (Doppel) -Funktion für GPU</a></li>
<li><a href="../de426357/index.html">Unity & Vive: Tutorial</a></li>
<li><a href="../de426359/index.html">Yandex-Initiative zur Bekämpfung von Piraterie, die nicht von Copyright-Inhabern genehmigt wurde</a></li>
<li><a href="../de426361/index.html">Über das Wunder der Biene und wie wir sie töten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>