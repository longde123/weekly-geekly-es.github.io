<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤷🏾 🏬 🏂🏽 Verwenden des SPI-Flash-Anzeigespeichers zum Speichern von Grafikressourcen oder zum Anzeigen einer Heimwetterstation 😗 💆🏻 🏂🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel soll über die Möglichkeit sprechen, die integrierte Flash-Speicheranzeige für die Anforderungen des Projekts zu verwenden. 
 Für wen es...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Verwenden des SPI-Flash-Anzeigespeichers zum Speichern von Grafikressourcen oder zum Anzeigen einer Heimwetterstation</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/388449/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieser Artikel soll über die Möglichkeit sprechen, die integrierte Flash-Speicheranzeige für die Anforderungen des Projekts zu verwenden. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Für wen es relevant oder nur interessant ist - willkommen unter der Katze.</font></font><a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein ganzes Jahr lang legte ich ein 7-Zoll-Display auf ein Regal und wartete auf meine Zeit. Warum so lange? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ja, weil ein 3,2-Zoll-Display verwendet wurde, das im Allgemeinen gut funktionierte. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das Volumen der gleichzeitig angezeigten Informationen bei 3,2 Zoll passte jedoch überhaupt nicht zu mir. Der Serverteil der Wetterstation empfängt eine Wettervorhersage für eine Woche aus dem Internet, aber es gab keine Möglichkeit, sie gleichzeitig mit den Sensorwerten anzuzeigen (Vorhersage). Daher war ich verwirrt, als ich einen größeren Bildschirm kaufte. Anfangs habe ich mir 5 "angesehen, aber nachdem ich ein paar Mal an der Auktion teilgenommen hatte, kaufte ich am Ende 7" zu einem Preis von 5 ", was sehr erfreut war. Das gekaufte Display ist mit einem SSD1963-Controller und 64 MB Flash-RAM ausgestattet.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Als das neue Display noch im Regal verstaubt war, machte ich auf das Vorhandensein von Bibliotheken im Internet aufmerksam, deren Dokumentation es ermöglichte, den eingebauten Flash-Speicher für meine Bedürfnisse zu verwenden. Bisher habe ich mir Symbole ausgedacht, die das aktuelle Wetter dort anzeigen. In der vorherigen Version mit einem 3,2-Zoll-Display wurden die Symbole auf einer SD-Karte gespeichert, die in den Kartenleser des Anzeigemoduls eingelegt war. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich möchte sofort darauf hinweisen, dass das Laden von Ressourcendateien in den Anzeigespeicher nicht einfach und bequem ist. Deshalb habe ich beschlossen, einen kurzen Anleitungsartikel zu schreiben : </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Laden Sie zunächst die Archive unter den folgenden Links herunter: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPIFlash</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UTFT_SPIflash,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und erweitern Sie die Archive in das Bibliotheksverzeichnis. Das </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Herunterladen besteht aus mehreren Schritten:</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1. Bereiten Sie im Voraus eine Reihe von Symbolen oder anderen grafischen Ressourcen vor, die wir in Ihrem Projekt verwenden möchten. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2. Im Ordner SPIflash \ tools \ FlashUploader befindet sich das FlashUploader-Tool und eine gute Dokumentation dafür. Theoretisch ist dieses Tool so konzipiert, dass Ressourcen in eine Flash-Anzeige geladen werden. Aufgrund von Problemen bei der Softwarekommunikation mit der Steuerung ist dies jedoch nicht möglich, sodass dieser Prozess etwas verlängert wird. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mit FlashUploader bereiten wir eine SFD-Datei vor, die eine Reihe vorbereiteter Bilder oder anderer Ressourcen enthält.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Ressourcendatei vorzubereiten und zu speichern, müssen Sie FlashUploader und die Anzeige nicht verbinden. Wenn Sie dies dennoch tun möchten, müssen Sie eine spezielle Skizze in Arduino laden, mit der die Anzeige verbunden ist. Diese befindet sich im Ordner SPIflash \ examples \ Arduino (AVR) \ SPIflash_FlashUploader . </font><font style="vertical-align: inherit;">Vergessen Sie nicht, nach dem Hinzufügen aller Symbole und dem Speichern der sfd-Datei eine Datei mit einer Beschreibung des angehängten Inhalts über die Schaltfläche "Inhaltsverzeichnis erstellen" zu erstellen. </font><font style="vertical-align: inherit;">In Zukunft verwenden wir die Datei mit der Beschreibung als Referenz, um nach der Nummer des gewünschten Symbols zu suchen.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FlashUploader Screenshot</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/180/53b/1b7/18053b1b71b4435cac987327a33637fb.png"><br>
</div></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. Die resultierende SFD-Datei wird auf die SD-Karte geschrieben, die dann in den Grafikkartenleser eingelegt wird. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4. Verbinden Sie die Anzeige mit Arduino und laden Sie die Skizze SPIflash_Restore aus dem Ordner SPIflash \ examples \ Arduino (AVR). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5. Wir beginnen mit der Wiederherstellung des SD-Inhalts im Flash-Speicher des Displays.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Screenshot von Serial Monitor nach erfolgreichem Upload</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/819/186/a61/819186a6151f42d581a77d593c7d2162.png"><br>
</div></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Damit ist der Startvorgang abgeschlossen. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Projekt müssen Sie über die ID in der SFD-Datei auf die gewünschte Ressource (Bild) zugreifen.</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine kleine Testskizze, um alle Symbole (in meinem Fall 44) auf dem Display anzuzeigen</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SPI.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;UTFT.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;SPIflash.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;UTFT_SPIflash.h&gt;</span></span></span></span>
<span class="hljs-comment"><span class="hljs-comment">//////      ////////</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> SmallFont[];
<span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint8_t</span></span> BigFont[];
<span class="hljs-comment"><span class="hljs-comment">///////////////////////////////////</span></span>
<span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-function"><span class="hljs-function">UTFT </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myGLCD</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(CTE70, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">38</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">39</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">40</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">41</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>;
<span class="hljs-comment"><span class="hljs-comment">// myFlash(&lt;SS&gt;); (if using the hardware SPI pins. See the manual for other configurations.)</span></span>
<span class="hljs-function"><span class="hljs-function">SPIflash      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myFlash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">45</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>;
<span class="hljs-function"><span class="hljs-function">UTFT_SPIflash </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myFiles</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;myGLCD, &amp;myFlash)</span></span></span></span>;
<span class="hljs-comment"><span class="hljs-comment">//////////////////////////////////////////////////</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  myGLCD.InitLCD(LANDSCAPE);<font></font>
  myGLCD.setBright(<span class="hljs-number"><span class="hljs-number">7</span></span>);<font></font>
  myGLCD.setFont(BigFont);<font></font>
  myGLCD.setColor(<span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>, <span class="hljs-number"><span class="hljs-number">255</span></span>);<font></font>
  myGLCD.setBackColor(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
  myGLCD.clrScr();<font></font>
  myFlash.begin();<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (myFlash.ID_device == <span class="hljs-number"><span class="hljs-number">0</span></span>)<font></font>
  {<font></font>
    myGLCD.print(F(<span class="hljs-string"><span class="hljs-string">"Unknown flash device!"</span></span>), <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) {};<font></font>
  }<font></font>
  TestIcon2Display(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestIcon2Display</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> y)</span></span></span><span class="hljs-function">
</span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">44</span></span>; i++)<font></font>
  {<font></font>
      Serial.println(i);<font></font>
    myFiles.loadBitmap(i, x, y);<font></font>
    x = x + <span class="hljs-number"><span class="hljs-number">150</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (x &gt; <span class="hljs-number"><span class="hljs-number">800</span></span> - <span class="hljs-number"><span class="hljs-number">150</span></span>)<font></font>
    {<font></font>
      x = <span class="hljs-number"><span class="hljs-number">10</span></span>;<font></font>
      y = y + <span class="hljs-number"><span class="hljs-number">110</span></span>;<font></font>
    }<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (y &gt; <span class="hljs-number"><span class="hljs-number">480</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>) y = <span class="hljs-number"><span class="hljs-number">10</span></span>;<font></font>
    delay(<span class="hljs-number"><span class="hljs-number">700</span></span>);<font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
}<font></font>
</code></pre><br>
</div></div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nun, am Ende </font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wetterstationsanzeige in einwandfreiem Zustand</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/files/4de/d44/31d/4ded4431d09d4cedbff7034320dff972.jpg"><br>
</div></div></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de388449/">https://habr.com/ru/post/de388449/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de388435/index.html">Wie wir ein Analogon von Oculus Rift gemacht haben</a></li>
<li><a href="../de388437/index.html">Charaktere von Märchen aus dem alten Russland, Episode II</a></li>
<li><a href="../de388443/index.html">Der legendäre Winamp-Spieler hat wieder die Chance, sich zu beleben</a></li>
<li><a href="../de388445/index.html">Warum explodieren Sterne?</a></li>
<li><a href="../de388447/index.html">BBC begann mit der automatischen Übersetzung von Berichten</a></li>
<li><a href="../de388453/index.html">Der erste funktionierende Prototyp eines elektronenoptischen Einzelchip-Prozessors wurde erstellt</a></li>
<li><a href="../de388455/index.html">Dutzende von DVD-Filmen vor der Veröffentlichung sind online durchgesickert</a></li>
<li><a href="../de388457/index.html">[Neujahrspost] Kingston gratuliert den Lesern von GeekTimes</a></li>
<li><a href="../de388461/index.html">Was gibt es für das neue Jahr zu geben? Epson Kurzanleitung</a></li>
<li><a href="../de388463/index.html">Gingwa (Sprache für die interplanetare Kommunikation zwischen Proteinhumanoiden). Teil 2, Schulungsworkshop</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>