<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐๐ฝ โ๏ธ ๐ ููุงูู ุงูุจูุงูุงุช ููุจุฑูุฌู ุงููุนุจุฉ: ุจูุงูุงุช ูุฌูุนุฉ ๐จ๐ผโ๐ ๐คฒ๐ฝ ๐ฉโโ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุณูุณุชููุฏ ุฃู ูุจุฑูุฌ ูู ููู ููุงูู ุงูุจูุงูุงุช ุงููุฎุชููุฉ ูููููุฉ ุชุญููู ุฃุฏุงุฆูุง. ููู ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ูู ุฃุชููู ุฃุจุฏูุง ูู ุงูุงุณุชูุงุฏุฉ ูู ุฃุดุฌุงุฑ AVL ุ ุฃู ุงูุฃุดุฌุงุฑ ุฐ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููุงูู ุงูุจูุงูุงุช ููุจุฑูุฌู ุงููุนุจุฉ: ุจูุงูุงุช ูุฌูุนุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/469861/" style=";text-align:right;direction:rtl"><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/7e7/1d7/bb3/7e71d7bb314eaffe2d54f349cc854a5f.png" alt="ุตูุฑุฉ"></div><br>  ุณูุณุชููุฏ ุฃู ูุจุฑูุฌ ูู ููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงูู ุงูุจูุงูุงุช</a> ุงููุฎุชููุฉ ูููููุฉ ุชุญููู ุฃุฏุงุฆูุง.  ููู ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ูู ุฃุชููู ุฃุจุฏูุง ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุงุณุชูุงุฏุฉ ูู ุฃุดุฌุงุฑ AVL</a> ุ ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุดุฌุงุฑ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฐุงุช ุงูููู ุงูุฃุญูุฑ - ุงูุฃุณูุฏ</a> ุ ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุดุฌุงุฑ ุงูุจุงุฏุฆุฉ</a> ุ ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุฆู ุงูุชุฎุทู</a> ุ ุฅูุฎ.  ูููููู ุงุณุชุฎุฏุงู ุจุนุถ ุจููุงุช ุงูุจูุงูุงุช ูุฎูุงุฑุฒููุฉ ูุญุฏุฏุฉ ูุงุญุฏุฉ ููุง ุดูุก ุขุฎุฑ (ุนูู ุณุจูู ุงููุซุงู ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃููุงู</a> ูุชุทุจูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุฆูุฉ ุงูุชุธุงุฑ ุฃููููุฉ</a> ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฎูุงุฑุฒููุฉ ุงูุจุญุซ ุนู ูุณุงุฑ A *</a> ). <br><br>  ูู ุงูุนูู ุงููููู ุ ุฃูุนู ุนุงุฏุฉู ูุน ุนุฏุฏ ูููู ุฌุฏูุง ูู ููุงูู ุงูุจูุงูุงุช.  ูู ูุซูุฑ ูู ุงูุฃุญูุงู ุ ูุฅููุง ุชุฃุชู ูู ูุชูุงูู ูุฏู ุจุงููุณุจุฉ ูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุตูุงุฆู ุงูุจูุงูุงุช ุงููุดุชุฑูุฉ (ุงูุจูุงูุงุช ุงููุฌูุนุฉ) - ุทุฑููุฉ ูุชุฎุฒูู ุนุฏุฏ ูุจูุฑ ูู ุงููุงุฆูุงุช ุจุดูู ูุนุงู. </li><li style=";text-align:right;direction:rtl">  ูุฑุงุฌุน ุถุนููุฉ (ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงุจุถ</a> ) - ุทุฑููุฉ ูููุตูู ุฅูู ุงููุงุฆูุงุช ูู ุงูุจูุงูุงุช ุงููุฌูุนุฉ ุฏูู ุชุนุทู ุงูุจุฑูุงูุฌ ูู ุญุงูุฉ ุญุฐู ุงููุงุฆู. </li><li style=";text-align:right;direction:rtl">  ุงูููุงุฑุณ ูู ูุณููุฉ ูููุตูู ุจุณุฑุนุฉ ุฅูู ูุฌููุนุงุช ูุฑุนูุฉ ูุฑุฏูุฉ ูู ุจูุงูุงุช ูุฌูุนุฉ. </li><li style=";text-align:right;direction:rtl">  ุตูุงุฆู ุงููุตูููุงุช ูู ุทุฑููุฉ ูุชุฎุฒูู ูุงุฆูุงุช ุจูุงูุงุช ูุฌูุนุฉ ุฐุงุช ุฃุญุฌุงู ุฏููุงููููุฉ. </li></ul><br>  ุณุฃุฎุตุต ุนุฏุฉ ููุงูุงุช ูููููุฉ ุชูููุฐ ูู ูุฐู ุงูููุงูู ุนุงุฏุฉู.  ููุจุฏุฃ ุจุฃุจุณุท ุงูุจูุงูุงุช ูุฃูุซุฑูุง ูุงุฆุฏุฉ. <a name="habracut"></a><br><br><h2 style=";text-align:right;direction:rtl">  ุจูุงูุงุช ูุฌูุนุฉ </h2><br>  ูุง ููุฌุฏ ูุตุทูุญ ุดุงุฆุน ููุฐุง ุงูููููู (ุฃู ูุง ุฃุนุฑู ุฐูู).  ุฃุฏุนู " <em>ุงูุจูุงูุงุช ุงููุฌูุนุฉ</em> " ุฃู ูุฌููุนุฉ ูุจูุฑุฉ ูู ุงููุงุฆูุงุช ุงูููุงุซูุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุฃู ูููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุงูุฑุตุงุต ูู ุงููุนุจุฉ. </li><li style=";text-align:right;direction:rtl">  ูู ุงูุฃุดุฌุงุฑ ูู ุงููุนุจุฉ. </li><li style=";text-align:right;direction:rtl">  ุฌููุน ุงููุทุน ุงูููุฏูุฉ ูู ุงููุนุจุฉ. </li></ul><br>  ุฃู ุ ุฅุฐุง ููุช ุชูุชุจ ุงูุดูุฑุฉ ุจูุณุชูู ุฃุนูู ูู ุงูุชุฌุฑูุฏ ุ ููุฏ ุชููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฌููุน ุงูููุงูุงุช ูู ุงููุนุจุฉ. </li><li style=";text-align:right;direction:rtl">  ุฌููุน ุชูุณุฌู ูู ุงููุนุจุฉ. </li><li style=";text-align:right;direction:rtl">  ูู ุงูุฃุตูุงุช ูู ุงููุนุจุฉ. </li></ul><br>  ุนุงุฏุฉู ูุง ูููู ููู ูุธุงู (ุงูุชูุฏูู ุ ุงูุตูุช ุ ุงูุฑุณูู ุงููุชุญุฑูุฉ ุ ุงูููุฒูุงุก ุ ุฅูุฎ) ูู ูุนุจุฉ ุนุฏุฉ ุฃููุงุน ูุฎุชููุฉ ูู ุงููุงุฆูุงุช ุงูุชู ูุญุชุงุฌูุง ุงูุชุชุจุน.  ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ููุธุงู ุงูุตูุช ุ ูููู ุฃู ูููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฌููุน ููุงุฑุฏ ุงูุตูุช ุงูุชู <em>ูููู</em> ูุนุจูุง. </li><li style=";text-align:right;direction:rtl">  ุฌููุน ุงูุฃุตูุงุช ุชูุนุจ <em>ุญุงููุง</em> . </li><li style=";text-align:right;direction:rtl">  ุฌููุน ุงูุขุซุงุฑ (ุงูุชูููู ุ ูุชุบููุฑุงุช ุงููุบูุฉ ุ ููุง ุฅูู ุฐูู) ุงููุทุจูุฉ ุนูู ุงูุฃุตูุงุช. </li></ul><br>  ูู ุญุงูุฉ ุงูุจูุงูุงุช ุงููุฌููุนุฉ ุ ุณุฃูุชุฑุถ ูุง ููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุฑุชูุจ ุชุฎุฒูู ุงููุงุฆูุงุช ุบูุฑ ููู.  ุฃู  ูุญู ูุชุตูุฑ ุงูุตููู ููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุนุฏูุฏ ูู</a> ุงููุงุฆูุงุช. </li><li style=";text-align:right;direction:rtl"> ูุชู ุชูุซูู ูู ูุงุฆู ุนูู ุฃูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจููุฉ ุจูุงูุงุช ุจุณูุทุฉ (POD-struct)</a> ุฐุงุช ุญุฌู ุซุงุจุช ูููู ููููุง ุฃู ุชูุฑุงุฑูุง ุจุงุณุชุฎุฏุงู <code>memcpy()</code> . </li></ul><br>  ุจุงูุทุจุน ุ ููููู ุงูุฎุฑูุฌ ุจููุงูู ุฐุงุช ุชุฑุชูุจ <em>ููู</em> .  ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงูุช ุงููุงุฆูุงุช ุชุดูุฑ ุฅูู ุนูุงุตุฑ ููุชุฌุณูุฏ ุ ููุจู ุงูุชูุฏูู ุ ูุฏ ูุญุชุงุฌ ุฅูู ูุฑุฒูุง ูู ุงูุฃูุงู ุฅูู ุงูุฎูู ูุชูููู ููุฏุงุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฅุนุงุฏุฉ ุงูุฑุณู</a> . <br><br>  ููุน ุฐูู ุ ุฃุนุชูุฏ ุฃูู ูู ุงูุฃูุถู ูู ูุนุธู ุงูุญุงูุงุช ูุฑุฒ ุงูุจูุงูุงุช <em>ููุง ูุชู ุงุณุชุฎุฏุงููุง</em> ุ ุจุฏูุงู ูู ุชุฎุฒูู ุงูุจูุงูุงุช ูู ุญุงููุฉ ููุฑูุฒุฉ ุ ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุดุฌุงุฑ ุฐุงุช ุงูููู ุงูุฃุญูุฑ ุงูุฏุงูู</a> ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุดุฌุงุฑ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">B.</a>  ุนูู ุณุจูู ุงููุซุงู ุ ูููููุง ูุฑุฒ ุงููุงุฆูุงุช ุงูููุฏูุฉ ูู ุงูุฃูุงู ุฅูู ุงูุฎูู ูุจู ููููุง ุฅูู ุงูุนุงุฑุถ ุ ุฃู ูุฑุฒ ุงููููุงุช ุฃุจุฌุฏููุง ูุจู ุนุฑุถูุง ุนูู ุงูุดุงุดุฉ ููุงุฆูุฉ.  ูุฏ ูุจุฏู ูุฑุฒ ุงูุจูุงูุงุช ูู ูู ุฅุทุงุฑ ูููููุง ุ ูููู ูู ูุซูุฑ ูู ุงูุญุงูุงุช ูุชู ุฐูู ูู <em>O (n)</em> ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุฒ ุงูุฌุฐุฑ</a> . <br><br>  ุจูุง ุฃููู ุฃุณุชุฎุฏู ููุงูู ุจูุงูุงุช ุจุณูุทุฉ ููุท ุ ูุฅููู ุฃูุถู ูุงุฆูุงุช C ++ ุนูู ูุงุฆูุงุช C ++ ุ ูุฃูู ูู ุงูุฃุณูู ููู ูุง ูุญุฏุซ ูู ุงูุฐุงูุฑุฉ ูุชูููู ุฃุฏุงุฆูุง.  ููุน ุฐูู ุ ููุงู ููุงูู ุนูุฏูุง ุชุญุชุงุฌ ุฅูู ุชุฎุฒูู ุจูุงูุงุช ูุฌููุนุฉ ูู ุดูุก ููุณ ูู ุญุฌู ุซุงุจุช.  ุนูู ุณุจูู ุงููุซุงู ุ ุงุณู ุฃู ูุงุฆูุฉ ุงููุงุฆูุงุช ุงูุชุงุจุนุฉ.  ุณุฃุชุญุฏุซ ุนู ูุฐู ุงูุญุงูุงุช ูู ููุดูุฑ ูููุตู ุ ุญูุซ ููุธุฑ ุฅูู "ุตูุงุฆู ุงููุตูููุงุช".  ุงูุขู ุ ูููุชุฑุถ ุฃู ุฌููุน ุงููุงุฆูุงุช ูู ููุงูู ุจูุงูุงุช ุจุณูุทุฉ ุงูุญุฌู ุซุงุจุชุฉ. <br><br>  ุนูู ุณุจูู ุงููุซุงู ุ ุฅููู ูุง ุณุชุจุฏู ููุงูู ุงูุจูุงูุงุช ุงููุฌูุนุฉ ููุธุงู ุงูุตูุช ุงูุงูุชุฑุงุถู ุงูุฎุงุต ุจูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">resource_t</span></span> *resource; <span class="hljs-comment"><span class="hljs-comment">// Resource manager data uint64_t bytes; // Size of data uint64_t format; // Data format identifier } sound_resource_t; typedef struct { sound_resource_t *resource; // Resource that's playing uint64_t samples_played; // Number of samples played float volume; // Volume of playing sound } playing_sound_t; typedef struct { playing_sound_t *sound; // Faded sound float fade_from; // Volume to fade from float fade_to; // Volume to fade to double fade_from_ts; // Time to start fade double fade_to_ts; // Time to end fade } playing_fade_t;</span></span></code> </pre> <br>  ุนูุฏ ุงูุชูููุฑ ูู ุทุฑู ูุชุฎุฒูู ุงูุจูุงูุงุช ุงููุฌููุนุฉ ุ ูุญุชุงุฌ ุฅูู ุงูุชูููุฑ ูู ูุฏููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชููู ุฅุถุงูุฉ ูุฅุฒุงูุฉ ุงูุฃุดูุงุก ุณุฑูุนุฉ. </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชููู ุงูุจูุงูุงุช ููุฌูุฏุฉ ูู ูููุฐุฌ <strong>ููุงุณุจ ููุชุฎุฒูู ุงููุคูุช</strong> ุ ุจุญูุซ ููููู ุชูุฑุงุฑูุง ุจุณุฑุนุฉ ูุชุญุฏูุซ ุงููุธุงู. </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ูุฏุนู <strong>ุขููุฉ ุงูุงุฑุชุจุงุท</strong> - ูุฌุจ ุฃู ูููู ููุงู ุทุฑููุฉ ูููู ุงููุนูููุงุช <em>ุญูู</em> ูุงุฆูุงุช ูุญุฏุฏุฉ ูู ุงูุจูุงูุงุช ุงููุฌูุนุฉ.  ูู ุงููุซุงู ุฃุนูุงู ุ ูุฌุจ ุฃู ูููู ุงูุฎุจู ูุงุฏุฑุงู ุนูู ุชุญุฏูุฏ ุงูุตูุช ุงููุฎูู.  ูู ุงููุซุงู ุ ูุชุจุช ุงูุงุฑุชุจุงุทุงุช ููุคุดุฑุงุช ุ ููู ุชูููุฐูุง ูุนุชูุฏ ุนูู ููููุฉ ุชุฑุชูุจ ุงูุจูุงูุงุช ุงููุฌููุนุฉ. </li><li style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู ุชููู ุงูุจูุงูุงุช <strong>ุณููุฉ ุงูุงุณุชุฎุฏุงู</strong> - ูุฌุจ ุฃู ุชุณุชุฎุฏู ุงูุนุฏูุฏ ูู ุนูููุงุช ุชุฎุตูุต ุงูุฐุงูุฑุฉ ุงููุจูุฑุฉ ุ ูููุณ ุชุฎุตูุต ูุงุฆูุงุช ูุฑุฏูุฉ ุนูู ุงููููุฉ. </li></ul><br>  ุฃุณูู ุทุฑููุชูู ูุชูุซูู ุงูุจูุงูุงุช ุงููุฌูุนุฉ ูู ุตููู ุซุงุจุช ุฃู ูุชุฌู C ++: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Static array #define MAX_PLAYING_SOUNDS 1024 uint32_t num_playing_sounds; playing_sound_t playing_sounds[MAX_PLAYING_SOUNDS]; // C++ vector std::vector&lt;playing_sound_t&gt; playing_sounds;</span></span></code> </pre> <br>  ุงูุนูู ูุน ุตููู ุจุณูุท ููุบุงูุฉ ุ ููููู ุฃู ูุนูู ุจุดูู ุฌูุฏ ุจุงููุณุจุฉ ูู ุฅุฐุง ููุช ุชุนุฑู ุจุงูุถุจุท ุนุฏุฏ ุงููุงุฆูุงุช ุงููุทููุจุฉ ูู ุงูุชุทุจูู.  ุฅุฐุง ููุช <em>ูุง ุชุนุฑู ุฐูู</em> ุ ูุฅูุง ุฃู ุชูุฏุฑ ุฐุงูุฑุชู ุฃู ููุฏุช ุงูุฃุดูุงุก. <br><br>  ูุนุชุจุฑ vector <code>std::vector</code> ุญููุง ุจุณูุทูุง ุฌุฏูุง ูุจุณูุทูุง ุ ูููู ุนููู ููุง ุงูุชูููุฑ ูู ุจุนุถ ุงูุฌูุงูุจ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุทุจูู ููุงุณู <code>std::vector</code> ูู Visual Studio ุจุทูุก ูู ูุถุน ุงูุชุตุญูุญ ุจุณุจุจ ุชูุฑุงุฑ ุงูุชูุฑุงุฑุงุช.  ูุฌุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุนููููู</a> ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">_ITERATOR_DEBUG_LEVEL = 0</a> . </li><li style=";text-align:right;direction:rtl">  ูุฅูุดุงุก ุงููุงุฆูุงุช ูุชุฏููุฑูุง ุ ูุณุชุฎุฏู <code>std::vector</code> <code>memcpy()</code> ุ ููู ุจุนุถ ุงูุญุงูุงุช ูููู ุฃู ุชููู ุฃุจุทุฃ ุจูุซูุฑ ูู <code>memcpy()</code> . </li><li style=";text-align:right;direction:rtl">  <code>std::vector</code> ุฃูุซุฑ ุตุนูุจุฉ ูู ุงูุชุญููู ูู ุชุทุจูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">"ุจุณุท ุนุงุฒู"</a> ุจุณูุท. </li></ul><br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุจุฏูู ุชุฏุงุจูุฑ ุฅุถุงููุฉ ุ ูุง ุชุฏุนู ุงููุตูููุงุช ุงูููุชุธูุฉ ุฃู ุงููุชุฌูุงุช ุงูุฅุดุงุฑุงุช ุฅูู ุงููุงุฆูุงุช ุงููุฑุฏูุฉ.  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ูุฐุง ุงูููุถูุน ุ ููุฐูู ูุฑุงุฑุงุช ุงูุชุตููู ุงููุงูุฉ ุงูุฃุฎุฑู ุงููุดุงุฑูุฉ ูู ุฅูุดุงุก ูุธุงู ุงูุจูุงูุงุช ุจุงูุฌููุฉ. <br><br><h2 style=";text-align:right;direction:rtl">  ุงุณุชุฑุงุชูุฌูุฉ ุฅุฒุงูุฉ </h2><br>  ุฃูู ูุฑุงุฑ ููู: ูุง ุงูุฐู ูุฌุจ ุงูููุงู ุจู ุนูุฏ ุญุฐู ุงููุงุฆู <code>a[i]</code> .  ูููุง ููู ุซูุงุซุฉ ุฎูุงุฑุงุช ุฑุฆูุณูุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููููู ุชุญููู ุฌููุน ุงูุนูุงุตุฑ ุงูุชุงููุฉ <code>a[i+1]</code> โ <code>a[i]</code> ุ <code>a[i+2]</code> โ <code>a[i+1]</code> ุ ุฅูุฎ ุ ูุฅุบูุงู ูุชุญุฉ ูุงุฑุบุฉ. </li><li style=";text-align:right;direction:rtl">  ููููู ููู ุงูุนูุตุฑ ุงูุฃุฎูุฑ ููุตููู ุฅูู ูุชุญุฉ ูุงุฑุบุฉ: <code>a[i] = a[n-1]</code> . </li><li style=";text-align:right;direction:rtl">  ุฃู ููููู ุชุฑู ุงููุชุญุฉ ูุงุฑุบุฉ ุนู ุทุฑูู ุฅูุดุงุก ุซูุจ ูู ุงููุตูููุฉ.  ูููู ุงุณุชุฎุฏุงู ูุฐุง ุงูุซูุจ ูููุง ุจุนุฏ ููุถุน ูุงุฆู ุฌุฏูุฏ. </li></ul><br>  ุงูุฎูุงุฑ ุงูุฃูู ูุธูุน - <em>O (ู)</em> ูููู ุนูู ุญุฑูุฉ ูู ูุฐู ุงูุนูุงุตุฑ.  ุงููุงุฆุฏุฉ ุงููุญูุฏุฉ ููุทุฑููุฉ ุงูุฃููู ูู ุฃูู ุฅุฐุง ุชู ูุฑุฒ ุงููุตูููุฉ ุ ูุณูุชู ุงูุงุญุชูุงุธ ุจุงูุชุฑุชูุจ ูููุง.  ูููู ููุง ุฐูุฑ ุฃุนูุงู ุ ูุฅู ุงููุธุงู ูุง ูุฒุนุฌูุง.  ูุงุญุธ ุฃูู ุฅุฐุง ููุช ุชุณุชุฎุฏู <code>a.erase()</code> ูุฅุฒุงูุฉ ุงูุนูุตุฑ <code>std::vector</code> ุ ููุฐุง ุจุงูุถุจุท ูุง ุณูุญุฏุซ! <br><br>  ุบุงูุจูุง ูุง ูุทูู ุนูู ุงูุฎูุงุฑ ุงูุซุงูู "ุงููุจุงุฏูุฉ ูุงูุจูุจ".  ููุงุฐุงุ  ูุฃูู ูู ุญุงูุฉ ุงุณุชุฎุฏุงู ูุชุฌู C ++ ุ ูุชู ุชูููุฐ ูุฐุง ุงูุฎูุงุฑ ุนุงุฏุฉู ุนู ุทุฑูู ุงุณุชุจุฏุงู (ุงุณุชุจุฏุงู) ุงูุนูุตุฑ ุงูุฐู ุชุฑูุฏ ุญุฐูู ุจุงูุนูุตุฑ ุงูุฃุฎูุฑ ุ ูุชุจูุนูุง ุจุฅุฒุงูุฉ ุงูุนูุตุฑ ุงูุฃุฎูุฑ ุฃู ุธููุฑู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::swap(a[i], a[a.size() - <span class="hljs-number"><span class="hljs-number">1</span></span>]); a.pop_back();</code> </pre> <br>  ููุงุฐุง ูู ูุฐุง ุถุฑูุฑูุ  ูู C ++ ุ ุฅุฐุง ูููุง <em>ุจุชุนููู</em> <code>a[i] = a[n-1]</code> ุ ูุฌุจ ุฃููุงู ุฅุฒุงูุฉ <code>a[i]</code> ุนู ุทุฑูู ุงุณุชุฏุนุงุก destructor ุงูุฎุงุต ุจู ุ ุซู ุงุณุชุฏุนุงุก ูููุดุฆ ุงููุณุฎ ูุฅูุดุงุก ูุณุฎุฉ ูู <code>a[n-1]</code> ูู ุงูููุถุน <code>i</code> ู ุฃุฎูุฑูุง ุ ูุญู ูุณูู ุงููุฏูุฑ <code>a[n-1]</code> ุนูุฏ ููู ุงููุชุฌู.  ุฅุฐุง ูุงู ูููุดุฆ ุงููุณุฎ ุจุชุฎุตูุต ุงูุฐุงูุฑุฉ ููุณุฎ ุงูุจูุงูุงุช ุ ููุฏ ูููู ุฐูู ุณูุฆูุง ููุบุงูุฉ.  ุฅุฐุง ุงุณุชุฎุฏููุง <code>std::swap</code> ุจุฏูุงู ูู ุงูุชุนููู ุ ููููููุง ุงูููุงู ุจุฐูู ููุท ูุน ุชุญุฑู ุงููููุดุฆุงุช ููุฌุจ ุนุฏู ุชุฎุตูุต ุงูุฐุงูุฑุฉ. <br><br>  ูุฑุฉ ุฃุฎุฑู ุ ูุฐุง ูู ุงูุณุจุจ ูุฑุงุก ุชูุถูู C ++ ูููุฆุงุช ุงูุจูุงูุงุช ุงูุจุณูุทุฉ ูุงูุนูููุงุช C. ุชุญุชูู C ++ ุนูู ุงูุนุฏูุฏ ูู ุนููุจ ุงูุฃุฏุงุก ุงูุชู ููููู ุงููููุน ูููุง ุฅุฐุง ููุช ูุง ุชุนุฑู ูุง ูุญุฏุซ ูู ุงูุฏุงุฎู.  ูู C ุ ุณุชููู ุนูููุฉ ูุญู ุงููุจุงุฏูุฉ ุจุณูุทุฉ ููุบุงูุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">a.data[i] = a.data[--an];</code> </pre> <br>  ุนูุฏ ุงุณุชุฎุฏุงู swap-and-pop ุ ุชุธู ุงููุงุฆูุงุช ูุนุจุฃุฉ ุจุฅุญูุงู.  ููุถุน ูุงุฆู ุฌุฏูุฏ ุ ูุง ุนููู ุณูู ุฅุฑูุงูู ุจููุงูุฉ ุงููุตูููุฉ. <br><br>  ุฅุฐุง ุงุณุชุฎุฏููุง ุงูุฎูุงุฑ "ูุน ุงูุซููุจ" ุ ูุนูุฏ ูุถุน ูุงุฆู ุฌุฏูุฏ ุ ูุญุชุงุฌ ุฃููุงู ุฅูู ุงูุชุญูู ููุง ุฅุฐุง ูุงู ููุงู "ุซููุจ" ูุฌุงููุฉ ูููู ุงุณุชุฎุฏุงููุง.  ูุฌุฏุฑ ุฒูุงุฏุฉ ุญุฌู ุงููุตูููุฉ ููุท ุนูุฏ ุนุฏู ูุฌูุฏ "ูุชุญุงุช" ูุฌุงููุฉ.  ุฎูุงู ุฐูู ุ ูู ุนูููุฉ ุญุฐู ูุฅูุดุงุก ุงููุงุฆูุงุช ุ ูุณูู ุชููู ุฅูู ุฃุฌู ุบูุฑ ูุณูู. <br><br>  ููููู ุงุณุชุฎุฏุงู <code>std::vector&lt;uint32_t&gt;</code> ูููุตูุฉ <code>std::vector&lt;uint32_t&gt;</code> ูุชุชุจุน ููุงุถุน ุงููุชุญุงุช ุ ูููู ููุฌุฏ ุญู ุฃูุถู ูุง ูุชุทูุจ ุฐุงูุฑุฉ ุฅุถุงููุฉ. <br><br>  ูุธุฑูุง ูุนุฏู ุงุณุชุฎุฏุงู ุจูุงูุงุช ุงููุงุฆู ุงูููุฌูุฏ ูู "ุงูุญูุฑุฉ" ูู ุฃู ุดูุก ุ ููููู ุงุณุชุฎุฏุงูู ูุชุฎุฒูู ูุคุดุฑ ุฅูู ุงููุชุญุฉ ุงูุญุฑุฉ ุงูุชุงููุฉ.  ูุจุงูุชุงูู ุ ูุฅู ุฌููุน ุงูุซููุจ ุงูููุฌูุฏุฉ ูู ุงููุตูููุฉ ุชุดูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุฆูุฉ ูุชุตูุฉ ุจุจุณุงุทุฉ</a> ุ ูุฅุฐุง ูุฒู ุงูุฃูุฑ ุ ูููููุง ุฅุถุงูุฉ ุนูุงุตุฑ ูุฅุฒุงูุชูุง ูููุง. <br><br>  ููุทูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุนูู</a> ูุฐุง ุงูููุน ูู ุจููุฉ ุงูุจูุงูุงุช ุ ุงูุฐู ุชุณุชุฎุฏู ููู ุงูุฐุงูุฑุฉ ุบูุฑ ุงููุณุชุฎุฏูุฉ ูุฑุจุท ุงูุนูุงุตุฑ ุงูุญุฑุฉ ุ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุฆูุฉ ูุฌุงููุฉ</a> . <br><br>  ูู ูุงุฆูุฉ ูุฑุชุจุทุฉ ุชูููุฏูุฉ ุ ูุดูุฑ <em>ุนูุตุฑ ุฑุฃุณ</em> ูุงุฆูุฉ ุฎุงุตุฉ ุฅูู ุงูุนูุฏุฉ ุงูุฃููู ูู ุงููุงุฆูุฉ ุ ููุดูุฑ ุนูุตุฑ ุงููุงุฆูุฉ ุงูุฃุฎูุฑ ุฅูู NULL ุ ููุง ูุนูู ููุงูุฉ ุงููุงุฆูุฉ.  ุจุฏูุงู ูู ุฐูู ุ ุฃูุถู ุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุงุฆูุฉ ูุฑุชุจุทุฉ ุฏุงุฆุฑูุฉ</a> ุ ูููู ุงูุนููุงู ูููุง ูุฌุฑุฏ ุนูุตุฑ ูุงุฆูุฉ ุฎุงุตุฉ ุ ููุดูุฑ ุนูุตุฑ ุงููุงุฆูุฉ ุงูุฃุฎูุฑ ุฅูู ุนูุตุฑ ุงูุนููุงู: <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ffe/fe0/a6b/ffefe0a6b6bd621b9362e84486db65e1.jpg" width="100%"></div><br>  <i>ุงูููุงุฆู ุงูุชูููุฏูุฉ ูุงูุฎูุงุชู ุงููุฑุชุจุทุฉ.</i> <br><br>  ููุฒุฉ ูุฐุง ุงูุฃุณููุจ ูู ุฃู ุงูุฑูุฒ ูุตุจุญ ุฃุจุณุท ุจูุซูุฑ ุนู ุทุฑูู ุชูููู ุนุฏุฏ ุงูุญุงูุงุช ุงูุฎุงุตุฉ ูู ุจุฏุงูุฉ ูููุงูุฉ ุงููุงุฆูุฉ. <br><br>  ูุงุญุธ ุฃูู ุฅุฐุง ููุช ุชุณุชุฎุฏู <code>std::vector</code> ูุชุฎุฒูู ุงููุงุฆูุงุช ุ ูุณูู ุชุชุบูุฑ ุงููุคุดุฑุงุช ุฅูู ุงููุงุฆูุงุช ูุน ูู ุนูููุฉ ุฅุนุงุฏุฉ ุชูุฒูุน ูููุงูู.  ูุฐุง ูุนูู ุฃููุง ูุง ูุณุชุทูุน ุงุณุชุฎุฏุงู ุงููุคุดุฑุงุช ุงูุนุงุฏูุฉ ูู ูุงุฆูุฉ ูุฑุชุจุทุฉ ุ ูุฃู ุงููุคุดุฑุงุช ุชุชุบูุฑ ุจุงุณุชูุฑุงุฑ.  ููุชุบูุจ ุนูู ูุฐู ุงููุดููุฉ ุ ููููู ุงุณุชุฎุฏุงู ุงูููุงุฑุณ ูู "ูุคุดุฑุงุช" ุฅูู ุงููุงุฆูุฉ ุงููุฑุชุจุทุฉ ุ ูุฃู ุงูููุฑุณ ูุดูุฑ ุจุงุณุชูุฑุงุฑ ุฅูู ูุชุญุฉ ูุญุฏุฏุฉ ุญุชู ุนูุฏ ุฅุนุงุฏุฉ ุชูุฒูุน ุงูุตููู.  ุณูุชุญุฏุซ ุฃูุซุฑ ุนู ุฅุนุงุฏุฉ ุงูุชุฎุตูุต ูู ุงููุณู ุงูุชุงูู. <br><br>  ููููู ุชุฎุตูุต ูุณุงุญุฉ ูุนูุตุฑ ุฎุงุต ูู ุนููุงู ุงููุงุฆูุฉ ูู ุฎูุงู ุชุฎุฒููู ุฏุงุฆููุง ูู ูุชุญุฉ ุงูุตููู 0. <br><br>  ุณูุจุฏู ุงูุฑูุฒ ูุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// The objects that we want to store: typedef struct {...} object_t; // An item in the free list points to the next one. typedef struct { uint32_t next_free; } freelist_item_t; // Each item holds either the object data or the free list pointer. typedef union { object_t; freelist_item_t; } item_t; typedef struct { std::vector&lt;item_t&gt; items; } bulk_data_t; void delete_item(bulk_data_t *bd, uint32_t i) { // Add to the freelist, which is stored in slot 0. bd-&gt;items[i].next = bd-&gt;items[0].next; bd-&gt;items[0].next = i; } uint32_t allocate_slot(bulk_data_t *bd) { const uint32_t slot = bd-&gt;items[0].next; bd-&gt;items[0].next = bd-&gt;items[slot].next; // If the freelist is empty, slot will be 0, because the header // item will point to itself. if (slot) return slot; bd-&gt;items.resize(bd-&gt;items.size() + 1); return bd-&gt;items.size() - 1; }</span></span></code> </pre> <br>  ูุง ูู ุฃูุถู ุงุณุชุฑุงุชูุฌูุฉ ุฅุฒุงูุฉุ  ูู ุชุฑูุฏ ููู ุงูุนูุตุฑ ุงูุฃุฎูุฑ ุฅูู ูุชุญุฉ ูุงุฑุบุฉ ุ ูุน ุถูุงู ุงูุญุฒู ุงููุญูู ููุตููู ุฃู ุงูุงุญุชูุงุธ ุจุฌููุน ุงูุนูุงุตุฑ ูู ุฃูุงูููุง ูุน ุฅูุดุงุก "ูุชุญุงุช" ูู ุงููุตูููุฉ ุจุฏูุงู ูู ุงูุนูุตุฑ ุงููุญุฐููุ <br><br>  ุนูุฏ ุงุชุฎุงุฐ ูุฑุงุฑ ุ ูุฌุจ ูุฑุงุนุงุฉ ุฌุงูุจูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูููู ุงูุชูุฑุงุฑ ุนูู ุตููู ููุชุธ ุจุงูุณุฑุนุฉ ุฃุณุฑุน ูุฃููุง ูุชุฌุงูุฒ ุฐุงูุฑุฉ ุฃูู ูููุณ ุนูููุง ูุถุงุก ุงููุซูุฑ ูู ุงูููุช ูู ุชุฎุทู ุงููุชุญุงุช ุงููุงุฑุบุฉ. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ุงุณุชุฎุฏููุง ูุฌููุนุฉ ูุนุจุฃุฉ ุจุฅุญูุงู ุ ูุฅู ุงูุนูุงุตุฑ ุณูู ุชุชุญุฑู.  ูุฐุง ูุนูู ุฃูู ูุง ูููููุง ุงุณุชุฎุฏุงู ููุฑุณ ุนูุตุฑ ููุนุฑู ุซุงุจุช ูููุฑุงุฌุน ุงูุฎุงุฑุฌูุฉ ููุนูุงุตุฑ.  ุณูุชุนูู ุนูููุง ุชุนููู ูุนุฑู ูุฎุชูู ููู ุนูุตุฑ ูุงุณุชุฎุฏุงู ุฌุฏูู ุงูุจุญุซ ููุทุงุจูุฉ ูุฐู ุงููุนุฑูุงุช ุงูุซุงุจุชุฉ ูุน ูุคุดุฑุงุช ุงููุงุฆูุงุช ุงูุญุงููุฉ.  ูููู ุฃู ูููู ุฌุฏูู ุงูุจุญุซ ูุฐุง ุนุจุงุฑุฉ ุนู ุฌุฏูู ุชุฌุฒุฆุฉ ุฃู <code>std::vector</code> ูุน ุซููุจ ุ ููุง ูู ููุถุญ ุฃุนูุงู (ุงูุฎูุงุฑ ุงูุซุงูู ุฃุณุฑุน).  ูููู ูููุง ูุงู ุงูุฃูุฑ ุ ุณูุญุชุงุฌ ุฅูู ุฐุงูุฑุฉ ุฅุถุงููุฉ ููุฐุง ุงูุฌุฏูู ูุฎุทูุฉ ุฅุถุงููุฉ ุบูุฑ ูุจุงุดุฑุฉ ูููุนุฑูุงุช. </li></ul><br>  ุงุฎุชูุงุฑ ุงูุฎูุงุฑ ุงูุฃูุถู ูุนุชูุฏ ุนูู ูุดุฑูุนู. <br><br>  ููููู ุงูููู ุฅู ุชุฎุฒูู ุตููู ููุชุธ ุจุดูู ูุซูู ุฃูุฑ ุฃูุถู ุ ูุฃู ุงูุชูุฑุงุฑุงุช ุนูู ุฌููุน ุงูุนูุงุตุฑ (ูุชุญุฏูุซ ุงููุธุงู) ุชุญุฏุซ ุฃูุซุฑ ูู ูุทุงุจูุฉ ุงูุฑูุงุจุท ุงูุฎุงุฑุฌูุฉ.  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูููููุง ุฃู ูููู ุฃู ุฃุฏุงุก "ุตููู ูุน ุซููุจ" ูู ุฃุณูุฃ ููุท ูู ุญุงูุฉ ูุฌูุฏ ุนุฏุฏ ูุจูุฑ ูู ุงูุซููุจ ุ ููู ุชุทููุฑ ุงููุนุจุฉ ุนุงุฏุฉ ูุง ููุชู ุจุงูุฃุฏุงุก ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุณูุฃ ุงูุญุงูุงุช</a> (ูุฑูุฏ ุฃู ูููู ูุนุฏู ุงูุฅุทุงุฑุงุช 60 ูุฑุชุฒ ุ ุญุชู ุนูุฏูุง ูุชู ุชูููุฐ ุงูุญุฏ ุงูุฃูุตู ููุนูููุงุช ูู ุงููุนุจุฉ) .  ูู ุฃุณูุฃ ุงูุญุงูุงุช ุ ูุฏููุง ุงูุญุฏ ุงูุฃูุตู ูุนุฏุฏ ุงููุงุฆูุงุช ุงูุญููููุฉ ุ ููู ูุฐู ุงูุญุงูุฉ <em>ูู ุชููู ููุงู ุซููุจ</em> ูู ุงูุตููู.  ุชุญุฏุซ ุงูุซููุจ ููุท ุนูุฏูุง ููุฎูุถ โโุนุฏุฏ ุงููุงุฆูุงุช ุ ูุนูุฏูุง ูุญุฐู ุจุนุถ ูุฐู ุงููุงุฆูุงุช. <br><br>  ููุงู ุฃูุถูุง ุงุณุชุฑุงุชูุฌูุงุช ูููู ุงุณุชุฎุฏุงููุง ูุชุณุฑูุน ูุนุงูุฌุฉ ุงููุตูููุงุช ูุน ุงูุนุฏูุฏ ูู ุงูุซููุจ.  ุนูู ุณุจูู ุงููุซุงู ุ ูููููุง ุชุชุจุน ุฃุทูุงู ุงูุชุณูุณูุงุช ุงููุณุชูุฑุฉ ููุซููุจ ูุชุฎุทู ุชุณูุณูุงุช ุงูุซููุจ ุจุฃููููุง ูู ููุช ูุงุญุฏ ุ ุจุฏูุงู ูู ุนูุตุฑ ุนูุตุฑ.  ูุธุฑูุง ูุฃู ูุฐู ุงูุจูุงูุงุช ูุทููุจุฉ ููุท ูู "ุงูุซููุจ" ูููุณ ููุนูุงุตุฑ ุงูุนุงุฏูุฉ ุ ููููู ุชุฎุฒูููุง ูุน ูุคุดุฑ ูุงุฆูุฉ ุงูุฅุตุฏุงุฑ ูู ุงูุฐุงูุฑุฉ ุบูุฑ ุงููุฎุตุตุฉ ูููุงุฆูุงุช ูููุณ ุฅุถุงุนุฉ ุฐุงูุฑุฉ ุฅุถุงููุฉ. <br><br>  ูู ุฑุฃูู ุ ุฅุฐุง ูู ุชูู ุจุญุงุฌุฉ ุฅูู ุชุญุณูู ุงูุดูุฑุฉ ููุชูุฑุงุฑ ุงูุณุฑูุน ุ ููู ุงูุฃูุถู ุงุณุชุฎุฏุงู ุฎูุงุฑ "ุงูุตููู ูุน ุงูุซููุจ".  ุฅูู ุฃุจุณุท ููุง ูุญุชุงุฌ ุฅูู ููุงูู ุจุญุซ ุฅุถุงููุฉ ุ ูููููู ุงุณุชุฎุฏุงู ููุฑุณ ุงููุงุฆู ููุนุฑูู ูู ุ ููู ูุฑูุญ ููุบุงูุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูุคุฏู ุนุฏู ูุฌูุฏ ูุงุฆูุงุช ูุชุญุฑูุฉ ุฅูู ุฅุฒุงูุฉ ุงูุฃุฎุทุงุก ุงููุญุชููุฉ. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/781/6e3/91f/7816e391f0b8c68dede02d95dffa304f.jpg" width="100%"></div><br>  <i>ุงุณุชุฑุงุชูุฌูุงุช ุฅุฒุงูุฉ ุงูุจูุงูุงุช ุจุงูุฌููุฉ.</i> <br><br><h2 style=";text-align:right;direction:rtl">  ูุคุดุฑุงุช ุถุนููุฉ </h2><br>  ูููุงุญุธุฉ ุ ุณุฃููู ุฃูู ูู ุงูุณูู ุชูููุฐ ุฏุนู "ุงููุคุดุฑุงุช ุงูุถุนููุฉ" ุฃู "ุงููุงุตูุงุช" ููุงุฆูุงุช ุงูุจูุงูุงุช ุงููุจูุฑุฉ. <br><br>  <em>ููุซู ุงููุคุดุฑ ุงูุถุนูู</em> ุฅุดุงุฑุฉ ุฅูู ูุงุฆู ููููู ุจุทุฑููุฉ ูุง ุชุญุฏูุฏ ุฃู ุงููุงุฆู ุงูุฐู ูุดูุฑ ุฅููู ูุฏ ุชู ุญุฐูู.  ูุฑูุญุฉ ูู ุงููุคุดุฑุงุช ุงูุถุนููุฉ ูู ุฃููุง ุชุณูุญ ูู ุจุญุฐู ุงููุงุฆูุงุช ุฏูู ุงูููู ุจุดุฃู ูู ููููู ุงูุฑุฌูุน ุฅูููุง.  ุจุฏูู ูุคุดุฑุงุช ุถุนููุฉ ูุฅุฒุงูุฉ ูุงุฆู ูุง ุ ุณูุญุชุงุฌ ุฅูู ุงูุจุญุซ ุนู ูู ุฑุงุจุท ูุฑุฏู ูุฅุนูุงูู ุบูุฑ ุตุงูุญ.  ูุฏ ูููู ูุฐุง ุฃูุฑูุง ุตุนุจูุง ุจุดูู ุฎุงุต ุฅุฐุง ุชู ุชุฎุฒูู ุงูุฑูุงุจุท ูู ุฑูุฒ ุงูุจุฑูุงูุฌ ุงููุตู ุฃู ุนูู ุฃุฌูุฒุฉ ููุจููุชุฑ ุฃุฎุฑู ุนูู ุงูุดุจูุฉ ุ ุฅูุฎ. <br><br>  ุชุฐูุฑ ุฃู ูุฏููุง ุจุงููุนู ูุนุฑู ูุญุฏุฏ ุงููุงุฆูุงุช <em>ุงูููุฌูุฏุฉ</em> ุจุดูู ูุฑูุฏ.  ูู ุฎูุงุฑ "ูุน ุงูุซููุจ" ุ ูุฐุง ุงููุนุฑู ูู ุจุจุณุงุทุฉ ููุฑุณ ุงูุนูุตุฑ (ูุฃู ุงูุนูุงุตุฑ ูุง ุชุชุญุฑู ุฃุจุฏูุง).  ูู ุญุงูุฉ ุงููุตูููุงุช ูุซููุฉ ุงูุญุฒู ุ ูุนุฏ ููุฑุณ ุงููุงุฆู ูุฐุง ุณุฌูุงู ูู <em>ุตููู ุงูุจุญุซ</em> . <br><br>  ูุง ูููู ุงุณุชุฎุฏุงู ุงููุนุฑู ููุณู ููุคุดุฑ ุถุนูู ุ ูุฃูู ูููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงููุนุฑูุงุช.  ุฅุฐุง ุชู ุญุฐู ุนูุตุฑ ูุชู ุฅูุดุงุก ุนูุตุฑ ุฌุฏูุฏ ูู ููุณ ุงููุชุญุฉ ุ ููู ูุชููู ูู ูุนุฑูุฉ ุงูุฑูู ุงูุชุนุฑููู ูุญุฏู.  ููุญุตูู ุนูู ูุคุดุฑ ุถุนูู ุ ุชุญุชุงุฌ ุฅูู ุฏูุฌ ุงููุนุฑู ูุน ุญูู <code>generation</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> generation; } <span class="hljs-keyword"><span class="hljs-keyword">weak_pointer_t</span></span>;</code> </pre> <br>  ุญูู <code>generation</code> ูู ุญูู ูู ุจููุฉ ุงููุงุฆู ูุชุชุจุน ุนุฏุฏ ูุฑุงุช ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงู ุงููุชุญุฉ ูู ุตููู ุงูุจูุงูุงุช ุงููุฌูุนุฉ.  (ูู ุญุงูุฉ ุงูุชุบููู ุงููุญูู ุ ูุชุชุจุน ุนุฏุฏ ุงููุฑุงุช ุงูุชู ุฃุนูุฏ ูููุง ุงุณุชุฎุฏุงู ุงููุชุญุฉ ูู ุตููู <em>ุงูุจุญุซ</em> .) <br><br>  ุนูุฏูุง ุชููู ุจุญุฐู ุนูุตุฑ ุ ูุฅููุง ูุฒูุฏ ุฑูู ุงูุชูููุฏ ูู ุงููุชุญุฉ ุงูุฎุงุตุฉ ุจู.  ููุชุญูู ููุง ุฅุฐุง ูุงู ุงููุคุดุฑ ุงูุถุนูู ูุง ูุฒุงู ุตุงูุญูุง ุ ูุฅููุง ูุชุญูู ููุง ุฅุฐุง ูุงู <code>generation</code> ูู ุจููุฉ ุงููุคุดุฑ ุงูุถุนูู ูุทุงุจู ุชูููุฏ ุงููุงุตู ุงููุดุงุฑ ุฅููู ุจูุงุณุทุฉ <code>id</code> .  ุฅุฐุง ูุงูุช ูุชุทุงุจูุฉ ุ ููุง ูุฒุงู ุงููุงุฆู ุงููุตุฏุฑ ุงูุฐู ูุดูุฑ ุฅููู ููุฌูุฏูุง.  ุฅุฐุง ูู ููู ุงูุฃูุฑ ูุฐูู ุ ููุฐุง ูุนูู ุฃูู ูุฏ ุชู ุญุฐูู ุ ูุชููู ุงููุชุญุฉ ุฅูุง ูู ูุงุฆูุฉ ุงูุฅุตุฏุงุฑ ุ ุฃู ุชู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงููุง. <br><br>  ุถุน ูู ุงุนุชุจุงุฑู ุฃูู ูุธุฑูุง ูุฃู ุญูู <code>generation</code> ุถุฑูุฑู ููู ูู ุงูุซููุจ ูุงููุงุฆูุงุช ุงูููุฌูุฏุฉ ุ ููุฌุจ ุชุฎุฒููู ุฎุงุฑุฌ ุงูุงุชุญุงุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> generation; <span class="hljs-keyword"><span class="hljs-keyword">union</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">object_t</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">freelist_item_t</span></span>; }; } <span class="hljs-keyword"><span class="hljs-keyword">item_t</span></span>;</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  ุงุณุชุฑุงุชูุฌูุฉ ุงูุชูุฒูุน </h2><br>  ุฅุฐุง ููุช ุชุณุชุฎุฏู <code>std::vector</code> ูุชุฎุฒูู ุจูุงูุงุช ุงูุนูุงุตุฑ ุ ูุนูุฏ ุงูุชูุงุก ุงููุตูููุฉ ูุชุญุชุงุฌ ุฅูู ุฒูุงุฏุชูุง ุ ุณูุชู ุฅุนุงุฏุฉ ุชูุฒูุน ูุฌููุนุฉ ุงูุนูุงุตุฑ ุจุงููุงูู.  ูุชู ูุณุฎ ุงูุนูุงุตุฑ ุงูููุฌูุฏุฉ ุฅูู ุงูุตููู ุงูุฌุฏูุฏ. <br><br>  <code>std::vector</code> ูููู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><em>ููุฏุณูุง</em></a> .  ูุฐุง ูุนูู ุฃูู ูู ูู ูุฑุฉ ูุญุชุงุฌ ูููุง ุงููุชุฌู ุฅูู ุงูุฒูุงุฏุฉ ุ ูุชู ุถุฑุจ ุนุฏุฏ ุงูุนูุงุตุฑ ุงูููุฒุนุฉ ุจุนุงูู ูุง (ุนุงุฏุฉ ร 2).  ุงูููู ุงูููุฏุณู (ุงูุฃุณู) ููู ูุฃูู ูุญุงูุธ ุนูู ุชูุงููู ุฒูุงุฏุฉ ุงููุตูููุฉ ุงูุซุงุจุชุฉ. <br><br>  ุนูุฏ ุฅุนุงุฏุฉ ุชูุฒูุน ุงููุตูููุฉ ุ ูุญุชุงุฌ ุฅูู ููู ุฌููุน ุงูุนูุงุตุฑ ุ ูุงูุชู ุชุชุทูุจ <em>O (n)</em> .  ููุน ุฐูู ุ ูุน ููู ุงูุตููู ุ ูุถูู ูุณุงุญุฉ ูุนูุงุตุฑ <em>n</em> ุฃุฎุฑู ุ ูุฃููุง ูุถุงุนู ุงูุญุฌู.  ูุฐุง ูุนูู ุฃููุง ูู ูุญุชุงุฌ ุฅูู ุฒูุงุฏุฉ ุงูุตููู ูุฑุฉ ุฃุฎุฑู ุญุชู ูุถูู ุฅูููุง ุงููุฒูุฏ ูู ุงูุนูุงุตุฑ.  ุจูุนูู ุฃู ุชูุงููู ุงูุฒูุงุฏุฉ ุชุณุงูู <em>O (n)</em> ุ ููููุง ูููุฐูุง ููุท * O (n) * ูููุฑุฉ ุงูุชุงุณุนุฉ ูู ุงููุชุงุจุฉ ุฅูู ุงูุตููู ุ ุฃู ูู ุงููุชูุณุท โโุ ุชูููุฉ ูุชุงุจุฉ ุนูุตุฑ ูุงุญุฏ ูู <em>O (n) / O (n) = ูุง (1)</em> . <br><br>  ุชุณูู ุชูููุฉ ุชุณุฌูู ุนูุตุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><em>ุซุงุจุช ุซุงุจุช</em></a> ุ ูุฃูู ุฅุฐุง ููุช ุจูุชูุณุท โโุฌููุน ุงูุณุฌูุงุช ุงูุชู ูุชู ุชูููุฐูุง ุ ูุณูุชู ุชุญุฏูุฏ ุงูุชูุงููู.  ููุน ุฐูู ุ ูุง ููุจุบู ููุง ุฃู ููุณู ุฃูู ูุจู ุฃู ูููู ูู ุงููุชูุณุท โโุ ูุฅู ุงูุชูุงููู ุณุชููู ูุชููุจุฉ ููุบุงูุฉ.  ุจุนุฏ ูู ุณุฌูุงุช <em>O (n)</em> ุ ูุญุตู ุนูู ุฐุฑูุฉ ุงูุงุฑุชูุงุน <em>O (n)</em> : <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/1d0/331/5be/1d03315be5a0c1ad8096ac05f11c7893.jpg" width="100%"></div><br>  <i>ุชูููุฉ ุงููุชุงุจุฉ ุฅูู <code>std::vector</code> .</i> <br><br>  ููุฑู ุฃูุถูุง ูุง ูุญุฏุซ ุฅุฐุง ูู ูุณุชุฎุฏู ุงูููู ุงูููุฏุณู.  ูููุชุฑุถ ุฃูู ุจุฏูุงู ูู ูุถุงุนูุฉ ุงูุฐุงูุฑุฉ ุฃุซูุงุก ุงูููู ุ ุณูุถูู 128 ูุชุญุฉ ุฃุฎุฑู.  ูุง ูุฒุงู ููู ุงูุจูุงูุงุช ุงููุฏููุฉ ูููููุง <em>O (n)</em> ุ ููููุง ูุญุชุงุฌ ุงูุขู ุฅูู ุงูููุงู ุจุฐูู ูู 128 ุนูุตุฑูุง ูุถููู ุ ุฃู ุฃู ูุชูุณุท โโุงูุชูุงููู ุณูููู ุงูุขู <em>O (n) / O (128) = O (n)</em> .  ุชุชูุงุณุจ ุชูููุฉ ูุชุงุจุฉ ุนูุตุฑ ุฅูู ุตููู ูุน ุญุฌู ุงููุตูููุฉ ุ ูุฐูู ุนูุฏูุง ุชุตุจุญ ุงููุตูููุฉ ูุจูุฑุฉ ุ ุชุจุฏุฃ ูู ุงูุนูู ุจุณุฑุนุฉ ุณูุญูุงุฉ.  ุนููุง! <br><br>  ุงุณุชุฑุงุชูุฌูุฉ ุชูุฒูุน <code>std::vector</code> ูู ุฎูุงุฑ ููุงุณู ุฌูุฏ ุ ุชุนูู ุจุดูู ุฌูุฏ ูู ูุนุธู ุงูุญุงูุงุช ุ ููู ูุฏููุง ุจุนุถ ุงููุดุงูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุณุช "ุงููุทูุฃุฉ ุงูุซุงุจุชุฉ" ููุงุณุจุฉ ุชูุงููุง ููุจุฑุงูุฌ ูู ุงูููุช ุงููุนูู.  ุฅุฐุง ูุงู ูุฏูู ูุฌููุนุฉ ูุจูุฑุฉ ุฌุฏูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุฆุงุช ุงูููุงููู ูู ุงูุนูุงุตุฑ ุ ูุฅู ุฒูุงุฏุฉ ูุฐู ุงููุฌููุนุฉ ูููู ุฌููุน ุงูุนูุงุตุฑ ูููู ุฃู ูุณุจุจ ุชุจุงุทุคูุง ููุญูุธูุง ูู ูุนุฏู ุงูุฅุทุงุฑุงุช.  ูุฐุง ูู ูุดููุฉ ูููุณ ุงูุณุจุจ ุฌูุน ุงูููุงูุฉ ูุดููุฉ ูู ุงูุฃูุนุงุจ.  ูุง ููู ูุฏู ุงูุฎูุงุถ ูุชูุณุท โโุงูุชูุงููู ุ ุฅุฐุง ูุงูุช ุงูุชูุงููู ูู ุจุนุถ ุงูุฅุทุงุฑุงุช ูููู ุฃู ุชุฑุชูุน ุ ููุง ุชุณุจุจ ูู ุฎูู ูู ุงููุนุจุฉ. </li><li style=";text-align:right;direction:rtl">  ูุจุงููุซู ุ ูุฅู ุฅุณุชุฑุงุชูุฌูุฉ ุงูุชุฎุตูุต ูุฐู ูู ุญุงูุฉ ุงูุตูุงุฆู ุงููุจูุฑุฉ ูููู ุฃู ุชูุฏุฑ ุงููุซูุฑ ูู ุงูุฐุงูุฑุฉ.  ูููุชุฑุถ ุฃู ูุฏููุง ูุฌููุนุฉ ููููุฉ ูู 16 ููููู ุนูุตุฑ ููุญุชุงุฌ ุฅูู ูุชุงุจุฉ ุนูุตุฑ ุขุฎุฑ ููู.  ููุฐุง ุณูุฌุนู ูุฌููุนุฉ ุชููู ุฅูู 32 ููููู ุฏููุงุฑ.  ุงูุขู ูุฏููุง 16 ููููู ุนูุตุฑ ูู ุงููุฌููุนุฉ ุงูุชู ูุง ูุณุชุฎุฏููุง.  ุจุงููุณุจุฉ ูููุตุฉ ุฐุงุช ุฐุงูุฑุฉ ููุฎูุถุฉ ุ ูุฐุง ูุซูุฑ. </li><li style=";text-align:right;direction:rtl">  ุฃุฎูุฑูุง ุ ูููู ุฅุนุงุฏุฉ ุงูุชุฎุตูุต ุจููู ุงููุงุฆูุงุช ูู ุงูุฐุงูุฑุฉ ุ ููุง ูุคุฏู ุฅูู ุฅุจุทุงู ุฌููุน ุงููุคุดุฑุงุช ุฅูู ุงููุงุฆูุงุช.  ูููู ุฃู ูููู ูุฐุง ูุตุฏุฑูุง ููุฃุฎุทุงุก ุงูุชู ูุตุนุจ ุชุชุจุนูุง. </li></ul><br>  ุงูุชุนูููุฉ ุงูุจุฑูุฌูุฉ ุฃุฏูุงู ูุซุงู ุนูู ุงูุฃุฎุทุงุก ุงูุชู ูููู ุฃู ุชุญุฏุซ ุนูุฏ ููู ุงููุงุฆูุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Create two items and return the sum of their costs. float f(bulk_data_t *bd) { const uint32_t slot_1 = allocate_slot(bd); item_t *item_1 = &amp;bd-&gt;items[slot_1]; const uint32_t slot_2 = allocate_slot(bd); item_t *item_2 = &amp;bd-&gt;items[slot_2]; return item_1-&gt;cost + item_2-&gt;cost; }</span></span></code> </pre> <br>  ุงููุดููุฉ ููุง ูู ุฃู ุฏุงูุฉ <code>item_2</code> <code>allocate_slot()</code> ูุฏ ุชุญุชุงุฌ ุฅูู ุฅุนุงุฏุฉ ุชูุฒูุน ุงูุตููู ูุฅูุดุงุก ูุณุงุญุฉ ูู <code>item_2</code> .  ูู ูุฐู ุงูุญุงูุฉ ุ ุณูุชู ููู <code>item_1</code> ุฅูู ุงูุฐุงูุฑุฉ <code>item_1</code> ุงููุคุดุฑ ุฅูู <code>item_1</code> ุตุงูุญูุง.  ูู ูุฐู ุงูุญุงูุฉ ุจุงูุฐุงุช ุ ูููููุง ุงูุชุฎูุต ูู ุงูุฎุทุฃ ุนู ุทุฑูู ููู ุงูุนูุตุฑ <code>item_1</code> ุ ูููู ูุฏ ุชุธูุฑ ุงูุฃุฎุทุงุก ุงููุดุงุจูุฉ ุจุดูู ุบูุฑ ูุญุณูุณ.  ุดุฎุตูุง ุ ููุฏ ุนุถููู ุนุฏุฉ ูุฑุงุช. <br><br>  ูุซู ูุฐุง ุงููููู ูู ุงูุบุฏุฑ ูู ุญูููุฉ ุฃู ุงูุฎุทุฃ ุณูู ูุฎุฑุฌ ููุท ุนูุฏูุง ูุชู ุฅุนุงุฏุฉ ุชูุฒูุน ูุฌููุนุฉ ุจุงูุถุจุท ูู ูุญุธุฉ <code>slot_2</code> .  ูููู ููุจุฑูุงูุฌ ุงูุนูู ุจุดูู ุตุญูุญ ููุชุฑุฉ ุทูููุฉ ุญุชู ูุบูุฑ ุดูุก ููุท ุงูุชูุฒูุน ุ ูุจุนุฏ ุฐูู ุณูู ูุนูู ุงูุฎุทุฃ. <br><br>  ูู ูุฐู ุงููุดุงูู ูููู ุญููุง ุจุงุณุชุฎุฏุงู ุงุณุชุฑุงุชูุฌูุฉ ุชูุฒูุน ูุฎุชููุฉ.  ูููุง ููู ุจุนุถ ุงูุฎูุงุฑุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">       : 16, 32, 64, โฆ,  <em></em>     . ,  16     ,  32   ,  .โฆ     ,         <code>std::vector</code> . </li><li style=";text-align:right;direction:rtl">           ,     .       ,       .               . ,           <em>O(n)</em>  <code>push()</code> ,        . </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">       </a> ,      ,   ,     ,   . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃูุฑุฑ ุ ูู ุทุฑููุฉ ููุง ูุฒุงูุงูุง ูุนููุจูุง. ูุฐุง ุงูุฃุฎูุฑ ุฌูุฏ ูุฃู ุงูุนูุงุตุฑ ูุง ุชุฒุงู ูุฎุฒูุฉ ูู ุงูุฐุงูุฑุฉ ุจุฌุงูุจ ุจุนุถูุง ุงูุจุนุถ ุ ููุญู ุจุญุงุฌุฉ ุฅูู ุชุชุจุน ูุฎุฒู ูุคูุช ูุงุญุฏ ุ ูุฐูู ููุณุช ููุงู ุญุงุฌุฉ ุฅูู ูุงููุงุช ุฃู ููุงุฆู ุฅุถุงููุฉ. ูุชุทูุจ ุถุจุท ุงูุญุฏ ุงูุฃูุตู ูุญุฌู ุงููุตูููุฉ ุ ููู ูุณุงุญุฉ ุงูุนูุงููู ุงูุงูุชุฑุงุถูุฉ ูุจูุฑุฉ ููุบุงูุฉ ุจุญูุซ ููููู ุนุงุฏุฉ ุชุญุฏูุฏ ุฃู ุนุฏุฏ ูุจูุฑ ุฏูู ุฃุฏูู ูุดููุฉ.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ูู ุชุชููู ูู ุงุณุชุฎุฏุงู ุญู ูุน ุงูุฐุงูุฑุฉ ุงูุธุงูุฑูุฉ ุ ููุง ุงูููุฌ ุงูุฐู ุณูููู ุฃูุถู - ุญุฌู ุซุงุจุช ุฃู ูุชู ูุน ููู ููุฏุณูุ ุฅุฐุง ูุงูุช ุงููุตูููุฉ ุตุบูุฑุฉ ุฌุฏูุง ุ ูุฅู ุงูุญุฌู ุงูุซุงุจุช ูููู ุงููุซูุฑ ูู ุงูุฐุงูุฑุฉ ุงูุฅุถุงููุฉ. ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ุญุฌู ุงููุชูุฉ ูุจูุบ 16 ุฃูู ุนูุตุฑ ุ ูุฅูู ุชุณุชุฎุฏู ูู ูุฐู ุงูุนูุงุตุฑ ุงูุจุงูุบ ุนุฏุฏูุง 16 ุฃูู ุนูุตุฑ ุ ุญุชู ุฅุฐุง ูุงู ููุงู ุนูุตุฑ ูุงุญุฏ ููุท ูู ุงููุตูููุฉ. ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุน ุงูููู ุงูููุฏุณู ุ ุณูู ุชูุฏุฑ ุงูุฐุงูุฑุฉ ุจูุตูููุฉ ูุจูุฑุฉ ุฌุฏูุง ุ ูุฃูู ูู ุงููุชูุณุท โโุณุชููู ุงููุชูุฉ ุงูููุฒุนุฉ ุงูุฃุฎูุฑุฉ ููุชูุฆุฉ ุจูุณุจุฉ 50ูช. ููุฌููุนุฉ ูุจูุฑุฉ ุ ูููู ุฃู ูููู ูุฐุง ุงูุนุฏูุฏ ูู ููุบุงุจุงูุช. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุฃููู ูุฑุฉ ุฃุฎุฑู ุฃูู ูู ุงูููู ูู ุชุทููุฑ ุงูุฃูุนุงุจ ุชุญุณูู ุงูููุฏ ูู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฃุณูุฃ ุงูุญุงูุงุช</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุ ูุฐูู ูุณุช ููููุง ุฌุฏูุง ูู ุฅุถุงุนุฉ ุงูุฐุงูุฑุฉ ุนูู ุงููุตูููุงุช ุงูุตุบูุฑุฉ ุ ุฅุฐุง ูุงูุช ุงููุตูููุงุช ุงููุจูุฑุฉ ุชุธูุฑ ุฏุงุฆููุง ุฃุฏุงุกู ุฌูุฏูุง. ูู ูุชุฌุงูุฒ ุฅุฌูุงูู ุญุฌู ุงูุฐุงูุฑุฉ ุงูููุฏุฑุฉ ุฃุจุฏูุง * 16 K * n * ุ ุญูุซ </font><font style="vertical-align: inherit;">ููุซู </font></font><em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนุฏุฏ ุตูุงุฆู ุงูุจูุงูุงุช ุงููุฌูุนุฉ ุงููููุตูุฉ ูู ุงููุดุฑูุน ุ ููุง ุฃุนุชูุฏ ุฃูู ุณูููู ูุฏููุง ุงูุนุฏูุฏ ูู ุงููุตูููุงุช ุงููุฎุชููุฉ (ุจุถุน ูุทุน ููุท ููู ูุธุงู). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุชู ุฐุงุช ุงูุญุฌู ุงูุซุงุจุช ููุง ููุฒุชุงู ุฃุฎุฑูุงู. ุฃููุงู ุ ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ููุนุซูุฑ ุนูู ุนูุตุฑ ูู ุฎูุงู ููุฑุณู ุฃุจุณุท ุ ุฅููุง ููุท </font></font><code>blocks\[i / elements_per_block\][i % elements_per_block]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุซุงููุงู ุ ูููู ุชุฎุตูุต ุงูุฐุงูุฑุฉ ูุจุงุดุฑุฉ ูู ุงูุฐุงูุฑุฉ ุงูุธุงูุฑูุฉ ุฃูุซุฑ ูุนุงููุฉ ูู ุงููุตูู ุฅูู ูุฎุตุต ุฏููุงูููู (ูุฎุตุต ุงููููุฉ) ุ ุจุณุจุจ ุนุฏู ูุฌูุฏ ุชุฌุฒุฆุฉ.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงูุฎุชุงู ุ ุฃุฑูุฏ ุฃู ุฃููู ุฅูู ุฅุฐุง ุงุณุชุฎุฏูุช ุฎูุงุฑ "ูุน ุซููุจ" ูุชุฎุฒูู ุงูุจูุงูุงุช ุ ูุฃุนุชูุฏ ุฃูู ูุฌุฏุฑ ุงูุงุจุชุนุงุฏ ุนู ุงุณุชุฑุงุชูุฌูุฉ ุงูุชูุฒูุน </font></font><code>std::vector</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุญุชู ุชุญุตู ุงููุงุฆูุงุช ุนูู ูุคุดุฑุงุช ุซุงุจุชุฉ ูุง ุชุชุบูุฑ ุฃุจุฏูุง. </font><font style="vertical-align: inherit;">ุนูู ุงูุฃุฑุฌุญ ุ ุณุชููู ูุฌููุนุฉ ูุจูุฑุฉ ูู ุงูุฐุงูุฑุฉ ุงูุธุงูุฑูุฉ ูู ุงูุญู ุงูุฃูุถู ุ ูููู ุฅุฐุง ูู ุชุชููู ูู ุชูููุฐูุง ุ ูุฅู ุงูุฎูุงุฑ ุงูุฃูุถู ุงูุซุงูู ูู ุชุณูุณู ูุชู ุฐุงุช ุญุฌู ุซุงุจุช.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุญุธ ุฃูู ูุธุฑูุง ูุฃู ูุฐุง ุงูุฃุณููุจ ูุฌุนู ุงููุคุดุฑุงุช ุฅูู ุงููุงุฆูุงุช ุฏุงุฆูุฉ ุ ุจุงูุฅุถุงูุฉ ุฅูู ูุนุฑูุงุช ุงูุขู ุ ูููููุง ุงุณุชุฎุฏุงู ุงููุคุดุฑุงุช ุฅูู ุงููุงุฆูุงุช ููุฅุดุงุฑุฉ ุฅูู ุงููุงุฆูุงุช. </font><font style="vertical-align: inherit;">ููุฒุฉ ุฐูู ูู ุฃูู ูููููุง ุงููุตูู ุฅูู ุงููุงุฆูุงุช ูุจุงุดุฑุฉู ุ ุฏูู ุฅุฌุฑุงุก ุนูููุงุช ุจุญุซ ูู ุงูููุฑุณ. </font><font style="vertical-align: inherit;">ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุญุชุงุฌ ุงููุคุดุฑ ุฅูู 64 ุจุช ูู ุงูุฐุงูุฑุฉ ุ ูุนุงุฏุฉ ูุง ูููู 32 ุจุช ูุงูู ูููุฑุณ (4 ูููุงุฑุงุช ูุงุฆู ูุซูุฑ).</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/98e/f31/c3d/98ef31c3d3388db45f0897c9a390ce5d.jpg" width="100%"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชุฑุงุชูุฌูุงุช ุงูุชูุฒูุน</font></font></i> <br><br><h2 style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฌููุนุฉ ูู ุงูููุงูู ูุงูุจููุฉ ูุฌููุนุฉ </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฑุงุฑ ุงูุชุตููู ุงูููู ุงูุขุฎุฑ ูู ุงูุงุฎุชูุงุฑ ุจูู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌููุนุฉ ูู ุงูููุงูู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Array of Structuresุ AoS) </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููููู ุงูุตููู</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (Structure of Arraysุ SoA). </font><font style="vertical-align: inherit;">ุงููุฑู ูู ุฃูุถู ูุซุงู ุนูู ุฐูู. </font><font style="vertical-align: inherit;">ูููุชุฑุถ ุฃู ูุฏููุง ูุธุงููุง ูุงุญุฏูุง ููุฌุณููุงุช ูููู ููุฌุณููุงุช ููู ุนูุฑ ูููุถุน ูุณุฑุนุฉ ูููู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t; <span class="hljs-keyword"><span class="hljs-keyword">vec3_t</span></span> pos; <span class="hljs-keyword"><span class="hljs-keyword">vec3_t</span></span> vel; <span class="hljs-keyword"><span class="hljs-keyword">vec3_t</span></span> col; } <span class="hljs-keyword"><span class="hljs-keyword">particle_t</span></span>;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุทุฑููุฉ ุงููุนุชุงุฏุฉ ูุชุฎุฒููู ูู ูุถุน ุงูุนุฏูุฏ ูู ูุฐู ุงูููุงูู ูู ุตููู. </font><font style="vertical-align: inherit;">ููุฐุง ุงูุณุจุจ ูุณูููุง "ูุฌููุนุฉ ูู ุงูููุงูู". </font><font style="vertical-align: inherit;">ูุฐุง ูู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> num_particles; <span class="hljs-keyword"><span class="hljs-keyword">particle_t</span></span> *particles;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุจุงูุทุจุน ุ ุจุฏูุงู ูู ุงููุตูููุฉ ุงููุนุชุงุฏุฉ ุ ููููู ุงุณุชุฎุฏุงู ุฃู ูู ุงูุงุณุชุฑุงุชูุฌูุงุช ุงููุฐููุฑุฉ ุฃุนูุงู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุชุบูุฑ ุจููุฉ ุงูุตููู (SoA) ุ ูุณุชุฎุฏู ุตููููุง ูููุตููุง ููู ูุฌุงู ูู ูุฌุงูุงุช ุงูุจููุฉ:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> num_particles; <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *t; <span class="hljs-keyword"><span class="hljs-keyword">vec3_t</span></span> *pos; <span class="hljs-keyword"><span class="hljs-keyword">vec3_t</span></span> *vel; <span class="hljs-keyword"><span class="hljs-keyword">vec3_t</span></span> *col; } particles;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุงููุงูุน ุ ูููููุง ุฃู ูุฐูุจ ุฃุจุนุฏ ูู ุฐูู ุ ูุฃูู </font></font><code>vec3_t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ุญุฏ ุฐุงุชู ูููู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> num_particles; <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *t; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *pos_x; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *pos_y; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *pos_z; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *vel_x; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *vel_y; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *vel_z; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *col_r; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *col_g; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> *col_b; } particles;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุจุฏู ูุฐุง ุฃูุซุฑ ุชุนููุฏูุง ูู ูุฎุทุท AoS ุงูุฃุตูู ุ ูููุงุฐุง ูุนุฏ ุถุฑูุฑููุง ุญููุงุ </font><font style="vertical-align: inherit;">ููุงู ุญุฌุฉ ุงุซููู ูุฏุนู ูุฐุง ุงูููุฌ:</font></font><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุนูู ุจุนุถ ุงูุฎูุงุฑุฒููุงุช ููุท ูุน ูุฌููุนุฉ ูุฑุนูุฉ ูู ุงูุญููู. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ </font></font><code>tick()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุคุซุฑ </font><font style="vertical-align: inherit;">ุงูุฎูุงุฑุฒููุฉ </font><font style="vertical-align: inherit;">ุนูู ุญูู ููุท </font></font><code>t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ุงูุฎูุงุฑุฒููุฉ </font></font><code>simulate_physics()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุชุคุซุฑ ููุท ุนูู ุงูุญููู </font></font><code>pos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ู </font></font><code>vel</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">ูู ูุฎุทุท SoA ุ ูุชู ุชุญููู ุฃุฌุฒุงุก ูุนููุฉ ููุท ูู ุงูุจููุฉ ูู ุงูุฐุงูุฑุฉ. </font><font style="vertical-align: inherit;">ุฅุฐุง ููุง </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูููุฏูู ุจุงูุฐุงูุฑุฉ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ุงูุชู ุบุงูุจุงู ูุง ุชููู ูุน ุงููุนุงูุฌุงุช ุงูุญุฏูุซุฉ) ุ ูุฅู ูุฐุง ูุฏ ูููู ูู ุชุฃุซูุฑ ูุจูุฑ. </font><font style="vertical-align: inherit;">ุนูู ุณุจูู ุงููุซุงู ุ </font></font><code>tick()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุชุคุซุฑ </font><font style="vertical-align: inherit;">ุงููุธููุฉ </font><font style="vertical-align: inherit;">ุนูู 1/10 ููุท ูู ุงูุฐุงูุฑุฉ ุ ููุง ูุนูู ุฃููุง ุชุญุตู ุนูู ุชุณุงุฑุน 10 ูุฑุงุช.</font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุณูุญ ููุง ูุฎุทุท SoA ุจุชุญููู ุงูุจูุงูุงุช ูุจุงุดุฑุฉ ุฅูู ุณุฌูุงุช </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SIMD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููุนุงูุฌุฉ. </font><font style="vertical-align: inherit;">ูููู ุฃู ูููู ููุฐุง ุชุฃุซูุฑ ูุจูุฑ ุฅุฐุง </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุชุตุฑูุง</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุนูู </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">FPUs</font></a><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">ุจุงุณุชุฎุฏุงู </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AVX ุ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููููุง ูุนุงูุฌุฉ ุซูุงููุฉ ุฃุฑูุงู ุชุนููู ูู ููุช ูุงุญุฏ ุ ููุง ูุนุทู ุชุณุงุฑุน 8 ูุฑุงุช.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐุง ูุนูู ุฃูู ูุน ูุฐู ุงูุชุณุงุฑุน </font></font><code>tick()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูู ูุตุจุญ 80 ุฃุณุฑุนุ</font></font> ูุง.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณูุญุตู ุนูู ุงูุชุณุงุฑุน ุงูุฃูู 10 ูุฑุงุช ููุท ุฅุฐุง ูุงูุช ุงูุฐุงูุฑุฉ ูุญุฏูุฏุฉ ุชูุงููุง ุ ูุฅุฐุง ูุงูุช ุงูุฐุงูุฑุฉ ูุญุฏูุฏุฉ ุชูุงููุง ุ ููู ุชุชููู SIMD ูู ุงูุณูุงุญ ููุง ุจุงูุนูู ุจุดูู ุฃุณุฑุน. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุนููุจ ููุฌ ุงูุฎุฏููุฉ:</font></font><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุงูุฑูุฒ ูุฒุฏุงุฏ ุตุนูุจุฉ. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฒูุฏ ูู ุงูุถุบุท ุนูู ุงูููุฒุน ุ ูุฃููุง ุจุญุงุฌุฉ ุฅูู ุชูุฒูุน ุตูููุงุช ูููุตูุฉ ุจุฏูุงู ูู ููุทุฉ ูุงุญุฏุฉ. </font></font></li><li style=";text-align:right;direction:rtl">           <code>particle_t *</code> ,         .      . </li><li style=";text-align:right;direction:rtl">           ,            </li><li style=";text-align:right;direction:rtl">             ( ),  <em></em>   .     <em>  </em> ,     . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุซุงู ุนูู ุฃู ููุน ูู ุงููุดุงูู ูููู ุฃู ุชูุดุฃ ูุน ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุ ุชุฐูุฑ ุฌุฒูุฆุงุช ุงูุจููุฉ ุงูููุถุญุฉ ุฃุนูุงู ูุชุฎูู ุฃููุง ุฎุตุตูุง ุฌููุน ุงููุตูููุงุช ุจุงุณุชุฎุฏุงู VM (ุฃู ุฃููุง ูุญุงุฐุงุฉ ุนูู ุญุฏูุฏ ุตูุญุฉ ูู ุฃุฑุจุนุฉ ููููุจุงูุช). ูุจุณุจุจ ูุฐุง ุงููุญุงุฐุงุฉ ุ ุณูุชู ุฑุจุท ุฌููุน ุงูุญููู ุงูุนุดุฑุฉ ููุฌุณููุงุช ุงููููููุฉ ุจูุชูุฉ ุฐุงูุฑุฉ ุชุฎุฒูู ูุคูุช ูุงุญุฏุฉ. ุฅุฐุง ูุงูุช ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุชุนุฏุฏุฉ ุงููููุงุช 8 ูููุงุช ุ ููุฐุง ูุนูู ุฃู ุฌููุน ุญููู ุงูุฌุณูู ูุง ูููู ุฃู ุชููู ูู ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูู ููุณ ุงูููุช. ุนููุง! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุทุฑููุฉ ูุงุญุฏุฉ ูุญู ูุฐู ุงููุดููุฉ ูู ุชุฌููุน ุงูุฌุฒูุฆุงุช ุญุณุจ ุญุฌู ูุงูู SIMD. ุนูู ุณุจูู ุงููุซุงู ุ ูููููุง ุงูููุงู ุจูุง ููู:</font></font><br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">uint32_t</span></span> num_particles; <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> t[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> position_x[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> position_y[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> position_z[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> velocity_x[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> velocity_y[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> velocity_z[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> color_r[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> color_g[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> color_b[<span class="hljs-number"><span class="hljs-number">8</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">eight_particles_t</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">eight_particles_t</span></span> *particles;</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐุง ุงููุฎุทุท ุ ูุง ูุฒุงู ุจุฅููุงููุง ุงุณุชุฎุฏุงู ุฅุฑุดุงุฏุงุช SIMD ููุนุงูุฌุฉ ุซูุงูู ุฌุณููุงุช ูู ููุช ูุงุญุฏ ุ ููู ุญููู ุงูุฌุณููุงุช ูุงุญุฏุฉ ูุฑูุจุฉ ุฌุฏูุง ูู ุงูุฐุงูุฑุฉ ูููุณ ูุฏููุง ุฃู ูุดุงูู ูุน ุชุตุงุฏูุงุช ุฎุท ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุชู ุธูุฑุช ุณุงุจููุง. ูุฐุง ุฃูุถู ุจุงููุณุจุฉ ููุธุงู ุงูุชูุฒูุน ุ ูุฃููุง ุนุฏูุง ุฅูู ุชูุฒูุน ูุงุญุฏ ููู ูุฌููุนุฉ ูุงููุฉ ูู ุงูุฌุฒูุฆุงุช. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูู ูุฐู ุงูุญุงูุฉ ุ </font></font><code>tick()</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุชุคุซุฑ </font><font style="vertical-align: inherit;">ุงูุฎูุงุฑุฒููุฉ </font><font style="vertical-align: inherit;">ุนูู 32 ุจุงูุช ุ ูุชุฎุทู 288 ุจุงูุช ุ ูุชุคุซุฑ ุนูู 32 ุจุงูุช ุ ุฅูุฎ. ูุฐุง ูุนูู ุฃููุง ูู ูุญุตู ุนูู ุชุณุงุฑุน ูุงูู 10x ุ ููุง ูู ุญุงูุฉ ูุฌููุนุฉ ูููุตูุฉ</font></font><code>t</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. ุฃููุงู ุ ุนุงุฏุฉ ูุง ูููู ุญุฌู ุฎุทูุท ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช 64 ุจุงูุช ุ ูุจูุง ุฃููุง ูุณุชุฎุฏู ูุตู ููุท ุ ููุง ูููููุง ุชุณุฑูุน ุฃูุซุฑ ูู 5 ูุฑุงุช. ุฃูุถูุง ุ ูุฏ ุชุญุฏุซ ุงูุชูุงููู ุงููุฑุชุจุทุฉ ุจุชุฎุทู ูุญุฏุงุช ุงูุจุงูุช ุ ุญุชู ูู ุนุงูุฌูุง ุฎุทูุท ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงููุงููุฉ ุ ููููู ูุณุช ูุชุฃูุฏูุง ุจูุณุจุฉ 100ูช ูู ุฐูู. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุญู ูุฐู ุงููุดููุฉ ุ ููููู ุชุฌุฑุจุฉ ุญุฌู ุงููุฌููุนุฉ. ุนูู ุณุจูู ุงููุซุงู ุ ููููู ุชุบููุฑ ุญุฌู ูุฌููุนุฉ </font></font><code>[16]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅูู ุญูู ุชุนููู ูุงุญุฏ ูููุฃ ุณุทุฑ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุจุงููุงูู. ุฃู ุ ุฅุฐุง ููุช ุชุณุชุฎุฏู ุทุฑููุฉ ุชุฎุตูุต ุงููุชูุฉ ุ ููููู ุจุจุณุงุทุฉ ุชุนููู ุฃู ุญุฌู ููุงุณุจ ุงููุชูุฉ ูุญุฌู ุงููุฌููุนุฉ:</font></font><br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/df8/7a2/558/df87a25586d4afb93a536585a84defef.png" width="100%"></div><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงูุฎุฏูุงุช ุงูุฅุฏุงุฑูุฉ ู ุงูุฎุฏููุฉ.</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุจุงููุณุจุฉ ูุงุณุชุฑุงุชูุฌูุฉ ุงูุญุฐู ุ ูุฅู SoA ููุณ ุงูุฎูุงุฑ ุงูุฃูุถู ูุฎูุงุฑ "with holes" ุ ูุฃูู ุฅุฐุง ุงุณุชุฎุฏููุง SIMD ููุนุงูุฌุฉ ุซูุงููุฉ ุนูุงุตุฑ ูู ููุณ ุงูููุช ุ ููู ูููู ูุงุฏุฑูู ุนูู ุชูููุช ุงูุซููุจ ุจุฃู ุทุฑููุฉ (ูุง ูู ุชูู ุงูุนูุงุตุฑ ุงูุซูุงููุฉ "ุซููุจ") . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุธุฑูุง ูุฃู ุชุนูููุงุช SIMD ุชุนุงูุฌ "ุงูุซููุจ" ุจููุณ ุทุฑููุฉ ูุนุงูุฌุฉ ุงูุจูุงูุงุช ุงูุญููููุฉ ุ ูุญุชุงุฌ ุฅูู ุงูุชุฃูุฏ ูู ุงุญุชูุงุก ุงูุซููุจ ุนูู ุจูุงูุงุช "ุขููุฉ". ุนูู ุณุจูู ุงููุซุงู ุ ูุง ูุฑูุฏ ุฃู ุชุณุจุจ ุนูููุงุช ุงููุชุญุงุช </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงุณุชุซูุงุกุงุช ูู ุนูููุงุช </font></font></a><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุงููุงุตูุฉ </font></font></a><font style="vertical-align: inherit;"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ุงูุนุงุฆูุฉ</font></a><font style="vertical-align: inherit;"> ุฃู ูุฅูุดุงุก </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">ุฃุฑูุงู ุฏูู ุทุจูุนูุฉ</font></a><font style="vertical-align: inherit;"> ุชููู ูู ุงูุฃุฏุงุก. ุฃูุถุง ุ ูุง ููุจุบู ููุง ุฃู ูุญุชูุธ ุงููุคุดุฑ</font></font><code>next</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฆูุฉ ุฅุตุฏุงุฑ ุจุงุณุชุฎุฏุงู ุงูุงุชุญุงุฏ ูุฃู ุนูููุงุช SIMD ุณุชุญู ูุญูู. </font><font style="vertical-align: inherit;">ุจุฏูุงู ูู ุฐูู ุ ุงุณุชุฎุฏู ุญูู ุงูุจููุฉ. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุฅุฐุง ุงุณุชุฎุฏููุง ุงูุฎูุงุฑ ุงูููุชุธ ุจูุซุงูุฉ ุ ูุณูููู ุงูุญุฐู ุฃุนูู ุชูููุฉ ุจุนุถ ุงูุดูุก ุ ูุฃูู ูุชุนูู ุนููู ููู ูู ุญูู ุนูู ุญุฏุฉ ุ ูููุณ ุจููุฉ ูุงููุฉ ูู ููุช ูุงุญุฏ. </font><font style="vertical-align: inherit;">ูููู ูุธุฑูุง ูุฃู ุงูุฅุฒุงูุฉ ุฃุตุนุจ ุจูุซูุฑ ูู ุงูุชุญุฏูุซุงุช ุ ููู ุชููู ูุฐู ูุดููุฉ ูุจูุฑุฉ.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ููุงุฑูุฉ AoS ู SoA ุ ุฃุณุชุทูุน ุฃู ุฃููู ุฃูู ูู ูุนุธู ุงูุญุงูุงุช ุ ูุฅู ุชุญุณูู ุงูุฃุฏุงุก ูุง ูุณุชุญู ุนูุงุก ูุชุงุจุฉ ุฑูุฒ ุฃูุซุฑ ุชุนููุฏูุง. </font><font style="vertical-align: inherit;">ุฃูุฏ ุงุณุชุฎุฏุงูู ูุชูุณูู ุชุฎุฒูู "ููุงุณู" ูุฃูุธูุฉ AoS ูุงูุชุญูู ุฅูู SoA ููุฃูุธูุฉ ุงูุชู ุชุชุทูุจ ุณุฑุนุงุช ุญูุณุจุฉ SIMD ุ ูุซู ุฃูุธูุฉ ุงููุทุน ูุงูุฌุฒูุฆุงุช. </font><font style="vertical-align: inherit;">ูู ูุซู ูุฐู ุงูุญุงูุงุช ุ ูุณุฑุนุฉ ูุตูู ุ ุฑุจูุง ุงุฎุชุฑุช ุตูุงุฆู ูุนุจุฃุฉ ุจุดูู ูุซูู.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุฌุฏุฑ ุงููุธุฑ ูู ุฎูุงุฑ ุขุฎุฑ - ุชุฎุฒูู ุงูุจูุงูุงุช ูู AoS ูุฅูุดุงุก ุจูุงูุงุช SOA ูุคูุชุฉ ูููุนุงูุฌุฉ ุจูุงุณุทุฉ ุจุนุถ ุงูุฎูุงุฑุฒููุงุช. ุนูู ุณุจูู ุงููุซุงู ุ ุฃูุฏ ุฃู ุฃููู ุจุชูุฑูุฑ ูุงุญุฏ ุนูู ุจูุงูุงุช AoS ูุฃู ุฃูุชุจูุง ุฅูู ูุฎุฒู ูุคูุช ูุคูุช ูู SOA ุ ููู ุจูุนุงูุฌุฉ ูุฐุง ุงููุฎุฒู ุงููุคูุช ุ ุซู ุฃุนุฏ ูุชุงุจุฉ ุงููุชุงุฆุฌ ูุฑุฉ ุฃุฎุฑู ุนูู ุฃููุง AoS (ุนูุฏ ุงูุถุฑูุฑุฉ). ุจูุง ุฃููู ูู ูุฐู ุงูุญุงูุฉ ุฃุนุฑู ุจุงูุชุฃููุฏ ุงูุฎูุงุฑุฒููุฉ ุงูุชู ุณุชููู ุจูุนุงูุฌุฉ ูุฐู ุงูุจูุงูุงุช ุ ูููููู ุชุญุณูู ุชูุณูู ุงูุชุฎุฒูู ููุง. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุถุน ูู ุงุนุชุจุงุฑู ุฃู ูุฐุง ุงูููุฌ ูุนูู ุจุดูู ุฌูุฏ ูุน ุฎูุงุฑ "ุชุฎุฒูู ุงูุจูููุงุช". ููููู ูุนุงูุฌุฉ ูุชูุฉ 16000 ูู ููุช ูุงุญุฏ ุ ูุชุญููููุง ุฅูู ุงูุฎุฏููุฉ ุ ูุชูููุฐ ุงูุฎูุงุฑุฒููุฉ ุ ููุชุงุจุฉ ุงููุชุงุฆุฌ ูุฑุฉ ุฃุฎุฑู. ูุชุฎุฒูู ุงูุจูุงูุงุช ุงููุคูุชุฉ ุ ุชุญุชุงุฌ ููุท ุฅูู ูุฎุฒู ูุคูุช ููุฎุฏุด ูุญุชูู ุนูู 16 ุฃูู ุนูุตุฑ.</font></font><br><br><h2 style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ุฃู ููุฌ ูู ูุฒุงูุงู ูุนููุจู ุ ูููู "ุงูุชุฑุงุถูุง" ุฃูุตู ุจุชุฎุฒูู ุงูุจูุงูุงุช ุงููุฌูุนุฉ ูููุธุงู ุงูุฌุฏูุฏ ุนูู ุงููุญู ุงูุชุงูู: </font></font><br><br><blockquote style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูุฌููุนุฉ ูู ุงูููุงูู ุฐุงุช "ูุชุญุงุช" ููุคุดุฑุงุช ุซุงุจุชุฉ ุ ุฅูุง ููุฒุนุฉ ููุญุฏุฉ ุชุฎุฒูู ูุจูุฑุฉ ูุญุฌูุฒุฉ ูู VM (ุฅู ุฃููู) ุ ุฃู ูุตููู ูู ุงููุชู ุฐุงุช ุงูุญุฌู ุงูุซุงุจุช (16 ุฃูู ููู ูููุง ุฃู ุจุญุฌู ูุซุงูู ูุจูุงูุงุชู). </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ููุญุงูุงุช ุงูุชู ุชุญุชุงุฌ ูููุง ุฅูู ุญุณุงุจุงุช ุณุฑูุนุฉ ุฌุฏูุง ูููู ุงูุจูุงูุงุช: </font></font><br><br><blockquote style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูููู ูุตูููุงุช ุงูุฃุฌุณุงู ุงููุญุฒููุฉ ุจุฅุญูุงู ุ ูุฌูุนุฉู ุจู 8 ูููุนุงูุฌุฉ SIMD ูุชูุฒุน ููุญุฏุฉ ุชุฎุฒูู ูุจูุฑุฉ ูุญุฌูุฒุฉ ูู VM ุฃู ููุฌููุนุฉ ูู ุงููุชู ุฐุงุช ุงูุญุฌู ุงูุซุงุจุช. </font></font></blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ูู ุงููุฑุฉ ุงููุงุฏูุฉ ุณูู ููุธุฑ ูู ููุถูุน ููุฑุณุฉ ูุฐู ุงูุจูุงูุงุช. </font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar469861/">https://habr.com/ru/post/ar469861/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar469839/index.html">Pikabu ุงูุจุฑูุฏ ุงููุฒุนุฌ ุงูุถุนู</a></li>
<li><a href="../ar469843/index.html">"ุฃูู ูู ุชูู ุงูุฃุดุฑุงุฑ ุงูุดุจุงุจ ุงูุชู ุณูู ุชูุญููุง ูู ุนูู ูุฌู ุงูุฃุฑุถุ"</a></li>
<li><a href="../ar469849/index.html">ูุนุจุฉ "Attack 51ูช": ูุชุงุจุฉ ูุนุจุฉ ูุงุฆูุฉ ุจุฐุงุชูุง ุจุณูุทุฉ ุนูู ููุตุฉ Obyte</a></li>
<li><a href="../ar469855/index.html">Gradle + LLVM</a></li>
<li><a href="../ar469859/index.html">ุฏูุงูุงุช ุงููุคุดุฑ ูุงููููุฉ ูู ุชุญุฏูุฏ ูุณุชูุจู ุฅุญุฏู ุงูุทุฑู</a></li>
<li><a href="../ar469865/index.html">700 ููุธู ููุงุฑุงุช ูุชุนุฏุฏุฉ: ููู ูุงูุช Alconost ุจุจูุงุก ูููุฐุฌ ุฃุนูุงู ุจูุง ุถููุฑ</a></li>
<li><a href="../ar469867/index.html">ููู ุชุชุญูู ุฅูู ุชูููุฐ (ููุง ุนูุงูุฉ ุฃูุนุงุจ ุงูุทุงููุฉ ุจู)</a></li>
<li><a href="../ar469869/index.html">ููุงุฐุง ูุฌุจ ุนููู ุฑูุน ุชุฑุฏุฏ ุงูุชุดุบูู RAM (ุฅูู ุฃูุฑ ุณูู!)</a></li>
<li><a href="../ar469871/index.html">ุนูุฏูุง ูุงูุช ููุญุงุช ุงูููุงุชูุญ ุงูุฌุฏุงูู</a></li>
<li><a href="../ar469875/index.html">ููููุฉ ุญูุงูุฉ ูููุงุช ุงูุณุฑ ุงูุฎุงุตุฉ ุจู ูู ุนุงู 2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>