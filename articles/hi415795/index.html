<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯРЕ ЁЯд╜ЁЯП╗ ЁЯСйЁЯП╗тАНЁЯОд рд╕реНрд╡рд┐рдлреНрдЯ рдкрд░ рд╕реНрдиреИрдкрдЪреИрдЯ рдпреВрдЖрдИ рд▓рд┐рдЦрдирд╛ ЁЯСИЁЯП╛ ЁЯХ┤ЁЯП╗ ЁЯС┤ЁЯП┐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдкреНрд░рд╕реНрддрд╛рд╡рдирд╛ 


 рдореЗрд░реЗ рдПрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ, рдореБрдЭреЗ рд╕реНрдиреЗрдкрдЪреИрдЯ рдореЗрдВ рдПрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рдереАред рдЬрдм рд╕реВрдЪрдирд╛ рд╡рд╛рд▓рд╛ рдПрдХ рдХрд╛рд░реНрдб рдХреИрдорд░реЗ рд╕реЗ рдЫрд╡рд┐ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдирд┐рдХрд▓рддрд╛ рд╣реИ, рддреЛ рдЗрд╕...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рд╕реНрд╡рд┐рдлреНрдЯ рдкрд░ рд╕реНрдиреИрдкрдЪреИрдЯ рдпреВрдЖрдИ рд▓рд┐рдЦрдирд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415795/"><h2 id="prolog">  рдкреНрд░рд╕реНрддрд╛рд╡рдирд╛ </h2><br><p> рдореЗрд░реЗ рдПрдХ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ, рдореБрдЭреЗ рд╕реНрдиреЗрдкрдЪреИрдЯ рдореЗрдВ рдПрдХ рдЗрдВрдЯрд░рдлреЗрд╕ рдмрдирд╛рдиреЗ рдХреА рдЬрд░реВрд░рдд рдереАред  рдЬрдм рд╕реВрдЪрдирд╛ рд╡рд╛рд▓рд╛ рдПрдХ рдХрд╛рд░реНрдб рдХреИрдорд░реЗ рд╕реЗ рдЫрд╡рд┐ рдХреЗ рд╢реАрд░реНрд╖ рдкрд░ рдирд┐рдХрд▓рддрд╛ рд╣реИ, рддреЛ рдЗрд╕реЗ рдЖрд╕рд╛рдиреА рд╕реЗ рдПрдХ рдареЛрд╕ рд░рдВрдЧ рдХреЗ рд╕рд╛рде рдмрджрд▓ рджрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдмрд╕ рд╡рд┐рдкрд░реАрдд рджрд┐рд╢рд╛ рдореЗрдВред  рдореИрдВ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдХреИрдорд░реЗ рдХреА рдЦрд┐рдбрд╝рдХреА рд╕реЗ рд╕рд╛рдЗрдб рдХрд╛рд░реНрдб рдореЗрдВ рд╕рдВрдХреНрд░рдордг рд╕реЗ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдореЛрд╣рд┐рдд рд╣реЛ рдЧрдпрд╛ рдерд╛, рдФрд░ рдмрд╣реБрдд рдЦреБрд╢реА рдХреЗ рд╕рд╛рде рдореИрдВ рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЛрдВ рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдЧрдпрд╛ рдерд╛ред </p><br><p>  рдмрд╛рдИрдВ рдУрд░ Snepchat рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ, рджрд╛рдИрдВ рдУрд░ рдПрдХ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ рдЬрд┐рд╕реЗ рд╣рдо рдмрдирд╛ рд░рд╣реЗ рд╣реЛрдВрдЧреЗред </p><br><p><img src="https://habrastorage.org/webt/es/cx/sd/escxsdlqbwqu7rfh9l9lcjjcl0a.gif"><img src="https://habrastorage.org/webt/vg/xf/8v/vgxf8vdl1gwnu0vplvu9gikqaho.gif"></p><a name="habracut"></a><br><p> рд╕рдВрднрд╡рдд: рдкрд╣рд▓рд╛ рд╕рдорд╛рдзрд╛рди рдЬреЛ рдорди рдореЗрдВ рдЖрддрд╛ рд╣реИ, рд╡рд╣ <code>UIScrollView</code> рд╡реНрдпреВ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╣реИ, рдХрд┐рд╕реА рддрд░рд╣ рдЙрд╕ рдкрд░ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд░реЗрдВ, рдкреГрд╖реНрдард╛рдВрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рд▓реЗрдХрд┐рди, рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ, рд╕реНрдХреНрд░реЙрд▓ рдХреЛ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ-рдЕрд▓рдЧ рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕ рдкрд░ рдЕрддрд┐рд░рд┐рдХреНрдд рдПрдирд┐рдореЗрд╢рди рдЙрдард╛рддреЗ рд╣реБрдП рд╢реНрд░рдорд╕рд╛рдзреНрдп рд╣реИ, рдФрд░ рдЗрд╕рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд▓рдЪреАрд▓рд╛рдкрди рдирд╣реАрдВ рд╣реИ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ред  рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдмрд┐рд▓реНрдХреБрд▓ рдЕрдиреБрдЪрд┐рдд рд╣реИред </p><br><p>  рдХреИрдорд░рд╛ рд╡рд┐рдВрдбреЛ рдФрд░ рд╕рд╛рдЗрдб рдЯреИрдм рдХреЗ рдмреАрдЪ рд╕реНрдХреНрд░реЙрд▓ рднреНрд░рд╛рдордХ рд╣реИ - рдпрд╣ рдмрд┐рд▓реНрдХреБрд▓ рднреА рд╕реНрдХреНрд░реЙрд▓ рдирд╣реАрдВ рд╣реИ, рдпрд╣ рд╡рд┐рднрд┐рдиреНрди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЗ рдмреАрдЪ рдПрдХ рд╕рдВрд╡рд╛рджрд╛рддреНрдордХ рд╕рдВрдХреНрд░рдордг рд╣реИред  рдЗрд╕рдХреЗ рдирд┐рдЪрд▓реЗ рд╣рд┐рд╕реНрд╕реЗ рдХреЗ рдмрдЯрди рд╕рд╛рдзрд╛рд░рдг рдЯреИрдм рд╣реИрдВ, рдЬрд┐рд╕ рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░рдиреЗ рд╕реЗ рдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЗ рдмреАрдЪ рдореЗрдВ рдлреЗрдХ рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/s1/xq/o7/s1xqo7xcojshfu3lqvdjiyonluk.jpeg"></p><br><p>  рдЗрд╕ рддрд░рд╣, рд╕реНрдиреЗрдЪ рдХрд╕реНрдЯрдо рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рд╕рдВрдХреНрд░рдордг рдХреЗ рд╕рд╛рде <code>UITabBarController</code> рдЬреИрд╕реЗ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдирд┐рдпрдВрддреНрд░рдХ рдХреЗ рдЕрдкрдиреЗ рд╕рдВрд╕реНрдХрд░рдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред </p><br><p>  <code>UIKit</code> рдореЗрдВ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЗ рд▓рд┐рдП рджреЛ рд╡рд┐рдХрд▓реНрдк рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдЖрдкрдХреЛ рд╕рдВрдХреНрд░рдордг рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ - рдпреЗ рд╣реИрдВ <code>UINavigationController</code> рдФрд░ <code>UITabBarController</code> ред  рдЙрди рджреЛрдиреЛрдВ рдХреЗ рдкрд╛рд╕ рдХреНрд░рдорд╢рдГ <code>navigationController(_:interactionControllerFor:)</code> рдФрд░ <code>tabBarController(_:interactionControllerFor:)</code> рддрд░реАрдХреЗ рд╣реИрдВ, рдЬреЛ рдЙрдирдХреЗ рдкреНрд░рддрд┐рдирд┐рдзрд┐рдпреЛрдВ рдореЗрдВ рдХреНрд░рдорд╢рдГ рд╣реИрдВ, рдЬреЛ рд╣рдореЗрдВ рд╕рдВрдХреНрд░рдордг рдХреЗ рд▓рд┐рдП рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдПрдиреАрдореЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВред </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">tabBarController (_: рдЗрдВрдЯрд░реИрдХреНрд╢рдирдХрдВрдЯреНрд░реЛрд▓рд░рдлреЛрд░ :)</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдиреЗрд╡рд┐рдЧреЗрд╢рдирдХрдВрдЯреНрд░реЛрд▓рд░ (_: рдЗрдВрдЯрд░реИрдХреНрд╢рдирдХрдВрдЯреНрд░реЛрд▓рд░рдлреЛрд░ :)</a> </p><br><p>  рд▓реЗрдХрд┐рди рдореИрдВ <code>UITabBarController</code> рдпрд╛ <code>UINavigationController</code> рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╕реЗ рд╕реАрдорд┐рдд рдирд╣реАрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рддрд╛, рдЦрд╛рд╕рдХрд░ рдЬрдм рд╕реЗ рд╣рдо рдЙрдирдХреЗ рдЖрдВрддрд░рд┐рдХ рддрд░реНрдХ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗред  рдЗрд╕рд▓рд┐рдП, рдореИрдВрдиреЗ рдЕрдкрдиреЗ рд╕рдорд╛рди рдирд┐рдпрдВрддреНрд░рдХ рдХреЛ рд▓рд┐рдЦрдиреЗ рдХрд╛ рдлреИрд╕рд▓рд╛ рдХрд┐рдпрд╛, рдФрд░ рдЕрдм рдореИрдВ рдмрддрд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдФрд░ рджрд┐рдЦрд╛рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВ рдХрд┐ рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛ рдЖрдпрд╛ред </p><br><h2 id="postanovka-zadachi">  рд╕рдорд╕реНрдпрд╛ рдХрд╛ рдмрдпрд╛рди </h2><br><p>  рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рдХрдВрдЯреЗрдирд░ рдирд┐рдпрдВрддреНрд░рдХ рдмрдирд╛рдПрдВ, рдЬрд┐рд╕рдореЗрдВ рдЖрдк <code>UITabBarController</code> рдФрд░ <code>UINavigationController</code> рджреЛрдиреЛрдВ рдореЗрдВ рдорд╛рдирдХ рддрдВрддреНрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрдХреНрд░рдордг рдХреЗ рд▓рд┐рдП рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдПрдирд┐рдореЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдмрд╛рд▓ рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЗ рдмреАрдЪ рд╕реНрд╡рд┐рдЪ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд╣рдореЗрдВ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рд▓рд┐рдЦреЗ рдЧрдП <code>UIViewControllerAnimatedTransitioning</code> рдкреНрд░рдХрд╛рд░ рдХреЗ рддреИрдпрд╛рд░ рдХрд┐рдП рдЧрдП рд╕рдВрдХреНрд░рдордг рдПрдирд┐рдореЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдорд╛рдирдХ рддрдВрддреНрд░ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </p><br><h2 id="podgotovka-proekta">  рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рддреИрдпрд╛рд░реА </h2><br><p>  рдЖрдорддреМрд░ рдкрд░ рдореИрдВ рдореЙрдбреНрдпреВрд▓ рдХреЛ рдЕрд▓рдЧ рдлреНрд░реЗрдорд╡рд░реНрдХ рдореЗрдВ рд▓реЗ рдЬрд╛рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддрд╛ рд╣реВрдВ, рдЗрд╕рдХреЗ рд▓рд┐рдП рдореИрдВ рдПрдХ рдирдпрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рддрд╛ рд╣реВрдВ, рдФрд░ рд╡рд╣рд╛рдВ рдПрдХ рдЕрддрд┐рд░рд┐рдХреНрдд <code>Cocoa Touch Framework</code> рд▓рдХреНрд╖реНрдп рдЬреЛрдбрд╝рддрд╛ рд╣реВрдВ, рдФрд░ рдлрд┐рд░ рд╕рдВрдмрдВрдзрд┐рдд рд▓рдХреНрд╖реНрдпреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдореЗрдВ рд╕реНрд░реЛрддреЛрдВ рдХреЛ рдмрд┐рдЦреЗрд░рддрд╛ рд╣реВрдВред  рдЗрд╕ рддрд░рд╣ рдореБрдЭреЗ рдбрд┐рдмрдЧрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрд▓рдЧ рдЖрд╡реЗрджрди рдкрддреНрд░ рдХреЗ рд╕рд╛рде рдПрдХ рдЕрд▓рдЧ рд░реВрдкрд░реЗрдЦрд╛ рдорд┐рд▓рддреА рд╣реИред </p><br><p>  <code>Single View App</code> рдмрдирд╛рдПрдВред </p><br><p><img src="https://habrastorage.org/webt/6p/eb/pa/6pebpaksin3ixvmlpse9tj7rnzs.png"></p><br><p>  <code>Product Name</code> рд╣рдорд╛рд░рд╛ рд▓рдХреНрд╖реНрдп рд╣реЛрдЧрд╛ред </p><br><p><img src="https://habrastorage.org/webt/aq/qv/fg/aqqvfgoimy4kv85lqjrb34tbkco.png"></p><br><p>  рд▓рдХреНрд╖реНрдп рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд▓рд┐рдП <code>+</code> рдкрд░ рдХреНрд▓рд┐рдХ рдХрд░реЗрдВред </p><br><p><img src="https://habrastorage.org/webt/_b/2v/vj/_b2vvjuxpzkbvcmxuo8wxsctza0.png"></p><br><p>  <code>Cocoa Touch Framework</code> рдЪреБрдиреЗрдВред </p><br><p><img src="https://habrastorage.org/webt/kr/mg/yy/krmgyylj_xfil50cdtejstjdpuc.png"></p><br><p>  рд╣рдо рдЕрдкрдиреЗ рдврд╛рдВрдЪреЗ рдХреЛ рдЙрдкрдпреБрдХреНрдд рдирд╛рдо рдХрд╣рддреЗ рд╣реИрдВ, Xcode рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╣рдорд╛рд░реЗ рд▓рдХреНрд╖реНрдп рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХрд╛ рдЪрдпрди рдХрд░рддрд╛ рд╣реИ рдФрд░ рдмрд╛рдЗрдирд░реА рдХреЛ рд╕реАрдзреЗ рдЖрд╡реЗрджрди рдореЗрдВ рдЯрд╛рдИ рдХрд░рдиреЗ рдХреА рдкреЗрд╢рдХрд╢ рдХрд░рддрд╛ рд╣реИред  рд╣рдо рд╕рд╣рдордд рд╣реИрдВред </p><br><p><img src="https://habrastorage.org/webt/no/xi/cn/noxicnp_oslkyxhn3qkmcaukpom.png"></p><br><p>  рд╣рдореЗрдВ рдбрд┐рдлрд╝реЙрд▓реНрдЯ <code>Main.storyboard</code> рдФрд░ <code>ViewController.swift</code> рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реЛрдЧреА, рд╣рдо рдЙрдиреНрд╣реЗрдВ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВред </p><br><p><img src="https://habrastorage.org/webt/_m/zq/aw/_mzqawkdo2pi9zgulfqlwnhs2vo.png"></p><br><p>  <code>General</code> рдЯреИрдм рдкрд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рдХреНрд╖реНрдп рдореЗрдВ <code>Main Interface</code> рд╕реЗ рдорд╛рди рдХреЛ рдирд┐рдХрд╛рд▓рдирд╛ рди рднреВрд▓реЗрдВред </p><br><p><img src="https://habrastorage.org/webt/kt/sv/3v/ktsv3vjy_1vqgwdnkh288h4ecpc.png"></p><br><p>  рдЕрдм рд╣рдо <code>AppDelegate.swift</code> рдЬрд╛рддреЗ <code>AppDelegate.swift</code> рдФрд░ рдХреЗрд╡рд▓ рдирд┐рдореНрди рд╕рд╛рдордЧреНрд░реА рдХреА <code>application</code> рд╡рд┐рдзрд┐ рдЫреЛрдбрд╝рддреЗ рд╣реИрдВ: </p><br><pre> <code class="hljs swift"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">application</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplicationLaunchOptionsKey: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">]?)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Launch our master view controller let master = MasterViewController() window = UIWindow() window?.rootViewController = master window?.makeKeyAndVisible() return true }</span></span></code> </pre> <br><p>  рдпрд╣рд╛рдВ рд╣рдо рдЕрдкрдиреЗ рдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЛ рдореБрдЦреНрдп рд╕реНрдерд╛рди рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдпрд╣ рд▓реЙрдиреНрдЪрд░ рдХреЗ рдмрд╛рдж рджрд┐рдЦрд╛рдИ рджреЗред </p><br><p>  рдЕрдм рдпрд╣ рдмрд╣реБрдд <code>MasterViewController</code> ред  рдпрд╣ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рддреЗ рд╕рдордп рд╕рд╣реА рд▓рдХреНрд╖реНрдп рдЪреБрдирдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред </p><br><p><img src="https://habrastorage.org/webt/7m/0y/r8/7m0yr8cefaenhznoqbjisg7sy1q.png"></p><br><p>  рд╣рдо <code>SnapchatNavigationController</code> рд╕реЗ <code>MasterViewController</code> рдХрд╛ рд╡рд╛рд░рд┐рд╕ рдХрд░реЗрдВрдЧреЗ, рдЬрд┐рд╕реЗ рд╣рдо рдмрд╛рдж рдореЗрдВ рдлреНрд░реЗрдорд╡рд░реНрдХ рдореЗрдВ рд▓рд╛рдЧреВ рдХрд░реЗрдВрдЧреЗред  рд╣рдорд╛рд░реЗ рдврд╛рдВрдЪреЗ рдХреЗ <code>import</code> рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордд рднреВрд▓рдирд╛ред  рдореИрдВ рдпрд╣рд╛рдВ рдкреВрд░реНрдг рдирд┐рдпрдВрддреНрд░рдХ рдХреЛрдб рдкреНрд░рджрд╛рди рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реВрдВ, рдЪреВрдХ рдХреЛ рджреАрд░реНрдШрд╡реГрддреНрдд рджреНрд╡рд╛рд░рд╛ рджрд┐рдЦрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ <code>...</code> , рдореИрдВрдиреЗ рдЖрд╡реЗрджрди рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">GitHub</a> рдкрд░ рд░рдЦрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> , рд╡рд╣рд╛рдВ рдЖрдк рд╕рднреА рд╡рд┐рд╡рд░рдг рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕ рдирд┐рдпрдВрддреНрд░рдХ рдореЗрдВ, рд╣рдо рдХреЗрд╡рд▓ <code>viewDidLoad()</code> рд╡рд┐рдзрд┐ рдореЗрдВ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВ, рдЬреЛ рдХреИрдорд░рд╛ + рдПрдХ рдкрд╛рд░рджрд░реНрд╢реА рдирд┐рдпрдВрддреНрд░рдХ (рдореБрдЦреНрдп рд╡рд┐рдВрдбреЛ) + рдХреЗ рд╕рд╛рде рдкреГрд╖реНрдарднреВрдорд┐ рдирд┐рдпрдВрддреНрд░рдХ рдХреЛ рдкреНрд░рд╛рд░рдВрдн рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рд╕реНрдерд╛рди рдХрд╛рд░реНрдб рд╣реЛрддрд╛ рд╣реИред </p><br><pre> <code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">MakingSnapchatNavigation</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MasterViewController</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">SnapchatNavigationController</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> func viewDidLoad() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() <span class="hljs-comment"><span class="hljs-comment">//   let camera = CameraViewController() setBackground(vc: camera) //     var vcs: [UIViewController] = [] //    var stub = UIViewController() stub.view.backgroundColor = .clear vcs.append(stub) //  ,     stub = UIViewController() stub.view.backgroundColor = .clear //   let scroll = UIScrollView() stub.view.addSubview(scroll) //  ... //  ,      let content = GradientView() //  ... //    scroll.addSubview(content) vcs.append(stub) //     - setViewControllers(vcs: vcs) } }</span></span></code> </pre> <br><p>  рдпрд╣рд╛рдБ рдХреНрдпрд╛ рд╣реЛ рд░рд╣рд╛ рд╣реИ?  рд╣рдо рдПрдХ рдХреИрдорд░рд╛ рдХреЗ рд╕рд╛рде рдПрдХ рдирд┐рдпрдВрддреНрд░рдХ рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ <code>SnapchatNavigationController</code> рд╕реЗ <code>setBackground</code> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреГрд╖реНрдарднреВрдорд┐ рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕ рдХрдВрдЯреНрд░реЛрд▓рд░ рдореЗрдВ рдХреИрдорд░реЗ рд╕реЗ рдкреВрд░реЗ рд╡реНрдпреВ рдХреЗ рд▓рд┐рдП рд╕реНрдЯреНрд░реЗрдЪ рдХреА рдЧрдИ рдЗрдореЗрдЬ рд╣реЛрддреА рд╣реИред  рдлрд┐рд░ рд╣рдо рдПрдХ рдЦрд╛рд▓реА рдкрд╛рд░рджрд░реНрд╢реА рдирд┐рдпрдВрддреНрд░рдХ рдмрдирд╛рддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рд╕рд░рдгреА рдореЗрдВ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ, рдпрд╣ рдмрд╕ рдЗрд╕рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреИрдорд░реЗ рд╕реЗ рдЫрд╡рд┐ рдХреЛ рдкрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИ, рд╣рдо рдЗрд╕ рдкрд░ рдирд┐рдпрдВрддреНрд░рдг рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдПрдХ рдФрд░ рдкрд╛рд░рджрд░реНрд╢реА рдирд┐рдпрдВрддреНрд░рдХ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЗрд╕рдореЗрдВ рдПрдХ рд╕реНрдХреНрд░реЙрд▓ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рд╕реНрдХреНрд░реЙрд▓ рдХреЗ рдЕрдВрджрд░ рд╕рд╛рдордЧреНрд░реА рдХреЗ рд╕рд╛рде рдПрдХ рджреГрд╢реНрдп рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рджреВрд╕рд░рд╛ рдирд┐рдпрдВрддреНрд░рдХ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ рд╕рд░рдгреА рдФрд░ рдкреИрд░реЗрдВрдЯ <code>SnapchatNavigationController</code> рд╕реЗ рд╡рд┐рд╢реЗрд╖ <code>setViewControllers</code> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рд╕рд░рдгреА рдХреЛ рд╕реЗрдЯ рдХрд░реЗрдВред </p><br><p>  <code>Info.plist</code> рдореЗрдВ рдХреИрдорд░реЗ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдиреБрд░реЛрдз рдЬреЛрдбрд╝рдирд╛ рди рднреВрд▓реЗрдВ </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span>NSCameraUsageDescription<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">key</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span>Need camera for background<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  рдЗрд╕ рдкрд░, рд╣рдо рдкрд░реАрдХреНрд╖рдг рдХреЗ рдЖрд╡реЗрджрди рдХреЛ рддреИрдпрд╛рд░ рдорд╛рдирддреЗ рд╣реИрдВ, рдФрд░ рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рднрд╛рдЧ рдкрд░ рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реИрдВ - рд░реВрдкрд░реЗрдЦрд╛ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрдиред </p><br><h2 id="struktura-roditelskogo-kontrollera">  рдЬрдирдХ рдирд┐рдпрдВрддреНрд░рдХ рд╕рдВрд░рдЪрдирд╛ </h2><br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдПрдХ рдЦрд╛рд▓реА <code>SnapchatNavigationController</code> рдмрдирд╛рдПрдВ, рдЗрд╕рдХреЗ рд▓рд┐рдП рд╕рд╣реА рд▓рдХреНрд╖реНрдп рдЪреБрдирдирд╛ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИред  рдпрджрд┐ рд╕рдм рдХреБрдЫ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рддреЛ рдЖрд╡реЗрджрди рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреА рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдХреЛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕рдВрджрд░реНрдн</a> рджреНрд╡рд╛рд░рд╛ рдЕрдирд▓реЛрдб рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">open</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> SnapchatNavigationController: UIViewController { override <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> func viewDidLoad() { super.viewDidLoad() // <span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> additional setup <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> loading the <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>. } // MARK: - <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> interface /// Sets <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> controllers. <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> func setViewControllers(vcs: [UIViewController]) { } /// Sets background <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>. <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> func setBackground(vc: UIViewController) { } }</code> </pre> <br><p>  рдЕрдм рдЖрдВрддрд░рд┐рдХ рдШрдЯрдХреЛрдВ рдХреЛ рдЬреЛрдбрд╝реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдирд┐рдпрдВрддреНрд░рдХ рд╢рд╛рдорд┐рд▓ рд╣реЛрдЧрд╛ред  рдореИрдВ рдпрд╣рд╛рдВ рд╕рднреА рдХреЛрдб рдирд╣реАрдВ рд▓рд╛рддрд╛, рдореИрдВ рдХреЗрд╡рд▓ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБрдУрдВ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реВрдВред </p><br><p>  рд╣рдо рдмрд╛рд▓ рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреА рд╕рд░рдгреА рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЪрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВред  рдЕрдм рд╣рдо рдХрдареЛрд░рддрд╛ рд╕реЗ рдЙрдирдХреА рдЖрд╡рд╢реНрдпрдХ рдорд╛рддреНрд░рд╛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ - 2 рдЯреБрдХрдбрд╝реЗред  рднрд╡рд┐рд╖реНрдп рдореЗрдВ, рдХрд┐рд╕реА рднреА рд╕рдВрдЦреНрдпрд╛ рдХреЗ рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЗ рд╕рд╛рде рдЙрдкрдпреЛрдЧ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдВрддреНрд░рдХ рддрд░реНрдХ рдХрд╛ рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛ред  рд╣рдордиреЗ рдкреНрд░рджрд░реНрд╢рд┐рдд рд╡рд░реНрддрдорд╛рди рдирд┐рдпрдВрддреНрд░рдХ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдЪрд░ рднреА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рд╣реИред </p><br><pre> <code class="hljs pgsql">private let requiredChildrenAmount = <span class="hljs-number"><span class="hljs-number">2</span></span> // MARK: - <span class="hljs-keyword"><span class="hljs-keyword">View</span></span> controllers /// top child <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> controller private var topViewController: UIViewController? /// <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> children <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> controllers private var children: [UIViewController] = []</code> </pre> <br><p>  рд╡рд┐рдЪрд╛рд░ рдмрдирд╛рдПрдВред  рд╣рдореЗрдВ рдкреГрд╖реНрдарднреВрдорд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рджреГрд╢реНрдп рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдПрдХ рджреГрд╢реНрдп рдЬрд┐рд╕рдХреЗ рдкреНрд░рднрд╛рд╡ рдХреЛ рд╣рдо рдирд┐рдпрдВрддреНрд░рдХ рдХреЛ рдмрджрд▓рддреЗ рд╕рдордп рдкреГрд╖реНрдарднреВрдорд┐ рдкрд░ рд▓рд╛рдЧреВ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВред  рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╡рд░реНрддрдорд╛рди рдмрд╛рд▓ рдирд┐рдпрдВрддреНрд░рдХ рдХреЗ рд▓рд┐рдП рдПрдХ рджреГрд╢реНрдп рдХрдВрдЯреЗрдирд░ рдФрд░ рдПрдХ рджреГрд╢реНрдп рд╕рдВрдХреЗрддрдХ рд╣реИ рдЬреЛ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЛ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдмрддрд╛рдПрдЧрд╛ред </p><br><pre> <code class="hljs bash">// MARK: - Views private <span class="hljs-built_in"><span class="hljs-built_in">let</span></span> backgroundViewContainer = UIView() private <span class="hljs-built_in"><span class="hljs-built_in">let</span></span> backgroundBlurEffectView: UIVisualEffectView = { <span class="hljs-built_in"><span class="hljs-built_in">let</span></span> backgroundBlurEffect = UIBlurEffect(style: UIBlurEffectStyle.light) <span class="hljs-built_in"><span class="hljs-built_in">let</span></span> backgroundBlurEffectView = UIVisualEffectView(effect: backgroundBlurEffect) backgroundBlurEffectView.alpha = 0 <span class="hljs-built_in"><span class="hljs-built_in">return</span></span> backgroundBlurEffectView }() /// content view <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> children private <span class="hljs-built_in"><span class="hljs-built_in">let</span></span> contentViewContainer = UIView() private <span class="hljs-built_in"><span class="hljs-built_in">let</span></span> swipeIndicatorView = UIView()</code> </pre> <br><p>  рдЕрдЧрд▓реЗ рдмреНрд▓реЙрдХ рдореЗрдВ, рд╣рдо рджреЛ рдЪрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, <code>swipeAnimator</code> рдПрдиреАрдореЗрд╢рди рдХреЗ рд▓рд┐рдП рдЬрд╝рд┐рдореНрдореЗрджрд╛рд░ рд╣реИ, <code>swipeInteractor</code> рдЗрдВрдЯрд░реИрдХреНрд╢рди (рдПрдиреАрдореЗрд╢рди рдХреА рдкреНрд░рдЧрддрд┐ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛) рдХреЗ рд▓рд┐рдП рдЬрд╝рд┐рдореНрдореЗрджрд╛рд░ рд╣реИ, рд╣рдореЗрдВ рдЗрд╕реЗ рдХрдВрдЯреНрд░реЛрд▓рд░ рдмреВрдЯ рдХреЗ рджреМрд░рд╛рди рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЗрд╕рд▓рд┐рдП рд╣рдо рдмрд▓ рдЕрдирдЯреНрд░реИрдк рдХрд░рддреЗ рд╣реИрдВред </p><br><pre> <code class="hljs erlang">// MARK: - Animation <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> transition private <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> swipeAnimator = AnimatedTransitioning() private var swipeInteractor: CustomSwipeInteractor!</code> </pre> <br><p>  рд╣рдордиреЗ рд╕рдВрдХреЗрддрдХ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рд╡рд░реНрддрди рднреА рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд┐рдпрд╛ рд╣реИред  рд╣рдо рдХрдВрдЯреЗрдирд░ рдХреА рдЪреМрдбрд╝рд╛рдИ рд╕реЗ рд╕рдВрдХреЗрддрдХ рдХреЛ рд╢рд┐рдлреНрдЯ рдХрд░рддреЗ рд╣реИрдВ + рдХрд┐рдирд╛рд░реЗ рд╕реЗ рдбрдмрд▓ рд╢рд┐рдлреНрдЯ + рд╕реВрдЪрдХ рдХреА рдЪреМрдбрд╝рд╛рдИ рд╕реЗ рд╣реА рддрд╛рдХрд┐ рд╕реВрдЪрдХ рдХрдВрдЯреЗрдирд░ рдХреЗ рд╡рд┐рдкрд░реАрдд рдЫреЛрд░ рдкрд░ рд╣реЛред  рдХрдВрдЯреЗрдирд░ рдХреА рдЪреМрдбрд╝рд╛рдИ рдЖрд╡реЗрджрди рдХреЗ рджреМрд░рд╛рди рдЬреНрдЮрд╛рдд рд╣реЛ рдЬрд╛рдПрдЧреА, рдЗрд╕рд▓рд┐рдП рдЪрд░ рдХреА рдЧрдгрдирд╛ рдЬрд╛рдиреЗ рдкрд░ рдХреА рдЬрд╛рддреА рд╣реИред </p><br><pre> <code class="hljs pgsql">// MARK: - Animation transforms private var swipeIndicatorViewTransform: CGAffineTransform { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> CGAffineTransform(translationX: -contentViewContainer.bounds.size.width + (swipeIndicatorViewXShift * <span class="hljs-number"><span class="hljs-number">2</span></span>) + swipeIndicatorViewWidth, y: <span class="hljs-number"><span class="hljs-number">0</span></span>) } }</code> </pre> <br><p>  рдирд┐рдпрдВрддреНрд░рдХ рд▓реЛрдб рдХрд░рддреЗ рд╕рдордп, рд╣рдо рдПрдиреАрдореЗрд╢рди рдХреЛ <code>self</code> рдЕрд╕рд╛рдЗрди рдХрд░рддреЗ рд╣реИрдВ (рд╣рдо рдиреАрдЪреЗ рджрд┐рдП рдЧрдП рд╕рдВрдмрдВрдзрд┐рдд рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рд▓рд╛рдЧреВ рдХрд░реЗрдВрдЧреЗ), рд╣рдорд╛рд░реЗ рдПрдиреАрдореЗрд╢рди рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЗрдВрдЯрд░реИрдХреНрдЯрд░ рдХреЛ рдЗрдирд┐рд╢рд┐рдпрд▓рд╛рдЗрдЬрд╝ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдХреА рдкреНрд░рдЧрддрд┐ рдЗрд╕реЗ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░реЗрдЧреАред  рд╣рдо рдЙрдиреНрд╣реЗрдВ рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЗ рд░реВрдк рдореЗрдВ рднреА рдирд┐рдпреБрдХреНрдд рдХрд░рддреЗ рд╣реИрдВред  рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЗрд╢рд╛рд░реЗ рдХреА рд╢реБрд░реБрдЖрдд рдкрд░ рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛ рджреЗрдЧрд╛ рдФрд░ рдирд┐рдпрдВрддреНрд░рдХ рдХреА рд╕реНрдерд┐рддрд┐ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдПрдиреАрдореЗрд╢рди рд╢реБрд░реВ рдХрд░реЗрдЧрд╛ рдпрд╛ рд░рджреНрдж рдХрд░реЗрдЧрд╛ред  рдлрд┐рд░ рд╣рдо рд╕рднреА рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреЛ рдореБрдЦреНрдп рдПрдХ рдореЗрдВ <code>setupViews()</code> рдФрд░ <code>setupViews()</code> , рдЬреЛ рдмрд╛рдзрд╛рдУрдВ рдХреЛ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИред </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.viewDidLoad() swipeAnimator.animation = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> swipeInteractor = <span class="hljs-type"><span class="hljs-type">CustomSwipeInteractor</span></span>(with: swipeAnimator) swipeInteractor.delegate = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> view.addSubview(backgroundViewContainer) view.addSubview(backgroundBlurEffectView) view.addSubview(contentViewContainer) view.addSubview(swipeIndicatorView) setupViews() }</code> </pre> <br><p>  рдЕрдЧрд▓рд╛, рд╣рдо рдПрдХ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдмрд╛рд▓ рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЛ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдиреЗ рдФрд░ рд╣рдЯрд╛рдиреЗ рдХреЗ рддрд░реНрдХ рдкрд░ рдЖрдЧреЗ рдмрдврд╝рддреЗ рд╣реИрдВред  рдпрд╣рд╛рдБ рд╕рдм рдХреБрдЫ рд╕рд░рд▓ рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ Apple рдкреНрд░рд▓реЗрдЦрди рдореЗрдВ рд╣реИред  рд╣рдо рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдСрдкрд░реЗрд╢рди рдХреЗ рд▓рд┐рдП рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  <code>addChildViewController(vc)</code> - рд╡рд░реНрддрдорд╛рди рдореЗрдВ рдПрдХ рдЪрд╛рдЗрд▓реНрдб рдХрдВрдЯреНрд░реЛрд▓рд░ рдЬреЛрдбрд╝реЗрдВред </p><br><p>  <code>contentViewContainer.addSubview(vc.view)</code> - рдирд┐рдпрдВрддреНрд░рдХ рджреГрд╢реНрдп рдХреЛ рдкрджрд╛рдиреБрдХреНрд░рдо рдореЗрдВ рдЬреЛрдбрд╝реЗрдВред </p><br><p>  <code>vc.view.frame = contentViewContainer.bounds</code> - рджреГрд╢реНрдп рдХреЛ рдкреВрд░реЗ рдХрдВрдЯреЗрдирд░ рдореЗрдВ <code>vc.view.frame = contentViewContainer.bounds</code> ред  рдЪреВрдВрдХрд┐ рд╣рдо рдСрдЯреЛ рд▓реЗрдЖрдЙрдЯ рдХреЗ рдмрдЬрд╛рдп рдпрд╣рд╛рдВ рдлрд╝реНрд░реЗрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рд╣рд░ рдмрд╛рд░ рдирд┐рдпрдВрддреНрд░рдХ рдЖрдХрд╛рд░ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдирдХреЗ рдЖрдХрд╛рд░реЛрдВ рдХреЛ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рд╣рдо рдЗрд╕ рддрд░реНрдХ рдХреЛ рдЫреЛрдбрд╝ рджреЗрдВрдЧреЗ рдФрд░ рдорд╛рди рд▓реЗрдВрдЧреЗ рдХрд┐ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдЪрд▓ рд░рд╣рд╛ рд╣реИ, рдЬрдмрдХрд┐ рдХрдВрдЯреЗрдирд░ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рдирд╣реАрдВ рдмрджрд▓реЗрдЧрд╛ред </p><br><p>  <code>vc.didMove(toParentViewController: self)</code> - рдПрдХ рдЪрд╛рдЗрд▓реНрдб рдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рд▓рд┐рдП рдПрдХ рдЕрдВрдд рдбрд╛рд▓ рджрд┐рдпрд╛ред </p><br><p>  <code>swipeInteractor.wireTo</code> - рд╣рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЗрд╢рд╛рд░реЛрдВ рдкрд░ рд╡рд░реНрддрдорд╛рди рдирд┐рдпрдВрддреНрд░рдХ рдХреЛ рдЯрд╛рдИ рдХрд░рддреЗ рд╣реИрдВред  рдмрд╛рдж рдореЗрдВ рд╣рдо рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВрдЧреЗред </p><br><pre> <code class="hljs pgsql">// MARK: - Private methods private func addChild(vc: UIViewController) { addChildViewController(vc) contentViewContainer.addSubview(vc.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>) vc.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.frame = contentViewContainer.bounds vc.didMove(toParentViewController: self) topViewController = vc let goingRight = children.<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">of</span></span>: topViewController!) == <span class="hljs-number"><span class="hljs-number">0</span></span> swipeInteractor.wireTo(viewController: topViewController!, edge: goingRight ? .right : .left) } private func removeChild(vc: UIViewController) { vc.willMove(toParentViewController: nil) vc.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.removeFromSuperview() vc.removeFromParentViewController() topViewController = nil }</code> </pre> <br><p>  рджреЛ рдФрд░ рд╡рд┐рдзрд┐рдпрд╛рдВ рд╣реИрдВ рдЬрд┐рдирдХреЗ рдХреЛрдб рдореИрдВ рдпрд╣рд╛рдВ рдирд╣реАрдВ рджреВрдВрдЧрд╛: <code>setViewControllers</code> рдФрд░ <code>setBackground</code> ред  <code>setViewControllers</code> рд╡рд┐рдзрд┐ рдореЗрдВ <code>setViewControllers</code> рд╣рдо рдХреЗрд╡рд▓ рдЕрдкрдиреЗ рдХрдВрдЯреНрд░реЛрд▓рд░ рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рд╡реИрд░рд┐рдПрдмрд▓ рдореЗрдВ рдЪрд╛рдЗрд▓реНрдб рдХрдВрдЯреНрд░реЛрд▓рд░реНрд╕ рдХреА рд╕рд░рдгреА рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ <code>setViewControllers</code> рдХреЛ рдЙрдирдореЗрдВ рд╕реЗ рдХрд┐рд╕реА рдПрдХ рдХреЛ рдбрд┐рд╕реНрдкреНрд▓реЗ рдкрд░ рджрд┐рдЦрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХрд░рддреЗ рд╣реИрдВред  <code>setBackground</code> рд╡рд┐рдзрд┐ рдореЗрдВ <code>setBackground</code> рд╣рдо рдЙрд╕реА рддрд░рд╣ рдХрд░рддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ <code>setBackground</code> рдореЗрдВ, рдХреЗрд╡рд▓ рдкреГрд╖реНрдарднреВрдорд┐ рдирд┐рдпрдВрддреНрд░рдХ рдХреЗ рд▓рд┐рдПред </p><br><h2 id="logika-animacii-kontrollera-konteynera">  рдХрдВрдЯреЗрдирд░ рдирд┐рдпрдВрддреНрд░рдХ рдПрдиреАрдореЗрд╢рди рддрд░реНрдХ </h2><br><p>  рдХреБрд▓, рд╣рдорд╛рд░реЗ рдореВрд▓ рдирд┐рдпрдВрддреНрд░рдХ рдХрд╛ рдЖрдзрд╛рд░ рд╣реИ: </p><br><ul><li>  UIView рджреЛ рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рд╣реИ <br><ul><li>  рдХрдВрдЯреЗрдирд░ </li><li>  рд╕рд╛рдзрд╛рд░рдг </li></ul></li><li>  рдмрдЪреНрдЪреЗ рдХреА рд╕реВрдЪреА UIViewController </li><li>  <code>swipeAnimator</code> рдкреНрд░рдХрд╛рд░ <code>AnimatedTransitioning</code> рдХрд╛ рдПрдиреАрдореЗрд╢рди рдирд┐рдпрдВрддреНрд░рдг рдСрдмреНрдЬреЗрдХреНрдЯ </li><li>  рдПрдХ рдРрд╕реА рд╡рд╕реНрддреБ рдЬреЛ рдХрд┐ <code>swipeInteractor</code> рдПрдиреАрдореЗрд╢рди рдХреЗ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдХреЛрд░реНрд╕ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд <code>CustomSwipeInteractor</code> </li><li>  рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдПрдиреАрдореЗрд╢рди </li><li>  рдПрдиреАрдореЗрд╢рди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди </li></ul><br><p>  рдЕрдм рд╣рдо рдЕрдВрддрд┐рдо рджреЛ рдмрд┐рдВрджреБрдУрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░реЗрдВрдЧреЗ, рдлрд┐рд░ <code>AnimatedTransitioning</code> рдФрд░ <code>CustomSwipeInteractor</code> рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрд░ рдЖрдЧреЗ <code>CustomSwipeInteractor</code> ред </p><br><h3 id="delegat-interaktivnogo-hoda-animacii">  рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдПрдиреАрдореЗрд╢рди </h3><br><p>  рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдореЗрдВ рдХреЗрд╡рд▓ рдПрдХ <code>panGestureDidStart(rightToLeftSwipe: Bool) -&gt; Bool</code> рд╡рд┐рдзрд┐ рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬреЛ рдирд┐рдпрдВрддреНрд░рдХ рдХреЛ рдЗрд╢рд╛рд░реЗ рдХреА рд╢реБрд░реБрдЖрдд рдФрд░ рдЙрд╕рдХреА рджрд┐рд╢рд╛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╕реВрдЪрд┐рдд рдХрд░рддреА рд╣реИред  рдЬрд╡рд╛рдм рдореЗрдВ, рд╡рд╣ рдЗрд╕ рдЬрд╛рдирдХрд╛рд░реА рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рдПрдиреАрдореЗрд╢рди рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред </p><br><p>  рдПрдХ рдкреНрд░рддрд┐рдирд┐рдзрд┐ рдХреЗ рд░реВрдк рдореЗрдВ, рд╣рдо рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рд╣рдо рджрд┐рдП рдЧрдП рджрд┐рд╢рд╛ рдореЗрдВ рдПрдиреАрдореЗрд╢рди рд╢реБрд░реВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдпрд╛ рдирд╣реАрдВ, рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рд╣рдо рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЗ рд╡рд░реНрддрдорд╛рди рдХреНрд░рдо рдХреА рдЬрд╛рдВрдЪ рдХрд░рддреЗ рд╣реИрдВ, рд╣рдо рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд╕рд╛рде, <code>transition</code> рд╡рд┐рдзрд┐ рд╢реБрд░реВ рдХрд░рддреЗ рд╣реИрдВ: рдЬрд┐рд╕ рдирд┐рдпрдВрддреНрд░рдХ рд╕реЗ рд╣рдо рдЪрд▓ рд░рд╣реЗ рд╣реИрдВ, рдЬрд┐рд╕ рдирд┐рдпрдВрддреНрд░рдХ рд╕реЗ рд╣рдо рдмрдврд╝ рд░рд╣реЗ рд╣реИрдВ, рдЖрдВрджреЛрд▓рди рдХреА рджрд┐рд╢рд╛, рдЕрдиреНрддрд░рдХреНрд░рд┐рдпрд╛рд╢реАрд▓рддрд╛ рдзреНрд╡рдЬред ( <code>false</code> рдорд╛рдорд▓реЗ рдореЗрдВ, рдПрдХ рд╕рдордп-рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╕рдВрдХреНрд░рдордг рдПрдиреАрдореЗрд╢рди рд╢реБрд░реВ рд╣реЛ рдЬрд╛рддрд╛ рд╣реИ)ред </p><br><pre> <code class="hljs julia">func panGestureDidStart(rightToLeftSwipe: <span class="hljs-built_in"><span class="hljs-built_in">Bool</span></span>) -&gt; <span class="hljs-built_in"><span class="hljs-built_in">Bool</span></span> { guard <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> topViewController = topViewController, <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> fromIndex = children.index(of: topViewController) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> newIndex = rightToLeftSwipe ? <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span> //   -    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> newIndex &gt; -<span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; newIndex &lt; children.count &amp;&amp; newIndex != fromIndex { transition(from: children[fromIndex], to: children[newIndex], goingRight: rightToLeftSwipe, interactive: <span class="hljs-literal"><span class="hljs-literal">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span> }</code> </pre> <br><p>  рдЖрдЗрдП рд╣рдо рддреБрд░рдВрдд <code>transition</code> рд╡рд┐рдзрд┐ рдХреЗ рд╢рд░реАрд░ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо <code>CustomControllerContext</code> рдПрдиреАрдореЗрд╢рди рдХреЗ рд▓рд┐рдП рдПрдиреАрдореЗрд╢рди рд╕рдВрджрд░реНрдн рдмрдирд╛рддреЗ рд╣реИрдВред  рд╣рдо рдЗрд╕ рд╡рд░реНрдЧ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдереЛрдбрд╝рд╛ рдмрд╛рдж рдореЗрдВ рдХрд░реЗрдВрдЧреЗ, рдпрд╣ <code>UIViewControllerContextTransitioning</code> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИред  <code>UINavigationController</code> рдФрд░ <code>UITabBarController</code> рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ <code>UITabBarController</code> рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛ <code>UITabBarController</code> рдЙрджрд╛рд╣рд░рдг рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рджреНрд╡рд╛рд░рд╛ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдФрд░ рдЗрд╕рдХрд╛ рддрд░реНрдХ рд╣рдорд╕реЗ рдЫрд┐рдкрд╛ рд╣реБрдЖ рд╣реИ, рд╣рдореЗрдВ рдЕрдкрдирд╛ рдЦреБрдж рдХрд╛ рдмрдирд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </p><br><pre> <code class="hljs pgsql">let ctx = CustomControllerContext(fromViewController: <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>, toViewController: <span class="hljs-keyword"><span class="hljs-keyword">to</span></span>, containerView: contentViewContainer, goingRight: goingRight) ctx.isAnimated = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ctx.isInteractive = interactive ctx.completionBlock = { (didComplete: <span class="hljs-type"><span class="hljs-type">Bool</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> didComplete { self.removeChild(vc: <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>) self.addChild(vc: <span class="hljs-keyword"><span class="hljs-keyword">to</span></span>) } };</code> </pre> <br><p>  рддрдм рд╣рдо рдмрд╕ рдпрд╛ рддреЛ рдлрд┐рдХреНрд╕реНрдб рдпрд╛ рдЗрдВрдЯрд░реИрдХреНрдЯрд┐рд╡ рдПрдиреАрдореЗрд╢рди рдХрд╣рддреЗ рд╣реИрдВред  рднрд╡рд┐рд╖реНрдп рдореЗрдВ, рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЗ рдмреАрдЪ рдиреЗрд╡рд┐рдЧреЗрд╢рди рдХреЗ рдЯреИрдм-рдмрдЯрди рдкрд░ рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдПрдХ рдХреЛ рд▓рдЯрдХрд╛ рджреЗрдирд╛ рд╕рдВрднрд╡ рд╣реЛрдЧрд╛, рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╣рдо рдРрд╕рд╛ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗред </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> interactive { // Animate <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> interaction swipeInteractor.startInteractiveTransition(ctx) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { // Animate <span class="hljs-keyword"><span class="hljs-keyword">without</span></span> interaction swipeAnimator.animateTransition(<span class="hljs-keyword"><span class="hljs-keyword">using</span></span>: ctx) }</code> </pre> <br><h3 id="protokol-animacii">  рдПрдирд┐рдореЗрд╢рди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ </h3><br><p>  <code>TransitionAnimation</code> рдПрдиреАрдореЗрд╢рди рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдореЗрдВ 4 рд╡рд┐рдзрд┐рдпрд╛рдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: </p><br><p>  <code>addTo</code> рдПрдХ рд╡рд┐рдзрд┐ рд╣реИ рдЬрд┐рд╕реЗ рдХрдВрдЯреЗрдирд░ рдореЗрдВ рдмрдЪреНрдЪреЗ рдХреЗ рд╡рд┐рдЪрд╛рд░реЛрдВ рдХреА рд╕рд╣реА рд╕рдВрд░рдЪрдирд╛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдбрд┐рдЬрд╝рд╛рдЗрди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддрд╛рдХрд┐ рдкрд┐рдЫрд▓рд╛ рд╡рд┐рдЪрд╛рд░ рдПрдиреАрдореЗрд╢рди рдХреЗ рд╡рд┐рдЪрд╛рд░ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдирдП рдХреЗ рд╕рд╛рде рдУрд╡рд░рд▓реИрдк рд╣реЛ рдЬрд╛рдПред </p><br><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">/// Setup the views hirearchy for animation. func addTo(containerView: UIView, fromView: UIView, toView: UIView, fromLeft: Bool)</span></span></code> </pre> <br><p>  рд╡реНрдпреВ рдХреЛ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдиреАрдореЗрд╢рди рд╕реЗ рдкрд╣рд▓реЗ рдХреА рд╡рд┐рдзрд┐ рддреИрдпрд╛рд░ рдХреА рдЬрд╛рддреА рд╣реИред </p><br><pre> <code class="hljs sql">/// Setup the views position prior to the animation start. func <span class="hljs-keyword"><span class="hljs-keyword">prepare</span></span>(fromView <span class="hljs-keyword"><span class="hljs-keyword">from</span></span>: UIView?, toView <span class="hljs-keyword"><span class="hljs-keyword">to</span></span>: UIView?, fromLeft: <span class="hljs-built_in"><span class="hljs-built_in">Bool</span></span>)</code> </pre> <br><p>  <code>animation</code> - рдПрдиреАрдореЗрд╢рди рд╣реАред </p><br><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">/// The animation. func animation(fromView from: UIView?, toView to: UIView?, fromLeft: Bool)</span></span></code> </pre> <br><p>  <code>finalize</code> - рдПрдиреАрдореЗрд╢рди рдХреЗ рдкреВрд░рд╛ рд╣реЛрдиреЗ рдХреЗ рдмрд╛рдж рдЖрд╡рд╢реНрдпрдХ рдХрд╛рд░реНрдпред </p><br><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">/// Cleanup the views position after the animation ended. func finalize(completed: Bool, fromView from: UIView?, toView to: UIView?, fromLeft: Bool)</span></span></code> </pre> <br><p>  рд╣рдо рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдкрд░ рд╡рд┐рдЪрд╛рд░ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ, рд╡рд╣рд╛рдВ рд╕рдм рдХреБрдЫ рдХрд╛рдлреА рдкрд╛рд░рджрд░реНрд╢реА рд╣реИ, рд╣рдо рддреАрди рдореБрдЦреНрдп рд╡рд░реНрдЧреЛрдВ рдкрд░ рд╕рд╣реА рдЬрд╛рдПрдВрдЧреЗ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдПрдиреАрдореЗрд╢рди рд╣реЛрддрд╛ рд╣реИред </p><br><h2 id="class-customcontrollercontext-nsobject-uiviewcontrollercontexttransitioning"> <code>class CustomControllerContext: NSObject, UIViewControllerContextTransitioning</code> </h2> <br><p>  рдПрдиреАрдореЗрд╢рди рдХрд╛ рд╕рдВрджрд░реНрднред  рдЗрд╕рдХреЗ рдХрд╛рд░реНрдп рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо <code>UIViewControllerContextTransitioning</code> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреА рдорджрдж рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░рддреЗ рд╣реИрдВ: </p><br><blockquote>  рдПрдХ рд╕рдВрджрд░реНрдн рд╡рд╕реНрддреБ рд╕рдВрдХреНрд░рдордг рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╡рд┐рдЪрд╛рд░реЛрдВ рдФрд░ рджреГрд╢реНрдп рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд╕рдВрд▓рдЧреНрди рдХрд░рддреА рд╣реИред  рдЗрд╕рдореЗрдВ рд╕рдВрдХреНрд░рдордг рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рддрд░реАрдХреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рднреА рд╡рд┐рд╡рд░рдг рд╣реИред </blockquote><p>  рд╕рдмрд╕реЗ рджрд┐рд▓рдЪрд╕реНрдк рдмрд╛рдд рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЗ рдЕрдиреБрдХреВрд▓рди рдкрд░ рдкреНрд░рддрд┐рдмрдВрдз рд╣реИ: </p><br><blockquote>  рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдЕрдкрдиреА рдХрдХреНрд╖рд╛рдУрдВ рдореЗрдВ рди рдЕрдкрдирд╛рдПрдВ рдФрд░ рди рд╣реА рдЗрд╕ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдЕрдкрдирд╛рдиреЗ рд╡рд╛рд▓реА рд╡рд╕реНрддреБрдУрдВ рдХрд╛ рд╕реАрдзреЗ рдирд┐рд░реНрдорд╛рдг рдХрд░реЗрдВред </blockquote><p>  рд▓реЗрдХрд┐рди рд╣рдореЗрдВ рдорд╛рдирдХ рдПрдиреАрдореЗрд╢рди рдЗрдВрдЬрди рдХреЛ рдЪрд▓рд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЗрд╕реЗ рд╡реИрд╕реЗ рднреА рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдЗрд╕рдХрд╛ рдХреЛрдИ рддрд░реНрдХ рдирд╣реАрдВ рд╣реИ, рдпрд╣ рдХреЗрд╡рд▓ рд░рд╛рдЬреНрдп рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдореИрдВ рдЗрд╕реЗ рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдирд╣реАрдВ рд▓рд╛рдКрдВрдЧрд╛ред  рдЖрдк рдЗрд╕реЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">GitHub</a> рдкрд░ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдпрд╣ рд╕рдордп-рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдПрдирд┐рдореЗрд╢рди рдкрд░ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЗрдВрдЯрд░реЗрдХреНрдЯрд┐рд╡ рдПрдирд┐рдореЗрд╢рди рдХреЗ рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╕рдордп, рдПрдХ рд╕рдорд╕реНрдпрд╛ рдЙрддреНрдкрдиреНрди рд╣реЛрддреА рд╣реИ - <code>UIPercentDrivenInteractiveTransition</code> рд╕рдВрджрд░реНрдн рдкрд░ рдПрдХ <code>UIPercentDrivenInteractiveTransition</code> рд╡рд┐рдзрд┐ рдХреЛ рдЖрдордВрддреНрд░рд┐рдд рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рдПрдХрдорд╛рддреНрд░ рд╕рд╣реА рд╕рдорд╛рдзрд╛рди рдПрдХ рдФрд░ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХреЛ рдЕрдиреБрдХреВрд▓рд┐рдд рдХрд░рдирд╛ рд╣реИ - <code>UIViewControllerInteractiveTransitioning</code> рдЕрдкрдиреЗ рд╕реНрд╡рдпрдВ рдХреЗ рд╕рдВрджрд░реНрдн рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдПред </p><br><h2 id="class-percentdriveninteractivetransition-nsobject-uiviewcontrollerinteractivetransitioning"> <code>class PercentDrivenInteractiveTransition: NSObject, UIViewControllerInteractiveTransitioning</code> </h2> <br><p>  рдпрд╣рд╛рдБ рдпрд╣ рд╣реИ - рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХрд╛ рджрд┐рд▓, рдХрд╕реНрдЯрдо рдПрдирд┐рдореЗрд╢рди рдХреЛ рдХрд╕реНрдЯрдо рдХрдВрдЯреЗрдирд░ рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдореЗрдВ рдореМрдЬреВрдж рд╣реЛрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред  рдЗрд╕реЗ рдХреНрд░рдо рдореЗрдВ рд▓реЗрддреЗ рд╣реИрдВред </p><br><p>  рд╡рд░реНрдЧ рдХреЛ <code>UIViewControllerAnimatedTransitioning</code> рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд╕рд╛рде рдЖрд░рдВрдн рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдирд┐рдпрдВрддреНрд░рдХреЛрдВ рдХреЗ рдмреАрдЪ рд╕рдВрдХреНрд░рдордг рдХреЛ рдПрдирд┐рдореЗрдЯ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдорд╛рдирдХ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╣реИред  рдЗрд╕ рддрд░рд╣ рд╣рдо рдЕрдкрдиреА рдХрдХреНрд╖рд╛ рдХреЗ рд╕рд╛рде рдкрд╣рд▓реЗ рд╕реЗ рд▓рд┐рдЦреЗ рдХрд┐рд╕реА рднреА рдПрдирд┐рдореЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><pre> <code class="hljs objectivec">init(with animator: <span class="hljs-built_in"><span class="hljs-built_in">UIViewControllerAnimatedTransitioning</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.animator = animator }</code> </pre> <br><p>  рд╕рд╛рд░реНрд╡рдЬрдирд┐рдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ, рдЪрд╛рд░ рд╡рд┐рдзрд┐рдпрд╛рдВ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рд╕реНрдкрд╖реНрдЯ рд╣реЛрдиреА рдЪрд╛рд╣рд┐рдПред </p><br><p>  рдПрдиреАрдореЗрд╢рди рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ рдПрдХ рд╣реА рдХреНрд╖рдг рдХреЛ рдзреНрдпрд╛рди рдореЗрдВ рд░рдЦрдирд╛ рд╣реИ, рд╣рдо рдХрдВрдЯреЗрдирд░ рдХреЗ рдореВрд▓ рджреГрд╢реНрдп рдХреЛ рд▓реЗрддреЗ рд╣реИрдВ рдФрд░ рдкрд░рдд рдХреА рдЧрддрд┐ 0 рдкрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдореЗрдВ рдореИрдиреНрдпреБрдЕрд▓ рд░реВрдк рд╕реЗ рдПрдиреАрдореЗрд╢рди рдХреА рдкреНрд░рдЧрддрд┐ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рдиреЗ рдХреА рдХреНрд╖рдорддрд╛ рдорд┐рд▓рддреА рд╣реИред </p><br><pre> <code class="hljs pgsql">// MARK: - <span class="hljs-built_in"><span class="hljs-built_in">Public</span></span> func startInteractiveTransition(_ transitionContext: UIViewControllerContextTransitioning) { self.transitionContext = transitionContext transitionContext.containerView.superview?.layer.speed = <span class="hljs-number"><span class="hljs-number">0</span></span> animator.animateTransition(<span class="hljs-keyword"><span class="hljs-keyword">using</span></span>: transitionContext) } func updateInteractiveTransition(percentComplete: CGFloat) { setPercentComplete(percentComplete: (CGFloat(fmaxf(fminf(<span class="hljs-type"><span class="hljs-type">Float</span></span>(percentComplete), <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>)))) } func cancelInteractiveTransition() { transitionContext?.cancelInteractiveTransition() completeTransition() } func finishInteractiveTransition() { transitionContext?.finishInteractiveTransition() completeTransition() }</code> </pre> <br><p>  рдЕрдм рд╣рдо рдЕрдкрдиреА рдХрдХреНрд╖рд╛ рдХреЗ рдирд┐рдЬреА рд▓реЙрдЬрд┐рдХ рдмреНрд▓реЙрдХ рдХреА рдУрд░ рд░реБрдЦ рдХрд░рддреЗ рд╣реИрдВред </p><br><p>  <code>setPercentComplete</code> рдкрд░рдд рдХреЗ рд▓рд┐рдП рдПрдиреАрдореЗрд╢рди рдХреА рдкреНрд░рдЧрддрд┐ рдХрд╛ рд╕рдордп рдСрдлрд╕реЗрдЯ рд╕реЗрдЯ рдХрд░рддрд╛ рд╣реИ, рдкреВрд░рд╛ рд╣реЛрдиреЗ рдФрд░ рдПрдиреАрдореЗрд╢рди рдХреА рдЕрд╡рдзрд┐ рдХреЗ рдкреНрд░рддрд┐рд╢рдд рд╕реЗ рдореВрд▓реНрдп рдХреА рдЧрдгрдирд╛ рдХрд░рддрд╛ рд╣реИред </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPercentComplete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(percentComplete: CGFloat)</span></span></span></span> { setTimeOffset(timeOffset: <span class="hljs-type"><span class="hljs-type">TimeInterval</span></span>(percentComplete) * duration) transitionContext?.updateInteractiveTransition(percentComplete) } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setTimeOffset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(timeOffset: TimeInterval)</span></span></span></span> { transitionContext?.containerView.superview?.layer.timeOffset = timeOffset }</code> </pre> <br><p>  рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдиреЗ рдЕрдкрдиреЗ рдЗрд╢рд╛рд░реЗ рдХреЛ рдмрдВрдж рдХрд░ рджрд┐рдпрд╛ рд╣реИ, рддреЛ <code>completeTransition</code> рдХреЛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣рд╛рдВ рд╣рдо <code>CADisplayLink</code> рдХреНрд▓рд╛рд╕ рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдмрдирд╛рддреЗ рд╣реИрдВ, рдЬреЛ рд╣рдореЗрдВ рдЙрд╕ рдмрд┐рдВрджреБ рд╕реЗ рдЦреВрдмрд╕реВрд░рддреА рд╕реЗ рдПрдиреАрдореЗрд╢рди рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдЧрд╛ рдЬрдм рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдм рдЕрдкрдиреА рдкреНрд░рдЧрддрд┐ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред  рд╣рдо рдЕрдкрдиреЗ <code>displayLink</code> рдХреЛ <code>run loop</code> рдЬреЛрдбрд╝рддреЗ рд╣реИрдВ рддрд╛рдХрд┐ рдЬрдм рднреА рдбрд┐рд╡рд╛рдЗрд╕ рдХреА рд╕реНрдХреНрд░реАрди рдкрд░ рдПрдХ рдирдпрд╛ рдлреНрд░реЗрдо рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ, рддреЛ рд╕рд┐рд╕реНрдЯрдо рд╣рдорд╛рд░реЗ рдЪрдпрдирдХрд░реНрддрд╛ рдХреЛ рдХреЙрд▓ рдХрд░реЗред </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">completeTransition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { displayLink = <span class="hljs-type"><span class="hljs-type">CADisplayLink</span></span>(target: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, selector: #selector(tickAnimation)) displayLink!.add(to: .main, forMode: .commonModes) }</code> </pre> <br><p>  рд╣рдорд╛рд░реЗ рдЪрдпрдирдХрд░реНрддрд╛ рдореЗрдВ, рд╣рдо рдПрдиреАрдореЗрд╢рди рдХреА рдкреНрд░рдЧрддрд┐ рдХреЗ рдЕрд╕реНрдерд╛рдпреА рд╡рд┐рд╕реНрдерд╛рдкрди рдХреА рдЧрдгрдирд╛ рдФрд░ рд╕реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдордиреЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЗрд╢рд╛рд░реЗ рдХреЗ рджреМрд░рд╛рди рдХрд┐рдпрд╛ рдерд╛, рдпрд╛ рд╣рдо рдПрдиреАрдореЗрд╢рди рдХреЛ рдкреВрд░рд╛ рдХрд░рддреЗ рд╣реИрдВ рдЬрдм рдпрд╣ рдЕрдкрдиреЗ рдкреНрд░рд╛рд░рдВрдн рдпрд╛ рдЕрдВрдд рдмрд┐рдВрджреБ рддрдХ рдкрд╣реБрдВрдЪрддрд╛ рд╣реИред </p><br><pre> <code class="hljs coffeescript">@objc private func tickAnimation() { var timeOffset = self.timeOffset() let tick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(displayLink?.duration ?? </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> * TimeInterval</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(completionSpeed)</span></span></span><span class="hljs-function"> timeOffset += </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(transitionContext?.transitionWasCancelled ?? </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">false</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> ? -tick : tick; if </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(timeOffset &lt; </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params"> || timeOffset &gt; duration)</span></span></span><span class="hljs-function"> { transitionFinished</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> } else { setTimeOffset</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(timeOffset: timeOffset)</span></span></span><span class="hljs-function"> } } private func timeOffset</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> -&gt;</span></span> TimeInterval { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> transitionContext?.containerView.superview?.layer.timeOffset ?? <span class="hljs-number"><span class="hljs-number">0</span></span> }</code> </pre> <br><p>  рдПрдиреАрдореЗрд╢рди рдХреЛ рд╕рдорд╛рдкреНрдд рдХрд░рддреЗ рд╣реБрдП, рд╣рдо рдЕрдкрдиреЗ <code>displayLink</code> рдмрдВрдж рдХрд░ рджреЗрддреЗ <code>displayLink</code> , рдкрд░рдд рдХреА рдЧрддрд┐ рд╡рд╛рдкрд╕ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдпрджрд┐ рдПрдиреАрдореЗрд╢рди рдХреЛ рд░рджреНрдж рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЕрд░реНрдерд╛рдд, рдпрд╣ рдЕрдкрдиреЗ рдЕрдВрддрд┐рдо рдлреНрд░реЗрдо рдкрд░ рдкрд╣реБрдВрдЪ рдЧрдпрд╛ рд╣реИ, рд╣рдо рдЙрд╕ рд╕рдордп рдХреА рдЧрдгрдирд╛ рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рд╕рд╕реЗ рдкрд░рдд рдХрд╛ рдПрдиреАрдореЗрд╢рди рд╢реБрд░реВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЖрдк рдЗрд╕рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреЛрд░ рдПрдирд┐рдореЗрд╢рди рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рдЧрд╛рдЗрдб рдореЗрдВ рдпрд╛ рд╕реНрдЯреИрдХрдУрд╡рд░рдлреНрд▓реЛ рдХреЗ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЬрд╡рд╛рдм</a> рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рди рд╕рдХрддреЗ рд╣реИрдВред </p><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">transitionFinished</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { displayLink?.invalidate() <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> layer = transitionContext?.containerView.superview?.layer <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } layer.speed = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> wasNotCanceled = !(transitionContext?.transitionWasCancelled ?? <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (wasNotCanceled) { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pausedTime = layer.timeOffset layer.timeOffset = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> timeSincePause = layer.convertTime(<span class="hljs-type"><span class="hljs-type">CACurrentMediaTime</span></span>(), from: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) - pausedTime layer.beginTime = timeSincePause } animator.animationEnded?(wasNotCanceled) }</code> </pre> <br><h2 id="class-animatedtransitioning-nsobject-uiviewcontrolleranimatedtransitioning"> <code>class AnimatedTransitioning: NSObject, UIViewControllerAnimatedTransitioning</code> </h2> <br><p>  рдЕрдВрддрд┐рдо рд╡рд░реНрдЧ рдЬрд┐рд╕рдХреА рд╣рдордиреЗ рдЕрднреА рддрдХ рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХреА рд╣реИ, рд╡рд╣ рд╣реИ <code>UIViewControllerAnimatedTransitioning</code> рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рдХрд╛ рдХреНрд░рд┐рдпрд╛рдиреНрд╡рдпрди, рдЬрд┐рд╕рдореЗрдВ рд╣рдо рдЕрдкрдиреЗ рдПрдиреАрдореЗрд╢рди <code>addTo</code> , <code>prepare</code> , <code>animation</code> , <code>finalize</code> рдХреЗ рдкреНрд░реЛрдЯреЛрдХреЙрд▓ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреНрд░рдо рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдпрд╣рд╛рдВ рд╕рдм рдХреБрдЫ рдХрд╛рдлреА prosaic рд╣реИ, рдпрд╣ рдЕрдзрд┐рдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ <code>UIView.animate(withDuration:animations:)</code> рдмрдЬрд╛рдп рдПрдиреАрдореЗрд╢рди рдкреНрд░рджрд░реНрд╢рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЗрд╡рд▓ <code>UIViewPropertyAnimator</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд╛рдпрдХ рд╣реИред  рдРрд╕рд╛ рдЗрд╕рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рддрд╛рдХрд┐ рдПрдиреАрдореЗрд╢рди рдХреА рдкреНрд░рдЧрддрд┐ рдХреЛ рдФрд░ рдЕрдзрд┐рдХ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХреЗ, рдФрд░ рдпрджрд┐ рдЗрд╕реЗ рд░рджреНрдж рдХрд░ рджрд┐рдпрд╛ рдЬрд╛рдП, рддреЛ рдЗрд╕реЗ <code>finishAnimation(at: .start)</code> рдЕрдкрдиреА <code>finishAnimation(at: .start)</code> рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд▓реМрдЯрд╛рдПрдВред рдЗрд╕реЗ <code>finishAnimation(at: .start)</code> , рдЬреЛ рд╕реНрдХреНрд░реАрди рдкрд░ рдПрдиреАрдореЗрд╢рди рдХреЗ рдЕрдВрддрд┐рдо рдлреНрд░реЗрдо рдХреЗ рдЕрдирд╛рд╡рд╢реНрдпрдХ <code>finishAnimation(at: .start)</code> рд╕реЗ рдмрдЪрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><h2 id="epilog">  рдЙрдкрд╕рдВрд╣рд╛рд░ </h2><br><p>  рд╣рдордиреЗ рд╕реНрдиреИрдкрдЪреИрдЯ рдХреЗ рд╕рдорд╛рди рд╣реА рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХрд╛ рдПрдХ рдХрд╛рдордХрд╛рдЬреА рдбреЗрдореЛ рдмрдирд╛рдпрд╛ рд╣реИред  рдЕрдкрдиреЗ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ, рдореИрдВрдиреЗ рд╕реНрдерд┐рд░рд╛рдВрдХ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рддрд╛рдХрд┐ рдХрд╛рд░реНрдб рдХреЗ рджрд╛рдИрдВ рдФрд░ рдмрд╛рдИрдВ рдУрд░ рдлрд╝реАрд▓реНрдб рд╣реЛрдВ, рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдореИрдВрдиреЗ рдХрд╛рд░реНрдб рдХреЗ рдкреАрдЫреЗ рдПрдХ рдкреНрд░рднрд╛рд╡ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреГрд╖реНрдарднреВрдорд┐ рджреГрд╢реНрдп рдкрд░ рдХреИрдорд░рд╛ рдЫреЛрдбрд╝ рджрд┐рдпрд╛ред  рдпрд╣ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреА рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдпрд╣ рдбрд┐рд╡рд╛рдЗрд╕ рдХреЗ рдкреНрд░рджрд░реНрд╢рди рдХреЛ рдХреИрд╕реЗ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░реЗрдЧрд╛ рдФрд░ рдореИрдВрдиреЗ рдЗрд╕рдХреА рдмреИрдЯрд░реА рдЪрд╛рд░реНрдЬ рдХреА рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХреАред </p><br><p>   тАФ        ,    -  ,          .      ,    -    . </p><br><p>      GitHub  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="></a> . </p><br><p>   ,   ,  ,  ! </p><br><p><img src="https://habrastorage.org/webt/mh/se/2z/mhse2z7hfck6aicbobu-vwyi9bw.gif"></p><br><h2 id="istochniki-informacii">   </h2><br><p>        : </p><br><ol><li><p>  Custom Container View Controller Transitions,  Joachim Bondo. </p><br><p>        Objective C.          Swift. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="></a> </p><br></li><li><p>  Interactive Custom Container View Controller Transitions,  Alek ├Еstr├╢m </p><br><p>               ,   Objective C,           Swift. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="></a> </p><br></li><li><p> <code>SwipeableTabBarController</code> </p> <br><p> ,            <code>UITabBarController</code> .      . </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u="></a> </p><br></li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi415795/">https://habr.com/ru/post/hi415795/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi415783/index.html">рд╕реНрдЯрд╛рд░ рдбрд┐рд╕реНрдХ рд╣рдореЗрдВ рдЧреНрд░рд╣реЛрдВ рдХреА рдЙрдкрд╕реНрдерд┐рддрд┐ рдХреЗ рд░рд╣рд╕реНрдпреЛрдВ рдХреЛ рдкреНрд░рдХрдЯ рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi415785/index.html">рд╕реНрдкреЗрд╕рдПрдХреНрд╕ ISS рдХреЛ рдХреГрддреНрд░рд┐рдо рдмреБрджреНрдзрд┐рдорддреНрддрд╛ рд░реЛрдмреЛрдЯ рднреЗрдЬрддрд╛ рд╣реИ</a></li>
<li><a href="../hi415789/index.html">рдХрдВрдкреНрдпреВрдЯрд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рд▓рд┐рдП рдкреЗрдЯреЗрдВрдЯ рдПрд▓реНрдЧреЛрд░рд┐рджрдо</a></li>
<li><a href="../hi415791/index.html">рд╕реНрдорд╛рд░реНрдЯ рдХреЙрдиреНрдЯреНрд░реИрдХреНрдЯ рдХрд╛ рдЕрдиреБрдХреВрд▓рдиред рдХреИрд╕реЗ рд╕реЙрд▓рд┐рдбрд┐рдЯреА рдкреНрд░рдХрд╛рд░ рд▓реЗрдирджреЗрди рд▓рд╛рдЧрдд рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░рддрд╛ рд╣реИ</a></li>
<li><a href="../hi415793/index.html">рдкреВрд░рд╛ рдбреЛрдореЗрди рдмреИрдХрдСрд░реНрдбрд░ рдЧрд╛рдЗрдб</a></li>
<li><a href="../hi415797/index.html">рдирд┐рдпрдорд┐рдд рдЕрднрд┐рд╡реНрдпрдХреНрддрд┐ + рддрд╛рд░реНрдХрд┐рдХ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧред рдкрд░рд┐рдгрд╛рдо рдХреНрдпрд╛ рд╣реИ?</a></li>
<li><a href="../hi415801/index.html">Google: рд╣рдорд╛рд░рд╛ "рдлрд╝реЛрди" AI рдЦрддрд░рдирд╛рдХ рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рдирд╣реАрдВ рд╣реИ</a></li>
<li><a href="../hi415805/index.html">рдЗрдВрдЯрд░рдиреЗрдЯ рдирд┐рдпрдВрддреНрд░рдг рдХреЗ рд▓рд┐рдП рдбреЛрд░рд╣рд╛рди рдЬреАрдПрд╕рдПрдо рдмрд╛рдзрд╛ рдореЙрдбреНрдпреВрд▓ рдХрд╛ рд╕рдВрд╢реЛрдзрди</a></li>
<li><a href="../hi415809/index.html">рдПрдЯрд▓рд╕рд┐рдпрди рдЬреАрд░рд╛ рдХреЗ рд▓рд┐рдП рдкреНрд▓рдЧрдЗрдиреНрд╕ рдореЗрдВ рд╕реЛрдпрд╛, рдЖрд╡рд╢реНрдпрдХрддрд╛, рдмреИрдХрдмреЛрди рдЬреЗрдПрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ</a></li>
<li><a href="../hi415811/index.html">рдПрдЖрдИ, рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдкрд╛рдареНрдпрдХреНрд░рдоред рдЫрд╡рд┐ рд╡рд░реНрдЧреАрдХрд░рдг рдХреЗ рд▓рд┐рдП рддрдВрддреНрд░рд┐рдХрд╛ рдиреЗрдЯрд╡рд░реНрдХ рдХрд╛ рдЕрд╡рд▓реЛрдХрди</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>