<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌘 🚄 🐵 Tri du drapeau américain 💕 👇🏽 🧝🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pour comprendre le principe de fonctionnement de ce tri «multibande», il est plus simple de commencer avec l'exemple d'un drapeau à trois bandes. Et a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tri du drapeau américain</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/edison/blog/481304/"><div style="text-align:center;"><img width="690" height="410" src="https://habrastorage.org/webt/3c/qf/bc/3cqfbc2j6t1knu0g3onxuvrgve8.png"></div><br>  Pour comprendre le principe de fonctionnement de ce tri «multibande», il est plus simple de commencer avec l'exemple d'un drapeau à trois bandes.  Et afin de gérer facilement le drapeau tricolore, il est préférable de voir d'abord comment cela fonctionne avec l'exemple bicolore.  <s>Et pour faire face aux deux couleurs ...</s> <a name="habracut"></a><blockquote> <a href="https://www.edsd.ru/" title="Logiciel EDISON - développement web"><img align="left" width="153" height="75" src="https://habrastorage.org/webt/w0/zl/to/w0zltoxvysbr0yeinstkfvw1wbg.png" alt="Logiciel EDISON - développement web"></a> <br clear="right">  Cet article a été écrit avec le soutien d'EDISON. <br><br>  Nous sommes engagés dans le <a href="https://www.edsd.ru/ru/uslugi/portirovanie-i-migracija">portage et la migration de logiciels</a> , ainsi que dans le <a href="https://www.edsd.ru/ru/proekty/mobilnye_prilozhenija">développement d'applications mobiles Android et iOS</a> . <br><br>  Nous aimons la théorie des algorithmes!  ;-) </blockquote><h2>  Drapeau bicolore </h2><br><img align="left" width="210" height="140" src="https://habrastorage.org/webt/rw/ya/rz/rwyarz78jggve0idacvf3k6jxs0.png"><br clear="right">  Tout d'abord, considérons le cas où les nombres dans le tableau trié sont distribués en seulement deux bits.  Pour simplifier, nous supposons que nous avons un tableau de zéros (ordre faible) et de uns (ordre élevé). <br><br>  Ainsi, nous n'avons que deux «bandes»: dans l'une nous déplacerons les bits les moins significatifs (zéros), et dans l'autre les bits les plus élevés (unités).  Tout drapeau bicolore fera l'objet d'une démonstration.  Par exemple, le drapeau de l'Ukraine. <br><br><img width="740" height="94" src="https://habrastorage.org/webt/av/g1/6q/avg16qxef8rxv9etteutswrkrke.gif"><br><br>  Que se passe-t-il ici?  Puisqu'au premier stade, on ne sait pas combien de zéros et combien d'unités nous avons, il n'est donc pas clair dans quelles tailles chacune des «bandes» se retrouvera.  Par conséquent, nous mettons deux pointeurs sur les clés du tableau.  Pour l'ordre inférieur, le pointeur est placé au début du tableau, pour l'ordre élevé à la fin.  Ensuite, nous faisons un seul passage à travers le tableau de gauche à droite et regardons chaque élément de bit. <br><br>  Si pendant le passage un élément est égal à l'ordre le plus élevé, alors le deuxième pointeur nous indique où transférer cet élément (on fait un échange).  Le pointeur pour insérer l'élément suivant se déplace vers la gauche, la "bande" du chiffre supérieur s'est développée. <br><br>  S'il est égal au chiffre le moins significatif, nous déplaçons le pointeur correspondant d'un élément vers la droite.  Comme nous n'avons que deux chiffres, il n'est pas nécessaire de transférer l'élément, il est déjà à sa place.  La «bande» pour la catégorie plus jeune s'est naturellement élargie. <br><br>  En conséquence, deux pointeurs se déplaçant l'un vers l'autre entreront en collision en un point, et les décharges seront ordonnées dans leurs «bandes».  Dans le même temps, vous n'aurez pas besoin de traverser l'ensemble du tableau - lorsque les pointeurs se rencontrent quelque part au milieu, l'algorithme fera son travail. <br><br><h2>  Le problème du drapeau national néerlandais :: Le problème du drapeau national néerlandais </h2><br><img align="left" width="210" height="140" src="https://habrastorage.org/webt/qq/cm/rv/qqcmrvjuvvyqo7ihytacypnh1li.png"><br clear="right">  Nous compliquons légèrement la tâche, considérons non pas deux chiffres, mais trois.  Faisons en sorte que les éléments du tableau appartiennent aux chiffres les plus bas (zéros), moyens (unités) et supérieurs (deux). <br><br>  Pour démonstration, nous prenons le drapeau à trois voies rouge-blanc-bleu de la <s>France, le</s> <s>Luxembourg de la</s> <s>Russie, le</s> <s>Schleswig-Goldstein des</s> Pays <s>-</s> Bas.  Pourquoi exactement le drapeau des Pays-Bas?  Parce que Edsger Dijkstra dans ses conférences sur l'exemple de ce drapeau a examiné l'algorithme correspondant, qui a été appelé "la tâche du drapeau national néerlandais". <br><br><img width="735" height="95" src="https://habrastorage.org/webt/yl/hy/b6/ylhyb69kavw2mki9nmk0_idsxcq.gif"><br><br>  Comme vous pouvez le voir, il n'y a rien de particulièrement nouveau.  Chaque catégorie a son propre pointeur.  Initialement, les étiquettes pour le junior et le milieu prennent les positions de départ au début du tableau et se déplacent vers la droite lorsque l'élément correspondant est rencontré.  Le pointeur pour l'ordre supérieur est le premier à la fin du tableau et se déplace vers la gauche. <br><br>  Le passage dans le tableau sera également incomplet en fait, si les bits sont répartis plus ou moins uniformément, alors l'algorithme passera par 2/3 du tableau avant de disperser tous les éléments dans ses «bandes». <br><br><h2>  Tri par drapeau américain :: Tri par drapeau américain </h2><br><img align="left" width="285" height="150" src="https://habrastorage.org/webt/2u/bb/hq/2ubbhq_rmqqxo6hj9blipmfppnq.png"><br clear="right">  Maintenant, dans nos explications, nous pouvons passer au drapeau américain multibande. <br><br>  Lorsque nous n'avons pas deux, pas trois, mais un nombre quelconque de chiffres, nous fixons où chaque chiffre doit commencer (sa «bande») et redessinons les éléments dans leurs «bandes». <br><br>  Dans cet algorithme, les nombres ne sont généralement pas considérés comme décimaux, mais avec une profondeur de bits différente, le plus souvent une puissance de deux.  Souvent, le nombre 256 est pris comme base pour la profondeur de bits (un peu moins souvent que 128), ce qui vous permet d'adapter efficacement le tri pour organiser les chaînes.  Pour les nombres pour la profondeur de bits, il est plus pratique de prendre de petits 2 <sup>n</sup> (2, 4, 16, etc.), ce qui vous permet de comparer en décalant par bits, au lieu d'augmenter à une puissance lors de la comparaison des nombres décimaux. <br><br>  L'animation montre un exemple de profondeur de bits avec base 16: <br><br><img width="740" height="328" src="https://habrastorage.org/webt/tm/mf/lk/tmmflkyrfqa3bqrlucv8y-rzcfk.gif"><br><br><ol><li>  Lors de la première passe - recherchez le maximum afin de déterminer le nombre maximum de bits parmi les éléments du tableau (afin d'extraire correctement les bits déterminés à partir du compte des éléments). </li><li>  Ensuite, un traitement récursif se produit.  Lorsqu'il est appelé, les limites du sous-tableau et le bit traité actuel sont indiqués.  Au premier appel, le tableau entier est un sous-tableau; le tout premier bit à gauche est pris. </li><li>  Parmi les éléments du sous-tableau, un calcul initial est effectué - combien de fois chaque chiffre apparaît dans la catégorie actuelle.  Ce comptage vous permet de déterminer la localisation de ces chiffres des chiffres (c'est-à-dire, les limites et l'emplacement de la «bande» vers laquelle vous souhaitez déplacer les éléments qui ont le chiffre suivant dans un chiffre particulier sont connus).  En fait, les localisations sont des pointeurs vers des «bandes» où les éléments correspondants doivent être déplacés. </li><li>  Conformément aux pointeurs de localisation, un échange a lieu sur place - le chiffre dans la catégorie indique où l'article doit être envoyé, un autre élément avec lequel l'échange a eu lieu prend sa place.  Cette clause est exécutée jusqu'à ce que, lors du prochain échange, un élément arrivant d'un autre endroit ne soit pas à sa place (vous pouvez alors passer à l'élément suivant du sous-tableau et exécuter de la même manière cette clause pour lui). </li><li>  Après que, à la suite des échanges, les éléments ont été redistribués en blocs par des nombres dans le chiffre suivant, une récursivité a lieu - le même algorithme est appliqué à chaque bloc comme un sous-tableau, le suivant est pris comme le chiffre actuel. </li></ol><br>  Dans l'article sur le <a href="https://habr.com/ru/post/478654/">comptage des tris avec une distribution approximative,</a> il existe un algorithme visuellement très similaire - le <b>tri par approximation</b> .  Là, nous avons compté le nombre de fois où chaque numéro du tableau s'est produit - et redistribué les éléments en fonction des localisations obtenues.  Ici, nous comptons le nombre de fois où chaque chiffre de la catégorie se produit pour les éléments du sous-tableau - et nous redistribuons également les éléments du sous-tableau en fonction des localisations obtenues.  Si l'approximation est une sorte de tri de comptage, alors «américain» est un tri de bits de comptage. <br><br><div class="spoiler">  <b class="spoiler_title">Tri du drapeau américain - Implémentation de Python</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#           def get_radix_val(x, digit, radix) -&gt; int: return int(floor(x / radix**digit)) % radix #             def compute_offsets(a_list, start: int, end: int, digit, radix) -&gt; list: #          counts = [0 for _ in range(radix)] for i in range(start, end): #        #         val = get_radix_val(a_list[i], digit, radix) counts[val] += 1 #       #          offsets = [0 for _ in range(radix)] sum = 0 #         for i in range(radix): offsets[i] = sum sum += counts[i] return offsets #      def swap(a_list, offsets, start: int, end: int, digit, radix) -&gt; None: i = start #          next_free = copy(offsets) #        #   (       ) cur_block = 0 while cur_block &lt; radix-1: # if i &gt;= start + offsets[cur_block+1]: cur_block += 1 continue radix_val = get_radix_val(a_list[i], digit, radix) if radix_val == cur_block: i += 1 continue swap_to = next_free[radix_val] a_list[i], a_list[swap_to] = a_list[swap_to], a_list[i] next_free[radix_val] += 1 #   def american_flag_sort_helper(a_list, start: int, end: int, digit, radix) -&gt; None: #          offsets = compute_offsets(a_list, start, end, digit, radix) #      swap(a_list, offsets, start, end, digit, radix) if digit == 0: #     ? return #   #       for i in range(len(offsets)-1): #      #         american_flag_sort_helper(a_list, offsets[i], offsets[i+1], digit-1, radix) #   def american_flag_sort(a_list, radix) -&gt; None: #,         for x in a_list: assert(type(x) == int) #    max_val = max(a_list) #    (  ) max_digit = int(floor(log(max_val, radix))) #   -     american_flag_sort_helper(a_list, 0, len(a_list), max_digit, radix)</span></span></code> </pre> </div></div><br><h2>  Sort Ska :: Sort Ska </h2><br>  Le programmeur allemand, Malte Skarupke, a annoncé qu'il a développé un nouvel algorithme de tri, qui est un «drapeau américain» radicalement amélioré et surpasse <b>std :: sort</b> en moyenne 2 fois (std :: sort - un algorithme également connu sous le nom de <b>tri introspectif</b> - un hybride de <b>tri rapide</b> et de <b>tri par tas</b> ). <br><br><ol><li>  Le tableau est trié récursivement, au premier niveau de récursivité, l'ensemble du tableau est pris comme un sous-tableau. </li><li>  Si le sous-tableau a moins de 128 éléments, std :: sort est appelé pour cela. </li><li>  Si le sous-tableau contient de 128 à 1024 éléments, alors le tri du drapeau américain est appelé pour cela. </li><li>  S'il y a plus de 1024 éléments dans un sous-tableau, le tri ska est appelé pour cela. </li><li>  De plus, pour éviter le pire des cas, si l'imbrication récursive est trop grande (plus de 16 niveaux), l'algorithme passe à <nobr>std :: sort</nobr> , même s'il y a plus de 128 éléments dans le sous-tableau. </li></ol><br>  Apparemment, c'est un algorithme très efficace et en même temps extrêmement complexe - la mise en œuvre de son auteur prend près d'un mille et demi de lignes.  Peut-être envisagerons-nous un jour ce tri, maintenant nous n'y entrerons pas.  Les personnes intéressées peuvent cliquer sur les liens ci-dessous. <br><br><h2>  Les références </h2><br><img width="30" height="30" src="https://habrastorage.org/webt/3y/wq/mh/3ywqmhuo7fv68jggkc416kbzuw4.png">  <a href="https://en.wikipedia.org/wiki/Dutch_national_flag_problem">Problème du drapeau national néerlandais</a> , <a href="https://en.wikipedia.org/wiki/American_flag_sort">type de drapeau américain</a> <br><br>  <b>Tri Ska:</b> <img width="30" height="30" src="https://habrastorage.org/webt/-p/f7/fs/-pf7fshzu943ul4yvkrw2f4dv1g.png">  J'ai écrit un algorithme de tri plus rapide ( <a href="https://probablydance.com/2016/12/27/i-wrote-a-faster-sorting-algorithm/">partie 1</a> , <a href="https://probablydance.com/2017/01/17/faster-sorting-algorithm-part-2/">partie 2</a> ) <img width="30" height="30" src="https://habrastorage.org/webt/fn/cd/py/fncdpynfktllvkdjtmpif0kd1zc.png">  <a href="https://github.com/skarupke/ska_sort/">Code Github</a> <br><br><h3>  Articles de série: </h3><ul><li>  <a href="https://habr.com/post/414447/">Application Excel AlgoLab.xlsm</a> </li><li>  <a href="https://habr.com/post/414653/">Exchange Sorts</a> </li><li>  <a href="https://habr.com/post/415935/">Tri d'insertion</a> </li><li>  <a href="https://habr.com/post/422085/">Trier par sélection</a> </li><li>  <a href="https://habr.com/ru/post/431964/">Fusionner les tris</a> </li><li>  <a href="https://habr.com/ru/post/472466/">Trier par distribution</a> <ul><li>  <a href="https://habr.com/ru/post/478654/">Compter les tris avec une distribution approximative</a> </li><li>  <b>Tri du drapeau américain</b> </li><li>  Arborescence des suffixes dans le tri au niveau du bit </li><li>  Comparaison des tri par distribution </li></ul></li><li>  <a href="https://habr.com/ru/post/483786/">Tri hybride</a> </li></ul><br>  Dans l'application AlgoLab Excel, le tri par un drapeau bicolore (trie les zéros et les uns), un drapeau tricolore (trie les zéros, les uns et les égalités), le tri par le drapeau américain est apparu.  Pour trier le «drapeau américain», vous pouvez (dans un commentaire sur la cellule avec le nom de l'algorithme) spécifier le système numérique pour la distribution - la valeur par défaut est hexadécimale. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr481304/">https://habr.com/ru/post/fr481304/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr481288/index.html">Redux Toolkit comme outil pour un développement efficace de Redux</a></li>
<li><a href="../fr481290/index.html">COMMENT / Paramètres réseau et VLAN sur un serveur Hetzner et Mikrotik dédié</a></li>
<li><a href="../fr481294/index.html">10 meilleurs outils d'automatisation de test de logiciels</a></li>
<li><a href="../fr481296/index.html">Comment écrire du code qui sera réutilisé</a></li>
<li><a href="../fr481302/index.html">"À propos, oui pas un cluster" ou comme nous avons importé un SGBD</a></li>
<li><a href="../fr481306/index.html">Présentation de werf 1.0 stable: qu'est-ce que GitOps a à voir avec lui, son statut et ses plans</a></li>
<li><a href="../fr481312/index.html">Cadeaux perdus du Père Noël: annonce d'une quête informatique pour le 6 janvier</a></li>
<li><a href="../fr481314/index.html">Plateforme DIY Crawler pour robots et divertissement</a></li>
<li><a href="../fr481316/index.html">Rédaction d'un blog sur les microservices - Partie 4 Post Service</a></li>
<li><a href="../fr481318/index.html">Hacking avec Unicode (sur l'exemple de GitHub)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>