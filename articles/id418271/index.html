<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😵 🚂 🀄️ Hancurkan garis dengan pemisah. Sedikit tentang CONNECT BY 👨🏾‍🔬 📓 🦎</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo 

 Saya bekerja sebagai pengembang PL / SQL. Ada tugas untuk mengumpulkan beberapa data untuk metrik untuk melacak beban sistem. Ada beberapa fun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hancurkan garis dengan pemisah. Sedikit tentang CONNECT BY</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/418271/"> Halo <br><br>  Saya bekerja sebagai pengembang PL / SQL.  Ada tugas untuk mengumpulkan beberapa data untuk metrik untuk melacak beban sistem.  Ada beberapa fungsi yang disebut dengan parameter yang terdiri dari daftar ID. <br><br> <code>1,2,3,4…1001,1002,1003…</code> <br> <br>  Tugasnya adalah sebagai berikut.  Adalah perlu untuk memecah baris tersebut menjadi elemen-elemen dan menuliskannya ke dalam koleksi integer. <br><a name="habracut"></a><br>  Mari kita mulai. <br><br>  Pertama, Anda perlu data untuk bekerja.  Mari kita menulis fungsi yang menghasilkan string dengan angka yang dipisahkan oleh koma.  Kami akan memberikan argumen integer N ke fungsi - jumlah angka dalam urutan. <br><br>  Kami tidak akan pintar, kami akan melakukan urutan dengan tipe VARCHAR2, bukan CLOB.  Selanjutnya, saya akan menjelaskan mengapa VARCHAR2. <br><br>  Kode fungsi untuk menghasilkan urutan: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> createNumbers(v_N <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> PLS_INTEGER) <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> VARCHAR2 <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> v_str VARCHAR2(<span class="hljs-number"><span class="hljs-number">4000</span></span>) := <span class="hljs-string"><span class="hljs-string">'0'</span></span>; too_small EXCEPTION; <span class="hljs-keyword"><span class="hljs-keyword">PRAGMA</span></span> EXCEPTION_INIT(too_small, <span class="hljs-number"><span class="hljs-number">-6502</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> <span class="hljs-number"><span class="hljs-number">1.</span></span>.v_N <span class="hljs-keyword"><span class="hljs-keyword">LOOP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> v_str := v_str || <span class="hljs-string"><span class="hljs-string">','</span></span> || TO_CHAR(i); EXCEPTION WHEN too_small THEN EXIT; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOOP</span></span>; RETURN v_str || ','; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br>  Mari kita kembali ke tugas kita. <br><br>  Hal pertama yang terlintas dalam pikiran adalah untuk loop melalui garis, mengurangi panjang garis di setiap iterasi.  Karena, sesuai dengan kondisi masalah, hasilnya harus ditempatkan dalam koleksi, kami akan membuat koleksi yang sesuai. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> v_N PLS_INTEGER := <span class="hljs-number"><span class="hljs-number">1000</span></span>; v_str VARCHAR2(4000) := createNumbers(v_N =&gt; v_N); TYPE tab_number IS TABLE OF NUMBER(5); t_str tab_number := tab_number(); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHILE</span></span> v_str <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOOP</span></span> t_str.EXTEND; t_str(t_str.COUNT) := SUBSTR(v_str, 1, INSTR(v_str, ',', 1) - 1); v_str := SUBSTR(v_str, INSTR(v_str, ',', 1) + 1); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOOP</span></span>; FOR i IN t_str.FIRST..t_str.LAST LOOP dbms_output.put_line(t_str(i)); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOOP</span></span>; t_str.DELETE; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br>  Hasil: <br> <code>0 <br> 1 <br> 2 <br> … <br> 421 <br> 422 <br> 423 <br> … <br></code> <br>  Fungsi createNumber () mengambil argumen v_N = 1000. Dalam fungsi createNumber (), Anda dapat melihat penanganan overflow dari variabel v_str.  Dengan perhitungan sederhana, Anda dapat mengetahui bahwa 4000 byte cukup untuk 1021 angka.  1000 kami cocok dengan ukuran ini tanpa masalah. <br><br>  Seperti yang Anda lihat, hasilnya adalah yang dibutuhkan.  String terpecah. <br><br>  Meskipun Oracle tidak memiliki fungsi built-in split (), seperti Java atau Python, opsi ini tidak cocok untuk saya, karena saya percaya bahwa terlalu banyak kode yang ditulis untuk tugas sederhana seperti memisahkan string. <br><br>  Pada tahap ini, saya pikir, apakah mungkin untuk membagi string hanya menggunakan SQL?  Maksud saya bukan SQL klasik, tetapi SQL yang ditawarkan Oracle. <br><br>  Saya ingat desain untuk membangun hierarkis CONNECT BY query. <br><br><img src="https://docs.oracle.com/cd/B19306_01/server.102/b14200/img/hierarchical_query_clause.gif" alt="gambar"><br><br>  Pernyataan START WITH opsional memberi tahu Oracle tempat memulai loop, mis.  baris mana yang akan menjadi root.  Kondisinya bisa apa saja.  Kondisi setelah CONNECT BY harus ditentukan.  Di sini perlu untuk memberi tahu Oracle berapa lama untuk melanjutkan siklus. <br><br>  Dapat dilihat bahwa satu-satunya syarat penting untuk membangun kueri hierarkis adalah operator CONNECT BY, sisanya "dirangkai" sesuai kebutuhan. <br><br>  Juga, konstruksi ini memiliki tingkat pseudo-kolom, yang mengembalikan tingkat bersarang pada iterasi saat ini. <br><br>  Pada pandangan pertama, mungkin terlihat bahwa konstruksi ini tidak cocok untuk memutus garis.  Ini tidak sepenuhnya benar.  Jika kondisi diatur dengan benar, maka traversal rekursif dapat diubah menjadi siklus, seperti pada saat atau untuk loop. <br><br>  Sebelum menulis kueri, pertimbangkan algoritma garis-traversal.  Mulai dari awal baris, perlu untuk memotong sejumlah karakter, menjadi karakter pemisah.  Di atas, saya menulis tentang level pseudo-kolom.  Kami akan menggunakannya sebagai nomor iterasi saat ini. <br>  Ternyata sesuatu seperti ini: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>) - <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL;</code> </pre><br>  Tetapi jika Anda melihat lebih dekat, Anda dapat melihat bahwa algoritma ini tidak akan bekerja pada iterasi pertama, karena argumen ketiga ke fungsi INSTR () tidak boleh 0. <br><br>  Oleh karena itu, kami menambahkan kondisi kecil menggunakan fungsi DECODE (). <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">DECODE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">level</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>) - <span class="hljs-keyword"><span class="hljs-keyword">DECODE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">level</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL;</code> </pre><br>  Sekarang iterasi pertama akan bekerja dengan benar. <br><br>  Sudah waktunya untuk menerapkan CONNECT BY.  Ditambah lagi, kami mengambil baris kami. <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> TMain <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-string"><span class="hljs-string">'100,200,300,400,500'</span></span> || <span class="hljs-string"><span class="hljs-string">','</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">str</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">DECODE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">level</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>) - <span class="hljs-keyword"><span class="hljs-keyword">DECODE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">level</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TMain <span class="hljs-keyword"><span class="hljs-keyword">CONNECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> NVL(<span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>) &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br>  Saya sudah menulis bahwa, di bawah kondisi yang tepat, CONNECT BY dapat berperilaku seperti loop.  Kondisi terpenuhi sampai fungsi INSTR () dapat menemukan posisi ke-n dari karakter pembatas, di mana n adalah jumlah iterasi saat ini, dan seperti yang kita ingat, level pseudo-kolom bertanggung jawab atas nomor iterasi. <br><br>  Tampaknya masalah terpecahkan?  Tidak. <br><br>  Kode mungkin berfungsi, tetapi keterbacaannya nol.  Saya sudah berpikir untuk kembali ke opsi loop, tetapi saya menemukan cara untuk meningkatkan opsi CONNECT BY. <br><br>  Oracle memiliki alat yang sangat kuat sebagai ekspresi reguler.  Secara khusus, fungsi regexp_instr () dan regexp_substr (). <br><br>  <code>regexp_instr(_, [, _ [,  ] ])</code> - fungsi mengembalikan posisi karakter pada awal atau akhir pertandingan untuk pola, serta INSTR analognya (). <br><br>  <code>regexp_substr(_, [,  [,  ]])</code> - fungsi mengembalikan substring yang cocok dengan pola. <br><br>  Tulis ulang kueri menggunakan ekspresi reguler: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">WITH</span></span> TMain <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-string"><span class="hljs-string">'100,200,300,400,500'</span></span> || <span class="hljs-string"><span class="hljs-string">','</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">str</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL) <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> regexp_substr(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">'[^,]+'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> TMain <span class="hljs-keyword"><span class="hljs-keyword">CONNECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> NVL(regexp_instr(<span class="hljs-keyword"><span class="hljs-keyword">str</span></span>, <span class="hljs-string"><span class="hljs-string">'[^,]+'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>) &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>;</code> </pre><br>  Kode membaca jauh lebih baik daripada pada contoh sebelumnya.  Opsi ini cocok untuk saya. <br><br>  Pada akhirnya, akan lebih logis untuk membandingkan perbandingan parsing runtime untuk ketiga opsi.  Di atas, saya berjanji untuk menjelaskan mengapa alih-alih tipe CLOB kita akan menggunakan tipe VARCHAR2.  Ini hanya untuk membandingkan runtime.  Karena Oracle menangani tipe CLOB secara berbeda dari VARCHAR2, yang dapat mendistorsi hasil. <br><br><div class="spoiler">  <b class="spoiler_title">Kode untuk mengevaluasi tiga opsi:</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> v_N PLS_INTEGER := <span class="hljs-number"><span class="hljs-number">1000</span></span>; v_str VARCHAR2(32767); v_startTime TIMESTAMP(9); v_endTime TIMESTAMP(9); TYPE tab_number IS TABLE OF NUMBER(5); t_str tab_number := tab_number(); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> v_str := createNumbers(v_N =&gt; v_N); v_startTime := SYSTIMESTAMP; WHILE v_str IS NOT NULL LOOP t_str.EXTEND; t_str(t_str.COUNT) := SUBSTR(v_str, 1, INSTR(v_str, ',', 1) - 1); v_str := SUBSTR(v_str, INSTR(v_str, ',', 1) + 1); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOOP</span></span>; v_endTime := SYSTIMESTAMP; dbms_output.put_line(v_endTime - v_startTime); t_str.DELETE; <span class="hljs-comment"><span class="hljs-comment">/*---------------------------------------------------------*/</span></span> v_str := createNumbers(v_N =&gt; v_N); v_startTime := SYSTIMESTAMP; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TO_NUMBER(<span class="hljs-keyword"><span class="hljs-keyword">SUBSTR</span></span>(v_str, <span class="hljs-keyword"><span class="hljs-keyword">DECODE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">level</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(v_str, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(v_str, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>) - <span class="hljs-keyword"><span class="hljs-keyword">DECODE</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">level</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(v_str, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">1</span></span>))) <span class="hljs-keyword"><span class="hljs-keyword">BULK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COLLECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> t_str <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL <span class="hljs-keyword"><span class="hljs-keyword">CONNECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> NVL(<span class="hljs-keyword"><span class="hljs-keyword">INSTR</span></span>(v_str, <span class="hljs-string"><span class="hljs-string">','</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>) &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; v_endTime := SYSTIMESTAMP; dbms_output.put_line(v_endTime - v_startTime); t_str.DELETE; <span class="hljs-comment"><span class="hljs-comment">/*---------------------------------------------------------*/</span></span> v_str := createNumbers(v_N =&gt; v_N); v_startTime := SYSTIMESTAMP; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> TO_NUMBER(regexp_substr(v_str, <span class="hljs-string"><span class="hljs-string">'[^,]+'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">BULK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COLLECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> t_str <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> DUAL <span class="hljs-keyword"><span class="hljs-keyword">CONNECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> NVL(regexp_instr(v_str, <span class="hljs-string"><span class="hljs-string">'[^,]+'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">level</span></span>), <span class="hljs-number"><span class="hljs-number">0</span></span>) &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; v_endTime := SYSTIMESTAMP; dbms_output.put_line(v_endTime - v_startTime); t_str.DELETE; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br></div></div><br>  Hasilnya ditabulasikan: <br><table><tbody><tr><th>  Opsi Istirahat / Jumlah Angka </th><th>  10 </th><th>  100 </th><th>  1000 </th></tr><tr><td>  Siklus </td><td>  0,05 ms </td><td>  0,15 ms </td><td>  1,52 ms </td></tr><tr><td>  HUBUNGI OLEH </td><td>  0,18 ms </td><td>  0,68 ms </td><td>  18.1ms </td></tr><tr><td>  TERHUBUNG DENGAN + ekspresi reguler </td><td>  0,25 ms </td><td>  12.1 ms </td><td>  1s 137ms </td></tr></tbody></table><br>  Jujur saja, hasilnya tidak terduga untuk saya.  Saya berasumsi bahwa opsi ketiga adalah yang tercepat.  Nah, itu akan menjadi pelajaran. <br><br>  Terima kasih sudah membaca! <br><br>  Daftar sumber yang digunakan: <br><br>  1. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pertanyaan hierarkis (rekursif)</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id418271/">https://habr.com/ru/post/id418271/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id418261/index.html">Sarung tangan stun gun buatan sendiri - senjata untuk geek</a></li>
<li><a href="../id418263/index.html">Ilmuwan Rusia sedang mengembangkan sistem MEG yang ringkas dan murah</a></li>
<li><a href="../id418265/index.html">Organisasi interaksi jaringan antara mesin fisik dan virtual</a></li>
<li><a href="../id418267/index.html">Agustus Acara TI Digest</a></li>
<li><a href="../id418269/index.html">Cara Kerja Manajer CPU di Kubernetes</a></li>
<li><a href="../id418273/index.html">Alat pengembangan untuk platform Baikal-T1 beralih ke ALT distribusi Rusia</a></li>
<li><a href="../id418275/index.html">Pelajaran Pencetakan 3D. Mencetak model berdinding tipis dari 3Dtool</a></li>
<li><a href="../id418277/index.html">Perangkat bayangan kotak</a></li>
<li><a href="../id418279/index.html">Reset kata sandi pada Cisco ASA tanpa downtime untuk sirkuit failover aktif / siaga</a></li>
<li><a href="../id418281/index.html">Analisis Pekerjaan HeadHunter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>