<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêâ üíáüèø ü§∞üèø Prototypage d'un jeu mobile, par o√π commencer et comment le faire. Partie 3 (finale) üëµüèΩ ü•î ‚ùï</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans la premi√®re partie, j'ai expliqu√© pourquoi le prototypage et en g√©n√©ral par o√π commencer 
 - Partie 1 

 Dans la deuxi√®me partie, un petit tour d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Prototypage d'un jeu mobile, par o√π commencer et comment le faire. Partie 3 (finale)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453748/">  Dans la premi√®re partie, j'ai expliqu√© pourquoi le prototypage et en g√©n√©ral par o√π commencer <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 1</a> <br><br>  Dans la deuxi√®me partie, un petit tour d'horizon des classes cl√©s <br>  et architecture - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Partie 2</a> <br><br>  Et la troisi√®me partie - il y aura en fait une petite discussion, nous analyserons le fonctionnement des modificateurs, et nous laisser tomber sur le terrain de jeu (ce n'est pas difficile, mais il y a des nuances).  Et un peu d'architecture, je vais essayer sans ennui. <br><br>  Les captures d'√©cran sur la fus√©e sont g√©n√©ralement ternes, je sugg√®re donc de regarder une vid√©o d'un autre prototype, qui a √©t√© assembl√© en 2 semaines avec les graphiques, et a √©t√© abandonn√© car il n'y a aucun moyen de contourner le genre de jeu de plateforme.  Soit dit en passant, c'est l'une des id√©es cl√©s autour du prototype - assembler, voir si c'est de la merde, est-ce n√©cessaire?  Et jetez honn√™tement le panier si les r√©ponses ne vous semblent pas convaincantes.  Mais!  Cela ne s'applique pas aux projets cr√©atifs - parfois la cr√©ativit√© se produit pour la cr√©ativit√©). <br><br>  Alors vidosik, vous devez regarder les textes class√©s par niveau, et non pas le gameplay): <br><iframe width="560" height="315" src="https://www.youtube.com/embed/lY8e1igkzI0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><a name="habracut"></a><br><br><h3>  Petite digression </h3><br>  Dans le dernier article, j'ai re√ßu le code de r√©vision et j'en suis reconnaissant; la critique aide √† se d√©velopper m√™me si vous n'√™tes pas d'accord avec elle. <br><br>  <b>Mais je veux d√©ployer pour l'architecture et la syntaxe concernant les prototypes:</b> <br><ol><li>  Peu importe √† quel point vous √™tes cool, vous ne pouvez pas simplement pr√©voir qu'il ne sera pas hypoth√©qu√©, et il peut y avoir beaucoup d'hypoth√®ques de ce qui n'est pas n√©cessaire.  Par cons√©quent, dans tous les cas, une refactorisation ou une extension sera n√©cessaire.  Si vous ne pouvez pas d√©crire les avantages sp√©cifiques du code / de l'approche, il est pr√©f√©rable de ne pas consacrer beaucoup de temps √† ce code. </li><li>  Pourquoi √† mon avis, la POO / mod√®le d'√©v√©nement / composition est plus facile pour les prototypes que ECS, Unity COOP, DI FrameWorks, Frameworks r√©actifs, etc.  Moins de gribouillis, toutes les connexions sont visibles dans le code, car la t√¢che principale du prototype est de r√©pondre √† la question principale - est-il possible d'y jouer, et un certain nombre de secondaires - ce qui est mieux pour le gameplay, ceci ou cela.  Par cons√©quent, vous devez impl√©menter les fonctionnalit√©s n√©cessaires le plus rapidement possible.  Pourquoi introduire un framework sur un petit projet, prescrire toutes les ordures afin d'impl√©menter trois entit√©s de jeu?  Chacun d'eux est en fait une classe de 50 √† 100 lignes.  L'architecture doit √™tre pens√©e dans le cadre des t√¢ches du prototype, et dans le cadre d'une √©ventuelle extension √† alpha, mais la seconde est plus n√©cessaire dans la t√™te que dans le code pour que le code ne soit pas grav√© plus tard </li></ol><br><br><h3>  √Ä propos des modificateurs: </h3><br>  <b>Et enfin sur le modificateur lui-m√™me:</b> <br>  Ici et plus t√¥t, j'appelle les modificateurs les champs de force que la fus√©e touche et qui affectent sa trajectoire, dans le prototype il y en a deux types - l'acc√©l√©ration et la d√©viation. <br><br><div class="spoiler">  <b class="spoiler_title">Classe de modificateurs</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PushSideModificator</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] TypeOfForce typeOfForce = TypeOfForce.Push; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> force; [SerializeField] DropPanelConfig dropPanelConfig; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> boundsOfCollider; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTriggerEnter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Collider other)</span></span></span><span class="hljs-function"> </span></span>{ boundsOfCollider = other.bounds.extents.x; GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpaceForces { TypeOfForce = typeOfForce, Force = force, ColliderBound = boundsOfCollider, CenterOfObject = transform.position, IsAdded = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnTriggerExit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Collider other)</span></span></span><span class="hljs-function"> </span></span>{ GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SpaceForces { CenterOfObject = transform.position, IsAdded = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> }); } }</code> </pre> <br></div></div><br>  Il s'agit d'une classe tr√®s simple dont la t√¢che est de passer deux √©v√©nements: <br><ol><li>  Le coup du joueur sur le terrain (qui est en fait un d√©clencheur d'unit√© physique), et tout le contexte n√©cessaire - le type de modificateur, sa position, la taille du collisionneur, la force du modificateur, etc.  En plus de l'√©v√©nement de l'agr√©gateur, il peut transmettre n'importe quel contexte aux parties int√©ress√©es.  Dans cette veine, il s'agit d'un mod√®le de fus√©e qui traite le modificateur. </li><li>  Le deuxi√®me √©v√©nement - le joueur a quitt√© le terrain.  Pour supprimer son influence sur la trajectoire du joueur </li></ol><br>  <b>√Ä quoi sert le mod√®le d'√©v√©nement?</b>  <b>Qui d'autre pourrait avoir besoin de cet √©v√©nement?</b> <b><br></b>  <b>Dans le projet actuel, cela n'est pas mis en ≈ìuvre, mais:</b> <br><ol><li>  Jeu de voix (a re√ßu un √©v√©nement o√π quelqu'un est entr√© sur le terrain - nous jouons le son correspondant, quelqu'un est sorti - de m√™me) </li><li>  Marqueurs d'interface, disons que pour chaque champ, nous retirerons du carburant de la fus√©e, des info-bulles devraient appara√Ætre que nous sommes entr√©s dans le champ et que nous avons perdu du carburant, eh bien, ou gagner des points pour chaque coup sur le terrain, il existe de nombreuses options que l'interface int√©resse pour le joueur. le terrain. </li><li>  Sp√©cial  effets - lorsqu'ils sont touch√©s dans un type de champ diff√©rent, diff√©rents effets peuvent √™tre superpos√©s, √† la fois sur la fus√©e elle-m√™me et sur l'espace autour de la fus√©e / champ.  Sp√©cial  les effets peuvent √™tre g√©r√©s par une entit√© / un contr√¥leur s√©par√©, qui sera √©galement abonn√© aux √©v√©nements des modificateurs. </li><li>  Eh bien, c'est un minimum de code, les localisateurs de service, l'agr√©gation, les d√©pendances, etc. ne sont pas n√©cessaires. </li></ol><br><br><h3>  Base de jeu </h3><br>  Dans ce prototype, l'essence du gameplay est de placer des modificateurs sur le terrain de jeu, d'ajuster la trajectoire de vol de la fus√©e, de contourner les obstacles et d'atteindre le point / plan√®te de destination.  Pour ce faire, nous avons un panneau sur la droite, sur lequel se trouvent les ic√¥nes des modificateurs. <br><br><img src="https://habrastorage.org/webt/lj/eb/ga/ljebgar88u47kcyxyhz_6kzxyke.jpeg"><br><br><div class="spoiler">  <b class="spoiler_title">Classe de panneau</b> <div class="spoiler_text"><pre> <code class="java hljs"> [RequireComponent (typeof(CanvasGroup))] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DragAndDropModifiersPanel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropModifiersIcon iconPrfb; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropPanelConfig config; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CanvasGroup canvasGroup; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ GlobalEventAggregator.EventAggregator.AddListener&lt;ButtonStartPressed&gt;(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, RocketStarted); canvasGroup = GetComponent&lt;CanvasGroup&gt;(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RocketStarted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ButtonStartPressed obj)</span></span></span><span class="hljs-function"> </span></span>{ canvasGroup.DOFade(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); (canvasGroup.transform as RectTransform).DOAnchorPosX(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>; x++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mod = config.GetModifierByType(TypeOfForce.Push); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> go = Instantiate(iconPrfb, transform); go.Init(mod); } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>; x++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mod = config.GetModifierByType(TypeOfForce.AddSpeed); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> go = Instantiate(iconPrfb, transform); go.Init(mod); } } }</code> </pre> <br></div></div><br><br>  Anticiper les questions: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>; x++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>; x++)</code> </pre><br><br>  3 et 1 - les soi-disant nombres magiques qui sont simplement pris de la t√™te et ins√©r√©s dans le code, cela devrait √™tre √©vit√©, mais pourquoi sont-ils ici?  Le principe selon lequel le panneau de droite est form√© n'a pas encore √©t√© d√©termin√©, et il a √©t√© d√©cid√© simplement de tester le prototype avec autant de modificateurs sur le prototype. <br><br>  Comment bien faire?  - au moins le mettre dans des champs s√©rialisables, et d√©finir les quantit√©s requises par l'inspecteur.  Pourquoi suis-je trop paresseux et devriez-vous le faire?  Ici, nous devons partir de la vue d'ensemble, pour la formation du nombre requis de modificateurs, une entit√© distincte et la configuration seront toujours responsables, alors j'√©tais trop paresseux en m'attendant √† beaucoup de refactoring √† l'avenir.  Mais mieux vaut ne pas √™tre paresseux!  ) <br><br>  √Ä propos des configurations - lorsque les premi√®res conf√©rences sur ScriptableObject sont apparues, j'ai aim√© l'id√©e de stocker des donn√©es comme un atout.  Vous obtenez les donn√©es n√©cessaires l√† o√π vous en avez besoin, sans √™tre li√© √† une instance √† copie unique.  Ensuite, il y a eu une conf√©rence sur une approche du d√©veloppement de jeux impliquant ScriptableObject, o√π ils avaient l'habitude de stocker les param√®tres d'instance.  En fait, les pr√©r√©glages / param√®tres de quelque chose enregistr√© dans l'actif sont la configuration. <br><br>  <b>Consid√©rez la classe de configuration:</b> <br><div class="spoiler">  <b class="spoiler_title">Classe de configuration</b> <div class="spoiler_text"><pre> <code class="java hljs"> [CreateAssetMenu(fileName = <span class="hljs-string"><span class="hljs-string">"DropModifiersPanel"</span></span>, menuName = <span class="hljs-string"><span class="hljs-string">"Configs/DropModifier"</span></span>, order = <span class="hljs-number"><span class="hljs-number">2</span></span>)] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropPanelConfig</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ScriptableObject</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ModifierBluePrintSimple[] modifierBluePrintSimples; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> DropModifier </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetModifierByType</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TypeOfForce typeOfModifiers)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> modifierBluePrintSimples.FirstOrDefault(x =&gt; x.GetValue.TypeOfModifier == typeOfModifiers).GetValue; } } [System.Serializable] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropModifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TypeOfForce TypeOfModifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Sprite Icon; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject Modifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Material Material; }</code> </pre> <br></div></div><br><br>  Quelle est l'essence de son travail?  Il stocke une classe de donn√©es de modificateur personnalis√©e. <br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropModifier</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TypeOfForce TypeOfModifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Sprite Icon; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> GameObject Modifier; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Material Material; }</code> </pre> <br><br>  Le type de modificateur est n√©cessaire pour l'identification, une ic√¥ne pour l'interface, le mode de jeu de l'objet de jeu du modificateur, le mat√©riel ici afin qu'il puisse √™tre modifi√© pendant la configuration.  Les modificateurs peuvent d√©j√† √™tre situ√©s sur le terrain de jeu, et disons que le concepteur de jeu change de type, maintenant il donne l'acc√©l√©ration, le modificateur s'initie dans la configuration et met √† jour tous les champs, y compris le mat√©riel, selon ce type de modificateur. <br><br>  Travailler avec la configuration est tr√®s simple - nous nous tournons vers la configuration pour les donn√©es d'un type sp√©cifique, nous obtenons ces donn√©es, des param√®tres visuels intimes et possibles √† partir de ces donn√©es. <br><br>  <b>O√π est le profit?</b> <br>  L'avantage est une tr√®s grande flexibilit√©, par exemple, vous voulez changer le mat√©riau et l'ic√¥ne sur le modificateur d'acc√©l√©ration, ou disons remplacer le projet de jeu entier.  Au lieu de r√©√©crire et de transf√©rer vers les champs de l'inspecteur, nous modifions simplement ces donn√©es dans une seule configuration et le tour est jou√© - tout sera mis √† jour avec nous, sur toutes les sc√®nes / niveaux / panneaux. <br><br>  <b>Et s'il y a plusieurs donn√©es pour le modificateur d'acc√©l√©rateur dans la configuration?</b> <br>  Dans le prototype, vous pouvez facilement le suivre manuellement afin que les donn√©es ne soient pas dupliqu√©es; sur un brouillon de travail, vous avez besoin de tests et de validation des donn√©es. <br><br><h3>  De l'ic√¥ne au terrain de jeu </h3><br><div class="spoiler">  <b class="spoiler_title">Classe d'ic√¥ne de modificateur</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DropModifiersIcon</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MonoBehaviour</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IDragHandler</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IBeginDragHandler</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IEndDragHandler</span></span></span><span class="hljs-class"> </span></span>{ [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Image icon; [Header(<span class="hljs-string"><span class="hljs-string">"       "</span></span>)] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> RectTransform canvas; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> CanvasGroup canvasGroup; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> DropModifier currentModifier; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 startPoint; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Vector3 outV3; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GameObject currentDraggedObj; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ canvasGroup = GetComponent&lt;CanvasGroup&gt;(); startPoint = transform.position; canvas = GetComponentInParent&lt;Canvas&gt;().transform as RectTransform; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DropModifier dropModifier)</span></span></span><span class="hljs-function"> </span></span>{ icon.sprite = dropModifier.Icon; currentModifier = dropModifier; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnBeginDrag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ BlockRaycast(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); currentDraggedObj = Instantiate(currentModifier.Modifier, WorldSpaceCoord(), Quaternion.identity); GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImOnDragEvent { IsDragging = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> }); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">BlockRaycast</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(bool state)</span></span></span><span class="hljs-function"> </span></span>{ canvasGroup.blocksRaycasts = state; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnDrag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ Vector2 outV2; RectTransformUtility.ScreenPointToLocalPointInRectangle(canvas, Input.mousePosition, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, out outV2); transform.position = canvas.transform.TransformPoint(outV2); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentDraggedObj != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) currentDraggedObj.transform.position = WorldSpaceCoord(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> Vector3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WorldSpaceCoord</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ RectTransformUtility.ScreenPointToWorldPointInRectangle(canvas, Input.mousePosition, Camera.main, out outV3); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> outV3; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnEndDrag</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PointerEventData eventData)</span></span></span><span class="hljs-function"> </span></span>{ GlobalEventAggregator.EventAggregator.Invoke(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ImOnDragEvent { IsDragging = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eventData.pointerCurrentRaycast.gameObject != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; eventData.pointerCurrentRaycast.gameObject.layer == <span class="hljs-number"><span class="hljs-number">5</span></span>) { Destroy(currentDraggedObj); transform.SetAsLastSibling(); canvasGroup.blocksRaycasts = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Destroy(gameObject); } } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> struct ImOnDragEvent { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> bool IsDragging; }</code> </pre><br></div></div><br><br>  <b>Que se passe-t-il ici?</b> <br>  Nous prenons l'ic√¥ne du panneau, en dessous, nous cr√©ons un blog de jeu du modificateur lui-m√™me.  Et en fait, nous d√©finissons les coordonn√©es du clic / de la brouette vers l'espace de jeu, nous d√©pla√ßons donc le modificateur dans l'espace de jeu avec l'ic√¥ne dans l'interface utilisateur, par la fa√ßon dont je vous conseille de lire sur RectTransformUtility, c'est une excellente classe d'aide dans laquelle il y a beaucoup de fonctionnalit√©s pour l'interface. <br><br>  Disons que nous changeons d'avis sur la mise d'un modificateur et que nous le renvoyons au panneau, <br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (eventData.pointerCurrentRaycast.gameObject != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; eventData.pointerCurrentRaycast.gameObject.layer == <span class="hljs-number"><span class="hljs-number">5</span></span>)</code> </pre> <br>  Ce morceau de code nous permet de comprendre ce qui est sous le clic.  Pourquoi la v√©rification des couches est-elle √©galement indiqu√©e ici?  Et pourquoi encore le nombre magique 5?  Comme nous nous en souvenons de la deuxi√®me partie, nous utilisons le graphique rakester non seulement pour l'interface utilisateur, mais aussi pour le bouton qui se trouve dans la sc√®ne, √©galement si nous ajoutons la fonctionnalit√© pour supprimer les modificateurs d√©j√† plac√©s sur le champ ou les d√©placer, ils tomberont √©galement sous le graphique rake, donc il existe √©galement une v√©rification suppl√©mentaire de l'appartenance √† la couche d'interface utilisateur.  Il s'agit du calque par d√©faut, et son ordre ne change pas, donc le nombre 5 ici n'est g√©n√©ralement pas un nombre magique. <br><br>  En cons√©quence, il s'av√®re que si nous rel√¢chons l'ic√¥ne au-dessus du panneau, elle reviendra au panneau, si au-dessus du terrain de jeu le modificateur reste sur le terrain, l'ic√¥ne sera supprim√©e. <br><br>  Une journ√©e de travail a √©t√© consacr√©e au code prototype.  Plus un peu d'agitation sur les fichiers et les graphiques.  En g√©n√©ral, le gameplay s'est av√©r√© appropri√©, malgr√© la tonne de questions sur les puces d'art et de conception de jeux.  Mission termin√©e. <br><br><h3>  Conclusions et recommandations </h3><br><ol><li>  Poser une architecture minimale, mais n√©anmoins une architecture </li><li>  Suivez les principes de base, mais sans fanatisme) </li><li>  Choisissez des solutions simples </li><li>  Entre polyvalence et vitesse - il vaut mieux choisir une vitesse pour le prototype </li><li>  Pour les projets de grande / moyenne taille, indiquez que le projet est pr√©f√©rable de r√©√©crire √† partir de z√©ro.  Par exemple, maintenant la tendance dans Unity est DOTS, vous devez √©crire beaucoup de composants et de syst√®mes, c'est mauvais pour les petites s√©ries, vous perdez du temps, pour les longues s√©ries - lorsque tous les composants et syst√®mes sont enregistr√©s, le gain de temps commence.  Je ne pense pas que ce soit cool de passer beaucoup de temps sur les tendances de l'architecture et de d√©couvrir ce qu'est le prototype </li></ol><br>  Des prototypes r√©ussis √† tous. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr453748/">https://habr.com/ru/post/fr453748/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr453730/index.html">Dentisterie moderne: implantation dentaire simultan√©e et extension de l'os de la m√¢choire √† travers les yeux du directeur technique</a></li>
<li><a href="../fr453732/index.html">Je viens de Moreinis. Vues obliques ou respect?</a></li>
<li><a href="../fr453734/index.html">Pr√©sentation de Helm 3</a></li>
<li><a href="../fr453742/index.html">Plugin Memcached: NoSQL dans MySQL</a></li>
<li><a href="../fr453744/index.html">Nous √©tudions le principe de la pseudo-classe: not () en utilisant l'exemple de la t√¢che "Mise en √©vidence de la ligne active d'une table en CSS pur"</a></li>
<li><a href="../fr453750/index.html">√Ä propos de la r√©cente cyberattaque de Baltimore</a></li>
<li><a href="../fr453756/index.html">Probl√®mes de la m√©thodologie actuelle pour d√©terminer les menaces actuelles du FSTEC</a></li>
<li><a href="../fr453760/index.html">Camp d'entra√Ænement en circuit pour r√©servoirs et processeurs</a></li>
<li><a href="../fr453764/index.html">Amn√©sie volontaire: manipulations hippocampiques pour √©liminer les souvenirs douloureux</a></li>
<li><a href="../fr453766/index.html">Radio d√©finie par logiciel - comment √ßa marche? Partie 6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>