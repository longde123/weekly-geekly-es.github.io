<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèà üîÇ üÜì Como lutei com a transi√ß√£o de elemento compartilhado e escrevi minha primeira biblioteca de c√≥digo-fonte aberto ‚Ü©Ô∏è ü•Å üõ∂</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="N√£o h√° hist√≥ria mais triste no mundo 
 do que a hist√≥ria do ViewPager'e e SET'e 




 Gostaria de avisar que o autor √© um novato no Android, portanto,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como lutei com a transi√ß√£o de elemento compartilhado e escrevi minha primeira biblioteca de c√≥digo-fonte aberto</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451116/"><p>  <i>N√£o h√° hist√≥ria mais triste no mundo</i> <i><br></i>  <i>do que a hist√≥ria do <abbr title="um livro que permite rolar pelas telas do aplicativo para a esquerda e para a direita com furtos">ViewPager'e</abbr> e <abbr title="Transi√ß√£o de elemento compartilhado - mover elementos entre telas no android">SET'e</abbr></i> <br></p><br><div style="text-align:center;"><img title="Uma imagem para atrair aten√ß√£o. Sobre o qu√£o dif√≠cil √© no c√≥digo aberto pela primeira vez ou sobre onde o back-end pode lev√°-lo. N√£o eu na foto" src="https://habrastorage.org/webt/xy/9_/-m/xy9_-mwralsvfgpectslixhktbw.jpeg"></div><br><p>  Gostaria de avisar que o autor √© um novato no Android, portanto, o artigo cont√©m tantas imprecis√µes t√©cnicas que voc√™ deve ser avisado de que declara√ß√µes tecnicamente confi√°veis ‚Äã‚Äãpodem aparecer no artigo. </p><br><h2 id="kuda-privodit-bekend">  Para onde o back-end leva </h2><br><p>  Toda a minha vida eu vi o back-end.  No in√≠cio de 2019, j√° existe um projeto muito ambicioso, mas inacabado.  Uma viagem infrut√≠fera a Zurique para uma entrevista com uma empresa de pesquisa.  Inverno, terra, sem humor.  N√£o h√° for√ßa e desejo de levar o projeto adiante. </p><br><p>  Eu queria esquecer esse backend terr√≠vel para sempre.  Felizmente, o destino me deu uma id√©ia - era uma aplica√ß√£o m√≥vel.  Sua principal caracter√≠stica era o uso n√£o padr√£o da c√¢mera.  O trabalho come√ßou a ferver.  Pouco tempo se passou e o prot√≥tipo est√° pronto.  O lan√ßamento do projeto estava se aproximando e tudo estava bem e bem proporcionado, at√© que eu decidi tornar o usu√°rio ‚Äú <em>conveniente</em> ‚Äù. </p><a name="habracut"></a><br><h2 id="viewpager-i-shared-element-transition-ischem-puti-primireniya">  ViewPager e transi√ß√£o de elemento compartilhado.  Estamos √† procura de reconcilia√ß√£o </h2><br><p> Ningu√©m quer clicar nos pequenos bot√µes do menu em 2019, tudo bem e esquerda eles querem deslizar as telas.  √â dito - feito, feito - quebrado.  Ent√£o o primeiro <abbr title="um livro que permite rolar pelas telas do aplicativo para a esquerda e para a direita com furtos"><code>ViewPager</code></abbr> apareceu no meu projeto (decifrei alguns termos para o mesmo back-end que eu - basta mover o cursor).  E a <abbr title="tecnologia para mover elementos de interface entre telas no android">transi√ß√£o de elemento compartilhado</abbr> (daqui em diante SET ou transi√ß√£o) - o elemento de assinatura do <abbr title="uma frase que voc√™ precisa inserir com mais frequ√™ncia se estiver escrevendo um artigo sobre desenvolvimento para Android">Design</abbr> de <abbr title="uma frase que voc√™ precisa inserir com mais frequ√™ncia se estiver escrevendo um artigo sobre desenvolvimento para Android">materiais</abbr> , recusou-se a trabalhar com o <code>ViewPager</code> , deixando-me uma escolha: furtos ou belas anima√ß√µes de transi√ß√£o entre telas.  N√£o queria recusar um ou outro.  Ent√£o minha pesquisa come√ßou. </p><br><p>  Horas de estudo: dezenas de t√≥picos em f√≥runs e perguntas n√£o respondidas no StackOverflow.  N√£o importa o que eu abra, me ofereceram a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">transi√ß√£o do <abbr title="ListView anal√≥gico - uma lista que exibe v√°rios outros itens na tela">RecyclerView</abbr> para o ViewPager</a> ou "anexar uma banana <code>Fragment.postponeEnterTransition()</code> ". <br><br></p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7l/qu/r_/7lqur_jrf31n12aqmqefruovwbo.png"></div><br><p>  Os rem√©dios populares n√£o ajudaram e eu decidi reconciliar o <code>ViewPager</code> e a <code>Shared Element Transition</code> . </p><br><h2 id="viewpager-pervaya-krov">  ViewPager: Primeiro Sangue </h2><br><p>  Comecei a refletir: ‚ÄúO problema aparece no momento em que o usu√°rio passa de uma p√°gina para outra ...‚Äù.  E ent√£o me dei conta: "Voc√™ n√£o ter√° problemas com o <em>SET</em> durante a mudan√ßa de p√°gina, se voc√™ n√£o mudar a p√°gina". </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tu/qa/ss/tuqasspx-ir0-tuk-fo4qk3m9fa.jpeg"></div><br><p>  Podemos fazer a <em>transi√ß√£o</em> na mesma p√°gina e apenas substituir a p√°gina atual pela p√°gina de destino no <code>ViewPager</code> . </p><br><p>  Primeiro, crie <abbr title="um elemento logicamente completo que encapsula a apresenta√ß√£o e a l√≥gica para uso posterior na interface. Este artigo √© apenas o conte√∫do da tela do aplicativo.">fragmentos</abbr> com os quais trabalharemos. </p><br><pre> <code class="java hljs">SmallPictureFragment small_picture_fragment = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SmallPictureFragment(); BigPictureFragment big_picture_fragment = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BigPictureFragment();</code> </pre> <br><p>  Vamos tentar alterar o fragmento na p√°gina atual para outra coisa. </p><br><pre> <code class="java hljs">FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction(); <span class="hljs-comment"><span class="hljs-comment">//  View      int fragmentContId = previousFragment.getView().getParent().getId(); //         fragmentTransaction.replace(fragmentContId, nextFragment); fragmentTransaction.commit();</span></span></code> </pre> <br><p>  Iniciamos o aplicativo e ... alternamos suavemente para uma tela em branco.  Qual o motivo? </p><br><p>  Acontece que o cont√™iner de cada p√°gina √© o pr√≥prio <code>ViewPager</code> , sem intermedi√°rios como <code>Page1Container</code> , <code>Page2Container</code> .  Portanto, apenas para alterar uma p√°gina para outra n√£o funciona, o <code>pager</code> inteiro ser√° substitu√≠do. </p><br><p>  Bem, para alterar o conte√∫do de cada p√°gina individualmente, criamos v√°rios fragmentos de cont√™iner para cada p√°gina. </p><br><pre> <code class="java hljs">RootSmallPictureFragment root_small_pic_fragment = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RootSmallPictureFragment(); RootBigPictureFragment root_big_pic_fragment = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RootBigPictureFragment();</code> </pre> <br><p>  Algo n√£o come√ßar√° novamente. </p><br><blockquote>  java.lang.IllegalStateException: N√£o √© poss√≠vel alterar o ID do cont√™iner do fragmento BigPictureFragment {...}: era 2131165289 agora 2131165290 </blockquote><p>  N√£o podemos anexar um fragmento da segunda p√°gina ( <code>BigPictureFragment</code> ) √† primeira, porque ela j√° est√° anexada ao cont√™iner da segunda p√°gina. </p><br><p>  Depois de cerrarmos os dentes, adicionamos mais fragmentos duplos. </p><br><pre> <code class="plaintext hljs">SmallPictureFragment small_picture_fragment_fake = new SmallPictureFragment(); BigPictureFragment big_picture_fragment_fake = new BigPictureFragment();</code> </pre> <br><p>  <strong>Ganhou!</strong>  O c√≥digo de transi√ß√£o que uma vez copiei das extens√µes do GitHub j√° continha anima√ß√µes <em>fade in</em> e <em>fade out</em> .  Portanto, antes da <em>transi√ß√£o,</em> todos os elementos est√°ticos do primeiro fragmento desapareceram, as imagens foram movidas e somente ent√£o os elementos da segunda p√°gina apareceram.  Para o usu√°rio, isso parece um movimento real entre as p√°ginas. </p><br><p>  Todas as anima√ß√µes passaram, mas h√° um problema.  O usu√°rio ainda est√° na primeira p√°gina, mas deve estar na segunda. </p><br><p>  Para corrigir isso, substitu√≠mos cuidadosamente a p√°gina vis√≠vel do <code>ViewPager</code> uma segunda.  E ent√£o restauramos o conte√∫do da primeira p√°gina ao seu estado inicial. </p><br><pre> <code class="java hljs"> handler.postDelayed( () -&gt; { <span class="hljs-comment"><span class="hljs-comment">//       activity.viewPager.setCurrentItem(nextPage, false); FragmentTransaction transaction = fragmentManager.beginTransaction(); //   . //       //    Shared Element Transition transaction.replace(fragmentContainer, previousFragment); transaction.commitAllowingStateLoss(); }, //      ,     FADE_DEFAULT_TIME + MOVE_DEFAULT_TIME + FADE_DEFAULT_TIME ); }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Qual √© o resultado?</b>  <b class="spoiler_title">(anima√ß√£o - 2,7 mb)</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/kc/cz/vy/kcczvylf6a4kekytbyrtbyzk7w4.gif"></div></div></div><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fonte inteiro</b> <div class="spoiler_text"><div class="oembed"><script type="text/javascript" src="https://gist.github.com/9d51e1c92585b75ec19f156c14562a5f.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-13f839f7454b3a5b3bfbfd6d1e34ec9d.css"><div id="gist96065161" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-fragmenttransitionutil-java" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-java ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-fragmenttransitionutil-java-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-fragmenttransitionutil-java-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">FragmentTransitionUtil</span> {</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-fragmenttransitionutil-java-LC2" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-fragmenttransitionutil-java-LC3" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">final</span> <span class="pl-k">long</span> <span class="pl-c1">FADE_DEFAULT_TIME</span> <span class="pl-k">=</span> <span class="pl-c1">500</span>;</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-fragmenttransitionutil-java-LC4" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">final</span> <span class="pl-k">long</span> <span class="pl-c1">MOVE_DEFAULT_TIME</span> <span class="pl-k">=</span> <span class="pl-c1">1000</span>;</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-fragmenttransitionutil-java-LC5" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-fragmenttransitionutil-java-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">perform</span>(</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-fragmenttransitionutil-java-LC7" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">MainActivity</span> <span class="pl-v">activity</span>,</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-fragmenttransitionutil-java-LC8" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">Fragment</span> <span class="pl-v">previousFragment</span>,</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-fragmenttransitionutil-java-LC9" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">Fragment</span> <span class="pl-v">nextFragment</span>,</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-fragmenttransitionutil-java-LC10" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">Map&lt;<span class="pl-smi">View</span>, <span class="pl-smi">String</span>&gt;</span> <span class="pl-v">sharedElements</span>,</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-fragmenttransitionutil-java-LC11" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">int</span> <span class="pl-v">nextPage</span></td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-fragmenttransitionutil-java-LC12" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-fragmenttransitionutil-java-LC13" class="blob-code blob-code-inner js-file-line">    ) {</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-fragmenttransitionutil-java-LC14" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">FragmentManager</span> fragmentManager <span class="pl-k">=</span> activity<span class="pl-k">.</span>getSupportFragmentManager();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-fragmenttransitionutil-java-LC15" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">FragmentTransaction</span> fragmentTransaction <span class="pl-k">=</span> fragmentManager<span class="pl-k">.</span>beginTransaction();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-fragmenttransitionutil-java-LC16" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-fragmenttransitionutil-java-LC17" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span> (previousFragment <span class="pl-k">!=</span> <span class="pl-c1">null</span>) {</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-fragmenttransitionutil-java-LC18" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-fragmenttransitionutil-java-LC19" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">//</span> 1. Exit for Previous Fragment</span></td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-fragmenttransitionutil-java-LC20" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">Fade</span> exitFade <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Fade</span>();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-fragmenttransitionutil-java-LC21" class="blob-code blob-code-inner js-file-line">            exitFade<span class="pl-k">.</span>setDuration(<span class="pl-c1">FADE_DEFAULT_TIME</span>);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-fragmenttransitionutil-java-LC22" class="blob-code blob-code-inner js-file-line">            previousFragment<span class="pl-k">.</span>setExitTransition(exitFade);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-fragmenttransitionutil-java-LC23" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-fragmenttransitionutil-java-LC24" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">//</span> 2. Shared Elements Transition</span></td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-fragmenttransitionutil-java-LC25" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">TransitionSet</span> enterTransitionSet <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">TransitionSet</span>();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-fragmenttransitionutil-java-LC26" class="blob-code blob-code-inner js-file-line">            enterTransitionSet<span class="pl-k">.</span>addTransition(</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-fragmenttransitionutil-java-LC27" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">new</span> <span class="pl-smi">TransitionSet</span>() {</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-fragmenttransitionutil-java-LC28" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-fragmenttransitionutil-java-LC29" class="blob-code blob-code-inner js-file-line">                        {</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-fragmenttransitionutil-java-LC30" class="blob-code blob-code-inner js-file-line">                            setOrdering(<span class="pl-c1">ORDERING_TOGETHER</span>);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-fragmenttransitionutil-java-LC31" class="blob-code blob-code-inner js-file-line">                            addTransition(<span class="pl-k">new</span> <span class="pl-smi">ChangeBounds</span>())<span class="pl-c1">.</span></td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-fragmenttransitionutil-java-LC32" class="blob-code blob-code-inner js-file-line">                            addTransition(<span class="pl-k">new</span> <span class="pl-smi">ChangeTransform</span>())<span class="pl-c1">.</span></td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-fragmenttransitionutil-java-LC33" class="blob-code blob-code-inner js-file-line">                            addTransition(<span class="pl-k">new</span> <span class="pl-smi">ChangeImageTransform</span>());</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-fragmenttransitionutil-java-LC34" class="blob-code blob-code-inner js-file-line">                        }</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-fragmenttransitionutil-java-LC35" class="blob-code blob-code-inner js-file-line">                    }</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-fragmenttransitionutil-java-LC36" class="blob-code blob-code-inner js-file-line">            );</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-fragmenttransitionutil-java-LC37" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-fragmenttransitionutil-java-LC38" class="blob-code blob-code-inner js-file-line">            enterTransitionSet<span class="pl-k">.</span>setDuration(<span class="pl-c1">MOVE_DEFAULT_TIME</span>);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-fragmenttransitionutil-java-LC39" class="blob-code blob-code-inner js-file-line">            enterTransitionSet<span class="pl-k">.</span>setStartDelay(<span class="pl-c1">FADE_DEFAULT_TIME</span>);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-fragmenttransitionutil-java-LC40" class="blob-code blob-code-inner js-file-line">            nextFragment<span class="pl-k">.</span>setSharedElementEnterTransition(enterTransitionSet);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-fragmenttransitionutil-java-LC41" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-fragmenttransitionutil-java-LC42" class="blob-code blob-code-inner js-file-line">            <span class="pl-c"><span class="pl-c">//</span> 3. Enter Transition for New Fragment</span></td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-fragmenttransitionutil-java-LC43" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">Fade</span> enterFade <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Fade</span>();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-fragmenttransitionutil-java-LC44" class="blob-code blob-code-inner js-file-line">            enterFade<span class="pl-k">.</span>setStartDelay(<span class="pl-c1">MOVE_DEFAULT_TIME</span> <span class="pl-k">+</span> <span class="pl-c1">FADE_DEFAULT_TIME</span>);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-fragmenttransitionutil-java-LC45" class="blob-code blob-code-inner js-file-line">            enterFade<span class="pl-k">.</span>setDuration(<span class="pl-c1">FADE_DEFAULT_TIME</span>);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-fragmenttransitionutil-java-LC46" class="blob-code blob-code-inner js-file-line">            nextFragment<span class="pl-k">.</span>setEnterTransition(enterFade);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-fragmenttransitionutil-java-LC47" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-fragmenttransitionutil-java-LC48" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span> (<span class="pl-smi">Build</span><span class="pl-c1"><span class="pl-k">.</span>VERSION<span class="pl-k">.</span>SDK_INT</span> <span class="pl-k">&gt;=</span> <span class="pl-smi">Build</span><span class="pl-c1"><span class="pl-k">.</span>VERSION_CODES<span class="pl-k">.</span>LOLLIPOP</span>) {</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L49" class="blob-num js-line-number" data-line-number="49"></td>
        <td id="file-fragmenttransitionutil-java-LC49" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span> (sharedElements <span class="pl-k">!=</span> <span class="pl-c1">null</span>) {</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L50" class="blob-num js-line-number" data-line-number="50"></td>
        <td id="file-fragmenttransitionutil-java-LC50" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">for</span> (<span class="pl-smi">Map</span><span class="pl-k">.</span><span class="pl-k">Entry&lt;<span class="pl-smi">View</span>, <span class="pl-smi">String</span>&gt;</span> viewStringEntry <span class="pl-k">:</span> sharedElements<span class="pl-k">.</span>entrySet()) {</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L51" class="blob-num js-line-number" data-line-number="51"></td>
        <td id="file-fragmenttransitionutil-java-LC51" class="blob-code blob-code-inner js-file-line">                        <span class="pl-smi">View</span> view <span class="pl-k">=</span> viewStringEntry<span class="pl-k">.</span>getKey();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L52" class="blob-num js-line-number" data-line-number="52"></td>
        <td id="file-fragmenttransitionutil-java-LC52" class="blob-code blob-code-inner js-file-line">                        <span class="pl-smi">String</span> transName <span class="pl-k">=</span> viewStringEntry<span class="pl-k">.</span>getValue();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L53" class="blob-num js-line-number" data-line-number="53"></td>
        <td id="file-fragmenttransitionutil-java-LC53" class="blob-code blob-code-inner js-file-line">                        view<span class="pl-k">.</span>setTransitionName(transName);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L54" class="blob-num js-line-number" data-line-number="54"></td>
        <td id="file-fragmenttransitionutil-java-LC54" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L55" class="blob-num js-line-number" data-line-number="55"></td>
        <td id="file-fragmenttransitionutil-java-LC55" class="blob-code blob-code-inner js-file-line">                        fragmentTransaction<span class="pl-k">.</span>addSharedElement(</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L56" class="blob-num js-line-number" data-line-number="56"></td>
        <td id="file-fragmenttransitionutil-java-LC56" class="blob-code blob-code-inner js-file-line">                                view,</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L57" class="blob-num js-line-number" data-line-number="57"></td>
        <td id="file-fragmenttransitionutil-java-LC57" class="blob-code blob-code-inner js-file-line">                                transName</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L58" class="blob-num js-line-number" data-line-number="58"></td>
        <td id="file-fragmenttransitionutil-java-LC58" class="blob-code blob-code-inner js-file-line">                        );</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L59" class="blob-num js-line-number" data-line-number="59"></td>
        <td id="file-fragmenttransitionutil-java-LC59" class="blob-code blob-code-inner js-file-line">                    }</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L60" class="blob-num js-line-number" data-line-number="60"></td>
        <td id="file-fragmenttransitionutil-java-LC60" class="blob-code blob-code-inner js-file-line">                }</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L61" class="blob-num js-line-number" data-line-number="61"></td>
        <td id="file-fragmenttransitionutil-java-LC61" class="blob-code blob-code-inner js-file-line">            }</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L62" class="blob-num js-line-number" data-line-number="62"></td>
        <td id="file-fragmenttransitionutil-java-LC62" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L63" class="blob-num js-line-number" data-line-number="63"></td>
        <td id="file-fragmenttransitionutil-java-LC63" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">int</span> fragmentContId <span class="pl-k">=</span> ((<span class="pl-smi">ViewGroup</span>) previousFragment<span class="pl-k">.</span>getView()<span class="pl-k">.</span>getParent())<span class="pl-k">.</span>getId();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L64" class="blob-num js-line-number" data-line-number="64"></td>
        <td id="file-fragmenttransitionutil-java-LC64" class="blob-code blob-code-inner js-file-line">            fragmentTransaction<span class="pl-k">.</span>replace(fragmentContId, nextFragment);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L65" class="blob-num js-line-number" data-line-number="65"></td>
        <td id="file-fragmenttransitionutil-java-LC65" class="blob-code blob-code-inner js-file-line">            fragmentTransaction<span class="pl-k">.</span>commit();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L66" class="blob-num js-line-number" data-line-number="66"></td>
        <td id="file-fragmenttransitionutil-java-LC66" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L67" class="blob-num js-line-number" data-line-number="67"></td>
        <td id="file-fragmenttransitionutil-java-LC67" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L68" class="blob-num js-line-number" data-line-number="68"></td>
        <td id="file-fragmenttransitionutil-java-LC68" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">final</span> <span class="pl-smi">Handler</span> handler <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Handler</span>();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L69" class="blob-num js-line-number" data-line-number="69"></td>
        <td id="file-fragmenttransitionutil-java-LC69" class="blob-code blob-code-inner js-file-line">            handler<span class="pl-k">.</span>postDelayed(</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L70" class="blob-num js-line-number" data-line-number="70"></td>
        <td id="file-fragmenttransitionutil-java-LC70" class="blob-code blob-code-inner js-file-line">                    () <span class="pl-k">-</span><span class="pl-k">&gt;</span> {</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L71" class="blob-num js-line-number" data-line-number="71"></td>
        <td id="file-fragmenttransitionutil-java-LC71" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">//</span> Stealthy changing page visible to user. He won‚Äôt notice!</span></td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L72" class="blob-num js-line-number" data-line-number="72"></td>
        <td id="file-fragmenttransitionutil-java-LC72" class="blob-code blob-code-inner js-file-line">                        activity<span class="pl-k">.</span>viewPager<span class="pl-k">.</span>setCurrentItem(nextPage, <span class="pl-c1">false</span>);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L73" class="blob-num js-line-number" data-line-number="73"></td>
        <td id="file-fragmenttransitionutil-java-LC73" class="blob-code blob-code-inner js-file-line">                        <span class="pl-smi">FragmentTransaction</span> transaction <span class="pl-k">=</span> fragmentManager<span class="pl-k">.</span>beginTransaction();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L74" class="blob-num js-line-number" data-line-number="74"></td>
        <td id="file-fragmenttransitionutil-java-LC74" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">//</span> Restore previous fragment. It contains inappropriate view now</span></td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L75" class="blob-num js-line-number" data-line-number="75"></td>
        <td id="file-fragmenttransitionutil-java-LC75" class="blob-code blob-code-inner js-file-line">                        transaction<span class="pl-k">.</span>replace(fragmentContId, previousFragment);</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L76" class="blob-num js-line-number" data-line-number="76"></td>
        <td id="file-fragmenttransitionutil-java-LC76" class="blob-code blob-code-inner js-file-line">                        transaction<span class="pl-k">.</span>commitAllowingStateLoss();</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L77" class="blob-num js-line-number" data-line-number="77"></td>
        <td id="file-fragmenttransitionutil-java-LC77" class="blob-code blob-code-inner js-file-line">                    },</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L78" class="blob-num js-line-number" data-line-number="78"></td>
        <td id="file-fragmenttransitionutil-java-LC78" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c1">FADE_DEFAULT_TIME</span> <span class="pl-k">+</span> <span class="pl-c1">MOVE_DEFAULT_TIME</span> <span class="pl-k">+</span> <span class="pl-c1">FADE_DEFAULT_TIME</span></td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L79" class="blob-num js-line-number" data-line-number="79"></td>
        <td id="file-fragmenttransitionutil-java-LC79" class="blob-code blob-code-inner js-file-line">            );</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L80" class="blob-num js-line-number" data-line-number="80"></td>
        <td id="file-fragmenttransitionutil-java-LC80" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L81" class="blob-num js-line-number" data-line-number="81"></td>
        <td id="file-fragmenttransitionutil-java-LC81" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L82" class="blob-num js-line-number" data-line-number="82"></td>
        <td id="file-fragmenttransitionutil-java-LC82" class="blob-code blob-code-inner js-file-line">        }</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L83" class="blob-num js-line-number" data-line-number="83"></td>
        <td id="file-fragmenttransitionutil-java-LC83" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L84" class="blob-num js-line-number" data-line-number="84"></td>
        <td id="file-fragmenttransitionutil-java-LC84" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-fragmenttransitionutil-java-L85" class="blob-num js-line-number" data-line-number="85"></td>
        <td id="file-fragmenttransitionutil-java-LC85" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">FragmentTransitionUtil.java</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div></div></div><br><p>  O projeto pode ser visualizado no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub</a> . </p><br><p>  <strong>Para resumir.</strong>  O c√≥digo come√ßou a parecer muito mais s√≥lido: em vez de 2 fragmentos iniciais, obtive at√© 6, apareceram instru√ß√µes nele que controlam o desempenho, substituindo fragmentos no momento certo.  E isso √© apenas na demonstra√ß√£o. </p><br><p>  No mesmo projeto, um ap√≥s o outro no c√≥digo, os backups come√ßaram a aparecer nos locais mais inesperados.  Eles n√£o permitiram que o aplicativo desmoronasse quando o usu√°rio clicou nos bot√µes das p√°ginas "erradas" ou restringiu o trabalho em segundo plano de fragmentos duplicados. </p><br><p>  Verificou-se que o android n√£o possui retornos de chamada para concluir a <em>transi√ß√£o</em> , e seu tempo de execu√ß√£o √© muito arbitr√°rio e depende de muitos fatores (por exemplo, a rapidez com que o <code>RecyclerView</code> carrega no fragmento resultante).  Isso levou ao fato de que a substitui√ß√£o de fragmentos em <code>handler.postDelayed()</code> frequentemente executada muito cedo ou muito tarde, o que exacerbava o problema anterior. </p><br><p>  O √∫ltimo destaque foi que, durante a anima√ß√£o, o usu√°rio pode simplesmente deslizar para outra p√°gina e assistir a duas telas duplas, ap√≥s o que o aplicativo tamb√©m a puxa para a tela desejada. </p><br><div class="spoiler">  <b class="spoiler_title">Artefatos interessantes dessa abordagem (anima√ß√£o - 2,7 mb)</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/lo/p2/3h/lop23hzo-o-cglifsb1aljyey-g.gif"></div></div></div><br><p>  Esse estado de coisas n√£o me agradou e eu, cheio de raiva justa, comecei a procurar outra solu√ß√£o. </p><br><h2 id="kak-sdelat-shared-element-transition-v-viewpager-pravilno">  Como fazer a transi√ß√£o de elemento compartilhado no Viewpager corretamente </h2><br><h3 id="probuem-pagetransformer">  Tentando o PageTransformer </h3><br><p>  Ainda n√£o havia respostas na Internet, e pensei: de que outra forma essa transi√ß√£o pode ser iniciada.  Algo no subc√≥rtex da consci√™ncia sussurrou para mim: "Use o <abbr title="uma classe que permite que indiv√≠duos particularmente teimosos substituam as anima√ß√µes de virada de p√°gina padr√£o"><code>PageTransformer</code></abbr> , Luke".  A ideia parecia promissora para mim e eu decidi ouvir. </p><br><p>  A id√©ia √© criar o <code>PageTransformer</code> , que, diferentemente do <em>Android SET</em> , n√£o exigir√° v√°rias repeti√ß√µes de <code>setTransitionName(transitionName)</code> <code>FragmentTransaction.addSharedElement(sharedElement,name)</code> <code>setTransitionName(transitionName)</code> e <code>FragmentTransaction.addSharedElement(sharedElement,name)</code> nos dois lados da transi√ß√£o.  Ele mover√° os elementos ap√≥s o furto e ter√° uma interface simples do formul√°rio: </p><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addSharedTransition</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fromViewId, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> toViewId)</span></span></span></span></code> </pre> <br><p>  Prosseguimos para o desenvolvimento.  Vou salvar os dados do <code>addSharedTransition(fromId, toId)</code> em <code>Set</code> from <code>Pair</code> e obt√™-los no m√©todo <code>PageTransfomer</code> </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/**     ,   ,     */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">transformPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@NonNull View page, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> position)</span></span></span></span></code> </pre> <br><p>  Por dentro, examinarei todos os pares de <code>View</code> salvos, entre os quais preciso fazer uma anima√ß√£o.  E tentarei filtr√°-los para que apenas elementos vis√≠veis sejam animados. </p><br><p>  Primeiro, vamos verificar se os elementos que precisam ser animados foram criados.  N√£o somos exigentes e, se a <code>View</code> n√£o <code>View</code> criada antes do in√≠cio da anima√ß√£o, n√£o interromperemos a anima√ß√£o inteira (como a <em>Transi√ß√£o de Elemento Compartilhado</em> ), mas a buscaremos quando o elemento for criado. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Pair&lt;Integer,Integer&gt; idPair : sharedElementIds) { Integer fromViewId = idPair.first; Integer toViewId = idPair.second; View fromView = activity.findViewById(fromViewId); View toView = activity.findViewById(toViewId); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fromView != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; toView != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) {</code> </pre> <br><p>  Encontro as p√°ginas entre as quais o movimento ocorre (como determino o n√∫mero da p√°gina ser√° descrito abaixo). </p><br><pre> <code class="java hljs">View fromPage = pages.get(fromPageNumber); View toPage = pages.get(toPageNumber);</code> </pre> <br><p>  Se as duas p√°ginas j√° tiverem sido criadas, estou procurando um par de <code>View</code> nelas, que preciso animar. </p><br><pre> <code class="java hljs">If (fromPage != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; toPage != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { fromView = fromPage.findViewById(fromViewId); toView = toPage.findViewById(toViewId);</code> </pre> <br><p>  Nesse est√°gio, selecionamos Exibir, que fica nas p√°ginas entre as quais o usu√°rio rola. </p><br><p>  √â hora de obter muitas vari√°veis.  Calculo pontos de refer√™ncia: </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//         //     float fromX = fromView.getX() - fromView.getTranslationX(); float fromY = fromView.getY() - fromView.getTranslationY(); float toX = toView.getX() - toView.getTranslationX(); float toY = toView.getY() - toView.getTranslationY(); float deltaX = toX - fromX; float deltaY = toY - fromY; //      float fromWidth = fromView.getWidth(); float fromHeight = fromView.getHeight(); float toWidth = toView.getWidth(); float toHeight = toView.getHeight(); float deltaWidth = toWidth - fromWidth; float deltaHeight = toHeight - fromHeight; //       boolean slideToTheRight = toPageNumber &gt; fromPageNumber;</span></span></code> </pre> <br><p>  No √∫ltimo trecho, defino <code>slideToTheRight</code> e, j√° neste, ser√° √∫til para mim.  A <code>translation</code> depende disso, o que determina que o <code>View</code> voar√° para seu lugar ou em algum lugar fora da tela. </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> pageWidth = getScreenWidth(); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> sign = slideToTheRight ? <span class="hljs-number"><span class="hljs-number">1</span></span> : -<span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> translationY = (deltaY + deltaHeight / <span class="hljs-number"><span class="hljs-number">2</span></span>) * sign * (-position); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> translationX = (deltaX + sign * pageWidth + deltaWidth / <span class="hljs-number"><span class="hljs-number">2</span></span>) * sign * (-position);</code> </pre> <br><p>  Curiosamente, as f√≥rmulas de deslocamento para <code>X</code> e <code>Y</code> para o modo de <code>View</code> , na p√°gina inicial e na p√°gina resultante, foram as mesmas, apesar dos diferentes deslocamentos iniciais. </p><br><p>  Por√©m, com a escala, infelizmente, esse truque n√£o funcionar√° - √© preciso considerar se essa <code>View</code> ponto inicial ou final da anima√ß√£o. </p><br><p>  Pode ser uma surpresa para algu√©m, mas o <code>transformPage(@NonNull View page, float position)</code> √© chamado v√°rias vezes: para cada p√°gina em cache (o tamanho do cache √© personaliz√°vel).  E, para n√£o redesenhar a <code>View</code> animada v√°rias vezes, para cada chamada a <code>transformPage()</code> , alteramos apenas as que est√£o na <code>page</code> atual. </p><br><div class="spoiler">  <b class="spoiler_title">Definimos a posi√ß√£o e a escala dos elementos animados</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//   View     if (page.findViewById(fromId) != null) { //      fromView.setTranslationX(translationX); fromView.setTranslationY(translationY); / /   float scaleX = (fromWidth == 0) ? 1 : //  View   , //        (fromWidth + deltaWidth * sign * (-position)) / fromWidth; float scaleY = (fromHeight == 0) ? 1 : //  View   , //        (fromHeight + deltaHeight * sign * (-position)) / fromHeight; fromView.setScaleX(scaleX); fromView.setScaleY(scaleY); } //   View     if (page.findViewById(toId) != null) { toView.setTranslationX(translationX); toView.setTranslationY(translationY); float scaleX = (toWidth == 0) ? 1 : (toWidth + deltaWidth * sign * (-position)) / toWidth; float scaleY = (toHeight == 0) ? 1 : (toHeight + deltaHeight * sign * (-position)) / toHeight; toView.setScaleX(scaleX); toView.setScaleY(scaleY); }</span></span></code> </pre> </div></div><br><h3 id="vybiraem-stranicy-dlya-risovaniya-animacii">  Selecione p√°ginas para desenhar anima√ß√µes </h3><br><p>  <code>ViewPager</code> n√£o tem pressa em compartilhar informa√ß√µes entre as p√°ginas que est√£o rolando.  Como prometi, agora vou contar como obtemos essas informa√ß√µes.  Em nosso <code>PageTransformer</code> implementamos outra interface <code>ViewPager.OnPageChangeListener</code> .  Tendo estudado a sa√≠da de <code>onPageScrolled()</code> atrav√©s de <code>System.out.println()</code> cheguei √† seguinte f√≥rmula: </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onPageScrolled</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> position, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> positionOffset, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> positionOffsetPixels )</span></span></span><span class="hljs-function"> </span></span>{ Set&lt;Integer&gt; visiblePages = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashSet&lt;&gt;(); visiblePages.add(position); visiblePages.add(positionOffset &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> ? position + <span class="hljs-number"><span class="hljs-number">1</span></span> : position - <span class="hljs-number"><span class="hljs-number">1</span></span>); visiblePages.remove(fromPageNumber); toPageNumber = visiblePages.iterator().next(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pages == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || toPageNumber &gt;= pages.size()) toPageNumber = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onPageSelected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> position)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.position = position; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onPageScrollStateChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> state)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (state == SCROLL_STATE_IDLE) { <span class="hljs-comment"><span class="hljs-comment">//      ,    fromPageNumber = position; resetViewPositions(); } }</span></span></code> </pre> <br><p>  Isso √© tudo.  <strong>N√≥s conseguimos!</strong>  A anima√ß√£o monitora os gestos do usu√°rio.  Por que escolher entre deslizar e <em>Transi√ß√£o de elemento compartilhado</em> , quando voc√™ pode deixar tudo. </p><br><p>  Ao escrever este artigo, adicionei o efeito do desaparecimento de elementos est√°ticos - ele ainda √© muito bruto, portanto n√£o foi adicionado √† biblioteca. </p><br><div class="spoiler">  <b class="spoiler_title">Veja o que aconteceu no final (anima√ß√£o - 2,4 mb)</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/qe/38/ac/qe38acszfutvrpyu2cru-pbwjwq.gif"></div></div></div><br><div class="spoiler">  <b class="spoiler_title">C√≥digo fonte inteiro</b> <div class="spoiler_text"><div class="oembed"><script type="text/javascript" src="https://gist.github.com/0bca6b1317e2827c668f0791d73cc7c8.js"></script><link rel="stylesheet" href="https://github.githubassets.com/assets/gist-embed-13f839f7454b3a5b3bfbfd6d1e34ec9d.css"><div id="gist96067891" class="gist">
    <div class="gist-file">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container file-box">
  <div id="file-sharedelementpagetransformer-java" class="file">
    

  <div itemprop="text" class="Box-body p-0 blob-wrapper data type-java ">
      
<table class="highlight tab-size js-file-line-container" data-tab-size="8">
      <tbody><tr>
        <td id="file-sharedelementpagetransformer-java-L1" class="blob-num js-line-number" data-line-number="1"></td>
        <td id="file-sharedelementpagetransformer-java-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">/**</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L2" class="blob-num js-line-number" data-line-number="2"></td>
        <td id="file-sharedelementpagetransformer-java-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-c"> * PageTransformer that allows you to do shared element transitions between pages in ViewPager.</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L3" class="blob-num js-line-number" data-line-number="3"></td>
        <td id="file-sharedelementpagetransformer-java-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-c"> * It requires view pager sides match screen sides to function properly. I.e. ViewPager page width</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L4" class="blob-num js-line-number" data-line-number="4"></td>
        <td id="file-sharedelementpagetransformer-java-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-c"> * must be equal to screen width. &lt;<span class="pl-ent">br</span>/&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L5" class="blob-num js-line-number" data-line-number="5"></td>
        <td id="file-sharedelementpagetransformer-java-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-c"> *     Usage:&lt;<span class="pl-ent">br</span>/&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L6" class="blob-num js-line-number" data-line-number="6"></td>
        <td id="file-sharedelementpagetransformer-java-LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-c"> *         &lt;<span class="pl-ent">code</span>&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L7" class="blob-num js-line-number" data-line-number="7"></td>
        <td id="file-sharedelementpagetransformer-java-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-c"> *                  sharedElementPageTransformer.addSharedTransition(R.id.FirstPageTextView, R.id.SecondPageTextView)&lt;/code&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L8" class="blob-num js-line-number" data-line-number="8"></td>
        <td id="file-sharedelementpagetransformer-java-LC8" class="blob-code blob-code-inner js-file-line"><span class="pl-c"> *         &lt;/code&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L9" class="blob-num js-line-number" data-line-number="9"></td>
        <td id="file-sharedelementpagetransformer-java-LC9" class="blob-code blob-code-inner js-file-line"><span class="pl-c"> *</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L10" class="blob-num js-line-number" data-line-number="10"></td>
        <td id="file-sharedelementpagetransformer-java-LC10" class="blob-code blob-code-inner js-file-line"><span class="pl-c"> *</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L11" class="blob-num js-line-number" data-line-number="11"></td>
        <td id="file-sharedelementpagetransformer-java-LC11" class="blob-code blob-code-inner js-file-line"><span class="pl-c"> <span class="pl-c">*/</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L12" class="blob-num js-line-number" data-line-number="12"></td>
        <td id="file-sharedelementpagetransformer-java-LC12" class="blob-code blob-code-inner js-file-line"><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">SharedElementPageTransformer</span> <span class="pl-k">implements</span> <span class="pl-e">ViewPager</span>.<span class="pl-e">PageTransformer</span>, <span class="pl-e">ViewPager</span>.<span class="pl-e">OnPageChangeListener</span> {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L13" class="blob-num js-line-number" data-line-number="13"></td>
        <td id="file-sharedelementpagetransformer-java-LC13" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">/*</span>* Android need the correction while view scaling for some reason<span class="pl-c">*/</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L14" class="blob-num js-line-number" data-line-number="14"></td>
        <td id="file-sharedelementpagetransformer-java-LC14" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">static</span> <span class="pl-k">float</span> <span class="pl-c1">MAGICAL_ANDROID_RENDERING_SCALE</span> <span class="pl-k">=</span> <span class="pl-c1">1</span>;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L15" class="blob-num js-line-number" data-line-number="15"></td>
        <td id="file-sharedelementpagetransformer-java-LC15" class="blob-code blob-code-inner js-file-line"><span class="pl-c"><span class="pl-c">//</span>    private static float MAGICAL_ANDROID_RENDERING_SCALE = 0.995f;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L16" class="blob-num js-line-number" data-line-number="16"></td>
        <td id="file-sharedelementpagetransformer-java-LC16" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L17" class="blob-num js-line-number" data-line-number="17"></td>
        <td id="file-sharedelementpagetransformer-java-LC17" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">//</span> External variables</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L18" class="blob-num js-line-number" data-line-number="18"></td>
        <td id="file-sharedelementpagetransformer-java-LC18" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L19" class="blob-num js-line-number" data-line-number="19"></td>
        <td id="file-sharedelementpagetransformer-java-LC19" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">final</span> <span class="pl-smi">Activity</span> activity;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L20" class="blob-num js-line-number" data-line-number="20"></td>
        <td id="file-sharedelementpagetransformer-java-LC20" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">List&lt;<span class="pl-smi">Fragment</span>&gt;</span> fragments;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L21" class="blob-num js-line-number" data-line-number="21"></td>
        <td id="file-sharedelementpagetransformer-java-LC21" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">Set&lt;<span class="pl-k">Pair&lt;<span class="pl-smi">Integer</span>,<span class="pl-smi">Integer</span>&gt;</span>&gt;</span> sharedElementIds <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">HashSet&lt;&gt;</span>();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L22" class="blob-num js-line-number" data-line-number="22"></td>
        <td id="file-sharedelementpagetransformer-java-LC22" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L23" class="blob-num js-line-number" data-line-number="23"></td>
        <td id="file-sharedelementpagetransformer-java-LC23" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L24" class="blob-num js-line-number" data-line-number="24"></td>
        <td id="file-sharedelementpagetransformer-java-LC24" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L25" class="blob-num js-line-number" data-line-number="25"></td>
        <td id="file-sharedelementpagetransformer-java-LC25" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">//</span>Internal variables</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L26" class="blob-num js-line-number" data-line-number="26"></td>
        <td id="file-sharedelementpagetransformer-java-LC26" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L27" class="blob-num js-line-number" data-line-number="27"></td>
        <td id="file-sharedelementpagetransformer-java-LC27" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">List&lt;<span class="pl-smi">View</span>&gt;</span> pages;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L28" class="blob-num js-line-number" data-line-number="28"></td>
        <td id="file-sharedelementpagetransformer-java-LC28" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">Map&lt;<span class="pl-smi">View</span>, <span class="pl-smi">Integer</span>&gt;</span> pageToNumber <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">HashMap&lt;&gt;</span>();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L29" class="blob-num js-line-number" data-line-number="29"></td>
        <td id="file-sharedelementpagetransformer-java-LC29" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L30" class="blob-num js-line-number" data-line-number="30"></td>
        <td id="file-sharedelementpagetransformer-java-LC30" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-smi">Integer</span> fromPageNumber <span class="pl-k">=</span> <span class="pl-c1">0</span>;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L31" class="blob-num js-line-number" data-line-number="31"></td>
        <td id="file-sharedelementpagetransformer-java-LC31" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-smi">Integer</span> toPageNumber;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L32" class="blob-num js-line-number" data-line-number="32"></td>
        <td id="file-sharedelementpagetransformer-java-LC32" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L33" class="blob-num js-line-number" data-line-number="33"></td>
        <td id="file-sharedelementpagetransformer-java-LC33" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">/*</span>* current view pager position <span class="pl-c">*/</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L34" class="blob-num js-line-number" data-line-number="34"></td>
        <td id="file-sharedelementpagetransformer-java-LC34" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">int</span> position;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L35" class="blob-num js-line-number" data-line-number="35"></td>
        <td id="file-sharedelementpagetransformer-java-LC35" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L36" class="blob-num js-line-number" data-line-number="36"></td>
        <td id="file-sharedelementpagetransformer-java-LC36" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">/**</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L37" class="blob-num js-line-number" data-line-number="37"></td>
        <td id="file-sharedelementpagetransformer-java-LC37" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * <span class="pl-k">@param</span> activity activity that hosts view pager</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L38" class="blob-num js-line-number" data-line-number="38"></td>
        <td id="file-sharedelementpagetransformer-java-LC38" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * <span class="pl-k">@param</span> fragments fragment that are in view pager in the SAME ORDER</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L39" class="blob-num js-line-number" data-line-number="39"></td>
        <td id="file-sharedelementpagetransformer-java-LC39" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     <span class="pl-c">*/</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L40" class="blob-num js-line-number" data-line-number="40"></td>
        <td id="file-sharedelementpagetransformer-java-LC40" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">public</span> <span class="pl-en">SharedElementPageTransformer</span>(<span class="pl-smi">Activity</span> <span class="pl-v">activity</span>, <span class="pl-k">List&lt;<span class="pl-smi">Fragment</span>&gt;</span> <span class="pl-v">fragments</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L41" class="blob-num js-line-number" data-line-number="41"></td>
        <td id="file-sharedelementpagetransformer-java-LC41" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">this</span><span class="pl-k">.</span>activity <span class="pl-k">=</span> activity;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L42" class="blob-num js-line-number" data-line-number="42"></td>
        <td id="file-sharedelementpagetransformer-java-LC42" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">this</span><span class="pl-k">.</span>fragments <span class="pl-k">=</span> fragments;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L43" class="blob-num js-line-number" data-line-number="43"></td>
        <td id="file-sharedelementpagetransformer-java-LC43" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L44" class="blob-num js-line-number" data-line-number="44"></td>
        <td id="file-sharedelementpagetransformer-java-LC44" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L45" class="blob-num js-line-number" data-line-number="45"></td>
        <td id="file-sharedelementpagetransformer-java-LC45" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L46" class="blob-num js-line-number" data-line-number="46"></td>
        <td id="file-sharedelementpagetransformer-java-LC46" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">@Override</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L47" class="blob-num js-line-number" data-line-number="47"></td>
        <td id="file-sharedelementpagetransformer-java-LC47" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">transformPage</span>(<span class="pl-k">@NonNull</span> <span class="pl-smi">View</span> <span class="pl-v">page</span>, <span class="pl-k">float</span> <span class="pl-v">position</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L48" class="blob-num js-line-number" data-line-number="48"></td>
        <td id="file-sharedelementpagetransformer-java-LC48" class="blob-code blob-code-inner js-file-line">        updatePageCache();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L49" class="blob-num js-line-number" data-line-number="49"></td>
        <td id="file-sharedelementpagetransformer-java-LC49" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span> (fromPageNumber <span class="pl-k">==</span> <span class="pl-c1">null</span> <span class="pl-k">||</span> toPageNumber <span class="pl-k">==</span> <span class="pl-c1">null</span>) <span class="pl-k">return</span>;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L50" class="blob-num js-line-number" data-line-number="50"></td>
        <td id="file-sharedelementpagetransformer-java-LC50" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L51" class="blob-num js-line-number" data-line-number="51"></td>
        <td id="file-sharedelementpagetransformer-java-LC51" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">for</span> (<span class="pl-k">Pair&lt;<span class="pl-smi">Integer</span>,<span class="pl-smi">Integer</span>&gt;</span> idPair <span class="pl-k">:</span> sharedElementIds) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L52" class="blob-num js-line-number" data-line-number="52"></td>
        <td id="file-sharedelementpagetransformer-java-LC52" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">Integer</span> fromViewId <span class="pl-k">=</span> idPair<span class="pl-k">.</span>first;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L53" class="blob-num js-line-number" data-line-number="53"></td>
        <td id="file-sharedelementpagetransformer-java-LC53" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">Integer</span> toViewId <span class="pl-k">=</span> idPair<span class="pl-k">.</span>second;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L54" class="blob-num js-line-number" data-line-number="54"></td>
        <td id="file-sharedelementpagetransformer-java-LC54" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L55" class="blob-num js-line-number" data-line-number="55"></td>
        <td id="file-sharedelementpagetransformer-java-LC55" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">View</span> fromView <span class="pl-k">=</span> activity<span class="pl-k">.</span>findViewById(fromViewId);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L56" class="blob-num js-line-number" data-line-number="56"></td>
        <td id="file-sharedelementpagetransformer-java-LC56" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">View</span> toView <span class="pl-k">=</span> activity<span class="pl-k">.</span>findViewById(toViewId);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L57" class="blob-num js-line-number" data-line-number="57"></td>
        <td id="file-sharedelementpagetransformer-java-LC57" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L58" class="blob-num js-line-number" data-line-number="58"></td>
        <td id="file-sharedelementpagetransformer-java-LC58" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">if</span> (fromView <span class="pl-k">!=</span> <span class="pl-c1">null</span> <span class="pl-k">&amp;&amp;</span> toView <span class="pl-k">!=</span> <span class="pl-c1">null</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L59" class="blob-num js-line-number" data-line-number="59"></td>
        <td id="file-sharedelementpagetransformer-java-LC59" class="blob-code blob-code-inner js-file-line">                <span class="pl-c"><span class="pl-c">//</span>Looking if current Shared element transition matches visible pages</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L60" class="blob-num js-line-number" data-line-number="60"></td>
        <td id="file-sharedelementpagetransformer-java-LC60" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L61" class="blob-num js-line-number" data-line-number="61"></td>
        <td id="file-sharedelementpagetransformer-java-LC61" class="blob-code blob-code-inner js-file-line">                <span class="pl-smi">View</span> fromPage <span class="pl-k">=</span> pages<span class="pl-k">.</span>get(fromPageNumber);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L62" class="blob-num js-line-number" data-line-number="62"></td>
        <td id="file-sharedelementpagetransformer-java-LC62" class="blob-code blob-code-inner js-file-line">                <span class="pl-smi">View</span> toPage <span class="pl-k">=</span> pages<span class="pl-k">.</span>get(toPageNumber);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L63" class="blob-num js-line-number" data-line-number="63"></td>
        <td id="file-sharedelementpagetransformer-java-LC63" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L64" class="blob-num js-line-number" data-line-number="64"></td>
        <td id="file-sharedelementpagetransformer-java-LC64" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span> (fromPage <span class="pl-k">!=</span> <span class="pl-c1">null</span> <span class="pl-k">&amp;&amp;</span> toPage <span class="pl-k">!=</span> <span class="pl-c1">null</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L65" class="blob-num js-line-number" data-line-number="65"></td>
        <td id="file-sharedelementpagetransformer-java-LC65" class="blob-code blob-code-inner js-file-line">                    fromView <span class="pl-k">=</span> fromPage<span class="pl-k">.</span>findViewById(fromViewId);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L66" class="blob-num js-line-number" data-line-number="66"></td>
        <td id="file-sharedelementpagetransformer-java-LC66" class="blob-code blob-code-inner js-file-line">                    toView <span class="pl-k">=</span> toPage<span class="pl-k">.</span>findViewById(toViewId);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L67" class="blob-num js-line-number" data-line-number="67"></td>
        <td id="file-sharedelementpagetransformer-java-LC67" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L68" class="blob-num js-line-number" data-line-number="68"></td>
        <td id="file-sharedelementpagetransformer-java-LC68" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L69" class="blob-num js-line-number" data-line-number="69"></td>
        <td id="file-sharedelementpagetransformer-java-LC69" class="blob-code blob-code-inner js-file-line">                    <span class="pl-c"><span class="pl-c">//</span> if both views are on pages user drag between apply transformation</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L70" class="blob-num js-line-number" data-line-number="70"></td>
        <td id="file-sharedelementpagetransformer-java-LC70" class="blob-code blob-code-inner js-file-line">                    <span class="pl-k">if</span> (</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L71" class="blob-num js-line-number" data-line-number="71"></td>
        <td id="file-sharedelementpagetransformer-java-LC71" class="blob-code blob-code-inner js-file-line">                            fromView <span class="pl-k">!=</span> <span class="pl-c1">null</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L72" class="blob-num js-line-number" data-line-number="72"></td>
        <td id="file-sharedelementpagetransformer-java-LC72" class="blob-code blob-code-inner js-file-line">                                    <span class="pl-k">&amp;&amp;</span> toView <span class="pl-k">!=</span> <span class="pl-c1">null</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L73" class="blob-num js-line-number" data-line-number="73"></td>
        <td id="file-sharedelementpagetransformer-java-LC73" class="blob-code blob-code-inner js-file-line">                    ) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L74" class="blob-num js-line-number" data-line-number="74"></td>
        <td id="file-sharedelementpagetransformer-java-LC74" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">//</span> saving shared element position on the screen</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L75" class="blob-num js-line-number" data-line-number="75"></td>
        <td id="file-sharedelementpagetransformer-java-LC75" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> fromX <span class="pl-k">=</span> fromView<span class="pl-k">.</span>getX() <span class="pl-k">-</span> fromView<span class="pl-k">.</span>getTranslationX();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L76" class="blob-num js-line-number" data-line-number="76"></td>
        <td id="file-sharedelementpagetransformer-java-LC76" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> fromY <span class="pl-k">=</span> fromView<span class="pl-k">.</span>getY() <span class="pl-k">-</span> fromView<span class="pl-k">.</span>getTranslationY();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L77" class="blob-num js-line-number" data-line-number="77"></td>
        <td id="file-sharedelementpagetransformer-java-LC77" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> toX <span class="pl-k">=</span> toView<span class="pl-k">.</span>getX() <span class="pl-k">-</span> toView<span class="pl-k">.</span>getTranslationX();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L78" class="blob-num js-line-number" data-line-number="78"></td>
        <td id="file-sharedelementpagetransformer-java-LC78" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> toY <span class="pl-k">=</span> toView<span class="pl-k">.</span>getY() <span class="pl-k">-</span> toView<span class="pl-k">.</span>getTranslationY();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L79" class="blob-num js-line-number" data-line-number="79"></td>
        <td id="file-sharedelementpagetransformer-java-LC79" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> deltaX <span class="pl-k">=</span> toX <span class="pl-k">-</span> fromX;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L80" class="blob-num js-line-number" data-line-number="80"></td>
        <td id="file-sharedelementpagetransformer-java-LC80" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> deltaY <span class="pl-k">=</span> toY <span class="pl-k">-</span> fromY;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L81" class="blob-num js-line-number" data-line-number="81"></td>
        <td id="file-sharedelementpagetransformer-java-LC81" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L82" class="blob-num js-line-number" data-line-number="82"></td>
        <td id="file-sharedelementpagetransformer-java-LC82" class="blob-code blob-code-inner js-file-line">                        <span class="pl-c"><span class="pl-c">//</span> scaling</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L83" class="blob-num js-line-number" data-line-number="83"></td>
        <td id="file-sharedelementpagetransformer-java-LC83" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> fromWidth <span class="pl-k">=</span> fromView<span class="pl-k">.</span>getWidth();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L84" class="blob-num js-line-number" data-line-number="84"></td>
        <td id="file-sharedelementpagetransformer-java-LC84" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> fromHeight <span class="pl-k">=</span> fromView<span class="pl-k">.</span>getHeight();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L85" class="blob-num js-line-number" data-line-number="85"></td>
        <td id="file-sharedelementpagetransformer-java-LC85" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> toWidth <span class="pl-k">=</span> toView<span class="pl-k">.</span>getWidth();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L86" class="blob-num js-line-number" data-line-number="86"></td>
        <td id="file-sharedelementpagetransformer-java-LC86" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> toHeight <span class="pl-k">=</span> toView<span class="pl-k">.</span>getHeight();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L87" class="blob-num js-line-number" data-line-number="87"></td>
        <td id="file-sharedelementpagetransformer-java-LC87" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> deltaWidth <span class="pl-k">=</span> toWidth <span class="pl-k">-</span> fromWidth;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L88" class="blob-num js-line-number" data-line-number="88"></td>
        <td id="file-sharedelementpagetransformer-java-LC88" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">float</span> deltaHeight <span class="pl-k">=</span> toHeight <span class="pl-k">-</span> fromHeight;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L89" class="blob-num js-line-number" data-line-number="89"></td>
        <td id="file-sharedelementpagetransformer-java-LC89" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L90" class="blob-num js-line-number" data-line-number="90"></td>
        <td id="file-sharedelementpagetransformer-java-LC90" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L91" class="blob-num js-line-number" data-line-number="91"></td>
        <td id="file-sharedelementpagetransformer-java-LC91" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">int</span> fromId <span class="pl-k">=</span> fromView<span class="pl-k">.</span>getId();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L92" class="blob-num js-line-number" data-line-number="92"></td>
        <td id="file-sharedelementpagetransformer-java-LC92" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">int</span> toId <span class="pl-k">=</span> toView<span class="pl-k">.</span>getId();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L93" class="blob-num js-line-number" data-line-number="93"></td>
        <td id="file-sharedelementpagetransformer-java-LC93" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L94" class="blob-num js-line-number" data-line-number="94"></td>
        <td id="file-sharedelementpagetransformer-java-LC94" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">boolean</span> slideToTheRight <span class="pl-k">=</span> toPageNumber <span class="pl-k">&gt;</span> fromPageNumber;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L95" class="blob-num js-line-number" data-line-number="95"></td>
        <td id="file-sharedelementpagetransformer-java-LC95" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L96" class="blob-num js-line-number" data-line-number="96"></td>
        <td id="file-sharedelementpagetransformer-java-LC96" class="blob-code blob-code-inner js-file-line">                        <span class="pl-k">if</span> (position <span class="pl-k">&lt;=</span> <span class="pl-k">-</span><span class="pl-c1">1</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L97" class="blob-num js-line-number" data-line-number="97"></td>
        <td id="file-sharedelementpagetransformer-java-LC97" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L98" class="blob-num js-line-number" data-line-number="98"></td>
        <td id="file-sharedelementpagetransformer-java-LC98" class="blob-code blob-code-inner js-file-line">                        } <span class="pl-k">else</span> <span class="pl-k">if</span> (position <span class="pl-k">&lt;</span> <span class="pl-c1">1</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L99" class="blob-num js-line-number" data-line-number="99"></td>
        <td id="file-sharedelementpagetransformer-java-LC99" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L100" class="blob-num js-line-number" data-line-number="100"></td>
        <td id="file-sharedelementpagetransformer-java-LC100" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">float</span> pageWidth <span class="pl-k">=</span> getSceenWidth();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L101" class="blob-num js-line-number" data-line-number="101"></td>
        <td id="file-sharedelementpagetransformer-java-LC101" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">float</span> sign <span class="pl-k">=</span> slideToTheRight <span class="pl-k">?</span> <span class="pl-c1">1</span> <span class="pl-k">:</span> <span class="pl-k">-</span><span class="pl-c1">1</span>;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L102" class="blob-num js-line-number" data-line-number="102"></td>
        <td id="file-sharedelementpagetransformer-java-LC102" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L103" class="blob-num js-line-number" data-line-number="103"></td>
        <td id="file-sharedelementpagetransformer-java-LC103" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">float</span> translationY <span class="pl-k">=</span> (deltaY <span class="pl-k">+</span> deltaHeight <span class="pl-k">/</span> <span class="pl-c1">2</span>) <span class="pl-k">*</span> sign <span class="pl-k">*</span> (<span class="pl-k">-</span>position);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L104" class="blob-num js-line-number" data-line-number="104"></td>
        <td id="file-sharedelementpagetransformer-java-LC104" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">float</span> translationX <span class="pl-k">=</span> (deltaX <span class="pl-k">+</span> sign <span class="pl-k">*</span> pageWidth <span class="pl-k">+</span> deltaWidth <span class="pl-k">/</span> <span class="pl-c1">2</span>) <span class="pl-k">*</span> sign <span class="pl-k">*</span> (<span class="pl-k">-</span>position);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L105" class="blob-num js-line-number" data-line-number="105"></td>
        <td id="file-sharedelementpagetransformer-java-LC105" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L106" class="blob-num js-line-number" data-line-number="106"></td>
        <td id="file-sharedelementpagetransformer-java-LC106" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">if</span> (page<span class="pl-k">.</span>findViewById(fromId) <span class="pl-k">!=</span> <span class="pl-c1">null</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L107" class="blob-num js-line-number" data-line-number="107"></td>
        <td id="file-sharedelementpagetransformer-java-LC107" class="blob-code blob-code-inner js-file-line">                                fromView<span class="pl-k">.</span>setTranslationX(translationX);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L108" class="blob-num js-line-number" data-line-number="108"></td>
        <td id="file-sharedelementpagetransformer-java-LC108" class="blob-code blob-code-inner js-file-line">                                fromView<span class="pl-k">.</span>setTranslationY(translationY);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L109" class="blob-num js-line-number" data-line-number="109"></td>
        <td id="file-sharedelementpagetransformer-java-LC109" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L110" class="blob-num js-line-number" data-line-number="110"></td>
        <td id="file-sharedelementpagetransformer-java-LC110" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">float</span> scaleX <span class="pl-k">=</span> (fromWidth <span class="pl-k">==</span> <span class="pl-c1">0</span>) <span class="pl-k">?</span> <span class="pl-c1">1</span> <span class="pl-k">:</span> (fromWidth <span class="pl-k">+</span> deltaWidth <span class="pl-k">*</span> sign <span class="pl-k">*</span> (<span class="pl-k">-</span>position)) <span class="pl-k">/</span> fromWidth;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L111" class="blob-num js-line-number" data-line-number="111"></td>
        <td id="file-sharedelementpagetransformer-java-LC111" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">float</span> scaleY <span class="pl-k">=</span> (fromHeight <span class="pl-k">==</span> <span class="pl-c1">0</span>) <span class="pl-k">?</span> <span class="pl-c1">1</span> <span class="pl-k">:</span> (fromHeight <span class="pl-k">+</span> deltaHeight <span class="pl-k">*</span> sign <span class="pl-k">*</span> (<span class="pl-k">-</span>position)) <span class="pl-k">/</span> fromHeight;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L112" class="blob-num js-line-number" data-line-number="112"></td>
        <td id="file-sharedelementpagetransformer-java-LC112" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L113" class="blob-num js-line-number" data-line-number="113"></td>
        <td id="file-sharedelementpagetransformer-java-LC113" class="blob-code blob-code-inner js-file-line">                                fromView<span class="pl-k">.</span>setScaleX(scaleX);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L114" class="blob-num js-line-number" data-line-number="114"></td>
        <td id="file-sharedelementpagetransformer-java-LC114" class="blob-code blob-code-inner js-file-line">                                fromView<span class="pl-k">.</span>setScaleY(scaleY <span class="pl-k">*</span> <span class="pl-c1">MAGICAL_ANDROID_RENDERING_SCALE</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L115" class="blob-num js-line-number" data-line-number="115"></td>
        <td id="file-sharedelementpagetransformer-java-LC115" class="blob-code blob-code-inner js-file-line">                            }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L116" class="blob-num js-line-number" data-line-number="116"></td>
        <td id="file-sharedelementpagetransformer-java-LC116" class="blob-code blob-code-inner js-file-line">                            <span class="pl-k">if</span> (page<span class="pl-k">.</span>findViewById(toId) <span class="pl-k">!=</span> <span class="pl-c1">null</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L117" class="blob-num js-line-number" data-line-number="117"></td>
        <td id="file-sharedelementpagetransformer-java-LC117" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L118" class="blob-num js-line-number" data-line-number="118"></td>
        <td id="file-sharedelementpagetransformer-java-LC118" class="blob-code blob-code-inner js-file-line">                                toView<span class="pl-k">.</span>setTranslationX(translationX);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L119" class="blob-num js-line-number" data-line-number="119"></td>
        <td id="file-sharedelementpagetransformer-java-LC119" class="blob-code blob-code-inner js-file-line">                                toView<span class="pl-k">.</span>setTranslationY(translationY);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L120" class="blob-num js-line-number" data-line-number="120"></td>
        <td id="file-sharedelementpagetransformer-java-LC120" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">float</span> scaleX <span class="pl-k">=</span> (toWidth <span class="pl-k">==</span> <span class="pl-c1">0</span>) <span class="pl-k">?</span> <span class="pl-c1">1</span> <span class="pl-k">:</span> (toWidth <span class="pl-k">+</span> deltaWidth <span class="pl-k">*</span> sign <span class="pl-k">*</span> (<span class="pl-k">-</span>position)) <span class="pl-k">/</span> toWidth;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L121" class="blob-num js-line-number" data-line-number="121"></td>
        <td id="file-sharedelementpagetransformer-java-LC121" class="blob-code blob-code-inner js-file-line">                                <span class="pl-k">float</span> scaleY <span class="pl-k">=</span> (toHeight <span class="pl-k">==</span> <span class="pl-c1">0</span>) <span class="pl-k">?</span> <span class="pl-c1">1</span> <span class="pl-k">:</span>(toHeight <span class="pl-k">+</span> deltaHeight <span class="pl-k">*</span> sign <span class="pl-k">*</span> (<span class="pl-k">-</span>position)) <span class="pl-k">/</span> toHeight;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L122" class="blob-num js-line-number" data-line-number="122"></td>
        <td id="file-sharedelementpagetransformer-java-LC122" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L123" class="blob-num js-line-number" data-line-number="123"></td>
        <td id="file-sharedelementpagetransformer-java-LC123" class="blob-code blob-code-inner js-file-line">                                toView<span class="pl-k">.</span>setScaleX(scaleX);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L124" class="blob-num js-line-number" data-line-number="124"></td>
        <td id="file-sharedelementpagetransformer-java-LC124" class="blob-code blob-code-inner js-file-line">                                toView<span class="pl-k">.</span>setScaleY(scaleY);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L125" class="blob-num js-line-number" data-line-number="125"></td>
        <td id="file-sharedelementpagetransformer-java-LC125" class="blob-code blob-code-inner js-file-line">                            }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L126" class="blob-num js-line-number" data-line-number="126"></td>
        <td id="file-sharedelementpagetransformer-java-LC126" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L127" class="blob-num js-line-number" data-line-number="127"></td>
        <td id="file-sharedelementpagetransformer-java-LC127" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L128" class="blob-num js-line-number" data-line-number="128"></td>
        <td id="file-sharedelementpagetransformer-java-LC128" class="blob-code blob-code-inner js-file-line">                        } <span class="pl-k">else</span> {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L129" class="blob-num js-line-number" data-line-number="129"></td>
        <td id="file-sharedelementpagetransformer-java-LC129" class="blob-code blob-code-inner js-file-line">                        }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L130" class="blob-num js-line-number" data-line-number="130"></td>
        <td id="file-sharedelementpagetransformer-java-LC130" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L131" class="blob-num js-line-number" data-line-number="131"></td>
        <td id="file-sharedelementpagetransformer-java-LC131" class="blob-code blob-code-inner js-file-line">                    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L132" class="blob-num js-line-number" data-line-number="132"></td>
        <td id="file-sharedelementpagetransformer-java-LC132" class="blob-code blob-code-inner js-file-line">                }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L133" class="blob-num js-line-number" data-line-number="133"></td>
        <td id="file-sharedelementpagetransformer-java-LC133" class="blob-code blob-code-inner js-file-line">            }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L134" class="blob-num js-line-number" data-line-number="134"></td>
        <td id="file-sharedelementpagetransformer-java-LC134" class="blob-code blob-code-inner js-file-line">        }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L135" class="blob-num js-line-number" data-line-number="135"></td>
        <td id="file-sharedelementpagetransformer-java-LC135" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L136" class="blob-num js-line-number" data-line-number="136"></td>
        <td id="file-sharedelementpagetransformer-java-LC136" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L137" class="blob-num js-line-number" data-line-number="137"></td>
        <td id="file-sharedelementpagetransformer-java-LC137" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">float</span> <span class="pl-en">getSceenWidth</span>() {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L138" class="blob-num js-line-number" data-line-number="138"></td>
        <td id="file-sharedelementpagetransformer-java-LC138" class="blob-code blob-code-inner js-file-line">        <span class="pl-smi">Point</span> outSize <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Point</span>();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L139" class="blob-num js-line-number" data-line-number="139"></td>
        <td id="file-sharedelementpagetransformer-java-LC139" class="blob-code blob-code-inner js-file-line">        activity<span class="pl-k">.</span>getWindowManager()<span class="pl-k">.</span>getDefaultDisplay()<span class="pl-k">.</span>getSize(outSize);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L140" class="blob-num js-line-number" data-line-number="140"></td>
        <td id="file-sharedelementpagetransformer-java-LC140" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">return</span> outSize<span class="pl-k">.</span>x;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L141" class="blob-num js-line-number" data-line-number="141"></td>
        <td id="file-sharedelementpagetransformer-java-LC141" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L142" class="blob-num js-line-number" data-line-number="142"></td>
        <td id="file-sharedelementpagetransformer-java-LC142" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L143" class="blob-num js-line-number" data-line-number="143"></td>
        <td id="file-sharedelementpagetransformer-java-LC143" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">/**</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L144" class="blob-num js-line-number" data-line-number="144"></td>
        <td id="file-sharedelementpagetransformer-java-LC144" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * Creating page cache array to determine if shared element on</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L145" class="blob-num js-line-number" data-line-number="145"></td>
        <td id="file-sharedelementpagetransformer-java-LC145" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * currently visible page</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L146" class="blob-num js-line-number" data-line-number="146"></td>
        <td id="file-sharedelementpagetransformer-java-LC146" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     <span class="pl-c">*/</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L147" class="blob-num js-line-number" data-line-number="147"></td>
        <td id="file-sharedelementpagetransformer-java-LC147" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">void</span> <span class="pl-en">updatePageCache</span>() {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L148" class="blob-num js-line-number" data-line-number="148"></td>
        <td id="file-sharedelementpagetransformer-java-LC148" class="blob-code blob-code-inner js-file-line">        pages <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">ArrayList&lt;&gt;</span>();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L149" class="blob-num js-line-number" data-line-number="149"></td>
        <td id="file-sharedelementpagetransformer-java-LC149" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L150" class="blob-num js-line-number" data-line-number="150"></td>
        <td id="file-sharedelementpagetransformer-java-LC150" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">for</span> (<span class="pl-k">int</span> i <span class="pl-k">=</span> <span class="pl-c1">0</span>; i <span class="pl-k">&lt;</span> fragments<span class="pl-k">.</span>size(); i<span class="pl-k">++</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L151" class="blob-num js-line-number" data-line-number="151"></td>
        <td id="file-sharedelementpagetransformer-java-LC151" class="blob-code blob-code-inner js-file-line">            <span class="pl-smi">View</span> pageView <span class="pl-k">=</span> fragments<span class="pl-k">.</span>get(i)<span class="pl-k">.</span>getView();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L152" class="blob-num js-line-number" data-line-number="152"></td>
        <td id="file-sharedelementpagetransformer-java-LC152" class="blob-code blob-code-inner js-file-line">            pages<span class="pl-k">.</span>add(pageView);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L153" class="blob-num js-line-number" data-line-number="153"></td>
        <td id="file-sharedelementpagetransformer-java-LC153" class="blob-code blob-code-inner js-file-line">            pageToNumber<span class="pl-k">.</span>put(pageView, i);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L154" class="blob-num js-line-number" data-line-number="154"></td>
        <td id="file-sharedelementpagetransformer-java-LC154" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L155" class="blob-num js-line-number" data-line-number="155"></td>
        <td id="file-sharedelementpagetransformer-java-LC155" class="blob-code blob-code-inner js-file-line">        }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L156" class="blob-num js-line-number" data-line-number="156"></td>
        <td id="file-sharedelementpagetransformer-java-LC156" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L157" class="blob-num js-line-number" data-line-number="157"></td>
        <td id="file-sharedelementpagetransformer-java-LC157" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L158" class="blob-num js-line-number" data-line-number="158"></td>
        <td id="file-sharedelementpagetransformer-java-LC158" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L159" class="blob-num js-line-number" data-line-number="159"></td>
        <td id="file-sharedelementpagetransformer-java-LC159" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">@Override</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L160" class="blob-num js-line-number" data-line-number="160"></td>
        <td id="file-sharedelementpagetransformer-java-LC160" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">onPageScrolled</span>(<span class="pl-k">int</span> <span class="pl-v">position</span>, <span class="pl-k">float</span> <span class="pl-v">positionOffset</span>, <span class="pl-k">int</span> <span class="pl-v">positionOffsetPixels</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L161" class="blob-num js-line-number" data-line-number="161"></td>
        <td id="file-sharedelementpagetransformer-java-LC161" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">Set&lt;<span class="pl-smi">Integer</span>&gt;</span> visiblePages <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-k">HashSet&lt;&gt;</span>();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L162" class="blob-num js-line-number" data-line-number="162"></td>
        <td id="file-sharedelementpagetransformer-java-LC162" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L163" class="blob-num js-line-number" data-line-number="163"></td>
        <td id="file-sharedelementpagetransformer-java-LC163" class="blob-code blob-code-inner js-file-line">        visiblePages<span class="pl-k">.</span>add(position);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L164" class="blob-num js-line-number" data-line-number="164"></td>
        <td id="file-sharedelementpagetransformer-java-LC164" class="blob-code blob-code-inner js-file-line">        visiblePages<span class="pl-k">.</span>add(positionOffset <span class="pl-k">&gt;=</span> <span class="pl-c1">0</span> <span class="pl-k">?</span> position <span class="pl-k">+</span> <span class="pl-c1">1</span> <span class="pl-k">:</span> position <span class="pl-k">-</span> <span class="pl-c1">1</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L165" class="blob-num js-line-number" data-line-number="165"></td>
        <td id="file-sharedelementpagetransformer-java-LC165" class="blob-code blob-code-inner js-file-line">        visiblePages<span class="pl-k">.</span>remove(fromPageNumber);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L166" class="blob-num js-line-number" data-line-number="166"></td>
        <td id="file-sharedelementpagetransformer-java-LC166" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L167" class="blob-num js-line-number" data-line-number="167"></td>
        <td id="file-sharedelementpagetransformer-java-LC167" class="blob-code blob-code-inner js-file-line">        toPageNumber <span class="pl-k">=</span> visiblePages<span class="pl-k">.</span>iterator()<span class="pl-k">.</span>next();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L168" class="blob-num js-line-number" data-line-number="168"></td>
        <td id="file-sharedelementpagetransformer-java-LC168" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L169" class="blob-num js-line-number" data-line-number="169"></td>
        <td id="file-sharedelementpagetransformer-java-LC169" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span> (pages <span class="pl-k">==</span> <span class="pl-c1">null</span> <span class="pl-k">||</span> toPageNumber <span class="pl-k">&gt;=</span> pages<span class="pl-k">.</span>size()) toPageNumber <span class="pl-k">=</span> <span class="pl-c1">null</span>;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L170" class="blob-num js-line-number" data-line-number="170"></td>
        <td id="file-sharedelementpagetransformer-java-LC170" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L171" class="blob-num js-line-number" data-line-number="171"></td>
        <td id="file-sharedelementpagetransformer-java-LC171" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L172" class="blob-num js-line-number" data-line-number="172"></td>
        <td id="file-sharedelementpagetransformer-java-LC172" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L173" class="blob-num js-line-number" data-line-number="173"></td>
        <td id="file-sharedelementpagetransformer-java-LC173" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">@Override</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L174" class="blob-num js-line-number" data-line-number="174"></td>
        <td id="file-sharedelementpagetransformer-java-LC174" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">onPageSelected</span>(<span class="pl-k">int</span> <span class="pl-v">position</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L175" class="blob-num js-line-number" data-line-number="175"></td>
        <td id="file-sharedelementpagetransformer-java-LC175" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">this</span><span class="pl-k">.</span>position <span class="pl-k">=</span> position;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L176" class="blob-num js-line-number" data-line-number="176"></td>
        <td id="file-sharedelementpagetransformer-java-LC176" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L177" class="blob-num js-line-number" data-line-number="177"></td>
        <td id="file-sharedelementpagetransformer-java-LC177" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L178" class="blob-num js-line-number" data-line-number="178"></td>
        <td id="file-sharedelementpagetransformer-java-LC178" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">@Override</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L179" class="blob-num js-line-number" data-line-number="179"></td>
        <td id="file-sharedelementpagetransformer-java-LC179" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">onPageScrollStateChanged</span>(<span class="pl-k">int</span> <span class="pl-v">state</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L180" class="blob-num js-line-number" data-line-number="180"></td>
        <td id="file-sharedelementpagetransformer-java-LC180" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span> (state <span class="pl-k">==</span> <span class="pl-c1">SCROLL_STATE_IDLE</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L181" class="blob-num js-line-number" data-line-number="181"></td>
        <td id="file-sharedelementpagetransformer-java-LC181" class="blob-code blob-code-inner js-file-line">            fromPageNumber <span class="pl-k">=</span> position;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L182" class="blob-num js-line-number" data-line-number="182"></td>
        <td id="file-sharedelementpagetransformer-java-LC182" class="blob-code blob-code-inner js-file-line">            resetViewPositions();</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L183" class="blob-num js-line-number" data-line-number="183"></td>
        <td id="file-sharedelementpagetransformer-java-LC183" class="blob-code blob-code-inner js-file-line">        }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L184" class="blob-num js-line-number" data-line-number="184"></td>
        <td id="file-sharedelementpagetransformer-java-LC184" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L185" class="blob-num js-line-number" data-line-number="185"></td>
        <td id="file-sharedelementpagetransformer-java-LC185" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L186" class="blob-num js-line-number" data-line-number="186"></td>
        <td id="file-sharedelementpagetransformer-java-LC186" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L187" class="blob-num js-line-number" data-line-number="187"></td>
        <td id="file-sharedelementpagetransformer-java-LC187" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">private</span> <span class="pl-k">void</span> <span class="pl-en">resetViewPositions</span>() {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L188" class="blob-num js-line-number" data-line-number="188"></td>
        <td id="file-sharedelementpagetransformer-java-LC188" class="blob-code blob-code-inner js-file-line">            <span class="pl-k">for</span> (<span class="pl-k">Pair&lt;<span class="pl-smi">Integer</span>, <span class="pl-smi">Integer</span>&gt;</span> idPair <span class="pl-k">:</span> sharedElementIds) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L189" class="blob-num js-line-number" data-line-number="189"></td>
        <td id="file-sharedelementpagetransformer-java-LC189" class="blob-code blob-code-inner js-file-line">                <span class="pl-smi">View</span> sharedElement <span class="pl-k">=</span> activity<span class="pl-k">.</span>findViewById(idPair<span class="pl-k">.</span>first);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L190" class="blob-num js-line-number" data-line-number="190"></td>
        <td id="file-sharedelementpagetransformer-java-LC190" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>(sharedElement <span class="pl-k">!=</span> <span class="pl-c1">null</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L191" class="blob-num js-line-number" data-line-number="191"></td>
        <td id="file-sharedelementpagetransformer-java-LC191" class="blob-code blob-code-inner js-file-line">                    sharedElement<span class="pl-k">.</span>setTranslationX(<span class="pl-c1">0</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L192" class="blob-num js-line-number" data-line-number="192"></td>
        <td id="file-sharedelementpagetransformer-java-LC192" class="blob-code blob-code-inner js-file-line">                    sharedElement<span class="pl-k">.</span>setTranslationY(<span class="pl-c1">0</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L193" class="blob-num js-line-number" data-line-number="193"></td>
        <td id="file-sharedelementpagetransformer-java-LC193" class="blob-code blob-code-inner js-file-line">                    sharedElement<span class="pl-k">.</span>setScaleX(<span class="pl-c1">1</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L194" class="blob-num js-line-number" data-line-number="194"></td>
        <td id="file-sharedelementpagetransformer-java-LC194" class="blob-code blob-code-inner js-file-line">                    sharedElement<span class="pl-k">.</span>setScaleY(<span class="pl-c1">1</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L195" class="blob-num js-line-number" data-line-number="195"></td>
        <td id="file-sharedelementpagetransformer-java-LC195" class="blob-code blob-code-inner js-file-line">                }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L196" class="blob-num js-line-number" data-line-number="196"></td>
        <td id="file-sharedelementpagetransformer-java-LC196" class="blob-code blob-code-inner js-file-line">                sharedElement <span class="pl-k">=</span> activity<span class="pl-k">.</span>findViewById(idPair<span class="pl-k">.</span>second);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L197" class="blob-num js-line-number" data-line-number="197"></td>
        <td id="file-sharedelementpagetransformer-java-LC197" class="blob-code blob-code-inner js-file-line">                <span class="pl-k">if</span>(sharedElement <span class="pl-k">!=</span> <span class="pl-c1">null</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L198" class="blob-num js-line-number" data-line-number="198"></td>
        <td id="file-sharedelementpagetransformer-java-LC198" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L199" class="blob-num js-line-number" data-line-number="199"></td>
        <td id="file-sharedelementpagetransformer-java-LC199" class="blob-code blob-code-inner js-file-line">                    sharedElement<span class="pl-k">.</span>setTranslationX(<span class="pl-c1">0</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L200" class="blob-num js-line-number" data-line-number="200"></td>
        <td id="file-sharedelementpagetransformer-java-LC200" class="blob-code blob-code-inner js-file-line">                    sharedElement<span class="pl-k">.</span>setTranslationY(<span class="pl-c1">0</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L201" class="blob-num js-line-number" data-line-number="201"></td>
        <td id="file-sharedelementpagetransformer-java-LC201" class="blob-code blob-code-inner js-file-line">                    sharedElement<span class="pl-k">.</span>setScaleX(<span class="pl-c1">1</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L202" class="blob-num js-line-number" data-line-number="202"></td>
        <td id="file-sharedelementpagetransformer-java-LC202" class="blob-code blob-code-inner js-file-line">                    sharedElement<span class="pl-k">.</span>setScaleY(<span class="pl-c1">1</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L203" class="blob-num js-line-number" data-line-number="203"></td>
        <td id="file-sharedelementpagetransformer-java-LC203" class="blob-code blob-code-inner js-file-line">                }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L204" class="blob-num js-line-number" data-line-number="204"></td>
        <td id="file-sharedelementpagetransformer-java-LC204" class="blob-code blob-code-inner js-file-line">            }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L205" class="blob-num js-line-number" data-line-number="205"></td>
        <td id="file-sharedelementpagetransformer-java-LC205" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L206" class="blob-num js-line-number" data-line-number="206"></td>
        <td id="file-sharedelementpagetransformer-java-LC206" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L207" class="blob-num js-line-number" data-line-number="207"></td>
        <td id="file-sharedelementpagetransformer-java-LC207" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L208" class="blob-num js-line-number" data-line-number="208"></td>
        <td id="file-sharedelementpagetransformer-java-LC208" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">/**</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L209" class="blob-num js-line-number" data-line-number="209"></td>
        <td id="file-sharedelementpagetransformer-java-LC209" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * Set up shared element transition from element with &lt;<span class="pl-ent">code</span>&gt;fromViewId&lt;/code&gt; to</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L210" class="blob-num js-line-number" data-line-number="210"></td>
        <td id="file-sharedelementpagetransformer-java-LC210" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * element with &lt;<span class="pl-ent">code</span>&gt;toViewId&lt;/code&gt;. Note that you can setup each transition</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L211" class="blob-num js-line-number" data-line-number="211"></td>
        <td id="file-sharedelementpagetransformer-java-LC211" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * direction separately. e.g. &lt;<span class="pl-ent">br</span>/&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L212" class="blob-num js-line-number" data-line-number="212"></td>
        <td id="file-sharedelementpagetransformer-java-LC212" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * &lt;<span class="pl-ent">code</span>&gt;addSharedTransition(R.id.FirstPageTextView, R.id.SecondPageTextView)&lt;/code&gt;&lt;<span class="pl-ent">br</span>/&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L213" class="blob-num js-line-number" data-line-number="213"></td>
        <td id="file-sharedelementpagetransformer-java-LC213" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * and&lt;<span class="pl-ent">br</span>/&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L214" class="blob-num js-line-number" data-line-number="214"></td>
        <td id="file-sharedelementpagetransformer-java-LC214" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * &lt;<span class="pl-ent">code</span>&gt;addSharedTransition(R.id.SecondPageTextView, R.id.FirstPageTextView)&lt;/code&gt;&lt;<span class="pl-ent">br</span>/&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L215" class="blob-num js-line-number" data-line-number="215"></td>
        <td id="file-sharedelementpagetransformer-java-LC215" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * are different.</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L216" class="blob-num js-line-number" data-line-number="216"></td>
        <td id="file-sharedelementpagetransformer-java-LC216" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * <span class="pl-k">@param</span> fromViewId</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L217" class="blob-num js-line-number" data-line-number="217"></td>
        <td id="file-sharedelementpagetransformer-java-LC217" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * <span class="pl-k">@param</span> toViewId</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L218" class="blob-num js-line-number" data-line-number="218"></td>
        <td id="file-sharedelementpagetransformer-java-LC218" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     <span class="pl-c">*/</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L219" class="blob-num js-line-number" data-line-number="219"></td>
        <td id="file-sharedelementpagetransformer-java-LC219" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">addSharedTransition</span>(<span class="pl-k">int</span> <span class="pl-v">fromViewId</span>, <span class="pl-k">int</span> <span class="pl-v">toViewId</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L220" class="blob-num js-line-number" data-line-number="220"></td>
        <td id="file-sharedelementpagetransformer-java-LC220" class="blob-code blob-code-inner js-file-line">        addSharedTransition(fromViewId, toViewId, <span class="pl-c1">false</span>);</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L221" class="blob-num js-line-number" data-line-number="221"></td>
        <td id="file-sharedelementpagetransformer-java-LC221" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L222" class="blob-num js-line-number" data-line-number="222"></td>
        <td id="file-sharedelementpagetransformer-java-LC222" class="blob-code blob-code-inner js-file-line">
</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L223" class="blob-num js-line-number" data-line-number="223"></td>
        <td id="file-sharedelementpagetransformer-java-LC223" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">/**</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L224" class="blob-num js-line-number" data-line-number="224"></td>
        <td id="file-sharedelementpagetransformer-java-LC224" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * Set up shared element transition from element with &lt;<span class="pl-ent">code</span>&gt;fromViewId&lt;/code&gt; to</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L225" class="blob-num js-line-number" data-line-number="225"></td>
        <td id="file-sharedelementpagetransformer-java-LC225" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * element with &lt;<span class="pl-ent">code</span>&gt;toViewId&lt;/code&gt;. Note that you can setup each transition</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L226" class="blob-num js-line-number" data-line-number="226"></td>
        <td id="file-sharedelementpagetransformer-java-LC226" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * direction separately. e.g. &lt;<span class="pl-ent">br</span>/&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L227" class="blob-num js-line-number" data-line-number="227"></td>
        <td id="file-sharedelementpagetransformer-java-LC227" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * &lt;<span class="pl-ent">code</span>&gt;addSharedTransition(R.id.FirstPageTextView, R.id.SecondPageTextView)&lt;/code&gt;&lt;<span class="pl-ent">br</span>/&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L228" class="blob-num js-line-number" data-line-number="228"></td>
        <td id="file-sharedelementpagetransformer-java-LC228" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * and&lt;<span class="pl-ent">br</span>/&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L229" class="blob-num js-line-number" data-line-number="229"></td>
        <td id="file-sharedelementpagetransformer-java-LC229" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * &lt;<span class="pl-ent">code</span>&gt;addSharedTransition(R.id.SecondPageTextView, R.id.FirstPageTextView)&lt;/code&gt;&lt;<span class="pl-ent">br</span>/&gt;</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L230" class="blob-num js-line-number" data-line-number="230"></td>
        <td id="file-sharedelementpagetransformer-java-LC230" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * are different.</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L231" class="blob-num js-line-number" data-line-number="231"></td>
        <td id="file-sharedelementpagetransformer-java-LC231" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * <span class="pl-k">@param</span> fromViewId</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L232" class="blob-num js-line-number" data-line-number="232"></td>
        <td id="file-sharedelementpagetransformer-java-LC232" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * <span class="pl-k">@param</span> toViewId</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L233" class="blob-num js-line-number" data-line-number="233"></td>
        <td id="file-sharedelementpagetransformer-java-LC233" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * <span class="pl-k">@param</span> bothDirections to include backward transition from toViewId to fromViewId aswell</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L234" class="blob-num js-line-number" data-line-number="234"></td>
        <td id="file-sharedelementpagetransformer-java-LC234" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     <span class="pl-c">*/</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L235" class="blob-num js-line-number" data-line-number="235"></td>
        <td id="file-sharedelementpagetransformer-java-LC235" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">addSharedTransition</span>(<span class="pl-k">int</span> <span class="pl-v">fromViewId</span>, <span class="pl-k">int</span> <span class="pl-v">toViewId</span>, <span class="pl-k">boolean</span> <span class="pl-v">bothDirections</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L236" class="blob-num js-line-number" data-line-number="236"></td>
        <td id="file-sharedelementpagetransformer-java-LC236" class="blob-code blob-code-inner js-file-line">        sharedElementIds<span class="pl-k">.</span>add(<span class="pl-k">new</span> <span class="pl-k">Pair&lt;&gt;</span>(fromViewId, toViewId));</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L237" class="blob-num js-line-number" data-line-number="237"></td>
        <td id="file-sharedelementpagetransformer-java-LC237" class="blob-code blob-code-inner js-file-line">        <span class="pl-k">if</span>(bothDirections) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L238" class="blob-num js-line-number" data-line-number="238"></td>
        <td id="file-sharedelementpagetransformer-java-LC238" class="blob-code blob-code-inner js-file-line">            sharedElementIds<span class="pl-k">.</span>add(<span class="pl-k">new</span> <span class="pl-k">Pair&lt;&gt;</span>(toViewId, fromViewId));</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L239" class="blob-num js-line-number" data-line-number="239"></td>
        <td id="file-sharedelementpagetransformer-java-LC239" class="blob-code blob-code-inner js-file-line">        }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L240" class="blob-num js-line-number" data-line-number="240"></td>
        <td id="file-sharedelementpagetransformer-java-LC240" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L241" class="blob-num js-line-number" data-line-number="241"></td>
        <td id="file-sharedelementpagetransformer-java-LC241" class="blob-code blob-code-inner js-file-line">    <span class="pl-c"><span class="pl-c">/**</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L242" class="blob-num js-line-number" data-line-number="242"></td>
        <td id="file-sharedelementpagetransformer-java-LC242" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * In case there is "ladder" appears between while transition.</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L243" class="blob-num js-line-number" data-line-number="243"></td>
        <td id="file-sharedelementpagetransformer-java-LC243" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * You may try to tune that magical scale to get rid of it.</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L244" class="blob-num js-line-number" data-line-number="244"></td>
        <td id="file-sharedelementpagetransformer-java-LC244" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     * <span class="pl-k">@param</span> magicalAndroidRenderingScale float between 0 and infinity. Typically very close to 1.0</span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L245" class="blob-num js-line-number" data-line-number="245"></td>
        <td id="file-sharedelementpagetransformer-java-LC245" class="blob-code blob-code-inner js-file-line"><span class="pl-c">     <span class="pl-c">*/</span></span></td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L246" class="blob-num js-line-number" data-line-number="246"></td>
        <td id="file-sharedelementpagetransformer-java-LC246" class="blob-code blob-code-inner js-file-line">    <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">void</span> <span class="pl-en">setMagicalAndroidRenderingScale</span>(<span class="pl-k">float</span> <span class="pl-v">magicalAndroidRenderingScale</span>) {</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L247" class="blob-num js-line-number" data-line-number="247"></td>
        <td id="file-sharedelementpagetransformer-java-LC247" class="blob-code blob-code-inner js-file-line">        <span class="pl-c1">MAGICAL_ANDROID_RENDERING_SCALE</span> <span class="pl-k">=</span> magicalAndroidRenderingScale;</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L248" class="blob-num js-line-number" data-line-number="248"></td>
        <td id="file-sharedelementpagetransformer-java-LC248" class="blob-code blob-code-inner js-file-line">    }</td>
      </tr>
      <tr>
        <td id="file-sharedelementpagetransformer-java-L249" class="blob-num js-line-number" data-line-number="249"></td>
        <td id="file-sharedelementpagetransformer-java-LC249" class="blob-code blob-code-inner js-file-line">}</td>
      </tr>
</tbody></table>


  </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="" style="float:right">view raw</a>
        <a href="">SharedElementPageTransformer.java</a>
        hosted with ‚ù§ by <a href="">GitHub</a>
      </div>
    </div>
</div>
</div></div></div><br><h3 id="kak-vyglyadit-rabota-s-bibliotekoy">  Como √© o trabalho com a biblioteca </h3><br><p>  A configura√ß√£o acabou bem concisa. </p><br><div class="spoiler">  <b class="spoiler_title">A configura√ß√£o completa do nosso exemplo √© semelhante a esta</b> <div class="spoiler_text"><pre> <code class="java hljs">ArrayList&lt;Fragment&gt; fragments = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); fragments.add(hello_fragment); fragments.add(small_picture_fragment); fragments.add(big_picture_fragment); SharedElementPageTransformer transformer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedElementPageTransformer(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, fragments); transformer.addSharedTransition(R.id.smallPic_image_cat2, R.id.bigPic_image_cat, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); transformer.addSharedTransition(R.id.smallPic_text_label3, R.id.bigPic_text_label, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); transformer.addSharedTransition(R.id.hello_text, R.id.smallPic_text_label3, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); viewPager.setPageTransformer(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, transformer); viewPager.addOnPageChangeListener(transformer);</code> </pre></div></div><br><p>  <code>onClick</code> , incluindo todas as transi√ß√µes, pode ser assim: </p><br><pre> <code class="java hljs">smallCatImageView.setOnClickListener( v -&gt; activity.viewPager.setCurrentItem(<span class="hljs-number"><span class="hljs-number">2</span></span>) );</code> </pre> <br><p>  Para que o c√≥digo n√£o desapare√ßa, coloquei a biblioteca no reposit√≥rio do <em>JCenter</em> e no <em>GitHub</em> .  Ent√£o entrei em contato com o mundo de c√≥digo aberto.  Voc√™ pode experiment√°-lo em seu projeto simplesmente adicionando </p><br><pre> <code class="java hljs">dependencies { <span class="hljs-comment"><span class="hljs-comment">//... implementation 'com.github.kirillgerasimov:shared-element-view-pager:0.0.2-alpha' }</span></span></code> </pre> <br><p>  Todas as fontes est√£o dispon√≠veis no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">GitHub</a> </p><br><h3 id="zaklyuchenie">  Conclus√£o </h3><br><p>  Mesmo que a Internet n√£o saiba a resposta, isso n√£o significa que n√£o.  Procure solu√ß√µes alternativas, tente at√© que funcione.  Talvez voc√™ seja o primeiro a chegar ao fundo disso e compartilh√°-lo com a comunidade. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt451116/">https://habr.com/ru/post/pt451116/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt451104/index.html">Extens√£o do navegador Intelligent Speaker que l√™ artigos: vozes adicionadas do Microsoft Azure</a></li>
<li><a href="../pt451106/index.html">Extens√£o do navegador Intelligent Speaker que l√™ textos para voc√™: voz da Microsoft adicionada (foram apenas da AWS Polly)</a></li>
<li><a href="../pt451110/index.html">Alarme sonoro</a></li>
<li><a href="../pt451112/index.html">Jetpack compor</a></li>
<li><a href="../pt451114/index.html">Micr√≥bios ind√≠genas e pesquisa de produtos nas lojas</a></li>
<li><a href="../pt451118/index.html">O teste n√£o √© para iniciantes</a></li>
<li><a href="../pt451120/index.html">Sobre os desafios de transportar c√©lulas mortas para plataformas m√≥veis</a></li>
<li><a href="../pt451124/index.html">Desenvolvimento de prote√≠nas na nuvem usando Python e Transcriptic ou Como criar qualquer prote√≠na por US $ 360</a></li>
<li><a href="../pt451126/index.html">Caixa de ferramentas para pesquisadores - Edi√ß√£o um: Auto-organiza√ß√£o e visualiza√ß√£o de dados</a></li>
<li><a href="../pt451130/index.html">Swift: ARC e gerenciamento de mem√≥ria</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>