<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåê üê∏ üßìüèª Pizza AI: c√≥mo usamos dos redes neuronales recurrentes ü•¶ üßõüèø ü¶î</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="El tema de las redes neuronales excita los corazones de los desarrolladores, cient√≠ficos y especialistas en marketing no durante el primer a√±o, pero p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pizza AI: c√≥mo usamos dos redes neuronales recurrentes</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dodopizzadev/blog/471650/">  El tema de las redes neuronales excita los corazones de los desarrolladores, cient√≠ficos y especialistas en marketing no durante el primer a√±o, pero para algunos ni siquiera la primera d√©cada.  Pero todos sabemos que, a menudo, en los proyectos basados ‚Äã‚Äãen neuronas hay una gran fecha simple y un bolet√≠n de marketing, inflado en el contexto de un encabezado de clickbait.  Intentamos evitar tal historia y desarrollamos un proyecto de neuropizza basado en un estudio de compatibilidad molecular de ingredientes, an√°lisis de 300 mil recetas y pura creatividad.  Debajo del corte puede encontrar los detalles y encontrar el enlace de c√≥digo abierto en GitHub. <br><br><img src="https://habrastorage.org/webt/6t/z6/jd/6tz6jdo9ickpopo97ovvc38w1l4.png"><br><br>  ¬øPuede un autom√≥vil crear algo nuevo o est√° limitado por lo que sabe?  Hasta ahora, nadie sabe la respuesta a esta pregunta.  Pero ahora, la inteligencia artificial resuelve perfectamente los problemas de analizar grandes datos no est√°ndar. <br><br>  Una vez en Dodo Pizza decidieron realizar un experimento: sistematizar y describir estructuralmente lo que se considera ca√≥tico y subjetivo en todo el mundo: el gusto.  La inteligencia artificial ayud√≥ a encontrar las combinaciones m√°s locas de ingredientes que, a pesar de su naturaleza inusual, resultaron sabrosas para la mayor√≠a de las personas. <br><br>  Mi colega y yo actuamos como especialistas en redes neuronales de MIPT y Skoltech en este proyecto inusual.  Hemos desarrollado y entrenado una red neuronal que puede resolver el problema de generar recetas de cocina.  En el curso del trabajo, se analizaron m√°s de 300,000 recetas, as√≠ como los resultados de la investigaci√≥n cient√≠fica sobre la compatibilidad molecular de los ingredientes.  En base a esto, AI aprendi√≥ a encontrar conexiones no obvias entre los ingredientes y a comprender c√≥mo se combinan entre s√≠ y c√≥mo la presencia de cada uno de ellos afecta la compatibilidad de todos los dem√°s. <br><a name="habracut"></a><br><h2>  C√≥mo nos metimos en el proyecto Dodo AI-pizza </h2><br>  Todo, como suele suceder, sucedi√≥ de repente.  Hubo un corto per√≠odo de tiempo de espera antes de la pr√°ctica de verano, acabamos de terminar el curso de Aprendizaje profundo, defendimos el proyecto e intentamos adaptarnos a un ritmo m√°s relajado de estudio / vida.  Pero no pudieron: accidentalmente se encontraron reposts en una solicitud personal de BBDO sobre encontrar chicos que pudieran escribir una red neuronal para generar nuevas recetas.  M√°s espec√≠ficamente: nuevas recetas de pizza para Dodo.  Sin dudarlo, decidimos que quer√≠amos intentarlo. <br><br>  Cuando el proyecto reci√©n comenzaba, no entend√≠amos completamente si ir√≠a m√°s all√°, si habr√≠a una implementaci√≥n pr√°ctica, simplemente est√°bamos interesados ‚Äã‚Äãen la tarea.  Una gran cantidad de redbowl e internet r√°pido nos ayudaron y nos hicieron avanzar.  Mirando hacia atr√°s, entendemos que algunas cosas podr√≠an hacerse de manera diferente, pero esto es normal. <br><br>  En cualquier caso, despu√©s de algunas semanas, el modelo de trabajo de la red neuronal estaba listo, comenz√≥ la etapa de su lanzamiento en producci√≥n.  Tenemos mucha suerte de que el proyecto no pueda llamarse industrial o t√©cnico en el sentido estricto de estas palabras.  El estado del experimento es m√°s adecuado para √©l. <br><br>  Usando nuestro modelo, se generaron varias variantes de recetas de pizza, que pasamos a manos de chefs de Dodo muy geniales para realizar pruebas de productos.  El momento de degustaci√≥n de pizza en el Dodo R&amp;D Lab fue un hito en t√©rminos de reconocimiento del valor del trabajo que hicimos.  Fue muy emocionante ver el producto vendido.  De hecho, a menudo todo el desarrollo y las soluciones son algo bastante ef√≠mero e intangible, y aqu√≠ el resultado no solo puede ser tocado, sino tambi√©n probado. <br><br><h2>  Colecci√≥n primaria de conjunto de datos y chile </h2><br>  Cualquier modelo necesita datos para funcionar.  Por lo tanto, para entrenar nuestra IA, recolectamos 300,000 recetas de todas las fuentes disponibles.  Era importante para nosotros recolectar no solo recetas de pizza, sino tambi√©n diversificar la selecci√≥n tanto como sea posible, mientras tratamos de no ir m√°s all√° de lo razonable (por ejemplo, ignorar las recetas de c√≥cteles, d√°ndonos cuenta de que su sem√°ntica no afectar√° en gran medida la sem√°ntica de recetas de pizza). <br><br>  Despu√©s de recopilar los datos, obtuvimos m√°s de 100,000 ingredientes √∫nicos.  El gran problema era llevarlos a una forma.  ¬øPero de d√≥nde vinieron tantos art√≠culos?  Todo es simple, por ejemplo, los chiles en las recetas se indican de esta manera: chile, chile, chile, chile.  Es obvio para usted que este es el mismo pimiento, pero la red neuronal percibe diferentes ortograf√≠as como entidades separadas.  Lo arreglamos  Despu√©s de limpiar los datos y llevarlos a una vista, solo nos quedaban 1,000 posiciones. <br><br><h2>  An√°lisis de gustos mundiales </h2><br>  Despu√©s de recibir el conjunto de datos listo para trabajar, realizamos el an√°lisis inicial.  Primero, observamos qu√© cocinas del mundo est√°n representadas en nuestro conjunto de datos en una proporci√≥n cuantitativa. <br><br><img src="https://habrastorage.org/webt/ye/_f/-s/ye_f-s1ogcsbp3zraf8g4tjy9bg.png"><br><br>  Para cada una de las cocinas, hemos identificado los ingredientes m√°s populares. <br><br><img src="https://habrastorage.org/webt/7o/hi/rl/7ohirlllid7ss1lv21mwuy9flz0.png"><br><br>  En estos gr√°ficos, las diferencias en las preferencias de sabor de las personas por pa√≠s son notables.  Tambi√©n queda claro a partir de estas preferencias c√≥mo las personas de diferentes pa√≠ses combinan ingredientes entre s√≠. <br><br><h2>  Dos hallazgos de pizza </h2><br>  Despu√©s de este an√°lisis global, decidimos estudiar recetas de pizza de todo el mundo con m√°s detalle para encontrar patrones en su composici√≥n.  Aqu√≠ est√°n las conclusiones que hicimos: <br><br><ol><li>  Las recetas de pizza son un orden de magnitud menor que las recetas y postres de carne / pollo. <br><br><img src="https://habrastorage.org/webt/_y/nd/dg/_ynddgqu4tewekxhnofpfcmswm4.png"></li><li>  Muchos de los ingredientes que se encuentran en las recetas de pizza son limitados.  La variabilidad de los productos es mucho menor que en otros platos. <br><br><img src="https://habrastorage.org/webt/rt/ra/sb/rtrasbuq1b2elfdgih1jdupn39a.png"></li></ol><br><h2>  Como probamos el modelo </h2><br>  Encontrar combinaciones de sabores reales no es lo mismo que revelar la compatibilidad de las mol√©culas.  Todos los quesos tienen una composici√≥n molecular similar, pero esto no significa que las combinaciones exitosas se encuentren solo en el √°rea de los ingredientes m√°s cercanos. <br><br><img src="https://habrastorage.org/webt/p9/yy/vm/p9yyvmf3mkjhenbhl3jm7gvwawm.png"><br><br>  Sin embargo, deber√≠amos ver exactamente la compatibilidad de ingredientes similares al nivel molecular cuando traducimos todo a las matem√°ticas.  Debido a que los objetos similares (los mismos quesos) deben seguir siendo similares, sin importar c√≥mo los describamos.  Entonces podemos determinar que describi√≥ estos objetos correctamente. <br><br><h2>  Convertir receta a matem√°tica </h2><br>  Para presentar la receta en una forma comprensible para la red neuronal, utilizamos el muestreo negativo Skip-Gram (SGNS), el algoritmo word2vec, que se basa en la aparici√≥n de palabras en contexto.  Decidimos no usar los modelos word2vec previamente entrenados, porque nuestra receta es obviamente diferente en estructura sem√°ntica de los textos simples.  Usando tales modelos, podr√≠amos perder informaci√≥n importante. <br><br>  Puede evaluar el resultado de word2vec mirando los vecinos sem√°nticos m√°s cercanos.  Por ejemplo, esto es lo que nuestro modelo sabe sobre el queso: <br><br><img src="https://habrastorage.org/webt/cs/rp/sf/csrpsfed7ebion0oaov3lfoeff0.png"><br><br>  Para probar c√≥mo los modelos sem√°nticos pueden capturar las interacciones de las recetas de los ingredientes, aplicamos un modelo de modelado tem√°tico para todas las recetas de la muestra.  Es decir, intentaron dividir el conjunto de datos de recetas en grupos de acuerdo con patrones matem√°ticamente identificados. <br><br><img src="https://habrastorage.org/webt/m6/dy/vo/m6dyvo5zqcczzgvivkvjkndiwqg.png"><br><br>  Sabiendo de antemano que cierta muestra de recetas pertenece a varias clases reales obtenidas de los datos, construimos la distribuci√≥n de pertenencia de cada clase real a las generadas identificadas. <br><br><img src="https://habrastorage.org/webt/09/gi/cg/09gicgc1q1xfv_juriqmu_imqde.png"><br><br>  La m√°s obvia fue la clase de postres, que form√≥ el tema 0 y 1, generado por el modelo tem√°tico.  Adem√°s de los postres, casi no hay otras clases en estas materias, lo que sugiere que los postres se separan f√°cilmente de otras clases de platos.  Tambi√©n en cada asignatura hay una clase que lo describe mejor.  Esto significa que nuestros modelos se adaptaron bien a la descripci√≥n matem√°tica del significado no obvio de "gusto". <br><br><h2>  Generaci√≥n de recetas </h2><br>  Para crear nuevas recetas, utilizamos dos redes neuronales recurrentes.  Para hacer esto, sugerimos que en el espacio com√∫n de recetas hay un subespacio responsable de las recetas de pizza.  Para que la red neuronal aprenda a crear nuevas recetas de pizza, tuvimos que encontrar este subespacio. <br><br>  Tal tarea es similar en significado a la codificaci√≥n autom√°tica de im√°genes cuando presentamos una imagen como un vector de peque√±a dimensi√≥n.  En este caso, los vectores pueden contener una gran cantidad de informaci√≥n espec√≠fica sobre la imagen. <br><br>  Por ejemplo, para el reconocimiento facial en la foto, dichos vectores pueden almacenar informaci√≥n sobre el color del cabello humano en una celda separada.  Elegimos este enfoque precisamente por las propiedades √∫nicas del subespacio oculto. <br><br>  Para identificar el subespacio de pizza, ejecutamos recetas a trav√©s de dos redes neuronales recurrentes.  El primero recibi√≥ una receta de pizza en la entrada y busc√≥ su representaci√≥n en forma de un vector oculto.  El segundo recibi√≥ un vector oculto de la primera red neuronal y tuvo que ofrecer una receta basada en √©l.  Las recetas en la entrada de la primera red neuronal y en la salida de la segunda deber√≠an haber coincidido. <br><br>  Entonces, dos redes neuronales en el formato de decodificaci√≥n del codificador aprendieron a transmitir correctamente la receta a un vector oculto (latente) y viceversa.  En base a esto, pudimos descubrir un subespacio oculto que es responsable de todas las recetas de pizza. <br><br><img src="https://habrastorage.org/webt/pv/je/w1/pvjew1cinuuscwwlqib5etg3pxe.png"><br><br><img src="https://habrastorage.org/webt/uj/bm/q1/ujbmq1s-m-u9wjzxt-v0zjxbjhi.png"><br><br><h2>  Compatibilidad molecular </h2><br>  Cuando resolvimos el problema de crear una receta de pizza, tuvimos que agregar el criterio de compatibilidad molecular al modelo.  Para esto, utilizamos los resultados de un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">estudio conjunto de</a> cient√≠ficos de Cambridge y varias universidades de EE. UU. <br><br>  Como resultado del estudio, se descubri√≥ que los ingredientes con el mayor n√∫mero de pares moleculares totales se combinan mejor.  Por lo tanto, al crear la receta, la red neuronal prefer√≠a ingredientes con una estructura molecular similar. <br><br><h2>  Resultado e IA Pizza </h2><br>  Como resultado, nuestra red neuronal ha aprendido a crear con √©xito recetas de pizza.  Al ajustar los coeficientes, la IA puede producir tanto recetas cl√°sicas (como Margarita o Pepperoni) como locas.  Una de esas recetas locas form√≥ la base de la primera pizza molecularmente perfecta del mundo con diez ingredientes: salsa de tomate, mel√≥n, pera, pollo, tomates cherry, at√∫n, menta, br√≥coli, queso mozzarella, granola.  La edici√≥n limitada incluso se puede comprar en una de las pizzer√≠as de Dodo.  Y aqu√≠ hay algunas recetas m√°s interesantes que puedes intentar cocinar en casa: <br><br><ul><li>  espinacas, queso, tomate, aceituna negra, aceituna, ajo, pimienta, albahaca, c√≠tricos, mel√≥n, brotes, suero de leche, lim√≥n, lubina, nuez, colinabo; </li><li>  cebolla, tomate, aceituna, pimienta negra, pan, masa; </li><li>  pollo, cebolla, aceituna negra, queso, salsa, tomate, aceite de oliva, queso mozzarella; </li><li>  tomate, mantequilla, queso crema, pimienta, aceite de oliva, queso, pimienta negra, queso mozzarella; </li></ul><br><blockquote>  Todo esto ser√≠a basura si no le damos un enlace a lo m√°s interesante: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">En este sitio, AI genera nuevas recetas de pizza.</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥digo fuente y detalles t√©cnicos del proyecto</a> . </li></ul></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/471650/">https://habr.com/ru/post/471650/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../471634/index.html">C√≥mo construir marketing por correo electr√≥nico en una empresa y evitar problemas: 6 pasos pr√°cticos</a></li>
<li><a href="../471636/index.html">Veh√≠culo no tripulado: algoritmos de animaci√≥n. Informe Yandex</a></li>
<li><a href="../471640/index.html">Una descripci√≥n general de las t√©cnicas de an√°lisis de blockchain an√≥nimas</a></li>
<li><a href="../471642/index.html">Time Killer desde la infancia</a></li>
<li><a href="../471644/index.html">De nuevo sobre phpQuery</a></li>
<li><a href="../471652/index.html">Mi vida con Boost Graph Library</a></li>
<li><a href="../471654/index.html">C√≥mo desarrollamos un dispositivo de internet de las cosas resistente a las heladas</a></li>
<li><a href="../471658/index.html">Estafadores telef√≥nicos. La primera acci√≥n en la que me dicen amablemente sobre otros estafadores</a></li>
<li><a href="../471660/index.html">Conferencia de psicolog√≠a del jugador</a></li>
<li><a href="../471662/index.html">Web: autenticaci√≥n de JavaScript, ofuscaci√≥n y c√≥digo nativo. Resoluci√≥n de problemas con r0ot-mi Web - Cliente. Parte 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>