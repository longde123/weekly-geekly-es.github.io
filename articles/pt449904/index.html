<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòß üëÇüèª üßû Criando uma DLL de proxy para verifica√ß√µes de opera√ß√£o de seq√ºestro de DLL üë©üèΩ‚Äçü§ù‚Äçüë®üèº üë©üèΩ‚Äçüíº üëÅÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quando examino a seguran√ßa do software, um dos pontos a verificar √© trabalhar com bibliotecas din√¢micas. Ataques como o DLL de seq√ºestro ("dll spoofin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Criando uma DLL de proxy para verifica√ß√µes de opera√ß√£o de seq√ºestro de DLL</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pm/blog/449904/">  Quando examino a seguran√ßa do software, um dos pontos a verificar √© trabalhar com bibliotecas din√¢micas.  Ataques como o DLL de seq√ºestro ("dll spoofing" ou "dll interception") s√£o muito raros.  Provavelmente, isso se deve ao fato de que os desenvolvedores do Windows adicionam mecanismos de seguran√ßa para evitar ataques, e os desenvolvedores de software s√£o mais cuidadosos com a seguran√ßa.  Mas o mais interessante √© a situa√ß√£o em que o software de destino est√° vulner√°vel. <br><br>  Descrevendo brevemente o ataque, a DLL de seq√ºestro est√° criando uma situa√ß√£o na qual algum execut√°vel tenta carregar a dll, mas o invasor interv√©m nesse processo e, em vez da biblioteca esperada, uma dll especialmente preparada √© carregada com a carga √∫til do invasor.  Como resultado, o c√≥digo da dll ser√° executado com os direitos do aplicativo iniciado; portanto, os aplicativos com direitos mais altos geralmente s√£o selecionados como destino. <br><br>  Para que a biblioteca seja carregada corretamente, v√°rias condi√ß√µes devem ser atendidas: o tamanho do bit do arquivo execut√°vel e a biblioteca devem corresponder e, se a biblioteca for carregada quando o aplicativo for iniciado, a dll dever√° exportar todas as fun√ß√µes que esse aplicativo espera importar.  Frequentemente, uma importa√ß√£o n√£o √© suficiente - √© muito desej√°vel que o aplicativo continue seu trabalho ap√≥s carregar a dll.  Para isso, √© necess√°rio que as fun√ß√µes da biblioteca preparada funcionem da mesma forma que o original.  A maneira mais f√°cil de fazer isso √© simplesmente passando as chamadas de fun√ß√£o de uma biblioteca para outra.  Essas s√£o as DLLs chamadas proxy dlls. <br><br><img src="https://habrastorage.org/webt/9l/cw/yb/9lcwyb3oo0wolz45digsbnh6wmw.jpeg"><br><br>  Sob o corte, haver√° v√°rias op√ß√µes para criar essas bibliotecas - na forma de c√≥digo e utilit√°rios. <br><a name="habracut"></a><br>
<h2>  <font color="orange">Uma pequena revis√£o te√≥rica</font> </h2><br>  As bibliotecas s√£o carregadas com mais frequ√™ncia usando a fun√ß√£o LoadLibrary, na qual o nome da biblioteca √© passado.  Se, em vez do nome, voc√™ passar o caminho completo, o aplicativo tentar√° carregar a biblioteca especificada.  Por exemplo, chamar LoadLibrary ("C: \ Windows \ system32 \ version.dll") carregar√° a dll especificada.  Ou, se a biblioteca n√£o existir, ela n√£o ser√° carregada. <br><br><div class="spoiler">  <b class="spoiler_title">Um pouco de t√©dio</b> <div class="spoiler_text">  Se alguma dll j√° estiver carregada no aplicativo, ela n√£o ser√° carregada novamente.  Como o version.dll √© carregado no in√≠cio de quase qualquer arquivo exe, na verdade, a chamada acima n√£o carrega nada.  Mas ainda consideramos o caso geral, considere o exemplo como uma chamada para alguma biblioteca abstrata. <br></div></div><br>  √â outra quest√£o se voc√™ escrever LoadLibrary ("version.dll").  Em uma situa√ß√£o normal, o resultado ser√° exatamente o mesmo do caso anterior - C: \ Windows \ system32 \ version.dll ser√° carregado, mas n√£o t√£o simples. <br><br>  Primeiro, ser√° pesquisada uma biblioteca, que ser√° na seguinte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ordem</a> : <br><br><ol><li>  Pasta execut√°vel </li><li>  Pasta C: \ Windows \ System32 </li><li>  Pasta C: \ Windows \ System </li><li>  Pasta C: \ Windows </li><li>  A pasta definida como atual para o aplicativo </li><li>  Pastas da vari√°vel de ambiente PATH </li></ol><br><div class="spoiler">  <b class="spoiler_title">Um pouco mais de t√©dio</b> <div class="spoiler_text">  Ao iniciar aplicativos de 32 bits em um sistema de 64 bits, todas as chamadas para C: \ Windows \ system32 ser√£o encaminhadas para C: \ Windows \ SysWOW64.  Isso √© apenas pela precis√£o da descri√ß√£o, do ponto de vista do atacante a diferen√ßa n√£o √© particularmente importante. <br></div></div><br>  Quando voc√™ executa o arquivo exe, o sistema operacional carrega todas as bibliotecas da se√ß√£o de importa√ß√£o de arquivos.  Em um sentido geral, podemos assumir que o sistema operacional for√ßa o arquivo a chamar LoadLibrary, passando todos os nomes de biblioteca escritos na se√ß√£o de importa√ß√£o.  Como em 99,9% dos casos existem nomes e n√£o caminhos, quando o aplicativo √© iniciado, todas as bibliotecas carregadas ser√£o pesquisadas no sistema. <br><br>  Na lista de locais de pesquisa da DLL, dois pontos s√£o realmente importantes para n√≥s - 1 e 6. Se colocarmos version.dll na mesma pasta de onde o arquivo √© iniciado, em vez do sistema, o carregado ser√° carregado.  Essa situa√ß√£o quase nunca √© encontrada, porque, se houver uma oportunidade de colocar uma biblioteca, provavelmente ser√° poss√≠vel substituir o pr√≥prio arquivo execut√°vel.  Mas ainda assim, essas situa√ß√µes s√£o poss√≠veis.  Por exemplo, se o arquivo execut√°vel estiver localizado em uma pasta grav√°vel e for um servi√ßo com inicializa√ß√£o autom√°tica, ele n√£o poder√° ser alterado enquanto o servi√ßo estiver em execu√ß√£o.  Ou o arquivo iniciado √© verificado externamente pela soma de verifica√ß√£o antes de iniciar, e a substitui√ß√£o do arquivo ainda n√£o √© uma op√ß√£o.  Mas colocar a biblioteca ao lado dela ser√° bastante real. <br><br>  Voc√™ pode n√£o conseguir criar arquivos ao lado de arquivos execut√°veis, mas pode criar pastas.  Nessa situa√ß√£o, o mecanismo de redirecionamento WinSxS (tamb√©m conhecido como "DotLocal") pode funcionar. <br><br><div class="spoiler">  <b class="spoiler_title">Brevemente sobre DotLocal</b> <div class="spoiler_text">  O manifesto do arquivo pode conter uma depend√™ncia na biblioteca de uma vers√£o espec√≠fica.  Nesse caso, ao iniciar o arquivo execut√°vel (por exemplo, application.exe), o sistema operacional verificar√° a exist√™ncia de uma pasta chamada application.exe.local na mesma pasta que o pr√≥prio arquivo.  Essa pasta deve ter uma subpasta com um nome complexo, como amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.9600.19291_none_6248a9f3ecb5e89b, na qual j√° existe uma biblioteca comctl32.dll.  O nome da biblioteca e as informa√ß√µes para o nome da pasta devem ser indicados no manifesto. Aqui est√° apenas um exemplo do primeiro processo encontrado.  Se n√£o houver pastas ou arquivos, a biblioteca ser√° retirada de C: \ Windows \ WinSxS.  No exemplo, C: \ Windows \ WinSxS \ amd64_microsoft.windows.common-controls_6595b64144ccf1df_6.0.9600.19291_none_6248a9f3ecb5e89b \ comctl32.dll. <br></div></div><br>  Mas isso √© mais a exce√ß√£o do que a regra.  Mas as situa√ß√µes em que a pesquisa dll atinge o sexto n√∫mero na lista s√£o bastante reais.  Se o aplicativo tentar carregar uma dll que n√£o esteja no sistema ou ao lado do arquivo, todas as pesquisas subir√£o para 6 pontos, que podem ser pastas grav√°veis. <br><br>  Por exemplo, uma instala√ß√£o t√≠pica do Python ocorre com mais freq√º√™ncia na pasta C: \ Python (ou fechada).  O pr√≥prio instalador python sugere adicionar suas pastas √† vari√°vel de sistema PATH.  Como resultado, temos um bom trampolim para iniciar um ataque - a pasta √© grav√°vel por todos os usu√°rios e qualquer tentativa de carregar uma biblioteca inexistente ir√° para a pesquisa de caminho do PATH. <br><br>  Agora que a teoria foi conclu√≠da, considere a cria√ß√£o da carga √∫til - as pr√≥prias bibliotecas de proxy. <br><br><h2>  <font color="orange">A primeira op√ß√£o</font>  <font color="orange">Biblioteca de proxy honesta</font> </h2><br>  Vamos come√ßar com uma relativamente simples - criaremos uma biblioteca de proxy honesta.  Honestidade, neste caso, implica que todas as fun√ß√µes na DLL ser√£o registradas explicitamente e, para cada fun√ß√£o, uma chamada de fun√ß√£o com o mesmo nome da biblioteca original ser√° gravada.  Trabalhar com essa biblioteca ser√° completamente transparente para o c√≥digo chamado: se ele chamar alguma fun√ß√£o, receber√° a resposta correta, o resultado e tudo o que deve acontecer lado a lado. <br><br>  Aqui est√° um link para o exemplo finalizado ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> ) da biblioteca version.dll. <br><br>  Destaques do c√≥digo: <br><br><ul><li>  Todos os prot√≥tipos de fun√ß√µes da tabela de exporta√ß√£o da biblioteca original s√£o descritos honestamente. </li><li>  A biblioteca original √© carregada e todas as chamadas para nossas fun√ß√µes s√£o lan√ßadas nela. </li></ul><br>  <b>Convenientemente</b> , o aplicativo continua funcionando corretamente, sem experimentar "efeitos especiais".  <b>√â inconveniente</b> que eu tenha que escrever um monte de c√≥digo uniforme para cada uma das fun√ß√µes, al√©m disso, verificando cuidadosamente a coincid√™ncia dos prot√≥tipos. <br><br><h2>  <font color="orange">A segunda op√ß√£o</font>  <font color="orange">Simplifique a escrita de c√≥digo</font> </h2><br>  Ao lidar com uma biblioteca como version.dll, onde a tabela de importa√ß√£o √© pequena, existem apenas 17 fun√ß√µes e os prot√≥tipos s√£o simples, uma biblioteca de proxy honesta √© uma boa op√ß√£o. <br><br><img src="https://habrastorage.org/webt/ws/cl/yv/wsclyv4uqz71puco7dp5jhsrhgq.png"><br><br>  Mas se o proxy da biblioteca, por exemplo, bcrypt, tudo fica mais complicado.  Aqui est√° sua tabela de importa√ß√£o: <br><br><img src="https://habrastorage.org/webt/b7/1v/5e/b71v5exl1zruqbn_0xlidadlpfs.png"><br><br>  57 recursos!  E aqui est√£o alguns exemplos de prot√≥tipos: <br><br><img src="https://habrastorage.org/webt/_5/du/ve/_5duve7awc84bk3btklrsqq6wzq.png"><br><img src="https://habrastorage.org/webt/7p/kq/5x/7pkq5xz7uxvpju2zcc3q4q78zcs.png"><br><br>  Digamos apenas que nada √© imposs√≠vel, mas fazer um proxy honesto para essa biblioteca n√£o √© muito agrad√°vel. <br><br>  Voc√™ pode simplificar o c√≥digo se enganar um pouco com as fun√ß√µes.  Declararemos todas as fun√ß√µes da biblioteca como __declspec (naked), e no corpo usaremos o c√≥digo do assembler que simplesmente faz jmp na fun√ß√£o da biblioteca original.  Isso nos permitir√° n√£o usar prot√≥tipos longos, mas colocar an√∫ncios simples em qualquer lugar sem exibir par√¢metros: <br><br>  void foo () <br><br>  Quando o aplicativo chama nossa fun√ß√£o, a biblioteca proxy n√£o realiza nenhuma manipula√ß√£o com o registrador e a pilha, permitindo que a fun√ß√£o original fa√ßa todo o trabalho como deveria. <br><br>  Um exemplo ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> ) da biblioteca version.dll com essa abordagem. <br><br>  Destaques: <br><br><ul><li>  A biblioteca original √© carregada e todas as chamadas para nossas fun√ß√µes s√£o lan√ßadas nela.  Os corpos de fun√ß√£o e o carregamento s√£o agrupados em macros. </li></ul><br>  Opera√ß√£o <b>conveniente</b> e correta do aplicativo e o fato de que mesmo um grande n√∫mero de fun√ß√µes √© facilmente descrito, gra√ßas √†s macros.  <b>√â inconveniente</b> que rake bastante inesperado em x64.  O Visual Studio (em algum lugar desde 2012, se bem me lembro) pro√≠be o uso de inser√ß√µes nuas e asm no c√≥digo de 64 bits.  Ao gravar um proxy do zero, √© necess√°rio que cada fun√ß√£o verifique se est√° descrita no arquivo def, se o original est√° carregado e se o corpo da fun√ß√£o est√° descrito. <br><br><h2>  <font color="orange">A terceira op√ß√£o.</font>  <font color="orange">N√≥s jogamos fora o corpo em geral</font> </h2><br>  Usar nu sugere mais uma op√ß√£o.  Voc√™ pode criar uma tabela de importa√ß√£o, que para todas as fun√ß√µes se referir√° a uma linha de c√≥digo real: <br><br>  void nop () {} <br><br>  Essa biblioteca ser√° carregada pelo aplicativo, mas n√£o funcionar√°.  Ao chamar qualquer uma das fun√ß√µes, a pilha provavelmente ser√° rasgada ou ocorrer√° outra sujeira.  Mas isso nem sempre √© ruim - se, por exemplo, o objetivo de uma inje√ß√£o de dll √© simplesmente executar o c√≥digo com os direitos necess√°rios, basta executar a carga da biblioteca proxy DllMain e encerrar o aplicativo silenciosamente imediatamente.  Nesse caso, n√£o ser√° feita uma chamada real para as fun√ß√µes e n√£o haver√° erros de queda. <br><br>  Um exemplo em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> , novamente para version.dll. <br><br>  Destaques do c√≥digo: <br><br><ul><li>  Todas as fun√ß√µes do arquivo def se referem a uma fun√ß√£o nop. </li></ul><br>  <b>Convenientemente,</b> essa biblioteca proxy √© gravada apenas por alguns minutos.  <b>√â inconveniente</b> que o aplicativo chamado pare de funcionar. <br><br><h2>  <font color="orange">A quarta op√ß√£o.</font>  <font color="orange">Leve utilit√°rios prontos</font> </h2><br>  Escrever uma dll √© bom, mas nem sempre √© conveniente e nem muito r√°pido, portanto, voc√™ deve considerar as op√ß√µes automatizadas. <br><br>  Voc√™ pode seguir o caminho dos v√≠rus antigos - pegue a biblioteca cujos proxies queremos criar, crie uma se√ß√£o execut√°vel do c√≥digo, anote a carga √∫til l√° e altere o ponto de entrada para esta se√ß√£o.  N√£o √© a maneira mais f√°cil, porque voc√™ pode acidentalmente quebrar algo, voc√™ precisa escrever no assembler, lembre-se do dispositivo do arquivo PE.  Este n√£o √© o nosso caminho. <br><br>  Para operar o dll hijack, adicionaremos outro dll hijack. <br><br><img src="https://habrastorage.org/webt/lo/rr/ux/lorruxyxi0m-fjomp-j22b18are.jpeg"><br><br>  Isso √© relativamente f√°cil de fazer.  Copiamos a biblioteca cujo proxy queremos criar e adicionamos alguma dll com uma fun√ß√£o arbitr√°ria √† tabela de importa√ß√£o dessa c√≥pia.  Agora o download seguir√° a cadeia - no in√≠cio do arquivo execut√°vel, a DLL do proxy ser√° carregada, o que carregar√° a pr√≥pria biblioteca especificada. <br><br>  ‚ÄúEi, voc√™ substituiu o carregamento de uma biblioteca por outra.  Qual √© o objetivo?  Mesmo assim, ser√° necess√°rio codificar dll! ".  Tudo est√° correto, mas ainda h√° um sentido.  Agora haver√° menos requisitos para uma biblioteca com uma carga √∫til.  Voc√™ pode especificar qualquer nome, o principal √© exportar apenas uma fun√ß√£o, que pode ter qualquer prot√≥tipo.  Digite o nome principal da biblioteca e a fun√ß√£o na tabela de importa√ß√£o. <br><br>  Uma biblioteca com carga √∫til pode ser uma para todas as ocasi√µes. <br><br>  Voc√™ pode modificar a tabela de importa√ß√£o com muitos editores de PE, por exemplo, CFF explorer ou pe-bear.  Para mim, escrevi um pequeno utilit√°rio em C # que corrige uma tabela sem gestos desnecess√°rios.  Fontes no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> , binar na se√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Release</a> . <br><br><h2>  <font color="orange">Conclus√£o</font> </h2><br>  No artigo, tentei divulgar os m√©todos b√°sicos para a cria√ß√£o de dll proxy, que eu mesmo usei.  Resta apenas dizer como se defender. <br><br>  N√£o h√° muitas recomenda√ß√µes universais: <br><br><ul><li>  N√£o armazene arquivos execut√°veis, especialmente aqueles executados com permiss√µes altas, em pastas grav√°veis ‚Äã‚Äãpara os usu√°rios. </li><li>  √â melhor primeiro encontrar e verificar a exist√™ncia da biblioteca antes de executar o LoadLibrary. </li><li>  Veja os m√©todos de prote√ß√£o existentes dispon√≠veis no sistema operacional.  Por exemplo, no Windows 10, voc√™ pode definir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o sinalizador PreferSystem32 para</a> que a pesquisa da DLL n√£o comece com a pasta do arquivo execut√°vel, mas com o system32. </li></ul><br>  Obrigado por sua aten√ß√£o, ficarei feliz em ouvir perguntas, sugest√µes, sugest√µes e coment√°rios. <br><br>  <b>UPD: Seguindo</b> o conselho dos comentaristas, lembro que voc√™ precisa escolher uma biblioteca com cuidado e cuidado.  Se a biblioteca estiver inclu√≠da na lista KnownDlls ou o nome for semelhante ao MinWin (ApiSetSchema, api-ms-win-core-console-l1-1-0.dll - isso √© tudo), provavelmente n√£o ser√° poss√≠vel intercept√°-lo devido aos recursos de processamento DLLs no sistema operacional. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt449904/">https://habr.com/ru/post/pt449904/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt449888/index.html">F√≠sica Qu√¢ntica: Decoherence</a></li>
<li><a href="../pt449890/index.html">Como est√£o as se√ß√µes algor√≠tmicas nas entrevistas no Yandex</a></li>
<li><a href="../pt449896/index.html">Como pastar gatos ou conselhos para um jovem programador</a></li>
<li><a href="../pt449898/index.html">Not√≠cias de Dentro para Fora</a></li>
<li><a href="../pt449902/index.html">Redes de TV a cabo para os menores. Parte 2: Composi√ß√£o e forma de onda</a></li>
<li><a href="../pt449906/index.html">Servidor REST auto-documentado (Node.JS, TypeScript, Koa, Joi, Swagger)</a></li>
<li><a href="../pt449908/index.html">DDR3 ou DDR4? Por que oferecemos Dell R420 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps por US $ 99 na Holanda?</a></li>
<li><a href="../pt449910/index.html">Runner do GitLab Shell. Lan√ßamento competitivo de servi√ßos de teste usando o Docker Compose</a></li>
<li><a href="../pt449918/index.html">Term√¥metro infravermelho com sensor MLX90614</a></li>
<li><a href="../pt449920/index.html">10 maneiras n√£o padronizadas de prejudicar o SEO ao alterar o CMS (b√¥nus +1)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>