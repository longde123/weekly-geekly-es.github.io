<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘£ ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘¨ğŸ» ğŸ¿ Percepat Ansible dengan Mitogen âœğŸ½ ğŸ¤ŸğŸ¾ ğŸ‘©â€âœˆï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Percepat Ansible dengan Mitogen! 


 â†’ versi Rusia 


 Ansible adalah salah satu Sistem Manajemen Konfigurasi yang paling populer saat ini. Setelah di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Percepat Ansible dengan Mitogen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/453446/"><h2>  Percepat Ansible dengan Mitogen! </h2><br><p>  â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">versi Rusia</a> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ansible</a> adalah salah satu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sistem Manajemen Konfigurasi yang</a> paling populer saat ini.  Setelah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">diakuisisi oleh Red Hat</a> pada tahun 2015 Ansible telah mencapai ribuan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">kontributor</a> dan menjadi salah satu alat penyebaran dan orkestrasi yang paling banyak digunakan.  Kasus penggunaannya cukup mengesankan. </p><br><p>  Dapat bekerja dengan koneksi SSH ke host jarak jauh.  Ini membuka sesi SSH, masuk ke shell, menyalin kode python melalui jaringan dan membuat file sementara di host jarak jauh dengan kode ini.  Pada langkah berikutnya, ia mengeksekusi file saat ini dengan interpreter python.  Semua alur kerja ini cukup berat dan ada beberapa cara untuk membuatnya lebih cepat dan lebih ringan. </p><a name="habracut"></a><br><p> Salah satu cara ini adalah menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pipa SSH</a> yang menggunakan kembali satu sesi SSH untuk menyalin kode python dari banyak tugas dan mencegah pembukaan beberapa sesi, yang menghemat banyak waktu.  (Jangan lupa untuk menonaktifkan pengaturan yang diperlukan untuk sudo di sisi jarak jauh di <code>/etc/sudoers</code> ) </p><br><p>  Cara baru untuk mempercepat Ansible adalah perpustakaan python besar yang disebut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mitogen</a> .  Jika seseorang seperti saya tidak terbiasa dengannya - perpustakaan ini memungkinkan eksekusi kode python dengan cepat pada host jarak jauh dan Ansible hanya merupakan salah satu kasusnya.  Mitogen menggunakan pipa UNIX pada mesin jarak jauh sambil melewati kode python "acar" yang dikompres dengan zlib.  Ini memungkinkan untuk menjalankannya dengan cepat dan tanpa banyak lalu lintas.  Jika Anda tertarik, Anda dapat membaca detail tentang cara kerjanya di halaman <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">"Cara kerjanya"</a> .  Tapi kami akan fokus hari ini pada bagian terkait yang memungkinkan. </p><br><p>  Mitogen dalam keadaan tertentu dapat mempercepat Ansible Anda dalam beberapa kali dan secara signifikan menurunkan bandwidth Anda.  Mari kita periksa kasus penggunaan yang paling populer dan mencari tahu apakah itu bermanfaat bagi kita. </p><br><p>  Kasing penggunaan yang paling populer untuk saya jalankan Ansible adalah: membuat file konfigurasi pada host jarak jauh, menginstal paket, mengunduh dan mengunggah file dari dan ke host jarak jauh.  Mungkin Anda ingin memeriksa kasus penggunaan lainnya, silakan tinggalkan komentar untuk artikel ini. </p><br><h2>  Ayo mulai bergulir! </h2><br><p>  Mengkonfigurasi Mitogen untuk Ansible sangat sederhana: <br>  Instal modul Mitogen: </p><br><pre> <code class="bash hljs">pip install mitogen</code> </pre> <br><p>  Kemudian konfigurasikan variabel lingkungan atau atur opsi konfigurasi dalam file ansible.cfg, kedua opsi tersebut baik-baik saja: <br>  Mari kita asumsikan / <code>/usr/lib/python2.7/site-packages/ansible_mitogen/plugins/strategy</code> python2.7/site-packages/ansible_mitogen/plugins/strategy adalah jalur Anda untuk menginstal pustaka Mitogen. </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">export</span></span> ANSIBLE_STRATEGY_PLUGINS=/usr/lib/python2.7/site-packages/ansible_mitogen/plugins/strategy <span class="hljs-built_in"><span class="hljs-built_in">export</span></span> ANSIBLE_STRATEGY=mitogen_linear</code> </pre> <br><p>  atau </p><br><pre> <code class="plaintext hljs">[defaults] strategy = mitogen_linear strategy_plugins = /usr/lib/python2.7/site-packages/ansible_mitogen/plugins/strategy</code> </pre> <br><hr><br><p>  Siapkan Ansible dalam virtualenv, dengan dan tanpa Mitogen diaktifkan: </p><br><pre> <code class="bash hljs">virtualenv mitogen_ansible ./mitogen_ansible/bin/pip install ansible==2.7.10 mitogen virtualenv pure_ansible ./pure_ansible/bin/pip install ansible==2.7.10</code> </pre> <br><p>  <strong>Harap perhatikan bahwa Mitogen 0.2.7 tidak berfungsi dengan Ansible 2.8 (untuk Mei 2019)</strong> </p><br><p>  Buat alias: </p><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">alias</span></span> pure-ansible-playbook=<span class="hljs-string"><span class="hljs-string">'$(pwd)/pure_ansible/bin/ansible-playbook'</span></span> <span class="hljs-built_in"><span class="hljs-built_in">alias</span></span> mitogen-ansible-playbook=<span class="hljs-string"><span class="hljs-string">'ANSIBLE_STRATEGY_PLUGINS=/usr/lib/python2.7/site-packages/ansible_mitogen/plugins/strategy:$(pwd)/mitogen_ansible/lib/python3.7/site-packages/ansible_mitogen/plugins/strategy ANSIBLE_STRATEGY=mitogen_linear $(pwd)/mitogen_ansible/bin/ansible-playbook'</span></span></code> </pre> <br><p>  Sekarang mari kita coba playbook yang membuat file di remote: </p><br><pre> <code class="plaintext hljs">--- - hosts: all gather_facts: false tasks: - name: Create files with copy content module copy: content: | test file {{ item }} dest: ~/file_{{item}} with_sequence: start=1 end={{ n }}</code> </pre> <br><p>  Dan jalankan dengan Mitogen dan tanpa membuat 10 file: </p><br><pre> <code class="bash hljs">time mitogen-ansible-playbook file_creation.yml -i hosts -en=10 &amp;&gt;/dev/null real 0m2.603s user 0m1.152s sys 0m0.096s time pure-ansible-playbook file_creation.yml -i hosts -en=10 &amp;&gt;/dev/null real 0m5.908s user 0m1.745s sys 0m0.643s</code> </pre> <br><p>  Saat ini kami melihat peningkatan dalam x2 kali.  Mari kita periksa 20, 30, ..., 100 file: </p><br><pre> <code class="bash hljs">time pure-ansible-playbook file_creation.yml -i hosts -en=100 &amp;&gt;/dev/null real 0m51.775s user 0m8.039s sys 0m6.305s time mitogen-ansible-playbook file_creation.yml -i hosts -en=100 &amp;&gt;/dev/null real 0m4.331s user 0m1.903s sys 0m0.197s</code> </pre> <br><p>  Akhirnya, kami meningkatkan waktu eksekusi lebih dari 10 kali! </p><br><p>  Sekarang mari kita coba berbagai skenario dan lihat bagaimana ini meningkat: </p><br><ul><li><p>  Skenario mengunggah file dari host lokal ke jarak jauh (dengan modul <code>copy</code> ): <br><img src="https://habrastorage.org/getpro/habr/post_images/4e8/349/44b/4e834944bcfe865814d0cdb6538b61c5.svg" alt="Mengunggah file"></p><br></li><li><p>  Skenario membuat file pada host jarak jauh dengan modul <code>copy</code> : <br><img src="https://habrastorage.org/getpro/habr/post_images/5dc/3db/ec2/5dc3dbec26ec1f9502e0a270aee5ef2d.svg" alt="Membuat file"></p><br></li><li><p>  Skenario dengan mengambil file dari host jarak jauh ke lokal: <br><img src="https://habrastorage.org/getpro/habr/post_images/dfb/fe8/385/dfbfe838521a915708a2f543715c7e25.svg" alt="Mengambil file"></p><br></li></ul><br><p>  Mari kita coba skenario terakhir pada beberapa (3) host jarak jauh, misalnya mengunggah skenario file: <br><img src="https://habrastorage.org/getpro/habr/post_images/eef/f89/d91/eeff89d9135f5c8890d57e18ec052b8a.svg" alt="Mengunggah file ke banyak host"></p><br><p>  Seperti yang dapat kita lihat, Mitogen menghemat waktu dan bandwidth dalam skenario ini.  Tetapi jika hambatannya bukan Ansible, tetapi misalnya I / O dari disk atau jaringan, atau di tempat lain, maka tentu saja sulit dari Mitogen untuk membantu. </p><br><p>  Mari kita jalankan misalnya instalasi paket dengan instalasi modul yum / dnf dan python dengan pip. <br>  Paket telah di-cache untuk menghindari ketergantungan pada gangguan jaringan: </p><br><pre> <code class="plaintext hljs">--- - hosts: all gather_facts: false tasks: - name: Install packages become: true package: name: - samba - httpd - nano - ruby state: present - name: Install pip modules become: true pip: name: - pytest-split-tests - bottle - pep8 - flask state: present</code> </pre><br><p>  Dengan Mitogen dibutuhkan 12 detik, serta dengan Ansible murni. </p><br><p>  Di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">halaman Mitogen untuk Ansible,</a> Anda dapat melihat tolok ukur dan pengukuran tambahan.  Seperti yang dinyatakan halaman: </p><br><blockquote>  Mitogen tidak dapat meningkatkan modul setelah dieksekusi, ia hanya dapat memastikan modul dieksekusi secepat mungkin </blockquote><p>  Itulah mengapa penting untuk menemukan di mana kemacetan Anda dan jika mereka terkait dengan operasi Ansible, Mitogen akan membantu Anda untuk menyelesaikannya dan mempercepat buku-buku bermain Anda secara signifikan. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id453446/">https://habr.com/ru/post/id453446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id453434/index.html">Fleksibilitas Cartridge: Sensor dalam Game untuk Game Boy</a></li>
<li><a href="../id453438/index.html">Teknologi mikroelektronika di jari: Hukum Moore, gerakan pemasaran, dan mengapa nanometer tidak sama sekarang. Bagian 1</a></li>
<li><a href="../id453440/index.html">Menumpang untuk Ketersediaan: Tautan untuk Melewati Navigasi dan Bagian</a></li>
<li><a href="../id453442/index.html">7 Hal yang Perlu Diketahui tentang Langganan yang Dapat Diperbarui Secara Otomatis</a></li>
<li><a href="../id453444/index.html">100 repositori GitHub paling berharga [sesuai dengan algoritma UOS]</a></li>
<li><a href="../id453450/index.html">Dalam permainan kuantum, Anda tidak bisa mengandalkan keberuntungan</a></li>
<li><a href="../id453452/index.html">Implikasi hukum dan etika dalam menggunakan AI untuk merekrut staf</a></li>
<li><a href="../id453454/index.html">Software Defined Radio - bagaimana cara kerjanya? Bagian 5</a></li>
<li><a href="../id453456/index.html">Cara kerja pelokalan di Netflix - terjemahan</a></li>
<li><a href="../id453458/index.html">Pemrograman reaktif nyata di Svelte 3.0</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>