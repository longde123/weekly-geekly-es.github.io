<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍👩‍👧 🏳️‍🌈 🙌🏾 SwiftUI in den Regalen 👨🏻‍⚕️ 🏂🏾 🚶🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jedes Mal, wenn ein neues Framework in einer Programmiersprache erscheint, erscheinen früher oder später Leute, die die Sprache daraus lernen. Dies wa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SwiftUI in den Regalen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485548/"> Jedes Mal, wenn ein neues Framework in einer Programmiersprache erscheint, erscheinen früher oder später Leute, die die Sprache daraus lernen.  Dies war wahrscheinlich in der iOS-Entwicklung zum Zeitpunkt des Erscheinens von Swift der Fall: Zuerst wurde es als Ergänzung zu Objective-C betrachtet - aber ich habe es nicht bereits gefunden.  Wenn Sie jetzt von vorne anfangen, lohnt es sich nicht mehr, eine Sprache zu wählen.  Swift ist außer Konkurrenz. <br><br>  Dasselbe, aber in kleinerem Maßstab, passiert mit Frameworks.  Das Aussehen von SwiftUI ist keine Ausnahme.  Ich bin wahrscheinlich ein Vertreter der ersten Entwicklergeneration, die SwiftUI lernte und UIKit ignorierte.  Dies hat einen Preis - bisher gibt es nur sehr wenige Schulungsunterlagen und Beispiele für Arbeitscode.  Ja, das Netzwerk verfügt bereits über eine Reihe von Artikeln, die sich auf eine bestimmte Funktion oder ein bestimmtes Tool beziehen.  Unter <a href="https://www.hackingwithswift.com/quick-start/swiftui" rel="nofollow">www.hackingwithswift.com</a> gibt es bereits eine ganze Reihe von Codebeispielen mit Erklärungen.  Sie tun jedoch wenig, um denen zu helfen, die SwiftUI von Grund auf lernen möchten, wie mir.  Die meisten Materialien im Netzwerk sind Antworten auf spezifische, formulierte Fragen.  Ein erfahrener Entwickler kann leicht herausfinden, wie alles funktioniert, warum es so ist und warum es angewendet werden sollte.  Für einen Anfänger müssen Sie zunächst verstehen, welche Frage zu stellen ist, und erst dann kann er auf diese Artikel zugreifen. <br><br><img src="https://habrastorage.org/webt/1u/td/t6/1utdt6xa6tcsov4biwj2ura36s0.png"><br><br>  Unter dem Kürzel werde ich versuchen, das zu systematisieren und zu sortieren, was ich im Moment gelernt habe.  Das Format des Artikels ist beinahe ein Leitfaden, vielmehr ein Spickzettel, den ich in der Form zusammengestellt habe, in der ich ihn zu Beginn meiner Reise selbst lesen möchte.  Für erfahrene Entwickler, die sich noch nicht tief mit SwiftUI befasst haben, gibt es auch einige interessante Codebeispiele, und Erläuterungen in Textform können diagonal gelesen werden. <br><br>  Ich hoffe, dieser Artikel spart Ihnen etwas Zeit, wenn Sie auch ein bisschen Magie spüren möchten. <br><a name="habracut"></a><br><h3>  Für den Anfang ein wenig über dich </h3><br>  Ich habe praktisch keinen mobilen Entwicklungshintergrund und bedeutende Erfahrung <br>  in 1s konnte hier nicht viel helfen.  Wie und warum ich mich dazu entschlossen habe, SwiftUI zu lernen, erkläre ich Ihnen zu einem späteren Zeitpunkt, ob es für jemanden interessant sein wird. <br><br>  So kam es, dass der Beginn meines Eintauchens in die mobile Entwicklung mit der Veröffentlichung von iOS 13 und SwiftUI zusammenfiel.  Dies ist ein Zeichen, dachte ich und beschloss, sofort damit zu beginnen und UIKit zu ignorieren.  Ich fand es ein amüsanter Zufall, dass ich zu solchen Zeiten mit 1c angefangen habe: Dann erschienen einfach verwaltete Formulare.  Im Fall von 1c dauerte die Popularisierung neuer Technologien fast fünf Jahre.  Jedes Mal, wenn ein Entwickler angewiesen wurde, einige neue Funktionen zu implementieren, stand er vor der Wahl, diese schnell und zuverlässig mit vertrauten Werkzeugen auszuführen oder viel Zeit mit neuen Werkzeugen und ohne Garantie für Ergebnisse zu verbringen.  Die Wahl fiel in der Regel gerade jetzt auf Geschwindigkeit und Qualität, und die Investition in neue Werkzeuge verzögerte sich sehr lange. <br><br>  Anscheinend ist die Situation bei SwiftUI ungefähr gleich.  Jeder ist interessiert, jeder versteht, dass dies die Zukunft ist, aber bisher haben sich nur wenige die Zeit genommen, sie zu studieren.  Es sei denn für Haustierprojekte. <br><br>  Im Großen und Ganzen war es mir egal, welchen Rahmen ich studieren sollte, und ich beschloss, trotz der allgemeinen Meinung, dass es möglich sein würde, ihn in ein oder zwei Jahren in Produktion zu bringen, ein Risiko einzugehen.  Und da ich zufällig zu den Pionieren gehörte, beschloss ich, praktische Erfahrungen auszutauschen.  Ich möchte sagen, dass ich kein Guru bin und generell in der mobilen Entwicklung - ein Wasserkocher.  Trotzdem bin ich schon einen bestimmten Weg gegangen, bei dem ich das ganze Internet nach Informationen abgesucht habe, und ich kann mit Zuversicht sagen, dass dies nicht ausreicht und praktisch nicht systematisiert ist.  Aber auf Russisch ist es natürlich praktisch nicht vorhanden.  In diesem Fall beschloss ich, meine Kräfte zu sammeln, den <a href="https://habr.com/ru/post/370877">Betrüger-</a> Komplex <a href="https://habr.com/ru/post/370877">beiseite zu</a> schieben und der Gemeinde <a href="https://habr.com/ru/post/370877">mitzuteilen</a> , was ich selbst herausgefunden hatte.  Ich gehe davon aus, dass der Leser mit SwiftUI zumindest minimal vertraut ist, und ich werde Dinge wie <code>VStack{…}</code> , <code>Text(…)</code> usw. nicht entschlüsseln. <br><br>  Ich betone noch einmal, dass ich meine eigenen Eindrücke von Versuchen, das gewünschte Ergebnis von SwiftUI zu erzielen, weiter beschreiben werde.  Ich konnte gut und gerne etwas nicht verstehen und aus einigen Versuchen falsche oder ungenaue Schlussfolgerungen ziehen, daher sind Korrekturen und Klarstellungen ausdrücklich erwünscht. <br><br>  Für erfahrene Entwickler scheint dieser Artikel voller Beschreibungen offensichtlicher Dinge zu sein, er wird jedoch nicht streng beurteilt.  Tutorials für Dummies auf SwiftUI wurden noch nicht geschrieben. <br><br><h2>  Was zur Hölle ist das SwiftUI? </h2><br>  Also, ich würde wahrscheinlich mit dem anfangen, worum es geht, das ist deine SwiftUI.  Auch hier taucht meine 1. Vergangenheit auf.  Die Analogie zu verwalteten Formularen wurde erst deutlicher, als ich mir einige Tutorial-Videos zum Layout von Benutzeroberflächen in Storyboard ansah (d. H. Bei der Arbeit mit UIKit).  Ich nahm Nostalgie nach „unkontrollierbaren“ Formen in 1s: manuelle Platzierung von Elementen auf dem Formular und insbesondere Bindungen ... Oh, als der Autor des Trainingsvideos etwa 20 Minuten lang über die Feinheiten der Bindung verschiedener Elemente aneinander und an die Ränder des Bildschirms sprach, erinnerte ich mich mit einem Lächeln 1C - Vor kontrollierten Formen war alles das Gleiche.  Na ja, fast ... ein bisschen schlimmer natürlich, na ja und dementsprechend - einfacher.  Und SwiftUI besteht grob aus verwalteten Formularen von Apple.  Keine Bindungen.  Keine Storyboards und Segways.  Sie beschreiben einfach die Struktur Ihrer Ansicht im Code.  Und alle.  Alle Parameter, Größen usw. werden direkt im Code eingestellt - aber ganz einfach.  Genauer gesagt, Sie können die Parameter vorhandener Objekte in Canvas bearbeiten, müssen sie jedoch erst im Code hinzufügen.  Ehrlich gesagt, ich weiß nicht, wie dies in großen Entwicklungsteams funktionieren wird, in denen es üblich ist, das Layout des Designs und den Inhalt der Ansicht selbst zu trennen, aber als Indie-Entwickler mag ich diesen Ansatz wirklich. <br><br><h3>  Deklarativer Stil </h3><br>  SwiftUI geht davon aus, dass die Beschreibung der Struktur Ihrer Ansicht vollständig im Code enthalten ist.  Darüber hinaus bietet uns Apple einen deklarativen Schreibstil für diesen Code.  Das heißt, so etwas: <br><blockquote>  „Dies ist eine Ansicht.  Es besteht aus zwei Textfeldern und einem Bild <s>(aus irgendeinem Grund möchte ich „Ansehen“ sagen und dementsprechend eine Deklination auf ein weibliches Wort anwenden)</s> .  Textfelder werden horizontal hintereinander angeordnet.  Das Bild ist darunter und seine Ränder sind in Form eines Kreises zugeschnitten. " </blockquote>  Klingt ungewöhnlich, oder?  Normalerweise beschreiben wir im Code den Prozess selbst, was getan werden muss, um das Ergebnis zu erzielen, das wir in unserem Kopf haben: <br><blockquote>  "Fügen Sie einen Block ein, fügen Sie ein Textfeld in diesen Block ein, gefolgt von einem anderen Textfeld, und machen Sie danach ein Bild, schneiden Sie die Kanten durch Abrunden ab und fügen Sie sie unten ein." </blockquote>  Es klingt wie eine Anleitung für Möbel von Ikea.  Und in swiftUI sehen wir sofort, was das Ergebnis sein sollte.  Auch ohne Canvas oder Debugging spiegelt die Struktur des Codes deutlich die Struktur der Ansicht wider.  Es ist klar, was und in welcher Reihenfolge und mit welchen Effekten angezeigt wird. <br><br>  Ein ausgezeichneter Artikel über FunctionBuilder und darüber, wie Sie Code deklarativ schreiben können, ist bereits auf <a href="https://habr.com/ru/company/tinkoff/blog/455760/">Habré</a> verfügbar. <br><br>  Grundsätzlich wurde viel über den deklarativen Stil und seine Vorteile geschrieben, deshalb werde ich ihn abrunden.  Ich füge von mir selbst hinzu, dass ich mich ein wenig daran gewöhnt habe und wirklich gespürt habe, wie bequem es ist, Code in diesem Stil zu schreiben, wenn es um Schnittstellen geht.  Damit traf Apple das sogenannte Bullseye! <br><br><h2>  Woraus besteht View? </h2><br>  Aber schauen wir uns das mal genauer an.  Apple schlägt vor, dass der deklarative Stil so aussieht: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text1 = <span class="hljs-string"><span class="hljs-string">"some text"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text2 = <span class="hljs-string"><span class="hljs-string">"some more text"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">VStack</span></span>{ <span class="hljs-type"><span class="hljs-type">Text</span></span>(text1) .padding() .frame(width: <span class="hljs-number"><span class="hljs-number">100</span></span>, height: <span class="hljs-number"><span class="hljs-number">50</span></span>) <span class="hljs-type"><span class="hljs-type">Text</span></span>(text2) .background(<span class="hljs-type"><span class="hljs-type">Color</span></span>.gray) .border(<span class="hljs-type"><span class="hljs-type">Color</span></span>.green) } } }</code> </pre> <br>  Bitte beachten Sie, dass <code>View</code> eine Struktur mit einigen Parametern ist.  Um die Strukturansicht zu <code>View</code> , müssen wir den berechneten Parameterkörper festlegen, der <code>some View</code> zurückgibt.  Wir werden später darüber sprechen.  Der Inhalt des <code>body: some View { … }</code> ist die Beschreibung dessen, was auf dem Bildschirm angezeigt wird.  Tatsächlich ist dies alles, was für unsere Struktur erforderlich ist, um die Anforderungen des View-Protokolls zu erfüllen.  Ich schlage vor, sich in erster Linie auf den <code>body</code> . <br><br><h3>  Und so Regale </h3><br>  Insgesamt habe ich drei Arten von Elementen gezählt, aus denen der Hauptteil der Ansicht aufgebaut ist: <br><br><ul><li>  <b>Andere Ansicht</b> <br>  Das heißt  Jede Ansicht enthält eine oder mehrere andere <code>View</code> .  Diese wiederum können sowohl vordefinierte Systemansichten wie <code>Text()</code> als auch benutzerdefinierte, komplexe, vom Entwickler geschriebene enthalten.  Es stellt sich eine Art Nistpuppe mit unbegrenztem Verschachtelungsgrad heraus. </li><li>  <b>Modifikatoren</b> <br>  Mit Hilfe von Modifikatoren geschieht jede Magie.  Dank ihnen teilen wir SwiftUI kurz und deutlich mit, welche Art von Ansicht wir sehen möchten.  Wie es funktioniert, werden wir noch herausfinden, aber die Hauptsache ist, dass Modifikatoren das gewünschte Teil zum Inhalt einer bestimmten <code>View</code> hinzufügen. </li><li>  <b>Behälter</b> <br>  Die ersten Container, mit denen der Standard "Hallo Welt" beginnt, sind <code>HStack</code> und <code>VStack</code> .  Wenig später erscheinen <code>Group</code> , <code>Section</code> und andere.  Container haben dieselbe Ansicht, jedoch eine Funktion.  Sie übergeben ihnen einige Inhalte, die Sie anzeigen möchten.  Das ganze Merkmal des Containers ist, dass er die Elemente dieses Inhalts irgendwie gruppieren und anzeigen muss.  In diesem Sinne ähneln Container Modifikatoren, mit dem einzigen Unterschied, dass Modifikatoren eine vorgefertigte Ansicht ändern sollen und Container diese Ansicht (Inhaltselemente oder deklarative <code>VStack{...}</code> ) in einer bestimmten Reihenfolge anordnen, z. B. vertikal oder horizontal ( <code>VStack{...}</code> <code>HStack{...}</code> ).  Es gibt auch spezielle Container wie <code>ForEach</code> oder <code>GeometryReader</code> , auf die wir später noch <code>ForEach</code> werden. <br><br>  Im Allgemeinen betrachte ich Container als jede Ansicht, in die Content als Parameter übergeben werden kann. </li></ul><br>  Und das ist alles.  Alle Elemente der reinrassigen SwiftUI können einem dieser Typen zugeordnet werden.  Ja, dies reicht nicht aus, um Ihre Ansicht mit Funktionen zu füllen, aber dies ist alles, was Sie benötigen, um Ihre Funktionen auf dem Bildschirm anzuzeigen. <br><br><h3>  .modifiers () - wie sind sie angeordnet? </h3><br>  Beginnen wir mit dem Einfachsten.  Ein Modifikator ist eigentlich eine sehr einfache Sache.  Er nimmt nur eine <code>View</code> , wendet einige Änderungen an <s>(oder tut es?)</s> Und gibt sie zurück.  Das heißt  Der Modifikator ist eine Funktion der <code>View</code> selbst, die <code>self</code> zurückgibt, nachdem zuvor einige Änderungen vorgenommen wurden. <br><br>  Unten ist ein Beispiel für Code, mit dem ich meinen eigenen Modifikator deklariere.  Genauer gesagt überlade ich den vorhandenen Modifikatorrahmen <code>frame(width:height:)</code> , mit dem Sie die spezifischen Abmessungen einer bestimmten Ansicht festlegen können.  In dem dafür vorgesehenen Feld müssen Sie die Breite und Höhe angeben, und ich musste ein <code>CGSize</code> Objekt mit einem Argument übergeben, das nur die Länge und Breite beschreibt.  Warum ich das brauchte, werde ich etwas später erzählen. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FrameFromSize</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewModifier</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> size: <span class="hljs-type"><span class="hljs-type">CGSize</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">body</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(content: Content)</span></span></span></span> -&gt; some <span class="hljs-type"><span class="hljs-type">View</span></span> { content .frame(width: size.width, height: size.height) } }</code> </pre> <br>  Mit diesem Code haben wir eine Struktur erstellt, die dem <code>ViewModifier</code> Protokoll entspricht.  Dieses Protokoll erfordert, dass die <code>body()</code> -Funktion in dieser Struktur implementiert ist, deren Eingabe ein gewisser <code>Content</code> ist und deren Ausgabe eine <code>some View</code> : derselbe Typ wie der <code>body</code> Parameter unserer <code>View</code> (wir werden im Folgenden über eine gewisse Sicht sprechen). .  Was für ein <code>Content</code> das? <br><br><h4>  Content + ViewBuilder = Anzeigen </h4><br>  In der eingebauten Dokumentation über ihn heißt es so: <br><blockquote>  `content` ist ein Proxy für die Ansicht, auf die der durch` Self` dargestellte Modifikator angewendet wird. </blockquote>  Dies ist ein Proxy-Typ, bei dem es sich um ein View-Prefab handelt, auf das Modifikatoren angewendet werden können.  Eine Art Halbzeug.  Tatsächlich ist <code>Content</code> ein deklarativer Stilabschluss, der die <code>View</code> beschreibt.  Nennen wir diesen Modifikator für eine bestimmte Ansicht, erhält er lediglich einen Abschluss vom <code>body</code> und übergibt ihn an unsere <code>body</code> , in der wir unsere fünf Cent zu diesem Abschluss addieren. <br><br>  <code>View</code> ist wiederum in erster Linie eine Struktur, in der alle Parameter gespeichert sind, die zur Erzeugung eines Bildes auf dem Bildschirm erforderlich sind.  Inklusive Montageanleitung, von der <code>Content</code> .  Ein mit <code>ViewBuilder</code> verarbeiteter Abschluss in einem deklarativen Stil ( <code>Content</code> ) gibt uns also eine View zurück. <br><br>  Kehren wir zu unserem Modifikator zurück.  Grundsätzlich reicht die Deklaration der <code>FrameFromSize</code> Struktur bereits aus, um sie anzuwenden.  Innerhalb des <code>body</code> wir so schreiben: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">RoundedRectangle</span></span>(cornerRadius: <span class="hljs-number"><span class="hljs-number">4</span></span>).modifier(<span class="hljs-type"><span class="hljs-type">FrameFromSize</span></span>(size: size))</code> </pre><br>  <code>modifier</code> ist eine View-Protokollmethode, die Inhalt aus der zu <code>ViewBuilder</code> <code>View</code> extrahiert, an die body-Funktion der Modifikatorstruktur übergibt und das Ergebnis an die <code>ViewBuilder</code> Verarbeitung oder an den nächsten Modifikator <code>ViewBuilder</code> , wenn eine Änderungskette <code>ViewBuilder</code> . <br><br>  Sie können es jedoch noch präziser gestalten, indem Sie Ihren eigenen Modifikator als Funktion deklarieren und damit die Funktionen des View-Protokolls erweitern. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">frame</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> size: CGSize)</span></span></span></span> -&gt; some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.modifier(<span class="hljs-type"><span class="hljs-type">FrameFromSize</span></span>(size: size)) } }</code> </pre> <br>  In diesem Fall habe ich den vorhandenen Modifikator <code>.frame(width: height:)</code> anderen Variante der <code>.frame(width: height:)</code> überladen.  Jetzt können wir die Option verwenden, den Modifikator <code>frame(size:)</code> für jede <code>View</code> aufzurufen.  Es stellte sich heraus, dass nichts kompliziert war. <br><br><div class="spoiler">  <b class="spoiler_title">Ein bisschen über Fehler</b> <div class="spoiler_text">  Übrigens dachte ich, dass es nicht notwendig ist, das gesamte Protokoll zu erweitern, es würde ausreichen, das <code>RoundedRectangle</code> in meinem Fall speziell zu erweitern, und es hätte funktionieren sollen, wie es mir schien - aber es scheint, als hätte Xcode eine solche Unverschämtheit nicht erwartet und fiel mit einem unverständlichen Fehler aus: „ <code>Abort trap: 6</code> ”und ein Vorschlag, ein Dump an die Entwickler zu senden.  Allgemein gesagt, zeigen in SwiftUI Fehlerbeschreibungen die Ursache dieses Fehlers häufig nicht vollständig an. <br></div></div><br>  Auf die gleiche Weise können Sie benutzerdefinierte Modifikatoren erstellen und wie die integrierte SwiftUI verwenden: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">RoundedRectangle</span></span>(cornerRadius: <span class="hljs-number"><span class="hljs-number">4</span></span>).frame(size)</code> </pre><br>  Praktisch, kurz und deutlich. <br><br>  Ich stelle mir eine Kette von Modifikationen als Perlen vor, die an einem Faden aufgereiht sind - unsere Ansicht.  Diese Analogie gilt auch in dem Sinne, dass es auf die Reihenfolge ankommt, in der Modifikationen genannt werden. <br><br><img src="https://habrastorage.org/webt/tw/1p/ak/tw1paklgxp9d5acpcmwvjywxjce.png"><br><br><div class="spoiler">  <b class="spoiler_title">Fast alles in SwiftUI ist View</b> <div class="spoiler_text">  Übrigens eine interessante Bemerkung.  Als Eingabeparameter akzeptiert Hintergrund keine Farbe, sondern Ansicht.  Das heißt  Die Color-Klasse ist nicht nur eine Beschreibung der Farbe, sondern eine vollständige Ansicht, auf die Modifikatoren und mehr angewendet werden können.  Und als Hintergrund können Sie dementsprechend eine andere Ansicht übergeben. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Modifikatoren - nur für Modifikationen</b> <div class="spoiler_text">  Vielleicht lohnt es sich, noch einen Punkt zu erwähnen.  Modifikatoren, die den Quellinhalt nicht ändern, werden von SwiftUI einfach ignoriert und nicht aufgerufen.  Das heißt  Sie können keinen Trigger basierend auf dem Modifikator ausführen, der einige Ereignisse verursacht, aber keine Aktionen mit dem Inhalt ausführen.  Apple drängt uns beharrlich, einige Aktionen zur Laufzeit abzubrechen, wenn wir die Benutzeroberfläche rendern, und dem deklarativen Stil zu vertrauen. <br></div></div><br><h2>  Standbildansicht </h2><br>  Früher haben wir darüber gesprochen, woraus der <code>body</code> besteht, aus dem Körper der <code>View</code> oder aus den Montageanweisungen.  Kehren wir zur <code>View</code> selbst zurück.  Erstens ist es eine Struktur, in der einige Parameter deklariert werden können, und <code>body</code> ist nur einer von ihnen.  Wie wir bereits sagten, <code>Content</code> <code>body</code> , um herauszufinden, was <code>Content</code> , eine Anweisung zum Zusammenstellen der gewünschten Ansicht, die einen deklarativen Abschluss darstellt.  Aber was soll unsere Schließung zurückbringen? <br><br><h3>  einige Ansicht - Bequemlichkeit </h3><br><img align="right" src="https://habrastorage.org/webt/j9/zh/zz/j9zhzza2ma_4if9rhtzqjkqvdhi.jpeg"><br><br>  Und wir kommen reibungslos zu einer Frage, die ich lange Zeit nicht herausfinden konnte, obwohl dies mich nicht davon abhielt, Arbeitscode zu schreiben.  Was ist das für <code>some View</code> ?  Die Dokumentation besagt, dass diese Beschreibung ein „undurchsichtiger Ergebnistyp“ ist - aber das macht wenig Sinn. <br><br>  Das Schlüsselwort <code>some</code> ist eine "generische" Version einer Beschreibung eines Typs, die von einem Abschluss zurückgegeben wird, der von nichts anderem als dem Code selbst abhängt.  Das heißt  Das Ergebnis des Zugriffs auf die berechnete Eigenschaft des Körpers unserer Ansicht sollte eine Struktur sein, die das Ansichtsprotokoll erfüllt.  Möglicherweise gibt es viele davon - Text, Bild oder eine von Ihnen deklarierte Struktur.  Der gesamte Chip des Schlüsselworts some besteht darin, "generic" zu deklarieren, das dem View-Protokoll entspricht.  Es wird statisch durch den Code bestimmt, der im Hauptteil Ihrer Ansicht implementiert ist, und Xcode ist durchaus in der Lage, diesen Code zu analysieren und die spezifische Signatur des Rückgabewerts zu berechnen <s>(</s> na ja <s>, fast immer)</s> .  Und manche sind nur ein Versuch, den Entwickler nicht mit unnötigen <a href="https://habr.com/ru/post/482834/">Zeremonien</a> zu belasten.  Es reicht für den Entwickler zu sagen: "Es wird eine Art von Ansicht geben."  Der Schlüssel dabei ist, dass der konkrete Typ nicht wie beim üblichen generischen Typ durch die Eingabeparameter bestimmt wird, sondern direkt durch den Code.  Daher habe ich oben generisch zitiert. <br><br>  Xcode sollte in der Lage sein, einen bestimmten Typ zu bestimmen, ohne genau zu wissen, welche Werte Sie an diese Struktur übergeben.  Dies ist wichtig zu verstehen - nach dem Kompilieren wird der Ausdruck Einige Ansichten durch den spezifischen Typ Ihrer <code>View</code> .  Dieser Typ ist ziemlich deterministisch und kann beispielsweise so komplex sein: <code>Group&lt;TupleView&lt;(Text, ForEach&lt;[SomeClass], SomeClass.ID, Text&gt;)&gt;&gt;</code> . <br><br>  Beispielcode kann von diesem Typ wiederhergestellt werden: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Group</span></span>{ <span class="hljs-type"><span class="hljs-type">Text</span></span>(…) <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(…){(value: <span class="hljs-type"><span class="hljs-type">SomeClass</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Text</span></span>(…) } }</code> </pre> <br>  <code>ForEach</code> , wie aus der <code>ForEach</code> , keine Laufzeitschleife.  Dies ist nur eine <code>View</code> die auf der Grundlage eines Arrays von <code>SomeClass</code> Objekten erstellt wird.  Als die Kennung einer bestimmten <code>subView</code> die dem Auflistungselement zugeordnet ist, wird die Element-ID angegeben, und für jedes Element wird eine <code>subView</code> Typ <code>Text</code> <code>subView</code> .  <code>Text</code> und <code>ForEach</code> in <code>TupleView</code> kombiniert, und all dies wird in <code>Group</code> platziert.  Wir werden näher auf <code>ForEach</code> eingehen. <br><br>  Stellen Sie sich vor, wie viel Schreiben wäre, wenn wir gezwungen wären, eine genaue Signatur wie den Parameterkörper zu beschreiben?  Um dies zu vermeiden, wurde das Schlüsselwort <code>some</code> erstellt. <br><br><div class="spoiler">  <b class="spoiler_title">Zusammenfassung</b> <div class="spoiler_text">  <code>some</code> ist dies „generisch - umgekehrt“.  Wir bekommen das klassische Generikum von außerhalb der Funktion, und da wir den spezifischen Typ des generischen Typs bereits kennen, definiert Xcode, wie unsere Funktion funktioniert.  <code>some-</code> hängt nicht von den Eingabeparametern ab, sondern nur vom Code selbst.  Dies ist lediglich eine Abkürzung, mit der kein bestimmter Typ definiert werden kann, sondern nur die Familie des von der Funktion (dem Protokoll) zurückgegebenen Werts. <br></div></div><br><h3>  Einige Sichtweisen - und Konsequenzen </h3><br>  Der Ansatz, den statischen Typ eines Ausdrucks im Körper zu berechnen, wirft meiner Meinung nach zwei wichtige Punkte auf: <br><br><ul><li>  Beim Kompilieren analysiert Xcode den Inhalt des Körpers, um den spezifischen Rückgabetyp zu berechnen.  In komplexen Körpern kann dies einige Zeit dauern.  In einigen besonders komplexen Körpern ist er möglicherweise überhaupt nicht in der Lage, mit vernünftiger Zeit umzugehen, und er wird es direkt sagen. <br><img src="https://habrastorage.org/webt/-b/cf/nv/-bcfnvtylozajmnzcgjcto_8ms0.png"><br>  Im Allgemeinen muss View so einfach wie möglich gehalten werden.  Komplexe Strukturen lassen sich am besten in einer separaten Ansicht platzieren.  Somit werden ganze Ketten von realen Typen durch einen Typ ersetzt - Ihre CustomView, die es dem Compiler ermöglicht, nicht mit all diesem Durcheinander durchzudrehen. <br>  Übrigens ist es sehr praktisch, ein kleines Stück einer großen Ansicht direkt hier zu debuggen und das Ergebnis in Canvas zu empfangen und zu beobachten. </li><li>  Wir können den Fluss nicht direkt steuern.  Wenn If - else SwiftUI es weiterhin verarbeiten kann, indem eine „Schrödinger-Ansicht“ vom Typ &lt;_ConditionalContent &lt;Text, TextField &gt;&gt; erstellt wird, kann der Trinar-Bedingungsoperator nur zur Auswahl eines bestimmten Parameterwerts, nicht jedoch eines Typs oder sogar zur Auswahl einer Folge von Modifikatoren verwendet werden. <br><img src="https://habrastorage.org/webt/cp/18/7s/cp187s4fsvn9v3kvwobduyk5rie.png"><br>  Es lohnt sich jedoch, die gleiche Reihenfolge von Modifikatoren wiederherzustellen, und ein solcher Datensatz ist kein Problem mehr. </li></ul><br><h2>  Außer Körper </h2><br>  Möglicherweise enthält die Struktur jedoch andere Parameter, mit denen Sie arbeiten können.  Als Parameter können wir folgende Dinge deklarieren. <br><br><h3>  Externe Parameter </h3><br>  Dies sind einfache Strukturparameter, die wir bei der Initialisierung von außen übergeben müssen, damit die Ansicht sie irgendwie wiedergibt: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TextView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> textValue: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">Text</span></span>(textValue) } }</code> </pre> <br>  In diesem Beispiel ist <code>textValue</code> für die <code>TextView</code> Struktur ein Parameter, der <code>textValue</code> <code>TextView</code> werden muss, da er keinen Standardwert hat.  Da die Strukturen die automatische Generierung von Initialisierern unterstützen, können wir diese Ansicht einfach verwenden: <br><br><pre> <code class="swift hljs"> <span class="hljs-type"><span class="hljs-type">TextView</span></span>(textValue: <span class="hljs-string"><span class="hljs-string">"some text"</span></span>)</code> </pre><br>  Von außen können Sie auch Abschlüsse übertragen, die ausgeführt werden müssen, wenn ein Ereignis eintritt.  Zum Beispiel <code>Button(lable:action:)</code> genau das: <code>Button(lable:action:)</code> den übergebenen Aktionsabschluss durch, wenn auf eine Schaltfläche geklickt wird. <br><br><h3>  Zustand - Parameter </h3><br>  SwiftUI nutzt die neue Funktion von Swift 5.1 - <a href="https://habr.com/ru/company/funcorp/blog/485008/">Property Wrapper</a> - sehr aktiv. <br><br>  Zuallererst sind dies Zustandsvariablen - gespeicherte Parameter unserer Struktur, deren Änderung sich auf dem Bildschirm widerspiegeln sollte.      <code>@State</code> —   ,  <code>@ObservedObject</code> —  .     <code>ObservableObject</code> —  ,        (View,       <code>@ObservedObject</code> )    .        <code>@Published</code> . <br><br>      ,     ,      <code>ObservableObjectPublisher</code>    ,   <code>willSet()</code>  ,  , , <a href="https://www.hackingwithswift.com/quick-start/swiftui/how-to-send-state-updates-manually-using-objectwillchange" rel="nofollow"></a> . <br><br> ,  ,  <code>body</code> —    ? -       State-,    - State-  <code>body</code>   .    ,  <code>body</code> — ,    , stateless . View    ,   ,   body   .      .   State-   <code>View</code> .   ,        ,    ,      . ,   <code>body</code> —   .       ,   ,   ,    . <br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und noch eine Bemerkung</font></font></b> <div class="spoiler_text">     <code>didSet</code> <code>willSet</code>   ,   - .      ,     .  ,   —    -  ,     . <br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Classic </font></font><a href="https://habr.com/ru/users/state/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">State</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Beispiel </font><font style="vertical-align: inherit;">:</font></font><br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tapCount = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">VStack</span></span> { <span class="hljs-type"><span class="hljs-type">Button</span></span>(action: {<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.tapCount += <span class="hljs-number"><span class="hljs-number">1</span></span>}, label: { <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"Tap count \(tapCount)"</span></span>) }) } } }</code> </pre> <br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bindungsparameter </font></font></h3><br> ,   -   View  <code>@State</code> <code>@ObservedObject</code> .       <code>View</code> ?    SwiftUI    PropertyWrapper — <code>@Binding</code> .         .      <code>View</code> ,  ,   ,  ,   <code>View</code>  .       <code>@State</code> —   ,   ,     .    ,      <code>@Binding</code> .    Property Wrapper,       ,     ,      <code>View</code> .    <code>inout</code>   <code>View</code> .      ,    ,   View,    .    <code>inout</code> ,        <code>$,</code>  ,         . React  . <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">State</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tapCount = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">VStack</span></span>{ <span class="hljs-type"><span class="hljs-type">SomeView</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>: $tapCount) <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"you tap \(tapCount) times"</span></span>) } } }</code> </pre><br>        . <code>@Binding var tapCount: Int</code> , ,     <code>Int</code> ,  <br><br><pre> <code class="plaintext hljs">Binding&lt;Int&gt;</code> </pre> <br>   , ,       <code>View</code> . <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span></span>{ @<span class="hljs-type"><span class="hljs-type">Binding</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tapCount: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">count</span></span>: <span class="hljs-type"><span class="hljs-type">Binding</span></span>&lt;<span class="hljs-type"><span class="hljs-type">Int</span></span>&gt;){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>._tapCount = <span class="hljs-built_in"><span class="hljs-built_in">count</span></span> <span class="hljs-comment"><span class="hljs-comment">//    -    } var body: some View{ Button(action: {self.tapCount += 1}, label: { Text("Tap me") }) } }</span></span></code> </pre> <br>  ,  <code>init</code>    ,   - <code>@PropertyWrapper</code>     <code>self._</code> —    ,  <code>self</code>    . ,   <code>self._</code>        .         . <br><br>   ,      ,   - <code>PropertyWrapper</code> ,  -,    <br><br><pre> <code class="plaintext hljs">Binding&lt;Int&gt;</code> </pre> <br>      <code>Int</code>   <code>.wrappedValue</code> . <br><br><div class="spoiler"> <b class="spoiler_title">  ,  </b> <div class="spoiler_text"> ,  Binding     .   View          View.      View      ,    @Binding-.  ,   View     <a href="https://habr.com/ru/users/state/" class="user_link">State</a>  @Binding — ,     State-   Binding.       -,  ,    . <br></div></div><br><h3> EnvironmentObject </h3><br>  ,  <code>EnvironmentObject</code>  —   <code>Binding</code> ,     <code>View</code>  ,       . <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ContentView</span></span>().environmentObject(session)</code> </pre> <br> ,    ,  -  ,     View. ,   ,   - ,     EnvironmentObject  ,   View.   View,   ,     ,     @EnvironmentObject   <br><br><pre> <code class="swift hljs"> @<span class="hljs-type"><span class="hljs-type">EnvironmentObject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> session: <span class="hljs-type"><span class="hljs-type">Session</span></span></code> </pre> <br>      .     <code>EnvironmentObject</code>       ,    .    3-, , ,       ,      .  <code>EnvironmentObject</code>      ,             <code>View</code> .    ,  <code>Binding</code> . <br><br> @Environment —    .   —   , .. .     , ,   (  ),     ,  ..  ,           CoreData: <br><br><pre> <code class="swift hljs">@<span class="hljs-type"><span class="hljs-type">Environment</span></span>(\.managedObjectContext) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> moc: <span class="hljs-type"><span class="hljs-type">NSManagedObjectContext</span></span></code> </pre><br> ,    CoreData  SwiftUI     .   , ,    .      . <br><br><h2> Custom @PropertyWrapper </h2><br>   , <code>PropertyWrapper</code> —    setter-  getter-,    ,       <code>property wrapper</code> .       ,      getter{} setter{} ,      ,   <code>View</code> ,  . ,   <code>PropertyWrapper</code>      <code>UserDefaults</code> . <br><br><pre> <code class="swift hljs">@propertyWrapper <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserDefault</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> initialValue: <span class="hljs-type"><span class="hljs-type">T</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> wrappedValue: <span class="hljs-type"><span class="hljs-type">T</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> { <span class="hljs-type"><span class="hljs-type">UserDefaults</span></span>.standard.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(newValue, forKey: key) } <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-type"><span class="hljs-type">UserDefaults</span></span>.standard.object(forKey: key) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>? <span class="hljs-type"><span class="hljs-type">T</span></span> ?? initialValue } } }</code> </pre> <br>  ,         <code>UserDefaults</code> . Apple         ,  , ,             ,             . <br><br>  ,   - (   ),          ,   <code>UserDefaults</code> ,     : <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">enum</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserPreferences</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">UserDefault</span></span>(key: <span class="hljs-string"><span class="hljs-string">"isCheatModeEnabled"</span></span>, initialValue: <span class="hljs-literal"><span class="hljs-literal">false</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isCheatModeEnabled: <span class="hljs-type"><span class="hljs-type">Bool</span></span> @<span class="hljs-type"><span class="hljs-type">UserDefault</span></span>(key: <span class="hljs-string"><span class="hljs-string">"highestScore"</span></span>, initialValue: <span class="hljs-number"><span class="hljs-number">10000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> highestScore: <span class="hljs-type"><span class="hljs-type">Int</span></span> @<span class="hljs-type"><span class="hljs-type">UserDefault</span></span>(key: <span class="hljs-string"><span class="hljs-string">"nickname"</span></span>, initialValue: <span class="hljs-string"><span class="hljs-string">"cloudstrife97"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> nickname: <span class="hljs-type"><span class="hljs-type">String</span></span> }</code> </pre><br>     ,   ,   ,      . <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">UserPreferences</span></span>.isCheatModeEnabled = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-type"><span class="hljs-type">UserPreferences</span></span>.highestScore = <span class="hljs-number"><span class="hljs-number">25000</span></span> <span class="hljs-type"><span class="hljs-type">UserPreferences</span></span>.nickname = <span class="hljs-string"><span class="hljs-string">"squallleonhart”</span></span></code> </pre><br>    <a href="https://medium.com/swlh/understanding-property-wrappers-in-swift-by-examples-604206022b5c" rel="nofollow"></a> . <br><br><h2>  Behälter </h2><br>   ,      ,  .     ,    <code>body</code> . , ,   <code>View</code> .    ,           . ,   —          .  ,      <code>@ViewBuilder</code> ,    View,     View,    ( ).  ,        — . <code>VStack</code>    , <code>HStack</code> ,    .   ,         View,   <code>Content</code> ,   ,    <code>View</code> . ,   <code>View</code>   . ,  <code>HStack{Text(…)}</code>    <code>TupleView&lt;Text, Image&gt;</code> . <br><br> ,   ,   <code>View</code> ,      —  ,       ,  body. ,     ,      <code>Text(«a»)</code> <code>Text(«b»)</code>  <code>HStack</code> .    <code>offset()</code>  <code>position()</code> ,       ,         <code>HStack</code> : <br><blockquote> HStack(spacing:, alingment:, context:). <br></blockquote> ,      ,     .   —    . <br><br><h4> ForEach </h4><br>     <code>ForEach</code> .  ,          .   ,  ,         -   <code>forEach(…)</code> .    , <code>ForEach</code>    <code>View</code> ,      .  Das heißt    ,    ,   —      . <br>  , <code>ForEach</code>     -  ,   ,       —   ,  , , ,    ( <code>List</code> ). <br><br> <code>ForEach</code>   :  ( <code>data: RandomAccesCollection</code> ),     ( <code>id: Hashable</code> )   ( <code>content: ()-&gt;Content</code> ).    :    , <code>ForEach</code>  <code>Content</code> — .. .      ,  <code>content</code>   , <code>ForEach</code>     ,      . <br><br>   <code>ForEach</code>   ,   <code>RandomAccesCollection</code> .        <code>sorted(by:)</code> ,      <code>RandomAccesCollection</code> . <br><br> <code>ForEach</code> —   <code>subView</code> ,         .  ,  SwiftUI  ,   <code>subView</code>     .  ,   <code>View</code>   .      .     <code>Hashable</code> ,  ,    <code>id: \.self</code> .   ,       .     ,    <code>Identifiable</code> —     .   , id      <code>subView</code> .      - ,  ,     <code>Hashable</code> —    : <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ForEach</span></span>(values, id: \.value){item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> …}</code> </pre><br>   , <code>values</code> —     <code>SomeObject</code> ,     <code>value: Int</code> .   ,       <code>View</code> ,     . ,        -   . <code>View</code>    1  1    ( ),   ,    <code>@Binding</code>  <code>View</code> . <br><br> ,    ,    Identifiable,     .  Zum Beispiel so: <br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">ForEach</span></span>(keys.<span class="hljs-built_in"><span class="hljs-built_in">indices</span></span>){ind <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">SomeView</span></span>(key: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.keys[ind]) }</code> </pre> <br>   ,       ,    .   ,   .       , ,    ,       , , ,    JSON .  ,   . <br><br>  ,   <code>Content</code> ,    <code>ForEach</code> .   ,      ,      (..       ,   2   —  ).    ,       <code>Groupe{}</code> —     . <br><br>            .  ,    ViewBuilder     . ,         <code>.frame(size:)</code> ?       .               (    ,       ).   CGSize,        .        ,       size,    <code>.ftame(width: size.width, height: size.height)</code> —     .    ,       —           . <br><br><h3> Custom container View </h3><br>    ,     .  ,     “1:N”       .          <code>dict: [KeyObject: [SomeObject]]</code>  . <br><br>   ,        <code>KeyObject</code> (      <code>Hashable</code> ),     —     — <code>SomeObject</code> . <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SomeObject</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Identifiable</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> value: <span class="hljs-type"><span class="hljs-type">Int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> id: <span class="hljs-type"><span class="hljs-type">UUID</span></span> = <span class="hljs-type"><span class="hljs-type">UUID</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(value: <span class="hljs-type"><span class="hljs-type">Int</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.value = value } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KeyObject</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hashable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Comparable</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(name: <span class="hljs-type"><span class="hljs-type">String</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.name = name } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> &lt; (lhs: KeyObject, rhs: KeyObject) -&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Bool</span></span></span><span class="hljs-function"> </span></span>{ lhs.name &lt; rhs.name } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> == </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(lhs: KeyObject, rhs: KeyObject)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Bool</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lhs.name == rhs.name } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hash</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(into hasher: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">inout</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Hasher)</span></span></span></span> { hasher.combine(name) } }</code> </pre><br>      -   ,           ,        .    ,     ,    generic.    ,   ,     : <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TreeView</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">K</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Hashable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">V</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Identifiable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KeyContent</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ValueContent</span></span></span><span class="hljs-class">&gt;: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">where</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">K</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Comparable</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KeyContent</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ValueContent</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> data: [<span class="hljs-type"><span class="hljs-type">K</span></span>: [<span class="hljs-type"><span class="hljs-type">V</span></span>]] <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> keyContent: (<span class="hljs-type"><span class="hljs-type">K</span></span>)-&gt;<span class="hljs-type"><span class="hljs-type">KeyContent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> valueContent: (<span class="hljs-type"><span class="hljs-type">V</span></span>)-&gt;<span class="hljs-type"><span class="hljs-type">ValueContent</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span>{ <span class="hljs-type"><span class="hljs-type">VStack</span></span>(alignment: .leading, spacing: <span class="hljs-number"><span class="hljs-number">0</span></span>){ <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(data.keys.sorted(), id: \.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>){(key: <span class="hljs-type"><span class="hljs-type">K</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">VStack</span></span>(alignment: .trailing, spacing: <span class="hljs-number"><span class="hljs-number">0</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.keyContent(key) <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.data[key]!){(value: <span class="hljs-type"><span class="hljs-type">V</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.valueContent(value) } } } } } }</code> </pre><br>  ,     <code>[K: [V]]</code> ( <code>K</code> —  - , <code>V</code> —  ,     ),   :     ,  —   .  ,       <code>ViewBuilder-</code>    (     ),       <code>ForEach</code> .       <code>RandomAccessCollection</code> ,  <code>dict.keys</code>   ,    .      <code>Comparable</code>  <code>KeyObject</code> . <br><br>     <code>ForEach</code> .   ,      ( <code>\.self</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) als Bezeichner jedes verschachtelten </font></font><code>View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Ich könnte das machen, weil Wörterbuchschlüssel sollten das Protokoll trotzdem unterstützen </font></font><code>Hashable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Im zweiten Fall habe ich der Klasse </font></font><code>SomeObject</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protokollunterstützung </font><font style="vertical-align: inherit;">hinzugefügt</font></font><code>Identifiable</code> .         —   id.    id   .     —     ,        —   id.  ,   .         .. ,           id.           id —    .          —    id  ,           <code>ForEach</code> . <br><br>    : <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> dict: [<span class="hljs-type"><span class="hljs-type">KeyObject</span></span>: [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>]] = [ <span class="hljs-type"><span class="hljs-type">KeyObject</span></span>(name: <span class="hljs-string"><span class="hljs-string">"1st group"</span></span>) : [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">2</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">3</span></span>)], <span class="hljs-type"><span class="hljs-type">KeyObject</span></span>(name: <span class="hljs-string"><span class="hljs-string">"2nd group"</span></span>) : [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">4</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">5</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">6</span></span>)], <span class="hljs-type"><span class="hljs-type">KeyObject</span></span>(name: <span class="hljs-string"><span class="hljs-string">"3rd group"</span></span>) : [<span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">7</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">8</span></span>), <span class="hljs-type"><span class="hljs-type">SomeObject</span></span>(value: <span class="hljs-number"><span class="hljs-number">9</span></span>)] ] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">TreeView</span></span>(data: dict, keyContent: {keyObject <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"the key is: \(keyObject.name)"</span></span>) } ){valueObject <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Text</span></span>(<span class="hljs-string"><span class="hljs-string">"value: \(valueObject.value)"</span></span>) } } }</code> </pre> <br>      Canvas: <br><br><img src="https://habrastorage.org/webt/48/jl/e_/48jle_vonedzfqtotu7uclu2u1e.png"><br><br><h4> to be continued </h4><br>    .       ,    ,   <code>CoreData</code>    SwiftUI, ,  ,  ,    SwiftUI   ,     .  ,  ,  . <br><br>    ,   —    .      . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de485548/">https://habr.com/ru/post/de485548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de485536/index.html">Ist es möglich ein Flugzeug zu hacken - 2</a></li>
<li><a href="../de485538/index.html">Zabbix: alles hintereinander überwachen (am Beispiel von Redis)</a></li>
<li><a href="../de485542/index.html">Hinzufügen von Grafiken zu Notion</a></li>
<li><a href="../de485544/index.html">Schach als dynamisches System</a></li>
<li><a href="../de485546/index.html">Die Apokalypse kommt</a></li>
<li><a href="../de485550/index.html">Gibt es ein Leben jenseits der Moskauer Ringstraße? Wie wir Entwickler suchen und vorbereiten</a></li>
<li><a href="../de485552/index.html">Eine andere Möglichkeit, die Zeit und die Build-Nummer für Java zu verfolgen</a></li>
<li><a href="../de485554/index.html">Ziele und Hauptergebnisse (OKR) - Unsere Erfahrung mit der schrittweisen Implementierung</a></li>
<li><a href="../de485556/index.html">Es dauerte 12 Jahre, um einen Abschnitt der Drosophila-Hirnkarte zu erstellen, die Bemühungen von 250 Menschen und 40 Millionen US-Dollar</a></li>
<li><a href="../de485558/index.html">Keine Mücken! Übersicht der Mücke "Phyto-Munition"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>