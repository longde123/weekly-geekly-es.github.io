<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëáüèª ‚¨õÔ∏è üßî De cero a h√©roe "Acciones en Google": inicio üôã üîü üë©üèΩ‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Google hackathon, y todo lo que necesitas para comenzar a desarrollar tus aplicaciones para un asistente. 


 Google ha organizado un hackathon dedica...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>De cero a h√©roe "Acciones en Google": inicio</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/redmadrobot/blog/419773/"><img src="https://habrastorage.org/webt/ek/p5/kq/ekp5kqbvvl0p4mdidicbmgfw5b0.png" alt="imagen"><br><p>  Google hackathon, y todo lo que necesitas para comenzar a desarrollar tus aplicaciones para un asistente. </p><br><p>  Google ha organizado un hackathon dedicado a la tecnolog√≠a Actions On Google.  Esta es una buena oportunidad para ganar experiencia y pensar en c√≥mo comenzar a crear una interfaz de usuario de conversaci√≥n (CUI) para nuestras aplicaciones.  Por lo tanto, reunimos un equipo de dos desarrolladores de Android: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">shipa_o</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">raenardev</a> y dise√±ador <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">camarada invitado,</a> y fuimos a participar. </p><a name="habracut"></a><br><h2>  ¬øQu√© son las acciones en Google? </h2><br><p>  Actions On Google (AoG) es una forma de agregar su acci√≥n al asistente. <br>  Puedes hacer esto usando 4 herramientas: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Acciones de contenido</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Rebanadas</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Acciones de aplicaciones</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Habilidad para el Asistente de Google</a> . </li></ul><br><p>  En el hackathon, creamos una habilidad: una aplicaci√≥n que ampl√≠a las capacidades de un asistente, por lo que nos detendremos all√≠. </p><br><p> Despu√©s de la apelaci√≥n, "Ok Google.  Quiero hablar con <code>${_}</code> ", el asistente abre la habilidad con la que el usuario lleva a cabo un di√°logo: </p><br><img src="https://habrastorage.org/webt/l2/vw/es/l2vwesoe1sywaswq0_8bmgjhhga.jpeg" alt="imagen" width="50%"><br><h3>  ¬øC√≥mo escribir una habilidad? <br></h3><br><p>  Necesitar√°s dos habilidades: <br>  - comprensi√≥n de la interfaz de usuario conversacional (CUI), la capacidad de dise√±arlos; <br>  - Capacidad para trabajar con procesamiento de lenguaje natural (PNL), por ejemplo, Dialogflow. </p><br><h4>  Etapa 1: dise√±o </h4><br><p>  Para que tu habilidad tenga un interlocutor de prote√≠nas, es mejor pensar en el futuro ahora.  La demanda ser√° la que tenga en cuenta el contexto de uso.  Las interfaces de di√°logo se utilizar√°n cuando sea posible hablar en voz alta e interactuar con dispositivos con voz de manera m√°s conveniente y r√°pida que con las manos, los ojos y otras partes del cuerpo. </p><br><p>  La interfaz de voz es serial.  Si es posible mostrar la forma completa de hacer un pedido en un gr√°fico, y la persona misma elegir√° qu√© mirar primero y luego qu√©, entonces solo puede hacer preguntas una tras otra en voz alta.  Para encontrar una aplicaci√≥n popular y conveniente, encuentre la intersecci√≥n entre las necesidades del usuario y la capacidad de usar la interfaz de voz (o la incapacidad de usar otras). </p><br><p>  Lo primero que viene a la mente es un asistente de voz para ciegos, que ayuda a resolver problemas cotidianos.  Por ejemplo, haga un pedido en una tienda, llame a un taxi, llame a familiares.  El segundo es un libro de recetas parlante para amas de casa con las manos en harina.  Tercero, juegos en los que necesitas explicar algo. </p><br><p>  Decidimos comenzar con uno simple y desarrollamos un robot que aconseja a las personas sobre buenas pel√≠culas.  Vencimos la imperfecci√≥n de los sintetizadores de voz: nuestro asistente ni siquiera finge ser un hombre y enfatiza su v√≠vida personalidad electr√≥nica en todos los sentidos. </p><br><p>  Google ha escrito excelentes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">pautas</a> sobre c√≥mo desarrollar interfaces interactivas.  Y hablaremos sobre c√≥mo dise√±amos nuestra conversaci√≥n primog√©nita. </p><br><p>  <b>1. Invocaci√≥n</b> </p><br><p>  Primero, debes llamar a un asistente.  La llamada puede ser expl√≠cita (invocaci√≥n expl√≠cita) e indirecta (invocaci√≥n impl√≠cita).  Las personas usar√°n un tratamiento expl√≠cito cuando ya conozcan la aplicaci√≥n.  Indirectamente, el Asistente de Google puede recomendar una aplicaci√≥n adecuada en una situaci√≥n espec√≠fica.  Las opciones elegidas correctamente para el atractivo indirecto, como las palabras clave correctas en la publicidad contextual, son solo m√°s "humanas". </p><br><div class="scrollable-table"><table><tbody><tr><td>  Tipo de apelaci√≥n </td><td><p>  Descripci√≥n </p><br></td><td>  Ejemplo </td></tr><tr><td>  Invocaci√≥n expl√≠cita </td><td>  Con el nombre del asistente </td><td><p><br>  Ok Google, quiero hablar con Red Passionate Movie Robot. <br>  Ll√°mame un robot de cine. <br>  ¬øD√≥nde est√° el rojo y el apasionado all√≠? </p><br></td></tr><tr><td><br>  Invocaci√≥n impl√≠cita </td><td><br>  En el contexto de cuando necesitas un asistente </td><td><br>  Ok Google, me aconsejas alguna pel√≠cula. <br>  Quiero ver una comedia divertida. <br>  ¬øQu√© tipo de pel√≠cula ver con una chica? </td></tr></tbody></table></div><br><p>  Es importante que las llamadas indirectas no sean demasiado generales.  Al igual que las palabras clave generales en la publicidad contextual, solo le impiden encontrar la aplicaci√≥n correcta y reducen la calificaci√≥n de la aplicaci√≥n en la emisi√≥n del Asistente. </p><br><p>  Las llamadas pueden contener un enlace profundo a las funciones individuales del asistente de voz.  Por ejemplo, generalmente nuestro robot de pel√≠cula comienza a comunicarse con el hecho de que le ofrece a una persona que elija un g√©nero.  Pero si se le llama en un llamado indirecto, "Quiero ver una comedia divertida", es l√≥gico comenzar un di√°logo con la oferta de una buena pel√≠cula garantizada del g√©nero mencionado. </p><br><p>  <b>2. Primer saludo</b> </p><br><p>  El primer saludo es lo que la aplicaci√≥n le dice a la persona inmediatamente despu√©s de la llamada. <br>  Primero debe informar al usuario que el asistente ya est√° aqu√≠: </p><br><blockquote>  Hola, una forma de vida proteica.  Soy un robot de cine apasionado rojo.  El prop√≥sito de mi existencia es aconsejar pel√≠culas biol√≥gicas sobre buenas pel√≠culas. </blockquote><p>  Y luego, sugiera qu√© hacer a continuaci√≥n.  Nuestro robot est√° buscando pel√≠culas por g√©nero, por lo que sugerimos con qu√© solicitud una persona puede ir m√°s all√°: <br>  ¬øQu√© quieres ver: tal vez comedia, acci√≥n u horror? </p><br><p>  Los usuarios nuevos y experimentados pueden ser recibidos de muchas maneras.  Si una persona est√° hablando con su asistente por primera vez, puede hablar un poco sobre usted.  Si no es el primero, un saludo largo lo molestar√°.  Por lo tanto, puede ponerse manos a la obra de inmediato: </p><br><div class="scrollable-table"><table><tbody><tr><td>  Primera vez </td><td><p>  Repetidamente </p><br></td></tr><tr><td>  Hola, una forma de vida proteica.  Soy un robot de cine apasionado rojo.  El prop√≥sito de mi existencia es aconsejar pel√≠culas biol√≥gicas sobre buenas pel√≠culas.  ¬øQu√© quieres ver: tal vez comedia, acci√≥n u horror? </td><td><br>  Saludos, hombre!  ¬øEn qu√© g√©nero est√°s interesado? </td></tr></tbody></table></div><br><p>  <b>3. conversaci√≥n humana</b> </p><br><p>  Ense√±e a su asistente a comprender el habla natural y a mantener la conversaci√≥n.  La forma m√°s f√°cil de hacerlo es comunicarse con personas del p√∫blico objetivo incluso antes de que comience el desarrollo.  Adem√°s, es deseable verbalmente, y no por escrito, porque el discurso coloquial escrito es m√°s escaso que el oral.  Juegue el papel del robot y p√≠dale al interlocutor que imagine que est√° usando su futura aplicaci√≥n.  Grabe todos los cuadros de di√°logo en la grabadora y luego descifre.  Esto lo ayudar√° a dise√±ar un diagrama de conversaci√≥n t√≠pico y a encontrar d√≥nde pueden aparecer ramas. </p><br><h4>  Etapa 2: desarrollo </h4><br><p>  Hay varias formas de desarrollar su acci√≥n para un asistente: </p><br><ul><li>  Con Dialogflow. </li><li>  Con acciones en el SDK de Google. </li><li>  El texto se puede procesar de forma independiente, por ejemplo, si tiene su propia soluci√≥n para procesar lenguaje natural (PNL - Procesamiento de lenguaje natural). </li></ul><br><p>  La siguiente es la interacci√≥n de un asistente con su habilidad. <br>  El di√°logo se ve as√≠: </p><br><ol><li><p>  El asistente traduce el discurso en texto y lo env√≠a a su acci√≥n. </p><br></li><li><p>  El texto se procesa de una de las formas anteriores.  En este diagrama, a trav√©s de Dialogflow. </p><br></li><li><p>  Dialogflow define la intenci√≥n (la intenci√≥n espec√≠fica del usuario) y recibe <br>  de ella entidades (par√°metros). </p><br></li><li><p>  (Opcional) Dialogflow puede llamar al webhook correspondiente, procesar los datos en el servidor y obtener una respuesta. </p><br></li><li><p>  Dialogflow forma la respuesta. </p><br></li><li><p>  El asistente expresa la respuesta, enciende el micr√≥fono y escucha lo que dir√° el usuario. </p><br></li></ol><br><img src="https://habrastorage.org/webt/ib/us/uf/ibusuffx_dlpg1eewj7ev4xcpzc.png" alt="imagen"><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Diagrama de acci√≥n auxiliar</a> </p><br><h4>  Dialogflow </h4><br><p>  No detallaremos los conceptos b√°sicos de Dialogflow: Google lanz√≥ buenos videos tutoriales. </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Intenciones</a> : sobre el reconocimiento de la intenci√≥n, c√≥mo exactamente Dialogflow comprende lo que el usuario pregunta o qu√© acci√≥n quiere realizar. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Entidades</a> : sobre el reconocimiento de par√°metros dentro de una frase.  Por ejemplo, en el caso de recomendar pel√≠culas, este es un g√©nero espec√≠fico. </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Control de di√°logo</a> : sobre el mecanismo de contexto (sobre esto a continuaci√≥n) y el cumplimiento: sobre c√≥mo procesar la solicitud del usuario mismo accediendo a su backend y c√≥mo devolver algo m√°s interesante que una respuesta de texto. </li></ol><br><p>  Suponemos que ya ha visto el video y descubri√≥ la consola Dialogflow.  Echemos un vistazo a los problemas que surgieron en cada una de las partes en el proceso de implementaci√≥n, y lo que es interesante se puede notar. </p><br><p>  Recuerde tambi√©n las reglas para construir un buen di√°logo cuando pase a la implementaci√≥n; esto afectar√° el conjunto de intentos, el conjunto de entidades y su uso en las respuestas, el uso de contextos y todo lo dem√°s. </p><br><h4>  Intenciones </h4><br><p>  Hay <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">recomendaciones</a> : hacer un saludo m√°s detallado para el nuevo usuario y para el resto hacerlo m√°s conciso.  ¬øC√≥mo implementar esto? </p><br><p>  En la consola de Dialogflow, esta l√≥gica no se puede determinar.  Esto se puede hacer dentro del cumplimiento por intenci√≥n de bienvenida.  En otras palabras, deber√° hacer esto con sus manos. </p><br><p>  Esto tambi√©n se aplica al manejo de errores.  Por ejemplo, por primera vez, simplemente puede volver a preguntar, y la segunda vez puede decir qu√© tipo de respuesta espera del usuario. </p><br><p>  No lo har√° a trav√©s de las respuestas: se seleccionar√° una respuesta aleatoria.  Puede hacerlo a trav√©s del cumplimiento o un poco m√°s complicado al vincularlo al contexto (m√°s sobre eso a continuaci√≥n). </p><br><h4>  Entidades </h4><br><p>  <b>"Permitir expansi√≥n automatizada" y sys.</b> </p><br><p>  Si la frase tiene una estructura similar, entonces cuando "Permitir expansi√≥n autom√°tica" est√° activado como una entidad reconocida, algo puede entrar en eso que a√∫n no puede procesarse con ganancias. </p><br><p>  Por ejemplo, su aplicaci√≥n reconoce la frase "Sugerirme algo de &lt;genre&gt;" para consejos sobre pel√≠culas.  Si dice "Av√≠seme algo de la comida", entonces como par√°metro "g√©nero" no obtendr√° lo que esperar√≠a.  Esto tiene sentido si el conjunto de g√©neros se actualiza constantemente din√°micamente en el back-end, y la respuesta del usuario se procesa all√≠, pero no tiene tiempo para actualizar la entidad. </p><br><p>  Otra soluci√≥n es usar sys. Cualquiera.  En este caso, transmitir√° todo lo que estaba despu√©s del dise√±o esperado, que puede ser la propuesta completa.  Esto brinda m√°s oportunidades que la expansi√≥n automatizada, pero tambi√©n hay m√°s desventajas. </p><br><p>  <b>Singular y plural, casos, g√©nero</b> </p><br><p>  Vamos a encontrar un ejemplo simple.  Hablaremos sobre sus frutas favoritas, y la aplicaci√≥n responder√° cu√°n geniales son.  En los ejemplos a continuaci√≥n, P es el usuario, A es nuestra acci√≥n. </p><br><blockquote>  P: Las pi√±as son las m√°s sabrosas. <br>  A: S√≠, ¬°las pi√±as son la fruta m√°s fresca! <br></blockquote><p>  En este ejemplo, tenemos entidad: Pi√±as <br>  Pero, ¬øqu√© pasa si el usuario dice "Pi√±a"?  Podemos agregar un sin√≥nimo. </p><br><blockquote>  P: Me gust√≥ la pi√±a. <br>  A: S√≠, ¬°las pi√±as son la fruta m√°s fresca! </blockquote><p>  El valor predeterminado es el formulario de referencia, es decir  es la forma original, no sus sin√≥nimos.  Es por eso que la aplicaci√≥n no dice "¬°S√≠, la pi√±a es la fruta m√°s fresca!" </p><br><p>  Tambi√©n vale la pena considerarlo al escribir respuestas.  Si tuvi√©ramos la respuesta "¬°S√≠, $ fruit es la m√°s genial!", Entonces obtendr√≠amos lo siguiente: </p><br><blockquote>  P: Me gust√≥ la pi√±a. <br>  A: S√≠, ¬°las pi√±as son las mejores! </blockquote><p>  Y no te olvides de los casos: </p><br><blockquote>  P: quiero drama <br>  A: Aqu√≠ hay un drama genial ... <br></blockquote><p>  Por lo tanto, debe escribir tanto los valores iniciales de la entidad como las respuestas de forma coherente.  Por ejemplo, podemos hacer todas las formas de entidad originales para frutas en plural y sin√≥nimos en cualquiera. </p><br><p>  Haremos g√©neros en ruso en el caso nominativo, pero en cualquier n√∫mero (drama, horrores). </p><br><p>  Cuando lleguemos a las respuestas, no escribiremos "S√≠, ¬°$ fruit es la fruta m√°s fresca!"  y "S√≠, ¬°$ fruit es la mejor!"  - las frutas siempre est√°n en plural. </p><br><p>  En el caso de la lengua rusa, vale la pena ir a√∫n m√°s lejos y pensar en c√≥mo escribir una respuesta acordada: no solo tenemos casos (drama / drama), sino tambi√©n g√©nero (drama / western). </p><br><blockquote>  P: quiero un western <br>  A: Aqu√≠ hay un western genial ... <br></blockquote><br><blockquote>  P: quiero un western <br>  A: occidental?  Ok, aqu√≠ hay una pel√≠cula genial ... </blockquote><p>  Pero, ¬øc√≥mo devolver exactamente el formulario de entidad que dijo el usuario? </p><br><p>  En el caso de los g√©neros, el sin√≥nimo de "ciencia ficci√≥n" podr√≠a ser "extraterrestres".  Luego, si el usuario dijera "extraterrestres", la "ciencia ficci√≥n" volver√≠a como par√°metro. <br>  Si queremos obtener la entidad en la forma en que dijo el usuario, entonces vale la pena elegir el valor de $ entity.original </p><br><img src="https://habrastorage.org/webt/vf/eq/9f/vfeq9fm3m3dbgzmmyik5qxvvd0q.png" alt="imagen"><br><p>  Pero entonces puede haber problemas con la inconsistencia del n√∫mero y (especialmente) la inconsistencia de los casos.  ¬øEs realmente necesario?  Si es as√≠, cree una entidad para singular, plural y case.  Las respuestas tambi√©n deben ser consistentes con el formulario de entidad que utilizan. </p><br><h4>  Contextos </h4><br><p>  Quiz√°s con esto la mayor√≠a de los problemas. </p><br><p>  <b>Contexto de entrada</b> </p><br><p>  Este es el contexto al que est√° vinculada una intenci√≥n particular.  Varios intentos pueden responder a la misma frase, y el que tiene el contexto de entrada activo probablemente funcionar√°. <br>  Por lo tanto, por ejemplo, puede adjuntar una respuesta de s√≠ / no a una pregunta espec√≠fica, que se realiza utilizando la intenci√≥n de seguimiento en Dialogflow </p><br><p>  <b>Contexto de salida</b> </p><br><p>  Este es el contexto que se activa cuando se activa la intenci√≥n.  As√≠ es como se activan los contextos en la consola de Dialogflow (esto tambi√©n se puede hacer en cumplimiento).  Indicamos el n√∫mero de vueltas del di√°logo durante el cual estar√° activo, y despu√©s de reiniciar el contador o despu√©s de 20 minutos se desactiva.  Esto significa que los datos dentro de este contexto ya no estar√°n disponibles y los intentos para los que se ingresan no funcionar√°n. </p><br><p>  Otro truco est√° relacionado con lo mismo: puede activar un contexto con un intento y desactivarlo manualmente con otro, simplemente poni√©ndolo como contexto de salida para el segundo intento con el n√∫mero de respuestas 0. </p><br><p>  Si no desea escribir c√≥digo en cumplimiento, de esta manera puede implementar una l√≥gica interesante, por ejemplo, utilizando el contexto como contador, implementar el manejo de errores cuando el asistente no comprende al usuario. </p><br><h4>  Consejos de Dialogflow </h4><br><ul><li><p>  No es necesario reiniciar la p√°gina con la vista previa del asistente: cuando haya realizado cambios en el agente de di√°logo de flujo, puede esperar hasta que se complete su capacitaci√≥n e inmediatamente repetir la frase no reconocida en el simulador.  Dialogflow puede considerarse como un backend al que se refiere un asistente. </p><br></li><li><p>  Use agentes preconstruidos: all√≠ puede ver c√≥mo implementar un escenario t√≠pico. </p><br></li><li><p>  Tenga cuidado con la secci√≥n Peque√±a charla.  Su uso no apaga el micr√≥fono al final de la conversaci√≥n, y tales respuestas generalmente no contienen un llamado a la acci√≥n.  No dirige al usuario a la siguiente ronda de di√°logo, y no le queda del todo claro qu√© se debe decir m√°s adelante.  Con una alta probabilidad, debido a esto, no puede pasar la revisi√≥n.  Es mejor hacer intentos separados para esto si puede ingresarlos en el di√°logo. </p><br></li><li><p>  No edite la misma intenci√≥n juntos al mismo tiempo.  Ahora no se admite el trabajo simult√°neo de varias personas; no se sabe qu√© cambios se sobrescribir√°n. </p><br></li><li><p>  Si es necesario paralelizar el trabajo con la intenci√≥n, puede llevarse a cabo en proyectos separados, y luego simplemente seleccionar los necesarios y transferirlos.  Tambi√©n importe y exporte entidades en json / xml e importe / exporte por intenci√≥n. </p><br></li><li><p>  Inmediatamente vale la pena considerar que escribes acciones para un idioma en particular.  Escribir respuestas en ruso tiene matices adicionales.  Por lo tanto, localizar la acci√≥n parece ser m√°s desafiante que con la GUI de la aplicaci√≥n m√≥vil. </p><br></li><li><p>  Considere las reglas de dise√±o de las interfaces de voz: afectan no solo al conjunto de r√©plicas, sino tambi√©n a la estructura en su conjunto.  Est√° creando un di√°logo, por lo que cada respuesta debe dejar un llamado a la acci√≥n para que el usuario entienda qu√© decir. </p><br></li><li><p>  Una vez que todo est√© listo y comience a probar, no tenga miedo de abandonar las ramas individuales del di√°logo o los formularios de preguntas.  Quiz√°s en la etapa de prueba comprender√° c√≥mo conectar las intenciones y lo que falta para facilitar su uso. </p><br></li></ul><br><h4>  Conexi√≥n al servidor </h4><br><p>  Para conectar el servidor necesita usar el cumplimiento.  Hay dos opciones para esto: </p><br><ul><li>  <strong>Cliente webhook</strong> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Muchos</a> idiomas soportados. </li><li>  <strong>Editor</strong> en <strong>l√≠nea</strong> sobre funciones en la nube para Firebase (node.js). </li></ul><br><p>  Consideremos el m√°s simple: el editor en l√≠nea. </p><br><p>  No pretendemos ser un experto en node.js; corregir errores en los comentarios es bienvenido. </p><br><p>  Es importante prestar atenci√≥n a la versi√≥n de la API de Dialogflow. <br>  √öltima versi√≥n v2.  Todo lo escrito para la versi√≥n v1 no funciona con √©l. <br>  Lea m√°s sobre la migraci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . </p><br><p>  Enlaces utiles: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Documentaci√≥n y c√≥digo fuente de la biblioteca para trabajar con el cumplimiento del flujo de di√°logo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Comenzando con el cumplimiento de Dialogflow</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ejemplos</a> </li><li>  Los registros se pueden ver aqu√≠: <a href="">vaya a la consola de Firebase junto al bot√≥n Implementar</a> </li></ul><br><h4>  Analiza la plantilla est√°ndar </h4><br><div class="spoiler">  <b class="spoiler_title">Cuando abre la secci√≥n Cumplimiento, el siguiente c√≥digo se muestra en el archivo / pesta√±a `index.js`:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">'use strict'; const functions = require('firebase-functions'); const {WebhookClient} = require('dialogflow-fulfillment'); const {Card, Suggestion} = require('dialogflow-fulfillment'); process.env.DEBUG = 'dialogflow:debug'; // enables lib debugging statements exports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) =&gt; { const agent = new WebhookClient({ request, response }); console.log('Dialogflow Request headers: ' + JSON.stringify(request.headers)); console.log('Dialogflow Request body: ' + JSON.stringify(request.body)); function welcome(agent) { agent.add(`Welcome to my agent!`); } function fallback(agent) { agent.add(`I didn't understand`); agent.add(`I'm sorry, can you try again?`); } // // Uncomment and edit to make your own intent handler // // uncomment `intentMap.set('your intent name here', yourFunctionHandler);` // // below to get this function to be run when a Dialogflow intent is matched // function yourFunctionHandler(agent) { // agent.add(`This message is from Dialogflow's Cloud Functions for Firebase editor!`); // agent.add(new Card({ // title: `Title: this is a card title`, // imageUrl: 'https://developers.google.com/actions/images/badges/XPM_BADGING_GoogleAssistant_VER.png', // text: `This is the body text of a card. You can even use line\n breaks and emoji! `, // buttonText: 'This is a button', // buttonUrl: 'https://assistant.google.com/' // }) // ); // agent.add(new Suggestion(`Quick Reply`)); // agent.add(new Suggestion(`Suggestion`)); // agent.setContext({ name: 'weather', lifespan: 2, parameters: { city: 'Rome' }}); // } // // Uncomment and edit to make your own Google Assistant intent handler // // uncomment `intentMap.set('your intent name here', googleAssistantHandler);` // // below to get this function to be run when a Dialogflow intent is matched // function googleAssistantHandler(agent) { // let conv = agent.conv(); // Get Actions on Google library conv instance // conv.ask('Hello from the Actions on Google client library!') // Use Actions on Google library // agent.add(conv); // Add Actions on Google library responses to your agent's response // } // // See https://github.com/dialogflow/dialogflow-fulfillment-nodejs/tree/master/samples/actions-on-google // // for a complete Dialogflow fulfillment library Actions on Google client library v2 integration sample // Run the proper function handler based on the matched Dialogflow intent name let intentMap = new Map(); intentMap.set('Default Welcome Intent', welcome); intentMap.set('Default Fallback Intent', fallback); // intentMap.set('your intent name here', yourFunctionHandler); // intentMap.set('your intent name here', googleAssistantHandler); agent.handleRequest(intentMap); });</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Y tales dependencias en el archivo / tab `package.json`:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">{ "name": "dialogflowFirebaseFulfillment", "description": "This is the default fulfillment for a Dialogflow agents using Cloud Functions for Firebase", "version": "0.0.1", "private": true, "license": "Apache Version 2.0", "author": "Google Inc.", "engines": { "node": "~6.0" }, "scripts": { "start": "firebase serve --only functions:dialogflowFirebaseFulfillment", "deploy": "firebase deploy --only functions:dialogflowFirebaseFulfillment" }, "dependencies": { "actions-on-google": "2.0.0-alpha.4", "firebase-admin": "^4.2.1", "firebase-functions": "^0.5.7", "dialogflow": "^0.1.0", "dialogflow-fulfillment": "0.3.0-beta.3" } }</code> </pre> </div></div><br><p>  En primer lugar, actualice las dependencias alfa y beta a las √∫ltimas estables. </p><br><div class="spoiler">  <b class="spoiler_title">Aqu√≠ est√°n las √∫ltimas versiones en este momento.</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">{ "dependencies": { "actions-on-google": "^2.2.0", "firebase-admin": "^5.2.1", "firebase-functions": "^0.6.2", "dialogflow": "^0.6.0", "dialogflow-fulfillment": "^0.5.0" } }</code> </pre> </div></div><br><p>  Y ahora echemos un vistazo m√°s de cerca al c√≥digo. </p><br><div class="spoiler">  <b class="spoiler_title">Lo anterior se hace importando dependencias</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">// Cloud Functions  Firebase library const functions = require('firebase-functions'); //       const {WebhookClient} = require('dialogflow-fulfillment'); //       const {Card, Suggestion} = require('dialogflow-fulfillment');</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Todo el punto de cumplimiento es anular la devoluci√≥n de llamada: un `dialogflowFirebaseFulfillment`</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">exports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) =&gt; { console.log('Dialogflow Request headers: ' + JSON.stringify(request.headers)); console.log('Dialogflow Request body: ' + JSON.stringify(request.body)); //   . const agent = new WebhookClient({ request, response }); //   let result = request.body.queryResult; //  action  entities https://dialogflow.com/docs/actions-and-parameters let action = result.action; let parameters = result.parameters; //    https://dialogflow.com/docs/contexts let outputContexts = result.outputContexts; //       let intentRequest = request.body.originalDetectIntentRequest; });</code> </pre> </div></div><br><p>  Se llamar√° a esta devoluci√≥n de llamada para aquellas intenciones para las cuales active fullfilment. </p><br><div class="spoiler">  <b class="spoiler_title">Ahora redefine la respuesta a la intenci√≥n</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">exports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) =&gt; { const agent = new WebhookClient({ request, response }); function welcome(agent) { //   agent.add(`Welcome to my agent!`); } function fallback(agent) { agent.add(`I didn't understand`); agent.add(`I'm sorry, can you try again?`); } //   ,  : // key -   intent-. // value -   ,   . let intentMap = new Map(); intentMap.set('Default Welcome Intent', welcome); intentMap.set('Default Fallback Intent', fallback); agent.handleRequest(intentMap); });</code> </pre> </div></div><br><p>  Al mismo tiempo, el c√≥digo reemplaza completamente la intenci√≥n de respuesta de la secci√≥n Respuestas. <br>  Las respuestas se llamar√°n solo si la devoluci√≥n de llamada falla, por lo que puede hacer un manejo de errores all√≠. </p><br><p>  Eliminamos las funciones de procesamiento de intenci√≥n de la devoluci√≥n de llamada. <br>  Las funciones de bienvenida y respaldo est√°n en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cierre</a> . </p><br><div class="spoiler">  <b class="spoiler_title">Para eliminarlos de la devoluci√≥n de llamada, deber√° agregar la transferencia del contexto de la funci√≥n y los par√°metros a trav√©s de `bind`</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">exports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) =&gt; { const agent = new WebhookClient({ request, response }); let intentMap = new Map(); //  set  Map.      intentMap .set('Default Welcome Intent', welcome.bind(this, agent)) .set('Default Fallback Intent', fallback.bind(this, agent)); agent.handleRequest(intentMap); }); function welcome(agent) { agent.add(`Welcome to my agent!`); } function fallback(agent) { //   2   add    agent.add([ `I didn't understand`, `I'm sorry, can you try again?` ]); }</code> </pre> </div></div><br><p> ,     ,       Google Assistant.  ,       . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es419773/">https://habr.com/ru/post/es419773/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es419763/index.html">Ejemplos de c√°lculo del "factor de disponibilidad" para conjuntos de equipos de red</a></li>
<li><a href="../es419765/index.html">El curso "Lenguajes de programaci√≥n web" (basado en Ruby) de MSTU. N.E. Bauman en el canal Technostream</a></li>
<li><a href="../es419767/index.html">El creador de Wikipedia responde preguntas: programaci√≥n, sue√±o, libros, consejos para la vida</a></li>
<li><a href="../es419769/index.html">WireGuard "vendr√°" al kernel de Linux, ¬øpor qu√©?</a></li>
<li><a href="../es419771/index.html">Resumen de tecnolog√≠a financiera: el Banco Central acelera la recopilaci√≥n de datos biom√©tricos de los clientes, las criptomonedas est√°n cayendo y el mercado de Internet de las cosas est√° creciendo</a></li>
<li><a href="../es419775/index.html">Mi versi√≥n del "dispositivo para sue√±os l√∫cidos" es una breve historia y una descripci√≥n de la primera versi√≥n</a></li>
<li><a href="../es419777/index.html">C√≥mo vender servidores NNN en los Pa√≠ses Bajos y no quedarse sin entusiasmo: secretos de ventas</a></li>
<li><a href="../es419779/index.html">Los pulmones crecidos se trasplantaron con √©xito a un cerdo; despu√©s de 5 a√±os, los ensayos en humanos son posibles</a></li>
<li><a href="../es419781/index.html">SpaceX celebr√≥ el primer taller de Marte</a></li>
<li><a href="../es419783/index.html">Hombre contra m√°quina: una nueva √©tica para la ciberseguridad</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>