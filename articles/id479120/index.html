<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëäüèæ üëéüèø üö¥ Jumlah pemilih gagal: kami membawa AgentTesla ke air bersih. Bagian 2 ‚õ©Ô∏è üõãÔ∏è üßî</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Kami melanjutkan serangkaian artikel tentang analisis malware. Pada bagian pertama , kami berbicara tentang bagaimana Ilya Pomerantsev, pakar analisis...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Jumlah pemilih gagal: kami membawa AgentTesla ke air bersih. Bagian 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/479120/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/vz/an/r5/vzanr5kxitvhd3zqrcdh1qhctjm.png"></div><br>  Kami melanjutkan serangkaian artikel tentang analisis malware.  Pada bagian <a href="https://habr.com/ru/company/group-ib/blog/478176/">pertama</a> , kami berbicara tentang bagaimana Ilya Pomerantsev, pakar analisis kode berbahaya di CERT Group-IB, melakukan analisis terperinci atas file yang diterima melalui pos dari salah satu perusahaan Eropa dan menemukan <b>spyware AgentTesla di sana</b> .  Dalam artikel ini, Ilya menyajikan hasil analisis bertahap dari modul <b>AgentTesla</b> utama. <br><a name="habracut"></a><br><blockquote> Agen Tesla adalah perangkat lunak spionase modular yang didistribusikan sebagai malware-as-a-service dengan kedok produk hukum keylogger.  Agent Tesla dapat mengekstraksi dan mengirimkan kredensial pengguna dari browser, klien email dan klien FTP ke server untuk penyerang, mendaftar data clipboard, dan menangkap layar perangkat.  Pada saat analisis, situs web resmi pengembang tidak tersedia. <br></blockquote><br><h2>  File konfigurasi </h2><br>  Tabel di bawah ini mencantumkan fitur yang digunakan dalam sampel yang digunakan: <br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Deskripsi</strong> <br></td><td>  <strong>Nilai</strong> <br></td></tr><tr><td>  Flag Penggunaan KeyLogger <br></td><td>  benar <br></td></tr><tr><td>  Tandai untuk menggunakan ScreenLogger <br></td><td>  salah <br></td></tr><tr><td>  Interval pengiriman log KeyLogger dalam hitungan menit <br></td><td>  20 <br></td></tr><tr><td>  Interval pengiriman log ScreenLogger dalam hitungan menit <br></td><td>  20 <br></td></tr><tr><td>  Tandai untuk memproses kunci Backspace.  Salah - hanya penebangan.  Benar - hapus kunci sebelumnya <br></td><td>  salah <br></td></tr><tr><td>  Ketik CnC.  Pilihan: smtp, webpanel, ftp <br></td><td>  smtp <br></td></tr><tr><td>  Bendera aktivasi utas untuk menghentikan proses dari daftar "% filter_list%" <br></td><td>  salah <br></td></tr><tr><td>  UAC menonaktifkan flag <br></td><td>  salah <br></td></tr><tr><td>  Nonaktifkan bendera pengelola tugas <br></td><td>  salah <br></td></tr><tr><td>  CMD disable flag <br></td><td>  salah <br></td></tr><tr><td>  Jalankan flag nonaktifkan jendela <br></td><td>  salah <br></td></tr><tr><td>  Nonaktifkan bendera penampil registri <br></td><td>  salah <br></td></tr><tr><td>  Nonaktifkan System Restore Points <br></td><td>  benar <br></td></tr><tr><td>  Panel Kontrol Nonaktifkan Bendera <br></td><td>  salah <br></td></tr><tr><td>  MSCONFIG menonaktifkan flag <br></td><td>  salah <br></td></tr><tr><td>  Bendera menonaktifkan menu konteks Explorer <br></td><td>  salah <br></td></tr><tr><td>  Bendera pin sistem <br></td><td>  salah <br></td></tr><tr><td>  Jalur untuk menyalin modul utama saat dok di sistem <br></td><td>  % startupfolder% \\% insfolder% \\% insname% <br></td></tr><tr><td>  Tandai untuk menetapkan atribut ‚ÄúSistem‚Äù dan ‚ÄúRahasia‚Äù untuk modul utama yang diperbaiki dalam sistem <br></td><td>  salah <br></td></tr><tr><td>  Mulai ulang flag eksekusi ketika memperbaiki sistem <br></td><td>  salah <br></td></tr><tr><td>  Tandai untuk memindahkan modul utama ke folder sementara <br></td><td>  salah <br></td></tr><tr><td>  UAC Bypass Run Flag <br></td><td>  salah <br></td></tr><tr><td>  Format tanggal dan waktu untuk logging <br></td><td>  yyyy-MM-dd HH: mm: ss <br></td></tr><tr><td>  Tandai untuk menggunakan filter program untuk KeyLogger <br></td><td>  benar <br></td></tr><tr><td>  Jenis penyaringan program. <br>  1 - nama program dicari di header jendela <br>  2 - nama program dicari dalam nama proses jendela <br></td><td>  1 <br></td></tr><tr><td>  Filter program <br></td><td>  Facebook <br>  Twitter <br>  Gmail <br>  Instagram <br>  "Film", <br>  Skype <br>  "Porno", <br>  Retas <br>  Whatsapp <br>  Perselisihan <br></td></tr></tbody></table></div><br><h2>  Memperbaiki modul utama dalam sistem </h2><br>  Jika flag yang sesuai diatur, modul utama disalin di sepanjang jalur yang ditentukan dalam konfigurasi sebagai jalur untuk perbaikan di sistem. <br><br>  Bergantung pada nilai dari konfigurasi, file diberi atribut "Tersembunyi" dan "Sistem". <br>  Autostart disediakan oleh dua cabang registri: <br><br><ul><li>  <b>HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \% insregname%</b> </li><li>  <b>HKCU \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ StartupApproved \ Run \% insregname%</b> </li></ul><br>  Karena bootloader menyuntikkan ke dalam proses <b>RegAsm</b> , pengaturan flag persisten untuk modul utama menghasilkan konsekuensi yang cukup menarik.  Alih-alih menyalin sendiri, malware mengamankan file <b>RegAsm.exe</b> asli ke dalam sistem, di mana injeksi dilakukan. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a8/mx/in/a8mxinpopuoixolt4r7tiwulc70.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9p/-f/ui/9p-fui42mv7y06i5ivacsyh2zqm.png"></div><br><h2>  Interaksi dengan C&amp;C </h2><br>  Terlepas dari metode yang digunakan, interaksi jaringan dimulai dengan memperoleh IP eksternal dari korban menggunakan <b><a href="http://checkip/">checkip</a> [.] Amazonaw [.] Com /</b> resource. <br>  Berikut ini menjelaskan metode jaringan yang disajikan dalam malware. <br><br><h3>  panel web </h3><br>  Interaksi ini melalui protokol HTTP.  Malware mengeksekusi permintaan POST dengan tajuk berikut: <br><br><ul><li>  <b>User-Agent: Mozilla / 5.0 (Windows U Windows NT 6.1 ru rv: 1.9.2.3) Gecko / 20100401 Firefox / 4.0 (.NET CLR 3.5.30729)</b> </li><li>  <b>Koneksi: Keep-Alive</b> </li><li>  <b>Content-Type: application / x-www-form-urlencoded</b> </li></ul><br>  Alamat server diatur ke <b>% PostURL%</b> .  Pesan terenkripsi dilewatkan dalam parameter <b>"p"</b> .  Mekanisme enkripsi dijelaskan di bagian <b>‚ÄúAlgoritma Enkripsi‚Äù (Metode 2)</b> . <br><br>  Pesan yang dikirimkan adalah sebagai berikut: <br><br>  <b>type = {0} \ nhwid = {1} \ ntime = {2} \ npcname = {3} \ nlogdata = {4} \ nscreenadd = {5} \ nipadd = {6} \ nwebcam_link = {7} \ nclient = {8} \ nlink = {9} \ nusername = {10} \ npassword = {11} \ nscreen_link = {12}</b> <br><br>  Parameter <b>tipe</b> menunjukkan tipe pesan: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lc/5l/yr/lc5lyrzbeie0jr9z-6dpzpylaze.jpeg"></div><br>  <b>hwid</b> - hash MD5 ditulis dari nilai-nilai nomor seri motherboard dan ID prosesor.  Kemungkinan besar digunakan sebagai ID Pengguna. <br>  <b>waktu</b> - berfungsi untuk mentransmisikan waktu dan tanggal saat ini. <br>  <b>pcname</b> - didefinisikan sebagai <b>&lt;Username&gt; / &lt;Computer Name&gt;</b> . <br>  <b>logdata</b> - data log. <br><br>  Saat mengirimkan kata sandi, pesannya tampak seperti: <br><br>  <b>type = {0} \ nhwid = {1} \ ntime = {2} \ npcname = {3} \ nlogdata = {4} \ nscreen = {5} \ nipadd = {6} \ nwebcam_link = {7} \ nscreen_link = {8} \ n [kata sandi]</b> <br><br>  Berikut ini adalah deskripsi data yang dicuri dalam format <b>\ nclient [] = {0} \ nlink [] = {1} \ nusername [] = {2} \ npassword [] = {3}</b> . <br><br><h3>  smtp </h3><br>  Interaksi ini melalui protokol SMTP.  Pesan yang dikirim dalam format HTML.  Parameter <b>BODY</b> adalah: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gh/vg/np/ghvgnpycvdbcsyyakmwjvfppnw4.png"></div><br>  Judul surat memiliki bentuk umum: <b>&lt;NAMA PENGGUNA&gt; / &lt;NAMA KOMPUTER&gt; &lt;JENIS KONTEN&gt;</b> .  Isi surat itu, beserta lampirannya, tidak dienkripsi. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x5/7c/5o/x57c5ojnqhgfpnec0jnsqix931c.jpeg"></div><br>  Interaksi adalah melalui protokol ftp.  File dengan nama <b>&lt;TYPE KONTEN&gt; _ &lt;NAMA PENGGUNA&gt; - &lt;NAMA KOMPUTER&gt; _ &lt;TANGGAL DAN WAKTU&gt; .html</b> ditransfer ke server yang ditentukan.  Isi file tidak dienkripsi. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/r-/2n/wr/r-2nwryzwnv7voneopya8y5aazq.jpeg"></div><br><h2>  Algoritma enkripsi </h2><br>  Metode enkripsi berikut digunakan dalam kasus ini: <br><br><h3>  Metode 1 </h3><br>  Metode ini digunakan untuk mengenkripsi string dalam modul utama.  Untuk enkripsi, algoritma <b>AES digunakan</b> . <br><br>  Input adalah angka desimal enam digit.  Transformasi berikut dilakukan di atasnya: <br><br>  <b>f (x) = (((x &gt;&gt; 2 - 31059) ^ 6380) - 1363) &gt;&gt; 3</b> <br><br>  Nilai yang dihasilkan adalah indeks untuk array data yang disematkan. <br><br>  Setiap elemen array adalah urutan <b>DWORD</b> .  Saat menggabungkan <b>DWORD,</b> array byte diperoleh: 32 byte pertama adalah kunci enkripsi, diikuti oleh 16 byte vektor inisialisasi, dan byte yang tersisa adalah data terenkripsi. <br><br><h3>  Metode 2 </h3><br>  Algoritma <b>3DES</b> digunakan dalam <b>mode ECB</b> dengan padding di seluruh byte ( <b>PKCS7</b> ). <br><br>  Kunci ditentukan oleh parameter <b>% urlkey%</b> , tetapi hash MD5-nya digunakan untuk enkripsi. <br><br><h2>  Fungsionalitas berbahaya </h2><br>  Sampel yang diteliti menggunakan program-program berikut untuk mengimplementasikan fungsi jahatnya: <br><br><h3>  Keylogger </h3><br>  Jika ada flag VPO yang sesuai menggunakan fungsi WinAPI, <b>SetWindowsHookEx</b> memberikan penangannya sendiri untuk acara keyboard keystroke.  Fungsi pawang dimulai dengan mendapatkan judul jendela aktif. <br><br>  Jika tanda untuk melakukan penyaringan aplikasi diatur, penyaringan dilakukan tergantung pada jenis yang ditentukan: <br><br><ol><li>  nama program terlihat di header jendela </li><li>  nama program terlihat di nama proses jendela </li></ol><br>  Selanjutnya, catatan ditambahkan ke log dengan informasi tentang jendela aktif dalam format: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bx/r0/cj/bxr0cj1srz9us2a4il4rwjfpoqo.png"></div><br>  Kemudian informasi tentang tombol yang ditekan direkam: <br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Kunci</strong> <br></td><td>  <strong>Rekam</strong> <br></td></tr><tr><td>  Backspace <br></td><td>  Bergantung pada bendera yang memproses kunci Backspace: Salah - <font color="#008000">{BACK}</font> <br>  Benar - hapus kunci sebelumnya <br></td></tr><tr><td>  CAPSLOCK <br></td><td>  <font color="#008000">{CAPSLOCK}</font> <br></td></tr><tr><td>  Esc <br></td><td>  <font color="#008000">{ESC}</font> <br></td></tr><tr><td>  PageUp <br></td><td>  <font color="#008000">{PageUp}</font> <br></td></tr><tr><td>  Turun <br></td><td>  <font color="#008000">? darr;</font> <br></td></tr><tr><td>  HAPUS <br></td><td>  <font color="#008000">{DEL}</font> <br></td></tr><tr><td>  ‚Äú <br></td><td>  &amp; quot; <br></td></tr><tr><td>  F5 <br></td><td>  <font color="#008000">{F5}</font> <br></td></tr><tr><td>  &amp; <br></td><td>  &amp; amp; <br></td></tr><tr><td>  F10 <br></td><td>  <font color="#008000">{F10}</font> <br></td></tr><tr><td>  Tab <br></td><td>  <font color="#008000">{TAB}</font> <br></td></tr><tr><td>  &lt; <br></td><td>  &amp; lt; <br></td></tr><tr><td>  &gt; <br></td><td>  &amp; gt; <br></td></tr><tr><td>  Bilah spasi <br></td><td></td></tr><tr><td>  F8 <br></td><td>  <font color="#008000">{F8}</font> <br></td></tr><tr><td>  F12 <br></td><td>  <font color="#008000">{F12}</font> <br></td></tr><tr><td>  F9 <br></td><td>  <font color="#008000">{F9}</font> <br></td></tr><tr><td>  ALT + TAB <br></td><td>  <font color="#008000">{ALT + TAB}</font> <br></td></tr><tr><td>  Akhir <br></td><td>  <font color="#008000">{END}</font> <br></td></tr><tr><td>  F4 <br></td><td>  <font color="#008000">{F4}</font> <br></td></tr><tr><td>  F2 <br></td><td>  <font color="#008000">{F2}</font> <br></td></tr><tr><td>  CTRL <br></td><td>  <font color="#008000">{CTRL}</font> <br></td></tr><tr><td>  F6 <br></td><td>  <font color="#008000">{F6}</font> <br></td></tr><tr><td>  Benar <br></td><td>  <font color="#008000">? rarr;</font> <br></td></tr><tr><td>  Naik <br></td><td>  <font color="#008000">&amp; uarr;</font> <br></td></tr><tr><td>  F1 <br></td><td>  <font color="#008000">{F1}</font> <br></td></tr><tr><td>  Kiri <br></td><td>  <font color="#008000">&amp; larr;</font> <br></td></tr><tr><td>  Pagedown <br></td><td>  <font color="#008000">{PageDown}</font> <br></td></tr><tr><td>  Masukkan <br></td><td>  <font color="#008000">{Sisipkan}</font> <br></td></tr><tr><td>  Menang <br></td><td>  <font color="#008000">{Menang}</font> <br></td></tr><tr><td>  Numlock <br></td><td>  <font color="#008000">{NumLock}</font> <br></td></tr><tr><td>  F11 <br></td><td>  <font color="#008000">{F11}</font> <br></td></tr><tr><td>  F3 <br></td><td>  <font color="#008000">{F3}</font> <br></td></tr><tr><td>  Rumah <br></td><td>  <font color="#008000">{HOME}</font> <br></td></tr><tr><td>  ENTER <br></td><td>  <font color="#008000">{ENTER}</font> <br></td></tr><tr><td>  ALT + F4 <br></td><td>  <font color="#008000">{ALT + F4}</font> <br></td></tr><tr><td>  F7 <br></td><td>  <font color="#008000">{F7}</font> <br></td></tr><tr><td>  Kunci lain <br></td><td>  Huruf besar atau huruf kecil tergantung pada posisi tombol CapsLock dan Shift <br></td></tr></tbody></table></div><br>  Dengan frekuensi yang diberikan, log yang dikumpulkan dikirim ke server.  Jika transfer tidak berhasil, log disimpan ke file <b>% TEMP% \\ log.tmp</b> dalam format: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xn/pz/eb/xnpzeba3_y7ulwz0wesksvlspkg.png"></div><br>  Ketika penghitung waktu mati, file akan ditransfer ke server. <br><br><h3>  Screenlogger </h3><br>  Dengan frekuensi yang ditentukan, malware menciptakan tangkapan layar dalam format <b>Jpeg</b> dengan nilai <b>Kualitas</b> 50 dan menyimpannya ke file <b>% APPDATA% \\ &lt;Urutan sewenang-wenang 10 karakter&gt; .jpg</b> .  Setelah transfer, file dihapus. <br><br><h3>  Clipboardlogger </h3><br>  Jika bendera yang sesuai diatur, penggantian dilakukan dalam teks dicegat sesuai dengan tabel di bawah ini. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xh/wc/y7/xhwcy7r4g5duormggz-texkxemi.jpeg"></div><br>  Setelah itu, teks dimasukkan ke dalam log: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ft/6l/2p/ft6l2pmpzecwtkh0hhgbblet30q.png"></div><br><h3>  PasswordStealer </h3><br>  Malware dapat mengunduh kata sandi dari aplikasi berikut: <br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Browser</strong> <br></td><td>  <strong>Klien Email</strong> <br></td><td>  <strong>Klien FTP</strong> <br></td></tr><tr><td>  Chrome <br></td><td>  Outlook <br></td><td>  Filezilla <br></td></tr><tr><td>  Firefox <br></td><td>  Thunderbird <br></td><td>  WS_FTP <br></td></tr><tr><td>  IE / Edge <br></td><td>  Foxmail <br></td><td>  Winscp <br></td></tr><tr><td>  Safari <br></td><td>  Opera Mail <br></td><td>  Coreftp <br></td></tr><tr><td>  Browser Opera <br></td><td>  IncrediMail <br></td><td>  Navigator FTP <br></td></tr><tr><td>  Yandex <br></td><td>  Pocomail <br></td><td>  Flashfxp <br></td></tr><tr><td>  Comodo <br></td><td>  Eudora <br></td><td>  Smartftp <br></td></tr><tr><td>  Chromeplus <br></td><td>  Hebat <br></td><td>  Komandan FTPC <br></td></tr><tr><td>  Chromium <br></td><td>  Kotak pos <br></td><td></td></tr><tr><td>  Obor <br></td><td>  Clawsmail <br></td><td></td></tr><tr><td>  7Star <br></td><td></td><td></td></tr><tr><td>  Amigo <br></td><td></td><td></td></tr><tr><td>  Perangkat lunak Braves <br></td><td>  <strong>Pelanggan Jabber</strong> <br></td><td>  <strong>Klien VPN</strong> <br></td></tr><tr><td>  Centbrowser <br></td><td>  Psi / psi + <br></td><td>  Buka VPN <br></td></tr><tr><td>  Chedot <br></td><td></td><td></td></tr><tr><td>  Coccoc <br></td><td></td><td></td></tr><tr><td>  Browser elemen <br></td><td>  <strong>Unduh pengelola</strong> <br></td><td></td></tr><tr><td>  Browser Privasi Epik <br></td><td>  Pengelola unduhan internet <br></td><td></td></tr><tr><td>  Kometa <br></td><td>  Jdownloader <br></td><td></td></tr><tr><td>  Orbitum <br></td><td></td><td></td></tr><tr><td>  Sputnik <br></td><td></td><td></td></tr><tr><td>  uCozMedia <br></td><td></td><td></td></tr><tr><td>  Vivaldi <br></td><td></td><td></td></tr><tr><td>  Seamonkey <br></td><td></td><td></td></tr><tr><td>  Browser kawanan <br></td><td></td><td></td></tr><tr><td>  Browser Uc <br></td><td></td><td></td></tr><tr><td>  Blackhawk <br></td><td></td><td></td></tr><tr><td>  Cyberfox <br></td><td></td><td></td></tr><tr><td>  K-meleon <br></td><td></td><td></td></tr><tr><td>  Icecat <br></td><td></td><td></td></tr><tr><td>  Icedragon <br></td><td></td><td></td></tr><tr><td>  Palemoon <br></td><td></td><td></td></tr><tr><td>  Kotak air <br></td><td></td><td></td></tr><tr><td>  Peramban falkon <br></td><td></td><td></td></tr></tbody></table></div><br><br><h2>  Menangkal analisis dinamis <br></h2><br><ul><li>  Menggunakan fungsi <b>Tidur</b> .  Memungkinkan untuk melewati beberapa kotak pasir berdasarkan batas waktu </li><li>  Menghancurkan <b>Zone.Identifier</b> stream.  Memungkinkan Anda menyembunyikan fakta mengunduh file dari Internet </li><li>  Parameter <b>% filter_list%</b> menetapkan daftar proses yang akan diselesaikan malware dengan interval satu detik </li><li>  Menonaktifkan <b>UAC</b> </li><li>  Menonaktifkan Task Manager </li><li>  Menonaktifkan <b>CMD</b> </li><li>  Menonaktifkan jendela <b>Jalankan</b> </li><li>  Menonaktifkan Panel Kontrol </li><li>  Menonaktifkan <b>Alat RegEdit</b> </li><li>  Menonaktifkan Poin Pemulihan Sistem </li><li>  Menonaktifkan menu konteks di Explorer </li><li>  Menonaktifkan <b>msconfig</b> </li><li>  Bypass <b>UAC</b> : <br></li></ul><br><h2>  Fitur tidak aktif dari modul utama </h2><br>  Selama analisis modul utama, fungsi yang bertanggung jawab untuk menyebar melalui jaringan dan melacak posisi mouse diidentifikasi. <br><br><h3>  Cacing </h3><br>  Dalam aliran terpisah, acara koneksi media yang dapat dilepas dimonitor.  Ketika terhubung ke root dari sistem file, <b>malware</b> disalin dengan nama <b>scr.exe</b> , setelah itu mencari file dengan ekstensi <b>lnk</b> .  Setiap <b>perintah lnk</b> berubah menjadi <b>cmd.exe / c mulai scr.exe &amp; mulai &lt;perintah asli&gt; &amp; keluar</b> . <br><br>  Setiap direktori di root media diberikan atribut <b>Tersembunyi</b> dan file dengan ekstensi <b>lnk dibuat</b> dengan nama direktori tersembunyi dan perintah <b>cmd.exe / c mulai scr.exe &amp; explorer / root, \ "% CD% &lt;NAMA DIREKTORI&gt; \" &amp; keluar</b> . <br><br><h3>  Perangkap tikus </h3><br>  Metode intersepsi mirip dengan yang digunakan untuk keyboard.  Fungsi ini masih dalam pengembangan. <br><br><h2>  Aktivitas file </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Jalan</strong> <br></td><td>  <strong>Deskripsi</strong> <br></td></tr><tr><td>  % Temp% \ temp.tmp <br></td><td>  Berisi counter upaya untuk memotong UAC <br></td></tr><tr><td>  % startupfolder% \% insfolder% \% insname% <br></td><td>  Cara untuk melakukan konsolidasi dalam sistem HPE <br></td></tr><tr><td>  % Temp% \ tmpG \ {Waktu saat ini dalam milidetik} .tmp <br></td><td>  Jalur untuk cadangan modul utama <br></td></tr><tr><td>  % Temp% \ log.tmp <br></td><td>  File log <br></td></tr><tr><td>  % AppData% \ {Urutan 10 karakter acak} .jpeg <br></td><td>  Tangkapan layar <br></td></tr><tr><td>  C: \ Users \ Public \ {Urutan 10 karakter yang sewenang-wenang} .vbs <br></td><td>  Path ke file vbs yang dapat digunakan bootloader untuk menutup sistem <br></td></tr><tr><td>  % Temp% \ {Nama folder sewenang-wenang} \ {Nama file} <br></td><td>  Jalur yang digunakan oleh bootloader untuk berlabuh di sistem <br></td></tr></tbody></table></div><br><h2>  Profil penyusup </h2><br>  Berkat data otentikasi "kabel", kami dapat memperoleh akses ke pusat perintah. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/q0/eb/nqq0ebtlfljriwj4m-97hm7-aww.png"></div><br>  Ini memungkinkan kami untuk mengidentifikasi surat terakhir para penyerang: <br><br>  <b>junaid [.] di *** @ gmail [.] com</b> . <br><br>  Nama domain dari pusat perintah terdaftar di <b>sg *** @ gmail [.] Com</b> . <br><br><h2>  Kesimpulan </h2><br>  Dalam proses analisis terperinci terhadap malware yang digunakan dalam serangan itu, kami dapat menetapkan fungsionalitasnya dan mendapatkan daftar indikator kompromi paling komprehensif yang relevan untuk kasus ini.  Memahami mekanisme interaksi jaringan malvari memungkinkan untuk memberikan rekomendasi tentang penyesuaian operasi alat perlindungan informasi, serta menulis aturan IDS yang stabil. <br><br>  Bahaya utama <b>AgentTesla</b> sebagai DataStealer adalah bahwa untuk melakukan tugasnya tidak perlu membuat fiksasi dalam sistem atau menunggu perintah kontrol.  Begitu berada di mesin, ia segera mulai mengumpulkan informasi pribadi dan mengirimkannya ke CnC.  Perilaku agresif semacam itu agak mirip dengan perilaku kriptografer, dengan satu-satunya perbedaan adalah bahwa yang terakhir bahkan tidak memerlukan koneksi jaringan.  Jika terjadi tabrakan dengan keluarga ini setelah membersihkan sistem yang terinfeksi dari malware itu sendiri, adalah wajib untuk mengubah semua kata sandi yang setidaknya secara teoritis dapat disimpan di salah satu aplikasi di atas. <br><br>  <b>Ke</b> depan, katakanlah bahwa penyerang mengirim <b>AgentTesla</b> sangat sering mengubah bootloader awal.  Ini memungkinkan Anda untuk tidak diketahui oleh pemindai statis dan analisis heuristik pada saat serangan.  Dan kecenderungan keluarga ini untuk segera memulai aktivitasnya membuat sistem monitor menjadi tidak berguna.  Cara terbaik untuk berurusan dengan AgentTesla adalah analisis pendahuluan di kotak pasir. <br><br>  Pada artikel ketiga dalam seri ini, kita akan melihat bootloader lain yang digunakan oleh <b>AgentTesla</b> , dan juga belajar tentang proses membongkar mereka secara otomatis.  Jangan sampai ketinggalan! <br><br><h2>  Hash </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>SHA1</strong> <br></td></tr><tr><td>  A8C2765B3D655BA23886D663D22BDD8EF6E8E894 <br></td></tr><tr><td>  8010CC2AF398F9F951555F7D481CE13DF60BBECF <br></td></tr><tr><td>  79B445DE923C92BF378B19D12A309C0E9C5851BF <br></td></tr><tr><td>  15839B7AB0417FA35F2858722F0BD47BDF840D62 <br></td></tr><tr><td>  1C981EF3EEA8548A30E8D7BF8D0D61F9224288DD <br></td></tr></tbody></table></div><br><h2>  C&amp;C </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>URL</strong> <br></td></tr><tr><td>  sina-c0m [.] icu <br></td></tr><tr><td>  smtp [.] sina-c0m [.] icu <br></td></tr></tbody></table></div><br><br><h2>  Regkey </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Daftar</strong> <br></td></tr><tr><td>  HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \ {Script Name} <br></td></tr><tr><td>  HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \% insregname% <br></td></tr><tr><td>  HKCU \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ StartupApproved \ Run \% insregname% <br></td></tr></tbody></table></div><br><h3>  Mutex </h3><br>  Tidak ada indikator. <br><br><h3>  File </h3><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Aktivitas file</strong> <br></td></tr><tr><td>  % Temp% \ temp.tmp <br></td></tr><tr><td>  % startupfolder% \% insfolder% \% insname% <br></td></tr><tr><td>  % Temp% \ tmpG \ {Waktu saat ini dalam milidetik} .tmp <br></td></tr><tr><td>  % Temp% \ log.tmp <br></td></tr><tr><td>  % AppData% \ {Urutan 10 karakter acak} .jpeg <br></td></tr><tr><td>  C: \ Users \ Public \ {Urutan 10 karakter sewenang-wenang} .vbs <br></td></tr><tr><td>  % Temp% \ {Nama folder sewenang-wenang} \ {Nama file} <br></td></tr></tbody></table></div><br><h2>  Info Sampel </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Nama</strong> <br></td><td>  Tidak dikenal <br></td></tr><tr><td>  <strong>MD5</strong> <br></td><td>  F7722DD8660B261EA13B710062B59C43 <br></td></tr><tr><td>  <strong>SHA1</strong> <br></td><td>  15839B7AB0417FA35F2858722F0BD47BDF840D62 <br></td></tr><tr><td>  <strong>SHA256</strong> <br></td><td>  41DC0D5459F25E2FDCF8797948A7B315D3CB0753 <br>  98D808D1772CACCC726AF6E9 <br></td></tr><tr><td>  <strong>Jenis</strong> <br></td><td>  PE (.NET) <br></td></tr><tr><td>  <strong>Ukuran</strong> <br></td><td>  327680 <br></td></tr><tr><td>  <strong>Nama asli</strong> <br></td><td>  AZZRIDKGGSLTYFUBCCRRCUMRKTOXFVPDKGAGPUZI_20190701133545943.exe <br></td></tr><tr><td>  <strong>Datestamp</strong> <br></td><td>  07/01/2019 <br></td></tr><tr><td>  <strong>Kompiler</strong> <br></td><td>  Vb.net <br></td></tr></tbody></table></div><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Nama</strong> <br></td><td>  IELibrary.dll <br></td></tr><tr><td>  <strong>MD5</strong> <br></td><td>  BFB160A89F4A607A60464631ED3ED9FD <br></td></tr><tr><td>  <strong>SHA1</strong> <br></td><td>  1C981EF3EEA8548A30E8D7BF8D0D61F9224288DD <br></td></tr><tr><td>  <strong>SHA256</strong> <br></td><td>  D55800A825792F55999ABDAD199DFA54F3184417 <br>  215A298910F2C12CD9CC31EE <br></td></tr><tr><td>  <strong>Jenis</strong> <br></td><td>  PE (.NET DLL) <br></td></tr><tr><td>  <strong>Ukuran</strong> <br></td><td>  16896 <br></td></tr><tr><td>  <strong>Nama asli</strong> <br></td><td>  IELibrary.dll <br></td></tr><tr><td>  <strong>Datestamp</strong> <br></td><td>  10/11/2016 <br></td></tr><tr><td>  <strong>Kompiler</strong> <br></td><td>  Microsoft Linker (48.0 *) <br></td></tr></tbody></table></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id479120/">https://habr.com/ru/post/id479120/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id479100/index.html">Front-end dojo: proyek untuk melatih keterampilan pengembang (5 baru + 43 lama)</a></li>
<li><a href="../id479102/index.html">Berkenalan dengan Yandex.Maps atau Seberapa saya suka dokumentasi</a></li>
<li><a href="../id479106/index.html">Berapa biaya trik sulap</a></li>
<li><a href="../id479108/index.html">Kehidupan Knight - Arena online dengan elemen RPG</a></li>
<li><a href="../id479116/index.html">Tayangan pada pencarian Y. Langsung: mengapa Anda membayar 1,5 kali lebih banyak per klik</a></li>
<li><a href="../id479122/index.html">Cara memulai proyek kesayangan dan tidak mendapat manfaat</a></li>
<li><a href="../id479124/index.html">[Infografis] Kecerdasan Buatan dalam Fiksi Ilmiah</a></li>
<li><a href="../id479126/index.html">Python dalam pengembangan Mobile</a></li>
<li><a href="../id479128/index.html">Bagaimana cara kerja layanan medis bandara</a></li>
<li><a href="../id479132/index.html">Komponen eksternal untuk platform 1C Mobile (BroadcastReceiver)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>