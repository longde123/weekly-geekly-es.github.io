<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüëß‚Äçüë¶ üïû üìß Programaci√≥n asincr√≥nica de JavaScript (devoluci√≥n de llamada, promesa, RxJs) ü§ôüèª üë®üèø‚Äçüî¨ üë†</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos En contacto Omelnitsky Sergey. No hace mucho tiempo, dirig√≠ una secuencia de programaci√≥n reactiva donde habl√© sobre asincron√≠a en JavaSc...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Programaci√≥n asincr√≥nica de JavaScript (devoluci√≥n de llamada, promesa, RxJs)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462355/"><p>  Hola a todos  En contacto Omelnitsky Sergey.  No hace mucho tiempo, dirig√≠ una secuencia de programaci√≥n reactiva donde habl√© sobre asincron√≠a en JavaScript.  Hoy me gustar√≠a esbozar este material. </p><br><p><img src="https://habrastorage.org/webt/oq/x0/s1/oqx0s1ukuyf6izyu-5cxkd9cd-m.png"></p><br><p>  Pero antes de comenzar el material principal, tenemos que hacer uno introductorio.  Entonces, comencemos con las definiciones: ¬øcu√°l es la pila y la cola? </p><br><p>  <strong>Una pila</strong> es una colecci√≥n cuyos elementos se reciben seg√∫n el principio de LIFO "√∫ltimo en entrar, primero en salir" </p><br><p>  <strong>Una cola</strong> es una colecci√≥n cuyos elementos se reciben seg√∫n el principio (FIFO "primero que entra, primero que sale") </p><br><p>  Ok, continuemos. </p><br><p><img src="https://habrastorage.org/webt/xk/dt/rr/xkdtrrm0vasdzlva2iqgrpjmwuk.png"></p><br><p>  JavaScript es un lenguaje de programaci√≥n de subproceso √∫nico.  Esto significa que solo tiene un hilo de ejecuci√≥n y una pila en la que las funciones se ponen en cola para su ejecuci√≥n.  Por lo tanto, en un momento dado, JavaScript puede realizar solo una operaci√≥n, mientras que otras operaciones esperar√°n su turno en la pila hasta que se llamen. </p><a name="habracut"></a><br><p>  <strong>La pila de llamadas</strong> es una estructura de datos que, en t√©rminos simples, registra informaci√≥n sobre el lugar en el programa donde estamos.  Si entramos en una funci√≥n, colocamos un registro al respecto en la parte superior de la pila.  Cuando volvemos de la funci√≥n, sacamos el elemento superior de la pila y nos encontramos desde donde llamamos a esta funci√≥n.  Esto es todo lo que la pila puede hacer.  Y ahora una pregunta extremadamente interesante.  ¬øC√≥mo funciona entonces la asincron√≠a en JavasScript? </p><br><p><img src="https://habrastorage.org/webt/h2/-x/aj/h2-xajggqa9vcloczh7owhqiffc.png"></p><br><p>  De hecho, adem√°s de la pila, los navegadores tienen una cola especial para trabajar con el llamado WebAPI.  Las funciones de esta cola se ejecutar√°n en orden solo despu√©s de que la pila est√© completamente limpia.  Solo despu√©s de eso son empujados desde la cola a la pila para su ejecuci√≥n.  Si al menos un elemento est√° actualmente en la pila, entonces no pueden acceder a la pila.  Es precisamente por esto que las funciones de llamada por tiempo de espera a menudo no son precisas en el tiempo, ya que una funci√≥n no puede pasar de la cola a la pila mientras est√° llena. </p><br><p>  Considere el siguiente ejemplo y realice su "ejecuci√≥n" paso a paso.  Tambi√©n vea lo que sucede en el sistema. </p><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Hi'</span></span>); setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cb1</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'cb1'</span></span>); }, <span class="hljs-number"><span class="hljs-number">5000</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'Bye'</span></span>);</code> </pre> <br><p><img src="https://habrastorage.org/webt/tg/i-/xf/tgi-xfd5vxrjxltraxp4o7uhiki.png"></p><br><p>  1) Hasta ahora, no pasa nada.  La consola del navegador est√° limpia, la pila de llamadas est√° vac√≠a. </p><br><p><img src="https://habrastorage.org/webt/v4/et/uh/v4etuhvfo-eltv08fhxv1bqx1a0.png"></p><br><p>  2) Luego se agrega el comando console.log ('Hola') a la pila de llamadas. </p><br><p><img src="https://habrastorage.org/webt/ns/-k/-k/ns-k-klle5egqpwjdzbgxkrwaes.png"></p><br><p>  3) Y se ejecuta </p><br><p><img src="https://habrastorage.org/webt/dp/oo/tz/dpootztdu0jjapitb1v60dzwdcu.png"></p><br><p>  4) Entonces console.log ('Hola') se elimina de la pila de llamadas. </p><br><p><img src="https://habrastorage.org/webt/fu/yb/wb/fuybwb7kq0kcxdj4gobj38-r_fc.png"></p><br><p>  5) Ahora vaya al comando setTimeout (funci√≥n cb1 () {...}).  Se agrega a la pila de llamadas. </p><br><p><img src="https://habrastorage.org/webt/85/ps/v2/85psv2_s7ec0ibxh8h2991nbxi4.png"></p><br><p>  6) Se ejecuta el comando setTimeout (funci√≥n cb1 () {...}).  El navegador crea un temporizador que forma parte de la API web.  √âl har√° la cuenta regresiva. </p><br><p><img src="https://habrastorage.org/webt/3a/4p/sh/3a4pshoazrkbxfgcajwjqm1cz-m.png"></p><br><p>  7) El comando setTimeout (funci√≥n cb1 () {...}) ha completado su trabajo y se elimina de la pila de llamadas. </p><br><p><img src="https://habrastorage.org/webt/oe/qt/ne/oeqtnemv7rawkjpanipkv41qpeq.png"></p><br><p>  8) El comando console.log ('Bye') se agrega a la pila de llamadas. </p><br><p><img src="https://habrastorage.org/webt/bb/mp/fb/bbmpfba1p2tadcztfm-41py_mgi.png"></p><br><p>  9) Se ejecuta el comando console.log ('Bye'). </p><br><p><img src="https://habrastorage.org/webt/d0/ra/3z/d0ra3zfarz4ujmyy46cmsofs8ue.png"></p><br><p>  10) El comando console.log ('Bye') se elimina de la pila de llamadas. </p><br><p><img src="https://habrastorage.org/webt/5y/by/dr/5ybydrdk6yuexhgyhbxwsvnkefa.png"></p><br><p>  11) Despu√©s de que hayan pasado al menos 5000 ms, el temporizador sale y coloca la devoluci√≥n de llamada cb1 en la cola de devoluci√≥n de llamada. </p><br><p><img src="https://habrastorage.org/webt/sx/of/no/sxofnovn3xkkz5oyngnotdggpcs.png"></p><br><p>  12) El bucle de eventos toma c la funci√≥n cb1 de la cola de devoluci√≥n de llamada y la coloca en la pila de llamadas. </p><br><p><img src="https://habrastorage.org/webt/ge/qp/1t/geqp1t65hnddi0hx0ut4b80ooi0.png"></p><br><p>  13) La funci√≥n cb1 se ejecuta y agrega console.log ('cb1') a la pila de llamadas. </p><br><p><img src="https://habrastorage.org/webt/xi/vq/ac/xivqac36m7yv79qocvstugftlb4.png"></p><br><p>  14) Se ejecuta el comando console.log ('cb1'). </p><br><p><img src="https://habrastorage.org/webt/hp/tu/gk/hptugkn_5iizvyhez25bpf8zvpy.png"></p><br><p>  15) El comando console.log ('cb1') se elimina de la pila de llamadas. </p><br><p><img src="https://habrastorage.org/webt/bh/wr/st/bhwrstroipmqqhrhiit4cmdy-we.png"></p><br><p>  16) La funci√≥n cb1 se elimina de la pila de llamadas. </p><br><p>  Eche un vistazo a un ejemplo en din√°mica: </p><br><p><img src="https://habrastorage.org/webt/xx/nj/a8/xxnja8sfjhdg5ks3ku5q6yzkxvc.gif"></p><br><p>  Bueno, aqu√≠ hemos examinado c√≥mo se implementa la asincron√≠a en JavaScript.  Ahora hablemos brevemente sobre la evoluci√≥n del c√≥digo asincr√≥nico. </p><br><h2 id="evolyuciya-asinhronnogo-koda">  La evoluci√≥n del c√≥digo asincr√≥nico. </h2><br><pre> <code class="javascript hljs">a(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resultsFromA</span></span></span><span class="hljs-function">) </span></span>{ b(resultsFromA, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resultsFromB</span></span></span><span class="hljs-function">) </span></span>{ c(resultsFromB, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resultsFromC</span></span></span><span class="hljs-function">) </span></span>{ d(resultsFromC, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resultsFromD</span></span></span><span class="hljs-function">) </span></span>{ e(resultsFromD, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resultsFromE</span></span></span><span class="hljs-function">) </span></span>{ f(resultsFromE, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resultsFromF</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(resultsFromF); }) }) }) }) }) });</code> </pre> <br><p>  La programaci√≥n asincr√≥nica, como la conocemos en JavaScript, solo se puede implementar con funciones.  Se pueden pasar como cualquier otra variable a otras funciones.  As√≠ nacieron las devoluciones de llamada.  Y es genial, divertido y provocativo, hasta que se convierte en tristeza, anhelo y tristeza.  Por qu√©  S√≠, todo es simple: </p><br><ul><li>  Con la creciente complejidad del c√≥digo, el proyecto se convierte r√°pidamente en oscuros bloques anidados repetidamente: "infierno de devoluci√≥n de llamada". </li><li>  El manejo de errores puede perderse f√°cilmente. </li><li>  No puede devolver expresiones con return. </li></ul><br><p>  Con Promise, las cosas mejoraron un poco. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) </span></span>{ setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> resolve(<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">2000</span></span>); }).then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">) =&gt;</span></span> { alert(result); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result + <span class="hljs-number"><span class="hljs-number">2</span></span>; }).then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">'FAILED HERE'</span></span>); alert(result); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result + <span class="hljs-number"><span class="hljs-number">2</span></span>; }).then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result</span></span></span><span class="hljs-function">) =&gt;</span></span> { alert(result); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result + <span class="hljs-number"><span class="hljs-number">2</span></span>; }).catch(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">'error: '</span></span>, e); });</code> </pre> <br><ul><li>  Aparecieron cadenas de promesa, que mejoraron la legibilidad del c√≥digo </li><li>  Ha aparecido un m√©todo separado de captura de errores </li><li>  Ahora puedes correr en paralelo usando Promise.all </li><li>  Podemos resolver la asincron√≠a anidada con async / await </li></ul><br><p>  Pero promis tiene sus limitaciones.  Por ejemplo, una promesa, sin bailar con una pandereta, no se puede deshacer, y lo m√°s importante, funciona con un valor. </p><br><p>  Bueno, nos acercamos sin problemas a la programaci√≥n reactiva.  Estas cansado  Bueno, lo bueno es que puedes hacer algunas gaviotas, pensar y volver a leer m√°s.  Y continuar√©. </p><br><p><img src="https://habrastorage.org/webt/pj/0g/7b/pj0g7bgonkiefme08noahs3y0wc.png" alt="Conceptos b√°sicos de programaci√≥n reactiva"></p><br><p>  <strong>La programaci√≥n reactiva</strong> es un paradigma de programaci√≥n centrado en los flujos de datos y la difusi√≥n del cambio.  Echemos un vistazo m√°s de cerca a lo que es un flujo de datos. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     const input = ducument.querySelector('input'); const eventsArray = []; //      eventsArray input.addEventListener('keyup', event =&gt; eventsArray.push(event) );</span></span></code> </pre> <br><p>  Imagine que tenemos un campo de entrada.  Creamos una matriz, y para cada keyup del evento de entrada guardaremos el evento en nuestra matriz.  En este caso, me gustar√≠a se√±alar que nuestra matriz est√° ordenada por tiempo, es decir  El √≠ndice de eventos posteriores es mayor que el √≠ndice de eventos anteriores.  Tal matriz es un modelo de flujo de datos simplificado, pero a√∫n no es un flujo.  Para que esta matriz se pueda llamar de forma segura una secuencia, debe poder informar de alguna manera a los suscriptores que ha recibido nuevos datos.  Entonces llegamos a la definici√≥n de flujo. </p><br><h3 id="potok-dannyh">  Flujo de datos </h3><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { interval } = Rx; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { take } = RxOperators; interval(<span class="hljs-number"><span class="hljs-number">1000</span></span>).pipe( take(<span class="hljs-number"><span class="hljs-number">4</span></span>) )</code> </pre> <br><p><img src="https://habrastorage.org/webt/iu/oe/9k/iuoe9k_c75atoryyrxykddnhuzi.gif"></p><br><p>  <strong>Una secuencia</strong> es una matriz de datos ordenados por tiempo que puede indicar que los datos han cambiado.  Ahora imagine lo conveniente que resulta escribir c√≥digo en el que necesita activar varios eventos en diferentes partes del c√≥digo en una sola acci√≥n.  Simplemente nos suscribimos a la transmisi√≥n y √©l nos avisar√° cuando ocurran los cambios.  Y la biblioteca RxJs puede hacer esto. </p><br><p><img src="https://habrastorage.org/webt/2e/eg/cv/2eegcvxzcaz0j6x_n27h7nko68s.png"></p><br><p>  <strong>RxJS</strong> es una biblioteca para trabajar con programas asincr√≥nicos y basados ‚Äã‚Äãen eventos que utilizan secuencias observables.  La biblioteca proporciona el tipo principal de <em>Observable</em> , varios tipos auxiliares ( <em>Observador, Programadores, Temas</em> ) y operadores para trabajar con eventos como con colecciones ( <em>mapa, filtro, reducci√≥n, todos</em> y similares de JavaScript Array). </p><br><p>  Veamos los conceptos b√°sicos de esta biblioteca. </p><br><h3 id="observable-observer-producer">  Observable, observador, productor </h3><br><p>  Observable es el primer tipo b√°sico que veremos.  Esta clase contiene la mayor parte de la implementaci√≥n de RxJs.  Est√° asociado con una secuencia observable, a la que ambos pueden suscribirse utilizando el m√©todo de suscripci√≥n. </p><br><p>  Observable implementa un mecanismo auxiliar para crear actualizaciones, el denominado <em>Observador</em> .  La fuente de valores para Observer se llama <em>Producer</em> .  Puede ser una matriz, un iterador, un socket web, alg√∫n tipo de evento, etc.  Entonces podemos decir que observable es un conductor entre Productor y Observador. </p><br><p>  Observable maneja tres tipos de eventos de observador: </p><br><ul><li>  siguiente - nuevos datos </li><li>  error: un error si la secuencia termin√≥ debido a una excepci√≥n.  Este evento tambi√©n implica la finalizaci√≥n de la secuencia. </li><li>  complete - se√±al sobre la finalizaci√≥n de la secuencia.  Esto significa que no habr√° nuevos datos. </li></ul><br><p>  Veamos la demo: </p><br><p><img src="https://habrastorage.org/webt/mg/qn/pf/mgqnpfxctqlz3yqwseag1fqttrc.gif"></p><br><p>  Al principio procesaremos los valores 1, 2, 3 y despu√©s de 1 seg.  obtendremos 4 y terminaremos nuestro flujo. </p><br><div class="spoiler">  <b class="spoiler_title">Pensamientos en el o√≠do</b> <div class="spoiler_text"><p>  Y luego me di cuenta de que contar era m√°s interesante que escribir al respecto.  : D </p></div></div><br><h3 id="subscription">  Suscripci√≥n </h3><br><p>  Cuando nos suscribimos a una transmisi√≥n, creamos una nueva clase de <strong>suscripci√≥n</strong> que nos permite cancelar la <em>suscripci√≥n</em> utilizando el m√©todo de <em>cancelaci√≥n de suscripci√≥n</em> .  Tambi√©n podemos agrupar suscripciones utilizando el m√©todo <em>add</em> .  Bueno, es l√≥gico que podamos desagrupar los hilos con <em>eliminar</em> .  Los m√©todos de entrada de agregar y quitar aceptan otra suscripci√≥n.  Me gustar√≠a se√±alar que cuando nos damos de baja, nos damos de baja de todas las suscripciones secundarias como si llamaran el m√©todo para darse de baja.  Adelante </p><br><h3 id="vidy-potokov">  Tipos de corrientes </h3><br><div class="scrollable-table"><table><thead><tr><th>  CALIENTE </th><th>  FR√çO </th></tr></thead><tbody><tr><td>  Productor creado fuera de observable </td><td>  Productor creado dentro de observable </td></tr><tr><td>  Los datos se transfieren en el momento en que se crea el observable. </td><td>  Los datos se informan en el momento de la suscripci√≥n. </td></tr><tr><td>  Necesita m√°s l√≥gica para darse de baja </td><td>  El hilo termina por s√≠ solo </td></tr><tr><td>  Utiliza comunicaci√≥n uno a muchos </td><td>  Utiliza una relaci√≥n uno a uno </td></tr><tr><td>  Todas las suscripciones tienen el mismo valor. </td><td>  Las suscripciones son independientes </td></tr><tr><td>  Los datos pueden perderse si no hay suscripci√≥n </td><td>  Vuelve a emitir todos los valores de transmisi√≥n para una nueva suscripci√≥n </td></tr></tbody></table></div><br><p>  Para dar una analog√≠a, me imagino una transmisi√≥n en caliente como una pel√≠cula en una sala de cine.  En qu√© momento viniste, desde ese momento y comenzaste a ver.  Yo comparar√≠a una corriente fr√≠a con una llamada en esos.  apoyo  Cada persona que llama escucha el contestador autom√°tico de principio a fin, pero puede colgar sin darse de baja. </p><br><p>  Me gustar√≠a se√±alar que todav√≠a existen los llamados flujos c√°lidos (una definici√≥n que conoc√≠ muy raramente y solo en comunidades extranjeras): esta es una corriente que se transforma de una corriente fr√≠a a una caliente.  Surge la pregunta: d√≥nde usar)) Dar√© un ejemplo de la pr√°ctica. </p><br><p>  Yo trabajo con un angular.  √âl usa activamente rxjs.  Para llevar datos al servidor, espero una transmisi√≥n en fr√≠o y la uso en la plantilla usando asyncPipe.  Si uso esta tuber√≠a varias veces, luego, volviendo a la definici√≥n de una transmisi√≥n en fr√≠o, cada tuber√≠a solicitar√° datos del servidor, lo cual es extra√±o por decir lo menos.  Y si convierto una corriente fr√≠a en una c√°lida, la solicitud suceder√° una vez. </p><br><p>  En general, comprender la forma de los flujos es bastante complicado para los principiantes, pero importante. </p><br><h3 id="operators">  Operadores </h3><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.http.get(<span class="hljs-string"><span class="hljs-string">`</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${environment.apiUrl}</span></span></span><span class="hljs-string">/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${</span></span><span class="hljs-keyword"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.apiUrl}</span></span></span><span class="hljs-string">/trade_companies`</span></span>) .pipe( tap(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ data }: TradeCompanyList</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.companies$$.next(cloneDeep(data))), map(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ data }: TradeCompanyList</span></span></span><span class="hljs-function">) =&gt;</span></span> data) );</code> </pre> <br><p>  Los operadores nos brindan la capacidad de trabajar con transmisiones.  Ayudan a controlar los eventos que ocurren en el Observable.  Consideraremos algunos de los m√°s populares, y los operadores se pueden encontrar con m√°s detalle utilizando los enlaces en la informaci√≥n √∫til. </p><br><p>  <strong>Operadores - de</strong> </p><br><p>  Comenzamos con el operador auxiliar de.  Crea un Observable basado en un valor simple. </p><br><p><img src="https://habrastorage.org/webt/ty/gv/ns/tygvns2-ufljiud304keflcihtw.png"></p><br><p>  <strong>Operadores - filtro</strong> </p><br><p><img src="https://habrastorage.org/webt/lu/ej/-q/luej-qu433z2ascmvk4avc9qg80.png"></p><br><p>  El filtro operador de filtro, como su nombre lo indica, filtra la se√±al de flujo.  Si el operador devuelve verdadero, salta a√∫n m√°s. </p><br><p>  <strong>Operadores - tomar</strong> </p><br><p><img src="https://habrastorage.org/webt/n3/h-/p7/n3h-p7dnsmlrus2qxcid1k-j0sc.png"></p><br><p>  take: toma el valor del n√∫mero de emisiones, despu√©s de lo cual finaliza la secuencia. </p><br><p>  <strong>Operadores - debounceTime</strong> </p><br><p><img src="https://habrastorage.org/webt/fm/-h/ov/fm-hovzqqm8setakpkxrq35220i.png"></p><br><p>  debounceTime: descarta los valores emitidos que caen dentro del per√≠odo de tiempo especificado entre los datos de salida, despu√©s del lapso del intervalo de tiempo que emite el √∫ltimo valor. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { Observable } = Rx; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { debounceTime, take } = RxOperators; Observable.create(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">observer</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; observer.next(i++); <span class="hljs-comment"><span class="hljs-comment">//     1000 setInterval(() =&gt; { observer.next(i++) }, 1000); //     1500 setInterval(() =&gt; { observer.next(i++) }, 1500); }).pipe( debounceTime(700), //  700     take(3) );</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/wq/c4/is/wqc4is_4memtbjbseivewpqsm3y.gif"></p><br><p>  <strong>Operadores - takeWhile</strong> </p><br><p><img src="https://habrastorage.org/webt/be/_4/bw/be_4bwupgcjmlqubh0bnjfwaq3o.png"></p><br><p>  Emite valores hasta que takeWhile devuelve falso, despu√©s de lo cual se dar√° de baja de la secuencia. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { Observable } = Rx; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { debounceTime, takeWhile } = RxOperators; Observable.create(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">observer</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; observer.next(i++); <span class="hljs-comment"><span class="hljs-comment">//     1000 setInterval(() =&gt; { observer.next(i++) }, 1000); }).pipe( takeWhile( producer =&gt; producer &lt; 5 ) );</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/fj/yx/ht/fjyxhtlst2zizvmv6uoei5vi_bm.gif"></p><br><p>  <strong>Operadores - combineLatest</strong> </p><br><p>  El operador combine combineLatest es algo similar a promise.all.  Combina varios hilos en uno.  Despu√©s de que cada hilo hace al menos una emisi√≥n, obtenemos los √∫ltimos valores de cada uno en forma de matriz.  Adem√°s, despu√©s de cualquier emisi√≥n de los flujos combinados, dar√° nuevos valores. </p><br><p><img src="https://habrastorage.org/webt/cg/lq/pj/cglqpjraurcow4xpusyfy-o-g1i.png"></p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { combineLatest, Observable } = Rx; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { take } = RxOperators; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> observer_1 = Observable.create(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">observer</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     1000 setInterval(() =&gt; { observer.next('a: ' + i++); }, 1000); }); const observer_2 = Observable.create((observer) =&gt; { let i = 1; //     750 setInterval(() =&gt; { observer.next('b: ' + i++); }, 750); }); combineLatest(observer_1, observer_2).pipe(take(5));</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/lx/f6/qc/lxf6qcp3uqlpezwwxzipibko8mw.gif"></p><br><p>  <strong>Operadores - zip</strong> </p><br><p>  Zip: espera un valor de cada flujo y forma una matriz basada en estos valores.  Si el valor no proviene de ninguna secuencia, el grupo no se formar√°. </p><br><p><img src="https://habrastorage.org/webt/_w/uw/u5/_wuwu5ncu3ikb96iszphaeho1cu.png"></p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { zip, Observable } = Rx; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { take } = RxOperators; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> observer_1 = Observable.create(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">observer</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     1000 setInterval(() =&gt; { observer.next('a: ' + i++); }, 1000); }); const observer_2 = Observable.create((observer) =&gt; { let i = 1; //     750 setInterval(() =&gt; { observer.next('b: ' + i++); }, 750); }); const observer_3 = Observable.create((observer) =&gt; { let i = 1; //     500 setInterval(() =&gt; { observer.next('c: ' + i++); }, 500); }); zip(observer_1, observer_2, observer_3).pipe(take(5));</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/lr/iz/k2/lrizk28md9flrpm-5nkiioxlbw0.gif"></p><br><p>  <strong>Operadores - forkJoin</strong> </p><br><p>  forkJoin tambi√©n concatena hilos, pero solo valora cuando todos los hilos est√°n completos. </p><br><p><img src="https://habrastorage.org/webt/kg/yn/i8/kgyni8bmucerz2-o015i4fnrlrg.png"></p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { forkJoin, Observable } = Rx; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { take } = RxOperators; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> observer_1 = Observable.create(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">observer</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     1000 setInterval(() =&gt; { observer.next('a: ' + i++); }, 1000); }).pipe(take(3)); const observer_2 = Observable.create((observer) =&gt; { let i = 1; //     750 setInterval(() =&gt; { observer.next('b: ' + i++); }, 750); }).pipe(take(5)); const observer_3 = Observable.create((observer) =&gt; { let i = 1; //     500 setInterval(() =&gt; { observer.next('c: ' + i++); }, 500); }).pipe(take(4)); forkJoin(observer_1, observer_2, observer_3);</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/34/ny/qn/34nyqnbve4g6gsheeoeaii1qkw0.gif"></p><br><p>  <strong>Operadores - mapa</strong> </p><br><p>  El operador de transformaci√≥n del mapa convierte el valor de emisi√≥n en uno nuevo. </p><br><p><img src="https://habrastorage.org/webt/z5/cq/gn/z5cqgnureeelbyknte8aohlkjyo.png"></p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { Observable } = Rx; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { take, map } = RxOperators; Observable.create(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">observer</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     1000 setInterval(() =&gt; { observer.next(i++); }, 1000); }).pipe( map(x =&gt; x * 10), take(3) );</span></span></code> </pre><br><p><img src="https://habrastorage.org/webt/zy/fz/az/zyfzazyep10bcow9f1nxzumq8nk.gif"></p><br><p>  <strong>Operadores: compartir, tocar</strong> </p><br><p>  El operador de toque: le permite realizar efectos secundarios, es decir, cualquier acci√≥n que no afecte la secuencia. </p><br><p>  El operador de utilidad compartida puede calentarlo desde una corriente fr√≠a. </p><br><p><img src="https://habrastorage.org/webt/2p/lc/fr/2plcfr9agwst3elkl_yglmmfftk.png"></p><br><p>  Con los operadores terminados.  Pasemos al tema. </p><br><div class="spoiler">  <b class="spoiler_title">Pensamientos en el o√≠do</b> <div class="spoiler_text"><p>  Y luego fui a tomar unas gaviotas.  Estos ejemplos me aburren: D </p></div></div><br><h2 id="semeystvo-subject-ov">  Familia sujeta </h2><br><p>  La familia de sujetos es un excelente ejemplo de corrientes calientes.  Estas clases son un tipo de h√≠brido que act√∫a simult√°neamente como observable y observador.  Dado que el asunto es una transmisi√≥n en caliente, debe cancelar su suscripci√≥n.  Si hablamos de los m√©todos b√°sicos, entonces esto: </p><br><ul><li>  siguiente: transferencia de nuevos datos a la secuencia </li><li>  error - error y terminaci√≥n de la transmisi√≥n </li><li>  complete - terminaci√≥n de la transmisi√≥n </li><li>  suscribirse - suscribirse a la transmisi√≥n </li><li>  cancelar suscripci√≥n - cancelar suscripci√≥n de la transmisi√≥n </li><li>  asObservable - transformarse en un observador </li><li>  toPromise - se transforma en una promesa </li></ul><br><p>  Asignar <del>  4 4 </del>  5 tipos de asignaturas. </p><br><div class="spoiler">  <b class="spoiler_title">Pensamientos en el o√≠do</b> <div class="spoiler_text"><p>  √âl habl√≥ en la secuencia 4, pero result√≥ que agregaron uno m√°s.  Como dice el refr√°n, vive y aprende. </p></div></div><br><p>  Asunto simple <code>new Subject()</code> es el tipo de sujeto m√°s simple.  Se crea sin par√°metros.  Pasa valores que llegaron solo despu√©s de la suscripci√≥n. </p><br><p>  BehaviorSubject <code>new BehaviorSubject( defaultData&lt;T&gt; )</code> : en mi opini√≥n, el tipo de tema m√°s com√∫n.  La entrada acepta un valor predeterminado.  Siempre guarda los datos de la √∫ltima emisi√≥n, que transfiere durante la suscripci√≥n.  Esta clase tambi√©n tiene un m√©todo de valor √∫til que devuelve el valor actual de la secuencia. </p><br><p>  ReplaySubject <code>new ReplaySubject(bufferSize?: number, windowTime?: number)</code> : la entrada puede aceptar opcionalmente el primer argumento como el tama√±o del b√∫fer de valores que almacenar√° en s√≠ mismo, y la segunda vez durante la cual necesitamos cambios. </p><br><p>  AsyncSubject <code>new AsyncSubject()</code> : no ocurre nada al suscribirse y el valor se devolver√° solo cuando se complete.  Solo se devolver√° el √∫ltimo valor de transmisi√≥n. </p><br><p>  WebSocketSubject <code>new WebSocketSubject(urlConfigOrSource: string | WebSocketSubjectConfig&lt;T&gt; | Observable&lt;T&gt;, destination?: Observer&lt;T&gt;)</code> - La documentaci√≥n no dice nada al respecto y la veo por primera vez.  Qui√©n sabe lo que est√° haciendo, escribe, complementa. </p><br><p>  Fuf  Bueno, aqu√≠ hemos considerado todo lo que quer√≠a contar hoy.  Espero que esta informaci√≥n haya sido √∫til.  Puede familiarizarse con la lista de referencias en la pesta√±a de informaci√≥n √∫til. </p><br><h2 id="poleznaya-informaciya">  Informacion util </h2><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Enlace de transmisi√≥n</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo funciona JS: descripci√≥n general del motor, mecanismos de tiempo de ejecuci√≥n, pila de llamadas</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo funciona JS: bucle de eventos, as√≠ncrono y cinco formas de mejorar el c√≥digo mediante as√≠ncrono / espera</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo funciona Event Loop en JavaSript</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Evoluci√≥n asincr√≥nica de JavaScript</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">¬øQu√© es RxJS y por qu√© es √∫til saberlo?</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><br></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Aplicaci√≥n pr√°ctica de RxJS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Tutorial de observables de RxJS: creaci√≥n y suscripci√≥n a observables</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">RXJS: observables fr√≠os y calientes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Clases, funciones para crear un Observable.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Operadores</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Operadores RxJS por ejemplo</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Lista de API</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Variedades de asignaturas y horarios en RxJS</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/462355/">https://habr.com/ru/post/462355/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../462337/index.html">Estad√≠sticas del sitio y tu peque√±o repositorio</a></li>
<li><a href="../462339/index.html">¬øC√≥mo se relaciona la capacitaci√≥n manual con los est√°ndares internos de Amazon y c√≥mo ha impactado la visi√≥n del mundo de la compa√±√≠a?</a></li>
<li><a href="../462347/index.html">Los primeros diez d√≠as en el camino de un b√∫ho a un madrugador: sue√±o, dieta, dieta y ejercicio</a></li>
<li><a href="../462349/index.html">RESTinio es un servidor HTTP as√≠ncrono. Un ejemplo simple de la pr√°ctica: devolver una gran cantidad de datos en respuesta</a></li>
<li><a href="../462353/index.html">Preguntas frecuentes sobre la seguridad del protocolo LoRaWAN</a></li>
<li><a href="../462357/index.html">Primer prototipo: Unikernels como etapa en la evoluci√≥n de Linux</a></li>
<li><a href="../462359/index.html">Dat: qu√© protocolo es y qui√©n lo usa</a></li>
<li><a href="../462365/index.html">Limitaciones de aprendizaje autom√°tico</a></li>
<li><a href="../462367/index.html">13 datos sobre capitalismo de riesgo para fundadores</a></li>
<li><a href="../462371/index.html">Comience Spring StateMachine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>