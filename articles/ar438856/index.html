<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤸🏼 👨‍👧‍👧 🐠 تبلد من الحياة 🤲 ⛹🏾 💧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="يوم جيد. 


 هل لديك أيضًا مطور تفاعل مألوف يروي قصصًا مذهلة حول الآثار الجانبية في عملية الإعادة؟ لا؟ هل يمكن ان اصبح هذا الشخص 





 اتخذ المؤلف حر...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>تبلد من الحياة</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438856/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  يوم جيد. </p><br><p style=";text-align:right;direction:rtl">  هل لديك أيضًا مطور تفاعل مألوف يروي قصصًا مذهلة حول الآثار الجانبية في عملية الإعادة؟  لا؟  هل يمكن ان اصبح هذا الشخص </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/7-/lj/cq/7-ljcqfw11ms3jciroq6ls9ekfw.jpeg"></p><br><p style=";text-align:right;direction:rtl">  <em>اتخذ المؤلف حريته في عدم كتابة جزء تمهيدي حول ما تدور حوله مكتبة الملحمة المسترجعة.</em>  <em>إنه يأمل أنه في حالة عدم كفاية البيانات ، فإن القارئ الكريم يستخدم بحث هبر أو <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">البرنامج التعليمي الرسمي</a> .</em>  <em>هذه الأمثلة مبسطة إلى حد كبير لنقل الجوهر.</em> </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  لذلك ، لماذا وضعت لكم جميعا معا.  سيكون حول استخدام الملحمة المعادة في المساحات المفتوحة للعملاء القتالية.  بشكل أكثر تحديدًا ، حول الحالات الأكثر تعقيدًا وإثارة للاهتمام من "قبول الإجراء =&gt; إرسال طلب API =&gt; إنشاء إجراء جديد". </p><br><p style=";text-align:right;direction:rtl">  آمل في تحفيز دراسة أعمق لهذه المكتبة من قبل زملائي المواطنين ، وكذلك المشاركة في سرور كيف تصبح الأشياء غير المتزامنة المعقدة أكثر قابلية للفهم والتعبير. </p><br><h2 id="websockets" style=";text-align:right;direction:rtl">  Websockets </h2><br><p style=";text-align:right;direction:rtl"> <em>استخدام الحالة: تلقي تحديثات لقائمة الشواغر المتاحة من الخادم في الوقت الحقيقي باستخدام نموذج الدفع.</em> </p><br><p style=";text-align:right;direction:rtl">  إنه بطبيعة الحال يتعلق باستخدام مآخذ الويب.  على سبيل المثال ، خذ socket.io ، ولكن في الواقع ، لا يهم واجهة برمجة تطبيقات مأخذ التوصيل هنا. </p><br><p style=";text-align:right;direction:rtl">  في sagas هناك شيء مثل القناة.  هذا ناقل رسائل يمكن من خلاله لمصدر الأحداث التواصل مع مستهلكيه.  الغرض الرئيسي من القنوات هو التواصل بين sagas وتحويل دفق الأحداث غير المتزامنة إلى هيكل مناسب للعمل. </p><br><p style=";text-align:right;direction:rtl">  بشكل افتراضي ، يعد المتجر هو قناة الأحداث الرئيسية لردع الملحمة.  الأحداث تأتي في شكل عمل.  تستخدم القنوات للعمل مع الأحداث وليس من المتجر. </p><br><p style=";text-align:right;direction:rtl">  اتضح أن القناة هي فقط ما تحتاجه للعمل مع الدفق غير المتزامن للرسائل من المقبس.  لنقم بإنشاء القناة في أسرع وقت ممكن! </p><br><p style=";text-align:right;direction:rtl">  لكن أولاً ، قم بإنشاء مأخذ توصيل: </p><br><pre style=";text-align:right;direction:rtl"><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'socket.io-client'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> socket = io.connect(<span class="hljs-string"><span class="hljs-string">'/'</span></span>);</code> </pre> <br><p style=";text-align:right;direction:rtl">  أعلن الآن قائمة متواضعة من الأحداث: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> SocketEvents = { <span class="hljs-attr"><span class="hljs-attr">jobsFresh</span></span>: <span class="hljs-string"><span class="hljs-string">'jobs+fresh'</span></span>, };</code> </pre> <br><p style=";text-align:right;direction:rtl">  التالي هو طريقة المصنع لإنشاء قناة.  تنشئ الشفرة طريقة للاشتراك في الأحداث التي تهمنا من خلال المقبس ، وطريقة لإلغاء الاشتراك ، وقناة الحدث نفسها مباشرةً: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { eventChannel } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { socket } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../apis/socket'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { SocketEvents } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../constants/socket-events'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createFreshJobsChannel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> subscribe = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">emitter</span></span></span><span class="hljs-function"> =&gt;</span></span> { socket.on(SocketEvents.jobsFresh, emitter); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> socket.removeListener(SocketEvents.jobsFresh, emitter); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> eventChannel(subscribe); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  دعنا نكتب قصة بسيطة إلى حد ما ، في انتظار التحديثات من المقبس وتحويلها إلى الإجراء المقابل: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { take, call, put } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga/effects'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createFreshJobsChannel } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../channels/fresh-jobs'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { JobsActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/jobs'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">freshJobsSaga</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> channel = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> call(createFreshJobsChannel); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> jobs = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> take(channel); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> action = JobsActions.fresh(jobs); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> put(action); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  يبقى فقط ربطه بسجل الجذر: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { fork } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga/effects'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { freshJobsSaga } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./fresh-jobs'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sagas</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> fork(freshJobsSaga); }</code> </pre> <br><h2 id="google-places-autocomplete" style=";text-align:right;direction:rtl">  أماكن جوجل الإكمال التلقائي </h2><br><p style=";text-align:right;direction:rtl">  <em>استخدام الحالة: إظهار النصائح عندما يدخل المستخدم موقعًا جغرافيًا للبحث اللاحق عن العقارات القريبة.</em> </p><br><p style=";text-align:right;direction:rtl">  في الواقع ، نحن بحاجة إلى الإحداثيات ، ويحتاج المستخدم إلى الاسم القابل للقراءة في المجال المطلوب. </p><br><p style=";text-align:right;direction:rtl">  يبدو أن هذه المهمة تختلف عن الإجراء الممل "action =&gt; API =&gt;"؟  في حالة الإكمال التلقائي ، نريد إجراء أقل عدد ممكن من المكالمات غير المجدية إلى الموارد الخارجية ، وإظهار التلميحات ذات الصلة للمستخدم فقط. </p><br><p style=";text-align:right;direction:rtl">  أولاً ، سنكتب طريقة API تستخدم خدمة الإكمال التلقائي لأماكن Google.  من الأشياء المثيرة للاهتمام هنا هو الحد من المطالبات داخل بلد معين: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPlaceSuggestions</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">autocompleteService, countryCode, query</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { autocompleteService.getPlacePredictions({ <span class="hljs-attr"><span class="hljs-attr">componentRestrictions</span></span>: { <span class="hljs-attr"><span class="hljs-attr">country</span></span>: countryCode }, <span class="hljs-attr"><span class="hljs-attr">input</span></span>: query, }, resolve); }); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  هناك طريقة API سنقوم بسحبها ، يمكنك البدء في كتابة ملحمة.  حان الوقت لتوضيح لطلبات عديمة الفائدة. </p><br><p style=";text-align:right;direction:rtl">  التنفيذ في الجبهة ، عندما يكتب المستخدم ، ونحن لكل تغيير ، نقرأ - لكل حرف ، إرسال طلب إلى API - يؤدي إلى أي مكان.  أثناء قيام المستخدم بالكتابة ، لا يحتاج إلى تلميحات.  ولكن عندما يتوقف ، حان الوقت لخدمته. </p><br><p style=";text-align:right;direction:rtl">  أيضًا ، لا نريد أن نكون في موقف حيث قام المستخدم بكتابة شيء ما ، أو إيقافه ، أو تم إنهاء طلب واجهة برمجة التطبيقات ، أو كتابة المستخدم لشيء ما ، أو طلب طلب آخر. </p><br><p style=";text-align:right;direction:rtl">  وبالتالي ، أنشأنا سباقًا بين طلبين.  يمكن أن تتطور الأحداث بطريقتين وكلاهما غير ممتع للغاية. </p><br><p style=";text-align:right;direction:rtl">  على سبيل المثال ، سينتهي الطلب غير ذي صلة قبل الطلب الحالي ولحظة سيرى المستخدم مطالبات غير ذات صلة.  غير سارة ، ولكن ليست حرجة. </p><br><p style=";text-align:right;direction:rtl">  أو ، ينتهي الطلب الحالي في وقت أبكر من الطلب غير ذي صلة وبعد وميض المستخدم سيبقى بنفس مطالبات غير ذات صلة.  هذا أمر بالغ الأهمية بالفعل. </p><br><p style=";text-align:right;direction:rtl">  بالطبع ، لسنا أول من يواجه مثل هذه المشكلة ، وستساعدنا التقنية المعروفة باسم debounce - تنفيذ المهمة فقط بعد استلام وحدات N من الوقت منذ استلام الحدث الأخير.  هنا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">القليل من المواد</a> حول هذا الموضوع. </p><br><p style=";text-align:right;direction:rtl">  في الإعادة الملحمة ، يتم تطبيق هذه التقنية باستخدام اثنين من الآثار - <em>التأخير</em> و <em>takeLatest</em> .  أول واحد يؤجل تنفيذ الملحمة من قبل عدد محدد من المللي ثانية.  الثاني إنهاء تنفيذ ملحمة العمل بالفعل عند وصول حدث جديد. </p><br><p style=";text-align:right;direction:rtl">  مع العلم كل هذا ، سنكتب الملحمة: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { delay } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { put, call, select } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga/effects'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PlaceActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/place'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { MapsActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/maps'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { getPlaceSuggestions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../api/get-place-suggestions'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">placeSuggestionsSaga</span></span></span><span class="hljs-function"> * (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ payload: query }</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-attr"><span class="hljs-attr">maps</span></span>: { isApiLoaded } } = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> select(); <span class="hljs-comment"><span class="hljs-comment">//  API    , //      if (!isApiLoaded) { yield take(MapsActions.apiLoaded); } //     Google Places Autocomplete  store const { maps: { autocompleteService }, countryCode } = yield select(); //    , //        if (query) { yield put(PlaceActions.suggestions([])); yield put(PlaceActions.select(null)); return; } //  250    yield call(delay, 250); //  API  const suggestions = yield call( getPlaceSuggestions, autocompleteService, countryCode, query, ); //  action   const action = PlacesActions.suggestions(suggestions || []); //     store yield put(action); };</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  كما في المثال السابق ، يبقى فقط ربطه بقصة الجذر: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { takeLatest } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga/effects'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { PlaceActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/place'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { placeSuggestionsSaga } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./place-suggestions'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sagas</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> takeLatest( PlaceActions.changeQuery, placeSuggestionsSaga, ); }</code> </pre> <br><h2 id="dropdowns-closer" style=";text-align:right;direction:rtl">  المنسدلة أقرب </h2><br><p style=";text-align:right;direction:rtl">  <em>استخدم الحالة: أغلق القوائم المنسدلة مكتوبة ذاتيًا عند النقر خارج منطقة التحكم.</em> </p><br><p style=";text-align:right;direction:rtl">  في الواقع ، هذا هو محاكاة للسلوك المدمج في المتصفح المحدد.  سيتم ترك الأسباب التي قد تحتاج إلى قائمة منسدلة مكتوبة على divs لخيال القارئ. </p><br><p style=";text-align:right;direction:rtl">  تتمثل الميزة الرئيسية للمهمة التي يتم حلها في تمرير حدث خارج عنصر التحكم ، على سبيل المثال ، عند النقر خارج القائمة. </p><br><p style=";text-align:right;direction:rtl">  خمنت؟  نعم ، سوف تساعدنا القنوات أيضًا هنا.  باستخدامها ، سنحول أحداث النقرات التي تنبثق إلى الأعلى في الإجراء المقابل. </p><br><p style=";text-align:right;direction:rtl">  سيكون من الجميل أن يكون لديك طريقة مصنع تنشئ قنوات لحدث نافذة تعسفي.  وهنا هو: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { eventChannel } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createWindowEventChannel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">eventName</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> subscribe = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">emitter</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.addEventListener(eventName, emitter); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.removeEventListener(eventName, emitter); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> eventChannel(subscribe); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  نقوم بإنشاء ملحمة مشابهة تمامًا للمثال الأول (يمكنك إنشاء طريقة مصنع لها إذا كنت ترغب في ذلك): </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { take, put, call } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga/effects'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createWindowEventChannel } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../channels/window-event'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { DropdownActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/dropdown'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">closeDropdownsSaga</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> channel = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> call(createWindowEventChannel, <span class="hljs-string"><span class="hljs-string">'onClick'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> event = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> take(channel); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> action = DropdownActions.closeAll(event); <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> put(action(event)); } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  المخفضون المهتمون سيضعون السيطرة في حالة مغلقة: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { handleActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-actions'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { DropdownActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/dropdown'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> priceReducer = handleActions({ ..., [DropdownActions.closeAll]: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">state</span></span></span><span class="hljs-function"> =&gt;</span></span> ({ ...state, <span class="hljs-attr"><span class="hljs-attr">isOpen</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}), }, {});</code> </pre> <br><p style=";text-align:right;direction:rtl">  يجب أن تتوقف القائمة المنسدلة نفسها عن نشر حدث النقر على أي أجزاء داخلية وأن ترسل الحدث الختامي إلى المتجر بمفرده.  على سبيل المثال ، عند النقر فوق "فتح": </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// components/dropdown.js import React from 'react'; export class Dropdown extends React.Component { ... __open(event) { event.stopPropagation(); this.props.open(); } } // dispatchers/open-price-dropdown.js import { DropdownActions } from '../actions/dropdown'; import { PriceActions } from '../actions/price'; export const openPriceDropdownDispatcher = dispatch =&gt; () =&gt; { dispatch( DropdownActions.closeAll() ); dispatch( PriceActions.open() ); };</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  خلاف ذلك ، فإن القائمة ببساطة لن تفتح.  الأمر نفسه ينطبق على نقرة عند تحديد خيار. </p><br><p style=";text-align:right;direction:rtl">  كلاسيكو ، جبل الملحمة: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { fork } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga/effects'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { closeDropdownsSaga } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./close-dropdowns'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sagas</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> fork(closeDropdownsSaga); }</code> </pre> <br><h2 id="notifications" style=";text-align:right;direction:rtl">  الإخطارات </h2><br><p style=";text-align:right;direction:rtl">  <em>استخدام الحالة: إظهار إعلامات المتصفح حول توفر الوظائف الشاغرة الجديدة ، إذا كانت علامة التبويب في الخلفية.</em> </p><br><p style=";text-align:right;direction:rtl">  في علامة التبويب النشطة ، سيرى المستخدم التغيير في عنصر تحكم خاص ، وبالتالي فإن الإخطارات ليست مناسبة.  ولكن لعلامة التبويب الخلفية في متناول يدي.  بالطبع ، بإذن من المستخدم! </p><br><p style=";text-align:right;direction:rtl">  أود أيضًا النقر فوق الإشعار للانتقال إلى علامة التبويب وإظهار الشواغر الجديدة.  إذا لم يستجب المستخدم ، فأغلق الإشعار.  للقيام بذلك ، نحن بحاجة إلى تأثير آخر مفيد - <em>العرق</em> .  انها تسمح لك لترتيب سباق بين العديد من الآثار الأخرى.  في معظم الحالات ، يستخدم السباق لتوفير مهلة لبعض العمليات. </p><br><p style=";text-align:right;direction:rtl">  لقد أغفلنا رمز تتبع نشاط علامة التبويب ، نظرًا للهوية التي بها رمز اعتراض النقرات من المثال السابق. </p><br><p style=";text-align:right;direction:rtl">  سنكتب طريقة المصنع التي ستنشئ قناة لطلب موافقة المستخدم لتلقي الإخطارات: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { eventChannel, END } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createRequestNotificationPermissionChannel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> subscribe = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">emitter</span></span></span><span class="hljs-function"> =&gt;</span></span> { Notification.requestPermission(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">permission</span></span></span><span class="hljs-function"> =&gt;</span></span> { emitter(permission); emitter(END); }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> {}; }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> eventChannel(subscribe); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  سعياً وراء أسلوب مصنع آخر ، ولكن مع قناة لتلقي إشعار ، انقر فوق: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { eventChannel, END } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNotificationClickChannel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">notification</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> subscribe = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">emitter</span></span></span><span class="hljs-function"> =&gt;</span></span> { notification.onclick = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function"> =&gt;</span></span> { emitter(event); emitter(END); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> notification.onclick = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> eventChannel(subscribe); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  كلتا القناتين تستخدمان مرة واحدة وأقصى تبادل لإطلاق النار في حدث واحد ، وبعد ذلك يتم إغلاقهما. </p><br><p style=";text-align:right;direction:rtl">  يبقى المفتاح - الملحمة مع المنطق.  تحقق مما إذا كانت علامة التبويب نشطة ، اطلب الإذن ، وقم بإنشاء إشعار ، وانتظر نقرة أو مهلة ، وأظهر الشواغر الجديدة ، وجعل علامة التبويب نشطة ، ثم أغلق الإشعار: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { delay } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { call, select, race, take } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga/effects'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createRequestNotificationPermissionChannel } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../channels/request-notification-permission'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createNotificationClickChannel } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../channels/notification-click'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { JobsActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/jobs'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">notificationsSaga</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">action</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { inFocus } = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> select(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inFocus) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> permissionChannel = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> call(createRequestNotificationPermissionChannel); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> permission = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> take(permissionChannel); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (permission !== <span class="hljs-string"><span class="hljs-string">'granted'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> notification = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Notification( <span class="hljs-string"><span class="hljs-string">`You have </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${action.payload.jobs.length}</span></span></span><span class="hljs-string"> new job posts`</span></span>, { <span class="hljs-attr"><span class="hljs-attr">icon</span></span>: <span class="hljs-string"><span class="hljs-string">'assets/new-jobs.png'</span></span> } ); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> clickChannel = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> call(createNotificationClickChannel, notification); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { click, timeout } = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> race({ <span class="hljs-attr"><span class="hljs-attr">click</span></span>: take(clickChannel), <span class="hljs-attr"><span class="hljs-attr">timeout</span></span>: call(delay, <span class="hljs-number"><span class="hljs-number">5000</span></span>), }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (click) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> put(JobsActions.show()); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.focus(); <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.scrollTo(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } notification.close(); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  قم بتركيب الملحمة قبل القيام بهذا الكشف عن الميزات: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { takeEvery } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga/effects'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { JobsActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/jobs'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { notificationsSaga } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./notifications'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sagas</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( <span class="hljs-string"><span class="hljs-string">'Notification'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-built_in"><span class="hljs-built_in">window</span></span> &amp;&amp; Notification.permission !== <span class="hljs-string"><span class="hljs-string">'denied'</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> takeEvery(JobsActions.fresh, notificationsSaga); } }</code> </pre> <br><h2 id="global-event-bus" style=";text-align:right;direction:rtl">  الحافلة الحدث العالمي </h2><br><p style=";text-align:right;direction:rtl">  <em>حالة الاستخدام: نقل فئة الأحداث المحددة بين مخازن الإعادة.</em> </p><br><p style=";text-align:right;direction:rtl">  مثل هذا الناقل ضروري في حالة وجود العديد من التطبيقات التي تحتوي على بيانات شائعة على الصفحة.  في الوقت نفسه ، يمكن تنفيذ التطبيقات بشكل مستقل عن بعضها البعض. </p><br><p style=";text-align:right;direction:rtl">  على سبيل المثال ، سلسلة البحث ذات الفلاتر ونتائج البحث كتطبيقات تفاعل منفصلة.  عند تغيير المرشحات ، أريد أن يعرف تطبيق النتائج ما إذا كان موجودًا على الصفحة أيضًا. </p><br><p style=";text-align:right;direction:rtl">  نستخدم باعث الحدث القياسي: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> EventEmmiter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'events'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.GlobalEventBus) { <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.GlobalEventBus = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> EventEmmiter(); } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> globalEventBus = <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.GlobalEventBus;</code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>الحدث</em> المحبوب بالفعل <em>ChanChannel</em> يحول باعث قياسي إلى قناة: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { eventChannel } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { globalEventBus <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> bus } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../utils/global-event-bus'</span></span>; exports <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createGlobalEventBusChannel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> subscribe = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">emitter</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> handler = <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">event</span></span></span><span class="hljs-function"> =&gt;</span></span> emitter({ ...event, <span class="hljs-attr"><span class="hljs-attr">external</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }); bus.on(<span class="hljs-string"><span class="hljs-string">'global.event'</span></span>, handler); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> bus.removeListener(<span class="hljs-string"><span class="hljs-string">'global.event'</span></span>, handler); }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> eventChannel(subscribe); }</code> </pre> <br><p style=";text-align:right;direction:rtl">  الملحمة بسيطة جدًا - فنحن ننشئ قناة ونقبل الأحداث بلا نهاية ، سواء داخلية أو خارجية.  إذا تلقينا حدثًا داخليًا ، فأرسله إلى الحافلة ، إذا كان الحدث الخارجي - في المتجر: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { take, put, race, call } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga/effects'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { globalEventBus <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> bus } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../utils/global-event-bus'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { createGlobalEventBusChannel } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../channels/global-event-bus'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">globalEventBusSaga</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">allowedActions</span></span></span><span class="hljs-function">) </span></span>{ allowedActions = allowedActions.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function"> =&gt;</span></span> x.toString()); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> channel = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> call(createGlobalEventBusChannel); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { local, external } = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> race({ <span class="hljs-attr"><span class="hljs-attr">local</span></span>: take(), <span class="hljs-attr"><span class="hljs-attr">external</span></span>: take(channel), }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( external &amp;&amp; allowedActions.some(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">action</span></span></span><span class="hljs-function"> =&gt;</span></span> action === external.type) ) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> put(external); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( local &amp;&amp; !local.external &amp;&amp; allowedActions.some(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">action</span></span></span><span class="hljs-function"> =&gt;</span></span> action === local.type) ) { bus.emit(<span class="hljs-string"><span class="hljs-string">'global.event'</span></span>, local); } } };</code> </pre> <br><p style=";text-align:right;direction:rtl">  والأخير - تصاعد الملحمة مع الأحداث الضرورية: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { fork } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'redux-saga/effects'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { globalEventBusSaga } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./global-event-bus'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { DropdownsActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/dropdowns'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { AreasActions } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../actions/areas'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sagas</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> fork(globalEventBusSaga, [ DropdownsActions.closeAll, AreasActions.add, AreasActions.remove, ... ]); }</code> </pre> <br><hr><br><p style=";text-align:right;direction:rtl">  آمل أن أكون قادرًا على إظهار أن الساجا تجعل وصف الآثار الجانبية المعقدة أسهل.  استكشف واجهات برمجة التطبيقات الخاصة بالمكتبات ، وقم بنقلها إلى حالاتك ، وقم بتكوين أنماط معقدة من توقع الحدث وكن سعيدًا.  نراكم في المساحات المفتوحة JS! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar438856/">https://habr.com/ru/post/ar438856/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar438840/index.html">الكبرياء والعاطفة ، قصة تحويل الحلم إلى مشروع فضاء</a></li>
<li><a href="../ar438842/index.html">قم بتنظيم قائمة تشغيل torrent-TV (Super Wash)</a></li>
<li><a href="../ar438850/index.html">موسكو JS 44 - الإعلان</a></li>
<li><a href="../ar438852/index.html">بوابات جي إس إم جديدة من OpenVox</a></li>
<li><a href="../ar438854/index.html">شرح الطبيعة الفيزيائية لظاهرة "قوة الرفع" دون استخدام معادلة برنولي</a></li>
<li><a href="../ar438858/index.html">كيفية استخدام التجزئة والاستهداف وتحديد المواقع (STP) في تطوير استراتيجية التسويق</a></li>
<li><a href="../ar438862/index.html">نشر تطبيق الويب isomorphic باستخدام Nuxt.js كمثال.</a></li>
<li><a href="../ar438864/index.html">ميزة تجميد C ++ 20. Coroutines ، وحدات وأكثر من ذلك</a></li>
<li><a href="../ar438866/index.html">بناة مقابل بناء جملة جافا</a></li>
<li><a href="../ar438868/index.html">أسبوع الأمان 06: مباشر على FaceTime</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>