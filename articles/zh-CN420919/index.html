<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ½â€âœˆï¸ â™‚ï¸ ğŸ¤¸ğŸ» Androidä¸Šçš„åŠ¨ç”»æ•°å­— ğŸšµğŸ¾ ğŸ¤µğŸ¾ ğŸˆ´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç¾è§‚ä¸”æœ‰å¸å¼•åŠ›çš„ç”¨æˆ·ç•Œé¢éå¸¸é‡è¦ã€‚ å› æ­¤ï¼Œå¯¹äºAndroidæ¥è¯´ï¼Œæœ‰å¤§é‡çš„åº“å¯ä»¥æ¼‚äº®åœ°æ˜¾ç¤ºè®¾è®¡å…ƒç´ ã€‚ é€šå¸¸åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œæ‚¨éœ€è¦æ˜¾ç¤ºå¸¦æœ‰æ•°å­—æˆ–æŸç§è®¡æ•°å™¨çš„å­—æ®µã€‚ ä¾‹å¦‚ï¼Œä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºé€‰æ‹©åˆ—è¡¨é¡¹çš„æ•°é‡æˆ–ä¸€ä¸ªæœˆçš„æ”¯å‡ºé¢ã€‚ å½“ç„¶ï¼Œå€ŸåŠ©å¸¸è§„TextViewå¯ä»¥è½»æ¾è§£å†³æ­¤ç±»ä»»åŠ¡ï¼Œä½†æ˜¯æ‚¨å¯ä»¥ä¼˜é›…åœ°è§£å†³å®ƒï¼Œå¹¶æ·»åŠ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Androidä¸Šçš„åŠ¨ç”»æ•°å­—</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420919/"><p>ç¾è§‚ä¸”æœ‰å¸å¼•åŠ›çš„ç”¨æˆ·ç•Œé¢éå¸¸é‡è¦ã€‚ å› æ­¤ï¼Œå¯¹äºAndroidæ¥è¯´ï¼Œæœ‰å¤§é‡çš„åº“å¯ä»¥æ¼‚äº®åœ°æ˜¾ç¤ºè®¾è®¡å…ƒç´ ã€‚ é€šå¸¸åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œæ‚¨éœ€è¦æ˜¾ç¤ºå¸¦æœ‰æ•°å­—æˆ–æŸç§è®¡æ•°å™¨çš„å­—æ®µã€‚ ä¾‹å¦‚ï¼Œä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºé€‰æ‹©åˆ—è¡¨é¡¹çš„æ•°é‡æˆ–ä¸€ä¸ªæœˆçš„æ”¯å‡ºé¢ã€‚ å½“ç„¶ï¼Œå€ŸåŠ©å¸¸è§„<code>TextView</code>å¯ä»¥è½»æ¾è§£å†³æ­¤ç±»ä»»åŠ¡ï¼Œä½†æ˜¯æ‚¨å¯ä»¥ä¼˜é›…åœ°è§£å†³å®ƒï¼Œå¹¶æ·»åŠ æ›´æ”¹æ•°å­—çš„åŠ¨ç”»ï¼š </p><br><p><img src="https://habrastorage.org/webt/ma/qy/zn/maqyznzolbevahrngecio-p3g0a.gif" alt="æ¼”ç¤º"></p><br><p>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¼”ç¤º</a></strong>è§†é¢‘å¯åœ¨YouTubeä¸Šè·å¾—ã€‚ </p><br><p> æœ¬æ–‡å°†è®¨è®ºå¦‚ä½•å®ç°æ‰€æœ‰è¿™ä¸€åˆ‡ã€‚ </p><a name="habracut"></a><br><h2 id="odna-staticheskaya-cifra"> ä¸€ä¸ªé™æ€æ•°å­— </h2><br><p> å¯¹äºæ¯ä¸ªæ•°å­—ï¼Œéƒ½æœ‰ä¸€ä¸ªçŸ¢é‡å›¾åƒï¼Œä¾‹å¦‚ï¼Œå¯¹äº8ï¼Œå®ƒæ˜¯<code>res/drawable/viv_vd_pathmorph_digits_eight.xml</code> ï¼š </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vector</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/viv_digit_size"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/viv_digit_size"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:viewportHeight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:viewportWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">group</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:translateX</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/viv_digit_translateX"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:translateY</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/viv_digit_translateY"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">path</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"iconPath"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:pathData</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/viv_path_eight"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:strokeColor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@color/viv_digit_color_default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:strokeWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@dimen/viv_digit_strokewidth"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">group</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">vector</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> é™¤äº†æ•°å­—0-9å¤–ï¼Œè¿˜éœ€è¦è´Ÿå·å›¾åƒï¼ˆ <code>viv_vd_pathmorph_digits_minus.xml</code> ï¼‰å’Œç©ºç™½å›¾åƒï¼ˆ <code>viv_vd_pathmorph_digits_nth.xml</code> ï¼‰ï¼Œå®ƒä»¬å°†åœ¨åŠ¨ç”»è¿‡ç¨‹ä¸­è±¡å¾æ•°å­—çš„æ¶ˆå¤±ã€‚ <br>  XMLå›¾åƒæ–‡ä»¶ä»…åœ¨<code>android:pathData</code>æœ‰æ‰€ä¸åŒã€‚ ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œé€šè¿‡å•ç‹¬çš„èµ„æºè®¾ç½®äº†æ‰€æœ‰å…¶ä»–å±æ€§ï¼Œå¹¶ä¸”æ‰€æœ‰çŸ¢é‡å›¾åƒçš„å±æ€§éƒ½ç›¸åŒã€‚ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a>æ‹æ‘„çš„æ•°å­—ä¸º0-9ã€‚ </p><br><h2 id="animaciya-perehoda"> è¿‡æ¸¡åŠ¨ç”» </h2><br><p> æ‰€æè¿°çš„çŸ¢é‡å›¾åƒæ˜¯é™æ€å›¾åƒã€‚ å¯¹äºåŠ¨ç”»ï¼Œæ‚¨éœ€è¦æ·»åŠ åŠ¨ç”»çŸ¢é‡å›¾åƒï¼ˆ <code>&lt;animated-vector&gt;</code> ï¼‰ã€‚ ä¾‹å¦‚ï¼Œè¦ä¸ºæ•°å­—2è®¾ç½®åŠ¨ç”»ï¼Œè¯·å°†æ–‡ä»¶<code>res/drawable/viv_avd_pathmorph_digits_2_to_5.xml</code>åˆ°æ•°å­—5ï¼š </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">animated-vector</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:aapt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/aapt"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:drawable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/viv_vd_pathmorph_digits_zero"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"iconPath"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">aapt:attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android:animation"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">objectAnimator</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:duration</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@integer/viv_animation_duration"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:propertyName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pathData"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:valueFrom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/viv_path_two"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:valueTo</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/viv_path_five"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:valueType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pathType"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">aapt:attr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">animated-vector</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œä¸ºæ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬é€šè¿‡å•ç‹¬çš„èµ„æºè®¾ç½®åŠ¨ç”»çš„æŒç»­æ—¶é—´ã€‚ æ€»å…±ï¼Œæˆ‘ä»¬æœ‰12ä¸ªé™æ€å›¾åƒï¼ˆ0-9 +â€œå‡â€ +â€œæ— æ•ˆâ€ï¼‰ï¼Œæ¯ä¸ªå›¾åƒéƒ½å¯ä»¥åœ¨å…¶ä»–ä»»ä½•å›¾åƒä¸­è¿›è¡ŒåŠ¨ç”»å¤„ç†ã€‚ äº‹å®è¯æ˜ï¼Œä¸ºäº†å®Œæ•´èµ·è§ï¼Œéœ€è¦12 * 11 = 132ä¸ªåŠ¨ç”»æ–‡ä»¶ã€‚ å®ƒä»¬åªä¼šåœ¨<code>android:valueFrom</code>å’Œ<code>android:valueTo</code>å±æ€§ä¸Š<code>android:valueFrom</code> ï¼Œå¹¶ä¸”ä¸èƒ½æ‰‹åŠ¨åˆ›å»ºå®ƒä»¬ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªç®€å•çš„ç”Ÿæˆå™¨ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">åŠ¨ç”»æ–‡ä»¶ç”Ÿæˆå™¨</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileWriter fun main(args: <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>&lt;String&gt;) { val names = arrayOf( "zero", "one", "two", "three", "four", "five", "six", "seven", "eight", "nine", "nth", "minus" ) fun getLetter(i: <span class="hljs-type"><span class="hljs-type">Int</span></span>) = <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (i) { <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-number"><span class="hljs-number">.9</span></span> -&gt; i.toString() <span class="hljs-number"><span class="hljs-number">10</span></span> -&gt; "n" <span class="hljs-number"><span class="hljs-number">11</span></span> -&gt; "m" <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>!! } val dirName = "viv_out" File(dirName).mkdir() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-number"><span class="hljs-number">.11</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0.</span></span><span class="hljs-number"><span class="hljs-number">.11</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> == <span class="hljs-keyword"><span class="hljs-keyword">to</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> FileWriter(File(dirName, "viv_avd_pathmorph_digits_${getLetter(from)}_to_${getLetter(to)}.xml")).use { it.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span>(""" &lt;?xml version="<span class="hljs-number"><span class="hljs-number">1.0</span></span>" encoding="utf<span class="hljs-number"><span class="hljs-number">-8</span></span>"?&gt; &lt;animated-vector xmlns:android="http://<span class="hljs-keyword"><span class="hljs-keyword">schemas</span></span>.android.com/apk/res/android" xmlns:aapt="http://<span class="hljs-keyword"><span class="hljs-keyword">schemas</span></span>.android.com/aapt" android:drawable="@drawable/viv_vd_pathmorph_digits_zero"&gt; &lt;target android:name="iconPath"&gt; &lt;aapt:attr name="android:animation"&gt; &lt;objectAnimator android:duration="@<span class="hljs-type"><span class="hljs-type">integer</span></span>/viv_animation_duration" android:propertyName="pathData" android:valueFrom="@string/viv_path_${names[<span class="hljs-keyword"><span class="hljs-keyword">from</span></span>]}" android:valueTo="@string/viv_path_${names[<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>]}" android:valueType="pathType"/&gt; &lt;/aapt:attr&gt; &lt;/target&gt; &lt;/animated-vector&gt; """.trimIndent()) } } } }</code> </pre> </div></div><br><h2 id="vse-vmeste"> ä¸€èµ· </h2><br><p> ç°åœ¨ï¼Œæ‚¨éœ€è¦å°†é™æ€çŸ¢é‡å›¾åƒå’Œè¿‡æ¸¡åŠ¨ç”»è¿æ¥åˆ°ä¸€ä¸ª<code>&lt;animated-selector&gt;</code>æ–‡ä»¶ä¸­ï¼Œè¯¥æ–‡ä»¶ä¸å¸¸è§„çš„<code>&lt;selector&gt;</code> ï¼Œæ ¹æ®å½“å‰çŠ¶æ€æ˜¾ç¤ºå…¶ä¸­ä¸€å¼ å›¾åƒã€‚ æ­¤å¯ç»˜åˆ¶èµ„æºï¼ˆ <a href=""><code>res/drawable/viv_asl_pathmorph_digits.xml</code></a> ï¼‰åŒ…å«å›¾åƒçŠ¶æ€çš„å£°æ˜ä»¥åŠå®ƒä»¬ä¹‹é—´çš„è¿‡æ¸¡ã€‚ </p><br><p> ä½¿ç”¨å¸¦æœ‰å›¾åƒå’Œå®šä¹‰æ­¤å›¾åƒçš„çŠ¶æ€å±æ€§ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º<code>app:viv_state_three</code> ï¼‰çš„<code>&lt;item&gt;</code>æ ‡ç­¾è®¾ç½®çŠ¶æ€ã€‚ æ¯ä¸ªçŠ¶æ€éƒ½æœ‰ä¸€ä¸ª<code>id</code> ï¼Œç”¨äºç¡®å®šæ‰€éœ€çš„è¿‡æ¸¡åŠ¨ç”»ï¼š </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/three"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:drawable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/viv_vd_pathmorph_digits_three"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:viv_state_three</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><p> çŠ¶æ€å±æ€§åœ¨<code>res/values/attrs.xml</code> ï¼š </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">declare-styleable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_DigitState"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_zero"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_one"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_two"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_three"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_four"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_five"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_six"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_seven"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_eight"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_nine"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_nth"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_state_minus"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"boolean"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">declare-styleable</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> çŠ¶æ€ä¹‹é—´çš„è¿‡æ¸¡åŠ¨â€‹â€‹ç”»ç”±<code>&lt;transition&gt;</code>æ ‡ç­¾è®¾ç½®ï¼Œå¹¶å¸¦æœ‰<code>&lt;animated-vector&gt;</code> <code>&lt;transition&gt;</code>æ ‡è®°ï¼Œè¯¥ç¬¦å·è¡¨ç¤ºè¿‡æ¸¡ä»¥åŠåˆå§‹çŠ¶æ€å’Œæœ€ç»ˆçŠ¶æ€çš„<code>id</code> ï¼š </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">transition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:drawable</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/viv_avd_pathmorph_digits_6_to_2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:fromId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/six"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:toId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@id/two"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><p>  <a href=""><code>res/drawable/viv_asl_pathmorph_digits.xml</code></a>çš„å†…å®¹å‡ ä¹ç›¸åŒï¼Œè¿˜ä½¿ç”¨äº†ç”Ÿæˆå™¨æ¥åˆ›å»ºå®ƒã€‚ æ­¤å¯ç»˜åˆ¶èµ„æºåŒ…æ‹¬12ä¸ªçŠ¶æ€ä»¥åŠå®ƒä»¬ä¹‹é—´çš„132ä¸ªè½¬æ¢ã€‚ </p><br><h2 id="customview"> è‡ªå®šä¹‰è§†å›¾ </h2><br><p> ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ª<code>drawable</code> ï¼Œå®ƒå…è®¸æˆ‘ä»¬æ˜¾ç¤ºä¸€ä½æ•°å­—å¹¶ä¸ºå…¶å˜åŒ–æ·»åŠ åŠ¨ç”»æ•ˆæœï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª<strong><code>VectorIntegerView</code></strong> ï¼Œå…¶ä¸­å°†åŒ…å«å¤šä¸ªæ•°å­—å¹¶æ§åˆ¶åŠ¨ç”»ã€‚ é€‰æ‹©<code>RecyclerView</code>ä½œä¸ºåŸºç¡€ï¼Œå› ä¸ºæ•°å­—ä¸­çš„ä½æ•°æ˜¯ä¸€ä¸ªå˜é‡å€¼ï¼Œè€Œ<code>RecyclerView</code>æ˜¯Androidä¸­è¿ç»­æ˜¾ç¤ºå¯å˜æ•°é‡çš„å…ƒç´ ï¼ˆæ•°å­—ï¼‰çš„æœ€ä½³æ–¹æ³•ã€‚ æ­¤å¤–ï¼Œ <code>RecyclerView</code>å…è®¸æ‚¨é€šè¿‡<code>ItemAnimator</code>æ§åˆ¶é¡¹ç›®åŠ¨ç”»ã€‚ </p><br><h4 id="digitadapter-i-digitviewholder">  DigitAdapterå’ŒDigitViewHolder </h4><br><p> æ‚¨éœ€è¦é¦–å…ˆåˆ›å»ºä¸€ä¸ªåŒ…å«ä¸€ä½æ•°å­—çš„<code>DigitViewHolder</code> ã€‚ è¿™æ ·çš„<code>DigitViewHolder</code> <code>View</code>å°†ç”±å…·æœ‰<code>android:src="@drawable/viv_asl_pathmorph_digits"</code>çš„å•ä¸ª<code>ImageView</code>ç»„æˆ<code>android:src="@drawable/viv_asl_pathmorph_digits"</code> ã€‚ ä¸ºäº†åœ¨<code>ImageView</code>æ˜¾ç¤ºæ‰€éœ€çš„æ•°å­—ï¼Œä½¿ç”¨äº†<code>mImageView.setImageState(state, true);</code>æ–¹æ³•<code>mImageView.setImageState(state, true);</code>  ã€‚ ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„<code>viv_DigitState</code>çŠ¶æ€å±æ€§ï¼ŒåŸºäºæ˜¾ç¤ºçš„æ•°å­—å½¢æˆçŠ¶æ€<code>state</code>æ•°ç»„ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">åœ¨â€œ ImageViewâ€ä¸­æ˜¾ç¤ºæ‰€éœ€çš„æ•°å­—</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] ATTRS = { R.attr.viv_state_zero, R.attr.viv_state_one, R.attr.viv_state_two, R.attr.viv_state_three, R.attr.viv_state_four, R.attr.viv_state_five, R.attr.viv_state_six, R.attr.viv_state_seven, R.attr.viv_state_eight, R.attr.viv_state_nine, R.attr.viv_state_nth, R.attr.viv_state_minus, }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDigit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@IntRange(from = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, to = VectorIntegerView.MAX_DIGIT)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> digit) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[] state = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[ATTRS.length]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; ATTRS.length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i == digit) { state[i] = ATTRS[i]; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { state[i] = -ATTRS[i]; } } mImageView.setImageState(state, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); }</code> </pre> </div></div><br><p>  <code>DigitAdapter</code>é€‚é…å™¨è´Ÿè´£åˆ›å»º<code>DigitViewHolder</code>å¹¶åœ¨æ‰€éœ€<code>DigitViewHolder</code>æ˜¾ç¤ºæ‰€éœ€æ•°å­—ã€‚ </p><br><p> å¯¹äºå°†ä¸€ä¸ªæ•°å­—è½¬æ¢ä¸ºå¦ä¸€ä¸ªæ•°å­—çš„æ­£ç¡®åŠ¨ç”»ï¼Œä½¿ç”¨äº†<code>DiffUtil</code> ã€‚ ä½¿ç”¨å®ƒï¼Œå¯ä»¥å°†æ•°åä¸ªçº§åˆ«çš„åŠ¨ç”»è®¾ç½®ä¸ºæ•°åä¸ªï¼Œå‡ ç™¾ä¸ªåˆ°æ•°ç™¾ä¸ªï¼Œæ•°åƒä¸‡åˆ°æ•°åƒä¸‡çš„çº§åˆ«ï¼Œä¾æ­¤ç±»æ¨ã€‚ å‡å·å§‹ç»ˆç‹¬ç«‹å­˜åœ¨ï¼Œåªèƒ½å‡ºç°æˆ–æ¶ˆå¤±ï¼Œå˜æˆä¸€ä¸ªç©ºå›¾åƒï¼ˆ <code>viv_vd_pathmorph_digits_nth.xml</code> ï¼‰ã€‚ </p><br><p> ä¸ºæ­¤ï¼Œ <code>DiffUtil.Callback</code>åœ¨æ¯”è¾ƒç›¸åŒçš„æ•°å­—ä½æ•°æ—¶ï¼Œ <code>DiffUtil.Callback</code>æ–¹æ³•ä¸­çš„<code>DiffUtil.Callback</code>è¿”å›<code>true</code> ã€‚ å‡å·æ˜¯ä¸€ä¸ªç‰¹æ®Šç±»åˆ«ï¼Œå‰ä¸€ä¸ªæ•°å­—çš„è´Ÿå·ç­‰äºæ–°æ•°å­—çš„è´Ÿå·ã€‚ </p><br><p>  <code>areContentsTheSame</code>æ–¹æ³•æ¯”è¾ƒå…ˆå‰æ•°å­—å’Œæ–°æ•°å­—ä¸­æŸäº›ä½ç½®çš„å­—ç¬¦ã€‚ å®ç°æœ¬èº«å¯ä»¥åœ¨<a href=""><code>DigitAdapter</code></a>çœ‹åˆ°ã€‚ </p><br><h4 id="digititemanimator">  DigitItemAnimator </h4><br><p> æ•°å­—å˜åŒ–çš„åŠ¨ç”»ï¼Œå³æ•°å­—çš„å˜æ¢ï¼Œå¤–è§‚å’Œæ¶ˆå¤±ï¼Œå°†ç”±<code>RecyclerView</code> - <a href=""><code>DigitItemAnimator</code></a>çš„ç‰¹æ®ŠåŠ¨ç”»æ§åˆ¶ã€‚ ä¸ºäº†ç¡®å®šåŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼Œä½¿ç”¨ä¸ä¸Šè¿°<code>&lt;animated-vector&gt;</code>ä¸­ç›¸åŒçš„<code>integer</code>èµ„æºï¼š </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> animationDuration; DigitItemAnimator(<span class="hljs-meta"><span class="hljs-meta">@NonNull</span></span> Resources resources) { animationDuration = resources.getInteger(R.integer.viv_animation_duration); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMoveDuration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> animationDuration; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAddDuration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> animationDuration; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getRemoveDuration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> animationDuration; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">long</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getChangeDuration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> animationDuration; }</code> </pre> <br><p>  <code>DigitItemAnimator</code>çš„å¤§éƒ¨åˆ†éƒ½è¦†ç›–äº†èƒºåŒ–æ–¹æ³•ã€‚ æ•°å­—æ˜¾ç¤ºçš„åŠ¨ç”»ï¼ˆ <code>animateAdd</code>æ–¹æ³•ï¼‰æ˜¯ä»ç©ºç™½å›¾åƒåˆ°æ‰€éœ€æ•°å­—æˆ–å‡å·çš„è¿‡æ¸¡ã€‚ æ¶ˆå¤±åŠ¨ç”»ï¼ˆ <code>animateRemove</code>æ–¹æ³•ï¼‰æ˜¯ä»æ˜¾ç¤ºçš„æ•°å­—æˆ–å‡å·åˆ°ç©ºç™½å›¾åƒçš„è¿‡æ¸¡ã€‚ </p><br><p> ä¸ºäº†æ‰§è¡Œæ•°å­—è½¬æ¢åŠ¨ç”»ï¼Œé¦–å…ˆé€šè¿‡è¦†ç›–<code>recordPreLayoutInformation</code>æ–¹æ³•æ¥å­˜å‚¨æœ‰å…³å…ˆå‰æ˜¾ç¤ºçš„æ•°å­—çš„ä¿¡æ¯ã€‚ ç„¶åï¼Œåœ¨<code>animateChange</code>æ–¹æ³•ä¸­ï¼Œæ‰§è¡Œä»å…ˆå‰æ˜¾ç¤ºçš„æ•°å­—åˆ°æ–°æ•°å­—çš„è½¬æ¢ã€‚ </p><br><p>  <code>RecyclerView.ItemAnimator</code>è¦æ±‚è¦†ç›–çš„åŠ¨ç”»æ–¹æ³•å¿…é¡»è°ƒç”¨è¡¨ç¤ºåŠ¨ç”»ç»“æŸçš„æ–¹æ³•ã€‚ å› æ­¤ï¼Œåœ¨æ¯ä¸ª<code>animateAdd</code> ï¼Œ <code>animateRemove</code>å’Œ<code>animateChange</code>æ–¹æ³•ä¸­ï¼Œéƒ½æœ‰ä¸€ä¸ªå¯¹ç›¸åº”æ–¹æ³•çš„è°ƒç”¨ï¼Œå…¶å»¶è¿Ÿç­‰äºåŠ¨ç”»çš„æŒç»­æ—¶é—´ã€‚ ä¾‹å¦‚ï¼Œ <code>animateAdd</code>æ–¹æ³•è°ƒç”¨å»¶è¿Ÿç­‰äº<code>@integer/viv_animation_duration</code>çš„<code>dispatchAddFinished</code>æ–¹æ³•ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">animateAdd</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> RecyclerView.ViewHolder holder)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> DigitAdapter.DigitViewHolder digitViewHolder = (DigitAdapter.DigitViewHolder) holder; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a = digitViewHolder.d; digitViewHolder.setDigit(VectorIntegerView.DIGIT_NTH); digitViewHolder.setDigit(a); holder.itemView.postDelayed(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Runnable() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ dispatchAddFinished(holder); } }, animationDuration); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; }</code> </pre> <br><h4 id="vectorintegerview">  VectorIntegerView </h4><br><p> åœ¨åˆ›å»ºCustomViewä¹‹å‰ï¼Œæ‚¨éœ€è¦å®šä¹‰å…¶xmlå±æ€§ã€‚ ä¸ºæ­¤ï¼Œå°†<code>&lt;declare-styleable&gt;</code>æ·»åŠ åˆ°<code>res/values/attrs.xml</code> ï¼š </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">declare-styleable</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"VectorIntegerView"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_vector_integer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"integer"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">attr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viv_digit_color"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">format</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"color"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">declare-styleable</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> åˆ›å»ºçš„<code>VectorIntegerView</code>å°†å…·æœ‰2ä¸ªç”¨äºè‡ªå®šä¹‰çš„xmlå±æ€§ï¼š </p><br><ul><li>  <code>viv_vector_integer</code>åˆ›å»ºè§†å›¾æ—¶æ˜¾ç¤º<code>viv_vector_integer</code>æ•°å­—ï¼ˆé»˜è®¤ä¸º0ï¼‰ã€‚ </li><li>  <code>viv_digit_color</code>æ•°å­—çš„é¢œè‰²ï¼ˆé»˜è®¤ä¸ºé»‘è‰²ï¼‰ã€‚ </li></ul><br><p> å¯ä»¥é€šè¿‡è¦†ç›–åº”ç”¨ç¨‹åºä¸­çš„èµ„æºæ¥æ›´æ”¹å…¶ä»–<code>VectorIntegerView</code>å‚æ•°ï¼ˆå°±åƒåœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">demoåº”ç”¨ç¨‹åºä¸­ä¸€æ ·</a> ï¼‰ï¼š </p><br><ul><li>  <code>@integer/viv_animation_duration</code>ç¡®å®šåŠ¨ç”»çš„æŒç»­æ—¶é—´ï¼ˆé»˜è®¤ä¸º400msï¼‰ã€‚ </li><li>  <code>@dimen/viv_digit_size</code>ç¡®å®šä¸€ä½æ•°å­—çš„å¤§å°ï¼ˆé»˜è®¤ä¸º<code>24dp</code> ï¼‰ã€‚ </li><li>  <code>@dimen/viv_digit_translateX</code>é€‚ç”¨äºæ‰€æœ‰æ•°å­—çŸ¢é‡å›¾åƒï¼Œä»¥ä½¿å…¶æ°´å¹³å¯¹é½ã€‚ </li><li>  <code>@dimen/viv_digit_translateY</code>åº”ç”¨äºæ•°å­—çš„æ‰€æœ‰çŸ¢é‡å›¾åƒï¼Œä»¥ä½¿å…¶å‚ç›´å¯¹é½ã€‚ </li><li>  <code>@dimen/viv_digit_strokewidth</code>é€‚ç”¨äºæ‰€æœ‰æ•°å­—çŸ¢é‡å›¾åƒã€‚ </li><li>  <code>@dimen/viv_digit_margin_horizontal</code>é€‚ç”¨äºæ‰€æœ‰è§†å›¾æ•°å­—ï¼ˆ <code>DigitViewHolder</code> ï¼‰ï¼ˆé»˜è®¤ä¸º<code>-3dp</code> ï¼‰ã€‚ ç”±äºæ•°å­—çš„çŸ¢é‡å›¾åƒæ˜¯æ­£æ–¹å½¢çš„ï¼Œå› æ­¤æœ‰å¿…è¦ä½¿æ•°å­—ä¹‹é—´çš„é—´è·æ›´å°ã€‚ </li></ul><br><p> è¦†ç›–çš„èµ„æºå°†åº”ç”¨äºåº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰<code>VectorIntegerView</code> ã€‚ </p><br><p>  <em>æ‰€æœ‰è¿™äº›å‚æ•°éƒ½æ˜¯é€šè¿‡èµ„æºè®¾ç½®çš„ï¼Œå› ä¸ºæ— æ³•é€šè¿‡ä»£ç è°ƒæ•´<code>VectorDrawable</code>å¤§å°æˆ–<code>AnimatedVectorDrawable</code>åŠ¨ç”»çš„æŒç»­æ—¶é—´ã€‚</em> </p><br><p> å°†<code>VectorIntegerView</code>æ·»åŠ åˆ°XMLæ ‡è®°å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FrameLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:app</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res-auto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">com.qwert2603.vector_integer_view.VectorIntegerView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/vectorIntegerView"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"match_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wrap_content"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_margin</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16dp"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:viv_digit_color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#ff8000"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">app:viv_vector_integer</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"14"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">FrameLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p> éšåï¼Œæ‚¨å¯ä»¥é€šè¿‡ä¼ é€’<code>BigInteger</code>æ¥æ›´æ”¹ä»£ç ä¸­æ˜¾ç¤ºçš„æ•°å­—ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> VectorIntegerView vectorIntegerView = findViewById(R.id.vectorIntegerView); vectorIntegerView.setInteger( vectorIntegerView.getInteger().add(BigInteger.ONE), <span class="hljs-comment"><span class="hljs-comment">/* animated = */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> );</code> </pre> <br><p> ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæœ‰ä¸€ç§ç”¨äºä¼ è¾“<code>long</code>ç±»å‹çš„æ•°å­—çš„æ–¹æ³•ï¼š </p><br><pre> <code class="java hljs">vectorIntegerView.setInteger(<span class="hljs-number"><span class="hljs-number">1918L</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>);</code> </pre> <br><p> å¦‚æœå°†<code>false</code>ä½œä¸º<code>animated</code>ä¼ é€’ï¼Œåˆ™å°†ä¸º<code>notifyDataSetChanged</code>è°ƒç”¨<code>notifyDataSetChanged</code>æ–¹æ³•ï¼Œå¹¶ä¸”æ–°æ•°å­—å°†ä¸æ˜¾ç¤ºåŠ¨ç”»ã€‚ </p><br><p> é‡æ–°åˆ›å»º<code>VectorIntegerView</code>ä½¿ç”¨<code>onSaveInstanceState</code>å’Œ<code>onRestoreInstanceState</code>ä¿å­˜æ˜¾ç¤ºçš„æ•°å­—ã€‚ </p><br><h2 id="ishodniki"> æºä»£ç  </h2><br><p> æºä»£ç åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github</a> ï¼ˆåº“ç›®å½•ï¼‰ä¸Šå¯ç”¨ã€‚ è¿˜æœ‰ä¸€ä¸ªä½¿ç”¨<code>VectorIntegerView</code> ï¼ˆåº”ç”¨ç¨‹åºç›®å½•ï¼‰çš„æ¼”ç¤ºåº”ç”¨ç¨‹åºã€‚ </p><br><p> è¿˜æœ‰ä¸€ä¸ª<a href="">æ¼”ç¤ºapk</a> ï¼ˆ <code>minSdkVersion 21</code> ï¼‰ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN420919/">https://habr.com/ru/post/zh-CN420919/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN420905/index.html">ä¿„ç½—æ–¯å¦‚ä½•å¼•å…¥æ™ºèƒ½ç…§æ˜ä»¥åŠéœ€è¦å¤šé•¿æ—¶é—´</a></li>
<li><a href="../zh-CN420907/index.html">ä»è¯ºåŸºäºšåˆ°å°ç±³ï¼šä¸­å›½æ‰‹æœºçš„æ¼”å˜</a></li>
<li><a href="../zh-CN420909/index.html">ä¿„ç½—æ–¯ç”µè§†å…¬å¸æŒ‡æ§Yandexç›—ç‰ˆ</a></li>
<li><a href="../zh-CN420913/index.html">åœ¨LXCå†…è¿è¡Œkubernetes</a></li>
<li><a href="../zh-CN420915/index.html">ä¸€é”®å¼RFMåˆ†ææˆ–æˆ‘ä»¬å¦‚ä½•ä½¿å®¢æˆ·çš„ç”Ÿæ´»æ›´è½»æ¾</a></li>
<li><a href="../zh-CN420923/index.html">è½¯ä»¶å¼€å‘äººå‘˜å…ƒæŠ€èƒ½</a></li>
<li><a href="../zh-CN420927/index.html">â€œåœ¨é˜¿é‡Œäº‘ä¸Šè¿›è¡Œæ©¡èƒ¶ä¸»æœºæœç´¢â€ï¼šåœ¨é˜¿é‡Œäº‘è®¾æ–½ä¸Šæ‰˜ç®¡Elasticsearch</a></li>
<li><a href="../zh-CN420929/index.html">è¿è¡Œï¼Œæµ‹è¯•ï¼Œè¿è¡Œã€‚ è°ˆè®ºç§»åŠ¨æµ‹è¯•èšä¼š</a></li>
<li><a href="../zh-CN420931/index.html">å¦‚ä½•æµ‹è¯•æ ¸ç”µç«™</a></li>
<li><a href="../zh-CN420935/index.html">æ‚¨éœ€è¦äº†è§£çš„æœ‰å…³Flexboxä¸­å¯¹é½çš„æ‰€æœ‰ä¿¡æ¯</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>