<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè® üëÉüèº ü§πüèª Como escrever programas na jun√ß√£o de desenvolvimento e algoritmos m√≥veis? Competi√ß√£o e hist√≥rias Yandex üßëüèº‚Äçü§ù‚Äçüßëüèª üñêüèº ü§∏üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De 10 a 22 de setembro, ser√° realizado o concurso de desenvolvimento m√≥vel Yandex.Blitz. O registro est√° aberto . O Blitz √© um caminho curto para o Ya...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como escrever programas na jun√ß√£o de desenvolvimento e algoritmos m√≥veis? Competi√ß√£o e hist√≥rias Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/420305/">  De 10 a 22 de setembro, ser√° realizado o concurso de desenvolvimento m√≥vel Yandex.Blitz.  O registro est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aberto</a> .  O Blitz √© um caminho curto para o Yandex: os 5 principais participantes ter√£o que passar com √™xito em uma se√ß√£o da entrevista, em vez das quatro padr√£o para obter uma oferta de emprego. <br><br>  Na ocasi√£o do concurso, conversamos com colegas sobre tarefas interessantes que se aplicam imediatamente a plataformas e algoritmos m√≥veis.  Hoje vamos compartilhar suas hist√≥rias com os leitores de Habr. <br><br><img src="https://habrastorage.org/webt/3z/_5/ry/3z_5rygov_eu9yhgyzngfbv6vmy.png"><br><br>  Acredita-se que o desenvolvimento de aplicativos m√≥veis seja algo especial, longe da programa√ß√£o no sentido geral, e os especialistas que escrevem para Android e iOS nunca encontram tarefas para resolver tarefas intensivas em algoritmos, limitando-se a conectar bibliotecas prontas, telas de digita√ß√£o, escrever l√≥gica de neg√≥cios simples e pesquisando bugs de uma plataforma espec√≠fica.  Mas n√£o √© t√£o simples. <br><br><a name="habracut"></a>  A cria√ß√£o de software para dispositivos m√≥veis est√° sempre cheia de limita√ß√µes.  Mesmo em dispositivos de ponta, CPUs e GPUs n√£o s√£o t√£o poderosas e n√£o t√™m tanta mem√≥ria quanto em um computador moderno.  Ao mesmo tempo, a parte principal do mercado √© o or√ßamento de smartphones com hardware ainda mais fraco.  Seus propriet√°rios s√£o particularmente afetados pela falta de recursos. <br><br>  O desenvolvimento de um projeto competitivo complexo √© imposs√≠vel sem o uso de solu√ß√µes que lidam com tarefas mais rapidamente do que em um per√≠odo quadr√°tico.  Os usu√°rios podem procurar um concorrente se n√£o gostarem da velocidade do trabalho ou de como seu aplicativo consome energia da bateria. <br><br>  Historicamente, o Blitz √© uma competi√ß√£o pelo conhecimento de algoritmos e pela capacidade de traduzir a id√©ia de uma solu√ß√£o em c√≥digo.  O Blitz, que ser√° realizado em setembro, n√£o ser√° uma exce√ß√£o.  Tentamos selecionar tarefas com algoritmos semelhantes aos usados ‚Äã‚Äãpelos desenvolvedores de dispositivos m√≥veis Yandex em projetos reais para Android e iOS. <br><br><h4>  Acelerando o Navegador Sugest </h4><br>  <b><i>Mikhail Efimov, desenvolvedor principal</i></b> : <br><blockquote> - Eu fiz omnibox - String de pesquisa do navegador.  O preenchimento autom√°tico funciona nele - basta digitar o in√≠cio da palavra e ofereceremos a palavra inteira.  A tarefa inicial pode ser simplificada para o seguinte: ap√≥s receber uma sequ√™ncia de entrada, encontre todas as palavras de um conjunto predefinido no qual a sequ√™ncia de entrada aparece como uma substring.  Para fazer isso, usamos todos os sufixos da palavra - todas as substrings com as quais ela termina.  Por exemplo, para a palavra "tabela" ser√° "tabela" e "tol".  Sufixos de um ou dois caracteres - aqui ter√≠amos "ol" e "l" - n√£o s√£o levados em considera√ß√£o, porque atrav√©s deles o lixo entra no teste. <br><br>  Assim, em vez de uma palavra, temos duas.  Se consistisse em cinco letras, elas receberiam tr√™s etc. Al√©m disso, por exemplo, voc√™ pode criar uma estrutura de dados conhecida, que permite procurar por elas.  Mas essa estrutura tem uma desvantagem - pode ocupar muito espa√ßo de mem√≥ria. <br><br>  Por sua vez, mantivemos uma lista classificada de sufixos - matriz de sufixos.  O elemento na matriz n√£o √© o sufixo inteiro - ent√£o a estrutura ocuparia muita mem√≥ria, uma quantidade quadr√°tica - mas apenas um par de ponteiros.  O primeiro deles indica a palavra ou frase que voc√™ deseja usar, o segundo - o s√≠mbolo na palavra ou frase com a qual o sufixo come√ßa.  Essa abordagem economiza mem√≥ria.  Temos apenas dois ponteiros, dois n√∫meros de oito bytes em vez de palavras muito longas. <br><br>  A pr√≥xima pergunta √© como armazenar uma lista j√° classificada.  Ele pode ser armazenado como uma matriz simples - mas novas entradas ser√£o inseridas nela por um per√≠odo muito longo.  Portanto, eu escolhi armazenar a √°rvore de pesquisa bin√°ria "aumentada" - √°rvore de pesquisa bin√°ria aumentada.  Como chave, cada n√≥ da √°rvore cont√©m um determinado sufixo para uma determinada palavra e, como um "complemento", as informa√ß√µes sobre prioridades s√£o armazenadas nos n√≥s.  Tudo o que voc√™ precisa fazer √© encontrar o n√≥ da √°rvore que corresponde ao prefixo inserido.  Al√©m disso, voc√™ pode analisar este e os n√≥s vizinhos para entender qual das palavras pode ser usada para emiss√£o. <br><br>  Entre eles, aqueles com maior prioridade s√£o selecionados.  A prioridade √© afetada pelo comprimento da indenta√ß√£o do sufixo desde o in√≠cio da palavra.  Para palavras com recuo zero, a prioridade √© maior - por exemplo, se o usu√°rio digitar "st", a palavra "tabela" ter√° prioridade muito maior que a palavra "ponte".  Mas, em princ√≠pio, voc√™ pode inserir uma sequ√™ncia de caracteres que o Navegador em resposta aconselhe a palavra onde essa sequ√™ncia ocorre no meio ou no final.  Por exemplo, se n√£o houver uma palavra que comece com esta sequ√™ncia. </blockquote><br><h4>  Exibi√ß√£o de c√¢meras de CFTV no Yandex.Maps m√≥vel </h4><br>  <i><b>Sergey Kuznetsov, desenvolvedor principal</b> :</i> <br><blockquote>  - Tivemos um algoritmo que exibia c√¢meras em um mapa.  Ele trabalhou no tempo quadr√°tico, n√£o muito r√°pido.  Havia uma id√©ia de que ele pode ser melhorado, sem recorrer a qualquer frescura. <br><br>  Se falamos sobre a declara√ß√£o do problema, tivemos muitas c√¢meras que precisam ser exibidas.  Em altas escalas do mapa, eles podiam se cruzar, e era feio - era necess√°rio exibir uma c√¢mera em vez de muitas se cruzarem. <br><br>  Se formalizarmos esse problema, ele se resumiu ao seguinte: no plano, existem n quadrados id√™nticos com lados paralelos aos eixos das coordenadas, e voc√™ precisa escolher um n√∫mero t√£o grande de quadrados para que n√£o se cruzem dentro dele e todos os outros quadrados se cruzem pelo menos um dos quadrados do conjunto original.  O algoritmo de solu√ß√£o mais simples - quando selecionamos um quadrado e o cruzamos com todos os outros - funcionava para n <sup>2</sup> .  Mas o problema pode ser resolvido em n * log (n), usando uma certa classe de algoritmos, que na literatura √© chamada de "linha de varredura".  Se voc√™ n√£o conhece essa abordagem, √© claro que esse problema pode ser resolvido, mas se voc√™ souber, pode ser resolvido com muito mais facilidade.  Voc√™ sabe imediatamente em que dire√ß√£o pensar. </blockquote><br><img src="https://habrastorage.org/webt/qp/5g/kq/qp5gkqw4zm-uhpoopbmma9jqk1q.png" width="350"><img src="https://habrastorage.org/webt/mr/sv/qt/mrsvqt_-ri1ognvqr4eokhkvj4m.png" width="350"><br><h5>  <sub><sup>C√¢meras em mapas m√≥veis.</sup></sub>  <sub><sup>Se voc√™ diminuir o zoom, resta apenas um √≠cone</sup></sub> </h5><br><h4>  Obtendo dados de uma das fontes do Sugest Browser </h4><br>  <i><b>Alexander Yashkin, chefe do grupo de back-end do portal</b> :</i> <br><blockquote>  - Existem v√°rias fontes de dicas "pesadas" que s√£o exibidas ao digitar no navegador da omnibox.  Uma dessas fontes √© o hist√≥rico local do usu√°rio.  As dicas do hist√≥rico s√£o enviadas por um provedor hist√≥rico - um componente veio do Chromium.  O que h√° de especial na omnibox?  Deve ser muito r√°pido, pronto imediatamente, enquanto voc√™ digita, para que as fontes sejam principalmente s√≠ncronas.  Quando o navegador √© iniciado, o provedor cria um √≠ndice r√°pido de dicas de hist√≥rico na semana passada.  No Chromium, o √≠ndice de hist√≥rico da omnibox usava os cont√™ineres associativos std :: set e std :: map da biblioteca padr√£o C ++.  Para armazenar dados dentro desses recipientes, geralmente √© usada madeira vermelha e preta. <br><br>  Nossa tarefa era acelerar a pesquisa de hist√≥rico na omnibox.  A partir dos histogramas dos usu√°rios, vimos que a pesquisa hist√≥rica leva mais tempo e, em computadores lentos, as pessoas realmente sofrem.  Para alguns, a expectativa era de um d√©cimo de segundo - quando voc√™ digita rapidamente caracteres na omnibox, √© muito longo e pode ser ainda pior. <br><br>  Fiz v√°rias abordagens, otimiza√ß√µes, upstream no Chromium.  Ao mesmo tempo, fizemos altera√ß√µes no nosso c√≥digo.  Em seguida, a tarefa passou para o nosso desenvolvedor Denis Yaroshevsky.  Ele √© um desenvolvedor bastante entusiasmado - ele est√° interessado em algoritmos C ++, STL.  Depois de vasculhar, ele prop√¥s agir radicalmente: substitua std :: set por flat_set e std :: map por flat_map.  Ou seja, basta alterar a estrutura b√°sica.  std :: set e std :: map armazenam seus elementos nos n√≥s da √°rvore, e flat_set e flat_map, de fato, s√£o wrappers sobre o vetor classificado.  Cont√™ineres planos s√£o um dos cont√™ineres mais populares que n√£o fazem parte da biblioteca padr√£o C ++.  Talvez no pr√≥ximo padr√£o eles ainda caiam nele. <br><br>  A princ√≠pio, houve certa desconfian√ßa: o caminho proposto parecia simples demais, deitado na superf√≠cie.  Para provar a efic√°cia, fizemos um teste de desempenho: pegamos o perfil de um de nossos colegas, criamos um √≠ndice de hist√≥rico a partir dele e fizemos consultas populares sobre ele.  Escolhemos 10 consultas e contamos os tempos.  Denis me mostrou o resultado, as melhorias foram √≥bvias e eu tamb√©m acreditei na ideia dele. <br><br>  O problema encontrado n√£o era espec√≠fico para o Yandex.Browser.  Ele afetou qualquer navegador baseado em Chromium; portanto, primeiro, como participantes do projeto Chromium, decidimos fazer um upstream.  Mas no Chromium h√° muitos que se comprometem, e algumas das id√©ias propostas s√£o selvagens.  Os desenvolvedores de cromo t√™m uma atitude bastante cautelosa em rela√ß√£o a todos que se oferecem para mudar algo de fora, de maneira mais radical.  No come√ßo, eles n√£o queriam pegar nosso patch.  Eles sugeriram antes disso para provar a efic√°cia e escrever um mini-design-doc para que eles possam entender a id√©ia, beneficiar e criticar a proposta. <br><br>  Al√©m disso, eles disseram: assim que precisar, escreva e adicione implementa√ß√µes separadas de cont√™ineres planos.  N√£o adicione novas bibliotecas ao nosso projeto - as implementa√ß√µes j√° existem no boost, eastl.  Recipientes planos deveriam ser adicionados aos componentes b√°sicos do Chromium.  Este √© um an√°logo da biblioteca padr√£o, e as pessoas com cromo est√£o muito preocupadas para que nada sup√©rfluo entre nela. <br><br>  Denis Yaroshevsky fez tudo isso, passou um tempo escrevendo um documento de design, escreveu a implementa√ß√£o flat_set em modelos C ++, aplicou muita m√°gica de modelo, escreveu testes cobrindo a funcionalidade dos cont√™ineres, criou outro teste sint√©tico - n√£o era poss√≠vel enviar o teste perf com real perfil de um colega.  Denis discutiu com os propriet√°rios do c√≥digo base e da omnibox, reformulou substancialmente o c√≥digo com base nos resultados da revis√£o - e finalmente os superou e enviou o c√≥digo para o Chromium. <br><br>  Essa saga inteira durou seis meses.  O cromo escreveu: ‚ÄúSim, realmente vimos uma melhoria de 10 a 20% em todos os histogramas.  √ìtimo, obrigado! ‚Äù  Deles, j√° atrav√©s do jusante chegou at√© n√≥s no navegador e, em seguida, um final feliz.  De fato, o √≠ndice hist√≥rico acelerou significativamente em todas as configura√ß√µes, em todas as plataformas.  Nesse √≠ndice, as vantagens dos cont√™ineres planos s√£o muito melhores que as desvantagens. <br><br>  Ap√≥s o upstream, flat_set e flat_map come√ßaram a ser usados ‚Äã‚Äãcom muito mais frequ√™ncia - agora no c√≥digo voc√™ pode encontrar centenas de locais onde eles est√£o envolvidos.  Moralidade - paci√™ncia e m√£o-de-obra trituram tudo e escolhem com cuidado n√£o apenas algoritmos para o seu c√≥digo, mas tamb√©m estruturas de dados adequadas. </blockquote><br><img src="https://habrastorage.org/webt/ax/2-/3k/ax2-3k3so-zw4zsgqtgmkajj7uo.png"><br><h5>  <sub><sup>Veja o lado esquerdo do gr√°fico.</sup></sub>  <sub><sup>Uma queda acentuada no tempo de carregamento dos resultados da omnibox no in√≠cio de 2017 se deve precisamente √† transi√ß√£o para flat_set e flat_map</sup></sub> </h5><br><h4>  Acelerando um dos HashMap no Chromium </h4><br>  <i><b>Oleg Maksimenko, desenvolvedor principal</b> :</i> <br><blockquote>  "O objetivo era acelerar o armazenamento de p√°ginas HTML regulares em um de nossos subprojetos".  Eu usei os meios padr√£o de cria√ß√£o de perfil do c√≥digo - observei quais partes do c√≥digo est√£o ‚Äúquentes‚Äù no processo de salvar.  Me deparei com um lugar inesperado.  Ou seja, essa n√£o √© a l√≥gica principal, mas apenas uma pesquisa no cont√™iner HashMap, que deve ocupar uma pequena porcentagem do tempo total.  Em vez disso, havia custos realmente fortes. <br><br>  Eu decidi substituir a implementa√ß√£o existente.  Era um HashMap interno, da Chromium.  Eu o substitu√≠ e ganhei v√°rias vezes.  Depois fui um pouco mais longe e me certifiquei de que isso n√£o fosse um erro dos caras do Google, que n√£o se tratasse de implementar todo o HashMap, mas uma fun√ß√£o de hash.  Isso √© uma coisa externa.  E aconteceu que eles tinham um hash trivial no c√≥digo que usamos, o endere√ßo na mem√≥ria foi usado como um hash.  Talvez, devido a alguns recursos, por exemplo, um pequeno volume, essa solu√ß√£o lhes convenha.  Talvez o HashMap deles n√£o fosse um ponto quente, mas se tornou nosso quando aplicamos essa estrutura.  Simplesmente substituindo a fun√ß√£o hash ing√™nua e trivial por std :: hash, obtivemos um aumento de velocidade de 3 a 10 vezes.  Como resultado, esse apelo √† mem√≥ria hash desapareceu da lista de pontos de acesso, passou a ocupar uma pequena porcentagem, como era esperado inicialmente.  Tudo ficou bom e bonito. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt420305/">https://habr.com/ru/post/pt420305/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt420295/index.html">NeoQUEST-2018: a t√£o esperada Cold Boot, pesquisa cient√≠fica e convidados de Nizhny Novgorod</a></li>
<li><a href="../pt420297/index.html">Instru√ß√µes passo a passo para recuperar o acesso √†s inst√¢ncias do Linux Amazon EC2 ao perder um arquivo pem</a></li>
<li><a href="../pt420299/index.html">Meus exemplos favoritos de programa√ß√£o funcional no Kotlin</a></li>
<li><a href="../pt420301/index.html">Primeiro-ministro indiano Narendra Modi: enviaremos a bandeira do pa√≠s para o espa√ßo a bordo do Gaganyan em 2022</a></li>
<li><a href="../pt420303/index.html">Balanceamento de carga ao analisar sites e conectar recursos adicionais da nuvem</a></li>
<li><a href="../pt420307/index.html">5 truques CSS que voc√™ deve conhecer</a></li>
<li><a href="../pt420311/index.html">Como nossa intui√ß√£o nos engana sobre o aquecimento global</a></li>
<li><a href="../pt420313/index.html">Fazemos horas liter√°rias com base no livro eletr√¥nico</a></li>
<li><a href="../pt420315/index.html">Fazemos um configurador 3D sem programa√ß√£o e layout</a></li>
<li><a href="../pt420317/index.html">Um novo exame de sangue instant√¢neo para danos cerebrais foi desenvolvido.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>