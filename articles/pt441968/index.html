<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úåüèª üë©üèø üî∞ Desenvolvimento de um novo ramo de produtos: como se livrar do impratic√°vel e se manter √∫til üé∏ üëàüèº üó°Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! Meu nome √© Dmitry, sou desenvolvedor do ISPsystem. Recentemente, lan√ßamos na vers√£o beta do teste uma nova vers√£o do painel de controle da m...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desenvolvimento de um novo ramo de produtos: como se livrar do impratic√°vel e se manter √∫til</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ispsystem/blog/441968/"><img src="https://habrastorage.org/webt/y1/x1/ec/y1x1ece2ww4irdsajxg6qeme6bw.jpeg"><br><br>  Ol√° Habr!  Meu nome √© Dmitry, sou desenvolvedor do ISPsystem.  Recentemente, lan√ßamos na vers√£o beta do teste uma nova vers√£o do painel de controle da m√°quina virtual.  Hoje vou lhe contar como decidimos o que levar de um produto antigo e o que √© melhor recusar.  Vou abordar as quest√µes mais importantes para n√≥s: uma biblioteca para trabalhar com libvirt, suporte para v√°rios sistemas operacionais durante a instala√ß√£o do produto, a transi√ß√£o do mon√≥lito para os microsservi√ßos e a implanta√ß√£o de m√°quinas virtuais. <br><br>  O artigo √© sobre o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">VMmanager</a> .  Este √© um sistema para gerenciar, implantar e monitorar m√°quinas virtuais com base na virtualiza√ß√£o KVM e OVZ.  A quinta gera√ß√£o saiu em 2012.  Desde ent√£o, a interface ficou muito desatualizada e a arquitetura centralizada impediu o desenvolvimento do produto.  √â hora de fazer uma nova vers√£o. <br><a name="habracut"></a><br><h2>  A primeira hist√≥ria.  Usamos o trabalho dos elfos dom√©sticos <br></h2><h5>  <font color="#787979">Trabalhar com libvirt: considere op√ß√µes, selecione bibliotecas</font> </h5><br>  Como uma ferramenta para gerenciar a virtualiza√ß√£o KVM, nosso produto usa libvirt.  Em 2012, uma biblioteca escrita em C foi escolhida para trabalhar com ela, por isso era mais conveniente para essa equipe de desenvolvimento.  Como resultado - uma grande quantidade de c√≥digo escrito em C ++, chamando a biblioteca C, que implementa o trabalho direto com libvirt. <br><br>  E agora, no limiar de um novo projeto, olhamos para tr√°s e examinamos nosso produto, avaliamos se vale a pena tomar uma solu√ß√£o / tecnologia espec√≠fica;  o que se provou e o que precisa ser lembrado e nunca repetido. <br><br>  Sentamos e fazemos uma retrospectiva de muitos anos de trabalho na vers√£o anterior do produto.  Somos pacientes, pegamos adesivos e escrevemos tr√™s tipos de pap√©is: <br><ol><li>  O que teve sucesso no produto?  O que os usu√°rios elogiaram?  O que nunca ouviu reclama√ß√µes?  Do que voc√™ gostou? </li><li>  O que falhou?  Quais eram os problemas constantemente?  O que dificultou o trabalho e por que eles come√ßaram uma nova filial? </li><li>  O que pode ser mudado?  O que os usu√°rios solicitam?  O que os membros da equipe querem mudar? </li></ol><br>  O grupo de pessoas que estragam o papel com zelo deve incluir aqueles que est√£o em contato pr√≥ximo com o produto h√° s√©culos e aqueles que podem dar uma nova olhada no produto.  N√£o se esque√ßa da solicita√ß√£o de recursos e do gerente de produtos.  Adesivos prontos s√£o colados no quadro, eles definitivamente nos ajudar√£o. <br><img src="https://habrastorage.org/webt/u8/wv/dp/u8wvdprmraomcmn1ykdj7fhht7i.png"><br>  De volta √† hist√≥ria.  Examinamos um peda√ßo de c√≥digo em que o padr√£o C ++ 98 coexiste pacificamente com chamadas da biblioteca C.  Lembramos que 2018 √© o ano e decidimos deix√°-lo em paz.  Mas como repetir a funcionalidade de trabalhar com m√°quinas virtuais (VMs), tornando o c√≥digo mais compacto e conveniente para o trabalho? <br><br>  Estudamos a quest√£o, entendemos que, independentemente da solu√ß√£o e do idioma escolhido, ser√° um inv√≥lucro na biblioteca C.  Como uma op√ß√£o interessante, vale a pena notar que a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">biblioteca do Go do DigitalOcean</a> , usa o protocolo RPC para se comunicar diretamente com a libvirt, mas tem suas desvantagens.  N√≥s nos instalamos na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">biblioteca Python</a> . <br><br>  Como resultado, obtivemos a velocidade de escrever c√≥digo, facilidade de uso e leitura.  Vale a pena explicar essas belas palavras. <br><ul><li>  <b>Velocidade</b> .  Agora, podemos prototipar rapidamente uma certa parte do trabalho com o dom√≠nio diretamente do console no servidor de depura√ß√£o, sem reconstruir o aplicativo principal. </li><li>  <b>Simplicidade</b> .  Em vez de chamar muitos m√©todos C ++ em um determinado manipulador, temos uma chamada de script Python com passagem de par√¢metro. </li><li>  <b>A depura√ß√£o</b> tamb√©m <b>√© o</b> mais r√°pida e indolor poss√≠vel.  Na minha opini√£o, a longo prazo, isso pode trazer uma experi√™ncia interessante para o usu√°rio.  Imagine, o administrador do sistema, infeliz por suas m√°quinas virtuais estarem aguardando um desligamento antes da destrui√ß√£o, e redefine o script para o m√©todo host_stop.  <s>Tamb√©m posso escrever um painel para voc√™?</s> </li></ul><br>  Como resultado, obtivemos uma ferramenta simples e conveniente para trabalhar com m√°quinas virtuais no n√≠vel do servidor. <br><br><h2>  A segunda hist√≥ria.  Um produto bem embalado n√£o precisa de car√≠cias adicionais <br></h2><h5>  <font color="#787979">Distribui√ß√£o de produtos: recusamos muitos pacotes e passamos para o Docker</font> </h5><br><img src="https://habrastorage.org/webt/dr/ow/wm/drowwmt-ru8iwccg64mlsjmmc8y.png"><br>  O VMmanager 5 √© distribu√≠do como um conjunto de pacotes Linux.  O CentOS 6/7 e, at√© recentemente, o Debian 7. s√£o suportados O que isso significa?  Isso significa mais servidores de cria√ß√£o para CI / CD, mais testes e mais aten√ß√£o ao c√≥digo.  Devemos lembrar que quando no reposit√≥rio oficial do CentOS 7 qemu vers√£o 1.5.3, no CentOS 6 √© 0.12.1.  Ao mesmo tempo, o usu√°rio pode usar reposit√≥rios nos quais a vers√£o deste pacote √© muito maior.  Isso significa que voc√™ precisa oferecer suporte a diferentes vers√µes da API ao trabalhar com VMs, em particular durante a migra√ß√£o.  Devemos lembrar a diferen√ßa entre inicializadores (init, systemd), levar em considera√ß√£o a diferen√ßa nos nomes de pacotes e utilit√°rios.  Os utilit√°rios que funcionam no CentOS n√£o funcionar√£o no Debian, ou suas vers√µes nos reposit√≥rios oficiais variam amplamente.  Para cada push, voc√™ precisa coletar pacotes para todas as vers√µes, e √© aconselh√°vel n√£o esquecer de test√°-los tamb√©m. <br><br>  Tudo isso no novo produto n√£o combina conosco.  Para n√£o suportar l√≥gica diferente, abandonamos v√°rios sistemas e deixamos apenas o CentOS 7. O problema foi resolvido?  Na verdade n√£o. <br><br>  Tamb√©m n√£o queremos verificar a vers√£o do sistema operacional antes da instala√ß√£o, se os utilit√°rios necess√°rios est√£o dispon√≠veis, quais regras est√£o instaladas no SELinux e n√£o queremos reconfigurar as listas de firewall e reposit√≥rio.  Gostaria de uma vez - e √© tudo, clicando em para <s>destruir cada segundo para</s> implantar todo o ambiente e o pr√≥prio produto.  Diz-se - feito, o projeto √© embrulhado em um cont√™iner de encaixe. <br><br>  Agora basta: <br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># docker pull vmmanager # docker run -d vmmanager:latest</span></span></code> </pre> <br>  O painel est√° instalado e funcionando. <br><br>  √â claro que estou exagerando, o usu√°rio deve instalar o Docker por conta pr√≥pria e temos mais de um cont√™iner, e atualmente o VMmanager √© executado no modo enxame como um servi√ßo SaaS.  Sobre o que encontramos ao escolher o Docker e como resolv√™-lo, voc√™ pode escrever um artigo separado. <br><br>  O fato em si √© o qu√£o importante √© simplificar o desenvolvimento e, o mais importante - a implanta√ß√£o do seu produto, install.sh, que ocupava <a href="">2097 linhas</a> . <br><br>  Como resultado: <br><ol><li>  Um ambiente de instala√ß√£o homog√™neo do produto simplifica o c√≥digo do programa e reduz os custos de montagem e teste. </li><li>  Distribuir o aplicativo como um cont√™iner de docker torna a implanta√ß√£o simples e previs√≠vel. </li></ol><br><h2>  A terceira hist√≥ria.  Primeiro relacionamento com microsservi√ßos <br></h2><h5>  <font color="#787979">Arquitetura: abandonamos o mon√≥lito em favor dos microsservi√ßos, ou n√£o</font> </h5><br><img src="https://habrastorage.org/webt/h0/x5/hv/h0x5hv2builkoorlw3wxiheknru.png"><br>  A quinta vers√£o do produto √© um grande sistema monol√≠tico com o padr√£o C ++ desatualizado.  Como resultado, a implementa√ß√£o problem√°tica de novas tecnologias e a dificuldade de refatorar o c√≥digo legado, baixa escala horizontal.  Na nova filial, eles decidiram usar a abordagem de microsservi√ßo como uma das maneiras de evitar esses problemas. <br><br>  Os microsservi√ßos s√£o uma tend√™ncia moderna que possui vantagens e desvantagens.  Tentarei apresentar minha vis√£o dos pontos fortes dessa arquitetura e falar sobre a solu√ß√£o dos problemas que ela traz ao projeto.  Vale a pena notar que este ser√° o primeiro olhar para a arquitetura de microsservi√ßo na pr√°tica, do lado de um desenvolvedor comum.  Aspectos que provavelmente n√£o mencionarei s√£o abordados em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bom artigo de revis√£o</a> . <br><br><h3>  Lado positivo </h3><br>  <b>O servi√ßo pequeno oferece muitas oportunidades.</b> <br>  Al√©m da conveni√™ncia de escrever, testar e depurar, os microsservi√ßos introduziram uma nova linguagem de programa√ß√£o no projeto.  Quando seu projeto √© um mon√≥lito, √© dif√≠cil imaginar que um dia voc√™ tente reescrever parte dele em outro idioma que lhe interesse.  Na arquitetura de microsservi√ßos - por favor.  Al√©m da linguagem de programa√ß√£o, voc√™ tamb√©m pode experimentar novas tecnologias, com a √∫nica ressalva de que tudo isso ser√° justificado para os neg√≥cios.  Por exemplo, escrevemos alguns dos microsservi√ßos em Golang, economizando bastante tempo. <br><br>  <b>Dimensionamento da equipe</b> <br>  Podemos dividir muitas pessoas que se comprometeram com um reposit√≥rio e tentaram manter a estrutura do mon√≥lito em suas cabe√ßas em v√°rias equipes.  Cada equipe estar√° envolvida em seu servi√ßo.  Al√©m disso, a entrada de uma nova pessoa no trabalho √© muito mais simples e r√°pida, devido ao contexto limitado em que ele trabalhar√°.  Por outro lado, h√° menos agregadores de pessoas do conhecimento mundial, que sempre podem ser descobertos sobre qualquer aspecto de um sistema imenso.  Talvez com o tempo eu reconsidere minha atitude a esse respeito. <br><br>  <b>Degrada√ß√£o independente</b> <br>  Eu atribuiria a degrada√ß√£o independente aos lados positivo e negativo dos microsservi√ßos, porque quem precisa do seu aplicativo se, por exemplo, existir um servi√ßo de autoriza√ß√£o?  No entanto, este ainda √© um lado positivo.  Anteriormente, a coleta de estat√≠sticas de v√°rias centenas de m√°quinas virtuais fazia nosso mon√≥lito trabalhar duro, no momento do pico de carregamento, a espera por um pedido do usu√°rio aumentava significativamente.  Um servi√ßo de coleta de estat√≠sticas separado pode colet√°-lo sem afetar outros servi√ßos, enquanto ainda pode ser dimensionado adicionando novo hardware ou aumentando o n√∫mero de coletores das mesmas estat√≠sticas.  E podemos at√© selecionar um servidor separado para o Graphite, onde este servi√ßo registra estat√≠sticas.  Com um mon√≥lito, onde h√° uma base, isso √© imposs√≠vel. <br><br><h3>  Lado negativo </h3><br>  <b>Contexto da solicita√ß√£o</b> <br>  Toda a minha depura√ß√£o no mon√≥lito se resumiu a duas consultas no console: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># tail -n 460 var/vmmgr.log | grep ERR # tail -n 460 var/vmmgr.log | grep thread_id_with_err</span></span></code> </pre> <br>  Feito!  Posso acompanhar a solicita√ß√£o inteira, desde o recebimento at√© o sistema at√© que ocorra um erro. <br><br>  Mas e agora, quando a solicita√ß√£o viaja do microsservi√ßo para o microsservi√ßo, acompanhada de chamadas adicionais para servi√ßos e registros vizinhos em v√°rios bancos de dados?  Para isso, implementamos as informa√ß√µes da solicita√ß√£o, que cont√™m o identificador da solicita√ß√£o e informa√ß√µes sobre o usu√°rio ou servi√ßo que a produziu.  Portanto, fica mais f√°cil rastrear toda a cadeia de eventos, mas o desejo √© escrever um servi√ßo de agrega√ß√£o de logs, porque, afinal, temos uma arquitetura de microsservi√ßo.  Voc√™ tamb√©m pode procurar o Elasticsearch, esse problema est√° aberto e ser√° resolvido em breve. <br><br>  <b>Inconsist√™ncia de dados</b> <br>  Os dados nos microsservi√ßos s√£o descentralizados, n√£o h√° um banco de dados √∫nico no qual todas as informa√ß√µes s√£o armazenadas.  Ao refletir sobre este artigo, analisei as principais intera√ß√µes entre microsservi√ßos em minha mente - onde podemos obter duplicatas, onde usamos transa√ß√µes entre redes - e percebi que resolvemos o problema de inconsist√™ncia com um mon√≥lito. <br><br>  Realmente constru√≠mos um mon√≥lito com uma base principal, envolvendo a maioria das a√ß√µes transacionais.  E ao redor do mon√≥lito foram coletados todos os microsservi√ßos que n√£o afetam a consist√™ncia dos dados principais.  A exce√ß√£o √© um monte de autoriza√ß√£o de servi√ßo + mon√≥lito.  O problema nesse caso √© que o banco de dados do aplicativo base n√£o cont√©m usu√°rios, suas fun√ß√µes e par√¢metros adicionais, tudo isso no servi√ßo de autoriza√ß√£o. <br><br>  O usu√°rio do sistema pode trabalhar com m√°quinas virtuais em um mon√≥lito, enquanto no servi√ßo de autoriza√ß√£o seus direitos podem mudar ou ele ser√° completamente bloqueado.  O sistema deve responder a isso em tempo h√°bil.  Nessa situa√ß√£o, a consist√™ncia dos dados √© alcan√ßada verificando os par√¢metros do usu√°rio antes de executar qualquer solicita√ß√£o. <br><br>  Quanto aos microsservi√ßos restantes, a incapacidade de se registrar no servi√ßo de estat√≠sticas n√£o afeta a opera√ß√£o da m√°quina virtual e essa a√ß√£o sempre pode ser repetida.  Bem, estamos fazendo um microsservi√ßo de coleta de estat√≠sticas.  Mas o servi√ßo de dom√≠nio define (criando uma m√°quina virtual usando libvirt) nunca ver√° a luz, pois quem precisa de um espa√ßo em branco da m√°quina sem sua exist√™ncia real. <br><br><h2>  A quarta hist√≥ria.  Fresco √© o inimigo do bem <br></h2><h5>  <font color="#787979">Implanta√ß√£o de VM: instalando a partir de imagens, em vez de instalar atrav√©s de uma rede</font> </h5><br>  Na quinta vers√£o do produto, a implanta√ß√£o de uma m√°quina virtual leva muito tempo para padr√µes reais.  O motivo disso √© a instala√ß√£o do sistema operacional pela rede. <br><br>  Para Centos, Fedora, RedHat √© o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">m√©todo kickstart</a> : <br>  1. Crie um arquivo de kickstart. <br>  2. Especifique o link para o arquivo de resposta nos par√¢metros do kernel linux inst.ks = &lt;link para o arquivo kickstart&gt;. <br>  3. Execute a instala√ß√£o do kickstart. <br><br>  O arquivo Kickstart √© bastante flex√≠vel, nele voc√™ pode descrever todas as etapas da instala√ß√£o, come√ßando pelo m√©todo e definindo o fuso hor√°rio, terminando com o particionamento do disco e a configura√ß√£o da rede.  O par√¢metro url em nossos modelos indica que a instala√ß√£o √© de um servidor remoto. <br><br>  Para Debian e Ubuntu, o m√©todo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">preseed</a> : <br>  √â semelhante ao anterior, esse m√©todo tamb√©m √© constru√≠do em torno do arquivo de configura√ß√£o e seu conte√∫do.  Nele, tamb√©m configuramos a instala√ß√£o pela rede. <br><br>  A instala√ß√£o do FreeBSD √© semelhante, mas em vez de um arquivo kickstart, existe um shell script de nossa pr√≥pria produ√ß√£o. <br><br><h3>  Aspectos positivos da abordagem </h3><br>  Esta op√ß√£o de instala√ß√£o permite que voc√™ use um modelo em nossos dois produtos: VMmanager e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DCImanager</a> (gerenciamento de servidores dedicados). <br><br>  A implanta√ß√£o de m√°quinas virtuais √© bastante flex√≠vel, o administrador do painel pode simplesmente copiar o modelo do sistema operacional e alterar o arquivo de configura√ß√£o como achar melhor. <br><br>  Todos os usu√°rios sempre t√™m vers√µes atualizadas dos sistemas operacionais, se forem atualizados em tempo h√°bil em um servidor remoto. <br><br><img src="https://habrastorage.org/webt/8w/z_/bk/8wz_bkz62ncaywrpb3mbd-eoyae.png"><br><br><h3>  Lado negativo </h3><br>  Como a pr√°tica demonstrou, os usu√°rios do VMmanager n√£o precisavam de flexibilidade de instala√ß√£o: em compara√ß√£o com servidores dedicados, poucas pessoas se preocupavam com configura√ß√µes espec√≠ficas de arquivos kickstart para m√°quinas virtuais.  Mas esperar pela instala√ß√£o do sistema operacional era realmente um luxo inadmiss√≠vel.  O outro lado da relev√¢ncia dos sistemas operacionais √© que parte do instalador est√° na rede e parte local do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">initrd</a> .  E suas vers√µes devem corresponder. <br><br>  Estes s√£o problemas solucion√°veis.  Voc√™ pode criar um pool de m√°quinas instaladas e criar seu pr√≥prio reposit√≥rio para sistemas operacionais, mas isso implica custos adicionais. <br><br>  Como resolver esses problemas sem criar reposit√≥rios e pools?  Selecionamos os arquivos de imagem do sistema operacional.  Agora, o processo de instala√ß√£o fica assim: <br>  1. Copiando a imagem do sistema operacional para o disco da m√°quina virtual. <br>  2. Aumente a se√ß√£o principal da imagem pelo tamanho do espa√ßo livre ap√≥s a c√≥pia. <br>  3. Configura√ß√£o b√°sica (configura√ß√£o de senha, fuso hor√°rio etc.). <br><br>  Tudo novo √© bem esquecido de idade.  Usamos imagens do SO no VDSmanager-Linux, o progenitor do VMmanager. <br><br>  Mas e a flexibilidade de instala√ß√£o?  A pr√°tica mostrou que a maioria dos usu√°rios n√£o est√° interessada em configura√ß√µes espec√≠ficas de rede e mapeamento de disco em m√°quinas virtuais. <br>  E a relev√¢ncia dos dados?  Isso pode ser alcan√ßado pela presen√ßa de imagens com as vers√µes mais recentes do SO no reposit√≥rio, e pequenas atualiza√ß√µes podem ser instaladas no script de configura√ß√£o inicial.  Assim, a m√°quina virtual j√° estar√° criada e em execu√ß√£o e, para isso, voc√™ encontrar√° a atualiza√ß√£o condicional do yum em execu√ß√£o. <br><br>  Em troca, obtemos uma m√°quina virtual pronta, cuja implanta√ß√£o depende apenas da c√≥pia do disco, do aumento da parti√ß√£o do disco e da inicializa√ß√£o do sistema operacional.  A implementa√ß√£o dessa abordagem para trabalhar com m√°quinas nos d√° a oportunidade de criar nossas pr√≥prias imagens e compartilh√°-las.  O usu√°rio pode instalar um pacote <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">configur√°vel LAMP</a> ou algum ambiente complexo na m√°quina virtual e criar uma imagem dessa m√°quina.  Agora, outras pessoas n√£o precisar√£o perder tempo instalando os utilit√°rios necess√°rios. <br><br>  Implementamos a configura√ß√£o e modifica√ß√£o de parti√ß√µes usando os utilit√°rios do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conjunto libguestfs</a> .  Por exemplo, alterar uma senha em uma m√°quina Linux passou de 40 linhas de c√≥digo, consistindo em mount, chroot e usermod, em uma linha: <br><br><pre> <code class="cpp hljs">command = <span class="hljs-string"><span class="hljs-string">"/usr/bin/virt-customize --root-password password:{password} --domain '{domain_name}'"</span></span>.format(password=args.password, domain_name=args.domain_name)</code> </pre> <br>  Como resultado, conseguimos obter a m√°quina virtual finalizada o mais r√°pido poss√≠vel.  Vale ressaltar que, com a configura√ß√£o da rede e a instala√ß√£o de scripts internos, o tempo de implanta√ß√£o aumentou um pouco.  Resolvemos esse problema exibindo as etapas de instala√ß√£o no front-end, preenchendo assim a pausa formada entre a cria√ß√£o e a prontid√£o completa da m√°quina. <br><br>  Tamb√©m tivemos uma abordagem mais flex√≠vel para implantar m√°quinas virtuais, com base nas quais √© conveniente criar suas pr√≥prias imagens com o ambiente necess√°rio. <br><br><h2>  O que voc√™ conseguiu fazer </h2><br>  Na sexta vers√£o do produto, tentamos levar em considera√ß√£o a principal desvantagem da quinta: a complexidade da intera√ß√£o do usu√°rio com o produto.  Reduzimos o prazo de entrega das principais a√ß√µes.  Juntamente com uma interface sem bloqueio, isso possibilita o trabalho com o painel sem uma espera for√ßada.  A conteineriza√ß√£o tornou o processo de instala√ß√£o do produto mais f√°cil e conveniente.  O uso de tecnologias modernas e v√°rias linguagens de programa√ß√£o simplificou o suporte e a manuten√ß√£o para programadores e especialistas em suporte t√©cnico.  A mudan√ßa para microsservi√ßos permitiu adicionar novos recursos rapidamente e com pequenas restri√ß√µes. <br><br>  Concluindo, quero dizer que o novo produto √© uma boa oportunidade para tentar outras abordagens de desenvolvimento, novas tecnologias.  Vale lembrar por que voc√™ est√° fazendo isso, que novidades isso trar√° para voc√™ e seus usu√°rios.  V√° em frente! <br><br><blockquote>  Convidamos a comunidade Habr a ver a vers√£o beta do VMmanager 6 e deixar seus coment√°rios.  Para fazer isso, acesse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">my.saasvm.com</a> , fa√ßa login e conecte um servidor dedicado (CentOS 7 x64, acesso √† Internet, endere√ßo IP p√∫blico). <br><br>  Se voc√™ n√£o possui um servidor, escreva-nos para <a href="">help@ispsystem.com</a> ou converse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no site</a> , forneceremos equipamentos de teste de nosso parceiro, Selectel. <br><br>  Leia mais <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">nas not√≠cias no site do ISPsystem</a> . <br></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt441968/">https://habr.com/ru/post/pt441968/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt441954/index.html">Recompensa do usu√°rio aos autores de Habr</a></li>
<li><a href="../pt441956/index.html">Tratamento de erro unificado (op√ß√£o C ++ para microcontroladores)</a></li>
<li><a href="../pt441962/index.html">√çndices no PostgreSQL - 1</a></li>
<li><a href="../pt441964/index.html">Dicas e truques do Kubernetes: movendo recursos de cluster para o Helm 2</a></li>
<li><a href="../pt441966/index.html">Kit de inicia√ß√£o para testes de seguran√ßa na Web</a></li>
<li><a href="../pt441970/index.html">An√°lise do Butkit FinFisher</a></li>
<li><a href="../pt441972/index.html">Invidious - front-end alternativo do YouTube</a></li>
<li><a href="../pt441974/index.html">O caminho do historiador de RH para programadores Java: um pouco de sorte e perseveran√ßa</a></li>
<li><a href="../pt441976/index.html">Com voc√™ FizTech.Science: estamos procurando par√¢metros ocultos e mergulhando no maravilhoso mundo qu√¢ntico</a></li>
<li><a href="../pt441978/index.html">Teste funcional das habilidades do Yandex Alice no Node.js</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>