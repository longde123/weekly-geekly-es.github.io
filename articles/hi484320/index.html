<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСиЁЯП╜тАНЁЯПл ЁЯУП ЁЯШ╖ рдХреНрд╡рд╛рд░реНрдХрд╕, рдХреЛрдЯрд▓рд┐рди рдФрд░ рдЧреНрд░реИрдбрд▓ рдкрд░ рдПрдХ рдорд╛рдЗрдХреНрд░реЛ рд╕рд░реНрд╡рд┐рд╕ рдмрдирд╛рдирд╛ ЁЯСйЁЯП╛тАНЁЯМ╛ ЁЯСзЁЯП╗ ЁЯдЩЁЯП┐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдкрд░рд┐рдЪрдп 


 рдкрд┐рдЫрд▓реЗ рд▓реЗрдЦ рдореЗрдВ, рд╣рдордиреЗ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдЖрдзреБрдирд┐рдХ JVM рдЪреМрдЦрдЯреЗ рдкрд░ рдПрдХ microservice рдмрдирд╛рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╡рд░реНрдгрди рдХрд┐рдпрд╛, рд╕рд╛рде рд╣реА рд╕рд╛рде рдЙрдирдХреА рддреБрд▓рдирд╛ рднреА рдХреАред рдЗрд╕ рдЖрд▓реЗрдЦ рдо...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдХреНрд╡рд╛рд░реНрдХрд╕, рдХреЛрдЯрд▓рд┐рди рдФрд░ рдЧреНрд░реИрдбрд▓ рдкрд░ рдПрдХ рдорд╛рдЗрдХреНрд░реЛ рд╕рд░реНрд╡рд┐рд╕ рдмрдирд╛рдирд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484320/"><p><img src="https://habrastorage.org/webt/b0/c8/k8/b0c8k8k4cxgj8-czvjdrgn6uxgk.jpeg"></p><br><h2 id="vvedenie">  рдкрд░рд┐рдЪрдп </h2><br><p>  <a href="https://romankudryashov.com/blog/2020/01/heterogeneous-microservices/" rel="nofollow">рдкрд┐рдЫрд▓реЗ рд▓реЗрдЦ рдореЗрдВ,</a> рд╣рдордиреЗ рд╕рдВрдХреНрд╖реЗрдк рдореЗрдВ рдЖрдзреБрдирд┐рдХ JVM рдЪреМрдЦрдЯреЗ рдкрд░ рдПрдХ microservice рдмрдирд╛рдиреЗ рдХреА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХрд╛ рд╡рд░реНрдгрди рдХрд┐рдпрд╛, рд╕рд╛рде рд╣реА рд╕рд╛рде рдЙрдирдХреА рддреБрд▓рдирд╛ рднреА рдХреАред  рдЗрд╕ рдЖрд▓реЗрдЦ рдореЗрдВ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдЬрд╛рд░реА рдХрд┐рдП рдЧрдП <a href="https://quarkus.io/" rel="nofollow">рдХреНрд╡рд╛рд░реНрдХрд╕</a> рдореЗрдВ рдЙрд▓реНрд▓реЗрдЦрд┐рдд рдкреНрд░реМрджреНрдпреЛрдЧрд┐рдХрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрдХ рдорд╛рдЗрдХреНрд░реЛрд╕реЗрд╡рд╛ рдмрдирд╛рдиреЗ рдФрд░ рдореБрдЦреНрдп рд▓реЗрдЦ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдЪрд░реНрдЪрд╛ рдХреА рдЬрд╛рдПрдЧреАред  рдкрд░рд┐рдгрд╛рдореА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдорд╛рдЗрдХреНрд░реЛрд╕рд░реНрд╡рд┐рд╕ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХрд╛ рд╣рд┐рд╕реНрд╕рд╛ рдмрди рдЬрд╛рдПрдЧрд╛: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f09/7fd/476/f097fd47661517c348a85a4d3251ecb4.png" alt="рд▓рдХреНрд╖реНрдп рд╡рд╛рд╕реНрддреБрдХрд▓рд╛"></p><a name="habracut"></a><br><p>  рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХрд╛ рд╕реНрд░реЛрдд рдХреЛрдб, рд╣рдореЗрд╢рд╛ рдХреА рддрд░рд╣, <a href="https://github.com/rkudryashov/heterogeneous-microservices/tree/master/quarkus-service" rel="nofollow">GitHub</a> рдкрд░ рдЙрдкрд▓рдмреНрдз <a href="https://github.com/rkudryashov/heterogeneous-microservices/tree/master/quarkus-service" rel="nofollow">рд╣реИ</a> ред </p><br><p>  рдПрдХ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реНрдерд╛рдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП: </p><br><ul><li>  Jdk 13 </li><li>  <a href="https://www.consul.io/" rel="nofollow">рдХреМрдВрд╕рд▓</a> </li></ul><br><h2 id="sozdanie-novogo-proekta">  рдПрдХ рдирдпрд╛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдПрдВ </h2><br><p>  рдПрдХ рдирдпрд╛ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, <a href="https://code.quarkus.io/" rel="nofollow">рд╡реЗрдм рд╕реНрдЯрд╛рд░реНрдЯрд░</a> рдпрд╛ рдорд╛рд╡реЗрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ ( <a href="https://quarkus.io/guides/getting-started" rel="nofollow">рдорд╛рд╡реЗрди</a> рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдпрд╛ <a href="https://quarkus.io/guides/gradle-tooling" rel="nofollow">рдЧреНрд░реИрдбрд▓</a> рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП)ред  рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рд░реВрдкрд░реЗрдЦрд╛ рдЬрд╛рд╡рд╛, рдХреЛрдЯрд▓рд┐рди рдФрд░ рд╕реНрдХрд╛рд▓рд╛ рднрд╛рд╖рд╛рдУрдВ рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддреА рд╣реИред </p><br><h2 id="zavismosti">  zavismosti </h2><br><p>  рдЗрд╕ рдкрд░рд┐рдпреЛрдЬрдирд╛ рдореЗрдВ, рдЧреНрд░реИрдбрд▓ рдХреЛрдЯрд▓рд┐рди рдбреАрдПрд╕рдПрд▓ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдкреНрд░рдгрд╛рд▓реА рдХреЗ рд░реВрдк рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдмрд┐рд▓реНрдб рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдореЗрдВ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП: </p><br><ul><li><p>  рдкреНрд▓рдЧ-рдЗрди <br>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 1. <a href="" rel="nofollow">build.gradle.kts</a></em> </p><br><pre><code class="kotlin hljs">plugins { kotlin(<span class="hljs-string"><span class="hljs-string">"jvm"</span></span>) kotlin(<span class="hljs-string"><span class="hljs-string">"plugin.allopen"</span></span>) id(<span class="hljs-string"><span class="hljs-string">"io.quarkus"</span></span>) }</code> </pre> <br><p>  рдкреНрд▓рдЧрдЗрди рд╕рдВрд╕реНрдХрд░рдг рд╕рдВрдХрд▓реНрдк <a href="" rel="nofollow"><code>settings.gradle.kts</code></a> рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br></li><li><p>  рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ <br>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 2. <a href="" rel="nofollow">build.gradle.kts</a></em> </p><br><pre> <code class="kotlin hljs">dependencies { ... implementation(enforcedPlatform(<span class="hljs-string"><span class="hljs-string">"io.quarkus:quarkus-bom:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$quarkusVersion</span></span></span><span class="hljs-string">"</span></span>)) implementation(<span class="hljs-string"><span class="hljs-string">"io.quarkus:quarkus-resteasy-jackson"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"io.quarkus:quarkus-rest-client"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"io.quarkus:quarkus-kotlin"</span></span>) implementation(<span class="hljs-string"><span class="hljs-string">"io.quarkus:quarkus-config-yaml"</span></span>) testImplementation(<span class="hljs-string"><span class="hljs-string">"io.quarkus:quarkus-junit5"</span></span>) ... }</code> </pre> <br><p>  Maven BOM рдХреЗ рдЖрдпрд╛рдд рдХреА рдЬрд╛рдирдХрд╛рд░реА <a href="https://docs.gradle.org/current/userguide/platforms.html" rel="nofollow">рдЧреНрд░реИрдбрд▓ рдкреНрд░рд▓реЗрдЦрди</a> рдореЗрдВ рдЙрдкрд▓рдмреНрдз рд╣реИред </p><br></li></ul><br><p>  рдЖрдкрдХреЛ рдХреБрдЫ рдХреЛрдЯрд▓рд┐рди рдХрдХреНрд╖рд╛рдПрдВ <code>open</code> рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ (рд╡реЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ <code>final</code> рд╣реИрдВ, <a href="https://quarkus.io/guides/kotlin" rel="nofollow">рдХреНрд╡рд╛рд░реНрдХрд╕ рдХреНрд▓реИрдорд▓рд┐рди</a> рдореЗрдВ рдЧреНрд░реЗрдб рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 3. <a href="" rel="nofollow">build.gradle.kts</a></em> </p><br><pre> <code class="kotlin hljs">allOpen { <span class="hljs-keyword"><span class="hljs-keyword">annotation</span></span>(<span class="hljs-string"><span class="hljs-string">"javax.enterprise.context.ApplicationScoped"</span></span>) }</code> </pre> <br><h2 id="konfigurirovanie">  рдХрд╛ рд╡рд┐рдиреНрдпрд╛рд╕ </h2><br><p>  рдлреНрд░реЗрдорд╡рд░реНрдХ рд╕рдВрдкрддреНрддрд┐рдпреЛрдВ рдФрд░ YAML рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХрд╛ рд╕рдорд░реНрдерди рдХрд░рддрд╛ рд╣реИ <br>  ( <a href="https://quarkus.io/guides/config" rel="nofollow">рдХреНрд╡рд╛рд░реНрдХрд╕ рдХреЙрдиреНрдлрд┐рдЧ рдЧрд╛рдЗрдб</a> рдореЗрдВ рдЕрдзрд┐рдХ)ред  рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдлрд╝рд╛рдЗрд▓ <code>resources</code> рдлрд╝реЛрд▓реНрдбрд░ рдореЗрдВ рд╕реНрдерд┐рдд рд╣реИ рдФрд░ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрддрд╛ рд╣реИ: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 4. <a href="" rel="nofollow">application.yaml</a></em> </p><br><pre> <code class="plaintext hljs">quarkus: http: host: localhost port: 8084 application-info: name: quarkus-service framework: name: Quarkus release-year: 2019</code> </pre> <br><p>  рдЗрд╕ рдХреЛрдб рдХреЗ рдЯреБрдХрдбрд╝реЗ рдореЗрдВ, microservice рдХреЗ рдорд╛рдирдХ рдФрд░ рдХрд╕реНрдЯрдо рдкреИрд░рд╛рдореАрдЯрд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдП рдЧрдП рд╣реИрдВред  рдЙрддреНрддрд░рд╛рд░реНрджреНрдз рдХреЛ рдЗрд╕ рддрд░рд╣ рдкрдврд╝рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 5. рд░реАрдбрд┐рдВрдЧ рдХрд╕реНрдЯрдо рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреИрд░рд╛рдореАрдЯрд░ ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд рдХреЛрдб</a> )</em> </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> io.quarkus.arc.config.ConfigProperties <span class="hljs-meta"><span class="hljs-meta">@ConfigProperties(prefix = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"application-info"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApplicationInfoProperties</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> name: String <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> framework: FrameworkConfiguration <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FrameworkConfiguration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> name: String <span class="hljs-keyword"><span class="hljs-keyword">lateinit</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> releaseYear: String } }</code> </pre> <br><h2 id="biny">  рдмреАрдирд╛ </h2><br><p>  рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдЖрдк рдХреЛрдб рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ, рдпрд╣ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдХреНрд╡рд╛рд░реНрдХрд╕ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕реНрд░реЛрдд рдХреЛрдб рдореЗрдВ рдХреЛрдИ рдореБрдЦреНрдп рд╡рд┐рдзрд┐ рдирд╣реАрдВ рд╣реИ (рд╣рд╛рд▓рд╛рдВрдХрд┐ рдпрд╣ <a href="https://github.com/quarkusio/quarkus/issues/6499" rel="nofollow">рдкреНрд░рдХрдЯ</a> рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред </p><br><p>  рдкрд┐рдЫрд▓реЗ рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рд╕реЗ <code>@ConfigProperties</code> рдмреАрди рдХреЛ рджреВрд╕рд░реА рдмреАрди рдореЗрдВ <code>@Inject</code> рдХрд░рдирд╛ <code>@Inject</code> рдПрдиреЛрдЯреЗрд╢рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 6. <code>@ConfigProperties</code> рдмреАрди ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд</a> ) рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛</em> </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@ApplicationScoped</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApplicationInfoService</span></span></span></span>( <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> applicationInfoProperties: ApplicationInfoProperties, <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> serviceClient: ServiceClient ) { ... }</code> </pre> <br><p>  <code>ApplicationInfoService</code> рдмреАрди рджреНрд╡рд╛рд░рд╛ <code>@ApplicationScoped</code> , рдмрджрд▓реЗ рдореЗрдВ, рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 7. <code>@ApplicationScoped</code> рдХреЛ <code>@ApplicationScoped</code> рдмреАрди ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд</a> )</em> </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApplicationInfoResource</span></span></span></span>( <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> applicationInfoService: ApplicationInfoService )</code> </pre> <br><p>  <a href="https://quarkus.io/guides/cdi-reference" rel="nofollow">рдХреНрд╡рд╛рд░реНрдХрд╕ рд╕реАрдбреАрдЖрдИ рдЧрд╛рдЗрдб</a> рдореЗрдВ <a href="https://quarkus.io/guides/cdi-reference" rel="nofollow">рдХреЙрдирдЯреЗрдХреНрд╕</a> рдФрд░ рдбрд┐рдкреЗрдВрдбреЗрдВрд╕реА рдЗрдВрдЬреЗрдХреНрд╢рди рдкрд░ рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реАред </p><br><h2 id="rest-kontroller">  рдЕрдиреНрдп рдирд┐рдпрдВрддреНрд░рдХ </h2><br><p>  рд╕реНрдкреНрд░рд┐рдВрдЧ рдлреНрд░реЗрдорд╡рд░реНрдХ рдпрд╛ рдЬрд╛рд╡рд╛ EE рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЛрдВ рдХреЗ рд▓рд┐рдП REST рдХрдВрдЯреНрд░реЛрд▓рд░ рдореЗрдВ рдХреБрдЫ рднреА рдЕрд╕рд╛рдорд╛рдиреНрдп рдирд╣реАрдВ рд╣реИ: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 8. рдмрд╛рдХреА рдирд┐рдпрдВрддреНрд░рдХ ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд</a> )</em> </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Path(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/application-info"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-meta"><span class="hljs-meta">@Produces(MediaType.APPLICATION_JSON)</span></span> <span class="hljs-meta"><span class="hljs-meta">@Consumes(MediaType.APPLICATION_JSON)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApplicationInfoResource</span></span></span></span>( <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> applicationInfoService: ApplicationInfoService ) { <span class="hljs-meta"><span class="hljs-meta">@GET</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@QueryParam(</span></span></span><span class="hljs-meta-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta"><span class="hljs-meta-string">"request-to"</span></span></span></span></span><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">)</span></span></span></span><span class="hljs-function"><span class="hljs-params"> requestTo: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span>: Response = Response.ok(applicationInfoService.<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(requestTo)).build() <span class="hljs-meta"><span class="hljs-meta">@GET</span></span> <span class="hljs-meta"><span class="hljs-meta">@Path(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/logo"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-meta"><span class="hljs-meta">@Produces(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"image/png"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">logo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: Response = Response.ok(applicationInfoService.getLogo()).build() }</code> </pre> <br><h2 id="rest-klient">  рдЕрдиреНрдп рдЧреНрд░рд╛рд╣рдХ </h2><br><p>  рдХреНрд╡рд╛рд░реНрдХрд╕ рдорд╛рдЗрдХреНрд░реЛрд╕рд╡рд░реНрдХ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╕реЗрд╡рд╛ рдХреЛ рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЪреВрдВрдХрд┐ рд╕рднреА рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рд╕рдорд╛рди рдПрдкреАрдЖрдИ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдпрд╣ рдХреЙрдорди рдХреЛрдб рдХреЗ рд▓рд┐рдП рдПрдХ рдПрдХрд▓ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИ рдФрд░ рдЖрд░рдИрдПрд╕рдЯреА рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХрд╛ рдПрдХ рд╕рдореВрд╣ рдЗрд╕реЗ рд╡рд┐рд░рд╛рд╕рдд рдореЗрдВ рджреЗрддрд╛ рд╣реИ: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 9. рдЕрдиреНрдп рдЧреНрд░рд╛рд╣рдХреЛрдВ ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд рдХреЛрдб</a> )</em> </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@ApplicationScoped</span></span> <span class="hljs-meta"><span class="hljs-meta">@Path(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ExternalServiceClient</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@GET</span></span> <span class="hljs-meta"><span class="hljs-meta">@Path(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"/application-info"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-meta"><span class="hljs-meta">@Produces(</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"application/json"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getApplicationInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>: ApplicationInfo } <span class="hljs-meta"><span class="hljs-meta">@RegisterRestClient(baseUri = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"http://helidon-service"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HelidonServiceClient</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExternalServiceClient @RegisterRestClient</span></span></span></span>(baseUri = <span class="hljs-string"><span class="hljs-string">"http://ktor-service"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">KtorServiceClient</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExternalServiceClient @RegisterRestClient</span></span></span></span>(baseUri = <span class="hljs-string"><span class="hljs-string">"http://micronaut-service"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MicronautServiceClient</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExternalServiceClient @RegisterRestClient</span></span></span></span>(baseUri = <span class="hljs-string"><span class="hljs-string">"http://quarkus-service"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QuarkusServiceClient</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExternalServiceClient @RegisterRestClient</span></span></span></span>(baseUri = <span class="hljs-string"><span class="hljs-string">"http://spring-boot-service"</span></span>) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpringBootServiceClient</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ExternalServiceClient</span></span></span></span></code> </pre> <br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХ REST рдХреНрд▓рд╛рдЗрдВрдЯ рдмрдирд╛рдирд╛, рд╕рдВрдмрдВрдзрд┐рдд JAX-RS рдФрд░ MicroProfile рдХреЗ рд╕рд╛рде рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдмрдирд╛рдирд╛ рд╣реИред </p><br><h2 id="service-discovery">  рд╕реЗрд╡рд╛ рдЦреЛрдЬ </h2><br><p>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдкрдиреЗ рдкрд┐рдЫрд▓реЗ рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рджреЗрдЦрд╛ рдерд╛, <code>baseUri</code> рдкреИрд░рд╛рдореАрдЯрд░ <code>baseUri</code> рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдирд╛рдо рд╣реИрдВред  рд▓реЗрдХрд┐рди рдЕрдм рддрдХ, рдХреНрд╡рд╛рд░реНрдХрд╕ рдХреЗ рдкрд╛рд╕ рд╕реЗрд╡рд╛ рдбрд┐рд╕реНрдХрд╡рд░реА ( <a href="https://github.com/quarkusio/quarkus/issues/2052" rel="nofollow">рдпреВрд░реЗрдХрд╛</a> ) рдХреЗ рд▓рд┐рдП рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╕рдорд░реНрдерди рдирд╣реАрдВ рд╣реИ рдпрд╛ рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ ( <a href="https://github.com/quarkusio/quarkus/issues/5812" rel="nofollow">рдХрдВрд╕рд▓</a> ), рдХреНрдпреЛрдВрдХрд┐ рд░реВрдкрд░реЗрдЦрд╛ рдореБрдЦреНрдп рд░реВрдк рд╕реЗ рдХреНрд▓рд╛рдЙрдб рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рдЙрджреНрджреЗрд╢реНрдп рд╕реЗ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╕реЗрд╡рд╛ рдбрд┐рд╕реНрдХрд╡рд░реА рдкреИрдЯрд░реНрди <a href="https://github.com/rickfast/consul-client" rel="nofollow">рдЬрд╛рд╡рд╛</a> рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХреЗ <a href="https://github.com/rickfast/consul-client" rel="nofollow">рд▓рд┐рдП рдХреМрдВрд╕рд▓ рдХреНрд▓рд╛рдЗрдВрдЯ</a> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рдХреМрдВрд╕рд▓ рдХреЗ рд▓рд┐рдП рдХреНрд▓рд╛рдЗрдВрдЯ рдореЗрдВ рджреЛ рд╡рд┐рдзрд┐рдпрд╛рдБ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, <code>register</code> рдФрд░ <code>getServiceInstance</code> (рд░рд╛рдЙрдВрдб-рд░реЙрдмрд┐рди рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ): </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 10. рдЧреНрд░рд╛рд╣рдХ рдХреЛ рдХреМрдВрд╕рд▓ ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд</a> )</em> </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@ApplicationScoped</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConsulClient</span></span></span></span>( <span class="hljs-meta"><span class="hljs-meta">@ConfigProperty(name = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"application-info.name"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> serviceName: String, <span class="hljs-meta"><span class="hljs-meta">@ConfigProperty(name = </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"quarkus.http.port"</span></span></span><span class="hljs-meta">)</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> port: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> ) { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> consulUrl = <span class="hljs-string"><span class="hljs-string">"http://localhost:8500"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> consulClient <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> lazy { Consul.builder().withUrl(consulUrl).build() } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> serviceInstanceIndex: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">register</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { consulClient.agentClient().register(createConsulRegistration()) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getServiceInstance</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(serviceName: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>: Service { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> serviceInstances = consulClient.healthClient().getHealthyServiceInstances(serviceName).response <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> selectedInstance = serviceInstances[serviceInstanceIndex] serviceInstanceIndex = (serviceInstanceIndex + <span class="hljs-number"><span class="hljs-number">1</span></span>) % serviceInstances.size <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> selectedInstance.service } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createConsulRegistration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = ImmutableRegistration.builder() .id(<span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$serviceName</span></span></span><span class="hljs-string">-</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$port</span></span></span><span class="hljs-string">"</span></span>) .name(serviceName) .address(<span class="hljs-string"><span class="hljs-string">"localhost"</span></span>) .port(port) .build() }</code> </pre> <br><p>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ рдЖрдкрдХреЛ рдЖрд╡реЗрджрди рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 11. рдХрдВрд╕рд▓ ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд</a> ) рдХреЗ рд╕рд╛рде рдкрдВрдЬреАрдХрд░рдг</em> </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@ApplicationScoped</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConsulRegistrationBean</span></span></span></span>( <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> consulClient: ConsulClient ) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStart</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-meta"><span class="hljs-function"><span class="hljs-params"><span class="hljs-meta">@Observes</span></span></span></span><span class="hljs-function"><span class="hljs-params"> event: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">StartupEvent</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { consulClient.register() } }</code> </pre> <br><p>  рдЕрдЧрд▓рд╛, рдЖрдкрдХреЛ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рдирд╛рдо рдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рд╕реНрдерд╛рди рдкрд░ рдмрджрд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдПрдХ рд╡рд░реНрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдЬреЛ <code>@Provider</code> рдФрд░ рдПрдиреЛрдЯреЗрдЯ <code>@Provider</code> рд╡рд┐рд╕реНрддрд╛рд░ рдХрд░рддрд╛ рд╣реИ: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 12. рд╕реЗрд╡рд╛ рдбрд┐рд╕реНрдХрд╡рд░реА ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд</a> ) рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдлрд╝рд┐рд▓реНрдЯрд░</em> </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Provider</span></span> <span class="hljs-meta"><span class="hljs-meta">@ApplicationScoped</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConsulFilter</span></span></span></span>( <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> consulClient: ConsulClient ) : ClientRequestFilter { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">filter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(requestContext: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">ClientRequestContext</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> serviceName = requestContext.uri.host <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> serviceInstance = consulClient.getServiceInstance(serviceName) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> newUri: URI = URIBuilder(URI.create(requestContext.uri.toString())) .setHost(serviceInstance.address) .setPort(serviceInstance.port) .build() requestContext.uri = newUri } }</code> </pre> <br><p>  рдлрд╝рд┐рд▓реНрдЯрд░ рдХреЗрд╡рд▓ <code>requestContext</code> рдХреЗ URI рдХреЛ рдХреНрд▓рд╛рдЗрдВрдЯ рд╕реЗ рдХреЙрдиреНрд╕реБрд▓ рдореЗрдВ рдкреНрд░рд╛рдкреНрдд рд╕реЗрд╡рд╛ рд╕реНрдерд╛рди рдХреЗ рд╕рд╛рде рдмрджрд▓ рджреЗрддрд╛ рд╣реИред </p><br><h2 id="testirovanie">  рдкрд░реАрдХреНрд╖рдг </h2><br><p>  REST рдПрд╢реНрдпреЛрд░реНрдб рд▓рд╛рдЗрдмреНрд░реЗрд░реА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рджреЛ API рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдЯреЗрд╕реНрдЯ рд▓рд╛рдЧреВ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 13. рдЯреЗрд╕реНрдЯ ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд</a> )</em> </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@QuarkusTest</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QuarkusServiceApplicationTest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testGet</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { given() .`<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>`().<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(<span class="hljs-string"><span class="hljs-string">"/application-info"</span></span>) .then() .statusCode(<span class="hljs-number"><span class="hljs-number">200</span></span>) .contentType(ContentType.JSON) .body(<span class="hljs-string"><span class="hljs-string">"name"</span></span>) { `<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>`(<span class="hljs-string"><span class="hljs-string">"quarkus-service"</span></span>) } .body(<span class="hljs-string"><span class="hljs-string">"framework.name"</span></span>) { `<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>`(<span class="hljs-string"><span class="hljs-string">"Quarkus"</span></span>) } .body(<span class="hljs-string"><span class="hljs-string">"framework.releaseYear"</span></span>) { `<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>`(<span class="hljs-number"><span class="hljs-number">2019</span></span>) } } <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">testGetLogo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { given() .`<span class="hljs-keyword"><span class="hljs-keyword">when</span></span>`().<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>(<span class="hljs-string"><span class="hljs-string">"/application-info/logo"</span></span>) .then() .statusCode(<span class="hljs-number"><span class="hljs-number">200</span></span>) .contentType(<span class="hljs-string"><span class="hljs-string">"image/png"</span></span>) .body(`<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>`(notNullValue())) } }</code> </pre> <br><p>  рдкрд░реАрдХреНрд╖рдг рдХреЗ рджреМрд░рд╛рди, рдХреЙрдиреНрд╕рд▓ рдХреЗ рд╕рд╛рде рдЖрд╡реЗрджрди рдХреЛ рдкрдВрдЬреАрдХреГрдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рд▓рд┐рдП, рдкрд░реАрдХреНрд╖рдг рдХреЗ рдмрдЧрд▓ рдореЗрдВ рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ рд╕реНрд░реЛрдд рдХреЛрдб рдореЗрдВ, <code>ConsulClientMock</code> , рдЬреЛ <code>ConsulClient</code> рд╡рд┐рд╕реНрддрд╛рд░ <code>ConsulClient</code> : </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 14. <code>ConsulClient</code> рд▓рд┐рдП рдирдХрд▓реА ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд</a> )</em> </p><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Mock</span></span> <span class="hljs-meta"><span class="hljs-meta">@ApplicationScoped</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConsulClientMock</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">ConsulClient</span></span></span></span>(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// do nothing override fun register() { } }</span></span></code> </pre> <br><h2 id="sborka">  рд╕рднрд╛ </h2><br><p>  <code>quarkusBuild</code> <code>build</code> рдХрд╛рд░реНрдп рдХреЗ рджреМрд░рд╛рди, <code>quarkusBuild</code> рдХрд╛рд░реНрдп <code>quarkusBuild</code> ред  рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ, рдпрд╣ рдПрдХ <em>рд░рдирд░</em> JAR рдФрд░ рдПрдХ <code>lib</code> рдлрд╝реЛрд▓реНрдбрд░ рдмрдирд╛рддрд╛ рд╣реИ рдЬрд╣рд╛рдБ рдирд┐рд░реНрднрд░рддрд╛рдПрдБ рд╕реНрдерд┐рдд рд╣реЛрддреА рд╣реИрдВред  Uber-JAR рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, <code>quarkusBuild</code> рдХрд╛рд░реНрдп рдХреЛ рдирд┐рдореНрдирд╛рдиреБрд╕рд╛рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ <code>quarkusBuild</code> рдЪрд╛рд╣рд┐рдП: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 15. uber-JAR рдкреАрдврд╝реА ( <a href="" rel="nofollow">рд╕реНрд░реЛрдд</a> ) рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдирд╛</em> </p><br><pre> <code class="kotlin hljs">tasks { withType&lt;QuarkusBuild&gt; { isUberJar = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } }</code> </pre> <br><p>  рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдЪрд▓рд╛рдПрдБ <code>./gradlew clean build</code> рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ рдореВрд▓ рдореЗрдВ <code>./gradlew clean build</code> ред </p><br><h2 id="zapusk">  рд▓рд╛рдВрдЪ </h2><br><p>  Microservice рд╢реБрд░реВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдЖрдкрдХреЛ Consul ( <a href="https://romankudryashov.com/blog/2020/01/heterogeneous-microservices/" rel="nofollow">рдореБрдЦреНрдп рд▓реЗрдЦ</a> рдореЗрдВ рд╡рд░реНрдгрд┐рдд) рд╢реБрд░реВ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред </p><br><p>  Microservice рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╢реБрд░реВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><br><ul><li>  <code>quarkusDev</code> рдХрд╛рд░реНрдп <br>  рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рдЬрдбрд╝ рдореЗрдВ рдЪрд▓рд╛рдПрдБ: <br> <code>./gradlew :quarkus-service:quarkusDev</code> <br>  рдпрд╛ IDE рдореЗрдВ рдХрд╛рд░реНрдп рдЪрд▓рд╛рдПрдБ </li><li>  uber-рдЬрд╛рд░ <br>  рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рдЬрдбрд╝ рдореЗрдВ рдЪрд▓рд╛рдПрдБ: <br> <code>java -jar quarkus-service/build/quarkus-service-1.0.0-runner.jar</code> </li> </ul><br><p>  рдЕрдм рдЖрдк REST API рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреНрд╡реЗрд░реА рдЪрд▓рд╛рдПрдБ: </p><br><p> <code>GET http://localhost:8084/application-info</code> </p> <br><p>  рдкрд░рд┐рдгрд╛рдо рд╣реЛрдЧрд╛: </p><br><p>  <em>рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ 16. рдПрдкреАрдЖрдИ рдХреЙрд▓ рдХрд╛ рдкрд░рд┐рдгрд╛рдо</em> </p><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"quarkus-service"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"framework"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Quarkus"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"releaseYear"</span></span>: <span class="hljs-number"><span class="hljs-number">2019</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"requestedService"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }</code> </pre> <br><h2 id="sovmestimost-s-spring">  рд╡рд╕рдВрдд рдХреА рдЕрдиреБрдХреВрд▓рддрд╛ </h2><br><p>  <a href="https://quarkus.io/guides/spring-di" rel="nofollow">DI</a> рд╡рд╕рдВрдд, <a href="https://quarkus.io/guides/spring-web" rel="nofollow">рд╡реЗрдм</a> , <a href="https://quarkus.io/guides/spring-security" rel="nofollow">рд╕реБрд░рдХреНрд╖рд╛</a> , <a href="https://quarkus.io/guides/spring-data-jpa" rel="nofollow">рдбреЗрдЯрд╛ JPA</a> : рдлреНрд░реЗрдорд╡рд░реНрдХ рдХрдИ рд╕реНрдкреНрд░рд┐рдВрдЧ рддрдХрдиреАрдХреЛрдВ рдХреЗ рд╕рд╛рде рд╕рдВрдЧрддрддрд╛ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред </p><br><h2 id="zaklyuchenie">  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br><p>  рд▓реЗрдЦ рдиреЗ рдХреЛрдЯрд▓рд┐рди рдФрд░ рдЧреНрд░реИрдбрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдХреНрд╡рд╛рд░реНрдХрд╕ рдкрд░ рдПрдХ рд╕рд░рд▓ рдЖрд░рдИрдПрд╕рдЯреА рд╕реЗрд╡рд╛ рдмрдирд╛рдиреЗ рдХреЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреА рдЬрд╛рдВрдЪ рдХреАред  <a href="https://romankudryashov.com/blog/2020/01/heterogeneous-microservices/" rel="nofollow">рдореБрдЦреНрдп рд▓реЗрдЦ рдореЗрдВ,</a> рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдкрд░рд┐рдгрд╛рдореА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ рдЕрдиреНрдп рдЖрдзреБрдирд┐рдХ рдЬреЗрд╡реАрдПрдо рдлреНрд░реЗрдорд╡рд░реНрдХ рдкрд░ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд╕рд╛рде рддреБрд▓рдиреАрдп рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИрдВред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдХреНрд╡рд╛рд░реНрдХрд╕ рдХреЗ рдкрд╛рд╕ рдЧрдВрднреАрд░ рдкреНрд░рддрд┐рдпреЛрдЧреА рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ рд╣реЗрд▓рд┐рдбреЙрди рдорд╛рдЗрдХреНрд░реЛрдкреНрд░реЛрдлрд╛рдЗрд▓, рдорд╛рдЗрдХреНрд░реЛрдиреНрдпреВрдЯ рдФрд░ рд╕реНрдкреНрд░рд┐рдВрдЧ рдмреВрдЯ (рдпрджрд┐ рд╣рдо рдлреБрд▓рд╕реНрдЯреИрдХ рдлреНрд░реЗрдорд╡рд░реНрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ)ред  рдЗрд╕рд▓рд┐рдП, рдореБрдЭреЗ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╣рдо рдШрдЯрдирд╛рдУрдВ рдХреЗ рдПрдХ рджрд┐рд▓рдЪрд╕реНрдк рд╡рд┐рдХрд╛рд╕ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛ рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдЬреЛ рдкреВрд░реЗ рдЬрд╛рд╡рд╛ рдкрд╛рд░рд┐рд╕реНрдерд┐рддрд┐рдХреА рддрдВрддреНрд░ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛ред </p><br><h2 id="poleznye-ssylki">  рдЙрдкрдпреЛрдЧреА рд▓рд┐рдВрдХ </h2><br><ul><li>  <a href="https://quarkus.io/get-started/" rel="nofollow">рдХреНрд╡рд╛рд░реНрдХрд╕ - рдЖрд░рдВрдн рдХрд░реЗрдВ</a> </li><li>  <a href="https://quarkus.io/guides/getting-started" rel="nofollow">рдХреНрд╡рд╛рд░реНрдХрд╕ - рдЖрдкрдХрд╛ рдкрд╣рд▓рд╛ рдЖрд╡реЗрджрди рдмрдирд╛рдирд╛</a> </li><li>  <a href="https://quarkus.io/blog/quarkus-for-spring-developers/" rel="nofollow">рд╕реНрдкреНрд░рд┐рдВрдЧ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЗ рд▓рд┐рдП рдХреНрд╡рд╛рд░реНрдХрд╕</a> </li></ul><br><p>  PS рд▓реЗрдЦ рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдореЗрдВ рдорджрдж рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж <a href="https://habr.com/en/users/vladimirsitnikov/" class="user_link">vladimirsitnikov</a> ред </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi484320/">https://habr.com/ru/post/hi484320/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi484302/index.html">рд╕реНрд▓реБрд░рдо рджреЗрд╡рдУрдкреНрд╕ - рджреВрд░ рдХреЗ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдПрдХ рд╕реБрдВрджрд░ рдХреНрд░реЗрди рдХреА рддреБрд▓рдирд╛ рдореЗрдВ 3 рджрд┐рдиреЛрдВ рдореЗрдВ рдПрдХ рдмреЗрд╣рддрд░ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓рд╛ рд╢реАрд░реНрд╖рдХ</a></li>
<li><a href="../hi484304/index.html">рдЪреАрди рдиреЗ рдЕрдкрдирд╛ "рд╕реНрдкреНрд░рд┐рдВрдЧ рдкреИрдХреЗрдЬ" рдЕрдкрдирд╛рдпрд╛</a></li>
<li><a href="../hi484306/index.html">рд╕реАрдЦрдиреЗ рдпреЛрдЧреНрдп рд╕рдореАрдХреНрд╖рд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ</a></li>
<li><a href="../hi484310/index.html">рд╢реБрд░реБрдЖрдд рдХреА рдЖрдБрдЦреЛрдВ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╡реЗрдмрд┐рдХреНрд╕ рдЬрд╛рд╡рд╛рд╕реНрдХреНрд░рд┐рдкреНрдЯ рд▓рд╛рдЗрдмреНрд░реЗрд░реАред рднрд╛рдЧ 2. рд░реВрдкреЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛</a></li>
<li><a href="../hi484312/index.html">рд▓рд╛рдЦреЛрдВ рдЫреЛрдЯреА рдлрд╛рдЗрд▓реЛрдВ рдХрд╛ рдХреБрд╢рд▓ рднрдВрдбрд╛рд░рдгред рд╕реНрд╡-рд╣реЛрд╕реНрдЯреЗрдб рд╕рдорд╛рдзрд╛рди</a></li>
<li><a href="../hi484326/index.html">рдЬрдВрдк рдЯреНрд░реЗрдбрд┐рдВрдЧ рдореЗрдВ рд▓рдВрджрди рдпрд╛ рдореЗрд░реА рдЗрдВрдЯрд░реНрдирд╢рд┐рдк рдкрд░ рдЬрд╛рдПрдВ</a></li>
<li><a href="../hi484328/index.html">рдкреЙрд▓ рдЧреНрд░рд╛рд╣рдо рдиреЗ рдирдИ рдмреЗрд▓ рдкреНрд░реЛрдЧреНрд░рд╛рдорд┐рдВрдЧ рд▓реИрдВрдЧреНрд╡реЗрдЬ рдХреА рдШреЛрд╖рдгрд╛ рдХреА</a></li>
<li><a href="../hi484330/index.html">[рдиреЗрдЧрдиреЗрдХреНрд╕] рдкреНрд░рддрд┐рдХреНрд░рд┐рдпрд╛_рд╕реНрдЯреИрдЯрд╕ = 0 рдХреЛ рдХреИрд╕реЗ рд╣рд░рд╛рдпрд╛ рдЬрд╛рдП</a></li>
<li><a href="../hi484332/index.html">рдХрд╛рд░реНрдп рдкреНрд░рдмрдВрдзрди рдкрд░ рдзреНрдпрд╛рди рджреЗрдВред рд╣рдо рдЕрдкрдиреА рдкреНрд░рдмрдВрдзрди рдкреНрд░рдгрд╛рд▓реА рдХреИрд╕реЗ рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi484336/index.html">рдЧрддрд┐рд╢реАрд▓ рд╕рд░рдгрд┐рдпреЛрдВ рдФрд░ рдХрд╕реНрдЯрдо рд╕рдВрдЧреНрд░рд╣ рдХрдХреНрд╖рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдпрдо</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>