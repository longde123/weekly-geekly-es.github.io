<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙅🏾 👇 🙂 Contournez la limite de recherche de LinkedIn en jouant avec l'API 🥘 🧜🏿 😊</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Limite 
 Il existe une telle restriction sur LinkedIn - la limite d'utilisation commerciale . Il est très probable que, comme moi, jusqu'à récemment, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Contournez la limite de recherche de LinkedIn en jouant avec l'API</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/462167/"><h2>  Limite </h2><br>  Il existe une telle restriction sur LinkedIn - la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">limite d'utilisation commerciale</a> .  Il est très probable que, comme moi, jusqu'à récemment, vous ne l'avez jamais rencontré ni entendu parler de lui. <br><br><img src="https://habrastorage.org/webt/ic/_s/ld/ic_sld0gnwrwrfucmb-it2psg-q.png"><br><br>  L'essence de la limite est que si vous utilisez trop souvent la recherche de personnes en dehors de vos contacts (il n'y a pas de mesures exactes, l'algorithme décide, en fonction de vos actions - à quelle fréquence vous avez recherché et ajouté des personnes), le résultat de la recherche sera limité à trois profils, au lieu de 1000 ( 100 pages par défaut, 10 profils par page).  La limite est réinitialisée au début de chaque mois.  Naturellement, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">les comptes premium n'ont pas une telle restriction</a> . <br><br>  Mais il n'y a pas si longtemps, pour un projet pour animaux de compagnie, j'ai commencé à jouer beaucoup avec la recherche sur LinkedIn et j'ai soudainement eu cette restriction.  Naturellement, je n'aimais pas beaucoup cela, car je ne l'ai pas utilisé à des fins commerciales, donc la première pensée a été d'étudier la restriction et d'essayer de la contourner. <br><a name="habracut"></a><br>  [ <i>Précision importante - les éléments contenus dans l'article sont présentés à titre informatif et éducatif uniquement.</i>  <i>L'auteur n'encourage pas leur utilisation à des fins commerciales.</i>  ] <br><br><h4>  Mise à jour importante - LinkedIn a pris en compte la vulnérabilité et l'a récemment corrigée.  Le bypass et le plugin ne fonctionnent plus. </h4><br><br><h2>  Nous étudions le problème </h2><br>  Nous avons: au lieu de dix profils avec pagination, la recherche n'en renvoie que trois, après quoi un bloc avec la «recommandation» d'un compte premium est inséré et ci-dessous sont des profils flous et non cliquables. <br><br>  Immédiatement, une main atteint la console du développeur pour voir ces profils cachés - peut-être pouvons-nous supprimer certains styles qui mettent des bleus, ou extraire des informations du bloc dans le balisage.  Mais, comme prévu, ces profils ne sont que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">des images tronquées</a> et ne stockent aucune information. <br><br><img src="https://habrastorage.org/webt/0o/oy/q4/0ooyq4vfdjxv2qysln5bnbk1c_0.png"><br><br>  Ok, regardons maintenant l'onglet Réseau et voyons si les résultats de la recherche alternative ont renvoyé qui ne retournent que trois profils fonctionnent réellement.  Nous trouvons la requête qui nous intéresse «/ api / search / blended» et regardons la réponse. <br><br><img src="https://habrastorage.org/webt/li/h9/r2/lih9r26torcwfxb1jwdvfgrnmha.png"><br><br>  Les profils entrent dans le tableau «inclus», mais il y a déjà 15 entités. Dans ce cas, les trois premiers d'entre eux sont des objets avec des informations supplémentaires, chaque objet contient des informations sur un profil spécifique (par exemple, le profil est-il une prime). <br><br><img src="https://habrastorage.org/webt/wx/fg/pd/wxfgpdex2erjtc3xrdnun1mws1u.png"><br><br>  Les 12 suivants sont de vrais profils - résultats de recherche, dont seulement trois nous seront montrés.  Comme vous pouvez déjà le deviner, il ne montre que ceux qui reçoivent des informations supplémentaires (les trois premiers objets).  Par exemple, si vous prenez la réponse du profil sans limite, alors 28 entités viendront - 10 objets avec ext.  informations et 18 profils. <br><br><div class="spoiler">  <b class="spoiler_title">Répondre au profil sans limite</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/u-/n2/ho/u-n2hokgvaopbfg-apq4v-gslli.jpeg"><br><img src="https://habrastorage.org/webt/hc/6x/4l/hc6x4lfr3xyxfxt_fnlaot_vzp0.png"><br></div></div><br><blockquote>  Pourquoi il y a plus de 10 profils, bien que 10 soient demandés, et ils ne participent pas à l'affichage, même sur la page suivante, ils ne le seront pas - je ne sais pas encore.  Si vous analysez l'URL de la demande, vous pouvez voir que count = 10 (combien de profils renvoyer dans la réponse, un maximum de 49). <br><br><img src="https://habrastorage.org/webt/4b/7y/rw/4b7yrwuueuktjkroc5sfoh4swm4.png"><br><br>  Je serai heureux de tout commentaire à ce sujet. <br></blockquote><h2>  Expérimenter </h2><br>  Eh bien, la chose la plus importante que nous savons maintenant avec certitude - plus de profils viennent dans la réponse qu'ils ne nous en montrent.  Nous pouvons donc obtenir plus de données, malgré la limite.  Essayons de tirer l'api nous-mêmes, directement depuis la console, en utilisant fetch. <br><br><img src="https://habrastorage.org/webt/bq/fp/47/bqfp47yq14d1fhcu--zqzicg-b0.png"><br><br>  On s'attend à ce que nous obtenions une erreur 403. Ceci est dû à la sécurité, ici nous n'envoyons pas le jeton CSRF ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">CSRF sur Wikipedia</a> . En bref, un jeton unique est ajouté à chaque demande, dont l'authenticité est vérifiée sur le serveur). <br><br><img src="https://habrastorage.org/webt/mv/wm/h_/mvwmh_mwx6nrjw2pkm3kug0en_m.png"><br><br>  Il peut être copié à partir de toute autre demande réussie ou à partir de cookies, où il est stocké dans le champ «JSESSIONID». <br><br><div class="spoiler">  <b class="spoiler_title">Où trouver un jeton</b> <div class="spoiler_text">  En-tête d'une autre demande: <br><br><img src="https://habrastorage.org/webt/mk/dz/sv/mkdzsvgr6s1v7ci-a9axwfdziz8.png"><br><br>  Ou à partir des cookies, directement via la console: <br><br><img src="https://habrastorage.org/webt/u_/ro/6m/u_ro6m2agsotottfwlsibcbonww.png"><br></div></div><br>  Nous essayons à nouveau, cette fois, passons les paramètres à récupérer, dans lesquels nous spécifions notre jeton csrf comme paramètre dans l'en-tête. <br><br><img src="https://habrastorage.org/webt/il/de/j8/ildej8ypx67iczcojevzp3klqye.png"><br><br>  Succès, nous obtenons les 10 profils.  : tada: <br><br><blockquote>  En raison de la différence dans les en-têtes, la structure de la réponse est légèrement différente de celle fournie dans la demande d'origine.  Vous pouvez obtenir la même structure si vous ajoutez 'Accept:' application / vnd.linkedin.normalized + json + 2.1 'à notre objet, à côté du jeton csrf. <br><div class="spoiler">  <b class="spoiler_title">Exemple de réponse avec en-tête ajouté</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/-4/lf/3m/-4lf3mdib2uervhnedsvh7ov_i0.png"><br></div></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">En savoir plus sur l'en-tête Accept</a> <br></blockquote><h2>  Et ensuite? </h2><br>  Ensuite, vous pouvez éditer (avec vos mains ou automatiser) le paramètre `start`, en indiquant l'index, à partir duquel nous recevrons 10 profils (par défaut = 0) à partir de l'ensemble du résultat de la recherche.  En d'autres termes, en l'incrémentant de 10 après chaque demande, nous obtenons la pagination habituelle, 10 profils à la fois. <br><br>  À ce stade, j'avais suffisamment de données et de liberté pour continuer à travailler sur le projet pour animaux de compagnie.  Mais c'était un péché de ne pas essayer d'afficher ces données directement sur place, car elles sont à portée de main.  Dans Ember, qui est utilisé à l'avant, nous ne grimperons pas.  JQuery était connecté au site, et en creusant la connaissance de la syntaxe de base en mémoire, vous pouvez créer ce qui suit en quelques minutes. <br><br><div class="spoiler">  <b class="spoiler_title">Code JQuery</b> <div class="spoiler_text"><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/*  ,             */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> createProfileBlock = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ headline, publicIdentifier, subline, title }</span></span></span><span class="hljs-function">) =&gt;</span></span> { $(<span class="hljs-string"><span class="hljs-string">'.search-results__list'</span></span>).append( <span class="hljs-string"><span class="hljs-string">`&lt;li class="search-result search-result__occluded-item ember-view"&gt; &lt;div class="search-entity search-result search-result--person search-result--occlusion-enabled ember-view"&gt; &lt;div class="search-result__wrapper"&gt; &lt;div class="search-result__image-wrapper"&gt; &lt;a class="search-result__result-link ember-view" href="/in/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${publicIdentifier}</span></span></span><span class="hljs-string">/"&gt; &lt;figure class="search-result__image"&gt; &lt;div class="ivm-image-view-model ember-view"&gt; &lt;img class="lazy-image ivm-view-attr__img--centered EntityPhoto-circle-4 presence-entity__image EntityPhoto-circle-4 loaded" src="http://www.userlogos.org/files/logos/give/Habrahabr3.png" /&gt; &lt;/div&gt; &lt;/figure&gt; &lt;/a&gt; &lt;/div&gt; &lt;div class="search-result__info pt3 pb4 ph0"&gt; &lt;a class="search-result__result-link ember-view" href="/in/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${publicIdentifier}</span></span></span><span class="hljs-string">/"&gt; &lt;h3 class="actor-name-with-distance search-result__title single-line-truncate ember-view"&gt; </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${title.text}</span></span></span><span class="hljs-string"> &lt;/h3&gt; &lt;/a&gt; &lt;p class="subline-level-1 t-14 t-black t-normal search-result__truncate"&gt;</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${headline.text}</span></span></span><span class="hljs-string">&lt;/p&gt; &lt;p class="subline-level-2 t-12 t-black--light t-normal search-result__truncate"&gt;</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${subline.text}</span></span></span><span class="hljs-string">&lt;/p&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;li&gt;`</span></span> ); }; <span class="hljs-comment"><span class="hljs-comment">//  ,      const fetchProfiles = () =&gt; { //  const csrf = 'ajax:9082932176494192209'; //    ,   const settings = { headers: { 'csrf-token': csrf } } //  ,       const url = `https://www.linkedin.com/voyager/api/search/blended?count=10&amp;filters=List(geoRegion-%3Ejp%3A0,network-%3ES,resultType-%3EPEOPLE)&amp;origin=FACETED_SEARCH&amp;q=all&amp;queryContext=List(spellCorrectionEnabled-%3Etrue,relatedSearchesEnabled-%3Etrue)&amp;start=${nextItemIndex}`; /*  ,        ,       10 */ fetch(url, settings).then(response =&gt; response.json()).then(data =&gt; { data.elements[0].elements.forEach(createProfileBlock); nextItemIndex += 10; }); }; //      $('.search-results__list').find('li').remove(); //     $('.search-results__list').after('&lt;button id="load-more"&gt;Load More&lt;/button&gt;'); //     $('#load-more').addClass('artdeco-button').on('click', fetchProfiles); //        window.nextItemIndex = 0;</span></span></code> </pre> <br></div></div><br>  Si vous faites cela directement dans la console sur la page de recherche, il ajoutera un bouton qui charge 10 nouveaux profils chaque fois que vous cliquez et les rend une liste.  Bien sûr, jeton et URL avant ce changement au besoin.  Le bloc de profil contiendra un nom, une position, un emplacement, un lien vers le profil et une image de talon. <br><br><img src="https://habrastorage.org/webt/gs/dd/6n/gsdd6nt6zacukksmzz9kffbqcqg.png"><br><br><h2>  Conclusion </h2><br>  Ainsi, avec un minimum d'effort, nous avons pu trouver un point faible et reprendre notre recherche sans restrictions.  Il suffisait d'analyser les données et leur chemin, de se pencher sur la requête elle-même. <br><br>  Je ne peux pas dire que c'est un problème grave pour LinkedIn, car il ne représente aucune menace.  Le maximum est le manque à gagner dû à de tels "tours", ce qui permet de ne pas payer la prime.  Peut-être qu'une telle réponse du serveur est nécessaire pour que les autres parties du site fonctionnent correctement, ou est-ce simplement la <s>paresse des développeurs, le</s> manque de ressources qui ne permet pas de bien faire.  (La restriction est apparue en janvier 2015, avant que cette limite ne l'était pas). <br><br><h2>  PS </h2><br><div class="spoiler">  <b class="spoiler_title">Vieux PS</b> <div class="spoiler_text">  Naturellement, le code jQuery est un exemple assez primitif de fonctionnalités.  Pour le moment, j'ai créé une extension pour le navigateur pour répondre à mes besoins.  Il ajoute des boutons de contrôle et rend des profils complets avec des images, un bouton d'invitation et des connexions générales.  De plus, il collecte dynamiquement des filtres d'emplacements, d'entreprises et d'autres choses, prend un jeton de cookies.  Vous n'avez donc pas besoin de coder en dur quoi que ce soit.  Eh bien, il ajoute des champs de paramètres supplémentaires, comme "combien de profils demander à la fois, jusqu'à 49". <br><br><img src="https://habrastorage.org/webt/8d/mr/bf/8dmrbfxoislgam1bpwh6mwnrq6u.png"><br><br>  Je travaille toujours sur ce module complémentaire et je prévois de le mettre dans le domaine public.  Écrivez si vous êtes intéressé. <br></div></div><br><br>  À la demande générale, j'ai mis l'add-on en accès libre, j'ai créé un add-on pour le navigateur et je l'ai posté pour un usage général (gratuit et même sans mineurs).  Là, non seulement la fonctionnalité de contournement limite est implémentée, mais aussi d'autres commodités.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Voir</a> et télécharger ici - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">adam4leos.github.io</a> <br><br>  Comme il s'agit d'une version alpha, n'hésitez pas à m'écrire sur les bugs, les idées et même une interface utilisateur <s>stupide et</s> chic.  Je continue de développer l'add-on et publierai périodiquement de nouvelles versions. <br><br><h4>  <b>Mise à jour importante - LinkedIn a pris en compte la vulnérabilité et l'a récemment corrigée.</b>  <b>Le bypass et le plugin ne fonctionnent plus.</b> </h4></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr462167/">https://habr.com/ru/post/fr462167/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr462155/index.html">Travaillez avec Worker «comme vous le souhaitez», pas «autant que possible»</a></li>
<li><a href="../fr462159/index.html">Construire un système de reconnaissance faciale basé sur Golang et OpenCV</a></li>
<li><a href="../fr462161/index.html">Expérience d'installation d'Apache Airflow sur Windows 10</a></li>
<li><a href="../fr462163/index.html">Des technologies qui seront populaires en 2020</a></li>
<li><a href="../fr462165/index.html">Comment 25 personnes ont été amenées à travailler pour une société de jeux inexistante</a></li>
<li><a href="../fr462169/index.html">Sommaire des actualités sur l'apprentissage automatique et l'intelligence artificielle de juillet</a></li>
<li><a href="../fr462171/index.html">Visualisation SCADA pour les projets IoT [Bibliothèque gratuite]</a></li>
<li><a href="../fr462173/index.html">Conférences. Résultats intermédiaires du premier semestre 2019</a></li>
<li><a href="../fr462175/index.html">Nous traitons les abréviations et les expressions latines en anglais</a></li>
<li><a href="../fr462177/index.html">Visite photographique du musée minéralogique du nom de Fersman</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>