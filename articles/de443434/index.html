<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äçüî¨ üèº üßòüèæ Benachrichtigungen: Ma√ünahmen zur Gewinnmitnahme / Stop-Loss erforderlich. Falls Ihr Broker diese Bestellungen nicht unterst√ºtzt üïõ üî† üßëüèΩ‚Äçü§ù‚Äçüßëüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Es gibt einen russischen Broker - Tinkoff Bank. Hier ist das Problem: Der Broker unterst√ºtzt keine Take-Profit- und Stop-Loss-Auftr√§ge. √úberhaupt nich...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Benachrichtigungen: Ma√ünahmen zur Gewinnmitnahme / Stop-Loss erforderlich. Falls Ihr Broker diese Bestellungen nicht unterst√ºtzt</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443434/">  Es gibt einen russischen Broker - Tinkoff Bank.  Hier ist das Problem: Der Broker unterst√ºtzt keine Take-Profit- und Stop-Loss-Auftr√§ge.  √úberhaupt nicht.  Wenn Sie sich beim Handeln wohler f√ºhlen m√∂chten, ben√∂tigen Sie eine Problemumgehung f√ºr diese Situation, bis die Entwickler der Tinkoff Bank diese Auftr√§ge endg√ºltig als Killer-Feature ver√∂ffentlichen.  In dem Artikel werde ich Ihnen meine Problemumgehung zeigen. <br>  <b>Update:</b> 2019-03-22, ver√∂ffentlichte der Broker die Plattform 3.0.0 (ein wichtiges Update) in Google Play.  Die Changelog-Funktionen nehmen Gewinn- / Stop-Loss-Auftr√§ge entgegen <br><a name="habracut"></a><br>  Warum habe ich beschlossen, den Artikel hier zu posten?  Ich gehe davon aus, dass die Tinkoff Bank und seine Produkte bei IT-Kunden in Russland sehr beliebt sind und wahrscheinlich einige von ihnen denselben Bedarf haben, aber nicht gen√ºgend Zeit oder Bereitschaft haben, eine eigene vor√ºbergehende Problemumgehung zu entwickeln.  Deshalb teile ich meine L√∂sung und die Geschichte der L√∂sung. <br><br>  Hier sollte ich etwas zu Problemumgehungen sagen, die vom Broker bereitgestellt werden.  Erstens hat der Broker Limit Orders.  Das Feature wurde im Februar 2019 ver√∂ffentlicht (und die Kunden haben fast zwei Jahre darauf gewartet).  Sie arbeiten innerhalb eines Handelstages.  Sie m√ºssen sie also an jedem Handelstag neu einstellen.  Noch ein Fehler: Sie k√∂nnen keine Grenzen setzen, wie Sie m√∂chten.  Es gibt eine Preisspanne und Sie k√∂nnen keine Limit-Bestellung mit einem Preis au√üerhalb der Bandbreite aufgeben.  Und dieser Bereich ist extrem eng.  In einem volatilen Markt f√ºhlen Sie sich unwohl.  Schlie√ülich k√∂nnen Sie nicht zwei multidirektionale Bestellungen erstellen (in meinem Fall f√ºhrt sogar die erste Limit-Bestellung zu einem sofortigen Absturz der mobilen Broker-App, und die Broker-Site bietet diese Funktion nicht). <br><br>  Zweitens bietet die mobile App des Brokers eine Funktion: Sie k√∂nnen die Preis√§nderung des Assets abonnieren.  Wenn der Schwellenwert (absolut, im Preis oder relativ, in Prozent) √ºberschritten wird, erhalten Sie eine Benachrichtigung.  Sie k√∂nnen jedoch auch hier keine zwei Schwellenwerte f√ºr das Asset erstellen. <br><br>  Meine Problemumgehung ist ganz einfach: <br><br><ol><li> Wir haben Schwellenwerte f√ºr einen Verm√∂genswert.  Wir berechnen die Schwellenwerte selbst.  Wenn Schwellenwerte √ºberschritten werden, f√ºhren wir eine manuelle Aktion durch: Verkaufen oder Kaufen, um als Ergebnis Gewinn oder Verlust zu erzielen. </li><li>  Wir sollten eine Datenquelle erhalten, um den Preis des tats√§chlichen Verm√∂genswerts zu erhalten </li><li>  Wenn der Schwellenwert √ºberschritten wird, sollten wir eine Benachrichtigung senden. </li></ol><br>  Obwohl es einfach genug aussieht, enth√§lt meine L√∂sung einige Details, die ich teilen und diskutieren m√∂chte. <br><br>  1. W√§hrend mein Wertpapierportfolio √ºber einen Verm√∂genswert verf√ºgte, wurden im Skript Schwellenwerte definiert, und die Aktiensuche wurde einfach, einfach und √ºberhaupt nicht konfigurierbar durchgef√ºhrt.  Es war eine schlechte L√∂sung, aber schnell und zeigte, dass die Idee richtig war.  Wenn ich neue Assets im Portfolio habe, habe ich Aktiennamen, B√∂rsen und Schwellenwerte aus einer Datei geladen. <br><br>  2. Mein erster Verm√∂genswert war eine ausl√§ndische Aktie, und die ausl√§ndische Aktie konnte nur an der B√∂rse in Sankt Petersburg gekauft oder verkauft werden.  Mein erster Ansturm war es, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Site</a> der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SPb-B√∂rse</a> zu analysieren. <br><br>  Es gibt eine absteigende Volumensortierung, daher war das Parsen einfach, da sich mein Asset immer auf der ersten Seite befand.  Aber am 8. M√§rz war es kaputt.  Ich wei√ü nicht warum, aber TSLA tauchte auf einer 25. Seite auf.  Ihr Paginator verwendet JavaScript, um die Daten der Seiten herunterzuladen.  Es gibt eine klare L√∂sung: Laden Sie alle Seiten herunter, analysieren Sie sie und suchen Sie das Asset.  Das Herunterladen und Parsen von mehr als 25 Seiten in jeder Schleife erfordert jedoch zu viel Zeit. <br><br>  Stattdessen habe ich beschlossen, die Website tradeview.com als weitere Datenquelle hinzuzuf√ºgen.  Es ist nicht erforderlich, viele Seiten zu analysieren, um Ihren Bestand zu finden, da jedes Asset eine eigene Seite hat, wie diese: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">www.tradingview.com/symbols/NASDAQ-TSLA</a> <br><br>  Ich nahm an, dass jetzt meine Probleme weg sind, aber ich habe mich geirrt.  Die Daten auf den Seiten werden nur mit JS geladen und aktualisiert.  Anfragen, die ich zum Herunterladen von Seiten verwendet habe, sind fehlgeschlagen. <br><br>  F√ºr dieses Problem kenne ich drei verschiedene L√∂sungen: <br><br>  PyQT, Selen (Webdriver) und eine Erweiterung Requests-HTML.  Da ich bereits ein Anforderungsmodul in meinem Projekt habe, habe ich mich f√ºr Requests-HTML entschieden. <br><br>  F√ºr meine starke Entt√§uschung war es nicht sehr stabil, bis ich einige Hinweise auf StackOverFlow und so fand. <br><br><pre><code class="python hljs">session = HTMLSession() r = session.get(url) my = r.html.render(timeout=<span class="hljs-number"><span class="hljs-number">30</span></span>) selector = <span class="hljs-string"><span class="hljs-string">'span.tv-symbol-header-quote__value.tv-symbol-header-quote__value--large.js-symbol-last'</span></span> price = r.html.find(selector)[<span class="hljs-number"><span class="hljs-number">0</span></span>].text r.close() session.close()</code> </pre> <br>  Achten Sie auf das Timeout sowie auf beide close () -Aufrufe.  Den meisten Beispielen fehlen diese Details, und es k√∂nnen einige Probleme auftreten. <br><br>  3. Wenn wir nun Seiten mit JS-Daten heruntergeladen, analysiert und entschieden haben, ob wir eine Benachrichtigung senden m√ºssen, gibt es nur die Frage: "Wie senden wir eine Benachrichtigung?".  In meinem Fall bietet sms.ru eine praktische API und 5 kostenlose SMS pro Tag.  Melden Sie sich an einem SMS-Gate an.  Erstellen Sie einen API-Schl√ºssel.  Der Schl√ºssel so etwas: <br><br><pre> <code class="plaintext hljs">24A41EA5-EEEE-CCCC-5555-094143C2EDDD</code> </pre> <br>  Senden einer SMS-Funktion aus einer fr√ºheren Version meiner L√∂sung: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send_message</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mymessage)</span></span></span><span class="hljs-function">:</span></span> sms_url = <span class="hljs-string"><span class="hljs-string">'https://sms.ru/sms/send?api_id=key&amp;to=number&amp;msg=message&amp;json=1'</span></span> sms_url = sms_url.replace(<span class="hljs-string"><span class="hljs-string">'key'</span></span>, mykey) sms_url = sms_url.replace(<span class="hljs-string"><span class="hljs-string">'number'</span></span>, mynumber) sms_url = sms_url.replace(<span class="hljs-string"><span class="hljs-string">'message'</span></span>, mymessage) sms_response = requests.get(sms_url)</code> </pre> <br>  Es funktioniert gut.  Ich bin auf die Frage gesto√üen: Was ist, wenn wir bereits eine SMS gesendet haben?  In der ersten Version fehlen √úberpr√ºfungen, daher wird innerhalb jeder Schleife eine SMS gesendet.  Immer wieder. <br><br>  Ich habe einen SMS-Z√§hler hinzugef√ºgt, den das Skript √ºberpr√ºft, bevor send_message aufgerufen wird. <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> sms_counter sms_counter = sms_counter + <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  Okay, wir haben es verstanden.  Aber wenn ein neuer Tag auftaucht, taucht ein neues Problem auf: Wie sp√ºlt man den SMS-Z√§hler?  Oder eigentlich wann?  Ich sehe drei verschiedene M√∂glichkeiten: Speichern des Z√§hlers in der Datenbank (aber meine L√∂sung ist derzeit zustandslos), Analysieren von Datum und Uhrzeit, um den Z√§hler zwischen Handelstagen zu leeren und das Skript irgendwann zwischen zwei Handelstagen neu zu starten.  Im Moment habe ich die neueste Variante implementiert, aber in Zukunft kann ich sie √§ndern. <br><br>  Meine L√∂sung funktioniert jetzt. Sie k√∂nnen sie von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub</a> herunterladen. <br><br>  F√ºr Benutzer, die nicht wissen, wie sie mit Python-Skripten umgehen sollen, biete ich eine Paketl√∂sung <a href="">f√ºr Windows an</a> (mit freundlicher Genehmigung von PyInstaller). <br><br>  TODOs: <br><br><ol><li>  Analysieren Sie die Datums- und Uhrzeit, um die SMS-Z√§hler zu leeren, anstatt das Skript neu zu starten. </li><li>  Im Moment ist es die zustandslose Anwendung. Ich m√∂chte eine Datenbank hinzuf√ºgen. </li><li>  Nach # 2 w√§re es sch√∂n, einen starken Anstieg oder R√ºckgang des Preises des Verm√∂genswerts (im Vergleich zum Schlusskurs des vorherigen Handelstages) zu verfolgen. </li><li>  Erweitern Sie Kommunikationspfade (Telegramm, Viber, Sprachanrufe) und Anbieter (aus Gr√ºnden der Zuverl√§ssigkeit m√∂chte ich smsc.ru SMS-gate hinzuf√ºgen, da sms.ru manchmal h√§ngen bleibt und sms_response nicht zur√ºckgibt, obwohl SMS gesendet wird). </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de443434/">https://habr.com/ru/post/de443434/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de443424/index.html">Umschreiben des Testfalls f√ºr das Junior-Frontend auf TypeScript und React-Hooks</a></li>
<li><a href="../de443426/index.html">Schwarze Markierung - wie OpenShift mit SELinux vor Container-Schwachstellen sch√ºtzt</a></li>
<li><a href="../de443428/index.html">Palmer Lucky, der "Vater" von Oculus Rift, entwickelt ein virtuelles Schlachtfeldsystem f√ºr das Pentagon</a></li>
<li><a href="../de443430/index.html">Warum ist es schlecht, wenn das Internet alles √ºber Sie wei√ü?</a></li>
<li><a href="../de443432/index.html">Blazor 0.9.0 ver√∂ffentlicht</a></li>
<li><a href="../de443436/index.html">Wo kann man √ºber Apache Ignite, verteilte Datenbanken und verteiltes maschinelles Lernen im Fr√ºhjahr sprechen?</a></li>
<li><a href="../de443438/index.html">7 n√ºtzliche Firefox-Erweiterungen zum Englischlernen</a></li>
<li><a href="../de443440/index.html">PHP-Modul zum Arbeiten mit hierarchischen Daten in InterSystems IRIS</a></li>
<li><a href="../de443450/index.html">Warum die Armen nicht gesund sein k√∂nnen</a></li>
<li><a href="../de443452/index.html">Das russische Milit√§r wird ein eigenes geschlossenes Internet schaffen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>