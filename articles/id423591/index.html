<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòï ‚òùüèª üë®üèæ‚Äçüç≥ Lagu-lagu lama tentang hal utama. Permintaan Java dan keluar üéª üë©üèø‚Äçü§ù‚Äçüë®üèæ ü§¢</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="( Ilustrasi ) 

 Salah satu tantangan yang dihadapi oleh 99,9% pengembang adalah mengakses titik akhir pihak ketiga. Ini bisa berupa API eksternal dan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lagu-lagu lama tentang hal utama. Permintaan Java dan keluar</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/umbrellaitcom/blog/423591/"><img src="https://habrastorage.org/webt/gc/zo/yn/gczoyneiff_giu5osapzaaekbpw.png"><br>  ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><i>Ilustrasi</i></a> ) <br><br>  Salah satu tantangan yang dihadapi oleh 99,9% pengembang adalah mengakses titik akhir pihak ketiga.  Ini bisa berupa API eksternal dan layanan mikro "milik Anda".  Sekarang semua orang memukul microservices, ya.  Mengambil atau mengirim data adalah hal yang sederhana, tetapi terkadang mereka menemukan kembali kemudi.  Bisakah Anda menyebutkan 5 cara untuk mengimplementasikan kueri di Jawa (menggunakan perpustakaan dan tanpa)?  Tidak - selamat datang di kucing.  Hah?  Datang dan bandingkan;) <a name="habracut"></a><br><br><h1>  0. Pendahuluan </h1><br>  Tugas yang akan kita selesaikan sangat sederhana: kita perlu mengirim permintaan GET / POST dan mendapatkan respons yang datang dalam format JSON.  Agar tidak menulis microservice asli lain, saya akan menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">contoh</a> yang menyediakan satu set titik akhir dengan beberapa data.  Semua contoh kode disederhanakan secara maksimal, tidak akan ada kasus rumit dengan token dan header auth di sini.  Hanya POST dan DAPATKAN, DAPATKAN dan POST, dan seterusnya 5 kali atau lebih. <br>  Jadi ayo pergi. <br><br><h1>  1. Solusi Java bawaan </h1><br>  Akan aneh jika tugas itu tidak dapat diselesaikan tanpa menggunakan perpustakaan pihak ketiga.  Tentu Anda bisa!  Tapi sedih.  Paket java.net, yaitu HttpURLConnection, URL dan URLEnconder. <br><br>  Untuk mengirim permintaan yang MENDAPATKAN, POST itu, Anda perlu membuat objek URL dan membuka koneksi berdasarkan itu: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> URL url = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URL(<span class="hljs-string"><span class="hljs-string">"http://jsonplaceholder.typicode.com/posts?_limit=10"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> HttpURLConnection con = (HttpURLConnection) url.openConnection();</code> </pre> <br>  Selanjutnya, Anda perlu membumbui koneksi dengan semua parameter: <br><br><pre> <code class="java hljs">con.setRequestMethod(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>); con.setRequestProperty(<span class="hljs-string"><span class="hljs-string">"Content-Type"</span></span>, <span class="hljs-string"><span class="hljs-string">"application/json"</span></span>); con.setConnectTimeout(CONNECTION_TIMEOUT); con.setReadTimeout(CONNECTION_TIMEOUT);</code> </pre> <br>  Dan dapatkan InputStream, dari mana membaca semua data yang diterima. <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">final</span></span> BufferedReader in = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BufferedReader(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader(con.getInputStream()))) { String inputLine; <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> StringBuilder content = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((inputLine = in.readLine()) != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { content.append(inputLine); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> content.toString(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Exception ex) { ex.printStackTrace(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>; }</code> </pre> <br>  Dan, pada kenyataannya, di sini kita mendapatkan jawaban seperti itu (itu akan sama untuk semua contoh berikutnya, karena kami bekerja dengan titik akhir yang sama): <br><br><pre> <code class="java hljs">[ { <span class="hljs-string"><span class="hljs-string">"userId"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"sunt aut facere repellat provident occaecati excepturi optio reprehenderit"</span></span>, <span class="hljs-string"><span class="hljs-string">"body"</span></span>: <span class="hljs-string"><span class="hljs-string">"quia et suscipit\nsuscipit recusandae consequuntur expedita et cum\nreprehenderit molestiae ut ut quas totam\nnostrum rerum est autem sunt rem eveniet architecto"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"userId"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"qui est esse"</span></span>, <span class="hljs-string"><span class="hljs-string">"body"</span></span>: <span class="hljs-string"><span class="hljs-string">"est rerum tempore vitae\nsequi sint nihil reprehenderit dolor beatae ea dolores neque\nfugiat blanditiis voluptate porro vel nihil molestiae ut reiciendis\nqui aperiam non debitis possimus qui neque nisi nulla"</span></span> }, ... { <span class="hljs-string"><span class="hljs-string">"userId"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"nesciunt iure omnis dolorem tempora et accusantium"</span></span>, <span class="hljs-string"><span class="hljs-string">"body"</span></span>: <span class="hljs-string"><span class="hljs-string">"consectetur animi nesciunt iure dolore\nenim quia ad\nveniam autem ut quam aut nobis\net est aut quod aut provident voluptas autem voluptas"</span></span> }, { <span class="hljs-string"><span class="hljs-string">"userId"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"optio molestias id quia eum"</span></span>, <span class="hljs-string"><span class="hljs-string">"body"</span></span>: <span class="hljs-string"><span class="hljs-string">"quo et expedita modi cum officia vel magni\ndoloribus qui repudiandae\nvero nisi sit\nquos veniam quod sed accusamus veritatis error"</span></span> } ]</code> </pre> <br>  Dalam hal permintaan POST, semuanya sedikit lebih rumit.  Kami ingin tidak hanya menerima jawaban, tetapi juga mengirimkan data.  Untuk ini kita perlu meletakkannya di sana.  Dokumentasi memberi tahu kami bahwa ini mungkin berfungsi sebagai berikut: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Map&lt;String, String&gt; parameters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); parameters.put(<span class="hljs-string"><span class="hljs-string">"title"</span></span>, <span class="hljs-string"><span class="hljs-string">"foo"</span></span>); parameters.put(<span class="hljs-string"><span class="hljs-string">"body"</span></span>, <span class="hljs-string"><span class="hljs-string">"bar"</span></span>); parameters.put(<span class="hljs-string"><span class="hljs-string">"userId"</span></span>, <span class="hljs-string"><span class="hljs-string">"1"</span></span>); con.setDoOutput(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> DataOutputStream out = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataOutputStream(con.getOutputStream()); out.writeBytes(getParamsString(parameters)); out.flush(); out.close();</code> </pre><br>  Di mana getParamsString adalah metode sederhana yang memetakan Peta ke String yang berisi pasangan nilai kunci: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getParamsString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Map&lt;String, String&gt; params)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> StringBuilder result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); params.forEach((name, value) -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { result.append(URLEncoder.encode(name, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)); result.append(<span class="hljs-string"><span class="hljs-string">'='</span></span>); result.append(URLEncoder.encode(value, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>)); result.append(<span class="hljs-string"><span class="hljs-string">'&amp;'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">final</span></span> UnsupportedEncodingException e) { e.printStackTrace(); } }); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String resultString = result.toString(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> !resultString.isEmpty() ? resultString.substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, resultString.length() - <span class="hljs-number"><span class="hljs-number">1</span></span>) : resultString; }</code> </pre> <br>  Setelah penciptaan berhasil, kami mendapatkan objek kembali: <br><br><pre> <code class="java hljs">{ <span class="hljs-string"><span class="hljs-string">"title"</span></span>: <span class="hljs-string"><span class="hljs-string">"foo"</span></span>, <span class="hljs-string"><span class="hljs-string">"body"</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-string"><span class="hljs-string">"userId"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">101</span></span>}</code> </pre> <br>  <a href="">Referensi</a> ke sumber yang dapat Anda jalankan. <br><br><h1>  2. Apache HttpClient </h1><br>  Jika kita menjauh dari solusi bawaan, maka hal pertama yang kita temui adalah HttpClient dari Apache.  Untuk akses, kita membutuhkan file JAR itu sendiri.  Atau, karena saya menggunakan Maven, ketergantungan yang terkait adalah: <br><br><pre> <code class="java hljs"> &lt;dependency&gt; &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt; &lt;artifactId&gt;httpclient&lt;/artifactId&gt; &lt;version&gt;<span class="hljs-number"><span class="hljs-number">4.5</span></span>.6&lt;/version&gt; &lt;/dependency&gt;</code> </pre> <br>  Dan cara kueri terlihat menggunakan HttpClient sudah jauh lebih baik ( <a href="">sumber</a> ): <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> CloseableHttpClient httpclient = HttpClients.createDefault(); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> HttpUriRequest httpGet = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpGet(<span class="hljs-string"><span class="hljs-string">"http://jsonplaceholder.typicode.com/posts?_limit=10"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> ( CloseableHttpResponse response1 = httpclient.execute(httpGet) ){ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> HttpEntity entity1 = response1.getEntity(); System.out.println(EntityUtils.toString(entity1)); } <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> HttpPost httpPost = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpPost(<span class="hljs-string"><span class="hljs-string">"http://jsonplaceholder.typicode.com/posts"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> List&lt;NameValuePair&gt; params = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); params.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicNameValuePair(<span class="hljs-string"><span class="hljs-string">"title"</span></span>, <span class="hljs-string"><span class="hljs-string">"foo"</span></span>)); params.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicNameValuePair(<span class="hljs-string"><span class="hljs-string">"body"</span></span>, <span class="hljs-string"><span class="hljs-string">"bar"</span></span>)); params.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicNameValuePair(<span class="hljs-string"><span class="hljs-string">"userId"</span></span>, <span class="hljs-string"><span class="hljs-string">"1"</span></span>)); httpPost.setEntity(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UrlEncodedFormEntity(params)); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> ( CloseableHttpResponse response2 = httpclient.execute(httpPost) ){ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> HttpEntity entity2 = response2.getEntity(); System.out.println(EntityUtils.toString(entity2)); } httpclient.close();</code> </pre> <br>  Kami mendapat data yang sama, tetapi menulis kode sebanyak setengahnya.  Saya ingin tahu di mana lagi mereka dapat mengarahkan pencarian dalam masalah yang tampaknya mendasar ini?  Tetapi Apache memiliki modul lain yang memecahkan masalah kami. <br><br><h1>  3. Apache Fluent API </h1><br><pre> <code class="java hljs"> &lt;dependency&gt; &lt;groupId&gt;org.apache.httpcomponents&lt;/groupId&gt; &lt;artifactId&gt;fluent-hc&lt;/artifactId&gt; &lt;version&gt;<span class="hljs-number"><span class="hljs-number">4.5</span></span>.6&lt;/version&gt; &lt;/dependency&gt;</code> </pre> <br>  Dan sudah menggunakan Fluent Api, panggilan kami menjadi jauh lebih mudah dibaca ( <a href="">sumber</a> ): <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Content getResult = Request.Get(<span class="hljs-string"><span class="hljs-string">"http://jsonplaceholder.typicode.com/posts?_limit=10"</span></span>) .execute().returnContent(); System.out.println(getResult.asString()); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Collection&lt;NameValuePair&gt; params = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); params.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicNameValuePair(<span class="hljs-string"><span class="hljs-string">"title"</span></span>, <span class="hljs-string"><span class="hljs-string">"foo"</span></span>)); params.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicNameValuePair(<span class="hljs-string"><span class="hljs-string">"body"</span></span>, <span class="hljs-string"><span class="hljs-string">"bar"</span></span>)); params.add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicNameValuePair(<span class="hljs-string"><span class="hljs-string">"userId"</span></span>, <span class="hljs-string"><span class="hljs-string">"1"</span></span>)); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Content postResultForm = Request.Post(<span class="hljs-string"><span class="hljs-string">"http://jsonplaceholder.typicode.com/posts"</span></span>) .bodyForm(params, Charset.defaultCharset()) .execute().returnContent(); System.out.println(postResultForm.asString());</code> </pre> <br>  Dan sebagai bonus - contoh.  Jika kami ingin mentransfer data ke tubuh bukan sebagai formulir, tetapi sebagai JSON favorit semua orang: <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Content postResult = Request.Post(<span class="hljs-string"><span class="hljs-string">"http://jsonplaceholder.typicode.com/posts"</span></span>) .bodyString(<span class="hljs-string"><span class="hljs-string">"{\"title\": \"foo\",\"body\":\"bar\",\"userId\": 1}"</span></span>, ContentType.APPLICATION_JSON) .execute().returnContent(); System.out.println(postResult.asString());</code> </pre> <br>  Faktanya, panggilan itu diciutkan menjadi satu baris kode.  Bagi saya, ini jauh lebih ramah terhadap pengembang daripada metode pertama. <br><br><h1>  4. Spring RestTemplate </h1><br>  Apa selanjutnya  Pengalaman lebih lanjut membawa saya ke dunia Musim Semi.  Dan, tidak mengherankan, pegas juga memiliki alat untuk menyelesaikan tugas sederhana kami (aneh, kan? Tugas, bahkan bukan itu - kebutuhan! - pada tingkat dasar, tetapi untuk beberapa alasan ada lebih dari satu solusi).  Dan solusi pertama (dasar) yang akan Anda temukan di ekosistem Spring adalah RestTemplate.  Dan untuk ini kita perlu menarik sebagian besar dari seluruh kebun binatang.  Jadi jika Anda perlu mengirim permintaan dalam aplikasi NONSpring, maka untuk ini lebih baik tidak menyeret seluruh dapur.  Dan jika sudah ada pegas, mengapa tidak?  Cara menarik semua yang Anda butuhkan untuk ini, Anda bisa lihat di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  Ya, sebenarnya permintaan GET menggunakan RestTemplate terlihat seperti ini: <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> RestTemplate restTemplate = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RestTemplate(); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String stringPosts = restTemplate.getForObject(<span class="hljs-string"><span class="hljs-string">"http://jsonplaceholder.typicode.com/posts?_limit=10"</span></span>, String.class); System.out.println(stringPosts);</code> </pre> <br>  Kap mesin  TAPI!  Saya tidak ingin bekerja dengan string lagi, terlebih lagi ada kesempatan untuk menerima bukan string, tetapi benda siap pakai yang kami harapkan akan terima!  Buat objek Posting: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.fasterxml.jackson.annotation.JsonIgnoreProperties; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lombok.Builder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lombok.Getter; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lombok.Setter; <span class="hljs-meta"><span class="hljs-meta">@Builder</span></span> <span class="hljs-meta"><span class="hljs-meta">@Getter</span></span> <span class="hljs-meta"><span class="hljs-meta">@Setter</span></span> <span class="hljs-meta"><span class="hljs-meta">@JsonIgnoreProperties</span></span>(ignoreUnknown = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Post</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> id; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String title; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String body; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> userId; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> String.format(<span class="hljs-string"><span class="hljs-string">"\n id: %s \n title: %s \n body: %s \n userId: %s \n"</span></span>, id, title, body, userId); } }</code> </pre> <br>  Di sini: <br>  <b>Builder, Getter, Setter</b> - gula dari Lombok, tidak menulis semuanya dengan tangan.  Ya, ini dia, ibu malas. <br>  <b>JsonIgnoreProperties</b> - sehingga dalam hal menerima bidang yang tidak dikenal, jangan menabrak kesalahan, tetapi gunakan bidang yang kita tahu. <br>  Nah, <b>toString</b> , untuk menampilkan objek kita ke konsol, dan ini bisa dibaca.  Sebenarnya, permintaan GET dan POST kami diubah menjadi ( <a href="">sumber</a> ): <br><br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">// Map it to list of objects final Post[] posts = restTemplate.getForObject("http://jsonplaceholder.typicode.com/posts?_limit=10", Post[].class); for (final Post post : posts) { System.out.println(post); } final Post postToInsert = Post.builder() .body("bar") .title("foo") .userId(1) .build(); final Post insertedPost = restTemplate.postForObject("http://jsonplaceholder.typicode.com/posts", postToInsert, Post.class); System.out.println(insertedPost);</span></span></code> </pre> <br>  Dan kita sudah memiliki benda di tangan kita, dan bukan seutas tali yang perlu kita uraikan sendiri. <br><br>  Kul.  Sekarang kita dapat menulis beberapa pembungkus di sekitar RestTemplate sehingga kueri dibangun dengan benar.  Kelihatannya tidak terlalu buruk, tetapi bagi saya itu masih bisa diperbaiki.  Semakin sedikit kode yang ditulis, semakin kecil kemungkinan kesalahan.  Semua orang tahu bahwa masalah utama sering PEBCAK (Masalah Ada di antara Kursi dan Keyboard) ... <br><br><h1>  5. Musim Semi Feign </h1><br>  Dan inilah panggung Feign, yang merupakan bagian dari Spring Cloud.  Pertama, tambahkan ketergantungan Feign ke lingkungan pegas yang sudah ditambahkan sebelumnya: <br><br><pre> <code class="java hljs"> &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-feign&lt;/artifactId&gt; &lt;version&gt;<span class="hljs-number"><span class="hljs-number">1.4</span></span>.5.RELEASE&lt;/version&gt; &lt;/dependency&gt;</code> </pre><br>  Faktanya, yang dibutuhkan hanyalah mendeklarasikan antarmuka dan membumbui dengan sedikit anotasi.  Terutama pendekatan ini akan menarik bagi mereka yang menulis pengendali menggunakan pegas. <br><br>  Inilah yang perlu kita lakukan untuk mengirim permintaan melalui Feign ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sumber</a> ). <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@FeignClient</span></span>(name = <span class="hljs-string"><span class="hljs-string">"jsonplaceholder"</span></span>, url = <span class="hljs-string"><span class="hljs-string">"http://jsonplaceholder.typicode.com"</span></span>, path = <span class="hljs-string"><span class="hljs-string">"/posts"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ApiClient</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(method = GET, value = <span class="hljs-string"><span class="hljs-string">"/"</span></span>, consumes = APPLICATION_JSON_VALUE) <span class="hljs-function"><span class="hljs-function">List&lt;Post&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPosts</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@RequestParam(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"_limit"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">final</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> postLimit)</span></span>; <span class="hljs-meta"><span class="hljs-meta">@RequestMapping</span></span>(method = POST, value = <span class="hljs-string"><span class="hljs-string">"/"</span></span>, consumes = APPLICATION_JSON_VALUE, produces = APPLICATION_JSON_VALUE) <span class="hljs-function"><span class="hljs-function">Post </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">savePost</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(@RequestBody Post post)</span></span></span></span>; }</code> </pre> <br>  Kecantikan, bukan?  Dan ya, model data yang kami tulis untuk RestTemplate digunakan kembali dengan baik di sini. <br><br><h1>  6. Kesimpulan </h1><br>  Tidak ada satu cara lain implementasi selain lima yang disajikan.  Koleksi ini hanya refleksi dari pengalaman penulis dalam urutan di mana saya bertemu dan mulai menggunakannya dalam proyek.  Sekarang saya secara aktif menggunakan Feign, menikmati hidup dan menunggu sesuatu yang lebih nyaman untuk ditampilkan sehingga Anda dapat berteriak ke monitor "&lt;nama perpustakaan&gt;, saya memilih Anda!"  - dan semuanya siap digunakan dan diintegrasikan.  Sementara itu, Feign. <br><br>  PS Sebagai salah satu cara "malas" Anda dapat mempertimbangkan Swagger klien yang dihasilkan.  Tapi, seperti kata mereka, ada nuansa.  Tidak semua pengembang menggunakan Swagger untuk mendokumentasikan API mereka, dan bahkan lebih sedikit melakukannya dengan kualitas tinggi sehingga mereka dapat dengan mudah menghasilkan dan menggunakan klien, dan bukannya mendapatkan koleksi entomologis, yang akan lebih berbahaya daripada kebaikan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id423591/">https://habr.com/ru/post/id423591/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id423579/index.html">Layanan Cloud untuk WebGL? Tidak terima kasih</a></li>
<li><a href="../id423583/index.html">Mendapatkan kecelakaan melalui NotificationIRP di OSS</a></li>
<li><a href="../id423585/index.html">Langsung: CI / CD di iOS dan Android</a></li>
<li><a href="../id423587/index.html">Membangun InnoDB cluster dari mysql 5.7 pada centos 7</a></li>
<li><a href="../id423589/index.html">Bagaimana kami memilih TTS, misalnya, suara dalam Kamus</a></li>
<li><a href="../id423593/index.html">Google mengumumkan kontes untuk serangan pada algoritma visi mesin</a></li>
<li><a href="../id423595/index.html">Frango Anomaly, Interchange</a></li>
<li><a href="../id423597/index.html">Bagaimana dan cluster mana yang dapat dialokasikan di basis klien</a></li>
<li><a href="../id423601/index.html">Sistem pekerjaan dan jalur pencarian</a></li>
<li><a href="../id423603/index.html">RxSwift bagian 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>