<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>❎ 🏇🏾 👲🏾 Boîte noire pour la maison: nous collectons les NAS de nos propres mains, partie 2 - magnifique NAS4Free 👩🏿‍🤝‍👩🏼 🤱🏽 ⛽️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La publication est destinée aux personnes éloignées de l'administration système. Cet article démontre les capacités de base du merveilleux système d'e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Boîte noire pour la maison: nous collectons les NAS de nos propres mains, partie 2 - magnifique NAS4Free</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/397575/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La publication est destinée aux personnes éloignées de l'administration système. </font><font style="vertical-align: inherit;">Cet article démontre les capacités de base du merveilleux système d'exploitation NAS4Free, qui vous permet de déployer votre NAS domestique même sur du matériel de faible puissance, avec une totale méconnaissance de FreeBSD et de la ligne de commande. </font><font style="vertical-align: inherit;">La première partie de la publication se trouve </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous avons donc une boîte avec les caractéristiques suivantes:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Boîtier: Thermaltake Core V1;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alimentation: Chieftec HPS-350NS;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Carte mère: GIGABYTE GA-J1800N-D2H;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM: Transcend SO-DIMM 2 Go DDR-III 1333 MHz x 2;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HDD: WD Re 2004FBYZ x 2 (avant de faire des yeux ronds, lisez la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">première partie</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Refroidissement: TITAN DC FAN (80 mm, 2000 tr / min) x 2.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est temps de le transformer en NAS domestique, aussi fiable que possible dans l'environnement actuel. </font><font style="vertical-align: inherit;">Et le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">système de fichiers Zettabyte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous y aidera </font><font style="vertical-align: inherit;">- peut-être la meilleure solution pour organiser un stockage de fichiers tolérant aux pannes et, en même temps, productif. </font><font style="vertical-align: inherit;">Développé par Sun Microsistems pour Solaris, ZFS a ensuite été porté sur Linux et FreeBSD. </font><font style="vertical-align: inherit;">Parmi ses nombreux avantages, nous nous intéresserons aux suivants:</font></font><br>
<br>
<ol>
<li> ,          ,   ,    –   ,  LVM;</li>
<li>     256-  ;</li>
<li>      ;</li>
<li>    RAID-    .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parmi les solutions spécialisées capables de travailler avec ZFS, deux concurrents se distinguent clairement - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FreeNAS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NAS4Free</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . De tels noms «miroirs» ne sont en aucun cas accidentels - les deux assemblages sont basés sur FreeBSD, et NAS4Free lui-même est une fourche de FreeNAS 0.7, qui est née au moment où le système d'exploitation d'origine est passé sous l'aile d'iXsystems et est monté sur des rails commerciaux. C'est NAS4Free qui est mon préféré. Pourquoi? Faisons les choses correctement.</font></font><br>
<br>
<ol>
<li>.   ,       NAS,     ,   NAS4Free   .       ?   , 4  RAM,  4-  ,       .     512    2-   .  FreeNAS   :      8  RAM  8- ,          1616 (    ).</li>
<li>.   NAS4Free       “ ” –         :<br>
<img src="https://habrastorage.org/files/db0/488/59d/db048859d2fd48b891142fb3bdb4b3b5.JPG"></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commodité. </font><font style="vertical-align: inherit;">Dans NAS4Free, presque tout peut être contrôlé via une interface Web vraiment intuitive, en plus, contenant beaucoup de conseils et bien traduit en russe par rapport à un concurrent. </font><font style="vertical-align: inherit;">Vous pourrez travailler avec des disques et des services, gérer le système de fichiers, prendre des instantanés et monter des clones sans lancer la console en principe, ce qui plaira aux utilisateurs novices et aux personnes qui ne sont pas du tout familiarisées avec l'administration * nix.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je pense que les arguments ci-dessus sont suffisants pour faire un choix sans ambiguïté. </font><font style="vertical-align: inherit;">Nous allons maintenant traiter de l'installation et de la configuration initiale du système.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Installez NAS4Free</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Puisqu'il n'y a que deux disques dans le système, nous utiliserons un lecteur flash USB comme lecteur de démarrage. Laquelle est absolument hors de propos, toute antiquité de 2 Go suffira amplement. En cas de doute sur la santé de l'appareil, vous pouvez utiliser le même </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rufus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , après avoir effectué plusieurs tests. Ensuite, tout est simple - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">téléchargez le LiveCD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et procédez à l'installation. Vous verrez d'abord l'écran suivant: </font></font><br>
<br>
<img src="https://habrastorage.org/files/fbf/648/4da/fbf6484daa0547b0909f3c6ae628055c.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après un certain temps, le menu texte apparaît à l'écran: </font></font><br>
<br>
<img src="https://habrastorage.org/files/a67/f79/d38/a67f79d38d184d7398b43e8e47ec31e6.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous sommes intéressés par le 9ème élément - nous le sélectionnons. Le processus d'installation démarre:</font></font><br>
<br>
<img src="https://habrastorage.org/files/e0b/749/0b5/e0b7490b5b9249e3afe759a0338f00ac.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous ne touchons pas au mode expert, mais le choix entre GPT et MBR dépend de l'âge de la carte mère de votre machine. Si vous êtes un fan du «classique» face au BIOS, sélectionnez le deuxième élément. Vaut UEFI - choisissez le premier. Après confirmation, NAS4Free vous indiquera aimablement les opérations qu'il va faire - nous sommes d'accord sur tout: </font></font><br>
<br>
<img src="https://habrastorage.org/files/9e0/573/d3d/9e0573d3d97748f9886e27cfce14abd7.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, sélectionnez le lecteur avec le disque d'installation (dans notre exemple, il est le seul): </font></font><br>
<br>
<img src="https://habrastorage.org/files/4e4/6e0/278/4e46e0278ccd4e81ac36823d4deaae17.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ensuite, vous devez spécifier le lecteur flash USB sur lequel l'installation sera effectuée. Il est facile de le distinguer du lecteur système en taille et en nom:</font></font><br>
<br>
<img src="https://habrastorage.org/files/2ab/ab6/10c/2abab610c86a4e088662cc49dadb6788.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'étape suivante consiste à définir la taille du fichier d'échange. La règle est simple: si vous utilisez un lecteur de 2 Go - mettez 512 Mo, 4 Go - mettez 1024 Mo, si 8 - 2. Beaucoup ont une bonne question dans les commentaires, mais à quel point est-il fiable d'installer le système d'exploitation sur une clé USB, d'autant plus que permutez-le ? J'estime nécessaire de clarifier ce point. Premièrement, une caractéristique de la version intégrée est qu'une image disque du système est créée dans la RAM, c'est-à-dire qu'un lecteur flash n'est accessible qu'au moment du chargement du NAS, ainsi que lors de l'enregistrement des paramètres. Deuxièmement, le programme d'installation nécessite la création d'un fichier d'échange sans échec, tout en déterminant incorrectement sa taille. Faire un échange de 8 Go sur un appareil de 4 Go? C'est facile! En tout cas, selon le programme, ça vaut le coup d’essayer. Pour éviter les erreurs, il est plus facile de définir l'une des valeurs correctes données ci-dessus.Et enfin, le fichier d'échange est connecté manuellement dans les paramètres - il ne sera pas utilisé, ce qui signifie que le lecteur flash ne sera pas tué non plus.</font></font><br>
<br>
<img src="https://habrastorage.org/files/f60/05b/781/f6005b78119547c887160a817bc13307.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le processus d'installation commencera, après quoi vous verrez l'écran suivant: </font></font><br>
<br>
<img src="https://habrastorage.org/files/899/565/757/89956575762146aa86febf2e095cf33e.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez déconnecter le lecteur flash USB et redémarrer - l'installation a réussi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, travaillons avec le NAS lui-même. Puisque nous avons choisi l'option de budget pour le client léger comme carte mère, nous devrons commencer par ajuster les paramètres de démarrage, en connectant non seulement un lecteur flash USB, mais également un moniteur avec un clavier à l'appareil. Comme les sorties vidéo présentent D-Sub et HDMI, il ne devrait donc y avoir aucun problème. Après avoir allumé la machine, nous appuyons sur «Supprimer» et définissons notre clé USB dans le menu «Boot» comme périphérique de démarrage principal (par défaut, UEFI Shell démarrera, mais nous n'en avons pas besoin). Nous enregistrons les modifications, redémarrons le NAS, et si tout est fait correctement, nous voyons un menu familier:</font></font><br>
<br>
<img src="https://habrastorage.org/files/145/570/2e1/1455702e1f1845a79781dfc2fcf7f1f7.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous pouvez connecter le NAS à l'environnement de travail par n'importe quel moyen: via un routeur, un commutateur, un concentrateur zéro - tout dépend de vos besoins personnels. </font><font style="vertical-align: inherit;">Étant donné que vous souhaitez probablement amener la machine sur votre réseau domestique, la meilleure option est un routeur, alors configurons une adresse IP statique à l'étape 2. Répondez constamment aux questions posées par le système:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voulez-vous utiliser DHCP pour cette interface? </font><font style="vertical-align: inherit;">- Non (nous voulons définir une IP statique)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entrez la nouvelle adresse IPv4 LAN - 192.168.1.250 (installée par défaut, si elle est déjà utilisée sur votre réseau - entrez-en une gratuite)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entrez le nouveau masque de sous-réseau LAN - 24 (masque de sous-réseau 255.255.255.0)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entrez la passerelle IPv4 par défaut - 192.168.1.1 (spécifiez l'adresse du routeur)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Entrez l'adresse IPv4 DNS - 192.168.1.1 (spécifiez également l'adresse du routeur)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voulez-vous configurer IPv6 pour cette interface? </font><font style="vertical-align: inherit;">- Non (nous n'avons tout simplement pas besoin d'un réseau domestique IPv6)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cet écran témoignera de la réussite de la configuration: </font></font><br>
<br>
<img src="https://habrastorage.org/files/e11/c1a/3b2/e11c1a3b258a446984032148e61f0d6c.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
c'est là que la préparation du NAS est terminée - vous pouvez maintenant connecter le stockage au réseau et procéder à la configuration.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Personnalisez les lecteurs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Toutes les opérations sont effectuées via le WebGUI pratique - il suffit de taper l'adresse IP définie précédemment (dans notre cas - 192.168.1.250) et d'accéder immédiatement au formulaire d'autorisation: la </font></font><br>
<br>
<img src="https://habrastorage.org/files/844/ba8/a75/844ba8a75db746cc88c0d4ab6107eeff.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
connexion par défaut est admin, le mot de passe (qui aurait pensé) est nas4free. </font><font style="vertical-align: inherit;">Connectez-vous et voyez le moniteur du système: </font></font><br>
<br>
<img src="https://habrastorage.org/files/7ee/93c/0d5/7ee93c0d52084fdba42170d9f4a9be33.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons tout de suite aux grands et puissants: allez dans "Système" -&gt; "Général" et changez la langue en russe: </font></font><br>
<br>
<img src="https://habrastorage.org/files/6f7/99d/35b/6f799d35b471485697b7a7284a8e2589.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, vous pouvez également définir un nouveau nom d'utilisateur et mot de passe pour l'interface Web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, configurons les disques. </font><font style="vertical-align: inherit;">On va dans la section "Drives" -&gt; "Management", et ... on ne trouve rien:</font></font><br>
<br>
<img src="https://habrastorage.org/files/fa5/4b0/53a/fa54b053a6a94984b083c298b52930f6.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seulement sans panique - dans NAS4Free, vous devez tout faire avec vos mains. </font><font style="vertical-align: inherit;">L'option la plus simple consiste à cliquer sur «Effacer la configuration et importer des disques», mais je recommande de cliquer sur le signe plus bleu à droite et d'ajouter des lecteurs un par un. </font><font style="vertical-align: inherit;">Le menu est le suivant: </font></font><br>
<br>
<img src="https://habrastorage.org/files/aac/ab4/fc0/aacab4fc02874f59a086427a3ae2bcbd.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Passons en revue les options:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La description peut être laissée vierge du tout, j'ai conduit le nom abrégé du disque;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le mode de transfert quitte Auto;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spécifiez la période de transfert des disques en mode veille en fonction de vos besoins personnels. </font><font style="vertical-align: inherit;">Cependant, il doit être pris en compte: un redémarrage fréquent n'est même pas bénéfique pour un WD Re fiable, il n'est donc pas logique de régler 5 à 10 minutes - cela accélérera seulement l'usure du disque dur;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gestion de l'alimentation - J'ai défini le niveau 127 - un compromis entre les performances et la consommation d'énergie;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Niveau sonore - je ne pense pas qu'il soit nécessaire de l'utiliser, car WD fonctionne très silencieusement de toute façon;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Si vous souhaitez activer la surveillance SMART, cochez la case;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Étant donné que les disques sont nouveaux, nous laissons Non formaté (non formaté) dans la dernière ligne.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, cliquez sur le bouton "Ajouter" et répétez la procédure pour les disques restants. </font><font style="vertical-align: inherit;">Vous n'avez pas besoin d'ajouter un lecteur flash pour éviter tout malentendu (formatez-le rapidement et tout devra recommencer à zéro). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après toutes les manipulations, nous voyons ce qui suit dans le menu des paramètres du disque: </font></font><br>
<br>
<img src="https://habrastorage.org/files/f7d/1d9/ca0/f7d1d9ca037f40d286c4fa1f4edf577b.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lisez l'avertissement dans la capture d'écran. </font><font style="vertical-align: inherit;">Oui, c'est une fonctionnalité de NAS4Free: nous faisons d'abord les réglages, puis nous confirmons le choix en cliquant sur «Appliquer les modifications» - vous devrez vous y habituer. </font><font style="vertical-align: inherit;">Après cela, nous observons le résultat de nos actions: </font></font><br>
<br>
<img src="https://habrastorage.org/files/aef/a97/cd9/aefa97cd9662417f8a71903c3f408636.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Si vous souhaitez recevoir des données SMART en surveillant l'état des disques, rendez-vous dans l'onglet du même nom.</font></font><br>
<br>
<img src="https://habrastorage.org/files/972/633/2f8/9726332f81f54e4fbcc01c31ebf99db3.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cochez la case «Activer», sélectionnez le mode d'alimentation en veille (afin de ne pas déranger les disques durs en mode veille) et enregistrez les modifications. Il y a aussi la possibilité de configurer des alertes. Vous pouvez maintenant afficher les données détaillées de chaque disque dans la section «Diagnostics» -&gt; «Informations» -&gt; «SMART». </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, les deux disques sont en ligne, tous les systèmes fonctionnent correctement. Mais ce n'est que le début du voyage. Passons à l'onglet «Formatage du disque dur». Comme nous l'avons convenu au début de l'article, nous utiliserons ZFS. Sélectionnez les deux disques et cliquez sur «Suivant»:</font></font><br>
<br>
<img src="https://habrastorage.org/files/1eb/08e/72e/1eb08e72e4b5475d872eaa8975b111ae.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'étape suivante, définissez le nom du volume - j'ai choisi WDREZFS% 1. La construction de «% 1» signifie que les disques que nous formons recevront des numéros de série commençant par un. Autrement dit, le premier sera nommé WDREZFS1, le second - WDREZFS2, etc. Si vous ne spécifiez pas de point de départ, en mettant un signe «%» sans chiffre, le système lui-même numérotera le disque dur. Vous pouvez également donner des noms par numéros de série. Par exemple, «[4» signifie que les quatre derniers chiffres du numéro de série seront utilisés comme étiquette. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De plus, je recommande fortement de cocher la case «Création de ZFS sur la partition GPT» si vous construisez un pool multi-disques complexe, prévoyant d'ajouter de nouveaux lecteurs à l'avenir. </font></font><br>
<br>
<img src="https://habrastorage.org/files/191/bd3/bc8/191bd3bc8f494c89b9eb38abd80c8890.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous formatons les disques, attendons la fin de l'opération et cliquons sur le bouton «OK».</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous devons construire un appareil virtuel. Allez dans "Lecteurs" -&gt; "ZFS" -&gt; "Pools" -&gt; "Périphérique virtuel", cliquez sur le bleu plus et voyez l'image suivante: </font></font><br>
<br>
<img src="https://habrastorage.org/files/90c/f28/391/90cf28391fee481b9fb04c0f94e72fb8.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, nous pouvons collecter les disques dans un tableau. J'ai besoin d'un analogue de RAID-1, j'ai donc sélectionné «Mirror» (pour référence, «Stripe» est essentiellement le même RAID-0). Après avoir confirmé la sélection, n'oubliez pas d'appliquer les modifications: </font></font><br>
<br>
<img src="https://habrastorage.org/files/8b0/b18/5c7/8b0b185c703c4208b4ae127141cc9b47.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, nous allons dans l'onglet «Pools» et en ajoutons un nouveau en utilisant le périphérique virtuel nouvellement créé: </font></font><br>
<br>
<img src="https://habrastorage.org/files/44a/2ad/fa5/44a2adfa59424164917a37b8f5dc902d.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout ce qui est requis est de trouver un nom, vous n'avez pas besoin de configurer quoi que ce soit d'autre.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En principe, vous pouvez déjà commencer à télécharger des fichiers, mais il est préférable de profiter du principal avantage de ZFS - la possibilité de créer des ensembles de données. En fait, ce sont des systèmes de fichiers subsidiaires, nous avons donc la possibilité de choisir une méthode de compression pour chaque ensemble de données, de définir des droits d'accès et des quotas de disque (ce qui élimine le cas où votre collection vidéo mange en toute sécurité tout l'espace libre pour les documents), et plus important encore - créer des instantanés qui vous permettent de récupérer presque instantanément les informations perdues. Par conséquent, allons dans les «Datasets» et créons-en: </font></font><br>
<br>
<img src="https://habrastorage.org/files/89f/4e1/1be/89f4e11be0744aeda26a792ef9bf26dd.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la capture d'écran ci-dessus, le seul pool est sélectionné - WDREP et la méthode de compression lzjb (un compromis entre efficacité et performances). </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Déduplication des données</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">laissez-le éteint, car son fonctionnement adéquat nécessite un minimum de 16 gigaoctets de RAM. Le terme lui-même désigne une méthode de compression d'un tableau de données en éliminant les copies en double. Elle est utile, par exemple, si vous créez régulièrement des copies de sauvegarde de gros volumes d'informations, alors que la différence entre elles est minime. Si le NAS ne joue que le stockage de films, de musique, de photos et d'autres contenus multimédias, vous ne remarquerez tout simplement pas les avantages de la duplication, ce qui signifie que vous ne devriez pas dépenser d'argent supplémentaire en matériel. Les autres paramètres sont laissés par défaut. La seule chose, à des fins de démonstration, je mettrai une coche devant «Instantanés de visibilité» - maintenant les images seront visibles à partir d'autres appareils. Dans le champ «Espace réservé», vous pouvez spécifier le volume minimum garanti de l'ensemble de données et «Quota» vous permet de définir la barre supérieure.Ci-dessous, vous pouvez sélectionner des utilisateurs et configurer les droits d'accès:</font></font><br>
<br>
<img src="https://habrastorage.org/files/6ec/2ba/9d4/6ec2ba9d4925465faa41e66dfb7f324f.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De la même manière, vous pouvez ajouter autant de jeux de données que vous le souhaitez:</font></font><br>
<br>
<img src="https://habrastorage.org/files/466/fbd/283/466fbd2831a44e5a84b7745a1d27795f.JPG"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il est temps de télécharger des fichiers</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le NAS est pleinement opérationnel, il reste à lui apprendre à communiquer avec le monde extérieur. </font><font style="vertical-align: inherit;">Pour cela, le système d'exploitation propose un ensemble d'outils très impressionnant pour tous les goûts, situé dans le menu "Services". </font><font style="vertical-align: inherit;">Ce dont vous avez besoin dépend de vous - décidez par vous-même, maintenant je vais me limiter au paramètre FTP de base: </font></font><br>
<br>
<img src="https://habrastorage.org/files/fba/8fa/c95/fba8fac9596241358493ce24f5630068.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N'oubliez pas de cocher la case «Activer» (par défaut, tous les services sont désactivés). </font><font style="vertical-align: inherit;">Le nombre de clients est défini par le nombre d'appareils qui contacteront simultanément le stockage (3 sont pertinents pour moi). </font><font style="vertical-align: inherit;">Je recommande de laisser le nombre de connexions 2. Ensuite, le téléchargement / téléchargement de fichiers sera effectué en un seul flux, ce qui évitera la fragmentation et atteindra la vitesse maximale. </font><font style="vertical-align: inherit;">Enregistrez les paramètres et essayez de vous connecter au NAS:</font></font><br>
<br>
<img src="https://habrastorage.org/files/052/afa/e33/052afae33a9942d9a619b994ea98ef44.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, le pool et les jeux de données sont présentés sous forme de répertoires et les répertoires .zfs sont affichés dans lesquels les instantanés seront enregistrés. Et, il me semble, le moment est venu d'en parler plus en détail. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instantanés - instantanés de l'ensemble du pool ou de l'ensemble de données sélectionné. Sans entrer dans les détails, un instantané est le moyen le plus rapide et le moins cher de sauvegarder en termes d'espace. Actuellement, la fonctionnalité de gestion d'image implémentée dans WebGUI est quelque peu limitée, mais elle est capable de satisfaire pleinement les besoins d'un utilisateur ordinaire. Si vous en voulez plus, vous devez utiliser la console.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
NAS4Free prend en charge la création manuelle et automatique d'instantanés. Pour prendre une photo manuellement, allez dans l'onglet "ZFS" -&gt; "Snapshots" -&gt; "Snapshot", cliquez sur le signe plus, spécifiez le chemin (par exemple, j'ai créé le jeu de données Musique) et pensez à un nom pour la future photo: Une </font></font><br>
<br>
<img src="https://habrastorage.org/files/7f9/b24/baa/7f9b24baa4654293b8c185dca3194338.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
coche dans la colonne "Récursive" "Signifie que des instantanés de tous les jeux de données enfants dans Music seront créés, le cas échéant. Le résultat sera le suivant: </font></font><br>
<br>
<img src="https://habrastorage.org/files/a55/41b/3fa/a5541b3fa5f54b359cae79e9825ddddc.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Oui, ce n'est pas une erreur - un instantané ne prend pas d'espace libre jusqu'à ce que les données de l'ensemble de données soient modifiées. Par exemple, il augmentera à mesure que vous supprimez des fichiers mp3 de la musique. Le processus d'instantané peut être automatisé sur l'onglet «Instantané automatique».</font></font><br>
<br>
<img src="https://habrastorage.org/files/f4c/8b3/e4b/f4c8b3e4bdbf412a83c6072edce9cf48.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, en plus des paramètres décrits ci-dessus, vous pouvez choisir l'heure à laquelle la photo a été prise et la période de stockage. Vous ne pouvez pas spécifier ici un type autre que quotidien (cela n'est possible que via la console). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Eh bien, disons que vous avez accidentellement supprimé des fichiers importants. Comment peuvent-ils être restaurés? Cela se fait en créant des clones. Revenons à l'onglet «Instantané» et cliquez sur l'icône de la clé en face de l'instantané. La fenêtre suivante apparaît: </font></font><br>
<br>
<img src="https://habrastorage.org/files/526/7dd/131/5267dd131142459faee1659b7a207e56.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ici, vous devez choisir le chemin le long duquel le clone sera situé. Bien sûr, il doit être unique et ne pas répéter les noms des jeux de données. Cliquez sur «Exécuter» et vérifiez le résultat via FTP:</font></font><br>
<br>
<img src="https://habrastorage.org/files/ae5/e3e/771/ae5e3e77122a46cdb4a769a024e686a2.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, le clone de MusicSnap répète complètement le contenu de l'ensemble de données d'origine. </font><font style="vertical-align: inherit;">Vous pouvez maintenant extraire les fichiers perdus du clone et les recopier dans Music. </font><font style="vertical-align: inherit;">Une fois le clone supprimé dans le même onglet:</font></font><br>
<br>
<img src="https://habrastorage.org/files/c50/efe/325/c50efe325b014a7f99d97c77428886d2.JPG"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Touche finale</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, ZFS Mirror basé sur le Western Digital Re pratiquement indestructible vous permet de créer un NAS domestique d'une fiabilité tout à fait acceptable, malgré le manque de prise en charge ECC par la carte mère. Cependant, il y a un point faible dans le système décrit - un lecteur flash. La mémoire flash ne peut être qualifiée de fiable que si vous utilisez </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">des puces industrielles</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais NAS4Free fournit un mécanisme très pratique pour élever le serveur à partir de zéro. Dans la section «Système» - «Enregistrement / restauration», vous pouvez obtenir le fichier XML avec les paramètres en un seul clic: le </font></font><br>
<br>
<img src="https://habrastorage.org/files/da2/325/19b/da232519b3b347d3b2773b3b171972cb.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
cryptage du mot de passe est disponible en option. Si le lecteur flash tombe en panne, il vous suffit d'installer le système proprement et de restaurer la configuration à partir du fichier. Tous les pools et ensembles de données créés précédemment, ainsi que les informations stockées, seront à nouveau disponibles.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En fait, c'est tout - le NAS domestique est prêt à fonctionner. </font><font style="vertical-align: inherit;">Pour le moment, l'assemblage décrit ci-dessus me coûte environ un mois, digérant environ 500 gigaoctets pendant cette période. </font><font style="vertical-align: inherit;">Bien sûr, c'est loin d'être un travail d'usure, néanmoins, le stockage fonctionne parfaitement, aucun problème n'a été observé pendant cette période. </font><font style="vertical-align: inherit;">Et maintenant, je vais organiser un peu interactif: écrivez dans les commentaires quelles fonctionnalités NAS4Free vous aimeriez voir, ou quelles solutions non standard que vous aimeriez implémenter en fonction de cela. </font><font style="vertical-align: inherit;">Ainsi, par exemple,   </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dispi était</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intéressé par la possibilité de </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link"><font style="vertical-align: inherit;">créer</font></a><font style="vertical-align: inherit;"> un LAMP à part entière - la demande a été acceptée, bien que je ne promette pas sa publication dans un avenir proche.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr397575/">https://habr.com/ru/post/fr397575/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr397561/index.html">Audio Digest 9: Blogs sur le son, la musique et la technologie audio</a></li>
<li><a href="../fr397563/index.html">L'authenticité du Code de Grolier, le quatrième codex maya survivant, est prouvée.</a></li>
<li><a href="../fr397565/index.html">Comment Lyft voit le transport routier dans 10 ans</a></li>
<li><a href="../fr397567/index.html">Chez Nokia Bell Labs, ils ont réalisé la transmission de données à une vitesse de 1 Tbit / s sur fibre</a></li>
<li><a href="../fr397571/index.html">Le tissu hybride convertit la lumière du soleil et l'énergie mécanique en électricité</a></li>
<li><a href="../fr397577/index.html">Processeur Terminator, Bender, Dandy et Apple 2: MOS 6502</a></li>
<li><a href="../fr397579/index.html">Historique du microprocesseur inattendu</a></li>
<li><a href="../fr397581/index.html">Coup de pied maintenant! Avec Kickstarter, l'avenir est plus proche</a></li>
<li><a href="../fr397583/index.html">Une rencontre inattendue. Chapitre 4</a></li>
<li><a href="../fr397585/index.html">"Oui, tu conduis!". Comment les overclockeurs ont changé l'industrie informatique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>