<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üí≥ ü§±üèΩ ‚ñ™Ô∏è Criando o rosto de um personagem para o jogo "OnAir" üßô ‚ôÇÔ∏è ü•ó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Boa tarde Meu nome √© Daria, sou um artista 3d no est√∫dio de produ√ß√£o RainStyle. Atualmente, estamos desenvolvendo um jogo de terror de fic√ß√£o cient√≠fi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Criando o rosto de um personagem para o jogo "OnAir"</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471288/">  Boa tarde  Meu nome √© Daria, sou um artista 3d no est√∫dio de produ√ß√£o RainStyle.  Atualmente, estamos desenvolvendo um jogo de terror de fic√ß√£o cient√≠fica chamado <b>‚ÄúOn Air‚Äù</b> . <br><br><img src="https://habrastorage.org/webt/kx/a4/x0/kxa4x0nk1p-invxwlnmddbywfkm.png" alt="imagem"><br><br>  O jogo conta sobre eventos misteriosos que aconteceram com o personagem principal, que acidentalmente ficou no hotel americano Algol.  Este incidente mudar√° completamente sua vida e o far√° encarar o desconhecido. <br><a name="habracut"></a><br>  Este √© o nosso primeiro projeto de jogo e nele tentamos alcan√ßar o realismo m√°ximo dos personagens, transmitir suas emo√ß√µes e car√°ter.  Portanto, para cri√°-los, decidiu-se usar a tecnologia de digitaliza√ß√£o de rosto.  Como parte dos objetivos do projeto, precisamos de dois graus de detalhes para os personagens: para renderiza√ß√£o - para cinema e baixa poli - para uso no pr√≥prio jogo. <br><br>  O jogo On Air est√° sendo desenvolvido no Unreal Engine 4. Planejamos escrever v√°rios artigos nos quais descreveremos detalhadamente as etapas da prepara√ß√£o do personagem. <br><br>  No momento, estamos criando uma vers√£o demo do jogo, que em breve aparecer√° no Steam.  Neste artigo, falarei sobre o est√°gio inicial de cria√ß√£o da face do personagem principal do nosso jogo. <br><br><img src="https://habrastorage.org/webt/-e/ce/rh/-ecerhoq3v8iuxdyublvhwuwfd8.png" alt="imagem"><br><br><h4>  Parte 1 </h4><br>  A imagem abaixo mostra algumas das emo√ß√µes que recebemos ap√≥s o processamento das digitaliza√ß√µes. <br><br><img src="https://habrastorage.org/webt/fd/tc/wt/fdtcwtsvrpdodfwomu8r6_np_g4.png" alt="imagem"><br><br>  Basicamente, eles s√£o exagerados e n√£o parecem realistas.  Isso foi feito de prop√≥sito.  O fato √© que a base desse m√©todo de cria√ß√£o de uma face √© o princ√≠pio de misturar as formas "Blend shapes".  Ou seja, cada uma dessas emo√ß√µes ser√° aplicada n√£o de uma forma "pura", mas em combina√ß√£o com outras.  Vou falar mais sobre isso no final do artigo.  Primeiro, voc√™ precisa descobrir o que fazer com a cabe√ßa digitalizada e como podemos us√°-la.  Obviamente, a topologia da digitaliza√ß√£o n√£o permite us√°-la como modelo, mas, ao fazer o mapa normal, obtemos as principais caracter√≠sticas da face, rugas, poros, incha√ßos ou cicatrizes.  Tamb√©m a partir da digitaliza√ß√£o, podemos extrair a textura da cor base. <br><br><img src="https://habrastorage.org/webt/4l/ex/lr/4lexlrzmipmxepu4d2uqhs1ocgw.png" alt="imagem"><br><br>  O programa Wrap 3.3 nos ajudar√° com isso.  √â amplamente utilizado para processar modelos digitalizados.  Com essa ajuda, projetaremos nosso futuro modelo de cabe√ßote em digitaliza√ß√µes. <br><br><h4>  Parte 2 </h4><br>  Primeiro, voc√™ precisa criar a chamada malha base.  Ou seja, uma express√£o facial neutra que subjaz a todas as emo√ß√µes.  Nossa verifica√ß√£o de emo√ß√µes neutras √© assim: <br><br><img src="https://habrastorage.org/webt/bf/zm/9r/bfzm9rnkwmw7whotrzfbolxmcym.png" alt="imagem"><br><br>  O programa Wrap 3.3 possui um sistema de n√≥s, ou seja, todas as fun√ß√µes s√£o apresentadas na forma de n√≥s (n√≥s) vinculados por uma cadeia. <br><br>  A sele√ß√£o do n√≥ √© realizada usando a tecla Tab.  Usando os n√≥s LoadGeom e LoadImage, uma varredura com emo√ß√£o neutra e sua textura correspondente s√£o carregadas.  Para fazer isso, especifique o caminho na janela Nomes de Arquivos.  Nas configura√ß√µes do n√≥ ‚ÄúLoadGeom‚Äù, voc√™ pode selecionar v√°rios modos de exibi√ß√£o da geometria (a fun√ß√£o wireframe est√° desativada na imagem abaixo).  Aqui voc√™ tamb√©m pode alterar a cor da geometria (n√£o funciona se a textura estiver conectada), coordenadas e escala. <br><br><img src="https://habrastorage.org/webt/jj/sa/ck/jjsacktagmrzkvs25xuhzuq0fos.png" alt="imagem"><br><br>  Em seguida, voc√™ precisa carregar a malha de base, que ser√° projetada nessa digitaliza√ß√£o.  Voc√™ pode encontr√°-lo na guia "Galeria".  Aqui est√£o muitas emo√ß√µes prontas.  Nesse caso, eu escolho o Basemesh. <br><br><img src="https://habrastorage.org/webt/-v/lc/b7/-vlcb7otf7kgk5o4zzbnwhdkvq4.png" alt="imagem"><br><br>  O basemesh deve corresponder aproximadamente a uma varredura.  Para fazer isso, voc√™ pode usar o eixo de coordenadas. <br><br>  Para projetar a malha base na varredura, eu uso o n√≥ Quebra.  Quando voc√™ passa o mouse sobre os n√≥s do n√≥, uma dica de ferramenta √© exibida: o primeiro n√≥, Geometria flutuante - para a geometria projetada, o segundo n√≥, Geometria de fixos - para o objeto fixo sobre o qual a geometria ser√° projetada (no nosso caso, esta √© uma varredura com uma emo√ß√£o neutra). <br><br><img src="https://habrastorage.org/webt/xd/y0/mc/xdy0mcmzi9irpyydokryacbctla.png" alt="imagem"><br><br>  Para iniciar o c√°lculo, √© necess√°rio marcar os pontos nos dois modelos que corresponder√£o um ao outro.  Para isso, √© utilizado o n√≥ Selecionar pontos, que √© conectado aos n√≥s correspondentes dos modelos.  Ap√≥s selecionar este n√≥, acesse a guia Editor Visual.  A fun√ß√£o inclu√≠da de visualiza√ß√µes de sincroniza√ß√£o permite sincronizar c√¢meras para as janelas esquerda e direita. <br><br><img src="https://habrastorage.org/webt/8f/ow/uc/8fowucelwz7738je5jm2xp9gkxc.png" alt="imagem"><br><br>  Se o modelo projetado contiver pol√≠gonos que devem permanecer no lugar, voc√™ dever√° selecion√°-los usando a fun√ß√£o Selecionar pol√≠gonos.  Caso contr√°rio, poder√£o surgir artefatos associados aos detalhes internos da malha. <br><br><img src="https://habrastorage.org/webt/jr/zv/dz/jrzvdzuikyktk64wpo_cs4n62yi.png" alt="imagem"><br><br>  Para usar o n√≥ Selecionar pol√≠gonos, use a guia Editor Visual.  Aqui, voc√™ pode selecionar os pol√≠gonos que os Modelos da galeria s√£o divididos em pol√≠grupos, simplificando a tarefa: eles podem ser selecionados ou desmarcados no painel superior. <br><br>  Destaco as partes internas da garganta, narinas, p√°lpebras extremas e parte inferior do pesco√ßo. <br><br><img src="https://habrastorage.org/webt/2v/nj/97/2vnj97z73izx0zdbnvvlefk4aja.png" alt="imagem"><br><br><img src="https://habrastorage.org/webt/so/ps/rc/sopsrc9xofh9bcneqnj8grhh2lm.png" alt="imagem"><br><br>  Depois disso, o modelo ser√° projetado corretamente. <br><br><img src="https://habrastorage.org/webt/i2/52/78/i25278qwzpx0x0a-s13wj4vn8wk.png" alt="imagem"><br><br>  Al√©m disso, para obter mais granularidade, voc√™ pode usar o n√≥ Subdivide.  Ele se conecta √† malha base e todos os n√≥s abaixo s√£o conectados ao seu n√≥ inferior (Sa√≠da). <br><br><img src="https://habrastorage.org/webt/u7/s-/dd/u7s-ddnr9ctkghve6wicg-x7qic.png" alt="imagem"><br><br>  Em seguida, leve a textura da digitaliza√ß√£o para a malha base.  Para isso, o n√≥ Transferir textura √© usado.  O n√≥ Geometria de origem se conecta ao modelo com o qual a textura ser√° assada.  No nosso caso, isso √© uma varredura.  O n√≥ Geometria de destino est√° conectado √† malha base, mas n√£o ao n√≥ LoadGeom, mas ao n√≥ Quebra autom√°tica, pois usaremos a geometria projetada j√° modificada. <br><br><img src="https://habrastorage.org/webt/em/vj/ra/emvjrap3jv0drbe42u8lxjspjn8.png" alt="imagem"><br><br>  Nas configura√ß√µes deste n√≥, voc√™ pode selecionar a qualidade da textura cozida.  Depois disso, vale a pena adicionar o n√≥ Extrapolar imagem para preencher os lugares transparentes e salvar a textura resultante usando o n√≥ Salvar imagem e pressionando o bot√£o Calcular quadro atual.  A geometria √© salva da mesma maneira usando o n√≥ Save Geom. <br><br><img src="https://habrastorage.org/webt/q8/ol/xq/q8olxqwsxreywugalgqd5gfh1ek.png" alt="imagem"><br><br><h4>  Parte 3 </h4><br>  Depois de termos uma emo√ß√£o e uma textura neutras, podemos passar a obter geometria para outras emo√ß√µes.  Para fazer isso, carregue o modelo de digitaliza√ß√£o e o Basemesh com texturas. <br><br><img src="https://habrastorage.org/webt/sd/ey/nx/sdeynxlfx4nmbc9hefsxeq_y-v4.png" alt="imagem"><br><br>  Em seguida, voc√™ precisa alinhar o Basemesh de acordo com a verifica√ß√£o.  Para iniciantes, voc√™ pode comparar modelos aproximadamente usando eixos de coordenadas. <br><br><img src="https://habrastorage.org/webt/oh/ka/7x/ohka7x47eywbrue0da6kbhgc9e4.png" alt="imagem"><br><br>  Um n√≥ que permite alinhar com mais precis√£o os modelos entre si - Alinhamento r√≠gido.  O n√≥ de geometria flutuante conecta a geometria que precisa ser alinhada.  No n√≥ de geometria fixa, respectivamente, haver√° geometria est√°tica (no nosso caso, isso √© uma varredura). <br><br><img src="https://habrastorage.org/webt/-1/8f/an/-18fanskyoz3mzz3ispdjlsgt9k.png" alt="imagem"><br><br>  Ao usar o n√≥ Alinhamento r√≠gido, voc√™ deve usar o n√≥ Selecionar pontos: <br><br><img src="https://habrastorage.org/webt/yx/nk/yz/yxnkyzv8vfifpocy9rezqo77sbq.png" alt="imagem"><br><br>  Meu modelo possui marcadores de controle que simplificam a tarefa de selecionar pontos.  Para alinhar os modelos entre si, pontos devem ser colocados nas partes do rosto que mudam levemente ao representar uma emo√ß√£o espec√≠fica.  No caso dessa emo√ß√£o, essa √© a testa, a parte superior do nariz, o pesco√ßo etc.  Al√©m disso, √© aconselh√°vel colocar pontos em todos os lados do modelo (ou seja, n√£o apenas no rosto, mas tamb√©m na parte de tr√°s da cabe√ßa e orelhas). <br><br><img src="https://habrastorage.org/webt/qy/88/yf/qy88yf5dndsigcayzn7cruu1m-4.png" alt="imagem"><br><br>  Como resultado, temos modelos alinhados entre si: <br><br><img src="https://habrastorage.org/webt/bx/l9/ao/bxl9aog0pbuv2bap92i0sysyi9g.png" alt="imagem"><br><br>  Nas configura√ß√µes do n√≥ Alinhamento r√≠gido, h√° uma fun√ß√£o "Match skale".  √â usado se os modelos tamb√©m precisarem ser redimensionados. <br><br>  Depois disso, voc√™ pode come√ßar a projetar a malha base na digitaliza√ß√£o.  Para isso, usaremos o n√≥ Optical Flow Wrapping.  Permite alinhar a geometria de acordo com a textura da digitaliza√ß√£o.  Ao mesmo tempo, a textura resultante das emo√ß√µes coincidir√° completamente com a textura da malha base, com exce√ß√£o de rugas, rugas e outras altera√ß√µes.  Todas as irregularidades da pele e poros ao usar este m√©todo permanecem no local. <br><br><img src="https://habrastorage.org/webt/mb/7m/iv/mb7mivt59e9su6kjmrpk1hnugwa.png" alt="imagem"><br><br>  Antes de usar o fluxo √≥ptico, como no primeiro caso, o n√≥ Selecionar pol√≠gonos √© usado: <br><br><img src="https://habrastorage.org/webt/ju/4v/to/ju4vto3ddusr5jsvugf6odd_qbi.png" alt="imagem"><br><br>  Assim, as partes fixas da cabe√ßa permanecer√£o no lugar. <br><br>  Voc√™ tamb√©m pode usar o n√≥ Selecionar pontos.  Aqui est√£o os pontos nas partes m√≥veis da face: <br><br><img src="https://habrastorage.org/webt/ph/3h/gw/ph3hgwcigqpzp7k8phlpe-n-d78.png" alt="imagem"><br><br>  Em seguida, v√° para as configura√ß√µes de fluxo √≥ptico.  As c√¢meras que podem ser ajustadas apareceram na janela do Editor Visual ao redor do modelo. <br><br><img src="https://habrastorage.org/webt/kf/lk/gs/kflkgszewb1rqqb5mruaw2fpo38.png" alt="imagem"><br><br>  No topo, h√° um menu suspenso com o qual voc√™ pode ir para a vista da c√¢mera.  Por padr√£o, existem 13. Voc√™ precisa configur√°-los para que o rosto caiba completamente no quadro. <br><br><img src="https://habrastorage.org/webt/nk/rz/da/nkrzdal-nf0bmdccxubbr2jfgnk.png" alt="imagem"><br><br>  Por recomenda√ß√£o dos desenvolvedores, deixo quase todas as configura√ß√µes por padr√£o, com exce√ß√£o dos par√¢metros Final da resolu√ß√£o e Final da suavidade do fluxo √≥ptico: <br><br><img src="https://habrastorage.org/webt/rs/og/t3/rsogt301d29-fmdkw3-w_ikb4f8.png" alt="imagem"><br><br>  Depois disso, voc√™ pode clicar em Computar e ver o resultado: <br><br><img src="https://habrastorage.org/webt/oq/sh/wv/oqshwvwqspwpktcdmrtcdaan0ru.png" alt="imagem"><br><br>  Depois que a malha √© projetada exatamente na digitaliza√ß√£o, voc√™ precisa assar a textura.  isso √© feito de acordo com o mesmo princ√≠pio da primeira parte do artigo: <br><br><img src="https://habrastorage.org/webt/5q/i3/ua/5qi3uariv6ry89ideprjf9yonmo.png" alt="imagem"><br><br>  Como resultado, se voc√™ combinar a textura resultante com a textura da malha de base, alguns detalhes ser√£o adicionados, mas ao mesmo tempo, os pontos de controle coincidir√£o: <br><br><img src="https://habrastorage.org/webt/fs/ws/tk/fswstkeyd2cmmu2xdzdja_3ffbg.png" alt="imagem"><br><br>  Depois disso, a textura e a geometria resultante podem ser salvas. <br><br><img src="https://habrastorage.org/webt/fg/o1/sz/fgo1szpef_fqluip7uf4uqgehko.png" alt="imagem"><br><br>  Como resultado, obtivemos uma malha de uma nova emo√ß√£o com uma textura. <br><br><h4>  Parte 4 </h4><br>  O m√©todo Blend shapes permite que voc√™ ‚Äúmisture emo√ß√µes‚Äù.  Para fazer isso, carregue malhas j√° recebidas no n√≥ Blend shapes. <br><br><img src="https://habrastorage.org/webt/jl/fi/i2/jlfii24nzvg4ptcyfl7bawhwbbc.png" alt="imagem"><br><br>  Eu carreguei emo√ß√£o neutra no primeiro n√≥.  Movendo os controles deslizantes nas configura√ß√µes do n√≥, voc√™ pode escolher com que intensidade essa ou aquela emo√ß√£o ser√° expressa.  Para que esse m√©todo funcione, os modelos devem ter a mesma topologia. <br><br><img src="https://habrastorage.org/webt/zx/0k/o5/zx0ko5teguiqiogh4qcsc8cyw_u.png" alt="imagem"><br><br><img src="https://habrastorage.org/webt/vi/ld/uq/vilduqi1jwtzgr662xx4nsyh85q.png" alt="imagem"><br><br><h4>  Resultado </h4><br>  O processo acima √© apenas uma pequena parte de um trabalho muito volumoso.  Ap√≥s receber os modelos de cabe√ßote LowPoly, foi necess√°rio criar mapas normais, rugosidade, subsuperf√≠cie etc., al√©m de configurar o shader (no nosso caso, configuramos o shader para a renderiza√ß√£o e o mecanismo).  Olhos, roupas e cabelos tamb√©m foram criados separadamente.  Tamb√©m √© importante notar que apenas tr√™s pessoas executaram essa tarefa.  Esta foi a nossa primeira experi√™ncia na cria√ß√£o de um personagem altamente detalhado.  Ficamos satisfeitos com o resultado, mas lutaremos por mais. <br><br><img src="https://habrastorage.org/webt/25/wo/-m/25wo-m_68qxmzq4wtff-2px721u.jpeg" alt="imagem"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt471288/">https://habr.com/ru/post/pt471288/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt471268/index.html">Entendendo os Corretores de Mensagens. Aprendendo a mec√¢nica das mensagens atrav√©s do ActiveMQ e Kafka. Cap√≠tulo 2. ActiveMQ</a></li>
<li><a href="../pt471270/index.html">Automatizamos o recebimento de dados na velocidade de carregamento de um site do Google PageSpeed ‚Äã‚ÄãInsights [modelo]</a></li>
<li><a href="../pt471272/index.html">Os benef√≠cios da digita√ß√£o forte em C ++: experi√™ncia pr√°tica</a></li>
<li><a href="../pt471278/index.html">Gera√ß√£o de texto em russo por modelos</a></li>
<li><a href="../pt471282/index.html">√Ä procura de pneumonia em raios-x com Fast.ai</a></li>
<li><a href="../pt471294/index.html">Poemas sobre Haskell, C ++ e programadores</a></li>
<li><a href="../pt471296/index.html">Lean Manufacturing - uma ferramenta para a efici√™ncia</a></li>
<li><a href="../pt471298/index.html">Bieber e Bilan acenam com uma caneta. AI agora est√° cantando m√∫sicas</a></li>
<li><a href="../pt471300/index.html">Reagir: elevar o estado est√° matando seu aplicativo</a></li>
<li><a href="../pt471302/index.html">Verifica√ß√£o do usu√°rio na China e cr√©dito social</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>