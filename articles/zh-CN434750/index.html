<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔙 🎍 👨🏽‍💼 如何控制您的网络基础架构。 第二章 清洁和记录 ⛹🏼 👨🏼‍🤝‍👨🏻 🤷🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文是标题为“如何控制网络基础结构”的系列文章中的第二篇。 该系列中所有文章的内容和链接都可以在这里找到 。 



 我们现阶段的目标是清理文档和配置。 
 在此过程的输出中，您应该具有必要的文档集和根据它们配置的网络。 

 现在我们不再谈论安全审核-第三部分将专门讨论这一点。 

 当然，在这...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>如何控制您的网络基础架构。 第二章 清洁和记录</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434750/">  <i>本文是标题为“如何控制网络基础结构”的系列文章中的第二篇。</i>  <i>该系列中所有文章的内容和链接都可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这里</a>找到</i> 。 <br><br><img src="https://habrastorage.org/files/7f5/0f3/579/7f50f35797d243e0a8563ba76f850724.jpg" alt="图片"><br><br> 我们现阶段的目标是清理文档和配置。 <br> 在此过程的输出中，您应该具有必要的文档集和根据它们配置的网络。 <br><br> 现在我们不再谈论安全审核-第三部分将专门讨论这一点。 <br><br> 当然，在这个阶段完成任务的难度因公司而异。 <br><br> 理想的情况是 <br><br><ul><li> 您的网络是根据项目创建的，并且您拥有全套文档 </li><li> 贵公司已实施了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">监视和管理</a>网络<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">变更</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">过程</a> </li><li> 根据此过程，您将拥有可提供有关当前状况的完整信息的文档（包括所有必要的方案） </li></ul><br> 在这种情况下，您的任务非常简单。 您应该研究文档并查看已进行的所有更改。 <br><br> 在最坏的情况下，您将拥有 <br><br><ul><li> 没有资格的工程师在没有项目，没有计划，没有协调的情况下创建的网络， </li><li> 具有混乱的，未记录的更改，以及大量的“垃圾”和次优解决方案 </li></ul><br> 很显然，您的处境介于两者之间，但不幸的是，在这种情况下情况会更好-极有可能出现更糟的情况，您将更接近最坏的情况。 <a name="habracut"></a><br><br> 在这种情况下，您还需要具有阅读思想的能力，因为您将必须学习理解“设计师”想要做什么，恢复他们的逻辑，完成未完成的事情并删除“垃圾”。 <br> 并且，当然，您将需要停止他们的错误，更改（在此阶段尽可能少地）设计并更改或重新创建电路。 <br><br> 本文不打算以任何方式全面。 在这里，我将仅描述一般原则，并集中讨论一些必须解决的常见问题。 <br><br><h2> 套文件 </h2><br><blockquote> 让我们从一个例子开始。 <br><br> 以下是Cisco Systems通常在设计中创建的一些文档。 <br><br>  <b>CR-</b>自定义要求，客户要求（技术任务）。 <br> 它与客户一起创建并定义网络要求。 <br><br>  <b>HLD-</b>高级设计，基于网络需求（CR）的高级设计。 该文档说明并证明了所采用的体系结构决策（拓扑，协议，设备选择等）。  HLD不包含设计详细信息，例如，有关使用的接口和IP地址的信息。 另外，此处不讨论特定的设备配置。 相反，本文档旨在说明客户技术管理的关键设计概念。 <br><br>  <b>LLD-</b>低层设计，基于高层（HLD）的低层设计。 <br> 它应包含项目实施所需的所有详细信息，例如有关如何连接和配置设备的信息。 这是设计实施的完整指南。 即使不是非常有资格的人员，该文档也应提供足够的信息以供实施。 <br><br> 诸如IP地址，AS号，电缆之类的内容可以在单独的文档中“取出”，例如<b>NIP</b> （网络实施计划）。 <br><br> 网络构建在创建这些文档之后开始，并严格按照它们进行，然后由客户检查（测试）是否符合设计要求。 </blockquote><br> 当然，不同的集成商，不同的客户，不同的国家/地区对项目文档的要求可能会有所不同。 但是我想避免手续，而是根据案情考虑这一问题。 这个阶段与设计无关，而在于使事情井然有序，我们需要一组足以完成任务的文档（方案，表格，说明...）。 <br><br> 在我看来，存在一定的绝对最小值，否则就无法有效地控制网络。 <br><br> 这些是以下文件： <br><br><ul><li> 物理交换（电缆）的方案（日志） </li><li> 网络电路或具有大量L2 / L3信息的电路 </li></ul><br><h2> 物理交换方案 </h2><br> 在一些小公司中，与设备安装和物理布线相关的工作是网络工程师的责任。 <br><br> 在这种情况下，可以通过以下方法部分解决该问题。 <br><br><ul><li> 在接口上使用描述来描述与其连接的内容 </li><li> 以管理方式关闭网络设备的所有未连接端口 </li></ul><br> 即使在链路出现问题时（当cdp或lldp在此接口上不起作用时），这也将为您提供机会，快速确定连接到该端口的端口。 <br> 您还可以轻松查看哪些端口正在忙碌，哪些端口空闲，这对于规划新网络设备，服务器或工作站的连接是必需的。 <br><br> 但是很明显，如果您无法访问设备，则将无法访问此信息。 此外，以这种方式，您将无法记录重要信息，例如哪种设备，什么功率消耗，多少个端口，哪个机架位于，什么配线架以及它们连接到哪个位置（哪个机架/配线架） 。 因此，所有相同的其他文档（不仅是硬件说明）非常有用。 <br><br> 理想的选择是使用旨在处理此类信息的应用程序。 但是您可以将自己限制为简单的表（例如在Excel中），也可以显示您认为在L1 / L2方案中必需的信息。 <br><blockquote> 重要！ <br><br> 当然，网络工程师可以非常清楚SCS的复杂性和标准，机架的类型，不间断电源的类型，冷热走廊是什么，进行适当的接地...就像从原理上他可以了解粒子物理学或C ++一样。 但是，一个人必须明白，这不是他的知识领域。 <br><br> 因此，优良作法是由专门的部门或专门人员解决与安装，连接，设备性能维护以及物理交换相关的问题。 通常，对于数据中心，这是数据中心工程师，对于办公室，是服务台。 <br><br> 如果您的公司中提供了此类设备，那么维护物理交换日志的问题就不是您的任务，并且您可以限制自己仅描述接口并以管理方式关闭未使用的端口。 </blockquote><h2> 网络图 </h2><br> 没有通用的绘图方案。 <br><br> 最重要的是，这些方案应了解流量将如何通过网络的逻辑和物理元素。 <br><br> 所谓物理元素，是指 <br><br><ul><li> 主动设备 </li><li> 活动设备的接口/端口 </li></ul><br> 根据逻辑- <br><br><ul><li> 逻辑设备（N7K VDC，Palo Alto VSYS等） </li><li>  VRF </li><li> 维拉纳斯 </li><li> 子接口 </li><li> 隧道 </li><li> 区域 </li><li>  ... </li></ul><br> 另外，如果您的网络不是完全基础的，它将由不同的网段组成。 <br> 举个例子 <br><br><ul><li> 数据中心 </li><li> 互联网 </li><li> 万 </li><li> 远程访问 </li><li> 办公室局域网 </li><li>  Dmz </li><li>  ... </li></ul><br> 合理的做法是，有几种方案可以给出总体情况（所有这些网段之间的流量如何）以及每个单独网段的详细说明。 <br><br> 由于现代网络可以具有许多逻辑级别，因此一种好的（但不是强制性的）方法可能针对不同的级别制定不同的方案，例如，在重叠方法的情况下，这些方案可以是以下方案： <br><br><ul><li> 覆盖 </li><li>  L1 / L2参考底图 </li><li>  L3参考底图 </li></ul><br> 当然，最重要的方案是路由方案，没有它，就不可能理解您的设计思想。 <br><br><h4> 路由方案 </h4><br> 该图至少应反映 <br><br><ul><li> 什么路由协议以及在哪里使用 </li><li> 有关路由协议设置的基本信息（区域/ AS编号/路由器ID / ...） </li><li> 在哪些设备上发生重新分配 </li><li> 发生路由过滤和聚合的地方 </li><li> 默认路线信息 </li></ul><br>  L2电路（OSI）通常也很有用。 <br><br><h4>  L2电路（OSI） </h4><br> 以下信息可能会反映在该图中： <br><br><ul><li> 什么vlan </li><li> 哪些端口是中继端口 </li><li> 哪些端口聚合在以太通道（端口通道），虚拟端口通道中 </li><li> 什么STP协议以及在哪些设备上使用 </li><li>  STP主要设置：根/根备份，STP成本，端口优先级 </li><li> 先进的STP设置：BPDU防护/过滤器，根防护... </li></ul><br><h2> 典型设计错误 </h2><br><blockquote> 一个不良的网络构建方法示例。 <br><br> 让我们以构建简单的办公室局域网的简单示例为例。 <br><br> 拥有向学生教授电信的经验，我可以说，实际上，到第二学期中期的任何一个学生都拥有必要的知识（作为我所教课程的一部分），以便建立简单的办公室局域网。 <br><br> 将交换机彼此连接，配置VLAN，SVI接口（对于L3交换机）以及设置静态路由有什么困难？ <br><br> 一切都会正常。 <br><br> 但与此同时，与 <br><br><ul><li> 安全性 </li><li> 预约 </li><li> 网络扩展 </li><li> 表现 </li><li> 频宽 </li><li> 可靠性 </li><li>  ... </li></ul><br> 有时，我会听到这样的说法：办公室局域网很简单，我通常会听到工程师（和经理）的话，他们做任何事情，但不做网络工作，他们如此自信地说，如果局域网不感到惊讶将由实践和知识不足的人进行，并且将大致与我将在下面描述的错误有关。 </blockquote><br><h4> 常见设计L1层错误（OSI） </h4><br><ul><li> 但是，如果您要负责，包括对SCS的负责，那么您可能会遇到的最不愉快的遗产之一就是粗心大意和无意识的转换。 </li></ul><br> 另外，要键入L1，我将与使用的设备资源相关的错误分类，例如， <br><br><ul><li> 带宽不足 </li><li> 设备上的TCAM不足（或使用效率低下） </li><li> 性能不足（通常指防火墙） </li></ul><br><h4> 常见设计L2层错误（OSI） </h4><br> 通常，当对STP的工作原理，所带来的潜在问题没有很好的了解时，交换机将以默认设置随机连接，而无需额外调整STP。 <br><br> 结果，我们经常有以下情况 <br><br><ul><li> 网络的STP直径较大，可能导致广播风暴 </li><li>  STP根将是随机确定的（基于mac地址），并且流量路径将不是最佳的 </li><li> 连接到主机的端口不会配置为边缘（端口快速），这将导致在打开/关闭端点时重新计算STP </li><li> 网络将不会在L1 / L2级别上进行分段，因此，任何交换机的问题（例如，电源过载）都将导致STP拓扑的重新计算并停止所有交换机上所有VLAN中的流量（包括从连续性角度来看很关键的问题）服务细分） </li></ul><br><h4>  L3设计错误示例（OSI） </h4><br> 新手网络人员的一些典型错误： <br><br><ul><li> 频繁使用（或仅使用）静态路由 </li><li> 使用对本设计而言并非最佳的路由协议 </li><li> 次优逻辑网络分段 </li><li> 地址空间的非最佳使用，不允许路由聚合 </li><li> 缺乏备用路线 </li><li> 缺少默认网关的冗余 </li><li> 重建路由时的非对称路由（对于NAT / PAT，全状态防火墙可能至关重要） </li><li>  MTU的问题 </li><li> 重建路由时，流量会通过其他安全区域甚至其他防火墙，这导致该流量下降 </li><li> 拓扑可伸缩性差 </li></ul><br><h2> 设计质量评估标准 </h2><br> 当我们谈论最优/非最优时，我们必须了解可以评估这一标准的标准。 在我看来，最重要（但不是全部）的标准（以及与路由协议有关的解密）： <br><br><ul><li> 可扩展性 <br> 例如，您决定添加另一个数据中心。 您可以轻松完成。 </li><li> 管理上的便利性（可管理性） <br> 操作更改（例如宣布新电网或过滤路线）有多么容易和安全？ </li><li> 可用性 <br> 您的系统在多少百分比的时间内提供所需的服务水平 </li><li> 安全性 <br> 传输的数据有多安全？ </li><li> 价格 </li></ul><br><h2> 变化 </h2><br> 这个阶段的基本原则可以用“不伤害”的表达方式来表达。 <br> 因此，即使您不太同意设计和所选的实现（配置），也不总是建议进行更改。 合理的方法是以两种方式对所有已发现的问题进行排名： <br><br><ul><li> 解决这个问题有多容易 </li><li> 她承担多少风险 </li></ul><br> 首先，有必要消除当前将提供的服务水平降低到允许的以下水平，例如导致包丢失的问题。 然后消除最简单，最安全的消除方法，以降低风险的严重性（从设计或配置问题中将更大的风险转移到较小的风险中）。 <br><br> 在这个阶段的完美主义可能是有害的。 使设计达到令人满意的状态，并根据它同步网络配置。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN434750/">https://habr.com/ru/post/zh-CN434750/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN434738/index.html">Python中的强化学习</a></li>
<li><a href="../zh-CN434740/index.html">神经网络教授如何检测卫星图像中的太阳能电池板并预测其分布水平</a></li>
<li><a href="../zh-CN434742/index.html">第2部分：使用赛普拉斯的UDB PSoC控制器减少3D打印机中的中断次数</a></li>
<li><a href="../zh-CN434744/index.html">三星SSD 860 QVO 1 TB和4 TB：第一个消费者SATA QLC（2部分）</a></li>
<li><a href="../zh-CN434746/index.html">BLE在显微镜4下</a></li>
<li><a href="../zh-CN434752/index.html">Robomoroz：新年主角的未来</a></li>
<li><a href="../zh-CN434756/index.html">Kubernetes的未来是虚拟机</a></li>
<li><a href="../zh-CN434758/index.html">Facebook版主指南：超过1,400页有冲突的幻灯片</a></li>
<li><a href="../zh-CN434760/index.html">PostgreSQL新闻摘要。 新年（缩短）第13期</a></li>
<li><a href="../zh-CN434762/index.html">植物化学家的笔记。 绿香蕉，还是记得养活微生物</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>