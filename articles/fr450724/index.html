<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙉 👩‍💼 🌜 Présentation de Python pour les camarades dépassant le «langage A contre V» langue B "et autres préjugés 📓 🏥 📬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pour tous les résidents de habrach qui ont le sentiment de déjà-vu: j'ai été invité à écrire ce post par l'article "Introduction à Python" et ses comm...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Présentation de Python pour les camarades dépassant le «langage A contre V» langue B "et autres préjugés</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450724/"><p>  Pour tous les résidents de habrach qui ont le sentiment de déjà-vu: j'ai été invité à écrire ce post par l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">"Introduction à Python"</a> et ses commentaires.  Malheureusement, la qualité de cette "introduction" ahem ... ne parlons pas de tristes choses.  Mais il était encore plus triste d'observer les querelles dans les commentaires des catégories «C ++ est plus rapide que Python», «Rust est encore plus rapide que C ++», «Python n'est pas nécessaire», etc.  C'est étonnant qu'ils ne se souviennent pas de Ruby! </p><br><p>  Comme l'a dit Bjarn Stroustrup, </p><br><blockquote>  "Il n'y a que deux types de langages de programmation: ceux que les gens jurent à tout moment, et ceux que personne n'utilise." </blockquote><p>  Bienvenue à tous ceux qui souhaitent se familiariser avec Python sans tomber dans le piège! </p><a name="habracut"></a><br><p> La matinée dans les montagnes du Caucase de l'Est a été marquée par des cris.  Deux jeunes hommes se sont assis sur un gros rocher et ont discuté vigoureusement de quelque chose, gesticulant activement.  Une minute plus tard, ils ont commencé à se pousser les uns les autres, puis se sont agrippés et sont tombés d'un rocher dans (comme il s'est avéré) un buisson d'orties.  Apparemment, ce buisson a poussé là pour une raison - il a immédiatement pacifié les bagarreurs et a apporté une trêve à leur différend inextinguible.  Comme vous l'avez probablement deviné, j'étais l'un des débatteurs, l'autre était mon meilleur ami (bonjour, Quaker_t!), Mais le sujet de notre petit entretien était <strong>Visual Basic vs.</strong>  <strong>Delphi</strong> ! </p><br><p>  Vous reconnaissez-vous?  Parfois, nous transformons nos langages de programmation préférés en culte et sommes prêts à le défendre jusqu'au bout!  Mais les années passent et le moment vient où «A contre B» du sujet des conflits se transforme en «Je suis plus à l'aise de travailler avec A, mais si nécessaire, j'apprendrai à travailler avec B, C, D, E <em>et en général, avec n'importe quoi</em> ».  Ce n'est que lorsque nous rencontrons de nouveaux langages de programmation, que les vieilles habitudes et la culture peuvent ne pas nous laisser partir longtemps. </p><br><p>  Je voudrais vous présenter Python et aider à transférer votre expérience dans une nouvelle direction.  Comme toute technologie, elle a ses propres forces et faiblesses.  Python, comme C ++, Rust, Ruby, JS et tout le monde, est un outil.  Les instructions sont attachées à tout instrument et vous devez apprendre à utiliser <em>correctement</em> n'importe quel instrument. </p><br><p>  "Auteur, vous n'avez pas de cervelle, alliez-vous nous présenter Python?"  Faisons connaissance! </p><br><p>  Python est un langage de programmation polyvalent de haut niveau dynamique.  Python est un langage de programmation <strong>mature</strong> avec un écosystème et une tradition riches.  Bien que la langue soit sortie en 1991, son apparence moderne a commencé à prendre forme au début des années 2000.  Python est un langage <strong>chargé</strong> , dans sa bibliothèque standard, il existe des solutions pour de nombreuses occasions.  Python est un langage de programmation <strong>populaire</strong> : Dropbox, Reddit, Instagram, Disqus, YouTube, Netflix, bon sang, même Eve Online et bien d'autres utilisent activement Python. </p><br><p>  Quelle est la raison de cette popularité?  Avec votre permission, je présenterai ma propre version. </p><br><p>  Python est un <strong>langage de</strong> programmation <strong>simple</strong> .  Saisie dynamique.  Collecteur d'ordures.  Fonctions d'ordre supérieur.  Syntaxe simple pour travailler avec des dictionnaires, des ensembles, des tuples et des listes (y compris pour obtenir des tranches).  Python est idéal pour les débutants: il permet de commencer avec la programmation procédurale, de passer lentement en POO et d'avoir un avant-goût de la programmation fonctionnelle.  Mais cette simplicité est comme la pointe d'un iceberg.  Il vaut la peine de plonger dans les profondeurs lorsque vous rencontrez la philosophie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de Python</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Zen Of Python</a> .  Plongez encore plus loin - et vous vous retrouvez dans un ensemble de règles claires pour la conception de code - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Guide de style pour le code Python</a> .  Plongée sous-marine, le programmeur se penche progressivement sur le concept de "façon Python" ou "Pythonique".  À cette étape étonnante de l'apprentissage des langues, vous commencez à comprendre pourquoi les bons programmes Python sont écrits de cette façon et non autrement.  Pourquoi le langage a évolué dans ce sens, et non dans un autre.  Python n'a pas réussi en vitesse.  Mais il a réussi dans l'aspect le plus important de notre travail - la lisibilité.  "Écrivez du code pour les gens, pas pour les voitures" - c'est la base des bases de Python. </p><br><p>  Un bon code Python est magnifique.  Et pour écrire du beau code - qu'est-ce qui n'est pas une occupation agréable? </p><br><p>  <strong>Astuce 0:</strong> <em>Avant de continuer à lire, veuillez jeter un œil à un coin <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Zen Python</a> .</em>  <em>La langue est basée sur ces postulats et notre communication sera beaucoup plus agréable si vous les connaissez.</em> </p><br><h3 id="kakoy-umnik-dodumalsya-do-otstupov">  Quel homme intelligent est venu avec l'indentation? </h3><br><p>  Le premier choc pour ceux qui n'ont jamais vu le code en Python est l'indentation du corps des instructions: </p><br><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> ins = input(<span class="hljs-string"><span class="hljs-string">'Please say something'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> w <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> ins.split(<span class="hljs-string"><span class="hljs-string">' '</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> w == <span class="hljs-string"><span class="hljs-string">'hello'</span></span>: print(<span class="hljs-string"><span class="hljs-string">'world!'</span></span>)</code> </pre> <br><p>  Je me souviens des soirées dans l'auberge de la Polytechnique de Pétersbourg lorsque mon voisin, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">VlK</a> , les yeux brûlants, m'a dit qu'il avait déniché quelque chose de nouveau en Python.  "Corps d'indentation? Sérieusement?"  - a été ma réaction.  En effet, pour une personne qui est passée de Visual Basic ( <code>if ... end if</code> ) à C # (accolades) via C, C ++ et Java, cette approche semblait, pour le dire légèrement, étrange.  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Formatez</a> -vous le code avec une indentation?", <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">A</a> demandé <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">VlK</a> .  Bien sûr, je l'ai formaté.  Plus précisément, Spiral Studio Visual l'a fait pour moi.  Elle l'a bien fait.  Je n'ai jamais pensé au formatage et à l'indentation - ils sont apparus dans le code par eux-mêmes et semblaient être quelque chose d'ordinaire et familier.  Mais il n'y avait rien à cacher - le code était toujours formaté avec une indentation.  "Alors pourquoi avez-vous besoin d'appareils orthopédiques si le corps des instructions est de toute façon décalé vers la droite?" </p><br><p>  Cette nuit-là, je me suis assis avec Python.  Avec le recul, je peux dire avec certitude ce qui a exactement aidé à absorber rapidement de nouveaux matériaux.  C'était un éditeur de code.  Influencé par le même <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">VlK</a> , peu de temps avant les événements décrits ci-dessus, je suis passé de Windows à Ubuntu et Emacs en tant qu'éditeur (dans la cour de 2007, à PyCharm, Atom, VS Code et autres - bien d'autres années).  "Eh bien, maintenant Emacs va PR ..." - vous dites.  Juste un peu :) Traditionnellement, la <code>&lt;tab&gt;</code> dans Emacs n'ajoute pas d'onglets, mais sert à aligner la ligne selon les règles de ce mode.  Appuyez sur <code>&lt;tab&gt;</code> - et la ligne de code est déplacée vers la position appropriée suivante: </p><br><p><img src="https://habrastorage.org/webt/p_/8g/jm/p_8gjmuqid2ffw7ixile3wkjz74.gif"></p><br><p>  De cette façon, vous n'avez jamais à vous demander si vous avez correctement aligné le code. </p><br><p>  <strong>Astuce 1:</strong> <em>Lorsque vous vous familiarisez avec Python, utilisez un éditeur qui prend en charge l'indentation.</em> </p><br><p>  Savez-vous quel effet secondaire a toute cette honte?  Le programmeur essaie d'éviter les longues constructions.  Dès que la taille de la fonction dépasse les bordures verticales de l'écran, il devient plus difficile de distinguer à quelle conception appartient le bloc de code donné.  Et plus il y a d'investissements, plus c'est difficile.  En conséquence, vous essayez d'écrire de la manière la plus concise possible, en décomposant les longs corps de fonctions, boucles, transitions conditionnelles, etc. </p><br><h3 id="da-nu-vashu-dinamicheskuyu-tipizaciyu">  Eh bien ta frappe dynamique </h3><br><p>  O, cette discussion existe presque aussi longtemps que le concept de «programmation» existe!  La frappe dynamique n'est ni mauvaise ni bonne.  La frappe dynamique est également notre outil.  En Python, la frappe dynamique offre une grande liberté d'action.  Et là où il y a une plus grande liberté d'action - plus susceptible de se tirer une balle dans le pied. </p><br><p>  Il convient de préciser que la saisie en Python est <strong>stricte</strong> et l'ajout d'un nombre à une chaîne ne fonctionne pas: </p><br><pre> <code class="python hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-string"><span class="hljs-string">'1'</span></span> &gt;&gt;&gt; TypeError: unsupported operand type(s) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> +: <span class="hljs-string"><span class="hljs-string">'int'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-string"><span class="hljs-string">'str'</span></span></code> </pre> <br><p>  Python vérifie également la signature de la fonction lorsqu'elle est appelée et lèvera une exception si la signature d'appel n'est pas vraie: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + y sum(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>) &gt;&gt;&gt; TypeError: sum() takes <span class="hljs-number"><span class="hljs-number">2</span></span> positional arguments but <span class="hljs-number"><span class="hljs-number">3</span></span> were given</code> </pre> <br><p>  Mais lors du chargement d'un script, Python ne vous dira pas que la fonction attend un nombre et non une chaîne que vous lui passez.  Et vous ne l'apprenez qu'au moment de l'exécution: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sum</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + y sum(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-string"><span class="hljs-string">'10'</span></span>) &gt;&gt;&gt; TypeError: can only concatenate str (<span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-string"><span class="hljs-string">"int"</span></span>) to str</code> </pre> <br><p>  Plus le défi est difficile pour le programmeur, en <em>particulier lors de l'écriture de grands projets</em> .  Modern Python a répondu à ce défi avec un moteur d'annotation et une bibliothèque de types, et la communauté a développé des programmes qui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">effectuent une vérification de type statique</a> .  Par conséquent, le programmeur apprend de telles erreurs avant d'exécuter le programme: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># main.py: def sum(x: int, y: int) -&gt; int: return x + y sum(10, '10') $ mypy main.py tmp.py:5: error: Argument 2 to "sum" has incompatible type "str"; expected "int"</span></span></code> </pre> <br><p>  Python n'attache aucune importance aux annotations, bien qu'il les stocke dans l'attribut <code>__annotations__</code> .  La seule condition est que les annotations doivent être des valeurs valides en termes de langue.  Depuis leur apparition dans la version 3.0 (il y a plus de dix ans!), Ce sont les efforts de la communauté qui ont commencé à utiliser des annotations pour le marquage typé des variables et des arguments. </p><br><div class="spoiler">  <b class="spoiler_title">Un autre exemple, plus compliqué.</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      , :   :) from typing import TypeVar, Iterable Num = TypeVar('Num', int, float) def sum(items: Iterable[Num]) -&gt; Num: accum = 0 for item in items: accum += item return accum sum([1, 2, 3]) &gt;&gt;&gt; 6</span></span></code> </pre> </div></div><br><p>  <strong>Astuce 2:</strong> <em>En pratique, la plupart des saisies dynamiques posent des problèmes lors de la lecture et du débogage du code.</em>  <em>Surtout si ce code a été écrit sans annotations et que vous devez passer beaucoup de temps à déterminer les types de variables.</em>  <em>Vous n'avez pas à indiquer et à documenter les types de tout et de tout, mais le temps consacré à une description détaillée des interfaces publiques et des sections de code les plus critiques sera récompensé au centuple!</em> </p><br><h3 id="krya-utinaya-tipizaciya">  Charlatan!  Dactylographie de canard </h3><br><p>  Parfois, les passionnés de Python font semblant d'être mystérieux et parlent de "Duck typing". <br>  La frappe de canard est l'utilisation du test de canard dans la programmation: </p><br><blockquote>  Si un objet se casse comme un canard, vole comme un canard et marche comme un canard, alors il s'agit très probablement d'un canard. </blockquote><p>  Prenons un exemple: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RpgCharacter</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, weapon)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">self</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">weapon</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">weapon</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">battle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.weapon.attack()</code> </pre> <br><p>  Voici l'injection de dépendance classique.  La classe <code>RpgCharacter</code> reçoit l'objet <code>weapon</code> dans le constructeur et plus tard, dans la méthode <code>battle()</code> , appelle <code>weapon.attack()</code> .  Mais <code>RpgCharacter</code> ne dépend pas de la mise en œuvre spécifique de l' <code>weapon</code> .  Il peut s'agir d'une épée, d'un BFG 9000 ou d'une baleine avec un pot de fleurs, prête à atterrir sur la tête de l'ennemi à tout moment.  Il est important que l'objet ait une méthode <code>attack()</code> , Python n'est pas intéressé par tout le reste. </p><br><p></p><div style="text-align:center;"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img width="400" src="https://habrastorage.org/webt/l8/ld/yz/l8ldyzcgtvlj3ifvbpnswr2k7ws.png"></a> </div><p></p><br><p>  À proprement parler, la frappe de canard n'est pas unique.  Il est présent dans tous les langages dynamiques (qui me sont familiers) qui implémentent la POO. </p><br><p>  Ceci est un autre exemple de programmation minutieuse dans le monde de la frappe dynamique.  Méthode mal nommée?  Nommé de manière ambiguë une variable?  Votre collègue, ou vous-même, après environ six mois, sera ravi de ratisser un tel code :) </p><br><div class="spoiler">  <b class="spoiler_title">Que se passerait-il si nous utilisons Java conditionnel?</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IWeapon</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">attack</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sword</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IWeapon</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">attack</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//... } } public class RpgCharacter { IWeapon weapon; public RpgCharacter(IWeapon weapon) { this.weapon = weapon; } public void battle() { weapon.attack(); } }</span></span></code> </pre> <br><p>  Et il y aurait un typage statique classique, avec vérification du type au stade de la compilation.  Prix ​​- l'incapacité à utiliser un objet qui a une méthode <code>attack()</code> , mais qui <code>IWeapon</code> pas explicitement l'interface <code>IWeapon</code> . </p></div></div><br><p>  <strong>Astuce 3</strong> : <em>Si vous le souhaitez, vous pouvez décrire l'interface en créant votre propre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">classe abstraite avec des méthodes et des propriétés</a> .</em>  <em>Mieux encore, passez du temps à tester et à rédiger de la documentation pour vous et vos utilisateurs de code.</em> </p><br><h3 id="procedurnyy-podhod-i-__specialnye_metody__">  Approche procédurale et __ méthodes_ spéciales __ () </h3><br><p>  Python est un langage orienté objet et la classe d' <code>object</code> est à la racine de la hiérarchie d'héritage: </p><br><pre> <code class="python hljs">isinstance(<span class="hljs-string"><span class="hljs-string">'abc'</span></span>, object) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> isinstance(<span class="hljs-number"><span class="hljs-number">10</span></span>, object) &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br><p>  Mais lorsque <code>obj.ToString()</code> utilisé en Java et C #, <code>obj.ToString()</code> aura un appel à <code>str(obj)</code> en Python.  Ou par exemple, au lieu de <code>myList.length</code> , Python aura <code>len(my_list)</code> .  Le créateur de la langue, Guido van Rossum, a expliqué ceci comme suit: </p><br><blockquote>  Quand je lis le code qui dit <code>len(x)</code> , je sais que la longueur de quelque chose est demandée.  Cela me dit immédiatement que le résultat sera un entier et que l'argument est une sorte de conteneur.  Inversement, lors de la lecture de <code>x.len()</code> , j'ai besoin de savoir que <code>x</code> est une sorte de conteneur qui implémente une interface spécifique ou hérite d'une classe qui a la méthode <code>len()</code> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Source]</a> . </blockquote><p>  Néanmoins, à l'intérieur d'elle-même, les fonctions <code>len()</code> , <code>str()</code> et quelques autres appellent <strong>certaines</strong> méthodes de l'objet: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, name, last_name)</span></span></span><span class="hljs-function">:</span></span> self.name = name self.last_name = last_name <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__str__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">f"Honourable </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{self.name}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{self.last_name}</span></span></span><span class="hljs-string">"</span></span> u = User(<span class="hljs-string"><span class="hljs-string">'Alex'</span></span>, <span class="hljs-string"><span class="hljs-string">'Black'</span></span>) label = str(u) print(label) &gt;&gt;&gt; Honourable Alex Black</code> </pre> <br><p>  Des méthodes spéciales sont également utilisées par les opérateurs de langage, à la fois mathématiques et booléens, ainsi que <code>for ... in ...</code> opérateurs de boucle <code>for ... in ...</code> , <code>with</code> opérateur de contexte, l'opérateur d'index <code>[]</code> , etc. <br>  Par exemple, un protocole d'itérateur se compose de deux méthodes: <code>__iter__()</code> et <code>__next__()</code> : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  Iterable, IEnumerable, std::iterator  .. class InfinitePositiveIntegers: def __init__(self): self.counter = 0 def __iter__(self): """      .    iter(). """ return self def __next__(self): """  .    next(). """ self.counter += 1 return self.counter for i in InfinitePositiveIntegers(): print(i) &gt;&gt;&gt; 1 &gt;&gt;&gt; 2 &gt;&gt;&gt; ... #  ,  Ctrl + C</span></span></code> </pre> <br><p>  Eh bien, disons des méthodes spéciales.  Mais pourquoi ont-ils l'air si tordus?  Guido a expliqué cela par le fait qu'ils avaient les noms habituels sans le souligner, les programmeurs eux-mêmes ne les redéfiniraient pas au moins tôt ou tard.  C'est-à-dire  <code>____()</code> est une sorte de protection contre le fou.  Comme le temps l'a montré - la protection est efficace :) </p><br><p>  <strong>Astuce 4:</strong> <em>examinez de près les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fonctions intégrées</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">les méthodes d'objets spéciaux</a> .</em>  <em>Ils font partie intégrante de la langue, sans laquelle il est impossible de la parler pleinement.</em> </p><br><h3 id="gde-inkapsulyaciya-gde-moy-private-gde-moya-skazochka">  Où est l'encapsulation?  Où est mon privé?!  Où est mon conte de fées? !! </h3><br><p>  Python n'a pas de modificateurs d'accès pour les attributs de classe.  L'intérieur des objets est ouvert à l'accès sans aucune restriction.  Cependant, il existe une convention selon laquelle les attributs avec le préfixe <code>_</code> sont considérés comme privés, par exemple: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyFile</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#    _os_handle = None def __init__(self, path: str): self._open(path) #    def _open(self, path): # os.open() - **    . #      open(). #   os.open()    . self._os_handle = os.open(path, os.O_RDWR | os.O_CREAT) #      def close(self): if self._os_handle is not None: os.close(self._os_handle) f = MyFile('/tmp/file.txt') print(f._os_handle) #    ""    ! f.close()</span></span></code> </pre> <br><p>  Pourquoi? </p><br><blockquote>  Il n'y a rien de privé en Python.  Ni la classe ni son instance ne vous cacheront ce qu'il y a à l'intérieur (grâce à quoi l'introspection la plus profonde est possible).  Python vous fait confiance.  Il dit en quelque sorte: "Mon pote, si tu veux fouiller dans les coins sombres - pas de problème. Je crois qu'il y a de bonnes raisons à cela et j'espère que tu ne casseras rien. <br><br>  En fin de compte, nous sommes tous des adultes ici. <br><br>  - Karl Fast <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[Source]</a> . </blockquote><br><div class="spoiler">  <b class="spoiler_title">Mais comment éviter les collisions de noms lors de l'héritage?</b> <div class="spoiler_text"><p>  Python a un mécanisme spécial pour modifier le nom des attributs commençant par un double soulignement et ne se terminant pas par un double soulignement ( <code>__my_attr</code> )!  Ceci est fait pour éviter les collisions de noms pendant l'héritage.  Pour appeler les méthodes de classe en dehors du corps, Python ajoute l' <code>___</code> prefix <code>___</code> .  Mais pour l'accès interne, rien ne change: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.__x = <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_x</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.__x c = C() c.__x &gt;&gt;&gt; <span class="hljs-string"><span class="hljs-string">'C'</span></span> object has no attribute <span class="hljs-string"><span class="hljs-string">'__x'</span></span> print(c.get_x()) &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">10</span></span> print(c._C__x) &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br><p>  Regardons une application pratique.  Par exemple, à la classe <code>File</code> , qui lit les fichiers du système de fichiers local, nous voulons ajouter des capacités de mise en cache.  Notre collègue a réussi à écrire une classe mixin à ces fins.  Mais afin d'isoler les méthodes et les attributs <strong>des</strong> conflits <strong>potentiels</strong> , un collègue a ajouté le préfixe <code>__</code> à leurs noms: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseFile</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, path)</span></span></span><span class="hljs-function">:</span></span> self.path = path <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LocalMixin</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read_from_local</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(self.path) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> f.read() <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CachedMixin</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CacheMissError</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Exception)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Tepe,         #   __cache,   __from_cache(), # ,     ! self.__cache = {} def __from_cache(self): return self.__cache[self.path] def read_from_cache(self): try: return self.__from_cache() except KeyError as e: raise self.CacheMissError() from e def store_to_cache(self, data): self.__cache[self.path] = data class File(CachedMixin, LocalMixin, BaseFile): def __init__(self, path): CachedMixin.__init__(self) BaseFile.__init__(self, path) def read(self): try: return self.read_from_cache() except CachedMixin.CacheMissError: data = self.read_from_local() self.store_to_cache(data) return data</span></span></code> </pre> <br><p>  Si vous êtes intéressé à regarder l'implémentation de ce mécanisme dans CPython, veuillez dans <a href="">Python / compile.c</a> </p></div></div><br><p>  Enfin, en raison de la présence de propriétés dans le langage, cela n'a aucun sens d'écrire des getters et setters dans le style Java: <code>getX(), setX()</code> .  Par exemple, dans les <code>Coordinates</code> classe écrites à l'origine, </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Coordinates</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.x = x self.y = y c = Coordinates(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) print(cx, cy) &gt;&gt;&gt; (<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)</code> </pre> <br><p>  J'avais besoin de contrôler l'accès à l'attribut <code>x</code> .  L'approche correcte serait de le remplacer par un <code>property</code> , maintenant ainsi un contrat avec le monde extérieur. </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Coordinates</span></span></span><span class="hljs-class">:</span></span> _x = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, x, y)</span></span></span><span class="hljs-function">:</span></span> self.x = x self.y = y @property <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._x @x.setter <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, val)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> val &gt; <span class="hljs-number"><span class="hljs-number">10</span></span>: self._x = val <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> ValueError(<span class="hljs-string"><span class="hljs-string">'x should be greater than 10'</span></span>) c = Coordinates(<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) cx = <span class="hljs-number"><span class="hljs-number">5</span></span> &gt;&gt;&gt; ValueError: x should be greater than <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br><p>  <strong>Astuce 5:</strong> <em>Comme dans Python, le concept de champs privés et de méthodes de classe est basé sur une convention établie.</em>  <em>Ne soyez pas offensé par les auteurs des bibliothèques si "tout a cessé de fonctionner" parce que vous avez utilisé activement les champs privés de leurs classes.</em>  <em>En fin de compte, nous sommes tous des adultes ici :)</em> . </p><br><h3 id="nemnogo-ob-isklyucheniyah">  Un peu sur les exceptions </h3><br><p>  La culture Python a une approche unique des exceptions.  En plus de l'interception et du traitement habituels à la C ++ / Java, vous rencontrerez l'utilisation d'exceptions dans le contexte </p><br><blockquote>  "Plus facile de demander pardon, que la permission - EAFP." </blockquote><p>  Pour paraphraser - n'écrivez pas trop <code>if</code> , dans la plupart des cas, l'exécution se fera sur cette branche.  Au lieu de cela, <code>try..except</code> la logique dans <code>try..except</code> . </p><br><p>  Exemple: imaginez un gestionnaire de requêtes POST qui crée un utilisateur dans une base de données conditionnelle.  A l'entrée de la fonction se trouve un dictionnaire de type valeur-clé: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_user_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data: Dict[str, str])</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: database.user.persist( username=data[<span class="hljs-string"><span class="hljs-string">'username'</span></span>], password=data[<span class="hljs-string"><span class="hljs-string">'password'</span></span>] ) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> KeyError: print(<span class="hljs-string"><span class="hljs-string">'There was a missing field in data passed for user creation'</span></span>)</code> </pre> <br><p>  Nous n'avons pas pollué le code avec des vérifications "si le <code>username</code> ou le <code>password</code> est contenu dans les <code>data</code> ".  Nous espérons qu'ils seront probablement là.  Nous ne demandons pas de «permission» pour utiliser ces champs, mais nous nous «excusons» lorsque le prochain kulhacker publiera un formulaire avec des données manquantes. </p><br><div class="spoiler">  <b class="spoiler_title">Ne l'amenez pas au point d'absurdité!</b> <div class="spoiler_text"><p>  Par exemple, vous souhaitez vérifier si le nom de famille de l'utilisateur est présent dans les données et sinon le définir sur une valeur vide.  <code>if</code> ici serait beaucoup plus approprié: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_user_handler</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-string"><span class="hljs-string">'last_name'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> data: data[<span class="hljs-string"><span class="hljs-string">'last_name'</span></span>] = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: database.user.persist( username=data[<span class="hljs-string"><span class="hljs-string">'username'</span></span>], password=data[<span class="hljs-string"><span class="hljs-string">'password'</span></span>], last_name=data[<span class="hljs-string"><span class="hljs-string">'last_name'</span></span>] ) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> KeyError: print(<span class="hljs-string"><span class="hljs-string">'There was a missing field in data passed for user creation'</span></span>)</code> </pre> </div></div><br><p>  <strong>Les erreurs ne doivent jamais passer silencieusement.</strong>  - n'ignorez pas les exceptions!  Modern Python a une merveilleuse <code>raise from</code> construction qui vous permet de maintenir le contexte de la chaîne d'exceptions.  Par exemple: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyProductError</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Exception)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> super().__init__(<span class="hljs-string"><span class="hljs-string">'There has been a terrible product error'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> / x <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> ZeroDivisionError <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> MyProductError() <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> e</code> </pre> <br><p>  Sans <code>raise from e</code> chaîne d'exceptions se casse sur <code>MyProductError</code> , et nous ne pouvons pas savoir quelle était exactement la cause de cette erreur.  Avec la <code>raise from X</code> , la raison (c'est-à-dire <code>X</code> ) de l'exception levée est stockée dans l'attribut <code>__cause__</code> : </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: calculate(<span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> MyProductError <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> e: print(e.__cause__) &gt;&gt;&gt; division by zero</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Mais il y a une petite nuance dans le cas de l'itération: StopIteration</b> <div class="spoiler_text"><p>  Dans le cas d'une itération, le lancement d'une exception <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">StopIteration</a> est le moyen officiel de signaler que l'itérateur est terminé. </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PositiveIntegers</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, limit)</span></span></span><span class="hljs-function">:</span></span> self.counter = <span class="hljs-number"><span class="hljs-number">0</span></span> self.limit = limit <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__iter__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__next__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.counter += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.counter == self.limit: <span class="hljs-comment"><span class="hljs-comment">#  hasNext()  moveNext(), #  ,   raise StopIteration() return self.counter for i in PositiveIntegers(5): print(i) &gt; 1 &gt; 2 &gt; 3 &gt; 4</span></span></code> </pre> </div></div><br><p>  <strong>Astuce 6:</strong> <em>Nous ne payons la gestion des exceptions que dans des situations exceptionnelles.</em>  <em>Ne les négligez pas!</em> </p><br><h3 id="there-should-be-one---and-preferably-only-one---obvious-way-to-do-it">  Il devrait y avoir une - et de préférence une seule - la manière précédente de le faire. </h3><br><p>  <code>switch</code> ou correspondance de motifs?  - utilisez <code>if</code> et dictionnaires.  <code>do-</code> ?  - pour cela il y a un <code>while</code> et <code>for</code> .  <code>goto</code> ?  Je pense que vous avez deviné.  Il en va de même pour certaines techniques et modèles de conception qui semblent être considérés comme acquis dans d'autres langues.  La chose la plus étonnante est qu'il n'y a pas de restrictions techniques sur leur mise en œuvre, c'est juste "nous n'avons pas cette façon". </p><br><p>  Par exemple, en Python, vous ne voyez pas souvent le modèle "Builder".  Au lieu de cela, il utilise la possibilité de passer et de demander explicitement des arguments de nom à la fonction.  Au lieu de cela </p><br><pre> <code class="python hljs">human = HumanBuilder.withName(<span class="hljs-string"><span class="hljs-string">"Alex"</span></span>).withLastName(<span class="hljs-string"><span class="hljs-string">"Black"</span></span>).ofAge(<span class="hljs-number"><span class="hljs-number">20</span></span>).withHobbies([<span class="hljs-string"><span class="hljs-string">'tennis'</span></span>, <span class="hljs-string"><span class="hljs-string">'programming'</span></span>]).build()</code> </pre> <br><p>  sera </p><br><pre> <code class="python hljs">human = Human( name=<span class="hljs-string"><span class="hljs-string">"Alex"</span></span> last_name=<span class="hljs-string"><span class="hljs-string">"Black"</span></span> age=<span class="hljs-number"><span class="hljs-number">20</span></span> hobbies=[<span class="hljs-string"><span class="hljs-string">'tennis'</span></span>, <span class="hljs-string"><span class="hljs-string">'programming'</span></span>] )</code> </pre> <br><p>  La bibliothèque standard n'utilise pas de chaînes de méthodes pour travailler avec des <em>collections</em> .  Je me souviens comment un collègue venu du monde de Kotlin m'a montré le code du sens suivant (extrait de la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation officielle</a> de Kotlin): </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> shortGreetings = people .filter { it.name.length &lt; <span class="hljs-number"><span class="hljs-number">10</span></span> } .map { <span class="hljs-string"><span class="hljs-string">"Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${it.name}</span></span></span><span class="hljs-string">!"</span></span> }</code> </pre> <br><p>  En Python, <code>map()</code> , <code>filter()</code> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bien d'autres,</a> sont des fonctions et non des méthodes de collecte.  En réécrivant ce code un par un, on obtient: </p><br><pre> <code class="python hljs">short_greetings = map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> h: <span class="hljs-string"><span class="hljs-string">f"Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{h.name}</span></span></span><span class="hljs-string">"</span></span>, filter(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> h: len(h.name) &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>, people))</code> </pre> <br><p>  À mon avis, cela a l'air horrible.  Par conséquent, pour les paquets longs comme <code>.takewhile().filter().map().reduce()</code> il est préférable d'utiliser ce que l'on appelle  <em>inclusion</em> (compréhension), ou bons vieux cycles.  Soit dit en passant, le même exemple sur Kotlin est donné sous la forme de la liste de compréhension correspondante.  Et sur Python, cela ressemble à ceci: </p><br><pre> <code class="python hljs">short_greetings = [ <span class="hljs-string"><span class="hljs-string">f"Hello </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{h.name}</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> h <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> people <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(h.name) &lt; <span class="hljs-number"><span class="hljs-number">10</span></span> ]</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Pour ceux qui manquent les chaînes</b> <div class="spoiler_text"><p>  Il existe des bibliothèques comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pipe</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">py_linq</a> ! </p></div></div><br><p>  Les chaînes de méthodes sont utilisées lorsqu'elles sont plus efficaces que les outils standard.  Par exemple, dans le framework Web Django, les chaînes sont utilisées pour créer un objet de requête de base de données: </p><br><pre> <code class="python hljs">query = User.objects \ .filter(last_visited__gte=<span class="hljs-string"><span class="hljs-string">'2019-05-01'</span></span>) \ .order_by(<span class="hljs-string"><span class="hljs-string">'username'</span></span>) \ .values(<span class="hljs-string"><span class="hljs-string">'username'</span></span>, <span class="hljs-string"><span class="hljs-string">'last_visited'</span></span>) \ [:<span class="hljs-number"><span class="hljs-number">5</span></span>]</code> </pre> <br><p>  <strong>Astuce 7:</strong> <em>Avant de faire quelque chose de très familier de l'expérience passée, mais pas familier en Python, demandez-vous quelle décision un pythoniste expérimenté prendrait-il?</em> </p><br><h3 id="piton-medlennyy">  Python lent </h3><br><p>  Oui </p><br><p>  Oui, en ce qui concerne la vitesse d'exécution par rapport aux langages typés et compilés statiquement. </p><br><p>  Mais semblez-vous vouloir une réponse détaillée? </p><br><p>  L'implémentation de référence Python (CPython) est loin d'être son implémentation la plus efficace.  L'une des raisons importantes est le désir des développeurs de ne pas le compliquer.  Et la logique est compréhensible - un code pas trop abstrus signifie moins d'erreurs, une meilleure opportunité d'apporter des modifications, et au final, plus de personnes qui veulent lire, comprendre et compléter ce code. </p><br><p>  Jake VanderPlas dans son blog analyse <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ce qui se passe dans CPython sous le capot</a> lors de l'ajout de deux variables contenant des valeurs entières: </p><br><pre> <code class="python hljs">a = <span class="hljs-number"><span class="hljs-number">1</span></span> b = <span class="hljs-number"><span class="hljs-number">2</span></span> c = a + b</code> </pre> <br><p>  Même si nous n'allons pas profondément dans la jungle de CPython, nous pouvons dire que pour stocker les variables <code>a</code> , <code>b</code> et <code>c</code> , l'interpréteur devra créer trois objets sur le tas, dans lesquels le type et les (pointeurs vers) les valeurs seront stockés;  <code>binary_add&lt;int, int&gt;(a-&gt;val, b-&gt;val)</code> à <code>binary_add&lt;int, int&gt;(a-&gt;val, b-&gt;val)</code> le type et les valeurs pendant l'opération d'addition pour appeler quelque chose comme <code>binary_add&lt;int, int&gt;(a-&gt;val, b-&gt;val)</code> ;  écrire le résultat dans <code>c</code> . <br>  C'est terriblement inefficace par rapport à un programme C similaire. </p><br><p>  Un autre problème avec CPython est le soi-disant  Verrou d'interprète global (GIL).  Ce mécanisme, essentiellement une valeur booléenne entourée d'un mutex, est utilisé pour synchroniser l'exécution du bytecode.  GIL simplifie le développement de code s'exécutant dans un environnement multi-thread: CPython n'a pas besoin de penser à synchroniser l'accès aux variables ou aux blocages.  Vous devez payer pour cela car un seul thread a accès et <em>exécute le bytecode</em> à un moment donné: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rw/od/if/rwodifh_niof7jaf5bvmagg4ypy.gif"></div><br><p>  <strong>UPD:</strong> Mais cela ne signifie pas que le programme sur Python fonctionnera comme par magie dans un environnement multi-thread!  Le code sur Python n'est pas transféré au bytecode un par un et il n'y a aucune garantie quant à la compatibilité du bytecode entre les versions!  Par conséquent, vous devez toujours synchroniser les threads dans le code.  Heureusement, ici Python dispose d'un riche ensemble d'outils, par exemple, vous permettant de basculer entre un modèle d'exécution multi-thread et multi-processus. </p><br><div class="spoiler">  <b class="spoiler_title">Si vous êtes curieux de savoir quels efforts sont déployés pour éliminer le GIL</b> <div class="spoiler_text"><p>    Anthony Shaw " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Has the Python GIL been slain?</a> ". </p></div></div><br><p>    ? </p><br><ol><li>      .    ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CFFI</a> )              .           API    (extensions)  C/C++.    ,      Rust, Go   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kotlin Native</a> ! </li><li>    , : <br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PyPy</a> ,   JIT-.    ,     ,          ? </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Cython</a> —      Python    C. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">IronPython</a> — ,   .NET framework. </li></ul></li></ol><br><p> <strong> 8:</strong> <em>     ,              .      ,   IO (, ,  )   ,    ,      ,    ,     :)</em> </p><br><h3 id="osnovnye-instrumenty">   </h3><br><p>      ?      Linux  MacOS,   95%      .      ,      3.,       2.7.    Windows   .   :  Docker, Windows Subsystem for Linux, Cygwin, ,     . </p><br><p> <strong> 9:</strong> <em>     .  ,   —       -   .</em> </p><br><p>    "Hello world"   ?  Super!      machine learning-    -    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Python Package Index</a> (PyPI). </p><br><p>        (packages),    ..   (virtual environments).        ,      .     -    .   <code>pip</code>    .     <code>pip</code>      .      ,  <code>pipenv</code>  <code>poetry</code> —  npm, bundler, cargo  .. </p><br><p> <strong> 0xA:</strong> <em>      —  <code>pip</code>  <code>virtualenv</code> .   —  , ,  .  ,      —   <code>sys.path</code> —  ,        .</em> </p><br><h3 id="chto-zhe-dalshe">   ? </h3><br><p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> </a> ?       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   </a> .     : </p><br><blockquote>      Dive into python... </blockquote><p> ,               .              , ,     :) </p><br><p> , ! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr450724/">https://habr.com/ru/post/fr450724/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr450710/index.html">Reconstruction du Midi à partir de vidéos Synthesia (et similaires)</a></li>
<li><a href="../fr450712/index.html">DotNetRu au DotNext 2019 Piter</a></li>
<li><a href="../fr450716/index.html">Annonce des compétences Windows Vision (préversion)</a></li>
<li><a href="../fr450718/index.html">Nouveautés de RxJS v6.5</a></li>
<li><a href="../fr450720/index.html">Comment développer une application conviviale</a></li>
<li><a href="../fr450726/index.html">Création d'un outil pour écrire rapidement et efficacement des autotests sur Selenium</a></li>
<li><a href="../fr450728/index.html">NLog: règles et filtres</a></li>
<li><a href="../fr450730/index.html">ok.tech: rencontre frontend</a></li>
<li><a href="../fr450732/index.html">Je vois, cela signifie que j'existe: une revue du Deep Learning in Computer Vision (partie 1)</a></li>
<li><a href="../fr450734/index.html">Le fuzzing est une étape importante dans un développement sûr</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>