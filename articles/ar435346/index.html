<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โ๏ธ ๐ก ๐ฆ ุงุดุชุฑู ูู Kafka ุนุจุฑ HTTP ุฃู ููููุฉ ุชุจุณูุท ุฑูุงุจุท ุงูููุจ ุงูุฎุงุตุฉ ุจู ๐ฉ๐ฟโ๐คโ๐ฉ๐ผ ๐ฌ ๐คถ๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุงู ุงูุนุฏูุฏ ูู ุงูุทุฑู ููุนุงูุฌุฉ ุงูุฑุณุงุฆู ูู ุฃูุธูุฉ Pub-Sub: ุงุณุชุฎุฏุงู ุฎุฏูุฉ ูููุตูุฉ ุ ุนุฒู ุนูููุฉ ูุนุฒููุฉ ุ ุชูุธูู ุชุฌูุน ูุนุงูุฌุฉ / ุณูุณูุฉ ุฑุณุงุฆู ุ IPC ูุนูุฏ ุ Poll-over...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงุดุชุฑู ูู Kafka ุนุจุฑ HTTP ุฃู ููููุฉ ุชุจุณูุท ุฑูุงุจุท ุงูููุจ ุงูุฎุงุตุฉ ุจู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/435346/" style=";text-align:right;direction:rtl">  ููุงู ุงูุนุฏูุฏ ูู ุงูุทุฑู ููุนุงูุฌุฉ ุงูุฑุณุงุฆู ูู ุฃูุธูุฉ Pub-Sub: ุงุณุชุฎุฏุงู ุฎุฏูุฉ ูููุตูุฉ ุ ุนุฒู ุนูููุฉ ูุนุฒููุฉ ุ ุชูุธูู ุชุฌูุน ูุนุงูุฌุฉ / ุณูุณูุฉ ุฑุณุงุฆู ุ IPC ูุนูุฏ ุ Poll-over-Http ูุงูุนุฏูุฏ ูู ุงูุฎุฏูุงุช ุงูุฃุฎุฑู.  ุงูููู ุฃุฑูุฏ ุฃู ุฃุชุญุฏุซ ุนู ููููุฉ ุงุณุชุฎุฏุงู Pub-Sub ุนุจุฑ HTTP ูุญูู ุฎุฏูุชู ุงูููุชูุจุฉ ุฎุตูุตูุง ููุฐุง ุงูุบุฑุถ. <br><br>  ูุนุฏ ุงุณุชุฎุฏุงู ุงููุงุฌูุฉ ุงูุฎูููุฉ ูุฎุฏูุฉ HTTP ุงูุฌุงูุฒุฉ ูู ุจุนุถ ุงูุญุงูุงุช ุญูุงู ูุซุงูููุง ููุนุงูุฌุฉ ูุงุฆูุฉ ุงูุชุธุงุฑ ุงูุฑุณุงุฆู: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุญููู ุงูุชูุงุฒู ูู ุฎุงุฑุฌ ููุทูุฉ ุงูุฌุฒุงุก.  ุนุงุฏุฉู ูุง ุชููู ุงููุงุฌูุฉ ุงูุฎูููุฉ ุจุงููุนู ูุฑุงุก ุงูููุงุฒู ููุฏููุง ุจููุฉ ุชุญุชูุฉ ุฌุงูุฒุฉ ููุชุญููู ุ ููุง ูุจุณุท ุงูุนูู ูุน ุงูุฑุณุงุฆู ุจุดูู ูุจูุฑ. </li><li style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู ูุญุฏุฉ ุชุญูู REST ุงูุนุงุฏูุฉ (ุฃู ููุฑุฏ HTTP).  ูููู ุงุณุชููุงู ุฑุณุงุฆู HTTP ูู ุชูููุฉ ุชูููุฐ ุจุฑุงูุฌ compumers ููุบุงุช ูุฎุชููุฉ ุฅุฐุง ูุงูุช ุงูุฎูููุฉ ูุฎุชูุทุฉ. </li><li style=";text-align:right;direction:rtl">  ุชุจุณูุท ุงุณุชุฎุฏุงู ุฎุทุงูุงุช ุงูููุจ ููุฎุฏูุงุช ุงูุฃุฎุฑู.  ุงูุขู ุชูุฑูุจูุง ูู ุฎุฏูุฉ (Jira ู Gitlab ู Mattermost ู Slack ...) ุชุฏุนู ุจุทุฑููุฉ ุฃู ุจุฃุฎุฑู ุฑูุงุจุท ุงูููุจ ููุชูุงุนู ูุน ุงูุนุงูู ุงูุฎุงุฑุฌู.  ููููู ุฌุนู ุงูุญูุงุฉ ุฃุณูู ุฅุฐุง ุนููุช ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุฃุฏุงุก ูุธุงุฆู ูุฑุณู HTTP. </li></ol><br>  ูุฐุง ุงูููุฌ ูู ุฃูุถุง ุนููุจ: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููููู ูุณูุงู ุฎูุฉ ุงูุญู.  HTTP ุจุฑูุชูููู ูุจูุฑ ุ ูุงุณุชุฎุฏุงู ุงูุฃุทุฑ ุนูู ุฌุงูุจ ุงููุณุชููู ุณูุฒูุฏ ุนูู ุงูููุฑ ูู ุงููููู ูุงูุชุญููู. </li><li style=";text-align:right;direction:rtl">  ูููุฏ ููุงุท ุงูููุฉ ูู ููุฌ ุงูุงุณุชุทูุงุน ุ ููุญุตู ุนูู ููุงุท ุงูุถุนู ูู Push. </li><li style=";text-align:right;direction:rtl">  ูููู ุฃู ุชุคุซุฑ ูุนุงูุฌุฉ ุงูุฑุณุงุฆู ุจูุงุณุทุฉ ูุซููุงุช ุงูุฎุฏูุฉ ููุณูุง ุงูุชู ุชุนุงูุฌ ุงูุนููุงุก ุนูู ุงูุงุณุชุฌุงุจุฉ.  ูุฐู ููุณุช ูููุฉ ุ ุญูุซ ูุชู ุงูุชุนุงูู ูุนูุง ุจุงูุชูุงุฒู ูุงูุนุฒูุฉ. </li></ol><br>  ููุฏ ุทุจูุช ุงูููุฑุฉ ูุฎุฏูุฉ ูุงุฆูุฉ ุงูุชุธุงุฑ ุนูู ุจุฑูุชูููู ุงูุชูุงู ุงููุต ุงููุชุดุนุจ ุ ูุงูุชู ุณูุชู ููุงูุดุชูุง ูุงุญููุง.  ุชูุช ูุชุงุจุฉ ุงููุดุฑูุน ูู Kotlin ุจุงุณุชุฎุฏุงู Spring Boot 2.1.  ููุณูุท ุ ูุชููุฑ Apache Kafka ููุท ุญุงูููุง. <br><a name="habracut"></a><br>  <i>ุนูุงูุฉ ุนูู ุฐูู ุ ูู ุงูููุชุฑุถ ุฃู ูููู ุงููุงุฑุฆ ูุนุชุงุฏูุง ุนูู ูุงููุง ููุนุฑู ุงูุฅูุชุฒุงูุงุช (ุงูุงูุชุฒุงู) ูุงูุฅุฒุงุญุฉ (ุงูุฅุฒุงุญุฉ) ููุฑุณุงุฆู ููุจุงุฏุฆ ุงููุฌููุนุงุช (ุงููุฌููุนุฉ) ูุงููุณุชููููู (ุงููุณุชููู) ุ ููููู ุฃูุถูุง ูุฏู ุงุฎุชูุงู ุงูุชูุณูู (ุงููุณู) ุนู ุงูููุถูุน (ุงูููุถูุน) .</i>  <i>ุฅุฐุง ูุงูุช ููุงู ูุฌูุงุช ุ ูุฅููู ุฃูุตุญู ุจูุฑุงุกุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง</a> ุงููุณู ูู ูุซุงุฆู ูุงููุง ูุจู ุงููุชุงุจุนุฉ.</i> <br><br><h1 style=";text-align:right;direction:rtl">  ุงููุญุชููุงุช </h1><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุงุฌุนุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฑุชูุจ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฎุทุฃ ูู ุงูุชุนุงูู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฑุณุงุฆู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃุฏุงุก</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุธุงูุฑุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฎุงุชูุฉ</a> </li></ul><br><a name="overview"></a><h1 style=";text-align:right;direction:rtl">  ูุฑุงุฌุนุฉ </h1><br>  Queue-Over-Http ูู ุฎุฏูุฉ ุชุนูู ููุณูุท ุจูู ูุณูุท ุงูุฑุณุงุฆู ููุณุชููู HTTP ุงูููุงุฆู (ุงูุฎุฏูุฉ ุชุฌุนู ูู ุงูุณูู ุชูููุฐ ุงูุฏุนู ูุฅุฑุณุงู ุงูุฑุณุงุฆู ุฅูู ุงููุณุชููููู ุจุฃู ุทุฑููุฉ ุฃุฎุฑู ุ ุนูู ุณุจูู ุงููุซุงู ุ * RPC).  ูู ุงูููุช ุงูุญุงูู ุ ูุง ูุชููุฑ ุณูู ุงูุงุดุชุฑุงู ูุฅูุบุงุก ุงูุงุดุชุฑุงู ูุนุฑุถ ูุงุฆูุฉ ุงููุณุชููููู ุ ููู ูุชู ุจุนุฏ ุฅุฑุณุงู ุงูุฑุณุงุฆู ุฅูู ุงููุณูุท (ุฅูุชุงุฌ) ุนุจุฑ HTTP ุจุณุจุจ ุนุฏู ุงููุฏุฑุฉ ุนูู ุถูุงู ุชุฑุชูุจ ุงูุฑุณุงุฆู ุฏูู ุฏุนู ุฎุงุต ูู ุงูููุชุฌ. <br><br>  ุงูุฑูู ุงูุฑุฆูุณู ููุฎุฏูุฉ ูู ุงููุณุชููู ุ ุงูุฐู ููููู ุงูุงุดุชุฑุงู ูู ุฃูุณุงู ูุญุฏุฏุฉ ุฃู ููุท ูู ุงูููุถูุนุงุช (ูุชู ุฏุนู ููุท ุงูููุถูุน).  ูู ุงูุญุงูุฉ ุงูุฃููู ุ ูุชู ุฅููุงู ุชุดุบูู ุงูุชูุงุฒู ุงูุชููุงุฆู ููุฃูุณุงู.  ุจุนุฏ ุงูุงุดุชุฑุงู ุ ูุจุฏุฃ ููุฑุฏ HTTP ุงููุญุฏุฏ ูู ุชููู ุงูุฑุณุงุฆู ูู ุฃูุณุงู ูุงููุง ุงููุนููุฉ.  ูุนูุงุฑูุง ุ ูุฑุชุจุท ูู ูุดุชุฑู ุจุนููู Kafka Java ุงูุฃุตูู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุตุฉ ูุณููุฉ ุนู KafkaConsumer</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุฏู ูุงููุง ุนููู ุฌุงูุง ุฑุงุฆุน ููููู ุงูููุงู ุจุงููุซูุฑ.  ูููููู ุงุณุชุฎุฏุงูู ูู ูุญูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุชููู ุงูุฑุณุงุฆู ูู ุงููุณูุท ุซู ุฅุฑุณุงูู ุฅูู ููุงุฆู ุงูุชุธุงุฑ ุงูุฎุฏูุฉ ุงููุญููุฉ.  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุงูุนููู ูุนูู ุจุดูู ุญุตุฑู ูู ุณูุงู ููุถูุน ูุงุญุฏ. <br><br>  ููุฑุฉ ุงููุญูู ุจุณูุทุฉ.  ูุจุฏุฃ ูู ููุถูุน ูุงุญุฏ ุ ููุชุจ ุฃุจุณุท ุฌุฏููุฉ ุงูุนููุงุก ุงูุฃุตูููู ุ ูุน ุงูุชุฑููุฒ ุนูู ุชูููู ุฒูู ุงููุตูู.  ููุฐุง ูู ุ ููุชุจ ุดูุฆุง ูุดุงุจูุง: <br><br><pre style=";text-align:right;direction:rtl"><code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!Thread.interrupted()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hasWork = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (consumer <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> kafkaConsumers) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> queueGroup = consumers[consumer] ?: <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span> invalidateSubscription(consumer, queueGroup) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> records = consumer.poll(Duration.ZERO) <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!records.isEmpty) { hasWork = <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> committed = doCommit() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!hasWork &amp;&amp; committed == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// ,    Thread.sleep(1) } }</span></span></code> </pre> <br>  ูุจุฏู ุฃู ูู ุดูุก ุฑุงุฆุน ุ ุงููููู ูู ุงูุญุฏ ุงูุฃุฏูู ุญุชู ูุน ุนุดุฑุงุช ุงููุณุชููููู.  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ุงุชุถุญ ุฃู <code>KafkaConsumer</code> ููุฐุง ุงููุถุน ูู ุงูุชุดุบูู ููุนุทู ูุนุฏู ุชุฎุตูุต ูุจูุบ ุญูุงูู 1.5 ููุฌุงุจุงูุช / ุซุงููุฉ ูู ููุช ุงูุฎููู.  ูุน 100 ูุงูู ุ ูุตู ูุนุฏู ุงูุชุฎุตูุต ุฅูู 150 ููุฌุงุจุงูุช / ุซุงููุฉ ููุฌุนู GC ุชููุฑ ูุซูุฑูุง ูู ุงูุชุทุจูู.  ุจุงูุทุจุน ุ ูู ูุฐู ุงูููุงูุฉ ููุฌูุฏุฉ ูู ุงูููุทูุฉ ุงูุตุบูุฑุฉ ุ GC ูุงุฏุฑุฉ ุนูู ุงูุชุนุงูู ูุน ูุฐุง ุ ููู ุงูุญู ููุณ ูุซุงูููุง. <br><br>  ูู ุงููุงุถุญ ุฃูู ุจุญุงุฌุฉ ุฅูู ุงููุถู ูุฏูุงู ุจุงูุทุฑููุฉ ุงููุนุชุงุฏุฉ ูู <code>KafkaConsumer</code> ุ ูุงูุขู ุฃุถุน ูู ูุดุชุฑู ูู ุณุงุญุฉ ุงููุดุงุฑูุงุช ุงูุฎุงุตุฉ ุจู.  ูุฐุง ูุนุทู ููุฏุงุฑ ุญูู ููุฐุงูุฑุฉ ูุงูุฌุฏููุฉ ุ ูููู ูุง ุชูุฌุฏ ุทุฑููุฉ ุฃุฎุฑู. <br><br>  ุฃุนุฏ ูุชุงุจุฉ ุงูุฑูุฒ ูู ุฃุนูู ุ ูุฃุฒู ุงูุญููุฉ ุงูุฏุงุฎููุฉ ูุชุบููุฑ <code>Duration.ZERO</code> ุฅูู <code>Duration.ofMillis(100)</code> .  ุงุชุถุญ ุจุดูู ุฌูุฏ ุ ููุฎูุถ โโูุนุฏู ุงูุชุฎุตูุต ุฅูู 80-150 ูููู ุจุงูุช ูู ุงูุซุงููุฉ ููู ูุณุชููู.  ููุน ุฐูู ุ ูุคุฎุฑ Poll ุฐู ูููุฉ ูุฏุฑูุง 100 ูููู ุซุงููุฉ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุจุฃููููุง ูู ุงูุงูุชุฒุงูุงุช ุฅูู ููุณ 100 ูููู ุซุงููุฉ ุ ููุฐุง ุบูุฑ ููุจูู ูุซูุฑูุง. <br><br>  ูู ุนูููุฉ ุฅูุฌุงุฏ ุญููู ูููุดููุฉ ุ ุฃุชุฐูุฑ <code>KafkaConsumer::wakeup</code> ุ ุงูุชู ุชููู <code>WakeupException</code> ุฃู ุนูููุฉ ุญุธุฑ ุนูู ุงููุณุชููู.  ูู ุฎูุงู ูุฐู ุงูุทุฑููุฉ ุ ูููู ุงูุทุฑูู ุฅูู ุฒูู ุงูุงูุชูุงู ุงูุจุณูุท ุจุณูุทูุง: ุนูุฏูุง ูุตู ุทูุจ ุฌุฏูุฏ ููุงูุชุฒุงู ุ ูุถุนู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุ ูุนูู ุงููุณุชููู ุงูุฃุตูู ูุณููู <code>wakeup</code> .  ูู ุฏูุฑุฉ ุงูุนูู ุ <code>WakeupException</code> ุฅูู ุงุฑุชูุงุจ ูุง ุชุฑุงูู.  ูููู ุงูุณูุทุฑุฉ ุจูุณุงุนุฏุฉ ุงูุงุณุชุซูุงุกุงุช ุ ูุฌุจ ุนููู ุฃู ุชุถุนูุง ุจูู ูุฏูู ููุฑูุง ุ ูููู ูุธุฑูุง ูุนุฏู ูุฌูุฏ ุฃู ุดูุก ุขุฎุฑ ... <br><br>  ุงุชุถุญ ุฃู ูุฐุง ุงูุฎูุงุฑ ุจุนูุฏ ุนู ุฃู ูููู ูุซุงููุงู ุ ูุฃู ุฃู ุนูููุฉ ุนูู ุงููุณุชููู ุงูุฃุตูู <code>WakeupException</code> ุงูุขู <code>WakeupException</code> ุ ุจูุง ูู ุฐูู ุงูุงูุชุฒุงู ููุณู.  ุณุชุคุฏู ูุนุงูุฌุฉ ูุฐุง ุงููููู ุฅูู ุชุดููุด ุงูุฑูุฒ ุจุนูุงูุฉ ุชุณูุญ <code>wakeup</code> . <br><br>  ููุฏ ุชูุตูุช ุฅูู ุงุณุชูุชุงุฌ ููุงุฏู ุฃูู ุณูููู ูู ุงูุฌูุฏ ุชุนุฏูู ุทุฑููุฉ <code>KafkaConsumer::poll</code> ุจุญูุซ ูููู ููุงุทุนุชูุง ุจุดูู ุทุจูุนู ุ ููููุง <code>KafkaConsumer::poll</code> ุฅุถุงููุฉ.  ูุชูุฌุฉู ูุฐูู ุ ูููุฏ <a href="https://github.com/viirtus/queue-over-">ูุฑุงููุดุชุงูู</a> ูู ุงูุงูุนูุงุณ ุ ุงูุฐู ููุณุฎ ุจุงูุถุจุท ุทุฑููุฉ ุงูุงุณุชุทูุงุน ุงูุฃุตููุฉ ุ ูุถูููุง ุฎุฑูุฌูุง ูู ุงูุญููุฉ ุจุงูุนูู.  ูุชู ุชุนููู ูุฐู ุงูุนูุงูุฉ ุจูุงุณุทุฉ ุทุฑููุฉ interruptPoll ูููุตูุฉ ุ ูุงูุชู ุ ุนูุงูุฉ ุนูู ุฐูู ุ ุชุณุชููุธ ุนูู ุฃุฏุงุฉ ุชุญุฏูุฏ ุงูุนููู ูุชุญุฑูุฑ ููู ูุคุดุฑ ุงูุชุฑุงุจุท ูู ุนูููุงุช ุงูุฅุฏุฎุงู / ุงูุฅุฎุฑุงุฌ. <br><br>  ุจุนุฏ ุชูููุฐ ุงูุนููู ุจูุฐู ุงูุทุฑููุฉ ุ ุฃุญุตู ุนูู ุณุฑุนุฉ ุฑุฏ ุงููุนู ูู ุงููุญุธุฉ ุงูุชู ูุตู ูููุง ุทูุจ ุงูุงูุชุฒุงู ุญุชู ูุนุงูุฌุชู ุญุชู 100 ูููุฑูุซุงููุฉ ุ ูุชุฃุฎุฑ ููุชุงุฒ ูุฌูุจ ุงูุฑุณุงุฆู ูู ูุณูุท ุ ููู ุฃูุฑ ุฌูุฏ ุฌุฏูุง. <br></div></div><br>  ูุชู ุชูุซูู ูู ูุณู ุจูุงุณุทุฉ ูุงุฆูุฉ ุงูุชุธุงุฑ ูุญููุฉ ูููุตูุฉ ุ ุญูุซ ููุชุจ ุงููุญูู ุฑุณุงุฆู ูู ุงููุณูุท.  ูุฃุฎุฐ ุงูุนุงูู ุงูุฑุณุงุฆู ููู ููุฑุณููุง ููุชูููุฐ ุ ุฃู ูุฅุฑุณุงููุง ุนุจุฑ HTTP. <br><br>  ุชุฏุนู ุงูุฎุฏูุฉ ูุนุงูุฌุฉ ุฑุณุงุฆู ุงูุฏููุนุงุช ูุฒูุงุฏุฉ ุงูุฅูุชุงุฌูุฉ.  ุนูุฏ ุงูุงุดุชุฑุงู ุ ููููู ุชุญุฏูุฏ <code>concurrencyFactor</code> ูู ููุถูุน (ููุทุจู ุนูู ูู ูุณู ูุนูู ุจุดูู ูุณุชูู).  ุนูู ุณุจูู ุงููุซุงู ุ ูุนูู <code>concurrencyFactor=1000</code> ุฃูู ูููู ุฅุฑุณุงู 1000 ุฑุณุงูุฉ ูู ุดูู ุทูุจุงุช HTTP ุฅูู ุงููุณุชููู ูู ููุณ ุงูููุช.  ุจูุฌุฑุฏ ุฃู ูุชู ุญู ุฌููุน ุงูุฑุณุงุฆู ุงููุงุฑุฏุฉ ูู ุงูุนุจูุฉ ุจุดูู ูุง ูุจุณ ููู ูู ูุจู ุงููุณุชููู ุ ุชูุฑุฑ ุงูุฎุฏูุฉ ุงูุงูุชุฒุงู ุงูุชุงูู ูุชุนููุถ ุขุฎุฑ ุฑุณุงูุฉ ูู ูุงููุง.  ูุจุงูุชุงูู ุ ูุฅู ุงููููุฉ ุงูุซุงููุฉ ูู <code>concurrencyFactor</code> ูู ุงูุญุฏ ุงูุฃูุตู ูุนุฏุฏ ุงูุฑุณุงุฆู ุงูุชู ูุนุงูุฌูุง ุงููุณุชููู ูู ุญุงูุฉ ุชุนุทู Kafka ุฃู Queue-Over-Http. <br><br>  ูุชูููู ุงูุชุฃุฎูุฑุงุช ุ ุชุญุชูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุนูู <code>loadFactor = concurrencyFactor * 2</code> ุ ูุงูุฐู ูุณูุญ ูู ุจูุฑุงุกุฉ ุถุนู ุนุฏุฏ ุงูุฑุณุงุฆู ูู ุงููุณูุท ุงูุชู ูููู ุฅุฑุณุงููุง.  ูุธุฑูุง ูุชุนุทูู autocommit ุนูู ุงูุนููู ุงูุฃุตูู ุ ูุฅู ูุฐุง ุงููุฎุทุท ูุง ููุชูู ุถูุงูุงุช At-Least-Once. <br>  ุชุคุฏู ูููุฉ <code>concurrencyFactor</code> ุงูุนุงููุฉ ุฅูู ุฒูุงุฏุฉ ุฅูุชุงุฌูุฉ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุนู ุทุฑูู ุชูููู ุนุฏุฏ ุงูุฅูุชุฒุงูุงุช ุงูุชู ุชุตู ุฅูู 10 ูููู ุซุงููุฉ ูู ุฃุณูุฃ ุงูุญุงูุงุช.  ูู ุงูููุช ููุณู ุ ูุฒุฏุงุฏ ุงูุญูู ุนูู ุงููุณุชููู. <br><br>  ุชุฑุชูุจ ุฅุฑุณุงู ุงูุฑุณุงุฆู ุฏุงุฎู ุงูุญุฒูุฉ ุบูุฑ ูุถููู ุ ูููู ูููู ุชุญููู ุฐูู ุนู ุทุฑูู ุถุจุท <code>concurrencyFactor=1</code> . <br><br><a name="commits"></a><h1 style=";text-align:right;direction:rtl">  ูุฑุชูุจ </h1><br>  ุงุฑุชูุงุจ ูู ุฌุฒุก ููู ูู ุงูุฎุฏูุฉ.  ุนูุฏูุง ุชููู ุงูุญุฒูุฉ ุงูุชุงููุฉ ูู ุงูุจูุงูุงุช ุฌุงูุฒุฉ ุ ูุฅู ุฅุฒุงุญุฉ ุขุฎุฑ ุฑุณุงูุฉ ูู ุงูุญุฒูุฉ ููุชุฒู ุนูู ุงูููุฑ ุจู Kafka ุ ูููุท ุจุนุฏ ุงูุงูุชุฒุงู ุงููุงุฌุญ ุชุตุจุญ ุงูุญุฒูุฉ ุงูุชุงููุฉ ูุชุงุญุฉ ูููุนุงูุฌุฉ.  ูู ูุซูุฑ ูู ุงูุฃุญูุงู ูุฐุง ูุง ูููู ูุงูุชุฒุงู ุงูุณูุงุฑุงุช ูู ูุทููุจ.  ููููุงู ุจุฐูู ุ ููุงู ุงููุนููุฉ <code>autoCommitPeriodMs</code> ุ ูุงูุชู ุชุดุชุฑู ูู ุงููููู ูุน ูุชุฑุฉ <code>autoCommitPeriodMs</code> ุงูููุงุณููู ููุนููุงุก ุงูุฃุตูููู ุงูุฐูู ูุฑุชูุจูู ุงูุฑุณุงูุฉ ุงูุฃุฎูุฑุฉ ุงูุชู ุชูุช ูุฑุงุกุชูุง ูู ุงููุณู.  ุชุฎูู <code>concurrencyFactor=10</code> .  ุฃุฑุณูุช ุงูุฎุฏูุฉ ุฌููุน ุงูุฑุณุงุฆู ุงูุนุดุฑุฉ ูุชูุชุธุฑ ุฃู ูููู ูู ูููุง ุฌุงูุฒูุง.  ุงูุชูุงู ูุนุงูุฌุฉ ุงูุฑุณุงูุฉ 3 ุฃููุงู ุ ุซู ุงูุฑุณุงูุฉ 1 ุ ุซู ุงูุฑุณุงูุฉ 10. ูู ูุฐู ุงููุฑุญูุฉ ุ ุญุงู ููุช ุงูุงูุชุฒุงู ุงูุชููุงุฆู.  ูู ุงูููู ุนุฏู ุงูุชูุงู ุฏูุงูุงุช At-Least-Once.  ูุฐูู ุ ููููู ููุท ุงูุงูุชุฒุงู ุจุงูุฑุณุงูุฉ ุงูุฃููู ุ ุฃู ุงูุฅุฒุงุญุฉ 2 ุ ุญูุซ ุชู ูุนุงูุฌุชูุง ุจูุฌุงุญ ููุท ูู ุชูู ุงููุญุธุฉ.  ุนูุงูุฉ ุนูู ุฐูู ุ ุญุชู ุชุชู ูุนุงูุฌุฉ ุงูุฑุณุงุฆู ุงูุชููุงุฆูุฉ ุงูุชุงููุฉ ุ ุชุชู ูุนุงูุฌุฉ ุงูุฑุณุงุฆู 2 ู 5 ู 6 ู 4 ู 8. ูุงูุขู ููุฒูู ุงูุงูุชุฒุงู ููุท ุจุงูุฅุฒุงุญุฉ 7 ูููุฐุง.  ูุง ูุคุซุฑ Autocommit ุชูุฑูุจูุง ุนูู ุงูุฅูุชุงุฌูุฉ. <br><br><a name="errors"></a><h1 style=";text-align:right;direction:rtl">  ุฎุทุฃ ูู ุงูุชุนุงูู </h1><br>  ูู ุงููุถุน ุงูุนุงุฏู ููุชุดุบูู ุ ุชุฑุณู ุงูุฎุฏูุฉ ุฑุณุงูุฉ ุฅูู ุงููุดุฑู ูุฑุฉ ูุงุญุฏุฉ.  ุฅุฐุง ุชุณุจุจุช ุ ูุณุจุจ ูุง ุ ูู ุญุฏูุซ ุฎุทุฃ 4xx ุฃู 5xx ุ ูุณุชุนูุฏ ุงูุฎุฏูุฉ ุฅุฑุณุงู ุงูุฑุณุงูุฉ ุ ูู ุงูุชุธุงุฑ ุงููุนุงูุฌุฉ ุงููุงุฌุญุฉ.  ูููู ุชูููู ุงูููุช ุจูู ุงููุญุงููุงุช ููุนููุฉ ูููุตูุฉ. <br><br>  ูู ุงููููู ุฃูุถูุง ุชุนููู ุนุฏุฏ ุงููุญุงููุงุช ุงูุชู ุณูุชู ุจุนุฏูุง ูุถุน ุนูุงูุฉ ุนูู ุงูุฑุณุงูุฉ ููุนุงูุฌุฉ ุ ููุง ูุคุฏู ุฅูู ุฅููุงู ุนูููุงุช ุฅุนุงุฏุฉ ุงูุฅุฑุณุงู ุจุบุถ ุงููุธุฑ ุนู ุญุงูุฉ ุงูุงุณุชุฌุงุจุฉ.  ูุง ุฃูุตุญ ุจุงุณุชุฎุฏุงู ูุฐุง ููุจูุงูุงุช ุงูุญุณุงุณุฉ ุ ูุฌุจ ุฏุงุฆููุง ุถุจุท ุญุงูุงุช ูุดู ุงููุณุชููููู ูุฏูููุง.  ูููู ูุฑุงูุจุฉ ุงูุฑุณุงุฆู ุงูููุตูุฉ ุจูุงุณุทุฉ ุณุฌูุงุช ุงูุฎุฏูุฉ ููุฑุงูุจุฉ ุญุงูุฉ ุงุณุชุฌุงุจุฉ ุงููุณุชููู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุญูู ุงูุดุงุฆูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ุนุงุฏุฉู ูุง ูุฑุณู ุฎุงุฏู HTTP ุ ุงูุฐู ูุนุทู 4xx ุฃู 5xx ุญุงูุฉ ุงูุงุณุชุฌุงุจุฉ ุ ุฃูุถูุง <code>Connection: close</code> header.  ูุธู ุงุชุตุงู TCP ุงููุบูู ุจูุฐู ุงูุทุฑููุฉ ูู <code>TIME_WAITED</code> ุญุชู ูุชู ูุณุญู ุจูุงุณุทุฉ ูุธุงู ุงูุชุดุบูู ุจุนุฏ ูุฑูุฑ ุจุนุถ ุงูููุช.  ุงููุดููุฉ ูู ุฃู ูุซู ูุฐู ุงูุงุชุตุงูุงุช ุชุดุบู ูููุฐูุง ูุงูููุง ูุง ูููู ุฅุนุงุฏุฉ ุงุณุชุฎุฏุงูู ุญุชู ูุชู ุฅุตุฏุงุฑู.  ูุฏ ููุชุฌ ุนู ุฐูู ุนุฏู ูุฌูุฏ ููุงูุฐ ูุฌุงููุฉ ุนูู ุงูุฌูุงุฒ ูุชุฃุณูุณ ุงุชุตุงู TCP ูุณูุชู ุทุฑุญ ุงูุฎุฏูุฉ ูุน ุงุณุชุซูุงุกุงุช ูู ุณุฌูุงุช ูู ุฅุฑุณุงู.  ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ูู Windows 10 ุ ุชูุชูู ุงูููุงูุฐ ุจุนุฏ ุฅุฑุณุงู 10-20 ุฃูู ุฑุณุงูุฉ ุฎุงุทุฆุฉ ูู ุบุถูู 1-2 ุฏูุงุฆู.  ูู ุงููุถุน ุงูููุงุณู ุ ูุฐู ููุณุช ูุดููุฉ. <br></div></div><br><a name="messages"></a><h1 style=";text-align:right;direction:rtl">  ุงูุฑุณุงุฆู </h1><br>  ูุชู ุฅุฑุณุงู ูู ุฑุณุงูุฉ ูุณุชุฎุฑุฌุฉ ูู ุงููุณูุท ุฅูู ุงููุณุชุดุงุฑ ุนุจุฑ HTTP ุฅูู ุงูููุฑุฏ ุงููุญุฏุฏ ุฃุซูุงุก ุงูุงุดุชุฑุงู.  ุจุดูู ุงูุชุฑุงุถู ุ ูุชู ุฅุฑุณุงู ุฑุณุงูุฉ ุจูุงุณุทุฉ ุทูุจ POST ูู ุงูุฌุณู.  ูููู ุชุบููุฑ ูุฐุง ุงูุณููู ุนู ุทุฑูู ุชุญุฏูุฏ ุฃู ุทุฑููุฉ ุฃุฎุฑู.  ุฅุฐุง ูุงูุช ุงูุทุฑููุฉ ูุง ุชุฏุนู ุฅุฑุณุงู ุงูุจูุงูุงุช ูู ุงููุต ุ ููููู ุชุญุฏูุฏ ุงุณู ูุนููุฉ ุงูุณูุณูุฉ ุงูุชู ุณูุชู ุฅุฑุณุงู ุงูุฑุณุงูุฉ ูููุง.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุนูุฏ ุงูุงุดุชุฑุงู ุ ููููู ุชุญุฏูุฏ ุฑุคูุณ ุฅุถุงููุฉ ุณุชุชู ุฅุถุงูุชูุง ุฅูู ูู ุฑุณุงูุฉ ุ ููู ููุงุณุจุฉ ููุชุฑุฎูุต ุงูุฃุณุงุณู ุจุงุณุชุฎุฏุงู ุงูุฑููุฒ.  ุชุชู ุฅุถุงูุฉ ุงูุฑุคูุณ ุฅูู ูู ุฑุณุงูุฉ ุจูุนุฑู ุงููุณุชููู ูุงูููุถูุน ูุงููุณู ุ ุญูุซ ุชูุช ูุฑุงุกุฉ ุงูุฑุณุงูุฉ ุ ูุฑูู ุงูุฑุณุงูุฉ ุ ูููุชุงุญ ุงููุณู ุ ุฅู ุฃููู ุ ููุฐูู ุงุณู ุงููุณูุท. <br><br><a name="performance"></a><h1 style=";text-align:right;direction:rtl">  ุงูุฃุฏุงุก </h1><br>  ูุชูููู ุงูุฃุฏุงุก ุ ุงุณุชุฎุฏูุช ุฌูุงุฒ ููุจููุชุฑ (Windows 10 ุ OpenJDK-11 (G1 ุจุฏูู ุชูููู) ุ i7-6700K ุ 16GB) ุ ุงูุฐู ูููู ุจุชุดุบูู ุงูุฎุฏูุฉ ูุฌูุงุฒ ููุจููุชุฑ ูุญููู (Windows 10 ุ i5-8250U ุ 8GB) ุ ุญูุซ ูุงู ููุชุฌ ุงูุฑุณุงุฆู ุ HTTP ูุฏูุฑ ููุฑุฏ ุงููุณุชููู ู Kafka ูุน ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ.  ุงูููุจููุชุฑ ูุชุตู ุจุงูููุฌู ุนุจุฑ ุงุชุตุงู ุณููู 1 ุฌูุฌุงุจุช / ุซุงููุฉ ุ ูุงูููุจููุชุฑ ุงููุญููู ุนุจุฑ 802.11ac.  ููุชุจ ุงูููุชุฌ ูู 110 ูููู ุซุงููุฉ ูู 100 ูููู ุซุงููุฉ ุนู 110 ุจุงูุช ูู ุงูุฑุณุงุฆู ุฅูู ุงูููุถูุนุงุช ุงููุญุฏุฏุฉ ุงูุชู ูุชู ุงุดุชุฑุงู ุงููุชุงุจุนูู ูููุง ( <code>concurrencyFactor=500</code> ุ ูุชู ุฅููุงู ุงูุงูุชุฒุงู ุงูุชููุงุฆู) ูู ูุฌููุนุงุช ูุฎุชููุฉ.  ุงูุญุงูู ุจุนูุฏ ุนู ุงููุซุงููุฉ ุ ููู ููููู ุงูุญุตูู ุนูู ุจุนุถ ุงูุตูุฑ. <br><br>  ูุนููุฉ ุงูููุงุณ ุงูุฑุฆูุณูุฉ ูู ุชุฃุซูุฑ ุงูุฎุฏูุฉ ุนูู ุงููููู. <br><br>  ุฏุน: <br>  - t <sub>q</sub> - ุงูุทุงุจุน ุงูุฒููู ูุฎุฏูุฉ ุงุณุชูุจุงู ุงูุฑุณุงุฆู ูู ุงูุนููู ุงูุฃุตูู <br>  - d <sub>t0</sub> ูู ุงูููุช ุจูู t <sub>q</sub> ูุงูููุช ุงูุฐู ุชู ููู ุฅุฑุณุงู ุงูุฑุณุงูุฉ ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงููุญููุฉ ุฅูู ูุฌููุนุฉ ุงููุณุคูููู ุงูุชูููุฐููู <br>  - d <sub>t</sub> ูู ุงูููุช ุจูู t <sub>q</sub> ูุงูููุช ุงูุฐู ุชู ููู ุฅุฑุณุงู ุทูุจ HTTP.  ุฃู d <sub>t</sub> ูู ุชุฃุซูุฑ ุงูุฎุฏูุฉ ุนูู ุฒูู ุงููุตูู ููุฑุณุงูุฉ. <br><br>  ุฎูุงู ุงูููุงุณุงุช ุ ุชู ุงูุญุตูู ุนูู ุงููุชุงุฆุฌ ุงูุชุงููุฉ (C - ูุณุชููููู ุ ููุงุถูุน T ุ ุฑุณุงุฆู M): <br><br><img src="https://habrastorage.org/webt/p4/r7/pq/p4r7pqavkke1d3glzc7u8o6a5gu.png"><br><br>  ูู ูุถุน ุงูุชุดุบูู ุงูููุงุณู ุ ูุง ุชุคุซุฑ ุงูุฎุฏูุฉ ููุณูุง ุชูุฑูุจูุง ุนูู ุฒูู ุงููุตูู ุ ููุง ุฃู ุงุณุชููุงู ุงูุฐุงูุฑุฉ ุถุฆูู.  ูุง ูุชู ุชุญุฏูุฏ ุงูููู ุงููุตูู ูู d <sub>t</sub> (ุญูุงูู 60 ูููู ุซุงููุฉ) ุนูู ูุฌู ุงูุชุญุฏูุฏ ุ ูุฃููุง ุชุนุชูุฏ ุนูู ุชุดุบูู GC ุ ูููุณ ุนูู ุงูุฎุฏูุฉ ููุณูุง.  ูููู ุฃู ูุณุงุนุฏ ุงูุถุจุท ุงูุฎุงุต ูู GC ุฃู ุงุณุชุจุฏุงู G1 ูุน Shenandoah ูู ุชุฎููู ุงูุชุดุงุฑ ุงูููู ุงููุตูู. <br><br>  ูุชุบูุฑ ูู ุดูุก ุจุดูู ูุจูุฑ ุนูุฏูุง ูุง ูุชุนุงูู ุงููุณุชููู ูุน ุชุฏูู ุงูุฑุณุงุฆู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ูุชููู ุงูุฎุฏูุฉ ุจุชุดุบูู ูุถุน ุงูุงุฎุชูุงู.  ูู ูุฐุง ุงููุถุน ุ ูุฒุฏุงุฏ ุงุณุชููุงู ุงูุฐุงูุฑุฉ ุ ุญูุซ ูุฒุฏุงุฏ ููุช ุงูุงุณุชุฌุงุจุฉ ููุทูุจุงุช ุจุดูู ูุจูุฑ ุ ููุง ูููุน ุชูุธูู ุงูููุงุฑุฏ ูู ุงูููุช ุงูููุงุณุจ.  ูุจูู ุงูุชุฃุซูุฑ ุนูู ุงููููู ููุง ุนูู ูุณุชูู ุงููุชุงุฆุฌ ุงูุณุงุจูุฉ ุ ูุชูุชุฌ ููู dt ุงูุนุงููุฉ ุนู ุงูุชุญููู ุงููุณุจู ููุฑุณุงุฆู ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุงููุญููุฉ. <br><br>  ูุณูุก ุงูุญุธ ุ ูุง ูููู ุงูุงุฎุชุจุงุฑ ุนูุฏ ุชุญููู ุฃุนูู ุ ูุธุฑูุง ูุฃู ุงูููุจููุชุฑ ุงููุญููู ููุญูู ุจุงููุนู ุนูุฏ 1300 RPS.  ุฅุฐุง ุชููู ุฃู ุดุฎุต ูู ุงููุณุงุนุฏุฉ ูู ุชูุธูู ุงูููุงุณุงุช ุจุงูุฃุญูุงู ุงููุจูุฑุฉ ุ ูุณูู ุฃููู ุณุนูุฏูุง ุจุชูุฏูู ูุฌููุนุฉ ููุงุฎุชุจุงุฑุงุช. <br><br><a name="demo"></a><h1 style=";text-align:right;direction:rtl">  ูุธุงูุฑุฉ </h1><br>  ุงูุขู ุฏุนูุง ููุชูู ุฅูู ุงููุธุงูุฑุฉ.  ููุฐุง ูุญุชุงุฌ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุงููุง ูุณูุท ุ ุนูู ุงุณุชุนุฏุงุฏ ููุฐูุงุจ.  ุณุขุฎุฐ ุงููุซูู ุงูุฐู ุฃุซูุฑ ูู 192.168.99.100:9092 ูู Bitnami. </li><li style=";text-align:right;direction:rtl">  ููุฑุฏ HTTP ุงูุฐู ุณูุชููู ุงูุฑุณุงุฆู.  ูู ุฃุฌู ุงููุถูุญ ุ ุฃุฎุฐุช ุฎุทุงูุงุช ุงูููุจ ูู ุณูุงู. </li></ul><br>  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุชุญุชุงุฌ ุฅูู ุฑูุน ุฎุฏูุฉ Queue-Over-Http ููุณูุง.  ููููุงู ุจุฐูู ุ ูู ุจุฅูุดุงุก ุงููุญุชููุงุช ุงูุชุงููุฉ ูู ุฏููู <code>application.yml</code> ูุงุฑุบ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">spring: profiles: default logging: level: com: viirrtus: queueOverHttp: DEBUG app: persistence: file: storageDirectory: "persist" brokers: - name: "Kafka" origin: "kafka" config: bootstrap.servers: "192.168.99.100:9092"</code> </pre><br>  ููุถุญ ููุง ููุฎุฏูุฉ ูุนููุงุช ุงุชุตุงู ูุณูุท ูุนูู ุ ููุฐูู ุฃูุงูู ุชุฎุฒูู ุงููุดุชุฑููู ุจุญูุซ ูุง ุชุถูุน ุจูู ุนูููุงุช ุงูุจุฏุก.  ูู `app.brokers []. Config 'ุ ููููู ุชุญุฏูุฏ ุฃู ูุนููุงุช ุงุชุตุงู ูุฏุนููุง ุนููู Kafka ุงูุฃุตูู ุ ูููู ุงูุนุซูุฑ ุนูู ูุงุฆูุฉ ูุงููุฉ <a href="">ููุง</a> . <br><br>  ูุธุฑูุง ูุฃู ููู ุงูุชูููู ุชุชู ูุนุงูุฌุชู ุจูุงุณุทุฉ Spring ุ ููููู ูุชุงุจุฉ ุงููุซูุฑ ูู ุงูุฃุดูุงุก ุงููุซูุฑุฉ ููุงูุชูุงู ููุงู.  ุจูุง ูู ุฐูู ุ ุชูููู ุงูุชุณุฌูู. <br><br>  ุงูุขู ูู ุจุชุดุบูู ุงูุฎุฏูุฉ ููุณูุง.  ูุญู ูุณุชุฎุฏู ุฃุณูู ุทุฑููุฉ - <code>docker-compose.yml</code> : <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">version: "2" services: app: image: viirrtus/queue-over-http:0.1.3 restart: unless-stopped command: --debug ports: - "8080:8080" volumes: - ./application.yml:/application.yml - ./persist:/persist</code> </pre><br>  <i>ุฅุฐุง ูุงู ูุฐุง ุงูุฎูุงุฑ ูุง ููุงุณุจู ุ ูููููู ุชุฑุฌูุฉ ุงูุฎุฏูุฉ ูู ุงููุตุฏุฑ.</i>  <i>ุฅุฑุดุงุฏุงุช ุงูุชุฌููุน ูู ูุดุฑูุน ุงููุณุชูุฏ ุงูุชูููุฏู ุ ููู ุฑุงุจุท ูุชู ุชูุฏููู ูู ููุงูุฉ ุงูููุงูุฉ.</i> <br><br>  ูุงูุฎุทูุฉ ุงูุชุงููุฉ ูู ุชุณุฌูู ุงููุดุชุฑู ุงูุฃูู.  ููููุงู ุจุฐูู ุ ุชุญุชุงุฌ ุฅูู ุชูููุฐ ุทูุจ HTTP ููุฎุฏูุฉ ูุน ูุตู ูููุณุชููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">POST localhost:8080/broker/subscription Content-Type: application/json { "id": "my-first-consumer", "group": { "id": "consumers" }, "broker": "Kafka", "topics": [ { "name": "slack.test", "config": { "concurrencyFactor": 10, "autoCommitPeriodMs": 100 } } ], "subscriptionMethod": { "type": "http", "delayOnErrorMs": 1000, "retryBeforeCommit": 10, "uri": "&lt;slack-wh-uri&gt;", "additionalHeaders": { "Content-Type": "application/json" } } }</code> </pre><br>  ุฅุฐุง ุณุงุฑุช ุงูุฃููุฑ ุนูู ูุง ูุฑุงู ุ ูุณุชููู ุงูุงุณุชุฌุงุจุฉ ูู ููุณ ุงููุญุชูู ุงููุฑุณู. <br><br>  ุฏุนูุง ูุฐูุจ ูู ุฎูุงู ูู ูุนููุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <code>Consumer.id</code> - ูุนุฑู ุงููุดุชุฑู ูุฏููุง </li><li style=";text-align:right;direction:rtl">  <code>Consumer.group.id</code> - ูุนุฑู ุงููุฌููุนุฉ </li><li style=";text-align:right;direction:rtl">  <code>Consumer.broker</code> - ุญุฏุฏ ุฃู ูู ูุณุทุงุก ุงูุฎุฏูุงุช ุงูุฐูู ุชุญุชุงุฌ ุฅูู ุงูุงุดุชุฑุงู ููู </li><li style=";text-align:right;direction:rtl">  <code>Consumer.topics[0].name</code> - ุงุณู ุงูููุถูุน ุงูุฐู ูุฑูุฏ ุงุณุชูุงู ุงูุฑุณุงุฆู ููู </li><li style=";text-align:right;direction:rtl"> <code>Consumer.topics[0].config. concurrencyFactor</code>  <code>Consumer.topics[0].config. concurrencyFactor</code> - ุงูุญุฏ ุงูุฃูุตู ูุนุฏุฏ ุงูุฑุณุงุฆู ุงููุฑุณูุฉ ูู ููุช ูุงุญุฏ </li><li style=";text-align:right;direction:rtl"> <code>Consumer.topics[0].config. autoCommitPeriodMs</code>  <code>Consumer.topics[0].config. autoCommitPeriodMs</code> - ูุชุฑุฉ ุงูุงูุชุฒุงู ุงููุณุฑู ููุฑุณุงุฆู ุงูุฌุงูุฒุฉ </li><li style=";text-align:right;direction:rtl">  <code>Consumer.subscriptionMethod.type</code> - ููุน ุงูุงุดุชุฑุงู.  HTTP ููุท ูู ูุชุงุญ ุญุงููุง. </li><li style=";text-align:right;direction:rtl">  <code>Consumer.subscriptionMethod.delayOnErrorMs</code> - ุงูููุช ูุจู ุฅุนุงุฏุฉ ุฅุฑุณุงู ุฑุณุงูุฉ ุงูุชูุช ุจุฎุทุฃ </li><li style=";text-align:right;direction:rtl">  <code>Consumer.subscriptionMethod.retryBeforeCommit</code> - ุนุฏุฏ ูุญุงููุงุช ุฅุนุงุฏุฉ ุฅุฑุณุงู ุฑุณุงูุฉ ุงูุฎุทุฃ.  ุฅุฐุง 0 - ุณูู ุชุฏูุฑ ุงูุฑุณุงูุฉ ุญุชู ูุนุงูุฌุฉ ูุงุฌุญุฉ.  ูู ุญุงูุชูุง ุ ูุง ูุถูู ุถูุงู ุงูุชุณููู ุงููุงูู ุฃูููุฉ ุซุจุงุช ุงูุชุฏูู. </li><li style=";text-align:right;direction:rtl">  <code>Consumer.subscriptionMethod.uri</code> - ุงูููุฑุฏ ุงูุฐู ุณูุชู ุฅุฑุณุงู ุงูุฑุณุงุฆู ุฅููู </li><li style=";text-align:right;direction:rtl">  <code>Consumer.subscriptionMethod.additionalHeader</code> - ุฑุคูุณ ุฅุถุงููุฉ ุณูุชู ุฅุฑุณุงููุง ูุน ูู ุฑุณุงูุฉ.  ูุงุญุธ ุฃูู ุณูููู ููุงู JSON ูู ูุต ูู ุฑุณุงูุฉ ุจุญูุซ ูููู ูู Slack ุชูุณูุฑ ุงูุทูุจ ุจุดูู ุตุญูุญ. </li></ul><br>  <i>ูู ูุฐุง ุงูุทูุจ ุ ุชู ุญุฐู ุทุฑููุฉ HTTP ุ ูุธุฑูุง ูุฃู ุงูุฅุนุฏุงุฏ ุงูุงูุชุฑุงุถู ุ POST ุ Slack ุฌูุฏ ุฌุฏูุง.</i> <br><br>  ูู ูุฐู ุงููุญุธุฉ ุ ุชุฑุงูุจ ุงูุฎุฏูุฉ ุงูุฃูุณุงู ุงููุนููุฉ ูููุถูุน slack.test ููุฑุณุงุฆู ุงูุฌุฏูุฏุฉ. <br><br>  ููุชุงุจุฉ ุฑุณุงุฆู ุฅูู ุงูููุถูุน ุ <code>/opt/bitnami/kafka/bin</code> ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ุงููุถููุฉ ูู ูุงููุง ุงูููุฌูุฏุฉ ูู <code>/opt/bitnami/kafka/bin</code> ูุตูุฑุฉ Kafka ุงูุชู ุชู ุฅุทูุงููุง (ูุฏ ูุฎุชูู ูููุน ุงูุฃุฏูุงุช ุงููุณุงุนุฏุฉ ูู ูุซููุงุช Kafka ุงูุฃุฎุฑู): <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">kafka-console-producer.sh --broker-list localhost:9092 --topic slack.test &gt; {โtextโ: โHello!โ}</code> </pre><br>  ูู ููุณ ุงูููุช ุ ุณูู ูุนููู Slack ุจุฑุณุงูุฉ ุฌุฏูุฏุฉ: <br><br><img src="https://habrastorage.org/webt/kl/eh/z7/klehz7ev6x1y2eaqpf_ylpnjic4.png"><br><br>  <i>ูุฅูุบุงุก ุงุดุชุฑุงู ุฃุญุฏ ุงููุณุชููููู ุ ูููู ุชูุฏูู ุทูุจ POST ูู "ูุณูุท / ุฅูุบุงุก ุงูุงุดุชุฑุงู" ุจููุณ ุงููุญุชูู ุงูุฐู ูุงู ุฎูุงู ุงูุงุดุชุฑุงู.</i> <br><br><a name="the-end"></a><h1 style=";text-align:right;direction:rtl">  ุงูุฎุงุชูุฉ </h1><br>  ูู ุงูููุช ุงูุญุงูู ุ ูุชู ุชูููุฐ ุงููุธููุฉ ุงูุฃุณุงุณูุฉ ููุท.  ุนูุงูุฉ ุนูู ุฐูู ุ ูู ุงููุฒูุน ุชุญุณูู ุงูุฏููุนุงุช ุ ููุญุงููุฉ ุชูููุฐ ุฏูุงูุงุช ุงูุฃููุงุธ ุชูุงููุง ุ ูุฅุถุงูุฉ ุงููุฏุฑุฉ ุนูู ุฅุฑุณุงู ุฑุณุงุฆู ุฅูู ุงููุณูุท ุนุจุฑ HTTP ุ ูุงูุฃูู ูู ุฐูู ุ ุฅุถุงูุฉ ุฏุนู ููุดุฑ Pub-Sub ุงูุดููุฑ. <br><br>  ุฎุฏูุฉ ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุนุจุฑ ุจุฑูุชูููู ุงูุชูุงู ุงููุต ุงููุชุดุนุจ ูู ุญุงููุง ููุฏ ุงูุชุทููุฑ ุงููุดุท.  ุงูุฅุตุฏุงุฑ 0.1.3 ูุณุชูุฑ ุจูุง ููู ุงูููุงูุฉ ููุงุฎุชุจุงุฑ ุนูู ุงููุฏุฑุฌุงุช ูุฑุญูุฉ ุงูุชุทููุฑ.  ุชู ุงุฎุชุจุงุฑ ุงูุฃุฏุงุก ุนูู ุฃูุธูุฉ ุงูุชุดุบูู Windows 10 ู Debian 9 ู Ubuntu 18.04.  ููููู ุงุณุชุฎุฏุงู ููุฒ ุนูู ูุณุคูููุชู ุงูุฎุงุตุฉ.  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุงููุณุงุนุฏุฉ ูู ุงูุชุทููุฑ ุฃู ุชูุฏูู ุฃู ููุงุญุธุงุช ุญูู ุงูุฎุฏูุฉ - ูุฑุญุจูุง ุจูู ูู ูุดุฑูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://github.com/viirtus/queue-over-">ุฌูุซุจ</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar435346/">https://habr.com/ru/post/ar435346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar435334/index.html">ุฑุฏ ุงููุนู ุนูู ุงูุญุฑูู ุงูุจุงุฑุฏุฉ</a></li>
<li><a href="../ar435336/index.html">ุงูุนุซูุฑ ุนูู ุดูุก ูุง: ูุฑูุงุช ูุน ููุงุก Elasticsearch ููุณูู ูู OZON</a></li>
<li><a href="../ar435338/index.html">ูุฎูู ูุธุงู ุงูุชูููุช ุงูุฅููุชุฑููู ููุฃุฌูุงุณ</a></li>
<li><a href="../ar435340/index.html">ุจุงุญุซ ููุดุฑ ูุซุงู ุนูู ุฑูุฒ ุงูุฏูุฏุฉ ูููุณุจูู</a></li>
<li><a href="../ar435344/index.html">ูุฏูุช ุฃูุงุฒูู ุตุงูุฉ ุงูุนุฑุถ ุ ุฃู ููุงุฐุง ุณูุดุชุฑู ูุฑูุจูุง ุฌููุน ุงูุฃุซุงุซ ุนุจุฑ ุงูุฅูุชุฑูุช</a></li>
<li><a href="../ar435348/index.html">ุจุณูุท MCerver - ูุฐููุฉ ุตุบูุฑุฉ ูุฎุงุฏู ูุงูู ูุฑุงูุช</a></li>
<li><a href="../ar435352/index.html">ูุคุชูุฑ DEFCON 18. ุงูุชุฌุณุณ ุงูุนููู ุจุงุณุชุฎุฏุงู ุงููุงุชู ุงููุญููู. ุงูุฌุฒุก 2</a></li>
<li><a href="../ar435354/index.html">ูุคุชูุฑ DEFCON 18. ุงูุชุฌุณุณ ุงูุนููู ุจุงุณุชุฎุฏุงู ุงููุงุชู ุงููุญููู. ุงูุฌุฒุก 1</a></li>
<li><a href="../ar435358/index.html">ุงูุขุซุงุฑ: Minidisk ูู ุนุตุฑ ุจูุฏ</a></li>
<li><a href="../ar435360/index.html">Snippets vs Clover - ูุงุฒ ุนูู ูุณุงุจูุฉ ูู ุงูููุช ุงูุญูููู ุงูุฃูุซุฑ ุดุนุจูุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>