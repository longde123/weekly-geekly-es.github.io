<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üö¥üèº üë©üèª‚Äçü§ù‚Äçüë®üèæ üë®‚Äçüë¶‚Äçüë¶ Russian AI Cup 2018, histoire 9 places üë®‚Äçüë®‚Äçüëß üö£ ü§≥üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Alors 


 Mon nom, comme l'ann√©e derni√®re, est Andrei Rybalka, mais cette fois, j'ai 33 ans. Et, puisque j'√©tais dans le top 10, j'ai d√©cid√© de partag...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Russian AI Cup 2018, histoire 9 places</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440574/"><h1 id="itak">  Alors </h1><br><p>  Mon nom, comme l'ann√©e derni√®re, est Andrei Rybalka, mais cette fois, j'ai 33 ans. Et, puisque j'√©tais dans le top 10, j'ai d√©cid√© de partager √† nouveau mon approche pour √©crire un bot de jeu pour la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Russian AI Cup 2018</a> . </p><br><p>  Cette fois, la t√¢che √©tait le football.  La t√¢che elle-m√™me rappelait quelque peu celle de l'IRAC 2014, quand il s'agissait du hockey, mais la solution √©tait compl√®tement diff√©rente. </p><br><p>  Cette fois, le monde √©tait tridimensionnel et cette tridimensionnalit√© √©tait pleinement utilis√©e.  Le jeu lui-m√™me rappelait le plus la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rocket League</a> . </p><br><p>  Je ne vais pas ennuyer la partie introductive, il est plus facile de montrer √† quoi cela ressemblait.  Vous pouvez regarder les jeux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le site</a> ou sur la vid√©o: </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/6g/jb/hf/6gjbhf4gdy_4qqrw74huttfudvq.jpeg"></a> </p><a name="habracut"></a><br><p>  Pour que la vie ne nous semble pas trop douce, les d√©veloppeurs, en plus du non-d√©terminisme du monde du jeu, ont √©galement divis√© le tick du jeu en 100 subwoofers, ce qui a initialement mis fin √† une simulation pr√©cise pour la plupart des participants, et encore plus pour moi, ayant l'intention d'√©crire un bot en Java lent. </p><br><p>  Aussi, je dois dire que le championnat est divis√© en tours, ce qui serait probablement plus correct d'appeler des tours. </p><br><h3 id="kratko-o-turnirnoy-sisteme">  En bref sur le syst√®me de tournois </h3><br><p>  Pour commencer, 2 semaines sont accord√©es pour le d√©veloppement.  Puis le premier tour passe.  Les 300 meilleurs vont plus loin. </p><br><p>  Apr√®s le tour, les r√®gles du jeu changent (en particulier, du nitro est ajout√© au jeu) et 2 autres semaines sont accord√©es, apr√®s quoi le deuxi√®me tour passe. </p><br><p>  Ensuite, les r√®gles sont √† nouveau compliqu√©es (le troisi√®me joueur est ajout√©), une autre semaine est donn√©e et nous jouons la finale. </p><br><p>  Mais ce n'est pas la fin.  Apr√®s les finales, il y a une autre semaine, √† la fin de laquelle le bac √† sable s'arr√™te simplement, et les 6 meilleurs, hors vainqueurs des finales, sont √©galement d√©cern√©s.  La diff√©rence fondamentale entre la finale du bac √† sable et la finale du championnat est que dans le bac √† sable, les jeux sont cr√©√©s dans un format al√©atoire, et pas seulement dans le format de la manche en cours. </p><br><h1 id="istorii-uchastiya">  Histoires de participation </h1><br><p>  La partie technique sera plus faible.  Pour qui l'histoire n'a pas d'int√©r√™t, vous pouvez faire d√©filer vers le bas jusqu'√† ce qu'elle devienne bonne. </p><br><h3 id="pervyy-raund">  Premier tour </h3><br><p>  Il a commenc√©, comme la plupart, par une semaine de beta.  J'ai pass√© beaucoup de temps, plus de 4 heures chaque soir. <br>  Avant de remplir la premi√®re version, il a fallu plusieurs it√©rations <br>  <em>nous codons jusqu'√† ce que nous commencions √† battre la version pr√©c√©dente - nous collectons - nous consid√©rons la version actuelle de la pr√©c√©dente - nous r√©p√©tons</em> . </p><br><p>  Je n'√©tais pas press√© avec le premier remplissage et c'est arriv√© quelques jours avant la manche.  Et, puisque, jusqu'√† pr√©sent, mon bot n'a jou√© avec personne, je ne savais pas dans quel genre de monde j'√©tais et quelles positions dans le classement je pouvais revendiquer.  Quand j'ai vu que j'avais d√©j√† remport√© plus de 100 matchs de suite sans une seule d√©faite, je me suis calm√©. </p><br><p>  En g√©n√©ral, la premi√®re d√©faite que j'ai subie √©tait, semble-t-il, √† la 12e place, dans le temps imparti, et le premier match perdu de suite √©tait d√©j√† dans le top 10. </p><br><p>  Bref, je me suis rendu compte que j'avais des chances d'entrer dans le deuxi√®me tour, o√π va le top 300. <br>  Par cons√©quent, je n'ai pas poursuivi la position et je n'ai rien inond√© d'autre pour le tour, mais j'ai simplement continu√© √† travailler. </p><br><p>  √Ä ce moment-l√†, j'ai vu qu'il y avait encore beaucoup d'espace √† am√©liorer sans connecter de nitro (qui est apparu apr√®s le 1er tour), alors je me suis concentr√© sur la partie principale de la strat√©gie, r√©alisant qu'avant le deuxi√®me tour, il y aurait plus de 2 semaines ou plus et j'aurais le temps de fixer le nitro. </p><br><h3 id="vtoroy-raund">  Deuxi√®me tour </h3><br><p>  La premi√®re semaine, je programmais activement, mais je n'ai toujours pas connect√© nitro.  Je voulais le faire la deuxi√®me semaine.  Mais tout s'est pass√© diff√©remment, car √† la fin de la premi√®re semaine, j'avais contract√© une pneumonie.  Je n'ai pas pu programmer, donc je viens de t√©l√©charger ce que c'√©tait, et, on peut dire, la participation active au championnat pour moi √† cet endroit √©tait termin√©e. </p><br><p>  Au cours des 3 prochaines semaines avant la fin du championnat, j'ai travaill√© sur une strat√©gie d'un montant de peut-√™tre 20 heures. </p><br><p>  En cons√©quence, au deuxi√®me tour, mon bot, en principe, ne savait pas qu'il y avait du nitro dans le jeu, mais a quand m√™me pris la 16e place. </p><br><h3 id="final">  Finale </h3><br><p>  En finale, un troisi√®me joueur a √©t√© ajout√©. </p><br><p>  J'ai √©crit en Java lent, et non en C ++, car 7 personnes sur 8 sont plus √©lev√©es que moi dans le classement, et avant cela, mon bot tombait souvent en timeout, donc avec l'av√®nement du troisi√®me joueur, il a commenc√© √† tomber dans 100% des jeux.  Heureusement, les jeux dans le bac √† sable sont cr√©√©s dans un format al√©atoire, donc je <br>  perdu seulement tous les trois matchs et donc pas trop vol√©.  Il semble √™tre tomb√© √† la 18e place. </p><br><p>  Sauf pour la programmation, l'√©dition des coefficients dans la fonction d'√©valuation et l'ex√©cution des tests, puis pour la premi√®re fois, apr√®s le d√©but de la maladie, je me suis assis au bot le soir de la veille de la finale.  Il a ajout√© une nitro tr√®s simple dirig√©e strictement vers le haut pour que deux attaquants arr√™tent de courir au m√™me point et entrent en collision l√†-bas, et r√©duisent tout ce qu'il pouvait pour un jeu 3x3, √† partir de la profondeur de rendu et se terminant avec la pr√©cision de simulation, seul le bot n'est pas mort par timeout. <br>  Sous cette forme, il a jou√© la finale. </p><br><p>  Dans l'intervalle entre les deux moiti√©s de la finale, je me suis de nouveau assis dans le bot et j'ai pass√© quelques bonnes heures 10. Les changements concernaient pour la plupart la s√©lection dynamique des coefficients, l'interruption pr√©coce de la g√©n√©tique, etc.  En g√©n√©ral, je cherchais un √©quilibre entre la pr√©cision et la profondeur et la vitesse des erreurs de calcul. <br>  En plus de la lutte contre la vitesse, il a apport√© quelques modifications suppl√©mentaires: </p><br><ul><li>  Envoy√© un attaquant distant (par rapport au ballon) √† un point au milieu entre le ballon et le but de l'adversaire </li><li>  J'ai un peu fix√© nitro (la description se fera dans la partie technique).  C'√©tait encore extr√™mement simple, mais il est devenu beaucoup plus efficace. </li></ul><br><p>  Total, apr√®s avoir pass√© les tests et vu le score de 395: 254 par rapport √† la version pr√©c√©dente, je me suis calm√©.  Cela m'a permis de prendre la 9e place en finale. </p><br><h3 id="final-pesochnicy">  Sandbox Finale </h3><br><p>  J'ai continu√© √† faire mal et je n'ai pas travaill√© sur le bot pendant la majeure partie de la semaine.  La veille de la fin, j'ai vu que plusieurs personnes t√©l√©chargeaient de nouvelles versions, qui gagnent souvent contre moi et peuvent jeter des bacs √† sable hors des prix.  J'ai donc pass√© quelques heures de plus. </p><br><p>  Le seul changement majeur est que j'ai d√©terr√© ma branche dans Git il y a trois semaines, dans laquelle j'ai eu une simulation du mouvement de l'ennemi en utilisant mon algorithme simplifi√©.  A cette √©poque, cela fonctionnait mal, mais je l'ai rappel√©, j'ai effectu√© des tests, j'ai vu <br>  qui surpasse la version pr√©c√©dente a presque doubl√© et inond√©.  Au total, au moment de l'arr√™t, j'√©tais √† la 10√®me place du classement g√©n√©ral, ce qui correspond √† la 4√®me en finale du bac √† sable. </p><br><h1 id="kak-eto-vsyo-rabotaet-tehnicheskaya-chast">  Comment tout cela fonctionne (partie technique) </h1><br><p>  Je m'excuse √† l'avance en cas d'inexactitudes dans la terminologie.  De plus, j'√©cris de m√©moire, il est donc possible que quelque part je ne d√©crive pas la version finale. </p><br><p>  Les algorithmes g√©n√©tiques sont donc au c≈ìur.  Le chromosome se compose de plusieurs g√®nes: </p><br><ul><li>  Nombre fractionnaire dans la plage -PI..PI, sp√©cifiant la direction du mouvement </li><li>  Un entier compris entre 0 et 10 qui sp√©cifie le nombre de r√©p√©titions de cette action </li><li>  Nombre fractionnaire de 0 √† 1. Si la valeur est sup√©rieure √† un certain seuil, faites un saut </li></ul><br><p>  Le g√©notype peut comprendre un nombre diff√©rent de chromosomes, mais de telle mani√®re que le nombre total d'actions (y compris les r√©p√©titions) est de 40. </p><br><p>  Au d√©part, je cr√©e plusieurs dizaines de g√©notypes al√©atoires.  J'y ajoute: </p><br><ul><li>  La trajectoire √† droite sur le ballon </li><li>  Trajectoires directes dans toutes les directions, seulement 10 pi√®ces avec un d√©calage de 36 degr√©s </li><li>  Un g√©notype qui ne fait tout simplement rien (sans lui, le bot court toujours quelque part, m√™me s'il se trouve d√©j√† au point optimal) </li><li>  Meilleur g√©notype de la tique pr√©c√©dente </li></ul><br><p>  Ensuite, tout est simul√© et ex√©cut√© via la fonction d'√©valuation.  N meilleurs g√©notypes "survivent" et sont clones M fois avec des mutations.  Lors de la mutation, chaque g√®ne change dans une plage donn√©e avec une probabilit√© de 10%.  Eh bien, cela a √©t√© r√©p√©t√© depuis plusieurs g√©n√©rations. <br>  Il n'y a pas de croisement, dans ce probl√®me je n'y vois aucun sens. </p><br><p>  Au total, le nombre maximum possible de trajectoires par tick par joueur de football √©tait d'environ 800, mais en fait, dans la plupart des cas, il √©tait beaucoup moins, car  dans certains cas (par exemple, lorsque dans un avenir proche nous ne pourrons d√©finitivement pas toucher le ballon), le mouvement des joueurs a √©t√© remplac√© par de simples heuristiques.  De plus, N, M et le nombre de g√©n√©rations d√©pendaient de la situation sur le terrain.  Tout d'abord, de la distance au ballon.  De plus, l'erreur de calcul est interrompue avant la date pr√©vue (mais pas avant la 5e g√©n√©ration) si une trajectoire avec une estimation acceptable est trouv√©e. </p><br><h3 id="makro">  Macro </h3><br><p>  Le gardien court jusqu'au point devant le centre du but.  Mes tests ont montr√© qu'il √©tait pr√©f√©rable pour moi de jouer en √©tant devant le but, et non √† l'int√©rieur, comme la plupart des joueurs du haut. </p><br><p>  La position du point a d√©vi√© du centre en fonction de plusieurs facteurs: la position et la direction du vol du ballon, le point o√π le ballon a frapp√© mon but, si un but est pr√©vu, l'emplacement de l'adversaire attaquant le plus proche, etc. </p><br><p>  Si le ballon est du c√¥t√© de l'adversaire et vole vers son but, on peut opter pour le nitro. </p><br><p>  Si mon gardien de but peut frapper le ballon plus t√¥t que mon attaquant (plus quelques conditions suppl√©mentaires), alors l'attaquant ignore le ballon et court jusqu'√† un point au milieu entre le ballon et le but de l'adversaire.  Je suis pass√© par beaucoup d'options, o√π exactement lui courir.  Dans mon cas, celui-ci a fonctionn√© le mieux. </p><br><p>  Sinon, si le ballon est trop loin, l'attaquant court en ligne droite jusqu'au point de contact le plus proche du ballon avec le sol, dans lequel il peut intercepter le ballon (si nous n'avons pas le temps pour le premier point de contact - v√©rifier le suivant, etc.) </p><br><p>  Sinon (lorsque le ballon atteint), l'attaquant court √† l'endroit o√π la fonction d'√©valuation lui dit.  Oui, et aussi, si le nitro se trouve √† proximit√© et que nous pouvons le ramasser, nous le s√©lectionnons. </p><br><p>  Dans un match 3x3, le deuxi√®me attaquant est plus susceptible de viser le ballon et avec moins de course en avant, s'attendant √† une passe du gardien de but.  Mais s'il fonctionne toujours, alors un autre point est choisi - plus pr√®s de la ligne m√©diane. </p><br><p>  De plus, chaque tick simulait une fois la balle 100 ticks en avant avec 100 microtiques (avec mise en cache). </p><br><p>  Cette trajectoire a √©t√© utilis√©e dans de nombreux endroits.  Par exemple: </p><br><ul><li>  Pour d√©terminer les points de contact de la balle avec le sol </li><li>  Pour savoir si le ballon menace mon objectif et si le gardien de but doit passer en mode simulation </li></ul><br><p>  La m√™me trajectoire exacte a √©t√© utilis√©e dans la simulation des trajectoires des joueurs, afin de ne pas compter la balle √† chaque fois.  Mais seulement jusqu'√† la premi√®re collision du ballon avec n'importe quel joueur de football. </p><br><p>  Au fait, √©crire Footballist √©tait paresseux, les mots Player, Robot √©taient r√©serv√©s par strat√©gie, <br>  donc ma classe wrapper s'appelait simplement Mec :) </p><br><h3 id="simulyaciya">  La simulation </h3><br><p>  Dans la plupart des cas, il est all√© avec un microtique, mais dans certaines situations, il est pass√© en mode pr√©cis avec un grand nombre de microtiques (au d√©but, il √©tait de 100, puis il a √©t√© r√©duit √† 50 dans un jeu 2x2, car les tests ont montr√© que la diff√©rence de r√©sultats √©tait dans la marge d'erreur, et √† 10 en 3x3, car sinon vol√© dans les d√©lais d'attente). </p><br><p>  En mode pr√©cis, j'ai bascul√© soit au moment du rebond, soit en √©tant si proche de la balle qu'une collision au prochain tick est possible.  De plus, il y avait aussi une masse de petites b√©quilles, de hacks, d'optimisations, dans lesquelles je ne comprendrai pas moi-m√™me. </p><br><p>  Par exemple, le ballon volant √©tait toujours simul√© avec 1 Mikrotik, mais si apr√®s le prochain Mikrotik j'ai vu qu'il y avait eu une collision, il a recul√© √† la position pr√©c√©dente et l'a simul√©e √† nouveau avec une plus grande pr√©cision. </p><br><p>  De plus, j'ai √©galement fait semblant d'√™tre d'autres joueurs (les miens et les autres) s'ils √©taient dans les airs (et donc leur trajectoire est plus facile √† pr√©voir) ou s'ils √©taient proches du ballon.  Pour les adversaires, la version finale utilisait une version simplifi√©e de ma propre strat√©gie de prise de d√©cision, qui √©tait lanc√©e toutes les 5 ticks (le plus souvent elle ne permettait pas la vitesse). </p><br><p>  Lors de la simulation de chaque personnage, j'ai calcul√© moi-m√™me, la balle et les autres joueurs de football 40 ticks en avant (ma limite sur le nombre d'actions dans le g√©notype), puis j'ai simul√© le m√™me nombre de ticks sur une seule balle. </p><br><h3 id="nitro">  Nitro </h3><br><p>  Simple √† ind√©cent. </p><br><p>  Dans la version finale, le nitro est toujours activ√© s'il l'est, si le joueur est en l'air et s'il n'a pas touch√© le ballon au cours des derni√®res tiques. </p><br><p>  Au d√©but, j'ai toujours dirig√© la nitro directement vers le haut, mais j'ai ensuite essay√© d'exp√©rimenter et l'option d'aller exactement au centre de la balle fonctionnait le mieux.  J'ai aussi essay√© des options pour que la direction du nitro soit choisie par la g√©n√©tique. </p><br><p>  Cela a fonctionn√© bien pire.  Peut-√™tre en raison d'un manque de profondeur de recherche. </p><br><h3 id="funkciya-ocenki">  Fonction de notation </h3><br><p>  La somme des scores pour chaque tick avec l'att√©nuation de 2% par tick. </p><br><p>  Le plus gros poids, bien s√ªr, avait un objectif.  Plusieurs choses ont influenc√© son poids: </p><br><ul><li>  La distance entre le ballon et le gardien ennemi au moment du but (le plus loin sera le mieux) </li><li>  Coordonn√©e Y du ballon (car en haut du but, il est beaucoup plus difficile de frapper) </li><li>  La vitesse du ballon le long de l'axe Z (qui est dirig√©e vers le but ennemi) </li></ul><br><p>  En m'attaquant, tout est exactement pareil, mais avec le signe oppos√©. </p><br><p>  De plus, pour l'attaquant, le score global d√©pendait: </p><br><ul><li>  Distances du joueur au ballon (pour qu'il court vers le ballon m√™me s'il ne peut pas le frapper) </li><li>  P√©nalit√© pour le saut (ne sauter que si cela rapporte tellement de points qu'ils d√©passeront cette p√©nalit√©) </li><li>  Distances √† la prochaine tic de la simulation du ballon aux adversaires </li><li>  Coordonn√©es de la balle Y (plus elle est √©lev√©e, moins l'ennemi a de chances de l'intercepter) </li><li>  Cosinus de l'angle entre la direction du ballon et le centre du but ennemi </li><li>  Signaler si j'ai touch√© le ballon </li><li>  Drapeau, si l'ennemi a touch√© le ballon </li><li>  Bonus pour la s√©lection de nitro </li></ul><br><p>  En outre, il y avait un petit bonus pour frapper un joueur ennemi.  En fait, c'est arriv√©, mais rarement. </p><br><p>  Pour le gardien de but: </p><br><ul><li>  Bonus pour la distance au ballon, la vitesse du ballon en Z, la position du ballon en Y </li><li>  P√©nalit√© pour le saut </li><li>  P√©nalit√© pour avoir trouv√© le ballon dans la zone devant mon but </li><li>  La distance par rapport aux ennemis et √† mes attaquants a √©t√© prise en compte (pour que la balle s'√©loigne des ennemis, mais si possible, se rapproche de mes attaquants) </li><li>  Et encore quelques petites choses. </li></ul><br><h3 id="machine-learning">  Apprentissage automatique </h3><br><p>  C'√©tait juste un peu dans l'une des branches du git √† titre d'exp√©rience.  Mais il me semble quand m√™me utile de le mentionner.  Je n'ai pas r√©ussi √† me le rappeler (et je ne sais pas ce qui avait du sens). </p><br><p>  En g√©n√©ral, j'ai essay√© de pr√©dire avec son aide si l'ennemi peut intercepter le ballon en fonction des positions et des vitesses de l'ennemi et du ballon.  J'avais pr√©vu de l'utiliser dans la fonction d'√©valuation.  P√©naliser les trajectoires qu'il est possible d'intercepter. </p><br><p>  Mais j'ai tout de suite compris que je ne pouvais pas me permettre non seulement un r√©seau de neurones, mais rien de grave du tout, car cela devrait √™tre fait 80 fois par trajectoire.  Eh bien, m√™me si c'est 40 ou 20, sinon chaque tick est compt√©, mais de toute fa√ßon, je n'avais aucune marge de temps du tout, donc je n'ai m√™me pas envisag√© ces options. </p><br><p>  Voici ce que j'ai fait: </p><br><p>  J'ai couru plusieurs jeux avec un bot modifi√©, dans lequel, lors de la recherche d'une trajectoire, j'ai enregistr√© des donn√©es sur moi-m√™me et le ballon, ainsi qu'un drapeau, si une trajectoire a √©t√© trouv√©e dans laquelle j'intercepte le ballon. </p><br><p>  J'ai consid√©r√© toutes les coordonn√©es relatives au joueur de football.  C'est-√†-dire  Je l'avais toujours dans la coordonn√©e [0,0,0], donc je n'ai gard√© que 10 champs: la position relative du ballon, le vecteur vitesse du ballon, le vecteur vitesse du footballeur, le drapeau d'interception binaire.  J'ai enregistr√© l'ensemble de donn√©es uniquement pour la partie centrale du champ, car  J'ai r√©alis√© que les algorithmes simples ne tireraient pas encore et rendraient compte des conseils. </p><br><p>  Ensuite, j'ai aliment√© ce jeu de donn√©es DecisionTreeClassifier avec max_depth = 7. L'arbre form√© a donn√© une pr√©cision, pour autant que je m'en souvienne, de l'ordre de 90%. </p><br><p>  Ensuite, j'ai export√© l'arborescence vers un ensemble d'if (qui est essentiellement DecisionTree). </p><br><p>  Cela ressemblait √† ceci: </p><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">predict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dude_vel_x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dude_vel_y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dude_vel_z, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_rel_pos_x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_rel_pos_y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_rel_pos_z, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_vel_x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_vel_y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_vel_z)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ball_vel_z &lt;= <span class="hljs-number"><span class="hljs-number">6.4765448570251465</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dude_vel_y &lt;= -<span class="hljs-number"><span class="hljs-number">6.087389945983887</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ball_vel_z &lt;= -<span class="hljs-number"><span class="hljs-number">20.188323974609375</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dude_vel_x &lt;= <span class="hljs-number"><span class="hljs-number">13.032730102539062</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ball_rel_pos_y &lt;= -<span class="hljs-number"><span class="hljs-number">1.1829500198364258</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ball_vel_y &lt;= <span class="hljs-number"><span class="hljs-number">18.906089782714844</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ............................</span></span></code> </pre> <br><p>  √Ä ce stade, j'ai effectu√© les tests, je n'ai vu aucune am√©lioration et j'ai report√© le proc√®s √† plus tard, qui, en raison de mes aventures, n'est jamais arriv√©. </p><br><h3 id="shryodinbag">  Schroedinbag </h3><br><p>  Quelque part apr√®s le premier tour, j'ai attrap√© cet animal rare dans ma maison. </p><br><p>  Qui ne sait pas, c'est un tel bug qu'ils ne trouvent qu'en lisant le code, et l'ayant trouv√©, le d√©veloppeur se demande comment le programme pourrait fonctionner.  Et dans mon cas, elle est √©galement rest√©e dans le top 10. </p><br><p>  En g√©n√©ral, le bug √©tait qu'un constructeur √©tait appel√© dans la fonction de copie du g√®ne, dans lequel un argument facultatif √©tait omis contenant la valeur de ce g√®ne.  En l'absence de cet argument, la valeur a √©t√© choisie au hasard.  Ainsi, en essayant de copier un g√®ne, au lieu d'une copie, il a cr√©√© une nouvelle instance al√©atoire. </p><br><p>  En fait, au lieu de la g√©n√©tique, j'ai eu une recherche al√©atoire, car chaque tick a simplement g√©n√©r√© plusieurs centaines de chemins al√©atoires et s√©lectionn√© le meilleur. </p><br><p>  Apr√®s la correction (consistant √† ajouter 2 caract√®res au code), le jeu est devenu environ 3 fois meilleur. </p><br><h3 id="ritualnye-tancy">  Danse rituelle </h3><br><p>  √Ä un moment donn√©, j'ai remarqu√© que les joueurs rebondissaient parfois sans raison, √©tant loin du ballon, malgr√© la p√©nalit√©. </p><br><p>  L'explication s'est av√©r√©e √™tre telle que j'ai compt√© le moment du saut avec une pr√©cision de 100 microtiques.  Et parfois, il s'est av√©r√© que juste au moment du saut il y avait une collision de la balle avec la barre.  Et selon la pr√©cision du calcul pr√©cis√©ment dans cette coche, la trajectoire propos√©e a conduit √† un objectif ou non. </p><br><p>  En gros, le ballon vole vers le but de l'adversaire et frappe le poteau.  mon footballeur, courant √† l'autre bout du terrain, simule une trajectoire sans saut (avec 1 mikrotik) et voit que le ballon ne touche pas le but. </p><br><p>  Puis une autre trajectoire entre en jeu, avec un saut exactement au moment o√π la balle frappe la barre.  Et puisque je compte une tique avec un saut de 100 Mikrotiks non seulement pour un joueur de football, mais aussi pour une balle, l'angle de rebond calcul√© de la balle diff√®re de l'angle obtenu sur le chemin avec 1 microtik, et il peut arriver que la balle dans cette trajectoire plus pr√©cise tombe dans la porte. </p><br><p>  Et donc, c'est cette trajectoire qui sera s√©lectionn√©e et le bot sautera. </p><br><p>  En g√©n√©ral, en ex√©cutant une danse rituelle avec rebond, les joueurs ont nomm√© un but :) </p><br><h3 id="killer-ficha">  Fonction tueur </h3><br><p>  Elle n'est pas </p><br><h3 id="testirovanie">  Test </h3><br><p>  J'ai conduit des jeux sans fin dans 8 threads (4 sur chaque ordinateur et ordinateur portable).  J'ai choisi le nombre de jeux pour qu'il soit statistiquement significatif. </p><br><p>  Avec une am√©lioration significative de la strat√©gie pourrait √™tre satisfait avec un demi-millier d'objectifs au total, <br>  avec des corrections plus petites, parti pour la nuit, puis le projet de loi est all√© par milliers. </p><br><h3 id="geneticheskiy-podbor-konstant">  S√©lection g√©n√©tique des constantes </h3><br><p>  Je l'ai essay√© avant le premier tour.  Cela ne donne rien parce que pour la g√©n√©tique, vous devez jouer un tournoi √† partir d'un grand nombre de jeux. </p><br><p>  J'ai essay√© de jouer √† 100 000 ticks, mais ce n'√©tait pas suffisant.  Avec une petite diff√©rence de force (et g√©n√©ralement lors du choix des constantes, c'est exactement le cas), le gagnant par 100 000 ticks d√©pend trop du cas.  Vous devez jouer beaucoup plus pour √™tre s√ªr du gagnant.  Et je ne pouvais pas me permettre de quitter la s√©lection pour un jour ou plus, alors j'ai refus√© cette aventure. </p><br><h1 id="v-zaklyuchenie">  En conclusion </h1><br><p>  Remerciements traditionnels aux organisateurs.  La t√¢che √©tait int√©ressante.  Dommage que je sois juste oblig√© de rater pr√®s de la moiti√© du championnat et n'ai vraiment rien fait pour le nitro ou pour trois joueurs. </p><br><p>  En cons√©quence, jusqu'√† la toute fin, j'ai regard√© dans le bac √† sable comment ma strat√©gie gagne en mode 2x2 sans nitro avec un score de 13: 2 contre n'importe quel Mr.Smile, qui a pris la 3e place en finale, et apr√®s quelques matchs, il perd 12: 2 en mode 3x3 avec nitro :) </p><br><p>  Et bien s√ªr, la vid√©o de mon visualiseur propri√©taire: </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/kh/hx/om/khhxombmg6eo4otune-_vdhdhbu.jpeg"></a> </p><br><p>  Vous seul devrez probablement dire adieu √† ce visualiseur lors de futurs championnats. <br>  Pour chaque fois, je suis de plus en plus convaincu que si vous postulez pour des places normales, la seule option est d'√©crire ... </p><br><p><img src="https://habrastorage.org/webt/gl/zj/1w/glzj1w_lztl_mhea9rqbs9rb5qq.jpeg"></p><br><p>  ... eh bien, vous obtenez le point. </p><br><p>  Fatigu√© √† chaque fois de se reposer sur la lenteur de Java et de r√©duire la force de la strat√©gie pour respecter le temps imparti. </p><br><p>  J'esp√®re que quelqu'un a trouv√© quelque chose d'int√©ressant ou d'utile dans cet opus √† moi avec une note de caract√®re autobiographique :) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr440574/">https://habr.com/ru/post/fr440574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr440562/index.html">Windows Phone - TOUT, c'est encore ou encore</a></li>
<li><a href="../fr440564/index.html">R√©seau neuronal GPT-2 d'OpenAI. D√©marrage rapide</a></li>
<li><a href="../fr440566/index.html">Acc√©l√©rer sans entrave ou d√©couvrir SIMD</a></li>
<li><a href="../fr440568/index.html">Nous √©crivons une application d'apprentissage en Go et Javascript pour √©valuer les rendements r√©els des actions. Partie 2 - Tester le backend</a></li>
<li><a href="../fr440570/index.html">Cartes d'ombres r√©fl√©chissantes: Partie 2 - Mise en ≈ìuvre</a></li>
<li><a href="../fr440576/index.html">Modifications importantes apport√©es √† CTE dans PostgreSQL 12</a></li>
<li><a href="../fr440582/index.html">Les voitures √©lectriques sont-elles tir√©es vers le bas de la soci√©t√© automobile?</a></li>
<li><a href="../fr440584/index.html">Quel est le probl√®me avec le Raspberry Pi</a></li>
<li><a href="../fr440586/index.html">Exonum Consensus: Comment √ßa marche</a></li>
<li><a href="../fr440588/index.html">Le MIT a appris √† transmettre le son avec un laser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>