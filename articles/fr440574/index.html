<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚴🏼 👩🏻‍🤝‍👨🏾 👨‍👦‍👦 Russian AI Cup 2018, histoire 9 places 👨‍👨‍👧 🚣 🤳🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Alors 


 Mon nom, comme l'année dernière, est Andrei Rybalka, mais cette fois, j'ai 33 ans. Et, puisque j'étais dans le top 10, j'ai décidé de partag...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Russian AI Cup 2018, histoire 9 places</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440574/"><h1 id="itak">  Alors </h1><br><p>  Mon nom, comme l'année dernière, est Andrei Rybalka, mais cette fois, j'ai 33 ans. Et, puisque j'étais dans le top 10, j'ai décidé de partager à nouveau mon approche pour écrire un bot de jeu pour la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Russian AI Cup 2018</a> . </p><br><p>  Cette fois, la tâche était le football.  La tâche elle-même rappelait quelque peu celle de l'IRAC 2014, quand il s'agissait du hockey, mais la solution était complètement différente. </p><br><p>  Cette fois, le monde était tridimensionnel et cette tridimensionnalité était pleinement utilisée.  Le jeu lui-même rappelait le plus la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rocket League</a> . </p><br><p>  Je ne vais pas ennuyer la partie introductive, il est plus facile de montrer à quoi cela ressemblait.  Vous pouvez regarder les jeux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le site</a> ou sur la vidéo: </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/6g/jb/hf/6gjbhf4gdy_4qqrw74huttfudvq.jpeg"></a> </p><a name="habracut"></a><br><p>  Pour que la vie ne nous semble pas trop douce, les développeurs, en plus du non-déterminisme du monde du jeu, ont également divisé le tick du jeu en 100 subwoofers, ce qui a initialement mis fin à une simulation précise pour la plupart des participants, et encore plus pour moi, ayant l'intention d'écrire un bot en Java lent. </p><br><p>  Aussi, je dois dire que le championnat est divisé en tours, ce qui serait probablement plus correct d'appeler des tours. </p><br><h3 id="kratko-o-turnirnoy-sisteme">  En bref sur le système de tournois </h3><br><p>  Pour commencer, 2 semaines sont accordées pour le développement.  Puis le premier tour passe.  Les 300 meilleurs vont plus loin. </p><br><p>  Après le tour, les règles du jeu changent (en particulier, du nitro est ajouté au jeu) et 2 autres semaines sont accordées, après quoi le deuxième tour passe. </p><br><p>  Ensuite, les règles sont à nouveau compliquées (le troisième joueur est ajouté), une autre semaine est donnée et nous jouons la finale. </p><br><p>  Mais ce n'est pas la fin.  Après les finales, il y a une autre semaine, à la fin de laquelle le bac à sable s'arrête simplement, et les 6 meilleurs, hors vainqueurs des finales, sont également décernés.  La différence fondamentale entre la finale du bac à sable et la finale du championnat est que dans le bac à sable, les jeux sont créés dans un format aléatoire, et pas seulement dans le format de la manche en cours. </p><br><h1 id="istorii-uchastiya">  Histoires de participation </h1><br><p>  La partie technique sera plus faible.  Pour qui l'histoire n'a pas d'intérêt, vous pouvez faire défiler vers le bas jusqu'à ce qu'elle devienne bonne. </p><br><h3 id="pervyy-raund">  Premier tour </h3><br><p>  Il a commencé, comme la plupart, par une semaine de beta.  J'ai passé beaucoup de temps, plus de 4 heures chaque soir. <br>  Avant de remplir la première version, il a fallu plusieurs itérations <br>  <em>nous codons jusqu'à ce que nous commencions à battre la version précédente - nous collectons - nous considérons la version actuelle de la précédente - nous répétons</em> . </p><br><p>  Je n'étais pas pressé avec le premier remplissage et c'est arrivé quelques jours avant la manche.  Et, puisque, jusqu'à présent, mon bot n'a joué avec personne, je ne savais pas dans quel genre de monde j'étais et quelles positions dans le classement je pouvais revendiquer.  Quand j'ai vu que j'avais déjà remporté plus de 100 matchs de suite sans une seule défaite, je me suis calmé. </p><br><p>  En général, la première défaite que j'ai subie était, semble-t-il, à la 12e place, dans le temps imparti, et le premier match perdu de suite était déjà dans le top 10. </p><br><p>  Bref, je me suis rendu compte que j'avais des chances d'entrer dans le deuxième tour, où va le top 300. <br>  Par conséquent, je n'ai pas poursuivi la position et je n'ai rien inondé d'autre pour le tour, mais j'ai simplement continué à travailler. </p><br><p>  À ce moment-là, j'ai vu qu'il y avait encore beaucoup d'espace à améliorer sans connecter de nitro (qui est apparu après le 1er tour), alors je me suis concentré sur la partie principale de la stratégie, réalisant qu'avant le deuxième tour, il y aurait plus de 2 semaines ou plus et j'aurais le temps de fixer le nitro. </p><br><h3 id="vtoroy-raund">  Deuxième tour </h3><br><p>  La première semaine, je programmais activement, mais je n'ai toujours pas connecté nitro.  Je voulais le faire la deuxième semaine.  Mais tout s'est passé différemment, car à la fin de la première semaine, j'avais contracté une pneumonie.  Je n'ai pas pu programmer, donc je viens de télécharger ce que c'était, et, on peut dire, la participation active au championnat pour moi à cet endroit était terminée. </p><br><p>  Au cours des 3 prochaines semaines avant la fin du championnat, j'ai travaillé sur une stratégie d'un montant de peut-être 20 heures. </p><br><p>  En conséquence, au deuxième tour, mon bot, en principe, ne savait pas qu'il y avait du nitro dans le jeu, mais a quand même pris la 16e place. </p><br><h3 id="final">  Finale </h3><br><p>  En finale, un troisième joueur a été ajouté. </p><br><p>  J'ai écrit en Java lent, et non en C ++, car 7 personnes sur 8 sont plus élevées que moi dans le classement, et avant cela, mon bot tombait souvent en timeout, donc avec l'avènement du troisième joueur, il a commencé à tomber dans 100% des jeux.  Heureusement, les jeux dans le bac à sable sont créés dans un format aléatoire, donc je <br>  perdu seulement tous les trois matchs et donc pas trop volé.  Il semble être tombé à la 18e place. </p><br><p>  Sauf pour la programmation, l'édition des coefficients dans la fonction d'évaluation et l'exécution des tests, puis pour la première fois, après le début de la maladie, je me suis assis au bot le soir de la veille de la finale.  Il a ajouté une nitro très simple dirigée strictement vers le haut pour que deux attaquants arrêtent de courir au même point et entrent en collision là-bas, et réduisent tout ce qu'il pouvait pour un jeu 3x3, à partir de la profondeur de rendu et se terminant avec la précision de simulation, seul le bot n'est pas mort par timeout. <br>  Sous cette forme, il a joué la finale. </p><br><p>  Dans l'intervalle entre les deux moitiés de la finale, je me suis de nouveau assis dans le bot et j'ai passé quelques bonnes heures 10. Les changements concernaient pour la plupart la sélection dynamique des coefficients, l'interruption précoce de la génétique, etc.  En général, je cherchais un équilibre entre la précision et la profondeur et la vitesse des erreurs de calcul. <br>  En plus de la lutte contre la vitesse, il a apporté quelques modifications supplémentaires: </p><br><ul><li>  Envoyé un attaquant distant (par rapport au ballon) à un point au milieu entre le ballon et le but de l'adversaire </li><li>  J'ai un peu fixé nitro (la description se fera dans la partie technique).  C'était encore extrêmement simple, mais il est devenu beaucoup plus efficace. </li></ul><br><p>  Total, après avoir passé les tests et vu le score de 395: 254 par rapport à la version précédente, je me suis calmé.  Cela m'a permis de prendre la 9e place en finale. </p><br><h3 id="final-pesochnicy">  Sandbox Finale </h3><br><p>  J'ai continué à faire mal et je n'ai pas travaillé sur le bot pendant la majeure partie de la semaine.  La veille de la fin, j'ai vu que plusieurs personnes téléchargeaient de nouvelles versions, qui gagnent souvent contre moi et peuvent jeter des bacs à sable hors des prix.  J'ai donc passé quelques heures de plus. </p><br><p>  Le seul changement majeur est que j'ai déterré ma branche dans Git il y a trois semaines, dans laquelle j'ai eu une simulation du mouvement de l'ennemi en utilisant mon algorithme simplifié.  A cette époque, cela fonctionnait mal, mais je l'ai rappelé, j'ai effectué des tests, j'ai vu <br>  qui surpasse la version précédente a presque doublé et inondé.  Au total, au moment de l'arrêt, j'étais à la 10ème place du classement général, ce qui correspond à la 4ème en finale du bac à sable. </p><br><h1 id="kak-eto-vsyo-rabotaet-tehnicheskaya-chast">  Comment tout cela fonctionne (partie technique) </h1><br><p>  Je m'excuse à l'avance en cas d'inexactitudes dans la terminologie.  De plus, j'écris de mémoire, il est donc possible que quelque part je ne décrive pas la version finale. </p><br><p>  Les algorithmes génétiques sont donc au cœur.  Le chromosome se compose de plusieurs gènes: </p><br><ul><li>  Nombre fractionnaire dans la plage -PI..PI, spécifiant la direction du mouvement </li><li>  Un entier compris entre 0 et 10 qui spécifie le nombre de répétitions de cette action </li><li>  Nombre fractionnaire de 0 à 1. Si la valeur est supérieure à un certain seuil, faites un saut </li></ul><br><p>  Le génotype peut comprendre un nombre différent de chromosomes, mais de telle manière que le nombre total d'actions (y compris les répétitions) est de 40. </p><br><p>  Au départ, je crée plusieurs dizaines de génotypes aléatoires.  J'y ajoute: </p><br><ul><li>  La trajectoire à droite sur le ballon </li><li>  Trajectoires directes dans toutes les directions, seulement 10 pièces avec un décalage de 36 degrés </li><li>  Un génotype qui ne fait tout simplement rien (sans lui, le bot court toujours quelque part, même s'il se trouve déjà au point optimal) </li><li>  Meilleur génotype de la tique précédente </li></ul><br><p>  Ensuite, tout est simulé et exécuté via la fonction d'évaluation.  N meilleurs génotypes "survivent" et sont clones M fois avec des mutations.  Lors de la mutation, chaque gène change dans une plage donnée avec une probabilité de 10%.  Eh bien, cela a été répété depuis plusieurs générations. <br>  Il n'y a pas de croisement, dans ce problème je n'y vois aucun sens. </p><br><p>  Au total, le nombre maximum possible de trajectoires par tick par joueur de football était d'environ 800, mais en fait, dans la plupart des cas, il était beaucoup moins, car  dans certains cas (par exemple, lorsque dans un avenir proche nous ne pourrons définitivement pas toucher le ballon), le mouvement des joueurs a été remplacé par de simples heuristiques.  De plus, N, M et le nombre de générations dépendaient de la situation sur le terrain.  Tout d'abord, de la distance au ballon.  De plus, l'erreur de calcul est interrompue avant la date prévue (mais pas avant la 5e génération) si une trajectoire avec une estimation acceptable est trouvée. </p><br><h3 id="makro">  Macro </h3><br><p>  Le gardien court jusqu'au point devant le centre du but.  Mes tests ont montré qu'il était préférable pour moi de jouer en étant devant le but, et non à l'intérieur, comme la plupart des joueurs du haut. </p><br><p>  La position du point a dévié du centre en fonction de plusieurs facteurs: la position et la direction du vol du ballon, le point où le ballon a frappé mon but, si un but est prévu, l'emplacement de l'adversaire attaquant le plus proche, etc. </p><br><p>  Si le ballon est du côté de l'adversaire et vole vers son but, on peut opter pour le nitro. </p><br><p>  Si mon gardien de but peut frapper le ballon plus tôt que mon attaquant (plus quelques conditions supplémentaires), alors l'attaquant ignore le ballon et court jusqu'à un point au milieu entre le ballon et le but de l'adversaire.  Je suis passé par beaucoup d'options, où exactement lui courir.  Dans mon cas, celui-ci a fonctionné le mieux. </p><br><p>  Sinon, si le ballon est trop loin, l'attaquant court en ligne droite jusqu'au point de contact le plus proche du ballon avec le sol, dans lequel il peut intercepter le ballon (si nous n'avons pas le temps pour le premier point de contact - vérifier le suivant, etc.) </p><br><p>  Sinon (lorsque le ballon atteint), l'attaquant court à l'endroit où la fonction d'évaluation lui dit.  Oui, et aussi, si le nitro se trouve à proximité et que nous pouvons le ramasser, nous le sélectionnons. </p><br><p>  Dans un match 3x3, le deuxième attaquant est plus susceptible de viser le ballon et avec moins de course en avant, s'attendant à une passe du gardien de but.  Mais s'il fonctionne toujours, alors un autre point est choisi - plus près de la ligne médiane. </p><br><p>  De plus, chaque tick simulait une fois la balle 100 ticks en avant avec 100 microtiques (avec mise en cache). </p><br><p>  Cette trajectoire a été utilisée dans de nombreux endroits.  Par exemple: </p><br><ul><li>  Pour déterminer les points de contact de la balle avec le sol </li><li>  Pour savoir si le ballon menace mon objectif et si le gardien de but doit passer en mode simulation </li></ul><br><p>  La même trajectoire exacte a été utilisée dans la simulation des trajectoires des joueurs, afin de ne pas compter la balle à chaque fois.  Mais seulement jusqu'à la première collision du ballon avec n'importe quel joueur de football. </p><br><p>  Au fait, écrire Footballist était paresseux, les mots Player, Robot étaient réservés par stratégie, <br>  donc ma classe wrapper s'appelait simplement Mec :) </p><br><h3 id="simulyaciya">  La simulation </h3><br><p>  Dans la plupart des cas, il est allé avec un microtique, mais dans certaines situations, il est passé en mode précis avec un grand nombre de microtiques (au début, il était de 100, puis il a été réduit à 50 dans un jeu 2x2, car les tests ont montré que la différence de résultats était dans la marge d'erreur, et à 10 en 3x3, car sinon volé dans les délais d'attente). </p><br><p>  En mode précis, j'ai basculé soit au moment du rebond, soit en étant si proche de la balle qu'une collision au prochain tick est possible.  De plus, il y avait aussi une masse de petites béquilles, de hacks, d'optimisations, dans lesquelles je ne comprendrai pas moi-même. </p><br><p>  Par exemple, le ballon volant était toujours simulé avec 1 Mikrotik, mais si après le prochain Mikrotik j'ai vu qu'il y avait eu une collision, il a reculé à la position précédente et l'a simulée à nouveau avec une plus grande précision. </p><br><p>  De plus, j'ai également fait semblant d'être d'autres joueurs (les miens et les autres) s'ils étaient dans les airs (et donc leur trajectoire est plus facile à prévoir) ou s'ils étaient proches du ballon.  Pour les adversaires, la version finale utilisait une version simplifiée de ma propre stratégie de prise de décision, qui était lancée toutes les 5 ticks (le plus souvent elle ne permettait pas la vitesse). </p><br><p>  Lors de la simulation de chaque personnage, j'ai calculé moi-même, la balle et les autres joueurs de football 40 ticks en avant (ma limite sur le nombre d'actions dans le génotype), puis j'ai simulé le même nombre de ticks sur une seule balle. </p><br><h3 id="nitro">  Nitro </h3><br><p>  Simple à indécent. </p><br><p>  Dans la version finale, le nitro est toujours activé s'il l'est, si le joueur est en l'air et s'il n'a pas touché le ballon au cours des dernières tiques. </p><br><p>  Au début, j'ai toujours dirigé la nitro directement vers le haut, mais j'ai ensuite essayé d'expérimenter et l'option d'aller exactement au centre de la balle fonctionnait le mieux.  J'ai aussi essayé des options pour que la direction du nitro soit choisie par la génétique. </p><br><p>  Cela a fonctionné bien pire.  Peut-être en raison d'un manque de profondeur de recherche. </p><br><h3 id="funkciya-ocenki">  Fonction de notation </h3><br><p>  La somme des scores pour chaque tick avec l'atténuation de 2% par tick. </p><br><p>  Le plus gros poids, bien sûr, avait un objectif.  Plusieurs choses ont influencé son poids: </p><br><ul><li>  La distance entre le ballon et le gardien ennemi au moment du but (le plus loin sera le mieux) </li><li>  Coordonnée Y du ballon (car en haut du but, il est beaucoup plus difficile de frapper) </li><li>  La vitesse du ballon le long de l'axe Z (qui est dirigée vers le but ennemi) </li></ul><br><p>  En m'attaquant, tout est exactement pareil, mais avec le signe opposé. </p><br><p>  De plus, pour l'attaquant, le score global dépendait: </p><br><ul><li>  Distances du joueur au ballon (pour qu'il court vers le ballon même s'il ne peut pas le frapper) </li><li>  Pénalité pour le saut (ne sauter que si cela rapporte tellement de points qu'ils dépasseront cette pénalité) </li><li>  Distances à la prochaine tic de la simulation du ballon aux adversaires </li><li>  Coordonnées de la balle Y (plus elle est élevée, moins l'ennemi a de chances de l'intercepter) </li><li>  Cosinus de l'angle entre la direction du ballon et le centre du but ennemi </li><li>  Signaler si j'ai touché le ballon </li><li>  Drapeau, si l'ennemi a touché le ballon </li><li>  Bonus pour la sélection de nitro </li></ul><br><p>  En outre, il y avait un petit bonus pour frapper un joueur ennemi.  En fait, c'est arrivé, mais rarement. </p><br><p>  Pour le gardien de but: </p><br><ul><li>  Bonus pour la distance au ballon, la vitesse du ballon en Z, la position du ballon en Y </li><li>  Pénalité pour le saut </li><li>  Pénalité pour avoir trouvé le ballon dans la zone devant mon but </li><li>  La distance par rapport aux ennemis et à mes attaquants a été prise en compte (pour que la balle s'éloigne des ennemis, mais si possible, se rapproche de mes attaquants) </li><li>  Et encore quelques petites choses. </li></ul><br><h3 id="machine-learning">  Apprentissage automatique </h3><br><p>  C'était juste un peu dans l'une des branches du git à titre d'expérience.  Mais il me semble quand même utile de le mentionner.  Je n'ai pas réussi à me le rappeler (et je ne sais pas ce qui avait du sens). </p><br><p>  En général, j'ai essayé de prédire avec son aide si l'ennemi peut intercepter le ballon en fonction des positions et des vitesses de l'ennemi et du ballon.  J'avais prévu de l'utiliser dans la fonction d'évaluation.  Pénaliser les trajectoires qu'il est possible d'intercepter. </p><br><p>  Mais j'ai tout de suite compris que je ne pouvais pas me permettre non seulement un réseau de neurones, mais rien de grave du tout, car cela devrait être fait 80 fois par trajectoire.  Eh bien, même si c'est 40 ou 20, sinon chaque tick est compté, mais de toute façon, je n'avais aucune marge de temps du tout, donc je n'ai même pas envisagé ces options. </p><br><p>  Voici ce que j'ai fait: </p><br><p>  J'ai couru plusieurs jeux avec un bot modifié, dans lequel, lors de la recherche d'une trajectoire, j'ai enregistré des données sur moi-même et le ballon, ainsi qu'un drapeau, si une trajectoire a été trouvée dans laquelle j'intercepte le ballon. </p><br><p>  J'ai considéré toutes les coordonnées relatives au joueur de football.  C'est-à-dire  Je l'avais toujours dans la coordonnée [0,0,0], donc je n'ai gardé que 10 champs: la position relative du ballon, le vecteur vitesse du ballon, le vecteur vitesse du footballeur, le drapeau d'interception binaire.  J'ai enregistré l'ensemble de données uniquement pour la partie centrale du champ, car  J'ai réalisé que les algorithmes simples ne tireraient pas encore et rendraient compte des conseils. </p><br><p>  Ensuite, j'ai alimenté ce jeu de données DecisionTreeClassifier avec max_depth = 7. L'arbre formé a donné une précision, pour autant que je m'en souvienne, de l'ordre de 90%. </p><br><p>  Ensuite, j'ai exporté l'arborescence vers un ensemble d'if (qui est essentiellement DecisionTree). </p><br><p>  Cela ressemblait à ceci: </p><br><pre><code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">predict</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dude_vel_x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dude_vel_y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> dude_vel_z, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_rel_pos_x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_rel_pos_y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_rel_pos_z, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_vel_x, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_vel_y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ball_vel_z)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ball_vel_z &lt;= <span class="hljs-number"><span class="hljs-number">6.4765448570251465</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dude_vel_y &lt;= -<span class="hljs-number"><span class="hljs-number">6.087389945983887</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ball_vel_z &lt;= -<span class="hljs-number"><span class="hljs-number">20.188323974609375</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dude_vel_x &lt;= <span class="hljs-number"><span class="hljs-number">13.032730102539062</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ball_rel_pos_y &lt;= -<span class="hljs-number"><span class="hljs-number">1.1829500198364258</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ball_vel_y &lt;= <span class="hljs-number"><span class="hljs-number">18.906089782714844</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ............................</span></span></code> </pre> <br><p>  À ce stade, j'ai effectué les tests, je n'ai vu aucune amélioration et j'ai reporté le procès à plus tard, qui, en raison de mes aventures, n'est jamais arrivé. </p><br><h3 id="shryodinbag">  Schroedinbag </h3><br><p>  Quelque part après le premier tour, j'ai attrapé cet animal rare dans ma maison. </p><br><p>  Qui ne sait pas, c'est un tel bug qu'ils ne trouvent qu'en lisant le code, et l'ayant trouvé, le développeur se demande comment le programme pourrait fonctionner.  Et dans mon cas, elle est également restée dans le top 10. </p><br><p>  En général, le bug était qu'un constructeur était appelé dans la fonction de copie du gène, dans lequel un argument facultatif était omis contenant la valeur de ce gène.  En l'absence de cet argument, la valeur a été choisie au hasard.  Ainsi, en essayant de copier un gène, au lieu d'une copie, il a créé une nouvelle instance aléatoire. </p><br><p>  En fait, au lieu de la génétique, j'ai eu une recherche aléatoire, car chaque tick a simplement généré plusieurs centaines de chemins aléatoires et sélectionné le meilleur. </p><br><p>  Après la correction (consistant à ajouter 2 caractères au code), le jeu est devenu environ 3 fois meilleur. </p><br><h3 id="ritualnye-tancy">  Danse rituelle </h3><br><p>  À un moment donné, j'ai remarqué que les joueurs rebondissaient parfois sans raison, étant loin du ballon, malgré la pénalité. </p><br><p>  L'explication s'est avérée être telle que j'ai compté le moment du saut avec une précision de 100 microtiques.  Et parfois, il s'est avéré que juste au moment du saut il y avait une collision de la balle avec la barre.  Et selon la précision du calcul précisément dans cette coche, la trajectoire proposée a conduit à un objectif ou non. </p><br><p>  En gros, le ballon vole vers le but de l'adversaire et frappe le poteau.  mon footballeur, courant à l'autre bout du terrain, simule une trajectoire sans saut (avec 1 mikrotik) et voit que le ballon ne touche pas le but. </p><br><p>  Puis une autre trajectoire entre en jeu, avec un saut exactement au moment où la balle frappe la barre.  Et puisque je compte une tique avec un saut de 100 Mikrotiks non seulement pour un joueur de football, mais aussi pour une balle, l'angle de rebond calculé de la balle diffère de l'angle obtenu sur le chemin avec 1 microtik, et il peut arriver que la balle dans cette trajectoire plus précise tombe dans la porte. </p><br><p>  Et donc, c'est cette trajectoire qui sera sélectionnée et le bot sautera. </p><br><p>  En général, en exécutant une danse rituelle avec rebond, les joueurs ont nommé un but :) </p><br><h3 id="killer-ficha">  Fonction tueur </h3><br><p>  Elle n'est pas </p><br><h3 id="testirovanie">  Test </h3><br><p>  J'ai conduit des jeux sans fin dans 8 threads (4 sur chaque ordinateur et ordinateur portable).  J'ai choisi le nombre de jeux pour qu'il soit statistiquement significatif. </p><br><p>  Avec une amélioration significative de la stratégie pourrait être satisfait avec un demi-millier d'objectifs au total, <br>  avec des corrections plus petites, parti pour la nuit, puis le projet de loi est allé par milliers. </p><br><h3 id="geneticheskiy-podbor-konstant">  Sélection génétique des constantes </h3><br><p>  Je l'ai essayé avant le premier tour.  Cela ne donne rien parce que pour la génétique, vous devez jouer un tournoi à partir d'un grand nombre de jeux. </p><br><p>  J'ai essayé de jouer à 100 000 ticks, mais ce n'était pas suffisant.  Avec une petite différence de force (et généralement lors du choix des constantes, c'est exactement le cas), le gagnant par 100 000 ticks dépend trop du cas.  Vous devez jouer beaucoup plus pour être sûr du gagnant.  Et je ne pouvais pas me permettre de quitter la sélection pour un jour ou plus, alors j'ai refusé cette aventure. </p><br><h1 id="v-zaklyuchenie">  En conclusion </h1><br><p>  Remerciements traditionnels aux organisateurs.  La tâche était intéressante.  Dommage que je sois juste obligé de rater près de la moitié du championnat et n'ai vraiment rien fait pour le nitro ou pour trois joueurs. </p><br><p>  En conséquence, jusqu'à la toute fin, j'ai regardé dans le bac à sable comment ma stratégie gagne en mode 2x2 sans nitro avec un score de 13: 2 contre n'importe quel Mr.Smile, qui a pris la 3e place en finale, et après quelques matchs, il perd 12: 2 en mode 3x3 avec nitro :) </p><br><p>  Et bien sûr, la vidéo de mon visualiseur propriétaire: </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/webt/kh/hx/om/khhxombmg6eo4otune-_vdhdhbu.jpeg"></a> </p><br><p>  Vous seul devrez probablement dire adieu à ce visualiseur lors de futurs championnats. <br>  Pour chaque fois, je suis de plus en plus convaincu que si vous postulez pour des places normales, la seule option est d'écrire ... </p><br><p><img src="https://habrastorage.org/webt/gl/zj/1w/glzj1w_lztl_mhea9rqbs9rb5qq.jpeg"></p><br><p>  ... eh bien, vous obtenez le point. </p><br><p>  Fatigué à chaque fois de se reposer sur la lenteur de Java et de réduire la force de la stratégie pour respecter le temps imparti. </p><br><p>  J'espère que quelqu'un a trouvé quelque chose d'intéressant ou d'utile dans cet opus à moi avec une note de caractère autobiographique :) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr440574/">https://habr.com/ru/post/fr440574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr440562/index.html">Windows Phone - TOUT, c'est encore ou encore</a></li>
<li><a href="../fr440564/index.html">Réseau neuronal GPT-2 d'OpenAI. Démarrage rapide</a></li>
<li><a href="../fr440566/index.html">Accélérer sans entrave ou découvrir SIMD</a></li>
<li><a href="../fr440568/index.html">Nous écrivons une application d'apprentissage en Go et Javascript pour évaluer les rendements réels des actions. Partie 2 - Tester le backend</a></li>
<li><a href="../fr440570/index.html">Cartes d'ombres réfléchissantes: Partie 2 - Mise en œuvre</a></li>
<li><a href="../fr440576/index.html">Modifications importantes apportées à CTE dans PostgreSQL 12</a></li>
<li><a href="../fr440582/index.html">Les voitures électriques sont-elles tirées vers le bas de la société automobile?</a></li>
<li><a href="../fr440584/index.html">Quel est le problème avec le Raspberry Pi</a></li>
<li><a href="../fr440586/index.html">Exonum Consensus: Comment ça marche</a></li>
<li><a href="../fr440588/index.html">Le MIT a appris à transmettre le son avec un laser</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>