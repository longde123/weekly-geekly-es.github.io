<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõÄüèº ‚ôâÔ∏è üòí React Native - Application et critique üà∂ üê≥ üí£</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Le plus souvent, lors du choix de ce langage, le d√©veloppement d'une application pour deux plates-formes devrait prendre la moiti√© du temps que le d√©v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>React Native - Application et critique</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/468901/"><p>  Le plus souvent, lors du choix de ce langage, le d√©veloppement d'une application pour deux plates-formes devrait prendre la moiti√© du temps que le d√©veloppement de deux applications.  Mais au final, il s'av√®re que le d√©veloppement prend autant, sinon plus, √† cause des difficult√©s cach√©es sous l'√©clat ext√©rieur et le marketing.  Nous parlerons de certaines des difficult√©s similaires que nous avons rencontr√©es au cours des derniers mois de travail avec React Native. </p><a name="habracut"></a><br><p>  React Native adapte Javascript pour le d√©veloppement mobile.  Ceci est r√©alis√© par le fait qu'il utilise plusieurs collecteurs pour construire des projets - Metro Bundler, qui interpr√®te le code JS et repr√©sente les ressources et le collecteur du syst√®me cible.  Dans notre cas, c'√©tait un gradle pour Android.  En th√©orie, l'application React Native devrait d√©marrer tout simplement.  La commande react-native run-android active Metro Bundler et cr√©e l'application pour tous les appareils et √©mulateurs Android connect√©s. </p><br><p> En r√©alit√©, il s'est av√©r√© que m√™me √† ce stade, il y a des difficult√©s.  Une erreur ¬´Impossible de t√©l√©charger le bundle JS¬ª est constamment apparue sur notre projet, ce qui signifie que le bundler n'a pas pu traduire le code en natif.  Comme il s'est av√©r√© plus tard, car il n'a pas commenc√©.  StackOverflow a confirm√© la conjecture et a sugg√©r√© que vous devez ex√©cuter bundler dans un thread s√©par√© en utilisant la commande start native.  Cela vous permet de red√©marrer bundler uniquement si package.json a chang√©, car la proc√©dure ne ralentit pas beaucoup le d√©veloppement. </p><br><p>  <em>Package.json</em> est un fichier contenant un ensemble de modules externes pour l'application.  Sur npmjs.com, il existe un grand nombre de biblioth√®ques diff√©rentes pour React Native, √©tendant les fonctionnalit√©s et simplifiant le d√©veloppement.  De nombreuses biblioth√®ques (par exemple, Firebase) utilisent des fonctions natives et doivent donc √™tre associ√©es directement au code natif.  Pour ce faire, utilisez la commande react-native link &lt;library-name&gt;, qui doit configurer ces relations avec le code natif. </p><br><p>  √âtant donn√© que toutes les biblioth√®ques sont √©crites √† des moments diff√©rents, elles utilisent diff√©rentes versions du SDK et n√©cessitent une approche diff√©rente.  Il arrive parfois que les biblioth√®ques soient incompatibles entre elles, ou que la derni√®re version de la biblioth√®que soit exp√©rimentale, et les d√©veloppeurs eux-m√™mes conseillent de r√©trograder vers l'avant-derni√®re.  Tr√®s souvent, le lien ne configure pas toutes les d√©pendances requises.  Donc, pour la base de feu susmentionn√©e, vous devez ajouter de nombreuses biblioth√®ques suppl√©mentaires en code natif, connecter divers r√©f√©rentiels externes, modifier mainApplication.java (et cela n'est valable que pour Android!).  Pour Firebase, il existe une instruction assez compr√©hensible pour effectuer ces actions, mais pour d'autres biblioth√®ques, elle n'est pas toujours pr√©sente. </p><br><p>  Une fois les connexions avec le code natif configur√©es, vous pouvez cr√©er le projet dans l'espoir que la biblioth√®que connect√©e fonctionnera.  Lors de l'assemblage, il convient de se rappeler que si vous obtenez une erreur, vous devez vous assurer qu'elle s'est produite pr√©cis√©ment √† cause de vos actions, et non √† cause d'une erreur de collecteur.  Pour une confiance totale, vous devez effectuer la s√©quence d'actions suivante: </p><br><pre><code class="plaintext hljs">rmdir node_modules /s /q &amp;&amp; npm cache clean - force &amp;&amp; npm i</code> </pre> <br><p>  Cette commande supprimera le dossier node_modules puis le rechargera.  C'est l'une des t√¢ches les plus longues, il vaut donc la peine de l'utiliser extr√™mement rarement.  Sur certains projets, node_modules peut occuper jusqu'√† plusieurs gigaoctets sur le disque dur, et donc la r√©installation prendra du temps. </p><br><pre> <code class="plaintext hljs">rmdir android/app/build /s /q</code> </pre> <br><p>  Pendant le d√©veloppement, il a √©t√© remarqu√© que la construction souvent infructueuse est une cons√©quence du fait que le collecteur ne peut pas cr√©er (ou supprimer) un dossier √† partir du r√©pertoire de d√©bogage.  Cette action r√©sout le probl√®me selon lequel React ne peut pas supprimer le dossier par lui-m√™me.  Mais en m√™me temps, g√©n√©rer √† nouveau des fichiers pour ce dossier prendra du temps suppl√©mentaire. </p><br><pre> <code class="plaintext hljs">react-native start-reset-cache</code> </pre> <br><p>  Lancez Metro Bundler.  Cet onglet doit rester ouvert tout au long du processus de d√©bogage.  Si une erreur se produit, le journal des erreurs peut appara√Ætre ici.  Tr√®s probablement, si une erreur se produit, ce processus se terminera et devra √™tre red√©marr√© √† nouveau. </p><br><pre> <code class="plaintext hljs">react-native run-android</code> </pre> <br><p>  Installez l'application sur un appareil ou un √©mulateur connect√©.  La plupart des erreurs de build se produisent ici, et certaines sont compr√©hensibles, mais certaines sont tout √† fait irrationnelles et sont "corrig√©es" en red√©marrant l'ensemble du processus. </p><br><p>  Imaginez le processus de construction avec une s√©quence de commandes pour un projet (ayant d√©j√† realm, redux, react-navigation, une dizaine de biblioth√®ques suppl√©mentaires) apr√®s avoir connect√© Firebase. </p><br><pre> <code class="plaintext hljs">react-native start react-native run-android &gt;&gt;    debug react-native run-android &gt;&gt; , metro bundler  react-native start react-native run-android &gt;&gt;    debug react-native run-android &gt;&gt;  !  metro bundler ,   JS-   react-native start &gt;&gt;   restart         - </code> </pre><br><p>  Inutile de dire que cela prend vraiment du temps?  Et ce n'est pas un processus unique: au moment d√©crit, cette proc√©dure √©tait requise apr√®s presque chaque modification du code du programme.  Avec chaque nouvelle biblioth√®que, le projet devient de moins en moins stable, et ce processus peut changer, le plus souvent pour le pire.  Le d√©bogage d'une application est l'une des fonctions les plus importantes pour un d√©veloppeur, et dans ce cas, sa vitesse diminue consid√©rablement. </p><br><p>  En parlant de d√©bogage.  Le d√©bogueur React Native a non seulement des probl√®mes de lancement.  La correction des erreurs trouv√©es √† la suite du test est √©galement un processus assez douloureux.  Dans react-native, le code JS est traduit en code natif, mais est obscurci lors de la traduction.  Donc, si vous ne voulez pas voir des erreurs comme "exception de pointeur nul dans zzz.yyy ()", alors vous devez utiliser le d√©bogueur int√©gr√©, vous ne pouvez pas simplement lire les exceptions dans logcat.  En cas d'erreur, le d√©bogueur affiche un "√©cran de mort" rouge avec sa description, poussant plus ou moins vers la voie de la correction.  Mais il y a des probl√®mes avec cette partie. </p><br><p>  Eh bien, lorsque l'erreur ressemble √† ceci: </p><br><p><img src="https://habrastorage.org/webt/oh/sr/zo/ohsrzozloajbn7g9y0nczb_6zkq.png"></p><br><p>  Il est vraiment clair ce qui se passe ici - au lieu de l'objet tableau attendu, this.state.noteArray.map n'est pas d√©fini, ce qui provoque la fameuse TypeError.  Vous pouvez le corriger en acc√©dant √† app.js: 14 et en v√©rifiant la valeur de cette variable avant utilisation. </p><br><p>  Pire encore lorsque l'erreur ressemble √† ceci: </p><br><p><img src="https://habrastorage.org/webt/wn/hb/6b/wnhb6bq3akewzc6vidymuhnv9ec.png"></p><br><p>  Donc: </p><br><p><img src="https://habrastorage.org/webt/tn/-k/oe/tn-koehm2wzsl7gu-4hqemsvpz4.png"></p><br><p>  Ou alors: </p><br><p><img src="https://habrastorage.org/webt/qb/jk/qw/qbjkqwgcbm59ffqwesbfholo6zu.png"></p><br><p>  Les images ont √©t√© prises sur Internet, mais nous les avons vues en direct.  Et malgr√© le fait qu'ils soient affich√©s au moment de l'ex√©cution, cette erreur n'est pas due au fait que quelque chose a √©t√© mal fait dans votre code.  Cela peut √™tre d√ª au fait que vous avez mal install√© la biblioth√®que, ou si vos importations ont des d√©pendances incompatibles, ou que quelque chose s'est mal pass√© dans le code natif, et React essaie de d√©tecter l'erreur.  Chaque erreur est individuelle et est r√©solue tr√®s diff√©remment.  C'est bien qu'il y ait StackOverflow et au moins une sorte de mode de d√©bogage. </p><br><p>  Pire encore, lorsqu'une erreur n'est pas reproduite dans le d√©bogage.  Nous avons rencontr√© cette situation lors de la tentative de cr√©ation d'une application avec une nouvelle version de React avec prise en charge de l'architecture x64 pour Android.  Lors de l'installation d'une application avec un d√©bogueur, tout fonctionne bien.  Mais d√®s que nous construisons le testeur sur le t√©l√©phone, tout cesse de fonctionner et se casse d√®s qu'il s'agit d'interagir avec la base de donn√©es.  Pour d√©boguer le non-d√©bogage √† la h√¢te, nous utilisons des messages de console, qui dans ce cas √©taient le composant react toastAndroid.  Ce composant affiche un court texte lorsque vous atteignez une certaine ligne de code.  M√©thodiquement, en divisant de pr√©f√©rence le code en deux, nous localisons la fonction dans laquelle l'erreur se produit et d√©couvrons que la m√©thode Object.assign ({}, item) ne fonctionne pas dans la nouvelle version de React.  Il a eu la chance de pouvoir remplacer cette fonction par un {... item} plus court tout en conservant la fonctionnalit√© de l'application, mais la recherche de cette erreur a co√ªt√© environ une douzaine d'heures de travail. </p><br><p>  Apr√®s une petite √©tude a √©t√© men√©e √† la recherche de raisons.  Il s'est av√©r√© que React Native utilise diff√©rents moteurs Javascript pour interpr√©ter le code JS dans les versions de d√©bogage et de production: pour le d√©bogage du moteur Chrome JS et dans JavaScriptCore.  Oui, React Native ne traduit pas JavaScript en code natif, mais l'interpr√®te lors de son ex√©cution.  Dans le m√™me temps, le moteur de d√©bogage fonctionne beaucoup plus stable et, par cons√©quent, les bogues se faufilent de plus en plus en production.  Par exemple, cet article montre comment le formatage de la date fonctionne dans diff√©rentes conditions.  Revenant √† l'erreur: il s'est av√©r√© qu'apr√®s la mise √† jour de la version React Native, le moteur web de production production a perdu le support d'Object.assign ().  Mais le moteur de d√©bogage est rest√© le m√™me. </p><br><p>  La pire option est peut-√™tre le cas lorsque l'application se casse √† des endroits al√©atoires, uniquement dans la version de production et sans aucun journal de React Native.  Exemple: apr√®s avoir install√© la version finale de l'application sur le t√©l√©phone, cela "fonctionne pendant un certain temps", puis "s'√©teint sans erreur ni avertissement √† un moment al√©atoire".  De plus, l'erreur n'est pas reproduite sur tous les appareils.  Au final, par essais et erreurs (et en d√©tectant que le Firebase Crashlytics susmentionn√© n'envoie pas les erreurs correspondantes), nous avons r√©ussi √† attraper les journaux de chute qui ressemblaient √† ceci: </p><br><p><img src="https://habrastorage.org/webt/oh/sr/zo/ohsrzozloajbn7g9y0nczb_6zkq.png"></p><br><p>  Ce texte ne s'applique m√™me pas √† notre application, il n'√©tait m√™me pas marqu√© en rouge.  Mais apr√®s l'avoir obtenu et √™tre all√© sur les forums, nous avons constat√© que la nouvelle version de React Native √©tait cass√©e.  Et le pr√©c√©dent √©tait cass√©.  Sur le Issue Tracker officiel, l'erreur "Android se bloque: signal 11 (SIGSEGV)" existait depuis deux mois, et √† notre chance deux jours avant de nous y rendre (!) Une solution exp√©rimentale a √©t√© propos√©e pour corriger l'erreur. </p><br><p>  Il est ironique que certains d√©veloppeurs qui ont d√ª faire face √† Android Studio ne comprennent pas que l'IDE a des options comme construire / nettoyer le projet ou classer / invalider les caches.  Cela est n√©cessaire pour se d√©barrasser du comportement anormal de gradle, des faux messages d'erreur et des avertissements, des erreurs de synchronisation.  Les d√©veloppeurs ont demand√©: "pourquoi devrions-nous faire le travail pour notre IDE, dans de telles situations, ces commandes devraient √™tre ex√©cut√©es automatiquement."  Et ils peuvent √™tre compris, mais en m√™me temps, les IDE modernes font tout le travail difficile dans les coulisses.  Et ces d√©veloppeurs n'ont tout simplement pas travaill√© avec React Native. </p><br><p>  Tous ces cas sont des cas isol√©s survenus au cours des derni√®res semaines.  Ici, nous ne d√©crivons pas la complexit√© de l'ex√©cution des applications avec Expo, avec la d√©finition du style de code dans babel / eslint, nous ne grondons pas Javascript pour une flexibilit√© excessive, nous ne disons pas comment le d√©bogage en raison de la liaison redux / realm a √©t√© presque compl√®tement perdu sur l'un des projets.  Compte tenu des difficult√©s d√©crites de support et de d√©veloppement et du fait que pour deux syst√®mes, tout se multiplie par deux, cela vaut-il la peine de se demander si React Native est vraiment rentable?  Apr√®s avoir termin√© notre troisi√®me projet dans cette langue, nous avons d√©cid√© de ne pas le faire.  Qu'en penses-tu? </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr468901/">https://habr.com/ru/post/fr468901/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr468885/index.html">N'apprends pas les mod√®les, apprends les concepts</a></li>
<li><a href="../fr468889/index.html">Fonctions de rappel de script</a></li>
<li><a href="../fr468891/index.html">Antiquit√©s: consid√©rons la carte m√®re du 386e ordinateur</a></li>
<li><a href="../fr468897/index.html">SwiftUI pour la derni√®re t√¢che comp√©titive de Telegram Charts (mars 2019): tout est simple</a></li>
<li><a href="../fr468899/index.html">Quels projets est-il sens√© de d√©marrer et de quoi l'industrie a-t-elle besoin en ce moment?</a></li>
<li><a href="../fr468903/index.html">L'avenir appartient aux plateformes √©ducatives adaptatives. D√©bit Entretien avec Asger Palm</a></li>
<li><a href="../fr468905/index.html">Vers l'accessibilit√©</a></li>
<li><a href="../fr468907/index.html">D√©modulation Yandex</a></li>
<li><a href="../fr468909/index.html">Gr√¢ce √† l'authentification √† deux facteurs, j'ai perdu tout mon argent et 3 ans de travail</a></li>
<li><a href="../fr468911/index.html">Superb Quantum Excellence Q & A</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>