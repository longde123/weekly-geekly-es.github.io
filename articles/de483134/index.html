<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏳️ 👨‍👩‍👧‍👦 ⛅️ Testen der Zwei-Faktor-Authentifizierung und mögliche Problemumgehungen 💞 👍🏿 📈</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Noch bevor ich mich mit der komplexen Wissenschaft der Informationssicherheit auseinandergesetzt habe, schien mir die 2FA-Authentifizierung eine garan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Testen der Zwei-Faktor-Authentifizierung und mögliche Problemumgehungen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/483134/"><img src="https://habrastorage.org/webt/g8/rq/pf/g8rqpf1rdulkehqbd2aromukw5q.png"><br><br>  Noch bevor ich mich mit der komplexen Wissenschaft der Informationssicherheit auseinandergesetzt habe, schien mir die 2FA-Authentifizierung eine garantierte Methode zum Schutz Ihres Kontos zu sein, und keine "Ihre Hacker" können beispielsweise meine interne Währung abheben, um Kleidung für Charaktere auf dem Spielkonto zu kaufen.  Im Laufe der Zeit wurde jedoch experimentell nachgewiesen, dass ein Zwei-Faktor-Authentifizierungssystem eine große Anzahl von Schwachstellen aufweisen kann. <br><a name="habracut"></a><br>  Mit einfachen Worten, die Zwei-Faktor-Authentifizierung ist eine Bestätigung der Aktion, indem der generierte Code eingegeben wird, um die Sicherheit zu erhöhen, und während der Bewegung oder vor dem Start Stöcke in die Räder bedingter Hacker geworfen werden. <br><br>  Das Code-Bestätigungssystem ist weit verbreitet, es wird überall an verschiedenen Standorten verwendet und kann sowohl für primäre als auch für sekundäre Anmeldungen verbunden werden.  Die Anwendung ist jedoch nicht darauf beschränkt - die Entwickler fügen eine Bestätigung über die Funktionalität der Passwortwiederherstellung, Bestätigung der Registrierung / des Abonnements, zusätzliche Bestätigung der Finanztransaktionen, Passwortänderung, Änderung der persönlichen Daten bei.  Außerdem wird 2FA von Zeit zu Zeit nach dem Abmelden als Pinnwand verwendet und nicht als Kennwort oder andere Art der Bestätigung. <br><br>  In diesem Artikel habe ich Möglichkeiten zum Testen von 2FA auf Sicherheitsanfälligkeiten, deren Ausnutzung sowie mögliche Optionen zum Umgehen des vorhandenen Schutzes vor bestimmten Arten von Angriffen zusammengefasst.  Sehen wir uns die Liste der Schwachstellenüberprüfungen an, die für 2FA gelten: <br><br><h2>  1. Keine Rate Limit </h2><br>  Der Ratenlimit-Algorithmus wird verwendet, um zu testen, ob eine Benutzersitzung (oder IP-Adresse) in Versuchen oder in der Geschwindigkeit begrenzt werden kann und unter welchen Umständen dies geschieht.  Wenn der Benutzer innerhalb eines bestimmten Zeitraums zu viele Anforderungen abgeschlossen hat, kann die Webanwendung mit einem 429-Code (viele Anforderungen) antworten oder ein Ratenlimit anwenden, ohne Fehler anzuzeigen.  Das Fehlen eines Ratenlimits impliziert, dass es während der normalen Aufzählung keine Einschränkungen hinsichtlich der Anzahl der Versuche und / oder der Geschwindigkeit gibt. Innerhalb des Gültigkeitszeitraums der Sitzung / des Tokens kann der Code beliebig oft (mit beliebiger Geschwindigkeit) durchlaufen werden. <br><br>  Sehr oft müssen Sie sich mit einem „noiseless“ -Ratenlimit auseinandersetzen. Wenn Sie feststellen, dass keine Fehler vorliegen und sich der HTTP-Body / Code bei nachfolgenden Anforderungen nicht ändert, sollten Sie zu früh glücklich sein und zuerst das Endergebnis des Angriffs mit einem gültigen Code überprüfen. <br><br><h2>  2. Ratenlimit existiert, kann aber umgangen werden </h2><br>  Fälle, die ich vorher treffen musste: <br><br><h4>  1) Begrenzung der Strömungsgeschwindigkeit ohne Verstopfung nach Erreichen einer bestimmten Geschwindigkeit </h4><br>  Häufig versuchen Sicherheitsforscher, Code mit 5 oder mehr Threads abzurufen, um einen Angriff zu beschleunigen (in Burp Intruder beträgt die Standardanzahl der Threads 5 ohne Verzögerung).  Aber manchmal kann ein Sicherheitssystem, das nicht mehr funktioniert, oder ein normaler Load Balancer nur auf diesen einen Faktor reagieren.  Wenn Sie versuchen, mit 5 Threads Gewalt anzuwenden, sollten Sie die Zahl auf 1 und dann mit einer Verzögerung von einer Sekunde auf 1 reduzieren.  Früher hatte ich das Glück, ein solches Verhalten zu beobachten, und mithilfe solcher Manipulationen kam es zu einer erfolgreichen Code-Auswahl, die zur Übernahme des Kontos führte.  Wenn der 2FA-Code kein bestimmtes Ablaufdatum hat, haben wir viel Zeit zum Sortieren.  Wenn die Gültigkeitsdauer vorliegt, verringert sich der Erfolg des Angriffs, die potenzielle Gefahr einer Sicherheitsanfälligkeit besteht jedoch weiterhin, da immer noch die Möglichkeit besteht, in den gewünschten Code einzudringen. <br><br><h4>  2) Der generierte OTP-Code ändert sich nicht </h4><br>  Dies gilt nicht für sich ständig ändernde Codes wie in Google Authenticator, sondern nur für statische Codes, die per SMS, E-Mail oder persönlich per Messenger eingehen. <br><br>  Das Wesentliche dieser Umgehung ist, dass derselbe OTP-Code ständig oder für einige Zeit, beispielsweise 5 Minuten, gesendet wird, was während dieser gesamten Zeit gültig ist.  Es lohnt sich auch, darauf zu achten, dass keine stille Frequenzbegrenzung erfolgt. <br><br>  Beispiel für einen Bericht: <a href="https://hackerone.com/reports/420163">hackerone.com/reports/420163</a> <br><br>  Angenommen, die Anwendung generiert einen Zufallscode von 001 bis 999 und sendet ihn innerhalb von 10 Minuten an das Telefon. Wenn die Funktion "Erneut senden" aktiviert ist, erhalten wir denselben Code.  Das Ratenlimit ist jedoch an die Anforderung gebunden, wodurch die Anzahl der Versuche pro Anforderungstoken begrenzt wird.  Wir können ständig einen neuen Code anfordern, ein neues Anforderungstoken generieren, es auf eine nachfolgende Anforderung anwenden (mithilfe von grep-match in einer Burp-Suite oder mithilfe unseres eigenen Skripts) und Bruteforce mit einem Zahlenbereich von 001 bis 999 ausführen. So können wir ständig ein neues Anforderungstoken verwenden Wir werden den richtigen Code erfolgreich auswählen, da er sich nicht ändert und für einen bestimmten Zeitraum statisch ist.  Die Einschränkungen dieses Angriffs sind eine lange Zahl oder das Mischen von Buchstaben mit Zahlen als Bestätigungscode. <br><br>  Diese Situation sollte nicht gefördert werden. Sie sollten versuchen, mindestens einen Teil unserer Liste zu sortieren, da die Möglichkeit besteht, dass der generierte Code in diesem Teil der Liste enthalten ist, da er zufällig generiert wird.  Wenn Sie es versuchen, müssen Sie sich auf Zufall verlassen, aber es besteht immer noch die Möglichkeit, die richtige Kombination zu finden, was eine Schwachstelle darstellt, die definitiv behoben werden muss. <br><br><h4>  3) Setzen Sie das Ratenlimit-a zurück, wenn Sie den Code aktualisieren. </h4><br>  In der Codeüberprüfungsanforderung ist das Ratenlimit vorhanden. Nach Aktivierung der Funktion zum erneuten Senden des Codes wird der Code zurückgesetzt und Sie können den Brute-Force-Code fortsetzen. <br>  Beispiele für Berichte: <br><br>  <a href="https://hackerone.com/reports/149598">https://hackerone.com/reports/149598</a> , - Theorie; <br>  <a href="https://hackerone.com/reports/205000">hackerone.com/reports/205000</a> , ein praktischer Exploit, der auf einem früheren Bericht basiert. <br><br><h4>  4) Umgehen des Ratenlimits durch Ändern der IP-Adresse </h4><br>  Viele Sperren basieren auf der Einschränkung des Empfangs von Anforderungen von IP, das beim Ausführen einer Anforderung den Schwellenwert einer bestimmten Anzahl von Versuchen erreicht hat.  Wenn die IP-Adresse geändert wird, besteht die Möglichkeit, diese Einschränkung zu umgehen.  Um diese Methode zu überprüfen, ändern Sie einfach Ihre IP-Adresse über den Proxyserver / VPN und prüfen Sie, ob die Blockierung von der IP-Adresse abhängt. <br><br>  Möglichkeiten, die IP zu ändern: <br><br><ul><li>  Proxies können bei einem Angriff mit dem IP Rotator-Add-On für Burp Suite verwendet werden. Github.com/RhinoSecurityLabs/IPRotate_Burp_Extension.  Meiner Meinung nach ist dies die beste Wahl, da es uns ~ unbegrenzte Brute-Force-Versuche und IP-Adressen gibt, mit denen Sie einen Brute-Force-Angriff ohne 42-fache Fehler und Unterbrechungen durchführen können. </li><li>  Eine gute Option könnte ein Python-Skript mit einem Proxy-Anforderungsmodul sein, aber zuerst müssen Sie eine große Anzahl gültiger Proxys irgendwo abrufen. </li></ul><br>  Da das IP-Rotationstool Anforderungen unter Verwendung von AWS-IP-Adressen sendet, werden alle Anforderungen blockiert, wenn sich die Webanwendung hinter der CloudFlare-Firewall befindet. <br><br><img src="https://habrastorage.org/webt/5b/ep/c4/5bepc4djncwcbel-6gxkjfzh1ro.png"><br><br>  In diesem Fall müssen Sie zusätzlich die IP des ursprünglichen Webservers ermitteln oder eine Methode finden, die keine AWS-IP-Adressen betrifft. <br><br><h4>  5) Die Site enthält Unterstützung für X-Forwarded-For </h4><br>  Der integrierte X-Forwarded-For-Header kann zum Ändern der IP-Adresse verwendet werden.  Wenn die Anwendung über eine integrierte Verarbeitung für diesen Header verfügt, senden Sie einfach X-Forwarded-For: desired_IP, um die IP zu ersetzen und die Einschränkung ohne die Verwendung zusätzlicher Proxys zu umgehen.  Jedes Mal, wenn eine Anfrage von X-Forwarded-For gesendet wird, geht der Webserver davon aus, dass unsere IP-Adresse mit dem über den Header übertragenen Wert übereinstimmt. <br>  Materialien zu diesem Thema: <br>  <a href="https://hackerone.com/reports/225897">hackerone.com/reports/225897</a> <br>  <a href="https://medium.com/%40arbazhussain/bypassing-rate-limit-protection-by-spoofing-originating-ip-ff06adf34157">medium.com/@arbazhussain/bypassing-rate-limit-protection-by-spoofing-originating-ip-ff06adf34157</a> <br><br><h2>  3. Umgehen Sie 2fa, indem Sie einen Teil der Anforderung durch eine Sitzung eines anderen Kontos ersetzen </h2><br>  Wenn ein Parameter mit einem bestimmten Wert gesendet wird, um den Code in der Anforderung zu überprüfen, versuchen Sie, den Wert aus der Anforderung an ein anderes Konto zu senden. <br><br>  Wenn Sie beispielsweise einen OTP-Code senden, wird die Formular-ID, Benutzer-ID oder das Cookie überprüft, die bzw. das mit dem Senden des Codes verknüpft ist.  Wenn wir die Daten aus den Parametern des Kontos, für das Sie die Codeüberprüfung umgehen möchten (Konto 1), auf eine Sitzung eines völlig anderen Kontos (Konto 2) anwenden, erhalten wir den Code und geben ihn auf dem zweiten Konto ein. Dann können wir den Schutz für das erste Konto umgehen.  Nach dem Neuladen der Seite sollte 2FA verschwinden. <br><br><h2>  4. Bypass 2FA mit der "Memorization-Funktion" </h2><br>  Viele Sites, die die 2FA-Autorisierung unterstützen, verfügen über die Funktion "An mich erinnern".  Dies ist nützlich, wenn der Benutzer bei nachfolgenden Anmeldungen keinen 2FA-Code eingeben möchte.  Es ist wichtig, die Art und Weise zu identifizieren, in der 2FA „erinnert“ wird.  Dies kann ein Cookie sein, ein Wert im Sitzungs- / lokalen Speicher oder einfach das Anhängen von 2FA an eine IP-Adresse. <br><br><h4>  1) Wenn 2FA mithilfe eines Cookies angehängt wird, muss der Cookie-Wert nicht ermittelbar sein </h4><br>  Das heißt, wenn ein Cookie aus einer Reihe von Zahlen besteht, die sich für jedes Konto erhöhen, ist es durchaus möglich, einen Brute-Force-Angriff auf den Cookie-Wert durchzuführen und 2FA zu umgehen.  Entwickler sollten das Cookie (zusammen mit dem Schlüsselsitzungscookie und dem CSRF-Token) mit dem Attribut HttpOnly versehen, damit es nicht mit XSS gestohlen und zur Umgehung von 2FA verwendet werden kann. <br><br><h4>  2) Wenn 2FA an die IP-Adresse angehängt ist, können Sie versuchen, sie zu ersetzen </h4><br>  Um diese Methode zu identifizieren, melden Sie sich mit der 2FA-Speicherfunktion bei Ihrem Konto an, wechseln Sie dann zu einem anderen Browser oder Inkognito-Modus des aktuellen Browsers und versuchen Sie erneut, sich anzumelden.  Wenn 2FA überhaupt nicht angefordert wird, wurde 2FA an die IP-Adresse angehängt. <br>  Um die IP-Adresse zu ersetzen, können Sie den X-Forwarded-For-Header bei der Eingabe des Anmeldenamens und des Kennworts verwenden, sofern die Webanwendung dies unterstützt. <br><br>  Mit diesem Header können Sie auch die Whitelist-Funktion für IP-Adressen umgehen, sofern in den Kontoeinstellungen eine vorhanden ist.  Es kann in Verbindung mit 2FA als zusätzlicher Kontoschutz verwendet werden oder 2FA kann nicht einmal angefordert werden, wenn die IP-Adresse mit der Whitelist übereinstimmt (mit Zustimmung des Benutzers).  Selbst ohne das Anhängen des 2FA an die IP-Adresse kann das 2FA in einigen Fällen umgangen werden, indem die zugehörigen Schutzmethoden umgangen werden. <br>  Im Allgemeinen ist das Anhängen von 2FA an eine IP-Adresse kein völlig sicherer Schutz, da 2FA umgangen werden kann, wenn Sie sich im selben Netzwerk befinden und mit demselben VPN- / Internetdienstanbieter mit einer statischen IP-Adresse verbunden sind. <br><br>  Der sicherste Weg, sich zu schützen, besteht darin, sich überhaupt nicht an 2FA zu erinnern, was sich nachteilig auf die Benutzerfreundlichkeit auswirkt. <br><br><h2>  5. Fehler bei der Zugriffskontrolle auf der 2FA-Eingabeseite </h2><br>  Manchmal wird eine Dialogseite zur Eingabe von 2FA als URL mit Parametern angezeigt.  Der Zugriff auf eine solche Seite mit Parametern in der URL mit Cookies, die nicht mit denen übereinstimmen, die zum Generieren der Seite verwendet wurden, oder ohne Cookies ist nicht sicher.  Wenn sich die Entwickler jedoch dazu entschlossen haben, die Risiken zu akzeptieren, müssen Sie einige wichtige Punkte durchgehen: <br><br><ol><li>  Läuft der Link für 2FA-Eingaben ab? </li><li>  ob der Link in Suchmaschinen indiziert ist. </li></ol><br>  Wenn der Link eine lange Lebensdauer hat und / oder die Suchmaschinen funktionierende Links für 2FA-Eingaben enthalten / Links indiziert werden können (es gibt keine Regeln in robots.txt / meta-Tags), besteht die Möglichkeit, auf der 2FA-Eingabeseite einen 2FA-Bypass-Mechanismus zu verwenden Umgehen Sie Login und Passwort vollständig und greifen Sie auf das Konto einer anderen Person zu. <br><br><h2>  6. Unzureichende Zensur personenbezogener Daten auf Seite 2FA </h2><br>  Beim Senden eines OTP-Codes auf einer Seite wird die Zensur verwendet, um persönliche Daten wie E-Mail, Telefonnummer, Spitzname usw. zu schützen.  Diese Daten können jedoch vollständig in den API-Endpunkten und anderen Anfragen offengelegt werden, für die wir im 2FA-Stadium über ausreichende Rechte verfügen.  Wenn diese Daten anfangs nicht bekannt waren, wir beispielsweise nur ein Login eingegeben haben, ohne die Telefonnummer zu kennen, wird dies als Sicherheitslücke in Bezug auf die Offenlegung von Informationen angesehen.  Die Kenntnis der Telefonnummer / E-Mail-Adresse kann für nachfolgende Phishing- und Brute-Force-Angriffe verwendet werden. <br><br>  Ein Beispiel für die Ausnutzung einer Sicherheitsanfälligkeit mit Credentials Stuffing.  Angenommen, es gibt eine öffentlich zugängliche Datenbank mit Anmeldungen und Kennwörtern für Site A. Angreifer können die Daten aus dieser Datenbank auf Site B verwenden: <br><br><ul><li>  Zuerst prüfen sie, ob der Benutzer in der Datenbank von Standort B vorhanden ist, indem sie den Fehler „Accounts Enumeration“ beim Registrieren / Wiederherstellen des Kennworts verwenden.  In der Regel betrachten viele Websites dies nicht als Sicherheitsanfälligkeit und gehen Risiken ein.  "Sicherheitslücke" liegt im Vorliegen eines Fehlers über die Tatsache der Benutzerregistrierung auf der Website.  Im Idealfall lautet eine sichere Nachricht auf der Seite zur Kennwortwiederherstellung wie folgt: <br><br><img src="https://habrastorage.org/webt/mh/qe/mh/mhqemhmykfiy5pcl-35konzb0dm.png"><br><br><img src="https://habrastorage.org/webt/ha/uu/ze/hauuzewqlj9escx9nc8fslz4a0o.png"></li><li>  Nachdem die Datenbank der vorhandenen Benutzer abgerufen wurde, wenden Angreifer Kennwörter auf diese Konten an. </li><li>  Wenn sie auf 2FA stoßen, bleiben sie stecken.  Im Falle einer unzureichenden Zensur von Benutzerdaten können sie ihre Datenbank jedoch durch ihre persönlichen Daten ergänzen (sofern sie nicht in der ursprünglichen Datenbank enthalten sind). </li></ul><br><h2>  7. Ignorieren von 2FA unter bestimmten Umständen </h2><br>  Bei der Ausführung einiger Aktionen, die zur automatischen Anmeldung bei Ihrem Konto führen, wird 2FA möglicherweise nicht angefordert. <br><br><h4>  1) Ignorieren Sie 2FA, wenn Sie ein Passwort wiederherstellen </h4><br>  Viele Dienste melden sich automatisch bei Ihrem Konto an, nachdem die Passwortwiederherstellung abgeschlossen wurde.  Da der Zugriff auf das Konto sofort gewährt wird, kann es beim Anmelden bei Ihrem 2FA-Konto ignoriert und vollständig ignoriert werden. <br><br>  Auswirkungen eines ähnlichen Hackerone-Berichts, den ich kürzlich gesendet habe: <br><blockquote>  Wenn ein Angreifer Zugriff auf die E-Mail des Opfers erhält (er kann das Konto mit Phishing, Brute-Force-Angriffen, Stuffing von Anmeldeinformationen usw. hacken), kann er 2FA umgehen, obwohl 2FA in diesem Fall das Konto schützen sollte.  Derzeit wird für 2FA der Google Authenticator-Code oder der Sicherungscode überprüft, nicht jedoch der Code aus der E-Mail. Daher ist diese Umgehung sinnvoll. </blockquote><h4>  2) Ignoriere 2FA, wenn du dich über ein soziales Netzwerk anmeldest </h4><br>  Sie können Ihrem Benutzerkonto ein soziales Netzwerk hinzufügen, um sich schnell bei Ihrem Konto anzumelden und gleichzeitig 2FA einzurichten.  Wenn Sie sich über soziale Netzwerke in Ihrem Konto anmelden, kann 2FA ignoriert werden.  Wenn die E-Mail des Opfers gehackt wird, kann das Kennwort für das Konto des sozialen Netzwerks wiederhergestellt werden (sofern dies zulässig ist) und der Dienst ohne Eingabe von 2FA aufgerufen werden. <br><br>  Auswirkungen eines der Berichte: <br><blockquote><ol><li>  Eine Reihe anderer Sicherheitsanfälligkeiten, z. B. die zuvor gesendete OAuth-Fehlkonfiguration # 577468, um das Konto vollständig zu erfassen und 2FA zu beschädigen. </li><li>  Wenn ein Angreifer die E-Mail-Adresse des Benutzers gehackt hat, kann er versuchen, den Zugriff auf das Konto des sozialen Netzwerks wiederherzustellen und sich ohne weitere Überprüfung in das Konto einzuloggen. </li><li>  Wenn sich ein Angreifer einmal in das Konto eines Opfers gehackt hat, kann er dem Konto ein soziales Netzwerk zuordnen und sich in Zukunft in das Konto einloggen, 2FA vollständig ignorieren und den Benutzernamen / das Passwort eingeben. </li></ol></blockquote><h4>  3) Ignorieren von 2FA in einer älteren Version der Anwendung </h4><br>  Entwickler fügen Domänen / Unterdomänen häufig Staging-Versionen einer Webanwendung hinzu, um bestimmte Funktionen zu testen.  Interessanterweise wird 2FA nicht angefordert, wenn Sie sich mit Ihrem Benutzernamen und Kennwort anmelden.  Möglicherweise verwenden die Entwickler eine ältere Version der Anwendung, in der es keinen Schutz für 2FA gibt, 2FA selbst deaktiviert ist oder die absichtlich zum Testen deaktiviert wurde. <br><br>  Sie können auch gleichzeitig andere Sicherheitslücken überprüfen. - Wenn Sie einen neuen Benutzer auf einem Staging-Server registrieren, dessen E-Mail in der Datenbank der Produktionsversion vorhanden ist, können Sie uns personenbezogene Daten aus der Produktion übermitteln.  das Fehlen eines Ratenlimits bei wichtigen Funktionen, z. B. der Passwortwiederherstellung.  Ein Beispiel für die jüngste Sicherheitsanfälligkeit ist ein Facebook-Fehler in Höhe von 15.000 US-Dollar, der das Hacken eines Kontos mithilfe des Wiederherstellungscodes für Bruteforce-Kennwörter unter beta.facebook.com ermöglichte. <a href="https://www.freecodecamp.org/news/responsible-disclosure-how-i-could-have-hacked-all-facebook-accounts-f47c0252ae4d/">facebook-accounts-f47c0252ae4d</a> . <br><br><h4>  4) Ignorieren von 2FA bei Cross-Plattform </h4><br>  2FA-Implementierungen in der Mobil- oder Desktopversion können von der Webversion der Anwendung abweichen.  2FA ist möglicherweise schwächer als in der Webversion oder fehlt vollständig. <br><br>  7. Beim Deaktivieren von 2FA wird der aktuelle Code nicht angefordert. <br><br>  Wenn beim Deaktivieren von 2FA keine zusätzliche Bestätigung angefordert wird, z. B. der aktuelle Code aus der Google-Authentifizierungsanwendung oder der Code aus E-Mail / Telefon, bestehen in diesem Fall bestimmte Risiken.  Bei einer sauberen Anfrage besteht die Möglichkeit eines CSRF-Angriffs.  Wenn ein Bypassvektor mit CSRF-Schutz gefunden wird (falls vorhanden), kann 2FA deaktiviert werden.  Eine Clickjacking-Sicherheitsanfälligkeit kann ebenfalls ausgenutzt werden. Nach einigen Klicks eines ahnungslosen Benutzers wird die Verbindung zu 2FA getrennt.  Durch die Validierung des vorherigen Codes wird ein zusätzlicher 2FA-Schutz hinzugefügt, wenn potenzielle CSRF / XSS / Clickjacking-Angriffe sowie CORS-Fehlkonfigurationen vorliegen. <br><br>  Ich gebe Ihnen ein Beispiel für hackerone.com. - Wenn Sie 2FA in einem Formular deaktivieren, müssen Sie gleichzeitig zwei Variablen eingeben. - Den aktuellen Code mit Google Authenticator-Anwendung und Passwort.  Dies ist der beste und empfohlene Schutz. <br><br><img src="https://habrastorage.org/webt/wg/hh/jz/wghhjzf5sdotqin6knlde5i4g5q.png"><br><br><h2>  8. Bereits erstellte Sitzungen bleiben nach Aktivierung von 2FA gültig </h2><br>  Wenn 2FA aktiviert ist, ist es wünschenswert, dass parallele Sitzungen auf demselben Konto enden und der 2FA-Eingabedialog angezeigt wird, ebenso wie bei einer Kennwortänderung.  Wenn das Konto kompromittiert wurde und die erste Reaktion des Opfers die Einbeziehung von 2FA ist, wird die Sitzung des Angreifers deaktiviert und der nächste Login und das nächste Passwort erfordern 2FA.  Alles in allem ist dies die beste Vorgehensweise, die befolgt werden muss.  Ich stelle oft fest, dass Kryptowährungsaustausche einen ähnlichen Schutz bieten.  Beispiel für einen HackerOne-Bericht, - <br>  https://hackerone.com/reports/534450. <br><br><h4>  9. Das Fehlen eines Tariflimits in Ihrem Konto </h4><br>  2FA kann in verschiedenen Funktionen des persönlichen Benutzerkontos implementiert werden, um die Sicherheit zu erhöhen.  Dies kann eine Änderung der E-Mail-Adresse, des Passworts, die Bestätigung einer Codeänderung für Finanztransaktionen usw. sein.  Das Vorhandensein von rate-limit-a in Ihrem Konto kann sich von dem Vorhandensein von rate-limit-a in 2FA bei der Eingabe Ihres Kontos unterscheiden.  Ich bin oft auf ähnliche Fälle gestoßen, in denen es möglich war, einen 2FA-Code in meinem Konto frei zu wählen, während am Eingang ein „strenges“ Tariflimit festgelegt wurde. <br><br>  Wenn die Entwickler ursprünglich Schutz vor nicht autorisierten Datenänderungen hinzugefügt haben, muss dieser Schutz von allen möglichen Bypass-s unterstützt und korrigiert werden.  Wenn die Umgehung gefunden wird, wird dies als Sicherheitsanfälligkeit in Bezug auf die Umgehung von Sicherheitsfunktionen angesehen, die von den Entwicklern implementiert wurde. <br><br><h4>  10. API-Versionierung </h4><br>  Wenn Sie in der Anforderung der Webanwendung etwas wie / v * / sehen, wobei * eine Zahl ist, können Sie wahrscheinlich zu einer älteren Version der API wechseln.    API          .         ,       API  production/staging . <br>  , /endpoint/api/v4/login    ,    .  2FA   ,      /endpoint/api/v4/2fa_check,  .     API   2FA, ,   ,   . /endpoint/api/v3/login    /endpoint/v3/login_successful?code=RANDOM,  2fa_check ,     API, 2FA    . <br><br>   , —    /endpoint/api/v4/2fa_check  rate-limit,     /endpoint/api/v3/2fa_check     - . <br><br><h4> 11. Improper Access Control     </h4><br>       2FA     .               ( ).   CORS /XSS    ,  «»         ,        2FA,     . <br><br>    , 2        , , ,     2FA    web    , —      .    ,          2FA  (  Salesforce, Valve)                      2FA.           2FA   ,        2FA bypass-. <br><br> ,        , bug bounty ,    ,       . Stay safe! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de483134/">https://habr.com/ru/post/de483134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de483124/index.html">Das massivste Gadget in naher Zukunft (kein Smartphone)</a></li>
<li><a href="../de483126/index.html">Kryogene Effekte können den sicheren Transport beschädigter Elektrofahrzeugbatterien gewährleisten</a></li>
<li><a href="../de483128/index.html">Einführung in PHP 7.4: Leistung, Funktionen, Abwertungen</a></li>
<li><a href="../de483130/index.html">Was tun, wenn der Code für das Kofferschloss vergessen wurde?</a></li>
<li><a href="../de483132/index.html">Design und Herstellung eines Teleskops</a></li>
<li><a href="../de483136/index.html">Überprüfung des verwendeten MacBook vor dem Kauf - Checkliste</a></li>
<li><a href="../de483140/index.html">Polygone eine andere Welt: Amiga 500</a></li>
<li><a href="../de483142/index.html">Portierungsbeben 3 nach Rust</a></li>
<li><a href="../de483144/index.html">Der Wissenschaftler He Jiankui ist ein Held, kein Verbrecher</a></li>
<li><a href="../de483146/index.html">DEFCON 27. Konferenz Kraken Wireless WiFi Hacking Tool</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>