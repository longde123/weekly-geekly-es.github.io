<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äçüé§ üßúüèΩ üö∑ Huawei Dorado V6: Sichuan Heat üßú üç£ üéå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O ver√£o em Moscou este ano, para ser sincero, n√£o foi muito bom. Come√ßou muito cedo e rapidamente, nem todos conseguiram reagir e terminou j√° no final...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Huawei Dorado V6: Sichuan Heat</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467975/"><p><img src="https://habrastorage.org/webt/yj/u8/io/yju8iodu0czpy6vqf4esj-rbyio.png"><br>  O ver√£o em Moscou este ano, para ser sincero, n√£o foi muito bom.  Come√ßou muito cedo e rapidamente, nem todos conseguiram reagir e terminou j√° no final de junho.  Portanto, quando a Huawei sugeriu que eu fosse para a China, para a cidade de Chengdu, onde est√° localizado o centro de RnD, olhando a previs√£o do tempo a +34 graus √† sombra, concordei imediatamente.  Ainda assim, minha idade n√£o √© a mesma e meus ossos precisam ser aquecidos um pouco.  Mas quero observar que foi poss√≠vel aquecer n√£o apenas os ossos, mas tamb√©m o interior, porque a prov√≠ncia de Sichuan, na qual, na verdade, Chengdu √© famosa por seu amor por comida picante.  Mas, ainda assim, este blog n√£o √© sobre viagens, ent√£o voltemos ao objetivo principal de nossa viagem - a nova linha de sistemas de armazenamento - Huawei Dorado V6.  Este artigo ir√° acenar para voc√™ um pouco do passado, como  Foi escrito antes do an√∫ncio oficial, mas publicado somente ap√≥s o lan√ßamento.  E assim, hoje analisamos tudo de interessante e saboroso que a Huawei preparou para n√≥s. </p><a name="habracut"></a><br><p><img src="https://habrastorage.org/webt/tq/ev/b4/tqevb4qfcfc3zadjk1texasfy94.png"><br>  A nova linha ter√° 5 modelos.  Todos os modelos, exceto 3000V6, podem estar em duas vers√µes - SAS e NVMe.  A interface do disco que voc√™ pode usar neste sistema, as portas de backend e o n√∫mero de unidades de disco que voc√™ pode instalar no sistema dependem da op√ß√£o.  O NVMe usa SSDs do tamanho de Palm, que s√£o mais finos que os SSDs SAS cl√°ssicos de 2,5 ‚Äùe podem acomodar at√© 36 unidades.  A nova linha √© All Flash e n√£o h√° configura√ß√µes de disco. </p><br><p><img src="https://habrastorage.org/webt/gg/f3/px/ggf3pxgpby4hojmgmepncvwgwli.jpeg"><br>  <i>Palm NVMe SSD</i> </p><br><p>  Na minha opini√£o, os modelos Dorado 8000 e 18000 parecem ser os mais interessantes: a Huawei os posiciona como um sistema sofisticado e, gra√ßas √† pol√≠tica de pre√ßos da Huawei, contrasta esses modelos de gama m√©dia com seu segmento de concorrentes.  √â sobre esses modelos que vou me concentrar hoje em minha an√°lise.  Imediatamente, observo que, devido √†s suas caracter√≠sticas de design, os sistemas mais novos de controlador duplo t√™m uma arquitetura um pouco diferente, diferente dos Dorado 8000 e 18000; portanto, nem tudo o que falarei hoje se aplica aos modelos mais jovens. </p><br><p>  Uma das principais caracter√≠sticas dos novos sistemas foi o uso de v√°rios chips de design pr√≥prio, cada um dos quais permite transportar a carga l√≥gica do processador central do controlador e adicionar funcionalidade a diferentes componentes. <br><img src="https://habrastorage.org/webt/v0/qf/hn/v0qfhnmuwftjqbjywytee5qrypq.png"></p><br><p>  O cora√ß√£o dos novos sistemas s√£o os processadores Kunpeng 920, desenvolvidos em tecnologias ARM e fabricados de forma independente pela Huawei.  Dependendo do modelo, o n√∫mero de n√∫cleos varia, sua frequ√™ncia e o n√∫mero de processadores instalados em cada controlador: <br>  Huawei Dorado V6 8000 - 2CPU, 64 n√∫cleos <br>  Huawei Dorado V6 18000 - 4CPU, 48 n√∫cleos <br><img src="https://habrastorage.org/webt/ry/dx/i4/rydxi40psrto73xx1dgz78kq_be.png"></p><br><p>  A Huawei desenvolveu esse processador na arquitetura ARM e, at√© onde eu sei, planejava coloc√°-lo apenas nos modelos Dorado 8000 e 18000 mais antigos, como aconteceu com alguns modelos V5, mas as san√ß√µes fizeram ajustes nessa id√©ia.  Claro, a ARM tamb√©m falou sobre a recusa de coopera√ß√£o com a Huawei durante a imposi√ß√£o de san√ß√µes, mas aqui a situa√ß√£o √© diferente da Intel.  A Huawei produz esses chips por conta pr√≥pria, e nenhuma san√ß√£o pode parar esse processo.  O rompimento das rela√ß√µes com a ARM amea√ßa apenas a perda de acesso a novos desenvolvimentos.  Quanto ao desempenho - aqui ser√° poss√≠vel julgar somente ap√≥s a realiza√ß√£o de testes independentes.  Embora eu tenha visto como o 1M IOPS foi removido do sistema Dorado 18000 sem problemas, at√© fazer isso com minhas pr√≥prias m√£os no rack, n√£o acredito.  Mas as capacidades nos controladores realmente n√£o s√£o suficientes.  Os modelos mais antigos est√£o equipados com 4 controladores, cada um com 4 processadores instalados, o que fornece um total de 768 n√∫cleos. <br><img src="https://habrastorage.org/webt/so/rq/ge/sorqge26yqm7i3j0gl7gm3dyqyo.jpeg"></p><br><p>  Mas vou falar sobre os kernels ainda mais tarde, quando olharmos para a arquitetura de novos sistemas, mas por enquanto vamos voltar para outro chip instalado no sistema.  O chip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ascend 310</a> parece uma solu√ß√£o extremamente interessante (como eu o entendo, o irm√£o mais novo do Ascend 910, que foi recentemente apresentado ao p√∫blico).  Sua tarefa √© analisar os blocos de dados que chegam ao sistema para aumentar a taxa de acertos de leitura.  Ainda √© dif√≠cil dizer como ele se mostrar√° no trabalho, porque  Hoje, ele funciona apenas de acordo com um determinado padr√£o e n√£o tem a capacidade de aprender em um modo intelectual.  A apar√™ncia de um modo inteligente √© prometida no firmware futuro, provavelmente no in√≠cio do pr√≥ximo ano. </p><br><p>  Vamos para a arquitetura.  A Huawei continuou a desenvolver sua pr√≥pria tecnologia Smart Matrix, que implementa uma abordagem de malha completa para conectar componentes.  Mas se na V5 era apenas para o acesso dos controladores aos discos, agora todos os controladores t√™m acesso a todas as portas no back-end e no front-end. <br><img src="https://habrastorage.org/webt/sq/4v/no/sq4vnozkqfimysajqmkepxlnzy0.png"></p><br><p>  Gra√ßas √† nova arquitetura de microsservi√ßo, isso tamb√©m permite equilibrar a carga entre todos os controladores, mesmo que exista apenas um lun.  O SO dessa linha de matrizes foi desenvolvido do zero e n√£o apenas otimizado para o uso de drives Flash.  Devido ao fato de todos os controladores terem acesso √†s mesmas portas, no caso de falha ou reinicializa√ß√£o do controlador, o host n√£o perde um √∫nico caminho para o sistema de armazenamento e a troca de caminho √© realizada no n√≠vel do sistema de armazenamento de dados.  Ao mesmo tempo, o uso do UltraPath no host n√£o √© uma necessidade estrita.  Outra "economia" na instala√ß√£o do sistema √© um n√∫mero menor de links necess√°rios.  E se, com a abordagem "cl√°ssica" de 4 controladores, precisarmos de 8 links de 2 f√°bricas, no caso da Huawei, at√© 2 ser√£o suficientes (n√£o estou falando agora da sufici√™ncia da largura de banda de um link). <br><img src="https://habrastorage.org/webt/hr/a9/pq/hra9pqgs3u61zday9wnciwxkrcy.png"></p><br><p>  Como na vers√£o anterior, um cache global com espelhamento √© usado.  Isso permite que voc√™ perca at√© dois controladores simultaneamente ou tr√™s controladores em s√©rie sem afetar a disponibilidade.  Mas vale a pena notar que n√£o vimos um balanceamento de carga total entre os tr√™s controladores restantes em caso de falha de um, no suporte de demonstra√ß√£o.  A carga do controlador com falha foi completamente assumida por um dos demais.  √â poss√≠vel que, para isso, seja necess√°rio deixar o sistema trabalhar por mais tempo nessa configura√ß√£o.  De qualquer forma, em meus pr√≥prios testes, verificarei isso com mais detalhes. <br>  A Huawei est√° posicionando novos sistemas como um sistema NVMe de ponta a ponta, mas no momento o front-end do NVMeOF ainda n√£o √© suportado, apenas FC, iSCSI ou NFS.  No final deste ou no in√≠cio do pr√≥ximo, como outros chips, prometemos suporte ao RoCE. <br><img src="https://habrastorage.org/webt/qw/bb/ta/qwbbtadffklr9azbeiuvwerwx-m.png"></p><br><p>  As prateleiras s√£o conectadas aos controladores da mesma maneira usando o RoCE, e isso tem uma desvantagem - a falta de uma conex√£o em ‚Äúloop‚Äù das prateleiras, como foi o caso do SAS.  Na minha opini√£o, embora essa seja uma grande desvantagem, se voc√™ planejou um sistema bastante grande.  O fato √© que todas as prateleiras s√£o conectadas em s√©rie, e a falha de uma das prateleiras implica a inacessibilidade completa de todas as outras que a seguem.  Nesse caso, para garantir a toler√¢ncia a falhas, precisamos conectar todas as prateleiras aos controladores, o que implica um aumento no n√∫mero necess√°rio de portas de back-end no sistema. </p><br><p>  E mais uma coisa que vale a pena mencionar √© a atualiza√ß√£o sem interrup√ß√£o (NDU).  Como eu disse acima, a Huawei implementou uma abordagem de cont√™iner na opera√ß√£o do sistema operacional para a nova linha Dorado, permitindo atualizar e reiniciar servi√ßos, sem a necessidade de uma reinicializa√ß√£o completa do controlador.  Vale ressaltar imediatamente que algumas atualiza√ß√µes conter√£o atualiza√ß√µes do kernel e, nesse caso, a reinicializa√ß√£o cl√°ssica dos controladores √†s vezes ainda ser√° necess√°ria durante a atualiza√ß√£o, mas nem sempre.  Isso reduzir√° o n√≠vel de influ√™ncia dessa opera√ß√£o no sistema produtivo. </p><br><p>  Em nosso arsenal, a grande maioria das matrizes da empresa NetApp.  Portanto, acho que ser√° bastante l√≥gico fazer uma pequena compara√ß√£o com os sistemas com os quais tenho que trabalhar bastante.  Esta n√£o √© uma tentativa de determinar quem √© melhor e quem √© pior ou cuja arquitetura √© mais vantajosa.  Tentarei com sobriedade e sem fanatismo comparar duas abordagens diferentes para resolver o mesmo problema de diferentes fornecedores.  Sim, √© claro, neste caso, consideraremos os sistemas da Huawei em "teoria" e tamb√©m observarei separadamente aqueles momentos que apenas est√£o planejados para serem implementados em vers√µes futuras de firmware.  Quais s√£o as vantagens que eu vejo no momento: </p><br><ol><li>  O n√∫mero de unidades NVMe suportadas.  Hoje, a NetApp possui um n√∫mero de 288, Huawei, dependendo do modelo - 1600-6400.  Ao mesmo tempo, a capacidade m√°xima utiliz√°vel da Huawei √© 32PBe, como os sistemas NetApp (para ser mais preciso, eles t√™m 31,64PBe).  E isso apesar do fato de que unidades do mesmo volume s√£o suportadas (at√© 15 TB).  A Huawei explica esse fato da seguinte forma - eles n√£o tiveram a oportunidade de montar um estande maior.  Em teoria, eles n√£o t√™m limite de volume, mas simplesmente n√£o foram capazes de testar esse fato.  Mas vale a pena notar que os recursos das unidades flash s√£o muito altos atualmente e, no caso dos sistemas NVMe, somos confrontados com o fato de que 24 unidades s√£o suficientes para utilizar o sistema de 2 controladores de √∫ltima gera√ß√£o.  Consequentemente, um aumento adicional no n√∫mero de discos no sistema n√£o apenas n√£o proporcionar√° um ganho de desempenho, mas tamb√©m afetar√° adversamente a propor√ß√£o IOPS / Tb.  Obviamente, vale a pena ver quantas unidades os sistemas de 4 controladores 8000 e 16000 podem retirar, porque  as capacidades e o potencial do Kunpeng 920 ainda n√£o est√£o completamente claros. </li><li>  Lun tem um propriet√°rio nos sistemas NetApp.  I.e.  apenas um controlador pode executar opera√ß√µes com a lua, enquanto o segundo apenas passa IO por si mesmo.  Os sistemas Huawei, pelo contr√°rio, n√£o possuem propriet√°rios e as opera√ß√µes com blocos de dados (compacta√ß√£o, desduplica√ß√£o) podem ser executadas por qualquer um dos controladores, bem como gravadas em discos. </li><li>  Nenhuma queda de porta em caso de falha de um dos controladores.  Para alguns, esse momento parece extremamente cr√≠tico.  A conclus√£o √© que a troca dentro do sistema de armazenamento deve ser mais r√°pida do que no lado do host.  E se no caso da mesma NetApp, na pr√°tica, revelamos um friso da ordem de 5 segundos ao puxar o controlador e mudar de caminho, a mudan√ßa para a Huawei ainda n√£o foi praticada. </li><li>  N√£o h√° necessidade de reiniciar o controlador durante a atualiza√ß√£o.  Fiquei especialmente preocupado com isso com o lan√ßamento bastante frequente de novas vers√µes e ramifica√ß√µes de firmware para o NetApps.  Sim, algumas atualiza√ß√µes da Huawei ainda exigir√£o uma reinicializa√ß√£o, mas n√£o todas. </li><li>  4 controladores Huawei pelo pre√ßo de dois controladores NetApp.  Como eu disse acima, gra√ßas √† pol√≠tica de pre√ßos da Huawei, ela pode competir com a gama m√©dia com seus modelos Hight-end. </li><li>  A presen√ßa de chips adicionais nos controladores de prateleira e nas placas de porta, com o objetivo potencial de aumentar a efici√™ncia do sistema. </li></ol><br><p>  Contras e medos em geral: </p><br><ol><li>  Conex√£o direta de prateleiras aos controladores ou a necessidade de um grande n√∫mero de portas de back-end para conectar todas as prateleiras aos controladores. </li><li>  Arquitetura ARM e presen√ßa de um grande n√∫mero de chips - com que efici√™ncia ele funcionar√° e se haver√° desempenho suficiente. </li></ol><br><p>  A maioria dos medos e medos ser√° capaz de dissipar os pr√≥prios testes da nova linha.  Espero que logo ap√≥s o lan√ßamento eles j√° apare√ßam em Moscou e que haja n√∫mero suficiente deles para obter rapidamente um para seus pr√≥prios testes.  At√© agora, podemos dizer que a abordagem da empresa como um todo parece interessante, e a nova linha parece muito boa contra os concorrentes.  a implementa√ß√£o final levanta muitas quest√µes, porque  veremos muitas coisas apenas no final do ano, e talvez apenas em 2020. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt467975/">https://habr.com/ru/post/pt467975/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt467961/index.html">Problemas e nuances ao desenvolver para SmartTV usando React.js</a></li>
<li><a href="../pt467965/index.html">Vivaldi 2.8 - Menu, por favor</a></li>
<li><a href="../pt467967/index.html">Imers√£o em redes neurais convolucionais: transfer√™ncia de aprendizado</a></li>
<li><a href="../pt467969/index.html">Apresenta√ß√µes modais de tela modal no iOS 13</a></li>
<li><a href="../pt467973/index.html">Nascimento da plataforma</a></li>
<li><a href="../pt467977/index.html">Criando um aplicativo usando componentes com estilo no Vue.js</a></li>
<li><a href="../pt467979/index.html">Integra√ß√µes de publicidade: como funciona?</a></li>
<li><a href="../pt467981/index.html">Servidor de rack Cisco UCS C240 ‚Äã‚ÄãM5 Anboxing</a></li>
<li><a href="../pt467983/index.html">Por que voc√™ deve expulsar o MVP de seus projetos</a></li>
<li><a href="../pt467987/index.html">Gel√©ia colorida e animada: tomada de decis√£o em n√≠vel de material sem CPU</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>