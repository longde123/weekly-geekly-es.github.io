<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСитАНтЭдя╕ПтАНЁЯСи ЁЯСиЁЯП╛тАНтЬИя╕П ЁЯР░ "рд╣реЗрд▓реЛ, рдЪреЗрдХрдорд╛рд░рдХреНрд╕!" Checkmarx SAST рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХреИрд╕реЗ рд▓рд┐рдЦреЗрдВ рдФрд░ рд╢рд╛рдВрдд рднреЗрджреНрдпрддрд╛ рдЦреЛрдЬреЗрдВ ЁЯНЧ ЁЯСйЁЯП╗тАНЁЯЪА ЁЯНГ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдирдорд╕реНрдХрд╛рд░, рд╣реЗрдмреНрд░! 

 рд▓реЗрдЦ рдореЗрдВ рдореИрдВ Checkmarx SAST рдореЗрдВ рдЕрдкрдиреЗ рдкреНрд░рд╢реНрди рдмрдирд╛рдиреЗ рдХреЗ рд╣рдорд╛рд░реЗ рдЕрдиреБрднрд╡ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВред 

 рдЬрдм рдЖрдк рдкрд╣рд▓реА рдмрд╛рд░ рдЗрд╕ рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рд╕реЗ рдкрд░...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>"рд╣реЗрд▓реЛ, рдЪреЗрдХрдорд╛рд░рдХреНрд╕!" Checkmarx SAST рдХреЗ рд▓рд┐рдП рдЕрдиреБрд░реЛрдз рдХреИрд╕реЗ рд▓рд┐рдЦреЗрдВ рдФрд░ рд╢рд╛рдВрдд рднреЗрджреНрдпрддрд╛ рдЦреЛрдЬреЗрдВ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dins/blog/477742/"><img src="https://habrastorage.org/webt/sh/ll/ln/shlllnc6iduoendolw26rabdugk.jpeg"><br><br>  рдирдорд╕реНрдХрд╛рд░, рд╣реЗрдмреНрд░! <br><br>  рд▓реЗрдЦ рдореЗрдВ рдореИрдВ Checkmarx SAST рдореЗрдВ рдЕрдкрдиреЗ рдкреНрд░рд╢реНрди рдмрдирд╛рдиреЗ рдХреЗ рд╣рдорд╛рд░реЗ рдЕрдиреБрднрд╡ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рдирд╛ рдЪрд╛рд╣рддрд╛ рд╣реВрдВред <br><br>  рдЬрдм рдЖрдк рдкрд╣рд▓реА рдмрд╛рд░ рдЗрд╕ рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рд╕реЗ рдкрд░рд┐рдЪрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рддреЛ рдЖрдкрдХреЛ рдпрд╣ рдзрд╛рд░рдгрд╛ рдорд┐рд▓ рд╕рдХрддреА рд╣реИ рдХрд┐ рдХрдордЬреЛрд░ рдПрдиреНрдХреНрд░рд┐рдкреНрд╢рди / рд╣реИрд╢рд┐рдВрдЧ рдПрд▓реНрдЧреЛрд░рд┐рджрдо рдФрд░ рдЭреВрдареЗ рд╕рдХрд╛рд░рд╛рддреНрдордХ рдХреЗ рдвреЗрд░ рдХреА рдЦреЛрдЬ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдпрд╣ рдХреБрдЫ рдФрд░ рдирд╣реАрдВ рд▓реМрдЯрд╛рддрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдЬрдм рдареАрдХ рд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рддреЛ рдпрд╣ рдПрдХ рд╕реБрдкрд░ рд╢рдХреНрддрд┐рд╢рд╛рд▓реА рдЙрдкрдХрд░рдг рд╣реИ рдЬреЛ рдЧрдВрднреАрд░ рдмрдЧ рдХреА рддрд▓рд╛рд╢ рдХрд░ рд╕рдХрддрд╛ рд╣реИред <br><br>  рд╣рдо Checkmarx SAST рдХреНрд╡реЗрд░реА рднрд╛рд╖рд╛ рдХреА рдкреЗрдЪреАрджрдЧрд┐рдпреЛрдВ рдХреЛ рд╕рдордЭреЗрдВрдЧреЗ рдФрд░ SQL рдЗрдВрдЬреЗрдХреНрд╢рди рдФрд░ рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдкреНрд░рддреНрдпрдХреНрд╖ рд╡рд╕реНрддреБ рд╕рдВрджрд░реНрдн рдХреЗ рд▓рд┐рдП рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП 2 рдХреНрд╡реЗрд░реА рд▓рд┐рдЦреЗрдВрдЧреЗред <br><a name="habracut"></a><br><br><h2>  рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ </h2><br>  рдЪреЗрдХрдорд░реИрдХреНрд╕ рдкрд░ рдХрд┐рд╕реА рднреА рдЧрд╛рдЗрдб рдпрд╛ рд▓реЗрдЦ рдХреА рд▓рдВрдмреА рдЦреЛрдЬ рдХреЗ рдмрд╛рдж, рдпрд╣ рдореЗрд░реЗ рд▓рд┐рдП рд╕реНрдкрд╖реНрдЯ рд╣реЛ рдЧрдпрд╛ рдХрд┐ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рджрд╕реНрддрд╛рд╡реЗрдЬ рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдкрд░реНрдпрд╛рдкреНрдд рдЙрдкрдпреЛрдЧреА рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рдереАред  рдФрд░ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рджрд╕реНрддрд╛рд╡реЗрдЬ рдпрд╣ рдирд╣реАрдВ рдХрд╣рддреЗ рд╣реИрдВ рдХрд┐ рд╕рдм рдХреБрдЫ рдмрд╣реБрдд рд╕реНрдкрд╖реНрдЯ рдФрд░ рд╕рдордЭ рдореЗрдВ рдЖрддрд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдореБрдЭреЗ рдХреЛрдИ рднреА рд╕рд░реНрд╡реЛрддреНрддрдо рдЕрднреНрдпрд╛рд╕ рдирд╣реАрдВ рдорд┐рд▓рд╛, рдУрд╡рд░рд░рд╛рдЗрдб рдкреНрд░рд╢реНрдиреЛрдВ рдХреЛ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХреИрд╕реЗ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдП, рдХреНрд╡реЗрд░реА рдХреЛ "рдбрдореАрдЬрд╝ рдХреЗ рд▓рд┐рдП" рдХреИрд╕реЗ рд▓рд┐рдЦрд╛ рдЬрд╛рдП, рдЖрджрд┐, рд╣рд╛рдБ, рд╕реАрдПрдордПрдХреНрд╕ рдХреНрд╡реЗрд░реА рд▓реИрдВрдЧреНрд╡реЗрдЬ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдкрд░ рдкреНрд░рд▓реЗрдЦрди рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣рд╛рдБ рдЗрди рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдПрдХ рд╣реА рдХреНрд╡реЗрд░реА рдореЗрдВ рд╕рдВрдпреЛрдЬрд┐рдд рдХрд░рдиреЗ рдХрд╛ рддрд░реАрдХрд╛ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИред рдкреНрд░рд▓реЗрдЦрди рдирд╣реАрдВ рд▓рд┐рдЦрд╛ рд╣реИред <br><br>  рд╢рд╛рдпрдж рдЪреЗрдХрдорд╛рд░реИрдХреНрд╕ рд╕рдореБрджрд╛рдп рдХреЗ рд▓реЗрдЦреЛрдВ рдФрд░ рдЧрд╛рдЗрдбреЛрдВ рдХреА рдХрдореА рдЙрдкрдХрд░рдг рдХреА рдЙрдЪреНрдЪ рд▓рд╛рдЧрдд рдХреЗ рд╕рд╛рде рдЬреБрдбрд╝реА рд╣реБрдИ рд╣реИ рдФрд░, рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдПрдХ рдЫреЛрдЯрд╛ рджрд░реНрд╢рдХред  рдпрд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ рдХрд┐ рдХреБрдЫ рд╣реА рд▓реЛрдЧ рдлрд╛рдЗрди-рдЯреНрдпреВрдирд┐рдВрдЧ рд╕реЗ рдкрд░реЗрд╢рд╛рди рд╣реЛрдВ рдФрд░ рд╕рдорд╛рдзрд╛рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдмреЙрдХреНрд╕ рд╕реЗ рдмрд╛рд╣рд░ рд╣реИред <br><br>  рдЕрдкрдиреЗ рдЕрдиреБрднрд╡ рдореЗрдВ, рдореИрдВ рдпрд╣ рджреЗрдЦрддрд╛ рд╣реВрдВ рдХрд┐ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдмрдЧреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЧреНрд░рд╛рд╣рдХреЛрдВ рдХреА рдУрд░ рд╕реЗ рд╡рд┐рднрд┐рдиреНрди рдЖрд╡рд╢реНрдпрдХрддрд╛рдУрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдФрдкрдЪрд╛рд░рд┐рдХрддрд╛рдУрдВ рдХрд╛ рдкрд╛рд▓рди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП SAST рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдзрд┐рдХ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХреЗ рд╕рд╛рде, рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдорд╛рд░реЗ рдкрд╛рд╕, "рдХрдордЬреЛрд░рд┐рдпреЛрдВ" рдХреА рдЕрдкреЗрдХреНрд╖рд╛рдХреГрдд рдХрдо рд╕рдВрдЦреНрдпрд╛ рд╣реИ, рдЬреЛ рд▓рдЧрднрдЧ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ "рд╢реЛрд╖рдХ рдирд╣реАрдВ" рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ (рдХреНрдпреЛрдВрдХрд┐ рд╡реЗ 99.9% рдорд╛рдорд▓реЛрдВ рдореЗрдВ рд╣реИрдВ)ред <br><br>  рдпрд╣ рдзреНрдпрд╛рди рджрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдХрд┐ рдЪреЗрдХрдорд╛рд░рдХреНрд╕ рд╕реНрд╡рдпрдВ рдЕрдкрдиреЗ рдкреНрд░рд╢реНрдиреЛрдВ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░ рд░рд╣рд╛ рд╣реИ рддрд╛рдХрд┐ рд╡реЗ рдЖрдЙрдЯ рдСрдл рдж рдмреЙрдХреНрд╕ рд╕рдмрд╕реЗ рдЕрдЪреНрдЫрд╛ рдкрд░рд┐рдгрд╛рдо рджреЗрдВред  рд▓реЗрдХрд┐рди CMx рдХреНрд╡реЗрд░реА рднрд╛рд╖рд╛ рдХреЗ рдкреНрд░рд╢реНрди "рд╕рд╛рдорд╛рдиреНрдп рдорд╛рдорд▓реЗ" рдХреЗ рдЕрдиреБрд░реВрдк рд╣реИрдВред  рдЯреЛрдХрди рдХреА рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдЦреЛрдЬ рдирд╛рдо рдкрд░ рдЖрдзрд╛рд░рд┐рдд рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, CMx SAST рдорд╛рдирддрд╛ рд╣реИ рдХрд┐ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рднреА рдкреНрд░рд╢реНрди рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗ: * createQuery * рдпрд╛ * createSQLQuery *ред  рд▓реЗрдХрд┐рди рдЕрдЧрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрдВрддрд░рд┐рдХ рд╡рд┐рдХрд╛рд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╡рд┐рдзрд┐ рдХреЛ рдЕрд▓рдЧ рддрд░рд╣ рд╕реЗ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП * driveMyQuery *, рддреЛ рд╕рднреА SQL рд╡рд┐рдзрд┐рдпрд╛рдВ рдЫреЛрдбрд╝ рджреА рдЬрд╛рдПрдВрдЧреАред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдорд╛рд░рд╛ рдЧреНрд░рд╛рд╣рдХ SQL DB рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо ORM рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдмреЙрдХреНрд╕ рд╕реЗ рдмрд╛рд╣рд░ CMx рдХреНрд╡реЗрд░реАрдЬрд╝ рд╕рднреА SQL рдЗрдВрдЬреЗрдХреНрд╢рдиреЛрдВ рдХреЛ рдЫреЛрдбрд╝ рджреЗрддрд╛ рд╣реИред <br><br><h4>  рд╕рдВрдХреЗрддрд╛рдХреНрд╖рд░ рдФрд░ рдкрд░рд┐рднрд╛рд╖рд╛рдПрдБ </h4><br>  <b>CMx</b> - <b>рдЪреЗрдХрдорд╛рд░рдХреНрд╕</b> SASTред <br>  <b>CMxQL</b> - <b>рдЪреЗрдХрдорд╛рд░рдХреНрд╕</b> SAST рдХреНрд╡реЗрд░реА рднрд╛рд╖рд╛ <br>  <b>рдЯреЛрдХрди</b> - рдПрдХ рдирд┐рд╢реНрдЪрд┐рдд рдореВрд▓реНрдп рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд▓реЗрдХреНрд╕рд┐рдХрд▓ рд╡рд┐рд╢реНрд▓реЗрд╖рдХ рдХреЗ рдХрд╛рдо рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реИ (рдЬрд┐рд╕реЗ рдЯреЛрдХрди рднреА рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ) <br><br><h3>  рдкрд░реАрдХреНрд╖рдг рдЖрд╡реЗрджрди </h3><br>  рдПрдХ рд▓реЗрдЦ рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдХреБрдЫ рдЬрд╛рд╡рд╛ рдХреЛрдб, рдПрдХ рдЫреЛрдЯрд╛ рдкрд░реАрдХреНрд╖рдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╕реНрдХреЗрдЪ рдХрд┐рдпрд╛ред  рдпрд╣ рдХреЛрдб рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдкреНрд░рдгрд╛рд▓реА рдХреЗ рдПрдХ рдЫреЛрдЯреЗ рд╕реЗ рд╣рд┐рд╕реНрд╕реЗ рдХреА рдЕрдиреБрдорд╛рдирд┐рдд рдкреНрд░рддрд┐ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рдкрд░реАрдХреНрд╖рдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рдХреЛрдб рдХрд┐рд╕реА рднреА рдЕрдиреНрдп HTTP рдмреИрдХрдПрдВрдб рдХреЛрдб рд╕реЗ рдмрд╣реБрдд рдЕрд▓рдЧ рдирд╣реАрдВ рд╣реИред  рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛрдб рдХреЗ рдкреНрд░рдореБрдЦ рднрд╛рдЧ рджрд┐рдЦрд╛рдИ рджреЗрдВрдЧреЗред <br><br><h4>  рдкрд░реАрдХреНрд╖рдг рдЖрд╡реЗрджрди рдореЗрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рдВрд░рдЪрдирд╛ рд╣реИ </h4><br>  рдЗрдирдХрдорд┐рдВрдЧ HTTP рд░рд┐рдХреНрд╡реЗрд╕реНрдЯ рдХреЛ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <i>WebRouter</i> рдХреНрд▓рд╛рд╕; рдЕрдВрджрд░ рдпреВрдЖрд░рдПрд▓ рдкреНрд░реЛрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ 4 рддрд░реАрдХреЗ: <br><ul><li>  <i>/ getTransaction</i> - рдЗрдирдкреБрдЯ <i>рдЖрдИрдбреА</i> рдкрд░ рд▓реЗрдирджреЗрди <i>рдЖрдИрдбреА</i> рдХреЛ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ <i>рдФрд░ рдЙрд╕</i> рдкрд░ <i>рдЬрд╛рдирдХрд╛рд░реА рджреЗрддрд╛</i> рд╣реИ, <i>рдЖрдИрдбреА</i> рдЗрд╕реЗ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрддрд╛ рд╣реИ, рдФрд░ рдЗрд╕реЗ <i>getTransactionInfo (transactionId)</i> =&gt; <i>getTransactionInfo (transactoinId) рдкрд░ рднреЗрдЬ</i> рджреЗрддрд╛ рд╣реИ - SQL рдХреНрд╡реЗрд░реА (рдпрд╛рдиреА, SQL рдЗрдВрдЬреЗрдХреНрд╢рди рдкреНрд░рд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИ) рдХреЗ рд▓рд┐рдП <i>TransIdate</i> рдмрдирд╛рддрд╛ рд╣реИ; </li><li>  <i>/ getSecureTransaction</i> - рд▓реЗрди-рджреЗрди <i>рдЖрдИрдбреА</i> рдХреЛ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ <i>рдФрд░ рдЙрд╕</i> рдкрд░ <i>рдЬрд╛рдирдХрд╛рд░реА рд▓реМрдЯрд╛рддрд╛</i> рд╣реИ, <i>рдЖрдИрдбреА</i> рдЗрд╕реЗ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ <i>рдкреНрд░рд╛рдкреНрдд</i> <i>рдХрд░рддрд╛ рд╣реИред</i> рдорд╛рдорд▓рд╛ рдЗрдВрдЬреЗрдХреНрд╢рди рдХрд╛ рд╢реЛрд╖рдг рдирд╣реАрдВ рд╣реИ); </li><li>  <i>/ getSettings</i> - <i>рдПрдХ рдЗрдирдкреБрдЯ рдХреЗ рд░реВрдк рдореЗрдВ</i> <i>userId</i> рдФрд░ <i>iPodId рдХреЛ</i> рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ - рдФрд░ рдореЗрд▓рдмреЙрдХреНрд╕ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдЬрд╛рд░реА рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рд╕рддреНрдпрд╛рдкрд┐рдд рдирд╣реАрдВ рдХрд░рддрд╛ рдХрд┐ <i>рдореЗрд▓рдмреЙрдХреНрд╕рд┐рдб</i> рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХрд╛ рд╣реИ; </li><li>  <i>/ getSecureSettings</i> - рднреА <i>рдЗрдирдкреБрдЯ рдХреЗ рд▓рд┐рдП</i> <i>userId</i> рдФрд░ <i>рдореЗрд▓рдмреЙрдХреНрд╕рдЖрдИрдб рдХреЛ</i> рд╕реНрд╡реАрдХрд╛рд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдореЗрд▓рдмреЙрдХреНрд╕ рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рддрд╛ рд╣реИред  BUT рдпрд╣ рдЬрд╛рдБрдЪрддрд╛ рд╣реИ рдХрд┐ <i>рдореЗрд▓рдмреЙрдХреНрд╕</i> рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдЖрддрд╛ рд╣реИред </li></ul><br><br><h2>  CMx: рд╕рд╛рдорд╛рдиреНрдп рд╕реВрдЪрдирд╛ рдФрд░ рдмреБрдирд┐рдпрд╛рджреА рдкрд░рд┐рднрд╛рд╖рд╛ </h2><br><h3>  рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ рдХрд┐ рдЖрдк рдкреНрд░рд╢реНрдиреЛрдВ рдХреЛ рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ </h3><br>  рдХреНрд╡реЗрд░реА рдбреЗрд╡рд▓рдкрдореЗрдВрдЯ рдПрдХ рдЕрд▓рдЧ рдкреНрд░реЛрдЧреНрд░рд╛рдо CxAuditor рдореЗрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  CxAuditor рдореЗрдВ рдЖрдкрдХреЛ рд╕рднреА рдХреЛрдб (рд╕реНрдерд╛рдиреАрдп рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдмрдирд╛рдиреЗ) рдХреЛ рд╕реНрдХреИрди рдХрд░рдирд╛ рд╣реЛрдЧрд╛, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╣рдо рдХреНрд╡реЗрд░реАрдЬрд╝ рд▓рд┐рдЦреЗрдВрдЧреЗред  рдЙрд╕рдХреЗ рдмрд╛рдж, рдЖрдк рдирдП рдкреНрд░рд╢реНрдиреЛрдВ рдХреЛ рд▓рд┐рдЦ рдФрд░ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдПрдХ рдмрдбрд╝реЗ рдХреЛрдб рдмреЗрд╕ рдХреЗ рд╕рд╛рде, рдкреНрд░рд╛рдердорд┐рдХ рд╕реНрдХреИрдирд┐рдВрдЧ рдореЗрдВ рдШрдВрдЯреЛрдВ рдХрд╛ рд╕рдордп рдФрд░ рд╕реНрдореГрддрд┐ рдХреЗ рдЧреАрдЧрд╛рдмрд╛рдЗрдЯреНрд╕ рд▓рдЧ рд╕рдХрддреЗ рд╣реИрдВред  рдЙрд╕рдХреЗ рдмрд╛рдж, рдкреНрд░рддреНрдпреЗрдХ рдЕрдиреБрд░реЛрдз рдХреЛ рддреЗрдЬреА рд╕реЗ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред  рдпрд╣ рд╡рд┐рдХрд╛рд╕ рдХреЗ рд▓рд┐рдП рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрдиреБрдкрдпреБрдХреНрдд рд╣реИред <br><br>  рдЗрд╕рд▓рд┐рдП, рдЖрдк рдкреНрд░реЛрдЬреЗрдХреНрдЯ рд╕реЗ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХрд╛ рдПрдХ рдЫреЛрдЯрд╛ рд╕рд╛ рд╕реЗрдЯ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ, рдЖрджрд░реНрд╢ рд░реВрдк рд╕реЗ рдЙрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдЕрдЧреНрд░рд┐рдо рдореЗрдВ рдХреЛрдб рдореЗрдВ рдкрд╛рдП рдЧрдП рдмрдЧ рдХреЗ рд╕рд╛рде рдЬрд┐рд╕рдХреЗ рддрд╣рдд рд╣рдо рдПрдХ рдЕрдиреБрд░реЛрдз рд▓рд┐рдЦ рд░рд╣реЗ рд╣реИрдВ (рдпрд╛ рдЕрдкрдиреЗ рд╣рд╛рдереЛрдВ рд╕реЗ рдмрдЧ рдХреЛ рд╡рд╣рд╛рдВ рд░рдЦреЗрдВ) рдФрд░ рдХреЗрд╡рд▓ рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдЗрд╕ рд╕реЗрдЯ рдХреЛ рд╕реНрдХреИрди рдХрд░реЗрдВред  рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рдлрд╝рд╛рдЗрд▓ рд╕рдВрд░рдЪрдирд╛ рдХрд╛ рдЕрдиреБрдкрд╛рд▓рди рдХрд░рдирд╛ рдЖрд╡рд╢реНрдпрдХ рдирд╣реАрдВ рд╣реИред  рдпрд╣реА рд╣реИ, рдЕрдЧрд░ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЬрд╛рд╡рд╛ рдкреИрдХреЗрдЬ рдП рдФрд░ рдмреА рд╣реИ, рдФрд░ рдкреИрдХреЗрдЬ рдмреА рдореЗрдВ рдХрдХреНрд╖рд╛рдПрдВ рдП рдХреЗ рд╡рд░реНрдЧреЛрдВ рдФрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреА рд╣реИрдВ, рддреЛ рдЖрдк рдпрд╣ рд╕рдм рдПрдХ рд╣реА рдирд┐рд░реНрджреЗрд╢рд┐рдХрд╛ рдореЗрдВ рдбрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╕реАрдПрдордПрдХреНрд╕ рдЕрднреА рднреА рд░рд┐рд╢реНрддреЛрдВ рдХреЛ рд╕рдордЭреЗрдВрдЧреЗ рдФрд░ рдлрд╛рдЗрд▓реЛрдВ рдХреЗ рдмреАрдЪ рдХреЙрд▓ рдЪреЗрди рдХреЛ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ (рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ, рдпрд╛ рд▓рдЧрднрдЧ) рдмрдирд╛рдПрдВрдЧреЗред рд╣рдореЗрд╢рд╛ рд╕рд╣реА, рд╣рд╛рд▓рд╛рдВрдХрд┐ рддреНрд░реБрдЯрд┐рдпрд╛рдВ рд╢рд╛рдпрдж рд╣реА рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреА рдлрд╝рд╛рдЗрд▓ рд╕рдВрд░рдЪрдирд╛ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣реИрдВ)ред <br><br><h3>  рдореВрд▓ рдкрд░рд┐рднрд╛рд╖рд╛рдПрдБ </h3><br><h4>  CxList </h4><br>  CMx рдореЗрдВ рдореБрдЦреНрдп рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ред  рд▓рдЧрднрдЧ рд╕рднреА CMxQL рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдкрд░рд┐рдгрд╛рдо CxList рд╣реЛрдЧрд╛ред  рдпрд╣ рдХреБрдЫ рдЧреБрдгреЛрдВ рд╡рд╛рд▓реЗ рддрддреНрд╡реЛрдВ рдХрд╛ рдПрдХ рдмрд╣реБрдд рд╣реИред  рд╡рд┐рдХрд╛рд╕ рдХреЗ рд▓рд┐рдП рд╕рдмрд╕реЗ рдЕрдзрд┐рдХ рдЙрдкрдпреЛрдЧреА рдЧреБрдгреЛрдВ рдХреЛ рдиреАрдЪреЗ рдорд╛рдирд╛ рдЬрд╛рдПрдЧрд╛ред <br><br><h4>  рдкрд░рд┐рдгрд╛рдо </h4><br>  CMxQL рдореЗрдВ рдПрдХ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдЪрд░ <i>рдкрд░рд┐рдгрд╛рдо рд╣реИ</i> ред  рд╡рд╣ рд╕реЗрдЯ рдЬрд┐рд╕рдореЗрдВ <i>рдкрд░рд┐рдгрд╛рдо</i> рдЪрд░ рд╣реЛрддрд╛ рд╣реИ, рд╕рдВрдкреВрд░реНрдг рдХреНрд╡реЗрд░реА рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рдмрд╛рдж рдкрд░рд┐рдгрд╛рдо рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ред <br><br>  рдЕрд░реНрдерд╛рддреН, рдХрд┐рд╕реА рднреА рдкреНрд░рд╢реНрди рдХрд╛ рдЕрдВрддрд┐рдо рд╕рдВрдЪрд╛рд▓рди рд╕реНрдЯреНрд░рд┐рдВрдЧ <i>рдкрд░рд┐рдгрд╛рдо =</i> рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: <br><pre><code class="actionscript hljs">result = All.FindByName(<span class="hljs-string"><span class="hljs-string">"anyname"</span></span>);</code> </pre> <br><h4>  рдкреНрд░рд╡рд╛рд╣ рдФрд░ рдХреЛрдб рддрддреНрд╡ </h4><br>  рд▓реМрдЯреЗ рд╣реБрдП рдорд╛рдиреЛрдВ рдХреЗ рдкреНрд░рдХрд╛рд░ рд╕реЗ рдЕрдзрд┐рдХрд╛рдВрд╢ CMxQL рдХрд╛рд░реНрдп 2 рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рд╣реЛрддреЗ рд╣реИрдВ, рдЬреЛ "рдХреЛрдб рдПрд▓рд┐рдореЗрдВрдЯреНрд╕" рдХреЛ рд╡рд╛рдкрд╕ рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдЬреЛ рдлреНрд▓реЛ рд▓реМрдЯрд╛рддреЗ рд╣реИрдВред  рджреЛрдиреЛрдВ рд╣реА рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдкрд░рд┐рдгрд╛рдо рдПрдХ <i>CxList рд╣реИ</i> ред  рд▓реЗрдХрд┐рди рдЗрд╕рдХреА рд╕рд╛рдордЧреНрд░реА рдлреНрд▓реЛ рдФрд░ рдХреЛрдб рддрддреНрд╡реЛрдВ рдХреЗ рд▓рд┐рдП рдереЛрдбрд╝реА рдЕрд▓рдЧ рд╣реЛрдЧреАред <br><ul><li>  <b>рдХреЛрдб рддрддреНрд╡</b> - рдЯреЛрдХрди - рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдЪрд░, рд╡рд┐рдзрд┐ рдХреЙрд▓, рдЕрд╕рд╛рдЗрдирдореЗрдВрдЯ, рдЖрджрд┐; </li><li>  <b>рдкреНрд░рд╡рд╛рд╣</b> - рджрд┐рдП рдЧрдП рдЯреЛрдХрди рдХреЗ рдмреАрдЪ рд╕рдВрдмрдВрдзред </li></ul><br><br><h4>  рд╕рднреА рдФрд░ "рдЙрдк" рд╕рднреА </h4><br>  рдкреНрд░рддреНрдпреЗрдХ CMxQL рдлрд╝рдВрдХреНрд╢рди рдХреЛ <i>рд╕рднреА</i> рд╕реЗрдЯ рдкрд░ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рдЗрд╕рдореЗрдВ рд╕рдВрдкреВрд░реНрдг рд╕реНрдХреИрди рдХреЛрдб рдХреЗ рд╕рднреА рдЯреЛрдХрди рд╢рд╛рдорд┐рд▓ рд╣реИрдВ, рд╣рдордиреЗ рдкрд╣рд▓реЗ рд╣реА <i>рдкрд░рд┐рдгрд╛рдо рдХреЗ</i> рд╕рд╛рде рдПрдХ рдЙрджрд╛рд╣рд░рдг рджреЗрдЦрд╛) рдпрд╛ <i>CxList</i> рд╕реЗрдЯ рдкрд░, рдЬреЛ рдмрджрд▓реЗ рдореЗрдВ рдХреНрд╡реЗрд░реА рдореЗрдВ рдХреБрдЫ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдХреНрд╡реЗрд░реА: <br><pre> <code class="actionscript hljs">CxList newList = CxList.New();</code> </pre> <br>  рдПрдХ рдЦрд╛рд▓реА рд╕реЗрдЯ рдмрдирд╛рдПрдЧрд╛, рдЬрд┐рд╕реЗ рд╣рдо рдлрд┐рд░ <i>рдРрдб ()</i> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рддрддреНрд╡реЛрдВ рд╕реЗ рднрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдирдП рд╕реЗрдЯ рдХреЗ рддрддреНрд╡реЛрдВ рджреНрд╡рд╛рд░рд╛ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЦреЛрдЬ рд╕рдХрддреЗ рд╣реИрдВ: <br><pre> <code class="actionscript hljs">CxList newFind = newList.FindByName(<span class="hljs-string"><span class="hljs-string">"narrowedScope"</span></span>);</code> </pre> <br><h4>  рдкрд╛рдпрд╛ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдЧреБрдг </h4><br>  CxList рд╕реЗрдЯ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдореЗрдВ рдХрдИ рдЧреБрдг рд╣реЛрддреЗ рд╣реИрдВред  рдкреНрд░рд╢реНрди рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдгрд╛рдореЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рддреЗ рд╕рдордп, рд╕рдмрд╕реЗ рдЙрдкрдпреЛрдЧреА рд╣реИрдВ: <br><br><ul><li>  <b>SourceFile</b> - рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдирд╛рдо рдЬрд┐рд╕рдореЗрдВ рдпрд╣ рддрддреНрд╡ рд╢рд╛рдорд┐рд▓ рд╣реИ; </li><li>  <b>рд╕реЛрд░реНрд╕ рд▓рд╛рдЗрди</b> - рдЯреЛрдХрди рдХреЗ рд╕рд╛рде рд▓рд╛рдЗрди рдирдВрдмрд░; </li><li>  <b>рд╕реНрд░реЛрдд рдХрд╛ рдирд╛рдо</b> - рдЯреЛрдХрди рдХрд╛ рдирд╛рдоред  рд╕рдорддреБрд▓реНрдп рдЯреЛрдХрди, рдЕрд░реНрдерд╛рдд рдпрджрд┐ рдЪрд░ рдХреЛ var1 рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ Source Name = var1; </li><li>  <b>рд╕реНрд░реЛрдд рдкреНрд░рдХрд╛рд░</b> - рдЯреЛрдХрди рдХрд╛ рдкреНрд░рдХрд╛рд░ред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдпрд╣ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реИ, рддреЛ рдпрд╣ рд╕реНрдЯреНрд░рд┐рдВрдЧрд▓рд┐рдЯрд░рд▓ рд╣реЛрдЧрд╛, рдпрджрд┐ рд╡рд┐рдзрд┐ рдХреЛ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ рдореЗрдердбрдЗрдирд╡реЛрдХ рдПрдХреНрд╕рдкреНрд░, рдФрд░ рдХрдИ рдЕрдиреНрдп; </li><li>  <b>рдЧрдВрддрд╡реНрдп рдлрд╝рд╛рдЗрд▓</b> </li><li>  <b>рдЧрдВрддрд╡реНрдп рд░реЗрдЦрд╛;</b> </li><li>  <b>рдЧрдВрддрд╡реНрдп рдХрд╛ рдирд╛рдо;</b> </li><li>  <b>рдЧрдВрддрд╡реНрдп рдкреНрд░рдХрд╛рд░ред</b> </li></ul><br><br>  рд╕реНрд░реЛрдд рдФрд░ рдЧрдВрддрд╡реНрдп рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣реЛрдВрдЧреЗ рдпрджрд┐ рдкрд░рд┐рдгрд╛рдо рд╕реЗрдЯ рдХреЗ рддрддреНрд╡ рдкреНрд░рд╡рд╛рд╣ рд╣реИрдВ, рдФрд░ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд рд╡реЗ рдореЗрд▓ рдХрд░реЗрдВрдЧреЗ рдпрджрд┐ рдкрд░рд┐рдгрд╛рдо рдХреЛрдб рддрддреНрд╡ рд╣реИрдВред <br><br><h2>  рдкреНрд░рд╢реНрди рдмрдирд╛рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ </h2><br>  рд╕рднреА CMxQL рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХрдИ рдкреНрд░рдХрд╛рд░реЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рдпрд╣рд╛рдБ, рдореЗрд░реА рд░рд╛рдп рдореЗрдВ, рдХреЛрдИ рднреА CMxQL рдкреНрд░рд▓реЗрдЦрди рдХреА рдореБрдЦреНрдп рдЦрд╛рдореА рдХреЛ рдиреЛрдЯ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рдЧреЛрджреА рдореЗрдВ рд╕рднреА рдХрд╛рд░реНрдпреЛрдВ рдХреЛ рдХреЗрд╡рд▓ рд╡рд░реНрдгрд╛рдиреБрдХреНрд░рдо рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЬрдмрдХрд┐ рдпрд╣ рдХрд╛рд░реНрдпрдХреНрд╖рдорддрд╛ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рдЙрдиреНрд╣реЗрдВ рд╕рдВрд░рдЪрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реЛрдЧрд╛ рдФрд░ рдХреЗрд╡рд▓ рддрдм рд╡рд░реНрдгрд╛рдиреБрдХреНрд░рдо рдореЗрдВред <br><br><ul><li>  рдЦреЛрдЬ рдХрд╛рд░реНрдп - <b>FindBy *</b> рдФрд░ <b>GetBy *</b> рдирд╛рдо рдХреЗ рд╕рд╛рде рд▓рдЧрднрдЧ рд╕рднреА CMxQL рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ; </li><li>  рд╕реЗрдЯ рдкрд░ рд╕рдВрдЪрд╛рд▓рди рдХреЗ рдХрд╛рд░реНрдп рдЗрд╕рдХреЗ рдЕрддрд┐рд░рд┐рдХреНрдд рд╣реИрдВ, рдШрдЯрд╛рд╡, рдЪреМрд░рд╛рд╣реЗ, рддрддреНрд╡реЛрдВ рдкрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐, рдЖрджрд┐ред </li><li>  рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛рд░реНрдп - рдпреЗ рдореВрд▓ рд░реВрдк рд╕реЗ <b>* InfluencedBy *</b> <b>* InfluencingOn *</b> рдлрд╝рдВрдХреНрд╢рди рд╣реИрдВред </li></ul><br><br>  рдкреНрд░рд╢реНрдиреЛрдВ рдХрд╛ рдореВрд▓ рд╕рд┐рджреНрдзрд╛рдВрдд рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХреЗ рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рд╡рд┐рдХрд▓реНрдк рд╣реИред  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рдЦреЛрдЬ рдлрд╝рдВрдХреНрд╢рдВрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдо рдХреЗрд╡рд▓ рдЙрди рдЯреЛрдХрди рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рд╣рдореЗрдВ рдХреБрдЫ рдЧреБрдгреЛрдВ рджреНрд╡рд╛рд░рд╛ рд░реБрдЪрд┐ рд░рдЦрддреЗ рд╣реИрдВред  рд╕реЗрдЯ рдкрд░ рд╕рдВрдЪрд╛рд▓рди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рд╣рдо рдЕрд▓рдЧ-рдЕрд▓рдЧ рдЯреЛрдХрди рдЧреБрдгреЛрдВ рдХреЗ рд╕рд╛рде рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╕реЗрдЯ рдХреЛ рдПрдХ рдореЗрдВ рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛ рдЗрд╕рдХреЗ рд╡рд┐рдкрд░реАрдд, рдПрдХ рд╕реЗ рджреВрд╕рд░реЗ рдХреЛ рдШрдЯрд╛ рд╕рдХрддреЗ рд╣реИрдВред  рдлрд┐рд░, рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдо рдХреЛрдб рдлреНрд▓реЛ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░рддреЗ рд╣реИрдВ рдФрд░ рдпрд╣ рд╕рдордЭрдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рд╕рдВрднрд╛рд╡рд┐рдд рдХрдордЬреЛрд░рд┐рдпрд╛рдВ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБрдУрдВ рдкрд░ рдорд╛рдкрджрдВрдбреЛрдВ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИрдВред <br><br>  рдЙрд╕ рд╕реНрдерд╛рди рдХрд╛ рд╡рд┐рдХрд▓реНрдк, рдЬрд╣рд╛рдВ рд╕реЗ рдЦреЛрдЬ рд╢реБрд░реВ рдХреА рдЬрд╛рддреА рд╣реИ, рдФрд░ рд╕рд╛рдорд╛рдиреНрдп рд░реВрдк рд╕реЗ рд╕рдВрдкреВрд░реНрдг рдЦреЛрдЬ рдкрде, рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреЛрдб рдкрд░ рдФрд░ рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рд░реВрдк рд╕реЗ "рдкрд╛рда" рдкрд░ рднреА рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИред  рдХреБрдЫ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рд╕реЗ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдкреНрд░рд╢реНрдиреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдирд╛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ, рдХреБрдЫ рдореЗрдВ "рдЕрдВрдд" рдпрд╛ рдмреАрдЪ рд╕реЗ рднреА рд╢реБрд░реВ рдХрд░рдирд╛ рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИред  рдпрд╣ рд╕рдм рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХреЛрдб рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЖрдкрдХреЛ рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рд░рд┐рдкреЙрдЬрд┐рдЯрд░реА рд╕реЗ рд╕рдВрдкрд░реНрдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред <br><br><h2>  рдЙрджрд╛рд╣рд░рдг: рдЦреЛрдЬ SQL рдЗрдВрдЬреЗрдХреНрд╢рди </h2><br>  рдЦреЛрдЬ рдпреЛрдЬрдирд╛, рдХреЛрд╖реНрдардХ рдореЗрдВ рдореИрдВрдиреЗ рд╕реЗрдЯ рдХреЗ рдирд╛рдо (рдХреНрд╡реЗрд░реА рдореЗрдВ рдЪрд░) рдХрд╛ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛: <br><br><ol><li>  рдЕрдкрд╡рд╛рджреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ - рдЯреЛрдХрди рдЬрд┐рдиреНрд╣реЗрдВ рддреБрд░рдВрдд рдЦреЛрдЬ рд╕реНрдХреЛрдк ( <i>рдмрд╣рд┐рд╖реНрдХрд░рдг рд╕реВрдЪреА</i> ) рд╕реЗ рдмрд╛рд╣рд░ рдирд┐рдХрд╛рд▓рд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ; </li><li>  рд╕реНрд╡рдЪреНрдЫрддрд╛ / рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪ ( <i>рд╕реНрд╡рдЪреНрдЫрддрд╛</i> ) рдХрд╛ рд╕реНрдерд╛рди рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ; </li><li>  рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдХреНрд╡реЗрд░реА рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╕рд╛рде рд╕рднреА рдирд┐рдореНрди-рд╕реНрддрд░реАрдп рд╕реНрдерд╛рди рдЦреЛрдЬреЗрдВ ( <i>runSuperSecureSQLQuery</i> ); </li><li>  рд╕рднреА рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ <i>рдЦреЛрдЬреЗ рдЬрд╛рдиреЗ рд╡рд╛рд▓реЗ</i> рддрд░реАрдХреЛрдВ рдХреЛ <i>рдЦреЛрдЬреЗрдВ: runSuperSecureSQLQuery</i> ( <i>runSSSQParams</i> ); </li><li>  рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдХреНрд╡реЗрд░реА рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╕реНрдерд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ (рдореВрд▓ рддрд░реАрдХреЗ рдФрд░ рдЙрдирдХреЗ рдкреИрд░рд╛рдореАрдЯрд░) рдЦреЛрдЬреЗрдВ ( <i>entryPointsParameters</i> ); </li><li>  <i>рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБрдУрдВ</i> рдкрд░ <i>runSSSQParams</i> рдорд╛рдкрджрдВрдбреЛрдВ рдХреА рдирд┐рд░реНрднрд░рддрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ, рдЬрдмрдХрд┐ рдХреЗрд╡рд▓ рдЙрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдЬрд╣рд╛рдВ рдЗрдирдкреБрдЯ <i>рд╕реИрдирд┐рдЯрд╛рдЗрдЬреЗрд╢рди</i> рдХрд╛ рдХреЛрдИ <i>рд╕рдВрдХрд░рдг</i> рдирд╣реАрдВ рд╣реИред </li></ol><br><br>  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдореЗрдВ SQL рдХреНрд╡реЗрд░реАрдЬрд╝ рдХреЗ рд╕рд╛рде рдирд┐рдореНрди-рд╕реНрддрд░реАрдп рд╡рд┐рдзрд┐рдпрд╛рдБ рдорд┐рд▓рддреА рд╣реИрдВ, рдЬрд╣рд╛рдБ SQL рдХреНрд╡реЗрд░реА рдХреЗ рдкреИрд░рд╛рдореАрдЯрд░: <br><br><ul><li>  рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдкрд░ рдирд┐рд░реНрднрд░; </li><li>  рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рд╕реНрд╡реАрдХрд╛рд░ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ; </li><li>  рдЕрдиреБрд░реЛрдз рдХреЗ рд▓рд┐рдП рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рд╕рдорд╛рдкреНтАНрдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред </li></ul><br>  рд╣рдо рдЬрд╛рдВрдЪ рдирд╣реАрдВ рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдХреНрдпрд╛ рд╣рдо рдЗрди рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐  рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдЪрд░ рдХреЛ рдХреНрд╡реЗрд░реА рдореЗрдВ рдореИрдк рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рддрдВрддреНрд░ рд╣реИ рдФрд░ рд╕рдВрдЦреНрдпрд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдХрд╛рд╕реНрдЯ рд╣реИ, рдФрд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╕рдВрдпреЛрдЬрди рд╣рдореЗрд╢рд╛ рдЦрддрд░рдирд╛рдХ рдорд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЕрдЧрд░ рдЕрдм рд▓рд╛рдЗрди рдкрд░ рдХреЛрдИ рдирд┐рдпрдВрддреНрд░рдг рдирд╣реАрдВ рд╣реИ, рддреЛ рдпрд╣ рдЕрдЪреНрдЫреА рддрд░рд╣ рд╕реЗ рдирдИ рд░рд┐рд▓реАрдЬ рдореЗрдВ рджрд┐рдЦрд╛рдИ рджреЗ рд╕рдХрддреА рд╣реИред <br><br><h3>  SQLi: рдЪрд░рдг 1ред рдЕрдкрд╡рд╛рджреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдирд╛ </h3><br>  рдЕрдкрд╡рд╛рджреЛрдВ рдореЗрдВ, рдЖрдкрдХреЛ рдЙрди рдХрдХреНрд╖рд╛рдУрдВ рдпрд╛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ рдЬрд╣рд╛рдВ рдЯреЛрдХрди рдХреЗ рдирд╛рдо рдЙрди рд▓реЛрдЧреЛрдВ рд╕реЗ рдореЗрд▓ рдЦрд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдЬрд┐рдиреНрд╣реЗрдВ рдЖрдк рдвреВрдВрдв рд░рд╣реЗ рд╣реИрдВ, рдХреНрдпреЛрдВрдХрд┐  рдпреЗ рдЯреЛрдХрди рдЕрдорд╛рдиреНрдп рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпреЛрдВ рдХреЛ рдЬрдиреНрдо рджреЗрдВрдЧреЗред <br><br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдбреЗрдЯрд╛рдмреЗрд╕ рддрдХ рдкрд╣реБрдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд┐рдзрд┐ рдХреЛ <i>runSuperSecureSQLquery</i> рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред  рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ <i>рд░рдирд╕реБрдкрд░рд╕реБрд░рдХреНрд╕реЗрд╕рдХреНрд╡реЗрдпрд░</i> рд╡рд┐рдзрд┐ рдЕрдВрджрд░ рд╕реБрд░рдХреНрд╖рд┐рдд рд░реВрдк рд╕реЗ рд▓рд╛рдЧреВ рдХреА рдЧрдИ рд╣реИред  рдФрд░ рд╣рдорд╛рд░рд╛ рдХрд╛рдо рдЙрди рдЬрдЧрд╣реЛрдВ рдХреЛ рдвреВрдВрдврдирд╛ рд╣реИ рдЬрд╣рд╛рдВ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИред  SQL рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛-рдирд┐рдпрдВрддреНрд░рд┐рдд рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд╕рдВрдШрдирди рдХреЗ рд╕реНрдерд╛рди рд╕реБрд░рдХреНрд╖рд┐рдд рд╕реНрдерд╛рди рдирд╣реАрдВ рд╣реЛрдВрдЧреЗред  рдФрд░ рд╕реБрд░рдХреНрд╖рд┐рдд - ORM рд╕рдВрд░рдЪрдирд╛ рдореЗрдВ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдорд╛рдирдЪрд┐рддреНрд░рдг рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рди рдпрд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╕рдВрдЦреНрдпрд╛рддреНрдордХ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЗрд╕реА рдкреНрд░рдХрд╛рд░ рдХрд╛ рдПрдХ рдХрд▓рд╛рдХрд╛рд░ рд╣реИред  рд╣рдореЗрдВ рдЙрди рд╕рднреА рдХреЛрдб рдХреЛ рд╕реНрдХреИрди рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ рдЬреЛ <i>runSuperSecureSQLquery рдХреА</i> рддреБрд▓рдирд╛ рдореЗрдВ "рдЕрдзрд┐рдХ рдЧрд╣рд░рд╛" рд╣реИ, рдЬрд┐рд╕рдХрд╛ рдЕрд░реНрде рд╣реИ рдХрд┐ рдмреЗрдХрд╛рд░ рдкрд╛рдпрд╛ рд╕реЗ рдмрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдмрд╛рд╣рд░ рдХрд░рдирд╛ рдмреЗрд╣рддрд░ рд╣реИред <br><br>  рдРрд╕реЗ рдЕрдкрд╡рд╛рджреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП CMxQL рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╣реИ: <br><ul><li>  <b>FindByFileName ()</b> - рдПрдХ рд╡рд┐рд╢реЗрд╖ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рднреА рдЯреЛрдХрди рдХрд╛ рд╕реЗрдЯ рдорд┐рд▓реЗрдЧрд╛; </li><li>  <b>GetByClass ()</b> - рджрд┐рдП рдЧрдП рдирд╛рдо рдХреЗ рд╕рд╛рде рдХрдХреНрд╖рд╛ рдореЗрдВ рд╕рднреА рдЯреЛрдХрди рдХрд╛ рд╕реЗрдЯ рдорд┐рд▓реЗрдЧрд╛ред </li></ul><br><br>  рдПрдХ рдкрд░реАрдХреНрд╖рдг рдЖрд╡реЗрджрди рдХреЗ рд▓рд┐рдП, рдпрд╣ рдЕрдкрд╡рд╛рдж <i>рд╕рддреНрд░</i> рд╡рд░реНрдЧ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ <i>рд░рдирд╕реБрдкрд░рд╕реЗрдХреЗрдпрд░рдХреНрдпреВрдХреНрд▓реЗрд░реА</i> рдкрджреНрдзрддрд┐ рдХрд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рд╢рд╛рдорд┐рд▓ рд╣реИред <br>  <i>рд╕рддреНрд░</i> рдХрдХреНрд╖рд╛ рдореЗрдВ рдХреЛрдб рдХреЛ рдмрд╛рд╣рд░ рдХрд░рдиреЗ рдХреЗ рдЕрдиреБрд░реЛрдз рдХрд╛ рдПрдХ рдЙрджрд╛рд╣рд░рдг ( <i>GetByClass ()</i> рд╡рд┐рдзрд┐ <i>рдпрд╣</i> рдЬрд╛рдВрдЪ <i>рдХрд░реЗрдЧреА</i> рдХрд┐ рдЗрдирдкреБрдЯ рдореЗрдВ рдЙрддреНрддреАрд░реНрдг рдХрд┐рдП рдЧрдП рдЯреЛрдХрди рдореЗрдВ рдХреМрди рд╕реА рдХреНрд▓рд╛рд╕ рдХрд╛ рд╕реАрдПрдордПрдХреНрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ рдФрд░ рдЗрд╕ рд╡рд░реНрдЧ рдХреЗ рдмрд╣реБрдд рд╕рд╛рд░реЗ рдЯреЛрдХрди рдЬрд╛рд░реА рдХрд░реЗрдЧрд╛) <br><br><pre> <code class="java hljs">CxList exclusionList = All.GetByClass(All.FindByName(<span class="hljs-string"><span class="hljs-string">"*Session*"</span></span>)); result = exclusionList;</code> </pre> <br><br>  рдпрд╛ рджреВрд╕рд░рд╛ рддрд░реАрдХрд╛ рдкреВрд░реЗ <i>рд╕рддреНрд░</i> рдореЗрдВ рдХреЛрдб рдлреЗрдВрдХрдирд╛ рд╣реИред <i>рдЬрд╛рд╡рд╛</i> рдлрд╛рдЗрд▓: <br><br><pre> <code class="java hljs">CxList exclusionList = All.FindByFileName(<span class="hljs-string"><span class="hljs-string">"*Session.java"</span></span>); result = exclusionList;</code> </pre> <br><br>  рдирд╛рдо рд╕реЗ рдкрд╣рд▓реЗ рддрд╛рд░рд╛рдВрдХрди рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдлрд╝рд╛рдЗрд▓ рдирд╛рдо рдореЗрдВ рд╕рдВрдкреВрд░реНрдг рдкрде рд╢рд╛рдорд┐рд▓ рд╣реИред <br>  рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХрдИ рдЯреЛрдХрди рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЦреЛрдЬ рджрд╛рдпрд░реЗ рд╕реЗ рдЕрдЧрд▓реЗ рдЪрд░рдгреЛрдВ рдореЗрдВ рдШрдЯрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  <i>рд╕рддреНрд░</i> рд╡рд░реНрдЧ рдХреЗ рдЕрдВрджрд░ рдЯреЛрдХрди рдХреА рдЦреЛрдЬ рдХрд╛ рдкрд░рд┐рдгрд╛рдо: <br><br><img src="https://habrastorage.org/webt/x3/gz/vx/x3gzvxxumbbu-th01llyjbymkoo.png"><br><br><h3>  SQLi: рдЪрд░рдг 2ред рд╕реНрд╡рдЪреНрдЫрддрд╛ рд╕реНрдерд╛рдиреЛрдВ рдХрд╛ рдирд┐рд░реНрдзрд╛рд░рдг </h3><br>  рдкрд░реАрдХреНрд╖рдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ 2 рдПрдкреАрдЖрдИ рд╡рд┐рдзрд┐рдпрд╛рдВ рд╣реИрдВ (рдкрд░реАрдХреНрд╖рдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рд╡рд┐рд╡рд░рдг рджреЗрдЦреЗрдВ)ред  рджреЛ API рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдХрд╛ рдЕрдВрддрд░ рдпрд╣ рд╣реИ рдХрд┐ <i>getTransactionInfo ()</i> SQL рдХреНрд╡реЗрд░реА рдореЗрдВ transactionId рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ <i>рдорд┐рд▓рд╛рддрд╛ рд╣реИ</i> , рдФрд░ <i>getTransactionInfoSecured ()</i> рдкрд╣рд▓реЗ <i>TransId</i> рдХреЛ Long рдореЗрдВ <i>рд░реВрдкрд╛рдВрддрд░рд┐рдд рдХрд░рддрд╛ рд╣реИ</i> , рдФрд░ рдлрд┐рд░ рдЗрд╕реЗ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рдкрд╛рд╕ рдХрд░рддрд╛ рд╣реИред  рднреЗрджреНрдпрддрд╛ (рдкреИрд░рд╛рдореАрдЯрд░ рд╕рдВрдШрдирди) рджреЛрдиреЛрдВ рд╡рд┐рдзрд┐рдпреЛрдВ рдореЗрдВ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╣реИред  рд▓реЗрдХрд┐рди <i>getTransactionInfoSecured ()</i> рдореЗрдВ рд▓реЙрдиреНрдЧ рдХрд╛рд╕реНрдЯрд┐рдВрдЧ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рдЕрдВрддрд┐рдо рд╡рд┐рдзрд┐ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рд▓рд┐рдП рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдирд╣реАрдВ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЬрдм рд╣рдо рдПрдХ рдЗрдВрдЬреЗрдХреНрд╢рди (рд╕реНрдЯреНрд░рд┐рдВрдЧ) рдкрд╛рд╕ рдХрд░рдиреЗ рдХреА рдХреЛрд╢рд┐рд╢ рдХрд░рддреЗ рд╣реИрдВ рддреЛ рд╣рдореЗрдВ рдПрдХ рдЬрд╛рд╡рд╛ рдЕрдкрд╡рд╛рдж рдорд┐рд▓рддрд╛ рд╣реИред <br><br>  рдЗрд╕ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ, рд╣рдо рдХрд▓рд╛рдХрд╛рд░реЛрдВ рдХреЛ рд▓рд╛рдВрдЧ рдХреЛ рд╕реНрд╡рдЪреНрдЫрддрд╛ рд╕реНрдерд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдорд╛рдиреЗрдВрдЧреЗред  рдЗрди рдЯреЛрдХрди рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП: <br><br><pre> <code class="java hljs">CxList sanitization = All.FindByName(<span class="hljs-string"><span class="hljs-string">"*Long*"</span></span>); result = sanitization;</code> </pre> <br><br>  рдЙрджрд╛рд╣рд░рдг рдкрд░рд┐рдгрд╛рдо: <br><br><img src="https://habrastorage.org/webt/hb/ms/vx/hbmsvxmjwynfncf96eyclx2ey8y.png"><br><br>  рдкрд░рд┐рдгрд╛рдо рдореЗрдВ YP рдкреНрд░рдХрд╛рд░ <i>рд▓рд╛рдВрдЧ рдХреЗ</i> рд╕рд╛рде рдЯреЛрдХрди рд╢рд╛рдорд┐рд▓ рдереЗ рдФрд░ <i>getValueAsLong</i> рд╡рд┐рдзрд┐рдпрд╛рдБ, рдЬреЛ рдЖрдВрддрд░рд┐рдХ рд░реВрдк рд╕реЗ <i>Long</i> рдЯрд╛рдЗрдк рдХрд░рдиреЗ рдХреЗ <i>рд▓рд┐рдП</i> рдорд╛рди рдХреЛ <i>рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддреА рд╣реИрдВ</i> ред  рдЖрдкрдХреЛ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░рд┐рдгрд╛рдо рдХреА рд╕рд╛рд╡рдзрд╛рдиреАрдкреВрд░реНрд╡рдХ рд╕рдореАрдХреНрд╖рд╛ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдХреЛрдИ рдЬрд╝рд░реВрд░рдд рд╕реЗ рдЬрд╝реНрдпрд╛рджрд╛ рдирд╣реАрдВ рд╣реИред <br><br><h3>  SQLi: рдЪрд░рдг 3. рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдХреНрд╡реЗрд░реА рдирд┐рд╖реНрдкрд╛рджрди рдХреЗ рд╕рд╛рде рд╕рднреА рдирд┐рдореНрди-рд╕реНрддрд░реАрдп рд╕реНрдерд╛рдиреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ </h3><br>  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреНрд╡реЗрд░реА рдХреЛ рд░рдирд╕реБрдкрд░рд╕реБрд░ SQLSQL рдЯреЛрдХрди (рдЬреЛ рдбреЗрдЯрд╛рдмреЗрд╕ рддрдХ рдкрд╣реБрдВрдЪрдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рднреА рд╕реНрдерд╛рди рдорд┐рд▓реЗрдВрдЧреЗ: <br><br><pre> <code class="actionscript hljs">result = All.FindByName(<span class="hljs-string"><span class="hljs-string">"*runSuperSecureSQLQuery*"</span></span>)</code> </pre> <br>  рдЯреЛрдХрди рдирд╛рдо runSuperSecureSQLQuery рджреНрд╡рд╛рд░рд╛ рдЦреЛрдЬ рдкрд░рд┐рдгрд╛рдо: <br><img src="https://habrastorage.org/webt/qm/bh/ci/qmbhci6ucl_wx3sb_9zqfkkpim8.png"><br><br>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЙрди рд╕реНрдерд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдЬрд╣рд╛рдВ рдЗрд╕ рд╡рд┐рдзрд┐ рдХреЛ ( <i>рдмрд┐рд▓рд┐рдВрдЧ</i> рд╡рд░реНрдЧ) рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреЗрд╡рд▓ рд╡рд┐рдзрд┐ рдордВрдЧрд▓рд╛рдЪрд░рдг рдЯреЛрдХрди (рдкреНрд░рдХрд╛рд░ <i>MethodInvokeExpr</i> ) рдкрд╛рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдФрд░ рд╡рд┐рдзрд┐ рдШреЛрд╖рдгрд╛ рд╕реНрдерд╛рди ( <i>рд╕рддреНрд░</i> рд╡рд░реНрдЧ) рдХреЗ рд▓рд┐рдП, рд╕рднреА рдЯреЛрдХрди - рдЪрд░ рднреА рдорд┐рд▓реЗрдВрдЧреЗред <br><br>  рд╣рдо рдХреЗрд╡рд▓ рд╡рд┐рдзрд┐ рдХреЙрд▓ рдЯреЛрдХрди рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="java hljs">CxList runSuperSecureSQLQuery = All.FindByName(<span class="hljs-string"><span class="hljs-string">"*runSuperSecureSQLQuery*"</span></span>).FindByType(typeof(MethodInvokeExpr)); result = runSuperSecureSQLQuery;</code> </pre> <br>  рдкрд░рд┐рдгрд╛рдо: <br><img src="https://habrastorage.org/webt/or/82/dw/or82dwxfoze-fcbko2b2mljfyus.png"><br><br>  рдирддреАрдЬрддрди, рд╣рдореЗрдВ 7 рд╕реНрдерд╛рди рдорд┐рд▓реЗ, рдЙрдирдореЗрдВ рд╕реЗ 4 рдХреЛ <i>рд░рдирд╕реБрдкрд░рд╕реЗрдХреНрдпреЛрд░рдПрд╕рдбреАрдХреНрдпреВрдИ ()</i> рд╡рд┐рдзрд┐ ( <i>рдмрд┐рд▓рд┐рдВрдЧ</i> рдФрд░ <i>рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛</i> рд╡рд░реНрдЧ) рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХреЙрд▓ред  2 - <i>рд╕рддреНрд░</i> рд╡рд░реНрдЧ рдХреЗ рдЕрдВрджрд░ runSuperSecureSQLQuery () рдЖрдВрддрд░рд┐рдХ рд╡рд┐рдзрд┐ рдХреЛ рдХреЙрд▓ рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдПрдХ рдФрд░ <i>рдРрдб</i> рд╡рд┐рдзрд┐ рд╣реИ, рдЬреЛ рд╕реАрдПрдордПрдХреНрд╕рдХреНрдпреВрдПрд▓ рдЦреЛрдЬ рд╡рд┐рд╖рдорддрд╛ рдХреЗ рдХреБрдЫ рдкреНрд░рдХрд╛рд░ рд╣реИред  рдорд╛рди рд▓реЗрдВ рдХрд┐ рдореИрдВрдиреЗ рдпрд╣ рдЙрдореНрдореАрдж рдирд╣реАрдВ рдХреА рдереА рдХрд┐ рдпрд╣ рд╕реВрдЪреА рдореЗрдВ рд╣реИ =) <i>рд╕рддреНрд░</i> рд╡рд░реНрдЧ рдореЗрдВ рдЯреЛрдХрди, рдЬреИрд╕рд╛ рдХрд┐ рд╣рдореЗрдВ рдЪрд░рдг 1 рдореЗрдВ рдкрддрд╛ рдЪрд▓рд╛ рд╣реИ, рд╣рдорд╛рд░реЗ рд▓рд┐рдП рджрд┐рд▓рдЪрд╕реНрдк рдирд╣реАрдВ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рд╣рдо рдЙрдиреНрд╣реЗрдВ рдкрд░рд┐рдгрд╛рдо рд╕реЗ рдШрдЯрд╛ рджреЗрдВрдЧреЗ: <br><br><pre> <code class="java hljs">CxList runSuperSecureSQLQuery = All.FindByName(<span class="hljs-string"><span class="hljs-string">"*runSuperSecureSQLQuery*"</span></span>).FindByType(typeof(MethodInvokeExpr)); result = runSuperSecureSQLQuery - exclusionList;</code> </pre> <br>  рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХ рд╡рд┐рдзрд┐ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдХреА рдПрдХ рдорд╛рдиреНрдп рд╕реВрдЪреА рдорд┐рд▓рддреА рд╣реИ: <br><br><img src="https://habrastorage.org/webt/sh/c8/ix/shc8ixcpk9wrkmdv_vzqfz5wj80.png"><br><br>  рдкрд┐рдЫрд▓реА рдХреНрд╡реЗрд░реА рдореЗрдВ <i>FindByType ()</i> рдФрд░ <i>рдЯрд╛рдЗрдкреЛрдлрд╝ () рдлрд╝рдВрдХреНрд╢рди</i> рдиреЛрдЯ рдХрд░реЗрдВред  рдпрджрд┐ рд╣рдо <i>CxList</i> рд╕рдВрдкрддреНрддрд┐ "рд╕реНрд░реЛрдд рдкреНрд░рдХрд╛рд░" рджреНрд╡рд╛рд░рд╛ CMx рдкреНрд░рдХрд╛рд░, рдЕрд░реНрдерд╛рдд рдЦреЛрдЬ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдо <i>рдЯрд╛рдЗрдкреЛрдл</i> <i>(рд╕реНрд░реЛрдд рдкреНрд░рдХрд╛рд░) рдХрд╛</i> рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдпрджрд┐ рд╣рдо рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░ рджреНрд╡рд╛рд░рд╛ рдПрдХ рдЦреЛрдЬ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд░реВрдк рдореЗрдВ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЛ рдкрд╛рд╕ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: <br><br><pre> <code class="java hljs">result = All.FindByType(<span class="hljs-string"><span class="hljs-string">"String"</span></span>);</code> </pre><br>  рдкреНрд░рдХрд╛рд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рд╕рднреА рдЬрд╛рд╡рд╛ рдЯреЛрдХрди рдорд┐рд▓реЗрдВрдЧреЗред <br><br><h3>  SQLi: рдЪрд░рдг 4. RunSuperSecureSQLQuery рдирд╛рдордХ рд╕рднреА рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ </h3><br>  рд╡рд┐рдзрд┐ рдорд╛рдкрджрдВрдбреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, CMxQL рдлрд╝рдВрдХреНрд╢рди <i>GetParameters () рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</i> : <br><br><pre> <code class="actionscript hljs">CxList runSSSQParams = All.GetParameters(runSuperSecureSQLQuery); result = runSSSQParams;</code> </pre> <br>  рдкрд░рд┐рдгрд╛рдо: <br><br><img src="https://habrastorage.org/webt/s4/4h/id/s44hidweor1j61xs1dkwbewrpja.png"><br><br><h3>  SQLi: рдЪрд░рдг 5. рдбреЗрдЯрд╛рдмреЗрд╕ рдореЗрдВ рдХреНрд╡реЗрд░реА рдирд┐рд╖реНрдкрд╛рджрди рд╕реНрдерд╛рдиреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдЦреЛрдЬреЗрдВ </h3><br>  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдкрд╣рд▓реЗ рд╣рдореЗрдВ рдореВрд▓ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рдирд╛рдо рдорд┐рд▓рддреЗ рд╣реИрдВ, рдЬрд┐рдирдХреЗ рдЕрдВрджрд░ <i>runSuperSecureSQLQuery</i> рдбреЗрдЯрд╛рдмреЗрд╕ рдкрд░ рдХреЙрд▓ <i>рд╣реЛрддреА</i> рд╣реИ, рдФрд░ рдлрд┐рд░ рд╣рдореЗрдВ рдЙрдирдХреЗ рдкреИрд░рд╛рдореАрдЯрд░ рдорд┐рд▓рддреЗ рд╣реИрдВред  рдореВрд▓ рдЯреЛрдХрди рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, CMxQL рдлрд╝рдВрдХреНрд╢рди <i>GetAncOfType () рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</i> : <br><br><pre> <code class="actionscript hljs">CxList entryPoints = runSuperSecureSQLQuery.GetAncOfType(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(MethodDecl)); result = entryPoints;</code> </pre> <br><br>  рдЗрд╕ рдХреНрд╡реЗрд░реА рдореЗрдВ, runSuperSecureSQLQuery рд╕реЗрдЯ рдХреЗ рд▓рд┐рдП, MethodDecl рдХреЗ рд╕рднреА рдореВрд▓ рдЯреЛрдХрди рд▓реМрдЯрд╛рдПрдБ - рдпрд╣ рдХреЙрд▓ рд╕реНрдЯреИрдХ рдореЗрдВ рдкрд┐рдЫрд▓реА рд╡рд┐рдзрд┐ рд╣реИ: <br><br><img src="https://habrastorage.org/webt/we/8w/7u/we8w7ucxjxvtgzerknbgjxir8fa.png"><br><br>  рд╡рд┐рдзрд┐ рдорд╛рдкрджрдВрдбреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо <i>GetParameters () рдХрд╛</i> рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="actionscript hljs">CxList entryPointsParameters = All.GetParameters(entryPoints).FindByType(<span class="hljs-string"><span class="hljs-string">"String"</span></span>);</code> </pre> <br><br>  рдХреНрд╡реЗрд░реА <i>рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐</i> рдкреНрд░рдХрд╛рд░ рдХреЗ рд╕рдмрд╕реЗрдЯ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдЬрд╛рд╡рд╛ рдкреНрд░рдХрд╛рд░ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд╕рд╛рде <i>рд▓реМрдЯрд╛рдПрдЧреА</i> : <br><br><img src="https://habrastorage.org/webt/7y/mw/tf/7ymwtfxg94oxlwggez3zhpfvcko.png"><br><br><h3>  рдПрд╕рдХреНрдпреВрдЖрдИ: рдЪрд░рдг 6. рдкреНрд░рд╡реЗрд╢ рдкрд░ рдЕрдВрдХ PRSS рдорд╛рдкрджрдВрдбреЛрдВ рдХреА рдирд┐рд░реНрднрд░рддрд╛ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВрдкреНрд░рдорд╛рдгрдкрддреНрд░, рдЬрдмрдХрд┐ рдХреЗрд╡рд▓ рдЙрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдЬрд╣рд╛рдВ рдХреЛрдИ рд╕реИрдирд┐рдЯрд╛рдЗрдЬреЗрд╢рди рдЗрдирдкреБрдЯ рдЗрдирдкреБрдЯ рдирд╣реАрдВ рд╣реИ </h3><br>  рдЗрд╕ рдЪрд░рдг рдореЗрдВ, рд╣рдо рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдлреНрд▓реЛ рдХреЛрдб рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд┐рдореНрди рдХрд╛рд░реНрдпреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ: <br><br><ul><li>  InfluencedBy () </li><li>  InfluencedByAndNotSanitized () </li><li>  рдЗрдиреНрдлреНрд▓реБрдПрдВрд╕рд┐рдВрдЧрдСрди () </li><li>  InfluencingOnAndNotSanitized () </li><li>  NotInfluencedBy () </li><li>  NotInfluencingOn () </li></ul><br><br>  <i>RunSSSQParams</i> рдХреЗ рдкреНрд░рд╡рд╛рд╣ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ <i>рдПрдВрдЯреНрд░реА рдкреЙрдЗрдВрдЯ рдкреЙрдЗрдВрдЯрд░реНрд╕</i> рдкреИрддреГрдХ рд╡рд┐рдзрд┐ рдХреЗ <i>рдорд╛рдирджрдВрдб</i> рдФрд░ рд╕реНрд╡рдЪреНрдЫрддрд╛ рдЯреЛрдХрди рдХреЛ рдмрд╛рд╣рд░ рдХрд░рдиреЗ рдХрд╛ рдЕрдиреБрд░реЛрдз рдХрд░реЗрдВ: <br><br><pre> <code class="java hljs">CxList dataInflOnTable = runSSSQParams.InfluencedByAndNotSanitized(entryPointsParameters, sanitization);</code> </pre> <br><br>  рд╣рд╛рд▓рд╛рдБрдХрд┐, рдореБрдЭреЗ рдпрдХреАрди рдирд╣реАрдВ рд╣реИ рдХрд┐ <i>* AndNotSanitized</i> рдлрд╝рдВрдХреНрд╢рдВрд╕ рдЕрдВрджрд░ рдХреБрдЫ рдЬрд╛рджреВ рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдпрд╣ рдЕрдзрд┐рдХ рдРрд╕рд╛ рд▓рдЧрддрд╛ рд╣реИ рдХрд┐ рд╡рд┐рдзрд┐ рдЗрд╕рдХреЗ рдкрд░рд┐рдгрд╛рдо рд╕реЗ рд╕реИрдирд┐рдЯрд╛рдЗрдЬреНрдб рд╕реЗрдЯ рдХреЛ рдШрдЯрд╛ рджреЗрддреА рд╣реИред  рдпрджрд┐ рдЖрдк рдРрд╕рд╛ рдХрд░рддреЗ рд╣реИрдВ: <br><br><pre> <code class="java hljs">CxList dataInflOnTable = runSSSQParams.InfluencedBy(entryPointsParameters) - sanitization;</code> </pre> <br><br>  рдпрд╣ рдПрдХ рд╣реА рдмрд╛рдд рд╣реИред  рд╣рд╛рд▓рд╛рдБрдХрд┐ рд╢рд╛рдпрдж рдореБрдЭреЗ рдЕрднреА рдХреЛрдИ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рдорд┐рд▓рд╛ рд╣реИ рдЬрдм рдорддрднреЗрдж рд╣реИрдВред <br><br>  рдХреНрд╡реЗрд░реА рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣рдореЗрдВ рдПрдХ рд╕рд╣реА рдврдВрдЧ рд╕реЗ рдирд┐рд░реНрдорд┐рдд рдкреНрд░рд╡рд╛рд╣ рджреЗрддрд╛ рд╣реИ: <br><br><img src="https://habrastorage.org/webt/ru/hs/2d/ruhs2dlh7alil7njbzsf2jke9qw.png"><br><br>  рд╕рдВрднрд╛рд╡рд┐рдд рдПрд╕рдХреНрдпреВрдПрд▓ рдЗрдВрдЬреЗрдХреНрд╢рди рдХреЗ рд╕рд╛рде рдлреНрд▓реЛ рдорд┐рд▓рд╛ред  рдЬреИрд╕рд╛ рдХрд┐ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рд╕реЗ рджреЗрдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ, Checkmarx рдиреЗ 3 рдлреНрд▓реЛ рд╡рд╛рдкрд╕ рдХрд┐рдпрд╛ред  рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдореЗрдВ рдкреНрд░рд╡рд╛рд╣ рд╕рдмрд╕реЗ рдЫреЛрдЯрд╛ рд╣реИ, рдпрд╣ рдПрдХ рдлрд╝рд╛рдЗрд▓ рдФрд░ рдПрдХ рд╡рд┐рдзрд┐ рдореЗрдВ рд╢реБрд░реВ рдФрд░ рд╕рдорд╛рдкреНрдд рд╣реЛрддрд╛ рд╣реИред  рдЕрдЧрд▓рд╛ рдлрд╝реНрд▓реЛ рд╕рддреНрд░ рд╡рд░реНрдЧ рдореЗрдВ рдкрд╣рд▓реЗ рд╣реА рдирд┐рдХрд▓ рдЬрд╛рддрд╛ рд╣реИред  рд╕реНрд░реЛрдд / рдЧрдВрддрд╡реНрдп рдкрд░ рдзреНрдпрд╛рди рджреЗрдВред  рдФрд░ рдЕрдВрддрд┐рдо рдПрдХ рд╕рддреНрд░ рд╡рд░реНрдЧ рдореЗрдВ рдПрдХ рдФрд░ рддрд░реАрдХрд╛ рд╣реИред  <i>рд╕рддреНрд░ рдХреЗ</i> рдЕрдВрджрд░ рдкреНрд░рд╡рд╛рд╣ рдЗрд╕ рддрд░рд╣ рджрд┐рдЦрд╛рдИ рджреЗрдЧрд╛: <br><br><img src="https://habrastorage.org/webt/mv/o7/uu/mvo7uuu6wp_dq-ggltm8lb5m5p0.png"><br><br>  рдПрдХ рдкреНрд░рд╡рд╛рд╣ рдХрд╛ рдЪрдпрди рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, <i>ReduceFlow</i> рд╡рд┐рдзрд┐ <i>(CxList.ReduceFlowType flowType) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</i> , рдЬрд╣рд╛рдБ flowType рд╣реЛ рд╕рдХрддрд╛ рд╣реИ: <br><br><ul><li>  <i>CxList.ReduceFlowType.ReduceBigFlow</i> - рд╕рдмрд╕реЗ рдХрдо рдкреНрд░рд╡рд╛рд╣ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ </li><li>  <i>CxList.ReduceFlowType.ReduceSmallFlow</i> - рд╕рдмрд╕реЗ рд▓рдВрдмреЗ рдкреНрд░рд╡рд╛рд╣ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ </li></ul><br><br><h3>  SQLi: SQL рдЗрдВрдЬреЗрдХреНрд╢рди рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдВрддрд┐рдо рдХреНрд╡реЗрд░реА </h3><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// 1.   CxList exclusionList = All.GetByClass(All.FindByName("*Session*")); // 2.    CxList sanitization = All.FindByName("*Long*"); // 3.    runSuperSecureSQLQuery() CxList runSuperSecureSQLQuery = All.FindByName("*runSuperSecureSQLQuery*").FindByType(typeof(MethodInvokeExpr)); runSuperSecureSQLQuery -= exclusionList; // 4.     runSuperSecureSQLQuery() CxList runSSSQParams = All.GetParameters(runSuperSecureSQLQuery); // 5.   ,     runSuperSecureSQLQuery() CxList entryPoints = runSuperSecureSQLQuery.GetAncOfType(typeof(MethodDecl)); CxList entryPointsParameters = All.GetParameters(entryPoints).FindByType("String"); // 6.       (runSuperSecureSQLQuery)     CxList dataInflOnTable = runSSSQParams.InfluencedByAndNotSanitized(entryPointsParameters, sanitization); // 7.   result = dataInflOnTable.ReduceFlow(CxList.ReduceFlowType.ReduceBigFlow);</span></span></code> </pre> <br><br><h2>  рдЙрджрд╛рд╣рд░рдг 2: рдЕрд╕реБрд░рдХреНрд╖рд┐рдд рдкреНрд░рддреНрдпрдХреНрд╖ рд╡рд╕реНрддреБ рд╕рдВрджрд░реНрдн рдЦреЛрдЬрдирд╛ </h2><br>  рдЗрд╕ рдЕрдиреБрд░реЛрдз рдореЗрдВ, рд╣рдо рдЙрди рд╕рднреА рд╕реНрдерд╛рдиреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░реЗрдВрдЧреЗ, рдЬрд╣рд╛рдВ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдорд╛рд▓рд┐рдХ рдХреА рдЬрд╛рдВрдЪ рдХреЗ рдмрд┐рдирд╛ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рд╣реЛрддрд╛ рд╣реИред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, рдореЗрд▓рдмреЙрдХреНрд╕ рдХреЗ рд▓рд┐рдП HTTP рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рд╡рд┐рднрд┐рдиреНрди рдирд╛рдореЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ (рд╣рдо рдорд╛рдирддреЗ рд╣реИрдВ рдХрд┐ рдпрд╣ рд▓рд┐рдЧреЗрд╕реА рд╣реИ), рдФрд░ рд╕рддреНрдпрд╛рдкрди рд╕реНрд╡рдпрдВ рд╡рд┐рднрд┐рдиреНрди рдЪрд░рдгреЛрдВ рдореЗрдВ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ: рдХрд╣реАрдВ рди рдХрд╣реАрдВ HTTP рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐ рдПрдкреАрдЖрдИ рдмрд┐рдВрджреБ рдкрд░, рдХрд╣реАрдВ рдбреЗрдЯрд╛рдмреЗрд╕ рдХреЗ рдЕрдиреБрд░реЛрдз рд╕реЗ рдкрд╣рд▓реЗ, рдФрд░ рдХрднреА-рдХрднреАред рдордзреНрдпрд╡рд░реНрддреА рд╡рд┐рдзрд┐рдпреЛрдВ рдореЗрдВред <br><br>  рдЦреЛрдЬ рдпреЛрдЬрдирд╛ <br><ol><li>  рдЕрдкрд╡рд╛рджреЛрдВ ( <i>рдмрд╣рд┐рд╖реНрдХрд░рдг</i> ) рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░реЗрдВ; </li><li>  рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдЬрд╛рдБрдЪ ( <i>idorSanitizer</i> ) рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рдиреЛрдВ рдХреЛ рдкрд╣рдЪрд╛рдиреЗрдВ; </li><li>  рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдЦреЛрдЬреЗрдВ - HTTP рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдкреНрд░рд╛рдердорд┐рдХ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рд▓рд┐рдП рд╕реНрдерд╛рди ( <i>webRemoteMethods</i> ); </li><li>  рдХреЗрд╡рд▓ HTTP рдкреИрд░рд╛рдореАрдЯрд░ <i>рдореЗрд▓рдмреЙрдХреНрд╕</i> ( <i>рдореЗрд▓рдмреЙрдХреНрд╕рдбреАрдирд┐рдЯ</i> ) рдХреЗ рдирд┐рд╖реНрдХрд░реНрд╖рдг рд╕реНрдерд╛рди рдХреЛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдЯреЛрдХрди рджреНрд╡рд╛рд░рд╛; </li><li>  WebRemoteMethods рд╕реЗ рд▓реЗрдХрд░ рдорд┐рдбрд┐рд▓рд╡реЗрдпрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдФрд░ рдЗрди рдХреЙрд▓реНрд╕ ( <i>рдорд┐рдбрд┐рд▓рд╡реЗрдпрд░рдореИрдереЛрдбреНрд╕</i> ) рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рддрдХ рд╕рднреА рдХреЙрд▓ рдЦреЛрдЬреЗрдВ; </li><li>  рдорд┐рдбрд▓рд╡реЗрдпрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ рдЬреЛ рдореЗрд▓рдмреЙрдХреНрд╕рд┐рдб ( <i>apiPotentialIDOR</i> ) рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИрдВ; </li><li>  рдЙрди рд╕рднреА рд╕реНрдерд╛рдиреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ, рдЬрд╣рд╛рдВ рдорд┐рдбрд▓рд╡реЗрдпрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ ( <i>рдорд┐рдбрд▓рд╡реЗрдпрд░рдбреЗрдХрд▓</i> ); </li><li>  рд╕рднреА <i>apiPotentialIDOR</i> рд╕реЗ <i>рдЧреБрдЬрд░реЗрдВ</i> рдФрд░ рдХреЗрд╡рд▓ рдЙрди <i>рдорд┐рдбрд▓рд╡реЗрдпрд░рдбреЗрдХ рдХрд╛</i> рдЪрдпрди рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ <i>рдореЗрд▓рдмреЙрдХреНрд╕</i> рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд╕реНрд╡рд╛рдореА рдХрд╛ рдХреЛрдИ рд╕рддреНрдпрд╛рдкрди рдирд╣реАрдВ рд╣реИред </li></ol><br><br><h3>  IDOR: рдЪрд░рдг 1. рдЕрдкрд╡рд╛рджреЛрдВ рдХреЛ рдкрд╣рдЪрд╛рдиреЗрдВ </h3><br>  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдлрд╝рд╛рдЗрд▓ рдореЗрдВ рд╕рднреА рдЯреЛрдХрди рдХреЛ рдмрд╛рд╣рд░ рдХрд░реЗрдВ: <br><br><pre> <code class="actionscript hljs">CxList exclusionList = All.FindByFileName(<span class="hljs-string"><span class="hljs-string">"*WebMethodContext.java"</span></span>); result = exclusionList;</code> </pre> <br>  <i>WebMethodContext.java</i> рдореЗрдВ <i>getMailboxId</i> рдФрд░ <i>getUserId</i> рдЬреИрд╕реЗ рддрд░реАрдХреЛрдВ рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд╕рд╛рде-рд╕рд╛рде рд╕реНрдЯреНрд░рд┐рдВрдЧ "рдореЗрд▓рдмреЙрдХреНрд╕рд┐рдб" рднреА рд╢рд╛рдорд┐рд▓ рд╣реИред  рдЪреВрдВрдХрд┐ рдЯреЛрдХрди рдХрд╛ рдирд╛рдо рдЙрди рд▓реЛрдЧреЛрдВ рдХреЗ рд╕рд╛рде рдореЗрд▓ рдЦрд╛рдПрдЧрд╛, рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдореЗрдВ рдХрдордЬреЛрд░рд┐рдпреЛрдВ рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдпрд╣ рдлрд╝рд╛рдЗрд▓ рдЧрд▓рдд рдирд┐рд╖реНрдХрд░реНрд╖ рдЬрд╛рд░реА рдХрд░реЗрдЧреАред <br><br><h3>  IDOR: рдЪрд░рдг 2. рдкреНрд░рд╛рдзрд┐рдХрд░рдг рдЬрд╛рдБрдЪ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдБ </h3><br>  рдкрд░реАрдХреНрд╖рдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдореЗрдВ, <i>рдорд╛рдиреНрдпрд▓реЗрдЯрдмреЙрдХреНрд╕ ()</i> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдХрд┐ рдЕрдиреБрд░реЛрдзрд┐рдд рд╡рд╕реНрддреБ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреА рд╣реИ: <br><br><pre> <code class="actionscript hljs">CxList idorSanitizer = All.FindByName(<span class="hljs-string"><span class="hljs-string">"*validateMailbox*"</span></span>); result = idorSanitizer;</code> </pre><br>  рдкрд░рд┐рдгрд╛рдо: <br><br><img src="https://habrastorage.org/webt/a7/jx/3e/a7jx3eqcxzb5pwgzze9yuqbysos.png"><br><br><h3>  IDOR: рдЪрд░рдг 3. рдХрд╕реНрдЯрдо HTTP рдПрдкреАрдЖрдИ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рдЦреЛрдЬреЗрдВ </h3><br>  HTTP рдЕрдиреБрд░реЛрдз рд╕рдВрдЪрд╛рд▓рдХреЛрдВ рдХреЗ рдкрд╛рд╕ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдПрдиреЛрдЯреЗрд╢рди рд╣реИ рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдвреВрдВрдврдирд╛ рдЖрд╕рд╛рди рдмрдирд╛рддрд╛ рд╣реИред  рдореЗрд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ "WebRemote" рд╣реИ; CMxQL рдлрд╝рдВрдХреНрд╢рди <i>FindByCustomAttribute () рдХрд╛</i> рдЙрдкрдпреЛрдЧ рдПрдиреЛрдЯреЗрд╢рди рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  <i>FindByCustomAttribute () рдХреЗ рд▓рд┐рдП</i> , рдореВрд▓ рдЯреЛрдХрди <i>GetAncOfType ()</i> рдХрд╛ рдЦреЛрдЬ рдлрд╝рдВрдХреНрд╢рди рдПрдиреЛрдЯреЗрд╢рди рдХреЗ рддрд╣рдд рд╡рд┐рдзрд┐ рд▓реМрдЯрд╛рдПрдЧрд╛: <br><br><pre> <code class="java hljs">CxList webRemoteMethods = All.FindByCustomAttribute(<span class="hljs-string"><span class="hljs-string">"WebRemote"</span></span>) .GetAncOfType(typeof(MethodDecl)); result = webRemoteMethods;</code> </pre> <br><br>  рд░рд┐рдЬрд▓реНрдЯ рдХрд╛ рдЕрдиреБрд░реЛрдз: <br><br><img src="https://habrastorage.org/webt/rc/xt/q_/rcxtq_rfostgwmdtmwrfyg-9ly4.png"><br><br><h3>  IDOR: рдЪрд░рдг 4. рдХреЗрд╡рд▓ рдПрдВрдЯреНрд░реА рдкреЙрдЗрдВрдЯ рдЯреЛрдХрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ, рдореЗрд▓рдмреЙрдХреНрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рд▓рд┐рдП HTTP рдирд┐рд╖реНрдХрд░реНрд╖рдг рд╕реНрдерд╛рди рдЦреЛрдЬреЗрдВ </h3><br>  HTTP рдореЗрд▓рдмреЙрдХреНрд╕рд┐рдб рдкреИрд░рд╛рдореАрдЯрд░ рдХреЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЯреЛрдХрди рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП: <br><br><pre> <code class="java hljs">CxList getMailboxId = All.FindByName(<span class="hljs-string"><span class="hljs-string">"\"mailboxId\""</span></span>) + All.FindByName(<span class="hljs-string"><span class="hljs-string">"\"mid\""</span></span>) + All.FindByName(<span class="hljs-string"><span class="hljs-string">"\"boxid\""</span></span>); result = getMailboxId;</code> </pre> <br>  рд╣рдордиреЗ 3 рд╕реЗрдЯреЛрдВ рдХреЛ 3 рдЕрд▓рдЧ-рдЕрд▓рдЧ рд▓рд╛рдЗрдиреЛрдВ рдХреЗ рд╕рд╛рде рдЬреЛрдбрд╝рд╛, рдХреНрдпреЛрдВрдХрд┐  рдХрд┐рдВрд╡рджрдВрддреА рдХреЗ рдЕрдиреБрд╕рд╛рд░, рд╕рд┐рд╕реНрдЯрдо рдХреЗ рд╡рд┐рднрд┐рдиреНрди рд╣рд┐рд╕реНрд╕реЛрдВ рдореЗрдВ HTTP рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдирд╛рдо рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдХреНрд╡реЗрд░реА рдЙрди рд╕рднреА рд╕реНрдерд╛рдиреЛрдВ рдкрд░ <i>рдорд┐рд▓реЗрдЧреА</i> рдЬрд╣рд╛рдВ <i>рдореЗрд▓рдмреЙрдХреНрд╕ / рдордзреНрдп / рдмреЙрдХреНрд╕рд┐рдб</i> рдХреЛ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рдХреЗ рд░реВрдк рдореЗрдВ (рджреЛрд╣рд░реЗ рдЙрджреНрдзрд░рдг рдЪрд┐рд╣реНрдиреЛрдВ рдореЗрдВ) рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдпрд╣ рдХреНрд╡реЗрд░реА рдмрд╣реБрдд рд╕рд╛рд░реЗ рдЦреЛрдЬ, tk рдХреЛ рд▓реМрдЯрд╛ рджреЗрдЧреАред  рдРрд╕реА рд╕реНрдЯреНрд░рд┐рдВрдЧ рди рдХреЗрд╡рд▓ рдЙрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдкрд╛рдИ рдЬрд╛ рд╕рдХрддреА рд╣реИ рдЬрд╣рд╛рдВ HTTP рдкреИрд░рд╛рдореАрдЯрд░ рдирд┐рдХрд╛рд▓реЗ рдЬрд╛рддреЗ рд╣реИрдВред  рдпрджрд┐ рд╣рдо рдЗрд╕ рд╕реЗрдЯ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рдЬрд╛рд░реА рд░рдЦрддреЗ рд╣реИрдВ, рддреЛ рд╣рдореЗрдВ рднрд╛рд░реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рдЭреВрдареЗ рдорд┐рд▓ рдЬрд╛рдПрдВрдЧреЗред <br><br>  рдЗрд╕рд▓рд┐рдП, рд╣рдо рдХреЗрд╡рд▓ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ ( <i>webRemoteMethods</i> ) рдХреЗ рдЯреЛрдХрди рдХреА рдЦреЛрдЬ рдХрд░реЗрдВрдЧреЗред  рд╕рднреА рдмрдЪреНрдЪреЗ рдХреЗ рдЯреЛрдХрди рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, CMBQL рдлрд╝рдВрдХреНрд╢рди <i>GetByAncs () рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ</i> : <br><br><pre> <code class="java hljs">result = All.GetByAncs(webRemoteMethods);</code> </pre> <br>  рдЕрдиреБрд░реЛрдз <i>WebRemote рдХреЗ</i> рд░реВрдк рдореЗрдВ рдПрдиреЛрдЯреЗрдЯ рдХрд┐рдП рдЧрдП рддрд░реАрдХреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╕рднреА рдЯреЛрдХрди <i>рд▓реМрдЯрд╛рдПрдЧрд╛</i> ред  рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдЗрд╕ рд╕реНрддрд░ рдкрд░, рд╣рдо рдЙрди рддрд░реАрдХреЛрдВ рдХреЗ рдЯреЛрдХрди рдХреЛ рдлрд╝рд┐рд▓реНрдЯрд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдорд╛рд▓рд┐рдХ рдХреА рдЬрд╛рдВрдЪ рдХреА рдЬрд╛рддреА рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдо рдмрдЪреНрдЪреЗ рдХреЗ рдЯреЛрдХрди рдХреА рдЦреЛрдЬ рдХреЗ рд▓рд┐рдП рдкрд┐рдЫрд▓реА рдХреНрд╡реЗрд░реА рдХреЛ рдЗрд╕ рддрд░рд╣ рд╕реЗ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦрддреЗ рд╣реИрдВ рдЬреИрд╕реЗ рдХрд┐ <i>рд╡реЗрдмрд░реЛрдЯ</i> рддрд░реАрдХреЛрдВ рдХреЗ рдХреЗрд╡рд▓ рдмрдЪреНрдЪреЗ рдХреЗ рдЯреЛрдХрди рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ, рдЬрд╣рд╛рдВ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдорд╛рд▓рд┐рдХ рдХреЗ рд▓рд┐рдП рдХреЛрдИ рд╕реБрд░рдХреНрд╖рд╛ рдЬрд╛рдВрдЪ рдирд╣реАрдВ рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╢рд░реНрдд рдХреЗ рд╕рд╛рде рдПрдХ рд▓реВрдк рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ: <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//          CxList entry_point_tokens = All.NewCxList(); //      webRemoteMethods foreach (CxList method in webRemoteMethods) { //        CxList method_tokens = All.GetByAncs(method); // ,       ,    owner if (method_tokens.FindByName(idorSanitizer).Count &gt; 0) { //  ,     , ,     } else { //  ,         entry_point_tokens.Add(method_tokens); } }</span></span></code> </pre><br>  рдЕрдм рд╣рдо HTTP <i>рдореЗрд▓рдмреЙрдХреНрд╕ рдореЗрд▓рдмреЙрдХреНрд╕</i> рдорд╛рдкрджрдВрдбреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЕрдзрд┐рдХ рд╕рдЯреАрдХ рдЪрдпрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br><pre> <code class="java hljs">CxList getMailboxHTTPParams = entry_point_tokens.FindByName(<span class="hljs-string"><span class="hljs-string">"\"mailboxid\""</span></span>) + entry_point_tokens.FindByName(<span class="hljs-string"><span class="hljs-string">"\"mid\""</span></span>) + entry_point_tokens.FindByName(<span class="hljs-string"><span class="hljs-string">"\"boxid\""</span></span>); result = getMailboxHTTPParams;</code> </pre> <br>  рд▓реЗрдХрд┐рди рд╣рдо рдЙрди рд╕реНрдерд╛рдиреЛрдВ рдореЗрдВ рд░реБрдЪрд┐ рдирд╣реАрдВ рд░рдЦрддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ HTTP рдкреИрд░рд╛рдореАрдЯрд░ рдкреБрдирд░реНрдкреНрд░рд╛рдкреНрдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЙрди рдЪрд░ рдореЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдЕрдВрддрддрдГ HTTP рдорд╛рдкрджрдВрдбреЛрдВ рдХреЗ рдореВрд▓реНрдпреЛрдВ рдХреЛ рд╕реМрдВрдкрд╛ рдЧрдпрд╛ рд╣реИред  рдЪреВрдБрдХрд┐ рдЪрд░ рдХреЗ рдЯреЛрдХрди рджреНрд╡рд╛рд░рд╛ рдлреНрд▓реЛ рдХреА рдЦреЛрдЬ рдХрд░рдирд╛ рдЕрдзрд┐рдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реИред <br><br>  CMxQL рдлрд╝рдВрдХреНрд╢рди <i>FindByInitialization ()</i> рджрд┐рдП рдЧрдП рдЯреЛрдХрди рдХреЗ рд▓рд┐рдП рдЪрд░ рдЖрд░рдВрднреАрдХрд░рдг рдХреЗ рд╕реНрдерд╛рдиреЛрдВ рдХреЛ <i>рдвреВрдВрдвреЗрдЧрд╛</i> : <br><br><pre> <code class="java hljs">CxList mailboxidInit = entry_point_tokens.FindByInitialization(getMailboxHTTPParams); result = mailboxidInit;</code> </pre> <br>  рдкрд░рд┐рдгрд╛рдо: <br><br><img src="https://habrastorage.org/webt/cp/e7/5q/cpe75qru5pcwzikvaona3h7w67c.png"><br><br><h3>  IDOR: рд╕реНрдЯреЗрдк 5. webRemoteMethods рд╕реЗ рд▓реЗрдХрд░ рдорд┐рдбрд▓рд╡реЗрдпрд░ рдореЗрдердб рдФрд░ рдЗрди рдХреЙрд▓реНрд╕ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рддрдХ рд╕рднреА рдХреЙрд▓реНрд╕ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ </h3><br>  рдорд┐рдбрд▓рд╡реЗрдпрд░ рджреНрд╡рд╛рд░рд╛, рдореЗрд░рд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рд╡рд╣ рдХреЛрдб рдЬреЛ HTTP API рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рддрд░реАрдХреЛрдВ рд╕реЗ рдЕрдзрд┐рдХ рдЧрд╣рд░рд╛ рд╣реИ, рдЬреЛ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреБрд░реЛрдзреЛрдВ рдХреЗ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБрдУрдВ рд╕реЗ рдЕрдзрд┐рдХ рдЧрд╣рд░рд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдКрдкрд░ рджрд┐рдП рдЧрдП рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдХреЗ рд▓рд┐рдП, рдпреЗ <i>рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛</i> рд╡рд░реНрдЧ рдХреЗ рддрд░реАрдХреЗ рд╣реИрдВ, <i>user.getSettings ()</i> рдФрд░ <i>user.getSecureSettings () рдХреЗ</i> рд▓рд┐рдП рдХреЙрд▓: <br><br><pre> <code class="java hljs">CxList middlewareMethods = All.FindByShortName(<span class="hljs-string"><span class="hljs-string">"user"</span></span>).GetRightmostMember(); CxList middlewareMethodsParams = entry_point_tokens.GetParameters(middlewareMethods); result = middlewareMethodsParams;</code> </pre> <br>  рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ, рд╣рдо рдирд╛рдо рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдХреЗ рд╕рд╛рде рд╕рднреА рдЯреЛрдХрди рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ <i>GetRightmostMember ()</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ <i>рд╣рдо</i> рдорд┐рдбрд▓рд╡реЗрдпрд░ рдХреЗ рд▓рд┐рдП рдХреЙрд▓ рдЯреЛрдХрди рдХрд╛ рдЪрдпрди рдХрд░рддреЗ рд╣реИрдВред  рд╡рд┐рдзрд┐ рдХреЙрд▓ рдХреА рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ <i>GetRightmostMember ()</i> рд╕рдмрд╕реЗ рд╕рд╣реА рд▓реМрдЯрд╛рдПрдЧрд╛ред  рдлрд┐рд░ рд╣рдо <i>рдЧреЗрдЯрдкрд╛рдореЗрдЯрд░реНрд╕ ()</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкрд╛рдпрд╛ рд╡рд┐рдзрд┐ рдХреЗ рдорд╛рдкрджрдВрдбреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд░рддреЗ рд╣реИрдВред <br><br>  рдкрд░рд┐рдгрд╛рдо: <br><br><img src="https://habrastorage.org/webt/8b/mm/2a/8bmm2ad7zg-xwponufdxuocn-t0.png"><br><br><h3>  IDOR: рд╕реНрдЯреЗрдк 6. рдорд┐рдбрд▓рд╡реЗрдпрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдЦреЛрдЬреЗрдВ рдЬреЛ рдореЗрд▓рдмреЙрдХреНрд╕рд┐рдб рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреА рд╣реИрдВ </h3><br>  рдкреНрд░рд╡рд╛рд╣ рд╡рд┐рд╢реНрд▓реЗрд╖рдг <i>* InfluencedBy *</i> рдФрд░ <i>* InfluncingOn * рд╡рд┐рдзрд┐рдпреЛрдВ</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред  рдЙрдирдХреЗ рдмреАрдЪ рдХрд╛ рдЕрдВрддрд░ рдирд╛рдо рд╕реЗ рд╕реНрдкрд╖реНрдЯ рд╣реИред <br><br>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП: <br><br><pre> <code class="java hljs">All.InfluencedBy(getMailboxHTTPParams)</code> </pre> <br>  рд╕реЗрдЯ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдЬрд╛рдирд╛ рд╣реЛрдЧрд╛ рд╕рднреА рдФрд░ рд╕рднреА рдЯреЛрдХрди рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ рдЬреЛ <i>getMailboxHTTPParams</i> рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддреЗ рд╣реИрдВред <br><br>  рдЙрд╕реА рдХреЛ рджреВрд╕рд░реЗ рддрд░реАрдХреЗ рд╕реЗ рд▓рд┐рдЦрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="java hljs">getMailboxHTTPParams.InfluencingOn(All)</code> </pre> <br><br>  <i>рдореЗрд▓рдмреЙрдХреНрд╕рдирд┐рдбрд┐рдЯ</i> рдкрд░ рдирд┐рд░реНрднрд░ рдЯреЛрдХрди рдХреА рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП: <br><br><pre> <code class="java hljs">CxList apiPotentialIDOR = entry_point_tokens.InfluencedByAndNotSanitized(mailboxidInit, idorSanitizer); result = apiPotentialIDOR;</code> </pre><br>  рдкрд░рд┐рдгрд╛рдо: <br><br><img src="https://habrastorage.org/webt/xl/wa/rq/xlwarqf4bvr96xchztinpiua7h4.png"><br><br><h3>  IDOR: рдЪрд░рдг 7. рдорд┐рдбрд┐рд▓рд╡реЗрдпрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рднреА рд╕реНрдерд╛рдиреЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдПрдВ </h3><br>  рдЖрдЗрдП рд╣рдо рдЙрди рд╕рднреА рдордзреНрдпрд╡рд░реНрддреА рддрд░реАрдХреЛрдВ рдХреА рдкрд░рд┐рднрд╛рд╖рд╛рдПрдБ рдЦреЛрдЬреЗрдВ рдЬреЛ рдЙрди рд╕реНрдерд╛рдиреЛрдВ рдкрд░ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд╣рд╛рдБ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ рдЕрдиреБрд░реЛрдз рд╕рдВрд╕рд╛рдзрд┐рдд рд╣реЛрддреЗ рд╣реИрдВред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рдЙрдирдХреА рд╕рд╛рдорд╛рдиреНрдп рд╕рдВрдкрддреНрддрд┐ рдкрд░ рдкреНрд░рдХрд╛рд╢ рдбрд╛рд▓рддреЗ рд╣реИрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдРрд╕реЗ рд╕рднреА рддрд░реАрдХреЛрдВ рдореЗрдВ <i>рдЕрдиреБрд░реЛрдз ()</i> рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рд╣реЛрддрд╛ рд╣реИ, рдСрдмреНрдЬреЗрдХреНрдЯ рдХрд╛ рдирд┐рд░реНрдорд╛рдг CMx рдкреНрд░рдХрд╛рд░ <i>ObjectCreateExpr</i> : <br><br><pre> <code class="java hljs">CxList requests = (All - exclusionList).FindByType(typeof(ObjectCreateExpr)).FindByName(<span class="hljs-string"><span class="hljs-string">"*Request*"</span></span>); CxList middlewareDecl = requests.GetAncOfType(typeof(MethodDecl)); result = middlewareDecl;</code> </pre> <br><br>  <i>(рд╕рднреА - рдмрд╣рд┐рд╖реНрдХрд░рдг)</i> - рдЖрдк рд╕реЗрдЯ рдХреЗ рдЗрд╕ рдШрдЯрд╛рд╡ рдХреЛ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдкрд░рд┐рдгрд╛рдо рд╕реЗ рд╡рд╛рдВрдЫрд┐рдд CMxQL рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  <i>рдЕрдиреБрд░реЛрдз рдореЗрдВ</i> рдЕрдм рд╕рднреА рдЯреЛрдХрди рд╣реЛрддреЗ рд╣реИрдВ рдирд╛рдо рдХреЗ рд╕рд╛рде <i>рдЕрдиреБрд░реЛрдз</i> рдФрд░ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рдирд┐рд░реНрдорд╛рдг рдХреЗ рд▓рд┐рдП рдЗрд╕реА рдкреНрд░рдХрд╛рд░ред <br><br>  рдЕрдЧрд▓рд╛, рдкрд░рд┐рдЪрд┐рдд <i>GetAncOfType ()</i> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ <i>,</i> рд╣рдо <i>MethodDecl</i> рдХреЗ рдореВрд▓ рдЯреЛрдХрди рдХреЛ <i>рдЦреЛрдЬрддреЗ рд╣реИрдВ</i> ред <br><br>  рдкрд░рд┐рдгрд╛рдо: <br><br><img src="https://habrastorage.org/webt/pp/ie/21/ppie21nmruhnqfekmune0fa5ytu.png"><br><br><h3>  IDOR: рдЪрд░рдг 8. рд╕рднреА apiPotentialIDOR рдкрд░ рдЬрд╛рдПрдВ рдФрд░ рдХреЗрд╡рд▓ рдЙрди рдорд┐рдбрд▓рд╡реЗрдпрд░рдбреЗрдХ рдХрд╛ рдЪрдпрди рдХрд░реЗрдВ рдЬрд┐рд╕рдореЗрдВ рдореЗрд▓рдмреЙрдХреНрд╕ рдСрдмреНрдЬреЗрдХреНрдЯ рдХреЗ рд╕реНрд╡рд╛рдореА рдХрд╛ рдХреЛрдИ рд╕рддреНрдпрд╛рдкрди рдирд╣реАрдВ рд╣реИ </h3><br>  рдЕрдиреБрд░реЛрдз рдХреЗ рдЕрдВрддрд┐рдо рднрд╛рдЧ рдореЗрдВ, рд╣рдо рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдХреМрди рд╕реЗ рдорд┐рдбрд▓рд╡реЗрдпрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рд╕реАрдзреЗ рдкреНрд░рд╡реЗрд╢ рдмрд┐рдВрджреБ рд╡рд┐рдзрд┐рдпреЛрдВ рд╕реЗ рдмреБрд▓рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдпрд╣ рдордд рдЬрд╛рдВрдЪреЗрдВ рдХрд┐ <i>рдореЗрд▓рдмреЙрдХреНрд╕ рдХрд┐рд╕рдХрд╛</i> рд╣реИред  рдлрд┐рд░ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЗ рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХреЗ рд▓рд┐рдП рдлреНрд▓реЛ рдХреЛ рдорд┐рд▓рд╛рдПрдВред <br><br>  рдирдИ рд╕реБрд╡рд┐рдзрд╛рдПрдБ рдЬреЛ рд╣рдордиреЗ рдЕрднреА рддрдХ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХреА рд╣реИрдВ: <br>  <i>GetCxListByPath ()</i> - рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдлрд╝реНрд▓реЛ рдкрд░ рдкреБрдирд░рд╛рд╡реГрддрд┐ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рдпрджрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рддреЛ CMx рдХреЛрдб рдПрд▓реАрдореЗрдВрдЯ рдореЗрдВ рдлрд╝реНрд▓реЛ рдХреЛ рд╕рдВрдкреАрдбрд╝рд┐рдд рдХрд░реЗрдЧрд╛ (рдкрд╣рд▓реЗ рдлрд╝реНрд▓реЛ рдиреЛрдб рдореЗрдВ) <br>  <i>рд╕рдВрдШрдЯрдХ * ()</i> - рдПрдХ рдореЗрдВ рдХрдИ рдкреНрд░рд╡рд╛рд╣ рдХреЗ рд╕рдВрдпреЛрдЬрди рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдХрдИ рдХрд╛рд░реНрдп <br>  <i>FindByParameters ()</i> - рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдкреИрд░рд╛рдореАрдЯрд░ рдЯреЛрдХрди рджреНрд╡рд╛рд░рд╛ рдПрдХ рд╡рд┐рдзрд┐ рдЦреЛрдЬреЗрдВ <br>  <i>GetName ()</i> - рдЯреЛрдХрди рдирд╛рдо рдХреЗ рд╕рд╛рде рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд▓реМрдЯрд╛рдПрдЧрд╛, рдЕрдЧрд░ CxList рдореЗрдВ рдПрдХ рд╕реЗ рдЕрдзрд┐рдХ рддрддреНрд╡ рд╣реИрдВ, рддреЛ рдпрд╣ рдкрд╣рд▓реЗ рд╡рд╛рдкрд╕ рдЖ рдЬрд╛рдПрдЧрд╛ред  рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреЗрд╡рд▓ рддрдм рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдЬрдм рдПрдХ рд╕реЗрдЯ рдХреЗ рддрддреНрд╡реЛрдВ рдкрд░ рдкреБрдирд░рд╛рд╡реГрддреНрддрд┐ рд╣реЛрддреА рд╣реИред <br><br>  рдЕрдиреБрд░реЛрдз рдХрд╛ рдЕрдВрддрд┐рдо рднрд╛рдЧ: <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//    CxList vulns = All.NewCxList(); //   Flow  apiPotentialIDOR foreach(CxList cxFlow in apiPotentialIDOR.GetCxListByPath()) { //    Flow CxList endNode = cxFlow.GetStartAndEndNodes(CxList.GetStartEndNodesType.EndNodesOnly); //       flow (mailboxid) CxList method_call = entry_point_tokens.FindByParameters(endNode); //     CxList method_decl = middlewareDecl.FindByShortName(method_call.GetName()); //     if (method_decl.Count &gt; 0) { //       CxList _all = (All - exclusionList).GetByAncs(method_decl); //       if (_all.FindByName(idorSanitizer).Count &gt; 0) { //  ,       cxLog.WriteDebugMessage("find sanitized in method: " + method_call.GetName()); //  ,   Flow     vulns } else { //     Flow       vulns.Add(cxFlow.ConcatenatePath(method_call).ConcatenatePath(method_decl)); cxLog.WriteDebugMessage("find NOT sanitized in method: " + method_call.GetName()); } } }</span></span></code> </pre> <br><br>  рдкрд░рд┐рдгрд╛рдо: <br><br><img src="https://habrastorage.org/webt/_z/qs/rj/_zqsrju8bqoni7u0ksolmokizhe.png"><br><br> <i>CocatenatePath</i>  ,          .     Code Element  Flow <br><br><h3> IDOR:     IDOR </h3><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// 1.   CxList exclusionList = All.FindByFileName("*WebMethodContext.java"); // 2.     CxList idorSanitizer = All.FindByName("*validateMailbox*"); // 3.    тАУ    HTTP  CxList webRemoteMethods = All.FindByCustomAttribute("WebRemote").GetAncOfType(typeof(MethodDecl)); // 4.         HTTP  mailboxid //     CxList entry_point_tokens = All.NewCxList(); foreach (CxList method in webRemoteMethods) { CxList method_tokens = All.GetByAncs(method); if (method_tokens.FindByName(idorSanitizer).Count &gt; 0) { } else { entry_point_tokens.Add(method_tokens); } } //    HTTP    -  CxList getMailboxHTTPParams = entry_point_tokens.FindByName("\"mailboxId\"") + entry_point_tokens.FindByName("\"mid\"") + entry_point_tokens.FindByName("\"boxid\""); CxList mailboxidInit = entry_point_tokens.FindByInitialization(getMailboxHTTPParams); // 5.      middleware     CxList middlewareMethods = All.FindByShortName("user").GetRightmostMember(); CxList middlewareMethodsParams = entry_point_tokens.GetParameters(middlewareMethods); // 6.  middleware ,     mailboxid CxList apiPotentialIDOR = entry_point_tokens.InfluencedByAndNotSanitized(mailboxidInit, idorSanitizer); // 7.      middleware      CxList requests = (All - exclusionList).FindByType(typeof(ObjectCreateExpr)).FindByName("*Request*"); CxList middlewareDecl = requests.GetAncOfType(typeof(MethodDecl)); // 8.    apiPotentialIDOR     middlewareDecl,      CxList vulns = All.NewCxList(); foreach(CxList cxFlow in apiPotentialIDOR.GetCxListByPath()) { CxList endNode = cxFlow.GetStartAndEndNodes(CxList.GetStartEndNodesType.EndNodesOnly); CxList method_call = entry_point_tokens.FindByParameters(endNode); CxList method_decl = middlewareDecl.FindByShortName(method_call.GetName()); if (method_decl.Count &gt; 0) { CxList _all = (All - exclusionList).GetByAncs(method_decl); if (_all.FindByName(idorSanitizer).Count &gt; 0) { cxLog.WriteDebugMessage("find sanitized in method: " + method_call.GetName()); } else { vulns.Add(cxFlow.ConcatenatePath(method_call).ConcatenatePath(method_decl)); cxLog.WriteDebugMessage("find NOT sanitized in method: " + method_call.GetName()); } } } result = vulns;</span></span></code> </pre><br><br><h2>  рдирд┐рд╖реНрдХрд░реНрд╖ </h2><br> Checkmarx      ,     .        ,      ,   ,     ..      Flow (    ).           ,         ,    ┬л┬╗ . <br><br>     false positive,     : <br><ul><li>     ,       (   ). </li><li>     ,    (  ). ,     ┬лPrivacy Violation┬╗,   ,         ,    Web UI.    , ..       UI    .       TLS        XSS     . </li><li>  -    ,           (,   ). ,   XXE  ,   , -    ,   . </li><li>   false positive,   ,           CMxQL   FindBy/GetBy.         ,     (        SQL). </li><li>   false positives,    ,      ,   ,       ,   CMx,      . ,       LDAP ,      .       c LDAP-   ,   ,      . </li></ul><br><br>   how-to     ┬лhello world┬╗  ,        Checkmarx. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi477742/">https://habr.com/ru/post/hi477742/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi477732/index.html">рдкрд╛рдиреА рдХреЗ рдиреАрдЪреЗ рдиреЗрд╡рд┐рдЧреЗрд╢рди рд╕рд┐рд╕реНрдЯрдо рдХреА рдЧрд▓рдд рдЙрдВрдЧрд▓реА рдХрд╛ рд╡рд░реНрдЧреАрдХрд░рдг</a></li>
<li><a href="../hi477734/index.html">рдлреЛрдЯреЛ рдРрдк рдХреЗ рд╕рд╛рде UICollectionViewLayout рдХреЛ рд╕рдордЭрдирд╛</a></li>
<li><a href="../hi477736/index.html">рдкрд░реАрдХреНрд╖рдХ рдХрд╛ рд░рд╛рд╕реНрддрд╛: "рд╣реИрдВрдбрдмреНрд░реЗрдХ" рд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рди рддрдХ</a></li>
<li><a href="../hi477738/index.html">iKassa рдпрд╛ рд╣рдордиреЗ "рдбрд┐рдЬрд┐рдЯрд▓ рдХреИрд╢рд┐рдпрд░" рдХрд╛ рдирд╛рдо рдХреИрд╕реЗ рд░рдЦрд╛</a></li>
<li><a href="../hi477740/index.html">рдФрд░ рдЗрд╕ рджреВрд░рдмреАрди рдХреЛ рдЕрдкрдиреА рдЖрдБрдЦ рд╕реЗ рдХрд╣рд╛рдБ рджреЗрдЦрдирд╛ рд╣реИ?</a></li>
<li><a href="../hi477744/index.html">рдкреЗрд╢реЗрд╡рд░ рдХрднреА-рдХрднреА рдЦрд░рд╛рдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреНрдпреЛрдВ рдмрдирд╛рддреЗ рд╣реИрдВ?</a></li>
<li><a href="../hi477746/index.html">рдореБрджреНрд░реАрдХрд░рдг рдбрд┐рдЬрд╛рдЗрдирд░: рд╡рд╣ рдХреМрди рд╣реИ рдФрд░ рдПрдХ рдХреИрд╕реЗ рдмрдирдирд╛ рд╣реИ</a></li>
<li><a href="../hi477754/index.html">рд╕реВрдХреНрд╖реНрдо рдХреА рддреБрд▓рдирд╛ рдХрд░реЗрдВ: Arduino рдХреЗ рд╕рд╛рде рдмрд┐рдЯред рдФрд░ рдпрджрд┐ рдЖрдк рдПрдХ рдЕрдВрдЧреНрд░реЗрдЬреА рдЫрд╛рддреНрд░ рдирд╣реАрдВ рд╣реИрдВ, рддреЛ рдореБрдлреНрдд рдореЗрдВ рдорд╛рдЗрдХреНрд░реЛ рдХреИрд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ?</a></li>
<li><a href="../hi477756/index.html">рд╣рдордиреЗ рджреЛ рдмреИрдВрдХрд┐рдВрдЧ рд╕реАрдЖрд░рдПрдо рд╕рд┐рд╕реНрдЯрдо рд╕реЗ рд╢рд╛рджреА рдХреИрд╕реЗ рдХреА</a></li>
<li><a href="../hi477758/index.html">"рдбреЙрдХреНрдЯрд░, рдЗрд╕реЗ рдмрд┐рд▓ рд╕реЗ рд╣рдЯрд╛ рджреЗрдВ": рд╣рдордиреЗ рд╡реАрдПрдЪрдЖрдИ рдореЗрдВ рдЕрд╡реИрдз рд╕реЗрд╡рд╛рдУрдВ рдХреА рддрд▓рд╛рд╢ рдХреИрд╕реЗ рдХреА</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>