<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧛🏼 👟 🤶🏾 MIT-Kurs "Computer Systems Security". Vorlesung 3: Pufferüberläufe: Exploits und Schutz, Teil 3 🔴 👏🏻 👨🏼‍🎨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Massachusetts Institute of Technology. Vorlesung # 6.858. "Sicherheit von Computersystemen." Nikolai Zeldovich, James Mickens. 2014 Jahr 
 Computer Sy...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MIT-Kurs "Computer Systems Security". Vorlesung 3: Pufferüberläufe: Exploits und Schutz, Teil 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/418099/"><h3>  Massachusetts Institute of Technology.  Vorlesung # 6.858.  "Sicherheit von Computersystemen."  Nikolai Zeldovich, James Mickens.  2014 Jahr </h3><br>  Computer Systems Security ist ein Kurs zur Entwicklung und Implementierung sicherer Computersysteme.  Die Vorträge behandeln Bedrohungsmodelle, Angriffe, die die Sicherheit gefährden, und Sicherheitstechniken, die auf jüngsten wissenschaftlichen Arbeiten basieren.  Zu den Themen gehören Betriebssystemsicherheit, Funktionen, Informationsflussmanagement, Sprachsicherheit, Netzwerkprotokolle, Hardwaresicherheit und Sicherheit von Webanwendungen. <br><br>  Vorlesung 1: „Einführung: Bedrohungsmodelle“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 2: „Kontrolle von Hackerangriffen“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <br>  Vorlesung 3: „Pufferüberläufe: Exploits und Schutz“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3</a> <a name="habracut"></a><br><br>  Sie können die Technik des Erraten des "Kanarienvogels" für Ihre eigenen Zwecke verwenden, um das Vorhandensein von "schwachen" Bits in Bezug auf die Auswahl herauszufinden.  Das heißt, wenn Sie richtig geraten haben, wird der Server neu gestartet, und dies dient als Signal für Sie, dass der eingestellte Wert recht einfach zu erraten ist.  Somit ist es möglich, die zufälligen „Kanarienvögel“ zu besiegen, vorausgesetzt, dass sich ihr Wert nach dem Neustart des Servers nicht ändert.  Sie können auch Gadgets verwenden, um eine verwandte Folge mehrerer Angriffe zu implementieren. <br><br>  Als nächstes werden wir uns eine produktivere Methode ansehen, mit der Sie alle diese Methoden verwenden können, um die Verhinderung der Datenausführung, zufällige Adressräume und „Kanarienvögel“ zu umgehen. <br><br>  Wenden wir uns 64-Bit-Architekturen anstelle von 32-Bit-Architekturen zu.  Die ersteren eignen sich besser für die Randomisierung, sodass Sie viel mehr „Chance“ haben, sich gegen einen Hacker zu verteidigen.  Und diese Systeme sehen im Hinblick auf die Angriffsbildung viel interessanter aus. <br><br>  Diese Art der 64-Bit-Architektur wurde auch aus Sicht von <b>BROP</b> , der "blinden" rückwärtsorientierten Programmierung, betrachtet.  Der Einfachheit halber nehmen wir an, dass der einzige Unterschied zwischen 64-Bit- und 32-Bit-Maschinen darin besteht, dass auf einer 64-Bit-Maschine Argumente an die Register und für eine 32-Bit-Maschine an den Stapel übergeben werden. <br><br><img src="https://habrastorage.org/webt/hg/z1/jc/hgz1jcij9zzqbaqc3fiztx1ctze.jpeg"><br><br>  Wenn eine Funktion mit der Ausführung beginnt, wird nach bestimmten Registern gesucht, um herauszufinden, wo sich die Argumente befinden. <br><br>  Kommen wir nun zum Kern des heutigen Vortrags - was ist Blind Return-orientiertes Programmieren oder <b>BROP?</b>  Das erste, was wir tun werden, ist ein Stopp-Gadget zu finden.  Denken Sie daran, dass wir mit "Gadget" im Wesentlichen Absenderadressen meinen.  Das Gadget wird mit der Absenderadresse identifiziert, der Startadresse der Befehlsfolge, zu der wir gehen möchten.  Was ist ein Stopp-Gadget? <br><br>  Im Wesentlichen ist dies die Absenderadresse an einer Stelle im Code. Wenn Sie jedoch dorthin springen, halten Sie das Programm einfach an, ohne dass das Programm abstürzt.  Aus diesem Grund wird dies als Stopp-Gadget bezeichnet. <br><br>  Sie könnten an eine Stelle im Code springen, die dann einen Aufruf des Schlafsystems oder Pausen oder ähnliches auslöst.  Es ist möglich, dass das Programm in einer Endlosschleife „hängen bleibt“, wenn Sie an diesen Ort springen.  Es spielt keine Rolle, warum der Stopp auftritt, aber Sie können sich einige Szenarien vorstellen, die dazu führen würden. <br><br>  Was nützt ein Stopp-Gadget? <br><br>  Sobald es dem Angreifer gelungen ist, den „Kanarienvogel“ mithilfe der interaktiven Technik des Erraten von Bits zu besiegen, kann er beginnen, diese Absenderadresse und <b>Ret-Adresse</b> neu zu schreiben und das Stopp-Gadget zu „tappen“.  Beachten Sie, dass die meisten zufälligen Adressen, die Sie auf dem Stapel platzieren können, wahrscheinlich einfach zum Absturz des Servers führen.  Auch diese Nachricht ist für Sie, den Angreifer, ein Hinweis darauf, dass das, was Sie gefunden haben, kein Stopp-Gadget ist.  Denn wenn der Server abstürzt, wird Ihr Socket geschlossen und Sie als Angreifer verstehen, dass Sie nicht auf das Stopp-Gadget gekommen sind.  Aber wenn Sie etwas erraten haben und die Steckdose danach noch eine Weile offen bleibt, denken Sie: "Ja, ich habe dieses Stopp-Gadget gefunden!"  Die Grundidee des ersten Schritts besteht also darin, dieses Stopp-Gadget zu finden. <br><br><img src="https://habrastorage.org/webt/xb/af/zx/xbafzxirvhgep_31ahp8fuzpey4.jpeg"><br><br>  Schritt zwei ist, dass Sie Gadgets suchen möchten, die Stapeleinträge mit dem Befehl <b>pop</b> löschen.  Verwenden Sie daher diese Abfolge sorgfältig gestalteter Anweisungen, um herauszufinden, wann Sie eines dieser Stapel-Gadgets greifen.  Diese Sequenz besteht aus der <b>Sondenadresse der Sondenadresse</b> , der <b>Stoppadresse der Stoppadresse</b> und der Systemfehleradresse <b>der Absturzadresse</b> . <br><br>  Daher wird die <b>Sondenadresse</b> auf den Stapel gelegt.  Dies ist die Adresse des potenziellen Gadgets zum Löschen des Stapels, <b>Stoppadresse</b> - dies haben wir im ersten Schritt berücksichtigt, dies ist die Adresse des Stopp-Gadgets.  Die <b>Absturzadresse ist</b> dann einfach die Adresse des nicht ausführbaren Codes.  Hier können Sie einfach die Nulladresse (0 x 0) eingeben. Wenn Sie die <b>Ret-</b> Funktion auf diese Adresse anwenden und versuchen, den Code dort auszuführen, führt dies zu einem Programmabsturz. <br><br><img src="https://habrastorage.org/webt/38/fa/ba/38fabavrj2kahtqh0_ruuxiigaa.jpeg"><br><br>  Wir können diese Arten von Adressen verwenden, um herauszufinden, wo diese Gadgets den <b>Stack-Popping-Stack</b> bereinigen. <br><br>  Ich werde ein einfaches Beispiel geben.  Angenommen, wir haben zwei verschiedene <b>Sondenbeispiele</b> , die <b>Fallenfalle</b> und die <b>Stoppfalle</b> .  Angenommen, wir werden mit Hilfe der <b>Sonde</b> eine Adresse "prüfen". Angenommen, sie beginnt mit 4 und endet mit acht: 0x4 ... 8, und dahinter befindet sich die nächste Adresse der Form 0x4 ... C.  Hypothetisch können wir annehmen, dass eine dieser beiden Adressen die Adresse des <b>Stack-Popping-</b> Gadgets ist. <br><br>  Die <b>Trap-Trap</b> erhält die Nulladressen 0x0 und 0x0 und lässt das <b>Stop-</b> Gadget- <b>Stop</b> beliebige Adressen wie 0xS ... 0xS ... haben, das spielt keine Rolle.  Dieses Stopp-Gadget zeigt auf den Code sleep (10), wodurch das Programm angehalten wird. <br><br>  Beginnen wir mit der <b>Sondenoperation</b> , bei der ein Register gelöscht und in der folgenden Reihenfolge zurückgegeben wird: <b>pop rax;</b>  <b>ret</b> .  Was wird passieren?  Wenn das System zu dieser Adresse springt, bewegt sich der Stapelzeiger in die Mitte unseres Gadgets.  Was wird das Gadget hier tun?  Richtig, führen Sie eine <b>Pop-Rax-</b> Operation durch. <br><br><img src="https://habrastorage.org/webt/i2/eu/zr/i2euzrwlujsohfb4dl-szdeasac.jpeg"><br><br>  Und dann folgt <b>ret</b> , wodurch die Funktion in die oberste Zeile des Gadgets verschoben wird, dh <b>gestoppt wird</b> , und die Funktion stoppt, ohne das gesamte Programm zum Absturz zu bringen.  Mit diesem Gadget kann ein Angreifer also sagen, dass die Testadresse zu einer dieser Funktionen gehört, wodurch der Stapel gelöscht wird, da die Server-Client-Verbindung offen ist. <br><br>  Nehmen wir nun an, dass die zweite <b>Sondenadresse</b> für ein Register auf etwas wie <b>xor rax, rax, ret zeigte</b> . <br><br><img src="https://habrastorage.org/webt/kw/5t/r3/kw5tr3vdtrqedphe0onl6ec-wa0.jpeg"><br><br>  Was passiert also, wenn wir versuchen, zu diesem Gadget zu springen?  Beachten Sie, dass nichts auf dem Stapel gelöscht wird, sondern nur der Inhalt der Register geändert wird.  Wir werden also zu der oben angegebenen 0x0-Adresse zurückkehren.  Dies führt zum Absturz des Systems.  Die Client-Verbindung zum Server wird unterbrochen, und der Hacker wird verstehen, dass dies kein Gadget zum Löschen des Stapelstapels ist. <br><br>  Auf diese Weise können Sie eine bizarrere Reihe von Fallen verwenden und Gadgets stoppen. Sie können beispielsweise zwei Elemente auf dem Stapel löschen.  Dazu müssen Sie hier nur eine weitere <b>Trap-</b> Anweisung einfügen. Wenn dieses Gadget nicht zwei Elemente löscht, befinden Sie sich in einer dieser Traps, und der Code wird nicht mehr ausgeführt.  Die Materialien für die Vorlesung beschreiben ein sogenanntes <b>BROP-Gadget,</b> das nützlich ist, wenn Sie nicht zur Programmierung zurückkehren <b>möchten</b> .  Aber heute werde ich Ihnen auch sagen, wie Sie diese einfachen <b>Pop-</b> Gadgets verwenden können, um einen ähnlichen Angriff zu starten.  Sobald Sie dies verstanden haben, wird der Umgang mit einem <b>BROP-Gadget</b> viel einfacher. <br><br>  Aber verstehen Sie alle, wie wir die <b>Sondenfunktion</b> für diese Geräte verwenden können?  Angenommen, Sie finden die Position der Codefragmente, mit denen Sie den Stapel mit der <b>Pop-</b> Funktion löschen und ein Element daraus entfernen können. Sie wissen jedoch nicht genau, in welchem ​​Register diese <b>Pop-</b> Funktion funktioniert.  Sie wissen nur, dass sie bereits zur Hinrichtung bereit ist.  Sie müssen jedoch wissen, in welchem ​​Register diese <b>Pop-</b> Gadgets funktionieren, da in einer 64-Bit-Architektur die Register steuern, wo sich die Argumente der Funktion befinden, die Sie aufrufen möchten. <br><br>  Unser Ziel ist es daher, Gadgets zu erstellen, mit denen wir die Werte löschen können, die wir in bestimmte Stapelregister eingegeben haben, und schließlich einen Systemaufruf-Systemaufruf initiieren, mit dem wir etwas Schlechtes tun können. <br>  Jetzt müssen wir bestimmen, welche Register von <b>Pop-</b> Gadgets verwendet werden. <br><br><img src="https://habrastorage.org/webt/xp/w-/hw/xpw-hw9rdgd2argq0yx6xgi3ece.jpeg"><br><br>  Dazu können wir den Systemaufruf pausieren.  Wenn der Systemaufruf angehalten wird, wird die Ausführung des Programms angehalten und es werden keine Argumente akzeptiert.  Und das bedeutet, dass das System alles in den Registern ignoriert. <br><br>  Um die Pause-Anweisung zu finden, die wir ausführen, können Sie alle diese <b>Pop-</b> Gadgets verknüpfen, damit wir sie alle auf den Stapel legen können, und zwischen jedem von ihnen <b>fügen</b> wir <b>eine Syscall-Nummer ein,</b> um anzuhalten.  Dann werden wir sehen, ob wir das Programm auf diese Weise "aussetzen" können.  Lassen Sie mich Ihnen ein konkretes Beispiel geben. <br><br>  Hier fügen wir ein Gadget in die Rücksendeadressenleiste ein, das die <b>RDI-</b> Register löscht und die <b>Ret-</b> Funktion auf sie anwendet.  Darüber setzen wir eine <b>Syscall-Nummer,</b> um anzuhalten. <br><br>  Angenommen, wir haben ein weiteres Gadget darüber, das die <b>Pop-</b> Funktion in einem anderen Register implementiert, z. B. <b>RSI</b> , und dann <b>ret</b> .  Und dann setzen wir die <b>Syscall-Nummer</b> erneut, um anzuhalten.  Und wir tun dies für alle Gadgets, die wir gefunden haben, und landen dann oben auf dem Stapel mit der mutmaßlichen Adresse für <b>syscall</b> . <br><br><img src="https://habrastorage.org/webt/qd/yx/3v/qdyx3vymmlc13o-sceyeimho_ro.jpeg"><br><br>  Erinnern Sie sich noch einmal daran, wie Sie diese Systemaufrufe verwenden.  Sie müssen die <b>Syscall-Nummer</b> in das <b>RAX-</b> Register eintragen und dann die <b>libc-Syscall-</b> Funktion aufrufen, die den angeforderten Systemaufruf ausführen soll. <br><br>  Was passiert also, wenn wir diesen Code ausführen?  Wir werden hierher kommen, zur <b>Ret-Adresszeile</b> , wir werden zur Adresse dieses Gadgets springen. Es sollte beachtet werden, dass der Angreifer weiß, dass dieses Gadget auf der rechten Seite etwas vom Stapel entfernt, aber noch nicht weiß, in welchem ​​Register es sich befindet. <br><br>  Was passiert also, wenn wir zur <b>Ret-Adresse</b> springen?  Er wird die <b>Pop-</b> Funktion verwenden, um den <b>Systemaufruf</b> in einem Register <b>anzuhalten</b> , das dem Angreifer nicht bekannt ist, und dann werden wir diese Kette von Operationen weiter den Stapel hinaufklettern. <br><br>  Wir hoffen, dass eines dieser Gadgets die <b>Pop-</b> Funktion für die <b>Syscall-Nummer</b> im entsprechenden <b>RAX-</b> Register ausführt.  Bis wir hier oben auf dem Stapel ankommen und alle Register "durcheinander bringen", die eine <b>Syscall-Nummer</b> zum Anhalten haben, hoffen wir, dass wir noch ein Register haben, das korrekt sein sollte.  Denn wenn eines unserer Geräte dies tut und wir dann nach einer Weile nach oben zurückkehren, werden wir eine Pause einlegen, wenn wir <b>ret</b> ausführen.  Die Pause dient erneut als Signal an den Angreifer.  Denn wenn diese angenommene Adresse für <b>syscall</b> falsch war, <b>schlägt</b> das Programm fehl. <br><br>  Was erlaubt uns also, diese Angriffsphase durchzuführen?  Wir wissen immer noch nicht, in welchen Registern sich welche <b>Pop-</b> Gadgets befinden, aber wir wissen, dass eines davon den <b>RAX freigibt</b> , den wir steuern möchten.  Und wir kennen wahrscheinlich die <b>Syscall-</b> Adresse, weil wir es geschafft haben, das System <b>anzuhalten</b> . <br><br>  Sobald wir dies getan haben, können wir diese Gadgets einzeln überprüfen und herausfinden, welches das System pausiert.  Mit anderen Worten, wir schneiden alles zwischen der <b>Ret-Adresszeile</b> und der Oberseite des Stapels ab, um direkt zum <b>Systemaufruf zu gelangen</b> .  Wir werden prüfen, ob eine Pause oder ein Systemfehler aufgetreten ist.  Wenn ein Fehler auftritt, identifizieren wir das Gadget, das ihn verursacht hat. Beispiel: In der unteren Zeile rechts befindet sich <b>pop rdi</b> .  Werde ihn los und versuche den nächsten.  Geben Sie hier in die Zeile über der <b>Ret-Adresse die</b> tatsächliche Adresse für <b>syscall ein</b> .  Könnten wir das Programm anhalten?  Ja, das heißt, wir haben gelernt, dass dieses <b>Pop-</b> Gadget <b>RAX</b> freigeben sollte.  Das ist klar? <br><br>  <b>Teilnehmerin:</b> Eine Möglichkeit, die Adresse für einen Systemaufruf zu erraten, ist also nur eine blinde Übertragung von Gadgets? <br><br>  <b>Professor:</b> Ja, und es gibt Möglichkeiten, diesen Prozess in den Vorlesungsmaterialien zu optimieren, wenn Sie die <b>PLT-</b> Dateierweiterung und ähnliche Dinge verwenden.  Mit dem einfachen Angriff, den ich beschrieben habe, fügen Sie einfach die Adresse hier ein und stellen sicher, ob sie eine Pause verursacht hat oder nicht.  Als Ergebnis des Tests ermitteln wir den Standort von <b>syscall</b> .  Wir werden herausfinden, wo sich die Anweisung befindet, die <b>Pop RAX</b> ausführt.  Wir brauchen auch Gadgets, die <b>Pop auch</b> in einigen anderen Registern ausführen.  Sie können ähnliche Tests für sie durchführen.  Verwenden <b>Sie</b> daher anstatt die <b>Syscall-Nummer anzuhalten</b> , <b>push</b> für einen anderen Befehl, der beispielsweise die Argumente <b>RAX</b> und <b>RDI verwendet</b> . <br><br>  Sie können also die Tatsache nutzen, dass es für einen bestimmten Satz von Registern, die Sie steuern möchten, eine Art <b>Systemaufruf</b> gibt, der einem Angreifer ein Signal gibt, um herauszufinden, ob Sie ihn erfolgreich gebrochen haben oder nicht.  Am Ende dieser Phase haben Sie also die <b>Syscall-</b> Adresse und die Gadget-Heap-Adresse, mit denen Sie beliebige Register einfügen können. <br><br>  Und jetzt gehen wir zum vierten Schritt über, der als <b>Schreibaufzeichnung bezeichnet wird</b> .  Der vierte Schritt ist das Aufzeichnen eines Systemaufrufs.  Um <b>write</b> aufrufen zu können, benötigen wir die folgenden Gadgets: <br><br>  <b>pop rdi, ret;</b> <b><br></b>  <b>pop rsi, ret;</b> <b><br></b>  <b>pop rdx, ret;</b> <b><br></b>  <b>Pop Rax, ret;</b> <b><br></b>  <b>syscall</b> <br><br><img src="https://habrastorage.org/webt/kj/1h/ds/kj1hdsjhh1509eliv3vjxte7nw4.jpeg"><br><br>  Wie werden diese Register von einem Systemaufruf verwendet?  Der erste ist der Socket oder allgemeiner der Dateideskriptor, den Sie zum Schreiben übertragen möchten.  Der zweite ist der Puffer, der dritte ist die Länge dieses Puffers, der vierte ist die <b>Systemrufnummer</b> und der fünfte ist der Systemaufruf selbst. <br><br>  Wenn wir also alle diese Gadgets finden, können wir die Werte steuern, die in die Argumente eingebettet sind, die wiederum in diesen Registern abgelegt werden, weil wir sie einfach auf den Stapel „geschoben“ haben. <br><br>  Was soll eine Steckdose sein?  Hier müssen wir ein wenig raten.  Sie können die Tatsache nutzen, dass Linux die Anzahl der gleichzeitig geöffneten Verbindungen für eine Datei begrenzt, die einen Wert von 2024 erreicht. Außerdem sollte dies das Minimum aller verfügbaren sein. <br><br>  Ich frage mich, was wir in den Pufferzeiger einfügen werden.  Das ist richtig, wir beabsichtigen, das Textfragment des Programms hier zu verwenden, wir werden es irgendwo im Programmcode in einen Zeiger setzen.  Dies ermöglicht es uns, die Binärdatei mit dem richtigen Client-Aufruf vom Socket aus dem Speicher zu lesen.  Dann kann der Angreifer diese Binärdatei nehmen, offline offline analysieren und mithilfe von <b>GDB</b> oder einem anderen Tool herausfinden, wo sich all dies befindet.  Der Angreifer weiß, dass jetzt jedes Mal, wenn der Server "abstürzt", die gleichen zufälligen Dinge darin gespeichert werden.  Nachdem ein Angreifer nun die Adressen und Offsets für den Inhalt des Stapels ermittelt hat, kann er diese Gadgets direkt angreifen.  Es kann andere Schwachstellen direkt angreifen, herausfinden, wie die Shell geöffnet werden kann und dergleichen.  Mit anderen Worten, an dem Ort, an dem Sie die Binärdatei mit dem Hacker versehen haben, wurden Sie besiegt. <br><br>  So funktioniert der <b>BROP-</b> Angriff.  Wie gesagt, in den Vorlesungsmaterialien gibt es viele Möglichkeiten, diese Prozesse zu optimieren, aber zuerst müssen Sie das Hauptmaterial verstehen, sonst verliert die Optimierung ihre Bedeutung.  Daher können Sie mit mir einzeln oder nach dem Unterricht über Optimierung sprechen. <br><br>  Im <b>Moment</b> genügt es zu sagen, dass dies die Grundlagen dafür sind, wie Sie einen <b>BROP-</b> Angriff starten <b>können</b> .  Sie müssen das <b>Stopp-</b> Gadget finden, die Gadgets finden, die die Funktion von <b>Pop-</b> Stack-Einträgen ausführen, herausfinden, in welchen Registern sie sich befinden, wo sich <b>syscall befindet</b> , und dann basierend auf den erhaltenen Informationen den <b>Schreibvorgang</b> einleiten. <br><br><img src="https://habrastorage.org/webt/xb/-q/iq/xb-qiqqwytbciwpbxiow5i_fovi.jpeg"><br><br>  Gehen Sie also schnell das Thema durch, wie verteidigen Sie sich gegen <b>BROP</b> ?  Das offensichtlichste, was Sie haben, ist die Re-Randomisierung.  Da die Tatsache, dass "heruntergefallene" Server nicht wieder erscheinen und keine zufälligen Versionen von sich selbst erstellen, als Signal fungiert, das einem Angreifer die Möglichkeit gibt, verschiedene Hypothesen über die Funktionsweise von Programmen zu testen. <br><br>  Eine einfache Möglichkeit, sich zu schützen, besteht darin, bei der Wiederbelebung Ihres Prozesses sicherzustellen, dass Sie <b>Exec</b> anstelle von <b>Fork</b> ausführen.  Denn wenn Sie den Prozess ausführen, erstellen Sie einen völlig neuen, zufällig angeordneten Speicherplatz, zumindest geschieht dies unter Linux.  Wenn Sie unter Linux mit <b>PIE</b> , <b>Position Independent Execution</b> , einer standortunabhängigen ausführbaren Datei, kompilieren, erhalten Sie bei Verwendung von <b>exec</b> nur einen neuen zufälligen Adressraum. <br><br>  Der zweite Weg ist einfach die Verwendung von Windows, da dieses Betriebssystem im Grunde nicht das Äquivalent einer <b>Gabelfunktion</b> hat.  Dies bedeutet, dass ein Server unter Windows unter Windows immer einen neuen zufälligen Adressraum hat. <br><br>  Jemand hier fragte, was passieren würde, wenn er nach einer Serverstörung die Verbindung nicht trennen würde.  Wenn wir also während eines Serverabsturzes diesen Fehler irgendwie „abfangen“ und die Verbindung für eine Weile offen halten, können wir den Angreifer verwirren, sodass er kein Signal über den Fehler erhält und denkt, dass er die richtige Adresse gefunden hat. <br><br>  In diesem Fall wird Ihr <b>BROP-</b> Angriff zu einem <b>DOS-</b> Angriff.  Weil du gerade alle möglichen Zombie-Prozesse hast, die es gibt.  Sie sind nutzlos, aber Sie können sie nicht weiter gehen lassen, sonst müssen Sie diese Informationen löschen. <br><br>  Eine andere Sache, an die Sie denken könnten, ist die Grenzkontrolle, über die wir zuvor gesprochen haben.  Die Materialien der Vorlesung besagen, dass diese Methode unproduktiv ist, da sie doppelt so teuer ist, aber Sie sie trotzdem verwenden könnten. <br><br>  So funktioniert <b>BROP</b> .  Bei den Hausaufgaben wird dort eine heikle Frage gestellt: Was ist, wenn Sie einen Hash der aktuellen Zeit verwenden?  Das heißt, die Zeitspanne, in der Sie das Programm neu starten.  Reicht das aus, um diese Art von Angriff zu verhindern?  Beachten Sie, dass Sie durch Hashing nicht auf magische Weise Entropiebits erhalten, wenn die Daten, die Sie in den Hash eingeben, leicht vorhersehbar sind.  Wenn Ihr Hash Milliarden von Bits enthält, spielt das keine Rolle.  Aber wenn Sie dort nur ein paar Bedeutungen haben, wird der Angreifer sie nur erraten.  Natürlich ist es besser, einen zufälligen Zeit-Hash zu verwenden, als nichts zum Schutz vor einem Hacker zu verwenden, aber dies bietet Ihnen nicht die Sicherheit, auf die Sie zählen sollten. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xSQxaie_h1o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Die Vollversion des Kurses finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br>  Vielen Dank für Ihren Aufenthalt bei uns.  Gefällt dir unser Artikel?  Möchten Sie weitere interessante Materialien sehen?  Unterstützen Sie uns, indem Sie eine Bestellung <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufgeben</a> oder sie Ihren Freunden empfehlen. <b>Habr-Benutzer erhalten 30% Rabatt auf ein einzigartiges Analogon von Einstiegsservern, das wir für Sie erfunden haben:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die ganze Wahrheit über VPS (KVM) E5-2650 v4 (6 Kerne) 10 GB DDR4 240 GB SSD 1 Gbit / s $ 20 oder wie teilt man den Server?</a>  (Optionen sind mit RAID1 und RAID10, bis zu 24 Kernen und bis zu 40 GB DDR4 verfügbar). <br><br>  <b>Dell R730xd 2 mal günstiger?</b>  Nur wir haben <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128 GB DDR4 6 x 480 GB SSD 1 Gbit / s 100 TV von 249 US-Dollar</a> in den Niederlanden und den USA!</b>  Lesen Sie mehr über <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den Aufbau eines Infrastrukturgebäudes.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Klasse mit Dell R730xd E5-2650 v4 Servern für 9.000 Euro für einen Cent?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de418099/">https://habr.com/ru/post/de418099/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de418087/index.html">80% der Selbstbedienungskassen sind gefährdet</a></li>
<li><a href="../de418089/index.html">SolidCraft CNC-Fräsmaschine Übersicht</a></li>
<li><a href="../de418091/index.html">Liste der Artikel und Literatur zu NAS</a></li>
<li><a href="../de418093/index.html">MIT-Kurs "Computer Systems Security". Vorlesung 3: Pufferüberläufe: Exploits und Schutz, Teil 2</a></li>
<li><a href="../de418095/index.html">Über das Gerät der eingebauten Testfunktionalität in Rust (Übersetzung)</a></li>
<li><a href="../de418101/index.html">Etymologie der IT-Begriffe</a></li>
<li><a href="../de418103/index.html">Der Chef von Roscosmos erinnerte sich an seine erste Rakete und teilte Pläne für die Zukunft</a></li>
<li><a href="../de418105/index.html">Warum das Öffnen von YouTube in Firefox oder Edge fünfmal länger dauern kann als in Google Chrome</a></li>
<li><a href="../de418107/index.html">Festlegen eines Präfixes für den MINDEO CS2190-Scanner für die Arbeit mit 1C im Tastaturunterbrechungsmodus</a></li>
<li><a href="../de418111/index.html">Modernes Online-Lernen: Herausforderungen und Trends</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>