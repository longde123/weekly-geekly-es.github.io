<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⬛️ 😃 🎛️ Développement de jeux sur LibGDX à l'aide du modèle Entity Component System 👩🏾‍🌾 🐪 🛀🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut Habr! Je m'appelle Andrey Shilo, je suis développeur Android chez FINCH . Aujourd'hui, je vais vous dire quelles erreurs ne devraient pas être c...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Développement de jeux sur LibGDX à l'aide du modèle Entity Component System</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482374/">  Salut Habr!  Je m'appelle Andrey Shilo, je suis développeur Android chez <a href="https://www.facebook.com/FinchMoscow">FINCH</a> .  Aujourd'hui, je vais vous dire quelles erreurs ne devraient pas être commises lors de l'écriture même du jeu le plus simple et pourquoi l'approche architecturale ECS ( <a href="https://en.wikipedia.org/wiki/Entity_component_system">Entity Component System</a> ) est cool. <br><a name="habracut"></a><br><h2>  La première fois est toujours douloureuse </h2><br>  Nous avons un projet amusant pour une grande entreprise médiatique, qui est un réseau social non standard.  réseau avec des messages, des commentaires, des likes et des vidéos.  Une fois, ils nous ont donné une tâche - introduire la mécanique du jeu comme promotion.  Le jeu ressemblait à de simples mini-courses, où avec un coup sur la gauche / droite, la voiture se déplaçait sur la voie gauche / droite.  Donc, en esquivant les obstacles et en récupérant des boosters, vous deviez arriver à la ligne d'arrivée, dans l'ensemble, le joueur avait trois vies. <br><br>  Le jeu était censé être implémenté directement dans l'application, bien sûr, sur un écran séparé.  Nous avons choisi inconditionnellement <a href="https://libgdx.badlogicgames.com/">LibGDX</a> comme moteur, car vous pouvez coder le jeu sur kotiln et déboguer sur le bureau, en lançant le jeu en tant <a href="https://libgdx.badlogicgames.com/documentation/gettingstarted/Running%2520and%2520Debugging.html">qu'application java</a> .  Dans le même temps, nous n'avions pas de gens qui connaissaient d'autres moteurs pouvant être implémentés dans l'application (si vous le savez, alors partagez-le). <br><br>  Le jeu ressemble à ceci: <br><br><img src="https://habrastorage.org/webt/le/xy/z0/lexyz0syrcyj6czcecctxnw0kh8.jpeg"><br><br>  Étant donné que le jeu selon les savoirs traditionnels d'origine semblait simple, nous ne nous sommes pas plongés dans les approches architecturales.  De plus, les promotions elles-mêmes passent rapidement - en moyenne, une action prend un mois et demi.  En conséquence, plus tard, le code du jeu sera simplement supprimé et ne sera pas nécessaire avant la prochaine promo, à condition que quelqu'un veuille répéter quelque chose comme ça. <br><br>  Tous les facteurs décrits ci-dessus et les gestionnaires bien-aimés et pressants nous ont poussés à écrire un mécanisme de jeu sans aucune architecture. <br><br><h2>  Description du jeu résultant </h2><br>  La plupart du code a été compilé dans les classes: MyGdxGame: <a href="https://libgdx.badlogicgames.com/ci/nightlies/docs/api/com/badlogic/gdx/Game.html">Game</a> , GameScreen: <a href="https://libgdx.badlogicgames.com/ci/nightlies/docs/api/com/badlogic/gdx/Screen.html">Screen</a> et TrafficGame: <a href="https://libgdx.badlogicgames.com/ci/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/Actor.html">Actor</a> . <br><br>  MyGdxGame - est le point d'entrée au début du jeu, ici les paramètres sont transférés au constructeur sous forme de chaînes.  GameScreen et les paramètres de jeu sont également créés ici, qui sont transmis à cette classe, mais sous une forme différente. <br><br>  GameScreen - crée un acteur du jeu TrafficGame, l'ajoute à la scène, lui passe les paramètres déjà mentionnés, et «écoute» les clics de l'utilisateur sur l'écran et appelle les méthodes correspondantes de l'acteur TrafficGame. <br><br>  TrafficGame - l'acteur principal de la scène dans laquelle se déroule tout le mouvement du jeu: rendu et logique de travail. <br><br>  Bien que l'utilisation de <a href="https://github.com/libgdx/libgdx/wiki/Scene2d">scene2d</a> permette de construire des arbres d'imbrication d'acteurs, ce n'est pas la meilleure solution architecturale.  Cependant, pour implémenter un jeu UI / UX (sur LibGDX), scene2d est une excellente option. <br><br>  Dans notre cas, TrafficGame a une énorme collection d'instances mixtes et toutes sortes d'indicateurs de comportement qui étaient autorisés dans les méthodes avec de grandes constructions <i>lorsque</i> .  Un exemple: <br><br><pre><code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isGameActive: <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span> = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(value) { backgroundActor?.isGameActive = value boostersMap.values.filterNotNull().forEach { it.isGameActive = value } obstaclesMap.values.filterNotNull().forEach { it.isGameActive = value } finishActor.isGameActive = value field = value } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> backgroundActoolbarActor <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> pauseButtonActor: PauseButtonActor <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> finishActor: FinishActor <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> isQuizWon = falser: BackgroundActor? = <span class="hljs-literal"><span class="hljs-literal">null</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> playerCarActor: PlayerCarActor <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toolbarActor: To <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pointsTime = <span class="hljs-number"><span class="hljs-number">0f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> totalTimeElapsed = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> timeToFinishTheGame = <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastQuizBoosterTime = <span class="hljs-number"><span class="hljs-number">0.0f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastBoosterTime = <span class="hljs-number"><span class="hljs-number">0.0f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> boostersMap = hashMapOf&lt;<span class="hljs-built_in"><span class="hljs-built_in">Long</span></span>?, BoosterActor?&gt;() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> boosterSpawnedCount = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> totalBoostersEatenCount = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> boosterLimit = <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastBoosterYPos = <span class="hljs-number"><span class="hljs-number">0.0f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toGenerateBooster = <span class="hljs-literal"><span class="hljs-literal">false</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastObstacleTime = <span class="hljs-number"><span class="hljs-number">0.0f</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obstaclesMap = hashMapOf&lt;<span class="hljs-built_in"><span class="hljs-built_in">Long</span></span>?, ObstacleActor?&gt;()</code> </pre> <br>  Naturellement, vous ne devriez pas écrire comme ça.  Mais en défense, je dirai que c'est arrivé parce que: <br><br><ul><li>  Vous devez commencer maintenant, eh bien, et nous montrerons le TK final avec le design plus tard.  Classique </li><li>  Les architectures déjà familières (MVP / MVC / MVVM, etc.) ne conviennent pas à la mise en œuvre du processus de jeu, car elles sont conçues uniquement pour l'interface utilisateur, dans le jeu tout se passe en temps réel. </li><li>  Initialement, le jeu semblait simple, mais en fait il nécessitait beaucoup de code, prenant en compte un grand nombre de nuances, dont la majeure partie a fait surface lors de l'écriture du jeu. </li></ul><br><img src="https://habrastorage.org/webt/8e/cg/sn/8ecgsncl5hmmhmzw8unltjyqgh0.jpeg"><br><br>  En plus de toutes ces difficultés, il existe un autre problème commun avec l'héritage.  Si vous rendez un jeu plus difficile, par exemple un jeu de plateforme, alors la question se pose - "Comment répartir le code réutilisable entre les objets du jeu?".  L'option la plus couramment choisie est l'héritage, où le code réutilisable est placé dans les classes parentes.  Mais cette solution crée de nombreux problèmes si des conditions n'apparaissent pas dans l'arbre d'héritage: <br><br><img src="https://habrastorage.org/webt/xg/tw/_6/xgtw_64w3v31if0kfnwoy9yemlg.png"><br><br>  Et ils résolvent généralement ces problèmes en réécrivant la structure de l'arbre d'héritage à partir de zéro (enfin, cette fois, ce sera certainement mieux), ou les classes parentes sont cassées avec des béquilles. <br><br><img src="https://habrastorage.org/webt/af/8-/4o/af8-4ovkeruwatlo--agakilupm.gif"><br><br><h2>  ECS est notre tout </h2><br>  Une toute autre histoire est notre deuxième jeu promo.  Elle était comme <a href="https://ru.wikipedia.org/wiki/Flappy_Bird">Flappy Bird</a> , mais avec des différences: le personnage était contrôlé par la voix, et le plafond et le sol n'étaient pas des obstacles - on pouvait glisser dessus. <br>  Un exemple de gameplay et à titre de comparaison, le processus de jeu de Flappy Bird: <br><br><img src="https://habrastorage.org/webt/9k/sv/ao/9ksvaojzedwbnyd0nm602f2n90e.gif"><br><img src="https://habrastorage.org/webt/gr/sq/3t/grsq3twwn7aorv6utrvdvgnwldw.gif"><br><br>  Pour plus de clarté, dans l'exemple, la caméra est retirée pour voir les coulisses du jeu.  Le sol et le plafond sont des blocs carrés qui, atteignant le bord, sont réarrangés au début, et les obstacles sont générés selon un motif donné qui vient de l'arrière.  Le design du jeu a été choisi par les clients, alors ne soyez pas surpris. <br><br>  J'aime le développement de jeux pour appareils mobiles et pendant les heures creuses, pour des raisons d'expérimentation, j'explorerai les schémas de jeu et tout ce qui concerne le développement de jeux.  J'ai lu un livre sur <a href="https://gameprogrammingpatterns.com/">les modèles de conception de jeux</a> , mais je n'ai pas compris quelle devrait être la véritable architecture de la logique de jeu, jusqu'à ce que je tombe sur ECS. <br><br>  Entity Component System - le modèle de conception le plus souvent utilisé dans le développement de jeux.  L'idée principale du modèle est la <a href="https://en.wikipedia.org/wiki/Composition_over_inheritance">composition plutôt que l'héritage</a> .  La composition vous permet de mélanger différentes mécaniques sur des objets de jeu, ce qui vous permettra à l'avenir de déléguer la définition des propriétés des objets à un concepteur de jeu, par exemple, par le biais d'un constructeur écrit.  Comme je connaissais déjà ce modèle, nous avons décidé de l'appliquer dans le deuxième match. <br><br>  Considérez les composants du modèle: <br><br><ul><li>  <i>Composant</i> - objets avec une <b>structure de données simple qui</b> ne contient aucune logique ou qui agissent comme un raccourci.  Les composants sont divisés par objectif et déterminent toutes les propriétés des objets du jeu.  Vitesse, position, texture, corps, etc.  etc.  tout cela est décrit dans les composants puis ajouté aux objets du jeu. <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VelocityComponent</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Component { val velocity = Vector2</span></span></span></span>() }</code> </pre> </li><li>  <i>Entité</i> - objets de jeu: obstacles / boosters / héros contrôlés et même arrière-plan.  Ils n'ont pas de classes spécialisées par type: UltraMegaSuperman: GameUnit, mais <b>sont</b> simplement des <b>conteneurs</b> pour l'ensemble de composants.  Le fait qu'une certaine entité soit ainsi UltraMegaSuperman définit son ensemble de composants et leurs paramètres. <br>  Par exemple, dans notre cas, le personnage principal avait les composants suivants: <br><br><ul><li>  TextureComponent - définit ce qui doit être dessiné à l'écran </li><li>  TransformComponent - la position de l'objet dans l'espace de jeu </li><li>  VelocityComponent - vitesse de l'objet dans l'espace de jeu </li><li>  HeroControllerComponent - contient des valeurs qui affectent le mouvement du héros </li><li>  ImmortalityTimeComponent - contient le temps restant d'immortalité </li><li>  DynamicComponent - indique que l'objet n'est pas statique et est soumis à la gravité </li><li>  BodyComponent - définit le corps physique du héros 2D nécessaire pour calculer les collisions </li></ul></li><li>  <i>Système</i> - contient le code de traitement des données des composants de chaque entité.  Ils <b>ne</b> doivent <b>pas stocker d'objets Entité et / ou Composant</b> , car cela contredirait le modèle.  Idéalement, ils devraient être propres du tout. <br><br>  Les systèmes font tout le sale boulot: dessinez tous les objets du jeu, déplacez l'objet par sa vitesse, vérifiez les collisions, changez la vitesse à partir du contrôle entrant, etc.  Par exemple, l'effet de la gravité ressemble à ceci: <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processEntity</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(entity: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Entity</span></span></span></span><span class="hljs-function"><span class="hljs-params">, deltaTime: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Float</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { entity.getComponent(VelocityComponent::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">) .</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">velocity</span></span></span><span class="hljs-class"> .</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">add</span></span></span></span>(<span class="hljs-number"><span class="hljs-number">0f</span></span>, -GRAVITY * deltaTime) }</code> </pre> <br>  La spécialisation de chaque système détermine les exigences pour les entités qu'il doit traiter.  Autrement dit, dans l'exemple ci-dessus, l'entité doit avoir les composants de vitesse VelocityComponent et DynamicComponent pour que cette entité puisse être traitée, sinon cette entité n'est pas intéressante pour le système, et donc pour les autres.  Pour dessiner une texture, par exemple, vous devez savoir ce qu'est la texture TextureComponent et où dessiner le TransformComponent.  Pour déterminer les exigences de chaque système, la famille est écrite dans le constructeur dans lequel les classes de composants sont indiquées. <br><br><pre> <code class="kotlin hljs">Family.all(TransformComponent::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TextureComponent::class.java).get</span></span></span></span>()</code> </pre> <br>  De plus, l'ordre des entités de traitement dans le système peut être ajusté par un comparateur.  De plus, l'ordre d'exécution des systèmes dans le moteur est également régulé par la valeur de priorité. <br></li></ul><br>  Le moteur combine trois composants.  Il contient tous les systèmes et toutes les entités du jeu.  Au début du jeu, tous les systèmes nécessaires dans le jeu <br><br><pre> <code class="kotlin hljs">engine.apply { addSystem(ControlSystem()) addSystem(GravitySystem()) addSystem(renderingSystem) addSystem(MovementSystem()) addSystem(EnemyGeneratorSystem()) }</code> </pre>  ainsi que des entités de départ sont ajoutées au moteur, <br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> hero: Entity = engine.createEntity() engine.addEntity(hero)</code> </pre> <br>  <a href="https://libgdx.badlogicgames.com/ci/ashley/docs/com/badlogic/ashley/core/PooledEngine.html">PooledEngine :: createEntity</a> - récupère un objet entité du <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%258A%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BD%25D1%258B%25D0%25B9_%25D0%25BF%25D1%2583%25D0%25BB">pool</a> , puisque les entités peuvent être créées pendant le jeu, afin de ne pas salir la mémoire.  Si nécessaire, ils sont extraits du pool d'objets et lorsqu'ils sont supprimés, ils sont replacés.  De même pour les composants.  Lors de la réception de composants du pool, il est nécessaire d'initialiser tous les champs, car ils peuvent contenir des informations sur l'utilisation précédente de ce composant. <br><br>  La relation entre les principales parties du modèle est présentée ci-dessous: <br><br><img src="https://habrastorage.org/webt/gk/tj/ak/gktjakst_gxpnuikd_bbgpnfv2a.png"><br><br>  Le moteur contient une collection de systèmes et une collection d'entités.  Chaque système reçoit du moteur un lien vers une collection d'entités, qui est une sélection de la collection générale en fonction des exigences du système; il sera mis à jour pendant le jeu lorsque les entités et les composants changent.  Chaque entité contient une collection de ses composants qui la définissent dans le jeu. <br><br>  Le cycle de jeu est structuré comme suit: <br><br><ol><li>  En utilisant l'implémentation du modèle <a href="https://habr.com/ru/post/271315/">«Game Cycle»</a> de LibGDX, dans la méthode de mise à jour, nous obtenons son incrément à chaque pas de temps - deltaTime. </li><li>  Ensuite, nous passons le temps au moteur.  Et lui, à son tour, itère à travers le système dans un cycle, les distribue deltaTime. <pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> until systems.size()) { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> system = systems[i] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (system.checkProcessing()) { system.update(deltaTime) } }</code> </pre> </li><li>  Les systèmes recevant deltaTime trient leurs entités et leur appliquent des modifications en tenant compte de deltaTime. <pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> until entities.size()) { processEntity(entities[i], deltaTime) }</code> </pre> </li></ol><br>  Cela se produit à chaque mesure du jeu. <br><br><h2>  Avantages sociaux chez ECS </h2><br><ol><li>  <b>Les données viennent en premier</b> .  Étant donné que les systèmes ne traitent que les entités qui leur conviennent, en l'absence de telles entités, le système ne fera tout simplement rien, cela permet de tester et de déboguer de nouvelles fonctionnalités, en créant uniquement les entités nécessaires pour cela. <br><br>  Par exemple, vous avez créé le jeu "Tanks".  Après un certain temps, vous avez décidé d'ajouter un nouveau type de terrain - «lave».  Si le char essaie de le traverser, il échouera.  Mais la technologie futuriste vient à la rescousse, en installant que vous pouvez traverser la lave. <br><br>  Pour déboguer un tel cas, vous n'avez pas besoin de créer des modèles complets de réservoirs et de construire des cartes complètes avec des emplacements de lave supplémentaires - il suffit de penser aux composants minimum nécessaires sur le réservoir et d'ajouter une entité au moteur de jeu pour tester.  Tout cela semble évident, mais en fait, vous rencontrez la classe TheTank qui, dans le constructeur, demande une liste de paramètres: calibre, vitesse, sprite, vitesse de tir, noms d'équipage, etc.  bien que cela ne soit pas nécessaire pour tester les intersections de lave. <br></li><li>  En outre, en suivant l'exemple du paragraphe précédent, nous notons une <b>grande flexibilité</b> , car avec cette approche, il est beaucoup plus facile d'ajouter et de supprimer des fonctionnalités. <br><br>  Un vrai exemple.  Le scénario de jeu de notre deuxième promo était que l'utilisateur, après avoir exécuté la chanson pendant environ 2 minutes, s'est écrasé dans la ligne d'arrivée, et le jeu a recommencé le compte à rebours en redémarrant le niveau, mais avec des points de sauvegarde, donnant ainsi au joueur une pause. <br><br>  Quelques jours avant la sortie prévue vient la tâche "de supprimer la ligne d'arrivée et de faire un rapport pendant une demi-heure de jeu continu avec des obstacles et des chansons en boucle".  Un changement global, mais c'était très facile à faire - il suffisait de supprimer l'essence de la ligne d'arrivée et d'ajouter un système de référence pour la fin de la partie. </li><li>  Tous les développements sont <b>faciles à tester</b> .  Sachant que les données en premier lieu, vous pouvez simuler tous les cas de test, les exécuter et voir le résultat. </li><li>  À l'avenir, pour <b>valider l'état du jeu</b> , vous pouvez connecter un serveur au processus de jeu.  Il exécutera à travers le même code la même entrée client et comparera son résultat avec le résultat sur le client.  Si les données ne convergent pas, alors le client est un tricheur ou nous avons des erreurs dans le jeu. </li></ol><br><br><h2>  ECS dans le grand monde de gamedev </h2><br>  Les grandes entreprises comme Unity, Epic ou Crytek utilisent ce modèle dans leurs cadres pour fournir aux développeurs un outil avec une tonne de fonctionnalités.  Je vous conseille de voir le rapport sur la façon dont la <a href="https://www.youtube.com/watch%3Fv%3D2Hi3GeCBpd0">logique de gameplay a été</a> implémentée <a href="https://www.youtube.com/watch%3Fv%3D2Hi3GeCBpd0">dans Overwatch</a> <br><br>  Pour une meilleure compréhension, j'ai fait un petit <a href="https://github.com/AndrewMisterio/examples">exemple sur github</a> . <br>  Merci de votre attention! <br><br><h2>  Également sur le sujet: </h2><br><ul><li>  <a href="https://habr.com/ru/post/343778/">Implémentation et exemple du jeu</a> </li><li>  <a href="https://habr.com/ru/post/358108/">ECS et tout-tout</a> </li><li>  <a href="https://leopotam.com/2/">Bases ECS</a> </li><li>  <a href="https://fateev.pro/ru/gamedev/entity-component-system">Système de composants et d'entités</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr482374/">https://habr.com/ru/post/fr482374/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr482360/index.html">Détective Habra: ils sont amis avec les OVNIS</a></li>
<li><a href="../fr482364/index.html">Choses que vous [peut-être] ne saviez pas sur Java</a></li>
<li><a href="../fr482366/index.html">Ce que les experts en robotique pensent du pilote automatique Tesla</a></li>
<li><a href="../fr482370/index.html">nodejs: gestionnaires de processus et modules ES6</a></li>
<li><a href="../fr482372/index.html">Activer le mode de session amélioré pour les invités Arch Linux dans Hyper-V</a></li>
<li><a href="../fr482378/index.html">Une brève histoire de Wacom: comment la technologie des tablettes graphiques est arrivée aux lecteurs électroniques</a></li>
<li><a href="../fr482384/index.html">Mon projet non réalisé. Réseau de 200 routeurs MikroTik</a></li>
<li><a href="../fr482386/index.html">Visual Studio pour Mac: prenez le contrôle de votre IDE avec les raccourcis clavier</a></li>
<li><a href="../fr482390/index.html">Tutoriel du tutoriel Ember.js. Application Super Rentals. Partie 1.2</a></li>
<li><a href="../fr482392/index.html">Astuces ELF dans Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>