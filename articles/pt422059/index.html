<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§òüèº üåó üë©üèæ‚Äç‚úàÔ∏è Descarregue dados no Excel. Civilizado ü§ôüèº ü§û üë©üèΩ‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Existem tarefas na ind√∫stria de TI que, no contexto de sucessos em big data , aprendizado de m√°quina , blockchain e outras tend√™ncias da moda, parecem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Descarregue dados no Excel. Civilizado</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422059/"> Existem tarefas na ind√∫stria de TI que, no contexto de sucessos em <i>big data</i> , <i>aprendizado de m√°quina</i> , <i>blockchain</i> e outras tend√™ncias da moda, parecem completamente pouco atraentes, mas h√° d√©cadas n√£o deixam de ser relevantes para todo um ex√©rcito de desenvolvedores.  Ser√° sobre o antigo como a tarefa mundial de criar e enviar documentos do Excel, que enfrentou todos os que j√° escreveram aplicativos para neg√≥cios. <br><br><img src="https://habrastorage.org/webt/xt/rq/6o/xtrq6o6vsy-0gtbrnuudywnnohs.png"><br><br><a name="habracut"></a><br><br>  Que possibilidades de cria√ß√£o de arquivos do Excel existem em princ√≠pio? <br><br><ol><li>  Macros VBA.  Atualmente, por raz√µes de seguran√ßa, a id√©ia de usar macros geralmente n√£o √© adequada. </li><li>  Automa√ß√£o do Excel com um programa externo atrav√©s da API.  Requer o Excel na mesma m√°quina que o programa que gera relat√≥rios do Excel.  No momento em que os clientes eram espessos e gravados na forma de aplicativos de desktop para Windows, esse m√©todo era adequado (embora n√£o diferisse em velocidade e confiabilidade), nas realidades atuais esse dificilmente √© um caso poss√≠vel. </li><li>  Gere arquivo XML-Excel diretamente.  Como voc√™ sabe, o Excel oferece suporte ao formato XML para salvar um documento, que pode ser potencialmente gerado / modificado usando qualquer meio de trabalhar com XML.  Esse arquivo pode ser salvo com a extens√£o .xls e, embora estritamente n√£o seja um arquivo xls, o Excel o abre bem.  Essa abordagem √© bastante popular, mas as desvantagens incluem o fato de que qualquer solu√ß√£o baseada na edi√ß√£o direta do formato XML-Excel √© um "hack" √∫nico, desprovido de generalidade. </li><li>  Por fim, √© poss√≠vel gerar arquivos do Excel usando bibliotecas de c√≥digo aberto, das quais o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Apache POI</a> √© especialmente conhecido.  Os desenvolvedores do Apache POI fizeram um trabalho tit√¢nico nos formatos bin√°rios de documentos de engenharia reversa do MS Office e continuam a manter e desenvolver essa biblioteca ao longo dos anos.  O resultado dessa engenharia reversa, por exemplo, √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">usado</a> no Open Office para implementar a preserva√ß√£o de documentos em formatos compat√≠veis com o MS Office. </li></ol><br>  Na minha opini√£o, √© o √∫ltimo dos m√©todos que agora √© preferido para gerar documentos compat√≠veis com o MS Office.  Por um lado, n√£o requer a instala√ß√£o de nenhum software propriet√°rio no servidor e, por outro lado, fornece uma API rica que permite usar todas as funcionalidades do MS Office. <br><br>  Mas o uso direto do Apache POI tem suas desvantagens.  Primeiramente, esta √© uma biblioteca Java e, se seu aplicativo estiver gravado em mais de uma das linguagens da JVM, voc√™ dificilmente poder√° us√°-lo.  Em segundo lugar, √© uma biblioteca de baixo n√≠vel que trabalha com conceitos como "c√©lula", "coluna", "fonte".  Portanto, "de frente" o procedimento escrito para gerar um documento rapidamente se transforma em um "macarr√£o" abundante de c√≥digo dif√≠cil de ler, onde n√£o h√° separa√ß√£o em um modelo de dados e apresenta√ß√£o, √© dif√≠cil fazer altera√ß√µes e, em geral, dor e vergonha.  E uma excelente ocasi√£o para delegar a tarefa ao programador mais inexperiente - deixe-o escolher. <br><br>  Mas poderia ser completamente diferente.  O projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">xilofone</a> sob a LGPL, constru√≠do com base no Apache POI, √© baseado em uma id√©ia que tem uma hist√≥ria estimada em 15 anos.  Nos projetos em que participei, ele foi usado em combina√ß√£o com uma grande variedade de plataformas e idiomas - e, devido √† variedade de formul√°rios criados com sua ajuda em uma grande variedade de projetos, provavelmente j√° existem milhares.  Este √© um projeto Java que pode funcionar como um utilit√°rio de linha de comando e como uma biblioteca (se voc√™ tiver um c√≥digo na linguagem JVM, poder√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">conect√°-</a> lo como uma depend√™ncia do Maven). <br><br>  O xilofone implementa o princ√≠pio de separar o modelo de dados da sua apresenta√ß√£o.  No procedimento de upload, voc√™ precisa gerar dados no formato XML (sem se preocupar com c√©lulas, fontes e linhas divis√≥rias), e o Xilophone, usando um modelo do Excel e um descritor que descreve como rastrear seu arquivo XML com dados, gerar√° o resultado, conforme mostrado no diagrama: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cg/6i/3l/cg6i3loswycjyokw8_dujjzlb_m.png" width="400"></div><br>  O modelo de documento (modelo xls / xlsx) √© mais ou menos assim: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2d/kg/gr/2dkggrfyq2b8se-dtfrtx6lwcje.png"></div><br>  Como regra, a compra desse modelo √© fornecida pelo cliente.  O cliente envolvido est√° feliz em participar da cria√ß√£o do modelo: come√ßando por escolher o formul√°rio certo no "Consultor" ou inventando um a partir do zero e terminando com o tamanho da fonte e a largura das linhas divis√≥rias.  A vantagem do modelo √© que √© f√°cil fazer pequenas edi√ß√µes, mesmo quando o relat√≥rio est√° totalmente desenvolvido. <br><br>  Quando o trabalho de "design" √© conclu√≠do, o desenvolvedor permanece <br><br><ol><li>  Crie um procedimento para baixar os dados necess√°rios no formato XML. </li><li>  Crie um descritor que descreva o procedimento para atravessar elementos de um arquivo XML e copiar fragmentos de modelo no relat√≥rio resultante </li><li>  Vincule c√©lulas de modelo a elementos de um arquivo XML usando express√µes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">XPath</a> . </li></ol><br>  Com o upload para XML, tudo fica mais ou menos claro: basta selecionar a representa√ß√£o XML apropriada dos dados necess√°rios para preencher o formul√°rio.  O que √© um descritor? <br><br>  Se o formul√°rio que estamos criando n√£o tiver elementos duplicados com n√∫meros diferentes (como linhas de fatura, que s√£o diferentes em faturas diferentes), o descritor ter√° a seguinte apar√™ncia: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"root"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"A1:Z100"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Aqui raiz √© o nome do elemento raiz do nosso arquivo de dados XML e o intervalo A1: Z100 √© o intervalo retangular de c√©lulas do modelo que ser√° copiado para o resultado.  Al√©m disso, como pode ser visto na ilustra√ß√£o anterior, os campos curinga cujos valores s√£o substitu√≠dos pelos dados de um arquivo XML t√™m o formato <code>~{XPath-}</code> (til, colchete, express√£o XPath em rela√ß√£o ao elemento XML atual, fechando o colchete). <br><br>  E se precisarmos repetir elementos no relat√≥rio?  Naturalmente, eles podem ser representados como elementos de um arquivo de dados XML, e um descritor ajuda a ajud√°-lo da maneira certa.  A repeti√ß√£o de elementos no relat√≥rio pode ter uma dire√ß√£o vertical (quando inserimos linhas de fatura, por exemplo) e horizontal (quando inserimos colunas do relat√≥rio anal√≠tico).  Ao mesmo tempo, podemos usar o aninhamento de elementos XML para refletir o aninhamento arbitr√°rio e profundo de elementos de relat√≥rio repetidos, conforme mostrado no diagrama: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/up/tz/sf/uptzsfb1elgxvrd9od7ixm6v2uy.png" width="300"></div><br>  Os quadrados vermelhos marcam as c√©lulas que ser√£o o canto superior esquerdo do pr√≥ximo fragmento retangular que o gerador de relat√≥rios est√° encaixando. <br><br>  H√° outra op√ß√£o poss√≠vel para repetir elementos: folhas em uma pasta de trabalho do Excel.  A capacidade de organizar essa itera√ß√£o tamb√©m est√° dispon√≠vel. <br><br>  Considere um exemplo um pouco mais complexo.  Suponha que precisamos obter um relat√≥rio de resumo como o seguinte: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sh/hm/j5/shhmj5ii0ptbgqaplyyu6iigiak.png" width="400"></div><br>  Deixe o usu√°rio selecionar o intervalo de anos para descarregar, portanto, linhas e colunas s√£o criadas dinamicamente neste relat√≥rio.  A representa√ß√£o XML dos dados para esse relat√≥rio pode ter a seguinte apar√™ncia: <br><br><div class="spoiler">  <b class="spoiler_title">testdata.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">report</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">year</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2016"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">year</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2017"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">year</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2018"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" 1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"365"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"286"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"207"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" 2"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"95"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"606"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"840"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">" 3"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"710"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"437"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">totals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1170"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1329"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">year</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">amount</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1147"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">totals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">report</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Temos a liberdade de escolher os nomes das tags ao seu gosto, a estrutura tamb√©m pode ser arbitr√°ria, mas tendo em vista a facilidade de convers√£o no relat√≥rio.  Por exemplo, geralmente escrevo os valores exibidos na planilha em atributos, porque simplifica as express√µes XPath (√© conveniente quando elas se parecem com <code>@</code> ). <br><br>  O modelo para esse relat√≥rio ter√° a seguinte apar√™ncia (compare express√µes XPath com os nomes de atributo das tags correspondentes): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x1/h0/dy/x1h0dyu0c10ywyjxx8kwajxrsnu.png" width="300"></div><br>  Agora vem a parte mais interessante: criar um identificador.  Como este √© um relat√≥rio quase completamente montado dinamicamente, o descritor √© bastante complicado, na pr√°tica (quando s√≥ temos um "cabe√ßalho" do documento, suas linhas e "rodap√©") tudo geralmente √© muito mais simples.  Aqui est√° o descritor necess√°rio neste caso: <br><br><div class="spoiler">  <b class="spoiler_title">descriptor.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"report"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">worksheet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sourcesheet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(before)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"A1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"column"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"B1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  :     ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    -   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(before)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"A2"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"year"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"B2"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"totals"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">mode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"horizontal"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"(before)"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"A3"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"year"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">output</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">range</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"B3"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iteration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">element</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Os elementos completos do descritor s√£o descritos na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">documenta√ß√£o</a> .  Em resumo, os elementos b√°sicos de um descritor significam o seguinte: <br><br><ul><li>  <b>elemento</b> - transi√ß√£o para o modo de leitura de um elemento de um arquivo XML.  Pode ser o elemento raiz do descritor ou estar dentro da <code>iteration</code> .  O atributo <code>name</code> pode ser usado para definir v√°rios filtros para elementos, por exemplo <ul><li>  <code>name="foo"</code> - elementos com o nome de tag foo </li><li>  <code>name="*"</code> - todos os elementos </li><li>  <code>name="tagname[@attribute='value']"</code> - elementos com um nome e valor de atributo espec√≠ficos </li><li>  <code>name="(before)"</code> , <code>name="(after)"</code> - elementos "virtuais" que precedem a itera√ß√£o e fecham a itera√ß√£o. </li></ul></li><li>  <b>itera√ß√£o</b> - transi√ß√£o para o modo de itera√ß√£o.  S√≥ pode ser <code>element</code> interno.  V√°rios par√¢metros podem ser definidos, p. <ul><li>  <code>mode="horizontal"</code> - modo de sa√≠da <code>mode="horizontal"</code> (vertical por padr√£o) </li><li>  <code>index=0</code> - restringe a itera√ß√£o ao primeiro elemento encontrado </li></ul></li><li>  <b>sa√≠da</b> - alterna para o modo de sa√≠da.  Os principais atributos s√£o os seguintes: <ul><li>  <code>sourcesheet</code> - A planilha do livro de modelos da qual o intervalo de sa√≠da √© obtido.  Se n√£o especificado, a folha atual (√∫ltima usada) √© aplicada. </li><li>  <code>range</code> - o intervalo do modelo a ser copiado para o documento resultante, por exemplo, "A1: M10", "5: 6" ou "C: C".  (Usar intervalos de linhas do tipo ‚Äú5: 6‚Äù no modo de sa√≠da horizontal e intervalos de colunas do tipo ‚ÄúC: C‚Äù no modo de sa√≠da vertical causar√° um erro). </li><li>  <code>worksheet</code> - se definida, uma nova planilha √© criada no arquivo de sa√≠da e a posi√ß√£o de sa√≠da √© deslocada para a c√©lula A1 desta planilha.  O valor desse atributo, igual a uma constante ou express√£o XPath, √© substitu√≠do no nome da nova planilha. </li></ul></li></ul><br>  Na realidade, existem muito mais op√ß√µes no descritor, consulte a documenta√ß√£o. <br><br>  Bem, agora √© hora de baixar o Xilophone e come√ßar a relatar. <br>  Pegue o arquivo da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bandeja</a> ou do <a href="">Maven Central</a> (NB: no momento da leitura deste artigo, s√£o poss√≠veis vers√µes mais recentes).  Na pasta / bin, h√° um script de shell; quando voc√™ o executa sem par√¢metros, voc√™ ver√° um prompt sobre os par√¢metros da linha de comando.  Para obter o resultado, precisamos "alimentar" com o xilofone todos os ingredientes previamente preparados: <br><br><pre> <code class="bash hljs">xylophone -data testdata.xml -template template.xlsx -descr descriptor.xml -out report.xlsx</code> </pre><br>  Abra o arquivo report.xlsx e verifique se obtemos exatamente o que precisamos: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sh/hm/j5/shhmj5ii0ptbgqaplyyu6iigiak.png" width="400"></div><br>  Como a biblioteca ru.curs: xylophone <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">est√° dispon√≠vel</a> no Maven Central sob a licen√ßa LGPL, ela pode ser usada sem problemas em programas em qualquer idioma da JVM.  Talvez o exemplo mais compacto e completo de trabalho seja obtido no Groovy, o c√≥digo n√£o precisa de coment√°rios: <br><br><pre> <code class="plaintext hljs">@Grab('ru.curs:xylophone:6.1.3') import ru.curs.xylophone.XML2Spreadsheet baseDir = '.' new File(baseDir, 'testdata.xml').withInputStream { input -&gt; new File(baseDir, 'report.xlsx').withOutputStream { output -&gt; XML2Spreadsheet.process(input, new File(baseDir, 'descriptor.xml'), new File(baseDir, 'template.xlsx'), false, output) } } println 'Done.'</code> </pre><br>  A classe <code>XML2Spreadsheet</code> possui v√°rias vers√µes sobrecarregadas do m√©todo de <code>process</code> est√°tico, mas todas se resumem a transferir os mesmos "ingredientes" necess√°rios para a prepara√ß√£o do relat√≥rio. <br><br>  Uma op√ß√£o importante que ainda n√£o mencionei √© a capacidade de escolher entre analisadores DOM e SAX no est√°gio de analisar um arquivo com dados XML.  Como voc√™ sabe, o analisador DOM carrega o arquivo inteiro na mem√≥ria, constr√≥i sua representa√ß√£o de objeto e possibilita ignorar seu conte√∫do de maneira arbitr√°ria (incluindo retornar repetidamente ao mesmo elemento).  O analisador SAX nunca coloca o arquivo de dados inteiro na mem√≥ria, mas processa-o como um "fluxo" de elementos, impedindo que ele retorne ao elemento novamente. <br><br>  O uso do modo SAX no xilofone (por meio da <code>-sax</code> linha de comando <code>-sax</code> ou da configura√ß√£o do par√¢metro <code>useSax</code> m√©todo <code>useSax</code> como <code>XML2Spreadsheet.process</code> ) pode ser extremamente √∫til quando voc√™ precisar gerar arquivos muito grandes.  Devido √† velocidade e lucratividade dos recursos do analisador SAX, a velocidade de gera√ß√£o de arquivos aumenta muitas vezes.  Isso √© fornecido √† custa de algumas pequenas restri√ß√µes no descritor (descritas na documenta√ß√£o), mas na maioria dos casos os relat√≥rios atendem a essas restri√ß√µes, portanto, recomendo usar o modo SAX sempre que poss√≠vel. <br><br>  Espero que voc√™ tenha gostado do m√©todo de upload para o Excel via xilofone e economize muito tempo e nervosismo - como voc√™ nos salvou. <br><br>  E, finalmente, links novamente: <br><br><ul><li>  fontes est√£o aqui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github.com/CourseOrchestra/xylophone</a> </li><li>  a documenta√ß√£o est√° aqui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">courseorchestra.github.io/xylophone</a> </li><li>  todos os exemplos de c√≥digo deste artigo est√£o aqui: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github.com/inponomarev/xylophone-example</a> . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt422059/">https://habr.com/ru/post/pt422059/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt422047/index.html">O mist√©rio da charada na "Uni√£o"</a></li>
<li><a href="../pt422049/index.html">Tratamento de erros no Go 2</a></li>
<li><a href="../pt422051/index.html">Testando a cria√ß√£o de uma biblioteca de componentes para Angular usando o novo comando para Angular / Cli - library</a></li>
<li><a href="../pt422053/index.html">ESP8266 + FLProg - Criando uma interface de configura√ß√£o baseada na Web</a></li>
<li><a href="../pt422057/index.html">Pesquisa: Java √© a linguagem mais popular na nuvem - quem a usa e por que</a></li>
<li><a href="../pt422061/index.html">Servidor compacto com recarga de c√≥digo personalizada e logs sql por uma equipe preparada para desenvolvimento produtivo</a></li>
<li><a href="../pt422069/index.html">PHP Digest No. 138 (20 de agosto a 2 de setembro de 2018)</a></li>
<li><a href="../pt422071/index.html">O suficiente para todos, ou como fornecer a Internet aos pa√≠ses em desenvolvimento</a></li>
<li><a href="../pt422073/index.html">A maneira mais f√°cil de apoiar a integra√ß√£o de um cliente java com um servidor java</a></li>
<li><a href="../pt422077/index.html">A inje√ß√£o de JavaScript √© relevante?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>