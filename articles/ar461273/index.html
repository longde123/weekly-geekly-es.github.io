<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ค ๐๐ป ๐ฉ๐ผโ๐ญ ููุฌ ุงูุฌุดุน ููุชุญุงุช ุงูุขูุงุช. ุชุญููู ููุงู ML ุงููุณุงุฑ ูู ุจุทููุฉ ุงูุจุฑูุฌุฉ ๐คต๐พ โ๐ป โ๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุงุตู ูุดุฑ ุชุญูููุงุช ุงูููุงู ุงูุชู ุชู ุงูุชุฑุงุญูุง ูู ุงูุจุทููุฉ ุงูุฃุฎูุฑุฉ. ุงูุชุงูู ูู ุงูุณุทุฑ ูู ุงูููุงู ุงูุชู ุงุชุฎุฐุช ูู ุฌููุฉ ุงูุชุฃููู ูุฃุฎุตุงุฆูู ุงูุชุนูู ุงูุขูู. ูุฐุง ูู ุงููุณุง...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููุฌ ุงูุฌุดุน ููุชุญุงุช ุงูุขูุงุช. ุชุญููู ููุงู ML ุงููุณุงุฑ ูู ุจุทููุฉ ุงูุจุฑูุฌุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/461273/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/sd/i7/yd/sdi7ydyv5yabtpudjamnnmm2dge.jpeg"><br><br>  ููุงุตู ูุดุฑ ุชุญูููุงุช ุงูููุงู ุงูุชู ุชู ุงูุชุฑุงุญูุง ูู ุงูุจุทููุฉ ุงูุฃุฎูุฑุฉ.  ุงูุชุงูู ูู ุงูุณุทุฑ ูู ุงูููุงู ุงูุชู ุงุชุฎุฐุช ูู ุฌููุฉ ุงูุชุฃููู ูุฃุฎุตุงุฆูู ุงูุชุนูู ุงูุขูู.  ูุฐุง ูู ุงููุณุงุฑ ุงูุซุงูุซ ูู ุฃุฑุจุนุฉ (ุงูุฎูููุฉ ุ ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุ ML ุ ุงูุชุญูููุงุช).  ูุญุชุงุฌ ุงููุดุงุฑููู ุฅูู ุตูุน ูููุฐุฌ ูุชุตุญูุญ ุงูุฃุฎุทุงุก ุงููุทุจุนูุฉ ูู ุงููุตูุต ุ ูุงูุชุฑุงุญ ุงุณุชุฑุงุชูุฌูุฉ ููุนุจ ุนูู ูุงูููุงุช ุงูููุงุฑ ุ ููุถุน ูุธุงู ุชูุตูุงุช ูููุญุชูู ุ ูุฅูุดุงุก ุนุฏุฉ ุจุฑุงูุฌ ุฃุฎุฑู. <br><br><a name="habracut"></a><h2 style=";text-align:right;direction:rtl">  ุฃ. ุงูุฃุฎุทุงุก ุงููุทุจุนูุฉ </h2><br><h4 style=";text-align:right;direction:rtl">  ุญุงูุฉ </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td></td><td>  <b>ูู ุงููุบุงุช</b> </td><td>  <b>python2.7 + numpy</b> </td><td>  <b>python3.5 + numpy</b> </td></tr><tr><td>  ุงููููุฉ </td><td>  1 ุซุงููุฉ </td><td>  5 ู </td><td>  5 ู </td></tr><tr><td>  ุญุฏ ุงูุฐุงูุฑุฉ </td><td>  64 ููุบุงุจุงูุช </td><td>  256 ููุบุงุจุงูุช </td><td>  256 ููุบุงุจุงูุช </td></tr><tr><td>  ุฏุฎูู </td><td colspan="3">  ุงููุฏุฎูุงุช ุงูููุงุณูุฉ ุฃู ุงููุฏุฎูุงุช </td></tr><tr><td>  ุงุณุชูุชุงุฌ </td><td colspan="3">  ุงูุฅุฎุฑุงุฌ ุงูููุงุณู ุฃู ุงูุฅุฎุฑุงุฌ </td></tr></tbody></table></div>  (ุงููุชุงุจุฉ) (ูู ููุชุฏู ูุงุญุฏ) <br>  - ูู ูุชููู ูุฐุง ุงููุฑุงุกุ <br>  - ุนููุงุก ุงูููุฒูุงุก ุงูููููุฉ.  ูู ุงููุงุณ ุฃูุถุง. <br>  - ููุฏ ุงุฑุชูุจุช 10 ุฃุฎุทุงุก ูู ูููุฉ "ุงูุตุญูููู". <br><br>  ูุฑุชูุจ ุงูุนุฏูุฏ ูู ุงููุณุชุฎุฏููู ุฃุฎุทุงุก ูู ุงููุชุงุจุฉ ุ ุจุนุถูุง ุจุณุจุจ ุถุฑุจ ุงูููุงุชูุญ ุ ูุงูุจุนุถ ุงูุขุฎุฑ ุจุณุจุจ ุฃููุชูู.  ูุฑูุฏ ุงูุชุญูู ููุง ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูููู ุฃู ูุนูู ูู ุงููุงูุน ูููุฉ ุฃุฎุฑู ุบูุฑ ุงููููุฉ ุงูุชู ูุชุจูุง. <br><br>  ุจุดูู ุฃูุซุฑ ุฑุณููุฉ ุ ุงูุชุฑุถ ุฃู ูููุฐุฌ ุงูุฎุทุฃ ุงูุชุงูู ูุญุฏุซ: ูุจุฏุฃ ุงููุณุชุฎุฏู ุจูููุฉ ูุฑูุฏ ูุชุงุจุชูุง ุ ุซู ูููู ุจุนุฏ ุฐูู ุจุนุฏุฏ ูู ุงูุฃุฎุทุงุก ูููุง.  ูู ุฎุทุฃ ูู ุงุณุชุจุฏุงู ูุจุนุถ ุณูุณูุฉ ูุฑุนูุฉ ูู ุงููููุฉ ูุณูุณูุฉ ูุฑุนูุฉ ุฃุฎุฑู.  ุฎุทุฃ ูุงุญุฏ ูุชูุงูู ูุน ุงุณุชุจุฏุงู ููุท ูู ูููู ูุงุญุฏ (ุฃู ุฅุฐุง ูุงู ุงููุณุชุฎุฏู ูุฑูุฏ ุฃู ูุฑุชูุจ ุฎุทุฃ ูุงุญุฏ ูู ูุจู ุงููุงุนุฏุฉ "abc" โ "cba" ุ ุซู ูู ุณูุณูุฉ "abcabc" ููููู ุงูุญุตูู ุนูู "cbaabc" ุฃู "abccba").  ุจุนุฏ ูู ุฎุทุฃ ุ ุชุชูุฑุฑ ุงูุนูููุฉ.  ูููู ุงุณุชุฎุฏุงู ููุณ ุงููุงุนุฏุฉ ุนุฏุฉ ูุฑุงุช ูู ุฎุทูุงุช ูุฎุชููุฉ (ุนูู ุณุจูู ุงููุซุงู ุ ูู ุงููุซุงู ุฃุนูุงู ุ ูููู ุงูุญุตูู ุนูู "cbacba" ูู ุฎุทูุชูู). <br><br>  ูุฌุจ ุชุญุฏูุฏ ุงูุญุฏ ุงูุฃุฏูู ูุนุฏุฏ ุงูุฃุฎุทุงุก ุงูุชู ูููู ุฃู ูุฑุชูุจูุง ุงููุณุชุฎุฏู ุฅุฐุง ูุงู ูููุฑ ูู ูููุฉ ูุนููุฉ ููุชุจ ูููุฉ ุฃุฎุฑู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูุณููุงุช I / O ููุซุงู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><h4 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุฅุฏุฎุงู </h4><br>  ูุญุชูู ุงูุณุทุฑ ุงูุฃูู ุนูู ุงููููุฉ ุงูุชู ุ ุญุณุจ ุงูุชุฑุงุถูุง ุ ูุงู ุงููุณุชุฎุฏู ูู ุฐููู (ุชุชููู ูู ุฃุญุฑู ุงูุฃุจุฌุฏูุฉ ุงููุงุชูููุฉ ูู ุงูุฃุญุฑู ุงูุตุบูุฑุฉ ุ ูุง ูุชุฌุงูุฒ ุงูุทูู 20). <br><br>  ูุญุชูู ุงูุณุทุฑ ุงูุซุงูู ุนูู ุงููููุฉ ุงูุชู ูุชุจูุง ุจุงููุนู (ููู ุชุชุฃูู ุฃูุถูุง ูู ุฃุญุฑู ุงูุฃุจุฌุฏูุฉ ุงููุงุชูููุฉ ูู ุงูุฃุญุฑู ุงูุตุบูุฑุฉ ุ ูุง ูุชุฌุงูุฒ ุงูุทูู 20). <br><br>  ูุญุชูู ุงูุณุทุฑ ุงูุซุงูุซ ุนูู ุฑูู ูุงุญุฏ N (N &lt;50) - ูู ุนุฏุฏ ุงูุจุฏุงุฆู ุงูุชู ุชุตู ุงูุฃุฎุทุงุก ุงููุฎุชููุฉ. <br><br>  ุชุญุชูู ุงูุฃุณุทุฑ N ุงูุชุงููุฉ ุนูู ุจุฏุงุฆู ูุญุชููุฉ ูู ุชูุณูู &amp; lt "ุงูุญุฑูู" ุงูุชุณูุณู &amp; gt &lt;space&gt; &lt;ุชุณูุณู ุงูุญุฑูู "ุงูุฎุงุทุฆุฉ"&gt;.  ุงูุชุณูุณูุงุช ูุง ูุฒูุฏ ุทูููุง ุนู 6 ุฃุญุฑู. <br><br><h4 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุฅุฎุฑุงุฌ </h4><br>  ูุฌุจ ุทุจุงุนุฉ ุฑูู ูุงุญุฏ - ููู ุงูุญุฏ ุงูุฃุฏูู ูุนุฏุฏ ุงูุฃุฎุทุงุก ุงูุชู ูุฏ ูุฑุชูุจูุง ุงููุณุชุฎุฏู.  ุฅุฐุง ุชุฌุงูุฒ ูุฐุง ุงูุฑูู 4 ุฃู ูุงู ูู ุงููุณุชุญูู ุงูุญุตูู ุนูู ุขุฎุฑ ูู ูููุฉ ูุงุญุฏุฉ ุ ููู ุจุทุจุงุนุฉ -1. <br><br><h4 style=";text-align:right;direction:rtl">  ูุซุงู </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <b>ุฏุฎูู</b> </td><td>  <b>ุงุณุชูุชุงุฌ</b> </td></tr><tr><td><code>mlax <br> drum <br> 50 <br> lr <br> mlax gtwt <br> md <br> mlax ujoc <br> ml pq <br> mf <br> ml bf <br> mlax aruq <br> mlax nqdd <br> mlax fglm <br> mlax bfit <br> mlax mziq <br> mla hlb <br> au <br> mlax vmpa <br> mw <br> aw <br> ax ok <br> mla kqf <br> me <br> xx <br> ml if <br> ml gk <br> le <br> mla xrh <br> mj <br> ac <br> ab <br> mq <br> ax fr <br> ml sb <br> mlax gxxx <br> xm <br> mlax hczx <br> lq <br> la sv <br> lg <br> ax eh <br> lax mjh <br> la ec <br> la pv <br> ml iq <br> aq <br> lax jrs <br> la qn <br> lax bjo <br> lo <br> az <br> ln <br> ac</code> </td> <td> <code>4</code> </td> </tr></tbody></table></div></div></div><br><h4 style=";text-align:right;direction:rtl">  ูุฑุงุฑ </h4><br>  ุฏุนูุง ูุญุงูู ุฅูุดุงุก ูู ุงููููุงุช ุงูููููุฉ ูู ุงูุฅููุงุก ุงูุตุญูุญ ุฏูู ุฃูุซุฑ ูู 4 ุฃุฎุทุงุก.  ูู ุฃุณูุฃ ุงูุญุงูุงุช ุ ูุฏ ูููู ููุงู O ((L๏นN) <sup>4</sup> ).  ูู ุญุฏูุฏ ุงููุดููุฉ ุ ูุฐุง ุนุฏุฏ ูุจูุฑ ุฅูู ุญุฏ ูุง ุ ูุฐูู ุชุญุชุงุฌ ุฅูู ูุนุฑูุฉ ููููุฉ ุงูุญุฏ ูู ุงูุชุนููุฏ.  ุจุฏูุงู ูู ุฐูู ุ ููููู ุงุณุชุฎุฏุงู ุฎูุงุฑุฒููุฉ ุงูุงูุชูุงุก ูู ุงููุณุท: ุฅูุดุงุก ูููุงุช ูุง ุชุฒูุฏ ุนู 2 ุฃุฎุทุงุก ุ ููุฐูู ุงููููุงุช ุงูุชู ููููู ูู ุฎูุงููุง ุงูุญุตูู ุนูู ูููุฉ ููุชูุจุฉ ุจูุงุณุทุฉ ุงููุณุชุฎุฏู ูุน ุนุฏู ูุฌูุฏ ุฃูุซุฑ ูู ุฎุทุฃูู.  ูุงุญุธ ุฃู ุญุฌู ูู ูุฌููุนุฉ ูู ูุฐู ุงููุฌููุนุงุช ูู ูุชุฌุงูุฒ 10 <sup>6</sup> .  ุฅุฐุง ูู ูุชุฌุงูุฒ ุนุฏุฏ ุงูุฃุฎุทุงุก ุงูุชู ุงุฑุชูุจูุง ุงููุณุชุฎุฏู 4 ุ ูุณูู ุชุชูุงุทุน ูุฐู ุงููุฌููุนุงุช.  ูุจุงููุซู ุ ูููููุง ุงูุชุญูู ูู ุฃู ุนุฏุฏ ุงูุฃุฎุทุงุก ูุง ูุชุฌุงูุฒ 3 ู 2 ู 1. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FromTo</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> from; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> to; }; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::pair&lt;<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; applyRule(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&amp; word, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FromTo &amp;fromTo, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pos) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> from = word.find(fromTo.from, pos); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (from == <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>::npos) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>::npos, {}}; } <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> to = from + fromTo.from.size(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> cpy = word; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = from; i &lt; to; i++) { cpy[i] = fromTo.to[i - from]; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {from, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(cpy)}; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inverseRules</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;FromTo&gt; &amp;rules)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; rule: rules) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::swap(rule.from, rule.to); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">solve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&amp; wordOrig, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">&amp; wordMissprinted, </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">std</span></span></span></span><span class="hljs-function"><span class="hljs-params">::</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">vector</span></span></span></span><span class="hljs-function"><span class="hljs-params">&lt;FromTo&gt;&amp; replaces)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_map</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; mapping; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_map</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>&gt; mappingInverse; mapping.emplace(wordOrig, <span class="hljs-number"><span class="hljs-number">0</span></span>); mappingInverse.emplace(<span class="hljs-number"><span class="hljs-number">0</span></span>, wordOrig); mapping.emplace(wordMissprinted, <span class="hljs-number"><span class="hljs-number">1</span></span>); mappingInverse.emplace(<span class="hljs-number"><span class="hljs-number">1</span></span>, wordMissprinted); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_map</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_set</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;&gt; edges; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> buildGraph = [&amp;edges, &amp;mapping, &amp;mappingInverse](<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> startId, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;FromTo&gt;&amp; replaces, <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> dir) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_set</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; mappingLayer0; mappingLayer0 = {startId}; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; i++) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unordered_set</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; mappingLayer1; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; v: mappingLayer0) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; word = mappingInverse.at(v); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; fromTo: replaces) { <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> from = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> [tmp, wordCpy] = applyRule(word, fromTo, from); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tmp == <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>::npos) { <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } from = tmp + <span class="hljs-number"><span class="hljs-number">1</span></span>; { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> w = mapping.size(); mapping.emplace(wordCpy, w); w = mapping.at(wordCpy); mappingInverse.emplace(w, <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(wordCpy)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (dir) { edges[v].emplace(w); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { edges[w].emplace(v); } mappingLayer1.emplace(w); } } } } mappingLayer0 = <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::move(mappingLayer1); } }; buildGraph(<span class="hljs-number"><span class="hljs-number">0</span></span>, replaces, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); inverseRules(replaces); buildGraph(<span class="hljs-number"><span class="hljs-number">1</span></span>, replaces, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">queue</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::pair&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;&gt; q; q.emplace(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">bool</span></span>&gt; mask(mapping.size(), <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> level{<span class="hljs-number"><span class="hljs-number">0</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (q.size()) { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> [w, level] = q.front(); q.pop(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mask[w]) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } mask[w] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mappingInverse.at(w) == wordMissprinted) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> level; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; v: edges[w]) { q.emplace(v, level + <span class="hljs-number"><span class="hljs-number">1</span></span>); } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">-1</span></span>; }</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  B. ุงูุนุตุงุจุงุช ุงููุณูุญุฉ </h2><br><h4 style=";text-align:right;direction:rtl">  ุญุงูุฉ </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  ุงููููุฉ </td><td>  2 ุซุงููุฉ </td></tr><tr><td>  ุญุฏ ุงูุฐุงูุฑุฉ </td><td>  64 ููุบุงุจุงูุช </td></tr><tr><td>  ุฏุฎูู </td><td>  ุงููุฏุฎูุงุช ุงูููุงุณูุฉ </td></tr><tr><td>  ุงุณุชูุชุงุฌ </td><td>  ุงูุฅุฎุฑุงุฌ ุงูููุงุณู </td></tr></tbody></table></div>  ูุฐู ูููุฉ ุชูุงุนููุฉ. <br><br>  ุฃูุช ููุณู ูุง ุชุนุฑู ููู ุญุฏุซ ุฐูู ุ ููููู ูุฌุฏุช ููุณู ูู ูุงุนุฉ ุจูุง ุขูุงุช ุงูููุงุฑ ูุน ุญููุจุฉ ูุงููุฉ ูู ุงูุฑููุฒ.  ููุฃุณู ุ ูู ุดุจุงู ุงูุชุฐุงูุฑ ุ ูุฑูุถูู ูุจูู ุงูุฑููุฒ ุงููููุฒุฉ ุ ููุฑุฑุช ุชุฌุฑุจุฉ ุญุธู.  ููุงู ุงูุนุฏูุฏ ูู ูุงูููุงุช ุงูููุงุฑ ูู ุงููุงุนุฉ ุงูุชู ููููู ูุนุจูุง.  ูุนุจุฉ ูุงุญุฏุฉ ูุน ูุชุญุฉ ุขูุฉ ุชุณุชุฎุฏู ุฑูุฒ ูุงุญุฏ.  ูู ุญุงูุฉ ุงูููุฒ ุ ูููุญู ุงูุฌูุงุฒ ุฏููุงุฑูุง ูุงุญุฏูุง ุ ูู ุญุงูุฉ ุงูุฎุณุงุฑุฉ - ูุง ุดูุก.  ูู ุฌูุงุฒ ูุฏูู ุงุญุชูุงููุฉ ุซุงุจุชุฉ ููููุฒ (ูุง ุชุนุฑูู) ุ ูููู ูุฎุชูู ุนู ุงูุฃุฌูุฒุฉ ุงููุฎุชููุฉ.  ุจุนุฏ ุฏุฑุงุณุฉ ูููุน ุงูุดุฑูุฉ ุงููุตูุนุฉ ููุฐู ุงูุขูุงุช ุ ุงูุชุดูุช ุฃู ุงุญุชูุงู ุงูููุฒ ููู ุฌูุงุฒ ูุชู ุงุฎุชูุงุฑู ุนุดูุงุฆููุง ูู ูุฑุญูุฉ ุงูุชุตููุน ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุฒูุน ุจูุชุง</a> ูุน ุจุนุถ ุงููุนููุงุช. <br><br>  ุชุฑูุฏ ุฒูุงุฏุฉ ุฃุฑุจุงุญู ุงููุชููุนุฉ ุฅูู ุงูุญุฏ ุงูุฃูุตู. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูุณููุงุช I / O ููุซุงู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><h4 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุฅุฏุฎุงู </h4><br>  ูุฏ ูุชููู ุชูููุฐ ูุงุญุฏ ูู ุนุฏุฉ ุงุฎุชุจุงุฑุงุช. <br><br>  ูุจุฏุฃ ูู ุงุฎุชุจุงุฑ ุจุญูููุฉ ุฃู ุงูุจุฑูุงูุฌ ุนูู ุงูุฎุท ูุญุชูู ุนูู ุนุฏุฏูู ุตุญูุญูู ููุตูููู ุจูุณุงูุฉ: ุงูุฑูู N ูู ุนุฏุฏ ุงูุฑููุฒ ูู ุญููุจุชู ุ ู M ูู ุนุฏุฏ ุงูุขูุงุช ูู ุงููุงุนุฉ (N โค 10 <sup>4</sup> ุ M โค min (N ุ 100) ).  ูุญุชูู ุงูุณุทุฑ ุงูุชุงูู ุนูู ุฑูููู ุญูููููู ฮฑ ู ฮฒ (1 โค ฮฑ ู ฮฒ โค 10) - ูุนููุงุช ุงูุชูุฒูุน ุงูุชุฌุฑูุจู ูุงุญุชูุงู ุงูููุฒ. <br><br>  ุจุฑูุชูููู ุงูุงุชุตุงู ูุน ูุธุงู ุงูุชุญูู ูู ูุฐุง: ููููู ุชูุฏูู ุทูุจุงุช N ุจุงูุถุจุท.  ููู ุทูุจ ุ ุงุทุจุน ูู ุณุทุฑ ูููุตู ุฑูู ุงูุฌูุงุฒ ุงูุฐู ุณุชูุนุจู (ูู 1 ุฅูู M ุถููุงู).  ูุฅุฌุงุจุฉ ุ ูู ุณุทุฑ ูููุตู ุณูููู ููุงู ุฅูุง "0" ุฃู "1" ุ ููุฐุง ูุนูู ุนูู ุงูุชูุงูู ุฎุณุงุฑุฉ ูููุฒ ูู ูุนุจุฉ ูุน ุขูุฉ ุงูููุงุฑ ุงููุทููุจุฉ. <br><br>  ุจุนุฏ ุงูุงุฎุชุจุงุฑ ุงูุฃุฎูุฑ ุ ุจุฏูุงู ูู ุงูุฃุฑูุงู N ู M ุ ุณูููู ููุงู ุตูุฑูู. <br><br><h4 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุฅุฎุฑุงุฌ </h4><br>  ุณูุชู ุงุนุชุจุงุฑ ุงููููุฉ ููุชููุฉ ุฅุฐุง ูู ููู ูุฑุงุฑู ุฃุณูุฃ ูู ูุฑุงุฑ ูุฌูุฉ ุงูุชุญููู.  ุฅุฐุง ูุงู ูุฑุงุฑู ุฃุณูุฃ ุจูุซูุฑ ูู ูุฑุงุฑ ููุฆุฉ ุงููุญูููู ุ ูุณุชุชููู ุงูุญูู "ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ". <br><br>  ูู ุงููุถููู ุฃูู ุฅุฐุง ูุงู ูุฑุงุฑู ููุณ ุฃุณูุฃ ูู ูุฑุงุฑ ููุฆุฉ ุงููุญูููู ุ ูุฅู ุงุญุชูุงู ุชููู ุงูุญูู "ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ" ูุง ูุชุฌุงูุฒ <sup>10-6</sup> . <br><br><h4 style=";text-align:right;direction:rtl">  ุงูููุงุญุธุงุช </h4><br>  ูุซุงู ุงูุชูุงุนู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs">____________________  <span class="hljs-built_in"><span class="hljs-built_in">stdin</span></span>     <span class="hljs-built_in"><span class="hljs-built_in">stdout</span></span> ____________________ ____________________   <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>   <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>              <span class="hljs-number"><span class="hljs-number">2</span></span>    <span class="hljs-number"><span class="hljs-number">1</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>    <span class="hljs-number"><span class="hljs-number">0</span></span>              <span class="hljs-number"><span class="hljs-number">1</span></span>    <span class="hljs-number"><span class="hljs-number">1</span></span>              <span class="hljs-number"><span class="hljs-number">2</span></span>    <span class="hljs-number"><span class="hljs-number">1</span></span>              <span class="hljs-number"><span class="hljs-number">2</span></span>    <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> </div></div><br><h4 style=";text-align:right;direction:rtl">  ูุฑุงุฑ </h4><br>  ูุฐู ุงููุดููุฉ ูุนุฑููุฉ ุฌูุฏูุง ุ ููููู ุญููุง ุจุทุฑู ูุฎุชููุฉ.  ุทุจู ุงููุฑุงุฑ ุงูุฑุฆูุณู ูููุฆุฉ ุงููุญูููู ุงุณุชุฑุงุชูุฌูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุฎุฐ ุนููุงุช Thompson</a> ุ ูููู ูุธุฑูุง ูุฃู ุนุฏุฏ ุงูุฎุทูุงุช ูุงู ูุนุฑูููุง ูู ุจุฏุงูุฉ ุงูุจุฑูุงูุฌ ุ ูููุงู ุงุณุชุฑุงุชูุฌูุงุช ุฃูุซุฑ ูุซุงููุฉ (ุนูู ุณุจูู ุงููุซุงู ุ UCB1).  ุนูุงูุฉ ุนูู ุฐูู ุ ูููู ูููุฑุก ุญุชู ุงูุญุตูู ุนูู ูุน ุงุณุชุฑุงุชูุฌูุฉ ุงูุฌุดุน epsilon: ูุน ูุฌูุฏ ุงุญุชูุงู ูุนูู ุ ุชูุนุจ ุขูุฉ ุนุดูุงุฆูุฉ ููุน ุงูุงุญุชูุงู (1 - ฮต) ุชูุนุจ ุขูุฉ ูุน ุฃูุถู ุฅุญุตุงุฆูุงุช ุงููุตุฑ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SolverFromStdIn</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.regrets = [<span class="hljs-number"><span class="hljs-number">0.</span></span>] self.total_win = [<span class="hljs-number"><span class="hljs-number">0.</span></span>] self.moves = [] <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ThompsonSampling</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(SolverFromStdIn)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, bandits_total, init_a=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">, init_b=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" init_a (int): initial value of a in Beta(a, b). init_b (int): initial value of b in Beta(a, b). """</span></span> SolverFromStdIn.__init__(self) self.n = bandits_total self.alpha = init_a self.beta = init_b self._as = [init_a] * self.n <span class="hljs-comment"><span class="hljs-comment"># [random.betavariate(self.alpha, self.beta) for _ in range(self.n)] self._bs = [init_b] * self.n # [random.betavariate(self.alpha, self.beta) for _ in range(self.n)] self.last_move = -1 random.seed(int(time.time())) def move(self): samples = [random.betavariate(self._as[x], self._bs[x]) for x in range(self.n)] self.last_move = max(range(self.n), key=lambda x: samples[x]) self.moves.append(self.last_move) return self.last_move def set_reward(self, reward): i = self.last_move r = reward self._as[i] += r self._bs[i] += (1 - r) return i, r while True: n, m = map(int, sys.stdin.readline().split()) if n == 0 and m == 0: break alpha, beta = map(float, sys.stdin.readline().split()) solver = ThompsonSampling(m) for _ in range(n): print &gt;&gt; sys.stdout, solver.move() + 1 sys.stdout.flush() reward = int(sys.stdin.readline()) solver.set_reward(reward)</span></span></code> </pre> <br><h2 style=";text-align:right;direction:rtl">  C. ูุญุงุฐุงุฉ ุงูุฌูู </h2><br><h4 style=";text-align:right;direction:rtl">  ุญุงูุฉ </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  ุงููููุฉ </td><td>  2 ุซุงููุฉ </td></tr><tr><td>  ุญุฏ ุงูุฐุงูุฑุฉ </td><td>  64 ููุบุงุจุงูุช </td></tr><tr><td>  ุฏุฎูู </td><td>  ุงููุฏุฎูุงุช ุงูููุงุณูุฉ ุฃู ุงููุฏุฎูุงุช </td></tr><tr><td>  ุงุณุชูุชุงุฌ </td><td>  ุงูุฅุฎุฑุงุฌ ุงูููุงุณู ุฃู ุงูุฅุฎุฑุงุฌ </td></tr></tbody></table></div>  ูุงุญุฏุฉ ูู ุฃูู ุงูููุงู ูุชุฏุฑูุจ ูููุฐุฌ ุงูุชุฑุฌูุฉ ุงูุขููุฉ ุงูุฌูุฏุฉ ูู ุญุงูุฉ ุฌูุฏุฉ ูู ุงูุฌูู ุงููุชูุงุฒูุฉ.  ุนุงุฏุฉู ูุง ูููู ูุตุฏุฑ ุงูุนุฑูุถ ุงููุชูุงุฒูุฉ ูุณุชูุฏุงุช ููุงุฒูุฉ.  ุงุชุถุญ ุฃูู ูู ูุซูุฑ ูู ุงูุฃุญูุงู ูุจูุงุก ูุฌููุนุฉ ูุนููุฉ ูู ุงูุฌูู ุงููุชูุงุฒูุฉ ุ ูุง ุชุญุชุงุฌ ุฅูู ูุนุฑูุฉ ุฃู ุดูุก ุณูู ุฃุทูุงููุง.  ุนูู ูุฌู ุงูุฎุตูุต ุ ูุฏ ุชูุงุญุธ ุฃูู ูููุง ุทุงูุช ูุฏุฉ ุงูุฌููุฉ ูู ูุบุฉ ุงููุตุฏุฑ ุ ูููุง ุชูุช ุชุฑุฌูุชูุง ุนูู ุงูุฃุฑุฌุญ.  ุชููู ุจุนุถ ุงูุตุนูุจุงุช ูู ุญูููุฉ ุฃูู ุฃุซูุงุก ุงูุชุฑุฌูุฉ ูููู ุฃู ูุชุบูุฑ ุนุฏุฏ ุงูุฌูู ูู ุงููุต: ูู ุจุนุถ ุงูุฃุญูุงู ูููู ุฏูุฌ ุฌููุชูู ูุชุฌุงูุฑุชูู ูู ุงูุชุฑุฌูุฉ ูู ุฌููุฉ ูุงุญุฏุฉ ุ ุฃู ุงูุนูุณ - ูููู ุชูุณูู ุฌููุฉ ูุงุญุฏุฉ ุฅูู ุฌููุชูู.  ูู ุจุนุถ ุงูุญุงูุงุช ุงููุงุฏุฑุฉ ุ ูุฏ ูุชู ุญุฐู ุงูุฌูู ุจุงููุงูู ูู ุงูุชุฑุฌูุฉ ุ ุฃู ูุฏ ุชุธูุฑ ุงูุชุฑุฌูุฉ ูู ุงูุชุฑุฌูุฉ ุงูุชู ูู ุชูู ุจุงูุฃุตู. <br><br>  ุจุดูู ุฃูุซุฑ ุฑุณููุฉ ุ ุงูุชุฑุถ ุฃู ุงููููุฐุฌ ุงูุชููููู ุงูุชุงูู ูููุฑููุงุช ุงูููุงุฒูุฉ ุตุญูุญ.  ูู ูู ุฎุทูุฉ ุ ูููู ุจุฃุญุฏ ุงูุฅุฌุฑุงุกุงุช ุงูุชุงููุฉ: <br><br>  <b>1. <i>ุชููู</i></b> <br><br>  ูุน ุงูุงุญุชูุงู p <sub>h ุ</sub> ููุชูู ุชูููุฏ ุงูุฃุฌุณุงู. <br><br>  <b>2. [1-0] <i>ุชุฎุทู ุงูุนุฑูุถ</i></b> <br><br>  ูุน ุงูุงุญุชูุงู p <sub>d</sub> ูุณูุฏ ุฌููุฉ ูุงุญุฏุฉ ุฅูู ุงููุต ุงูุฃุตูู.  ูุญู ูุง ููุณุจ ุฃู ุดูุก ููุชุฑุฌูุฉ.  ูุชู ุชุญุฏูุฏ ุทูู ุงูุฌููุฉ ุจุงููุบุฉ ุงูุฃุตููุฉ L โฅ 1 ูู ุงูุชูุฒูุน ุงููููุตู: <br><br><img src="https://habrastorage.org/webt/bm/pe/t_/bmpet_y_ksvwgbohazpgctekbks.png" width="350">  . <br><br>  ูููุง ููู ูุนููุงุช ุงูุชูุฒูุน ุ ู <i>ฮฑ <sub>s</sub></i> ูู ูุนุงูู ุงูุชุทุจูุน ุงููุฎุชุงุฑ ุจุญูุซ <img src="https://habrastorage.org/webt/fm/ae/ns/fmaensnvy1nauvywiluibhryr6s.png" width="100">  . <br><br>  <b>3. [0-1] <i>ุฃุฏุฎู ุงูุงูุชุฑุงุญ</i></b> <br><br>  ูุน ุงูุงุญุชูุงู p <sub>i</sub> ูุฎุตุต ุฌููุฉ ูุงุญุฏุฉ ููุชุฑุฌูุฉ.  ูุญู ูุง ููุณุจ ุฃู ุดูุก ุฅูู ุงูุฃุตู.  ูุชู ุชุญุฏูุฏ ุทูู ุงูุฌููุฉ ูู ูุบุฉ ุงูุชุฑุฌูุฉ L โฅ 1 ูู ุชูุฒูุน ูููุตู: <br><br><img src="https://habrastorage.org/webt/yl/yn/kr/ylynkr3cs_t7dpedebtzqj3uryk.png" width="350">  . <br><br>  ููุงุ <i><sub>t</sub></i> ุ <i>ฯ <sub>t</sub></i> ูู ูุนููุงุช ุงูุชูุฒูุน ุ ู <i>ฮฑ <sub>t</sub></i> ูู ูุนุงูู ุงูุชุทุจูุน ุงููุฎุชุงุฑ ุจุญูุซ <img src="https://habrastorage.org/webt/bq/-k/p3/bq-kp37k-c-k5fpq9jrz4r8rkvy.png" width="100">  . <br><br>  <b>4. <i>ุงูุชุฑุฌูุฉ</i></b> <br><br>  ูุน ุงูุงุญุชูุงู (1 - p <sub>d</sub> - p <sub>i</sub> - p <sub>h</sub> ) ูุฃุฎุฐ ุทูู ุงูุฌููุฉ ุจุงููุบุฉ ุงูุฃุตููุฉ L <sub>s</sub> โฅ 1 ูู ุงูุชูุฒูุน p <sub>s</sub> (ูุน ุงูุชูุฑูุจ ูุฃุนูู).  ุจุนุฏ ุฐูู ุ ูููู ุจุฅูุดุงุก ุทูู ุงูุฌููุฉ ูู ูุบุฉ ุงูุชุฑุฌูุฉ L <sub>t</sub> โฅ 1 ูู ุงูุชูุฒูุน ุงููููุตู ุงูุดุฑุทู: <br><br><img src="https://habrastorage.org/webt/ae/b6/mx/aeb6mx4cols1jplbs-di9emhxf8.png" width="500">  . <br><br>  ููุง <i>ฮฑ <sub>st</sub></i> ูู ูุนุงูู ุงูุชุทุจูุน ุ ููุชู ูุตู ุงููุนููุงุช ุงููุชุจููุฉ ูู ุงูููุฑุงุช ุงูุณุงุจูุฉ. <br><br>  ุงูุชุงูู ูู ุฎุทูุฉ ุฃุฎุฑู: <br><br>  1. [2-1] ูุน ุงูุงุญุชูุงู p <sub>split s ุ ุชููุณู</sub> ุงูุฌููุฉ ุงููููุฏุฉ ูู ุงููุบุฉ ุงูุฃุตููุฉ ุฅูู ูููุชูู ุบูุฑ ูุงุฑุบุชูู ุ ุจุญูุซ ูุฒูุฏ ุงูุนุฏุฏ ุงูุฅุฌูุงูู ูููููุงุช <b><i>ุจูุงุญุฏุฉ</i></b> .  ุงุญุชูุงู ุฃู ุชููุตู ุฌููุฉ ุงูุทูู L <sub>s</sub> ุฅูู ุฃุฌุฒุงุก ูู ุงูุทูู L <sub>1</sub> ู L <sub>2</sub> (ุฃู L <sub>1</sub> + L <sub>2</sub> = L <sub>s</sub> + 1) ุชุชูุงุณุจ ูุน P <sub>s</sub> (L <sub>1</sub> ) โ P <sub>s</sub> (L <sub>2</sub> ). <br><br>  2. [1-2] ูุน ูุฌูุฏ ุงูุงุญุชูุงู p <sub>split t ุ ุชููุณู</sub> ุงูุฌููุฉ ุงูุชู ุชู ุฅูุดุงุคูุง ูู ุงููุบุฉ ุงููุฏู ุฅูู ุฌููุชูู ุบูุฑ ูุงุฑุบุชูู ุ ุจุญูุซ ูุฒูุฏ ุงูุนุฏุฏ ุงูุฅุฌูุงูู ูููููุงุช ุจุญุฑู ูุงุญุฏ.  ุงุญุชูุงู ุฃู ุชููุตู ุฌููุฉ ุงูุทูู L <sub>t</sub> ุฅูู ุฃุฌุฒุงุก ูู ุงูุทูู L1 ู L2 (ุฃู L <sub>1</sub> + L <sub>2</sub> = L <sub>t</sub> + 1) ุชุชูุงุณุจ ูุน P <sub>t</sub> (L <sub>1</sub> ) โ P <sub>t</sub> (L <sub>2</sub> ). <br><br>  3. 3. [1-1] ูุน ุงุญุชูุงู (1 - p <sub>split s</sub> - p <sub>split t</sub> ) ุ ูู ูุชุญูู ุฃู ูู ุงูุฌูู ุงููุชููุฏุฉ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">I / O ุงูุชูุณููุงุช ูุงูุฃูุซูุฉ ูุงูููุงุญุธุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><h4 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุฅุฏุฎุงู </h4><br>  ูุญุชูู ุงูุณุทุฑ ุงูุฃูู ูู ุงูููู ุนูู ูุนููุงุช ุงูุชูุฒูุน: p <sub>h</sub> ุ p <sub>d</sub> ุ p <sub>i</sub> ุ p <sub>split s</sub> ุ p <sub>split t</sub> ุุ <sub>s</sub> ุ ฯ <sub>s</sub> ุ ฮผ <sub>t</sub> ุ ฯ <sub>t</sub> .  0.1 โค ฯ <sub>s</sub> &lt;ฯ <sub>t</sub> โค 3. 0 โค ฮผ <sub>s</sub> ุ ฮผ <sub>t</sub> โค 5. <br><br>  ูุญุชูู ุงูุณุทุฑ ุงูุชุงูู ุนูู ุงูุฃุฑูุงู N <sub>s</sub> ู N <sub>t</sub> - ุนุฏุฏ ุงูุฌูู ูู ุงูุญุงูุฉ ุจุงููุบุฉ ุงูุฃุตููุฉ ูุจุงููุบุฉ ุงููุฏู ุ ุนูู ุงูุชูุงูู (1 โค N <sub>s</sub> ู N <sub>t</sub> โค 1000). <br><br>  ูุญุชูู ุงูุณุทุฑ ุงูุชุงูู ุนูู ุฃุนุฏุงุฏ ุตุญูุญุฉ N - ุฃุทูุงู ุงูุฌูู ูู ุงููุบุฉ ุงูุฃุตููุฉ.  ูุญุชูู ุงูุณุทุฑ ุงูุชุงูู ุนูู ุฃุนุฏุงุฏ ุตุญูุญุฉ N <sub>t</sub> - ุฃุทูุงู ุงูุฌูู ูู ุงููุบุฉ ุงููุฏู. <br><br>  ูุญุชูู ุงูุณุทุฑ ุงูุชุงูู ุนูู ุฑูููู: j ู k (1 โค j โค N <sub>s</sub> ุ 1 โค k โค N <sub>t</sub> ). <br><br><h4 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุฅุฎุฑุงุฌ </h4><br>  ูู ุงูุถุฑูุฑู ุงุดุชูุงู ุงุญุชูุงู ุฃู ุชููู ุงูุฌูู ุฐุงุช ุงูููุงุฑุณ j ู k ูู ุงููุตูุต ุ ุนูู ุงูุชูุงูู ุ ูุชูุงุฒูุฉ (ุฃู ุ ูุชู ุฅูุดุงุคูุง ูู ุฎุทูุฉ ูุงุญุฏุฉ ูู ุงูุฎูุงุฑุฒููุฉ ูููุณ ุฃู ูููุง ูุงุชุฌ ุนู ุงูุงูุญูุงู). <br><br>  ุณูุชู ูุจูู ุฅุฌุงุจุชู ุฅุฐุง ูุงู ุงูุฎุทุฃ ุงููุทูู ูุง ูุชุฌุงูุฒ <sup>10-4</sup> . <br><br><h4 style=";text-align:right;direction:rtl">  ูุซุงู 1 </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <b>ุฏุฎูู</b> </td><td>  <b>ุงุณุชูุชุงุฌ</b> </td></tr><tr><td> <code>0.05 0.08 0.07 0.15 0.1 1 0.3 3 0.5 <br> 1 1 <br> 4 <br> 20 <br> 1 1</code> </td> <td> <code>0.975037457809</code> </td> </tr></tbody></table></div><h4 style=";text-align:right;direction:rtl">  ูุซุงู 2 </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <b>ุฏุฎูู</b> </td><td>  <b>ุงุณุชูุชุงุฌ</b> </td></tr><tr><td> <code>0.1 0.2 0.3 0.25 0.3 1 0.3 3 0.5 <br> 2 1 <br> 3 4 <br> 20 <br> 2 1</code> </td> <td> <code>0.247705779810</code> </td> </tr></tbody></table></div><h4 style=";text-align:right;direction:rtl">  ูุซุงู 3 </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <b>ุฏุฎูู</b> </td><td>  <b>ุงุณุชูุชุงุฌ</b> </td></tr><tr><td> <code>0.2 0.2 0.2 0.3 0.3 3 0.3 1 1 <br> 5 3 <br> 16 35 24 19 23 <br> 5 6 7 <br> 2 1</code> </td> <td> <code>0.200961101684</code> </td> </tr></tbody></table></div><h4 style=";text-align:right;direction:rtl">  ุงูููุงุญุธุงุช </h4><br>  ูู ุงููุซุงู ุงูุฃูู ุ ูููู ุงูุญุตูู ุนูู ุงูุชุณูุณู ุงูุฃููู ููุฃุฑูุงู ุจุซูุงุซ ุทุฑู: <br><br>  โข ุฃููุงู ุ ูุน ุงูุงุญุชูุงู p <sub>d</sub> ุฃุถู ุฌููุฉ ูุงุญุฏุฉ ุฅูู ุงููุต ุงูุฃุตูู ุ ุซู ูุน ุงูุงุญุชูุงู p <sub>i</sub> ุฃุถู ุฌููุฉ ูุงุญุฏุฉ ุฅูู ุงูุชุฑุฌูุฉ ุ ุซู ูุน ุงูุงุญุชูุงู p <sub>h</sub> ุฃููู ุงูุชูููุฏ. <br><br>  ุงุญุชูุงู ูุฐุง ุงูุญุฏุซ ูู P <sub>1</sub> = p <sub>d</sub> * P <sub>s</sub> (4) * p <sub>i</sub> * P <sub>t</sub> (20) * p <sub>h</sub> . <br><br>  โข ุฃููุงู ุ ูุน ุงูุงุญุชูุงู p <sub>d</sub> ุฃุถู ุฌููุฉ ูุงุญุฏุฉ ุฅูู ุงููุต ุงูุฃุตูู ุ ุซู ูุน ุงูุงุญุชูุงู p <sub>i</sub> ุฃุถู ุฌููุฉ ูุงุญุฏุฉ ุฅูู ุงูุชุฑุฌูุฉ ุ ุซู ูุน ุงูุงุญุชูุงู p <sub>h</sub> ุฃููู ุงูุชูููุฏ. <br><br>  ุงุญุชูุงู ูุฐุง ุงูุญุฏุซ ูุณุงูู P <sub>2</sub> = p <sub>i</sub> * P <sub>t</sub> (20) * p <sub>d</sub> * P <sub>s</sub> (4) * p <sub>h</sub> . <br><br>  โข ูุน ุงูุงุญุชูุงู (1 - p <sub>h</sub> - p <sub>d</sub> - p <sub>i</sub> ) ูู ุจุฅูุดุงุก ุฌููุชูู ุ ุซู ูุน ุงูุงุญุชูุงู (1 - p <sub>split s</sub> - p <sub>split t</sub> ) ุงุชุฑู ูู ุดูุก ููุง ูู (ุฃู ุ ูุง ุชูุณู ุงูุฃุตู ุฃู ุงูุชุฑุฌูุฉ ุฅูู ุฌููุชูู ) ูุจุนุฏ ุฐูู ูุน ุงูุงุญุชูุงู p <sub>h</sub> ูููู ุงูุฌูู. <br><br>  ุงุญุชูุงู ูุฐุง ุงูุญุฏุซ ูู <br><img src="https://habrastorage.org/webt/xw/ka/ys/xwkayskmtg4g3tkt9pb3n-ieyoa.png" width="550">  . <br><br>  ูุชูุฌุฉ ูุฐูู ุ ูุชู ุญุณุงุจ ุงูุฅุฌุงุจุฉ ูู <img src="https://habrastorage.org/webt/zm/tw/xk/zmtwxkdjhhctfrcbiqsc0tur6g0.png" width="100">  . </div></div><br><h4 style=";text-align:right;direction:rtl">  ูุฑุงุฑ </h4><br>  ุงููููุฉ ูู ุญุงูุฉ ุฎุงุตุฉ ูู ุงููุญุงุฐุงุฉ ุจุงุณุชุฎุฏุงู ููุงุฐุฌ Markov ุงููุฎููุฉ (ูุญุงุฐุงุฉ HMM).  ุงูููุฑุฉ ุงูุฑุฆูุณูุฉ ูู ุฃูู ููููู ุญุณุงุจ ุงุญุชูุงู ุฅูุดุงุก ุฒูุฌ ูุนูู ูู ุงููุณุชูุฏุงุช ุจุงุณุชุฎุฏุงู ูุฐุง ุงููููุฐุฌ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฎูุงุฑุฒููุฉ ุฅุนุงุฏุฉ ุงูุชูุฌูู</a> : ูู ูุฐู ุงูุญุงูุฉ ุ ุชููู ุงูุญุงูุฉ ุนุจุงุฑุฉ ุนู ุจุงุฏุฆุงุช ูู ุงููุณุชูุฏุงุช.  ููููุง ูุฐูู ุ ูููู ุญุณุงุจ ุงูุงุญุชูุงู ุงููุทููุจ ููุญุงุฐุงุฉ ุฒูุฌ ูุนูู ูู ุงูุฌูู ุงููุชูุงุฒูุฉ ุจูุงุณุทุฉ ุฎูุงุฑุฒููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุฃูุงู ูุงูุฎูู</a> . <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุงููู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; #include &lt;iomanip&gt; #include &lt;cmath&gt; #include &lt;vector&gt; double p_h, p_d, p_i, p_tr, p_ss, p_st, mu_s, sigma_s, mu_t, sigma_t; double lognorm_cdf(double x, double mu, double sigma) { if (x &lt; 1e-9) return 0.0; double res = std::log(x) - mu; res /= std::sqrt(2.0) * sigma; res = 0.5 * (1 + std::erf(res)); return res; } double length_probability(int l, double mu, double sigma) { return lognorm_cdf(l, mu, sigma) - lognorm_cdf(l - 1, mu, sigma); } double translation_probability(int ls, int lt) { double res = length_probability(ls, mu_s, sigma_s); double mu = mu_t - mu_s + std::log(ls); double sigma = std::sqrt(sigma_t * sigma_t - sigma_s * sigma_s); res *= length_probability(lt, mu, sigma); return res; } double split_probability(int l1, int l2, double mu, double sigma) { int l_sum = l1 + l2; double total_prob = 0.0; for (int i = 1; i &lt; l_sum; ++i) { total_prob += length_probability(i, mu, sigma) * length_probability(l_sum - i, mu, sigma); } return length_probability(l1, mu, sigma) * length_probability(l2, mu, sigma) / total_prob; } double log_prob10(int ls) { return std::log(p_d * length_probability(ls, mu_s, sigma_s)); } double log_prob01(int lt) { return std::log(p_i * length_probability(lt, mu_t, sigma_t)); } double log_prob11(int ls, int lt) { return std::log(p_tr * (1 - p_ss - p_st) * translation_probability(ls, lt)); } double log_prob21(int ls1, int ls2, int lt) { return std::log(p_tr * p_ss * split_probability(ls1, ls2, mu_s, sigma_s) * translation_probability(ls1 + ls2 - 1, lt)); } double log_prob12(int ls, int lt1, int lt2) { return std::log(p_tr * p_st * split_probability(lt1, lt2, mu_t, sigma_t) * translation_probability(ls, lt1 + lt2 - 1)); } double logsum(double v1, double v2) { double res = std::max(v1, v2); v1 -= res; v2 -= res; v1 = std::min(v1, v2); if (v1 &lt; -30) { return res; } return res + std::log(std::exp(v1) + 1.0); } double loginc(double* to, double from) { *to = logsum(*to, from); } constexpr double INF = 1e25; int main(void) { using std::cin; using std::cout; cin &gt;&gt; p_h &gt;&gt; p_d &gt;&gt; p_i &gt;&gt; p_ss &gt;&gt; p_st &gt;&gt; mu_s &gt;&gt; sigma_s &gt;&gt; mu_t &gt;&gt; sigma_t; p_tr = 1.0 - p_h - p_d - p_i; int Ns, Nt; cin &gt;&gt; Ns &gt;&gt; Nt; using std::vector; vector&lt;int&gt; ls(Ns), lt(Nt); for (int i = 0; i &lt; Ns; ++i) cin &gt;&gt; ls[i]; for (int i = 0; i &lt; Nt; ++i) cin &gt;&gt; lt[i]; vector&lt; vector&lt; double&gt; &gt; fwd(Ns + 1, vector&lt;double&gt;(Nt + 1, -INF)), bwd = fwd; fwd[0][0] = 0; bwd[Ns][Nt] = 0; for (int i = 0; i &lt;= Ns; ++i) { for (int j = 0; j &lt;= Nt; ++j) { if (i &gt;= 1) { loginc(&amp;fwd[i][j], fwd[i - 1][j] + log_prob10(ls[i - 1])); loginc(&amp;bwd[Ns - i][Nt - j], bwd[Ns - i + 1][Nt - j] + log_prob10(ls[Ns - i])); } if (j &gt;= 1) { loginc(&amp;fwd[i][j], fwd[i][j - 1] + log_prob01(lt[j - 1])); loginc(&amp;bwd[Ns - i][Nt - j], bwd[Ns - i][Nt - j + 1] + log_prob01(lt[Nt - j])); } if (i &gt;= 1 &amp;&amp; j &gt;= 1) { loginc(&amp;fwd[i][j], fwd[i - 1][j - 1] + log_prob11(ls[i - 1], lt[j - 1])); loginc(&amp;bwd[Ns - i][Nt - j], bwd[Ns - i + 1][Nt - j + 1] + log_prob11(ls[Ns - i], lt[Nt - j])); } if (i &gt;= 2 &amp;&amp; j &gt;= 1) { loginc(&amp;fwd[i][j], fwd[i - 2][j - 1] + log_prob21(ls[i - 1], ls[i - 2], lt[j - 1])); loginc(&amp;bwd[Ns - i][Nt - j], bwd[Ns - i + 2][Nt - j + 1] + log_prob21(ls[Ns - i], ls[Ns - i + 1], lt[Nt - j])); } if (i &gt;= 1 &amp;&amp; j &gt;= 2) { loginc(&amp;fwd[i][j], fwd[i - 1][j - 2] + log_prob12(ls[i - 1], lt[j - 1], lt[j - 2])); loginc(&amp;bwd[Ns - i][Nt - j], bwd[Ns - i + 1][Nt - j + 2] + log_prob12(ls[Ns - i], lt[Nt - j], lt[Nt - j + 1])); } } } int j, k; cin &gt;&gt; j &gt;&gt; k; double rlog = fwd[j - 1][k - 1] + bwd[j][k] + log_prob11(ls[j - 1], lt[k - 1]) - bwd[0][0]; cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(12) &lt;&lt; std::exp(rlog) &lt;&lt; std::endl; }</span></span></span></span></code> </pre> </div></div><br><h2 style=";text-align:right;direction:rtl">  ุงูุดุฑูุท ูู ุงูุชูุตูุงุช </h2><br><h4 style=";text-align:right;direction:rtl">  ุญุงูุฉ </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  ุงููููุฉ </td><td>  2 ุซุงููุฉ </td></tr><tr><td>  ุญุฏ ุงูุฐุงูุฑุฉ </td><td>  64 ููุบุงุจุงูุช </td></tr><tr><td>  ุฏุฎูู </td><td>  ุงููุฏุฎูุงุช ุงูููุงุณูุฉ ุฃู ุงููุฏุฎูุงุช </td></tr><tr><td>  ุงุณุชูุชุงุฌ </td><td>  ุงูุฅุฎุฑุงุฌ ุงูููุงุณู ุฃู ุงูุฅุฎุฑุงุฌ </td></tr></tbody></table></div>  ุงููุธุฑ ูู ููุฌุฒ ููุชูุตูุงุช ููุญุชูู ุบูุฑ ูุชุฌุงูุณุฉ.  ููุฒุฌ ุงููุงุฆูุงุช ูู ุฃููุงุน ูุฎุชููุฉ (ุงูุตูุฑ ูููุงุทุน ุงูููุฏูู ูุงูุฃุฎุจุงุฑ ููุง ุฅูู ุฐูู).  ุนุงุฏุฉู ูุง ูุชู ุชุฑุชูุจ ูุฐู ุงููุงุฆูุงุช ุญุณุจ ุตูุชูุง ุจุงููุณุชุฎุฏู: ูููุง ูุงู ุงููุงุฆู (ุงููุณุชุฎุฏู) ุงูุฃูุซุฑ ุตูุฉ ุจุงูููุถูุน ุ ูููุง ุงูุชุฑุจูุง ูู ุฃุนูู ูุงุฆูุฉ ุงูุชูุตูุงุช.  ููุน ุฐูู ุ ูุน ูุซู ูุฐุง ุงูุชุฑุชูุจ ุ ุชูุดุฃ ููุงูู ุบุงูุจูุง ุชุธูุฑ ูููุง ุนุฏุฉ ูุงุฆูุงุช ูู ููุณ ุงูููุน ูู ูุงุฆูุฉ ุงูุชูุตูุงุช.  ูุคุฏู ูุฐุง ุฅูู ุชูุงูู ุงูุชููุน ุงูุฎุงุฑุฌู ูุชูุตูุงุชูุง ุฅูู ุญุฏ ูุจูุฑ ูุจุงูุชุงูู ูุง ูุญุจ ุงููุณุชุฎุฏููู ุฐูู.  ูู ุงูุถุฑูุฑู ุชูููุฐ ุฎูุงุฑุฒููุฉ ุ ููููุง ููุงุฆูุฉ ุงูุชูุตูุงุช ุ ุณุชุดูู ูุงุฆูุฉ ุฌุฏูุฏุฉ ุณุชููู ุฎุงููุฉ ูู ูุฐู ุงููุดููุฉ ูุณุชููู ุฐุงุช ุตูุฉ. <br><br>  ุงุณูุญ ุจูุงุฆูุฉ ุฃูููุฉ ูู ุงูุชูุตูุงุช: = [a <sub>0</sub> ุ a <sub>1</sub> ุ ...ุ <sub>n - 1</sub> ] ูู ุงูุทูู n&gt; 0. ูุงุฆู ุจุฑูู <sub>i</sub> ูุชุจุชู ุจุงูุฑูู b <sub>i</sub> 0 {0ุ ...ุ m - 1}.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ููุฌุฏ ูุงุฆู ุชุญุช ุงูุฑูู i ุฐู ุตูุฉ r (a <sub>i</sub> ) = 2 <sub>โi</sub> .  ุงููุธุฑ ูู ุงููุงุฆูุฉ ุงูุชู ุชู ุงูุญุตูู ุนูููุง ูู ุงููุงุฆูุฉ ุงูุฃูููุฉ ุนู ุทุฑูู ุงุฎุชูุงุฑ ูุฌููุนุฉ ูุฑุนูุฉ ูู ุงููุงุฆูุงุช ูุงูุชูููุจ: x = [a <sub>i <sub>0</sub></sub> ุ <sub>i i <sub>1</sub></sub> ุ ...ุ <sub>i <sub>k - 1</sub></sub> ] ูู ุงูุทูู k (0 โค k โค n).  ุชูุฏุนู ูุงุฆูุฉ ููุจููุฉ ุฅุฐุง ูู ูุชุฒุงูู ูุฌูุฏ ูุงุฆููู ูุชุชุงูููู ูู ุงูููุน ุ ุฃู ุ b <sub>i <sub>j</sub></sub> โ b <sub>i <sub>j + 1</sub></sub> ููุฌููุน j = 0 ุ ... ุ k - 2.  ูุชู ุงุญุชุณุงุจ ุฃูููุฉ ุงููุงุฆูุฉ ูู ุฎูุงู ุงูุตูุบุฉ <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msubsup><msub><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#x2212;</mo><mi>j</mi></mrow></msub><mi>r</mi><mo stretchy=&quot;false&quot;>(</mo><msub><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><msub><mi>i</mi><mi>j</mi></msub></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.112ex" height="3.503ex" viewBox="0 -987.6 7367.6 1508.3" role="img" focusable="false" style="vertical-align: -1.209ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,403)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMAIN-2212" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMAIN-31" x="1300" y="0"></use></g><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMATHI-6A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMAIN-3D" x="412" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMAIN-30" x="1191" y="0"></use></g></g><g transform="translate(3543,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMAIN-2212" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMATHI-6A" x="778" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMATHI-72" x="4986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMAIN-28" x="5437" y="0"></use><g transform="translate(5827,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMATHI-61" x="0" y="0"></use><g transform="translate(529,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMATHI-6A" x="488" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=https://habr.com/ru/company/yandex/blog/461273/&amp;usg=ALkJrhjDtsBiwHp0muew7_BXTZADrlF_Ag#MJMAIN-29" x="6978" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>j</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo>โ</mo><mn>1</mn></mrow></msubsup><msub><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mo>โ</mo><mi>j</mi></mrow></msub><mi>r</mi><mo stretchy="false">(</mo><msub><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><msub><mi>i</mi><mi>j</mi></msub></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ sum_ {j = 0} ^ {k-1} 2 _ {- j} r (a_ {i_j}) </script>  .  ุชุญุชุงุฌ ุฅูู ุงูุนุซูุฑ ุนูู ูุงุฆูุฉ ุงูุตูุฉ ุงููุตูู ุจูู ุฌููุน ุตุงูุญุฉ. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">I / O ุงูุชูุณููุงุช ูุงูุฃูุซูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><h4 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุฅุฏุฎุงู </h4><br>  ูู ุงูุณุทุฑ ุงูุฃูู ุ ุชุชู ูุชุงุจุฉ ุงูุฃุฑูุงู n ู m ุจูุณุงูุฉ (1 โค n โค 100000 ุ 1 โค m โค n).  ุชุญุชูู ุงูุฃุณุทุฑ n ุงูุชุงููุฉ ุนูู ุงูุฃุฑูุงู b <sub>i</sub> ูู i = 0 ุ ... ุ n - 1 (0 โค b <sub>i</sub> โค m - 1). <br><br><h4 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุฅุฎุฑุงุฌ </h4><br>  ุงูุชุจ ุ ุจูุณุงูุฉ ุ ุนุฏุฏ ุงููุงุฆูุงุช ูู ุงููุงุฆูุฉ ุงูููุงุฆูุฉ: i <sub>0</sub> ุ i <sub>1</sub> ุ ... ุ i <sub>k - 1</sub> . <br><br><h4 style=";text-align:right;direction:rtl">  ูุซุงู 1 </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <b>ุฏุฎูู</b> </td><td>  <b>ุงุณุชูุชุงุฌ</b> </td></tr><tr><td> <code>1 1 <br> 0</code> </td> <td> <code>0</code> </td> </tr></tbody></table></div><h4 style=";text-align:right;direction:rtl">  ูุซุงู 2 </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <b>ุฏุฎูู</b> </td><td>  <b>ุงุณุชูุชุงุฌ</b> </td></tr><tr><td> <code>2 2 <br> 1 <br> 1</code> </td> <td> <code>0</code> </td> </tr></tbody></table></div><h4 style=";text-align:right;direction:rtl">  ูุซุงู 3 </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <b>ุฏุฎูู</b> </td><td>  <b>ุงุณุชูุชุงุฌ</b> </td></tr><tr><td> <code>10 2 <br> 1 <br> 1 <br> 1 <br> 0 <br> 0 <br> 1 <br> 0 <br> 1 <br> 1 <br> 1</code> </td> <td> <code>0 3 1 4 2 6 5</code> </td> </tr></tbody></table></div></div></div><br><h4 style=";text-align:right;direction:rtl">  ูุฑุงุฑ </h4><br>  ุจุงุณุชุฎุฏุงู ุญุณุงุจุงุช ุฑูุงุถูุฉ ุจุณูุทุฉ ุ ูููู ุฅุซุจุงุช ุฃู ุงููุดููุฉ ูููู ุญููุง ูู ุฎูุงู ููุฌ "ุฌุดุน" ุ ุฃู ูู ุงููุงุฆูุฉ ุงููุซูู ููุชูุตูุงุช ุ ูู ุนูุตุฑ ูุฏูู ุงููุงุฆู ุงูุฃูุซุฑ ุตูุฉ ุจูู ูุง ูู ุตุงูุญ ูู ุจุฏุงูุฉ ููุณ ุงููุงุฆูุฉ.  ุชูููุฐ ูุฐุง ุงูููุฌ ุจุณูุท: ูุฃุฎุฐ ุงูุฃุดูุงุก ุนูู ุงูุชูุงูู ููุถูููุง ุฅูู ุงูุฅุฌุงุจุฉ ุ ุฅู ุฃููู.  ุนูุฏูุง ุชุชู ูุตุงุฏูุฉ ูุงุฆู ุบูุฑ ุตุงูุญ (ูุชุฒุงูู ููุนู ูุน ููุน ุงูุนูุตุฑ ุงูุณุงุจู) ุ ูุฅููุง ูุถุนู ุฌุงูุจุงู ูู ูุงุฆูุฉ ุงูุชุธุงุฑ ูููุตูุฉ ุ ูููู ุจุฅุฏุฎุงูู ูู ุงูุงุณุชุฌุงุจุฉ ูู ุฃูุฑุจ ููุช ูููู.  ูุงุญุธ ุฃูู ูู ูู ูุญุธุฉ ูู ุงูุฒูู ุ ุณูููู ููู ุงููุงุฆูุงุช ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ููุน ูุทุงุจู.  ูู ุงูููุงูุฉ ุ ูุฏ ุชุจูู ุนุฏุฉ ูุงุฆูุงุช ูู ูุงุฆูุฉ ุงูุงูุชุธุงุฑ ุ ููู ูุชู ุชุถููููุง ูู ุงูุงุณุชุฌุงุจุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cpp hljs"> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; blend(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> m, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;&amp; types) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; result; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">queue</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; repeated; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; n; ++i) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (result.empty() || types[result.back()] != types[i]) { result.push_back(i); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!repeated.empty() &amp;&amp; types[repeated.front()] != types[result.back()]) { result.push_back(repeated.front()); repeated.pop(); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { repeated.push(i); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre> <br><h2 style=";text-align:right;direction:rtl">  D. ุชุฌููุน ุชุณูุณู ุงูุฃุญุฑู </h2><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td></td><td>  <b>ูู ุงููุบุงุช</b> </td><td>  <b>python2.7 + numpy</b> </td><td>  <b>python3.5 + numpy</b> </td></tr><tr><td>  ุงููููุฉ </td><td>  1 ุซุงููุฉ </td><td>  6 ู </td><td>  6 ู </td></tr><tr><td>  ุญุฏ ุงูุฐุงูุฑุฉ </td><td>  64 ููุบุงุจุงูุช </td><td>  64 ููุบุงุจุงูุช </td><td>  64 ููุบุงุจุงูุช </td></tr><tr><td>  ุฏุฎูู </td><td colspan="3">  ุงููุฏุฎูุงุช ุงูููุงุณูุฉ ุฃู ุงููุฏุฎูุงุช </td></tr><tr><td>  ุงุณุชูุชุงุฌ </td><td colspan="3">  ุงูุฅุฎุฑุงุฌ ุงูููุงุณู ุฃู ุงูุฅุฎุฑุงุฌ </td></tr></tbody></table></div>  ููุงู ุฃุจุฌุฏูุฉ ูุญุฏุฏุฉ A = {a <sub>1</sub> ุ a <sub>2</sub> ุ ...ุ <sub>K - 1</sub> ุ a <sub>K</sub> = S}ุ a โ {aุ bุ ...ุ z}ุ S ูู ููุงูุฉ ุงูุณุทุฑ. <br><br>  ุงููุธุฑ ูู ุงูุทุฑููุฉ ุงูุชุงููุฉ ูุฅูุดุงุก ุณูุงุณู ุนุดูุงุฆูุฉ ุนูู ุงูุฃุจุฌุฏูุฉ A: <br><br>  1. ุงูุญุฑู ุงูุฃูู x <sub>1</sub> ูู ูุชุบูุฑ ุนุดูุงุฆู ูุน ุงูุชูุฒูุน P (x <sub>1</sub> = a <sub>i</sub> ) = q <sub>i</sub> (ูู ุงููุนุฑูู ุฃู q <sub>K</sub> = 0). <br>  2. ูุชู ุฅูุดุงุก ูู ุญุฑู ุชุงูู ุจูุงุกู ุนูู ุงูุญุฑู ุงูุณุงุจู ููููุง ููุชูุฒูุน ุงูุดุฑุทู P (x <sub>i</sub> = a <sub>j</sub> || x <sub>i - 1</sub> = a <sub>l</sub> ) = p <sub>jl</sub> . <br>  3. ุฅุฐุง ูุงูุช x <sub>i</sub> = S ุ ูุชููู ุงูุฌูู ูุชููู ุงููุชูุฌุฉ x <sub>1</sub> ร <sub>2</sub> ... x <sub>i - 1</sub> . <br><br>  ูุชู ุชูููุฑ ูุฌููุนุฉ ูู ุงูุฎุทูุท ุงููุงุชุฌุฉ ูู ูุฒูุฌ ูู ูููุฐุฌูู ุงูููุตููุฉ ูุน ูุนููุงุช ูุฎุชููุฉ.  ูู ุงูุถุฑูุฑู ุฃู ูุนุทู ูู ุตู ููุฑุณ ุงูุณูุณูุฉ ุงูุชู ุชู ุฅูุดุงุคู ูููุง. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุชูุณููุงุช I / O ุ ูุซุงู ุ ูููุงุญุธุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><h4 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุฅุฏุฎุงู </h4><br>  ูุญุชูู ุงูุณุทุฑ ุงูุฃูู ุนูู ุฑูููู 1000 โค N โค 2000 ู 3 โค K โค 27 - ุนุฏุฏ ุงูุฎุทูุท ูุญุฌู ุงูุฃุจุฌุฏูุฉ ุ ุนูู ุงูุชูุงูู. <br><br>  ูุญุชูู ุงูุณุทุฑ ุงูุซุงูู ุนูู ุณุทุฑ ูุชููู ูู K - 1 ุจุฃุญุฑู ุตุบูุฑุฉ ูุฎุชููุฉ ูู ุงูุฃุจุฌุฏูุฉ ุงููุงุชูููุฉ ุ ูุดูุฑ ุฅูู ุงูุนูุงุตุฑ K - 1 ุงูุฃููู ูู ุงูุฃุจุฌุฏูุฉ. <br><br>  ูุชู ุฅูุดุงุก ูู ุณุทุฑ ูู ุงูุฃุณุทุฑ N ุงูุชุงููุฉ ููููุง ููุฎูุงุฑุฒููุฉ ุงูููุถุญุฉ ูู ุงูุดุฑุท. <br><br><h4 style=";text-align:right;direction:rtl">  ุชูุณูู ุงูุฅุฎุฑุงุฌ </h4><br>  ุฃุณุทุฑ N ุ ูุญุชูู ุงูุณุทุฑ i ุนูู ุฑูู ุงููุชูุฉ (0/1) ููุชุณูุณู ุนูู ุงูุณุทุฑ i + 1-th ูููู ุงูุฅุฏุฎุงู.  ูุฌุจ ุฃู ุชููู ูุตุงุฏูุฉ ุงูุฅุฌุงุจุฉ ุงูุญููููุฉ 80ูช ุนูู ุงูุฃูู. <br><br><h4 style=";text-align:right;direction:rtl">  ูุซุงู </h4><div class="scrollable-table" style=";text-align:right;direction:rtl"><table style=";text-align:right;direction:rtl"><tbody><tr><td>  <b>ุฏุฎูู</b> </td><td>  <b>ุงุณุชูุชุงุฌ</b> </td></tr><tr><td> <code>100 3 <br> a <br> a <br> aa <br> a <br> aaa <br> a <br> aaaaaa <br> aa <br> a <br> a <br> a <br> aaa <br> a <br> a <br> aaa <br> aa <br> aaaa <br> aaa <br> a <br> aaaaa <br> aa <br> a <br> aaaa <br> a <br> a <br> a <br> a <br> a <br> a <br> aa <br> aaaa <br> aaa <br> a <br> aa <br> aaaa <br> a <br> a <br> a <br> a <br> a <br> a <br> a <br> a <br> a <br> a <br> aa <br> aaa <br> aaa <br> a <br> a <br> bbb <br> bb <br> bb <br> bbbbbbb <br> bb <br> bbb <br> b <br> bbbbbbb <br> bbbb <br> bbb <br> bb <br> bbb <br> bb <br> bb <br> bbb <br> bbbbbb <br> bbb <br> b <br> bbbbbb <br> b <br> bbbbb <br> b <br> b <br> bb <br> b <br> bb <br> bb <br> b <br> b <br> b <br> b <br> bb <br> bb <br> bb <br> b <br> b <br> b <br> bb <br> b <br> bbb <br> bb <br> b <br> bbbbbb <br> b <br> bb <br> bb <br> bb <br> b <br> bb <br> bbb</code> </td> <td> <code>0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 0 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1 <br> 1</code> </td> </tr></tbody></table></div><h4 style=";text-align:right;direction:rtl">  ุงูููุงุญุธุงุช </h4><br>  ููุงุญุธุฉ ููุงุฎุชุจุงุฑ ูู ุงูุดุฑุท: ููู ูุชู ุฅูุดุงุก ุงูุฎุทูุท 50 ุงูุฃููู ูู ุงูุชูุฒูุน <br>  P (x <sub>i</sub> = a | x <sub>i - 1</sub> = a) = 0.5ุ P (x <sub>i</sub> = S | x <sub>i - 1</sub> = a) = 0.5ุ P (x <sub>1</sub> = a) = 1ุ  50 ุงูุซุงููุฉ - ูู ุงูุชูุฒูุน <br>  P (x <sub>i</sub> = b | x <sub>i - 1</sub> = b) = 0.5ุ P (x <sub>i</sub> = S | x <sub>i - 1</sub> = b) = 0.5ุ P (x <sub>1</sub> = b) = 1. </div></div><br><h4 style=";text-align:right;direction:rtl">  ูุฑุงุฑ </h4><br>  ุชู ุญู ุงููุดููุฉ ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฎูุงุฑุฒููุฉ EM</a> : ูู ุงูููุชุฑุถ ุฃู ูุชู ุฅูุดุงุก ุงูุนููุฉ ุงูููุฏูุฉ ูู ุฎููุท ูู ุงุซููู ูู ุณูุงุณู Markov ุงูุชู ูุชู ุงุณุชุนุงุฏุฉ ุงููุนููุงุช ุฃุซูุงุก ุงูุชูุฑุงุฑ.  ุชู ูุถุน ูููุฏ ุจูุณุจุฉ 80ูช ูู ุงูุฅุฌุงุจุงุช ุงูุตุญูุญุฉ ุจุญูุซ ูุง ุชุชุฃุซุฑ ุตุญุฉ ุงูุญู ุจุฃูุซูุฉ ุฐุงุช ุงุญุชูุงู ูุจูุฑ ูู ููุชุง ุงูุณูุณูุชูู.  ูุฐูู ุ ุนูุฏ ุงุณุชุนุงุฏุฉ ูุฐู ุงูุฃูุซูุฉ ุจุดูู ุตุญูุญ ุ ูููู ุชุนููููุง ุฅูู ุณูุณูุฉ ุบูุฑ ุตุญูุญุฉ ูู ุญูุซ ุงูุงุณุชุฌุงุจุฉ ุงูุชู ุชู ุฅูุดุงุคูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> math EPS = <span class="hljs-number"><span class="hljs-number">1e-9</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">empty_row</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(size)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [<span class="hljs-number"><span class="hljs-number">0</span></span>] * size <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">empty_matrix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rows, cols)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [empty_row(cols) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(rows)] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">normalized_row</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(row)</span></span></span><span class="hljs-function">:</span></span> row_sum = sum(row) + EPS <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [x / row_sum <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> row] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">normalized_matrix</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(mtx)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [normalized_row(r) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> mtx] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">restore_params</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(alphabet, string_samples)</span></span></span><span class="hljs-function">:</span></span> n_tokens = len(alphabet) n_samples = len(string_samples) samples = [tuple([alphabet.index(token) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> token <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s] + [n_tokens - <span class="hljs-number"><span class="hljs-number">1</span></span>, n_tokens - <span class="hljs-number"><span class="hljs-number">1</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> s <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> string_samples] probs = [random.random() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(n_samples)] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">200</span></span>): old_probs = [x <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> x <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> probs] <span class="hljs-comment"><span class="hljs-comment"># probs fixed p0, A = empty_row(n_tokens), empty_matrix(n_tokens, n_tokens) q0, B = empty_row(n_tokens), empty_matrix(n_tokens, n_tokens) for prob, sample in zip(probs, samples): p0[sample[0]] += prob q0[sample[0]] += 1 - prob for t1, t2 in zip(sample[:-1], sample[1:]): A[t1][t2] += prob B[t1][t2] += 1 - prob A, p0 = normalized_matrix(A), normalized_row(p0) B, q0 = normalized_matrix(B), normalized_row(q0) trans_log_diff = [ [math.log(b + EPS) - math.log(a + EPS) for b, a in zip(B_r, A_r)] for B_r, A_r in zip(B, A) ] # A, p0, B, q0 fixed probs = empty_row(n_samples) for i, sample in enumerate(samples): value = math.log(q0[sample[0]] + EPS) - math.log(p0[sample[0]] + EPS) for t1, t2 in zip(sample[:-1], sample[1:]): value += trans_log_diff[t1][t2] probs[i] = 1.0 / (1.0 + math.exp(value)) if max(abs(x - y) for x, y in zip(probs, old_probs)) &lt; 1e-9: break return [int(x &gt; 0.5) for x in probs] def main(): N, K = list(map(int, input().split())) string_samples = [] alphabet = list(input().strip()) + [''] for _ in range(N): string_samples.append(input().rstrip()) result = restore_params(alphabet, string_samples) for r in result: print(r) if __name__ == '__main__': main()</span></span></code> </pre> <br><hr><br>     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar461273/">https://habr.com/ru/post/ar461273/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar461261/index.html">ูุงุฆูุฉ ุงูุชุญูู ูู ูุฏูุงุช RRC ูููุฏุฉ ุนูู ููุชุฌุงุช RRC</a></li>
<li><a href="../ar461265/index.html">ุญูู ุฅุณุงุกุฉ ุงุณุชุฎุฏุงู ูุธุงู ุงูุชุดุบูู ูู ูุดุงุฑูุน ูููุฑูููุชุฑููุฑ</a></li>
<li><a href="../ar461267/index.html">ุชูููุงุช ุฅูุชู ุงูุฌุฏูุฏุฉ ูุชุบููู ุงูุฑูุงุฆู</a></li>
<li><a href="../ar461269/index.html">ุญู ุงููุดููุฉ ูุน pwnable.kr 08 ูู ุงูุณุงู ู 10 ูู ุงูุตุฏูุฉ. ูุฌูุน ุฃุฑููููุง. ุจุงุด ุงูุถุนู</a></li>
<li><a href="../ar461271/index.html">ููููุฉ ุงูุชุฑููุฌ ูุชุทุจูู ุงููุงุชู ุงููุญููู ูู 2019: 4 ุทุฑู ุนูููุฉ + ุฃุฏูุงุช ูููุฏุฉ</a></li>
<li><a href="../ar461277/index.html">ูุธุฑุฉ ุนุงูุฉ ุนูู ุฃุฏุงุฉ SQLIndexManager ุงููุฌุงููุฉ</a></li>
<li><a href="../ar461279/index.html">ููููุฉ ุฅูุดุงุก ุฎุฏูุฉ microservice ุจุณูุทุฉ ุนูู Golang ู gRPC ูุญุงููุงุชูุง ุจุงุณุชุฎุฏุงู Docker</a></li>
<li><a href="../ar461281/index.html">ุชุฌูู ูุฅุนุฏุงุฏ ุฎุงุฏู BIND DNS ูู ุจูุฆุฉ chroot ูู Red Hat (RHEL / CentOS) 7</a></li>
<li><a href="../ar461283/index.html">ููุฏุณุฉ ุงูุจุฑูุฌูุงุช ูุชุตููู ุงููุธุงู: The Big Picture and Resource Guide</a></li>
<li><a href="../ar461285/index.html">5 ุฎูุงุฑุฒููุงุช ุฃุฎุฐ ุงูุนููุงุช ุงูุฑุฆูุณูุฉ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>