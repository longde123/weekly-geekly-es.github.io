<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â­ï¸ ğŸ‘·ğŸ» ğŸ‘¶ğŸ» ä»‹ç»CLI Builder ğŸ§˜ğŸ¼ ğŸ‘… ğŸ‘¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»æ–°çš„Angular CLI APIï¼Œå®ƒå°†å…è®¸æ‚¨æ‰©å±•ç°æœ‰çš„CLIåŠŸèƒ½å¹¶æ·»åŠ æ–°åŠŸèƒ½ã€‚ æˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ä½¿ç”¨æ­¤APIï¼Œä»¥åŠå®ƒçš„æ‰©å±•è¦ç‚¹æ˜¯ä»€ä¹ˆï¼Œè¿™äº›ç‚¹å…è®¸å‘CLIæ·»åŠ æ–°åŠŸèƒ½ã€‚ 

 æ•…äº‹ 
 å¤§çº¦ä¸€å¹´å‰ï¼Œæˆ‘ä»¬åœ¨Angular CLIä¸­å¼•å…¥äº†å·¥ä½œç©ºé—´æ–‡ä»¶ï¼ˆ angular.json ï¼‰ï¼Œå¹¶é‡...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä»‹ç»CLI Builder</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450746/"><img src="https://habrastorage.org/webt/sm/xo/kb/smxokbjs_uhwjcb1rjv7cwt5k3m.png" alt="ä»‹ç»CLI Builder"><br><br> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä»‹ç»æ–°çš„Angular CLI APIï¼Œå®ƒå°†å…è®¸æ‚¨æ‰©å±•ç°æœ‰çš„CLIåŠŸèƒ½å¹¶æ·»åŠ æ–°åŠŸèƒ½ã€‚ æˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•ä½¿ç”¨æ­¤APIï¼Œä»¥åŠå®ƒçš„æ‰©å±•è¦ç‚¹æ˜¯ä»€ä¹ˆï¼Œè¿™äº›ç‚¹å…è®¸å‘CLIæ·»åŠ æ–°åŠŸèƒ½ã€‚ <br><a name="habracut"></a><br><h2> æ•…äº‹ </h2><br> å¤§çº¦ä¸€å¹´å‰ï¼Œæˆ‘ä»¬åœ¨Angular CLIä¸­å¼•å…¥äº†å·¥ä½œç©ºé—´æ–‡ä»¶ï¼ˆ <i>angular.json</i> ï¼‰ï¼Œå¹¶é‡æ–°è€ƒè™‘äº†å®ç°å…¶å‘½ä»¤çš„è®¸å¤šåŸºæœ¬åŸåˆ™ã€‚ æˆ‘ä»¬å‘ç°æˆ‘ä»¬å°†å›¢é˜Ÿæ”¾åœ¨â€œç›’å­â€ä¸­ï¼š <br><br><ol><li>  <b>ç¤ºæ„å›¾å‘½ä»¤-â€œç¤ºæ„å›¾å‘½ä»¤</b> ã€‚ <b>â€</b> åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨å¯èƒ½å·²ç»å¬è¯´è¿‡Schematicsï¼ŒCLIä½¿ç”¨è¯¥åº“æ¥ç”Ÿæˆå’Œä¿®æ”¹ä»£ç ã€‚ å®ƒå‡ºç°åœ¨ç‰ˆæœ¬5ä¸­ï¼Œå¹¶ä¸”å½“å‰åœ¨å¤§å¤šæ•°ä¸ä»£ç æœ‰å…³çš„å‘½ä»¤ä¸­ä½¿ç”¨ï¼Œä¾‹å¦‚<i>new</i> ï¼Œ <i>generate</i> ï¼Œ <i>add</i>å’Œ<i>update</i> ã€‚ </li><li>  <b>æ‚é¡¹å‘½ä»¤-â€œå…¶ä»–å›¢é˜Ÿâ€</b> ã€‚ è¿™äº›æ˜¯ä¸æ‚¨çš„é¡¹ç›®æ²¡æœ‰ç›´æ¥å…³ç³»çš„å‘½ä»¤ï¼š <i>help</i> ï¼Œ <i>version</i> ï¼Œ <i>config</i> ï¼Œ <i>doc</i> ã€‚ æœ€è¿‘ï¼Œ <i>åˆ†æ</i>æ–¹æ³•ä»¥åŠå¤æ´»èŠ‚å½©è›‹ä¹Ÿå‡ºç°äº†ï¼ˆå˜˜ï¼å¯¹ä»»ä½•äººæ¥è¯´éƒ½ä¸æ˜¯ä¸€å¥è¯ï¼ï¼‰ã€‚ </li><li>  <b>ä»»åŠ¡å‘½ä»¤-â€œä»»åŠ¡å‘½ä»¤</b> ã€‚ <b>â€</b> æ€»çš„æ¥è¯´ï¼Œè¯¥ç±»åˆ«æ˜¯â€œå‘å¸ƒåœ¨å…¶ä»–äººçš„ä»£ç ä¸Šæ‰§è¡Œçš„è¿›ç¨‹â€ã€‚  -ä¾‹å¦‚ï¼Œ <i>æ„å»º</i>æ˜¯é¡¹ç›®æ„å»ºï¼Œ <i>æ£‰ç»’</i>æ˜¯è°ƒè¯•ï¼Œ <i>æµ‹è¯•</i>æ˜¯æµ‹è¯•ã€‚ </li></ol><br> æˆ‘ä»¬å¾ˆä¹…ä»¥å‰å°±å¼€å§‹è®¾è®¡<i>angular.json</i> ã€‚ æœ€åˆï¼Œå®ƒè¢«è®¤ä¸ºæ˜¯Webpacké…ç½®çš„æ›¿ä»£å“ã€‚ å¦å¤–ï¼Œå®ƒåº”è¯¥å…è®¸å¼€å‘äººå‘˜ç‹¬ç«‹é€‰æ‹©é¡¹ç›®ç¨‹åºé›†çš„å®ç°ã€‚ ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªåŸºæœ¬çš„ä»»åŠ¡å¯åŠ¨ç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿå¯¹äºæˆ‘ä»¬çš„å®éªŒä»ç„¶ç®€å•è€Œæ–¹ä¾¿ã€‚ æˆ‘ä»¬å°†æ­¤APIç§°ä¸ºâ€œå»ºç­‘å¸ˆâ€ã€‚ <br><br> å°½ç®¡æ²¡æœ‰æ­£å¼æ”¯æŒArchitectï¼Œä½†å®ƒåœ¨æƒ³è¦è‡ªå®šä¹‰é¡¹ç›®ç¨‹åºé›†çš„å¼€å‘äººå‘˜ä»¥åŠéœ€è¦æ§åˆ¶å…¶å·¥ä½œæµçš„ç¬¬ä¸‰æ–¹åº“ä¸­å¾ˆå—æ¬¢è¿ã€‚  Nxä½¿ç”¨å®ƒæ‰§è¡ŒBazelå‘½ä»¤ï¼ŒIonicä½¿ç”¨å®ƒåœ¨Jestä¸Šè¿è¡Œå•å…ƒæµ‹è¯•ï¼Œç”¨æˆ·å¯ä»¥ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ngx-build-plusä¹‹</a>ç±»çš„å·¥å…·æ‰©å±•Webpacké…ç½®ã€‚ é‚£ä»…ä»…æ˜¯å¼€å§‹ã€‚ <br><br>  <b>Angular CLIç‰ˆæœ¬8ä¸­ä½¿ç”¨äº†è¯¥APIçš„å®˜æ–¹æ”¯æŒï¼Œç¨³å®šå’Œæ”¹è¿›ç‰ˆæœ¬ã€‚</b> <br><br><h2> æ¦‚å¿µå›¾ </h2><br>  Architect APIæä¾›äº†ç”¨äºå®‰æ’å’Œåè°ƒAngular CLIç”¨äºå®ç°å…¶å‘½ä»¤çš„ä»»åŠ¡çš„å·¥å…·ã€‚ å®ƒä½¿ç”¨ç§°ä¸º <br>  â€œå»ºé€ è€…â€-å¯ä»¥å……å½“å…¶ä»–æ”¶è—å®¶çš„ä»»åŠ¡æˆ–è®¡åˆ’è€…çš„â€œæ”¶è—å®¶â€ã€‚ å¦å¤–ï¼Œå®ƒä½¿ç”¨angular.jsonä½œä¸ºæ”¶é›†å™¨æœ¬èº«çš„ä¸€ç»„æŒ‡ä»¤ã€‚ <br><br> è¿™æ˜¯ä¸€ä¸ªéå¸¸é€šç”¨çš„ç³»ç»Ÿï¼Œæ—¨åœ¨çµæ´»ä¸”å¯æ‰©å±•ã€‚ å®ƒåŒ…å«ç”¨äºæŠ¥å‘Šï¼Œè®°å½•å’Œæµ‹è¯•çš„APIã€‚ å¦‚æœ‰å¿…è¦ï¼Œå¯ä»¥å°†ç³»ç»Ÿæ‰©å±•ä¸ºæ–°ä»»åŠ¡ã€‚ <br><br><h2> é€‰æ‹©å™¨ </h2><br> æ±‡ç¼–å™¨æ˜¯å®ç°å¯ä»¥ä»£æ›¿CLIå‘½ä»¤çš„ä»»åŠ¡çš„é€»è¾‘å’Œè¡Œä¸ºçš„å‡½æ•°ã€‚  -ä¾‹å¦‚ï¼Œå¯åŠ¨çŸ­ç»’æ£‰ã€‚ <br><br> æ”¶é›†å™¨å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•°ï¼šè¾“å…¥å€¼ï¼ˆæˆ–é€‰é¡¹ï¼‰å’Œæä¾›CLIå’Œæ”¶é›†å™¨æœ¬èº«ä¹‹é—´å…³ç³»çš„ä¸Šä¸‹æ–‡ã€‚ è¿™é‡Œçš„è´£ä»»åˆ’åˆ†ä¸Schematicsä¸­çš„ç›¸åŒ-CLIç”¨æˆ·è®¾ç½®é€‰é¡¹ï¼ŒAPIè´Ÿè´£ä¸Šä¸‹æ–‡ï¼Œæ‚¨ï¼ˆå¼€å‘äººå‘˜ï¼‰è®¾ç½®å¿…è¦çš„è¡Œä¸ºã€‚ è¯¥è¡Œä¸ºå¯ä»¥åŒæ­¥ï¼Œå¼‚æ­¥æˆ–ç®€å•åœ°æ˜¾ç¤ºä¸€å®šæ•°é‡çš„å€¼æ¥å®ç°ã€‚ è¾“å‡ºå¿…é¡»ä¸º<i>BuilderOutput</i>ç±»å‹ï¼Œå…¶ä¸­åŒ…å«é€»è¾‘å­—æ®µ<i>æˆåŠŸ</i>å’Œå¯é€‰å­—æ®µ<i>error</i> ï¼ˆå…¶ä¸­åŒ…å«é”™è¯¯æ¶ˆæ¯ï¼‰ã€‚ <br><br><h2> å·¥ä½œåŒºæ–‡ä»¶å’Œä»»åŠ¡ </h2><br>  Architect APIä¾èµ–<i>angular.json</i> ï¼ˆä¸€ä¸ªç”¨äºå­˜å‚¨ä»»åŠ¡åŠå…¶è®¾ç½®çš„å·¥ä½œç©ºé—´æ–‡ä»¶ï¼‰ã€‚ <br><br>  <i>angular.json</i>å°†å·¥ä½œç©ºé—´åˆ’åˆ†ä¸ºå¤šä¸ªé¡¹ç›®ï¼Œç„¶ååˆå°†å®ƒä»¬åˆ’åˆ†ä¸ºå¤šä¸ªä»»åŠ¡ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨<i>ng new</i>å‘½ä»¤åˆ›å»ºçš„åº”ç”¨ç¨‹åºå°±æ˜¯è¿™æ ·ä¸€ä¸ªé¡¹ç›®ã€‚ è¯¥é¡¹ç›®ä¸­çš„ä»»åŠ¡ä¹‹ä¸€æ˜¯<i>æ„å»º</i>ä»»åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨<i>ng buildå‘½ä»¤å¯åŠ¨</i> ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤ä»»åŠ¡å…·æœ‰ä¸‰ä¸ªé”®ï¼š <br><br><ol><li>  <b>builder-</b>ç”¨äºå®Œæˆä»»åŠ¡çš„æ”¶é›†<b>å™¨</b>çš„åç§°ï¼Œæ ¼å¼ä¸º<i>PACKAGE_NAMEï¼šASSEMBLY_NAME</i> ã€‚ </li><li>  <b>options-</b>é»˜è®¤æƒ…å†µä¸‹å¯åŠ¨ä»»åŠ¡æ—¶ä½¿ç”¨çš„è®¾ç½®ã€‚ </li><li>  <b>é…ç½®</b> -ä½¿ç”¨æŒ‡å®šé…ç½®å¯åŠ¨ä»»åŠ¡æ—¶å°†åº”ç”¨çš„è®¾ç½®ã€‚ </li></ol><br> è®¾ç½®çš„åº”ç”¨å¦‚ä¸‹ï¼šä»»åŠ¡å¼€å§‹æ—¶ï¼Œè®¾ç½®ä»é€‰é¡¹å—ä¸­è·å–ï¼Œç„¶åï¼Œå¦‚æœå·²æŒ‡å®šé…ç½®ï¼Œåˆ™å…¶è®¾ç½®å°†å†™å…¥ç°æœ‰è®¾ç½®çš„é¡¶éƒ¨ã€‚ æ­¤åï¼Œå¦‚æœå°†å…¶ä»–è®¾ç½®ä¼ é€’ç»™<i>scheduleTargetï¼ˆï¼‰</i> - <i>è¦†ç›–</i>å—ï¼Œåˆ™å°†æœ€åå†™å…¥å®ƒä»¬ã€‚ ä½¿ç”¨Angular CLIæ—¶ï¼Œå‘½ä»¤è¡Œå‚æ•°å°†ä¼ é€’ç»™<i>overrides</i> ã€‚ å°†æ‰€æœ‰è®¾ç½®è½¬ç§»åˆ°æ”¶é›†å™¨ä¹‹åï¼Œä»–å°†æ ¹æ®è‡ªå·±çš„æ–¹æ¡ˆæ£€æŸ¥å®ƒä»¬ï¼Œå¹¶ä¸”ä»…å½“è®¾ç½®ä¸ä¹‹ç›¸å¯¹åº”æ—¶ï¼Œæ‰ä¼šåˆ›å»ºä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”æ”¶é›†å™¨å°†å¼€å§‹å·¥ä½œã€‚ <br><br> æœ‰å…³å·¥ä½œåŒºçš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a> ã€‚ <br><br><h2> åˆ›å»ºè‡ªå·±çš„æ”¶è—å®¶ </h2><br> ä½œä¸ºç¤ºä¾‹ï¼Œè®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ”¶é›†å™¨ï¼Œè¯¥æ”¶é›†å™¨å°†åœ¨å‘½ä»¤è¡Œä¸Šè¿è¡Œå‘½ä»¤ã€‚ è¦åˆ›å»ºæ”¶é›†å™¨ï¼Œè¯·ä½¿ç”¨<i>createBuilder</i>å·¥å‚å¹¶è¿”å›<i>BuilderOutput</i>å¯¹è±¡ï¼š <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { BuilderOutput, createBuilder } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular-devkit/architect'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> createBuilder(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options, context</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>&lt;BuilderOutput&gt;(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { resolve({ <span class="hljs-attr"><span class="hljs-attr">success</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }); }); });</code> </pre> <br> ç°åœ¨ï¼Œè®©æˆ‘ä»¬å‘æ”¶é›†å™¨æ·»åŠ ä¸€äº›é€»è¾‘ï¼šæˆ‘ä»¬è¦é€šè¿‡è®¾ç½®æ¥æ§åˆ¶æ”¶é›†å™¨ï¼Œåˆ›å»ºæ–°æµç¨‹ï¼Œç­‰å¾…æµç¨‹å®Œæˆï¼Œå¦‚æœæµç¨‹æˆåŠŸå®Œæˆï¼ˆå³è¿”å›ä»£ç 0ï¼‰ï¼Œåˆ™å°†å…¶å‘é€ç»™Architectï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { BuilderOutput, createBuilder } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular-devkit/architect'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> childProcess <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'child_process'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> createBuilder(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options, context</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> child = childProcess.spawn(options.command, options.args); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>&lt;BuilderOutput&gt;(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { child.on(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, code =&gt; { resolve({ <span class="hljs-attr"><span class="hljs-attr">success</span></span>: code === <span class="hljs-number"><span class="hljs-number">0</span></span> }); }); }); });</code> </pre><br><h2> è¾“å‡ºå¤„ç† </h2><br> ç°åœ¨ï¼Œ <i>spawn</i>æ–¹æ³•å°†æ‰€æœ‰æ•°æ®ä¼ é€’åˆ°æµç¨‹çš„æ ‡å‡†è¾“å‡ºã€‚ æˆ‘ä»¬å¯èƒ½å¸Œæœ›å°†å®ƒä»¬è½¬ç§»åˆ°<i>è®°å½•å™¨</i> -è®°å½•å™¨ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œé¦–å…ˆï¼Œå°†ä¿ƒè¿›æµ‹è¯•è¿‡ç¨‹ä¸­çš„è°ƒè¯•ï¼Œå…¶æ¬¡ï¼ŒArchitectæœ¬èº«å¯ä»¥åœ¨å•ç‹¬çš„è¿›ç¨‹ä¸­è¿è¡Œæˆ‘ä»¬çš„æ”¶é›†å™¨ï¼Œæˆ–è€…ç¦ç”¨è¿›ç¨‹çš„æ ‡å‡†è¾“å‡ºï¼ˆä¾‹å¦‚ï¼Œåœ¨Electronåº”ç”¨ç¨‹åºä¸­ï¼‰ã€‚ <br><br> ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<i>ä¸Šä¸‹æ–‡</i>å¯¹è±¡ä¸­å¯ç”¨çš„<i>Logger</i> ï¼Œå®ƒå°†å…è®¸æˆ‘ä»¬é‡å®šå‘æµç¨‹çš„è¾“å‡ºï¼š <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { BuilderOutput, createBuilder } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular-devkit/architect'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> childProcess <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'child_process'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> createBuilder(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options, context</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> child = childProcess.spawn(options.command, options.args, { <span class="hljs-attr"><span class="hljs-attr">stdio</span></span>: <span class="hljs-string"><span class="hljs-string">'pipe'</span></span> }); child.stdout.on(<span class="hljs-string"><span class="hljs-string">'data'</span></span>, (data) =&gt; { context.logger.info(data.toString()); }); child.stderr.on(<span class="hljs-string"><span class="hljs-string">'data'</span></span>, (data) =&gt; { context.logger.error(data.toString()); }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>&lt;BuilderOutput&gt;(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { child.on(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, code =&gt; { resolve({ <span class="hljs-attr"><span class="hljs-attr">success</span></span>: code === <span class="hljs-number"><span class="hljs-number">0</span></span> }); }); }); });</code> </pre><br><h2> ç»©æ•ˆå’ŒçŠ¶æ€æŠ¥å‘Š </h2><br> ä¸æ‚¨è‡ªå·±çš„æ”¶é›†å™¨çš„å®ç°ç›¸å…³çš„APIçš„æœ€åä¸€éƒ¨åˆ†æ˜¯è¿›åº¦å’Œå½“å‰çŠ¶æ€æŠ¥å‘Šã€‚ <br><br> åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå‘½ä»¤å·²å®Œæˆæˆ–å·²æ‰§è¡Œï¼Œå› æ­¤æ·»åŠ è¿›åº¦æŠ¥å‘Šæ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å°†æˆ‘ä»¬çš„çŠ¶æ€ä¼ è¾¾ç»™çˆ¶æ”¶é›†è€…ï¼Œä»¥ä¾¿ä»–äº†è§£æ­£åœ¨å‘ç”Ÿçš„äº‹æƒ…ã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { BuilderOutput, createBuilder } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular-devkit/architect'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> childProcess <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'child_process'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> createBuilder(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">options, context</span></span></span><span class="hljs-function">) =&gt;</span></span> { context.reportStatus(<span class="hljs-string"><span class="hljs-string">`Executing "</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${options.command}</span></span></span><span class="hljs-string">"...`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> child = childProcess.spawn(options.command, options.args, { <span class="hljs-attr"><span class="hljs-attr">stdio</span></span>: <span class="hljs-string"><span class="hljs-string">'pipe'</span></span> }); child.stdout.on(<span class="hljs-string"><span class="hljs-string">'data'</span></span>, (data) =&gt; { context.logger.info(data.toString()); }); child.stderr.on(<span class="hljs-string"><span class="hljs-string">'data'</span></span>, (data) =&gt; { context.logger.error(data.toString()); }); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>&lt;BuilderOutput&gt;(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { context.reportStatus(<span class="hljs-string"><span class="hljs-string">`Done.`</span></span>); child.on(<span class="hljs-string"><span class="hljs-string">'close'</span></span>, code =&gt; { resolve({ <span class="hljs-attr"><span class="hljs-attr">success</span></span>: code === <span class="hljs-number"><span class="hljs-number">0</span></span> }); }); }); });</code> </pre><br> è¦ä¼ é€’<i>è¿›åº¦</i>æŠ¥å‘Šï¼Œè¯·ä½¿ç”¨å¸¦æœ‰å½“å‰å€¼å’Œï¼ˆå¯é€‰ï¼‰æ‘˜è¦å€¼ä½œä¸ºå‚æ•°çš„<i>reportProgress</i>æ–¹æ³•ã€‚  <i>æ€»æ•°</i>å¯ä»¥æ˜¯ä»»ä½•æ•°å­—ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çŸ¥é“éœ€è¦å¤„ç†å¤šå°‘ä¸ªæ–‡ä»¶ï¼Œåˆ™å¯ä»¥å°†å…¶æ•°é‡è½¬æ¢ä¸º<i>total</i> ï¼Œç„¶åå°†å…¶æ•°é‡è½¬æ¢ä¸º<i>æœ€æ–°çš„</i> ï¼Œå¯ä»¥ä¼ è¾“å·²å¤„ç†æ–‡ä»¶çš„æ•°é‡ã€‚  <a href="">tslintæ”¶é›†å™¨</a>å°±æ˜¯è¿™æ ·æŠ¥å‘Šå…¶è¿›åº¦çš„ã€‚ <br><br><h2> è¾“å…¥éªŒè¯ </h2><br> ä½¿ç”¨JSONæ¨¡å¼æ£€æŸ¥ä¼ é€’ç»™æ”¶é›†å™¨çš„<i>options</i>å¯¹è±¡ã€‚ å¦‚æœæ‚¨çŸ¥é“åŸç†å›¾ï¼Œè¿™ç±»ä¼¼äºåŸç†å›¾ã€‚ <br><br> åœ¨æˆ‘ä»¬çš„æ”¶é›†å™¨ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¸Œæœ›å‚æ•°å°†æ˜¯ä¸€ä¸ªæ¥æ”¶ä¸¤ä¸ªé”®çš„å¯¹è±¡ï¼š <i>command-</i>å‘½ä»¤ï¼ˆå­—ç¬¦ä¸²ï¼‰å’Œ<i>args-</i>å‚æ•°ï¼ˆå­—ç¬¦ä¸²æ•°ç»„ï¼‰ã€‚ æˆ‘ä»¬çš„éªŒè¯æ–¹æ¡ˆå¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"$schema"</span></span>: <span class="hljs-string"><span class="hljs-string">"http://json-schema.org/schema"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"object"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"properties"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"args"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"array"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span> } } }</code> </pre><br> æ–¹æ¡ˆæ˜¯çœŸæ­£å¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥æ‰§è¡Œå¤§é‡æ£€æŸ¥ã€‚ æœ‰å…³JSONæ–¹æ¡ˆçš„æ›´å¤šä¿¡æ¯ï¼Œæ‚¨å¯ä»¥å‚è€ƒ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">JSON Schemaå®˜æ–¹ç½‘ç«™</a> ã€‚ <br><br><h2> åˆ›å»ºä¸€ä¸ªæ„å»ºåŒ… </h2><br> ä¸ºäº†ä½¿å®ƒä¸Angular CLIå…¼å®¹ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºè‡ªå·±çš„æ”¶é›†å™¨åˆ›å»ºä¸€ä¸ªå¯†é’¥æ–‡ä»¶<i>-builders.json</i> ï¼Œè¯¥æ–‡ä»¶è´Ÿè´£æ”¶é›†å™¨çš„å®ç°ï¼Œå…¶åç§°å’ŒéªŒè¯æ–¹æ¡ˆä¹‹é—´çš„å…³ç³»ã€‚ æ–‡ä»¶æœ¬èº«å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"builders"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"implementation"</span></span>: <span class="hljs-string"><span class="hljs-string">"./command"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"schema"</span></span>: <span class="hljs-string"><span class="hljs-string">"./command/schema.json"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Runs any command line in the operating system."</span></span> } } }</code> </pre><br> ç„¶åï¼Œåœ¨<i>package.json</i>æ–‡ä»¶ä¸­ï¼Œæ·»åŠ <i>builders</i>é”®ï¼ŒæŒ‡å‘<i>builders.json</i>æ–‡ä»¶ï¼š <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"@example/command-runner"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.0.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"Builder for Architect"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"builders"</span></span>: <span class="hljs-string"><span class="hljs-string">"builders.json"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"devDependencies"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"@angular-devkit/architect"</span></span>: <span class="hljs-string"><span class="hljs-string">"^1.0.0"</span></span> } }</code> </pre><br> è¿™å°†å‘Šè¯‰Architectåœ¨å“ªé‡Œå¯»æ‰¾æ”¶é›†å™¨å®šä¹‰æ–‡ä»¶ã€‚ <br><br> å› æ­¤ï¼Œæˆ‘ä»¬çš„æ”¶é›†å™¨çš„åç§°ä¸º<i>â€œ @ example / command-runnerï¼šcommandâ€</i> ã€‚ åç§°çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œå†’å·ï¼ˆ:)ä¹‹å‰æ˜¯ä½¿ç”¨<i>package.json</i>å®šä¹‰çš„åŒ…åç§°ã€‚ ç¬¬äºŒéƒ¨åˆ†æ˜¯ä½¿ç”¨<i>builders.json</i>æ–‡ä»¶å®šä¹‰çš„æ”¶é›†å™¨çš„åç§°ã€‚ <br><br><h2> æµ‹è¯•æ‚¨è‡ªå·±çš„æ„å»ºå™¨ </h2><br> æ¨èçš„æµ‹è¯•ç»„è£…ç¨‹åºçš„æ–¹æ³•æ˜¯é€šè¿‡é›†æˆæµ‹è¯•ã€‚ è¿™æ˜¯å› ä¸ºåˆ›å»º<i>ä¸Šä¸‹æ–‡</i>å¹¶ä¸å®¹æ˜“ï¼Œå› æ­¤æ‚¨åº”è¯¥ä½¿ç”¨Architectçš„è°ƒåº¦ç¨‹åºã€‚ <br><br> ä¸ºäº†ç®€åŒ–æ¨¡å¼ï¼Œæˆ‘ä»¬æƒ³åˆ°äº†ä¸€ç§åˆ›å»ºArchitectå®ä¾‹çš„ç®€å•æ–¹æ³•ï¼šé¦–å…ˆåˆ›å»ºä¸€ä¸ª<i>JsonSchemaRegistry</i> ï¼ˆä»¥æµ‹è¯•æ¶æ„ï¼‰ï¼Œç„¶å<i>åˆ›å»ºTestingArchitectHost</i> ï¼Œæœ€åæ˜¯ä¸€ä¸ª<i>Architect</i>å®ä¾‹ã€‚ ç°åœ¨ï¼Œæ‚¨å¯ä»¥ç¼–è¯‘<i>builders.json</i>é…ç½®<i>æ–‡ä»¶</i> ã€‚ <br><br> è¿™æ˜¯è¿è¡Œæ”¶é›†å™¨çš„ç¤ºä¾‹ï¼Œè¯¥æ”¶é›†å™¨æ‰§è¡Œ<i>lså‘½ä»¤</i>å¹¶éªŒè¯<i>å‘½ä»¤</i>æ˜¯å¦æˆåŠŸå®Œæˆã€‚ è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å°†åœ¨<i>loggerä¸­</i>ä½¿ç”¨æµç¨‹çš„æ ‡å‡†è¾“å‡ºã€‚ <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Architect, ArchitectHost } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular-devkit/architect'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { TestingArchitectHost } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular-devkit/architect/testing'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { logging, schema } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'@angular-devkit/core'</span></span>; describe(<span class="hljs-string"><span class="hljs-string">'Command Runner Builder'</span></span>, () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> architect: Architect; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> architectHost: ArchitectHost; beforeEach(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> registry = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> schema.CoreSchemaRegistry(); registry.addPostTransform(schema.transforms.addUndefinedDefaults); <span class="hljs-comment"><span class="hljs-comment">//  TestingArchitectHost â€“    . //     ,   . architectHost = new TestingArchitectHost(__dirname, __dirname); architect = new Architect(architectHost, registry); //      NPM-, //    package.json  . await architectHost.addBuilderFromPackage('..'); }); //      Windows it('can run ls', async () =&gt; { //  ,     . const logger = new logging.Logger(''); const logs = []; logger.subscribe(ev =&gt; logs.push(ev.message)); // "run"    ,       . const run = await architect.scheduleBuilder('@example/command-runner:command', { command: 'ls', args: [__dirname], }, { logger }); // "result" â€“    . //    "BuilderOutput". const output = await run.result; //  . Architect     //   ,    ,    . await run.stop(); //   . expect(output.success).toBe(true); // ,     . // `ls $__dirname`. expect(logs).toContain('index_spec.ts'); }); });</span></span></code> </pre><br> è¦è¿è¡Œä¸Šé¢çš„ç¤ºä¾‹ï¼Œæ‚¨éœ€è¦<i>ts-node</i>è½¯ä»¶åŒ…ã€‚ å¦‚æœæ‰“ç®—ä½¿ç”¨Nodeï¼Œ <i>è¯·å°†</i> <i>index_spec.ts</i>é‡å‘½åä¸º<i>index_spec.js</i> ã€‚ <br><br><h2> åœ¨é¡¹ç›®ä¸­ä½¿ç”¨æ”¶é›†å™¨ </h2><br> è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„angular.jsonï¼Œä»¥æ¼”ç¤ºæˆ‘ä»¬ä»æ±‡ç¼–å™¨ä¸­å­¦åˆ°çš„æ‰€æœ‰çŸ¥è¯†ã€‚ å‡è®¾æˆ‘ä»¬å°†æ”¶é›†å™¨æ‰“åŒ…åœ¨<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">example</a> / command-runnerä¸­</i> ï¼Œç„¶åä½¿ç”¨<i>ng new builder-test</i>åˆ›å»ºäº†ä¸€ä¸ªæ–°åº”ç”¨ç¨‹åºï¼Œé‚£ä¹ˆ<i>angular.json</i>æ–‡ä»¶å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼ˆä¸ºç®€æ´èµ·è§ï¼ŒæŸäº›å†…å®¹å·²åˆ é™¤ï¼‰ï¼š <br><br><pre> <code class="json hljs">{ // ...   . <span class="hljs-attr"><span class="hljs-attr">"projects"</span></span>: { // ... <span class="hljs-attr"><span class="hljs-attr">"builder-test"</span></span>: { // ... <span class="hljs-attr"><span class="hljs-attr">"architect"</span></span>: { // ... <span class="hljs-attr"><span class="hljs-attr">"build"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"builder"</span></span>: <span class="hljs-string"><span class="hljs-string">"@angular-devkit/build-angular:browser"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"options"</span></span>: { // ...   <span class="hljs-attr"><span class="hljs-attr">"outputPath"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/builder-test"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"index"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/index.html"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/main.ts"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"polyfills"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/polyfills.ts"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tsConfig"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/tsconfig.app.json"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"configurations"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"production"</span></span>: { // ...   <span class="hljs-attr"><span class="hljs-attr">"optimization"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"aot"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"buildOptimizer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } } }</code> </pre><br> å¦‚æœæˆ‘ä»¬å†³å®šä½¿ç”¨æ”¶é›†å™¨æ·»åŠ æ–°ä»»åŠ¡ä»¥å°†<i>touch</i>å‘½ä»¤åº”ç”¨äºï¼ˆä¾‹å¦‚ï¼‰æ–‡ä»¶ï¼ˆæ›´æ–°æ–‡ä»¶ä¿®æ”¹æ—¥æœŸï¼‰ï¼Œæˆ‘ä»¬å°†è¿è¡Œ<i>npm install <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">example</a> / command-runner</i> ï¼Œç„¶åå¯¹<i>angular.json</i>è¿›è¡Œæ›´æ”¹ï¼š <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"projects"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"builder-test"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"architect"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"touch"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"builder"</span></span>: <span class="hljs-string"><span class="hljs-string">"@example/command-runner:command"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"options"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"touch"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"args"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"src/main.ts"</span></span> ] } }, <span class="hljs-attr"><span class="hljs-attr">"build"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"builder"</span></span>: <span class="hljs-string"><span class="hljs-string">"@angular-devkit/build-angular:browser"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"options"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"outputPath"</span></span>: <span class="hljs-string"><span class="hljs-string">"dist/builder-test"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"index"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/index.html"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"main"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/main.ts"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"polyfills"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/polyfills.ts"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"tsConfig"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/tsconfig.app.json"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"configurations"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"production"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"fileReplacements"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"replace"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/environments/environment.ts"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"with"</span></span>: <span class="hljs-string"><span class="hljs-string">"src/environments/environment.prod.ts"</span></span> } ], <span class="hljs-attr"><span class="hljs-attr">"optimization"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"aot"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"buildOptimizer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> } } } } } } }</code> </pre><br>  Angular CLIå…·æœ‰<i>è¿è¡Œ</i>å‘½ä»¤ï¼Œè¿™æ˜¯è¿è¡Œæ”¶é›†å™¨çš„ä¸»è¦å‘½ä»¤ã€‚ ä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°ï¼Œå®ƒé‡‡ç”¨æ ¼å¼ä¸º<i>PROJECTï¼šTASK [ï¼šCONFIGURATION]</i>çš„å­—ç¬¦ä¸²ã€‚ è¦è¿è¡Œæˆ‘ä»¬çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<i>ng run builder-testï¼štouch</i>å‘½ä»¤ã€‚ <br><br> ç°åœ¨æˆ‘ä»¬å¯èƒ½è¦é‡æ–°å®šä¹‰ä¸€äº›å‚æ•°ã€‚ ä¸å¹¸çš„æ˜¯ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ— æ³•ä»å‘½ä»¤è¡Œé‡æ–°å®šä¹‰æ•°ç»„ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥æ›´æ”¹å‘½ä»¤æœ¬èº«è¿›è¡Œæ¼”ç¤ºï¼š <i>ng run builder-testï¼štouch --command = ls</i> ã€‚  -è¿™å°†è¾“å‡º<i>src / main.tsæ–‡ä»¶</i> ã€‚ <br><br><h2> è§‚çœ‹æ¨¡å¼ </h2><br> é»˜è®¤æƒ…å†µä¸‹ï¼Œå‡å®šæ”¶é›†å™¨å°†è¢«è°ƒç”¨ä¸€æ¬¡å¹¶ç»ˆæ­¢ï¼Œä½†æ˜¯ï¼Œå®ƒä»¬å¯ä»¥è¿”å›<i>Observable</i>æ¥å®ç°è‡ªå·±çš„è§‚å¯Ÿæ¨¡å¼ï¼ˆå°±åƒ<i>Webpack</i>æ”¶é›†å™¨ä¸€æ ·ï¼‰ã€‚ å¦‚æœä½¿ç”¨ç›¸åŒçš„å‚æ•°è°ƒç”¨æ”¶é›†å™¨ï¼ˆå°½ç®¡ä¸èƒ½ä¿è¯ï¼‰ï¼Œé‚£ä¹ˆArchitectå°†è®¢é˜…<i>Observable</i>ç›´åˆ°å®Œæˆæˆ–åœæ­¢ä¸ºæ­¢ï¼Œå¹¶ä¸”å¯ä»¥å†æ¬¡è®¢é˜…æ”¶é›†å™¨ã€‚ <br><br><ol><li> æ¯æ¬¡æ‰§è¡Œåï¼Œæ”¶é›†å™¨åº”è¿”å›ä¸€ä¸ª<i>BuilderOutput</i>å¯¹è±¡ã€‚ å®Œæˆåï¼Œå®ƒå¯ä»¥è¿›å…¥ç”±å¤–éƒ¨äº‹ä»¶å¼•èµ·çš„è§‚å¯Ÿæ¨¡å¼ï¼Œå¦‚æœå†æ¬¡å¯åŠ¨ï¼Œåˆ™å¿…é¡»è°ƒç”¨<i>context.reportRunningï¼ˆï¼‰</i>å‡½æ•°æ¥é€šçŸ¥Architectæ”¶é›†å™¨æ­£åœ¨é‡æ–°å·¥ä½œã€‚ è¿™æ ·å¯ä»¥ä¿æŠ¤æ”¶é›†å™¨ï¼Œé˜²æ­¢å»ºç­‘å¸ˆåœ¨æ–°çš„å‘¼å«ä¸­é˜»æ­¢æ”¶é›†å™¨ã€‚ </li><li> å½“æ”¶é›†å™¨åœæ­¢æ—¶ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨run.stopï¼ˆï¼‰ï¼‰ï¼Œä½¿ç”¨æ‹†è§£<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é€»è¾‘</a> ï¼ˆé”€æ¯ç®—æ³•ï¼‰ï¼Œæ¶æ„å¸ˆè‡ªå·±ä»<i>Observable</i>é€€è®¢ã€‚ å¦‚æœæ­¤è¿‡ç¨‹å·²åœ¨è¿è¡Œï¼Œè¿™å°†å…è®¸æ‚¨åœæ­¢å¹¶æ¸…é™¤ç¨‹åºé›†ã€‚ </li></ol><br> ç»¼ä¸Šæ‰€è¿°ï¼Œå¦‚æœæ‚¨çš„æ”¶é›†è€…è§‚çœ‹å¤–éƒ¨äº‹ä»¶ï¼Œåˆ™å®ƒå¯ä»¥åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š <br><br><ol><li>  <b>å±¥è¡Œã€‚</b> ä¾‹å¦‚ï¼ŒWebpackçš„ç¼–è¯‘ã€‚ å½“Webpackå®Œæˆæ„å»ºå¹¶ä¸”æ‚¨çš„æ”¶é›†å™¨å°†<i>BuilderOutput</i>å‘é€åˆ°<i>Observable</i>æ—¶ï¼Œæ­¤æ­¥éª¤ç»“æŸã€‚ </li><li>  <b>è§‚å¯Ÿã€‚</b>  -åœ¨ä¸¤æ¬¡å‘å°„ä¹‹é—´ï¼Œå°†ç›‘è§†å¤–éƒ¨äº‹ä»¶ã€‚ ä¾‹å¦‚ï¼ŒWebpackç›‘è§†æ–‡ä»¶ç³»ç»Ÿæ˜¯å¦æœ‰ä»»ä½•æ›´æ”¹ã€‚ å½“Webpackæ¢å¤æ„å»ºå¹¶è°ƒç”¨<i>context.reportRunningï¼ˆï¼‰</i>æ—¶ï¼Œæ­¤æ­¥éª¤ç»“æŸã€‚ æ­¤æ­¥éª¤ä¹‹åï¼Œæ­¥éª¤1é‡æ–°å¼€å§‹ã€‚ </li><li>  <b>å®Œæˆã€‚</b>  -ä»»åŠ¡å·²å®Œå…¨å®Œæˆï¼ˆä¾‹å¦‚ï¼Œé¢„æœŸWebpackå°†å¯åŠ¨ä¸€å®šæ¬¡æ•°ï¼‰æˆ–åœæ­¢äº†æ”¶é›†å™¨çš„å¯åŠ¨ï¼ˆä½¿ç”¨<i>run.stopï¼ˆï¼‰</i> ï¼‰ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°†æ‰§è¡Œ<i>Observable</i>é”€æ¯ç®—æ³•å¹¶å°†å…¶æ¸…é™¤ã€‚ </li></ol><br><h2> ç»“è®º </h2><br> ä»¥ä¸‹æ˜¯æˆ‘ä»¬åœ¨è¯¥å‡ºç‰ˆç‰©ä¸­å­¦åˆ°çš„æ‘˜è¦ï¼š <br><br><ol><li> æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªæ–°çš„APIï¼Œä½¿å¼€å‘äººå‘˜å¯ä»¥æ›´æ”¹Angular CLIå‘½ä»¤çš„è¡Œä¸ºï¼Œå¹¶ä½¿ç”¨å®ç°å¿…è¦é€»è¾‘çš„æ±‡ç¼–ç¨‹åºæ·»åŠ æ–°çš„APIã€‚ </li><li> æ”¶é›†å™¨å¯ä»¥æ˜¯åŒæ­¥çš„ï¼Œå¼‚æ­¥çš„ï¼Œå¹¶ä¸”å¯ä»¥å“åº”å¤–éƒ¨äº‹ä»¶ã€‚ å®ƒä»¬å¯ä»¥è¢«å…¶ä»–æ”¶è—å®¶å¤šæ¬¡è°ƒç”¨ã€‚ </li><li> é¦–å…ˆä»<i>angular.json</i>æ–‡ä»¶ä¸­è¯»å–æ”¶é›†å™¨åœ¨ä»»åŠ¡å¯åŠ¨æ—¶æ”¶åˆ°çš„å‚æ•°ï¼Œç„¶åå°†å…¶ç”¨é…ç½®ä¸­çš„å‚æ•°ï¼ˆå¦‚æœæœ‰ï¼‰è¦†ç›–ï¼Œç„¶åå¦‚æœæ·»åŠ äº†å‘½ä»¤è¡Œæ ‡å¿—ï¼Œåˆ™å°†å…¶è¦†ç›–ã€‚ </li><li> æ¨èçš„æµ‹è¯•æ”¶é›†å™¨çš„æ–¹æ³•æ˜¯é€šè¿‡é›†æˆæµ‹è¯•ï¼Œä½†æ˜¯æ‚¨å¯ä»¥ä¸æ”¶é›†å™¨é€»è¾‘åˆ†å¼€æ‰§è¡Œå•å…ƒæµ‹è¯•ã€‚ </li><li> å¦‚æœæ”¶é›†å™¨è¿”å›ä¸€ä¸ªObservableï¼Œåˆ™åº”åœ¨é€šè¿‡é”€æ¯ç®—æ³•åå°†å…¶æ¸…é™¤ã€‚ </li></ol><br> åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œä½¿ç”¨è¿™äº›APIçš„é¢‘ç‡å°†ä¼šå¢åŠ ã€‚ ä¾‹å¦‚ï¼ŒBazelå®ç°ä¸å®ƒä»¬ç´§å¯†ç›¸å…³ã€‚ <br><br> æˆ‘ä»¬å·²ç»çœ‹åˆ°ç¤¾åŒºå¦‚ä½•åˆ›å»ºæ–°çš„CLIæ”¶é›†å™¨ä»¥ä¾›ä½¿ç”¨ï¼Œä¾‹å¦‚<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">jest</a></i>å’Œ<i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">cypress</a></i>ç”¨äºæµ‹è¯•ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN450746/">https://habr.com/ru/post/zh-CN450746/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN450734/index.html">æ¨¡ç³Šæµ‹è¯•æ˜¯å®‰å…¨å¼€å‘çš„é‡è¦ä¸€æ­¥</a></li>
<li><a href="../zh-CN450736/index.html">â€œä¸æä¾›å¤–éƒ¨é˜»æ­¢ç›¸æ¯”ï¼Œéš”ç¦»Internetæ›´åŠ å®¹æ˜“å’Œä¾¿å®œã€‚â€</a></li>
<li><a href="../zh-CN450738/index.html">æ•°æ®ä¸­å¿ƒçš„æœºå™¨äººï¼šäººå·¥æ™ºèƒ½å¦‚ä½•å‘æŒ¥ä½œç”¨ï¼Ÿ</a></li>
<li><a href="../zh-CN450740/index.html">æ™ºèƒ½ç¯åº§REDMOND-æ·»åŠ åˆ°æ™ºèƒ½å®¶å±…</a></li>
<li><a href="../zh-CN450744/index.html">æ˜æ–¯å…‹è‡ªè¡Œè½¦åŸºç¡€è®¾æ–½ï¼Œç”¨äºITåŸ¹è®­</a></li>
<li><a href="../zh-CN450748/index.html">ISTQBè®¤è¯ã€‚ ç¬¬1éƒ¨åˆ†ï¼šå­˜åœ¨è¿˜æ˜¯ä¸å­˜åœ¨ï¼Ÿ</a></li>
<li><a href="../zh-CN450752/index.html">â€œæˆ‘åªæœ‰ä¸€â€‹â€‹ç§æ•™å­¦æ–¹æ³•ï¼šè¡Œä¹‹æœ‰æ•ˆâ€-æ¥å—Ryan Dahlçš„é‡‡è®¿ï¼ˆNode.jsï¼ŒDenoï¼‰</a></li>
<li><a href="../zh-CN450754/index.html">è½®æ¤…æ¯”èµ›ï¼šä¿„ç½—æ–¯é£è¡Œå‘˜åœ¨ä¸œäº¬èµ¢å¾—äº†CYBATHLONå† å†›</a></li>
<li><a href="../zh-CN450756/index.html">å…³äºå†›äº‹èƒ½åŠ›ä¸§å¤±è€…</a></li>
<li><a href="../zh-CN450758/index.html">factory_trace gemå¯å¸®åŠ©æ¸…æ´å·¥å‚</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>