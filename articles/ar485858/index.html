<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐๐ฟ โน๏ธ ููููุฉ ุชุฏุฑูุณ ุงููุงุชู ููุนุฑูุฉ ุงูุฌูุงู ๐ ๐ ๐ถ๐ฝ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฏ ูุฑุฃุช ูุคุฎุฑูุง ูุชุงุจูุง ุนู ุงูุฑูุงุถูุงุช ูุฌูุงู ุงููุงุณ ูููุฑุช ูู ูุง ูุงู ุนููู ูุจู ุนูุฏ ูู ุงูุฒูู ุ ูููุฑุฉ ููููุฉ ููู ุงูุฌูุงู ุงูุจุดุฑู ุงูุฐู ูุงู ุจุฏุงุฆููุง ุชูุงููุง. ุฅู ุงูุชู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ููููุฉ ุชุฏุฑูุณ ุงููุงุชู ููุนุฑูุฉ ุงูุฌูุงู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485858/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/-f/0z/on/-f0zonxrb_qtnmaxp2bt34gu-d4.png" alt="ุตูุฑุฉ"><br><br>  ููุฏ ูุฑุฃุช ูุคุฎุฑูุง ูุชุงุจูุง ุนู ุงูุฑูุงุถูุงุช ูุฌูุงู ุงููุงุณ ูููุฑุช ูู ูุง ูุงู ุนููู ูุจู ุนูุฏ ูู ุงูุฒูู ุ ูููุฑุฉ ููููุฉ ููู ุงูุฌูุงู ุงูุจุดุฑู ุงูุฐู ูุงู ุจุฏุงุฆููุง ุชูุงููุง.  ุฅู ุงูุชูููุฑ ูู ุฃู ูุฌู ูุนุชุจุฑ ุฌูููุงู ูู ูุฌูุฉ ูุธุฑ ุงูุฑูุงุถูุงุช ูุฏ ุฌุงุก ุฅูู ุญูููุฉ ุฃูู ููุจุบู ุฃู ูููู ูุชูุงุซููุง.  ุฃูุถูุง ุ ููุฐ ุนุตุฑ ุงูููุถุฉ ุ ูุงูุช ููุงู ูุญุงููุงุช ููุตู ุงููุฌูู ุงูุฌูููุฉ ุจุงุณุชุฎุฏุงู ุงูุนูุงูุงุช ุจูู ุงููุณุงูุงุช ูู ุจุนุถ ุงูููุงุท ุนูู ุงููุฌู ูุฅุธูุงุฑ ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฃู ุงููุฌูู ุงูุฌูููุฉ ููุง ููุน ูู ุงูุนูุงูุฉ ุจุงููุฑุจ ูู ุงููุณุจุฉ ุงูุฐูุจูุฉ.  ูุชู ุงูุขู ุงุณุชุฎุฏุงู ุฃููุงุฑ ูุดุงุจูุฉ ุญูู ูููุน ุงูููุงุท ููุงุญุฏุฉ ูู ุทุฑู ุชุญุฏูุฏ ุงููุฌูู (ุงูุจุญุซ ุนู ูุนุงูู ุงููุฌู).  ููุน ุฐูู ุ ุชูุธูุฑ ุงูุชุฌุฑุจุฉ ุฃูู ุฅุฐุง ูู ุชูุตุฑ ูุฌููุนุฉ ุงูููุฒุงุช ุนูู ููุถุน ููุงุท ูุญุฏุฏุฉ ุนูู ุงููุฌู ุ ูููููู ุชุญููู ูุชุงุฆุฌ ุฃูุถู ูู ุนุฏุฏ ูู ุงูููุงู ุ <a href="https://arxiv.org/abs/1603.01249" rel="nofollow">ุจูุง ูู ุฐูู ุชุญุฏูุฏ ุงูุนูุฑ</a> ุฃู <a href="https://arxiv.org/abs/1603.01249" rel="nofollow">ุงูุฌูุณ</a> ุฃู <a href="https://www.gsb.stanford.edu/sites/gsb/files/publication-pdf/wang_kosinski.pdf" rel="nofollow">ุงูุชูุฌู ุงูุฌูุณู</a> .  ูู ุงููุงุถุญ ุจุงููุนู ููุง ุฃู ูุณุฃูุฉ ุฃุฎูุงููุงุช ูุดุฑ ูุชุงุฆุฌ ูุฐู ุงูุฏุฑุงุณุงุช ูุฏ ุชููู ุญุงุฏุฉ. <br><a name="habracut"></a><br>  ููุถูุน ุฌูุงู ุงููุงุณ ูุชููููู ูููู ุฃู ูููู ุฃูุถูุง ูุซุงุฑูุง ููุฌุฏู ุฃุฎูุงูููุง.  ุนูุฏ ุชุทููุฑ ุงูุชุทุจูู ุ ุฑูุถ ุงูุนุฏูุฏ ูู ุฃุตุฏูุงุฆู ุงุณุชุฎุฏุงู ุตูุฑูู ููุงุฎุชุจุงุฑุงุช ุ ุฃู ูู ูุฑุบุจูุง ูู ูุนุฑูุฉ ุงููุชูุฌุฉ (ูู ุงููุถุญู ุฃู ูุนุธู ุงููุชูุงุช ุฑูุถู ูุนุฑูุฉ ุงููุชุงุฆุฌ).  ุฃูุถุง ุ ูุฅู ุงููุฏู ูู ุฃุชูุชุฉ ุชูููู ุงูุฌูุงู ูููู ุฃู ูุซูุฑ ุฃุณุฆูุฉ ููุณููุฉ ูุซูุฑุฉ ููุงูุชูุงู.  ุฅูู ุฃู ูุฏู ูุชู ุชุญุฏูุฏ ููููู ุงูุฌูุงู ุญุณุจ ุงูุซูุงูุฉุ  ูุง ูุฏู ุตุญุฉ "ุงูุฌูุงู ูู ุนูู ุงููุงุธุฑ"ุ  ูู ูู ุงููููู ุชุณููุท ุงูุถูุก ุนูู ุนูุงูุงุช ููุถูุนูุฉ ูู ุงูุฌูุงูุ <br><br>  ููุฅุฌุงุจุฉ ุนูู ูุฐู ุงูุฃุณุฆูุฉ ุ ุชุญุชุงุฌ ุฅูู ุฏุฑุงุณุฉ ุงูุฅุญุตุงุกุงุช ุญูู ุชุตูููุงุช ุจุนุถ ุงูุฃุดุฎุงุต ูู ูุจู ุงูุขุฎุฑูู.  ุญุงููุช ุชุตููู ูููุฐุฌ ุดุจูุฉ ุนุตุจูุฉ ูุชููููู ูุชูููู ุงูุฌูุงู ุ ููุฐูู ุชุดุบููู ุนูู ูุงุชู ูุนูู ุจูุธุงู Android. <br><br><h2 style=";text-align:right;direction:rtl">  ุฌุฒุก 0. ุฎุท ุฃูุงุจูุจ </h2><br>  ูููู ููููุฉ ุงุฑุชุจุงุท ุงูุฎุทูุงุช ุงูุชุงููุฉ ุจุจุนุถูุง ุงูุจุนุถ ุ ููุช ุจุฑุณู ูุฎุทุท ูููุดุฑูุน: <br><br><img src="https://habrastorage.org/webt/cy/jp/zh/cyjpzhhy_hiczxqefjp9qgaohf0.png" alt="ุตูุฑุฉ"><br><br>  ุงูุฃุฒุฑู - ุงูููุชุจุงุช ุงููุงูุฉ ูุงูุจูุงูุงุช ุงูุฎุงุฑุฌูุฉ.  ุงูุฃุตูุฑ - ุงูุถูุงุจุท ูู ุงูุชุทุจูู. <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฌุฒุก 1. ุจูุซูู </h2><br>  ูุธุฑูุง ูุฃู ุชูููู ุงูุฌูุงู ูู ููุถูุน ุญุณุงุณ ุฅูู ุญุฏ ูุง ุ ูููุณ ููุงู ุงููุซูุฑ ูู ูุฌููุนุงุช ุงูุจูุงูุงุช ูู ุงููุฌุงู ุงูุนุงู ุงูุชู ุชุญุชูู ุนูู ุตูุฑ ูุน ุชูููู (ุฃูุง ูุชุฃูุฏ ูู ุฃู ุฎุฏูุงุช ุงูุชุนุงุฑู ุนู ุทุฑูู ุงูุฅูุชุฑูุช ูุซู tinder ูุฏููุง ูุฌููุนุงุช ุฃูุจุฑ ุจูุซูุฑ ูู ุงูุฅุญุตุงุกุงุช).  ููุฏ ูุฌุฏุช <a href="https://github.com/HCIILAB/SCUT-FBP5500-Database-Release" rel="nofollow">ูุงุนุฏุฉ ุจูุงูุงุช</a> ูุฌูุนุฉ ูู ุฅุญุฏู ุฌุงูุนุงุช ุงูุตูู ุ ุชุญุชูู ุนูู 5500 ุตูุฑุฉ ููุชูุบุฑุงููุฉ ุ ุชู ุชูููู ูู ูููุง ุจูุงุณุทุฉ 7 ูููููู ูู ุจูู ุงูุทูุงุจ ุงูุตููููู.  ูู ุจูู 5500 ุตูุฑุฉ ููุชูุบุฑุงููุฉ ุ ููุงู 2000 ุฑุฌู ุขุณููู (AM) ุ ู 2000 ุงูุฑุฃุฉ ุขุณูููุฉ (AF) ุ ู 750 ุฑุฌููุง ุฃูุฑูุจููุง (CM) ู (CF) ููู ููููุง. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fcf/1db/f9b/fcf1dbf9b67fee5543fdc9833d429676.jpg" alt="ุตูุฑุฉ"><br><br>  ุฏุนููุง ููุฑุฃ ุงูุจูุงูุงุช ุจุงุณุชุฎุฏุงู ูุญุฏุฉ ุจูุซูู ุงูุจุงูุฏุง ููููู ูุธุฑุฉ ุณุฑูุนุฉ ุนูู ุงูุจูุงูุงุช.  ุงูุชูุฒูุน ุงูููุฏุฑ ููุฃุฌูุงุณ ูุงูุฃุฌูุงุณ ุงููุฎุชููุฉ: <br><br><pre style=";text-align:right;direction:rtl"><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt ratingDS=pd.read_excel(<span class="hljs-string"><span class="hljs-string">'../input/faces-scut/scut-fbp5500_v2/SCUT-FBP5500_v2/All_Ratings.xlsx'</span></span>) Answer=ratingDS.groupby(<span class="hljs-string"><span class="hljs-string">'Filename'</span></span>).mean()[<span class="hljs-string"><span class="hljs-string">'Rating'</span></span>] ratingDS[<span class="hljs-string"><span class="hljs-string">'race'</span></span>]=ratingDS[<span class="hljs-string"><span class="hljs-string">'Filename'</span></span>].apply(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x:x[:<span class="hljs-number"><span class="hljs-number">2</span></span>]) fig, ax = plt.subplots(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, sharex=<span class="hljs-string"><span class="hljs-string">'col'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, race <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate([<span class="hljs-string"><span class="hljs-string">'CF'</span></span>,<span class="hljs-string"><span class="hljs-string">'CM'</span></span>,<span class="hljs-string"><span class="hljs-string">'AF'</span></span>,<span class="hljs-string"><span class="hljs-string">'AM'</span></span>]): sbp=ax[i%<span class="hljs-number"><span class="hljs-number">2</span></span>,i//<span class="hljs-number"><span class="hljs-number">2</span></span>] ratingDS[ratingDS[<span class="hljs-string"><span class="hljs-string">'race'</span></span>]==race].groupby(<span class="hljs-string"><span class="hljs-string">'Filename'</span></span>)[<span class="hljs-string"><span class="hljs-string">'Rating'</span></span>].mean().hist(alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, bins=<span class="hljs-number"><span class="hljs-number">20</span></span>,label=race,grid=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>,rwidth=<span class="hljs-number"><span class="hljs-number">0.9</span></span>,ax=sbp) sbp.set_title(race)</code> </pre> <br><img src="https://habrastorage.org/webt/fz/1q/fo/fz1qfoby_-ijefbbl4ifctz3llo.png" alt="ุตูุฑุฉ"><br><br>  ูููู ููุงุญุธุฉ ุฃู ุงูุฑุฌุงู ุ ุจุดูู ุนุงู ุ ูุนุชุจุฑูู ุฃูู ุฌูุงูุง ูู ุงููุณุงุก ุ ูุงูุชูุฒูุน ุซูุงุฆู ุงููุซุงูุฉ - ููุงู ูุคูุงุก.  ุงูุฐูู ูุนุชุจุฑูู ุฌูููุฉ ู "ุงููุชูุณุท".  ูุง ุชูุฌุฏ ุชููููุงุช ููุฎูุถุฉ ุชูุฑูุจูุง ุ ูุฐูู ูููู ุฅุนุงุฏุฉ ุชุตููู ุงูุจูุงูุงุช.  ููู ุฏุนูุง ูุชุฑููู ุงูุขู. <br><br>  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุงูุงูุญุฑุงู ุงููุนูุงุฑู ูู ุงูุชูุฏูุฑุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">ratingDS.groupby(<span class="hljs-string"><span class="hljs-string">'Filename'</span></span>)[<span class="hljs-string"><span class="hljs-string">'Rating'</span></span>].std().mean()</code> </pre><br>  ุฅูู 0.64 ุ ููุง ูุนูู ุฃู ุงููุฑู ูู ุชููููุงุช ุงูููููููู ุงููุฎุชูููู ูู ุฃูู ูู ููุทุฉ ูุงุญุฏุฉ ูู ุฃุตู 5 ุ ููุง ูุดูุฑ ุฅูู ุงูุฅุฌูุงุน ูู ุชููููุงุช ุงูุฌูุงู.  ูููู ุงูููู ุฃู "ุงูุฌูุงู ููุณ ูู ุนูู ุงููุงุธุฑ".  ุนูุฏ ุงููุชูุณุท โโุ ููููู ุงุณุชุฎุฏุงู ุงูุจูุงูุงุช ุจุดูู ููุซูู ูุชุฏุฑูุจ ุงููููุฐุฌ ูุนุฏู ุงูููู ุจุดุฃู ุงูุงุณุชุญุงูุฉ ุงูุฃุณุงุณูุฉ ููุชูููู ุงูุจุฑูุงูุฌู. <br><br>  ููุน ุฐูู ุ ุนูู ุงูุฑุบู ูู ุงููููุฉ ุงูุถุฆููุฉ ููุงูุญุฑุงู ุงููุนูุงุฑู ููุชูุฏูุฑ ุ ูููู ุฃู ูููู ุฑุฃู ุจุนุถ ุงููููููู ูุฎุชูููุง ุชูุงููุง ุนู ุงูุฑุฃู "ุงูุนุงุฏู".  ุฏุนููุง ูุจูู ุชูุฒูุน ุงููุฑู ุจูู ุงูุชูุฏูุฑ ูุงููุณุท: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">R2=ratingDS.join(ratingDS.groupby(<span class="hljs-string"><span class="hljs-string">'Filename'</span></span>)[<span class="hljs-string"><span class="hljs-string">'Rating'</span></span>].median(), on=<span class="hljs-string"><span class="hljs-string">'Filename'</span></span>, how=<span class="hljs-string"><span class="hljs-string">'inner'</span></span>,rsuffix =<span class="hljs-string"><span class="hljs-string">' median'</span></span>) R2[<span class="hljs-string"><span class="hljs-string">'ratingdiff'</span></span>]=(R2[<span class="hljs-string"><span class="hljs-string">'Rating median'</span></span>]-R2[<span class="hljs-string"><span class="hljs-string">'Rating'</span></span>]).astype(int) print(set(R2[<span class="hljs-string"><span class="hljs-string">'ratingdiff'</span></span>])) R2[<span class="hljs-string"><span class="hljs-string">'ratingdiff'</span></span>].hist(label=<span class="hljs-string"><span class="hljs-string">'difference of raings'</span></span>,bins=[<span class="hljs-number"><span class="hljs-number">-3.5</span></span>,<span class="hljs-number"><span class="hljs-number">-2.5</span></span>,<span class="hljs-number"><span class="hljs-number">-1.5</span></span>,<span class="hljs-number"><span class="hljs-number">-0.5</span></span>,<span class="hljs-number"><span class="hljs-number">0.5</span></span>,<span class="hljs-number"><span class="hljs-number">1.5</span></span>,<span class="hljs-number"><span class="hljs-number">2.5</span></span>,<span class="hljs-number"><span class="hljs-number">3.5</span></span>,<span class="hljs-number"><span class="hljs-number">4.5</span></span>],grid=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>,rwidth=<span class="hljs-number"><span class="hljs-number">0.5</span></span>)</code> </pre><br><img src="https://habrastorage.org/webt/ww/qb/7w/wwqb7wdyk_neg_semros1qthb_g.png" alt="ุตูุฑุฉ"><br><br>  ุชู ุงูุนุซูุฑ ุนูู ููุท ูุซูุฑ ููุงูุชูุงู.  ุงูุฃุดุฎุงุต ุงูุฐูู ุชุฎุชูู ุฏุฑุฌุงุชูู ุนู ุงููุณูุท ุจุฃูุซุฑ ูู ููุทุฉ ูุงุญุฏุฉ <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">len(R2[R2[<span class="hljs-string"><span class="hljs-string">'ratingdiff'</span></span>].abs()&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>])/len(R2)</code> </pre><br>  +0.029433333333333332 <br>  ุฃูู ูู 3 ูช.  ููุฐุง ูู ุ ูุฃูุฏ ุงูุฅุฌูุงุน ุถุฑุจ ูุฑุฉ ุฃุฎุฑู ูู ูุณุงุฆู ุชูููู ุงูุฌูุงู. <br>  ุฅูุดุงุก ุฌุฏูู ูุน ูุชูุณุท โโุงูุชุตูููุงุช ุงููุงุฒูุฉ <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">Answer=ratingDS.groupby(<span class="hljs-string"><span class="hljs-string">'Filename'</span></span>).mean()[<span class="hljs-string"><span class="hljs-string">'Rating'</span></span>]</code> </pre><br>  ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง ุตุบูุฑุฉ ุ  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุญุชูู ุฌููุน ุงูุตูุฑ ุนูู ุตูุฑ ูุงููุฉ ุงููุฌู ูู ุงูุบุงูุจ ุ ูุฃูุฏ ุงูุญุตูู ุนูู ูุชูุฌุฉ ููุซูู ุจูุง ูุฃู ููุถุน ูููุฌู.  ูุญู ุงููุดููุงุช ุงููุชุนููุฉ ุจูููุฉ ุตุบูุฑุฉ ูู ุงูุจูุงูุงุช ุ ุบุงูุจูุง ูุง ูุชู ุงุณุชุฎุฏุงู ุชูููุฉ ุชุนูู ุงูููู - ุงุณุชุฎุฏุงู ููุงุฐุฌ ุชู ุชุฏุฑูุจูุง ูุณุจููุง ุนูู ููุงู ููุงุซูุฉ ูุชุนุฏูููุง.  ุจุงููุฑุจ ูู ูููุชู ูู ูููุฉ ุงูุชุนุฑู ุนูู ุงููุฌูู.  ูุนุงุฏุฉ ูุง ูุชู ุญููุง ุจุทุฑููุฉ ุซูุงุซูุฉ ุงููุฑุงุญู. <br><br>  1. ููุงู ูุดู ูููุฌู ุนูู ุงูุตูุฑุฉ ูุชุญุฌูููุง. <br><br>  2. ุจุงุณุชุฎุฏุงู ุดุจูุฉ ุนุตุจูุฉ ุชูุงููููุฉ ุ ูุชู ุชุญููู ุตูุฑุฉ ุงููุฌู ุฅูู ูุชุฌู ููููุฒุงุช ุ ูุฎุตุงุฆุต ูุซู ูุฐุง ุงูุชุญูู ุชุฌุนู ุงูุชุญูู ุซุงุจุชูุง ูููุง ูุชุนูู ุจุชุฏููุฑ ุงููุฌู ูุงูุชุบููุฑ ูู ุชุตูููุฉ ุงูุดุนุฑ.  ูุธุงูุฑ ุงูุนูุงุทู ูุฃู ุตูุฑ ูุคูุชุฉ.  ุชุนูู ูุซู ูุฐู ุงูุดุจูุฉ ูู ูููุฉ ูุซูุฑุฉ ูู ุญุฏ ุฐุงุชูุง ุ ูุงูุชู ูููู ูุชุงุจุชูุง ููุชุฑุฉ ุทูููุฉ.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุชุธูุฑ ุชุทูุฑุงุช ุฌุฏูุฏุฉ ุจุงุณุชูุฑุงุฑ ูุชุญุณูู ูุฐุง ุงูุชุญููู ูุชุญุณูู ุฎูุงุฑุฒููุงุช ุงูุชุนูุจ ุงูุดุงูู ูุงูุชุนุฑู.  ููู ุชุญุณู ููุงู ูู ุจููุฉ ุงูุดุจูุฉ ูุทุฑููุฉ ุงูุชุฏุฑูุจ (ุนูู ุณุจูู ุงููุซุงู ุ ุงูุฎุณุงุฑุฉ ุงูุซูุงุซูุฉ - ููุฏุงู ูุงุฌูุฉ ุงูุณุทุญ). <br><br>  3. ููุงุฑูุฉ ูุชุฌู ุงูููุฒุฉ ูุน ุชูู ุงููุฎุฒูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช. <br><br>  ููููุชูุง ุ ุงุณุชุฎุฏูุช ุญููู ุฌุงูุฒุฉ ูู 1-2 ููุงุท.  ูุชู ุญู ูููุฉ ุงูุชุดุงู ุงููุฌูู ุนููููุง ุจุนุฏุฉ ุทุฑู ุ ุนูุงูุฉ ุนูู ุฐูู ุ ูุญุชูู ุฃู ุฌูุงุฒ ูุญููู ุชูุฑูุจูุง ุนูู ูุงุดูุงุช ูููุฌู (ุนูู Android ุ ููู ุฌุฒุก ูู ุญุฒูุฉ ุฎุฏูุงุช GooglePlay ุงูููุงุณูุฉ) ุ ูุงูุชู ุชุณุชุฎุฏู ููุชุฑููุฒ ุนูู ุงููุฌูู ุนูุฏ ุงูุชุตููุฑ.  ุฃูุง ุจุงููุณุจุฉ ูุชุฑุฌูุฉ ุงูุฃุดุฎุงุต ุฅูู ุดูู ูุชุฌู ุ ูููุงู ููุทุฉ ุฎููุฉ ุบูุฑ ูุงุถุญุฉ.  ุงูุญูููุฉ ูู ุฃู ุงูุนูุงูุงุช.  ุงููุณุชุฎุฑุฌุฉ ูู ุฃุฌู ุญู ูุดููุฉ ุงูุงุนุชุฑุงู - ูู ุณูุฉ ููุดุฎุต ุ ููููุง ูุฏ ูุง ุชุฑุชุจุท ูุน ุงูุฌูุงู ุนูู ุงูุฅุทูุงู.  ุฃูุซุฑ ูู ุฐูู.  ูุธุฑูุง ูุฎุตุงุฆุต ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุ ุชููู ูุฐู ุงูุนูุงูุงุช ูุญููุฉ ุจุดูู ุฑุฆูุณู ุ ููููู ุฃู ูุณุจุจ ุฐูู ุนููููุง ุงูุนุฏูุฏ ูู ุงููุดููุงุช (ูุฌูู ุงูุจูุณู ุงููุฑุฏู).  ููุน ุฐูู ุ ููุฏ ูุฌุฏุช ุฃู ุงููุชุงุฆุฌ ุชุนุชูุฏ ุงุนุชูุงุฏูุง ูุจูุฑูุง ุนูู ุงูุจุนุฏ ุงูุฎุงุต ุจุงููุงูู ุ ูุฅุฐุง ูู ุชูู 128 ุนูุงูุฉ ูุงููุฉ ูุชุญุฏูุฏ ุงูุฌูุงู ุ ูุฅู 512 ุนูุงูุฉ ูุงููุฉ.  ุจูุงุกู ุนูู ุฐูู ุ ุชู ุงุฎุชูุงุฑ <a href="https://github.com/shaoanlu/face_toolbox_keras" rel="nofollow">ุดุจูุฉ insightFace ูุนุชูุฏุฉ ุนูู ุฅุนุงุฏุฉ ุงูุถุจุท</a> .  ุณูุณุชุฎุฏู ุฃูุถูุง keras ูุฅุทุงุฑ ููุชุนูู ุงูุขูู. <br>  ูููู ุงูุงุทูุงุน <a href="https://www.kaggle.com/alexanderkhar/face-beauty-ranking-ported-to-android" rel="nofollow">ููุง</a> ุนูู ุฑูุฒ ุชูุตููู ูุชูุฒูู ุงูููุงุฐุฌ ุงููุฏุฑุจุฉ ูุณุจููุง <a href="https://www.kaggle.com/alexanderkhar/face-beauty-ranking-ported-to-android" rel="nofollow">.</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model=LResNet100E_IR()</code> </pre><br>  ุชู ุงุณุชุฎุฏุงู ูุงุดู <a href="https://github.com/ipazc/mtcnn" rel="nofollow">ุงููุฌู mtcnn</a> ููุงุดู ูููุฌู ูููุนุงูุฌุฉ ุงููุณุจูุฉ <a href="https://github.com/ipazc/mtcnn" rel="nofollow">.</a> <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">detector = MtcnnDetector(model_folder=mtcnn_path, ctx=ctx, num_worker=<span class="hljs-number"><span class="hljs-number">1</span></span>, accurate_landmark = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, threshold=det_threshold)</code> </pre><br>  ูุญุงุฐุงุฉ ุงูุตูุฑ ูุชูุทูุนูุง ูุชูุฌูููุง ูู ูุฌููุนุฉ ุงูุจูุงูุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">imgpath=<span class="hljs-string"><span class="hljs-string">'../input/faces-scut/scut-fbp5500_v2/SCUT-FBP5500_v2/Images/'</span></span> <span class="hljs-comment"><span class="hljs-comment">#    facevecs=[] for name in tqdm.tqdm(Answer.index): #   img1 = cv2.imread(imgpath+name) # ,     pre1 = np.moveaxis(get_input(detector,img1),0,-1) #  vec = model.predict(np.stack([pre1])) #   facevecs.append(vec)</span></span></code> </pre><br>  ุณูููู ุจุฅุนุฏุงุฏ ุงูุจูุงูุงุช ุจุชูุณูููุง ุฅูู ุชุฏุฑูุจ (90ูช ูููุง ุ ูุณูุฏุฑุณูุง) ูุงูุชุญูู ูู ุตุญุฉ (ุณูููู ุจูุญุต ุนูู ุงููููุฐุฌ ุนูููุง).  ูุญู ุชุทุจูุน ุงูุจูุงูุงุช ุฅูู ูุฌููุนุฉ ูู 0-1. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">X=np.stack(facevecs)[:,<span class="hljs-number"><span class="hljs-number">0</span></span>,:] Y=(Answer[:])/<span class="hljs-number"><span class="hljs-number">5</span></span> Indicies=np.arange(len(Answer)) X,Y,Indicies=sklearn.utils.shuffle(X,Y,Indicies) Xtrain=X[:int(len(facevecs)*<span class="hljs-number"><span class="hljs-number">0.9</span></span>)] Ytrain=Y[:int(len(facevecs)*<span class="hljs-number"><span class="hljs-number">0.9</span></span>)] Indtrain=Indicies[:int(len(facevecs)*<span class="hljs-number"><span class="hljs-number">0.9</span></span>)] Xval=X[int(len(facevecs)*<span class="hljs-number"><span class="hljs-number">0.9</span></span>):] Yval=Y[int(len(facevecs)*<span class="hljs-number"><span class="hljs-number">0.9</span></span>):] Indval=Indicies[int(len(facevecs)*<span class="hljs-number"><span class="hljs-number">0.9</span></span>):]</code> </pre><br>  ุงูุขู ุฏุนูุง ููุชูู ุฅูู ุงููููุฐุฌ.  ุชุตู ุงูุฌูุงู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Createheadmodel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> inp=keras.layers.Input((<span class="hljs-number"><span class="hljs-number">512</span></span>,)) x=keras.layers.Dense(<span class="hljs-number"><span class="hljs-number">32</span></span>,activation=<span class="hljs-string"><span class="hljs-string">'elu'</span></span>)(inp) x=keras.layers.Dropout(<span class="hljs-number"><span class="hljs-number">0.1</span></span>)(x) out=keras.layers.Dense(<span class="hljs-number"><span class="hljs-number">1</span></span>,activation=<span class="hljs-string"><span class="hljs-string">'hard_sigmoid'</span></span>,use_bias=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>,kernel_initializer=keras.initializers.Ones())(x) model=keras.models.Model(input=inp,output=out) model.layers[<span class="hljs-number"><span class="hljs-number">-1</span></span>].trainable=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span> model.compile(optimizer=keras.optimizers.Adam(lr=<span class="hljs-number"><span class="hljs-number">0.0001</span></span>), loss=<span class="hljs-string"><span class="hljs-string">'mse'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model modelhead=Createheadmodel()</code> </pre><br>  ูุฐุง ุงููููุฐุฌ ุนุจุงุฑุฉ ุนู ุดุจูุฉ ุนุตุจูุฉ ูุชุตูุฉ ูู ุทุจูุฉ ูุงุญุฏุฉ ุชุญุชูู ุนูู 32 ุฎููุฉ ุนุตุจูุฉ ู 512 ุนูุฏุฉ ุฅุฏุฎุงู - ูุงุญุฏุฉ ูู ุฃุจุณุท ุงูุจูู ุ ูุงูุชู ุ ูุน ุฐูู ุ ูุฏุฑุจุฉ ุชุฏุฑูุจุงู ุฌูุฏุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">hist=modelhead.fit(Xtrain,Ytrain, epochs=<span class="hljs-number"><span class="hljs-number">4000</span></span>, batch_size=<span class="hljs-number"><span class="hljs-number">5000</span></span>, validation_data=(Xval,Yval) )</code> </pre><br>  4950/4950 [================================] - 0 ุซุงููุฉ 3us / step - ุฎุณุงุฑุฉ: 0.0069 - val_loss: 0.0071 <br>  ุฏุนููุง ูุจูู ููุญููุงุช ุงูุชุนูู <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.plot(hist.history[<span class="hljs-string"><span class="hljs-string">'loss'</span></span>][<span class="hljs-number"><span class="hljs-number">100</span></span>:], label=<span class="hljs-string"><span class="hljs-string">'loss'</span></span>) plt.plot(hist.history[<span class="hljs-string"><span class="hljs-string">'val_loss'</span></span>][<span class="hljs-number"><span class="hljs-number">100</span></span>:],label=<span class="hljs-string"><span class="hljs-string">'validation_loss'</span></span>) plt.legend(bbox_to_anchor=(<span class="hljs-number"><span class="hljs-number">0.95</span></span>, <span class="hljs-number"><span class="hljs-number">0.95</span></span>), loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>, borderaxespad=<span class="hljs-number"><span class="hljs-number">0.</span></span>)</code> </pre><br>  ูุฑู ุฃู ุงูุฎุณุงุฑุฉ (ูุนูู ุงูุงูุญุฑุงู ุงููุฑุจุนู) ูู 0.0071 ุนูู ุจูุงูุงุช ุงูุชุญูู ุ ูุจุงูุชุงูู ูุฅู ุงูุงูุญุฑุงู ุงููุนูุงุฑู = 0.084 ุฃู 0.42 ููุทุฉ ุนูู ูููุงุณ ูู ุฎูุณ ููุงุท ุ ููู ุฃูู ูู ุงููุฑู ูู ุงูุชูุฏูุฑุงุช ุงูููุฏูุฉ ูู ุงููุงุณ (0.6 ููุทุฉ).  ูููุฐุฌูุง ูุนูู. <br><br>  ูุชุตูุฑ ููููุฉ ุนูู ุงููููุฐุฌ ุ ููููู ุงุณุชุฎุฏุงู ุงููุฎุทุท ุงููุจุนุซุฑ - ููู ุตูุฑุฉ ูู ุจูุงูุงุช ุงูุชุญูู ูู ุงูุตุญุฉ ุ ูููู ุจุจูุงุก ููุทุฉ ุญูุซ ูุชูุงูู ุฃุญุฏ ุงูุฅุญุฏุงุซูุงุช ูุน ูุชูุณุท โโุชูููู ุงููุฌู ูุงูุซุงูู ุฅูู ูุชูุณุท โโุงูุชูููู ุงููุชููุน: <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">Answer2=Answer.to_frame()[:<span class="hljs-number"><span class="hljs-number">5500</span></span>] Answer2[<span class="hljs-string"><span class="hljs-string">'ans'</span></span>]=<span class="hljs-number"><span class="hljs-number">0</span></span> Answer2[<span class="hljs-string"><span class="hljs-string">'race'</span></span>]=Answer2.index Answer2[<span class="hljs-string"><span class="hljs-string">'race'</span></span>]=Answer2[<span class="hljs-string"><span class="hljs-string">'race'</span></span>].apply(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> x: x[:<span class="hljs-number"><span class="hljs-number">2</span></span>]) Answer2[<span class="hljs-string"><span class="hljs-string">'ans'</span></span>]=modelhead.predict(np.stack(facevecs)[:,<span class="hljs-number"><span class="hljs-number">0</span></span>,:])*<span class="hljs-number"><span class="hljs-number">5</span></span> xy=np.array(Answer2.iloc[Indval][[<span class="hljs-string"><span class="hljs-string">'ans'</span></span>,<span class="hljs-string"><span class="hljs-string">'Rating'</span></span>]]) plt.scatter(xy[:,<span class="hljs-number"><span class="hljs-number">1</span></span>],xy[:,<span class="hljs-number"><span class="hljs-number">0</span></span>])</code> </pre><br><img src="https://habrastorage.org/webt/w2/t9/dd/w2t9ddnfyzjpx-xp7q3_wmsubzk.png" alt="ุตูุฑุฉ"><br><br>  ุงููุญูุฑ ุต - ุงูููู ุงูุชู ูุชูุจุฃ ุจูุง ุงููููุฐุฌ ุ ุงููุญูุฑ ุณ - ูุชูุณุท โโููู ุชูุฏูุฑุงุช ุงููุงุณ.  ูุฑู ุนูุงูุฉ ุนุงููุฉ (ุงูุดูู ููุฏูุฏ ุนูู ุทูู ุงููุงุฆู).  ููููู ุฃูุถูุง ุงูุชุญูู ูู ูุชุงุฆุฌูุง ุจุดูู ูุฑุฆู - ุฎุฐ ูุฌูู ูู ูุฆุฉ ูู ุงููุฆุงุช ุจุชููููุงุช ูุชููุนุฉ ูู 1 ุฅูู 5 <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.image <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> mpimg f, axarr = plt.subplots(<span class="hljs-number"><span class="hljs-number">4</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, race <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate([<span class="hljs-string"><span class="hljs-string">'AF'</span></span>,<span class="hljs-string"><span class="hljs-string">'CF'</span></span>, <span class="hljs-string"><span class="hljs-string">"AM"</span></span>, <span class="hljs-string"><span class="hljs-string">'CM'</span></span>]): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rating <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>): <span class="hljs-comment"><span class="hljs-comment">#axarr[i,rating-1].axis('off') axarr[i,rating-1].tick_params(# changes apply to the x-axis which='both', # both major and minor ticks are affected bottom=False, # ticks along the bottom edge are off top=False, # ticks along the top edge are off right=False, left=False, labelbottom=False, labelleft=False ) picname=(Answer2[Answer2['race']==race]['ans']-rating).abs().argmin() axarr[i,rating-1].set_xlabel(Answer2.loc[picname]['ans']) axarr[i,rating-1].imshow(mpimg.imread(imgpath+picname))</span></span></code> </pre><br><img src="https://habrastorage.org/webt/i4/az/pe/i4azpe-biju4pozojrgpiyxkoag.png" alt="ุตูุฑุฉ"><br><br>  ูุฑู ุฃู ุงููุชูุฌุฉ ุจุงููุฑุฒ ุญุณุจ ุงูุฌูุงู ุชุจุฏู ูุนูููุฉ. <br><br>  ุณูููู ุงูุขู ุจุฅูุดุงุก ูููุฐุฌ ูุงูู ููุฏู ููู ูุฌูุงู ููุฅุฏุฎุงู ุ ูุนูุฏ ุงูุฅุฎุฑุงุฌ ูุญุตู ุนูู ุชูููู ูู 0 ุฅูู 1 ููุญููู ุฅูู ุชูุณูู tflite ุงูููุงุณุจ ูููุงุชู <br><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf finmodel=Model(input=model.input, output=modelhead(model.output)) finmodel.save(<span class="hljs-string"><span class="hljs-string">'finmodel.h5'</span></span>) converter = tf.lite.TFLiteConverter.from_keras_model_file(<span class="hljs-string"><span class="hljs-string">'finmodel.h5'</span></span>) converter.optimizations = [tf.lite.Optimize.OPTIMIZE_FOR_SIZE] tflite_quant_model = converter.convert() open (<span class="hljs-string"><span class="hljs-string">"modelquant.tflite"</span></span> , <span class="hljs-string"><span class="hljs-string">"wb"</span></span>).write(tflite_quant_model) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> IPython.display <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> FileLink FileLink(<span class="hljs-string"><span class="hljs-string">r'modelquant.tflite'</span></span>)</code> </pre><br>  ูุชููู ูุฐุง ุงููููุฐุฌ ุตูุฑุฉ ููุฌู ุจุญุฌู 112 * 112 * 3 ุนูุฏ ุงูุฅุฏุฎุงู ุ ููู ุงูุฎุฑุฌ ูุนุทู ุฑูููุง ูุงุญุฏูุง ูู 0 ุฅูู 1 ุ ููุง ูุนูู ุฌูุงู ุงููุฌู (ุนูู ุงูุฑุบู ูู ุฃููุง ูุฌุจ ุฃู ูุชุฐูุฑ ุฃูู ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุ ูู ุชุฎุชูู ุงูุชุตูููุงุช ูู 0 ุฅูู 5 ุ ูููู ูู 1 ุฅูู 5). <br><br><h2 style=";text-align:right;direction:rtl">  ุงูุฌุฒุก 2. ุฌุงูุง </h2><br>  ุฏุนูุง ูุญุงูู ูุชุงุจุฉ ุชุทุจูู ุจุณูุท ููุงุชู Android.  ูุบุฉ Java ุฌุฏูุฏุฉ ุจุงููุณุจุฉ ูู ุ ููู ุฃุดุงุฑู ูุทูููุง ูู ุชุทููุฑ ูุธุงู Android ุ ูุจุงูุชุงูู ุ ูุฅู ุงููุดุฑูุน ูุง ูุณุชุฎุฏู ุชุญุณูู ุงูุนูู ุ ููุง ูุณุชุฎุฏู ุงูุชุญูู ูู ุงูุชุฏูู ูุฃุดูุงุก ุฃุฎุฑู ูุซููุฉ ุงูุนูุงูุฉ ูููุจุชุฏุฆูู.  ูุธุฑูุง ูุฃู java code ุฃูุฑ ูุฑูู ุฅูู ุญุฏ ูุง ุ ูุณุฃูุฏู ููุง ุฃูู ุงูุนูุงุตุฑ ุงูุชู ูุนูู ุนูููุง ุงูุจุฑูุงูุฌ.  ุฑูุฒ ุงูุชุทุจูู ุงููุงูู ูุชุงุญ <a href="https://github.com/Alexankharin/HowCuteAmI" rel="nofollow">ููุง</a> .  ููุชุญ ุงูุชุทุจูู ุตูุฑุฉ ูููุชุดู ููููู ูุฌููุง ุจุงุณุชุฎุฏุงู ุดุจูุฉ ูุญููุธุฉ ูุณุจููุง ููุนุฑุถ ุงููุชูุฌุฉ: <br><br><img src="https://habrastorage.org/webt/7s/si/a-/7ssia-98n-lxqpitskjaudyohpc.png" alt="ุตูุฑุฉ"><br><br>  ูู ูุฌูุฉ ูุธุฑ ุงูุชุทููุฑ ุ ุชุนุชุจุฑ ุงููุธุงุฆู ุงูุชุงููุฉ ูููุฉ ูู ุฐูู. <br><br>  1. ูุธููุฉ ุชุญููู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูู ููู model.tflite ูู ูุฌูุฏ ุงูุฃุตูู ุฅูู ูุงุฆู ูุชุฑุฌู <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.tensorflow.lite.Interpreter; Interpreter interpreter; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { interpreter=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Interpreter(loadModelFile(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); Log.e(<span class="hljs-string"><span class="hljs-string">"TIME"</span></span>, <span class="hljs-string"><span class="hljs-string">"Interpreter_started "</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { e.printStackTrace(); Log.e(<span class="hljs-string"><span class="hljs-string">"TIME"</span></span>, <span class="hljs-string"><span class="hljs-string">"Interpreter NOT started "</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> MappedByteBuffer </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadModelFile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Activity activity)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ AssetFileDescriptor fileDescriptor = activity.getAssets().openFd(<span class="hljs-string"><span class="hljs-string">"model.tflite"</span></span>); FileInputStream inputStream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(fileDescriptor.getFileDescriptor()); FileChannel fileChannel = inputStream.getChannel(); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> startOffset = fileDescriptor.getStartOffset(); <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> declaredLength = fileDescriptor.getDeclaredLength(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> fileChannel.map(FileChannel.MapMode.READ_ONLY, startOffset, declaredLength); }</code> </pre><br>  2. ุงููุดู ุนู ุงููุฌูู ุจุงุณุชุฎุฏุงู ูุญุฏุฉ FaceDetector ุ ุงูุชู ุชุนุฏ ุฌุฒุกูุง ูู ุญุฒูุฉ ุงูููุชุจุฉ ุงูููุงุณูุฉ ูู google ุ ุจุงุณุชุฎุฏุงู ุดุจูุฉ ุนุตุจูุฉ ูุนุฑุถ ุงููุชุงุฆุฌ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.android.gms.vision.face.Face; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.android.gms.vision.face.FaceDetector; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">detectFace</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{ <span class="hljs-comment"><span class="hljs-comment">//Create a Paint object for drawing with Paint myRectPaint = new Paint(); myRectPaint.setStrokeWidth(5); myRectPaint.setColor(Color.GREEN); myRectPaint.setStyle(Paint.Style.STROKE); Paint fontPaint = new Paint(); fontPaint.setStrokeWidth(3); fontPaint.setTextSize(70); fontPaint.setColor(Color.BLUE); fontPaint.setStyle(Paint.Style.FILL_AND_STROKE); //Create a Canvas object for drawing on tempBitmap = Bitmap.createBitmap(myBitmap.getWidth(), myBitmap.getHeight(), Bitmap.Config.RGB_565); Canvas tempCanvas = new Canvas(tempBitmap); tempCanvas.drawBitmap(myBitmap, 0, 0, null); //Detect the Faces FaceDetector faceDetector = new FaceDetector.Builder(getApplicationContext()).build(); Frame frame = new Frame.Builder().setBitmap(myBitmap).build(); SparseArray&lt;Face&gt; faces = faceDetector.detect(frame); Face face; float[][] labelProbArray = new float[1][1]; imgData.order(ByteOrder.nativeOrder()); //Draw Rectangles on the Faces if (faces.size()&gt;0){ for (int i = 0; i &lt; faces.size(); i++) { face = faces.valueAt(i); isFaceFound=true; float x1 = Math.max(face.getPosition().x,0); float y1 = Math.max(face.getPosition().y,0); float x2 = Math.min(x1 + face.getWidth(),frame.getBitmap().getWidth()); float y2 = Math.min(y1 + face.getHeight(),frame.getBitmap().getHeight()); Bitmap tempbitmap2 = Bitmap.createBitmap(tempBitmap, (int)x1, (int)y1, (int) (x2-x1), (int) (y2-y1)); tempbitmap2 = Bitmap.createScaledBitmap(tempbitmap2, 112, 112, true); convertBitmapToByteBuffer(tempbitmap2); interpreter.run(imgData, labelProbArray); String textToShow = String.format("%.1f", (Answer[0][0]*5-1)/4 * 10); textToShow = textToShow + "/10"; int width= tempCanvas.getWidth(); //int height=tempCanvas.getHeight(); int fontsize=Math.max(width/20,imgView.getWidth()/20); fontPaint.setTextSize(fontsize); tempCanvas.drawText(textToShow, x1, y1-10, fontPaint); tempCanvas.drawRoundRect(new RectF(x1, y1, x2, y2), 2, 2, myRectPaint) } imgView.setImageDrawable(new BitmapDrawable(getResources(),tempBitmap)); } }</span></span></code> </pre><br>  ุฅุฐุง ููุช ุชุฑุบุจ ูู ุงููุนุจ ุจุงุณุชุฎุฏุงู ุงูุชูุฏูุฑ ุนูู ูุงุชูู ุ ูููููู ุชูุฒูู <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.beautyfromphoto.androidfacedetection" rel="nofollow">ุงูุชุทุจูู ูู ุณูู GooglePlay</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar485858/">https://habr.com/ru/post/ar485858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar485846/index.html">ูุฏูุฉ ููุฌูุชุณู ู SUSE ุงููุดุชุฑูุฉ: "ุญููู ููุชูุญุฉ ูููุซููุฉ ููุนุตุฑ ุงูุฑููู"</a></li>
<li><a href="../ar485850/index.html">ููู ุชู ุงุฎุชูุงุฑ Clickhouse ูู Galaxy Solar</a></li>
<li><a href="../ar485852/index.html">10 ุฃุณุจุงุจ ูุนุฏู ุทูุจ ูุฑุงุฌุนุฉ ูุชุฌุฑ ุนูู ุงูุงูุชุฑูุช</a></li>
<li><a href="../ar485854/index.html">ูุณุงุนุฏุฉ ุงููุญูู ุงูุจุฑูุฌู C ++ ูู ุญู overloading ุงูุฏุงูุฉ</a></li>
<li><a href="../ar485856/index.html">ููู ุทุจุนูุง hexapod ููุงุฐุง ุฌุงุก ููู</a></li>
<li><a href="../ar485862/index.html">DDoS ูู ุตุงูุน ุงููููุฉ</a></li>
<li><a href="../ar485866/index.html">ุงูุชูุงูู ุฒููุจุฑุง ููุชูุญ ุงููุตุฏุฑ ูุน ุจูุงุจุฉ ุงููุคุณุณุฉ</a></li>
<li><a href="../ar485868/index.html">ุฅุถุงุกุฉ ูููุตูู ุงูุฏุฑุงุณูุฉ ูุงููุตูู ุงูุฏุฑุงุณูุฉ</a></li>
<li><a href="../ar485870/index.html">ูู ููุฌุฏ GameDev ูู ุณุฎุงูููุ 2.V</a></li>
<li><a href="../ar485872/index.html">ูุถุบ ุงูุงูุญุฏุงุฑ ุงูููุฌุณุชู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>