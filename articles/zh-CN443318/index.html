<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍❤️‍👨 💄 ♏️ 为Ghidra编写wasm加载程序。 第1部分：问题陈述和设置环境 ✊ 🧘🏿 🐐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本周，国家安全局（NSA）突然向人类献出了礼物，为其软件逆向工程框架开放了资源。 热情洋溢的逆向工程师和安全专家社区开始探索新玩具。 根据反馈，这确实是一个了不起的工具，能够与IDA Pro，R2和JEB等现有解决方案竞争。 该工具称为Ghidra，专业资源充满了研究人员的印象。 实际上，它们有一个...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>为Ghidra编写wasm加载程序。 第1部分：问题陈述和设置环境</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443318/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/xy/1q/jm/xy1qjmpn0nactzdrq1laun9brhm.png"></div><br> 本周，国家安全局（NSA）突然向人类献出了礼物，为其软件逆向工程框架开放了资源。 热情洋溢的逆向工程师和安全专家社区开始探索新玩具。 根据反馈，这确实是一个了不起的工具，能够与IDA Pro，R2和JEB等现有解决方案竞争。 该工具称为Ghidra，专业资源充满了研究人员的印象。 实际上，它们有一个很好的理由：并非每天都有政府组织提供对其内部工具的访问。 作为专业的逆向工程师和恶意软件分析师，我自己也无法幸免。 我决定花一个或两个周末来获得该工具的第一印象。 我玩了一些反汇编，并决定检查该工具的可扩展性。 在本系列文章中，我将解释Ghidra加载项的开发，该加载项加载了用于解决CTF任务的自定义格式。 由于它是一个大型框架，因此我选择了非常复杂的任务，因此将本文分为几个部分。 <br><br> 在本部分的最后，我希望设置开发环境并构建最小的模块，该模块将能够识别WebAssembly文件的格式并提出合适的反汇编程序进行处理。 <br><a name="habracut"></a><br> 让我们从任务描述开始。 去年，安全公司FireEye举办了名为flare-on的CTF竞赛。 在竞赛中，研究人员必须解决与逆向工程有关的十二项任务。 任务之一是研究使用WebAssembly构建的Web应用程序。 这是一种相对较新的可执行文件格式，据我所知，没有完美的工具来处理它。 在挑战期间，我尝试了多种工具来击败它。 这些是来自github的简单脚本以及知名的反编译器，例如IDA pro和JEB。 令人惊讶的是，我停止使用chrome，后者为WebAssembly提供了非常好的反汇编程序和调试器。 我的目标是解决与ghidra的挑战。 我将尽可能全面地描述这项研究，并提供所有可能的信息来重现我的步骤。 也许，作为一个没有太多乐器经验的人，我可能会讲一些不必要的细节，但事实就是如此。 <br><br> 我要用于学习的任务可以从flareon5挑战<a href="">网站</a>下载。 有文件05_web2point0.7z：归档文件已加密，带有<b>被感染</b>的可怕单词。 存档中有三个文件：index.html，main.js和test.wasm。 让我们在浏览器中打开文件index.html并检查结果： <br><br><img src="https://habrastorage.org/webt/5z/o2/fd/5zo2fdf7jjndo2tmhesju4go7io.png"><br><br> 好吧，这就是我要处理的。 让我们从html学习开始，尤其是因为它是挑战中最容易的部分。  html代码除加载main.js脚本外不包含任何内容。 <br><br><pre><code class="javascript hljs">&lt;!DOCTYPE html&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"./main.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br> 该脚本看起来也很冗长，但是它并没有做任何复杂的事情。 它只是加载文件test.wasm并使用它来创建WebAssembly实例。 然后，它从url中读取参数“ q”，并将其传递给方法match，由实例导出。 如果参数中的字符串不正确，则脚本将显示我们在FireEye开发人员称为“ Poo of poo”的图像。 <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Uint8Array</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TextEncoder().encode(getParameterByName(<span class="hljs-string"><span class="hljs-string">"q"</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pa = wasm_alloc(instance, <span class="hljs-number"><span class="hljs-number">0x200</span></span>); wasm_write(instance, pa, a); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pb = wasm_alloc(instance, <span class="hljs-number"><span class="hljs-number">0x200</span></span>); wasm_write(instance, pb, b); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (instance.exports.Match(pa, a.byteLength, pb, b.byteLength) == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// PARTY POPPER document.getElementById("container").innerText = "ðŸŽ‰"; } else { // PILE OF POO document.getElementById("container").innerText = "ðŸ'"; }</span></span></code> </pre><br> 该任务的解决方案是找到使函数“ match”返回“ True”的参数q的值。 为此，我将反汇编文件test.wasm并分析功能Match的算法。 <br><br> 毫不奇怪，我将尽力在Ghidra中做到这一点。 但是首先我必须安装它。 可以（并且应该）从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://ghidra-sre.org/</a>下载安装。 由于它是用Java编写的，因此几乎没有安装的特殊要求，也不需要进行任何特殊的安装。 您所需要做的只是解压缩归档文件并运行应用程序。 唯一需要做的就是将JDK和JRE更新到版本11。 <br><br> 让我们创建一个新的ghidra项目（ <b>File-&gt; New Project</b> ），并将其命名为“ wasm” / <br><br><img src="https://habrastorage.org/webt/yt/1j/2s/yt1j2sgpytbsoyhsschjdit4v7m.png"><br><br> 然后添加文件test.wasm（ <b>File→Import file</b> ）到项目中，看看ghidra如何处理它 <br><br><img src="https://habrastorage.org/webt/up/wq/jq/upwqjqan-5cooznznqw5pcks-pw.png"><br><br> 好吧，它什么也做不了。 它不能识别格式，也不能反汇编任何内容，因此处理此任务绝对无能为力。 最后，我们讨论了本文的主题。 没什么可做的，只是编写一个模块，该模块能够加载wasm文件，对其进行分析并反汇编其代码。 <br><br> 首先，我研究了所有可用的文档。 实际上，只有一个合适的文档显示了附件开发的过程：幻灯片GhidraAdvancedDevelopment。 我将按照该文档进行逐项介绍。 <br><br> 不幸的是，附加组件开发需要使用Eclipse。 我在eclipse方面的所有经验是在2012年为Android开发了两款gdx游戏。经历了两个星期的痛苦和磨难，之后我将其从脑中抹去了。 希望经过7年的发展，它比以前更好。 <br><br> 让我们从官方<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">网站</a>下载并安装Eclipse。 <br><br> 然后，为ghidra开发安装扩展程序： <br><br> 转到eclipse <b>帮助→安装新软件</b>菜单，单击<b>添加</b>按钮，然后从/扩展名/ Eclipse / GhidraDev /中选择GhidraDev.zip。 安装它并重新启动扩展。 该扩展将模板添加到新的项目菜单中，允许从eclipse调试模块并将模块编译到分发包。 <br><br> 正如开发人员文档所述，必须执行以下步骤来添加用于处理新二进制格式的模块： <br><br><ul><li> 创建类，描述数据结构 </li><li> 开发加载器。 加载程序应继承自<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AbstractLibrarySupportLoader</a>类。 它从文件中读取所有必要的数据，检查数据的完整性，并将二进制数据转换为内部表示形式，以准备进行分析 <br></li><li> 开发分析仪。  Analyzer继承自<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AbstractAnalyzer</a>类。 它采用加载程序准备的数据结构并对其进行注释（我不确定这是什么意思，但是我希望在开发过程中能够理解） <br></li><li> 添加处理器。  Ghidra有一个抽象：处理器。 它用内部声明性语言编写，并描述了指令集，内存布局和其他体系结构功能。 我将讨论这个主题，编写反汇编程序。 <br></li></ul><br> 现在，当我们掌握了所有必要的理论后，就该创建模块项目了。 感谢先前安装的Eclipse扩展GhidraDev，我们在<b>File-&gt; New project</b>菜单中有了模块模板。 <br><br><img src="https://habrastorage.org/webt/ir/z3/77/irz377yf_rcsginnfb-e8-ee-ga.png"><br><br> 向导询问需要哪些组件。 如前所述，我们将需要两个：加载器和分析器。 <br><br><img src="https://habrastorage.org/webt/vf/cc/j1/vfccj1djknkxefjuc1bg9pysycs.png"><br><br> 向导将创建包含所有必要部分的项目框架：文件WasmAnalyzer.java中的空白分析器，文件WasmLoader.java中的空白加载器以及目录/数据/语言中的语言框架。 <br><br><img src="https://habrastorage.org/webt/bu/3q/uw/bu3quwuupe-0heogbta81hrub7c.png"><br><br> 让我们从加载器开始。 如前所述，它应该从AbstractLibrarySupportLoader类继承，并具有三种要重载的方法： <br><br><ul><li>  getName-此方法应为加载程序的内部名称。  Ghidra在各种地方使用它，例如，将加载程序绑定到处理器 </li><li>  findSupportedLoadSpecs-回调，在用户选择要导入的文件时执行。 在此回调加载程序中，应确定它是否能够处理文件并返回LoadSpec类的实例，告诉用户如何处理文件。 </li><li>  load-用户加载文件后执行的回调。 在这种方法中，加载器解析文件结构并将其加载到Ghidra中。 将在下一篇文章中更详细地描述它 </li></ul><br> 第一个也是最简单的方法是getName，它只是返回加载程序的名称 <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"WebAssembly"</span></span>; }</code> </pre><br> 第二种实现方法是findSupportedLoadSpecs。 它是在导入文件时由工具调用的，应验证加载程序是否能够处理该文件。 如果有能力的方法返回<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">LoadSpec</a>类的对象，则告诉使用哪个对象加载文件以及哪个处理器将反汇编其代码。 <br><br> 方法从格式验证开始。 根据<a href="">规范</a> ，wasm文件的前八个字节应为签名“ \ 0asm”和版本。 <br><br> 为了解析标头，我创建了类WasmHeader，实现了接口<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">StructConverter</a> ，该接口是描述结构化数据的基础接口。  WasmHeader的构造函数接收对象<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BinaryReader-</a>抽象，用于从正在分析的二进制源中读取数据。 构造函数使用它来读取输入文件的头 <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] magic; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> [] version; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WasmHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ magic = reader.readNextByteArray(WASM_MAGIC_BASE.length()); version = reader.readNextByteArray(WASM_VERSION_LENGTH); }</code> </pre><br> 加载程序使用此对象来验证文件的签名。 然后，如果成功，则搜索适当的处理器。 它调用类<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">QueryOpinionService的</a>方法查询，并将其传递给加载程序的名称（“ Webassembly”）。  OpinionService正在寻找与此加载程序关联的处理器，并将其返回。 <br><br><pre> <code class="java hljs">List&lt;QueryResult&gt; queries = QueryOpinionService.query(getName(), MACHINE, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>);</code> </pre><br> 当然，它什么也不会返回，因为ghidra不知道称为WebAssembly的处理器，因此需要对其进行定义。 如前所述，向导在目录数据/语言中创建了语言框架。 <br><br><img src="https://habrastorage.org/webt/ck/hq/0d/ckhq0d4gena4dbalhjufpwv9kbs.png"><br><br> 在当前阶段，有两个可能有趣的文件：Webassembly.opinion和Wbassembly.ldefs。 文件.opinon设置加载程序和处理器之间的对应关系。 <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">opinions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">loader</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"WebAssembly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">compilerSpecID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">primary</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">opinions</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br> 它包含具有少量属性的简单xml。 需要将加载程序的名称设置为属性“ loader”，将处理器的名称设置为属性“ processor”，两者均为“ Webassembly”。 在此步骤中，我将使用随机值填充其他参数。 一旦我对Webassembly处理器架构师有了更多的了解，就将其更改为正确的值。 <br><br> 文件.ldefs描述了处理器的功能，这些功能应从文件中执行代码。 <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language_definitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">endian</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"little"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">variant</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">slafile</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly.sla"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorspec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly.pspec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wasm:LE:16:default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Webassembly Language Module<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">compiler</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">spec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly.cspec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language_definitions</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br> 属性“处理器”应与文件.opinion中的属性处理器相同。 让我们保持其他领域不变。 但是请记住，下次可以设置注册表的位数（属性“大小”），描述处理器“ processorspec”体系结构的文件和包含特殊声明性语言“ slafile”的代码描述的文件。 进行拆卸工作会很方便。 <br><br> 现在，该回到加载程序并返回加载程序的规范了。 <br><br> 一切准备就绪，可以进行测试了。  GhidraDev插件在运行时添加了运行选项“ <b>Run→Run As→Ghidra</b> ”： <br><br><img src="https://habrastorage.org/webt/j5/z-/ft/j5z-ft7xxiy1equy99ahzrt6d7a.png"><br><br> 它在调试模式下运行ghidra并在其中部署模块，这为使用该工具提供了绝佳的机会，同时使用调试器修复了正在开发的模块中的错误。 但是在这个简单的阶段，没有理由使用调试器。 和以前一样，我将创建一个新项目，导入文件，并查看我的努力是否成功。 与上次不同，该文件被识别为WebAssembly，并且加载程序为其建议相应的处理器。 这意味着一切正常，并且我的模块能够识别格式。 <br><br><img src="https://habrastorage.org/webt/zs/np/vd/zsnpvdvzqx5ecg7xdlz86dzres0.png"><br><br> 在下一篇文章中，我将扩展加载器，使其不仅可以识别，而且可以描述wasm文件的结构。 我认为在此阶段，设置环境之后，这将很容易做到。 <br><br> 该模块的代码可在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github</a>仓库中找到。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN443318/">https://habr.com/ru/post/zh-CN443318/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN443308/index.html">现代物理学的神话。 养护法</a></li>
<li><a href="../zh-CN443310/index.html">Bellabeat妇女健康小工具评论</a></li>
<li><a href="../zh-CN443312/index.html">Python内存管理</a></li>
<li><a href="../zh-CN443314/index.html">什么是耐心？ [文章翻译]</a></li>
<li><a href="../zh-CN443316/index.html">ReactJS测试：兔子洞有多深</a></li>
<li><a href="../zh-CN443320/index.html">电子文件管理系统“ Vizier”</a></li>
<li><a href="../zh-CN443322/index.html">GitLab 11.8与SAST一起发布，用于JavaScript，用于子组的GitLab页面和错误跟踪</a></li>
<li><a href="../zh-CN443324/index.html">Python vs. 适用于Apache Spark的Scala-预期基准测试具有意外结果</a></li>
<li><a href="../zh-CN443326/index.html">Python和Arduino。 简单，快速，美观</a></li>
<li><a href="../zh-CN443330/index.html">安全周11：RSA 2019和更光明的未来</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>