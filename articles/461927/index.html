<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßëüèø‚Äçü§ù‚ÄçüßëüèΩ üßë‚Äçü§ù‚Äçüßë ü§ú Aprendizaje de clasificaci√≥n activa üòµ üôèüèø üéóÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Con esta publicaci√≥n, estoy abriendo una serie en la que mis colegas y yo les contaremos c√≥mo se usa ML en Mail.ru Search. Hoy explicar√© c√≥mo se organ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aprendizaje de clasificaci√≥n activa</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/461927/">  Con esta publicaci√≥n, estoy abriendo una serie en la que mis colegas y yo les contaremos c√≥mo se usa ML en Mail.ru Search.  Hoy explicar√© c√≥mo se organiza la clasificaci√≥n y c√≥mo usamos la informaci√≥n sobre las interacciones de los usuarios con nuestro motor de b√∫squeda para mejorar el motor de b√∫squeda. <br><br><h2>  Tarea de clasificaci√≥n </h2><br>  ¬øQu√© se entiende por tarea de clasificaci√≥n?  Imagine que en la muestra de capacitaci√≥n hay un conjunto de consultas para las cuales se conoce el orden de los documentos por relevancia.  Por ejemplo, usted sabe qu√© documento es el m√°s relevante, cu√°l es el segundo m√°s relevante, etc.  Y necesita restaurar este orden para toda la poblaci√≥n.  Es decir, para todas las solicitudes de la poblaci√≥n en general, el primer lugar es el documento m√°s relevante y el √∫ltimo, el m√°s irrelevante. <br><br>  Veamos c√≥mo se resuelven estos problemas en los grandes motores de b√∫squeda. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7f7/a52/6c3/7f7a526c333c1e49c186b045e8dc86f6.png" width="600"></div><a name="habracut"></a><br>  Tenemos un √≠ndice de b√∫squeda: esta es una base de datos de muchos miles de millones de documentos.  Cuando llega una solicitud, primero generamos una lista de candidatos para la clasificaci√≥n final utilizando modelos de texto simples.  La opci√≥n m√°s f√°cil es recoger documentos que, en principio, contienen palabras de la solicitud.  ¬øPor qu√© es necesario este paso?  El hecho es que es imposible para todos los documentos disponibles construir letreros y formar pron√≥sticos del modelo final.  Despu√©s ya calculamos los signos.  ¬øQu√© signos podemos tomar?  Por ejemplo, el n√∫mero de apariciones de palabras de una consulta en un documento o el n√∫mero de clics en un documento determinado.  Puede usar factores complejos entrenados por la m√°quina: en la B√∫squeda usando redes neuronales, predecimos la relevancia del documento a pedido e insertamos este pron√≥stico con una nueva columna en nuestro espacio de caracter√≠sticas. <br><br>  ¬øPor qu√© estamos haciendo todo esto?  Queremos maximizar las m√©tricas de los usuarios para que los usuarios encuentren los resultados relevantes en nuestros resultados lo m√°s f√°cilmente posible y nos regresen con la mayor frecuencia posible. <br><br>  Nuestro modelo final utiliza un conjunto de √°rboles de decisi√≥n construidos mediante el aumento de gradiente.  Hay dos opciones para construir una m√©trica objetivo para el entrenamiento: <br><br><ul><li>  Estamos creando un departamento de asesores, personas especialmente capacitadas a quienes les hacemos consultas y les decimos: "Chicos, eval√∫en qu√© tan relevante es nuestra emisi√≥n".  Ellos responder√°n con n√∫meros que miden la relevancia.  ¬øPor qu√© es malo este enfoque?  En este caso, maximizaremos el modelo con respecto a las opiniones de las personas que no son nuestros usuarios.  No optimizaremos para la m√©trica que realmente queremos optimizar. <br></li><li>  Por esta raz√≥n, utilizamos el segundo enfoque para la variable objetivo: mostramos a los usuarios los resultados, observamos a qu√© documentos pasan, cu√°les se saltan.  Y luego usamos estos datos para entrenar el modelo final. <br></li></ul><br><h2>  ¬øC√≥mo se resuelve el problema de clasificaci√≥n? </h2><br>  Hay tres enfoques para resolver el problema de clasificaci√≥n: <br><br><ul><li>  <b>Puntiagudo</b> , es puntiagudo.  Consideraremos la relevancia como una medida absoluta y ajustaremos el modelo para la diferencia absoluta entre la relevancia predicha y la que conocemos de la muestra de entrenamiento.  Por ejemplo, el asesor le dio al documento una calificaci√≥n de 3, y nosotros dir√≠amos que 2, por lo que ajustamos el modelo por 1. <br></li><li>  <b>En</b> parejas, en parejas.  Compararemos los documentos entre nosotros.  Por ejemplo, en la muestra de capacitaci√≥n hay dos documentos, y sabemos cu√°l es m√°s relevante para esta solicitud.  Luego, ajustaremos el modelo si pone el pron√≥stico m√°s bajo que el menos relevante, es decir, el par est√° mal organizado. <br></li><li>  <b>Listwise</b> .  Tambi√©n se basa en la relevancia relativa, pero no dentro de los pares: clasificamos todo el problema seg√∫n el modelo y evaluamos el resultado; si el documento m√°s relevante no est√° en primer lugar, recibimos una gran multa. <br></li></ul><br>  ¬øQu√© enfoque es mejor usar para nuestra variable objetivo?  Para hacer esto, vale la pena discutir una pregunta importante: "¬øse pueden usar los clics como una medida de la relevancia absoluta de un documento?"  Es imposible, porque dependen de la posici√≥n del documento en el tema.  Despu√©s de recibir el problema, lo m√°s probable es que haga clic en el documento que ser√° m√°s alto, porque le parece que los primeros documentos son m√°s relevantes. <br><br>  ¬øC√≥mo se puede verificar tal hip√≥tesis?  Tomamos dos documentos en la parte superior del problema y los intercambiamos.  Si los clics fueran una medida absoluta de relevancia, su n√∫mero depender√≠a solo del documento en s√≠ y no de la posici√≥n.  Pero esto no es as√≠.  El documento anterior siempre recibe m√°s clics.  Por lo tanto, los clics nunca se pueden usar como una medida de relevancia absoluta.  Por lo tanto, puede usar pairwise o listwise. <br><br><h2>  Recopilamos un conjunto de datos. </h2><br>  Ahora extraemos los datos para el conjunto de entrenamiento.  Tuvimos esta sesi√≥n: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a9e/3c4/81c/a9e3c481c03dfce37e71ffc73485afc3.png" width="200"></div><br>  De los cuatro documentos, hubo un clic en el segundo y cuarto.  Como regla, la gente mira los resultados de arriba a abajo.  Mir√≥ el primer documento, no le gust√≥, hizo clic en el segundo.  Luego volvieron a la b√∫squeda, miraron el tercero e hicieron clic en el cuarto.  Obviamente, te gust√≥ el segundo m√°s que el primero, y el cuarto m√°s que el primero y el tercero.  Estos son los pares que generamos para todas las solicitudes y utilizamos modelos para el entrenamiento. <br><br>  Todo parece estar bien, pero hay un problema: las personas solo hacen clic en los documentos desde la parte superior del problema.  Por lo tanto, si hace la muestra de entrenamiento solo de esta manera, la distribuci√≥n en ella ser√° exactamente la misma que en la muestra de prueba.  Es necesario alinear de alguna manera la distribuci√≥n.  Hacemos esto agregando ejemplos negativos: estos son documentos que estaban en la parte inferior de la clasificaci√≥n, el usuario definitivamente no los vio, pero sabemos que son malos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fc4/a4e/993/fc4a4e993e6c5611ffb36af4385fed7b.png" width="300"></div><br>  Entonces, obtuvimos un esquema para la capacitaci√≥n de clasificaci√≥n: les mostraron a los usuarios los resultados, obtuvieron clics de ellos, agregaron ejemplos negativos para alinear la distribuci√≥n y reentrenaron el modelo de clasificaci√≥n.  Por lo tanto, tenemos en cuenta la reacci√≥n de los usuarios a su clasificaci√≥n actual, tenemos en cuenta los errores y mejoramos la clasificaci√≥n.  Repetimos estos procedimientos muchas veces hasta la convergencia.  Es importante tener en cuenta que buscamos no solo por la web, sino tambi√©n por video, por im√°genes, y el esquema descrito funciona perfectamente en cualquier tipo de b√∫squeda.  Como resultado, las m√©tricas de comportamiento crecen mucho.  En la segunda iteraci√≥n, es ligeramente m√°s peque√±a, en la tercera iteraci√≥n es a√∫n m√°s peque√±a, y como resultado converge a un √≥ptimo local. <br><br>  Pensemos por qu√© convergemos en un √≥ptimo local y no en un √≥ptimo global. <br><br>  Suponga que es un fan√°tico del f√∫tbol y que por la noche no tuvo tiempo de ver el partido de su equipo favorito.  Despierta por la ma√±ana e ingresa el nombre del equipo en la barra de b√∫squeda para averiguar el resultado del partido.  Vea los primeros tres documentos: estas son las p√°ginas oficiales sobre el club, no hay informaci√≥n √∫til.  No hojear√° todo el problema, no recoger√° otra solicitud.  Quiz√°s incluso haga clic en alg√∫n documento irrelevante.  Pero como resultado, se molesta, cierra el SERP y abre otro motor de b√∫squeda. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f2/fdf/388/1f2fdf3881703461703e82dd9881c673.png"><br><br>  Aunque este problema no solo se encuentra en la b√∫squeda, es especialmente relevante aqu√≠.  Imagine una tienda en l√≠nea, que es una gran cinta sin la capacidad de decir qu√© categor√≠a particular de productos desea ver.  Esto es exactamente lo que sucede con los resultados de b√∫squeda: despu√©s de enviar la solicitud, ya no puede explicar lo que realmente necesita: informaci√≥n sobre el equipo de f√∫tbol o el puntaje del √∫ltimo partido. <br><br>  Imagine que un hombre brutal fue a una tienda en l√≠nea tan extra√±a, que consta de una cinta de recomendaciones, y en sus recomendaciones solo ve productos t√≠picamente femeninos.  Tal vez incluso hace clic en un vestido, porque lo usa una chica hermosa.  Enviaremos este clic al conjunto de entrenamiento y decidiremos que al hombre le gusta este vestido m√°s que la esponja.  Cuando regrese a nuestro sistema, ya ver√° algunos vestidos.  Inicialmente, no ten√≠amos productos que fueran v√°lidos para el usuario, por lo que este enfoque no nos permitir√° corregir este error.  Est√°bamos en un √≥ptimo local, en el que la persona pobre ya no puede decirnos que no le gustan ni las esponjas ni los vestidos.  A menudo este problema se llama problema de retroalimentaci√≥n positiva. <br><br><h2>  Mejora adicional </h2><br>  ¬øC√≥mo mejorar un motor de b√∫squeda?  ¬øC√≥mo salir de un √≥ptimo local?  Se deben agregar nuevos factores.  Supongamos que hicimos un factor muy bueno que, previa solicitud con el nombre del equipo de f√∫tbol, ‚Äã‚Äãgenerar√° un documento relevante, es decir, los resultados del √∫ltimo partido.  ¬øCu√°l podr√≠a ser el problema aqu√≠?  Si entrena el modelo en datos antiguos, en datos fuera de l√≠nea, tome el conjunto de datos anterior con clics y agregue este atributo all√≠.  Puede ser relevante, pero no lo ha usado antes en el ranking y, por lo tanto, la gente no hizo clic en aquellos documentos para los que este atributo es bueno.  No se correlaciona con su variable de destino, por lo que simplemente no ser√° utilizada por el modelo. <br><br>  En tales casos, a menudo usamos esta soluci√≥n: omitiendo el modelo final, forzamos a nuestra clasificaci√≥n a usar esta funci√≥n.  Mostramos por la fuerza el resultado del √∫ltimo partido a pedido con el nombre del equipo, y si el usuario hizo clic en √©l, entonces esta es la informaci√≥n que nos permite entender que el letrero es bueno. <br><br>  Veamos un ejemplo.  Recientemente hicimos hermosas fotos para documentos de Instagram: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/229/b9f/da0/229b9fda0570937619fc62b946ff81cb.png"><br><br>  Parece que esas bellas im√°genes deber√≠an satisfacer a nuestros usuarios tanto como sea posible.  Obviamente, tenemos que hacer una se√±al de que el documento tiene esa imagen.  Agregamos al conjunto de datos, reentrenamos el modelo de clasificaci√≥n y vemos c√≥mo se usa esta caracter√≠stica.  Y luego analizamos el cambio en las m√©tricas de comportamiento.  Han mejorado un poco, pero ¬øes esta la mejor soluci√≥n? <br><br>  No, porque para muchas solicitudes no muestra bellas im√°genes.  No le diste al usuario la oportunidad de mostrar c√≥mo le gustan.  Para resolver este problema, para algunas solicitudes que implican mostrar documentos de Instagram, omitiendo por la fuerza el modelo, mostramos bellas im√°genes y observamos si hicieron clic en ellas.  Tan pronto como los usuarios apreciaron la innovaci√≥n, comenzaron a reentrenar el modelo en conjuntos de datos, en los que los usuarios tuvieron la oportunidad de mostrar la importancia de este factor.  Despu√©s de este procedimiento, en un nuevo conjunto de datos, el factor comenz√≥ a usarse muchas veces con m√°s frecuencia y aument√≥ significativamente las m√©tricas del usuario. <br><br><hr><br>  Por lo tanto, examinamos la declaraci√≥n del problema de clasificaci√≥n y discutimos las trampas que le esperar√°n al conocer los comentarios de los usuarios.  Lo principal que debe sacar de este art√≠culo: usando la retroalimentaci√≥n como un objetivo de entrenamiento, recuerde que el usuario puede dejar esta retroalimentaci√≥n solo donde el modelo actual lo permita.  Tal retroalimentaci√≥n puede jugar un truco cuando intente construir un nuevo modelo de aprendizaje autom√°tico. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/461927/">https://habr.com/ru/post/461927/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../461907/index.html">An√°lisis de productos en un estudio de ciclo completo.</a></li>
<li><a href="../461913/index.html">Usabilidad m√≥vil en comercio electr√≥nico: an√°lisis de las tiendas en l√≠nea TOP-20 en Rusia</a></li>
<li><a href="../461919/index.html">Reutilizando formularios en React</a></li>
<li><a href="../461921/index.html">HDMI-LVDS. Desarrollo en TSUMV59 de MStar</a></li>
<li><a href="../461923/index.html">Jornada de Puertas Abiertas de JetBrains en San Petersburgo: video</a></li>
<li><a href="../461929/index.html">Supervisi√≥n y comprobaci√≥n del estado de SSD en Linux</a></li>
<li><a href="../461935/index.html">C√≥mo trabajar con Postgres en Go: pr√°cticas, caracter√≠sticas, matices</a></li>
<li><a href="../461937/index.html">Ley de Parkinson y c√≥mo romperla</a></li>
<li><a href="../461939/index.html">A√±o de aventuras con grafeno-pit√≥n</a></li>
<li><a href="../461941/index.html">Masajearlo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>