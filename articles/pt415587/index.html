<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîÑ ü§ûüèæ üí± StereoPi - nossa pe√ßa de hardware para estudar vis√£o computacional, drones e rob√¥s ü§úüèª üëù üëáüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° pessoal! 

 Hoje, gostaria de falar sobre o nosso novo hardware baseado no Raspberry Pi Compute Module, projetado para estudar a vis√£o computacion...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>StereoPi - nossa pe√ßa de hardware para estudar vis√£o computacional, drones e rob√¥s</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415587/"> Ol√° pessoal! <br><br>  Hoje, gostaria de falar sobre o nosso novo hardware baseado no Raspberry Pi Compute Module, projetado para estudar a vis√£o computacional e instalar em rob√¥s e drones.  Na verdade, esta √© uma c√¢mera est√©reo ‚Äúinteligente‚Äù - suporta trabalhar com duas c√¢meras ao mesmo tempo, tem framboesas reais como ‚Äúcora√ß√£o‚Äù e, mais importante, trabalha com a vers√£o padr√£o do Raspbian. <br>  Aqui est√° a apar√™ncia da solu√ß√£o montada, com duas c√¢meras instaladas e um m√≥dulo Pi Compute. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/370/ff5/1f8/370ff51f81967c680df4581d65c375eb.jpg" alt="imagem"><br><a name="habracut"></a><br>  O dispositivo funciona com a vers√£o de estoque do Raspbian.  Voc√™ s√≥ precisa copiar nosso arquivo dtblob.bin para ativar o suporte √† c√¢mera dupla. <br><br>  Isso significa que voc√™ pode usar os utilit√°rios raspivid, raspistill e outros comuns para trabalhar com imagens e v√≠deos. <br><br>  Para refer√™ncia, o suporte ao modo est√©reo apareceu no Raspbian j√° em 2014, simultaneamente com o lan√ßamento da primeira vers√£o do Raspberry Pi Compute.  Voc√™ pode ver o hist√≥rico do desenvolvimento do suporte est√©reo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no f√≥rum Raspberry.</a> <br><br>  Antes de descrever os detalhes t√©cnicos, deixe-me mostrar alguns exemplos reais de como o dispositivo funciona. <br><br><h2>  1. Captura de imagem </h2><br>  C√≥digo: <br><br><pre><code class="bash hljs">raspistill -3d sbs -w 1280 -h 480 -o 1.jpg</code> </pre> <br>  e voc√™ obt√©m o seguinte: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ba4/fe7/aa8/ba4fe7aa80dbf03a20b095b0eb26440e.jpg" alt="imagem"><br><br>  Voc√™ pode fazer o download da imagem capturada original <a href="">aqui</a> . <br><br><h2>  2. captura de v√≠deo </h2><br>  C√≥digo: <br><br><pre> <code class="bash hljs">raspivid -3d sbs -w 1280 -h 480 -o 1.h264</code> </pre> <br>  e voc√™ obt√©m o seguinte: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/06a/ab8/07b/06aab807bc607b432fe10530b520edcf.gif" alt="imagem"><br><br>  Voc√™ pode baixar o arquivo de v√≠deo original (convertido em mp4) <a href="">neste link</a> . <br><br><h2>  3. Usando Python e OpenCV para criar um mapa de profundidade </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/be0/2eb/c97/be02ebc97ab1f4d43df096d5ff592fa7.png" alt="imagem"><br><br>  Nesse caso, usei um c√≥digo ligeiramente modificado de um projeto 3Dberry anterior ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://github.com/realizator/3dberry-turorial</a> ). <br><br>  Para obter essas fotos e v√≠deos, usamos este par de c√¢meras: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/554/679/759/554679759f32f6ca65f83cef449e80e6.jpg" alt="imagem"><br><br>  Para instala√ß√£o em drones, geralmente usamos grande angular (160 graus), s√£o eles: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/409/7c2/106/4097c210644486f3b5a2131d3c816403.jpg" alt="imagem"><br><br><h2>  Agora um pouco mais sobre o pr√≥prio peda√ßo de ferro </h2><br><iframe width="560" height="315" src="https://www.youtube.com/embed/g-iuJxtXlCA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br><h2>  Detalhes t√©cnicos </h2><br>  Vista frontal: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/580/13e/80c/58013e80c2da1a1b28c4b7aa83cacb55.jpg" alt="imagem"><br><br>  Vista superior: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/544/1e5/7d3/5441e57d310de3b5d632aa790d6a8350.jpg" alt="imagem"><br><br>  <b>Principais recursos:</b> <br>  <b>Dimens√µes:</b> 90x40 mm <br>  <b>C√¢meras:</b> 2 x cabo CSI 15 pistas <br>  <b>GPIO:</b> 40 cl√°ssicos GP de framboesa PI <br>  <b>USB:</b> 2 x USB tipo A, 1 USB nos pinos <br>  <b>Ethernet:</b> RJ45 <br>  <b>Mem√≥ria:</b> Micro SD (para CM3 Lite), para o resto NAND (flash) <br>  <b>Monitor:</b> sa√≠da HDMI <br>  <b>Fonte de alimenta√ß√£o:</b> 5V DC <br>  <b>Framboesas com suporte:</b> M√≥dulo de computa√ß√£o Raspberry Pi 3, Raspberry Pi CM 3 Lite, Raspberry Pi CM 1 <br>  <b>Tipos de c√¢meras suportadas:</b> c√¢mera Raspberry Pi OV5647, c√¢mera Raspberry Pi Sony IMX 219, entrada HDMI (modo √∫nico) <br>  <b>Para firmware NAND:</b> conector MicroUSB <br>  <b>Interruptor de energia:</b> Sim, sim, √© isso.  Chega de plugues MicroUSB para reinicializa√ß√£o el√©trica! <br><br><h2>  Um pouco de hist√≥ria </h2><br>  Em geral, a ideia em si surgiu em 2015.  A primeira vers√£o nasceu no final de 2015.  Algumas pessoas sabem que nossa equipe tem um "modismo" no controle remoto de v√°rios dispositivos mec√¢nicos; portanto, no primeiro lan√ßamento, um chip adicional foi instalado a bordo, o que nos deu 16 sa√≠das PWM - para dire√ß√£o, motores e outras coisas √∫teis. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5a3/ad7/884/5a3ad788455bc78d4758c930812c4ba4.jpg" alt="imagem"><br><br>  Naquela √©poca, havia apenas a primeira vers√£o do m√≥dulo Compute no mercado, a bordo, que era um processador antigo da primeira framboesa.  O peda√ßo de ferro fez um √≥timo trabalho de captura, compacta√ß√£o e streaming de v√≠deo, mas no final, encontramos o processador.  Por exemplo, j√° n√£o era suficiente um fluxo h264 para um piloto e um fluxo RTMP para um servidor ao mesmo tempo.  E para os construtores de rob√¥s, o principal desejo era construir um mapa espacial usando um mapa de profundidade e SLAM - aqui o processador estava completamente ausente. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d0d/d53/b0c/d0dd53b0c2488c0ead858deb9daa9133.jpg" alt="imagem"><br><br>  Aqui voc√™ tem a vers√£o do Compute Module 3. Eles saltaram imediatamente da primeira vers√£o para a terceira, colocando o processador do terceiro Raspberry.  Agora seu poder j√° era suficiente para calcular algo em tempo real. <br><br>  No entanto, as gera√ß√µes pareciam ser compat√≠veis, mas parecia n√£o ser assim.  O fato de o Compute Module 3 ter um mil√≠metro de largura n√£o nos incomodou.  Mas os requisitos nutricionais mudaram seriamente. <br><br>  Al√©m disso, j√° acumulamos coment√°rios sobre os resultados do trabalho com a primeira vers√£o e decidimos lan√ßar uma nova, na qual fizemos todas as altera√ß√µes acumuladas. <br><br><h2>  O que √© corrigido na segunda gera√ß√£o </h2><br>  <b>Adicionado suporte para o M√≥dulo de computa√ß√£o 3</b> <br><br>  Temos um esquema de energia selecion√°vel, portanto, se voc√™ quiser, poder√° trabalhar com a primeira framboesa.  A escolha aqui √© simples: se voc√™ s√≥ precisa transmitir o v√≠deo, a primeira framboesa √© perfeitamente suficiente.  Como um b√¥nus, ele vem com quase tr√™s vezes menos consumo de energia e dissipa√ß√£o de calor.  E voc√™ precisa calcular algo mais s√©rio (alguns v√≠deos ou vis√£o computacional) - coloque o terceiro. <br><br>  <b>M√≥dulo implantado "chips da placa"</b> <br><br>  Na primeira vers√£o, o tipo de conector SoDIMM na placa foi misturado, como resultado, o m√≥dulo do computador recebeu chips "para a m√£e".  No M√≥dulo de computa√ß√£o 1, isso n√£o causou problemas - a porcentagem estava esquentando um pouco e havia gargalo suficiente entre as placas para o resfriamento normal.  Com um terceiro, esse truque n√£o teria rolado, ent√£o "giramos" o conector, o que implicou na reconex√£o de toda a placa do zero. <br><br>  <b>Suporte nativo ao microSD</b> <br><br>  O primeiro m√≥dulo do computador, por padr√£o, possu√≠a um FLASH embutido e n√£o podia funcionar com o microsd.  Tentamos adicionar o MicroSD l√° como uma segunda unidade, mas encontramos um grande problema para apoi√°-lo.  A comunica√ß√£o com os trabalhadores do kernel em um f√≥rum de framboesa mostrou que o problema n√£o √© f√°cil (ao carregar, o m√≥dulo escolhe aleatoriamente NAND ou MicroSD para a inicializa√ß√£o).  Como resultado, na revis√£o atual, fizemos a fia√ß√£o, como no quadro de refer√™ncia de framboesa de refer√™ncia.  Se o Compute Module <b>Lite</b> - sem NAND embutido - trabalhamos com microsd como em framboesas comuns.  Se a vers√£o n√£o for Lite ou o primeiro m√≥dulo, o microsd n√£o estar√° dispon√≠vel. <br><br>  <b>Mova os conectores da c√¢mera para cima e espa√ßados 65 mm</b> <br><br>  Na primeira vers√£o, os conectores foram direcionados ao longo do plano da placa.  Um pouco, mas depois de muitas instala√ß√µes no caso, v√°rios problemas ficaram claros. <br><br><ul><li>  Um loop de uma c√¢mera se destaca dos conectores, o que √© aconselh√°vel n√£o dobrar (especialmente a parte refor√ßada em azul).  Isso estupidamente ocupou espa√ßo desnecess√°rio no caso e impediu a instala√ß√£o. </li><li>  Os conectores estavam muito pr√≥ximos - isso impedia o trabalho com cabos. </li><li>  As c√¢meras do gabinete geralmente ficam em uma base est√©reo de 65 mm e os cabos na placa estavam pr√≥ximos.  Acontece que cada loop tinha que ser dobrado de maneira n√£o natural - quebras, l√°grimas, saindo dos conectores. </li></ul><br>  <b>Removido o chip e mais 16 PWM</b> <br><br>  Depois de analisar muitos projetos recentes, percebemos que esse recurso √© irrelevante.  Na maioria das vezes, o software Raspberries PWM √© suficiente. <br><br>  <b>Adicionado interruptor</b> <br><br>  Aqueles que pelo menos trabalharam um pouco com framboesas entendem do que se trata :-) <br><br>  <b>Adicionado um terceiro USB nos pinos laterais</b> <br><br>  Em nossos projetos de framboesa, geralmente precisamos de dongles USB a bordo.  Se eles estiverem presos nos conectores na placa, temos um m√≥dulo preso para fora.  Tentar usar um cabo de extens√£o USB agrava o problema.  Havia apenas uma op√ß√£o - a fia√ß√£o de solda diretamente nas framboesas.  Os pinos laterais que adicionamos nos permitem fazer um simples cabo de extens√£o e colocar um dongle USB (geralmente WiFi ou 4G) diretamente ao longo da placa, e toda essa economia se encaixa perfeitamente em um estojo compacto. <br><br>  Aqui est√° uma hist√≥ria que eu queria lhe contar hoje.  Agradecemos sua aten√ß√£o e estou pronto para responder a perguntas. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt415587/">https://habr.com/ru/post/pt415587/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt415573/index.html">Otimiza√ß√£o de um modelo para impress√£o 3D usando o software Blender como exemplo</a></li>
<li><a href="../pt415575/index.html">Fun√ß√µes para documentar bancos de dados PostgreSQL. Parte um</a></li>
<li><a href="../pt415577/index.html">Slides do curso "DBMS Technologies and Development"</a></li>
<li><a href="../pt415579/index.html">Aprenda o OpenGL. Li√ß√£o 5.5 - Mapeamento Normal</a></li>
<li><a href="../pt415581/index.html">International fintech - digest: 12 not√≠cias sobre o mais importante do setor</a></li>
<li><a href="../pt415589/index.html">"Um pouco mais sobre PD": empresas de TV dos EUA v√£o parar de vender dados de clientes</a></li>
<li><a href="../pt415591/index.html">Os engenheiros da Apple interceptam o teclado do MacBook Pro</a></li>
<li><a href="../pt415593/index.html">6 anos depois, uma nova vers√£o do lend√°rio CD de distribui√ß√£o de falhas Hiren</a></li>
<li><a href="../pt415595/index.html">M√©todos para aumentar a reten√ß√£o de jogadores usando jogos de slot como exemplo: Parte 1</a></li>
<li><a href="../pt415597/index.html">Postfix - amavisd-new sem host local ou servidor de correio de uma nova maneira</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>