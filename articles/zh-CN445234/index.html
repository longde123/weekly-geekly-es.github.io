<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©â€ğŸ‘©â€ğŸ‘¦ ğŸ‘¨ğŸ¿â€âš–ï¸ ğŸ’‘ ç°åœ¨å°†Pythonå¼‚å¸¸è§†ä¸ºåæ¨¡å¼ ğŸ‘©ğŸ¿â€ğŸš’ ğŸ™ â€¼ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ‰ä»€ä¹ˆä¾‹å¤–ï¼Ÿ é¡¾åæ€ä¹‰ï¼Œå®ƒä»¬æ˜¯åœ¨ç¨‹åºä¸­å‘ç”Ÿå¼‚å¸¸æ—¶å‡ºç°çš„ã€‚ æ‚¨å¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆå¼‚å¸¸æ˜¯ä¸€ç§åæ¨¡å¼ï¼Œå®ƒä»¬ä¸è¾“å…¥æœ‰ä½•å…³ç³»ï¼Ÿ æˆ‘è¯•å›¾å¼„æ¸…æ¥š ï¼Œç°åœ¨æˆ‘æƒ³å’Œä½ ä¸€èµ·è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼Œharazhiteliã€‚ 

 ä¾‹å¤–é—®é¢˜ 
 å¾ˆéš¾å‘ç°æ‚¨æ¯å¤©é¢å¯¹çš„é—®é¢˜ã€‚ ä¹ æƒ¯å’Œç›²ç›®æ€§å°†é”™è¯¯å˜æˆåŠŸèƒ½ï¼Œä½†æ˜¯è®©æˆ‘ä»¬å°è¯•ä»¥å¼€æ”¾çš„æ€åº¦çœ‹å¾…å¼‚å¸¸ã€‚ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ç°åœ¨å°†Pythonå¼‚å¸¸è§†ä¸ºåæ¨¡å¼</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/445234/"> æœ‰ä»€ä¹ˆä¾‹å¤–ï¼Ÿ é¡¾åæ€ä¹‰ï¼Œå®ƒä»¬æ˜¯åœ¨ç¨‹åºä¸­å‘ç”Ÿå¼‚å¸¸æ—¶å‡ºç°çš„ã€‚ æ‚¨å¯èƒ½ä¼šé—®ä¸ºä»€ä¹ˆå¼‚å¸¸æ˜¯ä¸€ç§åæ¨¡å¼ï¼Œå®ƒä»¬ä¸è¾“å…¥æœ‰ä½•å…³ç³»ï¼Ÿ æˆ‘è¯•å›¾<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¼„æ¸…æ¥š</a> ï¼Œç°åœ¨æˆ‘æƒ³å’Œä½ ä¸€èµ·è®¨è®ºè¿™ä¸ªé—®é¢˜ï¼Œharazhiteliã€‚ <br><br><h2> ä¾‹å¤–é—®é¢˜ </h2><br> å¾ˆéš¾å‘ç°æ‚¨æ¯å¤©é¢å¯¹çš„é—®é¢˜ã€‚ ä¹ æƒ¯å’Œç›²ç›®æ€§å°†é”™è¯¯å˜æˆåŠŸèƒ½ï¼Œä½†æ˜¯è®©æˆ‘ä»¬å°è¯•ä»¥å¼€æ”¾çš„æ€åº¦çœ‹å¾…å¼‚å¸¸ã€‚ <br><br><h3> å¾ˆéš¾å‘ç°ä¾‹å¤– </h3><br> å¼‚å¸¸æœ‰ä¸¤ç§ç±»å‹ï¼šâ€œæ˜¾å¼â€æ˜¯é€šè¿‡åœ¨æ‚¨æ­£åœ¨é˜…è¯»çš„ä»£ç ä¸­ç›´æ¥è°ƒç”¨<code>raise</code>æ¥åˆ›å»ºçš„ï¼›  â€œéšè—â€éšè—åœ¨ä½¿ç”¨çš„å‡½æ•°ï¼Œç±»ï¼Œæ–¹æ³•ä¸­ã€‚ <br><br> é—®é¢˜åœ¨äºï¼Œâ€œéšè—â€å¼‚å¸¸ç¡®å®å¾ˆéš¾æ³¨æ„åˆ°ã€‚ è®©æˆ‘å‘æ‚¨å±•ç¤ºä¸€ä¸ªçº¯å‡½æ•°çš„ç¤ºä¾‹ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">divide</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(first: float, second: float)</span></span></span><span class="hljs-function"> -&gt; float:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> first / second</code> </pre><br> è¯¥å‡½æ•°ç®€å•åœ°å°†ä¸€ä¸ªæ•°é™¤ä»¥å¦ä¸€ä¸ªï¼Œè¿”å›<code>float</code> ã€‚ æ£€æŸ¥ç±»å‹ï¼Œç„¶åæ‚¨å¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š <br><br><pre> <code class="python hljs">result = divide(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) print(<span class="hljs-string"><span class="hljs-string">'x / y = '</span></span>, result)</code> </pre><br> ä½ æ³¨æ„åˆ°äº†å—ï¼Ÿ å®é™…ä¸Šï¼Œè¯¥ç¨‹åºçš„æ‰§è¡Œå°†æ°¸è¿œæ— æ³•å®ç°<code>print</code> ï¼Œå› ä¸ºå°†1é™¤ä»¥0æ˜¯ä¸å¯èƒ½çš„æ“ä½œï¼Œå®ƒå°†å¼•å‘<code>ZeroDivisionError</code> ã€‚ æ˜¯çš„ï¼Œè¿™æ ·çš„ä»£ç æ˜¯ç±»å‹å®‰å…¨çš„ï¼Œä½†æ˜¯æ— è®ºå¦‚ä½•éƒ½ä¸èƒ½ä½¿ç”¨ã€‚ <br><a name="habracut"></a><br> ä¸ºäº†å³ä½¿åœ¨è¿™ç§ç®€å•æ˜“è¯»çš„ä»£ç ä¸­ä¹Ÿè¦æ³¨æ„æ½œåœ¨çš„é—®é¢˜ï¼Œéœ€è¦ç»éªŒã€‚  Pythonä¸­çš„ä»»ä½•å†…å®¹éƒ½å¯ä»¥åœæ­¢ä½¿ç”¨ä¸åŒç±»å‹çš„å¼‚å¸¸ï¼šé™¤æ³•ï¼Œå‡½æ•°è°ƒç”¨ï¼Œ <code>int</code> ï¼Œ <code>str</code> ï¼Œç”Ÿæˆå™¨ï¼Œå¾ªç¯ä¸­çš„è¿­ä»£å™¨ï¼Œå¯¹å±æ€§æˆ–é”®çš„è®¿é—®ã€‚ ç”šè‡³<code>raise something()</code>ä¹Ÿå¯èƒ½å¯¼è‡´å´©æºƒã€‚ è€Œä¸”ï¼Œæˆ‘ä»€è‡³æ²¡æœ‰æåˆ°è¾“å…¥å’Œè¾“å‡ºæ“ä½œã€‚ å¹¶ä¸”åœ¨ä¸ä¹…çš„å°†æ¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°†ä¸å†æ”¯æŒæ£€æŸ¥çš„å¼‚å¸¸</a> ã€‚ <br><br><h3> æ— æ³•æ¢å¤æ­£å¸¸è¡Œä¸º </h3><br> ä½†æ°æ°åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æœ‰ä¾‹å¤–ã€‚ è®©æˆ‘ä»¬åªå¤„ç†<code>ZeroDivisionError</code> ï¼Œä»£ç å°†å˜ä¸ºç±»å‹å®‰å…¨ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">divide</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(first: float, second: float)</span></span></span><span class="hljs-function"> -&gt; float:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> first / second <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> ZeroDivisionError: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0.0</span></span></code> </pre><br> ç°åœ¨ä¸€åˆ‡éƒ½å¾ˆå¥½ã€‚ ä½†æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬è¿”å›0ï¼Ÿ ä¸ºä»€ä¹ˆä¸é€‰æ‹©1æˆ–<code>None</code> ï¼Ÿ å½“ç„¶ï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè·å–<code>None</code>å‡ ä¹å’Œå¼‚å¸¸ä¸€æ ·ç³Ÿï¼ˆå¦‚æœä¸æ˜¯æ›´ç³Ÿï¼‰ï¼Œä½†æ˜¯ä½¿ç”¨è¯¥åŠŸèƒ½ä»ç„¶éœ€è¦ä¾é ä¸šåŠ¡é€»è¾‘å’Œé€‰é¡¹ã€‚ <br><br> æˆ‘ä»¬åˆ°åº•åˆ†äº«äº†ä»€ä¹ˆï¼Ÿ ä»»æ„æ•°å­—ï¼Œä»»ä½•ç‰¹å®šå•ä½æˆ–é‡‘é¢ï¼Ÿ å¹¶éæ¯ä¸ªé€‰é¡¹éƒ½æ˜“äºé¢„è§å’Œæ¢å¤ã€‚ å¯èƒ½ä¼šå¯¼è‡´æ‚¨ä¸‹æ¬¡ä½¿ç”¨ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ä¸åŒçš„æ¢å¤é€»è¾‘ã€‚ <br><br><blockquote> å¯æ‚²çš„ç»“è®ºæ˜¯ï¼šæ¯ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ¡ˆéƒ½æ˜¯ä¸ªåˆ«çš„ï¼Œå…·ä½“å–å†³äºä½¿ç”¨çš„å…·ä½“æƒ…å†µã€‚ </blockquote><br> æ²¡æœ‰ä¸€åŠ³æ°¸é€¸åœ°è§£å†³<code>ZeroDivisionError</code> ã€‚ è€Œä¸”ï¼Œæˆ‘ä»¬å¹¶ä¸æ˜¯åœ¨è®¨è®ºå¸¦æœ‰é‡å¤è¯·æ±‚å’Œè¶…æ—¶çš„å¤æ‚I / Oçš„å¯èƒ½æ€§ã€‚ <br><br> ä¹Ÿè®¸æ²¡æœ‰å¿…è¦ç²¾ç¡®åœ°å¤„ç†å¼‚å¸¸å‘ç”Ÿçš„åœ°æ–¹ï¼Ÿ ä¹Ÿè®¸åªæ˜¯å°†å…¶æ”¾å…¥ä»£ç æ‰§è¡Œè¿‡ç¨‹ä¸­-ç¨åæœ‰äººä¼šå¼„æ¸…æ¥šã€‚ ç„¶åæˆ‘ä»¬è¢«è¿«å›åˆ°ç›®å‰çš„å±€åŠ¿ã€‚ <br><br><h3> æ‰§è¡Œè¿‡ç¨‹ä¸æ¸…æ¥š </h3><br> å¥½å§ï¼Œè®©æˆ‘ä»¬å¸Œæœ›å…¶ä»–äººèƒ½å¤Ÿæ•è·å¹¶å¤„ç†è¯¥å¼‚å¸¸ã€‚ ä¾‹å¦‚ï¼Œç³»ç»Ÿå¯èƒ½è¦æ±‚ç”¨æˆ·æ›´æ”¹è¾“å…¥çš„å€¼ï¼Œå› ä¸ºå®ƒä¸èƒ½è¢«0 <code>divide</code>å¹¶ä¸”<code>divide</code>åŠŸèƒ½ä¸åº”æ˜ç¡®è´Ÿè´£ä»é”™è¯¯ä¸­æ¢å¤ã€‚ <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦æ£€æŸ¥æˆ‘ä»¬åœ¨å“ªé‡Œæ•è·åˆ°å¼‚å¸¸ã€‚ é¡ºä¾¿è¯´ä¸€å¥ï¼Œå¦‚ä½•ç¡®å®šç¡®åˆ‡çš„å¤„ç†ä½ç½®ï¼Ÿ æ˜¯å¦å¯ä»¥åœ¨ä»£ç ä¸­æ‰¾åˆ°æ­£ç¡®çš„ä½ç½®ï¼Ÿ äº‹å®è¯æ˜ï¼Œä¸ï¼Œ <strong>è¿™æ˜¯ä¸å¯èƒ½çš„</strong> ã€‚ <br><br> æ— æ³•ç¡®å®šå¼•å‘å¼‚å¸¸åå°†æ‰§è¡Œå“ªä¸€è¡Œä»£ç ã€‚ å¯ä»¥ä½¿ç”¨<code>except</code>é€‰é¡¹<code>except</code>é€‰é¡¹å¤„ç†ä¸åŒç±»å‹çš„å¼‚å¸¸ï¼Œå¹¶ä¸”å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¿½ç•¥</a>æŸäº›å¼‚å¸¸ã€‚ è€Œä¸”ï¼Œæ‚¨å¯ä»¥åœ¨å…¶ä»–æ¨¡å—ä¸­æŠ›å‡ºå…¶ä»–å¼‚å¸¸ï¼Œè¿™äº›å¼‚å¸¸å°†æ›´æ—©æ‰§è¡Œï¼Œå¹¶ä¸”é€šå¸¸ä¼šç ´åæ‰€æœ‰é€»è¾‘ã€‚ <br><br> å‡è®¾åº”ç”¨ç¨‹åºä¸­æœ‰ä¸¤ä¸ªç‹¬ç«‹çš„çº¿ç¨‹ï¼šä»ä¸Šåˆ°ä¸‹è¿è¡Œçš„å¸¸è§„çº¿ç¨‹ï¼Œä»¥åŠæ ¹æ®éœ€è¦è¿è¡Œçš„å¼‚å¸¸çº¿ç¨‹ã€‚ å¦‚ä½•é˜…è¯»å’Œç†è§£æ­¤ä»£ç ï¼Ÿ <br><br> ä»…åœ¨â€œæ•è·æ‰€æœ‰å¼‚å¸¸â€æ¨¡å¼ä¸‹æ‰“å¼€è°ƒè¯•å™¨ã€‚ <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8k/bn/do/8kbndolwukkaluarfk3vpexws2w.png"></div><br> åƒè‡­åæ˜­è‘—çš„<code>goto</code>ç±»çš„å¼‚å¸¸ä¼šç ´åç¨‹åºç»“æ„ã€‚ <br><br><h3> å¼‚å¸¸ä¸æ˜¯å”¯ä¸€çš„ </h3><br> è®©æˆ‘ä»¬çœ‹å¦ä¸€ä¸ªç¤ºä¾‹ï¼šé€šå¸¸çš„è¿œç¨‹HTTP APIè®¿é—®ä»£ç ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetch_user_profile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(user_id: int)</span></span></span><span class="hljs-function"> -&gt; 'UserProfile':</span></span> <span class="hljs-string"><span class="hljs-string">"""Fetches UserProfile dict from foreign API."""</span></span> response = requests.get(<span class="hljs-string"><span class="hljs-string">'/api/users/{0}'</span></span>.format(user_id)) response.raise_for_status() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.json()</code> </pre><br> åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå®é™…ä¸Šä¸€åˆ‡éƒ½å¯èƒ½å‡ºé”™ã€‚ ä»¥ä¸‹æ˜¯éƒ¨åˆ†å¯èƒ½çš„é”™è¯¯åˆ—è¡¨ï¼š <br><br><ul><li> ç½‘ç»œå¯èƒ½ä¸å¯ç”¨ï¼Œè¯¥è¯·æ±‚å°†æ ¹æœ¬ä¸ä¼šæ‰§è¡Œã€‚ </li><li> æœåŠ¡å™¨å¯èƒ½æ— æ³•æ­£å¸¸å·¥ä½œã€‚ </li><li> æœåŠ¡å™¨å¯èƒ½å¤ªå¿™ï¼Œå°†å‘ç”Ÿè¶…æ—¶ã€‚ </li><li> æœåŠ¡å™¨å¯èƒ½éœ€è¦èº«ä»½éªŒè¯ã€‚ </li><li>  APIå¯èƒ½æ²¡æœ‰è¿™æ ·çš„URLã€‚ </li><li> å¯èƒ½å­˜åœ¨ä¸å­˜åœ¨çš„ç”¨æˆ·ã€‚ </li><li> å¯èƒ½æ²¡æœ‰è¶³å¤Ÿçš„æƒåˆ©ã€‚ </li><li> å¤„ç†æ‚¨çš„è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨å¯èƒ½ç”±äºå†…éƒ¨é”™è¯¯è€Œå´©æºƒ </li><li> æœåŠ¡å™¨å¯èƒ½è¿”å›æ— æ•ˆæˆ–æŸåçš„å“åº”ã€‚ </li><li> æœåŠ¡å™¨å¯èƒ½ä¼šè¿”å›æ— æ³•è§£æçš„æ— æ•ˆJSONã€‚ </li></ul><br> æ¸…å•ä¸èƒœæšä¸¾ï¼Œä¸å¹¸çš„ä¸‰è¡Œä»£ç ä¸­æœ‰è®¸å¤šæ½œåœ¨çš„é—®é¢˜ã€‚ æˆ‘ä»¬å¯ä»¥è¯´ï¼Œå®ƒé€šå¸¸åªèƒ½é å¹¸è¿çš„æœºä¼šæ‰èƒ½å‘æŒ¥ä½œç”¨ï¼Œè€Œä¸”å¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°ä¾‹å¤–æƒ…å†µã€‚ <br><br><h2> å¦‚ä½•ä¿æŠ¤è‡ªå·±ï¼Ÿ </h2><br> æ—¢ç„¶æˆ‘ä»¬å·²ç»ç¡®å®šäº†å¼‚å¸¸å¯èƒ½å¯¹ä»£ç æœ‰å®³ï¼Œé‚£ä¹ˆè®©æˆ‘ä»¬æ‰¾å‡ºå¦‚ä½•æ¶ˆé™¤å®ƒä»¬ã€‚ è¦æ— ä¾‹å¤–åœ°ç¼–å†™ä»£ç ï¼Œæœ‰ä¸åŒçš„æ¨¡å¼ã€‚ <br><br><ul><li>  <code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">except Exception: pass</a></code>åœ°æ–¹éƒ½å†™ã€‚ æ­»èƒ¡åŒã€‚  <strong>ä¸è¦è¿™æ ·åšã€‚</strong> </li><li> ä¸è¿”å›<code>None</code> ã€‚ å¤ªé‚ªæ¶äº†ã€‚ ç»“æœï¼Œ <code>if something is not None:</code> ï¼Œæ‚¨å°†ä¸å¾—ä¸å‡ ä¹ä»¥æ¯è¡Œå¼€å§‹<code>if something is not None:</code>å¹¶ä¸”æ‰€æœ‰é€»è¾‘å°†åœ¨æ¸…ç†æ£€æŸ¥çš„åƒåœ¾åé¢ä¸¢å¤±ï¼Œå¦åˆ™æ‚¨å°†ä¸€ç›´é­å—<code>TypeError</code>å›°æ‰°ã€‚ ä¸æ˜¯ä¸€ä¸ªå¥½é€‰æ‹©ã€‚ </li><li> ä¸ºç‰¹æ®Šç”¨ä¾‹ç¼–å†™ç±»ã€‚ ä¾‹å¦‚ï¼Œå…·æœ‰å­ç±»çš„<code>User</code>åŸºç±»å…·æœ‰<code>UserNotFound</code>å’Œ<code>MissingUser</code>ç±»çš„é”™è¯¯ã€‚ å¯ä»¥åœ¨æŸäº›ç‰¹å®šæƒ…å†µä¸‹ä½¿ç”¨æ­¤æ–¹æ³•ï¼Œä¾‹å¦‚Djangoä¸­çš„<code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">AnonymousUser</a></code> ï¼Œä½†æ˜¯å°†æ‰€æœ‰å¯èƒ½çš„é”™è¯¯åŒ…è£…åœ¨ç±»ä¸­æ˜¯ä¸ç°å®çš„ã€‚ è¿™å°†éœ€è¦å¤ªå¤šçš„å·¥ä½œï¼Œå¹¶ä¸”åŸŸæ¨¡å‹å°†å˜å¾—éš¾ä»¥æƒ³è±¡çš„å¤æ‚ã€‚ </li><li> ä½¿ç”¨å®¹å™¨å°†ç»“æœå˜é‡æˆ–é”™è¯¯å€¼åŒ…è£…åœ¨åŒ…è£…å™¨ä¸­ï¼Œç„¶åç»§ç»­ä½¿ç”¨å®¹å™¨å€¼ã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åˆ›å»º<code><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@dry-python/return</a></code>é¡¹ç›®çš„åŸå› ã€‚ è¿™æ ·è¯¥å‡½æ•°å°†è¿”å›æœ‰æ„ä¹‰ï¼Œç±»å‹åŒ–å’Œå®‰å…¨çš„å†…å®¹ã€‚ </li></ul><br> è®©æˆ‘ä»¬å›åˆ°é™¤æ³•ç¤ºä¾‹ï¼Œè¯¥ç¤ºä¾‹åœ¨å‘ç”Ÿé”™è¯¯æ—¶è¿”å›0ï¼Œæ˜¯å¦å¯ä»¥æ˜ç¡®è¡¨æ˜å‡½æ•°ä¸è¿”å›ç‰¹å®šæ•°å€¼å°±ä¸ä¼šæˆåŠŸï¼Ÿ <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> returns.result <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Result, Success, Failure <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">divide</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(first: float, second: float)</span></span></span><span class="hljs-function"> -&gt; Result[float, ZeroDivisionError]:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Success(first / second) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> ZeroDivisionError <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> exc: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Failure(exc)</code> </pre><br> æˆ‘ä»¬å°†å€¼åŒ…å«åœ¨ä¸¤ä¸ªåŒ…è£…å™¨ä¹‹ä¸€ä¸­ï¼š <code>Success</code>æˆ–<code>Failure</code> ã€‚ è¿™äº›ç±»æ˜¯ä»<code>Result</code>åŸºç±»ç»§æ‰¿çš„ã€‚ å¯ä»¥ä½¿ç”¨è¿”å›çš„å‡½æ•°åœ¨æ‰¹æ³¨ä¸­æŒ‡å®šæ‰“åŒ…å€¼çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼Œ <code>Result[float, ZeroDivisionError]</code>è¿”å›<code>Success[float]</code>æˆ–<code>Failure[ZeroDivisionError]</code> ã€‚ <br><br> è¿™ç»™äº†æˆ‘ä»¬ä»€ä¹ˆï¼Ÿ æ›´å¤šçš„<strong>ä¾‹å¤–å¹¶éä¾‹å¤–ï¼Œä½†è¿™æ˜¯é¢„æœŸçš„é—®é¢˜</strong> ã€‚ å¦å¤–ï¼Œå°†å¼‚å¸¸åŒ…è£…åœ¨â€œ <code>Failure</code>è§£å†³äº†ç¬¬äºŒä¸ªé—®é¢˜ï¼šè¯†åˆ«æ½œåœ¨å¼‚å¸¸çš„å¤æ‚æ€§ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-number"><span class="hljs-number">1</span></span> + divide(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment"># =&gt; mypy error: Unsupported operand types for + ("int" and "Result[float, ZeroDivisionError]")</span></span></code> </pre><br> ç°åœ¨ï¼Œå®ƒä»¬å¾ˆå®¹æ˜“å‘ç°ã€‚ å¦‚æœæ‚¨åœ¨ä»£ç ä¸­çœ‹åˆ°<code>Result</code> ï¼Œåˆ™è¯¥å‡½æ•°å¯èƒ½ä¼šå¼•å‘å¼‚å¸¸ã€‚ æ‚¨ç”šè‡³å¯ä»¥æå‰çŸ¥é“ä»–çš„ç±»å‹ã€‚ <br><br> æ­¤å¤–ï¼Œè¯¥åº“æ˜¯å®Œå…¨ç±»å‹åŒ–çš„ï¼Œå¹¶ä¸”<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸PEP561å…¼å®¹</a> ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ‚¨å°è¯•è¿”å›ä¸å£°æ˜çš„ç±»å‹ä¸åŒ¹é…çš„å†…å®¹ï¼Œmypyå°†è­¦å‘Šæ‚¨ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> returns.result <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Result, Success, Failure <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">divide</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(first: float, second: float)</span></span></span><span class="hljs-function"> -&gt; Result[float, ZeroDivisionError]:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Success(<span class="hljs-string"><span class="hljs-string">'Done'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># =&gt; error: incompatible type "str"; expected "float" except ZeroDivisionError as exc: return Failure(0) # =&gt; error: incompatible type "int"; expected "ZeroDivisionError"</span></span></code> </pre><br><h3> å¦‚ä½•ä½¿ç”¨å®¹å™¨ï¼Ÿ </h3><br> æœ‰ä¸¤ç§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–¹æ³•</a> ï¼š <br><br><ul><li>  <code>map</code>è¿”å›æ­£å¸¸å€¼çš„å‡½æ•°ï¼› </li><li>  <code>bind</code>è¿”å›å…¶ä»–å®¹å™¨çš„å‡½æ•°ã€‚ </li></ul><br><pre> <code class="python hljs">Success(<span class="hljs-number"><span class="hljs-number">4</span></span>).bind(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> number: Success(number / <span class="hljs-number"><span class="hljs-number">2</span></span>)) <span class="hljs-comment"><span class="hljs-comment"># =&gt; Success(2) Success(4).map(lambda number: number + 1) # =&gt; Success(5)</span></span></code> </pre><br> è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œæ­¤ä»£ç å°†ä¿æŠ¤æ‚¨å…å—å¤±è´¥çš„è„šæœ¬çš„æ”»å‡»ï¼Œå› ä¸º<code>.bind</code>å’Œ<code>.map</code>ä¸ä¼šå¯¹å…·æœ‰<code>Failure</code>å®¹å™¨æ‰§è¡Œï¼š <br><br><pre> <code class="python hljs">Failure(<span class="hljs-number"><span class="hljs-number">4</span></span>).bind(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> number: Success(number / <span class="hljs-number"><span class="hljs-number">2</span></span>)) <span class="hljs-comment"><span class="hljs-comment"># =&gt; Failure(4) Failure(4).map(lambda number: number / 2) # =&gt; Failure(4)</span></span></code> </pre><br> ç°åœ¨ï¼Œæ‚¨å¯ä»¥ä¸“æ³¨äºæ­£ç¡®çš„æ‰§è¡Œè¿‡ç¨‹ï¼Œå¹¶ç¡®ä¿é”™è¯¯çš„çŠ¶æ€ä¸ä¼šåœ¨æ„å¤–çš„åœ°æ–¹ä¸­æ–­ç¨‹åºã€‚ è€Œä¸”æ€»æ˜¯æœ‰æœºä¼š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¡®å®šé”™è¯¯çš„çŠ¶æ€ï¼Œè¿›è¡Œæ›´æ­£</a> ï¼Œç„¶åè¿”å›åˆ°æµç¨‹çš„æ„æƒ³è·¯å¾„ã€‚ <br><br><pre> <code class="python hljs">Failure(<span class="hljs-number"><span class="hljs-number">4</span></span>).rescue(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> number: Success(number + <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-comment"><span class="hljs-comment"># =&gt; Success(5) Failure(4).fix(lambda number: number / 2) # =&gt; Success(2)</span></span></code> </pre><br> åœ¨æˆ‘ä»¬çš„æ–¹æ³•ä¸­ï¼Œâ€œæ‰€æœ‰é—®é¢˜éƒ½æ˜¯å•ç‹¬è§£å†³çš„â€ï¼Œâ€œæ‰§è¡Œè¿‡ç¨‹ç°åœ¨æ˜¯é€æ˜çš„â€ã€‚ äº«å—ç¼–ç¨‹çš„ä¹è¶£ï¼ <br><br><h3> ä½†æ˜¯å¦‚ä½•ä»å®¹å™¨ä¸­æ‰©å±•ä»·å€¼å‘¢ï¼Ÿ </h3><br> ç¡®å®ï¼Œå¦‚æœæ‚¨ä½¿ç”¨å¯¹å®¹å™¨ä¸€æ— æ‰€çŸ¥çš„å‡½æ•°ï¼Œé‚£ä¹ˆæ‚¨æœ¬èº«å°±éœ€è¦è¿™äº›å€¼ã€‚ ç„¶åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<code>.unwrap()</code>æˆ–<code>.value_or()</code>æ–¹æ³•ï¼š <br><br><pre> <code class="python hljs">Success(<span class="hljs-number"><span class="hljs-number">1</span></span>).unwrap() <span class="hljs-comment"><span class="hljs-comment"># =&gt; 1 Success(0).value_or(None) # =&gt; 0 Failure(0).value_or(None) # =&gt; None Failure(1).unwrap() # =&gt; Raises UnwrapFailedError()</span></span></code> </pre><br> ç­‰ç­‰ï¼Œæˆ‘ä»¬ä¸å¾—ä¸æ‘†è„±å¼‚å¸¸ï¼Œç°åœ¨äº‹å®è¯æ˜ï¼Œæ‰€æœ‰<code>.unwrap()</code>è°ƒç”¨éƒ½å¯èƒ½å¯¼è‡´å¦ä¸€ä¸ªå¼‚å¸¸ï¼Ÿ <br><br><h3> å¦‚ä½•ä¸è€ƒè™‘UnwrapFailedErrorsï¼Ÿ </h3><br> å¥½çš„ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•ä½¿ç”¨æ–°çš„å¼‚å¸¸ã€‚ è€ƒè™‘ä»¥ä¸‹ç¤ºä¾‹ï¼šæ‚¨éœ€è¦æ£€æŸ¥ç”¨æˆ·è¾“å…¥å¹¶åœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸¤ä¸ªæ¨¡å‹ã€‚ æ¯ä¸ªæ­¥éª¤éƒ½å¯èƒ½ä»¥å¼‚å¸¸ç»“æŸï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ‰€æœ‰æ–¹æ³•éƒ½åŒ…è£…åœ¨<code>Result</code> ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> returns.result <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Result, Success, Failure <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateAccountAndUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""Creates new Account-User pair."""</span></span> <span class="hljs-comment"><span class="hljs-comment"># </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> we need to create a pipeline of these methods somehow... def _validate_user( self, username: str, email: str, ) -&gt; Result['UserSchema', str]: """Returns an UserSchema for valid input, otherwise a Failure.""" def _create_account( self, user_schema: 'UserSchema', ) -&gt; Result['Account', str]: """Creates an Account for valid UserSchema's. Or returns a Failure.""" def _create_user( self, account: 'Account', ) -&gt; Result['User', str]: """Create an User instance. If user already exists returns Failure."""</span></span></code> </pre><br> é¦–å…ˆï¼Œæ‚¨æ ¹æœ¬ä¸å¿…åœ¨è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ä¸­æ‰©å±•ä»·å€¼ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateAccountAndUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""Creates new Account-User pair."""</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, username: str, email: str)</span></span></span><span class="hljs-function"> -&gt; Result['User', str]:</span></span> <span class="hljs-string"><span class="hljs-string">"""Can return a Success(user) or Failure(str_reason)."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._validate_user( username, email, ).bind( self._create_account, ).bind( self._create_user, ) <span class="hljs-comment"><span class="hljs-comment"># ...</span></span></code> </pre><br> ä¸€åˆ‡éƒ½ä¼šæ­£å¸¸è¿›è¡Œï¼Œä¸ä¼š<code>.unwrap()</code>ä»»ä½•å¼‚å¸¸ï¼Œå› ä¸ºä¸ä½¿ç”¨<code>.unwrap()</code> ã€‚ ä½†æ˜¯é˜…è¯»è¿™æ ·çš„ä»£ç å®¹æ˜“å—ï¼Ÿ ä¸è¡Œ è¿˜æœ‰ä»€ä¹ˆé€‰æ‹©ï¼Ÿ  <code>@pipeline</code> ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> result.functions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pipeline <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CreateAccountAndUser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""Creates new Account-User pair."""</span></span> @pipeline <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, username: str, email: str)</span></span></span><span class="hljs-function"> -&gt; Result['User', str]:</span></span> <span class="hljs-string"><span class="hljs-string">"""Can return a Success(user) or Failure(str_reason)."""</span></span> user_schema = self._validate_user(username, email).unwrap() account = self._create_account(user_schema).unwrap() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._create_user(account) <span class="hljs-comment"><span class="hljs-comment"># ...</span></span></code> </pre><br> ç°åœ¨ï¼Œè¿™æ®µä»£ç å·²ç»å¾ˆå¥½åœ°é˜…è¯»äº†ã€‚ è¿™æ˜¯<code>.unwrap()</code>å’Œ<code>@pipeline</code>ä¸€èµ·å·¥ä½œçš„æ–¹å¼ï¼šæ¯å½“<code>.unwrap()</code>æ–¹æ³•å¤±è´¥å’Œ<code>Failure[str]</code> ï¼Œ <code>@pipeline</code>è£…é¥°å™¨å°†å…¶æ•è·å¹¶è¿”å›<code>Failure[str]</code>ä½œä¸ºç»“æœå€¼ã€‚ è¿™å°±æ˜¯æˆ‘å»ºè®®ä»ä»£ç ä¸­åˆ é™¤æ‰€æœ‰å¼‚å¸¸å¹¶ä½¿ä¹‹çœŸæ­£å®‰å…¨å’Œé”®å…¥çš„æ–¹å¼ã€‚ <br><br><h2> å…¨éƒ¨åŒ…è£¹åœ¨ä¸€èµ· </h2><br> å¥½çš„ï¼Œç°åœ¨æˆ‘ä»¬å°†åº”ç”¨æ–°å·¥å…·ï¼Œä¾‹å¦‚ï¼Œå¯¹HTTP APIçš„è¯·æ±‚ã€‚ è¿˜è®°å¾—æ¯è¡Œéƒ½å¯ä»¥æŠ›å‡ºå¼‚å¸¸å—ï¼Ÿ è€Œä¸”æ²¡æœ‰åŠæ³•è®©ä»–ä»¬ç”¨<code>Result</code>è¿”å›å®¹å™¨ã€‚ ä½†æ˜¯æ‚¨å¯ä»¥ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@safeè£…é¥°å™¨</a>æ¥åŒ…è£…ä¸å®‰å…¨çš„å‡½æ•°å¹¶ä½¿å®ƒä»¬å®‰å…¨ã€‚ ä»¥ä¸‹æ˜¯ä¸¤ä¸ªæ‰§è¡Œç›¸åŒæ“ä½œçš„ä»£ç é€‰é¡¹ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> returns.functions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> safe @safe <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">divide</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(first: float, second: float)</span></span></span><span class="hljs-function"> -&gt; float:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> first / second <span class="hljs-comment"><span class="hljs-comment"># is the same as: def divide(first: float, second: float) -&gt; Result[float, ZeroDivisionError]: try: return Success(first / second) except ZeroDivisionError as exc: return Failure(exc)</span></span></code> </pre><br> ç¬¬ä¸€ä¸ªä½¿ç”¨<code>@safe</code> ï¼Œæ›´æ˜“äºé˜…è¯»ã€‚ <br><br>  APIè¯·æ±‚ç¤ºä¾‹ä¸­çš„æœ€åä¸€ä»¶äº‹æ˜¯æ·»åŠ <code>@safe</code>è£…é¥°å™¨ã€‚ ç»“æœæ˜¯ä»¥ä¸‹ä»£ç ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> returns.functions <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pipeline, safe <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> returns.result <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Result <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FetchUserProfile</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-string"><span class="hljs-string">"""Single responsibility callable object that fetches user profile."""</span></span> <span class="hljs-comment"><span class="hljs-comment">#: You can later use dependency injection to replace `requests` #: with any other http library (or even a custom service). _http = requests @pipeline def __call__(self, user_id: int) -&gt; Result['UserProfile', Exception]: """Fetches UserProfile dict from foreign API.""" response = self._make_request(user_id).unwrap() return self._parse_json(response) @safe def _make_request(self, user_id: int) -&gt; requests.Response: response = self._http.get('/api/users/{0}'.format(user_id)) response.raise_for_status() return response @safe def _parse_json(self, response: requests.Response) -&gt; 'UserProfile': return response.json()</span></span></code> </pre><br>  <strong>æ€»ç»“å¦‚ä½•æ‘†è„±å¼‚å¸¸å¹¶ä¿æŠ¤ä»£ç </strong> ï¼š <br><br><ul><li> å¯¹å¯èƒ½å¼•å‘å¼‚å¸¸çš„æ‰€æœ‰æ–¹æ³•ä½¿ç”¨<code>@safe</code>åŒ…è£…å™¨ã€‚ å®ƒå°†å‡½æ•°çš„è¿”å›ç±»å‹æ›´æ”¹ä¸º<code>Result[OldReturnType, Exception]</code> ã€‚ </li><li> ä½¿ç”¨<code>Result</code>ä½œä¸ºå®¹å™¨ï¼Œå¯ä»¥å°†å€¼å’Œé”™è¯¯è½¬æ¢ä¸ºç®€å•çš„æŠ½è±¡ã€‚ </li><li> ä½¿ç”¨<code>.unwrap()</code>æ‰©å±•å®¹å™¨ä¸­çš„å€¼ã€‚ </li><li> ä½¿ç”¨<code>@pipeline</code>ä½¿<code>.unwrap</code>è°ƒç”¨<code>.unwrap</code>æ›´æ˜“äºé˜…è¯»ã€‚ </li></ul><br> é€šè¿‡éµå®ˆè¿™äº›è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥åšå®Œå…¨ç›¸åŒçš„äº‹æƒ…-åªæœ‰å®‰å…¨ä¸”æ˜“äºé˜…è¯»ã€‚ è§£å†³äº†æ‰€æœ‰ä¸å¼‚å¸¸æœ‰å…³çš„é—®é¢˜ï¼š <br><br><ul><li>  <strong>â€œå¾ˆéš¾å‘ç°ä¾‹å¤–</strong> ã€‚ <strong>â€</strong> ç°åœ¨ï¼Œå°†å®ƒä»¬åŒ…è£…åœ¨ä¸€ä¸ªç±»å‹åŒ–çš„<code>Result</code>å®¹å™¨ä¸­ï¼Œè¿™ä½¿å®ƒä»¬å®Œå…¨é€æ˜ã€‚ </li><li>  <strong>æ¢å¤æ­£å¸¸è¡Œä¸ºæ˜¯ä¸å¯èƒ½çš„</strong> ã€‚ <strong>â€</strong> ç°åœ¨ï¼Œæ‚¨å¯ä»¥å®‰å…¨åœ°å°†æ¢å¤è¿‡ç¨‹å§”æ‰˜ç»™è°ƒç”¨æ–¹ã€‚ å¯¹äºè¿™ç§æƒ…å†µï¼Œæœ‰<code>.fix()</code>å’Œ<code>.rescue()</code> ã€‚ </li><li>  <strong>â€œæ‰§è¡Œçš„é¡ºåºå°šä¸æ¸…æ¥š</strong> ã€‚ <strong>â€</strong> ç°åœ¨ï¼Œå®ƒä»¬æ˜¯å…·æœ‰é€šå¸¸ä¸šåŠ¡æµç¨‹çš„ä¸€ç§ã€‚ ä»å¤´åˆ°å°¾ã€‚ </li><li>  <strong>â€œä¾‹å¤–å¹¶ä¸ä¾‹å¤–</strong> ã€‚ <strong>â€</strong> æˆ‘ä»¬çŸ¥é“ï¼ å¹¶ä¸”æˆ‘ä»¬å¸Œæœ›æŸäº›äº‹æƒ…ä¼šå‡ºé”™å¹¶ä¸”ä¸ºä»»ä½•äº‹æƒ…åšå¥½å‡†å¤‡ã€‚ </li></ul><br><h3> ç”¨ä¾‹å’Œé™åˆ¶ </h3><br> æ˜¾ç„¶ï¼Œæ‚¨ä¸èƒ½åœ¨æ‰€æœ‰ä»£ç ä¸­éƒ½ä½¿ç”¨è¿™ç§æ–¹æ³•ã€‚ å¯¹äºå¤§å¤šæ•°æ—¥å¸¸æƒ…å†µè€Œè¨€ï¼Œå®ƒ<strong>å¤ªå®‰å…¨äº†</strong> ï¼Œå¹¶ä¸”ä¸å…¶ä»–åº“æˆ–æ¡†æ¶ä¸å…¼å®¹ã€‚ ä½†æ˜¯ï¼Œæ‚¨å¿…é¡»å®Œå…¨æŒ‰ç…§æˆ‘çš„è¯´æ˜ç¼–å†™ä¸šåŠ¡é€»è¾‘ä¸­æœ€é‡è¦çš„éƒ¨åˆ†ï¼Œä»¥ç¡®ä¿ç³»ç»Ÿæ­£ç¡®è¿è¡Œå¹¶ä¿ƒè¿›å°†æ¥çš„æ”¯æŒã€‚ <br><br><blockquote> è¿™ä¸ªè¯é¢˜ä¼šè®©æ‚¨æ€è€ƒç”šè‡³çœ‹èµ·æ¥åƒéœåˆ©ç“¦å°”å°¼å—ï¼Ÿ  4æœˆ5æ—¥æ¥åˆ°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è«æ–¯ç§‘Python Conf ++</a> ï¼Œæˆ‘ä»¬å°†è¿›è¡Œè®¨è®ºï¼ é™¤äº†æˆ‘ä¹‹å¤–ï¼Œå¹²Pythoné¡¹ç›®çš„åˆ›å§‹äººå’ŒDjango Channelsçš„æ ¸å¿ƒå¼€å‘äººå‘˜Artyom Malyshevä¹Ÿå°†åœ¨é‚£é‡Œã€‚ ä»–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°†</a>æ›´å¤šåœ°è®¨è®ºå¹²Pythonå’Œä¸šåŠ¡é€»è¾‘ã€‚ </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN445234/">https://habr.com/ru/post/zh-CN445234/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN445220/index.html">AMD Radeon VIIï¼šé«˜ç«¯èŠ¯ç‰‡ï¼ˆç¬¬3éƒ¨åˆ†ï¼‰</a></li>
<li><a href="../zh-CN445222/index.html">åœ¨å®‡å®™èˆªè¡Œæ—¥çš„1å¤©ä¹‹å†…ç»™åç«¯å›¢é˜Ÿä¸€ä¸ªæŠ¥ä»·</a></li>
<li><a href="../zh-CN445226/index.html">ç ”åˆ¶èƒ½å¤Ÿåˆ°è¾¾æœˆçƒçš„ç«ç®­å°†è€—èµ„ä¿„ç½—æ–¯7,400äº¿å¢å¸ƒ</a></li>
<li><a href="../zh-CN445228/index.html">Javaä¸­çš„å¯†ç å­¦ã€‚ Macç±»</a></li>
<li><a href="../zh-CN445230/index.html">å¼€å§‹ä¸ºåˆå­¦è€…SMARTRHINO-2019ä¸¾è¡Œçš„II ITä¼šè®®çš„æ³¨å†Œ</a></li>
<li><a href="../zh-CN445236/index.html">â€œ NOWè‡³å°Šè®ºå›2019â€ï¼šæ³¨å†Œå¼€æ”¾</a></li>
<li><a href="../zh-CN445238/index.html">æˆé•¿ï¼šMobius 2018è«æ–¯ç§‘çš„åå¤§æŠ¥é“</a></li>
<li><a href="../zh-CN445240/index.html">å¦‚ä½•å»‰ä»·ï¼Œå¿«é€Ÿåœ°ç§»åŠ¨ï¼Œä¸Šä¼ å’Œé›†æˆéå¸¸å¤§çš„æ•°æ®ï¼Ÿ ä¸‹æ¨å¼ä¼˜åŒ–æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="../zh-CN445242/index.html">åç¨‹å’Œæ”¹é€ 2çš„ç»éªŒ</a></li>
<li><a href="../zh-CN445244/index.html">â€œåŒºå—é“¾ä¹‹å¤–çš„é‡‘é’±æ¸¸æˆå¿…é¡»æ¶ˆäº¡â€</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>