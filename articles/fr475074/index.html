<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üß¶ ‚Ü©Ô∏è üíØ Introduction √† ECMAScript 2017 (ES8) üå∏ üèòÔ∏è üà∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Table des mati√®res 
 Pr√©face 
 Pr√©sentation d'ES7 
 1. Entr√©es d'objet 
 2. Object.values 
 3. String.prototype.padEnd 
 4. String.prototype.padStart ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introduction √† ECMAScript 2017 (ES8)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475074/"><h4>  Table des mati√®res </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pr√©face</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pr√©sentation d'ES7</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">1. Entr√©es d'objet</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">2. Object.values</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">3. String.prototype.padEnd</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">4. String.prototype.padStart</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">5. Object.getOwnPropertyDescriptor</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">6. Virgules de fin</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">7. SharedArrayBuffer</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">8. Atomics</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">9. Fonctions asynchrones</a> <br><br><a name="section000"></a><h2>  Pr√©face </h2><br>  Bonjour, dans le pass√©, j'avais d√©j√† envisag√© des innovations dans ES6 et maintenant il est temps de d√©monter ES8 car il a apport√© beaucoup de nouvelles choses.  Je n'ai pas consid√©r√© ES7 (2016) s√©par√©ment, car cette version n'a apport√© que 2 innovations.  Il s'agit de Array.prototype.includes () et de l'op√©rateur d'exponentiation.  Mais avant de commencer ES8, regardons les innovations d'ES7. <br><br><a name="section0000"></a><h2>  Pr√©sentation d'ES7 </h2><br>  <b>La m√©thode includes ()</b> d√©termine si le tableau contient un √©l√©ment sp√©cifique, renvoyant vrai ou faux selon cela. <br><br><pre><code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.prototype.includes(searchElement[, fromIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>]) : <span class="hljs-built_in"><span class="hljs-built_in">Boolean</span></span></code> </pre> <br>  searchElement - L'√©l√©ment √† rechercher. <br><br>  fromIndex - La position dans le tableau √† partir de laquelle commencer la recherche de l'√©l√©ment searchElement.  Pour les valeurs n√©gatives, la recherche est effectu√©e en commen√ßant par l'index array.length + fromIndex croissant.  La valeur par d√©faut est 0. <a name="habracut"></a><br><br>  <b>Des exemples</b> <br><br><pre> <code class="javascript hljs">[<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>].includes(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">// true [1, 2, 3].includes(4); // false [1, 2, 3].includes(3, 3); // false [1, 2, 3].includes(3, -1); // true [1, 2, NaN].includes(NaN); // true</span></span></code> </pre> <br>  includes () peut √™tre appliqu√© √† d'autres types d'objets (par exemple, des objets de type tableau).  Exemple: utilisation de la m√©thode includes () sur un objet arguments. <br><br><pre> <code class="javascript hljs">(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log([].includes.call(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>, <span class="hljs-string"><span class="hljs-string">'a'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// true console.log([].includes.call(arguments, 'd')); // false })('a','b','c');</span></span></code> </pre> <br>  <b>L'op√©rateur d'exponentiation</b> (**) renvoie une puissance de base a et d'exposant naturel b.  √âlever a au pouvoir de b. <br><br><pre> <code class="javascript hljs">a ** b</code> </pre> <br>  <b>Des exemples</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-comment"><span class="hljs-comment">// 8 3 ** 2 // 9 3 ** 2.5 // 15.588457268119896 10 ** -1 // 0.1 NaN ** 2 // NaN 2 ** 3 ** 2 // 512 2 ** (3 ** 2) // 512 (2 ** 3) ** 2 // 64 -(2 ** 2) // -4 (-2) ** 2 // 4</span></span></code> </pre> <br><a name="section001"></a><h2>  1. Entr√©es d'objet </h2><br>  Object.entries () renvoie un tableau dont les √©l√©ments sont des tableaux correspondant √† la propri√©t√© √©num√©r√©e de la paire [cl√©, valeur] trouv√©e directement dans l'objet.  L'ordre des propri√©t√©s est le m√™me que lorsque vous parcourez manuellement les propri√©t√©s d'un objet. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.entries(obj) : <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span></code> </pre> <br>  obj - Un objet dont les propri√©t√©s √©num√©r√©es seront renvoy√©es sous forme de tableau [cl√©, valeur]. <br><br>  Object.entries () renvoie les propri√©t√©s dans le m√™me ordre que dans la boucle for ... in (la diff√©rence est que for-in r√©pertorie √©galement les propri√©t√©s de la cha√Æne de prototypes).  L'ordre des √©l√©ments du tableau renvoy√© par Object.entries () est ind√©pendant de la fa√ßon dont l'objet est d√©clar√©.  Si un ordre sp√©cifique est n√©cessaire, le tableau doit √™tre tri√© avant l'appel de la m√©thode. <br><br>  <b>Des exemples</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.entries(obj)); <span class="hljs-comment"><span class="hljs-comment">// [ ['foo', 'bar'], ['baz', 42] ] //    var obj = { 0: 'a', 1: 'b', 2: 'c' }; console.log(Object.entries(obj)); // [ ['0', 'a'], ['1', 'b'], ['2', 'c'] ] //    c random   var an_obj = { 100: 'a', 2: 'b', 7: 'c' }; console.log(Object.entries(an_obj)); // [ ['2', 'b'], ['7', 'c'], ['100', 'a'] ] // getFoo  ,    var my_obj = Object.create({}, { getFoo: { value: function() { return this.foo; } } }); my_obj.foo = "bar"; console.log(Object.entries(my_obj)); // [ ['foo', 'bar'] ] // non-object     object console.log(Object.entries("foo")); // [ ['0', 'f'], ['1', 'o'], ['2', 'o'] ] let obj = { one: 1, two: 2 }; for (let [k,v] of Object.entries(obj)) console.log(`${JSON.stringify(k)}: ${JSON.stringify(v)}`) // "one": 1 // "two": 2</span></span></code> </pre> <br>  <b>Convertir un objet en carte</b> <br><br>  Le nouveau constructeur Map () accepte la r√©p√©tition des valeurs.  Avec Object.entries, vous pouvez facilement convertir un objet en carte.  C'est plus concis que d'utiliser un tableau de tableaux √† 2 √©l√©ments, mais les cl√©s ne peuvent √™tre que des cha√Ænes. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> map = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Map</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.entries(obj)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(map); <span class="hljs-comment"><span class="hljs-comment">// Map {"foo" =&gt; "bar", "baz" =&gt; 42}</span></span></code> </pre> <br>  Pourquoi la valeur de retour de Object.entries () est-elle un tableau et non un it√©rateur? <br>  Le cas d'utilisation correspondant dans ce cas est Object.keys (), et non, par exemple, Map.prototype.entries (). <br><br>  Pourquoi Object.entries () retourne uniquement les propri√©t√©s natives √©num√©r√©es avec des cl√©s de cha√Æne? <br><br>  Encore une fois, cela est fait pour faire correspondre Object.keys ().  Cette m√©thode ignore √©galement les propri√©t√©s dont les cl√©s sont des caract√®res.  En fin de compte, il peut y avoir une m√©thode Reflect.ownEntries () qui renvoie toutes ses propres propri√©t√©s. <br><br>  Voir object.entries dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">sp√©cification</a> officielle, ainsi que dans les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">documents Web MDN</a> . <br><br><a name="section002"></a><h2>  2. Object.values </h2><br>  Object.values ‚Äã‚Äã() renvoie un tableau dont les √©l√©ments sont les valeurs des propri√©t√©s √©num√©r√©es trouv√©es dans l'objet.  L'ordre est le m√™me que si vous parcourez l'objet manuellement. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.values(obj) : <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span></code> </pre> <br>  obj - Un objet dont les valeurs des propri√©t√©s √©num√©r√©es seront renvoy√©es. <br><br>  La m√©thode Object.values ‚Äã‚Äã() renvoie un tableau de valeurs des propri√©t√©s √©num√©r√©es de l'objet dans le m√™me ordre que la boucle for ... in.  La diff√©rence entre une boucle et une m√©thode est que la boucle r√©pertorie les propri√©t√©s de et de la cha√Æne prototype. <br><br>  <b>Des exemples</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.values(obj)); <span class="hljs-comment"><span class="hljs-comment">// ['bar', 42] //    var obj = { 0: 'a', 1: 'b', 2: 'c' }; console.log(Object.values(obj)); // ['a', 'b', 'c']</span></span></code> </pre><br>  La diff√©rence entre Object.entries et Object.values ‚Äã‚Äã() est que le premier retourne un tableau de tableaux contenant le nom et la valeur de la propri√©t√©, tandis que le second retourne uniquement un tableau avec la valeur des propri√©t√©s. <br><br>  <b>Exemple de diff√©rence entre Object.values ‚Äã‚Äã() et Object.entries ()</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> object = { <span class="hljs-attr"><span class="hljs-attr">a</span></span>: <span class="hljs-string"><span class="hljs-string">'somestring'</span></span>, <span class="hljs-attr"><span class="hljs-attr">b</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span>, <span class="hljs-attr"><span class="hljs-attr">c</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span> }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.values(object)); <span class="hljs-comment"><span class="hljs-comment">// ["somestring", 42, false] console.log(Object.entries(object)); // [ ["a", "somestring"], ["b", 42], ["c", false] ]</span></span></code> </pre> <br>  Voir Object.values ‚Äã‚Äã() dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">sp√©cification</a> officielle, ainsi que dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section003"></a><h2>  3. String.prototype.padEnd </h2><br>  La m√©thode padEnd () compl√®te la ligne actuelle avec la cha√Æne donn√©e (√©ventuellement r√©p√©t√©e) afin que la cha√Æne r√©sultante atteigne la longueur sp√©cifi√©e.  L'addition est appliqu√©e √† la fin (√† droite) de la ligne actuelle. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.prototype.padEnd(maxLength [ , fillString ]) : <span class="hljs-built_in"><span class="hljs-built_in">String</span></span></code> </pre> <br>  maxLength - La longueur de la ligne r√©sultante apr√®s le remplissage de la ligne actuelle.  Si ce param√®tre est inf√©rieur √† la longueur de la ligne actuelle, la ligne actuelle sera renvoy√©e telle quelle. <br>  fillString - Une cha√Æne pour compl√©ter la ligne actuelle.  Si cette ligne est trop longue, elle sera tronqu√©e et sa partie la plus √† gauche sera appliqu√©e.  "" (0x0020 ESPACE) est la valeur par d√©faut de ce param√®tre. <br><br>  <b>Des exemples</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'abc'</span></span>.padEnd(<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-comment"><span class="hljs-comment">// "abc " 'abc'.padEnd(10, "foo"); // "abcfoofoof" 'abc'.padEnd(6,"123456"); // "abc123"</span></span></code> </pre> <br>  Les cas d'utilisation pour le remplissage de cha√Ænes incluent: <br><br><ul><li>  Ajout d'un compteur ou d'un identifiant √† un nom de fichier ou √† une URL: ¬´fichier 001.txt¬ª </li><li>  Alignement de la sortie de la console: ¬´Test 001: ‚úì¬ª </li><li>  Imprimer des nombres hexad√©cimaux ou binaires avec un nombre fixe de chiffres: '0x00FF' </li></ul><br>  Voir String.prototype.padEnd dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">sp√©cification</a> officielle, ainsi que dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section004"></a><h2>  4. String.prototype.padStart </h2><br>  La m√©thode padStart () remplit la ligne actuelle avec une autre ligne (plusieurs fois, si n√©cessaire) afin que la ligne r√©sultante atteigne la longueur sp√©cifi√©e.  Le remplissage s'effectue au d√©but (√† gauche) de la ligne courante. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">String</span></span>.prototype.padStart(maxLength [, fillString]) : <span class="hljs-built_in"><span class="hljs-built_in">String</span></span></code> </pre> <br>  maxLength - La longueur de la ligne r√©capitulative apr√®s la fin de la ligne actuelle.  Si la valeur est inf√©rieure √† la longueur de la ligne actuelle, la ligne actuelle sera retourn√©e inchang√©e. <br><br>  fillString - Une cha√Æne pour remplir la ligne actuelle.  Si cette cha√Æne est trop longue pour la longueur donn√©e, elle sera tronqu√©e.  La valeur par d√©faut est "" (0x0020 ESPACE). <br><br>  <b>Des exemples</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">'abc'</span></span>.padStart(<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-comment"><span class="hljs-comment">// " abc" 'abc'.padStart(10, "foo"); // "foofoofabc" 'abc'.padStart(6,"123465"); // "123abc" 'abc'.padStart(8, "0"); // "00000abc" 'abc'.padStart(1); // "abc"</span></span></code> </pre> <br>  Pourquoi les m√©thodes de remplissage ne sont-elles pas appel√©es padLeft et padRight? <br><br>  Pour les langues bidirectionnelles ou de droite √† gauche, les termes ¬´gauche¬ª et ¬´droite¬ª ne fonctionnent pas.  Par cons√©quent, la d√©nomination de padStart et padEnd suit les noms existants commen√ßant par beginWith et endsWith. <br><br>  Voir String.prototype.padStart dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">sp√©cification</a> officielle, ainsi que dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section005"></a><h2>  5. Object.getOwnPropertyDescriptor </h2><br>  La m√©thode Object.getOwnPropertyDescriptor () renvoie un descripteur de propri√©t√© pour sa propre propri√©t√© (c'est-√†-dire situ√©e directement dans l'objet et non re√ßue via la cha√Æne de prototype) de l'objet transmis.  Si la propri√©t√© n'existe pas, retourne undefined. <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(obj, prop) : <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span></code> </pre> <br>  obj - L'objet dans lequel la propri√©t√© est recherch√©e. <br><br>  prop - Le nom de la propri√©t√© dont la description sera retourn√©e. <br><br>  Cette m√©thode vous permet de visualiser la description exacte de la propri√©t√©.  Une propri√©t√© en JavaScript se compose d'un nom de cha√Æne et d'un descripteur de propri√©t√©. <br><br>  Un descripteur de propri√©t√© est un enregistrement avec certains des attributs suivants: <br><br><ul><li>  value - La valeur associ√©e √† la propri√©t√© (uniquement dans le descripteur de donn√©es). </li><li>  accessible en √©criture - true si la valeur associ√©e √† la propri√©t√© peut √™tre modifi√©e, sinon false (uniquement dans le descripteur de donn√©es). </li><li>  get - Une fonction qui renvoie la valeur de la propri√©t√©, ou ind√©finie s'il n'y a pas une telle fonction (uniquement dans le descripteur d'acc√®s). </li><li>  set - Une fonction qui change la valeur d'une propri√©t√©, ou ind√©finie s'il n'y a pas une telle fonction (uniquement dans le descripteur d'acc√®s). </li><li>  configurable - true si le type de handle de cette propri√©t√© peut √™tre modifi√© et si la propri√©t√© peut √™tre supprim√©e de l'objet qui la contient, sinon false. </li><li>  enumerable - true si cette propri√©t√© est disponible lors de l'√©num√©ration des propri√©t√©s de l'objet qui la contient, sinon false. </li></ul><br>  <b>Des exemples</b> <br><br><pre> <code class="javascript hljs">obj = { get foo() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span>; } }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(obj, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// {set: undefined, enumerable: true, configurable: true, get: ∆í} obj2 = { bar: 42 }; console.log(Object.getOwnPropertyDescriptor(obj2, 'bar')); // {value: 42, writable: true, enumerable: true, configurable: true}</span></span></code> </pre> <br><h4>  Cas d'utilisation de Object.getOwnPropertyDescriptor () </h4><br>  <b>Premier</b> cas d'utilisation: copier les propri√©t√©s dans un objet <br>  Depuis ES6, JavaScript dispose d√©j√† d'une m√©thode d'outil pour copier les propri√©t√©s: Object.assign ().  Cependant, cette m√©thode utilise de simples op√©rations get et set pour copier une propri√©t√© dont la cl√© est la cl√©: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> value = source[key]; <span class="hljs-comment"><span class="hljs-comment">// get target[key] = value; // set</span></span></code> </pre>  Cela signifie qu'il ne copie pas correctement les propri√©t√©s avec des attributs autres que ceux sp√©cifi√©s par d√©faut (m√©thodes d'obtention, de d√©finition, d'√©criture, etc.).  L'exemple suivant illustre cette limitation.  La source de l'objet a un programme d'installation dont la cl√© est foo: <pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> source = { set foo(value) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(value); } }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(source, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// { get: undefined, set: [Function: foo], enumerable: true, configurable: true }</span></span></code> </pre> <br>  √âchec de l'utilisation d'Object.assign () pour copier la propri√©t√© foo dans l'objet cible: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> target1 = {}; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign(target1, source); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(target1, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// { value: undefined, writable: true, enumerable: true, configurable: true }</span></span></code> </pre>  Heureusement, l'utilisation d'Object.getOwnPropertyDescriptors () avec Object.defineProperties () fonctionne: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> target2 = {}; <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.defineProperties(target2, <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptors(source)); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptor(target2, <span class="hljs-string"><span class="hljs-string">'foo'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// { get: undefined, set: [Function: foo], enumerable: true, configurable: true }</span></span></code> </pre> <br>  <b>Deuxi√®me</b> cas d'utilisation: clonage d'objets <br>  Le clonage superficiel est similaire √† la copie de propri√©t√©s, donc Object.getOwnPropertyDescriptors () est √©galement un bon choix ici. <br><br>  Cette fois, nous utilisons Object.create (), qui a deux param√®tres: <br>  Le premier param√®tre sp√©cifie le prototype de l'objet retourn√©. <br><br>  Un deuxi√®me param√®tre facultatif est une collection de descripteurs de propri√©t√©s, similaires √† ceux renvoy√©s par Object.getOwnPropertyDescriptors (). <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> clone = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(<span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(obj), <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptors(obj));</code> </pre> <br>  <b>Troisi√®me</b> cas d'utilisation: litt√©raux d'objets multiplateformes avec des prototypes arbitraires. <br><br>  La meilleure fa√ßon syntaxiquement d'utiliser un litt√©ral d'objet pour cr√©er un objet avec un prototype arbitraire est d'utiliser la propri√©t√© sp√©ciale __proto__: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = { <span class="hljs-attr"><span class="hljs-attr">__proto__</span></span>: prot, <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, };</code> </pre> <br>  H√©las, cette fonctionnalit√© est garantie d'√™tre pr√©sente uniquement dans les navigateurs.  La solution de contournement g√©n√©rale est Object.create () et l'affectation: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(prot); obj.foo = <span class="hljs-number"><span class="hljs-number">123</span></span>;</code> </pre> <br>  Mais vous pouvez √©galement utiliser Object.getOwnPropertyDescriptors (): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create( prot, <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getOwnPropertyDescriptors({ <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, }) );</code> </pre> <br>  Une autre alternative est Object.assign (): <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> obj = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.assign( <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.create(prot), { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-number"><span class="hljs-number">123</span></span>, } );</code> </pre> <br>  Pi√®ge: copier des m√©thodes en utilisant super. <br><br>  La m√©thode que super utilise est √©troitement li√©e √† son objet d'origine (l'objet dans lequel il est stock√©).  Il n'existe actuellement aucun moyen de copier ou d√©placer une telle m√©thode vers un autre objet. <br><br>  Voir Object.getOwnPropertyDescriptor dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">sp√©cification</a> officielle, ainsi que dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section006"></a><h2>  6. Virgules de fin </h2><br>  Les virgules suspendues (virgules de fin) - peuvent √™tre utiles lors de l'ajout de nouveaux √©l√©ments, param√®tres ou propri√©t√©s au code JavaScript.  Si vous souhaitez ajouter une nouvelle propri√©t√©, vous ajoutez simplement une nouvelle ligne sans changer la pr√©c√©dente, si la virgule suspendue y est d√©j√† utilis√©e.  Cela rend les diff√©rences dans le contr√¥le de version plus propres et les changements de code peuvent √™tre moins g√™nants. <br><br><h4>  Accrocher des virgules dans les litt√©raux </h4><br>  <b>Tableaux</b> <br><br>  JavaScript ignore les virgules suspendues dans les tableaux: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arr = [ <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, ]; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(arr); <span class="hljs-comment"><span class="hljs-comment">// [0, 1, 2] console.log(arr.length); // 3 var arr2 = [0, 1, 2,,,]; console.log(arr2.length); // 5 arr2.forEach((e) =&gt; console.log(e)); // 0 1 2 console.log(arr.map((e) =&gt; e)); // 0 1 2</span></span></code> </pre> <br>  Si plusieurs points pendants sont utilis√©s, des trous seront cr√©√©s.  Un tableau avec des ¬´trous¬ª est appel√© clairsem√© (un tableau dense n'a pas de ¬´trous¬ª).  Lors de l'it√©ration d'un tableau en utilisant, par exemple, Array.prototype.forEach () ou Array.prototype.map (), les trous seront ignor√©s. <br><br>  <b>Les objets</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> object = { <span class="hljs-attr"><span class="hljs-attr">foo</span></span>: <span class="hljs-string"><span class="hljs-string">"bar"</span></span>, <span class="hljs-attr"><span class="hljs-attr">baz</span></span>: <span class="hljs-string"><span class="hljs-string">"qwerty"</span></span>, <span class="hljs-attr"><span class="hljs-attr">age</span></span>: <span class="hljs-number"><span class="hljs-number">42</span></span>, }; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(object); <span class="hljs-comment"><span class="hljs-comment">// {foo: "bar", baz: "qwerty", age: 42}</span></span></code> </pre> <br><h4>  Suspendre des virgules dans les fonctions </h4><br>  <b>D√©finition des param√®tres</b> <br><br>  Les d√©finitions suivantes des param√®tres de fonction sont valides et √©quivalentes les unes aux autres.  Les virgules pendantes n'affectent pas la propri√©t√© length d'une fonction ou leur objet arguments. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p</span></span></span><span class="hljs-function">) </span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p,</span></span></span><span class="hljs-function">) </span></span>{} (p) =&gt; {}; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">p,</span></span></span><span class="hljs-function">) =&gt;</span></span> {};</code> </pre> <br>  <b>D√©finition de la m√©thode</b> <br><br>  La virgule suspendue fonctionne √©galement avec la d√©finition de m√©thodes pour les classes ou les objets. <br><br><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">C</span></span></span><span class="hljs-class"> </span></span>{ one(a,) {}, two(a, b,) {}, } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> obj = { one(a,) {}, two(a, b,) {}, };</code> </pre> <br>  <b>Appel de fonction</b> <br><br>  Les appels de fonction suivants sont valides et √©quivalents les uns aux autres. <br><br><pre> <code class="javascript hljs">f(p); f(p,); <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>,);</code> </pre> <br>  <b>Virgules suspendues non valides</b> <br><br>  La d√©finition de param√®tres de fonction ou l'appel d'une fonction contenant uniquement une virgule d√©clenche une SyntaxError.  De plus, lors de l'utilisation des param√®tres restants, les virgules suspendues ne sont pas autoris√©es. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">,</span></span></span><span class="hljs-function">) </span></span>{} <span class="hljs-comment"><span class="hljs-comment">// SyntaxError: missing formal parameter (,) =&gt; {}; // SyntaxError: expected expression, got ',' f(,) // SyntaxError: expected expression, got ',' function f(...p,) {} // SyntaxError: parameter after rest parameter (...p,) =&gt; {} // SyntaxError: expected closing parenthesis, got ','</span></span></code> </pre> <br><h4>  Suspendre des virgules dans la d√©structuration </h4><br>  Les virgules suspendues peuvent √©galement √™tre utilis√©es √† gauche lors de l'utilisation d'une affectation destructrice. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//      [a, b,] = [1, 2]; //      var o = { p: 42, q: true, }; var {p, q,} = o;</span></span></code> </pre> <br>  Encore une fois, en utilisant les param√®tres restants, une SyntaxError sera lanc√©e. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> [a, ...b,] = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// Uncaught SyntaxError: Rest element must be last element</span></span></code> </pre> <br><h4>  JSON Dangling Commas </h4><br>  Les virgules suspendues dans un objet ne sont autoris√©es que dans ECMAScript 5. √âtant donn√© que JSON est bas√© sur une syntaxe JavaScript ant√©rieure √† ES5, les <b>virgules suspendues</b> ne sont pas autoris√©es <b>dans JSON.</b> <br><br>  Les deux lignes lancent une SyntaxError <br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(<span class="hljs-string"><span class="hljs-string">'[1, 2, 3, 4, ]'</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">JSON</span></span>.parse(<span class="hljs-string"><span class="hljs-string">'{"foo" : 1, }'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// Uncaught SyntaxError: Unexpected token ] in JSON // Uncaught SyntaxError: Unexpected token } in JSON</span></span></code> </pre> <br><h4>  Pourquoi les virgules suspendues sont-elles utiles? </h4><br>  Il y a deux avantages. <br><br>  Tout d'abord, la r√©organisation des √©l√©ments est plus facile car vous n'avez pas besoin d'ajouter ou de supprimer des virgules si le dernier √©l√©ment change de position. <br><br>  Deuxi√®mement, il aide les syst√®mes de contr√¥le de version √† suivre ce qui a vraiment chang√©.  Par exemple, √† partir de: <br><br><pre> <code class="plaintext hljs">[ 'Foo' ] : [ 'Foo', '' ]</code> </pre> <br>  fait que la ligne avec 'foo' et la ligne avec 'bar' sont marqu√©es comme modifi√©es, bien que le seul vrai changement soit d'ajouter la derni√®re ligne. <br><br>  Voir Virgules de fin dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">MDN Web Docs</a> . <br><br><a name="section007"></a><h2>  7. SharedArrayBuffer </h2><br>  L'objet SharedArrayBuffer est utilis√© pour cr√©er un tampon fractionn√© de longueur fixe pour le stockage de donn√©es binaires primitives, similaire √† l'objet ArrayBuffer, mais en revanche, les instances SharedArrayBuffer peuvent √™tre utilis√©es pour cr√©er une vue sur la m√©moire partag√©e.  SharedArrayBuffer ne peut pas √™tre d√©connect√©. <pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(length) : <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span></code> </pre>  length - La taille, en octets, pour cr√©er le tableau de tampons. <br><br>  return - Un nouvel objet SharedArrayBuffer de la longueur sp√©cifi√©e.  Son contenu apr√®s l'initialisation est 0. <br><br>  Pour partager la m√©moire √† l'aide de l'objet SharedArrayBuffer entre un agent du cluster et un autre (l'agent peut √™tre soit le programme principal de la page Web, soit l'un des travailleurs Web), postMessage et le clonage structur√© sont utilis√©s. <br><br>  L'algorithme de clonage structur√© accepte SharedArrayBuffers et TypedArrays mapp√©s sur SharedArrayBuffers.  Dans les deux cas, l'objet SharedArrayBuffer est transmis au r√©cepteur, ce qui cr√©e un nouvel objet PrivateArrayBuffer priv√© √† l'int√©rieur de l'agent r√©cepteur (comme pour ArrayBuffer).  Cependant, le bloc de donn√©es partag√©es r√©f√©renc√© par les deux objets SharedArrayBuffer est le m√™me bloc de donn√©es et les effets tiers dans le bloc dans l'un des agents deviendront √©ventuellement visibles dans l'autre agent. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sab = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(<span class="hljs-number"><span class="hljs-number">1024</span></span>); worker.postMessage(sab);</code> </pre> <br>  La m√©moire partag√©e peut √™tre cr√©√©e et modifi√©e simultan√©ment dans les travailleurs ou le thread principal.  Selon le syst√®me (CPU, OS, navigateur), cela peut prendre du temps jusqu'√† ce que les modifications soient propag√©es √† tous les contextes.  Pour la synchronisation, des op√©rations atomiques sont n√©cessaires. <br><br>  Shared Array Buffers est un bloc de construction primitif pour les abstractions de parall√©lisme de niveau sup√©rieur.  Ils vous permettent de partager les octets d'un objet SharedArrayBuffer entre plusieurs travailleurs et le thread principal (le tampon est partag√© pour acc√©der aux octets, enveloppez-le dans un tableau typ√©).  Ce type d'√©change pr√©sente deux avantages: <br>  Vous pouvez √©changer des donn√©es entre les employ√©s plus rapidement. <br><br>  La coordination entre les travailleurs devient plus facile et plus rapide (par rapport √† postMessage ()). <br><br>  La mise en ≈ìuvre du travailleur est la suivante. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// worker.js self.addEventListener ('message', function (event) { const {sharedBuffer} = event.data; const sharedArray = new Int32Array (sharedBuffer); // ¬∑¬∑¬∑ });</span></span></code> </pre><br>  Tout d'abord, nous extrayons le tampon du tableau partag√© qui nous a √©t√© envoy√©, puis nous l'enveloppons dans un tableau typ√© afin de pouvoir l'utiliser localement. <br><br>  <b>Propri√©t√©s et m√©thodes de SharedArrayBuffer.</b> <br><br>  SharedArrayBuffer.length - La longueur du constructeur SharedArrayBuffer dont la valeur est 1. <br>  SharedArrayBuffer.prototype - Autorise des propri√©t√©s suppl√©mentaires pour tous les objets SharedArrayBuffer. <br><br>  <b>Instances SharedArrayBuffer</b> <br>  <b>Les propri√©t√©s</b> <br><br>  SharedArrayBuffer.prototype.constructor - D√©finit une fonction qui cr√©e un prototype d'un objet.  La valeur initiale est le constructeur standard SharedArrayBuffer int√©gr√©. <br><br>  SharedArrayBuffer.prototype.byteLength (lecture seule) - La taille du tableau en octets.  Ce param√®tre est d√©fini lors de la cr√©ation du tableau et ne peut pas √™tre modifi√©. <br><br>  <b>Les m√©thodes</b> <br><br>  SharedArrayBuffer.prototype.slice () - Renvoie un nouveau SharedArrayBuffer dont le contenu est une copie des octets de ce SharedArrayBuffer depuis le d√©but, y compris jusqu'√† la fin, de l'exclusif.  Si le d√©but ou la fin est n√©gatif, cela se r√©f√®re √† l'index √† la fin du tableau, pas au d√©but.  Cette m√©thode a le m√™me algorithme que Array.prototype.slice (). <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  SharedArrayBuffer     const buffer = new SharedArrayBuffer(16); const int32View = new Int32Array(buffer); //  view // produces Int32Array [0, 0, 0, 0] int32View[1] = 42; const sliced = new Int32Array(buffer.slice(4,12)); console.log(sliced); // Int32Array [42, 0]</span></span></code> </pre> <br><pre> <code class="javascript hljs">sab.slice([begin, end]) : <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span></code> </pre> <br>  begin - L'index z√©ro auquel commence l'extraction.  Vous pouvez utiliser un index n√©gatif indiquant le d√©calage √† partir de la fin de la s√©quence.  slice (-2) extrait les deux derniers √©l√©ments d'une s√©quence.  Si le d√©but n'est pas d√©fini, la tranche commence √† l'index 0. <br>  End - Index de base z√©ro auquel l'extraction doit √™tre termin√©e. <br><br>  Par exemple, la tranche (1,4) r√©cup√®re le deuxi√®me √©l√©ment via le quatri√®me √©l√©ment (√©l√©ments avec les indices 1, 2 et 3).  Vous pouvez utiliser un index n√©gatif indiquant le d√©calage √† partir de la fin de la s√©quence.  slice (2, -1) r√©cup√®re le troisi√®me √©l√©ment via l'avant-dernier √©l√©ment de la s√©quence.  Si end est omis, tranche r√©cup√®re jusqu'√† la fin de la s√©quence (sab.byteLength). <br><br>  <b>Des exemples</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sab = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(<span class="hljs-number"><span class="hljs-number">1024</span></span>); sab.slice(); <span class="hljs-comment"><span class="hljs-comment">// SharedArrayBuffer { byteLength: 1024 } sab.slice(2); // SharedArrayBuffer { byteLength: 1022 } sab.slice(-2); // SharedArrayBuffer { byteLength: 2 } sab.slice(0, 1); // SharedArrayBuffer { byteLength: 1 }</span></span></code> </pre> <br>  Voir SharedArrayBuffer dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">sp√©cification</a> officielle, ainsi que dans les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">documents Web MDN</a> . <br><br><a name="section008"></a><h2>  8. Atomics </h2><br>  L'objet Atomics fournit des op√©rations atomiques en tant que m√©thodes statiques.  Utilis√© avec un objet SharedArrayBuffer. <br><br>  Les op√©rations atomiques sont install√©es dans le module Atomics.  Contrairement √† d'autres objets globaux, Atomics n'est pas un constructeur.  Il ne peut pas √™tre utilis√© avec le nouvel op√©rateur ou pour appeler un objet Atomics en tant que fonction.  Toutes les propri√©t√©s et m√©thodes Atomics sont statiques (comme un objet Math, par exemple). <br><br>  Lorsque la m√©moire est partag√©e, plusieurs threads peuvent lire et √©crire les m√™mes donn√©es dans la m√©moire.  Les op√©rations atomiques garantissent que les valeurs attendues seront √©crites et lues, et les op√©rations termin√©es avant que la prochaine op√©ration ne commence son travail, et elles ne seront pas interrompues. <br><br><h4>  Les propri√©t√©s </h4><br>  Atomics [Symbol.toStringTag] - La valeur de cette propri√©t√© est Atomics. <br><br><h4>  Les m√©thodes </h4><br>  <b>Op√©rations atomiques</b> <br><br><ul><li>  Atomics.add () - Ajoute la valeur pr√©sent√©e √† la valeur actuelle √† la position sp√©cifi√©e dans le tableau.  Renvoie la valeur pr√©c√©dente √† cette position. </li><li>  Atomics.and () - Calcule un ET au niveau du bit √† la position de tableau sp√©cifi√©e.  Renvoie la valeur pr√©c√©dente √† cette position. </li><li>  Atomics.compareExchange () - Enregistre la valeur pr√©sent√©e √† la position sp√©cifi√©e du tableau, si elle est √©quivalente √† la valeur pr√©sent√©e.  Renvoie la valeur pr√©c√©dente. </li><li> Atomics.exchange() ‚Äî       .   . </li><li> Atomics.load() ‚Äî      . </li><li> Atomics.or() ‚Äî   OR    .      . </li><li> Atomics.store() ‚Äî       .  . </li><li> Atomics.sub() ‚Äî          .      . </li><li> Atomics.xor() ‚Äî   XOR    .      . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La m√©thode statique Atomics.add () ajoute la valeur √† la valeur actuelle √† la position sp√©cifi√©e dans le tableau et renvoie la valeur pr√©c√©dente √† cette position. </font><font style="vertical-align: inherit;">Cette op√©ration atomique garantit qu'aucune autre √©criture ne se produit tant que la valeur modifi√©e n'est pas r√©√©crite.</font></font><br><br><pre> <code class="javascript hljs">Atomics.add(typedArray, index, value) : mixed</code> </pre> <br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">typedArray - Un tableau divis√© d'entiers. </font><font style="vertical-align: inherit;">Int8Array, Uint8Array, Int16Array, Uint16Array, Int32Array ou Uint32Array.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> index - La position dans typedArray pour ajouter de la valeur. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value - Le nombre √† ajouter. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> return - La valeur pr√©c√©dente √† la position sp√©cifi√©e (typedArray [index]). </font></font></li></ul><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L√®ve une TypeError si le type typedArray n'est pas l'un des types entiers valides. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L√®ve une TypeError si le type typedArray n'est pas de type g√©n√©rique. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> L√®ve RangeError si l'index est en dehors de typedArray. </font></font></li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des exemples</font></font></b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sab = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SharedArrayBuffer(<span class="hljs-number"><span class="hljs-number">1024</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ta = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Uint8Array</span></span>(sab); Atomics.add(ta, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  0,   Atomics.load(ta, 0); // 12</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atomics.add () dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sp√©cification</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MDN Web Docs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Attendez et informez </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les m√©thodes wait () et wake () sont mod√©lis√©es sur la base de futex (¬´mutex fast user-space mutex¬ª) Linux et fournissent des moyens d'attendre un moment o√π un certain √©tat ne devient pas vrai, et est g√©n√©ralement utilis√© comme constructions de blocage. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Atomics.wait () </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V√©rifie </font><font style="vertical-align: inherit;">si la </font><font style="vertical-align: inherit;">valeur qui est toujours repr√©sent√©e est contenue dans la position sp√©cifi√©e du tableau et est en attente de temporisation. </font><font style="vertical-align: inherit;">Renvoie ok, non √©gal ou expir√©. </font><font style="vertical-align: inherit;">Si l'attente n'est pas autoris√©e dans l'agent appelant, elle g√©n√©rera une erreur d'exception (la plupart des navigateurs n'autorisent pas wait () dans le flux principal du navigateur).</font></font><br><br><ul><li> Atomics.wait() ‚Äî ,               -.  ¬´ok¬ª, ¬´not-equal¬ª  ¬´timed-out¬ª.       ,     (    wait()    ). </li><li> Atomics.wake() ‚Äî   ,         .   ,   . </li><li> Atomics.isLockFree(size) ‚Äî  ,            .  true,                 (  ).   . </li></ul><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Probl√®mes d'optimisation </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'optimisation rend le code impr√©visible chez les travailleurs. </font><font style="vertical-align: inherit;">Dans les threads uniques, les compilateurs peuvent effectuer des optimisations qui cassent le code multithread. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Prenons, par exemple, le code suivant:</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (sharedArray [<span class="hljs-number"><span class="hljs-number">0</span></span>] === <span class="hljs-number"><span class="hljs-number">123</span></span>);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans un seul thread, la valeur de sharedArray [0] ne change jamais pendant l'ex√©cution de la boucle (si sharedArray est un tableau ou un tableau typ√© qui n'a √©t√© fix√© d'aucune fa√ßon). </font><font style="vertical-align: inherit;">Par cons√©quent, le code peut √™tre optimis√© comme suit:</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tmp = sharedArray [<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (tmp === <span class="hljs-number"><span class="hljs-number">123</span></span>);</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, en mode multithread, cette optimisation ne nous permet pas d'utiliser ce mod√®le pour attendre les modifications apport√©es dans un autre thread. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un autre exemple est le code suivant:</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// main.js sharedArray [1] = 11; sharedArray [2] = 22;</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans un thread, vous pouvez r√©organiser ces op√©rations d'√©criture car rien n'est lu entre elles. </font><font style="vertical-align: inherit;">Plusieurs threads rencontrent des probl√®mes lorsque vous vous attendez √† ce que les enregistrements soient effectu√©s dans un ordre sp√©cifique:</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// worker.js while (sharedArray [2]! == 22); console.log (sharedArray [1]); // 0  11</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ces types d'optimisation rendent presque impossible la synchronisation des actions de plusieurs travailleurs travaillant sur le m√™me tampon avec un tableau commun. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> R√©solution des probl√®mes d'optimisation </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utilisation de la variable globale Atomics, dont les m√©thodes ont trois utilisations principales. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Premier cas d'utilisation: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">synchronisation. </font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les m√©thodes atomiques peuvent √™tre utilis√©es pour se synchroniser avec d'autres travailleurs. </font><font style="vertical-align: inherit;">Par exemple, les deux op√©rations suivantes vous permettent de lire et d'√©crire des donn√©es et ne sont jamais r√©organis√©es par les compilateurs:</font></font><br><br><pre> <code class="javascript hljs">Atomics.load (TypedArray &lt;T&gt;, index) : T Atomics.store (TypedArray &lt;T&gt;, index, <span class="hljs-attr"><span class="hljs-attr">value</span></span>: T) : T</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'id√©e est d'utiliser des op√©rations ordinaires pour lire et √©crire la plupart des donn√©es, tandis que les op√©rations Atomics (chargement, stockage et autres) garantissent la s√©curit√© de la lecture et de l'√©criture. Vous utiliserez souvent vos propres m√©canismes de synchronisation, tels que les verrous, qui sont bas√©s sur Atomics. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici un exemple tr√®s simple qui fonctionne toujours gr√¢ce √† Atomics (j'ai saut√© le param√®tre sharedArray):</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// main.js console.log ('notified...'); Atomics.store (sharedArray, 0, 123); // worker.js while (Atomics.load (sharedArray, 0)! == 123); console.log ('notified');</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deuxi√®me cas d'utilisation: en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">attente de notification</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisation d'une boucle while pour attendre une notification n'est pas tr√®s efficace, donc Atomics a des op√©rations qui aident: Atomics.wait (Int32Array, index, valeur, timeout) et Atomics.wake (Int32Array, index, count). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Troisi√®me cas d'utilisation: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">op√©rations atomiques</font></font></b> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Certaines </font><b><font style="vertical-align: inherit;">op√©rations</font></b><font style="vertical-align: inherit;"> Atomics font de l'arithm√©tique et ne peuvent pas √™tre interrompues en m√™me temps, ce qui facilite la synchronisation.</font></font> Par exemple: <br><br><pre> <code class="javascript hljs">Atomics.add (TypedArray &lt;T&gt;, index, value) : T</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En gros, cette op√©ration effectue: index + = valeur; </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Probl√®me avec des valeurs d√©chir√©es. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un autre effet de probl√®me avec la m√©moire partag√©e est les valeurs d√©chir√©es (ordures): lors de la lecture, vous pouvez voir une valeur interm√©diaire - ni la valeur avant l'√©criture de la nouvelle valeur en m√©moire, ni la nouvelle valeur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La section Lectures sans d√©chirures de la sp√©cification indique qu'il n'y a pas de lacunes si et seulement si:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La lecture et l'√©criture s'effectuent via des tableaux typ√©s (et non DataViews). </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Les deux tableaux typ√©s sont align√©s avec leurs tampons de tableau partag√©: sharedArray.byteOffset% sharedArray.BYTES_PER_ELEMENT === 0 </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Les deux tableaux typ√©s ont le m√™me nombre d'octets par √©l√©ment. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En d'autres termes, les valeurs d√©chir√©es sont un probl√®me lorsque le m√™me tampon d'un tableau partag√© est accessible via: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Un ou plusieurs DateViews; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il existe un ou plusieurs tableaux typ√©s non align√©s; </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tableaux typ√©s avec diff√©rentes tailles d'√©l√©ments; </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pour √©viter un √©cart de valeurs dans ces cas, utilisez Atomics ou sync. </font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Tampons de baie partag√©e dans les utilisations </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tampons de tableau partag√© et s√©mantique JavaScript pour ex√©cuter une fonction en attente. JavaScript a la soi-disant s√©mantique d'ex√©cution ¬´avant la fin¬ª: chaque fonction peut s'attendre √† ce qu'elle ne soit pas interrompue par un autre thread tant qu'elle n'est pas termin√©e. Les fonctions deviennent des transactions et peuvent ex√©cuter des algorithmes complets, tandis que personne ne voit les donn√©es avec lesquelles elles fonctionnent dans un √©tat interm√©diaire. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les tampons de tableau partag√© interrompent le cycle jusqu'√† la fin (RTC): les donn√©es sur lesquelles la fonction travaille peuvent √™tre modifi√©es par un autre thread pendant l'ex√©cution de la fonction. Cependant, le code contr√¥le enti√®rement si cette violation RTC se produit: s'il n'utilise pas de tampons de baie partag√©e, il est s√ªr.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ceci est √† peu pr√®s similaire √† la fa√ßon dont les fonctions asynchrones violent RTC. L√†, vous activez l'op√©ration de verrouillage √† l'aide du mot-cl√© wait. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les buffers de baies partag√©es permettent √† emscripten de compiler des pthreads dans asm.js. Citant la page de documentation emscripten: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Fr] [Les tampons de </font><font style="vertical-align: inherit;">la baie </font><font style="vertical-align: inherit;">partag√©e permettent] aux applications Emscripten de partager le tas de m√©moire principal entre les travailleurs Web. Ceci, ainsi que les primitives pour la prise en charge atomique et futex de bas niveau, permet √† Emscripten d'impl√©menter la prise en charge de l'API Pthreads (threads POSIX). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Ru] [Les tampons de baies partag√©es permettent] aux applications Emscripten de partager un tas de m√©moire principale entre les travailleurs Web. Avec les primitives atomiques de bas niveau et la prise en charge de futex, Emscripten permet la prise en charge de l'API Pthreads (threads POSIX).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Autrement dit, vous pouvez compiler du code C et C ++ multithread dans asm.js. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Des discussions sont en cours sur la meilleure fa√ßon d'utiliser le multithreading dans WebAssembly. </font><font style="vertical-align: inherit;">√âtant donn√© que les travailleurs Web sont relativement lourds, il est possible que WebAssembly introduise des threads l√©gers. </font><font style="vertical-align: inherit;">Vous pouvez √©galement voir que les rubriques sont en route vers l'avenir de WebAssembly.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √âchanger des donn√©es autres que des entiers </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Actuellement, seuls les tableaux d'entiers (jusqu'√† 32 bits de long) peuvent √™tre utilis√©s. </font><font style="vertical-align: inherit;">Cela signifie que la seule fa√ßon de partager d'autres types de donn√©es est de les coder sous forme d'entiers. </font><font style="vertical-align: inherit;">Les outils qui peuvent vous aider comprennent:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TextEncoder et TextDecoder: le premier convertit les cha√Ænes en instances Uint8Array, le second fait le contraire. </font></font></li><li> stringview.js: ,      .   . </li><li> FlatJS:  JavaScript        (,   )    (ArrayBuffer  SharedArrayBuffer). JavaScript + FlatJS    JavaScript. JavaScript  (TypeScript  . .) . </li><li> TurboScript:  JavaScript-    .    asm.js  WebAssembly. </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En fin de compte, il est probable que des m√©canismes suppl√©mentaires - de niveau sup√©rieur - pour l'√©change de donn√©es apparaissent. Et les exp√©riences continueront de d√©terminer √† quoi devraient ressembler ces m√©canismes. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans quelle mesure le code utilisant les tampons de la baie partag√©e fonctionne-t-il plus rapidement?</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Lars T. Hansen a √©crit deux impl√©mentations de l'algorithme Mandelbrot (comme d√©crit dans son article ¬´ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un go√ªt des nouvelles primitives parall√®les de JavaScript</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬ª, une version s√©quentielle et une version parall√®le qui utilise plusieurs travailleurs Web. Jusqu'√† 4 travailleurs Web et, par cons√©quent, c≈ìurs de processeur, acc√©l√©ration augmente de fa√ßon presque lin√©aire, passant de 6,9 ‚Äã‚Äãimages par seconde (1 travailleur Web) √† 25,4 images par seconde (4 travailleurs Web). De plus, les travailleurs Web apportent des am√©liorations de productivit√© suppl√©mentaires, mais plus modestes.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hansen note que les acc√©l√©rations sont impressionnantes, mais le travail parall√®le est d√ª √† un code plus complexe. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informations suppl√©mentaires</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur les tampons de baies partag√©es et les technologies de prise en charge:</font></font><br><br><ul><li> <a href="" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M√©moire partag√©e - un bref tutoriel</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de Lars T. Hansen</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Un avant-go√ªt des nouvelles primitives parall√®les de JavaScript</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par Lars T. Hansen</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SharedArrayBuffer et Atomics Stage 2.95 √† Stage 3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (PDF), slides de Shu-yu Guo et Lars T. Hansen (2016-11-30) [slides accompagnant la phrase ES]</font></font></li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les bases des travailleurs Web</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> par Eric Bidelman [introduction aux travailleurs Web].</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Autres technologies de concurrence JavaScript: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¬´ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le chemin vers JavaScript parall√®le</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ¬ª par Dave Herman [aper√ßu g√©n√©ral de la position de JavaScript apr√®s l'abandon de PJS]</font></font></li><li> ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Write massively-parallel GPU code for the browser with WebGL</a> ‚Äù by Steve Sanderson [ , ,   WebGL      GPU]. </li><li> ‚Äú <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Concurrency is not parallelism</a> ‚Äù by Rob Pike [Rob Pike   ¬´concurrency¬ª  ¬´parallelism¬ª    ]. </li><li> " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Using Web Workers</a> " from MDN [  MDN,      web workers]. </li><li> " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow">Shared memory and atomics</a> " by Axel Rauschmayer [     js   Shared Array Buffers  Atomics] </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voir Objet Atomics dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sp√©cification</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> officielle </font><font style="vertical-align: inherit;">, ainsi que dans les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documents Web MDN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><a name="section009"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 9. Fonctions asynchrones </font></font></h2><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cr√©ation d'une fonction Async √† l'aide du constructeur AsyncFunction </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le constructeur AsyncFunction cr√©e un nouvel objet fonction async. </font><font style="vertical-align: inherit;">En JavaScript, toute fonction asynchrone est en fait un objet AsyncFunction. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Notez que AsyncFunction n'est pas un objet global. </font><font style="vertical-align: inherit;">Il peut √™tre obtenu en ex√©cutant le code suivant.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}).constructor</code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syntaxe</font></font></b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AsyncFunction([arg1[, arg2[, ...argN]],] functionBody)</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">arg1, arg2, ... argN - Noms utilis√©s par la fonction comme noms d'arguments formels. Chaque nom doit √™tre une cha√Æne qui correspond √† un identifiant JavaScript valide ou √† une liste de ces cha√Ænes s√©par√©es par des virgules; par exemple, ¬´x¬ª, ¬´theValue¬ª ou ¬´a, b¬ª. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">functionBody - Une cha√Æne contenant la d√©finition d'une fonction dans le code source JavaScript. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les objets de fonction Async cr√©√©s avec le constructeur AsyncFunction seront analys√©s au moment o√π la fonction est cr√©√©e. Cela est moins efficace que de d√©clarer une fonction asynchrone √† l'aide de l'expression de fonction asynchrone et de l'appeler dans votre code, car ces fonctions sont analys√©es avec le reste du code.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tous les arguments pass√©s √† la fonction sont trait√©s comme les noms des identificateurs de param√®tre dans la fonction cr√©√©e dans l'ordre dans lequel ils sont pass√©s. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'appel du constructeur AsyncFunction en tant que fonction (sans utiliser le nouvel op√©rateur) a le m√™me effet que l'appel en tant que constructeur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les fonctions asynchrones cr√©√©es √† l'aide du constructeur AsyncFunction ne court-circuitent pas les contextes qui les cr√©ent; Ils sont toujours cr√©√©s dans la port√©e globale. Au d√©marrage, ils ne pourront acc√©der qu'√† leurs variables locales et globales, mais n'ont pas acc√®s aux √©tendues dans lesquelles le constructeur AsyncFunction a √©t√© appel√©. C'est diff√©rent de l'utilisation d'eval avec le code de la fonction asynchrone. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemple de cr√©ation d'une fonction asynchrone √† l'aide du constructeur AsyncFunction</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolveAfter2Seconds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { resolve(x); }, <span class="hljs-number"><span class="hljs-number">2000</span></span>); }); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> AsyncFunction = <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>.getPrototypeOf(<span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}).constructor <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AsyncFunction(<span class="hljs-string"><span class="hljs-string">'a'</span></span>, <span class="hljs-string"><span class="hljs-string">'b'</span></span>, <span class="hljs-string"><span class="hljs-string">'return await resolveAfter2Seconds(a) + await resolveAfter2Seconds(b);'</span></span>); a(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(v); <span class="hljs-comment"><span class="hljs-comment">//  30  4  });</span></span></code> </pre> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> D√©claration de fonction asynchrone </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La d√©claration de fonction asynchrone d√©finit une fonction asynchrone qui renvoie un objet AsyncFunction. </font><font style="vertical-align: inherit;">Vous pouvez √©galement d√©finir des fonctions asynchrones √† l'aide de l'expression de fonction asynchrone. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Syntaxe</font></font></b> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">name</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[param[, param[, ... param]]]</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// body }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">name - Le nom de la fonction. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">param - Le nom de l'argument √† passer √† la fonction. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instructions - Une expression contenant le corps de la fonction. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apr√®s l'appel, la fonction async renvoie Promise. Une fois le r√©sultat re√ßu, Promise est termin√©e et renvoie la valeur re√ßue. Lorsque la fonction async l√®ve une exception, Promise √©choue avec une valeur throws. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La fonction async peut contenir une expression d'attente qui suspend l'ex√©cution de la fonction async et attend une r√©ponse de la promesse pass√©e, puis reprend la fonction async et renvoie la valeur re√ßue. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le mot cl√© wait n'est valide que dans les fonctions asynchrones. Dans un autre contexte, vous obtiendrez une erreur SyntaxError.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le but des fonctions async / attente est de simplifier l'utilisation des promesses de fa√ßon synchrone et de reproduire une action sur le groupe Promises. </font><font style="vertical-align: inherit;">Tout comme les promesses sont comme des rappels structur√©s, async / wait est comme une combinaison de g√©n√©rateurs et de promesses.</font></font><br><br>  <b>Exemple</b> <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resolveAfter2Seconds</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve</span></span></span><span class="hljs-function"> =&gt;</span></span> { setTimeout(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> { resolve(x); }, <span class="hljs-number"><span class="hljs-number">2000</span></span>); }); } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add1</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> resolveAfter2Seconds(<span class="hljs-number"><span class="hljs-number">20</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> b = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> resolveAfter2Seconds(<span class="hljs-number"><span class="hljs-number">30</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x + a + b; } add1(<span class="hljs-number"><span class="hljs-number">10</span></span>).then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">v</span></span></span><span class="hljs-function"> =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(v); <span class="hljs-comment"><span class="hljs-comment">//  60  4  }); async function add2(x) { const a = resolveAfter2Seconds(20); const b = resolveAfter2Seconds(30); return x + await a + await b; } add2(10).then(v =&gt; { console.log(v); //  60  2  });</span></span></code> </pre> <br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √Ä quoi sert l'asynchronie? </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vous pouvez √©crire votre programme JS dans un fichier .js, mais votre code sera tr√®s probablement divis√© en plusieurs parties. Et une seule des parties sera ex√©cut√©e maintenant, et le reste sera ex√©cut√© plus tard. La fonction est la technique la plus utilis√©e pour diviser un programme en plusieurs parties. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le principal probl√®me de la plupart des d√©veloppeurs qui voient JS pour la premi√®re fois est le manque de compr√©hension de ce qui ne se produira pas imm√©diatement apr√®s. En d'autres termes, les t√¢ches qui ne peuvent pas √™tre termin√©es maintenant, par d√©finition, se termineront de mani√®re asynchrone. Et nous n'aurons pas le comportement de blocage du programme que nous supposons. (You-Dont-Know-JS / async &amp; performance, Jake Archibald).</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ajax(..)  Ajax-,   var data = ajax( "http://some.url.1" ); console.log( data );// !  `data`     Ajax-</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Quelle est l'erreur ici? </font><font style="vertical-align: inherit;">console.log () ex√©cut√© avant que nous ayons re√ßu les donn√©es de la demande. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La d√©cision √©vidente d '¬´attendre¬ª de maintenant √† plus tard est d'utiliser des rappels:</font></font><br><br><pre> <code class="javascript hljs">ajax( <span class="hljs-string"><span class="hljs-string">"http://some.url.1"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">myCallbackFunction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( data ); <span class="hljs-comment"><span class="hljs-comment">// ,   ! } );</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Consid√©rez diverses m√©thodes pour r√©soudre pr√©matur√©ment l'ex√©cution de code synchrone. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nous avons 3 fonctions getUser, getPosts, getComments.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { getUser, getPosts, getComments } = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./db'</span></span>); getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>, (error, user) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); getPosts(user.id, (error, posts) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); getComments(posts[<span class="hljs-number"><span class="hljs-number">0</span></span>].id, (error, comment) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(error) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(comments); }); }); });</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans cet exemple, il est difficile de ne pas remarquer la pyramide, qui augmente avec l'ajout de nouvelles fonctions. Ce style de codage est commun√©ment appel√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Callback Hell</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Il s'agit d'un certain sch√©ma qui vous permet de contr√¥ler les demandes concurrentes (asynchrones), ce qui garantit la s√©quence de leur ex√©cution. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une partie de la solution au probl√®me des fonctions d'imbrication consiste √† utiliser Promise (dont j'ai parl√© dans mon dernier </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui le supprime et rend le code plus propre. Ils fournissent √©galement un moyen plus pratique de g√©rer les erreurs. Mais beaucoup n'aimaient pas cette syntaxe.</font></font><br><br><pre> <code class="javascript hljs">getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function"> =&gt;</span></span> getPosts(user,id)) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">posts</span></span></span><span class="hljs-function"> =&gt;</span></span> getComments(posts[<span class="hljs-number"><span class="hljs-number">0</span></span>].id)) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">comments</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(comments)) .catch(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">error</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(error));</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les g√©n√©rateurs sont devenus une alternative √† Promise (que j'ai √©galement examin√©e dans un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pr√©c√©dent </font><font style="vertical-align: inherit;">. Le g√©n√©rateur lui-m√™me n'est pas adapt√© pour √©crire du code asynchrone, mais si vous les utilisez avec Promise, nous obtenons quelque chose d'unique - du code asynchrone qui semble synchrone. En m√™me temps, les g√©n√©rateurs fournissent le m√©canisme de gestion des erreurs familier utilisant la construction try ... catch. Seuls les g√©n√©rateurs ont un gros inconv√©nient - pour les utiliser avec Promise, vous aurez besoin d'une fonction distincte qui contr√¥lera le processus du g√©n√©rateur A. Vous pouvez √©crire cette fonction vous-m√™me ou utiliser une biblioth√®que tierce, par exemple </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">co</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Dans cet exemple, j'ai √©crit mon impl√©mentation d'une telle fonction.</font></font><br><br><pre> <code class="javascript hljs">co(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">* (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> posts = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> getPosts(user.id); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> comments = <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> getComments(posts[<span class="hljs-number"><span class="hljs-number">0</span></span>].id); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(comments); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (error) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(error); } }); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">co</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">generator</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> iterator = generator(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">resolve, reject</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">prev</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { value, done } = iterator.next(prev); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (done) resolve(value); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>) value.then(run, reject); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> run(value); } run(); }); }</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Chacune des m√©thodes de travail avec du code asynchrone a ses avantages et ses inconv√©nients. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonctions de rappel (fonctions Calback) - Facile √† utiliser, mais avec une augmentation des fonctions imbriqu√©es, la lisibilit√© commence √† en souffrir. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Promesses (Promises) - √âl√©gant et confortable, mais difficile √† comprendre pour les d√©butants. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">G√©n√©rateurs (Generators) - Vous permettent d'√©crire du code asynchrone de mani√®re synchrone, mais ils n√©cessitent une fonction distincte, et le m√©canisme de fonctionnement des g√©n√©rateurs est tr√®s compliqu√©. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les fonctions asynchrones ont √©t√© cr√©√©es sur la base des promesses et des g√©n√©rateurs, afin de rendre le travail avec le code asynchrone simple et compr√©hensible. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Afin de comprendre ce que sont les fonctions asynchrones, consid√©rez l'exemple suivant:</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }; } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(user); <span class="hljs-comment"><span class="hljs-comment">// { id: 1 }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Maintenant, si vous rendez la fonction asynchrone (en ajoutant le mot cl√© async), la fonction renverra une promesse qui contient un objet avec la propri√©t√© id. </font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }; } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> user = getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(user); <span class="hljs-comment"><span class="hljs-comment">// Promise { {id: 1} }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ainsi, nous pouvons dire que toute fonction asynchrone renvoie Promis (ou plut√¥t encapsule dans Promis la valeur qu'elle doit renvoyer). </font><font style="vertical-align: inherit;">Si la valeur renvoy√©e √† la fonction asynchrone est d√©j√† une promesse, elle ne sera pas retourn√©e √† nouveau. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour obtenir la valeur de la promesse, nous pouvons utiliser la m√©thode then ().</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUser</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">id</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }; } getUser(<span class="hljs-number"><span class="hljs-number">1</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">user</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(user)); <span class="hljs-comment"><span class="hljs-comment">// { id: 1 }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ou nous pouvons utiliser le mot-cl√© attendent, qui sera discut√© plus tard. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Revenons √† notre premier exemple (seulement cette fois, nous utiliserons la fonction r√©elle pour envoyer une requ√™te HTTP.</font></font><br><br><pre> <code class="javascript hljs">fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function"> =&gt;</span></span> data.json()) .then(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(data));</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici √† quoi ressemble le code asynchrone en utilisant Promise. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais nous pouvons √©crire du code asynchrone comme synchrone si nous utilisons des fonctions asynchrones.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> response= <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.json(); } <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> sendRequest(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(a); } main();</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La seule chose que je n'aime pas, c'est que l'op√©rateur asynchrone ne peut √™tre utilis√© que dans les fonctions asynchrones. </font><font style="vertical-align: inherit;">Sinon, je n'aurais pas besoin d'utiliser la fonction main (). </font><font style="vertical-align: inherit;">Bien s√ªr, vous pouvez √©galement utiliser la m√©thode then (), mais le code ne sera plus comme asynchrone.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> response= <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.json(); } sendRequest() .then(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(data));</code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'essentiel est que nous n'utilisons pas de fonctions de rappel pour obtenir des donn√©es de fetch (). </font><font style="vertical-align: inherit;">Au lieu de cela, nous utilisons le mot cl√© wait, qui, pour ainsi dire, indique au runtime: attendez que la fonction fetch () s'ex√©cute et √©crive le r√©sultat dans la variable de r√©ponse. </font><font style="vertical-align: inherit;">Et en utilisant la fonction de rappel, nous disons: attendez que la fonction fetch () s'ex√©cute et appelez la fonction de rappel pour traiter les donn√©es. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voici la diff√©rence √©vidente entre l'utilisation de la fonction Promise et async</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  Promise function sendRequest() { return fetch(`https://jsonplaceholder.typicode.com/users/1`) .then(data =&gt; data.json()); } //  async function async function sendRequest() { let response = await fetch(`https://jsonplaceholder.typicode.com/users/1`); return response.json(); }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'op√©rateur wait ne peut √™tre utilis√© que dans le corps des fonctions asynchrones, et son action peut √™tre utilis√©e sur n'importe quelle fonction qui renvoie une promesse. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour g√©rer les exceptions dans les fonctions asynchrones, il est habituel d'utiliser la construction try ... catch.</font></font><br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">async</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendRequest</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> response = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> fetch(<span class="hljs-string"><span class="hljs-string">`https://jsonplaceholder.typicode.com/users/1`</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(<span class="hljs-string"><span class="hljs-string">"Unexpected error"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> response.json(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(error) { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(error); <span class="hljs-comment"><span class="hljs-comment">// Error: Unexpected error at sendRequest } }</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Et enfin ... </font></font><br><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//    async; await; async; await; async; await; async; await; In the System(); The function.sleep()s tonight~</span></span></code> </pre> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Voir D√©finitions des fonctions asynchrones dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sp√©cification</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> officielle </font><font style="vertical-align: inherit;">, ainsi que dans les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documents Web MDN</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr475074/">https://habr.com/ru/post/fr475074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr475062/index.html">Pr√©sentation de la connexion avec Apple - Syst√®me d'autorisation Apple</a></li>
<li><a href="../fr475064/index.html">.NET Core 3 pour Windows Desktop</a></li>
<li><a href="../fr475066/index.html">Les Chroniques de la faim du livre</a></li>
<li><a href="../fr475068/index.html">Nous enveloppons tout le trafic LAN en vpn sans limitation de vitesse</a></li>
<li><a href="../fr475072/index.html">Des stagiaires √† travers les yeux de l'entreprise</a></li>
<li><a href="../fr475076/index.html">Super-h√©ros sovi√©tiques, boogers tch√®ques et clone australien</a></li>
<li><a href="../fr475078/index.html">Pr√©sentation des wrappers de propri√©t√© dans SwiftUI</a></li>
<li><a href="../fr475082/index.html">Habr Weekly # 26 / Semaine de travail de quatre jours, GitLab est entr√© en politique, Yandex teste le robot de livraison Rover</a></li>
<li><a href="../fr475090/index.html">.NET Core avec Jupyter Notebooks Aper√ßu 1</a></li>
<li><a href="../fr475092/index.html">¬´Je le lirai plus tard¬ª: le sort difficile d'une collection hors ligne de pages Web</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>