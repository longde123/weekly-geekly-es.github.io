<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üéí üò° üå¥ Beispiel f√ºr die Implementierung einer kontinuierlichen Integration mit BuildBot ü•† üêç üçæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="(Bild von Computerizer von Pixabay) 
 
 Hallo! 

 Mein Name ist Evgeny Cherkin , ich bin Programmierer im Entwicklungsteam von Polymetal . 

 Wenn Sie...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Beispiel f√ºr die Implementierung einer kontinuierlichen Integration mit BuildBot</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460501/"><img src="https://habrastorage.org/webt/jj/-4/-g/jj-4-gindpovkdi6rbmzxax4yqu.jpeg" alt="Buildbot-Testkonfiguration"><br>  <i>(Bild von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Computerizer</a> von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pixabay)</a></i> <i><br></i> <br>  Hallo! <br><br>  Mein Name ist <b>Evgeny Cherkin</b> , ich bin Programmierer im Entwicklungsteam von <b>Polymetal</b> . <br><br>  Wenn Sie ein Gro√üprojekt starten, denken Sie: ‚ÄûWelche Software ist f√ºr die Wartung besser geeignet?‚Äú.  Ein IT-Projekt vor der Ver√∂ffentlichung der n√§chsten Version durchl√§uft eine Reihe von Phasen.  Es ist gut, wenn die Kette dieser Schritte automatisiert ist.  Der automatisierte Prozess zum Freigeben einer neuen Version eines IT-Projekts wird als <i>kontinuierliche Integration bezeichnet</i> .  <b>BuildBot hat</b> sich als guter Helfer f√ºr uns erwiesen und diesen Prozess implementiert. <br><br>  In diesem Artikel habe ich beschlossen, einen √úberblick √ºber die Funktionen von <b>BuildBot zu geben</b> .  Was kann diese Software?  Wie kann man sich ihm n√§hern und wie kann man mit ihm eine normale EFFEKTIVE ARBEITSBEZIEHUNG aufbauen?  Sie k√∂nnen unsere Erfahrung auch auf sich selbst anwenden, indem Sie auf Ihrer Maschine einen funktionierenden Service zum Zusammenstellen und Testen Ihres Projekts erstellen. <br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">Inhalt</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><td colspan="4" align="center"><h3>  Inhalt </h3></td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">1. Warum ist BuildBot?</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">2. Konzept unter der Leitung von BuildMaster</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">3. Installation</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">4. Erste Schritte</a> </td></tr><tr><td colspan="4" align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5. Konfiguration.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schritt f√ºr Schritt Rezept</a> </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5.1 BuildmasterConfig</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5.2 Arbeiter</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5.3 change_source</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5.4 Schuppen</a> </td></tr><tr><td colspan="2" align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5.5 BuildFactory</a> </td><td colspan="2" align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5.6 Bauherren</a> </td></tr><tr><td colspan="4" align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">6. Beispiel einer eigenen Konfiguration</a> </td></tr><tr><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">6.1 Auf dem Weg zu Ihrem master.cfg</a> </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">6.2 Mit svn arbeiten</a> </td><td colspan="2">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">6.3 Ein Brief an Sie: Reporter sind berechtigt zu erkl√§ren</a> </td></tr><tr><td colspan="4" align="center">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wir haben es geschafft!</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Herzliche Gl√ºckw√ºnsche</a> </td></tr></tbody></table></div><br></div></div><br><a name="Why"></a><h3>  1. Warum ist BuildBot? </h3><hr><br>  Fr√ºher bei habr-e bin ich auf Artikel zur Implementierung der <i>kontinuierlichen Integration</i> mit <b>BuildBot gesto√üen</b> .  Zum Beispiel schien mir dieser am informativsten.  Es gibt noch ein anderes Beispiel - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einfacher</a> .  Diese Artikel k√∂nnen mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">einem Beispiel aus dem Handbuch</a> gew√ºrzt werden, und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">das ist</a> danach in englischer Sprache.  Das Coup√© ist ein guter Ausgangspunkt.  Nachdem Sie diese Artikel gelesen haben, m√∂chten Sie wahrscheinlich <b>sofort</b> etwas auf <b>BuildBot</b> tun. <br><br>  H√∂r auf!  Hat es jemand in seinen Projekten verwendet?  Es stellt sich heraus, ja, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">viele haben</a> es in ihren Aufgaben angewendet.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beispiele f√ºr die</a> Verwendung von <b>BuildBot</b> finden <b>Sie</b> in den Google- <b>Codearchiven</b> . <br><br>  Was ist die Logik von Leuten, die <b>Buildbot verwenden</b> ?  Immerhin gibt es noch andere Tools: <b>CruiseControl</b> und <b>Jenkins</b> .  Ich werde so antworten.  F√ºr die meisten Aufgaben wird <b>Jenkins</b> wirklich ausreichen.  <b>BuildBot</b> wiederum ist anpassungsf√§higer und die dortigen Aufgaben lassen sich genauso einfach l√∂sen wie in <b>Jenkins</b> .  W√§hle dich.  Da wir jedoch nach einem Tool f√ºr ein sich entwickelndes Zielprojekt suchen, w√§hlen Sie das Tool, mit dem wir ausgehend von einfachen Schritten ein Build-System mit Interaktivit√§t und einer einzigartigen Benutzeroberfl√§che erstellen k√∂nnen. <br><br>  F√ºr diejenigen, deren Zielprojekt in Python geschrieben ist, stellt sich die Frage: ‚ÄûWarum nicht ein Integrationssystem w√§hlen, das eine klare Schnittstelle in Bezug auf die im Projekt verwendete Sprache hat?‚Äú.  Und dann ist es Zeit, die Vorteile von <b>BuildBot vorzustellen</b> . <br><blockquote>  Also unser ‚ÄûInstrumentalquartett‚Äú.  F√ºr mich selbst habe ich die vier Funktionen von <b>BuildBot definiert</b> : <br><ol><li>  Dies ist ein Open Source Framework unter der GPL </li><li>  Hierbei wird Python als Konfigurationstool verwendet und die erforderlichen Aktionen beschrieben. </li><li>  Dies ist eine Gelegenheit, eine Antwort von der Maschine zu erhalten, auf der die Montage stattfindet. </li><li>  Dies sind schlie√ülich die Mindestanforderungen f√ºr den Host.  Die Bereitstellung erfordert Python und Twisted, und es ist keine virtuelle Maschine oder Java-Maschine erforderlich. </li></ol><br></blockquote><a name="Concepts"></a><h3>  2. Konzept unter der Leitung von BuildMaster </h3><hr><br><img src="https://habrastorage.org/webt/so/qs/u1/soqsu1skae_0xuktzdemfv-n3yq.png" alt="BuildBot BuildMaster"><br><br>  Im Zentrum der Aufgabenverteilungsarchitektur steht <b>BuildMaster</b> .  Es ist ein Dienst, der: <br><br><ul><li>  <b>Verfolgt</b> √Ñnderungen im Projektquellbaum </li><li>  <b>Sendet die</b> Befehle, die der Worker-Dienst ausf√ºhren soll, um ein Projekt zu erstellen und zu testen </li><li>  <b>benachrichtigt</b> Benutzer √ºber die Ergebnisse der ergriffenen Ma√ünahmen </li></ul><br>  <b>BuildMaster wird</b> √ºber die Datei <b>master.cfg</b> konfiguriert.  Diese Datei befindet sich im Stammverzeichnis von <b>BuildMaster</b> .  Sp√§ter werde ich zeigen, wie diese Wurzel erstellt wird.  Die Datei <i>master.cfg selbst</i> enth√§lt Python, ein Skript, das <b>BuildBot-</b> Aufrufe verwendet. <br><br>  Der <b>n√§chstwichtigste BuildBot</b> hei√üt <b>Worker</b> .  Dieser Dienst kann auf einem anderen Host mit einem anderen Betriebssystem oder m√∂glicherweise auf <b>BuildMaster ausgef√ºhrt werden</b> .  Es kann auch in einer speziell vorbereiteten virtuellen Umgebung mit eigenen Paketen und Variablen vorhanden sein.  Diese virtuellen Umgebungen k√∂nnen mit Python-Dienstprogrammen wie <i>vertualenv, venv</i> vorbereitet werden. <br><br>  <b>BuildMaster</b> sendet Befehle an jeden <b>Worker</b> , der sie wiederum ausf√ºhrt.  Das hei√üt, es stellt sich heraus, dass der Prozess des Erstellens und Testens des Projekts unter Windows auf den Worker und unter Linux auf einen anderen Worker √ºbertragen werden kann. <br><br>  <i>Das Auschecken</i> des Projektquellcodes erfolgt bei jedem <b>Worker</b> . <br><br><a name="Install"></a><h3>  3. Installation </h3><hr><br>  Also lass uns gehen.  Ich werde Ubuntu 18.04 als Host verwenden.  Darauf werde ich einen <b>BuildMaster</b> -a und einen <b>Worker</b> -a platzieren.  Aber zuerst m√ºssen Sie python3.7 installieren: <br><br><pre><code class="bash hljs">sudo apt-get update sudo apt-get install python3.7</code> </pre> <br>  F√ºr diejenigen, die python3.7.2 anstelle von 3.7.1 ben√∂tigen, k√∂nnen Sie Folgendes tun: <br><br><pre> <code class="bash hljs">sudo apt-get update sudo apt-get software-properties-common sudo add-apt-repository ppa:deadsnakes/ppa sudo apt-get install python3.7 sudo ln -fs /usr/bin/python3.7 /usr/bin/python3 pip3 install --upgrade pip</code> </pre><br>  Der n√§chste Schritt ist die Installation von <i>Twited</i> und <b>BuildBot</b> sowie von Paketen, die zus√§tzliche <b>BuildBot</b> -a-Funktionen erm√∂glichen. <br><br><pre> <code class="bash hljs">/*   sudo        /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/lib/python3.7/dist-packages*/ <span class="hljs-comment"><span class="hljs-comment">#     Worker- sudo pip install twisted # twisted sudo pip install buildbot #BuildMaster #  pip install pysqlite3 #  sqllite    pip install jinja2 #framework  django,  web     pip install autobahn #Web c   BuildMaster-&gt;Worker pip install sqlalchemy sqlalchemy-migrate #     # Web  BuildBot-a pip install buildbot-www buildbot-grid-view buildbot-console-view buildbot-waterfall-view pip install python-dateutil #   web #         pip install buildbot-worker #Worker #  sudo pip install virtualenv # </span></span></code> </pre><br><a name="master"></a><h3>  4. Erste Schritte </h3><hr><br>  Zeit, einen <b>BuildMaster</b> zu erstellen.  Wir werden es im Ordner <i>/ home / habr / master haben</i> . <br><pre> <code class="bash hljs">mkdir master buildbot create-master master <span class="hljs-comment"><span class="hljs-comment">#    </span></span></code> </pre> <br><a name="createworker"></a>  Der n√§chste Schritt.  Erstellen Sie einen <b>Worker</b> .  Wir werden es im Ordner <i>/ home / habr / worker haben</i> . <br><pre> <code class="bash hljs">mkdir worker buildbot-worker create-worker --<span class="hljs-built_in"><span class="hljs-built_in">umask</span></span>=0o22 --keepalive=60 worker localhost:4000 yourWorkerName password</code> </pre><br>  Wenn Sie <b>Worker</b> starten, wird standardm√§√üig ein Ordner in <i>/ home / habr / worker</i> mit dem Namen des Projekts erstellt, der in <i>master.cfg</i> angegeben <i>ist</i> .  In dem Ordner mit dem Namen des Projekts erstellt er das Erstellungsverzeichnis, und dann wird das <i>Auschecken</i> darin durchgef√ºhrt.  Das Arbeitsverzeichnis f√ºr <b>Worker</b> ist das Verzeichnis <i>/ home / habr / yourProject / build</i> . <br><br>  <b>Goldener Schl√ºssel</b> <br>  Und nun zu dem, was ich im vorherigen Absatz geschrieben habe: Das Skript, das <b>Worker vom</b> <b>Master</b> remote in diesem Verzeichnis ausf√ºhren muss, wird nicht ausgef√ºhrt, da das Skript keine Berechtigung zum Ausf√ºhren hat.  Um die Situation zu beheben, ben√∂tigen Sie einen Schl√ºssel <a name="umask"></a>  <i>--umask = 0o22</i> , wodurch das Schreiben in dieses Verzeichnis <i>verboten wird</i> , jedoch <i>Startrechte verbleiben</i> .  Und das brauchen wir nur. <br><br>  <b>BuildMaster</b> und <b>Worker</b> stellen eine Verbindung zwischen ihnen her.  Es kommt vor, dass es abbricht und <b>Worker</b> einige Zeit auf eine Antwort von <b>BuildMaster</b> wartet.  Wenn keine Antwort empfangen wird, wird die Verbindung neu gestartet.  Der Schl√ºssel <b>--keepalive = 60</b> ist genau das, was Sie ben√∂tigen, um die Zeit anzugeben, nach der die <i>Verbindung neu</i> gestartet wird. <br><br><a name="Recept"></a><h3>  5. Konfiguration.  Schritt f√ºr Schritt Rezept </h3><hr><br>  <b>Die BuildMaster-</b> Konfiguration erfolgt auf der Maschinenseite, wo wir den Befehl <i>create-master</i> ausgef√ºhrt haben.  In unserem Fall ist dies das Verzeichnis <i>/ home / habr / master</i> .  Die Konfigurationsdatei <i>master.cfg ist</i> noch nicht vorhanden, aber der Befehl selbst hat die Datei <i>master.cmg.sample</i> bereits erstellt.  Sie m√ºssen es in <i>master.cfg.sample</i> in <i>master.cfg</i> <i>umbenennen</i> <br><pre> <code class="bash hljs">mv master.cfg.sample master.cfg</code> </pre> <br>  √ñffnen <i>wir</i> diese <i>master.cfg</i> .  Und wir werden analysieren, woraus es besteht.  Danach versuchen wir, eine eigene Konfigurationsdatei zu erstellen. <br><br><div class="spoiler">  <b class="spoiler_title">master.cfg</b> <div class="spoiler_text"><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>].append(changes.GitPoller( <span class="hljs-string"><span class="hljs-string">'git://github.com/buildbot/hello-world.git'</span></span>, workdir=<span class="hljs-string"><span class="hljs-string">'gitpoller-workdir'</span></span>, branch=<span class="hljs-string"><span class="hljs-string">'master'</span></span>, pollInterval=<span class="hljs-number"><span class="hljs-number">300</span></span>)) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>].append(schedulers.SingleBranchScheduler( name=<span class="hljs-string"><span class="hljs-string">"all"</span></span>, change_filter=util.ChangeFilter(branch=<span class="hljs-string"><span class="hljs-string">'master'</span></span>), treeStableTimer=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, builderNames=[<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>])) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>].append(schedulers.ForceScheduler( name=<span class="hljs-string"><span class="hljs-string">"force"</span></span>, builderNames=[<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>])) factory = util.BuildFactory() factory.addStep(steps.Git(repourl=<span class="hljs-string"><span class="hljs-string">'git://github.com/buildbot/hello-world.git'</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'incremental'</span></span>)) factory.addStep(steps.ShellCommand(command=[<span class="hljs-string"><span class="hljs-string">"trial"</span></span>, <span class="hljs-string"><span class="hljs-string">"hello"</span></span>], env={<span class="hljs-string"><span class="hljs-string">"PYTHONPATH"</span></span>: <span class="hljs-string"><span class="hljs-string">"."</span></span>})) c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>].append( util.BuilderConfig(name=<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>, workernames=[<span class="hljs-string"><span class="hljs-string">"example-worker"</span></span>], factory=factory)) c[<span class="hljs-string"><span class="hljs-string">'services'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'title'</span></span>] = <span class="hljs-string"><span class="hljs-string">"Hello World CI"</span></span> c[<span class="hljs-string"><span class="hljs-string">'titleURL'</span></span>] = <span class="hljs-string"><span class="hljs-string">"https://buildbot.github.io/hello-world/"</span></span> c[<span class="hljs-string"><span class="hljs-string">'buildbotURL'</span></span>] = <span class="hljs-string"><span class="hljs-string">"http://localhost:8010/"</span></span> c[<span class="hljs-string"><span class="hljs-string">'www'</span></span>] = dict(port=<span class="hljs-number"><span class="hljs-number">8010</span></span>, plugins=dict(waterfall_view={}, console_view={}, grid_view={})) c[<span class="hljs-string"><span class="hljs-string">'db'</span></span>] = { <span class="hljs-string"><span class="hljs-string">'db_url'</span></span> : <span class="hljs-string"><span class="hljs-string">"sqlite:///state.sqlite"</span></span>, }</code> </pre><br></div></div><br><a name="BC"></a><h4>  <u>5.1 BuildmasterConfig</u> </h4><br><pre> <code class="python hljs">c = BuildmasterConfig = {}</code> </pre> <br>  <i>BuildmasterConfig</i> - das Basisw√∂rterbuch der Konfigurationsdatei.  Es muss in der Konfigurationsdatei enthalten sein.  Zur Vereinfachung der Verwendung wird der Alias <i>"c"</i> in den Konfigurationscode eingegeben.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schl√ºsselnamen</a> in <i>c ["keyFromDist"]</i> sind feste Elemente f√ºr die Interaktion mit <b>BuildMaster</b> .  Unter jedem Schl√ºssel wird das entsprechende Objekt als Wert ersetzt. <br><br><a name="Worker"></a><h4>  <u>5.2 Arbeiter</u> </h4><br><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'workers'</span></span>] = [worker.Worker(<span class="hljs-string"><span class="hljs-string">"example-worker"</span></span>, <span class="hljs-string"><span class="hljs-string">"pass"</span></span>)]</code> </pre> <br>  Dieses Mal weisen wir auf die <b>BuildMaster-</b> Liste der <b>Worker hin</b> .  Wir haben <b>Worker</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">oben erstellt,</a> indem wir Ihren <b>Worker</b> <i>-Namen</i> und <i>Ihr</i> <i>Passwort angegeben haben</i> .  Jetzt m√ºssen sie anstelle von <i>Beispielarbeiter</i> angegeben und <i>√ºbergeben werden</i> . <br><br><a name="CS"></a><h4>  <u>5.3 change_source</u> </h4><br><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>].append(changes.GitPoller( <span class="hljs-string"><span class="hljs-string">'git://github.com/buildbot/hello-world.git'</span></span>, workdir=<span class="hljs-string"><span class="hljs-string">'gitpoller-workdir'</span></span>, branch=<span class="hljs-string"><span class="hljs-string">'master'</span></span>, pollInterval=<span class="hljs-number"><span class="hljs-number">300</span></span>))</code> </pre><br>  <i>Mit dem</i> Schl√ºssel <i>change_source</i> des <i>c-</i> W√∂rterbuchs erhalten wir Zugriff auf die Liste, in der Sie das Objekt <i>ablegen</i> m√∂chten, das das Repository mit <i>dem Projektquellcode abfragt</i> .  In diesem Beispiel wird das Git-Repository verwendet, das in bestimmten Abst√§nden abgefragt wird. <br><br>  Das erste Argument ist der Pfad zu Ihrem Repository. <br><br>  <i>workdir</i> ist der Pfad zu dem Ordner, in dem auf der <b>Arbeiterseite</b> relativ zum Pfad <i>/ home / habr / worker / yourProject / build</i> die lokale Version des Repositorys gespeichert wird. <br><br>  <i>Der Zweig</i> enth√§lt einen bestimmten Zweig im Repository, der √ºberwacht werden soll. <br><br>  <i>pollInterval</i> enth√§lt die Anzahl der Sekunden, nach denen <b>BuildMaster</b> das Repository nach √Ñnderungen <b>abfragt</b> . <br><br>  Es gibt verschiedene Methoden, um √Ñnderungen in einem Projekt-Repository zu verfolgen. <br><br>  Die einfachste Methode ist <i>Polling</i> . <b>Dies</b> bedeutet, dass <b>BuildMaster</b> den Server regelm√§√üig mit dem Repository <b>abfragt</b> .  Wenn das <b>Festschreiben</b> die √Ñnderungen im Repository widerspiegelt, erstellt <b>BuildMaster</b> mit einiger Verz√∂gerung ein internes <i>√Ñnderungsobjekt</i> und sendet es an den <i>Scheduler-</i> Ereignishandler, der die Schritte zum Erstellen und Testen des Projekts in <i>Worker</i> startet.  Unter diesen Schritten wird die <i>Aktualisierung des</i> Repositorys angezeigt.  Auf <b>Worker wird</b> eine lokale Kopie des Repositorys erstellt.  Details dieses Prozesses werden nachstehend in den n√§chsten beiden Abschnitten <b>( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5.4</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">5.5</a> )</b> offenbart. <br><br>  Eine noch elegantere Methode zum Verfolgen von √Ñnderungen im Repository besteht darin, Nachrichten direkt von dem Server, auf dem es sich befindet, an <b>BuildMaster</b> zu <b>senden,</b> um die Quellcodes des Projekts zu <b>√§ndern</b> .  In diesem Fall sendet der Server mit dem Projekt-Repository eine Nachricht an <b>BuildMaster</b> , sobald der Entwickler eine <b>Festschreibung vornimmt</b> .  Und das wird wiederum durch das Erstellen eines <i>PBChangeSource-</i> Objekts abgefangen.  Au√üerdem wird dieses Objekt an den <i>Scheduler √ºbertragen</i> , der die Schritte f√ºr die Montage des Projekts und dessen Test aktiviert.  Ein wichtiger Teil dieser Methode ist die Arbeit mit Server- <i>Hook-</i> Skripten im Repository.  In dem <i>Hook-</i> Skript, das f√ºr die Verarbeitung von Aktionen w√§hrend des <i>Festschreibens</i> verantwortlich ist, m√ºssen Sie das Dienstprogramm <i>sendchange aufrufen</i> und die Netzwerkadresse von <b>BuildMaster angeben</b> .  Sie m√ºssen <i>den</i> Netzwerkport <i>angeben, der PBChangeSource abh√∂rt</i> .  <i>PBChangeSource</i> ist √ºbrigens Teil von <b>BuildMaster</b> .  Diese Methode erfordert die Berechtigung <i>admin</i> -a auf dem Server, auf dem sich das Projektrepository befindet.  Zuerst m√ºssen Sie ein Backup-Repository erstellen. <br><br><a name="shedulers"></a><h4>  <u>5.4 Schuppen</u> </h4><br><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>].append(schedulers.SingleBranchScheduler( name=<span class="hljs-string"><span class="hljs-string">"all"</span></span>, change_filter=util.ChangeFilter(branch=<span class="hljs-string"><span class="hljs-string">'master'</span></span>), treeStableTimer=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, builderNames=[<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>])) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>].append(schedulers.ForceScheduler( name=<span class="hljs-string"><span class="hljs-string">"force"</span></span>, builderNames=[<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>]))</code> </pre><br>  <i>Scheduler</i> ist ein Element, das als Ausl√∂ser fungiert und die gesamte Montage- und Testkette eines Projekts ausf√ºhrt. <br><img src="https://habrastorage.org/webt/sh/1j/jo/sh1jjoo3rog47fsyjgqgorizyfs.png" alt="Buildbot Sheduler"><br><br>  Die von <i>change_source</i> aufgezeichneten <i>√Ñnderungen</i> wurden w√§hrend des Vorgangs von <b>BuildBot</b> -a in das <i>Change-</i> Objekt konvertiert, und jetzt erstellt jeder <i>darauf</i> basierende <i>Sheduler</i> Anforderungen zum Starten des Projekterstellungsprozesses.  Es wird jedoch auch festgelegt, wann diese Anforderungen an die Warteschlange gesendet werden sollen.  Objekt <a name="builder"></a>  <i>Builder</i> f√ºhrt eine Anforderungswarteschlange und √ºberwacht den Status der aktuellen Assembly auf einem separaten <b>Worker</b> -e.  <i>Builder</i> ist <b>sowohl f√ºr BuildMaster</b> -e als auch f√ºr <b>Worker</b> -e vorhanden.  Er sendet einen bestimmten <i>Build</i> von <b>BuildMaster</b> an <b>Worker</b> , eine Reihe von Schritten, die befolgt werden m√ºssen. <br>  Wir sehen, dass im aktuellen Beispiel solcher <i>Scheduler</i> 2 Teile erstellt werden.  Dar√ºber hinaus hat jeder seinen eigenen Typ. <br><br>  <i>SingleBranchScheduler</i> ist eine der beliebtesten Zeitplanklassen.  Es √ºberwacht einen Zweig und wird durch eine aufgezeichnete √Ñnderung in ihm ausgel√∂st.  Wenn er die √Ñnderungen sieht, kann er das Senden einer Konstruktionsanforderung verschieben (auf den im speziellen Parameter <i>treeStableTimer</i> angegebenen Zeitraum <i>verschieben</i> ).  Der <i>Name</i> gibt den Namen des Zeitplans an, der in der <b>BuildBot-</b> Webschnittstelle angezeigt wird.  In <i>ChangeFilter</i> wird ein <i>Filter</i> festgelegt, nachdem √Ñnderungen in der Verzweigung den Zeitplan zum Senden einer Erstellungsanforderung <i>auffordern</i> .  Der Name <i>Builder</i> -a wird in <i>builderNames angegeben</i> , die wir etwas sp√§ter angeben werden.  Der Name in unserem Fall entspricht dem Namen des Projekts: <i>yourProject</i> . <br><br>  <i>ForceScheduler ist eine</i> sehr einfache Sache.  Diese Art von Zeitplan wird durch einen Mausklick √ºber die <b>BuildBot-</b> Web-Oberfl√§che ausgel√∂st.  Parameter haben die gleiche Essenz wie in <i>SingleBranchScheduler</i> . <br><br>  <b>PS Nr. 3.</b>  <b>Pl√∂tzlich n√ºtzlich sein</b> <br>  <i>Periodisch</i> ist ein Zeitplan, der mit einer bestimmten zeitlich festgelegten Frequenz ausgel√∂st wird.  Es sieht aus wie ein Anruf wie dieser <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> buildbot.plugins <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> schedulers nightly = schedulers.Periodic(name=<span class="hljs-string"><span class="hljs-string">"daily"</span></span>, builderNames=[<span class="hljs-string"><span class="hljs-string">"full-solaris"</span></span>], periodicBuildTimer=<span class="hljs-number"><span class="hljs-number">24</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>*<span class="hljs-number"><span class="hljs-number">60</span></span>) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>] = [nightly]</code> </pre><br><a name="buildfactory"></a><h4>  <u>5.5 BuildFactory</u> </h4><br><pre> <code class="python hljs">factory = util.BuildFactory() factory.addStep(steps.Git(repourl=<span class="hljs-string"><span class="hljs-string">'git://github.com/buildbot/hello-world.git'</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'incremental'</span></span>)) factory.addStep(steps.ShellCommand(command=[<span class="hljs-string"><span class="hljs-string">"trial"</span></span>, <span class="hljs-string"><span class="hljs-string">"hello"</span></span>], env={<span class="hljs-string"><span class="hljs-string">"PYTHONPATH"</span></span>: <span class="hljs-string"><span class="hljs-string">"."</span></span>}))</code> </pre><br>  <i>periodicBuildTimer</i> legt die Zeit dieser Periodizit√§t in Sekunden fest. <br><br>  <i>BuildFactory</i> erstellt einen konkreten <i>Build</i> , den der <i>Builder</i> dann an den <b>Worker</b> sendet.  <i>BuildFactory</i> gibt die Schritte an, die ein <b>Worker</b> <i>ausf√ºhren</i> sollte.  Schritte werden durch Aufrufen der <i>addStep-</i> Methode hinzugef√ºgt <i>.</i> <i><br></i> <br><br>  Der erste in diesem Beispiel hinzugef√ºgte Schritt ist <i>git clean -d -f -f ‚Äìx</i> und dann <i>git checkout</i> .  Diese Aktionen sind in den <i>Methodenparameter</i> eingebettet, der nicht eindeutig angegeben ist, aber den Standardwert von <i>fresh</i> impliziert.  Der Parameter <i>mode = 'incremental'</i> gibt an, dass die Dateien aus dem Verzeichnis, in dem das <i>Cheechout durchgef√ºhrt</i> wird, zwar im Repository fehlen, aber unber√ºhrt bleiben. <br><br>  Der zweite hinzugef√ºgte Schritt besteht darin, das <i>Testskript</i> mit dem Parameter " <i>Hallo"</i> auf der <b>Arbeiterseite</b> aus dem Verzeichnis <i>/ home / habr / worker / yourProject / build</i> mit der Umgebungsvariablen PATHONPATH = ... aufzurufen. Sie k√∂nnen also Ihre eigenen Skripte schreiben und sie auf der <b>Arbeiterseite</b> -a ausf√ºhren durch den Schritt <i>util.ShellCommand</i> .  Diese Skripte k√∂nnen direkt in das Repository gestellt werden.  W√§hrend des <i>Cheechouts</i> gehen sie dann zu <i>/ home / habr / worker / yourProject / build</i> .  Dann gibt es jedoch zwei ‚ÄûAber‚Äú: <br><ol><li>  <b>Worker</b> muss mit dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><i>Schalter --umask erstellt werden,</i></a> damit die Ausf√ºhrungsrechte nach dem <i>Auschecken</i> -a nicht blockiert werden. </li><li>  Wenn <i>git</i> diese Skripte <i>pusht</i> , muss die <i>exacutable</i> Eigenschaft angegeben werden, damit Git mit <i>chechout</i> -e nicht das Recht verliert, das Skript auszuf√ºhren. </li></ol><br><br><a name="builders"></a><h4>  <u>5.6 Bauherren</u> </h4><br><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>].append(util.BuilderConfig(name=<span class="hljs-string"><span class="hljs-string">"runtests"</span></span>, workernames=[<span class="hljs-string"><span class="hljs-string">"example-worker"</span></span>], factory=factory))</code> </pre><br>  √úber was <i>Builder</i> hier beschrieben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wurde</a> .  Jetzt werde ich ausf√ºhrlicher dar√ºber sprechen, wie es erstellt wird.  <i>BuilderConfig</i> ist ein Konstruktor- <i>Builder</i> .  Sie k√∂nnen in <i>c ['Builder']</i> mehrere solcher Konstruktoren angeben, da dies eine Liste von Objekten vom Typ <i>Builder ist</i> .  Jetzt werden wir das Beispiel aus <b>BuildBot</b> leicht umschreiben, um es unserer Aufgabe n√§her zu bringen. <br><pre> <code class="python hljs">c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>] = [] c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>].append(util.BuilderConfig(name=<span class="hljs-string"><span class="hljs-string">"yourProject"</span></span>, workernames=[<span class="hljs-string"><span class="hljs-string">"yourWorkerName"</span></span>], factory=factory))</code> </pre><br>  Jetzt werde ich √ºber die Parameter <i>BuilderConfig</i> erz√§hlen. <br><br>  <i>name</i> legt den Namensgenerator -a fest.  Hier haben wir es <i>yourProject genannt</i> .  Dies bedeutet, dass auf dem <b>Worker</b> <i>genau</i> dieser Pfad <i>/ home / habr / worker / yourProject / build</i> erstellt wird.  <i>Sheduler</i> sucht nach einem <i>Builder</i> mit diesem Namen. <br><br>  <i>Arbeitsnamen</i> enth√§lt eine Liste der <b>Arbeiter</b> .  Jedes davon muss zu <i>c ['Arbeiter']</i> hinzugef√ºgt werden. <br><br>  <i>Factory</i> ist der spezifische <i>Build,</i> dem der <i>Builder zugeordnet ist</i> .  Es wird ein <i>Build-</i> Objekt an <b>Worker gesendet</b> , um alle Schritte auszuf√ºhren, aus denen dieser <i>Build</i> -a besteht. <br><br><a name="myconfig"></a><h3>  6. Beispiel einer eigenen Konfiguration </h3><hr><br>  Hier ist die Architektur eines Beispielprojekts, das ich √ºber <b>BuildBot</b> implementieren <b>m√∂chte</b> <b><br></b>  . <br><br>  Wir werden <i>svn</i> als Versionskontrollsystem verwenden.  Das Repository selbst befindet sich in einer bestimmten Cloud.  Hier ist die Adresse dieser Cloud <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">svn.host/svn/yourProject/trunk</a></i> .  In der Cloud unter <i>svn</i> gibt es einen Benutzernamen: <i>user</i> , passwd: <i>password</i> account.  Die Skripte, die die Schritte <i>build</i> -a darstellen, befinden sich auch im Zweig <i>svn</i> in einem separaten <i>Ordner buildbot / worker_linux</i> .  Diese Skripte befinden sich im Repository, wobei die <i>ausf√ºhrbare</i> Eigenschaft gespeichert ist. <br><br>  <b>BuildMaster</b> und <b>Worker</b> arbeiten auf demselben <i>project.host-</i> Host.  <b>BuildMaster</b> speichert seine Dateien im Ordner <i>/ home / habr / master</i> .  <b>Worker</b> speichert den folgenden Pfad <i>/ home / habr / worker</i> .  Die Kommunikation zwischen den <b>BuildMaster-</b> und <b>Worker-</b> Prozessen <b>erfolgt</b> √ºber den 4000-Port unter Verwendung des <b>BuildBot-</b> a-Protokolls, <b>dh</b> des <i>'pb'-</i> Protokolls. <br><br>  Das Zielprojekt ist vollst√§ndig in Python geschrieben.  Die Aufgabe besteht darin, die √Ñnderungen zu verfolgen, eine ausf√ºhrbare Datei zu erstellen, Dokumentation zu erstellen und Tests durchzuf√ºhren.  Im Fehlerfall m√ºssen alle Entwickler eine Nachricht an die E-Mail senden, dass eine Aktion fehlgeschlagen ist. <br><br>  Wir werden das <b>BuildBot-</b> Web-Mapping mit Port 80 f√ºr <i>project.host verbinden</i> .  Apatch ist optional.  Die <i>verdrehte</i> Bibliothek hat bereits einen Webserver, <b>BuildBot</b> verwendet ihn. <br><br>  <b>Wir</b> werden <b>SQLite</b> verwenden, um interne Informationen f√ºr <b>BuildBot</b> zu speichern. <br><br>  Zum Versenden ben√∂tigen Sie den Host <i>smtp.your.domain</i> - er erm√∂glicht das Senden von E-Mails von <i>projectHost@your.domain</i> ohne Authentifizierung.  Auch auf dem Host ' <i>smtp</i> ' wird das Protokoll um 1025 abgeh√∂rt. <br><br>  An dem Prozess sind zwei Personen beteiligt: <i>Administrator</i> und <i>Benutzer</i> .  admin verwaltet <b>BuildBot</b> .  Benutzer ist die Person, die das <i>Commit festlegt</i> . <br><br>  Eine austauschbare Datei wird √ºber <i>pyinstaller</i> generiert.  Die Dokumentation wird durch <i>Sauerstoff</i> erzeugt. <br><br>  F√ºr diese Architektur habe ich diese <i>master.cfg geschrieben</i> : <br><br><div class="spoiler">  <b class="spoiler_title">master.cfg</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os, re <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> buildbot.plugins <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> steps, util, schedulers, worker, changes, reporters c= BuildmasterConfig ={} c[<span class="hljs-string"><span class="hljs-string">'workers'</span></span>] = [ worker.Worker(<span class="hljs-string"><span class="hljs-string">'yourWorkerName'</span></span>, <span class="hljs-string"><span class="hljs-string">'password'</span></span>) ] c[<span class="hljs-string"><span class="hljs-string">'protocols'</span></span>] = {<span class="hljs-string"><span class="hljs-string">'pb'</span></span>: {<span class="hljs-string"><span class="hljs-string">'port'</span></span>: <span class="hljs-number"><span class="hljs-number">4000</span></span>}} svn_poller = changes.SVNPoller(repourl=<span class="hljs-string"><span class="hljs-string">"https://svn.host/svn/yourProject/trunk"</span></span>, svnuser=<span class="hljs-string"><span class="hljs-string">"user"</span></span>, svnpasswd=<span class="hljs-string"><span class="hljs-string">"password"</span></span>, pollinterval=<span class="hljs-number"><span class="hljs-number">60</span></span>, split_file=util.svn.split_file_alwaystrunk ) c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>] = svn_poller hourlyscheduler = schedulers.SingleBranchScheduler( name=<span class="hljs-string"><span class="hljs-string">"your-project-schedulers"</span></span>, change_filter=util.ChangeFilter(branch=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>), builderNames=[<span class="hljs-string"><span class="hljs-string">"yourProject"</span></span>], properties = {<span class="hljs-string"><span class="hljs-string">'owner'</span></span>: <span class="hljs-string"><span class="hljs-string">'admin'</span></span>} ) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>] = [hourlyscheduler] checkout = steps.SVN(repourl=<span class="hljs-string"><span class="hljs-string">'https://svn.host/svn/yourProject/trunk'</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'full'</span></span>, method=<span class="hljs-string"><span class="hljs-string">'fresh'</span></span>, username=<span class="hljs-string"><span class="hljs-string">"user"</span></span>, password=<span class="hljs-string"><span class="hljs-string">"password"</span></span>, haltOnFailure=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) projectHost_build = util.BuildFactory() cleanProject = steps.ShellCommand(name=<span class="hljs-string"><span class="hljs-string">"Clean"</span></span>, command=[<span class="hljs-string"><span class="hljs-string">"buildbot/worker_linux/pyinstaller_project"</span></span>, <span class="hljs-string"><span class="hljs-string">"clean"</span></span>] ) buildProject = steps.ShellCommand(name=<span class="hljs-string"><span class="hljs-string">"Build"</span></span>, command=[<span class="hljs-string"><span class="hljs-string">"buildbot/worker_linux/pyinstaller_project"</span></span>, <span class="hljs-string"><span class="hljs-string">"build"</span></span>] ) doxyProject = steps.ShellCommand(name=<span class="hljs-string"><span class="hljs-string">"Update Docs"</span></span>, command=[<span class="hljs-string"><span class="hljs-string">"buildbot/worker_linux/gendoc"</span></span>, []] ) testProject = steps.ShellCommand(name=<span class="hljs-string"><span class="hljs-string">"Tests"</span></span>, command=[<span class="hljs-string"><span class="hljs-string">"python"</span></span>,<span class="hljs-string"><span class="hljs-string">"tests/utest.py"</span></span>], env={<span class="hljs-string"><span class="hljs-string">'PYTHONPATH'</span></span>: <span class="hljs-string"><span class="hljs-string">'.'</span></span>} ) projectHost_build.addStep(checkout) projectHost_build.addStep(cleanProject) projectHost_build.addStep(buildProject) projectHost_build.addStep(doxyProject) projectHost_build.addStep(testProject) c[<span class="hljs-string"><span class="hljs-string">'builders'</span></span>] = [ util.BuilderConfig(name=<span class="hljs-string"><span class="hljs-string">"yourProject"</span></span>, workername=<span class="hljs-string"><span class="hljs-string">'yourWorkerName'</span></span>, factory=projectHost_build) ] template_html=<span class="hljs-string"><span class="hljs-string">u'''\ &lt;h4&gt;  : {{ summary }}&lt;/h4&gt; &lt;p&gt;   : {{ workername }}&lt;/p&gt; &lt;p&gt;: {{ projects }}&lt;/p&gt; &lt;p&gt;         : {{ buildbot_url }}&lt;/p&gt; &lt;p&gt;         : {{ build_url }}&lt;/p&gt; &lt;p&gt; WinSCP     c ip:xxx.xx.xxx.xx.   habr/password,   executable    ~/worker/yourProject/build/dist.&lt;/p&gt; &lt;p&gt;&lt;b&gt;    Buildbot&lt;/b&gt;&lt;/p&gt; '''</span></span> sendMessageToAll = reporters.MailNotifier(fromaddr=<span class="hljs-string"><span class="hljs-string">"projectHost@your.domain"</span></span>, sendToInterestedUsers=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, lookup=<span class="hljs-string"><span class="hljs-string">"your.domain"</span></span>, relayhost=<span class="hljs-string"><span class="hljs-string">"smtp.your.domain"</span></span>, smtpPort=<span class="hljs-number"><span class="hljs-number">1025</span></span>, mode=<span class="hljs-string"><span class="hljs-string">"warnings"</span></span>, extraRecipients=[<span class="hljs-string"><span class="hljs-string">'user@your.domain'</span></span>], messageFormatter=reporters.MessageFormatter( template=template_html, template_type=<span class="hljs-string"><span class="hljs-string">'html'</span></span>, wantProperties=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, wantSteps=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ) c[<span class="hljs-string"><span class="hljs-string">'services'</span></span>] = [sendMessageToAll] c[<span class="hljs-string"><span class="hljs-string">'title'</span></span>] = <span class="hljs-string"><span class="hljs-string">"The process of bulding"</span></span> c[<span class="hljs-string"><span class="hljs-string">'titleURL'</span></span>] = <span class="hljs-string"><span class="hljs-string">"http://project.host:80/"</span></span> c[<span class="hljs-string"><span class="hljs-string">'buildbotURL'</span></span>] = <span class="hljs-string"><span class="hljs-string">"http://project.host"</span></span> c[<span class="hljs-string"><span class="hljs-string">'www'</span></span>] = dict(port=<span class="hljs-number"><span class="hljs-number">80</span></span>, plugins=dict(waterfall_view={}, console_view={}, grid_view={})) c[<span class="hljs-string"><span class="hljs-string">'db'</span></span>] = { <span class="hljs-string"><span class="hljs-string">'db_url'</span></span> : <span class="hljs-string"><span class="hljs-string">"sqlite:///state.sqlite"</span></span> }</code> </pre><br></div></div><br>  Zuerst m√ºssen Sie <b>BuildMaster</b> und <b>Worker</b> -a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erstellen</a> .  <i>F√ºgen Sie</i> dann diese Datei <i>master.cfg</i> in <i>/ home / habr / master ein</i> . <br><br>  Der n√§chste Schritt ist das Starten des <b>BuildMaster-</b> Dienstes <br><pre> <code class="bash hljs">sudo buildbot start /home/habr/master</code> </pre><br>  Starten Sie dann den <b>Worker</b> -a-Dienst <br><pre> <code class="bash hljs">buildbot-worker start /home/habr/worker</code> </pre><br>  Fertig!  Jetzt verfolgt <b>Buildbot</b> die √Ñnderungen und <b>f√ºhrt sie</b> beim <i>Festschreiben</i> in <i>svn aus. Dabei</i> werden die Schritte zum <i>Erstellen</i> und Testen des Projekts mit der oben genannten Architektur ausgef√ºhrt. <br><br>  Im Folgenden werde ich einige Funktionen der obigen <i>master.cfg beschreiben.</i> <i><br></i> <br><br><a name="fails"></a><h4>  <u>6.1 Auf dem Weg zu Ihrem master.cfg</u> </h4><br>  Beim Schreiben Ihrer <i>master.cfg werden</i> viele Fehler gemacht, sodass Sie die Protokolldatei lesen m√ºssen.  Es wird sowohl auf dem absoluten <b>BuildMaster</b> -ec-Pfad <i>/home/habr/master/twistd.log</i> als auch auf der <b>Worker-</b> Seite mit dem absoluten Pfad <i>/home/habr/worker/twistd.log gespeichert</i> .  Wenn Sie den Fehler lesen und beheben, m√ºssen Sie den <b>BuildMaster</b> -a-Dienst neu <b>starten</b> .  So geht's: <br><pre> <code class="bash hljs">sudo buildbot stop /home/habr/master sudo buildbot upgrade-master /home/habr/master sudo buildbot start /home/habr/master</code> </pre><br><a name="svn"></a><h4>  <u>6.2 Mit svn arbeiten</u> </h4><br><pre> <code class="python hljs">svn_poller = changes.SVNPoller(repourl=<span class="hljs-string"><span class="hljs-string">"https://svn.host/svn/yourProject/trunk"</span></span>, svnuser=<span class="hljs-string"><span class="hljs-string">"user"</span></span>, svnpasswd=<span class="hljs-string"><span class="hljs-string">"password"</span></span>, pollinterval=<span class="hljs-number"><span class="hljs-number">60</span></span>, split_file=util.svn.split_file_alwaystrunk ) c[<span class="hljs-string"><span class="hljs-string">'change_source'</span></span>] = svn_poller hourlyscheduler = schedulers.SingleBranchScheduler( name=<span class="hljs-string"><span class="hljs-string">"your-project-schedulers"</span></span>, change_filter=util.ChangeFilter(branch=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>), builderNames=[<span class="hljs-string"><span class="hljs-string">"yourProject"</span></span>], properties = {<span class="hljs-string"><span class="hljs-string">'owner'</span></span>: <span class="hljs-string"><span class="hljs-string">'admin'</span></span>} ) c[<span class="hljs-string"><span class="hljs-string">'schedulers'</span></span>] = [hourlyscheduler] checkout = steps.SVN(repourl=<span class="hljs-string"><span class="hljs-string">'https://svn.host/svn/yourProject/trunk'</span></span>, mode=<span class="hljs-string"><span class="hljs-string">'full'</span></span>, method=<span class="hljs-string"><span class="hljs-string">'fresh'</span></span>, username=<span class="hljs-string"><span class="hljs-string">"user"</span></span>, password=<span class="hljs-string"><span class="hljs-string">"password"</span></span>, haltOnFailure=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre><br>  Schauen Sie sich zun√§chst <i>svn_poller an</i> .  Dies ist dieselbe Schnittstelle, die das Repository regelm√§√üig einmal pro Minute abfragt.  In diesem Fall greift <i>svn_poller</i> nur auf den <i>Trunk-</i> Zweig zu.  Der mysteri√∂se Parameter <i>split_file = util.svn.split_file_alwaystrunk</i> legt die Regeln fest: So teilen Sie die Struktur von <i>SVN-</i> Ordnern in Zweige auf.  Er bietet ihnen relative Wege an.  <i>Split_file_alwaystrunk</i> vereinfacht wiederum den Prozess, indem angegeben wird, dass sich nur <i>Trunk</i> im Repository befindet. <br><br>  In <i>Schedulern</i> wird <i>ChangeFilter angegeben</i> , der <i>None</i> sieht und den <i>Trunk-</i> Zweig gem√§√ü der angegebenen Zuordnung √ºber <i>split_file_alwaystrunk</i> mit ihm <i>verkn√ºpft</i> .  Als Reaktion auf √Ñnderungen im <i>Trunk</i> wird der <i>Builder mit dem</i> Namen <i>yourProject gestartet</i> . <br><br>  <i>Eigenschaften</i> hier sind erforderlich, damit der Administrator den Newsletter von der Montage und den Testergebnissen als Eigent√ºmer des Prozesses erh√§lt. <br><br>  Mit dem Schritt " <i>Auschecken</i> <i>erstellen"</i> k√∂nnen alle Dateien in der lokalen Version des <b>Worker-</b> Repositorys vollst√§ndig gel√∂scht werden.  A <i>F√ºhren Sie</i> dann das vollst√§ndige <i>SVN-Update durch</i> .  Der Modus wird √ºber den Parameter <i>mode = full</i> , <i>method = fresh</i> konfiguriert.  Der Parameter <i>haltOnTailure</i> gibt an, dass bei nicht erfolgreichem <i>svn-Update</i> der gesamte Montage- und Testprozess angehalten werden sollte, da weitere Schritte keinen Sinn ergeben. <br><br><a name="reporter"></a><h4>  <u>6.3 Ein Brief an Sie: Reporter sind berechtigt zu erkl√§ren</u> </h4><br>  <i>Reporter</i> ist ein Mail-Benachrichtigungsdienst. <br><pre> <code class="python hljs">template_html=<span class="hljs-string"><span class="hljs-string">u'''\ &lt;h4&gt;  : {{ summary }}&lt;/h4&gt; &lt;p&gt;   : {{ workername }}&lt;/p&gt; &lt;p&gt;: {{ projects }}&lt;/p&gt; &lt;p&gt;         : {{ buildbot_url }}&lt;/p&gt; &lt;p&gt;         : {{ build_url }}&lt;/p&gt; &lt;p&gt; WinSCP     c ip:xxx.xx.xxx.xx.   habr/password,   executable    ~/worker/yourProject/build/dist.&lt;/p&gt; &lt;p&gt;&lt;b&gt;    Buildbot&lt;/b&gt;&lt;/p&gt; '''</span></span> sendMessageToAll = reporters.MailNotifier(fromaddr=<span class="hljs-string"><span class="hljs-string">"projectHost@your.domain"</span></span>, sendToInterestedUsers=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, lookup=<span class="hljs-string"><span class="hljs-string">"your.domain"</span></span>, relayhost=<span class="hljs-string"><span class="hljs-string">"smtp.your.domain"</span></span>, smtpPort=<span class="hljs-number"><span class="hljs-number">1025</span></span>, mode=<span class="hljs-string"><span class="hljs-string">"warnings"</span></span>, extraRecipients=[<span class="hljs-string"><span class="hljs-string">'user@your.domain'</span></span>], messageFormatter=reporters.MessageFormatter( template=template_html, template_type=<span class="hljs-string"><span class="hljs-string">'html'</span></span>, wantProperties=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, wantSteps=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) ) c[<span class="hljs-string"><span class="hljs-string">'services'</span></span>] = [sendMessageToAll]</code> </pre><br>  Es kann Nachrichten auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">viele Arten</a> senden. <br><br>  <i>MailNotifier</i> verwendet Mail, um Benachrichtigungen zu senden. <br><br>  <i>template_html</i> legt die Textvorlage f√ºr den Newsletter fest.  Verwenden Sie zum Erstellen von Markups HTML.  Es wird von der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><i>jinja2-</i></a> Engine modifiziert (kann mit <i>django</i> verglichen <i>werden</i> ).  <b>BuildBot</b> verf√ºgt √ºber eine Reihe von Variablen, deren Werte beim <b>Erstellen</b> des Nachrichtentextes in die Vorlage eingesetzt werden.  Diese Variablen sind in {{doppelte geschweifte Klammern}} eingeschrieben.  So zeigt beispielsweise die <i>Zusammenfassung</i> den Status abgeschlossener Vorg√§nge an, d. H. Erfolg oder Misserfolg.  Und <i>Projekte</i> geben <i>yourProject aus</i> .  Mit Steuerbefehlen in <i>jinja2</i> , <i>BuildBot-</i> Variablen und Python-String-Formatierern k√∂nnen Sie also eine sehr informative Nachricht erstellen. <br><br>  <i>MailNotifier</i> enth√§lt die folgenden Argumente. <br><br>  <i>fromaddr</i> - die Adresse, von der jeder den Newsletter erh√§lt. <br><br>  <i>sendToInterestedUsers</i> = True sendet eine Nachricht an den Eigent√ºmer und Benutzer, der das <i>Commit durchgef√ºhrt hat</i> . <br><br>  <i>Lookup</i> - Suffix, das den Namen der Benutzer hinzugef√ºgt wird, die den Newsletter erhalten.  Der <i>Administrator</i> als Benutzer erh√§lt den Newsletter unter admin@your.domain. <br><br>  <i>Relayhost</i> gibt den Hostnamen an, auf dem der <i>SMTP-</i> Server ge√∂ffnet ist, und <i>smptPort</i> gibt die Portnummer an, die der <i>SMTP-</i> Server <i>√ºberwacht</i> . <br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mode = "warning"</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> besagt, dass das Mailing nur durchgef√ºhrt werden soll, wenn mindestens ein </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Build-</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schritt </font><font style="vertical-align: inherit;">mit einem Fehler- oder Warnstatus beendet wurde. Im Erfolgsfall ist kein Mailing erforderlich. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">extraRecipients</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enth√§lt neben dem Eigent√ºmer und der Person, die das </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commit durchgef√ºhrt hat,</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> eine Liste der Personen, an die das Mailing erfolgen soll </font><font style="vertical-align: inherit;">. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">messageFormatter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ist ein Objekt, das das Format der Nachricht, ihre Vorlage und die von </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jinja2</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> verf√ºgbaren Variablen </font><i><font style="vertical-align: inherit;">definiert</font></i><font style="vertical-align: inherit;"> . Parameter wie </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wantProperties = True</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wantSteps = True</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> geben diesen Satz verf√ºgbarer Variablen an. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with ['services'] = [sendMessageToAll]</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> bietet eine Liste von Diensten, darunter unsere</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reporter</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><a name="goodboy"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben es geschafft! </font><font style="vertical-align: inherit;">Herzliche Gl√ºckw√ºnsche</font></font></h3><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wir haben unsere eigene Konfiguration erstellt und die Funktionalit√§t von </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BuildBot erkannt</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ich denke, dies reicht aus, um zu verstehen, ob dieses Tool zum Erstellen Ihres Projekts ben√∂tigt wird. </font><font style="vertical-align: inherit;">Ist er f√ºr dich interessant? </font><font style="vertical-align: inherit;">Wird es f√ºr Sie n√ºtzlich sein? </font><font style="vertical-align: inherit;">Ist es bequem, damit zu arbeiten? </font><font style="vertical-align: inherit;">Dann schreibe ich diesen Artikel aus gutem Grund.</font></font><br><br>  Und noch etwas.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich m√∂chte, dass die professionelle Community, die </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BuildBot verwendet</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , breiter wird, Handb√ºcher √ºbersetzt und weitere Beispiele.</font></font><br><br>  Vielen Dank f√ºr Ihre Aufmerksamkeit.  Viel Gl√ºck. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de460501/">https://habr.com/ru/post/de460501/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de460491/index.html">Arduino Temperatur- und Feuchtigkeitssensor mit Senden und Plotten (Teil 1)</a></li>
<li><a href="../de460493/index.html">"Killer Apps" f√ºr PC aus den 80ern: VisiCalc und WordStar</a></li>
<li><a href="../de460495/index.html">Container-to-Pipeline: CRI-O ist jetzt die Standardeinstellung in OpenShift Container Platform 4</a></li>
<li><a href="../de460497/index.html">Intuitive Anwendung von Monte-Carlo-Methoden mit Markov-Ketten</a></li>
<li><a href="../de460499/index.html">Drei Gewinner des Dijkstra-Preises: Wie verliefen Hydra 2019 und SPTDC 2019?</a></li>
<li><a href="../de460503/index.html">Drahtlose Konfiguration des Raspberry PI 3 B +</a></li>
<li><a href="../de460505/index.html">Verf√ºhren Sie drei Kreuze oder warum Projekte so schwer p√ºnktlich zu beenden sind</a></li>
<li><a href="../de460507/index.html">XEN und die Zukunft der Automobilindustrie: Wie ein Open-Source-Hypervisor zu einem Konkurrenten f√ºr kommerzielle Automobill√∂sungen wird</a></li>
<li><a href="../de460509/index.html">Wie gebietsans√§ssige Proxys im Gesch√§ftsleben helfen: Ein realer Fall der Verwendung von Infatica in Data Mining</a></li>
<li><a href="../de460511/index.html">PHP-FPM-Optimierung: Verwenden von pm static f√ºr maximale Leistung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>