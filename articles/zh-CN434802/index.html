<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗼 ✖️ 🎌 “我不会放弃”或如何安排“诅咒之地”游戏的资源 🛷 🍶 ◀️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="你还记得很多俄罗斯游戏吗？ 定性的？ 难忘？ 是的，他们是。 如果您年满35岁，或者是俄罗斯游戏产业的忠实拥护者，那么您可能很熟悉《诅咒之地》。 


 故事开始得很平淡：夏天，炎热。 没什么特别的事情要做，当懒惰地浏览笔记本电脑硬盘的内容时，我的目光抓住了一个带有熟悉的龙图标的文件夹，该文件夹已经...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>“我不会放弃”或如何安排“诅咒之地”游戏的资源</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434802/"><p><img src="https://habrastorage.org/webt/ry/nk/a_/rynka_dqz5ny9nqgs7gawsw4zxy.jpeg"></p><br><p> 你还记得很多俄罗斯游戏吗？ 定性的？ 难忘？ 是的，他们是。 如果您年满35岁，或者是俄罗斯游戏产业的忠实拥护者，那么您可能很熟悉《诅咒之地》。 </p><br><p> 故事开始得很平淡：夏天，炎热。 没什么特别的事情要做，当懒惰地浏览笔记本电脑硬盘的内容时，我的目光抓住了一个带有熟悉的龙图标的文件夹，该文件夹已经闲置了几年。 </p><br><p> 哪个游戏迷不会知道里面有什么？ </p><a name="habracut"></a><br><h1 id="vvedenie"> 引言 </h1><br><h2 id="informaciya-ob-igre"> 游戏资讯 </h2><br><p>  <strong>被诅咒的土地</strong> -或在独联体之外被称为“ <strong>邪恶的岛屿：失落的灵魂的诅咒”，这</strong>是2000年发布的隐身RPG游戏。 该游戏是由Nival Interactive开发的，当时该公司已经将自己确立为一系列的Alloda游戏（国外的Rage of Mages）。 大部分莫斯科国立大学的毕业生都在其中工作-他们完全有能力实现具有完整三维世界的首批游戏之一。 <br>  2010年，Mail.Ru（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">信息</a> ）转让了标题，但该游戏仍代表Nival在GOG商店中出售。 </p><br><p> 相对最近，该游戏已经18岁了-生日被认为是10月26日，即CIS中的发布日期。 尽管年代久远，官方主服务器仍在使用：定期，有人决定爬过Gipat的森林，并用同志小队打十二打或两个骷髅。 </p><br><h2 id="korotko-o-state"> 关于文章的简要介绍 </h2><br><p> 最初，我的目标只是使用专用的标准库在Python 3中“为我自己”编写一个单向转换器。 但是，在此过程中，有关格式的文档开始顺利，试图以某种方式标准化输出。 对于某些格式，使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kaitai Struct</a>描述了该结构。 结果，一切都导致了本文和Wiki格式的撰写。 </p><br><p> 我马上注意到：在大多数情况下，已经研究了游戏文件，并为他们编写了粉丝编辑器。 但是，这些信息非常分散，在公共领域中或多或少没有完整的格式描述，也没有足够的集合来创建修改。 </p><br><h2 id="i-o-tom-kak-eyo-chitat">  ...以及如何阅读 </h2><br><p> 提供了所有格式的方案（.ksy文件），可以单击两次即可将其转换为几种最流行语言的代码。 </p><br><p> 不幸的是，在撰写本文的最后阶段，我发现受人尊敬的Habr不能突出显示YAML（和JSON），并且所有方案都使用它。 这应该不是什么大问题，但是如果不方便阅读该方案，我建议您将其复制到第三方编辑器，例如NPP。 </p><br><h1 id="resursy-i-gde-oni-obitayut"> 资源及其居住地 </h1><br><p> 该游戏是一个便携式应用程序，其中包含带有库的引擎，启动器以及实际上打包的资源。 </p><br><blockquote>  <strong>这很有趣：</strong>游戏的设置几乎全部存储在注册表中。  GOG版本中的相机错误是由于安装程序未注册正确的默认值而导致的。 </blockquote><p> 乍一看游戏文件夹的内容，我们立即注意到几个新的文件扩展名：ASI和REG。 <br> 第一个是动态库，我们将不考虑它（这是由逆向工程专家完成的），但是第二个是游戏的第一个本机文件格式。 </p><br><h2 id="reg">  REG </h2><br><p> 此类型的文件是众所周知的INI文件的二进制序列化。 <br> 内容分为存储键及其值的部分。  REG文件保留了此层次结构，但是加快了读取和解析数据的速度-在2000年，这显然很关键。 </p><br><p> 通常，您可以描述此图的结构： <br><img src="https://habrastorage.org/webt/yh/se/fo/yhsefo2h5nxp0ghwse2zla8cmv0.png"></p><br><div class="spoiler">  <b class="spoiler_title">结构说明</b> <div class="spoiler_text"><pre><code class="plaintext hljs">meta: id: reg title: Evil Islands, REG file (packed INI) application: Evil Islands file-extension: reg license: MIT endian: le doc: Packed INI file seq: - id: magic contents: [0xFB, 0x3E, 0xAB, 0x45] doc: Magic bytes - id: sections_count type: u2 doc: Number of sections - id: sections_offsets type: section_offset doc: Sections offset table repeat: expr repeat-expr: sections_count types: section_offset: doc: Section position in file seq: - id: order type: s2 doc: Section order number - id: offset type: u4 doc: Global offset of section in file instances: section: pos: offset type: section types: section: doc: Section representation seq: - id: keys_count type: u2 doc: Number of keys in section - id: name_len type: u2 doc: Section name lenght - id: name type: str encoding: cp1251 size: name_len doc: Section name - id: keys type: key doc: Section's keys repeat: expr repeat-expr: keys_count types: key: doc: Named key seq: - id: order type: s2 doc: Key order in section - id: offset type: u4 doc: Key offset in section instances: key_record: pos: _parent._parent.offset + offset type: key_data key_data: seq: - id: packed_type type: u1 doc: Key value info - id: name_len type: u2 doc: Key name lenght - id: name type: str encoding: cp1251 size: name_len doc: Key name - id: value type: value doc: Key value instances: is_array: value: packed_type &gt; 127 doc: Is this key contain array value_type: value: packed_type &amp; 0x7F doc: Key value type types: value: doc: Key value seq: - id: array_size type: u2 if: _parent.is_array doc: Value array size - id: data type: switch-on: _parent.value_type cases: 0: s4 1: f4 2: string repeat: expr repeat-expr: '_parent.is_array ? array_size : 1' doc: Key value data string: doc: Sized string seq: - id: len type: u2 doc: String lenght - id: value type: str encoding: cp1251 size: len doc: String</code> </pre> </div></div><br><blockquote>  <strong>这很有趣：</strong> 2002年，Nival与游戏社区共享了一些工具（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://web.archive.org/web/20020610194020/">站点快照</a> ）-其中一个是REG中的INI序列化器。 您可能会猜到，虽然不是官方的，但反序列化器几乎立即出现。 </blockquote><p> 整理好开始文件夹后，让我们继续进入子目录。 <br> 最初的外观位于包含CAM文件的Cameras文件夹中。 </p><br><h2 id="cam"> 凸轮 </h2><br><p> 一个非常简单的格式就是随时间打包摄像机的位置。 通过位置和旋转来描述摄像机。 其他两个字段大概是时间和运动顺序。 </p><br><p><img src="https://habrastorage.org/webt/cu/8u/bj/cu8ubjrcz2pode-v3lydliwrvsq.png"></p><br><div class="spoiler">  <b class="spoiler_title">结构说明</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">meta: id: cam title: Evil Islands, CAM file (cameras) application: Evil Islands file-extension: cam license: MIT endian: le doc: Camera representation seq: - id: cams type: camera repeat: eos types: vec3: doc: 3d vector seq: - id: x type: f4 doc: x axis - id: y type: f4 doc: y axis - id: z type: f4 doc: z axis quat: doc: quaternion seq: - id: w type: f4 doc: w component - id: x type: f4 doc: x component - id: y type: f4 doc: y component - id: z type: f4 doc: z component camera: doc: Camera parameters seq: - id: unkn0 type: u4 doc: unknown - id: unkn1 type: u4 doc: unknown - id: position type: vec3 doc: camera's position - id: rotation type: quat doc: camera's rotation</code> </pre> </div></div><br><p> 在下一个文件夹-Res中，（出乎意料！）存储了存档的RES文件。 </p><br><h2 id="res">  RES </h2><br><p> 这种格式有时会隐藏在其他扩展名下，但原始格式仍然完全是RES。 <br> 数据结构对于具有对文件的随机访问权的存档来说非常典型：有一些表用于存储有关内部文件，名称表和文件内容的信息。 <br> 目录结构直接包含在名称中。 </p><br><p> 值得注意两个非常有趣的事实： </p><br><ol><li> 该归档文件经过优化，可使用封闭式哈希将文件信息加载到链接列表中。 </li><li> 您可以存储一次文件的内容，但是可以使用不同的名称来引用它。 据我所知，这个事实被用在了风扇的重新包装中，因此游戏的尺寸大大减小了。 在原始发行版中，未使用档案优化。 </li></ol><br><p><img src="https://habrastorage.org/webt/_9/ie/8_/_9ie8_m0lc_b1n0ddnagkue514g.png"></p><br><div class="spoiler">  <b class="spoiler_title">结构说明</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">meta: id: res title: Evil Islands, RES file (resources archive) application: Evil Islands file-extension: res license: MIT endian: le doc: Resources archive seq: - id: magic contents: [0x3C, 0xE2, 0x9C, 0x01] doc: Magic bytes - id: files_count type: u4 doc: Number of files in archive - id: filetable_offset type: u4 doc: Filetable offset - id: nametable_size type: u4 doc: Size of filenames instances: nametable_offset: value: filetable_offset + 22 * files_count doc: Offset of filenames table filetable: pos: filetable_offset type: file_record repeat: expr repeat-expr: files_count doc: Files metadata table types: file_record: doc: File metadata seq: - id: next_index type: s4 doc: Next file index - id: file_size type: u4 doc: Size of file in bytes - id: file_offset type: u4 doc: File data offset - id: last_change type: u4 doc: Unix timestamp of last change time - id: name_len type: u2 doc: Lenght of filename - id: name_offset type: u4 doc: Filename offset in name array instances: name: io: _root._io pos: name_offset + _parent.nametable_offset type: str encoding: cp1251 size: name_len doc: File name data: io: _root._io pos: file_offset size: file_size doc: Content of file</code> </pre> </div></div><br><blockquote>  <strong>这很有趣：</strong>在游戏的俄语版本中，Speech.res归档文件包含两个子目录s和t，它们的内容完全相同，这就是为什么归档文件大小是原来的两倍大的原因-这就是为什么游戏不适合一张CD的原因。 </blockquote><p> 现在您可以解压缩所有归档文件（可以嵌套）： </p><br><ul><li>  RES只是一个档案， </li><li>  MPR-游戏级别的概况， </li><li>  MQ-有关多人游戏任务的信息， </li><li>  ANM-一组动画， </li><li>  MOD-3D模型， </li><li>  BON-模型骨骼的位置。 </li></ul><br><p> 如果存档中的文件没有扩展名，我们将为BON和ANM存档添加父扩展名。 </p><br><p> 您还可以将所有收到的文件分为四个组： </p><br><ol><li> 贴图 </li><li> 资料库 </li><li> 型号 </li><li> 关卡文件。 </li></ol><br><p> 让我们从简单的-纹理开始。 </p><br><h2 id="mmp">  MMP </h2><br><p> 其实是质地。 它有一个小标题，指示图像参数，MIP级别数和使用的压缩。 标头后是按大小降序的MIP图像级别。 </p><br><p><img src="https://habrastorage.org/webt/a7/1s/-r/a71s-rtar5cg6ipi53n86bbsxps.png"></p><br><div class="spoiler">  <b class="spoiler_title">结构说明</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">meta: id: mmp title: Evil Islands, MMP file (texture) application: Evil Islands file-extension: mmp license: MIT endian: le doc: MIP-mapping texture seq: - id: magic contents: [0x4D, 0x4D, 0x50, 0x00] doc: Magic bytes - id: width type: u4 doc: Texture width - id: height type: u4 doc: Texture height - id: mip_levels_count type: u4 doc: Number of MIP-mapping stored levels - id: fourcc type: u4 enum: pixel_formats doc: FourCC label of pixel format - id: bits_per_pixel type: u4 doc: Number of bits per pixel - id: alpha_format type: channel_format doc: Description of alpha bits - id: red_format type: channel_format doc: Description of red bits - id: green_format type: channel_format doc: Description of green bits - id: blue_format type: channel_format doc: Description of blue bits - id: unused size: 4 doc: Empty space - id: base_texture type: switch-on: fourcc cases: 'pixel_formats::argb4': block_custom 'pixel_formats::dxt1': block_dxt1 'pixel_formats::dxt3': block_dxt3 'pixel_formats::pnt3': block_pnt3 'pixel_formats::r5g6b5': block_custom 'pixel_formats::a1r5g5b5': block_custom 'pixel_formats::argb8': block_custom _: block_custom types: block_pnt3: seq: - id: raw size: _root.bits_per_pixel block_dxt1: seq: - id: raw size: _root.width * _root.height &gt;&gt; 1 block_dxt3: seq: - id: raw size: _root.width * _root.height block_custom: seq: - id: lines type: line_custom repeat: expr repeat-expr: _root.height types: line_custom: seq: - id: pixels type: pixel_custom repeat: expr repeat-expr: _root.width types: pixel_custom: seq: - id: raw type: switch-on: _root.bits_per_pixel cases: 8: u1 16: u2 32: u4 instances: alpha: value: '_root.alpha_format.count == 0 ? 255 : 255 * ((raw &amp; _root.alpha_format.mask) &gt;&gt; _root.alpha_format.shift) / (_root.alpha_format.mask &gt;&gt; _root.alpha_format.shift)' red: value: '255 * ((raw &amp; _root.red_format.mask) &gt;&gt; _root.red_format.shift) / (_root.red_format.mask &gt;&gt; _root.red_format.shift)' green: value: '255 * ((raw &amp; _root.green_format.mask) &gt;&gt; _root.green_format.shift) / (_root.green_format.mask &gt;&gt; _root.green_format.shift)' blue: value: '255 * ((raw &amp; _root.blue_format.mask) &gt;&gt; _root.blue_format.shift) / (_root.blue_format.mask &gt;&gt; _root.blue_format.shift)' channel_format: doc: Description of bits for color channel seq: - id: mask type: u4 doc: Binary mask for channel bits - id: shift type: u4 doc: Binary shift for channel bits - id: count type: u4 doc: Count of channel bits enums: pixel_formats: 0x00004444: argb4 0x31545844: dxt1 0x33545844: dxt3 0x33544E50: pnt3 0x00005650: r5g6b5 0x00005551: a1r5g5b5 0x00008888: argb8</code> </pre> </div></div><br><p> 可能的像素包装格式： </p><br><table><thead><tr><th>  fourcc </th><th> 内容描述 </th></tr></thead><tbody><tr><td>  44 44 00 00 </td><td>  ARGB4 </td></tr><tr><td>  44 58 54 31 </td><td>  Dxt1 </td></tr><tr><td>  44 58 54 33 </td><td>  Dxt3 </td></tr><tr><td>  50 4E 54 33 </td><td>  PNT3-RLE压缩ARGB8 </td></tr><tr><td>  50 56 00 00 </td><td>  R5G5B5 </td></tr><tr><td>  51 55 00 00 </td><td>  A1R5G5B5 </td></tr><tr><td>  88 88 00 00 </td><td>  ARGB8 </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">关于PNT3</b> <div class="spoiler_text"><p> 如果图像格式为<strong>PNT3</strong> ，则解包后的像素结构为ARGB8；  <code>bits_per_pixel</code>压缩图像的大小（以字节为单位）。 </p><br><h4 id="raspakovka-pnt3"> 拆箱PNT3 </h4><br><pre> <code class="python hljs">n = <span class="hljs-number"><span class="hljs-number">0</span></span> destination = <span class="hljs-string"><span class="hljs-string">b""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> src &lt; size: v = int.from_bytes(source[src:src + <span class="hljs-number"><span class="hljs-number">4</span></span>], byteorder=<span class="hljs-string"><span class="hljs-string">'little'</span></span>) src += <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> v &gt; <span class="hljs-number"><span class="hljs-number">1000000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> v == <span class="hljs-number"><span class="hljs-number">0</span></span>: n += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: destination += source[src - (<span class="hljs-number"><span class="hljs-number">1</span></span> + n) * <span class="hljs-number"><span class="hljs-number">4</span></span>:src - <span class="hljs-number"><span class="hljs-number">4</span></span>] destination += <span class="hljs-string"><span class="hljs-string">b"\x00"</span></span> * v n = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> </div></div><br><blockquote>  <strong>这很有趣：</strong>有些纹理是垂直反射的（有些是不反射的？）。 <br> 游戏非常喜欢透明性-如果图像带有Alpha通道，则透明像素的颜色必须恰好是黑色。 还是白色-真是幸运。 </blockquote><p> 简单的格式已经结束，让我们继续使用更严格的格式-一次，mod制作人员大胆地为以下格式保留了自己的编辑工具，但没有白费。 我警告过你 </p><br><h2 id="bazy-dannyh-db-i-izhe-s-nimi"> 数据库（* DB和其他） </h2><br><p> 这种格式非常难以描述-本质上，这是节点（或记录表）的序列化树。 一个文件由具有指定字段类型的几个表组成。 常规结构：表嵌套在公共的“根”节点中，记录是表内的节点。 </p><br><p> 在每个节点中，指定其类型和大小： </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> type_index; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> raw_size; <span class="hljs-comment"><span class="hljs-comment">//      unsigned length; //     read(raw_size); if (raw_size &amp; 1) { length = raw_size &gt;&gt; 1; for (int i = 0; i &lt; 3; i++) length &lt;&lt;= 8; read(raw_size); length += raw_size; } else length = raw_size &gt;&gt; 1;</span></span></code> </pre> <br><p> 表字段的类型由索引从表的格式字符串中获取，实际类型由获得的值确定。 </p><br><div class="spoiler">  <b class="spoiler_title">栏位类型</b> <div class="spoiler_text"><table><thead><tr><th> 名称 </th><th> 说明 </th></tr></thead><tbody><tr><td> 小号 </td><td> 弦 </td></tr><tr><td> 我 </td><td>  4b int </td></tr><tr><td>  ü </td><td>  4b未签名 </td></tr><tr><td>  ˚F </td><td>  4B浮球 </td></tr><tr><td>  X </td><td> 位字节 </td></tr><tr><td>  ˚F </td><td> 浮点数组 </td></tr><tr><td> 我 </td><td> 整数数组 </td></tr><tr><td> 乙 </td><td> 布尔 </td></tr><tr><td>  b </td><td> 布尔数组 </td></tr><tr><td>  ^ h </td><td> 未知的十六进制字节 </td></tr><tr><td>  Ť </td><td> 时间 </td></tr><tr><td>  0 </td><td> 没有说明 </td></tr><tr><td>  1个 </td><td> <code>0FII</code> </td> </tr><tr><td>  2 </td><td> <code>SUFF</code> </td> </tr><tr><td>  3 </td><td> <code>FFFF</code> </td> </tr><tr><td>  4 </td><td> <code>0SISS</code> </td> </tr><tr><td>  5 </td><td> <code>0SISS00000U</code> </td> </tr></tbody></table></div></div><br><div class="spoiler">  <b class="spoiler_title">基础说明</b> <div class="spoiler_text"><h4 id="predmety-idb"> 项目（.idb） </h4><br><table><thead><tr><th> 桌子 </th><th> 结构 </th></tr></thead><tbody><tr><td> 用料 </td><td> <code>SSSIFFFIFIFfIX</code> </td> </tr><tr><td> 武器装备 </td><td> <code>SSISIIIFFFFIFIXB00000IHFFFfHHFF</code> </td> </tr><tr><td> 护甲 </td><td> <code>SSISIIIFFFFIFIXB00000ffBiHH</code> </td> </tr><tr><td> 快速物品 </td><td> <code>SSISIIIFFFFIFIXB00000IIFFSbH</code> </td> </tr><tr><td> 任务物品 </td><td> <code>SSISIIIFFFFIFIXB00000Is</code> </td> </tr><tr><td> 销售物品 </td><td> <code>SSISIIIFFFFIFIXB00000IHI</code> </td> </tr></tbody></table><br><h4 id="pereklyuchateli-ldb"> 开关（.ldb） </h4><br><table><thead><tr><th> 桌子 </th><th> 结构 </th></tr></thead><tbody><tr><td> 开关原型 </td><td> <code>SfIFTSSS</code> </td> </tr></tbody></table><br><h4 id="umeniya-i-navyki-pdb"> 技能与技巧（.pdb） </h4><br><table><thead><tr><th> 桌子 </th><th> 结构 </th></tr></thead><tbody><tr><td> 能力 </td><td> <code>SSI0000000s</code> </td> </tr><tr><td> 技能专长 </td><td> <code>SSI0000000SSIIIFFFIIIIBI</code> </td> </tr></tbody></table><br><h4 id="sledy-printsdb"> 足迹（prints.db） </h4><br><table><thead><tr><th> 桌子 </th><th> 结构 </th></tr></thead><tbody><tr><td> 血迹 </td><td> <code>0S11</code> </td> </tr><tr><td> 火焰痕迹 </td><td> <code>0S110000001</code> </td> </tr><tr><td> 足迹 </td><td> <code>0S11</code> </td> </tr></tbody></table><br><h4 id="zaklinaniya-sdb"> 咒语（.sdb） </h4><br><table><thead><tr><th> 桌子 </th><th> 结构 </th></tr></thead><tbody><tr><td> 样机 </td><td> <code>SSSFIFIFFFFIIIIUSSIIbIXFFFFF</code> </td> </tr><tr><td> 修饰符 </td><td> <code>SSFIFFISX</code> </td> </tr><tr><td> 模式 </td><td> <code>0SssSX</code> </td> </tr><tr><td> 装甲模板 </td><td> <code>0SssSX</code> </td> </tr><tr><td> 武器模式 </td><td> <code>0SssSX</code> </td> </tr></tbody></table><br><h4 id="suschestva-udb"> 生物（.udb） </h4><br><table><thead><tr><th> 桌子 </th><th> 结构 </th></tr></thead><tbody><tr><td> 零件损坏 </td><td> <code>SffUU</code> </td> </tr><tr><td> 种族 </td><td> <code>SUFFUUFfFUUf222222000000000000SssFSsfUUfUUIUSBFUUUU</code> </td> </tr><tr><td> 怪物原型 </td><td> <code>SSIUIFFFSFFFFFFFFFUFFFFFFff33sfssSFFFFFUFUSF</code> </td> </tr><tr><td>  NPC </td><td> <code>SUFFFFbbssssFUB</code> </td> </tr></tbody></table><br><h4 id="vykriki-acksdb"> 喊声（acks.db） </h4><br><table><thead><tr><th> 桌子 </th><th> 结构 </th></tr></thead><tbody><tr><td> 答案 </td><td> <code>0S0000000044444444444444444444445444444444444</code> </td> </tr><tr><td> 尖叫声 </td><td> <code>0S0000000044444</code> </td> </tr><tr><td> 其他 </td><td> <code>0S0000000044</code> </td> </tr></tbody></table><br><h4 id="zadaniya-qdb"> 任务（.qdb） </h4><br><table><thead><tr><th> 桌子 </th><th> 结构 </th></tr></thead><tbody><tr><td> 任务 </td><td> <code>SFIISIIs</code> </td> </tr><tr><td> 简报 </td><td> <code>SFFsSsssssI</code> </td> </tr></tbody></table></div></div><br><blockquote>  <strong>有趣的是：</strong> 2002年1月16日，Nival发布了csv格式的多人游戏的源代码库，以及游戏格式的实用程序转换器（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://web.archive.org/web/20020610194020/">网站快照</a> ）。 自然，逆转换器的出现并不慢。 至少还有两个描述modmakers的字段及其类型的文档，但是很难阅读它们。 </blockquote><br><h2 id="adb"> 亚行 </h2><br><p> 特定单元类型的动画数据库。 与上述* DB相比，它相当“人性化”-它是具有静态字段大小的单级表。 </p><br><p><img src="https://habrastorage.org/webt/vm/f4/jr/vmf4jr_3jtmqytycobxvurk7v2c.png"></p><br><div class="spoiler">  <b class="spoiler_title">结构说明</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">meta: id: adb title: Evil Islands, ADB file (animations database) application: Evil Islands file-extension: adb license: MIT endian: le doc: Animations database seq: - id: magic contents: [0x41, 0x44, 0x42, 0x00] doc: Magic bytes - id: animations_count type: u4 doc: Number of animations in base - id: unit_name type: str encoding: cp1251 size: 24 doc: Name of unit - id: min_height type: f4 doc: Minimal height of unit - id: mid_height type: f4 doc: Middle height of unit - id: max_height type: f4 doc: Maximal height of unit - id: animations type: animation doc: Array of animations repeat: expr repeat-expr: animations_count types: animation: doc: Animation's parameters seq: - id: name type: str encoding: cp1251 size: 16 doc: Animation's name - id: number type: u4 doc: Index in animations array - id: additionals type: additional doc: Packed structure with animation parameters - id: action_probability type: u4 doc: Percents of action probability - id: animation_length type: u4 doc: Lenght of animation in game ticks - id: movement_speed type: f4 doc: Movement speed - id: start_show_hide1 type: u4 - id: start_show_hide2 type: u4 - id: start_step_sound1 type: u4 - id: start_step_sound2 type: u4 - id: start_step_sound3 type: u4 - id: start_step_sound4 type: u4 - id: start_hit_frame type: u4 - id: start_special_sound type: u4 - id: spec_sound_id1 type: u4 - id: spec_sound_id2 type: u4 - id: spec_sound_id3 type: u4 - id: spec_sound_id4 type: u4 types: additional: seq: - id: packed type: u8 instances: weapons: value: 'packed &amp; 127' allowed_states: value: '(packed &gt;&gt; 15) &amp; 7' action_type: value: '(packed &gt;&gt; 18) &amp; 15' action_modifyer: value: '(packed &gt;&gt; 22) &amp; 255' animation_stage: value: '(packed &gt;&gt; 30) &amp; 3' action_forms: value: '(packed &gt;&gt; 36) &amp; 63'</code> </pre> </div></div><br><blockquote>  <strong>这很有趣：</strong>对于几个单元，使用了部分截断的数据库格式，这几乎没有被探索。 </blockquote><p> 处理完数据库后，我们宣布暂停广告投放。 但是我们不会做任何广告-不是我们的方法。 更好地表示接下来有用的东西-生物文件的命名方式。 </p><br><h2 id="format-imyon-modeley"> 型号名称格式 </h2><br><p> 名称是从两个字符组成的组中收集的-逻辑“级别”的缩写。 <br> 例如，女性角色将是<code>unhufe</code> - <code>Unit &gt; Human &gt; Female</code> ，并且<code>initwesp</code> - <code>Inventory &gt; Item &gt; Weapon &gt; Spear</code> ，即库存中的一支矛（不是后矛，这很好）。 </p><br><div class="spoiler">  <b class="spoiler_title">名称元素的完整树：</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">un: # unit an: # animal wi: # wild ti # tiger ba # bat bo # boar hy # hyen de # deer gi # rat ra # rat cr # crawler wo # wolf ho: # home co # cow pi # pig do # dog ho # horse ha # hare or: # orc fe # female ma # male mo: # monster co # column (menu) un # unicorn cu # Curse be # beholder tr # troll el # elemental su # succub (harpie) ba # banshee dr # driad sh # shadow li # lizard sk # skeleton sp # spider go # golem, goblin ri # Rick og # ogre zo # zombie bi # Rik's dragon cy # cyclope dg # dragon wi # willwisp mi # octopus to # toad hu: # human fe # female ma # male in: # inventory it: # item qu # quest qi # interactive ar: # armor pl # plate gl # gloves lg # leggins bt # boots sh # shirt hl # helm pt # pants li: # loot mt # material tr # trade we: # weapon hm # hammer dg # dagger sp # spear cb # crossbow sw # sword ax # axe bw # bow gm # game menu fa: # faces un: # unit an: # animal wi: # wild ti: # tiger face # face ba: # bat face # face bo: # boar face # face de: # deer face # face ra: # rat face # face cr: # crawler face # face wo: # wolf face # face ho: # home co: # cow face # face pi: # pig face # face do: # dog face # face ho: # horse face # face ha: # hare face # face hu: # human fe: # female fa # me # th # ma: # male fa # me # th # mo: # monster to: # toad face # face tr: # troll face # face or: # orc face # face sp: # spider face # face li: # lizard face # face na: # nature fl: # flora bu # bush te # termitary tr # tree li # waterplant wa # waterfall sk # sky st # stone ef: # effects cu # ar # co # components st: # static si # switch bu: # building to # tower ho # house tr # trap br # bridge ga # gate we # well (waterhole) wa: # wall me # medium li # light to # torch st # static</code> </pre> </div></div><br><blockquote>  <strong>这很有趣：</strong>按照这种分类，蘑菇是树木，带有地精的go是兄弟，而Tka-Rick是怪物。 在这里，您还可以看到怪物的“有效”名称，与D＆D的可疑名称相似-旁观者（邪恶之眼），调教（竖琴），食人魔（食人族），闪族（森林人）。 </blockquote><p> 在道德上休息之后，我们全力投入模型。 它们以链接在一起的几种格式表示。 </p><br><h2 id="lnk"> 伦克 </h2><br><p> 逻辑上-模型的基础。 用现代3D建模描述模型各部分的层次结构-骨骼的层次结构。 </p><br><p><img src="https://habrastorage.org/webt/we/va/a1/wevaa186p5bq4fvw8-4vtxbfiju.png"></p><br><div class="spoiler">  <b class="spoiler_title">结构说明</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">meta: id: lnk title: Evil Islands, LNK file (bones hierarchy) application: Evil Islands file-extension: lnk license: MIT endian: le doc: Bones hierarchy seq: - id: bones_count type: u4 doc: Number of bones - id: bones_array type: bone repeat: expr repeat-expr: bones_count doc: Array of bones types: bone: doc: Bone node seq: - id: bone_name_len type: u4 doc: Length of bone's name - id: bone_name type: str encoding: cp1251 size: bone_name_len doc: Bone's name - id: parent_name_len type: u4 doc: Length of bone's parent name - id: parent_name type: str encoding: cp1251 size: parent_name_len doc: Bone's parent name</code> </pre> </div></div><br><p> 父骨骼的父名称是一个空字符串（长度为0）。 </p><br><p> 有骨头，但是仅仅命名和组合在一起是不够的-您需要将它们组装成骨架。 </p><br><h2 id="bon"> 邦 </h2><br><p> 如前所述，此格式（如果不是归档文件）设置相对于父零件的模型零件（骨骼）的位置。 仅偏移存储，没有旋转-这是现代格式的差异之一。 </p><br><p><img src="https://habrastorage.org/webt/rq/f0/nt/rqf0ntdd5sxadr0us5gfq5cfq2g.png"></p><br><div class="spoiler">  <b class="spoiler_title">结构说明</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">meta: id: bon title: Evil Islands, BON file (bone position) application: Evil Islands file-extension: bon license: MIT endian: le doc: Bone position seq: - id: position type: vec3 doc: Bone translation repeat: eos types: vec3: doc: 3d vector seq: - id: x type: f4 doc: x axis - id: y type: f4 doc: y axis - id: z type: f4 doc: z axis</code> </pre> </div></div><br><p> 如您所见，一个偏移量的数字太多-事实是，在这里我们首先遇到了游戏引擎的关键特征之一-三线性模型插值。 </p><br><p> 工作原理：模型具有三个插值参数-有条件，强度，灵巧性，增长。 模型也有8个极端状态。 使用这些参数，我们可以通过三线性插值获得最终模型。 </p><br><div class="spoiler">  <b class="spoiler_title">算法本身</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trilinear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(val, coefs=[</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">])</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Linear interpolation by str t1 = val[0] + (val[1] - val[0]) * coefs[1] t2 = val[2] + (val[3] - val[2]) * coefs[1] # Bilinear interpolation by dex v1 = t1 + (t2 - t1) * coefs[0] # Linear interpolation by str t1 = val[4] + (val[5] - val[4]) * coefs[1] t2 = val[6] + (val[7] - val[6]) * coefs[1] # Bilinear interpolation by dex v2 = t1 + (t2 - t1) * coefs[0] # Trilinear interpolation by height return v1 + (v2 - v1) * coefs[2]</span></span></code> </pre> </div></div><br><blockquote>  <strong>这很有趣：</strong>三线性模型插值用于为某些对象设置动画，例如，打开石门和箱子。 </blockquote><p> 现在是时候看看模型本身的各个部分了。 </p><br><h2 id="fig"> 图 </h2><br><p> 也许这种反弹是无法理解的。 您可以在网上找到他的描述和搅拌机的插件，但是即使有了它们，意识也不会马上消失。 看一下： </p><br><p><img src="https://habrastorage.org/webt/c_/yx/bu/c_yxbuglpgn1h0j2g48gc1lk1dw.png"></p><br><div class="spoiler">  <b class="spoiler_title">结构说明</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">meta: id: fig title: Evil Islands, FIG file (figure) application: Evil Islands file-extension: fig license: MIT endian: le doc: 3d mesh seq: - id: magic contents: [0x46, 0x49, 0x47, 0x38] doc: Magic bytes - id: vertex_count type: u4 doc: Number of vertices blocks - id: normal_count type: u4 doc: Number of normals blocks - id: texcoord_count type: u4 doc: Number of UV pairs - id: index_count type: u4 doc: Number of indeces - id: vertex_components_count type: u4 doc: Number of vertex components - id: morph_components_count type: u4 doc: Number of morphing components - id: unknown contents: [0, 0, 0, 0] doc: Unknown (aligment) - id: group type: u4 doc: Render group - id: texture_index type: u4 doc: Texture offset - id: center type: vec3 doc: Center of mesh repeat: expr repeat-expr: 8 - id: aabb_min type: vec3 doc: AABB point of mesh repeat: expr repeat-expr: 8 - id: aabb_max type: vec3 doc: AABB point of mesh repeat: expr repeat-expr: 8 - id: radius type: f4 doc: Radius of boundings repeat: expr repeat-expr: 8 - id: vertex_array type: vertex_block doc: Blocks of raw vertex data repeat: expr repeat-expr: 8 - id: normal_array type: vec4x4 doc: Packed normal data repeat: expr repeat-expr: normal_count - id: texcoord_array type: vec2 doc: Texture coordinates data repeat: expr repeat-expr: texcoord_count - id: index_array type: u2 doc: Triangles indeces repeat: expr repeat-expr: index_count - id: vertex_components_array type: vertex_component doc: Vertex components array repeat: expr repeat-expr: vertex_components_count - id: morph_components_array type: morph_component doc: Morphing components array repeat: expr repeat-expr: morph_components_count types: morph_component: doc: Morphing components indeces seq: - id: morph_index type: u2 doc: Index of morphing data - id: vertex_index type: u2 doc: Index of vertex vertex_component: doc: Vertex components indeces seq: - id: position_index type: u2 doc: Index of position data - id: normal_index type: u2 doc: Index of normal data - id: texture_index type: u2 doc: Index of texcoord data vec2: doc: 2d vector seq: - id: u type: f4 doc: u axis - id: v type: f4 doc: v axis vec3: doc: 3d vector seq: - id: x type: f4 doc: x axis - id: y type: f4 doc: y axis - id: z type: f4 doc: z axis vec3x4: doc: 3d vector with 4 values per axis seq: - id: x type: f4 doc: x axis repeat: expr repeat-expr: 4 - id: y type: f4 doc: y axis repeat: expr repeat-expr: 4 - id: z type: f4 doc: z axis repeat: expr repeat-expr: 4 vertex_block: doc: Vertex raw block seq: - id: block type: vec3x4 doc: Vertex data repeat: expr repeat-expr: _root.vertex_count vec4x4: doc: 4d vector with 4 values per axis seq: - id: x type: f4 doc: x axis repeat: expr repeat-expr: 4 - id: y type: f4 doc: y axis repeat: expr repeat-expr: 4 - id: z type: f4 doc: z axis repeat: expr repeat-expr: 4 - id: w type: f4 doc: w axis repeat: expr repeat-expr: 4</code> </pre> </div></div><br><p> 有什么困难？ 因此，毕竟，法线和顶点的数据存储在4个块中，并且顶点也排列在8个块中进行插值。 </p><br><blockquote>  <strong>这很有趣：</strong>据推测，这样的分组是为了借助自1999年以来出现在英特尔处理器中的SSE指令来加快处理速度。 </blockquote><p> 好了，我们阅读并组成了模型，但是缺少了一些东西。 恰好-动画！ </p><br><h2 id="anm"> 安姆 </h2><br><p> 动画以组件形式存储为关键状态。 一个有趣的事实是，它不仅支持骨骼动画，而且还支持顶点变形。 </p><br><p><img src="https://habrastorage.org/webt/i_/yb/lr/i_yblr5zy2irqqer1jqi6tm8v_c.png"></p><br><div class="spoiler">  <b class="spoiler_title">结构说明</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">meta: id: anm title: Evil Islands, ANM file (bone animation) application: Evil Islands file-extension: anm license: MIT endian: le doc: Bone animation seq: - id: rotation_frames_count type: u4 doc: Number of rotation frames - id: rotation_frames type: quat repeat: expr repeat-expr: rotation_frames_count doc: Bone rotations - id: translation_frames_count type: u4 doc: Number of translation frames - id: translation_frames type: vec3 repeat: expr repeat-expr: translation_frames_count doc: Bone translation - id: morphing_frames_count type: u4 doc: Number of morphing frames - id: morphing_vertex_count type: u4 doc: Number of vertices with morphing - id: morphing_frames type: morphing_frame repeat: expr repeat-expr: morphing_frames_count doc: Array of morphing frames types: vec3: doc: 3d vector seq: - id: x type: f4 doc: x axis - id: y type: f4 doc: y axis - id: z type: f4 doc: z axis quat: doc: quaternion seq: - id: w type: f4 doc: w component - id: x type: f4 doc: x component - id: y type: f4 doc: y component - id: z type: f4 doc: z component morphing_frame: doc: Array of verteces morphing seq: - id: vertex_shift type: vec3 repeat: expr repeat-expr: _parent.morphing_vertex_count doc: Morphing shift per vertex</code> </pre> </div></div><br><p> 就是这样-现在我们有了完整的模型，您可以欣赏一下刚渲染的隐士蜥蜴： </p><br><p><img src="https://habrastorage.org/webt/bu/tk/sm/butksmbjbom_kgib93drtz9xvj8.jpeg"></p><br><div class="spoiler">  <b class="spoiler_title">怀旧的时刻</b> <div class="spoiler_text"><h4 id="uznat-chto-nuzhno-yascheru"> 找出蜥蜴的需求 </h4><br><p>  <em>与他家中的蜥蜴交谈</em> </p><br><p>  <strong>隐士蜥蜴：</strong>伙计，你来了。 很好 </p><br><p>  <strong>扎克：</strong>这就是你想告诉我的吗？ </p><br><p>  <strong>隐士蜥蜴：</strong>你又着急了。 我记得您的问题，并会回答。 我来找人做生意。 但是我看到了他们对你的表现。 他们一言不发，我停止相信他们。 你信守诺言 将为您提供交易。 </p><br><p>  <strong>隐士蜥蜴：</strong>人们喜欢黄金。 金蜥蜴没意思。 您将完成我的任务，我会给您我拥有的金子。 有很多黄金。 </p><br><p>  <strong>扎克<em>（深思熟虑，没多大兴趣）</em> ：</strong>嗯……金……肯定不会伤害…… </p><br><p>  <strong>扎克：</strong>如果您能帮助我找出我一直在寻找长寿的老魔术师的位置，那会更好。 毕竟，蜥蜴是一个古老的民族，你知道的！ </p><br><p>  <strong>隐士蜥蜴：</strong>你是对的。 蜥蜴是古老的民族。 我可以收集我们所知道的有关老人的一切。 您同意完成我的任务吗？ </p><br><p>  <strong>扎克：</strong>真是个话题！ 考虑到一切都已经完成。 </p><br><p>  <strong>隐士蜥蜴<em>（严重）</em> ：</strong>已经完成了吗？ 你想骗我吗 </p><br><p>  <strong>扎克：</strong>实际上，我想开个玩笑，否则你真的很认真。 </p><br><p>  <strong>隐士蜥蜴：</strong>我明白了。 这是个玩笑。 我想我也可以开个玩笑。 然后 现在我需要您将水还给运河。 兽人从我们那里偷了水。 </p><br><p>  <strong>隐士蜥蜴：</strong>沿着水往南走。 您将看到水坝和运河。 大坝必须抬高。 杠杆作用。 我会给。 该频道需要封锁。 石头。 我不会扔石头。 他已经躺在运河的边缘。 大坝上游。 石头很重。 当兽人挖掘时，他们将他抬了很长时间。 如果您推动他，他将迅速后退。 </p><br><p>  <strong>隐士蜥蜴：</strong>之后，回来。 我将告诉您我从旧魔术师那里学到的所有知识。 </p><br><p>  <strong>扎克：</strong>手牵手！ 但是，顺便说一句，如果您在故事中添加一些硬币，我将不会被冒犯。 </p><br><p>  <strong>隐士蜥蜴：要买</strong>硬币，去找我的亲戚，他们住在南部更浅的地方。 前往第三座最远的沙滩岛。 珍宝将属于您！ </p><br><p>  <strong>蜥蜴人隐士<em>（对自己）</em> ：</strong>奇怪。 这个男人喜欢幽默。 我在开玩笑。 那个人没有笑。 很奇怪 </p></div></div><br><p> 现在-最有趣的是：地图的存储方式。 </p><br><h2 id="mp">  MP </h2><br><p> 这是地图头文件。 由于不幸的巧合，扩展名与多人保存文件的扩展名重合，我们将不予考虑。 </p><br><p> 首先，您需要对景观进行总体描述： </p><br><ul><li>  “块”的数量-卡的32x32米； </li><li> 最大高度（因为顶点的高度以整数比例存储）； </li><li> 瓷砖地图集的数量。 </li></ul><br><p>     ,     — ,   . </p><br><p><img src="https://habrastorage.org/webt/rq/5a/zv/rq5azvlnywx7dynoartwivfelea.png"></p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">meta: id: mp title: Evil Islands, MP file (map header) application: Evil Islands file-extension: mp license: MIT endian: le doc: Map header seq: - id: magic contents: [0x72, 0xF6, 0x4A, 0xCE] doc: Magic bytes - id: max_altitude type: f4 doc: Maximal height of terrain - id: x_chunks_count type: u4 doc: Number of sectors by x - id: y_chunks_count type: u4 doc: Number of sectors by y - id: textures_count type: u4 doc: Number of texture files - id: texture_size type: u4 doc: Size of texture in pixels by side - id: tiles_count type: u4 doc: Number of tiles - id: tile_size type: u4 doc: Size of tile in pixels by side - id: materials_count type: u2 doc: Number of materials - id: animated_tiles_count type: u4 doc: Number of animated tiles - id: materials type: material doc: Map materials repeat: expr repeat-expr: materials_count - id: id_array type: u4 doc: Tile type repeat: expr repeat-expr: tiles_count enum: tile_type - id: animated_tiles type: animated_tile doc: Animated tiles repeat: expr repeat-expr: animated_tiles_count types: material: doc: Material parameters seq: - id: type type: u4 doc: Material type by enum: terrain_type - id: color type: rgba doc: RGBA diffuse color - id: self_illumination type: f4 doc: Self illumination - id: wave_multiplier type: f4 doc: Wave speed multiplier - id: warp_speed type: f4 doc: Warp speed multiplier - id: unknown size: 12 types: rgba: doc: RGBA color seq: - id: r type: f4 doc: Red channel - id: g type: f4 doc: Green channel - id: b type: f4 doc: Blue channel - id: a type: f4 doc: Alpha channel enums: terrain_type: 0: base 1: water_notexture 2: grass 3: water animated_tile: doc: Animated tile parameters seq: - id: start_index type: u2 doc: First tile of animation - id: length type: u2 doc: Animation frames count enums: tile_type: 0: grass 1: ground 2: stone 3: sand 4: rock 5: field 6: water 7: road 8: empty 9: snow 10: ice 11: drygrass 12: snowballs 13: lava 14: swamp 15: highrock</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><table><thead><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地形类型 </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 型式 </font></font></th></tr></thead><tbody><tr><td>  0 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 基础景观 </font></font></td></tr><tr><td>  1个 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 无纹理的水 </font></font></td></tr><tr><td>  2 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 纹理的草 </font></font></td></tr><tr><td>  3 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 质感的水 </font></font></td></tr></tbody></table></div></div><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><table><thead><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 材料类型 </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 型式 </font></font></th></tr></thead><tbody><tr><td>  0 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 草 </font></font></td></tr><tr><td>  1个 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地面 </font></font></td></tr><tr><td>  2 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 石头 </font></font></td></tr><tr><td>  3 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 沙 </font></font></td></tr><tr><td>  4 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 摇滚乐 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 5 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 场 </font></font></td></tr><tr><td>  6 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 水 </font></font></td></tr><tr><td>  7 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 路 </font></font></td></tr><tr><td>  8 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> （空） </font></font></td></tr><tr><td>  9 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 大雪 </font></font></td></tr><tr><td>  10 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 冰块 </font></font></td></tr><tr><td>  11 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 干草 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 12 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 雪球 </font></font></td></tr><tr><td>  13 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 熔岩 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 14 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 沼泽地 </font></font></td></tr><tr><td>  15 </td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 高摇滚 </font></font></td></tr></tbody></table></div></div><br><p>      ,      <code>Res/aiinfo.res/tileDesc.reg</code> . </p><br><blockquote> <strong> :</strong>     ,   —       . <br>   :       . </blockquote><p>       .  ! </p><br><h2 id="sec"> SEC </h2><br><p>      —  3232 .       ,    <code>ZonenameXXXYYY</code> . </p><br><p><img src="https://habrastorage.org/webt/9-/pd/_l/9-pd_ltybkk7hx_oywo4wsfwrpc.png"></p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">meta: id: sec title: Evil Islands, SEC file (map sector) application: Evil Islands file-extension: sec license: MIT endian: le doc: Map sector seq: - id: magic contents: [0x74, 0xF7, 0x4B, 0xCF] doc: Magic bytes - id: liquids type: u1 doc: Liquids layer indicator - id: vertexes type: vertex doc: Vertex array 33x33 repeat: expr repeat-expr: 1089 - id: liquid_vertexes type: vertex doc: Vertex array 33x33 if: liquids != 0 repeat: expr repeat-expr: 'liquids != 0 ? 1089 : 0' - id: tiles type: tile doc: Tile array 16x16 repeat: expr repeat-expr: 256 - id: liquid_tiles type: tile doc: Tile array 16x16 if: liquids != 0 repeat: expr repeat-expr: 'liquids != 0 ? 256 : 0' - id: liquid_material type: u2 doc: Index of material if: liquids != 0 repeat: expr repeat-expr: 'liquids != 0 ? 256 : 0' types: vertex: doc: Vertex data seq: - id: x_shift type: s1 doc: Shift by x axis - id: y_shift type: s1 doc: Shift by y axis - id: altitude type: u2 doc: Height (z position) - id: packed_normal type: normal doc: Packed normal normal: doc: Normal (3d vector) seq: - id: packed type: u4 doc: Normal packed in 4b instances: x: doc: Unpacked x component value: packed &gt;&gt; 11 &amp; 0x7FF y: doc: Unpacked y component value: packed &amp; 0x7FF z: doc: Unpacked z component value: packed &gt;&gt; 22 tile: doc: Tile parameters seq: - id: packed type: u2 doc: Tile information packed in 2b instances: index: doc: Tile index in texture value: packed &amp; 63 texture: doc: Texture index value: packed &gt;&gt; 6 &amp; 255 rotation: doc: Tile rotation (*90 degrees) value: packed &gt;&gt; 14 &amp; 3</code> </pre> </div></div><br><p>      —       . </p><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><h4 id="raspakovka-normali"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 正常拆箱 </font></font></h4><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 每个z轴10位，每个x和y 11位 </font></font></p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> packed_normal; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> x = ((<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)((packed_normal &gt;&gt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x7FF</span></span>) - <span class="hljs-number"><span class="hljs-number">1000.0f</span></span>) / <span class="hljs-number"><span class="hljs-number">1000.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> y = ((<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)(packed_normal &amp; <span class="hljs-number"><span class="hljs-number">0x7FF</span></span>) - <span class="hljs-number"><span class="hljs-number">1000.0f</span></span>) / <span class="hljs-number"><span class="hljs-number">1000.0f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> z = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)(packed_normal &gt;&gt; <span class="hljs-number"><span class="hljs-number">22</span></span>) / <span class="hljs-number"><span class="hljs-number">1000.0f</span></span>;</code> </pre> <br><h4 id="informaciya-o-teksture"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 纹理信息 </font></font></h4><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 地图集中每个索引6位，每个纹理编号8个，每旋转2个 </font></font></p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">short</span></span> texture; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> tile_index = f &amp; <span class="hljs-number"><span class="hljs-number">63</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> texture_index = (f &gt;&gt; <span class="hljs-number"><span class="hljs-number">6</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">255</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> rotation = (f &gt;&gt; <span class="hljs-number"><span class="hljs-number">14</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">3</span></span>;</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title"> 3d </b> <div class="spoiler_text"><h4 id="poluchenie-landshafta"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 获得风景 </font></font></h4><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">顶点沿着33条线中的33个元素移动，即形成32x32单元。</font><font style="vertical-align: inherit;">电池的边长为1个常规单位。</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">顶点位置：</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x = x的索引+ x_offset / 254 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y = y的索引+ y_offset / 254 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z =高度/ 65535 * max_altitude（来自.mp文件）</font></font></p><br><p>     "",       : </p><br><pre> <code class="plaintext hljs"> 0 1 2 *-*-* |\|\| ~ 33 *-*-* |\|\| ~ 66 *-*-* ~ ~ ~</code> </pre> <br><p>       ,  , 1616 .   — 2  .      ,  90 . </p></div></div><br><p>        .   ,     ,     ID  ,       MP . </p><br><blockquote> <strong> :</strong>    MP,     ,       :  ID     , -     . <br>  ID       —         . </blockquote><p>  —      : </p><br><p><img src="https://habrastorage.org/webt/so/88/c6/so88c6ufcpzn1cqhxc7orbzeif4.jpeg"></p><br><p>   - —    ,         . </p><br><h2 id="mob"> MOB </h2><br><p>    ( )   ,     ,     :   .           —    " ",     . <br>         ,    (    ). </p><br><p>   : </p><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> structure { <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> type_id; <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> size; byte data[size - <span class="hljs-number"><span class="hljs-number">8</span></span>]; } node;</code> </pre> <br><div class="spoiler"> <b class="spoiler_title">  (,   !)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/hf/jd/yi/hfjdyiujzmtzizewv5i86pmjil0.png"></p><br><p>   ( , ) </p><br><pre> <code class="plaintext hljs">meta: id: mob title: Evil Islands, MOB file (map entities) application: Evil Islands file-extension: mob license: MIT endian: le doc: Map entities tree seq: - id: root_node type: node doc: Root node types: node: doc: Entity node seq: - id: type_id type: u4 doc: Node children type ID - id: size type: u4 doc: Node full size - id: data type: node_data size: size - 8 doc: Node stored data node_data: doc: Node data seq: - id: value type: switch-on: _parent.type_id cases: 0xA000: node 0x00001E00: node 0x00001E01: node 0x00001E02: node 0x00001E03: node 0x00001E0B: node 0x00001E0E: node 0x0000A000: node 0x0000AA01: node 0x0000ABD0: node 0x0000B000: node 0x0000B001: node 0x0000CC01: node 0x0000DD01: node 0x0000E000: node 0x0000E001: node 0x0000F000: node 0x0000FF00: node 0x0000FF01: node 0x0000FF02: node 0xBBAB0000: node 0xBBAC0000: node 0xBBBB0000: node 0xBBBC0000: node 0xBBBD0000: node 0xBBBE0000: node 0xBBBF0000: node 0xDDDDDDD1: node _: u1 doc: Node elements repeat: eos</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title">   </b> <div class="spoiler_text"><table><thead><tr><th>   </th><th>  () </th><th> 说明 </th></tr></thead><tbody><tr><td> AiGraph </td><td></td><td>   </td></tr><tr><td> AreaArray </td><td></td><td></td></tr><tr><td> Byte </td><td>  1个 </td><td> 1   </td></tr><tr><td> Diplomacy </td><td> 4096 </td><td> 32x32   2  </td></tr><tr><td> Dword </td><td>  4 </td><td> 4   </td></tr><tr><td> 浮点数 </td><td>  4 </td><td> 4  </td></tr><tr><td> LeverStats </td><td> 12 </td><td>   </td></tr><tr><td> Null </td><td>  0 </td><td>   </td></tr><tr><td> Plot </td><td> 12 </td><td> 3 floats (vec3) </td></tr><tr><td> Plot2DArray </td><td></td><td></td></tr><tr><td> Quaternion </td><td> 16 </td><td> 4 floats (vec4) </td></tr><tr><td> Record </td><td> &gt;8 </td><td>   </td></tr><tr><td> Rectangle </td><td></td><td></td></tr><tr><td> 弦乐 </td><td></td><td>  </td></tr><tr><td> StringArray </td><td> &gt;4 </td><td>   </td></tr><tr><td> StringEncrypted </td><td> &gt;4 </td><td>    </td></tr><tr><td> UnitStats </td><td>  180 </td><td>   </td></tr><tr><td> Unknown </td><td></td><td></td></tr></tbody></table></div></div><br><div class="spoiler"> <b class="spoiler_title">  type_id</b> <div class="spoiler_text"><table><thead><tr><th> type_id </th><th>   </th><th>   </th></tr></thead><tbody><tr><td> 0x00000000 </td><td> Record </td><td> ROOT </td></tr><tr><td> 0x00001E00 </td><td> Record </td><td> VSS_SECTION </td></tr><tr><td> 0x00001E01 </td><td> Record </td><td> VSS_TRIGER </td></tr><tr><td> 0x00001E02 </td><td> Record </td><td> VSS_CHECK </td></tr><tr><td> 0x00001E03 </td><td> Record </td><td> VSS_PATH </td></tr><tr><td> 0x00001E04 </td><td> Dword </td><td> VSS_ID </td></tr><tr><td> 0x00001E05 </td><td> Rectangle </td><td> VSS_RECT </td></tr><tr><td> 0x00001E06 </td><td> Dword </td><td> VSS_SRC_ID </td></tr><tr><td> 0x00001E07 </td><td> Dword </td><td> VSS_DST_ID </td></tr><tr><td> 0x00001E08 </td><td> 弦乐 </td><td> VSS_TITLE </td></tr><tr><td> 0x00001E09 </td><td> 弦乐 </td><td> VSS_COMMANDS </td></tr><tr><td> 0x00001E0A </td><td> Byte </td><td> VSS_ISSTART </td></tr><tr><td> 0x00001E0B </td><td> Record </td><td> VSS_LINK </td></tr><tr><td> 0x00001E0C </td><td> 弦乐 </td><td> VSS_GROUP </td></tr><tr><td> 0x00001E0D </td><td> Byte </td><td> VSS_IS_USE_GROUP </td></tr><tr><td> 0x00001E0E </td><td> Record </td><td> VSS_VARIABLE </td></tr><tr><td> 0x00001E0F </td><td> StringArray </td><td> VSS_BS_CHECK </td></tr><tr><td> 0x00001E10 </td><td> StringArray </td><td> VSS_BS_COMMANDS </td></tr><tr><td> 0x00001E11 </td><td> 弦乐 </td><td> VSS_CUSTOM_SRIPT </td></tr><tr><td> 0x0000A000 </td><td> Record </td><td> OBJECTDBFILE </td></tr><tr><td> 0x0000AA00 </td><td> Null </td><td> LIGHT_SECTION </td></tr><tr><td> 0x0000AA01 </td><td> Record </td><td> LIGHT </td></tr><tr><td> 0x0000AA02 </td><td> 浮点数 </td><td> LIGHT_RANGE </td></tr><tr><td> 0x0000AA03 </td><td> 弦乐 </td><td> LIGHT_NAME </td></tr><tr><td> 0x0000AA04 </td><td> Plot </td><td> LIGHT_POSITION </td></tr><tr><td> 0x0000AA05 </td><td> Dword </td><td> LIGHT_ID </td></tr><tr><td> 0x0000AA06 </td><td> Byte </td><td> LIGHT_SHADOW </td></tr><tr><td> 0x0000AA07 </td><td> Plot </td><td> LIGHT_COLOR </td></tr><tr><td> 0x0000AA08 </td><td> 弦乐 </td><td> LIGHT_COMMENTS </td></tr><tr><td> 0x0000ABD0 </td><td> Record </td><td> WORLD_SET </td></tr><tr><td> 0x0000ABD1 </td><td> Plot </td><td> WS_WIND_DIR </td></tr><tr><td> 0x0000ABD2 </td><td> 浮点数 </td><td> WS_WIND_STR </td></tr><tr><td> 0x0000ABD3 </td><td> 浮点数 </td><td> WS_TIME </td></tr><tr><td> 0x0000ABD4 </td><td> 浮点数 </td><td> WS_AMBIENT </td></tr><tr><td> 0x0000ABD5 </td><td> 浮点数 </td><td> WS_SUN_LIGHT </td></tr><tr><td> 0x0000B000 </td><td> Record </td><td> OBJECTSECTION </td></tr><tr><td> 0x0000B001 </td><td> Record </td><td> OBJECT </td></tr><tr><td> 0x0000B002 </td><td> Dword </td><td> NID </td></tr><tr><td> 0x0000B003 </td><td> Dword </td><td> OBJTYPE </td></tr><tr><td> 0x0000B004 </td><td> 弦乐 </td><td> OBJNAME </td></tr><tr><td> 0x0000B005 </td><td> Null </td><td> OBJINDEX </td></tr><tr><td> 0x0000B006 </td><td> 弦乐 </td><td> OBJTEMPLATE </td></tr><tr><td> 0x0000B007 </td><td> 弦乐 </td><td> OBJPRIMTXTR </td></tr><tr><td> 0x0000B008 </td><td> 弦乐 </td><td> OBJSECTXTR </td></tr><tr><td> 0x0000B009 </td><td> Plot </td><td> OBJPOSITION </td></tr><tr><td> 0x0000B00A </td><td> Quaternion </td><td> OBJROTATION </td></tr><tr><td> 0x0000B00B </td><td> Null </td><td> OBJTEXTURE </td></tr><tr><td> 0x0000B00C </td><td> Plot </td><td> OBJCOMPLECTION </td></tr><tr><td> 0x0000B00D </td><td> StringArray </td><td> OBJBODYPARTS </td></tr><tr><td> 0x0000B00E </td><td> 弦乐 </td><td> PARENTTEMPLATE </td></tr><tr><td> 0x0000B00F </td><td> 弦乐 </td><td> OBJCOMMENTS </td></tr><tr><td> 0x0000B010 </td><td> Null </td><td> OBJ_DEF_LOGIC </td></tr><tr><td> 0x0000B011 </td><td> Byte </td><td> OBJ_PLAYER </td></tr><tr><td> 0x0000B012 </td><td> Dword </td><td> OBJ_PARENT_ID </td></tr><tr><td> 0x0000B013 </td><td> Byte </td><td> OBJ_USE_IN_SCRIPT </td></tr><tr><td> 0x0000B014 </td><td> Byte </td><td> OBJ_IS_SHADOW </td></tr><tr><td> 0x0000B015 </td><td> Null </td><td> OBJ_R </td></tr><tr><td> 0x0000B016 </td><td> 弦乐 </td><td> OBJ_QUEST_INFO </td></tr><tr><td> 0x0000C000 </td><td> Null </td><td> SC_OBJECTDBFILE </td></tr><tr><td> 0x0000CC00 </td><td> Null </td><td> SOUND_SECTION </td></tr><tr><td> 0x0000CC01 </td><td> Record </td><td> SOUND </td></tr><tr><td> 0x0000CC02 </td><td> Dword </td><td> SOUND_ID </td></tr><tr><td> 0x0000CC03 </td><td> Plot </td><td> SOUND_POSITION </td></tr><tr><td> 0x0000CC04 </td><td> Dword </td><td> SOUND_RANGE </td></tr><tr><td> 0x0000CC05 </td><td> 弦乐 </td><td> SOUND_NAME </td></tr><tr><td> 0x0000CC06 </td><td> Dword </td><td> SOUND_MIN </td></tr><tr><td> 0x0000CC07 </td><td> Dword </td><td> SOUND_MAX </td></tr><tr><td> 0x0000CC08 </td><td> 弦乐 </td><td> SOUND_COMMENTS </td></tr><tr><td> 0x0000CC09 </td><td> Null </td><td> SOUND_VOLUME </td></tr><tr><td> 0x0000CC0A </td><td> StringArray </td><td> SOUND_RESNAME </td></tr><tr><td> 0x0000CC0B </td><td> Dword </td><td> SOUND_RANGE2 </td></tr><tr><td> 0x0000CC0D </td><td> Byte </td><td> SOUND_AMBIENT </td></tr><tr><td> 0x0000CC0E </td><td> Byte </td><td> SOUND_IS_MUSIC </td></tr><tr><td> 0x0000D000 </td><td> Null </td><td> PR_OBJECTDBFILE </td></tr><tr><td> 0x0000DD00 </td><td> Null </td><td> PARTICL_SECTION </td></tr><tr><td> 0x0000DD01 </td><td> Record </td><td> PARTICL </td></tr><tr><td> 0x0000DD02 </td><td> Dword </td><td> PARTICL_ID </td></tr><tr><td> 0x0000DD03 </td><td> Plot </td><td> PARTICL_POSITION </td></tr><tr><td> 0x0000DD04 </td><td> 弦乐 </td><td> PARTICL_COMMENTS </td></tr><tr><td> 0x0000DD05 </td><td> 弦乐 </td><td> PARTICL_NAME </td></tr><tr><td> 0x0000DD06 </td><td> Dword </td><td> PARTICL_TYPE </td></tr><tr><td> 0x0000DD07 </td><td> 浮点数 </td><td> PARTICL_SCALE </td></tr><tr><td> 0x0000E000 </td><td> Record </td><td> DIRICTORY </td></tr><tr><td> 0x0000E001 </td><td> Record </td><td> FOLDER </td></tr><tr><td> 0x0000E002 </td><td> 弦乐 </td><td> DIR_NAME </td></tr><tr><td> 0x0000E003 </td><td> Dword </td><td> DIR_NINST </td></tr><tr><td> 0x0000E004 </td><td> Dword </td><td> DIR_PARENT_FOLDER </td></tr><tr><td> 0x0000E005 </td><td> Byte </td><td> DIR_TYPE </td></tr><tr><td> 0x0000F000 </td><td> Record </td><td> DIRICTORY_ELEMENTS </td></tr><tr><td> 0x0000FF00 </td><td> Record </td><td> SEC_RANGE </td></tr><tr><td> 0x0000FF01 </td><td> Record </td><td> MAIN_RANGE </td></tr><tr><td> 0x0000FF02 </td><td> Record </td><td> RANGE </td></tr><tr><td> 0x0000FF05 </td><td> Dword </td><td> MIN_ID </td></tr><tr><td> 0x0000FF06 </td><td> Dword </td><td> MAX_ID </td></tr><tr><td> 0x31415926 </td><td> AiGraph </td><td> AIGRAPH </td></tr><tr><td> 0xACCEECCA </td><td> 弦乐 </td><td> SS_TEXT_OLD </td></tr><tr><td> 0xACCEECCB </td><td> StringEncrypted </td><td> SS_TEXT </td></tr><tr><td> 0xBBAB0000 </td><td> Record </td><td> MAGIC_TRAP </td></tr><tr><td> 0xBBAB0001 </td><td> Dword </td><td> MT_DIPLOMACY </td></tr><tr><td> 0xBBAB0002 </td><td> 弦乐 </td><td> MT_SPELL </td></tr><tr><td> 0xBBAB0003 </td><td> AreaArray </td><td> MT_AREAS </td></tr><tr><td> 0xBBAB0004 </td><td> Plot2DArray </td><td> MT_TARGETS </td></tr><tr><td> 0xBBAB0005 </td><td> Dword </td><td> MT_CAST_INTERVAL </td></tr><tr><td> 0xBBAC0000 </td><td> Record </td><td> LEVER </td></tr><tr><td> 0xBBAC0001 </td><td> Null </td><td> LEVER_SCIENCE_STATS </td></tr><tr><td> 0xBBAC0002 </td><td> Byte </td><td> LEVER_CUR_STATE </td></tr><tr><td> 0xBBAC0003 </td><td> Byte </td><td> LEVER_TOTAL_STATE </td></tr><tr><td> 0xBBAC0004 </td><td> Byte </td><td> LEVER_IS_CYCLED </td></tr><tr><td> 0xBBAC0005 </td><td> Byte </td><td> LEVER_CAST_ONCE </td></tr><tr><td> 0xBBAC0006 </td><td> LeverStats </td><td> LEVER_SCIENCE_STATS_NEW </td></tr><tr><td> 0xBBAC0007 </td><td> Byte </td><td> LEVER_IS_DOOR </td></tr><tr><td> 0xBBAC0008 </td><td> Byte </td><td> LEVER_RECALC_GRAPH </td></tr><tr><td> 0xBBBB0000 </td><td> Record </td><td> UNIT </td></tr><tr><td> 0xBBBB0001 </td><td> Null </td><td> UNIT_R </td></tr><tr><td> 0xBBBB0002 </td><td> 弦乐 </td><td> UNIT_PROTOTYPE </td></tr><tr><td> 0xBBBB0003 </td><td> Null </td><td> UNIT_ITEMS </td></tr><tr><td> 0xBBBB0004 </td><td> UnitStats </td><td> UNIT_STATS </td></tr><tr><td> 0xBBBB0005 </td><td> StringArray </td><td> UNIT_QUEST_ITEMS </td></tr><tr><td> 0xBBBB0006 </td><td> StringArray </td><td> UNIT_QUICK_ITEMS </td></tr><tr><td> 0xBBBB0007 </td><td> StringArray </td><td> UNIT_SPELLS </td></tr><tr><td> 0xBBBB0008 </td><td> StringArray </td><td> UNIT_WEAPONS </td></tr><tr><td> 0xBBBB0009 </td><td> StringArray </td><td> UNIT_ARMORS </td></tr><tr><td> 0xBBBB000A </td><td> Byte </td><td> UNIT_NEED_IMPORT </td></tr><tr><td> 0xBBBC0000 </td><td> Record </td><td> UNIT_LOGIC </td></tr><tr><td> 0xBBBC0001 </td><td> Null </td><td> UNIT_LOGIC_AGRESSIV </td></tr><tr><td> 0xBBBC0002 </td><td> Byte </td><td> UNIT_LOGIC_CYCLIC </td></tr><tr><td> 0xBBBC0003 </td><td> Dword </td><td> UNIT_LOGIC_MODEL </td></tr><tr><td> 0xBBBC0004 </td><td> 浮点数 </td><td> UNIT_LOGIC_GUARD_R </td></tr><tr><td> 0xBBBC0005 </td><td> Plot </td><td> UNIT_LOGIC_GUARD_PT </td></tr><tr><td> 0xBBBC0006 </td><td> Byte </td><td> UNIT_LOGIC_NALARM </td></tr><tr><td> 0xBBBC0007 </td><td> Byte </td><td> UNIT_LOGIC_USE </td></tr><tr><td> 0xBBBC0008 </td><td> Null </td><td> UNIT_LOGIC_REVENGE </td></tr><tr><td> 0xBBBC0009 </td><td> Null </td><td> UNIT_LOGIC_FEAR </td></tr><tr><td> 0xBBBC000A </td><td> 浮点数 </td><td> UNIT_LOGIC_WAIT </td></tr><tr><td> 0xBBBC000B </td><td> Byte </td><td> UNIT_LOGIC_ALARM_CONDITION </td></tr><tr><td> 0xBBBC000C </td><td> 浮点数 </td><td> UNIT_LOGIC_HELP </td></tr><tr><td> 0xBBBC000D </td><td> Byte </td><td> UNIT_LOGIC_ALWAYS_ACTIVE </td></tr><tr><td> 0xBBBC000E </td><td> Byte </td><td> UNIT_LOGIC_AGRESSION_MODE </td></tr><tr><td> 0xBBBD0000 </td><td> Record </td><td> GUARD_PT </td></tr><tr><td> 0xBBBD0001 </td><td> Plot </td><td> GUARD_PT_POSITION </td></tr><tr><td> 0xBBBD0002 </td><td> Null </td><td> GUARD_PT_ACTION </td></tr><tr><td> 0xBBBE0000 </td><td> Record </td><td> ACTION_PT </td></tr><tr><td> 0xBBBE0001 </td><td> Plot </td><td> ACTION_PT_LOOK_PT </td></tr><tr><td> 0xBBBE0002 </td><td> Dword </td><td> ACTION_PT_WAIT_SEG </td></tr><tr><td> 0xBBBE0003 </td><td> Dword </td><td> ACTION_PT_TURN_SPEED </td></tr><tr><td> 0xBBBE0004 </td><td> Byte </td><td> ACTION_PT_FLAGS </td></tr><tr><td> 0xBBBF0000 </td><td> Record </td><td> TORCH </td></tr><tr><td> 0xBBBF0001 </td><td> 浮点数 </td><td> TORCH_STRENGHT </td></tr><tr><td> 0xBBBF0002 </td><td> Plot </td><td> TORCH_PTLINK </td></tr><tr><td> 0xBBBF0003 </td><td> 弦乐 </td><td> TORCH_SOUND </td></tr><tr><td> 0xDDDDDDD1 </td><td> Record </td><td> DIPLOMATION </td></tr><tr><td> 0xDDDDDDD2 </td><td> Diplomacy </td><td> DIPLOMATION_FOF </td></tr><tr><td> 0xDDDDDDD3 </td><td> StringArray </td><td> DIPLOMATION_PL_NAMES </td></tr><tr><td> 0xFFFFFFFF </td><td> Unknown </td><td> UNKNOWN </td></tr></tbody></table></div></div><br><p>        — ,    ,     Nival,    —  ,     (  ,  ). </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> key; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; size; i++) { key += (((((key * <span class="hljs-number"><span class="hljs-number">13</span></span>) &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) + key) &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) - key) * <span class="hljs-number"><span class="hljs-number">4</span></span> + <span class="hljs-number"><span class="hljs-number">2531011</span></span>; data[i] ^= key &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>; }</code> </pre> </div></div><br><blockquote> <strong> :</strong>      ,       (   )    .   ,      ,       ,       . </blockquote><p>      (  ,   ,    — Windows 98): </p><br><p><img src="https://habrastorage.org/webt/8w/qv/gz/8wqvgzyxxuqmqremuny92irjzue.jpeg"></p><br><blockquote> <strong> :</strong>       ,     . ,        ( , ,  " :   ",     ). </blockquote><p>  ,     ,  -     -   , , Collada      : </p><br><p><img src="https://habrastorage.org/webt/l8/2i/tc/l82itcjm6orpd7hb0tp6p9rqq5y.jpeg"></p><br><h1 id="epilog">  </h1><br><p>          .      ,          <em> </em>   . </p><br><p>  ,            .     -   ,   — -    ,      . , -... </p><br><p>     —     ! </p><br><p> <strong>UPD (23.01.2019):</strong> <br>        ,             : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github</a> . <br>        ,          (,   ""      ). </p><br><div class="spoiler"> <b class="spoiler_title">   </b> <div class="spoiler_text"><h3 id="obschaya-informaciya-ob-igre">     </h3><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://ru.nival.com/games/history/zemli</a> —    </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://ru.wikipedia.org/wiki/_</a> —    </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://allods.gipat.ru/index.php?p=ei</a> —    " " </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://evil-islands.github.io</a> —  ,     </li></ul><br><h3 id="instrumenty-s-otkrytymi-ishodnikami">     </h3><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://gipatgroup.org/utilities</a> — EiEdit (.res, .*db), MobSurgeon (.mob) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://svn.gipat.org/trac/GGWiki</a> — EiEdit (.res, .*db), MobSurgeon (.mob),    .mp, .sec, .*db </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/demothorg/eifixer</a> —     </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/konstvest/ei_figer</a> —   Blender   .lnk, .fig, .bon, .anm </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/demothorg/ei-tools</a> —       (.mob, .lnk, .mpr, .res) +   </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/konstvest/ei_maper</a> —   (.mpr, .mp, .sec, .mob) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/chemmalion/EIDBEditor</a> —     (.*db) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://gitlab.com/ykurganov/open-evil-islands</a> —       ,      </li></ul><br><h3 id="kommyuniti">  </h3><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://vk.com/evil.islands</a> —   </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://allods.gipat.ru</a> — " " </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://gipat.ru</a> —  " " </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://gipatgroup.org/forum</a> —  GipatGroup (   —  ) </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">http://honestgroup.net/forum</a> —  HonestGroup </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN434802/">https://habr.com/ru/post/zh-CN434802/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN434792/index.html">Freelansim 2018：年度业绩</a></li>
<li><a href="../zh-CN434794/index.html">成功的测试人员的软技能</a></li>
<li><a href="../zh-CN434796/index.html">编码艺术：我们如何在设计项目中生成图形和动画</a></li>
<li><a href="../zh-CN434798/index.html">Swagger-RESTful Web API的智能文档-新手的初级后端开发人员评论</a></li>
<li><a href="../zh-CN434800/index.html">（5-2）迁移大型SQL表的方法</a></li>
<li><a href="../zh-CN434804/index.html">金融科技初创公司Robinhood无法启动类似银行账户的业务</a></li>
<li><a href="../zh-CN434806/index.html">新年用独木舟拆除</a></li>
<li><a href="../zh-CN434810/index.html">使用Spring Cloud的入门</a></li>
<li><a href="../zh-CN434812/index.html">项目时间管理</a></li>
<li><a href="../zh-CN434816/index.html">Detox和Appium：React Native中的自动接口测试</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>