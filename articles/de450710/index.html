<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöÅ üñïüèø üë®üèª‚Äçüîß Rekonstruktion von Midi aus Synthesia-Videos (und √§hnlichem) üçÖ üïå üë®üèΩ‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Als ich einmal auf YouTube sa√ü und nach interessanten Lehrmelodien suchte, stie√ü ich auf Videos von Synthesia, von denen einige mir sehr gut gefallen ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rekonstruktion von Midi aus Synthesia-Videos (und √§hnlichem)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450710/"><p>  Als ich einmal auf YouTube sa√ü und nach interessanten Lehrmelodien suchte, stie√ü ich auf Videos von Synthesia, von denen einige mir sehr gut gefallen haben. Ich entschied mich, sie herunterzuladen und zu lernen ... =) Aber leider stellte sich heraus, dass es Videos gibt, aber niemand wollte MIDI-Dateien hochladen = ( </p><br><p>  Als ich mich f√ºr Google entschied, wollte ich herausfinden, ob es vorgefertigte L√∂sungen gibt, die zu mir passen, aber leider aufgrund der Tatsache, dass es nur Audiokonverter im Midi gab, was mich leicht ver√§rgerte ... Ohne zweimal dar√ºber nachzudenken, entschied ich, dass es ausreichen w√ºrde, die MIDI-Bildrate in Videoclips wiederherzustellen ..., und ich beschloss zu versuchen, dieses Gesch√§ft umzusetzen ... </p><a name="habracut"></a><br><p>  Ich wollte nicht alles von Grund auf neu schreiben, weil ich beschlossen habe, was ich mit den vorgefertigten Komponenten tun m√∂chte, die Debian GNU / Linux mir zur Verf√ºgung stellt, von denen Python am besten geeignet ist. </p><br><p>  Zu Beginn der Implementierung habe ich beschlossen, fertige (aus Videoclips herausgezogene) Bilder zu verwenden, aber nach den ersten Uploads wurde mir klar, dass dies keinen Sinn ergibt. Es stellte sich heraus, dass es sehr langsam war und auch erhebliche Ressourcen f√ºr die Schraube verbrauchte. Dann entschied ich mich, eine neue Sache f√ºr mich selbst auszuprobieren OpenCV (ich wollte es schon lange sp√ºren) stellte sich heraus, dass OpenCV sehr gut mit dem Videostream zusammenarbeitet und alle Funktionen bietet, die ich ben√∂tige (Pixel z√§hlen, Frames anzeigen und Text). </p><br><p>  Das √ñffnen einer Videodatei und das Empfangen eines Frames kann beispielsweise in zwei Zeilen beschrieben werden: </p><br><pre><code class="python hljs">vidcap = cv2.VideoCapture(<span class="hljs-string"><span class="hljs-string">'test.mp4'</span></span>) success,image = vidcap.read()</code> </pre> <br><p>  Und wenn Sie m√∂chten, k√∂nnen Sie sofort Rahmen auf die Schraube werfen: </p><br><pre> <code class="python hljs">cv2.imwrite(<span class="hljs-string"><span class="hljs-string">"/tmp/frame%d.jpg"</span></span> % frame, image)</code> </pre> <br><p>  Nach einiger Zeit schrieb ich eine Funktion, um die Positionen der Tasten der virtuellen Tastatur zu generieren und sie (in Form von Rechtecken) √ºber dem Stream-Bild anzuzeigen und das Bild hochzuladen. Es stellte sich Folgendes heraus: <br><img src="https://github.com/svsdval/video2midi/raw/master/docs/frame47.jpg?raw=true" alt="Bild"></p><br><p>  Nachdem ich mich f√ºr Frame f√ºr Frame entschieden habe, lese ich beim Lesen des Bildes aus dem Videostream die aktiven Notizen von der Position der virtuellen Tasten (nur Noten, deren Pixel mit der Referenzfarbe √ºbereinstimmen oder nicht weit davon entfernt sind) als aktiv und sende sie an Midi.  Ich konnte Notizen nicht einfach registrieren, als ob die Situation auf einer normalen Midi-Tastatur w√§re, es ist nur ein bisschen einfacher ... Ich habe das Video √ºberpr√ºft und gesehen, wie viele Notizen ich habe (und es gab viele davon). Ich dachte nicht schlecht, ich musste nur herausfinden, wie man Notizen in eine Datei schreibt und nach etwas sucht , fand ein tolles Python-Midiutil-Python-Paket.  Nach einiger Zeit konnte ich Noten im Midi aufnehmen.  Wie sich herausstellte, ist Python-Midiutil ein sehr einfacher und sehr benutzerfreundlicher Beutel.  Das Erstellen einer Datei und das Hinzuf√ºgen von Notizen erfolgt beispielsweise in mehreren Zeilen: </p><br><pre> <code class="python hljs">mf.addTrackName(track, time, <span class="hljs-string"><span class="hljs-string">"Sample Track"</span></span>) mf.addTempo(track, time, <span class="hljs-number"><span class="hljs-number">60</span></span> ) mf.addNote(track, channel, pitch, keytime, duration, volume) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(outputmid, <span class="hljs-string"><span class="hljs-string">'wb'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> outf: mf.writeFile(outf)</code> </pre> <br><p>  Das Herunterladen des resultierenden Midi in LMMS erwies sich als recht erfolgreich.  Zun√§chst habe ich einige meiner Lieblingslieder restauriert.  Dann wurde klar, dass die Funktion zum Generieren von Schl√ºsselpositionen von Rolle zu Rolle nicht sehr praktisch war, ihre Position √§nderte sich, ich entschied mich f√ºr eine grafische Benutzeroberfl√§che, ich machte eine einfache, aber mit einer Tastenplatzierungsfunktion </p><br><p><img src="https://github.com/svsdval/video2midi/raw/master/docs/mainwindow.png?raw=true" alt="Bild"></p><br><p>  Ich denke, dass dieses Programm f√ºr viele n√ºtzlich sein kann, weil ich alles auf dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> gepostet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">habe</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de450710/">https://habr.com/ru/post/de450710/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de450698/index.html">Zahnr√§der in Box2D</a></li>
<li><a href="../de450700/index.html">Wieder √ºber l√∂chrige Abstraktionen (oder √ºber eine unvorhersehbare Umgebung)</a></li>
<li><a href="../de450702/index.html">Der Ort ist verdammt?</a></li>
<li><a href="../de450704/index.html">Sicherheitswoche 19: Sicherheitsl√ºcken in IP-Kameras, GPS-Trackern und drahtlosen Monitoren</a></li>
<li><a href="../de450708/index.html">Python in Visual Studio Code - Ver√∂ffentlichung im April 2019</a></li>
<li><a href="../de450712/index.html">DotNetRu bei DotNext 2019 Piter</a></li>
<li><a href="../de450716/index.html">Ank√ºndigung von Windows Vision-F√§higkeiten (Vorschau)</a></li>
<li><a href="../de450718/index.html">Was ist neu in RxJS v6.5?</a></li>
<li><a href="../de450720/index.html">So entwickeln Sie eine benutzerfreundliche Anwendung</a></li>
<li><a href="../de450724/index.html">Einf√ºhrung von Python f√ºr Kameraden, die der ‚ÄûA vs. V-Sprache‚Äú entwachsen sind Sprache B "und andere Vorurteile</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>