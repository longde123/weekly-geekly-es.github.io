<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üé∞ üë®üèº‚Äçüéì üìß VPN para dispositivos m√≥veis no n√≠vel da rede üëô üëª üßôüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ainda h√° surpreendentemente pouco material no Runet sobre um sistema antigo e simples, mas conveniente, seguro e especialmente relevante em rela√ß√£o ao...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VPN para dispositivos m√≥veis no n√≠vel da rede</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444946/">  Ainda h√° surpreendentemente pouco material no Runet sobre um sistema antigo e simples, mas conveniente, seguro e especialmente relevante em rela√ß√£o ao desenvolvimento da Internet de coisas como tecnologias como VPN m√≥vel (rede privada virtual).  Neste artigo, descreverei como e por que voc√™ pode configurar o acesso √† sua rede privada para qualquer dispositivo com um cart√£o SIM, sem a necessidade de configurar um software especializado. <br><img src="https://habrastorage.org/webt/vn/it/qi/vnitqitwtv8qnzwhufihgww6h0g.png"><br><a name="habracut"></a><br><h2>  Tarefas e limita√ß√µes </h2><br>  Para come√ßar, responderei √† pergunta "por qu√™?".  A VPN como tecnologia √© usada para resolver uma variedade de problemas de rede, unidos por um recurso comum - a transfer√™ncia isolada de dados entre dois dispositivos por meio de um grande n√∫mero de n√≥s intermedi√°rios.  Com base nisso, solu√ß√µes mais complexas j√° est√£o sendo criadas e as tarefas muito diferentes est√£o sendo resolvidas.  No caso usual e comum a todos, uma rede de operadora de linha fixa √© usada para criar uma VPN (existe um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√≥timo material para</a> quem deseja) ou muitos protocolos de rede diferentes (GRE, IPSec, L2TP e outros - o mesmo autor <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sobre isso</a> ) e os produtos de software que trabalham com eles (Cisco AnyConnect, OpenVPN, TOR - bem, voc√™ mesmo sabe), mas seu uso em um dispositivo terminal espec√≠fico apresenta imediatamente uma s√©rie de requisitos, cuja falha leva a certas restri√ß√µes. <br><br>  A primeira limita√ß√£o s√©ria √© que o dispositivo deve poder trabalhar com pelo menos um desses protocolos nos n√≠veis de hardware e software.  Isso geralmente √© determinado por um software f√°cil de encontrar para um laptop ou smartphone, mas h√° casos em que a tarefa √© confrontada com um dispositivo muito simples do ponto de vista de hardware ou seu software tem limita√ß√µes: o hidr√¥metro deseja usar uma VPN para transmitir seu infeliz byte de leituras uma vez por m√™s, n√£o menos do que voc√™ deseja usar uma VPN para editar seu perfil do LinkedIn. <br><br>  Outra limita√ß√£o importante √© a necessidade de personaliza√ß√£o.  Ele funciona tanto para dispositivos "est√∫pidos" do primeiro par√°grafo quanto para smartphones e computadores cl√°ssicos para os quais a restri√ß√£o anterior √© desconhecida.  E se com o primeiro tudo √© relativamente simples e depende da quantidade de tempo gasto na instala√ß√£o, ent√£o com o √∫ltimo h√° op√ß√µes.  Muitas vezes, as organiza√ß√µes usam VPNs para fins de seguran√ßa para proteger o dispositivo terminal de servi√ßo de acessar a rede p√∫blica sem a prote√ß√£o corporativa adequada ou de transferir dados de servi√ßo por canais p√∫blicos.  Os usu√°rios finais, no entanto, podem, por algum motivo, desconectar ou esquecer de habilitar a VPN, como resultado dos quais muitos dos sistemas de seguran√ßa da empresa podem ficar para tr√°s. <br><br>  Ambas as restri√ß√µes podem ser facilmente removidas se o acesso √† VPN for fornecido no n√≠vel da rede.  No caso de comunica√ß√µes m√≥veis, isso pode ser implementado usando a "VPN m√≥vel".  Um dispositivo de qualquer complexidade capaz de transmitir dados o transmitir√° para a rede correta.  N√£o importa quais configura√ß√µes s√£o feitas no dispositivo, se a rede estiver configurada corretamente, ela ser√° transferida de qualquer maneira para onde voc√™ quiser e em nenhum outro lugar. <br><br>  E como um b√¥nus agrad√°vel, o dispositivo receber√° um endere√ßo da rede interna, configurado remotamente, e o acesso a ele ser√° poss√≠vel apenas dentro desta rede (ou fisicamente).  Para uma determinada classe de dispositivos, isso √© muito importante. <br><br><h2>  Como isso funciona </h2><br><h3>  PS Core </h3><br>  Parece que a VPN √© um servi√ßo cl√°ssico de todas as operadoras de telecomunica√ß√µes para o segmento B2B, e por que, ent√£o, focar nisso?  O problema √© como a rede de dados √© organizada para dispositivos conectados via GPRS, HSPA, LTE ou outra tecnologia de comunica√ß√£o m√≥vel.  N√£o h√° vlan familiar para todos os administradores de rede, n√£o h√° comutadores, nem roteadores no seu significado usual.  Mas h√° uma rede de acesso via r√°dio (RAN) e um n√∫cleo de pacotes (PS Core). <br><br><img src="https://habrastorage.org/webt/_d/yn/mx/_dynmxtvymlk1yu5fwschjzwlsa.png"><br>  <i>Um diagrama simplificado de uma rede de pacotes de uma operadora m√≥vel.</i>  <i>√â um pouco diferente para LTE, mas o significado geral permanece o mesmo.</i> <br><br>  No caso geral, cada dispositivo com um cart√£o SIM registrado na rede de pacotes (que passou no procedimento de conex√£o GPRS ou similar), antes de come√ßar a transferir dados em algum lugar, deve iniciar a cria√ß√£o de uma sess√£o de transfer√™ncia de dados (contexto PDP) no roteador principal da rede de pacotes, GGSN .  Os detalhes e o objetivo desses processos est√£o muito bem descritos aqui <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">neste artigo</a> .  O que √© importante para n√≥s: ao iniciar uma sess√£o, a solicita√ß√£o ao GGSN, entre outros, inclui par√¢metros que muitos viram em seus telefones ou at√© mesmo lidaram com eles ao configurar, por exemplo, modems USB.  Estes s√£o tr√™s campos: APN, login e senha.  O APN (ponto de acesso) √© uma entidade muito importante na l√≥gica do GGSN: dependendo de qual APN a sess√£o √© iniciada, o GGSN age de maneiras diferentes.  Como resultado do processamento bem-sucedido de uma solicita√ß√£o do usu√°rio, o GGSN deve ativar uma sess√£o de transfer√™ncia de dados e informar o dispositivo de seus par√¢metros, em particular, o endere√ßo IP e os endere√ßos DNS fornecidos ao dispositivo.  Existem v√°rios recursos muito importantes: <br><br><ul><li>  Em uma solicita√ß√£o para iniciar uma sess√£o, o dispositivo nunca pergunta qual endere√ßo IP gostaria de receber; </li><li>  Al√©m dos campos "APN", "login" e "senha" definidos nas configura√ß√µes do dispositivo, a solicita√ß√£o ao GGSN tamb√©m transfere o n√∫mero de telefone (MSISDN) do assinante (a seguir "assinante" √© o usu√°rio final, um dispositivo com um cart√£o SIM e ‚ÄúCliente‚Äù - a organiza√ß√£o-cliente do servi√ßo, que inclui assinantes); </li><li>  Quando uma sess√£o √© ativada, o GGSN cria um registro do novo endere√ßo IP em sua tabela de roteamento.  Todos os assinantes no GGSN s√£o indicados por entradas na tabela de roteamento com o prefixo / 32, ou seja,  1 assinante - 1 entrada na tabela.  GGSN √© um roteador muito produtivo; </li><li>  A rede de uma operadora pode, em diferentes est√°gios (tanto no SGSN quanto no GGSN), por v√°rios motivos, alterar o campo APN em uma solicita√ß√£o para iniciar uma sess√£o.  Isso permite, em alguns casos, reduzir e, em alguns casos, excluir completamente as configura√ß√µes de rede em dispositivos com um cart√£o SIM. </li></ul><br>  Nos tr√™s primeiros pontos, surge imediatamente a pergunta: que tipo de endere√ßo IP √© emitido para o assinante? <br>  Isso √© determinado pelas configura√ß√µes do APN com o qual a solicita√ß√£o para ativar a sess√£o veio.  Cerca de 99% dos usu√°rios de dados m√≥veis usam acesso regular √† Internet.  Estes s√£o internet.mts.ru, internet.beeline.ru e assim por diante, pontos de acesso conhecidos.  No caso do acesso √† Internet, o GGSN emite endere√ßos de acordo com o princ√≠pio cl√°ssico do DHCP nas sub-redes cinza especificadas nas configura√ß√µes.  Ao acessar a rede p√∫blica, eles s√£o fechados pelo NAT cl√°ssico (ou melhor, por sua vers√£o, que √© PAT). <br><br>  Mas o GGSN √© capaz de mais.  Para selecionar um endere√ßo IP, ele pode fazer uma solicita√ß√£o AAA ao servidor de autoriza√ß√£o (Radius, por exemplo).  Essa l√≥gica √© configurada para APNs individuais, dependendo de sua finalidade.  O caso mais simples √© o servi√ßo de fornecer um endere√ßo IP p√∫blico permanente.  Esses endere√ßos, em regra, s√£o atribu√≠dos aos assinantes no faturamento do operador (BSS) e, dependendo da arquitetura de TI, eles acabam em um banco de dados espec√≠fico, que √© acessado pela solicita√ß√£o GGSN.  Devido ao fato de ele conhecer o MSISDN (n√∫mero de telefone) do assinante, que estar√° contido na solicita√ß√£o, esse banco de dados ser√° bastante simples e poder√° conter apenas v√°rios n√∫meros e endere√ßos.  Al√©m disso, se o cliente planeja usar um cart√£o SIM para conectar v√°rios dispositivos (se o cart√£o SIM estiver no roteador WiFi do escrit√≥rio remoto, por exemplo), esta tabela tamb√©m poder√° conter a chamada "rota emoldurada" - o prefixo da rede localizado " para ‚Äùum cart√£o SIM, que ser√° anunciado a todos os dispositivos da rede usando protocolos de roteamento din√¢mico. <br><br><h3>  Nem um √∫nico GGSN </h3><br>  Al√©m de emitir endere√ßos, tamb√©m √© necess√°rio fornecer tr√°fego de assinante para redes de clientes, cada uma por conta pr√≥pria.  Aqui tudo funciona muito mais tradicionalmente.  No GGSN, o tr√°fego especializado para trabalhar com o VPN APN √© roteado para um roteador separado da rede da operadora (pode ser chamado de maneira diferente, √†s vezes √© um roteador VPN), que, por sua vez, executa a fun√ß√£o de um PE cl√°ssico no esquema L3VPN.  Ele adiciona os r√≥tulos, cabe√ßalhos e isso √© tudo e envia todo esse fluxo de tr√°fego atrav√©s dos roteadores da rede de transporte para as articula√ß√µes ou t√∫neis pr√©-configurados para a rede do cliente.  Esta parte j√° √© muito mais tradicional e muitas vezes descrita em outros lugares, por isso n√£o vou me concentrar nela neste material. <br><br>  Dado todos esses detalhes, pode haver v√°rias maneiras de organizar uma VPN m√≥vel e elas diferem entre si por uma combina√ß√£o dos seguintes recursos: <br><br><ul><li>  Os endere√ßos IP, como j√° descrito, podem ser emitidos dinamicamente (sempre que um endere√ßo diferente de uma determinada sub-rede) e estaticamente (sempre que o mesmo endere√ßo para um assinante espec√≠fico), que √© determinado pelas configura√ß√µes de / ou APN e / ou do servidor Radius ; </li><li>  Os endere√ßos IP podem ser emitidos por um servidor Radius sob controle do operador ou sob controle do cliente; </li><li>  Os dispositivos conectados a uma VPN m√≥vel podem interagir apenas entre si ou ter acesso a uma rede cliente L3VPN normal por meio de uma interface direta (porta VPN) com um operador ou atrav√©s de t√∫nel na Internet; </li><li>  Em alguns casos, pode ser necess√°rio usar um nome de usu√°rio e senha para ativar com √™xito uma sess√£o e, √†s vezes, nem √© necess√°rio preencher o campo "APN". </li></ul><br>  Existem v√°rias dezenas dessas combina√ß√µes com diferentes tipos de encapsulamento, equilibrando o tr√°fego entre os canais de acesso ao cliente VPN ‚Äúprincipal‚Äù e o princ√≠pio de emiss√£o de endere√ßos.  Na maioria dos casos, o esquema geral √© o seguinte: <br><br><img src="https://habrastorage.org/webt/47/ez/7d/47ez7dugxs7whtjaghvrapuihcs.png"><br><br>  Como resultado, ap√≥s um processo bastante r√°pido de registro na rede e obten√ß√£o de um endere√ßo IP, o dispositivo obt√©m acesso √† rede do cliente e a rede do cliente obt√©m acesso ao dispositivo.  Ao mesmo tempo, o assinante √© isolado de todos os outros assinantes do operador que n√£o est√£o relacionados a um cliente espec√≠fico, ele n√£o precisa de configura√ß√µes adicionais e todo o tr√°fego √© enviado para a rede do cliente sem alternativa, onde √© processado de acordo com as pol√≠ticas internas do cliente. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt444946/">https://habr.com/ru/post/pt444946/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt444936/index.html">Firmware ZXHN H118N da Dom.ru sem solda e programador</a></li>
<li><a href="../pt444938/index.html">Servi√ßos √∫teis e n√£o muito p√∫blicos</a></li>
<li><a href="../pt444940/index.html">Dicas e truques do Digital Forensics: como conectar uma imagem de encase √† m√°quina virtual</a></li>
<li><a href="../pt444942/index.html">Quando visitei a lend√°ria Escola 42: ‚Äúpiscina‚Äù, gatos e a Internet em vez de professores</a></li>
<li><a href="../pt444944/index.html">Enquanto eu visitava a lend√°ria Escola 42: "piscina", gatos e Internet em vez de professores. Parte 2</a></li>
<li><a href="../pt444950/index.html">Termux passo a passo (Parte 1)</a></li>
<li><a href="../pt444954/index.html">Revis√£o dos sistemas abertos de gerenciamento de v√≠deo</a></li>
<li><a href="../pt444956/index.html">Para trabalhar em uma bicicleta. Outra opini√£o</a></li>
<li><a href="../pt444958/index.html">Compre um dispositivo eletr√¥nico e obtenha os dados de gra√ßa: as informa√ß√µes pessoais permanecem nos gadgets doados</a></li>
<li><a href="../pt444960/index.html">Ligue para o espa√ßo profundo: como a NASA acelera a comunica√ß√£o interplanet√°ria</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>