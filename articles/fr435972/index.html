<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêÉ ü•õ üß† Pr√©sentation de la programmation r√©active au printemps üßìüèª ü•Ç üê≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour, Habr! 

 Cette semaine, nous attendons un nouveau livre Spring 5 de l'imprimerie: 


 Parmi les fonctionnalit√©s int√©ressantes de Spring 5, la...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pr√©sentation de la programmation r√©active au printemps</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/piter/blog/435972/">  Bonjour, Habr! <br><br>  Cette semaine, nous attendons un nouveau <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">livre</a> Spring 5 de l'imprimerie: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ap/o3/tt/apo3ttu5x8fqhvkjyzyrj8g3m2s.jpeg"></div><br>  Parmi les fonctionnalit√©s int√©ressantes de Spring 5, la programmation r√©active m√©rite une mention sp√©ciale, dont la mise en ≈ìuvre dans ce cadre est bri√®vement d√©crite par l'article propos√© par Matt Raible.  Dans le livre susmentionn√©, les mod√®les r√©actifs sont examin√©s au chapitre 11. <br><br>  Matt a √©t√© co-√©crit par Josh Long, auteur d'un autre grand livre sur Java et Spring, " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Java in the Cloud</a> ", sorti l'√©t√© dernier. <br><a name="habracut"></a><br>  La programmation r√©active est votre fa√ßon de construire des syst√®mes r√©sistants aux charges √©lev√©es.  Le traitement d'un trafic important n'est plus un probl√®me, car le serveur n'est pas bloquant et les processus clients n'ont pas √† attendre les r√©ponses.  Le client ne peut pas observer directement comment le programme s'ex√©cute sur le serveur et se synchroniser avec lui.  Lorsque l'API a du mal √† traiter les demandes, elle doit quand m√™me donner des r√©ponses raisonnables.  Ne doit pas refuser et rejeter les messages de mani√®re incontr√¥l√©e.  Il doit informer les composants sup√©rieurs qu'il fonctionne sous charge afin qu'ils puissent le lib√©rer partiellement de cette charge.  Cette technique est appel√©e contre-pression, un aspect important de la programmation r√©active. <br><br>  Nous avons co-√©crit cet article avec <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Josh Long</a> .  Josh est un champion Java, Spring Developer Advocate, et g√©n√©ralement un gars mondial travaillant chez Pivotal.  Je travaille avec Spring depuis longtemps, mais c'est Josh qui m'a montr√© le Spring Boot, c'√©tait lors de la conf√©rence Devoxx en Belgique.  Depuis, nous sommes devenus de bons amis, nous aimons Java et √©crivons des applications sympas. <br><br>  <b>Programmation r√©active ou E / S, E / S, on se met au travail ...</b> <br><br>  La programmation r√©active est une approche de cr√©ation de logiciels qui utilise activement les E / S asynchrones.  Les E / S asynchrones sont une petite id√©e, charg√©e de grands changements dans la programmation.  L'id√©e elle-m√™me est simple: corriger la situation avec l'allocation inefficace des ressources, lib√©rer les ressources qui auraient √©t√© inactives sans notre intervention, attendre la fin des E / S.  L'entr√©e / sortie asynchrone inverse l'approche habituelle du traitement des E / S: le client est lib√©r√© et peut effectuer d'autres t√¢ches en attendant de nouvelles notifications. <br><br>  Consid√©rez ce qui est commun entre les entr√©es / sorties synchrones et asynchrones, et quelles sont les diff√©rences entre elles. <br><br>  Nous allons √©crire un programme simple qui lit les donn√©es de la source (en particulier, nous parlons du lien <code>java.io.File</code> ).  Commen√ßons par une impl√©mentation qui utilise le bon vieux <code>java.io.InputStream</code> : <br><br>  <i>Exemple 1. Lecture synchrone de donn√©es d'un fichier</i> <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example.io; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lombok.extern.log4j.Log4j2; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.util.FileCopyUtils; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileInputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.function.Consumer; <span class="hljs-meta"><span class="hljs-meta">@Log</span></span>4j2 <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Synchronous</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Reader</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File file, Consumer&lt;BytesPayload&gt; consumer)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> (FileInputStream in = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(file)) { <span class="hljs-comment"><span class="hljs-comment">//1 byte[] data = new byte[FileCopyUtils.BUFFER_SIZE]; int res; while ((res = in.read(data, 0, data.length)) != -1) { //2 consumer.accept(BytesPayload.from(data, res)); //3 } } } }</span></span></code> </pre> <br><ol><li>  Nous fournissons un fichier √† lire avec le fichier <code>java.io.File</code> habituel </li><li>  Tirez les r√©sultats de la source une ligne √† la fois ... </li><li>  J'ai √©crit ce code pour prendre <code>Consumer&lt;BytesPayloadgt;</code>  appel√© lorsque de nouvelles donn√©es arrivent </li></ol><br>  Assez simple, que dites-vous?  Ex√©cutez ce code et vous verrez dans la sortie du journal (√† gauche de chaque ligne), indiquant que toutes les actions se produisent dans un seul thread. <br>  Ici, nous extrayons des octets de nos donn√©es prises dans la source (dans ce cas, nous parlons d'une sous-classe de <code>java.io.FileInputStream</code> h√©rit√©e de <code>java.io.InputStream</code> ).  Quel est le probl√®me avec cet exemple?  Dans ce cas, nous utilisons un InputStream qui pointe vers des donn√©es situ√©es sur notre syst√®me de fichiers.  Si le fichier est l√† et que le disque dur fonctionne, alors ce code fonctionnera comme pr√©vu. <br><br>  Mais que se passe-t-il si nous lisons les donn√©es non pas depuis <code>File</code> , mais depuis une prise r√©seau, et utilisons une autre impl√©mentation de <code>InputStream</code> ?  Rien √† craindre!  Bien s√ªr, il n'y aura absolument rien √† craindre si la vitesse du r√©seau est infiniment √©lev√©e.  Et si le canal r√©seau entre celui-ci et l'autre n≈ìud ne tombe jamais en panne.  Si ces conditions sont remplies, le code fonctionnera parfaitement. <br><br>  Mais que se passe-t-il si le r√©seau ralentit ou s'√©tire?  Dans ce cas, je veux dire que nous allons augmenter la p√©riode jusqu'√† ce que l'op√©ration <code>in.read(‚Ä¶)</code> .  En fait, elle ne reviendra peut-√™tre pas du tout!  C'est un probl√®me si nous essayons de faire autre chose avec le flux √† partir duquel nous lisons des donn√©es.  Bien s√ªr, vous pouvez toujours cr√©er un autre flux et lire des donn√©es √† travers celui-ci.  Cela peut √™tre fait jusqu'√† un certain point, mais, √† la fin, nous atteindrons la limite √† laquelle l'ajout de threads pour une mise √† l'√©chelle suppl√©mentaire ne sera plus suffisant.  Nous n'aurons pas de v√©ritable concurrence au-del√† du nombre de c≈ìurs pr√©sents sur notre machine.  Impasse!  Dans ce cas, nous pouvons augmenter le traitement d'entr√©e / sortie (la lecture est ici signifi√©e) uniquement en raison de flux suppl√©mentaires, mais ici nous atteindrons t√¥t ou tard la limite. <br><br>  Dans cet exemple, le travail principal est la lecture - presque rien ne se passe sur les autres fronts.  Nous d√©pendons des E / S.  Consid√©rez comment une solution asynchrone nous aide √† surmonter partiellement la monopolisation de nos flux. <br><br>  <i>Exemple 2. Lecture asynchrone de donn√©es d'un fichier</i> <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example.io; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lombok.extern.log4j.Log4j2; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.springframework.util.FileCopyUtils; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.nio.ByteBuffer; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.nio.channels.AsynchronousFileChannel; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.nio.channels.CompletionHandler; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.nio.file.Path; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.nio.file.StandardOpenOption; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Collections; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.concurrent.ExecutorService; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.concurrent.Executors; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.function.Consumer; <span class="hljs-meta"><span class="hljs-meta">@Log</span></span>4j2 <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Asynchronous</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Reader</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CompletionHandler</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Integer</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ByteBuffer</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bytesRead; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> position; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AsynchronousFileChannel fileChannel; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Consumer&lt;BytesPayload&gt; consumer; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> ExecutorService executorService = Executors.newFixedThreadPool(<span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(File file, Consumer&lt;BytesPayload&gt; c)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.consumer = c; Path path = file.toPath(); <span class="hljs-comment"><span class="hljs-comment">// 1 this.fileChannel = AsynchronousFileChannel.open(path, Collections.singleton(StandardOpenOption.READ), this.executorService); //2 ByteBuffer buffer = ByteBuffer.allocate(FileCopyUtils.BUFFER_SIZE); this.fileChannel.read(buffer, position, buffer, this); //3 while (this.bytesRead &gt; 0) { this.position = this.position + this.bytesRead; this.fileChannel.read(buffer, this.position, buffer, this); } } @Override public void completed(Integer result, ByteBuffer buffer) { //4 this.bytesRead = result; if (this.bytesRead &lt; 0) return; buffer.flip(); byte[] data = new byte[buffer.limit()]; buffer.get(data); //5 consumer.accept(BytesPayload.from(data, data.length)); buffer.clear(); this.position = this.position + this.bytesRead; this.fileChannel.read(buffer, this.position, buffer, this); } @Override public void failed(Throwable exc, ByteBuffer attachment) { log.error(exc); } }</span></span></code> </pre> <br><ol><li>  Cette fois, nous adaptons <code>java.io.File</code> , faisant de <code>Java NIO java.nio.file.Path</code> partir de celui-ci </li><li>  Lors de la cr√©ation d'un <code>Channel</code> , nous <code>java.util.concurrent.ExecutorService</code> en particulier le service <code>java.util.concurrent.ExecutorService</code> , qui sera utilis√© pour appeler le gestionnaire <code>CompletionHandler</code> lorsque les donn√©es n√©cessaires apparaissent </li><li>  Nous commen√ßons la lecture en passant un lien vers <code>CompletionHandler&lt;Integer, ByteBuffer&gt; (this)</code> </li><li>  Dans le rappel, lisez les octets du <code>ByteBuffer</code> dans la capacit√© en <code>byte[]</code> </li><li>  Tout comme dans l'exemple <code>Synchronous</code> , les donn√©es d' <code>byte[]</code> sont transmises au consommateur. </li></ol><br>  Nous ferons une r√©servation tout de suite: ce code s‚Äôest av√©r√© beaucoup plus difficile!  Il y a tellement de choses qui se passent ici que votre t√™te tourne tout de suite, cependant, permettez-moi de souligner ... ce code lit les donn√©es du <code>Java NIO Channel</code> , puis traite ces donn√©es dans un thread s√©par√© responsable des rappels.  Ainsi, le flux dans lequel la lecture a commenc√© n'est pas monopolis√©.  Nous revenons presque instantan√©ment apr√®s avoir appel√© <code>.read(..)</code> , et quand, enfin, nous avons les donn√©es √† notre disposition, un rappel est effectu√© - d√©j√† dans un autre thread.  S'il y a un d√©lai entre les appels √† <code>.read()</code> vous pouvez passer √† d'autres sujets en les ex√©cutant dans notre thread.  La dur√©e d'une op√©ration de lecture asynchrone, du premier au dernier, n'est au mieux pas plus longue que celle d'une op√©ration de lecture synchrone.  Habituellement, une op√©ration asynchrone n'est pas significativement plus longue.  Cependant, face √† ces difficult√©s suppl√©mentaires, nous pouvons g√©rer plus efficacement nos flux.  Faites plus de travail, multiplexez les E / S dans un pool avec un nombre fini de threads. <br><br>  Je travaille pour une entreprise de cloud computing.  Nous aimerions que vous obteniez de nouvelles instances de l'application pour r√©soudre les probl√®mes de mise √† l'√©chelle horizontale!  Bien s√ªr, ici, je suis un peu hypocrite.  Les E / S asynchrones compliquent un peu les choses, mais j'esp√®re que cet exemple illustre √† quel point le code r√©actif est si utile: il vous permet de traiter plus de requ√™tes et de travailler plus sur votre mat√©riel existant si les performances d√©pendent fortement des E / S.  Si les performances d√©pendent de l'utilisation du processeur (disons, nous parlons d'op√©rations sur les nombres de Fibonacci, d'extraction de bitcoins ou de cryptographie), alors la programmation r√©active ne nous donnera rien. <br><br>  Actuellement, la plupart d'entre nous n'utilisons pas les impl√©mentations <code>Channel</code> ou <code>InputStream</code> dans notre travail quotidien!  Nous devons penser aux probl√®mes au niveau des abstractions de niveau sup√©rieur.  Il s'agit de choses comme les tableaux, ou plut√¥t, la hi√©rarchie <code>java.util.Collection</code> .  La collection <code>java.util.Collection</code> s'affiche tr√®s bien sur un InputStream: les deux entit√©s supposent que vous pouvez op√©rer sur toutes les donn√©es √† la fois, et presque instantan√©ment.  Il est pr√©vu que vous pourrez terminer la lecture de la plupart des <code>InputStreams</code> plus t√¥t que tard.  Les types de collections deviennent un peu inconfortables lors du passage √† de plus grandes quantit√©s de donn√©es.  Et si vous avez affaire √† quelque chose de potentiellement infini (illimit√©) - par exemple, des sockets Web ou des √©v√©nements de serveur?  Que faire en cas de retard entre les enregistrements? <br><br>  Nous avons besoin d'une meilleure fa√ßon de d√©crire ce type de donn√©es.  Nous parlons d'√©v√©nements asynchrones, tels qui se produiront √† la fin.  Il peut sembler que <code>Future&lt;T&gt;</code> ou <code>CompletableFuture&lt;T&gt;</code> sont bien adapt√©s √† cette fin, mais ils d√©crivent juste une chose qui se produit √† la fin.  En fait, Java ne fournit pas de m√©taphore appropri√©e pour d√©crire ce type de donn√©es.  Les types <code>Iterator</code> et <code>Stream</code> de Java 8 peuvent ne pas √™tre li√©s, cependant, les deux sont orient√©s vers l'extraction;  vous demandez vous-m√™me l'entr√©e suivante, et non le type devrait envoyer un rappel √† votre code.  Il est suppos√© que si le traitement par push √©tait pris en charge dans ce cas, ce qui permettrait de r√©aliser bien plus au niveau du thread, l'API fournirait √©galement un contr√¥le de threading et de planification.  <code>Iterator</code> impl√©mentations d' <code>Iterator</code> ne disent rien sur le thread, et tous les threads Java 8 partagent le m√™me pool de jointures de fourches. <br><br>  Si <code>Iterator</code> et <code>Stream</code> <code>Iterator</code> vraiment en charge le traitement push, nous rencontrerions alors un autre probl√®me qui d√©g√©n√®re pr√©cis√©ment dans le contexte des E / S: nous aurons besoin d'une sorte de m√©canisme de r√©tro-p√©n√©tration!  √âtant donn√© que le consommateur de donn√©es est trait√© de mani√®re asynchrone, nous n'avons aucune id√©e du moment o√π les donn√©es seront dans le pipeline et en quelle quantit√©.  Nous ne savons pas combien de donn√©es devront √™tre trait√©es lors du prochain rappel: un octet ou un t√©raoctet! <br><br>  En tirant des donn√©es d'un <code>InputStream</code> , vous lisez autant d'informations que vous √™tes pr√™t √† les traiter, et pas plus.  Dans les exemples pr√©c√©dents, nous lisons les donn√©es dans le tampon d' <code>byte[]</code> d'une longueur fixe et connue.  Dans un contexte asynchrone, nous avons besoin d'un moyen de dire au fournisseur la quantit√© de donn√©es que nous sommes pr√™ts √† traiter. <br>  Oui, monsieur.  Il manque certainement quelque chose ici. <br><br>  <b>Rechercher la m√©taphore manquante</b> <br><br>  Dans ce cas, nous recherchons une m√©taphore qui refl√®te magnifiquement l'essence des E / S asynchrones, prend en charge un tel m√©canisme pour le transfert inverse des donn√©es et nous permet de contr√¥ler le flux d'ex√©cution dans les syst√®mes distribu√©s.  Dans la programmation r√©active, la capacit√© d'un client √† signaler quelle charge il est capable de g√©rer est appel√©e ¬´flux inverse¬ª. <br><br>  Il existe maintenant un certain nombre de bons projets - Vert.x, Akka Streams et RxJava - prenant en charge la programmation r√©active.  L'√©quipe Spring g√®re √©galement un projet appel√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Reactor</a> .  Entre ces diff√©rentes normes, il existe un champ g√©n√©ral assez large, attribu√© de facto √† la norme de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">initiative Reactive Streams</a> .  L'initiative Reactive Streams d√©finit quatre types: <br><br>  Interface de l' <code>Publisher&lt;T&amp;gt</code> ;  produit des valeurs qui peuvent finalement arriver.  Interface de l' <code>Publisher&lt;T&amp;gt</code> ;  produit des valeurs de type <code>T</code> pour l' <code>Subscriber&lt;T&gt;</code> . <br><br>  <i>Exemple 3. Flux r√©actifs: interface <code>Publisher&lt;T&gt;</code></i> . <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> org.reactivestreams; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Publisher</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">subscribe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Subscriber&lt;? </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">super</span></span></span></span><span class="hljs-function"><span class="hljs-params"> Tgt; s)</span></span></span></span>; }</code> </pre> <br>  Le type <code>Subscriber</code> s'abonne √† <code>Publisher&lt;T&gt;</code> , recevant des notifications de toute nouvelle valeur de type <code>T</code> via sa <code>onNext(T)</code> .  Si des erreurs se produisent, sa <code>onError(Throwable)</code> est <code>onError(Throwable)</code> .  Lorsque le traitement s'est termin√© normalement, la m√©thode <code>onComplete</code> l'abonn√© est appel√©e. <br><br>  <i>Exemple 4. Jet streams: interface <code>Subscriber&lt;T&gt;</code> .</i> <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> org.reactivestreams; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Subscriber</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSubscribe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Subscription s)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onNext</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T t)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onError</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Throwable t)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onComplete</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre><br>  Lorsque l' <code>Subscriber</code> connecte pour la premi√®re fois √† <code>Publisher</code> , il re√ßoit un <code>Subscription</code> dans la <code>Subscriber#onSubscribe</code> .  Abonnement L' <code>Subscription</code> est peut-√™tre la partie la plus importante de toute la sp√©cification;  c'est elle qui assure le retour.  Un abonn√© abonn√© utilise la m√©thode de demande d' <code>Subscription#request</code> pour demander des donn√©es suppl√©mentaires ou la m√©thode d' <code>Subscription#cancel</code> pour arr√™ter le traitement. <br><br>  <i>Exemple 5. Flux r√©actifs: interface d' <code>Subscription&lt;T&gt;</code></i> . <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> org.reactivestreams; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Subscription</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">request</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> n)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cancel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; }</code> </pre> <br>  La sp√©cification de flux r√©actif fournit un autre type utile, bien qu'√©vident,: le <code>Processor&lt;A,B&gt;</code> n'est qu'une interface qui h√©rite √† la fois de l' <code>Subscriber&lt;A&gt;</code> et de l' <code>Publisher&lt;B&gt;</code> . <br><br>  <i>Exemple 6. Jet streams: <code>Processor&lt;T&gt;</code></i> . <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> org.reactivestreams; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Processor</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">T</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">R</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Subscriber</span></span></span><span class="hljs-class">&amp;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ltT</span></span></span><span class="hljs-class">&gt;, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Publisher</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">R</span></span></span><span class="hljs-class">&gt; </span></span>{ }</code> </pre> <br>  Une sp√©cification n'est pas positionn√©e comme une prescription pour les impl√©mentations; en fait, son objectif est de d√©finir des types pour prendre en charge l'interop√©rabilit√©.  L'avantage √©vident des types associ√©s aux flux r√©actifs est qu'ils ont n√©anmoins trouv√© une place dans la version Java 9, d'ailleurs, s√©mantiquement ils sont ¬´one to one¬ª correspondent aux interfaces de la classe <code>java.util.concurrent.Flow</code> , par exemple: <code>java.util.concurrent.Flow.Publisher</code> . <br><br>  <b>Rencontrez Reactor</b> <br><br>  Les types de flux r√©actifs ne suffisent pas √† eux seuls;  des impl√©mentations d'ordre sup√©rieur sont n√©cessaires pour prendre en charge des op√©rations telles que le filtrage et la transformation.  En tant que tel, le projet Reactor est pratique;  il s'appuie sur la sp√©cification Reactive Streams et propose deux sp√©cialisations <code>Publisher&lt;T&gt;</code> . <br><br>  Tout d'abord, <code>Flux&lt;T&gt;</code> est un <code>Publisher</code> qui produit z√©ro ou plusieurs valeurs.  Le second, <code>Mono&lt;T&gt;</code> , est <code>Publisher&lt;T&gt;</code> , produisant z√©ro ou une valeur.  Tous deux publient des valeurs et peuvent les g√©rer en cons√©quence, cependant, leurs capacit√©s sont beaucoup plus √©tendues que la sp√©cification Reactive Streams.  Les deux fournissent des op√©rateurs qui vous permettent de traiter des flux de valeur.  Les types de r√©acteurs se composent bien - la sortie de l'un d'eux peut servir d'entr√©e pour l'autre, et si le type doit fonctionner avec d'autres flux de donn√©es, ils s'appuient sur des instances <code>Publisher&lt;T&gt;</code> . <br><br>  <code>Mono&lt;T&gt;</code> et <code>Flux&lt;T&gt;</code> impl√©mentent <code>Publisher&lt;T&gt;</code> ;  nous recommandons que vos m√©thodes acceptent les instances <code>Publisher&lt;T&gt;</code> mais retournent <code>Flux&lt;T&gt;</code> ou <code>Mono&lt;T&gt;</code> ;  cela aidera le client √† distinguer le type de donn√©es qu'il re√ßoit. <br><br>  Supposons qu'on vous ait donn√© <code>Publisher&lt;T&gt;</code> et qu'on vous ait demand√© d'afficher l'interface utilisateur de cet <code>Publisher&lt;T&gt;</code> .  Dois-je ensuite afficher une page avec les d√©tails d'un enregistrement, car vous pouvez obtenir <code>CompletableFuture&lt;T&gt;</code> ?  Ou afficher une page de pr√©sentation avec une liste ou une grille o√π toutes les entr√©es sont affich√©es page par page?  C'est difficile √† dire. <br><br>  √Ä leur tour, <code>Flux&lt;T&gt;</code> et <code>Mono&lt;T&gt;</code> tr√®s sp√©cifiques.  Vous savez que vous devez afficher une page de r√©vision si <code>Flux&lt;T&gt;</code> re√ßu, et une page avec des d√©tails pour un (ou pas un seul) enregistrement lorsque vous recevez <code>Mono&lt;T&gt;</code> . <br><br>  Reactor est un projet open source lanc√© par Pivotal;  Maintenant, il est devenu tr√®s populaire.  Facebook l'utilise dans son <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">moteur √†</a> r√©action <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">pour appeler des proc√©dures √† distance</a> , et l'utilise √©galement dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Rsocket</a> , dirig√© par Ben Christensen, le cr√©ateur de RxJava.  Salesforce l'utilise dans son <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">impl√©mentation gRPC r√©active</a> .  Reactor impl√©mente les types Reactive Streams, afin qu'il puisse interagir avec d'autres technologies qui prennent en charge ces types, par exemple, avec <a href="">RxJava 2</a> de Netflix, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Akka Streams</a> de Lightbend et avec le projet <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Vert.x</a> de la Fondation Eclipse.  David Cairnock, directeur de RxJava 2, a √©galement collabor√© activement avec Pivotal pour d√©velopper Reactor, am√©liorant encore le projet.  De plus, bien s√ªr, il est pr√©sent sous une forme ou une autre dans Spring Framework, √† commencer par Spring Framework 4.0. <br><br>  <b>Programmation r√©active avec Spring WebFlux</b> <br><br>  Malgr√© toute son utilit√©, Reactor n'est que la base.  Nos applications doivent communiquer avec des sources de donn√©es.  Doit prendre en charge l'authentification et l'autorisation.  Le printemps fournit tout cela.  Si Reactor nous donne la m√©taphore manquante, alors Spring nous aide tous √† parler un langage commun. <br><br>  Spring Framework 5.0 a √©t√© publi√© en septembre 2017. Il s'appuie sur Reactor et la sp√©cification Reactive Streams.  Il dispose d'un nouveau mod√®le d'ex√©cution r√©actif et de composants appel√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Spring WebFlux</a> . <br><br>  Spring WebFlux est ind√©pendant de l'API Servlet et ne n√©cessite pas leur fonctionnement.  Il est livr√© avec des adaptateurs qui vous permettent de l'utiliser au-dessus du moteur Servlet si n√©cessaire, mais ce n'est pas n√©cessaire.  Il fournit √©galement un tout nouveau runtime bas√© sur Netty appel√© Spring WebFlux.  Spring Framework 5, fonctionnant avec Java 8 et Java EE 7 et versions ult√©rieures, sert d√©sormais de base √† une grande partie de l'√©cosyst√®me Spring, notamment Spring Data Kay, Spring Security 5, Spring Boot 2 et Spring Cloud Finchley. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr435972/">https://habr.com/ru/post/fr435972/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr435960/index.html">Exp√©rience de pens√©e: Flutter on Go</a></li>
<li><a href="../fr435962/index.html">25e anniversaire d'Aeron: sensations et impressions de la version mise √† jour d'Aeron Remastered</a></li>
<li><a href="../fr435964/index.html">Ethereum pr√©voit d'√™tre 99% plus √©conomique</a></li>
<li><a href="../fr435968/index.html">Pr√©sentation des algorithmes de Deep Machine Learning pour les robots</a></li>
<li><a href="../fr435970/index.html">Guide du d√©butant pour le d√©veloppement de serveurs Web avec Node.js</a></li>
<li><a href="../fr435974/index.html">Three.js - faire des contr√¥les pour l'espace ou le plan√©tarium</a></li>
<li><a href="../fr435976/index.html">WebAssembly en production et le ¬´champ de mines¬ª de la Smart TV: un entretien avec Andrei Nagikh</a></li>
<li><a href="../fr435978/index.html">Solutions de contournement de la protection biom√©trique</a></li>
<li><a href="../fr435984/index.html">R√©seaux de neurones et philosophie du langage</a></li>
<li><a href="../fr435986/index.html">Windows r√©servera 7 Go pour les mises √† jour du syst√®me afin d'√©viter de manquer d'espace sur le disque dur</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>