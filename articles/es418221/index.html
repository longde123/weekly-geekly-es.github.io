<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üà≥ üöµüèæ üöÉ Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 6: "Oportunidades", parte 3 üëÑ ‚ùî üé´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Instituto de Tecnolog√≠a de Massachusetts. Conferencia Curso # 6.858. "Seguridad de los sistemas inform√°ticos". Nikolai Zeldovich, James Mickens. A√±o 2...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 6: "Oportunidades", parte 3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/418221/"><h3>  Instituto de Tecnolog√≠a de Massachusetts.  Conferencia Curso # 6.858.  "Seguridad de los sistemas inform√°ticos".  Nikolai Zeldovich, James Mickens.  A√±o 2014 </h3><br>  Computer Systems Security es un curso sobre el desarrollo e implementaci√≥n de sistemas inform√°ticos seguros.  Las conferencias cubren modelos de amenazas, ataques que comprometen la seguridad y t√©cnicas de seguridad basadas en trabajos cient√≠ficos recientes.  Los temas incluyen seguridad del sistema operativo (SO), caracter√≠sticas, gesti√≥n del flujo de informaci√≥n, seguridad del idioma, protocolos de red, seguridad de hardware y seguridad de aplicaciones web. <br><br>  Lecci√≥n 1: "Introducci√≥n: modelos de amenaza" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lecci√≥n 2: "Control de ataques de hackers" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lecci√≥n 3: ‚ÄúDesbordamientos del b√∫fer: exploits y protecci√≥n‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lecci√≥n 4: ‚ÄúSeparaci√≥n de privilegios‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <br>  Lecci√≥n 5: ‚Äú¬øDe d√≥nde vienen los sistemas de seguridad?‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> <br>  Lecci√≥n 6: ‚ÄúOportunidades‚Äù <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 1</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 2</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Parte 3</a> <a name="habracut"></a><br><br>  <b>P√∫blico:</b> si este <b>UID</b> proporciona acceso de solo lectura a este archivo, y tambi√©n tiene un descriptor de archivo, entonces, si pierde el <b>UID</b> , ¬øpuede obtener permiso para leer este archivo? <br><br>  <b>Profesor:</b> s√≠, ya que aparecer√° en los cat√°logos.  Porque tan pronto como agregue la funci√≥n al archivo, eso es todo.  Est√° abierto para usted con privilegios especiales, etc.  Pero el problema es que tienen este dise√±o h√≠brido. <br><br>  Es decir, dicen: realmente puede agregar caracter√≠sticas a los directorios y puede abrir un nuevo archivo, mientras trabaja en paralelo.  Puede ser que agregue la funci√≥n a un directorio, como <b>/ etc</b> , pero no tiene acceso obligatorio a todos los archivos en el directorio <b>/ etc.</b>  Pero tan pronto como ingrese al modo de funciones, puede intentar abrir estos archivos, sabiendo que tiene acceso al directorio <b>/ etc.</b>  Despu√©s de todo, ya est√° abierto, as√≠ que ¬øpor qu√© no me das un archivo llamado <b>"contrase√±a"</b> ubicado en este directorio? <br><br><img src="https://habrastorage.org/webt/8y/ew/2d/8yew2dwzcw7lpgl31ttm1ayzj6g.jpeg"><br><br>  Y luego, el n√∫cleo debe decidir si le permite abrir el archivo en este directorio en modo de lectura o escritura, o lo que tiene.  As√≠ que creo que este es el √∫nico lugar donde todav√≠a necesita este privilegio externo, porque intentaron crear un dise√±o compatible, donde utilizaron una sem√°ntica no demasiado natural para describir el funcionamiento de los directorios.  Este parece ser el √∫nico lugar donde permanecen los principios para configurar un <b>sistema de</b> archivos <b>Unix</b> . <br><br>  <b>P√∫blico:</b> ¬øhay otros lugares similares? <br><br>  <b>Profesor:</b> buena pregunta.  Creo que tendr√© que obtener su c√≥digo fuente anterior para averiguar qu√© est√° sucediendo, pero la mayor√≠a de las otras situaciones realmente no requieren verificaci√≥n de <b>UID</b> .  Porque, por ejemplo, no se usa para redes.  Estas son probablemente las operaciones habituales del sistema de archivos: si tiene un segmento de memoria compartida, simplemente √°bralo y listo. <br><br>  <b>P√∫blico:</b> ¬øpodr√≠a explicar nuevamente cu√°l es exactamente la ID de usuario, si tiene la funci√≥n de <b>capacidad</b> ? <br><br>  <b>Profesor:</b> esto es importante cuando tienes la oportunidad de catalogar.  La pregunta es, ¬øqu√© le presenta esta oportunidad?  Considere una interpretaci√≥n, por ejemplo, el estado de las capacidades de un sistema limpio, no <b>Capsicum</b> .  Si en dicho sistema tiene la oportunidad de un directorio, entonces tiene acceso incondicional a todos los archivos en este directorio. <br><br>  En <b>Unix,</b> este no suele ser el caso.  Puede abrir el directorio como <b>/ etc</b> , pero tiene muchos archivos del sistema en los que se puede almacenar informaci√≥n confidencial, por ejemplo, la clave privada del servidor.  Y el hecho de que pueda abrir y desplazarse por este directorio no significa que no pueda abrir archivos en este directorio.  Es decir, al tener acceso al directorio, tiene acceso a los archivos. <br><br>  En <b>Capsicum</b> , si abre el directorio <b>/ etc</b> y luego ingresa al modo de funci√≥n, sucede lo siguiente.  Usted dice: ‚ÄúNo s√© qu√© es este directorio.  Solo le agrego un descriptor de archivo ".  Hay un archivo llamado "clave".  ¬øPor qu√© no abres este archivo <b>"clave"</b> ?  Solo porque en ese momento, probablemente no desee que este proceso basado en caracter√≠sticas abra este archivo, porque no lo necesita.  Aunque esto le permite omitir <b>los</b> permisos de <b>Unix</b> para el archivo. <br><br>  Por lo tanto, creo que los autores de este art√≠culo abordaron cuidadosamente el desarrollo de un sistema que no violar√≠a los mecanismos de seguridad existentes. <br><br>  <b>P√∫blico:</b> es decir, ¬ødice que en algunos casos puede usar una combinaci√≥n de estos dos factores de seguridad?  Es decir, aunque el usuario puede cambiar el archivo en el directorio, ¬øa qu√© archivos accede depende de su ID de usuario? <br><br>  <b>Profesor:</b> s√≠, exactamente.  En la pr√°ctica, en <b>Capsicum</b> , antes de pasar al modo de funciones, debe adivinar qu√© archivos puede necesitar m√°s adelante.  Es posible que necesite bibliotecas compartidas, archivos de texto, plantillas, conexiones de red, etc.  Por lo tanto, abres todo esto por adelantado.  Y no siempre es necesario saber qu√© archivo necesita.  Entonces, estos tipos lo hicieron para que simplemente pueda abrir el descriptor de archivo del directorio y ver los archivos que necesita m√°s adelante.  Sin embargo, puede ser que estos archivos no tengan los mismos permisos que usted tiene.  Es precisamente por esta raz√≥n que se utiliza una combinaci√≥n de dos factores de seguridad: verificar las capacidades y el usuario <b>uid</b> .  Entonces esto es parte del mecanismo del n√∫cleo. <br><br><img src="https://habrastorage.org/webt/xk/zu/ea/xkzueav2oq8qjqezg3f7hrzvemc.jpeg"><br><br>  ¬øPor qu√© necesitan una biblioteca como <b>libcapsicum</b> ?  Creo que hay dos cosas principales que admiten en esta biblioteca. <br><br>  Una de ellas es que implementan una funci√≥n llamada <b>lch_start</b> , que debe usar en lugar de la funci√≥n <b>cap_enter</b> .  Otra funci√≥n que proporciona <b>libcapsicum</b> es el concepto de listas fd, que se utiliza para pasar descriptores de archivo por n√∫meros.  El prop√≥sito de esta <b>lista de archivos es</b> f√°cil de explicar.  Esto es b√°sicamente una generalizaci√≥n de c√≥mo <b>Unix</b> administra y pasa descriptores de archivo entre procesos.  En <b>Unix</b> y <b>Linux</b> tradicionales, que usa hoy, se le pasan algunos descriptores de archivos cuando comienza el proceso.  Simplemente abra algunos descriptores de archivo con valores enteros de esta tabla e inicie el proceso secundario que necesita.  O ejecuta un binario espec√≠fico y hereda todos estos espacios abiertos en la tabla <b>fd</b> .  Sin embargo, no hay otra buena manera de nombrar estas cosas que usar n√∫meros como nombres. <br><br>  Considere un ejemplo en el que la ranura 0 se utilizar√° para la entrada, la ranura 1 para la salida, la ranura 2 para imprimir mensajes de error.  As√≠ es como funciona en <b>Unix</b> .  Y funciona bien si solo transfiere estos tres archivos o tres flujos de datos al proceso. <br><br><img src="https://habrastorage.org/webt/bn/kq/yt/bnkqytvftq_0clyfqaqlqmwlfbs.jpeg"><br><br>  Pero en <b>Capsicum,</b> sucede que "revisas" muchos m√°s descriptores de archivos en tu camino.  Entonces, cuando pasa un descriptor de archivo para algunos archivos, pasa por un descriptor de archivo para una conexi√≥n de red, un descriptor para una biblioteca compartida que tiene, y as√≠ sucesivamente.  Gestionar todos estos n√∫meros es bastante tedioso.  Por lo tanto, de hecho, <b>libcapsicum</b> proporciona la capacidad de abstraer del nombre de estos descriptores de archivos pasados ‚Äã‚Äãentre procesos usando un nombre jer√°rquico que se usa en lugar de estos enteros oscuros. <br>  Esta es una de las cosas simples que proporcionan en su biblioteca.  Entonces puedo pasar el descriptor de archivo al proceso y darle un nombre, no importa qu√© n√∫mero se indique.  Este m√©todo es mucho m√°s simple. <br><br>  Todav√≠a tienen otro mecanismo de lanzamiento de caja de arena m√°s complejo.  Esta es <b>lch</b> , la <b>API de</b> host de sandbox que se usa en lugar de simplemente ingresar al modo de caracter√≠sticas de <b>Capability</b> .  ¬øPor qu√© necesitaban algo m√°s que una simple entrada en un modo de oportunidad?  ¬øQu√© es lo que generalmente te molesta al crear un sandbox? <br><br>  <b>P√∫blico:</b> probablemente, <b>lch</b> borra todas las cosas heredadas para garantizar un inicio "limpio" del sistema. <br><br>  <b>Profesor:</b> si.  Creo que les preocupa tratar de tener en cuenta todo a lo que tiene acceso el sandbox.  La <b>cuesti√≥n</b> es que, si solo llama a <b>cap_enter</b> , t√©cnicamente, al nivel del mecanismo del n√∫cleo, funcionar√°.  Derecho?  Simplemente evita que descubras nuevas oportunidades. <br><br>  Pero el problema es que puede haber muchas cosas existentes a las que el proceso ya tiene acceso. <br><br>  Por lo tanto, creo que el ejemplo m√°s simple es la presencia de descriptores de archivos abiertos que olvid√≥, y este proceso simplemente los heredar√°. <br><br><img src="https://habrastorage.org/webt/td/yv/dd/tdyvddlujfmx8gudizztmw9n5gm.jpeg"><br><br>  Por ejemplo, consideraron <b>tcpdump</b> .  Primero, cambiaron <b>tcpdump</b> simplemente llamando a <b>cap_enter</b> incluso antes de que estuvieran a punto de analizar todas las conexiones de red entrantes.  En cierto modo, esto funciona bien porque no puede obtener m√°s funciones de <b>capacidad</b> .  Pero luego, mirando el descriptor de archivo abierto, se dieron cuenta de que tiene acceso completo al terminal de usuario, porque tiene un descriptor de archivo abierto para √©l.  Para que pueda interceptar todas las pulsaciones de teclas que realiza el usuario, y similares.  Por lo tanto, este probablemente no sea un buen plan para <b>tcpdump</b> .  Porque no quieres que alguien intercepte tu actividad de teclado. <br><br>  Por lo tanto, en el caso de <b>tcpdump,</b> cambiaron manualmente los descriptores de archivo y agregaron algunos bits de caracter√≠sticas para limitar los tipos de operaciones que puede realizar.  Si recuerda, en <b>Capsicum, la</b> funci√≥n tambi√©n tiene estos bits adicionales que indican la clase de operaciones que se pueden realizar para un descriptor de archivo dado.  Por lo tanto, b√°sicamente suponen que el descriptor de archivo es 0. Apunta al <b>terminal de</b> usuario tty.  Inicialmente, era solo un puntero directo a la estructura <b>tty</b> en el n√∫cleo.  Para limitar el tipo de operaciones que se pueden realizar para este descriptor, introdujeron una estructura beta intermedia de capacidades en el medio.  Por lo tanto, el descriptor de archivo apunta a esta estructura de capacidad, y ya apunta al archivo real al que est√° intentando acceder.  Y esta estructura de capacidad contiene algunos bits o permisos restrictivos para un objeto descriptor de archivo que se puede implementar. <br><br>  Por lo tanto, con la entrada de datos est√°ndar en <b>tcpdump,</b> no puede hacer nada con ella.  Puedes ver que existe, y eso es todo.  Para el descriptor del archivo de salida, proporcionaron una oportunidad cuando puede escribir algo en √©l, pero no puede cambiar el registro, es decir, no puede cancelar los cambios realizados. <br><br><img src="https://habrastorage.org/webt/cg/-4/p5/cg-4p5ivw8r8yde-rotszxgxn2a.jpeg"><br><br>  Entonces, ¬øqu√© m√°s podr√≠a preocuparse por lanzar <b>el sandbox</b> ?  Pienso en el estado del descriptor de archivo.  ¬øAlgo m√°s importa?  Creo que en <b>Unix</b> estos son descriptores de archivos y memoria. <br><br>  Otra cosa es que estos tipos est√°n preocupados de que en su espacio de direcciones pueda haber datos confidenciales asignados anteriormente.  Y el proceso que va a aislar en el sandbox puede leer toda la memoria disponible.  Entonces, si hay alg√∫n tipo de contrase√±a que verific√≥ anteriormente, cuando el usuario inicia sesi√≥n y a√∫n no ha borrado la memoria, entonces este proceso podr√° leerla y hacer algo "interesante". <br><br>  <b>Resolvieron</b> este problema de esta manera: en <b>lch_start</b> tienes que ejecutar un programa "nuevo".  Usted toma el programa y empaqueta todos los argumentos en √©l, todos los descriptores de archivo que desea proporcionarle.  Luego inicia un nuevo proceso o inicia la operaci√≥n de reinicializaci√≥n de todo el espacio de memoria virtual.  Y luego no hay duda de que este proceso no recibir√° ning√∫n privilegio adicional para afectar el conjunto de datos confidenciales.  Esto es exactamente lo que pas√≥ a la funci√≥n <b>lch_start</b> , en t√©rminos de nombres binarios, argumentos y capacidades del programa. <br><br>  <b>Audiencia:</b> ¬øqu√© sucede si el proceso que inicia contiene <b>setuid</b> binario <b>= 0</b> ? <br><br>  <b>Profesor:</b> Creo que estos tipos no usan "binarios" <b>setuid</b> en el modo de funci√≥n para evitar algunas interacciones extra√±as que puedan aparecer.  Implementan esta regla: puede tener un programa <b>setuid</b> que obtenga sus privilegios del binario <b>setuid</b> , y luego puede llamar a <b>cap_enter</b> o <b>lch_start</b> .  Pero una vez que ingresa al modo de funciones, no puede restaurar preferencias adicionales. <br><br>  En principio, esto podr√≠a funcionar, pero ser√≠a muy extra√±o.  Porque, si recuerdas, lo √∫nico en lo que importa el <b>UID</b> cuando est√°s en modo de funci√≥n es abrir archivos dentro de un directorio.  Por lo tanto, no est√° claro si este es realmente un gran plan para privilegios adicionales o si tiene fallas. <br><br>  <b>P√∫blico:</b> Anteriormente, hablamos sobre por qu√© la biblioteca no admite realmente una separaci√≥n estricta entre los dos factores de seguridad.  Pero no tenemos que usar <b>lch_start</b> ? <br><br>  <b>Profesor:</b> eso es correcto.  Suponga que tiene algo como <b>tcpdump</b> , o <b>gzip</b> : esta es otra cosa con la que trabajan.  Asume que la aplicaci√≥n probablemente no est√° comprometida, y que hay alguna funci√≥n b√°sica de la aplicaci√≥n, y le importa c√≥mo se comporta en el entorno limitado.  En el caso de <b>tcpdump, se</b> trata de un an√°lisis de paquetes que provienen de la red, en el caso de <b>gzip</b> se trata de descomprimir archivos.  Y hasta cierto punto, asumes que el proceso est√° haciendo todo bien y que no habr√° vulnerabilidades.  Por lo tanto, conf√≠a en √©l para ejecutar <b>lch_start</b> y cree que crear√° correctamente la imagen, configurar√° correctamente todas las funciones y luego se limitar√° a s√≠ mismo de cualquier otra llamada al sistema fuera del modo de capacidades. <br><br>  Y luego lanzas cosas peligrosas.  Pero para entonces la instalaci√≥n era correcta y no tienes forma de salir de este entorno limitado.  Por lo tanto, creo que necesita ver c√≥mo puede usar el modo de funci√≥n para las aplicaciones de sandbox. <br><br>  As√≠ que hablamos un poco sobre <b>tcpdump</b> .  ¬øC√≥mo aislar este proceso?  Otro ejemplo interesante es el programa <b>gzip</b> , que comprime y descomprime archivos.  Entonces, ¬øpor qu√© est√°n preocupados por la caja de arena?  Creo que les preocupa que el c√≥digo de descompresi√≥n pueda tener errores, o que pueda haber errores en la administraci√≥n de la memoria, la administraci√≥n del b√∫fer durante la descompresi√≥n, etc. <br><br><img src="https://habrastorage.org/webt/rg/0p/fj/rg0pfjhm0nsvzqfxtmemlhvwoq8.jpeg"><br><br>  Otra pregunta interesante es ¬øpor qu√© los cambios para <b>gzip</b> parecen mucho m√°s complicados que para <b>tcpdump</b> ?  Creo que esto se debe a c√≥mo la aplicaci√≥n est√° estructurada internamente, ¬øverdad?  Por lo tanto, si tiene una aplicaci√≥n que simplemente comprimi√≥ un archivo o descomprimi√≥ un archivo, entonces es normal simplemente iniciarlo sin cambiarlo en el modo de funciones.  Simplemente le da un nuevo est√°ndar para desempacar algo, y el est√°ndar proporciona datos desempaquetados en la salida, y esto funcionar√° bien. <br><br>  El problema, como casi siempre ocurre con tales m√©todos de sandbox, es que la aplicaci√≥n en realidad tiene una l√≥gica de proceso mucho m√°s compleja.  Por ejemplo, <b>gzip</b> puede comprimir varios archivos a la vez, y as√≠ sucesivamente.  Y en este caso, tiene alg√∫n tipo de proceso l√≠der al frente de la aplicaci√≥n, que en realidad tiene derechos adicionales para abrir varios archivos, empaquetarlos, etc.  Y la l√≥gica central a menudo necesita ser otro proceso de apoyo.  En el caso de <b>gzip, la</b> aplicaci√≥n no estaba estructurada de modo que la compresi√≥n y la descompresi√≥n actuaran como procesos separados.  Por lo tanto, tuvieron que cambiar la implementaci√≥n del kernel <b>gzip</b> y alguna estructura de la aplicaci√≥n en s√≠ misma para que, adem√°s de pasar los datos a la funci√≥n de descompresi√≥n, se enviaran a trav√©s de una llamada <b>RPC</b> o realmente se escribieran en alg√∫n tipo de descriptor de casi archivo.  Esto fue para evitar que ocurran problemas de terceros y desempaquetar pr√°cticamente sin privilegios.  Lo √∫nico que <b>gzip</b> pod√≠a hacer al mismo tiempo era devolver los datos descomprimidos o comprimidos al proceso que lo llam√≥. <br><br>  Otra tarea es c√≥mo usar <b>Capsicum</b> en <b>OKWS</b> .  ¬øQu√© opinas de esto?  ¬øSer√≠a √∫til?  ¬ø <b>Los</b> chicos de <b>OKWS estar√≠an</b> felices de actualizar a <b>FreeBSD</b> porque es mucho m√°s f√°cil de usar?  ¬øC√≥mo <b>usar√≠as Capsicum</b> en <b>FreeBSD</b> ? <br><br>  <b>P√∫blico: se</b> podr√≠an eliminar algunas restricciones estrictas. <br><br>  <b>Profesor:</b> s√≠, lo podr√≠amos reemplazar por completo con la presencia de un directorio de descriptores de archivos y capacidades.  No necesitar√≠a configurar un <b>chroot</b> confuso.  En lugar de usar <b>chroot</b> con muchas cosas peque√±as, puedes establecer los permisos con cuidado.  Simplemente puede abrir los archivos exactos que necesita.  As√≠ que esto parece una gran ventaja. <br><br>  A continuaci√≥n, en <b>OKWS</b> , tiene el servicio de inicio <b>OK</b> , que debe iniciar todos los procesos principales.  Tan pronto como mueren, la se√±al regresa a <b>okld</b> para reiniciar el proceso "muerto".  Y esto tendr√≠a que ejecutar <b>root</b> , porque ten√≠a que aislar los procesos en el sandbox.  Pero hay varias cosas en <b>OKWS</b> que podr√≠an mejorarse con <b>Capsicum</b> . <br><br>  Por ejemplo, podr√≠a proporcionar <b>okld con</b> muchos menos privilegios.  Porque, por ejemplo, para obtener el puerto 80, necesita privilegios de root.  Pero despu√©s de eso, puede poner todo lo dem√°s de forma segura en el entorno limitado, porque los derechos de root ya no son necesarios.  Entonces es genial.  Quiz√°s incluso pueda delegar al proceso el derecho de responder a las solicitudes de otra persona, por ejemplo, un proceso de monitoreo del sistema que solo tiene este descriptor de proceso o descriptor de proceso para el proceso secundario y cada vez que dicho proceso falla, comienza uno nuevo.  Por lo tanto, creo que la capacidad de crear un sandbox sin privilegios de root es muy √∫til. <br><br>  <b>P√∫blico:</b> puede proporcionar a cada proceso un descriptor de archivo que le permita agregar solo entradas al registro. <br><br>  <b>Profesor:</b> s√≠, y eso es genial.  Como dijimos la √∫ltima vez, <b>oklogd</b> puede "estropear" el archivo de registro.  Y qui√©n sabe qu√© le permitir√° hacer el n√∫cleo cuando tenga el descriptor del archivo de registro.  Sin embargo, podemos determinar con mayor precisi√≥n las capacidades del descriptor de archivo d√°ndole un archivo de registro e indicando que solo puede escribir pero no buscar nada.  ,    append-only,     ¬´¬ª   .   .       ,    ,         <b>Unix</b> . <br><br>         <b>Capsicum</b> ? <br><br> <b>:</b>  , ,   ,        .     ,       ,  ,       . <br><br> : ,  .   <b>Capsicum</b> ,   ,      .           . <br><br> <b>:</b> ,     ,  okld      .      ,    . <br><br> <b>:</b>  ,      .   .     ,    ,   <b>Capability</b>      ,       .   ,     ,   ,   , ,        . <br>   ,         <b>OKWS</b> .               . , ,        ,    .    . <br><br> ,      ,   ¬´¬ª.     ,       .  ,  ,         ,    ,       .        . <br> :    ¬´¬ª   ,      ,   ? <br><br> : ,   <b>FreeBSD</b>   .   ,     -   ,     .  <b>FreeBSD</b>     <b>Casper</b> ,    ,   <b>Capability</b> .            ,   ¬´¬ª. <br><br>      - ,    ,  ,  - ,        ,  <b>Casper</b>    . <br><br><img src="https://habrastorage.org/webt/pj/hd/aw/pjhdaw8gumxqioaoawbwert89ks.jpeg"><br><br>      ,    ¬´¬ª     .   . ,     ,     ,   <b>Casper</b>     - . <br><br>   ,         ,       -  .    ,   <b>Unix</b>         <b>FD</b> .      ,      .  ,        ,    . <br><br>  ,       <b>FreeBSD</b> ,      <b>DNS</b> .       <b>DNS</b> -,   ¬´¬ª.    ,    <b>tcpdump</b> .    tcpdump   ,        IP-.   ,   ,     <b>DNS</b> -. <br><br>  , ,     DNS-      DNS-,    .    <b>Casper</b> ,      DNS-. <br><br>  ,     ,   ,     Capsicum?    ?       ?       ,   ,    .         <b>Capsicum</b> ,    ? <br><br>     tcpdump  <b>GZIP</b> ,  ,   .            ? <br><br><img src="https://habrastorage.org/webt/yn/u5/ov/ynu5ovmtuqxeqgmma5p7hnhhwrg.jpeg"><br><br> <b>:</b> ,    ,   ,  . ,      <b>Capability</b> . <br><br> <b>:</b> ,  .      <b>Capsicum</b>  ,    ,    .  ,    ,        .  ,   ,   ,    ,    <b>Capsicum</b> ,   . <br><br>     ,          ¬´¬ª. ,  <b>TCP ‚Äî helper</b> , ,  , ,    .    ,  ,  ,    . <br><br> <b>:</b>  ,             . <br><br> <b>:</b> , .        . ,          .    <b>lth_start</b> ,      .  ,   ,      ,     - . <br><br>  ,   ,  Capsicum        .    ,       ,   ,             .    Unix    -    ,      . <br><br>          ,     . ,               .  ,          ,    .   ,    . <br><br> ,   Chrome      .  ,     ,       ,        Unix,  -,     <b>Unix</b> . <br><br> ,      ? <br><br> <b>:</b>            . <br><br> <b>:</b> .       .    ,    .      ,       , ,                 ,     . <br><br>     <b>Unix</b>     ,      .  ,        .    ,              .        .      ,     . <br><br>     .  <b>Linux</b>  ,  <b>setcall</b> ,     ,    .  ,    <b>Capsicum</b> ,        ,  <b>Capsicum</b>     ,     .   <b>Linux</b>  <b>setcall</b>     ,   .    ,   ,      <b>Linux</b> . <br><br> ,    ‚Äî    , ,      ,     ,        .   ,      -  ,     ¬´//¬ª,       .        <b>Capsicum</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> donde puede iniciar el proceso para un archivo espec√≠fico y no para todo el directorio de inicio. </font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/MlWK2YbZRZ8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La versi√≥n completa del curso est√° disponible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  Gracias por quedarte con nosotros.  ¬øTe gustan nuestros art√≠culos?  ¬øQuieres ver m√°s materiales interesantes?  <b>Ap√≥yenos</b> haciendo un pedido o recomend√°ndolo a sus amigos, un <b>descuento del 30% para los usuarios de Habr en un an√°logo √∫nico de servidores de nivel de entrada que inventamos para usted:</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">toda la verdad sobre VPS (KVM) E5-2650 v4 (6 n√∫cleos) 10GB DDR4 240GB SSD 1Gbps de $ 20 o c√≥mo dividir el servidor?</a>  (las opciones est√°n disponibles con RAID1 y RAID10, hasta 24 n√∫cleos y hasta 40GB DDR4). <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 meses gratis</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> al pagar un nuevo Dell R630 por un per√≠odo de seis meses - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 x Intel Deca-Core Xeon E5-2630 v4 / 128GB DDR4 / 4x1TB HDD o 2x240GB SSD / 1Gbps 10 TB - desde $ 99.33 al mes</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , solo hasta fines de agosto, ordene es posible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqu√≠</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br>  <b>Dell R730xd 2 veces m√°s barato?</b>  ¬°Solo tenemos <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">2 x Intel Dodeca-Core Xeon E5-2650v4 128GB DDR4 6x480GB SSD 1Gbps 100 TV desde $ 249</a> en los Pa√≠ses Bajos y los Estados Unidos!</b>  Lea sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">C√≥mo construir un edificio de infraestructura.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">clase utilizando servidores Dell R730xd E5-2650 v4 que cuestan 9,000 euros por un centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es418221/">https://habr.com/ru/post/es418221/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es418211/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 4: "Compartir privilegios", Parte 3</a></li>
<li><a href="../es418213/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 5: "De d√≥nde vienen los sistemas de seguridad", parte 1</a></li>
<li><a href="../es418215/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 5: "De d√≥nde vienen los errores del sistema de seguridad", Parte 2</a></li>
<li><a href="../es418217/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 6: "Oportunidades", parte 1</a></li>
<li><a href="../es418219/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 6: Oportunidades, Parte 2</a></li>
<li><a href="../es418223/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 7: El sandbox del cliente nativo, parte 1</a></li>
<li><a href="../es418225/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 7: Sandbox de Native Client Parte 2</a></li>
<li><a href="../es418227/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 7: El sandbox del cliente nativo, parte 3</a></li>
<li><a href="../es418229/index.html">Curso MIT "Seguridad de sistemas inform√°ticos". Lecci√≥n 8: Modelo de seguridad de red, parte 1</a></li>
<li><a href="../es418233/index.html">BMW mnemotecnia para encontrar valores l√≠mite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>