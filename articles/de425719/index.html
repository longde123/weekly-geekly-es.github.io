<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏻 🔊 💅🏼 Sellerie in geschäftigen Projekten: ein wenig Übung 👩 👆🏿 ♂️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Am Vorabend unseres Moscow Python Conf ++ sprachen wir kurz mit Oleg Churkin, einem Techniker des Fintech-Startups, über seine umfangreichen Erfahrung...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sellerie in geschäftigen Projekten: ein wenig Übung</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/425719/"> Am Vorabend unseres Moscow Python Conf ++ sprachen wir kurz mit Oleg Churkin, einem Techniker des Fintech-Startups, über seine umfangreichen Erfahrungen mit Sellerie: eine halbe Million Hintergrundaufgaben, Fehler und Tests. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9e7/04b/f65/9e704bf65f55a3ee6007034fc9a38540.jpg"><br><a name="habracut"></a><br>  <b>- Erzählen Sie mir ein paar Details zu dem Projekt, an dem Sie gerade arbeiten?</b> <br><br>  Im Moment bin ich an einem Fintech-Startup <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">namens Statusmoney beteiligt</a> , das Finanzdaten von Benutzern analysiert und es Kunden ermöglicht, ihre Einnahmen und Ausgaben mit anderen Personengruppen zu vergleichen, Ausgabenlimits festzulegen und zu beobachten, wie der Wohlstand in den Charts wächst oder fällt.  Bisher konzentriert sich das Projekt nur auf den nordamerikanischen Markt. <br><br>  Um Finanzinformationen zu analysieren, laden wir alle Benutzertransaktionen herunter, speichern sie und integrieren sie in Kreditbüros, um zusätzliche Daten zur Bonitätshistorie zu erhalten. <br><br>  Jetzt haben wir ungefähr 200.000 Benutzer und 1,5 Terabyte verschiedener Finanzdaten von unseren Lieferanten.  Über eine Million Transaktionen <br><br>  <b>- Was ist der technologische Stack?</b> <br><br>  Der Stack des aktuellen Projekts ist Python 3.6, Django / Celery und Amazon Web Services.  Wir verwenden RDS und Aurora aktiv zum Speichern relationaler Daten, ElasticCache für den Cache und für Nachrichtenwarteschlangen, CloudWatch, Prometheus und Grafana für die Alarmierung und Überwachung.  Nun und natürlich S3 für die Dateispeicherung. <br><br>  Wir setzen Sellerie auch sehr aktiv für verschiedene Geschäftsaufgaben ein: Versenden von Benachrichtigungen und Massenversand von Briefen, Massenaktualisierung verschiedener Daten von externen Diensten, asynchrone API und dergleichen. <br><br>  Am Frontend haben wir React, Redux und TypeScript. <br><br>  <b>- Was ist die Hauptnatur der Lasten in Ihrem Projekt und wie gehen Sie damit um?</b> <b><br></b>  <b>kommst du zurecht</b> <br><br>  Die Hauptlast des Projekts liegt in den Hintergrundaufgaben, die Sellerie ausführt.  Jeden Tag starten wir ungefähr eine halbe Million verschiedene Aufgaben, zum Beispiel die Aktualisierung und Verarbeitung (ETL) von Finanzdaten von Benutzern verschiedener Banken, Kreditbüros und Investmentinstitutionen.  Zusätzlich senden wir viele Benachrichtigungen und berechnen viele Parameter für jeden Benutzer. <br><br>  Wir haben auch eine asynchrone API implementiert, die die Ergebnisse von externen Quellen „pulsiert“ und auch viele Aufgaben generiert. <br><br>  Im Moment, nachdem wir die Infrastruktur und den Sellerie optimiert haben, können wir problemlos damit umgehen, aber bevor es passiert ist, werde ich Ihnen dies in meinem Bericht mitteilen. <br><br>  <b>- Wie skalieren Sie alles und sorgen für Fehlertoleranz?</b> <br><br>  Für die Skalierung verwenden wir Auto Scaling Groups, eine Toolbox, die von unserer AWS Cloud-Plattform bereitgestellt wird.  Django und Sellerie lassen sich horizontal gut skalieren. Wir setzen die Grenzwerte für die maximale Speichermenge, die von uWSGI / Sellerie-Mitarbeitern verwendet wird, nur ein wenig. <br><br>  <b>- Und womit überwachen?</b> <br><br>  Um die CPU- / Speichernutzung und die Verfügbarkeit der Systeme selbst zu überwachen, verwenden wir Cloud Watch in AWS, aggregieren verschiedene Metriken aus der Anwendung und von Sellerie-Mitarbeitern mithilfe von Prometheus, erstellen Diagramme und senden Warnungen an Grafana.  Für einige Daten in Grafana verwenden wir ELK als Quelle. <br><br>  <b>- Sie haben die asynchrone API erwähnt.</b>  <b>Erzählen Sie etwas mehr darüber, wie Sie es haben.</b> <b><br></b>  <b>arrangiert.</b> <br><br>  Unsere Benutzer haben die Möglichkeit, ihr Bankkonto (oder ein anderes Finanzkonto) zu "verknüpfen" und uns Zugriff auf alle ihre Transaktionen zu gewähren.  Wir zeigen den Prozess des „Verknüpfens“ und dynamischen Verarbeitens von Transaktionen auf der Site an. Dazu verwenden wir die übliche Zusammenfassung der aktuellen Ergebnisse aus dem Backend. Das Backend nimmt Daten auf und startet die ETL-Pipeline mit mehreren sich wiederholenden Aufgaben. <br><br>  <b>- Sellerie ist ein umstrittenes Produkt.</b>  <b>Wie lebst du mit ihm?</b> <br><br>  Meiner Meinung nach befindet sich unsere Beziehung zu Sellerie jetzt in der Phase „Akzeptanz“. Wir haben herausgefunden, wie das Framework im Inneren funktioniert, Einstellungen für uns selbst vorgenommen, die Bereitstellung sortiert, die Überwachung „überlagert“ und mehrere Bibliotheken geschrieben, um Routineaufgaben zu automatisieren.  Einige Funktionen reichten uns nicht "out of the box", und wir haben sie selbst hinzugefügt.  Leider hatte Sellerie zum Zeitpunkt der Auswahl des Technologie-Stacks für das Projekt nicht viele Konkurrenten, und wenn wir einfachere Lösungen verwenden würden, müssten wir viel mehr hinzufügen. <br><br>  In der vierten Version von Sellerie sind wir noch nie auf Fehler gestoßen.  Die meisten Probleme waren entweder auf unser Unverständnis darüber zurückzuführen, wie dies alles funktioniert, oder auf Faktoren von Drittanbietern. <br><br>  Ich werde in meiner Präsentation über einige Bibliotheken sprechen, die in unserem Projekt geschrieben wurden. <br><br>  <b>- Meine Lieblingsfrage.</b>  <b>Wie testest du all diese Musik?</b> <br><br>  Sellerie-Aufgaben werden durch Funktionstests gut getestet.  Wir testen die Integration mit Hilfe von automatischen Tests und manuellen Tests an QS-Ständen und Staging.  Im Moment haben wir noch einige Probleme beim Testen von regelmäßigen Aufgaben nicht gelöst: Wie lassen Sie Tester sie ausführen und wie überprüfen Sie, ob der Zeitplan für diese Aufgaben korrekt ist (die Anforderungen erfüllt)? <br><br>  <b>- Und die Tests für Frontend und Layout?</b>  <b>Wie ist das Verhältnis von manuell zu</b> <b><br></b>  <b>automatisiertes Testen?</b> <br><br>  Im Vordergrund verwenden wir Jest und schreiben nur Unit-Tests für die Geschäftslogik.  55% unserer geschäftskritischen Fälle werden derzeit durch Selenium-Selbsttests abgedeckt. Derzeit haben wir etwa 600 Tests in TestRail und 3.000 Tests im Backend. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/59f/40f/ad7/59f40fad7b54ad4abeb212461b6653a7.jpg"><br><br>  <b>- Worum geht es in Ihrem Bericht über Moscow Python Conf ++?</b> <br><br>  Im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bericht</a> werde ich Ihnen detailliert erläutern, welche Aufgaben und wie Sie Sellerie verwenden können, und es mit bestehenden Wettbewerbern vergleichen.  Ich werde beschreiben, wie Sie beim Entwerfen eines komplexen Systems mit einer großen Anzahl von Aufgaben verschiedene Rechen vermeiden können: Welche Einstellungen sollten sofort festgelegt werden und welche können später beibehalten werden, wie eine neue Version des Codes bereitgestellt wird, um beim Wechseln des Datenverkehrs keine Aufgaben zu verlieren. Ich werde schriftliche Bibliotheken für Überwachungsaufgaben freigeben und platzt. <br><br>  Ich werde auch auf das Thema der Implementierung von ETL-Pipelines auf Sellerie eingehen und beantworten, wie diese schön beschrieben werden können, welche Wiederholungsrichtlinie verwendet werden soll und wie die Anzahl der unter Bedingungen begrenzter Ressourcen ausgeführten Aufgaben genau begrenzt werden kann.  Außerdem beschreibe ich, mit welchen Tools wir die Stapelverarbeitung von Aufgaben implementieren, wodurch der verfügbare Speicher wirtschaftlich verbraucht wird. <br><br>  Wenn Sie sich nach Details für alle oben genannten Punkte sehnen, kommen Sie im Allgemeinen.  Ich hoffe, Sie finden meinen Bericht nützlich und interessant. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de425719/">https://habr.com/ru/post/de425719/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de425709/index.html">Wir haben ein Memo für die Chinesen gemacht, die zu Ihnen gekommen sind</a></li>
<li><a href="../de425711/index.html">Nicht übereinstimmender Leitungsverlust</a></li>
<li><a href="../de425713/index.html">Integration der HTML-Engine in native Windows-Anwendungen - Auswahl und Architektur</a></li>
<li><a href="../de425715/index.html">Bildungsprogramm in Chemie: Säurewechselung von Mikroschaltungen (wie man einen Kristall einer Mikroschaltung für die anschließende Fotografie freilegt)</a></li>
<li><a href="../de425717/index.html">Neuronales Netzwerk für C ++ - Entwickler</a></li>
<li><a href="../de425723/index.html">Facebook entwickelt aktiv einen Dienst, um Arbeit zu finden und Mitarbeiter in einem sozialen Netzwerk einzustellen</a></li>
<li><a href="../de425725/index.html">Nintendo Patents Case - Game Boy</a></li>
<li><a href="../de425727/index.html">Bis zum nächsten Mal</a></li>
<li><a href="../de425729/index.html">Hackathon Pro Willkommen: Wie war der erste Charity SmartMail Hack?</a></li>
<li><a href="../de425731/index.html">Geheimnisse des unmöglichen GPU-Computing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>