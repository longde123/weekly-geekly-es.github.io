<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧐 🧑🏿‍🤝‍🧑🏽 🍍 俄罗斯邮政数据中心的新IT基础架构 👩🏿‍✈️ 🚣🏿 🦐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我敢肯定，所有哈勃（Habr）的读者至少一次在国外的在线商店订购了商品，然后又去了俄罗斯邮局收货。 您能从物流组织的角度想象这项任务的规模吗？ 将客户数量乘以购买数量，想象一下我们这个广阔国家的地图，上面有4万多个邮局...顺便说一下，俄罗斯邮政在2018年处理了3.45亿个国际包裹。 

 在本文...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>俄罗斯邮政数据中心的新IT基础架构</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/484090/"> 我敢肯定，所有哈勃（Habr）的读者至少一次在国外的在线商店订购了商品，然后又去了俄罗斯邮局收货。 您能从物流组织的角度想象这项任务的规模吗？ 将客户数量乘以购买数量，想象一下我们这个广阔国家的地图，上面有4万多个邮局...顺便说一下，俄罗斯邮政在2018年处理了3.45亿个国际包裹。 <br><br> 在本文中，我们将告诉您Mail面临的问题以及LANIT集成团队如何解决它们，从而为数据中心创建了一个新的IT基础结构。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/243/aa0/cd2/243aa0cd2d1d9e1286ab8290ba80f7a9.jpg"></div>  <i>俄罗斯邮政的现代物流中心之一</i> <br><a name="habracut"></a><br><h2> 项目前 </h2><br> 由于来自中国，西欧和北美的海外商店的包裹数量急剧增加，俄罗斯邮政物流设施的负担增加了。 因此，建立了使用大容量分拣机的新一代物流中心。 他们需要计算基础架构的支持。 <br><br> 数据中心基础架构已过时，并且无法在企业信息系统的运行中提供必要的性能和可靠性。 此外，《俄罗斯邮政》也缺乏启动新服务的计算能力。 <br><br><h2> 客户数据中心及其问题 </h2><br> 俄罗斯邮政数据中心为40,000多个对象和85个地区部门提供服务。 数据中心有数十种全天候的业务服务，包括电子商务服务。 <br><br> 今天，该公司已使用用于存储，分析和处理大数据的系统。 对于此类系统，人工智能和机器学习算法的使用起着重要作用。 如今，对于公司而言，最重要的案例之一是优化物流流程的管理并加快邮局的客户服务。 <br><br> 在现代化项目开始之前，主数据中心和备份数据中心中大约有3,000个虚拟机，存储的信息量超过2 PB。 数据中心具有复杂的流量路由结构，根据安全级别将其分为不同的段。 <br><br> 随着应用的发展和新服务的引入，数据中心中网络设备的现有带宽已变得不足。 需要以新的速度过渡到接口：10 Gbit / s，而不是访问时的1 Gbit / s和核心级别的40 Gbit / s，并具有设备和通信通道的完全冗余。 <br><br> 信息安全部收到了将基础架构划分为具有高级别流量和应用程序信息安全性的部分的请求（PN-专用网络和DMZ-非军事区）。 通过防火墙（ITU）的流量，无需进行过滤。 交换机上的VRF未用于此类流量。  ITU的规则不是最佳的（每个数据中心成千上万的规则）。 <br><br> 不可能在数据中心之间无缝迁移虚拟机（VM），同时保留IP地址和段之间的最佳通信路径，包括公司数据网络（KSPD）。 <br><br> 为了进行备份，使用了MSTP，某些端口被阻止（热备用）。 内核和访问交换机未合并到故障转移群集中，未使用接口聚合（LAG）。 <br><br> 随着第三个数据中心的出现，需要一种新的架构和设备配置来操作数据中心之间的环网（提出了EVPN）。 <br><br> 数据中心的开发没有一个单一的概念，而是以项目的形式记录下来并与客户的所有部门达成一致。 当前用于操作网络的文档不完整且过时。 <br><br><h3> 客户期望 </h3><br> 项目团队具有以下任务： <br><br><ul><li> 准备用于构建第三个数据中心的网络和服务器基础结构的体系结构和开发概念； </li><li> 对现有客户网络进行运营审核； </li><li> 通过每个数据中心的1500个10/40 Gbit / s以太网端口扩展网络核心的容量（总共4500个端口）； </li><li> 确保三个数据中心之间的环网运行，并可能将每个网段的速度提高到80 Gb / s，以便将来自不同数据中心的客户的计算资源合并到一个IT系统中； </li><li> 提供所有网络元素的100％双重保留，以达到99.995％的目标正常运行时间； </li><li> 最小化虚拟机之间的流量延迟，以加速业务应用程序； </li><li> 收集统计数据，进行分析并随后对数据中心的流量过滤规则进行优化（最初大约有80,000条规则）； </li><li> 开发目标架构，以将客户关键业务应用程序无缝迁移到三个数据中心中的任何一个。 </li></ul><br> 因此，我们有一些工作要做。 <br><br><h2> 配套设备 </h2><br> 让我们详细介绍一下项目中使用的设备。 <br><br>  <b>防火墙（NGWF）USG9560：</b> <br><br><ul><li> 分为VSYS; </li><li> 高达720 Gbps; </li><li> 多达7.2亿个并发会话； </li><li>  8个插槽。 </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/36e/523/355/36e5233550f276b92525d264c8c79ebc.png"></div><br>  <b>路由器NE40E-X8：</b> <br><br><ul><li> 高达7.08 Tbit / s的交换能力； </li><li> 最高2,880 Mpps的转发性能； </li><li>  8个用于线卡（LPU）的插槽； </li><li> 每个MPU最多可达10M BGP IPv4路由； </li><li> 每个MPU最多1500K OSPF IPv4路由; </li><li> 高达3000K-IPv4 FIB（取决于LPU）。 </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f74/581/f63/f74581f63475eb267481b2ecfbedf56d.png" width="500"></div><br>  <b>CE12800系列交换机：</b> <br><br><ul><li> 设备虚拟化：VS（1:16虚拟化），集群交换系统（CSS），超级虚拟结构（SVF）； </li><li> 网络虚拟化：M-LAG，TRILL，VXLAN和VXLAN桥接，VXLAN中的QinQ，EVN（以太网虚拟网络）； </li><li> 从VRP V2开始，包括EVPN支持。 </li><li>  M-LAG-Cisco Nexus上的vPC（虚拟端口通道）的类似物； </li><li> 虚拟生成树协议（VSTP）-与Cisco PVST兼容。 </li></ul><br>  <b>CE12804</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/038/32b/bd6/03832bbd638493fe604e0cd2df180a26.png" width="500"></div><br>  <b>CE12808</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ab/54b/f91/4ab54bf91ecef2a5607645c805adb69b.png" width="500"></div><br><h3> 软体类 </h3><br> 在项目中，我们使用了： <br><br><ul><li> 将其他厂商的防火墙的配置文件转换为新设备的命令格式； </li><li> 专有脚本，用于优化和转换防火墙配置。 </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ae/e32/aa1/5aee32aa1a46b56acb725054085288b6.png"></div>  <i>用于转换配置文件的转换器外观</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c05/fb0/3ea/c05fb03ea25d97c4239d18a78a7c4abd.png"></div>  <i>数据中心之间的通信组织方案（EVPN VXLAN）</i> <br><br><h2> 设备设置的细微差别 </h2><br>  <b>CE12808</b> <br><br><ul><li> 数据中心之间的通信采用EVPN（标准）而不是EVN（华为专有）： <br><br>  ○在控制平面中使用iBGP在L3之上的L2； <br>  ○通过iBGP EVPN系列（MAC路由，类型2）进行MAC培训及其公告； <br>  ○自动构建用于广播/未知单播流量的VXLAN隧道（包括多播路由，类型3）。 </li><li>  VS上的两种划分模式： <br><br>  ○基于端口（端口模式端口）或基于ASIC（端口模式组，显示设备端口映射）； <br>  ○端口拆分维度接口40GE仅在Admin VS中起作用（与端口模式无关）。 </li></ul><br>  <b>USG9560</b> <br><br><ul><li> 划分为VSYS的可能性， </li><li>  VSYS和路由泄漏之间不可能进行动态路由！ </li></ul><br>  <b>CE12804</b> <br><br> 数据中心之间具有MAC VRRP过滤功能的所有活动GW（VRRP主站/主站/主站） <br><br> <code>acl number 4000 <br> rule 5 deny source-mac 0000-5e00-0100 ffff-ffff-ff00 <br> rule 10 deny destination-mac 0000-5e00-0100 ffff-ffff-ff00 <br> rule 15 permit <br> <br> interface Eth-Trunk1 <br> traffic-filter acl 4000 outbound</code> <br> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4a5/ae3/2d8/4a5ae32d8dde225760aafa5e2695a9c6.png"></div>  <i>数据中心之间的资源交互方案（VXLAN EVPN和所有活动GW）</i> <br><br><h2> 项目挑战 </h2><br> 主要困难是需要使用计算基础结构来保留现有应用程序。 该客户拥有100多种不同的应用程序，其中一些是近10年前编写的。 例如，如果对于Yandex，您可以轻松关闭数百个虚拟机而又不损害最终用户，那么在《俄罗斯邮政》中，这种方法将需要从头开始开发许多应用程序，并需要更改企业信息系统的体系结构。 我们在计算基础架构的联合审核阶段解决了迁移和优化过程中出现的问题。 企业的所有新网络技术（例如EVPN）均已在实验室中进行了预测试。 <br><br><h2> 项目总结 </h2><br> 该项目团队包括来自<a href="https://itlanit.ru/">LANIT-Integration的</a>专家，客户及其合作伙伴在计算基础架构运营方面的专家。 还成立了来自供应商（Check Point和华为）的专用支持团队。 该项目耗时两年。 这是这段时间所做的。 <br><br><ul><li> 制定了开发数据中心网络，公司数据网络（KSPD）以及在数据中心之间建立环网的战略，并与所有客户部门达成了一致。 </li><li> 服务的可用性已经增加。 客户的业务注意到了这一点，并由于引入了新服务而导致了更大的流量增长。 </li><li> 从FWSM / ASA到USG 9560已迁移并优化了40,000多个规则。UGG9560上的不同ASA上下文已组合到一个安全策略中。 </li><li> 通过使用CE12800 / CE6850，数据中心端口吞吐量从1G增加到10 / 40G。 这消除了接口拥塞和数据包丢失。 <br></li><li> 考虑到未来的业务发展，运营商级路由器NE40E-X8可以完全满足客户数据中心和KSPD的需求。 </li><li>  USG 9560提出了八项新的功能请求。其中七项已经实施，并已包含在当前版本的VRP中。  1 FR-在华为研发部门销售。 这是一个由八个机箱组成的集群，能够配置必要的功能以同步配置而不同步会话。 如果到其中一个数据中心的流量延迟过大（Adler-Moscow在主要高速公路上为1300公里，在备用高速公路上为2800公里），则需要这样做。 </li></ul><br> 与其他俄罗斯邮政公司相比，该项目没有类似物。 <br><br> 数据中心网络基础设施的现代化为企业开发数字服务开辟了新的机遇。 <br><br><ul><li> 为个人和法人实体提供个人帐户和移动应用程序。 </li><li> 与电子商店整合以提供货物运送服务。 </li><li> 履行-货物存储，电子商店订单的形成和交付。 </li><li> 扩展订单的交付点，包括使用会员网络。 </li><li> 与交易对手具有法律意义的工作流程。 这样一来，您就可以放弃纸质文档的缓慢且昂贵的传输。 </li><li> 以电子形式和纸质形式接受电子形式的挂号信（交付时的印章应尽可能靠近最终收件人）。 在公共服务门户网站上提供电子挂号信的服务。 </li><li> 提供远程医疗服务的平台。 </li><li> 使用简单的电子签名简化了接收邮件并简化了投递邮件的发送。 </li><li> 邮局网络的数字化。 </li><li> 处理自助服务（终端和邮局）。 </li><li> 创建用于管理快递服务的数字平台和面向快递服务客户的新移动应用程序。 </li></ul><br><div class="spoiler">  <b class="spoiler_title">来我们工作吧！</b> <div class="spoiler_text"><ul><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-154.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2020-01-28%26utm_campaign%3Ddsi">企业基础架构工程师</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-171.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2020-01-28%26utm_campaign%3Ddsi">首席Linux / DevOps工程师</a> </li></ul></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN484090/">https://habr.com/ru/post/zh-CN484090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN484070/index.html">我们如何用四手三头编写反欺诈系统</a></li>
<li><a href="../zh-CN484072/index.html">5. Fortinet入门v6.0。 NAT</a></li>
<li><a href="../zh-CN484076/index.html">加密货币的存储位置：不同国家/地区的加密货币征税</a></li>
<li><a href="../zh-CN484084/index.html">1C-Bitrix并尝试引入它</a></li>
<li><a href="../zh-CN484088/index.html">密码命中大游行（从泄漏中分析约50亿个密码）</a></li>
<li><a href="../zh-CN484092/index.html">王子和贵族穿得有些体面</a></li>
<li><a href="../zh-CN484094/index.html">使用DOTS创建第三人称僵尸射击游戏</a></li>
<li><a href="../zh-CN484096/index.html">两个Yakozun之战，或Cassandra与HBase。 Sberbank团队经验</a></li>
<li><a href="../zh-CN484100/index.html">使用Android版Google Maps SDK中的界面</a></li>
<li><a href="../zh-CN484102/index.html">PHP vs Python vs Ruby on Rails：详细比较</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>