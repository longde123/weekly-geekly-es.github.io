<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèø‚Äçüè´ üî• ü¶ä Test de matrices RAID logicielles pour les p√©riph√©riques NVMe √† l'aide de la m√©thodologie SNIA üö§ üë©üèª‚Äçüåæ üå¨Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a quelques mois, alors qu'ils travaillaient sur le prochain projet, les gars de notre laboratoire de recherche ont √©tudi√© les disques NVMe et les...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Test de matrices RAID logicielles pour les p√©riph√©riques NVMe √† l'aide de la m√©thodologie SNIA</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raidix/blog/420837/"><img src="https://habrastorage.org/webt/4j/ib/lz/4jiblzb0pamckpjzolpdiq1gr8s.jpeg"><br><br>  Il y a quelques mois, alors qu'ils travaillaient sur le prochain projet, les gars de notre laboratoire de recherche ont √©tudi√© les disques NVMe et les solutions logicielles afin de trouver la meilleure option pour assembler une matrice logicielle. <br><br>  Les r√©sultats des tests √©taient alors √©tonnamment d√©courageants - l'√©norme potentiel de vitesse des disques NVMe n'√©tait pas du tout en corr√©lation avec les performances d√©montr√©es des produits logiciels existants. <br><a name="habracut"></a><br>  Nos d√©veloppeurs ne l'ont pas aim√©.  Et ils ont d√©cid√© d'√©crire leur produit ... Un produit que les sp√©cialistes du marketing ont ensuite joyeusement propos√© avec le nom RAIDIX ERA. <br><br>  Aujourd'hui, plus d'une douzaine d'entreprises produisent des serveurs adapt√©s √† l'utilisation des disques NVMe.  Le march√© des produits qui soutiennent et d√©veloppent cette technologie a un √©norme potentiel.  Dans le rapport analytique G2M, des chiffres assez convaincants sont pr√©sent√©s, convaincant que ce protocole de transfert de donn√©es dominera dans un avenir proche. <br><br><img src="https://habrastorage.org/webt/wd/f6/ol/wdf6olgkq9vam7sfinx9sb843ek.png"><br>  <i><font color="#99999">Graphique du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapport G2M</a></font></i> <br><br>  Actuellement, Intel est l'un des leaders de la production de composants NVMe.  C'est sur leur √©quipement que nous avons effectu√© des tests pour √©valuer les capacit√©s des logiciels existants √† g√©rer un mat√©riel aussi ¬´innovant¬ª. <br><br>  En collaboration avec notre partenaire Promobit (fabricant de serveurs et de syst√®mes de stockage de donn√©es sous la marque BITBLAZE), nous avons organis√© des tests des disques NVMe d'Intel et des logiciels courants pour la gestion de ces appareils.  Les tests ont √©t√© effectu√©s selon la m√©thode SNIA. <br><br>  Dans cet article, nous partagerons les chiffres obtenus lors des tests du syst√®me mat√©riel Intel NVMe, des baies logicielles de MDRAID, Zvol sur ZFS RAIDZ2 et, en fait, de notre nouveau d√©veloppement. <br><br><h2>  Configuration mat√©rielle </h2><br>  Pour la base de la plateforme de test, nous avons pris le syst√®me serveur Intel Server System R2224WFTZS.  Il dispose de 2 sockets pour l'installation de processeurs √©volutifs Intel Xeon et de 12 canaux de m√©moire (24 DIMM au total) DDR 4 avec une fr√©quence allant jusqu'√† 2666 MHz. <br><br>  Vous trouverez plus d'informations sur la plate-forme serveur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur le site Web du fabricant</a> . <br><br>  Tous les disques NVMe connect√©s via 3 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">backplanes F2U8X25S3PHS</a> . <br><br>  Au total, nous avons obtenu 12 disques NVMe INTEL SSDPD2MD800G4 avec le firmware CVEK6256004E1P0BGN dans le syst√®me. <br><br>  La plate-forme serveur √©tait √©quip√©e de deux processeurs Intel¬Æ Xeon¬Æ Gold 6130 √† 2,10 GHz avec Hyper-Threading activ√©, permettant de lancer deux threads √† partir de chaque c≈ìur.  Ainsi, en sortie, nous avons re√ßu 64 threads de calcul. <br><br><h2>  Pr√©paration au test </h2><br>  Tous les tests de cet article ont √©t√© effectu√©s conform√©ment aux sp√©cifications de la m√©thodologie SNIA SSS PTSe v 1.1.  Y compris, une pr√©paration pr√©liminaire du stockage a √©t√© effectu√©e afin d'obtenir un r√©sultat stable et honn√™te. <br><br>  SNIA permet √† l'utilisateur de d√©finir les param√®tres du nombre de threads et de la profondeur de file d'attente, nous avons donc d√©fini 64/32, avec 64 threads de calcul sur 32 c≈ìurs. <br><br>  Chaque test a √©t√© effectu√© en 16 cycles pour amener le syst√®me √† un niveau stable d'indicateurs et exclure les valeurs al√©atoires. <br><br>  Avant de commencer les tests, nous avons effectu√© une pr√©paration pr√©alable du syst√®me: <br><br><ol><li>  Installation de la version 4.11 du noyau sur CentOS 7.4. </li><li>  D√©sactivez C-STATES et P-STATES. </li><li>  Ex√©cutez l'utilitaire tuned-adm et d√©finissez le profil de performances de latence. </li></ol><br>  Les tests de chaque produit et article ont √©t√© effectu√©s selon les √©tapes suivantes: <br><br>  Pr√©paration des appareils selon la sp√©cification SNIA (d√©pendante et ind√©pendante du type de charge). <br><br><ol><li>  Test IOps en blocs de 4k, 8k, 16k, 32k, 64k, 128k, 1m avec des variations de combinaisons de lecture / √©criture 0/100, 5/95, 35/65, 50/50, 65/35, 95/5, 100/0 . </li><li>  Tests de latence avec des blocs 4k, 8k, 16k avec des variations de combinaisons de lecture / √©criture 0/100, 65/35 et 100/0.  Le nombre de threads et la profondeur de file d'attente est de 1-1.  Les r√©sultats sont enregistr√©s en tant que retards moyens et maximaux. </li><li>  Test de rendement avec blocs de 128k et 1M, en 64 lignes de 8 √©quipes. </li></ol><br>  Nous avons commenc√© par tester les performances, la latence et le d√©bit de la plate-forme mat√©rielle.  Cela nous a permis d'√©valuer le potentiel de l'√©quipement propos√© et de comparer avec les capacit√©s des solutions logicielles appliqu√©es. <br><br><h2>  Test 1. Test mat√©riel </h2><br>  Pour commencer, nous avons d√©cid√© de voir de quoi un disque Intel DCM D3700 NVMe est capable. <br>  Dans la sp√©cification, le fabricant d√©clare les param√®tres de performances suivants: <br><blockquote>  Lecture al√©atoire (100%) 450 000 IOPS <br>  √âcriture al√©atoire (100%) 88000 IOPS </blockquote><br><h3>  Test 1.1 Un lecteur NVMe.  Test IOPS </h3><br>  R√©sultat de performance (IOps) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  84017.8 </td><td>  91393.8 </td><td>  117271.6 </td><td>  133059.4 </td><td>  175086.8 </td><td>  281131.2 </td><td>  390969.2 </td></tr><tr><td>  8k </td><td>  42602.6 </td><td>  45735.8 </td><td>  58980.2 </td><td>  67321.4 </td><td>  101357.2 </td><td>  171316.8 </td><td>  216551.4 </td></tr><tr><td>  16k </td><td>  21618.8 </td><td>  22834.8 </td><td>  29703.6 </td><td>  33821.2 </td><td>  52552,6 </td><td>  89731.2 </td><td>  108347 </td></tr><tr><td>  32k </td><td>  10929.4 </td><td>  11322 </td><td>  14787 </td><td>  16811 </td><td>  26577,6 </td><td>  47185.2 </td><td>  50670.8 </td></tr><tr><td>  64k </td><td>  5494,4 </td><td>  5671,6 </td><td>  7342,6 </td><td>  8285.8 </td><td>  13130.2 </td><td>  23884 </td><td>  27249.2 </td></tr><tr><td>  128k </td><td>  2748,4 </td><td>  2805.2 </td><td>  3617,8 </td><td>  4295.2 </td><td>  6506,6 </td><td>  11997,6 </td><td>  13631 </td></tr><tr><td>  1m </td><td>  351,6 </td><td>  354,8 </td><td>  451,2 </td><td>  684,8 </td><td>  830.2 </td><td>  1574,4 </td><td>  1702.8 </td></tr></tbody></table><br>  R√©sultat de performance (IOps) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/ja/gw/al/jagwaldo3cvyw5bxk9uxgeaqvtq.png"><br><br>  A ce stade, nous avons obtenu des r√©sultats qui n'atteignent pas tout √† fait ceux de l'usine.  Tr√®s probablement, NUMA (le sch√©ma d'impl√©mentation de la m√©moire informatique utilis√© dans les syst√®mes multiprocesseurs, lorsque le temps d'acc√®s √† la m√©moire est d√©termin√© par son emplacement par rapport au processeur) a jou√© son r√¥le, mais pour l'instant nous n'y pr√™terons pas attention. <br><br><h3>  Testez 1.2 Un lecteur NVMe.  Tests de retard </h3><br>  <b>Temps de r√©ponse moyen</b> (ms) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,02719 </td><td>  0,072134 </td><td>  0,099402 </td></tr><tr><td>  8k </td><td>  0,029864 </td><td>  0,093092 </td><td>  0,121582 </td></tr><tr><td>  16k </td><td>  0,046726 </td><td>  0,137016 </td><td>  0,16405 </td></tr></tbody></table><br>  <b>Temps de r√©ponse moyen</b> (ms) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/di/dg/cy/didgcy1xldxrxa8e9qec9cfri8y.png"><br><br>  <b>Temps de r√©ponse maximum</b> (ms) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  6,9856 </td><td>  4.7147 </td><td>  1.5098 </td></tr><tr><td>  8k </td><td>  7.0004 </td><td>  4.3118 </td><td>  1,4086 </td></tr><tr><td>  16k </td><td>  7.0068 </td><td>  4.6445 </td><td>  1.1064 </td></tr></tbody></table><br>  <b>Temps de r√©ponse maximum</b> (ms) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/j0/sp/1y/j0sp1ynjubpq8yfuikeiogvhzz0.png"><br><br><h3>  Test 1.3 D√©bit </h3><br>  La derni√®re √©tape consiste √† √©valuer le d√©bit.  Voici les indicateurs suivants: <br><blockquote>  Enregistrement s√©quentiel de 1 Mo - 634 Mo / s. <br>  Lecture s√©quentielle 1 Mo - 1707 Mo / s. <br>  Enregistrement s√©quentiel de 128 Ko - 620 Mo / s. <br>  Lecture s√©quentielle de 128 Ko - 1704 Mo / s. </blockquote><br>  Apr√®s avoir trait√© un lecteur, nous proc√©dons √† l'√©valuation de la plate-forme enti√®re, qui se compose de 12 lecteurs. <br><br><h3>  Test 1.4 Syst√®me sur 12 disques.  Test IOPS </h3><br>  Ici, une d√©cision volontaire a √©t√© prise pour gagner du temps et afficher les r√©sultats uniquement pour travailler avec le bloc 4k, qui est de loin le sc√©nario le plus courant et indicatif pour √©valuer les performances. <br><br>  R√©sultat de performance (IOps) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  1363078.6 </td><td>  1562345 </td><td>  1944105 </td><td>  2047612 </td><td>  2176476 </td><td>  3441311 </td><td>  4202364 </td></tr></tbody></table><br>  R√©sultat de performance (IOps) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/lz/nb/za/lznbza47oi8rjwokg-eobx2rfnc.png"><br><br><h3>  Test 1.5 Syst√®me sur 12 disques.  Tests de bande passante </h3><br><blockquote>  Enregistrement s√©quentiel de 1 Mo - 8612 Mbps. <br>  Lecture s√©quentielle 1 Mo - 20481 Mbps. <br>  Enregistrement s√©quentiel de 128 Ko - 7500 Mbps. <br>  Lecture s√©quentielle de 128 Ko - 20 400 Mo / s. </blockquote><br>  Nous examinerons √† nouveau les indicateurs de performances mat√©rielles obtenus √† la fin de l'article, en les comparant avec les num√©ros des logiciels test√©s dessus. <br><br><h2>  Test 2: Test de MDRAID </h2><br>  Lorsque nous parlons d'un ensemble de logiciels, MDRAID vient √† l'esprit en premier.  Rappelons qu'il s'agit du logiciel RAID de base pour Linux, qui est distribu√© gratuitement. <br><br>  Voyons comment MDRAID g√®re le syst√®me √† 12 disques propos√© avec un niveau de matrice RAID 0. Nous comprenons tous que la construction de RAID 0 sur 12 disques n√©cessite un courage particulier, mais maintenant nous avons besoin de ce niveau de matrice pour d√©montrer les capacit√©s maximales de cette solution. <br><br><h3>  Test 2.1 MDRAID.  RAID 0. Test IOPS </h3><br>  R√©sultat de performance (IOps) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  1010396 </td><td>  1049306.6 </td><td>  1312401.4 </td><td>  1459698.6 </td><td>  1932776.8 </td><td>  2692752.8 </td><td>  2963943.6 </td></tr><tr><td>  8k </td><td>  513627.8 </td><td>  527230.4 </td><td>  678140 </td><td>  771887.8 </td><td>  1146340.6 </td><td>  1894547.8 </td><td>  2526853.2 </td></tr><tr><td>  16k </td><td>  261087.4 </td><td>  263638.8 </td><td>  343679.2 </td><td>  392655.2 </td><td>  613912.8 </td><td>  1034843.2 </td><td>  1288299.6 </td></tr><tr><td>  32k </td><td>  131198.6 </td><td>  130947.4 </td><td>  170846.6 </td><td>  216039.4 </td><td>  309028.2 </td><td>  527920.6 </td><td>  644774.6 </td></tr><tr><td>  64k </td><td>  65083.4 </td><td>  65099.2 </td><td>  85257.2 </td><td>  131005.6 </td><td>  154839.8 </td><td>  268425 </td><td>  322739 </td></tr><tr><td>  128k </td><td>  32550.2 </td><td>  32718.2 </td><td>  43378,6 </td><td>  66999.8 </td><td>  78935.8 </td><td>  136869.8 </td><td>  161015.4 </td></tr><tr><td>  1m </td><td>  3802 </td><td>  3718,4 </td><td>  3233.4 </td><td>  3467,2 </td><td>  3546 </td><td>  6150.8 </td><td>  8193.2 </td></tr></tbody></table><br>  R√©sultat de performance (IOps) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/jf/d1/kl/jfd1klb3wv6px-vjbxypjff8nmu.png"><br><br><h3>  Test 2.2 MDRAID.  RAID 0. Tests de d√©lai </h3><br>  <b>Temps de r√©ponse moyen</b> (ms) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,03015 </td><td>  0,067541 </td><td>  0,102942 </td></tr><tr><td>  8k </td><td>  0,03281 </td><td>  0,082132 </td><td>  0.126008 </td></tr><tr><td>  16k </td><td>  0,050058 </td><td>  0,114278 </td><td>  0,170798 </td></tr></tbody></table><br>  <b>Temps de r√©ponse moyen</b> (ms) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/6l/_o/im/6l_oimj5-72qy9d6w9tobclq3n4.png"><br><br>  <b>Temps de r√©ponse maximum</b> (ms) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  6.7042 </td><td>  3.7257 </td><td>  0,8568 </td></tr><tr><td>  8k </td><td>  6.5918 </td><td>  2.2601 </td><td>  0,9004 </td></tr><tr><td>  16k </td><td>  6.3466 </td><td>  2,77741 </td><td>  2,5678 </td></tr></tbody></table><br>  <b>Temps de r√©ponse maximum</b> (ms) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/ms/-s/or/ms-sorgvctpuijgx_jf2uomifty.png"><br><br><h3>  Test 2.3 MDRAID.  RAID 0. Tests de bande passante </h3><br><blockquote>  √âcriture s√©quentielle de 1 Mo - 7820 MBPS. <br>  Lecture s√©quentielle de 1 Mo - 20418 MBPS. <br>  √âcriture s√©quentielle de 128 Ko - 7622 Mo / s. <br>  Lecture s√©quentielle de 128 Ko - 20 380 Mo / s. </blockquote><br><h3>  Test 2.4 MDRAID.  RAID 6. Test IOPS </h3><br>  Voyons maintenant ce que ce syst√®me a au niveau RAID 6. <br><br>  Options de cr√©ation de tableaux <br><blockquote>  mdadm --create --verbose --chunk 16K / dev / md0 --level = 6 --raid-devices = 12 / dev / nvme0n1 / dev / nvme1n1 / dev / nvme2n1 / dev / nvme3n1 / dev / nvme4n1 / dev / nvme5n1 / dev / nvme8n1 / dev / nvme9n1 / dev / nvme10n1 / dev / nvme11n1 / dev / nvme6n1 / dev / nvme7n1 </blockquote><br>  Le volume total de la matrice √©tait de <b>7450,87 Gio</b> . <br><br>  Nous commen√ßons le test apr√®s l'initialisation pr√©liminaire de la matrice RAID. <br><br>  R√©sultat de performance (IOps) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  39907.6 </td><td>  42849 </td><td>  61609.8 </td><td>  78167.6 </td><td>  108594.6 </td><td>  641950.4 </td><td>  1902561.6 </td></tr><tr><td>  8k </td><td>  19474.4 </td><td>  20701.6 </td><td>  30316.4 </td><td>  39737.8 </td><td>  57051.6 </td><td>  394072.2 </td><td>  1875791.4 </td></tr><tr><td>  16k </td><td>  10371.4 </td><td>  10979.2 </td><td>  16022 </td><td>  20992.8 </td><td>  29955,6 </td><td>  225157.4 </td><td>  1267495.6 </td></tr><tr><td>  32k </td><td>  8505.6 </td><td>  8824.8 </td><td>  12896 </td><td>  16657.8 </td><td>  23823 </td><td>  173261.8 </td><td>  596857.8 </td></tr><tr><td>  64k </td><td>  5679,4 </td><td>  5931 </td><td>  8576.2 </td><td>  11137.2 </td><td>  15906.4 </td><td>  109469.6 </td><td>  320874.6 </td></tr><tr><td>  128k </td><td>  3976,8 </td><td>  4170.2 </td><td>  5974.2 </td><td>  7716,6 </td><td>  10996 </td><td>  68124.4 </td><td>  160453.2 </td></tr><tr><td>  1m </td><td>  768,8 </td><td>  811,2 </td><td>  1177,8 </td><td>  1515 </td><td>  2149,6 </td><td>  4880.4 </td><td>  5499 </td></tr></tbody></table><br>  R√©sultat de performance (IOps) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/p7/as/5s/p7as5s0v49uhmbhznnvjrpmfgf0.png"><br><br><h3>  Test 2.5 MDRAID.  RAID 6. Tests de d√©lai </h3><br>  <b>Temps de r√©ponse moyen</b> (ms) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,193702 </td><td>  0.145565 </td><td>  0,10558 </td></tr><tr><td>  8k </td><td>  0,266582 </td><td>  0,186618 </td><td>  0,127142 </td></tr><tr><td>  16k </td><td>  0,426294 </td><td>  0,281667 </td><td>  0,169504 </td></tr></tbody></table><br>  <b>Temps de r√©ponse moyen</b> (ms) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/ls/zv/3f/lszv3flgx0nduvygoxigvjfdfgk.png"><br><br>  <b>Temps de r√©ponse maximum</b> (ms) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  6.1306 </td><td>  4.5416 </td><td>  4.2322 </td></tr><tr><td>  8k </td><td>  6.2474 </td><td>  4.5197 </td><td>  3,5898 </td></tr><tr><td>  16k </td><td>  5.4074 </td><td>  5.5861 </td><td>  4.1404 </td></tr></tbody></table><br>  <b>Temps de r√©ponse maximum</b> (ms) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/fv/id/ri/fvidriesmmcwdstzhrsnmwd-kqa.png"><br><br>  Il est √† noter qu'ici MDRAID a montr√© un tr√®s bon niveau de retards. <br><br><h3>  Test 2.6 MDRAID.  RAID 6. Tests de bande passante </h3><br><blockquote>  √âcriture s√©quentielle de 1 Mo - 890 Mo / s. <br>  Lecture s√©quentielle de 1 Mo - 18800 MBPS. <br>  √âcriture s√©quentielle de 128 Ko - 870 Mo / s. <br>  Lecture s√©quentielle de 128 Ko - 10400 MBPS. </blockquote><br><h2>  Test 3. Zvol sur ZFS RAIDZ2 </h2><br>  ZFS a une fonction de cr√©ation RAID int√©gr√©e et un gestionnaire de volume int√©gr√© qui cr√©e des p√©riph√©riques de blocs virtuels, qui sont utilis√©s par de nombreux fabricants de stockage.  Nous profiterons √©galement de ces fonctionnalit√©s en cr√©ant un pool avec protection RAIDZ2 (analogue √† RAID 6) et un volume de bloc virtuel au-dessus. <br><br>  La version 0.79 (ZFS) a √©t√© compil√©e.  Options de cr√©ation de baies et de volumes: <br><blockquote>  ashift = 12 / compression - off / dedup - off / recordsize = 1M / atime = off / cachefile = none / Type RAID = RAIDZ2 </blockquote><br>  ZFS montre de tr√®s bons r√©sultats avec le pool nouvellement cr√©√©.  Cependant, avec un doublage r√©p√©t√©, les performances sont consid√©rablement r√©duites. <br><br>  L'approche SNIA est bonne car elle vous permet de voir les r√©sultats r√©els des tests de syst√®mes de fichiers similaires (celui bas√© sur ZFS) apr√®s des √©crasements r√©p√©t√©s sur eux. <br><br><h3>  Testez 3.1 ZVOL (ZFS).  RAIDZ2.  Test IOps </h3><br>  R√©sultat de performance (IOps) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  15719,6 </td><td>  15147.2 </td><td>  14190.2 </td><td>  15592,4 </td><td>  17965,6 </td><td>  44832.2 </td><td>  76314.8 </td></tr><tr><td>  8k </td><td>  15536.2 </td><td>  14929.4 </td><td>  15140.8 </td><td>  16551 </td><td>  17898.8 </td><td>  44553.4 </td><td>  76187.4 </td></tr><tr><td>  16k </td><td>  16696,6 </td><td>  15937.2 </td><td>  15982,6 </td><td>  17350 </td><td>  18546.2 </td><td>  44895.4 </td><td>  75549.4 </td></tr><tr><td>  32k </td><td>  11859,6 </td><td>  10915 </td><td>  9698.2 </td><td>  10235.4 </td><td>  11265 </td><td>  26741.8 </td><td>  38167.2 </td></tr><tr><td>  64k </td><td>  7444 </td><td>  6440.2 </td><td>  6313.2 </td><td>  6578.2 </td><td>  7465,6 </td><td>  14145.8 </td><td>  19099 </td></tr><tr><td>  128k </td><td>  4425,4 </td><td>  3785,6 </td><td>  4059,8 </td><td>  3859,4 </td><td>  4246.4 </td><td>  7143.4 </td><td>  10052,6 </td></tr><tr><td>  1m </td><td>  772 </td><td>  730,2 </td><td>  779,6 </td><td>  784 </td><td>  824,4 </td><td>  995,8 </td><td>  1514.2 </td></tr></tbody></table><br>  R√©sultat de performance (IOps) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/0j/cf/fr/0jcffrp4gkeayltgnp5us5rg2q8.png"><br><br>  Les chiffres de performance ne sont absolument pas impressionnants.  Dans le m√™me temps, le zvol pur (avant r√©√©criture) donne des r√©sultats nettement meilleurs (5 √† 6 fois plus √©lev√©s).  Ici, le test a montr√© qu'apr√®s le premier doublage, les performances chutaient. <br><br><h3>  Testez 3.2 ZVOL (ZFS).  RAIDZ2.  Tests de retard </h3><br>  <b>Temps de r√©ponse moyen</b> (ms) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,332824 </td><td>  0,2555225 </td><td>  0,218354 </td></tr><tr><td>  8k </td><td>  0,3299 </td><td>  0,259013 </td><td>  0,225514 </td></tr><tr><td>  16k </td><td>  0.139738 </td><td>  0,180467 </td><td>  0,233332 </td></tr></tbody></table><br>  <b>Temps de r√©ponse moyen</b> (ms) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/ys/fj/hb/ysfjhbkrepf-zzj6bvdtx_hhrlm.png"><br><br>  <b>Temps de r√©ponse maximum</b> (ms) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  90,55 </td><td>  69,9718 </td><td>  84.4018 </td></tr><tr><td>  8k </td><td>  91,6214 </td><td>  86.6109 </td><td>  104,7368 </td></tr><tr><td>  16k </td><td>  108.2192 </td><td>  86.2194 </td><td>  105,658 </td></tr></tbody></table><br>  <b>Temps de r√©ponse maximum</b> (ms) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/du/ue/_1/duue_1fwxcx-n4dmyd455pdrc40.png"><br><br><h3>  Test 3.3 ZVOL (ZFS).  RAIDZ2.  Tests de bande passante </h3><br><blockquote>  √âcriture s√©quentielle de 1 Mo - 1150 Mo / s. <br>  Lecture s√©quentielle de 1 Mo - 5500 MBPS. <br>  √âcriture s√©quentielle de 128 Ko - 1100 Mo / s. <br>  Lecture s√©quentielle de 128 Ko - 5300 Mo / s. </blockquote><br><h2>  Test 4: RAIDIX ERA </h2><br>  Voyons maintenant les tests de notre nouveau produit - RAIDIX ERA. <br>  Nous avons cr√©√© RAID6.  Taille de la bande: 16 ko.  Une fois l'initialisation termin√©e, ex√©cutez le test. <br><br>  R√©sultat de performance (IOps) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  354887 </td><td>  363830 </td><td>  486865.6 </td><td>  619349.4 </td><td>  921403.6 </td><td>  2202384.8 </td><td>  4073187.8 </td></tr><tr><td>  8k </td><td>  180914.8 </td><td>  185371 </td><td>  249927.2 </td><td>  320438.8 </td><td>  520188.4 </td><td>  1413096.4 </td><td>  2510729 </td></tr><tr><td>  16k </td><td>  92115.8 </td><td>  96327.2 </td><td>  130661.2 </td><td>  169247.4 </td><td>  275446.6 </td><td>  763307.4 </td><td>  1278465 </td></tr><tr><td>  32k </td><td>  59994.2 </td><td>  61765.2 </td><td>  83512.8 </td><td>  116562.2 </td><td>  167028.8 </td><td>  420216.4 </td><td>  640418.8 </td></tr><tr><td>  64k </td><td>  27660.4 </td><td>  28229.8 </td><td>  38687,6 </td><td>  56603.8 </td><td>  76976 </td><td>  214958.8 </td><td>  299137.8 </td></tr><tr><td>  128k </td><td>  14475,8 </td><td>  14730 </td><td>  20674.2 </td><td>  30358.8 </td><td>  40259 </td><td>  109258.2 </td><td>  160141.8 </td></tr><tr><td>  1m </td><td>  2892,8 </td><td>  3031.8 </td><td>  4032,8 </td><td>  6331,6 </td><td>  7514.8 </td><td>  15871 </td><td>  19078 </td></tr></tbody></table><br>  R√©sultat de performance (IOps) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/px/on/md/pxonmd9exhzvhwqse0wugnzkc9o.png"><br><br><h3>  Testez 4.2 RAIDIX ERA.  RAID 6. Tests de d√©lai </h3><br>  <b>Temps de r√©ponse moyen</b> (ms) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  0,16334 </td><td>  0,136397 </td><td>  0,10958 </td></tr><tr><td>  8k </td><td>  0,207056 </td><td>  0,163325 </td><td>  0,132586 </td></tr><tr><td>  16k </td><td>  0,313774 </td><td>  0,225767 </td><td>  0,182928 </td></tr></tbody></table><br>  <b>Temps de r√©ponse moyen</b> (ms) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/hv/ad/xq/hvadxqbbwsigpbfi2d40nhsfevo.png"><br><br>  <b>Temps de r√©ponse maximum</b> (ms) sous forme de tableau.  Lecture / √©criture Mix%. <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R65% / W35% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  5.371 </td><td>  3.4244 </td><td>  3,5438 </td></tr><tr><td>  8k </td><td>  5.243 </td><td>  3,7415 </td><td>  3,5414 </td></tr><tr><td>  16k </td><td>  7.628 </td><td>  4.2891 </td><td>  4.0562 </td></tr></tbody></table><br>  <b>Temps de r√©ponse maximum</b> (ms) sous forme graphique.  Lecture / √©criture Mix%. <br><br><img src="https://habrastorage.org/webt/pk/ys/bb/pkysbbysl2ldmme0fcbptzjh0ug.png"><br><br>  Les d√©lais sont similaires √† ce que MDRAID produit.  Mais pour des conclusions plus pr√©cises, une estimation des retards sous une charge plus grave doit √™tre effectu√©e. <br><br><h3>  Testez 4.3 RAIDIX ERA.  RAID 6. Tests de bande passante </h3><br><blockquote>  √âcriture s√©quentielle de 1 Mo - 8160 Mo / s. <br>  Lecture s√©quentielle 1 Mo - 19700 MBPS. <br>  √âcriture s√©quentielle de 128 Ko - 6 200 Mo / s. <br>  Lecture s√©quentielle de 128 Ko - 19700 MBPS. </blockquote><br><h2>  Conclusion </h2><br>  √Ä la suite des tests, il vaut la peine de comparer les chiffres obtenus √† partir des solutions logicielles avec ce que la plate-forme mat√©rielle nous fournit. <br><br>  Pour analyser les performances de la charge al√©atoire, nous comparerons la vitesse de RAID 6 (RAIDZ2) lorsque vous travaillez avec un bloc en 4k. <br><table><tbody><tr><th></th><th>  MD RAID 6 </th><th>  RAIDZ2 </th><th>  RAIDIX ERA RAID 6 </th><th>  Mat√©riel informatique </th></tr><tr><td>  4k R100% / W0% </td><td>  1902561 </td><td>  76314 </td><td>  4073187 </td><td>  4 494 142 </td></tr><tr><td>  4k R65% / W35% </td><td>  108594 </td><td>  17965 </td><td>  921403 </td><td>  1823432 </td></tr><tr><td>  4k R0% / W100% </td><td>  39907 </td><td>  15719 </td><td>  354887 </td><td>  958054 </td></tr></tbody></table><br><img src="https://habrastorage.org/webt/cm/4g/ff/cm4gffjnga2flpdn0nl3yxiwew0.png"><br><br>  Pour analyser les performances de la charge s√©rie, nous allons regarder RAID 6 (RAIDZ2) avec un bloc de 128k.  Entre les threads, nous avons utilis√© un d√©calage de 10 Go pour √©liminer le hit du cache et afficher les performances r√©elles. <br><table><tbody><tr><th></th><th>  MD RAID 6 </th><th>  RAIDZ2 </th><th>  RAIDIX ERA RAID 6 </th><th>  Mat√©riel informatique </th></tr><tr><td>  128k seq lu </td><td>  10400 </td><td>  5300 </td><td>  19700 </td><td>  20 400 </td></tr><tr><td>  128k d'√©criture s√©quentielle </td><td>  870 </td><td>  1100 </td><td>  6200 </td><td>  7500 </td></tr></tbody></table><br><img src="https://habrastorage.org/webt/6l/dw/wt/6ldwwti-7dql_njqadpemrz1mxi.png"><br><br><h3>  Quel est le r√©sultat? </h3><br>  Les matrices RAID logicielles populaires et abordables pour travailler avec des p√©riph√©riques NVMe ne peuvent pas montrer les performances inh√©rentes au potentiel mat√©riel. <br><br>  Ici, il existe un besoin tr√®s √©vident d'un logiciel de contr√¥le capable d'agiter la situation et de montrer que la symbiose de contr√¥le de programme avec les disques NVMe peut √™tre tr√®s productive et flexible. <br><br>  Comprenant cette demande, notre soci√©t√© a cr√©√© un produit RAIDIX ERA, dont le d√©veloppement s'est concentr√© sur la r√©solution des probl√®mes suivants: <br><br><ul><li>  Performances de lecture et d'√©criture √©lev√©es (plusieurs millions d'IOps) sur des baies avec Parit√© en mode mix. </li><li>  Performances de streaming √† partir de 30 Go / s, y compris pendant le basculement et la r√©cup√©ration. </li><li>  Prise en charge des niveaux RAID 5, 6, 7.3. </li><li>  Initialisation et reconstruction du fond. </li><li>  Param√®tres flexibles pour diff√©rents types de charge (c√¥t√© utilisateur). </li></ul><br>  Aujourd'hui, nous pouvons dire que ces t√¢ches sont termin√©es et que le produit est pr√™t √† l'emploi. <br><br>  Dans le m√™me temps, comprenant l'int√©r√™t de nombreuses parties int√©ress√©es pour de telles technologies, nous avons pr√©par√© pour la sortie non seulement une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">licence</a> payante, mais aussi une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">licence gratuite</a> , qui peut √™tre pleinement utilis√©e pour r√©soudre les probl√®mes sur les disques NVMe et SSD. <br><br>  En savoir plus sur RAIDIX ERA <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur notre site Web</a> . <br><br><h2>  UPD  Tests ZFS r√©duits avec taille d'enregistrement et taille de bloc 8k </h2><br>  Tableau des options ZFS <br><table><tbody><tr><th>  NOM </th><th>  PROPRI√âT√â </th><th>  VALEUR </th><th>  SOURCE </th></tr><tr><td>  r√©servoir </td><td>  taille d'enregistrement </td><td>  8K </td><td>  local </td></tr><tr><td>  r√©servoir </td><td>  compression </td><td>  √©teint </td><td>  d√©faut </td></tr><tr><td>  r√©servoir </td><td>  d√©doubler </td><td>  √©teint </td><td>  d√©faut </td></tr><tr><td>  r√©servoir </td><td>  somme de contr√¥le </td><td>  √©teint </td><td>  local </td></tr><tr><td>  r√©servoir </td><td>  volblocksize </td><td>  - </td><td>  - </td></tr><tr><td>  tank / raid </td><td>  taille d'enregistrement </td><td>  - </td><td>  - </td></tr><tr><td>  tank / raid </td><td>  compression </td><td>  √©teint </td><td>  local </td></tr><tr><td>  tank / raid </td><td>  d√©doubler </td><td>  √©teint </td><td>  d√©faut </td></tr><tr><td>  tank / raid </td><td>  somme de contr√¥le </td><td>  √©teint </td><td>  local </td></tr><tr><td>  tank / raid </td><td>  volblocksize </td><td>  8k </td><td>  d√©faut </td></tr></tbody></table><br>  L'enregistrement est devenu pire, la lecture est meilleure. <br>  Mais tout de m√™me, tous les r√©sultats sont nettement pires que les autres solutions <br><table><tbody><tr><th>  Taille de bloc </th><th>  R0% / W100% </th><th>  R5% / W95% </th><th>  R35% / W65% </th><th>  R50% / W50% </th><th>  R65% / W35% </th><th>  R95% / W5% </th><th>  R100% / W0% </th></tr><tr><td>  4k </td><td>  13703.8 </td><td>  14399.8 </td><td>  20903.8 </td><td>  25669 </td><td>  31610 </td><td>  66955.2 </td><td>  140849.8 </td></tr><tr><td>  8k </td><td>  15126 </td><td>  16227.2 </td><td>  22393,6 </td><td>  27720.2 </td><td>  34274.8 </td><td>  67008 </td><td>  139480.8 </td></tr><tr><td>  16k </td><td>  11111.2 </td><td>  11412.4 </td><td>  16980.8 </td><td>  20812.8 </td><td>  24680.2 </td><td>  48803.6 </td><td>  83710.4 </td></tr></tbody></table></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr420837/">https://habr.com/ru/post/fr420837/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr420825/index.html">Aujourd'hui sera le premier match entre OpenAI et Dota 2 professionnels (personnes gagn√©es). Nous comprenons comment fonctionne le bot</a></li>
<li><a href="../fr420827/index.html">Cr√©ez un projet maven simple √† l'aide de Java EE + WildFly10 + JPA (Hibernate) + Postgresql + EJB + IntelliJ IDEA</a></li>
<li><a href="../fr420829/index.html">Syst√®me d'emploi. Vue d'ensemble de l'autre c√¥t√©</a></li>
<li><a href="../fr420831/index.html">Le dispositif pour l'√©mission de cookies "Cook 3000"</a></li>
<li><a href="../fr420833/index.html">Erreurs majeures de mon√©tisation d'applications [et comment les corriger]</a></li>
<li><a href="../fr420841/index.html">Correctif pr√©-hospitalier ou ¬´Hey Swagger! O√π sont mes erreurs? "</a></li>
<li><a href="../fr420843/index.html">7 septembre, Iekaterinbourg - une r√©union pour les d√©veloppeurs .NET</a></li>
<li><a href="../fr420845/index.html">Apprivoiser l'obstin√© √† l'aide d'une b√©quille: le trou de l'adaptateur Wi-Fi WF2190 (Realtek8812AU Wireless LAN 802.11ac USB)</a></li>
<li><a href="../fr420847/index.html">Introduction √† la programmation des shaders pour les mises en page</a></li>
<li><a href="../fr420853/index.html">D√©couvrez la pseudo console Windows (ConPTY)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>