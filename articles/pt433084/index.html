<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìô üí™üèº üßö Li√ß√£o aberta "Engenharia de recursos no exemplo do conjunto de dados cl√°ssico do Titanic" üé© üìÆ üëêüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° novamente! 

 Em dezembro, come√ßaremos o treinamento para o pr√≥ximo grupo de cientistas de dados , para que haja mais e mais li√ß√µes abertas e outr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Li√ß√£o aberta "Engenharia de recursos no exemplo do conjunto de dados cl√°ssico do Titanic"</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/433084/">  Ol√° novamente! <br><br>  Em dezembro, come√ßaremos o treinamento para o pr√≥ximo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">grupo de cientistas de dados</a> , para que haja mais e mais li√ß√µes abertas e outras atividades.  Por exemplo, outro dia, um webinar foi realizado com o nome longo "Feature Engineering no exemplo do conjunto de dados cl√°ssico do Titanic".  Foi conduzido por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Alexander Sizov</a> , um desenvolvedor experiente, Ph.D., especialista em Machine / Deep Learning e participante de v√°rios projetos comerciais internacionais relacionados √† intelig√™ncia artificial e an√°lise de dados. <br><br>  Uma li√ß√£o aberta levou cerca de uma hora e meia.  Durante o webinar, o professor falou sobre a sele√ß√£o de recursos, a transforma√ß√£o de dados de origem (codifica√ß√£o, dimensionamento), a defini√ß√£o de par√¢metros, o treinamento do modelo e muito mais.  Durante a li√ß√£o, os participantes receberam um caderno Jupyter.  Para o trabalho, usamos dados abertos da plataforma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Kaggle</a> (o conjunto de dados cl√°ssico sobre o Titanic, a partir do qual muitos come√ßam a se familiarizar com a Ci√™ncia de Dados).  Abaixo, oferecemos um v√≠deo e uma transcri√ß√£o do evento passado, e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> voc√™ pode pegar a apresenta√ß√£o e os c√≥digos em um laptop Jupiter. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/tOAAwpK2O80" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><a name="habracut"></a><br>  <b>Sele√ß√£o de Recursos</b> <b><br></b> <br>  O tema foi escolhido, embora cl√°ssico, mas ainda um pouco sombrio.  Em particular, foi necess√°rio resolver o problema de classifica√ß√£o bin√°ria e prever a partir dos dados dispon√≠veis se o passageiro sobreviver√° ou n√£o.  Os dados em si foram divididos em duas amostras de treinamento e teste.  A vari√°vel chave √© Survival (sobreviveu / n√£o sobreviveu; 0 = N√£o, 1 = Sim). <br><br>  Dados de treinamento de entrada: <br><br><ol><li>  classe de ingresso </li><li>  idade e sexo do passageiro; </li><li>  estado civil (se h√° parentes a bordo); </li><li>  pre√ßo do bilhete; </li><li>  n√∫mero da cabine; </li><li>  porto de embarque. </li></ol><br>  Como voc√™ pode ver, os tipos de vari√°veis ‚Äã‚Äãs√£o diferentes: num√©rico, texto.  Nesse caleidosc√≥pio, foi necess√°rio formar um conjunto de dados para o pr√≥ximo treinamento do modelo. <br><br>  Resumimos: <br><br><ul><li>  train.csv - conjunto de treinamento - conjunto de dados de treinamento.  A resposta √© conhecida neles - sobreviv√™ncia - um sinal bin√°rio 0 (n√£o sobreviveu) / 1 (sobreviveu); </li><li>  test.csv - conjunto de teste - conjunto de dados de teste.  A resposta √© desconhecida.  Esta √© uma amostra a ser enviada √† plataforma kaggle para calcular a m√©trica de qualidade do modelo; </li><li>  gender_submission.csv √© um exemplo do formato dos dados a serem enviados ao kaggle. </li></ul><br>  Algoritmo de trabalho <br><br><ol><li>  O trabalho ocorreu em etapas: </li><li>  An√°lise de dados de train.csv. </li><li>  Manipula√ß√£o de valores ausentes. </li><li>  Dimensionamento. </li><li>  Codifica√ß√£o de recursos categ√≥ricos. </li><li>  Construindo um modelo e selecionando par√¢metros, escolhendo o melhor modelo nos dados convertidos em train.csv. </li><li>  Fixa√ß√£o e modelo do m√©todo de transforma√ß√£o. </li>
<li>  Aplicando as mesmas convers√µes ao test.csv usando o pipeline. </li><li>  Aplica√ß√£o do modelo em test.csv. </li><li>  Salvando o arquivo de resultados do aplicativo no mesmo formato que em gender_submission.csv. </li><li>  Enviando resultados para a plataforma kaggle. </li></ol><br>  <b>A parte pr√°tica do webinar</b> <br><br>  A primeira coisa que precisava ser feita foi ler o conjunto de dados e exibir nossos dados na tela: <br><br><img src="https://habrastorage.org/webt/eu/7p/vm/eu7pvmx66rypokyjafuw8kmyn3k.png"><br><br>  Para an√°lise dos dados, foi utilizada uma biblioteca de perfis pouco conhecida, mas bastante √∫til: <br> <code>pandas_profiling.ProfileReport(df_train)</code> <br> <br>  <b>Mais sobre cria√ß√£o de perfil</b> <br><br>  Esta biblioteca faz tudo o que pode ser feito a priori sem conhecer os detalhes sobre os dados.  Por exemplo, exiba estat√≠sticas sobre os dados (quantas vari√°veis ‚Äã‚Äãe que tipo s√£o, quantas linhas, valores ausentes etc.).  Al√©m disso, estat√≠sticas separadas para cada vari√°vel s√£o fornecidas com um m√≠nimo e um m√°ximo, um gr√°fico de distribui√ß√£o e outros par√¢metros. <br><br>  Como voc√™ sabe, para criar um bom modelo, voc√™ precisa se aprofundar no processo que estamos tentando simular e entender quais s√£o os principais atributos.  Al√©m disso, longe de sempre em nossos dados, h√° tudo o que √© necess√°rio e, mais precisamente, quase nunca neles h√° tudo o que √© necess√°rio, determinando e determinando completamente nosso processo.  Como regra, sempre precisamos combinar algo, talvez adicionar recursos adicionais que n√£o s√£o representados no conjunto de dados (por exemplo, a previs√£o do tempo).  √â para entender o processo que precisamos da an√°lise de dados, o que pode ser feito usando a biblioteca de cria√ß√£o de perfil. <br><br>  <b>Valores em falta</b> <br><br>  O pr√≥ximo passo √© resolver o problema dos valores ausentes, porque na maioria dos casos os dados n√£o s√£o completamente preenchidos. <br>  As seguintes solu√ß√µes est√£o dispon√≠veis para esse problema: <br><br><ul><li>  excluir linhas com valores ausentes (lembre-se de que voc√™ pode perder alguns valores importantes); </li><li>  excluir um sinal (relevante se houver muito poucos dados nele); </li><li>  substitua valores ausentes por outra coisa (mediana, m√©dia ...). </li></ul><br>  Um exemplo de uma convers√£o simples usando o m√©todo fillna, que atribui os valores da vari√°vel mediana apenas √†s c√©lulas que n√£o s√£o preenchidas: <br><br><img src="https://habrastorage.org/webt/sj/ir/yl/sjirylzgnphmwoba3e2jnnicflc.png"><br><br>  Al√©m disso, o professor mostrou exemplos de uso do Imputer e do pipeline. <br><br>  <b>Escala de recursos</b> <br><br>  A opera√ß√£o do modelo e a decis√£o final dependem da escala dos recursos.  O fato √© que n√£o √© fato que qualquer recurso que tenha uma escala maior seja mais importante do que um recurso que tenha uma escala menor.  √â por isso que o modelo precisa enviar recursos dimensionados de forma id√™ntica, ou seja, tendo o mesmo peso para o modelo. <br><br>  Existem diferentes t√©cnicas de dimensionamento, no entanto, o formato da li√ß√£o aberta nos permitiu considerar apenas duas delas em mais detalhes: <br><br><img src="https://habrastorage.org/webt/jj/jm/h_/jjjmh_mkrlg5n73lo9l5nabgl7q.png"><br><br>  <b>Combina√ß√µes de recursos</b> <br><br>  Combina√ß√µes de recursos existentes usando opera√ß√µes aritm√©ticas (soma, multiplica√ß√£o, divis√£o) permitem obter qualquer recurso que torne o modelo mais eficiente.  Isso nem sempre √© bem sucedido e n√£o sabemos qual combina√ß√£o dar√° o efeito desejado, mas a pr√°tica mostra que faz sentido tentar.  √â conveniente aplicar transforma√ß√µes de recursos usando o pipeline. <br><br>  <b>Codifica√ß√£o</b> <br><br>  Portanto, temos dados de diferentes tipos: num√©ricos e de texto.  Atualmente, a maioria dos modelos no mercado n√£o pode funcionar com dados de texto.  Como resultado, todos os sinais categ√≥ricos (textuais) devem ser convertidos em uma representa√ß√£o num√©rica, para a qual a codifica√ß√£o √© usada. <br><br>  <b>Codifica√ß√£o de etiquetas</b> .  Este √© um mecanismo implementado na estrutura de muitas bibliotecas que podem ser chamadas e aplicadas: <br><br><img src="https://habrastorage.org/webt/tf/xd/kh/tfxdkh3eypfrqjuihl4w_60vfzq.png"><br><br>  A codifica√ß√£o de etiqueta atribui um identificador exclusivo a cada valor exclusivo.  Menos - introduzimos a ordem em uma determinada vari√°vel que n√£o foi ordenada, o que n√£o √© bom. <br><br>  <b>OneHotEncoder.</b>  Os valores exclusivos da vari√°vel de texto s√£o expandidos na forma de colunas, que s√£o adicionadas aos dados de origem, em que cada coluna √© uma vari√°vel bin√°ria na forma de 0 e 1. Essa abordagem n√£o possui defici√™ncias na codifica√ß√£o da etiqueta, mas tem seu menos: se houver muitos valores exclusivos, adicionamos muitas colunas e, em alguns casos, o m√©todo simplesmente n√£o √© aplic√°vel (o conjunto de dados cresce demais). <br><br>  <b>Modelo de treinamento</b> <br><br>  Depois de executar as etapas acima, um pipeline final √© compilado com um conjunto de todas as opera√ß√µes necess√°rias.  Agora basta pegar o conjunto de dados de origem e aplicar o pipeline resultante a esses dados usando a opera√ß√£o fit_transform: <br> <code>x_train = vec.fit_transform(df_train)</code> <br> <br>  Como resultado, obtemos o conjunto de dados x_train, que est√° pronto para uso no modelo.  A √∫nica coisa a fazer √© separar o valor da nossa vari√°vel de destino para que possamos realizar o treinamento. <br><br>  Em seguida, selecione o modelo.  Como parte do webinar, o professor prop√¥s uma regress√£o log√≠stica simples.  O modelo foi treinado usando a opera√ß√£o de ajuste, resultando em um modelo na forma de regress√£o log√≠stica com certos par√¢metros: <br><br><img src="https://habrastorage.org/webt/xs/tc/dc/xstcdche3jydmlahruszn6txahi.png"><br><br>  No entanto, na pr√°tica, geralmente s√£o usados ‚Äã‚Äãv√°rios modelos que parecem ser os mais eficazes.  E a solu√ß√£o final geralmente √© uma combina√ß√£o desses modelos usando t√©cnicas de empilhamento e outras abordagens para montar modelos (usando v√°rios modelos no mesmo modelo h√≠brido). <br><br>  Ap√≥s o treinamento, o modelo pode ser aplicado aos dados de teste, avaliando sua qualidade na estrutura de algumas m√©tricas.  No nosso caso, a qualidade dentro do precision_score foi de 0,8: <br><br><img src="https://habrastorage.org/webt/ka/ut/dj/kautdjopfjqa1dbgkii10wptcfs.png"><br><br>  Isso significa que, nos dados obtidos, a vari√°vel √© prevista corretamente em 80% dos casos.  Ap√≥s receber os resultados do treinamento, podemos melhorar o modelo (se a precis√£o n√£o for satisfat√≥ria) ou prosseguir diretamente para a previs√£o. <br><br>  Este foi o t√≥pico principal da li√ß√£o, mas o professor falou com mais detalhes sobre os recursos do modelo em diferentes tarefas e respondeu a perguntas da plat√©ia.  Portanto, se voc√™ n√£o quer perder nada, assista ao semin√°rio on-line completo se estiver interessado neste t√≥pico. <br><br>  Como sempre, estamos aguardando seus coment√°rios e perguntas que voc√™ pode deixar aqui ou perguntar a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Alexander</a> , indo at√© ele em um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">dia aberto.</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt433084/">https://habr.com/ru/post/pt433084/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt433072/index.html">Como hackear a prote√ß√£o contra c√≥pia do console Sega Dreamcast</a></li>
<li><a href="../pt433074/index.html">Mudando para o Kotlin em um projeto Android: Dicas e Truques</a></li>
<li><a href="../pt433076/index.html">Como criamos nossa biblioteca da Galeria do Android para exibir conte√∫do de m√≠dia</a></li>
<li><a href="../pt433078/index.html">Escrevemos rob√¥s de negocia√ß√£o usando a estrutura gr√°fica StockSharp. Parte 2</a></li>
<li><a href="../pt433082/index.html">Bombear as contas de outras pessoas se tornou um crime na Cor√©ia do Sul</a></li>
<li><a href="../pt433086/index.html">Tinkoff e tudo, tudo, tudo: IoT, an√°lise e vigil√¢ncia para bancos</a></li>
<li><a href="../pt433088/index.html">Como voc√™ gosta, Elon Musk: BMW e Porsche desenvolveram um carregamento que adiciona 100 km de viagem em 3 minutos</a></li>
<li><a href="../pt433090/index.html">T√©cnicas de √≠ndice de bitmap Oracle</a></li>
<li><a href="../pt433092/index.html">Modelagem CG de n√≠vel 80: Personagens fotorrealistas realistas em Unreal</a></li>
<li><a href="../pt433094/index.html">Modelagem num√©rica em uma grande empresa industrial</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>