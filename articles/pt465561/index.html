<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíáüèæ üö† üò¥ O que aprendi com um programador l√≠der üçÑ üåò ü§∑üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="H√° um ano, comecei a trabalhar em per√≠odo integral na Bloomberg. E ent√£o eu decidi escrever este artigo. Eu pensei que estaria cheio de id√©ias que eu ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>O que aprendi com um programador l√≠der</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/mailru/blog/465561/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/cc/m9/v8/ccm9v8yphneof1qcnuaru8peu1e.jpeg"></div><br>  H√° um ano, comecei a trabalhar em per√≠odo integral na Bloomberg.  E ent√£o eu decidi escrever este artigo.  Eu pensei que estaria cheio de id√©ias que eu poderia jogar no papel quando chegasse a hora.  Mas, dentro de um m√™s, percebi que tudo n√£o seria t√£o simples: j√° comecei a esquecer o que aprendi.  Ou o conhecimento foi t√£o bem adquirido que minha mente me fez acreditar que eu sempre soube, ou eles simplesmente voaram da minha cabe√ßa.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup>1</sup></a> <br><br>  Essa √© uma das raz√µes pelas quais comecei a manter um di√°rio.  Todos os dias, entrando em situa√ß√µes interessantes, eu as descrevi.  E tudo gra√ßas ao fato de estar sentado ao lado de um programador l√≠der.  Eu pude observar de perto o trabalho dele e vi como era diferente do que eu faria.  N√≥s programamos muito juntos, o que tornou minhas observa√ß√µes ainda mais f√°ceis.  Al√©m disso, nossa equipe n√£o condena a "espionagem" de pessoas que escrevem c√≥digo.  Quando me pareceu que algo interessante estava acontecendo, eu me virei e olhei.  Gra√ßas ao constante aumento, eu sempre tive consci√™ncia do que estava acontecendo. <br><br>  Passei um ano ao lado de um programador l√≠der.  Foi isso que eu aprendi. <br><a name="habracut"></a><br><h1>  Conte√∫do </h1><br><ul><li>  Escrita de c√≥digo <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como nomear coisas no c√≥digo</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">C√≥digo herdado e o pr√≥ximo desenvolvedor</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Documenta√ß√£o e coment√°rios no c√≥digo</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Commits at√¥micos</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como excluir com seguran√ßa c√≥digos ruins</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Revis√£o de c√≥digo</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Teste</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Redu√ß√£o de risco</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Arquitetura</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criamos arquitetura, sem esquecer a manuten√ß√£o</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Implantar</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Quando algo der errado</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Bicicleta</a> <br></li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Monitoramento</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conclus√£o</a> <br></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sobre o que n√£o tenho certeza</a> <br></li></ul><br><h2>  Escrita de c√≥digo </h2><br><a name="1"></a><h4>  Como nomear coisas no c√≥digo </h4><br>  Uma das minhas primeiras tarefas foi trabalhar na interface do usu√°rio do React.  T√≠nhamos um componente principal que continha todos os outros componentes.  Eu gosto de adicionar um pouco de humor ao c√≥digo e queria nomear o componente principal do <code>GodComponent</code> .  Chegou o momento de revisar o c√≥digo e entendi por que √© t√£o dif√≠cil dar nomes. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="7269997868"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  Cada peda√ßo de c√≥digo que batizei ganhou um prop√≥sito impl√≠cito.  <code>GodComponent</code> ?  Esse √© o componente que recebe todo o lixo que eu n√£o quero colocar no lugar certo.  Ele cont√©m tudo.  Nomeie-o <code>LayoutComponent</code> , e no futuro eu decidiria que este componente atribui um layout.  Que n√£o cont√©m um estado. <br><br>  Outra li√ß√£o importante que aprendi foi que, se algo parecer muito grande, como um <code>LayoutComponent</code> com um monte de l√≥gica de neg√≥cios, √© hora de refator√°-lo, porque n√£o deve haver l√≥gica de neg√≥cios aqui.  E no caso do nome <code>GodComponent</code> presen√ßa da l√≥gica de neg√≥cios n√£o importar√°. <br><br>  Precisa nomear os clusters?  Ligar para eles ap√≥s os servi√ßos executados neles ser√° uma √≥tima id√©ia at√© voc√™ executar outra coisa nesses clusters.  Demos a eles um nome em homenagem √† nossa equipe. <br><br>  O mesmo se aplica √†s fun√ß√µes.  <code>doEverything()</code> √© um nome terr√≠vel com muitas consequ√™ncias.  Se a fun√ß√£o fizer tudo, ser√° muito dif√≠cil testar suas partes individuais.  N√£o importa o tamanho dessa fun√ß√£o, ela nunca parecer√° muito estranha para voc√™, pois deve fazer tudo.  Ent√£o mude o nome.  Refact. <br><br>  Um nome significativo tem uma desvantagem.  De repente, o nome ser√° muito significativo e ocultar√° algum tipo de nuance?  Por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fechar sess√µes</a> n√£o fecha a conex√£o com o banco de dados quando <code>session.close()</code> chamado em SQLAlchemy.  Eu deveria ter lido a documenta√ß√£o e evitado esse bug, mais sobre isso na se√ß√£o de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bicicletas</a> . <br><br>  Desse ponto de vista, nomear fun√ß√µes como <code>x</code> , <code>y</code> , <code>z</code> vez de <code>count()</code> , <code>close()</code> , <code>insertIntoDB()</code> n√£o nos permite colocar um certo significado nelas e me faz monitorar cuidadosamente o que essas fun√ß√µes fazem.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup>2</sup></a> <br><br>  Eu nunca pensei que escreveria sobre os princ√≠pios de nomear mais de uma linha de texto. <br><br><a name="2"></a><h4>  C√≥digo herdado e o pr√≥ximo desenvolvedor </h4><br>  Voc√™ j√° olhou o c√≥digo e isso lhe parece estranho?  Por que voc√™ escreveu isso?  Isso n√£o faz sentido. <br><br>  Eu tive a chance de trabalhar com uma base de c√≥digo herdada.  Isso, voc√™ sabe, com coment√°rios como "Descomente o c√≥digo quando Maom√© entender a situa√ß√£o".  O que voc√™ est√° fazendo aqui?  Quem √© Maom√©? <br><br>  Posso trocar de pap√©is e pensar na pessoa que receber√° meu c√≥digo, isso parecer√° estranho para ele?  A revis√£o parcial do seu c√≥digo ajuda os colegas a revis√°-lo.  Isso me levou a pensar sobre o contexto: preciso lembrar o contexto em que minha equipe trabalha. <br><br>  Se eu esquecer esse c√≥digo, retornar a ele mais tarde e n√£o conseguir restaurar o contexto, direi: ‚ÄúO que diabos eles fizeram?  Isso √© est√∫pido ... Ah, espere, eu consegui. <br><br>  E aqui a documenta√ß√£o e os coment√°rios no c√≥digo entram em jogo. <br><br><a name="3"></a><h4>  Documenta√ß√£o e coment√°rios no c√≥digo </h4><br>  Eles ajudam a manter o contexto e transmitir conhecimento.  Como Lee disse em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Como criar um bom software</a> : <br><br><blockquote>  O principal valor do software n√£o est√° no c√≥digo criado, mas no conhecimento acumulado pelas pessoas que criaram esse software </blockquote><br>  Voc√™ tem um ponto de extremidade da API do cliente aberto que ningu√©m parece ter usado.  Ele s√≥ precisa ser exclu√≠do?  De um modo geral, √© um dever t√©cnico.  E se eu lhe disser que em um dos pa√≠ses, 10 jornalistas enviam seus relat√≥rios para esse endpoint uma vez por ano?  Como verific√°-lo?  Se isso n√£o for mencionado na documenta√ß√£o (era), n√£o h√° como verificar isso.  N√≥s n√£o verificamos.  Eles o removeram e, alguns meses depois, chegou aquele momento anual.  Dez jornalistas n√£o puderam enviar seus relat√≥rios importantes porque o ponto final n√£o existia mais.  E pessoas com conhecimento de produto j√° deixaram a equipe.  Obviamente, agora no c√≥digo h√° coment√°rios explicando por que isso √© necess√°rio. <br><br>  At√© onde eu sei, cada equipe est√° lutando com a documenta√ß√£o.  E com a documenta√ß√£o, n√£o apenas pelo c√≥digo, mas tamb√©m pelos processos associados a ela. <br><br>  Ainda n√£o chegamos √† solu√ß√£o perfeita.  Pessoalmente, gosto da maneira como Antirez dividiu os coment√°rios no c√≥digo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">em diferentes tipos de valores</a> . <br><br><a name="4"></a><h4>  Commits at√¥micos </h4><br>  Se voc√™ precisar reverter (e precisa. Consulte o cap√≠tulo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Teste</a> ), isso confirmar√° o sentido como um √∫nico m√≥dulo? <br><br><a name="5"></a><h4>  Como excluir com seguran√ßa c√≥digos ruins </h4><br>  Fiquei muito desagrad√°vel ao excluir o c√≥digo ruim ou desatualizado.  Pareceu-me que tudo o que foi escrito s√©culos atr√°s √© sagrado.  Eu pensei: "Eles tinham algo em mente quando escreveram assim".  Este √© um confronto entre tradi√ß√£o e cultura, por um lado, e pensar no estilo do "princ√≠pio prim√°rio", por outro.  √â o mesmo que a remo√ß√£o do terminal anual.  Eu aprendi uma li√ß√£o especial.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup>3</sup></a> <br><br>  Eu tentava contornar o c√≥digo e os principais desenvolvedores tentavam passar por ele.  Apague.  Uma express√£o if que n√£o pode ser acessada?  Sim, n√≥s apagamos.  O que eu fiz?  Acabei de escrever minha fun√ß√£o em cima dela.  N√£o reduzi a d√≠vida t√©cnica.  Enfim, acabei de aumentar a complexidade e o encaminhamento do c√≥digo.  Ser√° ainda mais dif√≠cil para a pr√≥xima pessoa juntar as pe√ßas da imagem. <br><br>  Empiricamente, cheguei √† conclus√£o: existe um c√≥digo que voc√™ n√£o entende, mas existe um c√≥digo com o qual voc√™ definitivamente nunca entrar√° em contato.  Apague o c√≥digo que voc√™ n√£o contata e tenha cuidado com o c√≥digo que voc√™ n√£o entende. <br><br><a name="6"></a><h4>  Revis√£o de c√≥digo </h4><br>  Uma revis√£o de c√≥digo √© uma √≥tima ferramenta para auto-educa√ß√£o.  Este √© um loop de feedback externo, mostrando como eles escreveriam o c√≥digo e como voc√™ o escreveu.  Qual a diferen√ßa?  De um jeito melhor que do outro?  Eu me perguntava sobre isso em todas as resenhas: "Por que eles escreveram dessa maneira?"  E se ele n√£o conseguiu encontrar uma resposta adequada, foi e perguntou. <br><br>  Ap√≥s o primeiro m√™s, comecei a encontrar erros no c√≥digo dos meus colegas (como eles encontraram nos meus).  Era algum tipo de loucura.  A revis√£o se tornou muito mais interessante para mim, tornou-se um jogo que eu estava perdendo, um jogo que melhorou meu "senso de c√≥digo". <br><br>  Na minha experi√™ncia, voc√™ n√£o precisa aprovar o c√≥digo at√© que eu entenda como ele funciona. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/96a/2ad/248/96a2ad248018ff0721f16a262dbb294c.png"><br>  <i>Minhas estat√≠sticas do github.</i> <br><br><a name="7"></a><h2>  Teste </h2><br>  Eu me apaixonei tanto por testar que √© desagrad√°vel escrever c√≥digo em uma base de c√≥digo sem testes. <br><br>  Se o seu aplicativo fizer apenas uma coisa (como todos os meus projetos da escola), voc√™ ainda poder√° testar manualmente.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup>4</sup></a> Foi exatamente o que eu fiz.  Mas o que acontece se um aplicativo executar 100 tarefas diferentes?  N√£o quero passar meia hora testando e √†s vezes perco alguma coisa.  Um pesadelo. <br><br>  Testes e automa√ß√£o de teste ajudam aqui. <br><br>  Trato o teste como documenta√ß√£o.  Esta √© a documenta√ß√£o das minhas id√©ias sobre c√≥digo.  Os testes me dizem como eu (ou qualquer outra pessoa antes de mim) imagino que o c√≥digo funcione e onde algo esperado deve dar errado. <br><br>  Hoje, quando escrevo testes, tento: <br><br><ol><li>  Mostre como usar a classe, fun√ß√£o ou sistema de teste. <br></li><li>  Mostre o que, na minha opini√£o, pode dar errado. <br></li></ol><br>  Como resultado, na maioria das vezes eu testo o comportamento, mas n√£o a implementa√ß√£o ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">eis um exemplo</a> que escolhi durante os intervalos no Google). <br><br>  No par√°grafo 2, n√£o mencionei as fontes de erros. <br><br>  Quando percebo um bug, certifico-me de que a corre√ß√£o tenha um teste apropriado (isso √© chamado de teste de regress√£o) para documentar as informa√ß√µes.  Essa √© outra raz√£o pela qual algo pode dar errado.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup>5</sup></a> <br><br>  Obviamente, a qualidade do meu c√≥digo melhora n√£o porque escrevo testes, mas porque escrevo c√≥digo.  Mas ler os testes me ajuda a entender melhor as situa√ß√µes e escrever um c√≥digo melhor. <br><br>  Esta √© a situa√ß√£o geral com o teste. <br><br>  Mas este n√£o √© o √∫nico tipo de teste que eu aplico.  Eu estou falando sobre ambientes de implanta√ß√£o.  Voc√™ pode ter testes de unidade ideais, mas se voc√™ n√£o tiver testes de sistema, algo como isto pode acontecer: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/905/1c5/bb8/9051c5bb8da5d845cbd0d9c6dcccf236.gif"><br><br>  Isso tamb√©m se aplica ao c√≥digo testado: se voc√™ n√£o possui as bibliotecas necess√°rias no seu computador, tudo ir√° falhar. <br><br><ul><li>  Existem m√°quinas nas quais voc√™ est√° desenvolvendo (a fonte de todos os memes como "Funcionou no meu computador!"). <br></li><li>  Existem m√°quinas nas quais voc√™ est√° testando (pode coincidir com as anteriores). <br></li><li>  Por fim, existem m√°quinas nas quais voc√™ est√° implantando (elas n√£o devem coincidir com as m√°quinas nas quais voc√™ desenvolveu). <br></li></ul><br>  Se os ambientes de teste e implanta√ß√£o n√£o corresponderem nas m√°quinas, voc√™ ter√° problemas.  Os ambientes de implanta√ß√£o ajudar√£o a evitar isso. <br><br>  Estamos desenvolvendo localmente no Docker em nosso computador. <br><br>  Temos um ambiente de desenvolvimento, esses computadores est√£o equipados com um conjunto de bibliotecas (e ferramentas de desenvolvimento) e aqui instalamos o c√≥digo escrito.  Aqui pode ser testado com todos os sistemas necess√°rios.  Tamb√©m temos um ambiente beta / intermedi√°rio que repete completamente o ambiente operacional.  Finalmente, temos um ambiente operacional - m√°quinas que executam c√≥digo para nossos clientes. <br><br>  A id√©ia √© capturar erros que n√£o apareceram durante os testes de unidade e sistema.  Por exemplo, a diferen√ßa na API entre os sistemas solicitante e respondente.  Eu acho que no caso de um projeto pessoal ou de uma pequena empresa, a situa√ß√£o pode ser completamente diferente.  Nem todo mundo tem a oportunidade de criar sua pr√≥pria infraestrutura.  No entanto, voc√™ pode recorrer a servi√ßos em nuvem, como AWS e Azure. <br><br>  Voc√™ pode configurar clusters individuais para desenvolvimento e opera√ß√£o.  O AWS ECS usa imagens do Docker para implantar; portanto, processos em diferentes ambientes ser√£o relativamente consistentes.  Existem nuances em termos de integra√ß√£o entre diferentes servi√ßos da AWS.  Voc√™ est√° chamando o endpoint certo do ambiente certo? <br><br>  Voc√™ pode ir ainda mais longe: baixe imagens de cont√™ineres alternativas para outros servi√ßos da AWS e configure um ambiente local totalmente funcional baseado no Docker-Compose.  Isso acelera o ciclo de feedback.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup>6</sup></a> Talvez eu ganhe mais experi√™ncia ao criar e lan√ßar meu projeto paralelo. <br><br><a name="8"></a><h2>  Redu√ß√£o de risco </h2><br>  Que medidas voc√™ pode tomar para reduzir seu risco de desastre?  Se estamos falando de uma nova mudan√ßa radical, como podemos verificar a dura√ß√£o m√≠nima do tempo de inatividade, se algo der errado?  "N√£o precisamos implantar completamente o sistema por causa de todas essas novas altera√ß√µes."  O que realmente?  E por que eu n√£o pensei nisso! <br><br><a name="9"></a><h2>  Arquitetura </h2><br>  Por que estou falando de arquitetura depois de escrever c√≥digo e testar?  Ele pode ser colocado em primeiro lugar, mas se eu n√£o tivesse programado e testado no ambiente que usei, provavelmente n√£o teria conseguido criar uma arquitetura que levasse em considera√ß√£o os recursos desse ambiente.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><sup>7</sup></a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><br></a> <br>  Voc√™ precisa pensar muito ao criar uma arquitetura. <br><br><ul><li>  Como os n√∫meros ser√£o usados? <br></li><li>  Quantos usu√°rios haver√°?  Quanto pode aumentar seu n√∫mero (o n√∫mero de linhas no banco de dados depende disso)? <br></li><li>  Que recifes podem se encontrar? <br></li></ul><br>  Preciso transformar isso em uma lista de verifica√ß√£o chamada "Recolha de reivindica√ß√£o".  No momento, n√£o tenho experi√™ncia suficiente, tentarei faz√™-lo no pr√≥ximo ano na Bloomberg.  Esse processo √© amplamente contr√°rio ao Agile: quanto voc√™ pode projetar a arquitetura antes de avan√ßar para a implementa√ß√£o?  √â tudo uma quest√£o de equil√≠brio, voc√™ precisa escolher quando e o que far√°.  Quando faz sentido avan√ßar e quando - recuar?  Obviamente, coletar requisitos n√£o √© o mesmo que considerar todos os problemas.  Eu acho que vale a pena se incluirmos os processos de desenvolvimento no design.  Por exemplo: <br><br><ul><li>  Como o desenvolvimento local continuar√°? <br></li><li>  Como vamos embalar e implantar? <br></li><li>  Como conduziremos testes de ponta a ponta? <br></li><li>  Como conduziremos o teste de estresse do novo servi√ßo? <br></li><li>  Como vamos guardar segredos? <br></li><li>  Integra√ß√£o de CI / CD? <br></li></ul><br>  Recentemente, desenvolvemos um novo mecanismo de pesquisa para o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BNEF</a> .  Foi maravilhoso trabalhar nisso, organizei um desenvolvimento local e descobri o DPG (pacotes e sua implanta√ß√£o), cobrando a implanta√ß√£o de segredos. <br><br>  Quem pensaria que implantar segredos em um prod pode ser t√£o trivial: <br><br><ol><li>  Eles n√£o podem ser colocados no c√≥digo, porque algu√©m pode not√°-los <br></li><li>  Para armazen√°-los como uma vari√°vel de ambiente, pois a especifica√ß√£o oferece 12 fatores de aplica√ß√£o?  N√£o √© uma m√° id√©ia, mas como coloc√°-los l√°?  (Ir ao produto para preencher vari√°veis ‚Äã‚Äãde ambiente toda vez que o carro d√° partida √© uma dor) <br></li><li>  Implant√°-los como arquivos?  Mas de onde eles vir√£o e como preench√™-los? <br></li></ol><br>  N√£o queremos fazer tudo manualmente. <br><br>  Como resultado, chegamos a um banco de dados com controle de acesso baseado em fun√ß√£o (somente n√≥s e nossos computadores podemos nos comunicar com o banco de dados).  Nosso c√≥digo recebe segredos do banco de dados na inicializa√ß√£o.  Essa abordagem √© bem replicada dentro da estrutura de ambientes de desenvolvimento, preparo e opera√ß√£o; os segredos s√£o armazenados em bancos de dados apropriados. <br><br>  Novamente, com servi√ßos em nuvem como a AWS, a situa√ß√£o pode ser completamente diferente.  Voc√™ n√£o precisa cuidar de segredos de alguma forma.  Obtenha uma conta para sua fun√ß√£o, insira os segredos na interface e seu c√≥digo os encontrar√° quando forem necess√°rios.  Isso simplifica muito tudo, mas estou feliz por ter adquirido experi√™ncia, gra√ßas √† qual posso apreciar essa simplicidade. <br><br><a name="10"></a><h4>  Criamos arquitetura, sem esquecer a manuten√ß√£o </h4><br>  O design do sistema √© inspirador.  E a escolta?  N√£o √© demais.  Minha jornada pelo mundo das escoltas me levou √† pergunta: por que e como os sistemas se degradam?  A primeira parte da resposta n√£o est√° relacionada ao descomissionamento de todos os obsoletos, mas apenas √† adi√ß√£o de um novo.  A tend√™ncia de adicionar e n√£o excluir (isso n√£o lembra nada?).  A segunda parte √© projetar com o objetivo final em mente.  Um sistema que, com o tempo, come√ßa a fazer o que n√£o foi planejado, n√£o funcionar√° necessariamente, assim como um sistema originalmente projetado para as mesmas tarefas.  Esta √© uma abordagem de estilo de retrocesso, n√£o truques e truques. <br><br>  Conhe√ßo pelo menos tr√™s maneiras de reduzir a taxa de degrada√ß√£o. <br><br><ol><li>  L√≥gica e infraestrutura de neg√≥cios separadas: a infraestrutura geralmente se degrada - a carga aumenta, as estruturas se tornam obsoletas, as vulnerabilidades de dia zero aparecem etc. <br></li><li>  Crie processos para suporte futuro.  Aplique as mesmas atualiza√ß√µes para bits antigos e novos.  Isso evitar√° diferen√ßas entre o antigo e o novo e manter√° todo o c√≥digo em um estado "moderno". <br></li><li>  Certifique-se de jogar fora tudo o que √© desnecess√°rio e antigo. <br></li></ol><br><a name="11"></a><h2>  Implanta√ß√£o </h2><br>  Vou reunir os recursos ou implant√°-los um de cada vez?  Dependendo do processo atual, se voc√™ junt√°-los, aguarde problemas.  Pergunte a si mesmo por que voc√™ deseja agrupar recursos? <br><br><ul><li>  A implanta√ß√£o leva muito tempo? <br></li><li>  A revis√£o de c√≥digo n√£o √© muito divertida? <br></li></ul><br>  Seja qual for o motivo, essa situa√ß√£o precisa ser corrigida.  Conhe√ßo pelo menos dois problemas associados √† embalagem: <br><br><ol><li>  Voc√™ mesmo bloqueia todos os recursos se um deles tiver um bug. <br></li><li>  Voc√™ aumenta o risco de problemas. <br></li></ol><br>  Qualquer que seja o processo de implanta√ß√£o escolhido, voc√™ sempre quer que seus carros sejam como gado, n√£o como animais de estima√ß√£o.  Eles n√£o s√£o √∫nicos.  Voc√™ sabe exatamente o que √© executado em cada m√°quina, como recri√°-los em caso de morte.  Voc√™ n√£o ficar√° chateado se algum carro morrer, basta pegar um novo.  Voc√™ as pasta, n√£o cresce. <br><br><a name="12"></a><h2>  Quando algo der errado </h2><br>  Caso algo d√™ errado - e aconte√ßa -, existe uma regra de ouro: minimizar o impacto nos clientes.  Em caso de falhas, meu primeiro desejo sempre foi corrigi-lo.  Esta n√£o parece ser a solu√ß√£o ideal.  Em vez de consertar, mesmo que isso possa ser feito em uma linha, voc√™ precisa reverter primeiro.  Retorne ao estado operacional anterior.  Essa √© a maneira mais r√°pida de retornar os clientes para uma vers√£o funcional.  S√≥ ent√£o eu descubro qual √© o problema e o soluciono. <br><br>  O mesmo se aplica √† m√°quina "danificada" no seu cluster: desligue-a e marque-a como inacess√≠vel, antes de descobrir o que aconteceu com ela.  Acho estranho o quanto meus desejos e instintos naturais contradizem a solu√ß√£o √≥tima. <br><br>  Eu acho que esse instinto tamb√©m levou ao fato de eu corrigir bugs por mais tempo.  √Äs vezes, percebi que algo n√£o funcionava, porque o c√≥digo que escrevi estava de alguma forma errado e subi na natureza, olhando cada linha.  Algo como uma pesquisa "primeiro em profundidade".  E quando se descobriu que o problema surgiu devido a uma altera√ß√£o na configura√ß√£o, ou seja, eu n√£o o verifiquei em primeiro lugar, essa situa√ß√£o me perturbou.  Eu perdi muito tempo procurando por um bug. <br><br>  Desde ent√£o, aprendi a pesquisar ‚Äúprimeiro em profundidade‚Äù e, portanto, j√° ‚Äúprimeiro em profundidade‚Äù para excluir raz√µes de n√≠vel superior.  O que exatamente posso confirmar com os recursos atuais? <br><br><ul><li>  O carro funciona? <br></li><li>  O c√≥digo est√° instalado corretamente? <br></li><li>  Existe uma configura√ß√£o? <br></li><li>  &lt;Configura√ß√£o espec√≠fica do c√≥digo&gt;, como se o roteamento est√° escrito corretamente? <br></li><li>  A vers√£o do esquema est√° correta? <br></li><li>  E ent√£o eu mergulho no c√≥digo. <br></li></ul><br><blockquote>  Achamos que o nginx foi instalado incorretamente, mas acabou que a configura√ß√£o estava desativada </blockquote><br>  Claro, eu n√£o preciso fazer isso o tempo todo.  √Äs vezes, apenas uma mensagem de erro √© suficiente para chegar ao c√≥digo imediatamente.  Quando n√£o consigo determinar a causa, tento minimizar o n√∫mero de altera√ß√µes no c√≥digo para descobrir o motivo.  Quanto menos altera√ß√µes, mais r√°pido posso encontrar a verdadeira raiz do problema.  Al√©m disso, agora tenho um memorando para bugs que me salvou mais de uma hora pensando "do que eu perdi?"  √Äs vezes, esque√ßo as verifica√ß√µes mais simples, como configura√ß√£o de roteamento, esquema correspondente e vers√µes de servi√ßo, etc.  Esse √© outro passo no desenvolvimento da pilha de tecnologia que eu uso, e o que voc√™ ganha apenas com experi√™ncia √© a intui√ß√£o para determinar o que exatamente n√£o funciona. <br><br><a name="13"></a><h4>  Bicicleta </h4><br>  Este artigo n√£o pode ser conclu√≠do sem uma hist√≥ria.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu gosto de l√™-los e quero compartilhar um deles com voc√™. </font><font style="vertical-align: inherit;">Esta √© uma hist√≥ria sobre pesquisa e SQLAlchemy. </font><font style="vertical-align: inherit;">Existem muitos analistas no BNEF que escrevem relat√≥rios de pesquisa. </font><font style="vertical-align: inherit;">Quando o relat√≥rio √© publicado, recebemos uma mensagem. </font><font style="vertical-align: inherit;">Quando recebemos uma mensagem, acessamos o banco de dados por meio do SQLAlchemy, obtemos os dados necess√°rios, os convertemos e os enviamos para indexa√ß√£o em uma inst√¢ncia do Solr. </font><font style="vertical-align: inherit;">E de alguma forma um bug estranho surgiu. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todas as manh√£s, a conex√£o com o banco de dados travava com o erro "O servidor MYSQL desapareceu". </font><font style="vertical-align: inherit;">√Äs vezes isso acontecia durante o dia. </font><font style="vertical-align: inherit;">Os carros ligam durante o dia, ent√£o essa foi a primeira coisa que verifiquei. </font><font style="vertical-align: inherit;">N√£o, n√£o houve erro ao ligar o computador. </font><font style="vertical-align: inherit;">Fizemos milhares de consultas ao banco de dados durante o dia, estava tudo em ordem. </font><font style="vertical-align: inherit;">Ent√£o, qual √© o problema que levou ao fracasso?</font></font><br><br>  ,      ?     ,      ,       .     ,         ,      <code>__exit__()</code>  <code>session.close()</code> . <br><br>     ,  ,    .             .          .      .    . <br><br> <code>Session.close()</code>  MySQL- SQLAlchemy      ,    NullPool.   . ,      ,           .      :     StackOverflow (,   !)     ,   ,     SQL- .       ,       .  ,        ,     (),     . <br><br>    ¬´¬ª  ,      1   8.   ,   ,       ‚Äî          . <br><br><blockquote>     ,      . </blockquote><br><a name="14"></a><h2>  Monitoramento </h2><br>  ,       .  ,         ,      .    ,      . <br><br>    ,      ,      ,      .     ,      .  ,      . ¬´ <i>  ?!        ,  ?</i> ¬ª. <br><br>  ,      : ,   .   ,   ,  .  ,     ,     .     ,       .     ‚Äî     ? ,   ,   .          .  ,     -,     ,    ,   ,  ,  ..        . <br><br>      .    ,     ,     ?          (,    AWS CloudWatch  Grafana).            . <br><br>        .       ,      ,       50 %,       ‚Äî   .    ?   .     ,    ‚Äî      (, ?). <br><br>        .   ,      ,  ,    ,      ?   ?    ,    ? <br><br>    ,   .      ,    .      ‚Äî    -  . <br><br><a name="15"></a><h2>  Conclus√£o </h2><br>      .  ,     ,       ,     .   ,      - ! <br><br>        . ,    ! <br><br><blockquote>     ,        .     ,                ‚Äî <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">How to Build Good Software</a> . </blockquote><br><a name="16"></a><h2>      </h2><br>        .       :     !     ,         . <br><br><ol><li>    ? <br></li><li>          ? ,    ?    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">,   </a> ? <br></li><li>   .       ,      ?    ? <br></li><li>     (utils) (,     ,   ,  )  ,   ¬´ ¬ª? <br></li><li>         ? <br></li><li>    ,  ,  -  ? <br></li><li>   ‚Äî      API    ,         ? <br></li><li>    ?  ,     . <br></li><li>     ,   ,  .  ,   ,       . <br></li><li>      PR: ¬´      ,    ,     52 ,  , ,  ,     ,   ¬ª.    ? <br></li><li>    .        ? <br></li><li>    ? <br></li><li>     ? <br></li></ol><br><h2>  </h2><br><ol><li><a name="17"></a>     .  ,    ?  - ?    ,    ? <br></li><li><a name="18"></a>    ,        <code>x()</code> , <code>y()</code>  <code>z(),</code>       <code>x()</code> , <code>y()</code>  <code>z()</code> .  ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">WYSIATI</a> . <br></li><li><a name="19"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> .</a> <br></li><li><a name="20"></a>       .      ,   ? <br></li><li><a name="21"></a>  ,    - ,      ,     .   ,   . <br></li><li><a name="22"></a>     ,    ,       Docker-  AWS. <br></li><li><a name="23"></a>         . <br></li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt465561/">https://habr.com/ru/post/pt465561/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt465547/index.html">Guia SQL: Como escrever consultas melhor (parte 1)</a></li>
<li><a href="../pt465551/index.html">Resumo dos eventos de TI de setembro (parte um)</a></li>
<li><a href="../pt465553/index.html">Linguagem de programa√ß√£o √ú. Introdu√ß√£o, motiva√ß√£o para criar, objetivos</a></li>
<li><a href="../pt465555/index.html">12 Soft Skills que tornam os gerentes de projeto de TI impar√°veis</a></li>
<li><a href="../pt465557/index.html">Prazos de Desenvolvimento de Produto</a></li>
<li><a href="../pt465567/index.html">Testando o c√≥digo do SQL Server com tSQLt</a></li>
<li><a href="../pt465569/index.html">Mapa de desenvolvimento para desenvolvedores m√≥veis</a></li>
<li><a href="../pt465571/index.html">Como vender cigarros masculinos para mulheres e fazer selvagens se protegerem: redatores que poderiam</a></li>
<li><a href="../pt465573/index.html">Todo o poder do IntelliJ IDEA no exemplo de um idioma (nas imagens)</a></li>
<li><a href="../pt465575/index.html">Opera√ß√µes de compara√ß√£o em C ++ 20</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>