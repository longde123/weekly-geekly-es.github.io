<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úäüèº üë©üèø‚Äçü§ù‚Äçüë©üèº üå™Ô∏è De la demande de pool √† la lib√©ration. Signaler Yandex.Taxi üå¨Ô∏è üÖøÔ∏è üõÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il y a une p√©riode critique dans le cycle de publication d'un service - du moment o√π une nouvelle version est pr√©par√©e au moment o√π elle devient dispo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>De la demande de pool √† la lib√©ration. Signaler Yandex.Taxi</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/439704/">  Il y a une p√©riode critique dans le cycle de publication d'un service - du moment o√π une nouvelle version est pr√©par√©e au moment o√π elle devient disponible pour les utilisateurs.  Les actions d'√©quipe entre ces deux points de contr√¥le doivent √™tre coh√©rentes d'une version √† l'autre et, si possible, automatis√©es.  Dans son rapport, l'alb√©riste Sergey Pomazanov <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">a</a> d√©crit les processus qui suivent chaque demande de pool Yandex.Taxi. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/1_j72yHvXUw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - Bonsoir!  Je m'appelle Sergey, je suis le chef du groupe d'automatisation chez Yandex.Taxi.  En bref, la t√¢che principale de notre groupe est de minimiser le temps que les d√©veloppeurs passent √† r√©soudre leurs probl√®mes.  Cela comprend tout, du CI aux processus de d√©veloppement et de test. <br><br>  Que fait notre d√©veloppement lorsque le code est √©crit? <br><br><a name="habracut"></a>  Pour tester la nouvelle fonctionnalit√©, nous v√©rifions d'abord tout localement.  Pour les tests locaux, nous avons un large √©ventail de tests.  Si un nouveau code appara√Æt, il doit √©galement √™tre couvert par des tests. <br><br><img src="https://habrastorage.org/webt/cy/lr/el/cylrel5kfrii-dvrh7wvpbgh6fw.jpeg"><br><br>  Notre couverture de test n'est pas aussi bonne que nous le souhaiterions, mais nous essayons de la maintenir √† un niveau suffisant. <br><br>  Pour les tests, nous utilisons Google Test et un framework de pytest auto-√©crit, avec lequel nous testons non seulement la partie "python", mais aussi la partie "plus".  Notre cadre vous permet de d√©marrer des services, de t√©l√©charger des donn√©es dans la base de donn√©es avant chaque test, de mettre √† jour les caches, d'effacer toutes les demandes externes, etc. Un cadre suffisamment fonctionnel qui vous permet d'ex√©cuter tout ce que vous voulez, de verrouiller tout pour que nous n'obtenions aucun accident demandes √† l'ext√©rieur. <br><br>  En plus des tests fonctionnels, nous avons des tests d'int√©gration.  Ils vous permettent de r√©soudre un autre probl√®me.  Si vous n'√™tes pas s√ªr que votre service interagira correctement avec d'autres services, vous pouvez ex√©cuter le stand et ex√©cuter un ensemble de tests.  Jusqu'√† pr√©sent, nous avons un ensemble de tests de base, mais il se d√©veloppe lentement. <br><br>  Le stand est construit sur la technologie de Docker et Docker Compose, o√π chaque conteneur a ses propres services, et ils interagissent tous les uns avec les autres.  Cela se produit dans un environnement isol√©.  Ils ont leur propre r√©seau isol√©, leur propre base de donn√©es, leur propre ensemble de donn√©es.  Et les tests r√©ussissent de la sorte, comme si quelqu'un lance une application mobile, clique sur des boutons, passe une commande.  En ce moment, les voitures virtuelles conduisent, am√®nent le passager, puis l'argent est d√©bit√© du passager, etc.  Fondamentalement, tous les tests n√©cessitent l'interaction de nombreux services et composants √† la fois. <br><br>  Naturellement, nous testons uniquement nos services et uniquement nos composants, car nous ne devons pas tester les services externes, et nous mouillons tout ce qui est externe. <br><br>  Le stand √©tait assez pratique pour courir localement et en sortir un taxi de poche.  Vous pouvez prendre cette position, l'ex√©cuter sur une machine locale ou sur une machine virtuelle ou toute autre machine de d√©veloppement.  Apr√®s avoir lanc√© le stand, vous pouvez prendre une application mobile adapt√©e pour un taxi de poche, la configurer sur votre ordinateur et passer des commandes.  Tout est exactement le m√™me qu'en production ou ailleurs.  Si vous avez besoin de tester la nouvelle fonctionnalit√©, vous pouvez simplement glisser votre code, il reprendra et fonctionnera dans tout l'environnement. <br><br>  Encore une fois, vous pouvez simplement prendre et ex√©cuter le service souhait√©.  Pour ce faire, vous devez augmenter la base de donn√©es, la remplir avec le contenu n√©cessaire ou prendre une base dans des environnements existants et la connecter au service.  Et puis vous pouvez simplement le contacter, faire quelques requ√™tes, voir si cela fonctionne correctement ou non. <br><br>  Un autre point important est la v√©rification de style.  Si tout est simple pour les ¬´plus¬ª, nous utilisons le format clang et v√©rifions si le code le correspond ou non, alors pour Python nous utilisons jusqu'√† quatre analyseurs: Flake8, Pylint, Mypy et, semble-t-il, autopep8. <br><br>  Nous utilisons ces analyseurs principalement dans la livraison standard.  S'il est possible de choisir un style de conception, nous utilisons le style Google.  La seule chose que nous avons corrig√©e en ajoutant la n√¥tre est une v√©rification du tri des importations afin que les importations soient tri√©es correctement. <br><br>  Apr√®s avoir cr√©√© le code, v√©rifi√© localement, vous pouvez faire une demande de pool.  Les demandes de pool sont cr√©√©es sur GitHub. <br><br><img src="https://habrastorage.org/webt/dx/sj/ac/dxsjacymhqczij9ourzfrtnxai0.jpeg"><br><br>  La cr√©ation d'une demande de pool sur GitHub offre de nombreuses opportunit√©s que TeamCity nous offre.  TeamCity ex√©cute automatiquement tous les tests mentionn√©s ci-dessus, les v√©rifie automatiquement et dans la demande de pool elle-m√™me, il est √©crit sur l'√©tat du passage, que les tests aient r√©ussi ou non.  Autrement dit, sans visiter TeamCity, vous pouvez voir si elle a r√©ussi ou non, et en cliquant sur le lien pour comprendre ce qui s'est mal pass√© et ce qui doit √™tre corrig√©. <br><br>  Si vous n'avez pas assez de taxis de poche et de tests, vous voulez v√©rifier l'interaction r√©elle avec un service r√©el, nous avons un environnement de test qui r√©p√®te la production.  Nous avons deux de ces environnements de test.  Le premier est destin√© au d√©veloppement mobile des testeurs et le second aux d√©veloppeurs.  L'environnement de test est aussi proche que possible de la production, et si des demandes sont adress√©es √† des services externes, elles le sont √©galement √† partir d'environnements de test.  La seule limitation est que l'environnement de test est mis √† l'essai des ressources externes chaque fois que possible.  Et l'environnement de production entre en production. <br><br>  Pour en savoir plus sur l'environnement de test, nous le faisons tout simplement via TeamCity.  Il est n√©cessaire de mettre l'√©tiquette appropri√©e sur GitHub, et une fois qu'il est d√©fini, cliquez sur le bouton "Collecter personnalis√©".  Nous l'appelons donc.  Ensuite, toutes les demandes de pool avec cette √©tiquette se poursuivront, puis l'assemblage automatique des packages avec le clustering commencera. <br><br>  En plus des tests de routine, des tests de charge sont parfois requis.  Si vous modifiez du code faisant partie d'un service tr√®s charg√©, nous pouvons effectuer des tests de chargement pour cela.  En Python, il existe peu de services tr√®s charg√©s, certains d'entre eux ont √©t√© r√©√©crits en C ++, mais n√©anmoins, ils restent, parfois il y a de la place pour √™tre.  Les tests de charge ont lieu via le syst√®me Lunapark.  Il utilise Yandex.Tank, il est disponible gratuitement, vous pouvez le t√©l√©charger et le regarder.  Le r√©servoir vous permet de tirer sur certains services, de cr√©er des graphiques, d'effectuer diff√©rentes m√©thodes de chargement et de montrer quelle charge √©tait actuellement sur le service et quelles ressources il a utilis√©es.  Il suffit de cliquer sur le bouton via TeamCity, le colis sera r√©cup√©r√©, puis il sera possible de le rouler si n√©cessaire.  Ou remplissez-le simplement et ex√©cutez-le manuellement. <br><br><img src="https://habrastorage.org/webt/a5/ny/uu/a5nyuuqz_opgjup2cr5mjqcweqc.jpeg"><br><br>  Pendant que vous testez votre code, l'un des d√©veloppeurs peut √† ce moment commencer √† regarder votre code et √† proc√©der √† sa r√©vision. <br><br>  Ce √† quoi nous pr√™tons attention dans le processus: <br><br><img src="https://habrastorage.org/webt/cy/ul/h3/cyulh3bd1lfyhcraxx3x6gtdccm.jpeg"><br><br>  L'un des points importants - la fonctionnalit√© doit √™tre d√©sactiv√©e.  Cela signifie que quel que soit le code, il y avait des bogues ou non, peut-√™tre que cette fonctionnalit√© ne fonctionne pas comme pr√©vu √† l'origine, peut-√™tre que les gestionnaires voulaient autre chose, ou peut-√™tre que cette fonctionnalit√© essayait de mettre un autre service qui n'√©tait pas pr√™t √† de nouvelles charges, et vous devez pouvoir l'√©teindre rapidement et mettre tout dans un √©tat normal. <br><br>  Nous avons √©galement une r√®gle selon laquelle lors du d√©ploiement de nouvelles fonctionnalit√©s, elles doivent √™tre d√©sactiv√©es et activ√©es uniquement apr√®s leur d√©ploiement dans tous les clusters et tous les centres de donn√©es. <br><br>  N'oubliez pas que nous avons une API utilis√©e par les applications mobiles qui peuvent ne pas √™tre mises √† jour pendant longtemps.  Si nous apportons des modifications incompatibles dans notre API, certaines applications peuvent tomber en panne et nous ne pouvons pas forcer toutes les applications √† simplement t√©l√©charger et mettre √† jour.  Cela affectera n√©gativement notre r√©putation.  Par cons√©quent, toutes les nouvelles fonctionnalit√©s doivent √™tre r√©trocompatibles.  Cela s'applique non seulement √† l'API externe, mais √©galement √† l'API interne, car vous ne pouvez pas d√©ployer simultan√©ment tout le code vers tous les centres de donn√©es, toutes les machines, tous les clusters.  Dans tous les cas, l'ancien code et le nouveau cohabiteront avec nous en m√™me temps.  Par cons√©quent, nous obtenons des requ√™tes qui ne peuvent pas √™tre trait√©es quelque part et nous aurons des erreurs. <br><br>  Vous devriez √©galement penser √† la chose suivante: si soudainement votre code ne fonctionne pas ou si vous avez √©crit un nouveau microservice dans lequel il y a des probl√®mes potentiels, vous devez √™tre pr√©par√© aux cons√©quences et √™tre capable de se d√©grader.  Mon coll√®gue en parlera lors de la prochaine pr√©sentation. <br><br>  Si vous modifiez des services hautement charg√©s et que vous n'avez pas √† attendre la fin de certaines op√©rations, vous pouvez effectuer certaines t√¢ches de mani√®re asynchrone quelque part en arri√®re-plan ou en tant que processus distinct.  Il vaut mieux le faire de cette fa√ßon, car un processus distinct a moins d'impact sur la production et le syst√®me fonctionnera globalement plus stable. <br><br><img src="https://habrastorage.org/webt/4f/gt/l2/4fgtl2iijso_y_j8ecaekyi_aik.jpeg"><br><br>  Il est √©galement important que toutes les donn√©es que nous recevons de l'ext√©rieur, nous ne devons pas leur faire confiance, nous devons les valider, les v√©rifier d'une mani√®re ou d'une autre, etc. Toutes les donn√©es que nous avons doivent √™tre divis√©es en groupes que nous avons form√©s ou des donn√©es brutes qui n'ont pas √©t√© valid√©es.  Cela inclut toutes les donn√©es qui pourraient potentiellement √™tre obtenues √† partir d'autres services externes ou directement aupr√®s des utilisateurs, car tout pourrait potentiellement venir.  Peut-√™tre que quelqu'un a sp√©cialement envoy√© une demande malveillante, et tout devrait √™tre v√©rifi√© avec nous. <br><br><img src="https://habrastorage.org/webt/zn/vn/q4/znvnq49zowpwiono0al7g6eczde.jpeg"><br><br>  Il existe encore des cas o√π, sur demande, le service peut ne pas r√©pondre au bon moment.  Peut-√™tre que la connexion s'est rompue ou que quelque chose s'est mal pass√©, il peut y avoir de nombreuses situations.  L'application mobile ne sait pas ce qui s'est finalement pass√©, fait juste une nouvelle demande. <br><br>  Il est tr√®s important que, dans le processus de ces nouvelles demandes, quel que soit le nombre, au final, tout fonctionne comme pr√©vu √† l'origine avec une seule demande.  Nous ne devons pas avoir d'effets sp√©ciaux.  Il faut √©galement garder √† l'esprit que nous avons plus d'un service, nous avons de nombreuses machines, de nombreux centres de donn√©es, nous avons des bases distribu√©es et des courses sont possibles pour tout le monde.  Le code doit √™tre √©crit de fa√ßon √† ce qu'il s'ex√©cute √† plusieurs endroits en m√™me temps afin que nous n'ayons pas de courses. <br><br>  Un point tout aussi important est la capacit√© de diagnostiquer les probl√®mes.  Les probl√®mes existent toujours, en tout, et vous devez comprendre o√π ils se sont produits.  Dans une situation id√©ale, l'existence du probl√®me n'a pas √©t√© apprise par le service d'assistance, mais par le suivi.  Et en analysant certaines situations, nous pourrions √©ventuellement comprendre ce qui s'est pass√© en lisant simplement les journaux sans lire le code.  M√™me la personne qui n'a jamais vu le code, de sorte que par les journaux √† la fin, il pourrait l'obtenir. <br><br>  Et dans le cas id√©al, si la situation est tr√®s compliqu√©e, vous devez √™tre en mesure de v√©rifier par les journaux dans quelle direction le programme s'est finalement d√©roul√©, et ce qui est arriv√© pour simplifier consid√©rablement le d√©briefing.  Parce que la situation est all√©e √† la suite dans le pass√©, et maintenant il est peu probable qu'elle puisse se reproduire, il n'y a d√©j√† pas de donn√©es ou d'autres donn√©es ou d'autres situations. <br><br>  Si vous effectuez de nouvelles op√©rations dans la base de donn√©es ou en cr√©ez une nouvelle, vous devez consid√©rer qu'il peut y avoir beaucoup de donn√©es.  Vous allez peut-√™tre √©crire un nombre infini d'enregistrements dans cette base de donn√©es, et si vous ne pensez pas √† les archiver, il peut y avoir des probl√®mes, la base de donn√©es commencera simplement √† se d√©velopper ind√©finiment, et il n'y aura plus de ressources, pas de disques et de partitionnement.  Il est important de pouvoir archiver les donn√©es et de stocker uniquement les donn√©es op√©rationnelles n√©cessaires pour le moment.  Et il est √©galement n√©cessaire d'effectuer des requ√™tes d'index sur toutes les bases de donn√©es.  Une requ√™te non index√©e peut mettre toute la production.  Une petite demande √† la collection centrale la plus charg√©e peut tout mettre.  Vous devez √™tre tr√®s prudent. <br><br>  Nous n'acceptons pas les optimisations pr√©matur√©es.  Si quelqu'un essaie de faire une sorte d'usine une m√©thode tr√®s universelle qui g√®re potentiellement les cas pour l'avenir, peut-√™tre qu'un jour quelqu'un voudra l'√©tendre - ce n'est pas notre coutume, car il est possible qu'elle se d√©veloppe ce sera compl√®tement faux, et peut-√™tre que ce code finira par √™tre enterr√©, ou peut-√™tre que tout cela n'est pas n√©cessaire, mais complique seulement la lecture et la compr√©hension du code.  Parce que lire et comprendre le code est tr√®s important.  Il est important que le code soit tr√®s simple et facile. <br><br>  Si vous ajoutez une nouvelle base de donn√©es dans votre code ou apportez une modification √† l'API, nous avons une documentation qui est partiellement g√©n√©r√©e √† partir du code, partiellement r√©alis√©e sur le Wiki.  Ces informations sont importantes pour rester √† jour.  Sinon, cela peut induire quelqu'un en erreur ou causer des probl√®mes √† d'autres d√©veloppeurs.  Parce que le code est √©crit seul, mais il est beaucoup pris en charge. <br><br>  Une partie importante est le respect du style g√©n√©ral.  L'essentiel dans ce cas est l'uniformit√©.  Lorsque tout le code est √©crit de mani√®re uniforme, il est facile √† comprendre, facile √† lire et vous n'avez pas besoin de vous plonger dans tous les d√©tails et nuances.  Un code uniform√©ment √©crit peut acc√©l√©rer le processus de d√©veloppement entier potentiellement √† l'avenir. <br><br>  Un autre point que nous ne v√©rifions pas sp√©cifiquement pour les avis est que nous ne recherchons pas de bugs.  Parce que l'auteur doit √™tre engag√© dans la recherche de bugs.  S'il y a des bogues lors de la r√©vision, bien s√ªr, ils √©criront √† ce sujet, mais il ne devrait pas y avoir de recherche cibl√©e, c'est enti√®rement la responsabilit√© de la personne qui √©crit le code. <br><br>  De plus, lorsque votre code est √©crit, la r√©vision est termin√©e, vous √™tes pr√™t √† le geler, mais il arrive souvent que vous deviez effectuer des actions suppl√©mentaires, migrer vers la base de donn√©es. <br><br><img src="https://habrastorage.org/webt/2x/-5/s7/2x-5s7zzkdpr8vdacojgjcsayzy.jpeg"><br><br>  Pour les migrations, nous √©crivons un script Python qui peut communiquer avec le backend.  Le backend, quant √† lui, est connect√© √† toutes nos bases et peut effectuer toutes les op√©rations n√©cessaires.  Le script est lanc√© via le panneau d'administration de lancement de script, puis il est ex√©cut√©, vous pouvez voir son journal et ses r√©sultats.  Et si vous avez besoin d'op√©rations de faisceau √† long terme, vous ne pouvez pas tout mettre √† jour en m√™me temps, vous devez le faire avec des morceaux de 1000 √† 10000 avec quelques pauses, afin de ne pas accidentellement mettre la base avec ces op√©rations. <br><br><img src="https://habrastorage.org/webt/kc/tc/i4/kctci40g68ovk-1jywdr7is2h9u.jpeg"><br><br>  Lorsque le code est √©crit, r√©vis√©, test√©, toutes les migrations sont effectu√©es, vous pouvez le fusionner en toute s√©curit√© dans GitHub et continuer √† le publier. <br><br>  Pour certains services, nous avons une r√©glementation selon laquelle nous devons d√©ployer √† un certain moment, mais une partie importante des services que nous pouvons d√©ployer √† tout moment. <br><br>  Tout cela se fait avec TeamCity. <br><br><img src="https://habrastorage.org/webt/uy/5q/hs/uy5qhsjjmwkjkdigex_wgykubfw.jpeg"><br><br>  Tout commence par la construction de packages.  TeamCity ne git flow ou son apparence.  Nous nous √©loignons lentement de Git Flow vers nos meilleures pratiques, qui nous semblaient plus pratiques.  TeamCity produit tout cela, collecte les paquets, les remplit.  Nous attendons plus loin lorsque les tests passeront sur ces packages.  La r√©ussite des tests est n√©cessaire pour d√©ployer la version.  Si les tests √©chouent, vous devez d'abord le comprendre et voir ce qui a finalement mal tourn√©.  Les tests utilis√©s sont les m√™mes, r√©guliers et d'int√©gration.  Ils v√©rifient le paquet d√©j√† assembl√©, pr√™t, exactement ce qui va entrer en production.  C'est juste au cas o√π, soudainement, il y a des probl√®mes dans le paquet assembl√©, tout √† coup quelque chose n'est pas copi√©, tout √† coup quelque chose s'est av√©r√© √™tre manquant. <br><br>  Il est √©galement n√©cessaire de cr√©er un ticket de sortie dans notre tracker, o√π chaque d√©veloppeur doit se d√©sabonner de la fa√ßon dont il a test√© ce code, et il doit contenir toutes les t√¢ches qui doivent √™tre effectu√©es. <br><br>  Cela se fait √©galement automatiquement dans TeamCity, qui passe par la liste des commits.  Nous avons exig√© que dans chaque commit, il y ait un mot-cl√© ¬´Relates¬ª suivi du nom de la t√¢che.  Un script √©crit en Python passe automatiquement par tout cela, compile une liste de t√¢ches qui ont √©t√© r√©solues, forme une liste d'auteurs et cr√©e un ticket de version, exhortant tous les auteurs √† se d√©sabonner de leurs tests et √† confirmer qu'ils sont pr√™ts √† "aller" dans la version. <br><br><img src="https://habrastorage.org/webt/mz/hn/7t/mzhn7t86z09-ewjvhdyr-kvqr44.jpeg"><br><br>  Lorsque tout le monde est pr√™t, les confirmations sont collect√©es, puis le d√©ploiement a lieu, d'abord - dans la pr√©-√©curie.  Il s'agit d'une petite partie de la production.  Pour chaque service, plusieurs centres de donn√©es sont utilis√©s, dans chaque centre de donn√©es il peut y avoir plusieurs machines.  L'une des machines est une pr√©-stable et le code n'est d√©ploy√© en premier que sur une ou deux machines. <br><br>  Lorsque le code est d√©gonfl√©, nous suivons les graphiques, les journaux et ce qui se passe finalement sur le service.  Si tout va bien, si les graphiques montrent que tout est stable et que tout le monde a v√©rifi√© que sa fonctionnalit√© fonctionne comme il se doit, alors il roule sur le reste de l'environnement, que nous appelons stable.  Lors du d√©ploiement √† l'√©curie, tout est pareil: nous regardons les graphiques, les logs et v√©rifions que tout va bien pour nous. <br><br>  Le d√©ploiement est pass√©, tout va bien.  Et si quelque chose tournait mal, si soudainement des probl√®mes? <br><br><img src="https://habrastorage.org/webt/9r/pd/qk/9rpdqkpeibqn-uud5knv1age12m.jpeg"><br><br>  Nous collectons le correctif.  Cela se fait sur le m√™me principe que git flow, c'est-√†-dire une branche de la branche principale.  Une demande de pool distincte est cr√©√©e √† partir du ma√Ætre, qui effectue des corrections, puis le script lanc√© √† partir de TeamCity la fige, effectue toutes les op√©rations n√©cessaires, collecte tous les packages de la m√™me mani√®re et continue. <br><br><img src="https://habrastorage.org/webt/jc/tq/ep/jctqep5zyjjh3cebljvmvqjoino.jpeg"><br><br>  En fin de compte, je voudrais parler de la direction dans laquelle nous allons.  Nous nous dirigeons vers un r√©f√©rentiel unique, lorsque de nombreux services vivent dans un seul r√©f√©rentiel √† la fois.  Chacun d'eux a des calculs ind√©pendants: dans les tests, dans les versions.  Pour les demandes de pool, m√™me lorsque TeamCity est utilis√©, nous v√©rifions quels fichiers ont √©t√© affect√©s, √† quels services ils appartiennent.  Selon le graphique des d√©pendances, nous d√©terminons quels tests nous devons finalement ex√©cuter et ce qu'il faut v√©rifier.  Nous nous effor√ßons d'isoler au maximum les services les uns des autres.  Jusqu'√† pr√©sent, cela ne fonctionne pas tr√®s bien, mais nous nous effor√ßons de le faire pour que de nombreux services puissent vivre dans un r√©f√©rentiel, avoir un code commun, et que cela ne cause pas de probl√®mes et simplifie la vie du d√©veloppement.  C'est tout, merci √† tous. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr439704/">https://habr.com/ru/post/fr439704/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr439692/index.html">AT&T poursuivi pour avoir chang√© l'ic√¥ne du r√©seau de 4G en 5G E</a></li>
<li><a href="../fr439694/index.html">Tissus intelligents sensibles aux changements de temp√©rature corporelle</a></li>
<li><a href="../fr439696/index.html">Sur la cr√™te d'une vague, ou "je veux int√©grer" - mais √ßa vaut le coup?</a></li>
<li><a href="../fr439698/index.html">Introduction √† la programmation: un simple jeu de tir 3D √† partir de z√©ro au cours du week-end, partie 1</a></li>
<li><a href="../fr439700/index.html">Brevet de jeu de soci√©t√© en Russie</a></li>
<li><a href="../fr439706/index.html">Conf√©rence BLACK HAT. Le√ßons de survivre √† une attaque DDOS de 300 Gb / s. Partie 1</a></li>
<li><a href="../fr439708/index.html">Conf√©rence BLACK HAT. Le√ßons de survivre √† une attaque DDOS de 300 Gb / s. 2e partie</a></li>
<li><a href="../fr439710/index.html">Caract√©ristiques de la cr√©ation de produits pour le march√© am√©ricain</a></li>
<li><a href="../fr439712/index.html">March√©s publics: l'√©quilibre entre la gr√®ve italienne et le criminel russe</a></li>
<li><a href="../fr439714/index.html">Les Russes chez Apple: comment le n√¥tre a obtenu un contrat de plusieurs millions avec les Beatles et des chansons de ¬´certains Jerry¬ª</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>