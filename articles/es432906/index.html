<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úÇÔ∏è üëäüèº ü•Å Edici√≥n de archivos CSV para no romper datos ‚ôüÔ∏è üôåüèø üóúÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Los productos de HFLabs en vol√∫menes industriales procesan datos: direcciones, nombres completos, detalles de la compa√±√≠a e incluso un carro en total....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Edici√≥n de archivos CSV para no romper datos</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hflabs/blog/432906/"><img src="https://habrastorage.org/webt/xr/j1/ia/xrj1ia0lo_magqpxw2sr51g-9dg.jpeg"><br><br>  Los productos de HFLabs en vol√∫menes industriales procesan datos: direcciones, nombres completos, detalles de la compa√±√≠a e incluso un carro en total.  Naturalmente, los probadores manejan estos datos todos los d√≠as: actualice los casos de prueba, estudie los resultados de la limpieza.  A menudo, los clientes dan una base "en vivo" al probador para configurar el servicio. <br><br>  Lo primero que ense√±amos a los nuevos QA es guardar los datos en su forma original.  Todo de acuerdo con los pactos: "No hagas da√±o".  En este art√≠culo, le mostrar√© c√≥mo trabajar cuidadosamente con archivos CSV en Excel y Open Office.  Las sugerencias ayudar√°n a no estropear nada, guardar informaci√≥n despu√©s de la edici√≥n y, en general, sentirse m√°s seguro. <br><br>  <i>El material es b√°sico, los profesionales definitivamente se aburrir√°n.</i> <br><a name="habracut"></a><br><h2>  ¬øQu√© son los archivos CSV? </h2><br>  El formato CSV se usa para almacenar tablas en archivos de texto.  Los datos a menudo se empaquetan en tablas, por lo que los archivos CSV son muy populares. <br><br><img src="https://habrastorage.org/webt/ya/z5/vw/yaz5vwq0sruyxaqvir0cnxvu7je.png"><br>  <sub>Un archivo CSV consta de filas de datos y delimitadores que indican los l√≠mites de las columnas.</sub> <br><br>  CSV significa valores separados por comas: "valores separados por comas".  Pero no se deje enga√±ar por el nombre: tanto el punto y coma como las pesta√±as pueden servir como separadores de columna en un archivo CSV.  Seguir√° siendo un archivo CSV. <br><br>  CSV tiene muchas ventajas sobre el mismo formato de Excel: los archivos de texto son simples como un bot√≥n, se abren r√°pidamente, se leen en cualquier dispositivo y en cualquier entorno sin herramientas adicionales. <br><br>  Debido a sus ventajas, el CSV es un formato de intercambio de datos muy popular, aunque ya tiene 40 a√±os. Los CSV utilizan aplicaciones industriales, descargan datos de bases de datos. <br><br>  Un problema: un editor de texto para trabajar con CSV no es suficiente.  A√∫n as√≠, si la tabla es simple: en el primer campo, la ID tiene la misma longitud, en el segundo la fecha tiene el mismo formato y en el tercero hay alguna direcci√≥n.  Pero cuando los campos de diferentes longitudes y hay m√°s de tres, comienza el tormento. <br><br><img src="https://habrastorage.org/webt/cv/lb/mm/cvlbmmwfjujdiowdolcfjgwbiik.png"><br>  <sub>Lleve un registro de los divisores y columnas: rompe los ojos</sub> <br><br>  Peor a√∫n con el an√°lisis de datos: intente Bloc de notas al menos para agregar todos los n√∫meros en una columna.  No estoy hablando de hermosos gr√°ficos. <br><br>  Por lo tanto, los archivos CSV se analizan y editan en Excel y sus an√°logos: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Open Office</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">LibreOffice</a> y otros. <br><br>  <i>Para los veteranos que, sin embargo, leen: chicos, sabemos sobre el an√°lisis directamente en la base de datos usando SQL, sabemos sobre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Tableau</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Talend Open Studio</a> .</i>  <i>Este art√≠culo es para principiantes, pero a nivel b√°sico y una peque√±a cantidad de datos de Excel con an√°logos es suficiente.</i> <br><br>
<h2>  C√≥mo Excel desordena los datos: de los cl√°sicos </h2><br>  Todo estar√≠a bien, pero Excel, apenas abriendo el archivo CSV, comienza sus trucos astutos.  Cambia los datos sin demanda para que pierdan su valor.  Y lo hace completamente desapercibido.  Debido a esto, en un momento tuvimos muchos problemas. <br><br>  La mayor√≠a de los incidentes se deben al hecho de que el programa convierte cadenas con un conjunto de n√∫meros en n√∫meros sin demanda. <br><br>  <b>Redondea</b>  Por ejemplo, en la celda original, dos tel√©fonos se almacenan separados por comas sin espacios: "5235834.5235835".  ¬øQu√© har√° Excel?  Convierte famosos n√∫meros en un n√∫mero y redondea a dos decimales: "5235834.52".  Entonces perdemos el segundo tel√©fono. <br><br>  <b>Lleva a la forma exponencial.</b>  Excel convierte cuidadosamente "123456789012345" al n√∫mero "1,2E + 15".  Perdemos el valor original por completo. <br><br>  El problema es relevante para caracteres largos de quince l√≠neas num√©ricas.  Por ejemplo, c√≥digos CLADR (este es un identificador de estado de un objeto de direcci√≥n: ciudad, calle, casa). <br><br>  <b>Elimina las principales ventajas.</b>  Excel cree que la ventaja al comienzo de una l√≠nea con n√∫meros es un car√°cter completamente superfluo.  Me gusta, y est√° tan claro que el n√∫mero es positivo, ya que no hay un signo menos delante.  Por lo tanto, la ventaja principal en el n√∫mero "+74955235834" se descartar√° como innecesaria: resultar√° "74955235834".  (En realidad, el n√∫mero sufrir√° a√∫n m√°s, pero para mayor claridad, me llevar√© bien con la ventaja). <br><br>  La p√©rdida de un plus es cr√≠tica, por ejemplo, si los datos van a un sistema de terceros, y ese comprueba r√≠gidamente el formato al importar. <br><br>  <b>Desglosa tres d√≠gitos.</b>  Excel es una buena alma que analizar√° una cadena digital de m√°s de tres caracteres.  Por ejemplo, "8 495 5235834" se convertir√° en "84 955 235 834". <br><br>  El formateo es importante al menos para los n√∫meros de tel√©fono: los espacios separan los c√≥digos de pa√≠s y ciudad del resto del n√∫mero y entre s√≠.  Excel viola f√°cilmente la divisi√≥n correcta del tel√©fono. <br><br>  <b>Elimina los ceros a la izquierda.</b>  Excel convertir√° la cadena "00523446" en "523446". <br>  Y en el TIN, por ejemplo, los dos primeros d√≠gitos son el c√≥digo de regi√≥n.  Para la Rep√∫blica de Altai, comienza desde cero - "04".  Sin cero, el significado del n√∫mero se distorsionar√° y la verificaci√≥n del formato INN no pasar√° en absoluto. <br><br>  <b>Cambia las fechas a la configuraci√≥n local.</b>  Excel con gusto corregir√° el n√∫mero de casa "1/2" a "01. febrero".  Debido a que Windows sugiri√≥ que en este formulario, es m√°s conveniente que lea las fechas. <br><br><h2>  Derrotamos la corrupci√≥n de datos mediante la importaci√≥n adecuada </h2><br>  Pero en serio, Excel no tiene la culpa de los problemas, sino una forma no obvia de importar datos al programa. <br><br>  De forma predeterminada, Excel aplica el tipo General a los datos en el archivo CSV descargado, el tipo general.  Por eso, el programa reconoce las cadenas digitales como n√∫meros.  Este orden puede ser derrotado usando la herramienta de importaci√≥n incorporada. <br><br>  <b>Comienzo el mecanismo de importaci√≥n incorporado en Excel.</b>  En el men√∫ es "Datos ‚Üí Obtener datos externos ‚Üí Del texto". <br><br>  <b>Selecciono un archivo CSV con datos, se abre un cuadro de di√°logo.</b>  En el cuadro de di√°logo, hago clic en el tipo de archivo Delimitado (delimitado).  Codificaci√≥n: la del archivo generalmente se determina autom√°ticamente.  Si la primera l√≠nea del archivo es un encabezado, marco "Mis datos tienen encabezados". <br><br>  <b>Paso al segundo paso del di√°logo.</b>  Selecciono el separador de campo (generalmente un punto y coma - punto y coma).  Desactivo "Tratar delimitadores consecutivos como uno" y configuro "Calificador de texto" en "{none}".  (El calificador de texto es un s√≠mbolo del principio y el final del texto. Si el separador en el CSV es una coma, entonces el calificador de texto es necesario para distinguir las comas dentro del texto de las comas del separador). <br><br>  <b>En el tercer paso, elijo el formato de los campos</b> , en aras de todo se inici√≥.  Para todas las columnas establezco el tipo en "Texto".  Por cierto, si hace clic en la primera columna, mantenga presionado el turno y haga clic en la √∫ltima, todas las columnas se resaltar√°n a la vez.  Convenientemente <br><br>  A continuaci√≥n, Excel le preguntar√° d√≥nde pegar los datos del CSV: puede hacer clic en "Aceptar" y los datos aparecer√°n en una hoja abierta. <br><br><img src="https://habrastorage.org/webt/rl/rf/cw/rlrfcwbol_yygemdyub2caobfpk.gif"><br>  <sub>Debe crear un nuevo libro de trabajo en Excel antes de importar</sub> <br><br>  <b>Pero!</b>  <b>Si planeo agregar datos a CSV a trav√©s de Excel, hay algo m√°s que hacer.</b> <br><br>  Despu√©s de la importaci√≥n, es necesario forzar todas las celdas de la hoja al formato "Texto".  De lo contrario, los nuevos campos adquirir√°n el mismo tipo General. <br><br><ul><li>  Presiono Ctrl + A dos veces, Excel selecciona todas las celdas de la hoja; </li><li>  Hago clic con el bot√≥n derecho del mouse; </li><li>  Selecciono "Formatear celdas" en el men√∫ contextual; </li><li>  en el cuadro de di√°logo que se abre, seleccione el tipo de datos de Texto a la izquierda. </li></ul><br><img src="https://habrastorage.org/webt/3s/ux/aw/3suxawbdhnfuj5mokakdb8v6y74.gif"><br>  <sub>Para seleccionar todas las celdas, debe presionar Ctrl + A dos veces.</sub>  <sub>Exactamente dos, esto no es una broma, prueba</sub> <br><br>  Despu√©s de eso, con suerte, Excel dejar√° solo los datos originales.  Pero esta no es la garant√≠a m√°s dif√≠cil, por lo que despu√©s de guardar, definitivamente revisaremos el archivo a trav√©s de un visor de texto. <br><br><h2>  Alternativa: Open Office Calc </h2><br>  Para trabajar con archivos CSV, uso Calc.  No es que no considere los datos digitales como cadenas en absoluto, pero al menos no les aplica el reformateo de acuerdo con la configuraci√≥n regional de Windows.  S√≠, y la importaci√≥n es m√°s simple. <br><br>  Por supuesto, necesitar√° el paquete Open Office (OO).  Durante la instalaci√≥n, ofrecer√° reasignar archivos de MS Office a s√≠ mismo.  No lo recomiendo: aunque OO es bastante funcional, no comprende completamente el complicado formato de documentos de Microsoft. <br><br>  Pero hacer que OO sea el programa predeterminado para los archivos CSV es bastante razonable.  Puede hacer esto despu√©s de instalar el paquete. <br><br>  Entonces, comenzamos la importaci√≥n de datos desde CSV.  Despu√©s de hacer doble clic en el archivo, Open Office muestra un cuadro de di√°logo. <br><br><img src="https://habrastorage.org/webt/xe/uh/zy/xeuhzy60ogakabxxxoiwc8pcdq8.png"><br>  <sub>Tenga en cuenta que en OO no necesita crear un nuevo libro de trabajo y forzar que se inicie la importaci√≥n, todo por s√≠ mismo</sub> <br><br><ol><li>  Codificaci√≥n: como en el archivo. </li><li>  "Separador" es un punto y coma.  Naturalmente, si es precisamente el separador en el archivo. </li><li>  "Separador de texto": vac√≠o (todo lo mismo que en Excel). </li><li>  En la secci√≥n "Campos", hago clic en el cuadrado superior izquierdo de la tabla, todas las columnas est√°n resaltadas.  Indico el tipo de "Texto". </li></ol><br>  Algo que ech√≥ a perder mucha sangre: si selecciona err√≥neamente varios separadores de campo o se divide el texto incorrecto, el archivo puede abrirse correctamente, pero puede guardarse incorrectamente. <br><br>  Adem√°s de Calc, libreOffice es popular en HFLabs, especialmente en Linux.  Ambos se usan m√°s activamente para CSV que Excel. <br><br><h2>  Bonus track: problemas al guardar de Calc a .xlsx </h2><br>  Si guarda datos de Calc en formato Excel .xlsx, tenga en cuenta: OO a veces inexplicablemente y a gran escala pierde datos. <br><br><img src="https://habrastorage.org/webt/yv/bw/7u/yvbw7u8x4lzavz3hztn4pff9wvw.jpeg"><br>  <sub>El p√°ramo blanco en el medio est√° lleno de datos en el archivo CSV original</sub> <br><br>  Por lo tanto, despu√©s de guardar, abro el archivo nuevamente y me aseguro de que los datos est√©n en su lugar. <br><br>  Si se pierde algo, el tratamiento consiste en salvar de CSV a .xlsx.  O, si Windows est√° instalado, importe desde CSV a Excel y guarde desde all√≠. <br><br>  Despu√©s de volver a guardar, definitivamente comprobar√© una vez m√°s que todos los datos est√°n en su lugar y que no hay l√≠neas vac√≠as adicionales. <br><br>  <i>Si est√° interesado en trabajar con datos, consulte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">nuestras vacantes</a> .</i>  <i>HFLabs casi siempre necesita analistas, probadores, ingenieros de implementaci√≥n, desarrolladores.</i>  <i>Proporcionaremos datos para que parezca poco :)</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es432906/">https://habr.com/ru/post/es432906/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es432896/index.html">AXIS P1425-LE Mk II versus IDIS DC-T3233HRXL: Comparar c√°maras CCTV</a></li>
<li><a href="../es432898/index.html">Panoramas en StereoPi</a></li>
<li><a href="../es432900/index.html">Caracter√≠sticas del trabajo en un equipo internacional. Jap√≥n</a></li>
<li><a href="../es432902/index.html">El vuelo fallido a la luna: lo que se supo de una de las misiones</a></li>
<li><a href="../es432904/index.html">Mejores empleadores en TI 2018: calificaci√≥n anual de My Circle</a></li>
<li><a href="../es432908/index.html">En Rusia, planean introducir un control adicional sobre los pagos en Internet.</a></li>
<li><a href="../es432910/index.html">Es peligroso considerar la realidad virtual como una m√°quina para la empat√≠a.</a></li>
<li><a href="../es432912/index.html">C√≥mo obtener una pasant√≠a en Google</a></li>
<li><a href="../es432914/index.html">Un bot de chat muy simple para Telegram para los m√°s peque√±os.</a></li>
<li><a href="../es432918/index.html">Lo siento, romp√≠ tu recovery.conf</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>