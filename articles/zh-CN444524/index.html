<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ™‹ğŸ½ ğŸ™ğŸ¾ ğŸš´ğŸ¾ Lambdaï¼šä»C ++ 11åˆ°C ++ 20ã€‚ ç¬¬ä¸€éƒ¨åˆ† ğŸ‘©ğŸ¿â€âš–ï¸ ğŸ³ï¸â€ğŸŒˆ ğŸ¹</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ‹å‹ä»¬ï¼Œä¸‹åˆå¥½ã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸ºæ‚¨å‡†å¤‡äº†æ–‡ç« â€œ Lambdasï¼šä»C ++ 11åˆ°C ++ 20â€çš„ç¬¬ä¸€éƒ¨åˆ†çš„ç¿»è¯‘ã€‚ è¯¥ææ–™çš„å‘å¸ƒæ—¶é—´æ°å¥½ä¸æ˜å¤©å¼€å§‹çš„â€œ C ++å¼€å‘äººå‘˜â€è¯¾ç¨‹çš„å‘å¸ƒæ—¶é—´ç›¸åŒã€‚ 

 Lambdaè¡¨è¾¾å¼æ˜¯C ++ 11ä¸­æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå¹¶ä¸”éšç€æ¯ç§æ–°è¯­è¨€æ ‡å‡†çš„å‘å±•è€Œä¸æ–­å‘å±•ã€‚ åœ¨æœ¬æ–‡...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Lambdaï¼šä»C ++ 11åˆ°C ++ 20ã€‚ ç¬¬ä¸€éƒ¨åˆ†</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/444524/">æœ‹å‹ä»¬ï¼Œä¸‹åˆå¥½ã€‚ ä»Šå¤©ï¼Œæˆ‘ä»¬ä¸ºæ‚¨å‡†å¤‡äº†æ–‡ç« <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œ Lambdasï¼šä»C ++ 11åˆ°C ++ 20â€</a>çš„ç¬¬ä¸€éƒ¨åˆ†çš„ç¿»è¯‘ã€‚ è¯¥ææ–™çš„å‘å¸ƒæ—¶é—´æ°å¥½ä¸æ˜å¤©å¼€å§‹çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œ C ++å¼€å‘äººå‘˜â€</a>è¯¾ç¨‹çš„å‘å¸ƒæ—¶é—´ç›¸åŒã€‚ <br><br>  Lambdaè¡¨è¾¾å¼æ˜¯C ++ 11ä¸­æœ€å¼ºå¤§çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå¹¶ä¸”éšç€æ¯ç§æ–°è¯­è¨€æ ‡å‡†çš„å‘å±•è€Œä¸æ–­å‘å±•ã€‚ åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†å›é¡¾ä»–ä»¬çš„å†å²ï¼Œå¹¶ç ”ç©¶ç°ä»£C ++è¿™ä¸ªé‡è¦éƒ¨åˆ†çš„æ¼”å˜ã€‚ <br><br><img src="https://habrastorage.org/webt/s8/xa/l8/s8xal8zqrhmjeh-omwslxujvsmw.png"><br><br> ç¬¬äºŒéƒ¨åˆ†åœ¨è¿™é‡Œå¯ç”¨ï¼š <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Lambdaï¼šä»C ++ 11åˆ°C ++ 20ï¼Œç¬¬2éƒ¨åˆ†</a> <br><a name="habracut"></a><br>  <b>å‚èµ›ä½œå“</b> <br><br> åœ¨æœ¬åœ°C ++ç”¨æˆ·ç»„ä¼šè®®ä¸Šï¼Œæˆ‘ä»¬å°±lambdaè¡¨è¾¾å¼çš„â€œå†å²â€è¿›è¡Œäº†ç°åœºç¼–ç¨‹ã€‚ å¯¹è¯ç”±C ++ä¸“å®¶TomaszKamiÅ„skiä¸»æŒï¼ˆ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯·å‚é˜…Thomasçš„Linkedinä¸ªäººèµ„æ–™</a> ï¼‰ã€‚ è¿™æ˜¯äº‹ä»¶ï¼š <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Lambdaï¼šä»C ++ 11åˆ°C ++ 20-C ++ç”¨æˆ·ç»„å…‹æ‹‰ç§‘å¤«</a> <br><br> æˆ‘å†³å®šä»Thomasï¼ˆç»è¿‡ä»–çš„è®¸å¯ï¼ï¼‰è·å–ä»£ç ï¼Œå¯¹å…¶è¿›è¡Œæè¿°å¹¶åˆ›å»ºå¦ä¸€ç¯‡æ–‡ç« ã€‚ <br><br> æˆ‘ä»¬å°†ä»æ¢ç´¢C ++ 03å’Œå¯¹ç´§å‡‘å±€éƒ¨å‡½æ•°è¡¨è¾¾å¼çš„éœ€æ±‚å¼€å§‹ã€‚ ç„¶åæˆ‘ä»¬è½¬åˆ°C ++ 11å’ŒC ++ 14ã€‚ åœ¨æœ¬ç³»åˆ—çš„ç¬¬äºŒéƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°C ++ 17ä¸­çš„å˜åŒ–ï¼Œç”šè‡³çœ‹çœ‹C ++ 20ä¸­å°†å‘ç”Ÿä»€ä¹ˆã€‚ <br><br>  <b>C ++ 03ä¸­çš„Lambda</b> <br><br> ä»ä¸€å¼€å§‹ï¼ŒSTLçš„<code>std::algorithms</code> ï¼ˆä¾‹å¦‚<code>std::sort</code> ï¼‰å°±å¯ä»¥æ¥å—ä»»ä½•è¢«è°ƒç”¨çš„å¯¹è±¡ï¼Œå¹¶åœ¨å®¹å™¨å…ƒç´ ä¸Šå¯¹å…¶è¿›è¡Œè°ƒç”¨ã€‚ ä½†æ˜¯ï¼Œåœ¨C ++ 03ä¸­ï¼Œè¿™ä»…æ¶‰åŠæŒ‡å‘å‡½æ•°å’Œå‡½å­çš„æŒ‡é’ˆã€‚ <br><br> ä¾‹å¦‚ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; #include &lt;algorithm&gt; #include &lt;vector&gt; struct PrintFunctor { void operator()(int x) const { std::cout &lt;&lt; x &lt;&lt; std::endl; } }; int main() { std::vector&lt;int&gt; v; v.push_back(1); v.push_back(2); std::for_each(v.begin(), v.end(), PrintFunctor()); }</span></span></span></span></code> </pre> <br> è¿è¡Œä»£ç ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <br><br> ä½†æ˜¯é—®é¢˜åœ¨äºï¼Œæ‚¨å¿…é¡»åœ¨ä¸åŒçš„èŒƒå›´å†…è€Œä¸æ˜¯åœ¨ç®—æ³•è°ƒç”¨çš„èŒƒå›´å†…ç¼–å†™ä¸€ä¸ªå•ç‹¬çš„å‡½æ•°æˆ–å‡½å­ã€‚ <br><br> ä½œä¸ºä¸€ç§æ½œåœ¨çš„è§£å†³æ–¹æ¡ˆï¼Œæ‚¨å¯èƒ½è€ƒè™‘ç¼–å†™æœ¬åœ°ä»¿å‡½æ•°ç±»-å› ä¸ºC ++å§‹ç»ˆæ”¯æŒæ­¤è¯­æ³•ã€‚ ä½†è¿™è¡Œä¸é€š... <br><br> çœ‹ä¸€ä¸‹è¿™æ®µä»£ç ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PrintFunctor</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; x &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; } }; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; v; v.push_back(<span class="hljs-number"><span class="hljs-number">1</span></span>); v.push_back(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::for_each(v.begin(), v.end(), PrintFunctor()); }</code> </pre> <br> å°è¯•ä½¿ç”¨<code>-std=c++98</code>ç¼–è¯‘ï¼Œæ‚¨å°†åœ¨GCCä¸­çœ‹åˆ°ä»¥ä¸‹é”™è¯¯ï¼š <br><br><pre> <code class="cpp hljs">error: <span class="hljs-keyword"><span class="hljs-keyword">template</span></span> argument <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-string"><span class="hljs-string">'template&lt;class _IIter, class _Funct&gt; _Funct std::for_each(_IIter, _IIter, _Funct)'</span></span> uses local type <span class="hljs-string"><span class="hljs-string">'main()::PrintFunctor'</span></span></code> </pre> <br> æœ¬è´¨ä¸Šï¼Œåœ¨C ++ 98/03ä¸­ï¼Œæ‚¨ä¸èƒ½åˆ›å»ºå…·æœ‰æœ¬åœ°ç±»å‹çš„æ¨¡æ¿çš„å®ä¾‹ã€‚ <br> ç”±äºæ‰€æœ‰è¿™äº›é™åˆ¶ï¼Œå§”å‘˜ä¼šå¼€å§‹å¼€å‘ä¸€é¡¹æ–°åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºè¯¥åŠŸèƒ½å¹¶å°†å…¶ç§°ä¸ºâ€œå°±åœ°â€ ...â€œ lambdaè¡¨è¾¾å¼â€ï¼ <br><br> å¦‚æœæˆ‘ä»¬çœ‹ä¸€ä¸‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">N3337</a> -C ++ 11çš„æœ€ç»ˆç‰ˆæœ¬ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°lambdaçš„å•ç‹¬éƒ¨åˆ†ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[expr.prim.lambda]</a> ã€‚ <br><br>  <b>ç´§æ¥C ++ 11</b> <br><br> æˆ‘è®¤ä¸ºlambdaå·²è¢«æ˜æ™ºåœ°æ·»åŠ åˆ°è¯­è¨€ä¸­ã€‚ ä»–ä»¬ä½¿ç”¨æ–°çš„è¯­æ³•ï¼Œä½†æ˜¯ç¼–è¯‘å™¨éšåå°†å…¶â€œæ‰©å±•â€ä¸ºçœŸå®çš„ç±»ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬æ‹¥æœ‰çœŸæ­£çš„ä¸¥æ ¼ç±»å‹åŒ–è¯­è¨€çš„æ‰€æœ‰ä¼˜ç‚¹ï¼ˆæœ‰æ—¶æ˜¯ç¼ºç‚¹ï¼‰ã€‚ <br><br> è¿™æ˜¯ä¸€ä¸ªåŸºæœ¬ä»£ç ç¤ºä¾‹ï¼Œè¿˜æ˜¾ç¤ºäº†ç›¸åº”çš„æœ¬åœ°ä»¿å‡½æ•°å¯¹è±¡ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; #include &lt;algorithm&gt; #include &lt;vector&gt; int main() { struct { void operator()(int x) const { std::cout &lt;&lt; x &lt;&lt; '\n'; } } someInstance; std::vector&lt;int&gt; v; v.push_back(1); v.push_back(2); std::for_each(v.begin(), v.end(), someInstance); std::for_each(v.begin(), v.end(), [] (int x) { std::cout &lt;&lt; x &lt;&lt; '\n'; } ); }</span></span></span></span></code> </pre> <br> ç¤ºä¾‹ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@WandBox</a> <br><br> æ‚¨è¿˜å¯ä»¥ç­¾å‡ºCppInsightsï¼Œå®ƒæ˜¾ç¤ºäº†ç¼–è¯‘å™¨å¦‚ä½•æ‰©å±•ä»£ç ï¼š <br><br> çœ‹ä¸€ä¸‹è¿™ä¸ªä¾‹å­ï¼š <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CppInsighsï¼šLambdaæµ‹è¯•</a> <br><br> åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œç¼–è¯‘å™¨å°†è½¬æ¢ï¼š <br><br><pre> <code class="cpp hljs">[] (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; x &lt;&lt; <span class="hljs-string"><span class="hljs-string">'\n'</span></span>; }</code> </pre> <br><br> å˜æˆä¸æ­¤ç±»ä¼¼çš„å½¢å¼ï¼ˆç®€åŒ–å½¢å¼ï¼‰ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> x)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; x &lt;&lt; <span class="hljs-string"><span class="hljs-string">'\n'</span></span>; } } someInstance;</code> </pre> <br>  Lambdaè¡¨è¾¾å¼è¯­æ³•ï¼š <br><br><pre> <code class="cpp hljs">[] () { ; } ^ ^ ^ | | | | | : <span class="hljs-keyword"><span class="hljs-keyword">mutable</span></span>, exception, trailing <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>, ... | | |   |     </code> </pre><br> æˆ‘ä»¬å¼€å§‹ä¹‹å‰çš„ä¸€äº›å®šä¹‰ï¼š <br><br> æ¥è‡ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[expr.prim.lambdaï¼ƒ2]</a> ï¼š <br><br> è®¡ç®—lambdaè¡¨è¾¾å¼ä¼šå¯¼è‡´ä¸€ä¸ªä¸´æ—¶çš„prvalueã€‚ æ­¤ä¸´æ—¶å¯¹è±¡ç§°ä¸º<i>é—­åŒ…å¯¹è±¡</i> ã€‚ <br><br> å¹¶ä¸”æ¥è‡ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[expr.prim.lambdaï¼ƒ3]</a> ï¼š <br><br>  lambdaè¡¨è¾¾å¼çš„ç±»å‹ï¼ˆä¹Ÿæ˜¯é—­åŒ…å¯¹è±¡çš„ç±»å‹ï¼‰æ˜¯ç§°ä¸º<i>é—­åŒ…ç±»å‹</i>çš„ç±»çš„å”¯ä¸€æ— åéå·¥ä¼š<i>ç±»å‹</i> ã€‚ <br><br>  Lambdaè¡¨è¾¾å¼çš„ä¸€äº›ç¤ºä¾‹ï¼š <br><br> ä¾‹å¦‚ï¼š <br><br><pre> <code class="cpp hljs">[](<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> f, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a*f; } [](MyClass t) -&gt; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> a = t.compute(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a; } [](<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a &lt; b; }</code> </pre> <br>  <b>Î»å‹</b> <br><br> ç”±äºç¼–è¯‘å™¨ä¼šä¸ºæ¯ä¸ªlambdaç”Ÿæˆä¸€ä¸ªå”¯ä¸€çš„åç§°ï¼Œå› æ­¤ä¸å¯èƒ½äº‹å…ˆçŸ¥é“å®ƒã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> myLambda = [](<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a) -&gt; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2.0</span></span> * a; }</code> </pre> <br> æ­¤å¤–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[expr.prim.lambda]</a> ï¼š <br> ä¸lambdaè¡¨è¾¾å¼å…³è”çš„é—­åŒ…ç±»å‹å…·æœ‰ä¸€ä¸ªè¿œç¨‹ï¼ˆ[dcl.fct.def.delete]ï¼‰é»˜è®¤æ„é€ å‡½æ•°å’Œä¸€ä¸ªè¿œç¨‹èµ‹å€¼è¿ç®—ç¬¦ã€‚ <br><br> å› æ­¤ï¼Œæ‚¨ä¸èƒ½å†™ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> foo = [&amp;x, &amp;y]() { ++x; ++y; }; <span class="hljs-keyword"><span class="hljs-keyword">decltype</span></span>(foo) fooCopy;</code> </pre> <br> è¿™ä¼šåœ¨GCCä¸­å¯¼è‡´ä»¥ä¸‹é”™è¯¯ï¼š <br><br><pre> <code class="cpp hljs">error: use of deleted function <span class="hljs-string"><span class="hljs-string">'main()::&lt;lambda()&gt;::&lt;lambda&gt;()'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">decltype</span></span>(foo) fooCopy; ^~~~~~~ note: a lambda closure type has a deleted <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> constructor</code> </pre> <br>  <b>å‘¼å«æ¥çº¿å‘˜</b> <br><br> æ”¾å…¥lambdaä¸»ä½“ä¸­çš„ä»£ç è¢«â€œè½¬æ¢â€ä¸ºç›¸åº”é—­åŒ…ç±»å‹çš„operatorï¼ˆï¼‰ä»£ç ã€‚ <br><br> é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå†…ç½®çš„å¸¸é‡æ–¹æ³•ã€‚ æ‚¨å¯ä»¥åœ¨å£°æ˜å‚æ•°åé€šè¿‡æŒ‡å®šmutableæ¥æ›´æ”¹å®ƒï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> myLambda = [](<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> a) <span class="hljs-keyword"><span class="hljs-keyword">mutable</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; a; }</code> </pre> <br> å°½ç®¡å¸¸é‡æ–¹æ³•ä¸æ˜¯æ²¡æœ‰ç©ºæ•è·åˆ—è¡¨çš„lambdaçš„â€œé—®é¢˜â€ï¼Œä½†æ˜¯å½“æ‚¨è¦æ•è·æŸäº›ä¸œè¥¿æ—¶ï¼Œå®ƒå°±å¾ˆé‡è¦ã€‚ <br><br>  <b>æ•æ‰</b> <br><br>  []ä¸ä»…å¼•å…¥äº†lambdaï¼Œè€Œä¸”è¿˜åŒ…å«æ•è·å˜é‡çš„åˆ—è¡¨ã€‚ è¿™ç§°ä¸ºæ•è·åˆ—è¡¨ã€‚ <br><br> é€šè¿‡æ•è·å˜é‡ï¼Œæ‚¨å¯ä»¥åœ¨é—­åŒ…ç±»å‹ä¸­åˆ›å»ºæ­¤å˜é‡çš„å‰¯æœ¬æˆå‘˜ã€‚ ç„¶åï¼Œå¯ä»¥åœ¨lambdaä¸»ä½“å†…è®¿é—®å®ƒã€‚ <br><br> åŸºæœ¬è¯­æ³•ä¸ºï¼š <br><br><ul><li>  [ï¼†]-é€šè¿‡å¼•ç”¨æ•è·ï¼Œè‡ªåŠ¨å­˜å‚¨ä¸­çš„æ‰€æœ‰å˜é‡éƒ½åœ¨ä½œç”¨åŸŸä¸­å£°æ˜ </li><li>  [=]-æŒ‰å€¼æ•è·ï¼Œå°†å€¼å¤åˆ¶ </li><li>  [xï¼Œï¼†y]-æŒ‰å€¼æ˜¾å¼æ•è·xï¼ŒæŒ‰å¼•ç”¨æ˜¾å¼æ•è·y </li></ul><br> ä¾‹å¦‚ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">1</span></span>, y = <span class="hljs-number"><span class="hljs-number">1</span></span>; { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; x &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; y &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> foo = [&amp;x, &amp;y]() { ++x; ++y; }; foo(); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; x &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; y &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; }</code> </pre><br> æ‚¨å¯ä»¥åœ¨æ­¤å¤„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å°è¯•</a>å®Œæ•´çš„ç¤ºä¾‹ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <br><br> å°½ç®¡æŒ‡å®š<code>[=]</code>æˆ–<code>[&amp;]</code>ä¼šå¾ˆæ–¹ä¾¿-ç”±äºå®ƒä¼šæ•è·è‡ªåŠ¨å­˜å‚¨ä¸­çš„æ‰€æœ‰å˜é‡ï¼Œæ‰€ä»¥æ˜¾å¼åœ°æ•è·å˜é‡æ›´ä¸ºæ˜æ˜¾ã€‚ å› æ­¤ï¼Œç¼–è¯‘å™¨å¯ä»¥è­¦å‘Šæ‚¨ä¸å¿…è¦çš„å½±å“ï¼ˆä¾‹å¦‚ï¼Œè¯·å‚è§æœ‰å…³å…¨å±€å’Œé™æ€å˜é‡çš„è¯´æ˜ï¼‰ <br><br> æ‚¨è¿˜å¯ä»¥åœ¨Scott Meyersæ’°å†™çš„æœ‰æ•ˆç°ä»£C ++ç¬¬31æ®µä¸­äº†è§£æ›´å¤šä¿¡æ¯ï¼šâ€œé¿å…ä½¿ç”¨é»˜è®¤æ•è·æ¨¡å¼ã€‚â€ <br><br> è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„æŠ¥ä»·ï¼š <br><blockquote>  C ++é—­åŒ…ä¸ä¼šå¢åŠ æ•è·é“¾æ¥çš„ç”Ÿå­˜æœŸã€‚ </blockquote><br><br>  <b>å¯å˜çš„</b> <br><br> é»˜è®¤æƒ…å†µä¸‹ï¼Œé—­åŒ…ç±»å‹è¿ç®—ç¬¦ï¼ˆï¼‰æ˜¯å¸¸é‡ï¼Œæ‚¨ä¸èƒ½åœ¨lambdaè¡¨è¾¾å¼ä¸»ä½“å†…ä¿®æ”¹æ•è·çš„å˜é‡ã€‚ <br> å¦‚æœè¦æ›´æ”¹æ­¤è¡Œä¸ºï¼Œåˆ™éœ€è¦åœ¨å‚æ•°åˆ—è¡¨ä¹‹åæ·»åŠ mutableå…³é”®å­—ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">1</span></span>, y = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; x &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; y &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> foo = [x, y]() <span class="hljs-keyword"><span class="hljs-keyword">mutable</span></span> { ++x; ++y; }; foo(); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; x &lt;&lt; <span class="hljs-string"><span class="hljs-string">" "</span></span> &lt;&lt; y &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>;</code> </pre> <br> åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ›´æ”¹xå’Œyçš„å€¼ï¼Œä½†æ˜¯è¿™äº›åªæ˜¯æ‰€é™„èŒƒå›´ä¸­xå’Œyçš„å‰¯æœ¬ã€‚ <br><br>  <b>å…¨å±€å˜é‡æ•è·</b> <br><br> å¦‚æœæ‚¨å…·æœ‰å…¨å±€å€¼ï¼Œç„¶ååœ¨lambdaä¸­ä½¿ç”¨[=]ï¼Œåˆ™æ‚¨å¯èƒ½ä¼šè®¤ä¸ºå…¨å±€å€¼ä¹Ÿå¯ä»¥é€šè¿‡å€¼æ¥æ•è·ï¼Œä½†äº‹å®å¹¶éå¦‚æ­¤ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> global = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; global &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> foo = [=] () <span class="hljs-keyword"><span class="hljs-keyword">mutable</span></span> { ++global; }; foo(); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; global &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; [] { ++global; } (); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; global &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; [global] { ++global; } (); }</code> </pre> <br> æ‚¨å¯ä»¥åœ¨æ­¤å¤„ä½¿ç”¨ä»£ç ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><br></a> <br> ä»…æ•è·è‡ªåŠ¨å­˜å‚¨ä¸­çš„å˜é‡ã€‚  GCCç”šè‡³å¯èƒ½å‘å‡ºä»¥ä¸‹è­¦å‘Šï¼š <br><br><pre> <code class="cpp hljs">warning: capture of variable <span class="hljs-string"><span class="hljs-string">'global'</span></span> with non-automatic storage duration</code> </pre> <br> ä»…å½“æ‚¨æ˜ç¡®æ•è·å…¨å±€å˜é‡æ—¶æ‰ä¼šå‡ºç°æ­¤è­¦å‘Šï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨<code>[=]</code> ï¼Œç¼–è¯‘å™¨å°†æ— æµäºäº‹ã€‚ <br>  Clangç¼–è¯‘å™¨æ›´æœ‰ç”¨ï¼Œå› ä¸ºå®ƒä¼šç”Ÿæˆé”™è¯¯ï¼š <br><br><pre> <code class="cpp hljs">error: <span class="hljs-string"><span class="hljs-string">'global'</span></span> cannot be captured because it does <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> have automatic storage duration</code> </pre> <br> å‚è§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <br><br>  <b>æ•è·é™æ€å˜é‡</b> <br><br> æ•è·é™æ€å˜é‡ç±»ä¼¼äºæ•è·å…¨å±€å˜é‡ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; void bar() { static int static_int = 10; std::cout &lt;&lt; static_int &lt;&lt; std::endl; auto foo = [=] () mutable { ++static_int; }; foo(); std::cout &lt;&lt; static_int &lt;&lt; std::endl; [] { ++static_int; } (); std::cout &lt;&lt; static_int &lt;&lt; std::endl; [static_int] { ++static_int; } (); } int main() { bar(); }</span></span></span></span></code> </pre> <br> æ‚¨å¯ä»¥åœ¨æ­¤å¤„ä½¿ç”¨ä»£ç ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <br><br> ç»“è®ºï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span></code> </pre> <br> åŒæ ·ï¼Œä»…å½“æ‚¨æ˜¾å¼æ•è·é™æ€å˜é‡æ—¶æ‰ä¼šå‡ºç°è­¦å‘Šï¼Œå› æ­¤ï¼Œå¦‚æœä½¿ç”¨<code>[=]</code> ï¼Œç¼–è¯‘å™¨å°†æ— æµäºäº‹ã€‚ <br><br>  <b>ç­çº§æˆå‘˜æ•è·</b> <br><br> æ‚¨çŸ¥é“æ‰§è¡Œä»¥ä¸‹ä»£ç åä¼šå‘ç”Ÿä»€ä¹ˆï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; #include &lt;functional&gt; struct Baz { std::function&lt;void()&gt; foo() { return [=] { std::cout &lt;&lt; s &lt;&lt; std::endl; }; } std::string s; }; int main() { auto f1 = Baz{"ala"}.foo(); auto f2 = Baz{"ula"}.foo(); f1(); f2(); }</span></span></span></span></code> </pre><br> è¯¥ä»£ç å£°æ˜ä¸€ä¸ªBazå¯¹è±¡ï¼Œç„¶åè°ƒç”¨<code>foo()</code> ã€‚ è¯·æ³¨æ„ï¼Œ <code>foo()</code>è¿”å›ä¸€ä¸ªlambdaï¼ˆå­˜å‚¨åœ¨<code>std::function</code> ï¼‰ï¼Œè¯¥lambdaæ•è·è¯¥ç±»çš„æˆå‘˜ã€‚ <br><br> ç”±äºæˆ‘ä»¬ä½¿ç”¨ä¸´æ—¶å¯¹è±¡ï¼Œå› æ­¤æ— æ³•ç¡®å®šè°ƒç”¨f1å’Œf2æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆã€‚ è¿™æ˜¯ä¸€ä¸ªæ‚¬è€Œæœªå†³çš„é“¾æ¥é—®é¢˜ï¼Œå¯¼è‡´æœªå®šä¹‰çš„è¡Œä¸ºã€‚ <br><br> ç±»ä¼¼åœ°ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bar</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">string</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function">&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s; }; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> s; }; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp;&amp; f1 = Bar{<span class="hljs-string"><span class="hljs-string">"ala"</span></span>}.foo(); <span class="hljs-comment"><span class="hljs-comment">//  </span></span></code> </pre> <br> ç©<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a>ä»£ç  <br><br> åŒæ ·ï¼Œå¦‚æœæ‚¨æ˜ç¡®æŒ‡å®šæ•è·ï¼ˆ[s]ï¼‰ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::function&lt;<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>()&gt; foo() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [s] { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; s &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; }; }</code> </pre><br> ç¼–è¯‘å™¨å°†é˜²æ­¢æ‚¨çš„é”™è¯¯ï¼š <br><br><pre> <code class="cpp hljs">In member function <span class="hljs-string"><span class="hljs-string">'std::function&lt;void()&gt; Baz::foo()'</span></span>: error: capture of non-variable <span class="hljs-string"><span class="hljs-string">'Baz::s'</span></span> error: <span class="hljs-string"><span class="hljs-string">'this'</span></span> was <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> captured <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> lambda function ...</code> </pre> <br> æŸ¥çœ‹ç¤ºä¾‹ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <br><br>  <b>åªèƒ½ç§»åŠ¨çš„å¯¹è±¡</b> <br><br> å¦‚æœæ‚¨æœ‰ä¸€ä¸ªåªèƒ½ç§»åŠ¨çš„å¯¹è±¡ï¼ˆä¾‹å¦‚ï¼Œunique_ptrï¼‰ï¼Œåˆ™ä¸èƒ½å°†å…¶ä½œä¸ºæ•è·å˜é‡æ”¾å…¥lambdaä¸­ã€‚ æŒ‰å€¼æ•è·ä¸èµ·ä½œç”¨ï¼Œå› æ­¤æ‚¨åªèƒ½æŒ‰å¼•ç”¨æ•è·...ä½†æ˜¯ï¼Œè¿™ä¸ä¼šå°†å…¶è½¬è®©ç»™æ‚¨ï¼Œå¹¶ä¸”å¯èƒ½ä¸æ˜¯æ‚¨æƒ³è¦çš„ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">unique_ptr</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; p(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>[<span class="hljs-number"><span class="hljs-number">10</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> foo = [p] () {}; <span class="hljs-comment"><span class="hljs-comment">//  ....</span></span></code> </pre><br>  <b>ä¿å­˜å¸¸æ•°</b> <br><br> å¦‚æœæ•è·ä¸€ä¸ªå¸¸é‡å˜é‡ï¼Œåˆ™å°†ä¿ç•™å¸¸é‡ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> x = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> foo = [x] () <span class="hljs-keyword"><span class="hljs-keyword">mutable</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::is_const&lt;<span class="hljs-keyword"><span class="hljs-keyword">decltype</span></span>(x)&gt;::value &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; x = <span class="hljs-number"><span class="hljs-number">11</span></span>; }; foo();</code> </pre> <br> å‚è§ä»£ç ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <br><br>  <b>è¿”å›ç±»å‹</b> <br><br> åœ¨C ++ 11ä¸­ï¼Œæ‚¨å¯ä»¥è·³è¿‡<code>trailing</code>è¿”å›çš„lambdaç±»å‹ï¼Œç„¶åç¼–è¯‘å™¨å°†ä¸ºæ‚¨è¾“å‡ºå®ƒã€‚ <br><br> æœ€åˆï¼Œè¿”å›å€¼ç±»å‹çš„è¾“å‡ºä»…é™äºåŒ…å«ä¸€ä¸ªreturnè¯­å¥çš„lambdaï¼Œä½†ç”±äºå®ç°äº†æ›´æ–¹ä¾¿çš„ç‰ˆæœ¬æ²¡æœ‰é—®é¢˜ï¼Œå› æ­¤è¯¥é™åˆ¶å¾ˆå¿«è¢«æ¶ˆé™¤ã€‚ <br><br> è¯·å‚é˜…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">C ++æ ‡å‡†æ ¸å¿ƒè¯­è¨€ç¼ºé™·æŠ¥å‘Šå’Œå·²æ¥å—çš„é—®é¢˜</a> ï¼ˆæ„Ÿè°¢Thomasæ‰¾åˆ°æ­£ç¡®çš„é“¾æ¥ï¼ï¼‰ <br><br> å› æ­¤ï¼Œä»C ++ 11å¼€å§‹ï¼Œå¦‚æœæ‰€æœ‰è¿”å›è¯­å¥éƒ½å¯ä»¥è½¬æ¢ä¸ºç›¸åŒç±»å‹ï¼Œåˆ™ç¼–è¯‘å™¨å¯ä»¥æ¨æ–­å‡ºè¿”å›å€¼çš„ç±»å‹ã€‚ <br><blockquote> å¦‚æœæ‰€æœ‰returnè¯­å¥åœ¨å·¦å€¼åˆ°å³å€¼ï¼ˆ7.1 [conv.lval]ï¼‰ï¼Œæ•°ç»„åˆ°æŒ‡é’ˆï¼ˆ7.2 [conv.array]ï¼‰å’Œå‡½æ•°åˆ°æŒ‡é’ˆï¼ˆ7.3 [convã€‚ func]ï¼‰ä¸æ³›å‹ç±»å‹ç›¸åŒï¼› <br></blockquote><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> baz = [] () { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( x &lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x * <span class="hljs-number"><span class="hljs-number">1.1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x * <span class="hljs-number"><span class="hljs-number">2.1</span></span>; };</code> </pre><br> æ‚¨å¯ä»¥åœ¨æ­¤å¤„ä½¿ç”¨ä»£ç ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <br><br> ä¸Šé¢çš„lambdaä¸­æœ‰ä¸¤ä¸ª<code>return</code> ï¼Œä½†æ˜¯å®ƒä»¬éƒ½æŒ‡å‘<code>double</code> ï¼Œå› æ­¤ç¼–è¯‘å™¨å¯ä»¥æ¨æ–­ç±»å‹ã€‚ <br><br>  <b>IIFE-ç«‹å³è°ƒç”¨å‡½æ•°è¡¨è¾¾å¼</b> <br><br> åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘å®šä¹‰äº†ä¸€ä¸ªlambdaï¼Œç„¶åä½¿ç”¨é—­åŒ…å¯¹è±¡å¯¹å…¶è¿›è¡Œäº†è°ƒç”¨â€¦â€¦ä½†ä¹Ÿå¯ä»¥ç«‹å³è°ƒç”¨å®ƒï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">1</span></span>, y = <span class="hljs-number"><span class="hljs-number">1</span></span>; [&amp;]() { ++x; ++y; }(); <span class="hljs-comment"><span class="hljs-comment">// &lt;-- call () std::cout &lt;&lt; x &lt;&lt; " " &lt;&lt; y &lt;&lt; std::endl;</span></span></code> </pre> <br> è¿™æ ·çš„è¡¨è¾¾å¼åœ¨å¸¸é‡å¯¹è±¡çš„å¤æ‚åˆå§‹åŒ–ä¸­å¾ˆæœ‰ç”¨ã€‚ <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> val = []() { <span class="hljs-comment"><span class="hljs-comment">/*   ... */</span></span> }();</code> </pre> <br> æˆ‘åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">IIFEå¤æ‚åˆå§‹åŒ–</a>æ–‡ç« ä¸­å†™äº†æ›´å¤šæœ‰å…³æ­¤çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å†…å®¹</a> ã€‚ <br><br>  <b>è½¬æ¢ä¸ºå‡½æ•°æŒ‡é’ˆ</b> <br><blockquote> æ²¡æœ‰æ•è·çš„lambdaè¡¨è¾¾å¼çš„é—­åŒ…ç±»å‹å…·æœ‰å¼€æ”¾çš„éè™šæ‹Ÿéšå¼å‡½æ•°ï¼Œè¯¥å‡½æ•°å°†å¸¸é‡è½¬æ¢ä¸ºæŒ‡å‘å…·æœ‰ä¸è°ƒç”¨é—­åŒ…ç±»å‹çš„å‡½æ•°çš„è¿ç®—ç¬¦ç›¸åŒçš„å‚æ•°å’Œè¿”å›ç±»å‹çš„å‡½æ•°çš„æŒ‡é’ˆã€‚ æ­¤è½¬æ¢å‡½æ•°è¿”å›çš„å€¼å¿…é¡»æ˜¯è¯¥å‡½æ•°çš„åœ°å€ï¼Œè¯¥åœ°å€åœ¨è°ƒç”¨æ—¶ä¸è°ƒç”¨ç±»ä¼¼äºé—­åŒ…ç±»å‹çš„å‡½æ•°çš„è¿ç®—ç¬¦å…·æœ‰ç›¸åŒçš„ä½œç”¨ã€‚ </blockquote> æ¢å¥è¯è¯´ï¼Œæ‚¨å¯ä»¥å°†æ²¡æœ‰æ•è·çš„lambdaè½¬æ¢ä¸ºå‡½æ•°æŒ‡é’ˆã€‚ <br><br> ä¾‹å¦‚ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; void callWith10(void(* bar)(int)) { bar(10); } int main() { struct { using f_ptr = void(*)(int); void operator()(int s) const { return call(s); } operator f_ptr() const { return &amp;call; } private: static void call(int s) { std::cout &lt;&lt; s &lt;&lt; std::endl; }; } baz; callWith10(baz); callWith10([](int x) { std::cout &lt;&lt; x &lt;&lt; std::endl; }); }</span></span></span></span></code> </pre> <br> æ‚¨å¯ä»¥åœ¨æ­¤å¤„ä½¿ç”¨ä»£ç ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <br><br>  <b>C ++ 14çš„æ”¹è¿›</b> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">N4140</a>æ ‡å‡†å’Œlambdaï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[expr.prim.lambda]</a> ã€‚ <br><br>  C ++ 14å¯¹lambdaè¡¨è¾¾å¼è¿›è¡Œäº†ä¸¤é¡¹é‡å¤§æ”¹è¿›ï¼š <br><br><ul><li> ç”¨åˆå§‹åŒ–å™¨æ•è· </li><li> å¸¸è§çš„Î» </li></ul><br> è¿™äº›åŠŸèƒ½è§£å†³äº†C ++ 11ä¸­å¯è§çš„å‡ ä¸ªé—®é¢˜ã€‚ <br><br>  <b>è¿”å›ç±»å‹</b> <br><br>  lambdaè¡¨è¾¾å¼çš„è¿”å›å€¼ç±»å‹çš„è¾“å‡ºå·²æ›´æ–°ï¼Œä»¥ç¬¦åˆå‡½æ•°çš„è‡ªåŠ¨è¾“å‡ºè§„åˆ™ã€‚ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[expr.prim.lambdaï¼ƒ4]</a> <br><blockquote>  lambdaçš„è¿”å›ç±»å‹ä¸ºautoï¼Œå¦‚æœæä¾›äº†è¿”å›çš„ç±»å‹å’Œ/æˆ–ä»returnè¯­å¥æ¨æ–­å‡ºè¯¥å€¼ï¼Œåˆ™å°†å…¶æ›¿æ¢ä¸ºå°¾éšçš„è¿”å›ç±»å‹ï¼Œå¦‚[dcl.spec.auto]ä¸­æ‰€è¿°ã€‚ </blockquote>  <b>ç”¨åˆå§‹åŒ–å™¨æ•è·</b> <br><br> ç®€è€Œè¨€ä¹‹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„é—­åŒ…ç±»å‹çš„æˆå‘˜å˜é‡ï¼Œç„¶ååœ¨lambdaè¡¨è¾¾å¼ä¸­ä½¿ç”¨å®ƒã€‚ <br><br> ä¾‹å¦‚ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">10</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> y = <span class="hljs-number"><span class="hljs-number">11</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> foo = [z = x+y]() { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; z &lt;&lt; <span class="hljs-string"><span class="hljs-string">'\n'</span></span>; }; foo(); }</code> </pre> <br> è¿™å¯ä»¥è§£å†³å‡ ä¸ªé—®é¢˜ï¼Œä¾‹å¦‚ï¼Œä»…å¯ç”¨äºç§»åŠ¨çš„ç±»å‹ã€‚ <br><br>  <b>æ¬å®¶</b> <br><br> ç°åœ¨æˆ‘ä»¬å¯ä»¥å°†å¯¹è±¡ç§»åŠ¨åˆ°é—­åŒ…ç±»å‹çš„æˆå‘˜ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;memory&gt; int main() { std::unique_ptr&lt;int&gt; p(new int[10]); auto foo = [x=10] () mutable { ++x; }; auto bar = [ptr=std::move(p)] {}; auto baz = [p=std::move(p)] {}; }</span></span></span></span></code> </pre> <br>  <b>æœ€ä½³åŒ–</b> <br><br> å¦ä¸€ä¸ªæƒ³æ³•æ˜¯å°†å…¶ç”¨ä½œæ½œåœ¨çš„ä¼˜åŒ–æŠ€æœ¯ã€‚ ä¸å¿…æ¯æ¬¡è°ƒç”¨lambdaéƒ½è®¡ç®—ä¸€äº›å€¼ï¼Œè€Œæ˜¯å¯ä»¥åœ¨åˆå§‹åŒ–ç¨‹åºä¸­è®¡ç®—ä¸€æ¬¡ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; #include &lt;algorithm&gt; #include &lt;vector&gt; #include &lt;memory&gt; #include &lt;iostream&gt; #include &lt;string&gt; int main() { using namespace std::string_literals; std::vector&lt;std::string&gt; vs; std::find_if(vs.begin(), vs.end(), [](std::string const&amp; s) { return s == "foo"s + "bar"s; }); std::find_if(vs.begin(), vs.end(), [p="foo"s + "bar"s](std::string const&amp; s) { return s == p; }); }</span></span></span></span></code> </pre> <br>  <b>æ•è·æˆå‘˜å˜é‡</b> <br><br> åˆå§‹åŒ–ç¨‹åºä¹Ÿå¯ä»¥ç”¨äºæ•è·æˆå‘˜å˜é‡ã€‚ ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—æˆå‘˜å˜é‡çš„å‰¯æœ¬ï¼Œè€Œä¸å¿…æ‹…å¿ƒæ‚¬æŒ‚é“¾æ¥ã€‚ <br><br> ä¾‹å¦‚ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Baz</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">auto</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">foo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [s=s] { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; s &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; }; } <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> s; }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> f1 = Baz{<span class="hljs-string"><span class="hljs-string">"ala"</span></span>}.foo(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> f2 = Baz{<span class="hljs-string"><span class="hljs-string">"ula"</span></span>}.foo(); f1(); f2(); }</code> </pre> <br> æ‚¨å¯ä»¥åœ¨æ­¤å¤„ä½¿ç”¨ä»£ç ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><br></a> <br><br> åœ¨<code>foo()</code>æˆ‘ä»¬é€šè¿‡å°†æˆå‘˜å˜é‡å¤åˆ¶åˆ°é—­åŒ…ç±»å‹æ¥æ•è·å®ƒã€‚ å¦å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨autoè¾“å‡ºæ•´ä¸ªæ–¹æ³•ï¼ˆä»¥å‰ï¼Œåœ¨C ++ 11ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>std::function</code> ï¼‰ã€‚ <br><br>  <b>é€šç”¨Lambdaè¡¨è¾¾å¼</b> <br><br> å¦ä¸€ä¸ªé‡è¦çš„æ”¹è¿›æ˜¯å¹¿ä¹‰Î»ã€‚ <br> ä»C ++ 14å¼€å§‹ï¼Œæ‚¨å¯ä»¥ç¼–å†™ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> foo = [](<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> x) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; x &lt;&lt; <span class="hljs-string"><span class="hljs-string">'\n'</span></span>; }; foo(<span class="hljs-number"><span class="hljs-number">10</span></span>); foo(<span class="hljs-number"><span class="hljs-number">10.1234</span></span>); foo(<span class="hljs-string"><span class="hljs-string">"hello world"</span></span>);</code> </pre> <br> è¿™ç­‰æ•ˆäºåœ¨é—­åŒ…ç±»å‹çš„è°ƒç”¨è¯­å¥ä¸­ä½¿ç”¨æ¨¡æ¿å£°æ˜ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">operator</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(T x)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; x &lt;&lt; <span class="hljs-string"><span class="hljs-string">'\n'</span></span>; } } someInstance;</code> </pre><br> å½“éš¾ä»¥æ¨æ–­ç±»å‹æ—¶ï¼Œè¿™ç§å¹¿ä¹‰lambdaå¯èƒ½éå¸¸æœ‰ç”¨ã€‚ <br><br> ä¾‹å¦‚ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">map</span></span>&lt;<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; numbers { { <span class="hljs-string"><span class="hljs-string">"one"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }, {<span class="hljs-string"><span class="hljs-string">"two"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span> }, { <span class="hljs-string"><span class="hljs-string">"three"</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span> } }; <span class="hljs-comment"><span class="hljs-comment">//      pair&lt;const string, int&gt;! std::for_each(std::begin(numbers), std::end(numbers), [](const std::pair&lt;std::string, int&gt;&amp; entry) { std::cout &lt;&lt; entry.first &lt;&lt; " = " &lt;&lt; entry.second &lt;&lt; '\n'; } );</span></span></code> </pre><br> æˆ‘åœ¨è¿™é‡Œé”™äº†å—ï¼Ÿ è¾“å…¥çš„ç±»å‹æ­£ç¡®å—ï¼Ÿ <br>  ã€‚ <br>  ã€‚ <br>  ã€‚ <br> å¯èƒ½ä¸æ˜¯ï¼Œå› ä¸ºstd :: mapçš„å€¼ç±»å‹æ˜¯<code>std::pair&lt;const Key, T&gt;</code> ã€‚ å› æ­¤ï¼Œæˆ‘çš„ä»£ç å°†åˆ¶ä½œè¿™äº›è¡Œçš„å…¶ä»–å‰¯æœ¬... <br> è¿™å¯ä»¥é€šè¿‡<code>auto</code>æ¥è§£å†³ï¼š <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::for_each(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::begin(numbers), <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::end(numbers), [](<span class="hljs-keyword"><span class="hljs-keyword">auto</span></span>&amp; entry) { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; entry.first &lt;&lt; <span class="hljs-string"><span class="hljs-string">" = "</span></span> &lt;&lt; entry.second &lt;&lt; <span class="hljs-string"><span class="hljs-string">'\n'</span></span>; } );</code> </pre> <br> æ‚¨å¯ä»¥åœ¨æ­¤å¤„ä½¿ç”¨ä»£ç ï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">@Wandbox</a> <br><br>  <b>ç»“è®º</b> <br><br> çœŸæ˜¯ä¸ªæ•…äº‹ï¼ <br><br> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬ä»C ++ 03å’ŒC ++ 11ä¸­çš„lambdaè¡¨è¾¾å¼å¼€å§‹çš„ç¬¬ä¸€å¤©å¼€å§‹ï¼Œç„¶åè½¬åˆ°C ++ 14ä¸­çš„æ”¹è¿›ç‰ˆæœ¬ã€‚ <br><br> æ‚¨å·²ç»äº†è§£äº†å¦‚ä½•åˆ›å»ºlambdaï¼Œè¯¥è¡¨è¾¾å¼çš„åŸºæœ¬ç»“æ„æ˜¯ä»€ä¹ˆï¼Œæ•è·åˆ—è¡¨ç­‰ç­‰ã€‚ <br><br> åœ¨æœ¬æ–‡çš„ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­å­¦ä¹ C ++ 17ï¼Œå¹¶äº†è§£C ++ 20çš„æœªæ¥åŠŸèƒ½ã€‚ <br><br> ç¬¬äºŒéƒ¨åˆ†åœ¨è¿™é‡Œå¯ç”¨ï¼š <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Lambdaï¼šä»C ++ 11åˆ°C ++ 20ï¼Œç¬¬2éƒ¨åˆ†</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><br></a> <br><br> å‚è€ƒæ–‡çŒ® <br><br>  C ++ 11- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[expr.prim.lambda]</a> <br>  C ++ 14- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">[expr.prim.lambda]</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">C ++ä¸­çš„Lambdaè¡¨è¾¾å¼|</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¾®è½¯æ–‡æ¡£</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­ç§˜C ++ lambdas-ç²˜æ€§ä½-ç”±Feabhasæä¾›æ”¯æŒï¼›ç²˜æ€§ä½-ç”±Feabhasæä¾›æ”¯æŒ</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><br></a> <br><br> æˆ‘ä»¬æ­£åœ¨ç­‰å¾…æ‚¨çš„æ„è§ï¼Œå¹¶é‚€è¯·å¯¹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œ C ++å¼€å‘äººå‘˜â€</a>è¯¾ç¨‹æ„Ÿå…´è¶£çš„æ‰€æœ‰äººã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN444524/">https://habr.com/ru/post/zh-CN444524/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN444514/index.html">ç½‘ç»œç ”è®¨ä¼šâ€œæœºå™¨å­¦ä¹ å®‰å…¨æ€§ï¼šäººå·¥æ™ºèƒ½çš„è‡ªç„¶é—®é¢˜â€</a></li>
<li><a href="../zh-CN444516/index.html">Wolfenstein 3Dï¼šä½¿ç”¨WebGL1è¿›è¡Œå…‰çº¿è·Ÿè¸ª</a></li>
<li><a href="../zh-CN444518/index.html">èµ°å‘æ„è¯†çš„åŸºæœ¬ç†è®º</a></li>
<li><a href="../zh-CN444520/index.html">2. Check Pointå…¥é—¨R80.20ã€‚ è§£å†³æ–¹æ¡ˆæ¶æ„</a></li>
<li><a href="../zh-CN444522/index.html">å¯ç¤ºå½•è¢«å–æ¶ˆ</a></li>
<li><a href="../zh-CN444526/index.html">DOTSå †æ ˆï¼šC ++å’ŒCï¼ƒ</a></li>
<li><a href="../zh-CN444528/index.html">æƒ…å†µï¼šæ—¥æœ¬å¯èƒ½é™åˆ¶ä»ç½‘ç»œä¸‹è½½å†…å®¹-æˆ‘ä»¬ç†è§£å¹¶è®¨è®º</a></li>
<li><a href="../zh-CN444530/index.html">Androidä¸­ä¾èµ–é¡¹æ³¨å…¥çš„æœªæ¥</a></li>
<li><a href="../zh-CN444534/index.html">æ¼æ´æ‰«æå’Œå®‰å…¨å¼€å‘ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN444536/index.html">MVCC-2ã€‚ å›¾å±‚ï¼Œæ–‡ä»¶ï¼Œé¡µé¢</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>