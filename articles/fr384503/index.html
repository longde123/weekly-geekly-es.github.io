<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíò üê∫ üë®‚Äçüë®‚Äçüë¶‚Äçüë¶ Rubik's Cube Machine bas√© sur FAC üôå üñïüèº ü§ò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il n'y a pas si longtemps, avec Wilbert Swinkels, nous avons termin√© de travailler sur une machine qui collecte le Rubik's Cube. Ils ont √©crit sur nou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rubik's Cube Machine bas√© sur FAC</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/384503/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Il n'y a pas si longtemps, avec </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wilbert Swinkels, nous avons</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> termin√© de travailler sur une machine qui collecte le Rubik's Cube. </font><font style="vertical-align: inherit;">Ils ont </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©crit</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur nous </font><font style="vertical-align: inherit;">sur le blog officiel de Raspberry Pi et nous avons re√ßu beaucoup de critiques √©logieuses. </font><font style="vertical-align: inherit;">N√©anmoins, dans le segment russe du r√©seau, le projet est en quelque sorte pass√© inaper√ßu. </font><font style="vertical-align: inherit;">J'ai donc d√©cid√© de corriger cette omission en publiant ici une version traduite et augment√©e de l'article d' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">origine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/vpAKfSYueMI%3Ffeature%3Doembed&amp;usg=ALkJrhiIicy_OhpaxO6m3FkpoPedxK-dzA" frameborder="0" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sous la coupe, on va parler (principalement) de la partie logicielle de cette machine, la partie m√©canique peut √™tre lue sur la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">page officielle du</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> projet (oui, on sait que c'est un peu "old school")</font></font><br>
<a name="habracut"></a><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TL; DR</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour les impatients, quelques liens:</font></font><br>
<ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Page officielle du projet</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Impl√©mentations de l'algorithme √† deux phases de Kotsemba (Python et C)</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D'autres ≈ìuvres deWilbert</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Site Web de Wilbert FAC</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Site officiel du syst√®me FAC</font></font></a></li>
</ul><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">introduction</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout a commenc√© avec le fait qu'en mai de cette ann√©e, j'ai rencontr√© accidentellement Wilbert Swinkels. J'ai √©t√© tout simplement choqu√© en voyant ses </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cr√©ations</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : chacun de ces m√©canismes, du plus petit au plus grand, peut en toute s√©curit√© √™tre qualifi√© d'oeuvre d'art. Et plus vous regardez leur appareil de pr√®s, plus vous √™tes frapp√© par leur beaut√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bien s√ªr, lorsque Wilbert m'a invit√© √† l'aider avec la machine d'assemblage de Rubik's Cube, je n'ai pas h√©sit√© une seconde, d'autant plus qu'√† cette √©poque j'avais d√©j√† </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d√©couvert</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> une passion pour les cubes color√©s. A cette √©poque, il travaillait d√©j√† sur la machine depuis plus de 4 (!) Ans, mais la partie logicielle √©tait encore √† √©crire.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je n'avais aucune exp√©rience de la programmation pour Raspberry Pi et Arduino, mais dans l'ensemble, la t√¢che m'a sembl√© assez simple. </font><font style="vertical-align: inherit;">Bien s√ªr, j'avais tort :)</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mat√©riel</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La machine elle-m√™me est construite √† l'aide d'un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">syst√®me FAC modulaire</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">C'est quelque chose comme un designer sovi√©tique, mais cr√©√© pour prototyper des m√©canismes s√©rieux et complexes. </font><font style="vertical-align: inherit;">Dans la seconde moiti√© du si√®cle dernier, il a √©t√© tr√®s activement utilis√© dans les laboratoires de Philips et d'autres entreprises et universit√©s. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au moment o√π j'ai rencontr√© Wilbert, il avait d√©j√† essay√© √† deux reprises de ¬´faire revivre¬ª la voiture. </font><font style="vertical-align: inherit;">Les deux fois, des √©tudiants de l'Universit√© d'Amsterdam ont repris l'affaire et, malheureusement, les deux fois, ils se sont d√©sint√©ress√©s du projet apr√®s plusieurs tentatives infructueuses. </font><font style="vertical-align: inherit;">L‚Äôun d‚Äôeux a m√™me d√©fendu un dipl√¥me de licence sur ce sujet, malgr√© le fait que la machine n‚Äôait pas pu r√©cup√©rer le cube (levez la main √† ceux qui se reconnaissent ici).</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Microcontr√¥leur</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tout d'abord, nous avons d√©cid√© d'utiliser le Raspberry Pi au lieu de l'Arduino. </font><font style="vertical-align: inherit;">Cela est principalement d√ª au fait que les algorithmes ¬´intelligents¬ª pour r√©soudre le Rubik's Cube n√©cessitent une quantit√© importante de m√©moire et de puissance de processeur. </font><font style="vertical-align: inherit;">Dans les tentatives pr√©c√©dentes, un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algorithme</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> primitif √† </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">trois couches a √©t√© utilis√©</font></a><font style="vertical-align: inherit;"> , mais cette fois, nous avons d√©cid√© d'utiliser </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'algorithme de Kotsemba</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">De plus, je ne voulais pas vraiment tout √©crire en do (bien que je devais en partie le faire). </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/53b/142/5d4/53b1425d42fca6feb8f98819c3f4ff39.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans la version standard du Raspberry Pi, nous n'avions pas suffisamment de broches pour connecter tous les moteurs disponibles, nous avons donc command√© le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kit de d√©veloppement</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Au fait, je conseille fortement: non seulement plus de broches, mais elles sont, √† mon avis, plus logiques √† part. </font><font style="vertical-align: inherit;">De plus, cette carte a deux connecteurs pour la cam√©ra au lieu d'un.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La premi√®re version du scanner</font></font></h3><br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/465/d0e/05d/465d0e05d87cd5c11a732f3d448ac6b4.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pour lire la configuration initiale du cube, un p√©riph√©rique de num√©risation √©tait n√©cessaire. L'id√©e est tr√®s simple: √† son tour, nous √©clairons la surface du cube avec trois LED: rouge, verte et bleue. Chaque fois, nous mesurons la lumi√®re r√©fl√©chie √† l'aide d'une r√©sistance photosensible. Th√©oriquement, nous devrions obtenir des valeurs RVB qui peuvent √™tre utilis√©es pour reconna√Ætre la couleur du carr√©. D'apr√®s les programmeurs pr√©c√©dents, nous avons encore du code de preuve de concept pour Arduino, qui, semble-t-il, fonctionnait m√™me sous certaines conditions.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le premier probl√®me que nous avons rencontr√© √©tait un d√©calage de tension. Comme vous le savez, l'unit√© logique sur les broches Arduino est de 5 V, tandis que le Raspberry Pi est de 3,3 V. Heureusement, les contr√¥leurs de pilote de moteur pas √† pas que nous avons utilis√©s ont continu√© de fonctionner malgr√© la modification de l'amplitude des impulsions. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'est av√©r√© beaucoup plus critique que le Raspberry Pi ne dispose pas d'entr√©es analogiques. Pour cette raison, la framboise ne peut pas simplement prendre et lire la tension √† la photor√©sistance. C'est probablement √©vident pour ceux qui ont au moins rencontr√© cela, mais au d√©but je n'y ai m√™me pas pens√©. √Ä la recherche d'une solution sur le net, nous sommes tomb√©s sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cet article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">En bref, nous ajoutons un condensateur au circuit et mesurons le temps pendant lequel il sera charg√© de z√©ro √† une unit√© logique (nous pouvons le d√©tecter √† l'aide d'une broche num√©rique). </font><font style="vertical-align: inherit;">Le temps de charge sera proportionnel √† la r√©sistance de la photor√©sistance, nous pouvons donc juger de la quantit√© de lumi√®re. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/40a/8d9/d2b/40a8d9d2b30365e9e4fd4c3cf3615798.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Cette approche est non seulement terriblement peu fiable (prendre du temps dans un script Python Python sur Linux avec un tas de processus d'arri√®re-plan est une chose ingrate), mais elle est √©galement impossible √† long. </font><font style="vertical-align: inherit;">Afin de lisser les √©carts al√©atoires dans les lectures, nous avons d√ª lire plusieurs fois, nous d√©barrasser des </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">valeurs aberrantes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et faire la moyenne des valeurs restantes. </font><font style="vertical-align: inherit;">Cependant, nous avons quand m√™me r√©ussi √† faire fonctionner ce scanner:</font></font><br>
<br>
<iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://www.youtube.com/embed/z4iJ0hNQulo%3Ffeature%3Doembed&amp;usg=ALkJrhjpDogQlyl_7Wsg35AK0e-omujBRQ" frameborder="0" allowfullscreen=""></iframe><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La deuxi√®me version (finale) du scanner</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le scanner √† condensateur fonctionnait assez bien, mais il √©tait tr√®s lent. Il a fallu environ deux minutes pour analyser l'int√©gralit√© du Rubik's Cube, et au moment o√π l'analyse a √©t√© termin√©e, le spectateur avait perdu tout int√©r√™t. Par cons√©quent, nous avons d√©cid√© de revenir √† l'Arduino et avons achet√© un petit Arduino Mini sp√©cifiquement pour contr√¥ler le scanner. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/21a/9e5/775/21a9e5775f5e15affb6792ae5f67b984.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se faire des amis Arduino avec le Raspberry Pi s'est av√©r√© incroyablement simple: deux fils, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un convertisseur de tension</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> entre eux et le tour est jou√© - nous avons une interface s√©rie. Et si vous vissez un protocole </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Min</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simple </font><font style="vertical-align: inherit;">, la programmation de cette entreprise est un plaisir.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai transf√©r√© toute la logique de contr√¥le du scanner vers l'Arduino. </font><font style="vertical-align: inherit;">La vitesse de num√©risation a consid√©rablement augment√©. </font><font style="vertical-align: inherit;">Gr√¢ce aux entr√©es analogiques, nous pouvons lire la tension directement √† partir des photor√©sistances, et ces valeurs sont tr√®s pr√©cises. </font><font style="vertical-align: inherit;">De plus, comme l'Arduino est mont√© directement sur le scanner, nous avons besoin de beaucoup moins de fils du scanner au Raspberry Pi!</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Algorithme de construction</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assembler le Rubik's Cube d'un point de vue math√©matique est une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t√¢che</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> assez </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">laborieuse</font></a><font style="vertical-align: inherit;"> . Bien s√ªr, nous parlons de trouver la solution optimale, et non "certains". J'ai √©t√© surpris quand j'ai d√©couvert que le nombre de Dieu (la limite inf√©rieure exacte du nombre de mouvements n√©cessaires pour r√©soudre un cube arbitraire) n'a √©t√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">trouv√© qu'en 2010</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans ce projet, nous voulions r√©duire le temps total n√©cessaire au calcul de la solution et √† l'assemblage, donc ni un simple </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algorithme √† trois couches ne</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nous a approch√©s </font><font style="vertical-align: inherit;">(il fonctionne rapidement, mais donne des solutions d'une centaine de coups), ni un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algorithme optimal</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (les solutions sont courtes, mais le processus de rendu sur Raspberry Pi prendrait une √©ternit√©). En cons√©quence, nous nous sommes install√©s sur le magnifique </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">algorithme "en deux phases"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le math√©maticien allemand Herbert Kociemba. Il est capable de prendre des d√©cisions sous-optimales (en moyenne 20 coups), tout en respectant un d√©lai raisonnable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sur le site de l'auteur, vous trouverez l'impl√©mentation de l'algorithme en Java. La premi√®re chose que j'ai faite a √©t√© de traduire ce code en Python. Ce n'√©tait pas du tout difficile, car la plupart des programmes sont des op√©rations math√©matiques et une √©num√©ration des options. Cependant, je n'ai pas pris en compte que l'algorithme n√©cessite </font></font><i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">vraiment beaucoup de</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ressources. Trouver une solution au premier lancement a pris plus d'une minute (!) Sur mon ordinateur portable. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sous </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pypy</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec JIT activ√©, la solution a pris 1 seconde sur l'ordinateur portable, mais sur le Raspberry Pi, cela a pris environ une minute. </font><font style="vertical-align: inherit;">Apr√®s plusieurs tentatives pour acc√©l√©rer le travail du programme Python (numpy, multiprocessing), j'ai d√©cid√© de r√©√©crire l'algorithme en C. N√©anmoins, la solution prend maintenant 1-2 secondes, m√™me en Raspberry. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai post√© les deux impl√©mentations de l'algorithme sur </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GitHub</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Commande de machine</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'√©tape suivante consistait √† √©crire un programme qui contr√¥lerait la partie m√©canique: d√©placer les moteurs, en tenant compte des rapports d'engrenage et des limitations du m√©canisme (par exemple, les supports lat√©raux ne peuvent √™tre tourn√©s que lorsque le fond est dans une certaine position, sinon cela interf√®re). </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/b89/c9b/3e0/b89c9b3e0780fae3e7dd5b28a8aa209d.png" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En plus du programme principal, j'ai cr√©√© un shell interactif qui m'a fait gagner beaucoup de temps lors du d√©bogage. </font><font style="vertical-align: inherit;">En g√©n√©ral, cette partie n'√©tait pas inhabituelle en termes de programmation. </font><font style="vertical-align: inherit;">Pour d√©boguer l'analyse, j'ai g√©n√©r√© les r√©sultats sous forme d'images.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Num√©risation et reconnaissance des couleurs</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jusque-l√†, tout √©tait int√©ressant, mais pas difficile. </font><font style="vertical-align: inherit;">Deux semaines apr√®s le d√©but des travaux, la machine pouvait d√©j√† collecter un cube d'un √©tat donn√©. </font><font style="vertical-align: inherit;">Il ne restait plus qu'√† apprendre √† lire la configuration initiale du cube √† l'aide d'un scanner. </font><font style="vertical-align: inherit;">Nous avions d√©j√† un programme ¬´fonctionnel¬ª pour Arduino, donc nous ne nous attendions pas √† des surprises. </font><font style="vertical-align: inherit;">Cependant, cette partie du projet s'est av√©r√©e √™tre la plus difficile, et cela nous a pris encore 2 mois de travail.</font></font><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Indications de la photor√©sistance</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je l'ai √©crit ci-dessus, nous avons commenc√© avec un circuit de scanner avec des condensateurs. L'erreur de cette approche √©tait horrible, donc pour obtenir des valeurs utilisables, j'ai d√ª prendre des mesures plusieurs fois, puis me d√©barrasser des √©missions. Apr√®s cela, nous avons obtenu quelque chose comme √ßa (c'est le r√©sultat de la num√©risation du cube assembl√© dans une pi√®ce sombre): </font></font><br>
<br>
<img src="https://habrastorage.org/files/d0d/0eb/467/d0d0eb4676f54a8c9319882658278664.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous pouvez le voir, le r√©sultat est loin d'√™tre id√©al. Premi√®rement, les valeurs pour la m√™me couleur sont diff√©rentes √† diff√©rentes positions, car les photor√©sistances et les LED ¬´regardent¬ª dans des directions l√©g√®rement diff√©rentes. Deuxi√®mement, certaines couleurs sont tr√®s proches les unes des autres dans l'espace colorim√©trique, et parfois les plages de valeurs se chevauchent (par exemple, l'orange et le rouge donnent parfois la m√™me valeur). Et enfin, les lectures sont tr√®s d√©pendantes de l'√©clairage ext√©rieur.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Visuellement, l'erreur du scanner sur les condensateurs peut √™tre vue dans le diagramme suivant (en g√©n√©ral, il y a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">une version interactive ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ): </font></font><br>
<br>
<img src="https://habrastorage.org/files/8a6/489/4fd/8a64894fd9a249a1a297ac2743930120.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Avec le recul, je me demande comment nous avons r√©ussi √† faire fonctionner le scan avec de tels r√©sultats, bien que cela ait n√©cessit√© un √©talonnage soigneux et d√©licat des valeurs en question ira un peu plus bas. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme je l'ai dit, le scanner √† condensateur a fonctionn√©, mais il a √©t√© tr√®s lent. </font><font style="vertical-align: inherit;">Lorsque nous l'avons remplac√© par un autre, avec l'Arduino int√©gr√©, les lectures sont devenues beaucoup plus ¬´encombr√©es¬ª (la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">version interactive est ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ):</font></font><br>
<br>
<img src="https://habrastorage.org/files/c6e/0a8/8b5/c6e0a88b595747aa87ef2c35bdf634fe.png"><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√âtalonnage et regroupement des lectures</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant que nous avions les lectures RGB brutes des photor√©sistances, nous devions identifier les couleurs nous-m√™mes afin d'alimenter la configuration du cube √† l'algorithme de construction. Deux approches diff√©rentes ont √©t√© imm√©diatement sugg√©r√©es ici: l'utilisation d'intervalles de couleurs et l'algorithme de clustering.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La premi√®re approche est une solution ¬´frontale¬ª: il a √©t√© possible de d√©terminer exp√©rimentalement les intervalles de valeurs de chaque c√¥t√© du cube (en fait, de diviser l'espace colorim√©trique en zones disjointes), puis de combiner simplement les valeurs selon leur appartenance √† un certain intervalle. Dans ce cas, chacune des 9 positions possibles sur le bord du cube doit √™tre consid√©r√©e s√©par√©ment. Cette m√©thode est tr√®s facile √† programmer, mais elle pr√©sente deux inconv√©nients importants. Premi√®rement, il nous lie √† des couleurs sp√©cifiques, ce qui signifie que nous ne pouvons collecter qu'un cube Rubik strictement d√©fini. Et deuxi√®mement, les intervalles de valeurs possibles d√©pendent beaucoup de l'√©clairage ext√©rieur. De plus, nous avons constat√© que, selon la lumi√®re ambiante, la m√™me lecture peut correspondre √† des couleurs diff√©rentes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La deuxi√®me approche n√©cessite un √©talonnage pr√©liminaire des valeurs afin que la m√™me couleur donne les m√™mes r√©sultats dans les 9 positions sur le bord du cube. </font><font style="vertical-align: inherit;">Dans ce cas, nous pouvons utiliser </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l'algorithme de clustering</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour combiner les valeurs en 6 groupes. </font><font style="vertical-align: inherit;">En m√™me temps, peu importe les couleurs dans lesquelles le cube est peint, si seulement elles sont diff√©rentes. </font><font style="vertical-align: inherit;">Malheureusement, cette m√©thode a √©galement d√ª √™tre ¬´rejet√©e¬ª en raison de la nature probabiliste des algorithmes de clustering: ils peuvent produire un ¬´bon¬ª r√©sultat, mais ne garantissent pas sa pr√©cision. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les deux approches ont leurs avantages et leurs inconv√©nients, nous avons donc utilis√© quelque chose entre les deux:</font></font><br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tout d'abord, nous effectuons un √©talonnage artificiel des lectures du scanner pour normaliser les valeurs. </font><font style="vertical-align: inherit;">Les coefficients sont obtenus exp√©rimentalement.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">convertir les valeurs RVB r√©sultantes en HSV</font></font></li>
<li>   ,    S ()</li>
<li>     </li>
<li>    ,     .</li>
</ol><br>
<br>
<h3>   </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
M√™me avec un bon algorithme de clustering, l'analyse √©chouait souvent en raison des conditions environnementales. </font><font style="vertical-align: inherit;">L'algorithme, calibr√© dans une pi√®ce sombre, ne pouvait pas faire face √† la t√¢che dans des conditions diurnes, et vice versa. </font><font style="vertical-align: inherit;">De plus, si l'√©clairage ext√©rieur √©tait tr√®s lumineux (lumi√®re directe du soleil), le scanner cessait g√©n√©ralement de fonctionner, car l'influence des LED devenait √† peine perceptible. </font><font style="vertical-align: inherit;">Wilbert a fait un travail tr√®s minutieux en isolant le scanner de la lumi√®re ambiante. </font><font style="vertical-align: inherit;">J'ai d√ª passer par 3 it√©rations: chaque fois nous pensions que ce serait suffisant, et chaque fois nous trouvions un autre espace √† travers lequel l'√©clairage externe tombait sur la photor√©sistance.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/d4c/a1e/795/d4ca1e795ba1c28d27a3fa8ebbc8c5cb.jpg" alt="image"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclusion</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Travailler sur ce projet √©tait incroyablement excitant. C'est tellement g√©nial de voir la voiture prendre vie sous vos yeux, et c'est particuli√®rement cool de voir comment elle fonctionne, justifiant tous vos efforts. Cependant, cela ne peut pas √™tre compar√© √† la r√©serve de connaissances que nous avons r√©ussi √† acqu√©rir dans le processus. Je n'aurais pas pu imaginer que je devrais √©tudier un tas de mat√©riaux sur l'√©lectronique, la m√©canique, l'alg√®bre et m√™me les statistiques math√©matiques, et en chemin pour trouver une douzaine d'utilitaires et de biblioth√®ques utiles. C'est pourquoi je suis si heureux d'avoir eu l'opportunit√© de travailler sur ce projet.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/238/e22/a67/238e22a6758025d7fbda1f52441b75a2.jpg" alt="image"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quoi qu'il en soit, cette voiture n'est qu'un prototype. </font><font style="vertical-align: inherit;">Nous ne nous sommes pas fix√© pour objectif de battre le record de vitesse, et nous n'avons certainement pas r√©alis√© tout le potentiel des pi√®ces m√©caniques. </font><font style="vertical-align: inherit;">Mais nous allons certainement essayer de le faire dans la prochaine version de la machine, sur laquelle nous avons d√©j√† commenc√© √† travailler. </font><font style="vertical-align: inherit;">L√†, nous allons utiliser l'appareil photo pour la num√©risation, et la conception des manipulateurs a subi des changements importants. </font><font style="vertical-align: inherit;">Et bien s√ªr, si vous avez des questions, des suggestions ou des conseils, je serai heureux de les entendre dans les commentaires.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr384503/">https://habr.com/ru/post/fr384503/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr384489/index.html">–ù–æ–≤—ã–π —Å–∞–º—ã–π –±—ã—Å—Ç—Ä—ã–π —Ç–≤–µ—Ä–¥–æ—Ç–µ–ª—å–Ω—ã–π –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å –æ—Ç –∫–æ—Ä–µ–π—Å–∫–æ–≥–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è ‚Äî Samsung 950 Pro</a></li>
<li><a href="../fr384491/index.html">Les robots se garent mieux que les humains</a></li>
<li><a href="../fr384493/index.html">Montre √©lectronique de style Qlocktwo</a></li>
<li><a href="../fr384499/index.html">Acer Revo One: un ordinateur miniature avec un large spectre d'action</a></li>
<li><a href="../fr384501/index.html">Du son dans votre poche pour 500 000r: Astell & Kern AK380 + Astell & Kern Layla</a></li>
<li><a href="../fr384505/index.html">√âcouteurs avec technologie de conduction osseuse osseuse: quels sont-ils, pourquoi sont-ils n√©cessaires et o√π acheter</a></li>
<li><a href="../fr384507/index.html">–ü—Ä–æ—Å—Ç–æ–π –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞ Amazon –ø–æ–≤–ª–µ–∫ –∑–∞ —Å–æ–±–æ–π —Å–±–æ–π –≤ —Ä–∞–±–æ—Ç–µ Netflix, Heroku –∏ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤</a></li>
<li><a href="../fr384509/index.html">NVIDIA va installer sa meilleure carte vid√©o embarqu√©e GeForce GTX 980</a></li>
<li><a href="../fr384511/index.html">Rake de d√©part - comment nous avons ouvert le terrain de jeu</a></li>
<li><a href="../fr384513/index.html">Stations mobiles solaires √† gaz EV ARC - r√©alit√©s et perspectives</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>