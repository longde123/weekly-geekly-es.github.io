<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฉ๐ฝโโ๏ธ ๐ด๐ฝ ๐ Microsoft ML Spark: ุงูุชุฏุงุฏ Spark ุงูุฐู ูุฌุนู SparkML ุฃูุซุฑ ุฅูุณุงููุฉ ู LightGBM ูููุงูุฃุฉ ๐คถ๐ป ๐๐ผ ๐ป</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุนุฑู ุงููุซูุฑ ููู ุนูููุง ูุน Spark ML ุฃู ุจุนุถ ุงูุฃุดูุงุก ุงูุชู ุฃูุฌุฒููุง ููุงู "ููุณุช ูุงุฌุญุฉ ุชูุงููุง". 
 ุฃู ูู ุชูุนู ุนูู ุงูุฅุทูุงู. ูุชูุซู ูููู ูุทูุฑู Spark ูู ุฃู SparkML...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Microsoft ML Spark: ุงูุชุฏุงุฏ Spark ุงูุฐู ูุฌุนู SparkML ุฃูุซุฑ ุฅูุณุงููุฉ ู LightGBM ูููุงูุฃุฉ</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/raiffeisenbank/blog/456668/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุนุฑู ุงููุซูุฑ ููู ุนูููุง ูุน Spark ML ุฃู ุจุนุถ ุงูุฃุดูุงุก ุงูุชู ุฃูุฌุฒููุง ููุงู "ููุณุช ูุงุฌุญุฉ ุชูุงููุง". <br>  ุฃู ูู ุชูุนู ุนูู ุงูุฅุทูุงู.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชูุซู ูููู ูุทูุฑู Spark ูู</a> ุฃู SparkML ูู ุงููุธุงู ุงูุฃุณุงุณู ุ ููุฌุจ ุฃู ุชููู ุฌููุน ุงูููุญูุงุช ุญุฒู ูููุตูุฉ.  ููู ูุฐุง ููุณ ูุฑูุญูุง ุฏุงุฆููุง ุ ูุฃู Data Scientist ูุงููุญูููู ูุฑูุฏูู ุงูุนูู ุจุงุณุชุฎุฏุงู ุฃุฏูุงุช ูุฃูููุฉ (Jupter ุ Zeppelin) ุ ุญูุซ ููุฌุฏ ูุนุธู ูุง ูู ูุทููุจ.  ูุง ูุฑูุฏูู ุฌูุน ูููุงุช JAR 500 ููุฌุงุจุงูุช ูุน ุชุฌููุน maven ุฃู ุชูุฒูู ุงูุชุจุนูุงุช ูู ุฃูุฏููู ูุฅุถุงูุชูุง ุฅูู ูุนููุงุช ุจุฏุก ุชุดุบูู Spark.  ูุฏ ูุชุทูุจ ุงูุนูู ุงูุฏููู ูุน ุฃูุธูุฉ ุฅูุดุงุก ูุดุฑูุน JVM ุงููุซูุฑ ูู ุงูุฌููุฏ ุงูุฅุถุงููุฉ ูู ูุจู ุงููุญูููู ู DataScientists ุงูุฐูู ุงุนุชุงุฏูุง ุนูู Jupyter / Zeppelin.  ูู ุงููุงุถุญ ุฃู ูุทุงูุจุฉ DevOps ููุณุคููู ุงููุชูุฉ ุจูุถุน ูุฌููุนุฉ ูู ุงูุญุฒู ุนูู ุนูุฏ ุญุณุงุจ ููุฑุฉ ุณูุฆุฉ.  ูุนุฑู ุฃู ุดุฎุต ูุชุจ ููุญูุงุช ูู SparkML ุจููุฑุฏู ุนุฏุฏ ุงูุตุนูุจุงุช ุงูุฎููุฉ ุงูููุฌูุฏุฉ ูู ุงููุตูู ูุงูุฃุณุงููุจ ุงููููุฉ (ูุงูุชู ูุณุจุจ ูุง ุฎุงุตุฉ [ml]) ุ ูุงููููุฏ ุนูู ุฃููุงุน ุงููุนููุงุช ุงููุฎุฒูุฉ ุ ุฅูุฎ </p><br><p style=";text-align:right;direction:rtl">  ููุจุฏู ุฃูู ุงูุขู ุ ูุน ููุชุจุฉ MMLSpark ุ ุณุชููู ุงูุญูุงุฉ ุฃุณูู ููููุงู ุ ูุงูุญุฏ ุงูุฃุฏูู ูุฅุฏุฎุงู ุงูุชุนูู ุงูุขูู ุงููุงุจู ููุชุทููุฑ ุจุงุณุชุฎุฏุงู SparkML ู Scala ุฃูู ููููุงู. </p><a name="habracut"></a><br><h2 id="vvedenie" style=";text-align:right;direction:rtl">  ููุฏูุฉ </h2><br><p style=";text-align:right;direction:rtl"> ูุธุฑูุง ูุนุฏุฏ ูู ุงูุตุนูุจุงุช ุ ูุถูุงู ุนู ูุฌููุนุฉ ููููุฉ ูู ุงูุทุฑู ูุงูุญููู ุงูุฌุงูุฒุฉ ูู SparkML ุ ุชูุชุจ ุงูุนุฏูุฏ ูู ุงูุดุฑูุงุช ุงูุชุฏุงุฏุงุชูุง ูู Spark.  ุฃุญุฏ ุงูุฃูุซูุฉ ุนูู ุฐูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PravdaML</a> ุ ุงูุฐู ูุชู ุชุทููุฑู ูู Odnoklassniki ูุงูุฐู ุ ุจูุงุกู ุนูู ุชูููู ุณุฑูุน ููุง ูู ููุฌูุฏ ุนูู GitHub ุ ูุจุฏู ูุงุนุฏุงู ููุบุงูุฉ.  ูุณูุก ุงูุญุธ ุ ูุฅู ูุนุธู ูุฐู ุงูุญููู ุฅูุง ูุบููุฉ ุฃู ููุชูุญุฉ ุจุดูู ุนุงู ุ ูููู ููุณ ูุฏููุง ุงููุฏุฑุฉ ุนูู ุงูุชุซุจูุช ูู ุฎูุงู Maven / sbt ููุซุงุฆู ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ุ ููุง ูุฌุนู ูู ุงูุตุนุจ ููุบุงูุฉ ุงูุนูู ูุนูู. </p><br><p style=";text-align:right;direction:rtl">  ุงูููู ููุธุฑ ุฅูู ููุชุจุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">MMLSpark</a> . </p><br><p style=";text-align:right;direction:rtl">  ุณููุธุฑ ุ ูุงูุนุงุฏุฉ ุ ูู ูุซุงู ูููุฉ ุชุตููู ุฑูุงุจ ุงูุณูููุฉ ุชุงูุชุงููู.  ุงููุฏู ูู ุฅุธูุงุฑ ุฃูุจุฑ ุนุฏุฏ ูููู ูู ููุฒุงุช ููุชุจุฉ MMLSpark ุ ูููุณ ุฐูู <del>  ุถุฑุจ ุณูุชุง ุนูู ImageNet </del>  ุชุธูุฑ ุงูุชุนูู ุขูุฉ ุจุงุฑุฏุฉ.  ูุฐูู ุณูู ุชูุชุงููู ุงูููุงู ุจู. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/rg/bt/sf/rgbtsf7j0ovmfa5lpjkfpfapzti.jpeg"></p><br><p style=";text-align:right;direction:rtl">  ุชุญุชูู ุงูููุชุจุฉ ููุณูุง ุนูู ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ุฃุตููุฉ ูู Scala ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชูุซูู</a> ) ุ ู Python API ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชูุซูู</a> ) ุ ูุงุณุชูุงุฏุงู ุฅูู ุจุนุถ ุงูุฃูุงูู ูู ูุณุชูุฏุน GitHub ุ ุณุชุชููุฑ ูุฑูุจูุง ูุงุฌูุฉ ุจุฑูุฌุฉ ุชุทุจููุงุช ูู R. </p><br><p style=";text-align:right;direction:rtl">  ููุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุซุงู ุฌูุฏ ูุฃุฌูุฒุฉ ุงูููุจููุชุฑ ุงููุญูููุฉ ูู</a> ูุดุฑูุน ุฌูุซุจ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">(PySpark + Jupyter)</a> ุ ููููุง ุณูุฐูุจ ูู ุงูุงุชุฌุงู ุงูุขุฎุฑ.  ููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชุจ</a> Dmitry Bugaychenko ุ ุฅุฐุง ููุช ุจุงูุชุทููุฑ ูุตุงูุญ Spark ุ ูููุงู ูู ุงูุฃุณุจุงุจ ูุงุณุชุฎุฏุงู Scala ููุฐุง ุ ุนูุงูุฉ ุนูู ุฐูู ุ ุชุณูุญ ูู Scala ุจุชุนุฑูู ูุญููู ูููุฏุฑู ุนูู ูุญู ุฃูุซุฑ ููุงุกุฉ ูุฃูุซุฑ ูุฑููุฉ ูุชุถูููููุง ูู SparkML Pipeline ุ ูููู ููู ุชุนูู ุจุจุทุก / pandas code ูู UDF (ุชู ุงุณุชุฏุนุงุคู ุงููููุงุช ุงูุชูููุฐูุฉ ูู JVM) ูุฏ ุชูุช ูุชุงุจุฉ ุงููุซูุฑ ุจุงููุนู. </p><br><h2 id="kratko-ob-ustanovke" style=";text-align:right;direction:rtl">  ููุฌุฒ ุงูุชุซุจูุช </h2><br><p style=";text-align:right;direction:rtl">  ุงูููุจููุชุฑ ุงููุญููู ุจุฃูููู ูุชุงุญ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> .  ููุนูู ูุน Titanic ุ ุชููู ุตูุฑุฉ Zeppelin Docker ุงูุชู ุชุนูู ูุญูููุง ุนูู ุฌูุงุฒ ููุจููุชุฑ ูุญููู ูุน ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ููุนููู.  ุนุงูู ุงููููุงุก ูููู ุงูุนุซูุฑ ุนูููุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> .  ููุชุจุฉ MMLSpark ููุณุช ูู Maven Central ุ ูููู ูู ุญุฒู ุดุฑุงุฑุฉ ุ ููุฅุถุงูุชูุง ุฅูู Zeppelin ุ ูุฌุจ ุชุดุบูู ุงููุชูุฉ ุงูุชุงููุฉ ูู ุจุฏุงูุฉ ุงูููุจููุชุฑ ุงููุญููู: </p><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">%spark.dep z.addRepo("bintray.com").url("http://dl.bintray.com/spark-packages/maven/") z.load("Azure:mmlspark:0.17")</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู ุงูููุชุจุฉ ุชุชูุชุน ุจุชูุงูู ุฎููู ููุชุงุฒ: ุนูู ุนูุณ ุ ุนูู ุณุจูู ุงููุซุงู ุ XGBoost4j-spark ุ ุงูุชู ุชุชุทูุจ ูุง ูุง ููู ุนู Spark 2.3+ ุ ุญุตู ูุฐุง ุงูุดูุก ุนูู Spark 2.2.1 ุ ุงูุฐู ุฌุงุก ูุน ุตูุฑุฉ Zeppelin Docker ุ ูุฃู ุตุนูุจุงุช ูู ุฃูุงุญุธ. </p><br><p style=";text-align:right;direction:rtl">  <strong>ููุงุญุธุฉ:</strong> ูุนุธู ููุชุจุฉ MMLSpark ูุฎุตุตุฉ ูุงุณุชุฏูุงู ุงูุดุจูุงุช ุนูู ุงููุชูุฉ ุ ูุงูุชู ููุฌุฏ ุจูุง CNTK (ูุงูุชู ุ ุจูุงุกู ุนูู ุงููุซุงุฆู ุ ูุฌุจ ุฃู ุชูุฑุฃ ุทุฑุฒ cntk ุงูุฌุงูุฒุฉ) ููุชูุฉ OpenCV ุถุฎูุฉ.  ุณูุฑูุฒ ุนูู ุงููุฒูุฏ ูู ุงูููุงู ุงูุฏููููุฉ ููุญุงูู "ูุญุงูุงุฉ" ุงูุญุงูุฉ ุนูุฏูุง ูููู ูุฏููุง ุตูุงุฆู ุถุฎูุฉ ูู ุงูุจูุงูุงุช ุงููุฌุฏููุฉ ุงูููุฌูุฏุฉ ูู HDFS ูู ุดูู .csv ุฃู ุฌุฏุงูู ุฃู ุจุชูุณูู ุขุฎุฑ.  ูุฐูู ุ ูุญุชุงุฌ ุฅูู ูุนุงูุฌุชูุง ูุณุจููุง ูุจูุงุก ูููุฐุฌ ุ ูู ุญูู ุฃู ูุฐู ุงูุจูุงูุงุช ูุง ุชูุณุฌู ูุน ุฐุงูุฑุฉ ุฌูุงุฒ ูุงุญุฏ.  ูุฐูู ุ ุณูู ูููู ุจุชูููุฐ ุฌููุน ุงูุฅุฌุฑุงุกุงุช ุนูู ุงููุชูุฉ. </p><br><h2 id="chtenie-i-razvedochnyy-analiz" style=";text-align:right;direction:rtl">  ูุฑุงุกุฉ ูุชุญููู ุงูุฐูุงุก </h2><br><p style=";text-align:right;direction:rtl">  ุจุดูู ุนุงู ุ Spark + Zeppelin ููุณุช ุณูุฆุฉ ุนูู ุงูุฅุทูุงู ููููููุง ุงูุชุนุงูู ูุน ูููุฉ EDA ุ ููููุง ุณูุญุงูู ุชูุณูุน ูุฏุฑุงุชูุง.  ุฃููุงู ุ ูุณุชูุฑุฏ ุงููุฆุงุช ุงูุชู ูุญุชุงุฌูุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููู ูู spark.sql.types ูุฅุนูุงู ูุฎุทุท ููุฑุงุกุฉ ุงูุจูุงูุงุช ุจุดูู ุตุญูุญ </li><li style=";text-align:right;direction:rtl">  ูู ุฐูู ูู spark.sql.functions ุฅูู ุงููุตูู ุฅูู ุงูุฃุนูุฏุฉ ูุงุณุชุฎุฏุงู ูุธุงุฆู ูุฏูุฌุฉ </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">com.microsoft.ml.spark.SummarizeData</a> ุ ูุงูุชู ูููู ุชุณููุชูุง ุชูุงุธุฑูุฉ pandas.DataFrame.describe </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.microsoft.ml.spark.<span class="hljs-type"><span class="hljs-type">SummarizeData</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.sql.functions._ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.sql.types._</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุฑุฃ ููููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> titanicSchema = <span class="hljs-type"><span class="hljs-type">StructType</span></span>( <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"Passanger"</span></span>, <span class="hljs-type"><span class="hljs-type">ShortType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"Survived"</span></span>, <span class="hljs-type"><span class="hljs-type">ShortType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"PClass"</span></span>, <span class="hljs-type"><span class="hljs-type">ShortType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"Name"</span></span>, <span class="hljs-type"><span class="hljs-type">StringType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"Sex"</span></span>, <span class="hljs-type"><span class="hljs-type">StringType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"Age"</span></span>, <span class="hljs-type"><span class="hljs-type">ShortType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"SibSp"</span></span>, <span class="hljs-type"><span class="hljs-type">ShortType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"Parch"</span></span>, <span class="hljs-type"><span class="hljs-type">ShortType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"Ticket"</span></span>, <span class="hljs-type"><span class="hljs-type">StringType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"Fare"</span></span>, <span class="hljs-type"><span class="hljs-type">FloatType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"Cabin"</span></span>, <span class="hljs-type"><span class="hljs-type">StringType</span></span>) :: <span class="hljs-type"><span class="hljs-type">StructField</span></span>(<span class="hljs-string"><span class="hljs-string">"Embarked"</span></span>, <span class="hljs-type"><span class="hljs-type">StringType</span></span>) :: <span class="hljs-type"><span class="hljs-type">Nil</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> train = spark .read .schema(titanicSchema) .option(<span class="hljs-string"><span class="hljs-string">"header"</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>) .csv(<span class="hljs-string"><span class="hljs-string">"/mountV/titanic/train.csv"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงูุขู ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุงูุจูุงูุงุช ููุณูุง ุ ููุฐูู ุญุฌููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs">println(<span class="hljs-string"><span class="hljs-string">s"Train shape is: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${train.count}</span></span></span><span class="hljs-string"> x </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${train.columns.length}</span></span></span><span class="hljs-string">"</span></span>) train.limit(<span class="hljs-number"><span class="hljs-number">5</span></span>).createOrReplaceTempView(<span class="hljs-string"><span class="hljs-string">"trainHead"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ููุงุญุธุฉ:</strong> ููุณุช ููุงู ุญุงุฌุฉ ุญููุง ูุงุณุชุฎุฏุงู createOrReplaceTempView ุนูุฏูุง ููููู ููุท ูุชุงุจุฉ .show (5).  ููู ุงูุนุฑุถ ูุฏูู ูุดููุฉ: ุนูุฏูุง ุชููู ุงูุจูุงูุงุช "ูุงุณุนุฉ" ุ ูุฅู ุงูุชูุซูู ุงููุตู ูููุญุฉ "ูุชุญุฑู" ุ ููุง ูุตุจุญ ุฃู ุดูุก ูุงุถุญูุง ุนูู ุงูุฅุทูุงู. </p><br><p style=";text-align:right;direction:rtl">  ุงุญุตู ุนูู ุญุฌู ุจูุงูุงุชูุง: <code>Train shape is: 891 x 12</code> <br>  ูุงูุขู ูู ุงูุฎููุฉ sql ูููููุง ุฃู ููุธุฑ ุฅูู ุฃูู 5 ุตููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="sql hljs">%sql <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> trainHead</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/qe/jc/wj/qejcwjvi65jp6xucnorcdfdmxo4.png"></p><br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ุฏุนูุง ูุฑู ุงูููุฎุต ุนูู ุทุงููุชูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">SummarizeData</span></span>() .setBasic(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) .setCounts(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) .setPercentiles(<span class="hljs-literal"><span class="hljs-literal">false</span></span>) .setSample(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) .setErrorThreshold(<span class="hljs-number"><span class="hljs-number">0.25</span></span>) .transform(train) .createOrReplaceTempView(<span class="hljs-string"><span class="hljs-string">"summary"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุชููุฒ ูุฆุฉ SummarizeData ุจุงูุนุฏูุฏ ูู ุงููุฒุงูุง ุนูู Dataset.describe ุงูุจุณูุท ุ ูุฃููุง ุชุชูุญ ูู ุญุณุงุจ ุนุฏุฏ ุงูููู ุงูููููุฏุฉ ูุงููุฑูุฏุฉ ุ ููุง ุชุชูุญ ูู ุชุญุฏูุฏ ุฏูุฉ ุญุณุงุจ ุงููููุงุช.  ูุฐุง ูููู ุฃู ูููู ุญุงุณูุง ุจุงููุณุจุฉ ููุจูุงูุงุช ุงููุจูุฑุฉ ุญูุง. <br><img src="https://habrastorage.org/webt/91/g4/8c/91g48c0oaqiuz8pjgklo38jaiis.png"></p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุจุนุถ ุงูุฃููุงุฑ ุงูุดุฎุตูุฉ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ุจุดูู ุนุงู ุ ุจุฏุง ูู ุดุฎุตููุง ุฃู Odnoklassniki ูู PravdaML ูุงู ูุฏูู ุชุทุจูู ุฃูุถู ููุชูุงุซููุฉ SummarizeData.  ูุงูุช Microsoft ุจุงูุทุฑููุฉ ุงูุณููุฉ ูุชุณุชุฎุฏู <code>org.apache.spark.sql.functions</code> ุ ุฅููุง ูุฌุฑุฏ ูู ูู ุดูุก ุจุดูู ูุฑูุญ ูู ูุตู ูุงุญุฏ.  ุจุงููุณุจุฉ ุฅูู Odnoklassniki ุ ูุชู ุชุทุจูู ุฐูู ูู ุฎูุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>VectorStatCollector</code></a> ุ ูุงูุฐู ูุชุทูุจ ุชุนูููุฉ ุจุฑูุฌูุฉ ุฃูุซุฑ ุชุนููุฏูุง ุนูุฏ ุงูุงุชุตุงู (ูุฌุจ ุนููู ุฃููุงู ุฅุถุงูุฉ ุฌููุน ุงูููุฒุงุช ุฅูู ูุชุฌู) ููุฏ ูุชุทูุจ ุนูููุงุช ุฅุถุงููุฉ (ุนูู ุณุจูู ุงููุซุงู ุ ูุฑูุถ <code>DecimalType</code> ูุถู <code>DecimalType</code> ).  ููู ูุฏู ุงูุชุฑุงุถ ุ ุจูุงุกู ุนูู ุชุฌุฑุจุชู ูุน Spark ุ ุฃู SummarizeData ูู MMLSpark ูุฏ ุชุชุนุทู ูุน ุฃุฎุทุงุก ูุซู <code>StackOverflow</code> ูู <code>org.apache.spark.sql.catalyst</code> ุฅุฐุง ูุงู ููุงู <strong>ุงูุนุฏูุฏ ูู</strong> ุงูุฃุนูุฏุฉ <strong>ุจุงููุนู</strong> ุ ูุงูุฑุณู ุงูุจูุงูู ููุญุณุงุจ ููุณ ุตุบูุฑุงู ุจุญููู ููุช ุงูุฅุทูุงู ( ุนูู ุงูุฑุบู ูู ุฃู ูุคูุงุก ุงููุดุฌุนูู ูู "ุงููุชุทุฑูุฉ" ูู Spark 2.4 ุ ุฅูุง ุฃููู ุฃุถุงููุง ุงููุฏุฑุฉ ุนูู ุฎูุถ ููุญุณููู ุงูุฑุณู ุงูุจูุงูู <code>Catalyst</code> ).  ุญุณููุง ุ ูุจุฏู ุฃูู ูุน ูุฌูุฏ ุนุฏุฏ <strong>ูุจูุฑ</strong> ูู ุงูุฃุนูุฏุฉ ุ ุณูููู ุฅุตุฏุงุฑ Microsoft ุฃุจุทุฃ.  ูููู ูุฐุง ุ ุจุงูุทุจุน ุ ูุฌุจ ุฃู ูุชู ุงูุชุญูู ุจุดูู ูููุตู. </p></div></div><br><h2 id="ochistka-dannyh" style=";text-align:right;direction:rtl">  ุชุทููุฑ ุงูุจูุงูุงุช </h2><br><p style=";text-align:right;direction:rtl">  ูู ุชูุชุงููู ุ ูู ุดูุก ูุงููุนุชุงุฏ - ูุฌููุนุฉ ูู ุฃุนูุฏุฉ ุงูุณูุณูุฉ ุชูุชูุฏ ุงูููู.  ูููุน ูู ุบูุฑ ูุงุฏุฑ ูู ุงูุจูุงูุงุช (ูุจุฏู ุฃู ูุฐุง ุงูุฅุตุฏุงุฑ ูุนูู ูู ุงูุจูุงูุงุช ููุณุช ูุญุฏุฏุฉ ููุบุงูุฉ) - 25 ุฃุณุทุฑ ูู ุงูููู ุงูููููุฏุฉ.  ุฃููุงู ุ ูู ุจุฅุตูุงุญ ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> trainFiltered = train.filter(!(isnan(col(<span class="hljs-string"><span class="hljs-string">"Survived"</span></span>)) || isnull(col(<span class="hljs-string"><span class="hljs-string">"Survived"</span></span>))))</code> </pre> <br><h3 id="obrabotka-strokovyh-dannyh" style=";text-align:right;direction:rtl">  ุณูุณูุฉ ูุนุงูุฌุฉ ุงูุจูุงูุงุช </h3><br><p style=";text-align:right;direction:rtl">  ุจูุฏุฑ ูุง ุฃุชุฐูุฑ ุ ูุงูุช ุงูุณูุงุช ุงูุชู ุชู ุงูุญุตูู ุนูููุง ูู ุญููู <code>Name</code> and <code>Cabin</code> ูู ุงูุฃูุถู ูู Titanic.  ููููู ุชูููุฑูุง ูุซูุฑูุง ุ ููููุง ุณููุชุตุฑ ุนูู ุนุฏุฏ ูููู ุ ุญุชู ูุง ูุนุทู ุฃูุซูุฉ ุนูู ููุณ ุงูููุฏ ุชูุฑูุจูุง. </p><br><p style=";text-align:right;direction:rtl">  ุนุงุฏุฉ ูุง ูููู ูู ุงูููุงุณุจ ุงุณุชุฎุฏุงู ุงูุชุนุจูุฑุงุช ุงูุนุงุฏูุฉ ููุซู ูุฐู ุงูุฃุดูุงุก. <br>  ููููุง ูุฑูุฏ ูู ูุฐู ุงูุญุงูุฉ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชู ุชูุฒูุน ูู ุดูุก ุ ูุชูุช ูุนุงูุฌุฉ ุงูุจูุงูุงุช ูู ููุณ ุงูููุงู ุงูุฐู ูุงูุช ููู ุ </li><li style=";text-align:right;direction:rtl">  ุชู ุชุตููู ูู ุดูุก ุนูู ุฃูู ูุฆุงุช SpakrML Transformer ุฃู Spark ML Estimator ุ ุจุญูุซ ูููู ุชุฌููุนูุง ูุงุญููุง ูู Pipeline. </li></ul><br><p style=";text-align:right;direction:rtl">  <strong>ููุงุญุธุฉ:</strong> ุฃููุงู ุ ูุถูู ููุง ุฎุท ุงูุฃูุงุจูุจ ุฃููุง ูุทุจู ุฏุงุฆููุง ููุณ ุงูุชุญูููุงุช ุนูู ูู ูู ุงููุทุงุฑ ูุงูุงุฎุชุจุงุฑ ุ ููุง ูุชูุญ ููุง ุฃูุถูุง ุงูุชุดุงู ุฎุทุฃ "ุงูุจุญุซ ูู ุงููุณุชูุจู" ูู ุงูุชุญูู ูู ุงูุตุญุฉ.  ููุง ุฃูู ูููุฑ ููุง ุฅููุงูุงุช ุจุณูุทุฉ ูุชูููุฑ ูุชุญููู ุ ูุงูุชูุจุค ุจุงุณุชุฎุฏุงู ุฎุท ุฃูุงุจูุจ ูุฏููุง. </p><br><p style=";text-align:right;direction:rtl">  ูุญุชูู SparkML ุนูู ูุฆุฉ "ุดุจู ุนุงูููุฉ" ููุซู ูุฐู ุงูููุงู - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SQLTranformer</a> ุ ููู ูู ุงููุงุถุญ ุฃู ุงููุชุงุจุฉ ูู SQL ุฃุณูุฃ ูู ุงููุชุงุจุฉ ูู Scala ุ ุฅุฐุง ูุงู ุฐูู ุจุณุจุจ ุฅููุงููุฉ ุงูุชุดุงู ุจูุงุก ุฌููุฉ ุฃู ุฃุฎุทุงุก ูููุฐุฌูุฉ ุฃุซูุงุก ุงูุชุญููู ุงูุจุฑูุฌู ูุชูููุฒ ุจูุงุก ุงูุฌููุฉ ูู Idea.  ูููุง ุชุฃุชู MMLSpark ููุณุงุนุฏุชูุง ุ ุญูุซ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุชู ุชุทุจูู ูุญูู UDFT</a> ุนุงููู ุญูููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.microsoft.ml.spark.<span class="hljs-type"><span class="hljs-type">UDFTransformer</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุณูููู ุจุฅูุดุงุก ูุธููุฉ ุงูุชุญููู ูุฏููุง ุ ูุงูุชู ูู ุจุณูุทุฉ ููุบุงูุฉ ุฅูู ุงูุญุฏ ุงูุฃูุตู ุ ูููู ูุฏููุง ุงูุขู ูู ุฅุธูุงุฑ ุนูููุฉ ุฅูุดุงุก UDFTransformer.  ูู ุญูุซ ุงููุจุฏุฃ ุ ุจูุงุกู ุนูู ูุซู ูุฐู ุงูุฃูุซูุฉ ุงูุจุณูุทุฉ ุ ูููู ูุฃู ุดุฎุต ุฅุถุงูุฉ ููุทู ุฅูู ุฃู ูุณุชูู ูู ุงูุชุนููุฏ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> miss = <span class="hljs-string"><span class="hljs-string">".*miss\\..*"</span></span>.r <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> mr = <span class="hljs-string"><span class="hljs-string">".*mr\\..*"</span></span>.r <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> mrs = <span class="hljs-string"><span class="hljs-string">".*mrs\\..*"</span></span>.r <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> master = <span class="hljs-string"><span class="hljs-string">".*master.*"</span></span>.r <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convertNames</span></span></span></span>(input: <span class="hljs-type"><span class="hljs-type">String</span></span>): <span class="hljs-type"><span class="hljs-type">Option</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>] = { <span class="hljs-type"><span class="hljs-type">Option</span></span>(input).map(x =&gt; { x.toLowerCase <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> miss() =&gt; <span class="hljs-string"><span class="hljs-string">"Miss"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> mr() =&gt; <span class="hljs-string"><span class="hljs-string">"Mr"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> mrs() =&gt; <span class="hljs-string"><span class="hljs-string">"Mrs"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> master() =&gt; <span class="hljs-string"><span class="hljs-string">"Master"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> _ =&gt; <span class="hljs-string"><span class="hljs-string">"Unknown"</span></span> } }) }</code> </pre> <br><p style=";text-align:right;direction:rtl">  (ููููู ุฃู ุชุฑู ุนูู ุงูููุฑ ูุฏู ููุงุกูุฉ ุณูุงูุง ููุนูู ูุน ุงูููู ุงูููููุฏุฉ ุ ูุงูุชู ุ ุจุงูููุงุณุจุฉ ุ ููุณุช ููุท <code>null</code> ุ ูููู ุฃูุถูุง <code>Double.NaN</code> ุ ูููู ููุงู <del>  ูุฐู ูุฒุญุฉ </del>  ุดูุก ูุงุฏุฑ ูุซู ุงูุฅุบูุงูุงุช ูู ูุชุบูุฑุงุช <code>BooleanType</code> ุ ุฅูุฎ.) </p><br><p style=";text-align:right;direction:rtl">  ุฃุนูู ุงูุขู ูุฏููุง <code>UserDefinedFunction</code> ูุฅูุดุงุก <code>Transformer</code> ุนูู ุงูููุฑ ุนูู ุฃุณุงุณ ุฐูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> nameTransformUDF = udf(convertNames _) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> nameTransformer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">UDFTransformer</span></span>() .setUDF(nameTransformUDF) .setInputCol(<span class="hljs-string"><span class="hljs-string">"Name"</span></span>) .setOutputCol(<span class="hljs-string"><span class="hljs-string">"NameType"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ููุงุญุธุฉ:</strong> ูู ุฌูุงุฒ ุงูููุจููุชุฑ ุงููุญููู Zeppelin ุ ูุชุดุงุจู ุงูุฃูุฑ ุชูุงููุง ุ ูููู ุนูุฏูุง ูุชู ุชุฌููุนู ูุนูุง ูุงุญููุง ูู ุฑูุฒ ุงูุฅูุชุงุฌ ุ ูู ุงูููู ุฃู ุชููู ุฌููุน UDF ูู ูุฆุงุช ุฃู ูุงุฆูุงุช <code>extends Serializable</code> .  ุงูุดูุก ุงููุงุถุญ ุงูุฐู ููููู ูุณูุงูู ูู ุจุนุถ ุงูุฃุญูุงู ุซู ุงูุฏุฎูู ููู ููุชุฑุฉ ุทูููุฉ ูู ุงูุฎุทุฃ ูู ูุฑุงุกุฉ ุขุซุงุฑ ุงูููุฏุณ ุงูุทูููุฉ ูู ุฃุฎุทุงุก Spark. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูุง ูุฒุงู ูุฏููุง ูุฌุงู <code>Cabin</code> .  ุฏุนููุง ูููู ูุธุฑุฉ ูุงุญุตุฉ ุนูู ุฐูู: <br><img src="https://habrastorage.org/webt/1m/sn/n2/1msnn2zqeyerzpysj2ma3bwzuda.png"></p><br><p style=";text-align:right;direction:rtl">  ูุฑู ุฃู ููุงู ุงูุนุฏูุฏ ูู ุงูููู ุงูููููุฏุฉ ุ ูููุงู ุญุฑูู ูุฃุฑูุงู ููุฌููุนุงุช ูุฎุชููุฉ ุ ุฅูุฎ.  ุฏุนูุง ูุฃุฎุฐ ุนุฏุฏ ุงูุญุฌุฑุงุช (ุฅุฐุง ูุงู ููุงู ุฃูุซุฑ ูู ูุงุจููุฉ) ุ ููุฐูู ุงูุฃุฑูุงู - ุฑุจูุง ูููู ูุฏููู ููุน ูู ุงูููุทู ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅุฐุง ูุงู ุงูุชุฑููู ูู ุฅุญุฏู ููุงูุงุช ุงูุณูููุฉ ุ ููุงูุช ูุฑุต ูุงุจููุฉ ูู ุงูููุณ ุฃูู.  ุณูููู ุฃูุถูุง ุจุฅูุดุงุก ูุธุงุฆู ุ ุซู ุจูุงุกู ุนูููุง <code>UDFTransformer</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCabinsCount</span></span></span></span>(input: <span class="hljs-type"><span class="hljs-type">String</span></span>): <span class="hljs-type"><span class="hljs-type">Int</span></span> = { <span class="hljs-type"><span class="hljs-type">Option</span></span>(input) <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-type"><span class="hljs-type">Some</span></span>(x) =&gt; x.split(<span class="hljs-string"><span class="hljs-string">" "</span></span>).length <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-type"><span class="hljs-type">None</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numPattern = <span class="hljs-string"><span class="hljs-string">"([az])([0-9]+)"</span></span>.r <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNumbersFromCabin</span></span></span></span>(input: <span class="hljs-type"><span class="hljs-type">String</span></span>): <span class="hljs-type"><span class="hljs-type">Int</span></span> = { <span class="hljs-type"><span class="hljs-type">Option</span></span>(input) <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-type"><span class="hljs-type">Some</span></span>(x) =&gt; { x.split(<span class="hljs-string"><span class="hljs-string">" "</span></span>)(<span class="hljs-number"><span class="hljs-number">0</span></span>).toLowerCase <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> numPattern(sym, num) =&gt; <span class="hljs-type"><span class="hljs-type">Integer</span></span>.parseInt(num) <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> _ =&gt; <span class="hljs-number"><span class="hljs-number">-1</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-type"><span class="hljs-type">None</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">-2</span></span> } } <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cabinsCountUDF = udf(getCabinsCount _) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numbersFromCabinUDF = udf(getNumbersFromCabin _) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> cabinsCountTransformer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">UDFTransformer</span></span>() .setInputCol(<span class="hljs-string"><span class="hljs-string">"Cabin"</span></span>) .setOutputCol(<span class="hljs-string"><span class="hljs-string">"CabinCount"</span></span>) .setUDF(cabinsCountUDF) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numbersFromCabinTransformer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">UDFTransformer</span></span>() .setInputCol(<span class="hljs-string"><span class="hljs-string">"Cabin"</span></span>) .setOutputCol(<span class="hljs-string"><span class="hljs-string">"CabinNumber"</span></span>) .setUDF(numbersFromCabinUDF)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ููุจุฏุฃ ุจุงูููู ุงูููููุฏุฉ ุ ููู ุงูุนูุฑ.  ุฃููุงู ุ ุฏุนูุง ูุณุชููุฏ ูู ุฅููุงูุงุช ุงูุชุตูุฑ ูู ุฒูุจููู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/h-/cj/l6/h-cjl6tzbakgmqxc1w-gt_kgwk0.png"></p><br><p style=";text-align:right;direction:rtl">  ูุงูุธุฑ ููู ุชูุณุฏ ุงูููู ุงูููููุฏุฉ ูู ุดูุก.  ุณูููู ูู ุงูููุทูู ุงุณุชุจุฏุงููุง ุจูุณุท (ุฃู ูุณูุท) ุ ูููู ูุฏููุง ูู ุงููุธุฑ ูู ุฌููุน ููุฒุงุช ููุชุจุฉ MMLSpark.  ูุฐูู ุ ุณูู ููุชุจ <code>Estimator</code> ุงูุฎุงุต ุ ูุงูุฐู ุณููุธุฑ ูู ูุฌููุนุฉ / ูุชูุณุทุงุช ูู ุนููุฉ ุงูุชุฏุฑูุจ ูุงุณุชุจุฏุงููุง ุจุงููุฌูุงุช ุงูููุงุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุณูุญุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.sql.{<span class="hljs-type"><span class="hljs-type">Dataset</span></span>, <span class="hljs-type"><span class="hljs-type">DataFrame</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.ml.{<span class="hljs-type"><span class="hljs-type">Estimator</span></span>, <span class="hljs-type"><span class="hljs-type">Model</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.ml.param.{<span class="hljs-type"><span class="hljs-type">Param</span></span>, <span class="hljs-type"><span class="hljs-type">ParamMap</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.ml.util.<span class="hljs-type"><span class="hljs-type">Identifiable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.ml.util.<span class="hljs-type"><span class="hljs-type">DefaultParamsWritable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.microsoft.ml.spark.{<span class="hljs-type"><span class="hljs-type">HasInputCol</span></span>, <span class="hljs-type"><span class="hljs-type">HasOutputCol</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.microsoft.ml.spark.<span class="hljs-type"><span class="hljs-type">ConstructorWritable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.microsoft.ml.spark.<span class="hljs-type"><span class="hljs-type">ConstructorReadable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.microsoft.ml.spark.<span class="hljs-type"><span class="hljs-type">Wrappable</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ููุงุญุธ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>ConstructorWritable</code></a> ุ ููุง ูุจุณุท ุงูุญูุงุฉ ุฅูู ุญุฏ ูุจูุฑ.  ุฅุฐุง ูุงู <code>Model</code> ุจูุง <code>Model</code> "ูุฏุฑุจูุง" <code>fit(),</code> ุทุฑููุฉ <code>fit(),</code> ุ ูุงูุฐู ูุชู ุชุญุฏูุฏู ุจุงููุงูู ุจูุงุณุทุฉ ูููุดุฆู (ูุฑุจูุง ูููู ูุฐุง 99ูช ูู ุงูุญุงูุงุช) ุ ููุง ูููููุง ูุชุงุจุฉ ุงูุชุณูุณู ุจุฃูุฏููุง ุนูู ุงูุฅุทูุงู.  ูุนูู ูุฐุง ุจุงููุนู ุนูู ุชุจุณูุท ุนูููุฉ ุงูุชุทููุฑ ูุชุณุฑูุนูุง ูุฅุฒุงูุฉ ุงูุฃุฎุทุงุก ูุชูููู ุนุชุจุฉ ุงูุฏุฎูู ุฅูู DataScientist ูุงููุญูููู ุงูุฐูู ููุณูุง ุนุงุฏุฉ ูุจุฑูุฌูู ูุญุชุฑููู. </p><br><p style=";text-align:right;direction:rtl">  ุชุญุฏูุฏ ูุฆุฉ <code>Estimator</code> ูุฏููุง.  ูู ุงููุงูุน ุ ุฃูู ุดูุก ููุง ูู ุงูุฃุณููุจ <code>fit</code> ุ ูุงูุจุงูู ููุงุท ุชูููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GroupImputerEstimator</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">override val uid: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Estimator</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">GroupImputerModel</span></span></span><span class="hljs-class">] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HasInputCol</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HasOutputCol</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Wrappable</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DefaultParamsWritable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">this</span></span></span></span>() = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>(<span class="hljs-type"><span class="hljs-type">Identifiable</span></span>.randomUID(<span class="hljs-string"><span class="hljs-string">"GroupImputer"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> groupCol: <span class="hljs-type"><span class="hljs-type">Param</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Param</span></span>[<span class="hljs-type"><span class="hljs-type">String</span></span>]( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-string"><span class="hljs-string">"groupCol"</span></span>, <span class="hljs-string"><span class="hljs-string">"Groupping column"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setGroupCol</span></span></span></span>(v: <span class="hljs-type"><span class="hljs-type">String</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">type</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.set(groupCol, v) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getGroupCol</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">String</span></span> = $(groupCol) <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fit</span></span></span></span>(dataset: <span class="hljs-type"><span class="hljs-type">Dataset</span></span>[_]): <span class="hljs-type"><span class="hljs-type">GroupImputerModel</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> meanDF = dataset .toDF .groupBy($(groupCol)) .agg(mean(col($(inputCol))).alias(<span class="hljs-string"><span class="hljs-string">"groupMean"</span></span>)) .select(col($(groupCol)), col(<span class="hljs-string"><span class="hljs-string">"groupMean"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">GroupImputerModel</span></span>( uid, meanDF, getInputCol, getOutputCol, getGroupCol ) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">transformSchema</span></span></span></span>(schema: <span class="hljs-type"><span class="hljs-type">StructType</span></span>): <span class="hljs-type"><span class="hljs-type">StructType</span></span> = schema .add( <span class="hljs-type"><span class="hljs-type">StructField</span></span>( $(outputCol), schema.filter(x =&gt; x.name == $(inputCol))(<span class="hljs-number"><span class="hljs-number">0</span></span>).dataType ) ) <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span></span>(extra: <span class="hljs-type"><span class="hljs-type">ParamMap</span></span>): <span class="hljs-type"><span class="hljs-type">Estimator</span></span>[<span class="hljs-type"><span class="hljs-type">GroupImputerModel</span></span>] = { <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> to = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">GroupImputerEstimator</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.uid) copyValues(to, extra).asInstanceOf[<span class="hljs-type"><span class="hljs-type">GroupImputerEstimator</span></span>] } }</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ููุงุญุธุฉ:</strong> ูู ุฃุณุชุฎุฏู defaultCopy ุ ูุฃูู ุนูุฏูุง ุงุชุตูุช ุ ูุณุจุจ ูุง ุ ุฃูุณู ุฃููู ูู ููู ูุฏู ูููุดุฆ. \ &lt;init&gt; (java.lang.String) ุ ุนูู ุงูุฑุบู ูู ุฃูู ูุจุฏู ุฃูู ูุง ููุจุบู ุฃู ูุญุฏุซ ูุฐุง.  ุญุณููุง ุ ุนูู ุฃู ุญุงู ุ ูุฅู ุชูููุฐ <code>copy</code> ุณูู. </p><br><p style=";text-align:right;direction:rtl">  ุชุญุชุงุฌ ุงูุขู ุฅูู ุชุทุจูู <code>Model</code> - ูุตู ูุตู ุงููููุฐุฌ ุงููุฏุฑุจ ููููู ุจุชูููุฐ ุทุฑููุฉ <code>transform</code> .  ุณููุดุฆูุง ุจูุงุกู ุนูู ูุธููุฉ <code>org.apache.spark.sql.functions</code> ุงููุฏูุฌุฉ ูู <code>org.apache.spark.sql.functions</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GroupImputerModel</span></span></span><span class="hljs-class">(</span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"> val uid: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-class"><span class="hljs-params">, val meanDF: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">DataFrame</span></span></span></span><span class="hljs-class"><span class="hljs-params">, val inputCol: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-class"><span class="hljs-params">, val outputCol: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-class"><span class="hljs-params">, val groupCol: </span></span><span class="hljs-type"><span class="hljs-class"><span class="hljs-params"><span class="hljs-type">String</span></span></span></span><span class="hljs-class"><span class="hljs-params"> </span></span></span><span class="hljs-class">) </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Model</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">GroupImputerModel</span></span></span><span class="hljs-class">] </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConstructorWritable</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">GroupImputerModel</span></span></span><span class="hljs-class">] </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> ttag: <span class="hljs-type"><span class="hljs-type">TypeTag</span></span>[<span class="hljs-type"><span class="hljs-type">GroupImputerModel</span></span>] = typeTag[<span class="hljs-type"><span class="hljs-type">GroupImputerModel</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">objectsToSave</span></span></span></span>: <span class="hljs-type"><span class="hljs-type">List</span></span>[<span class="hljs-type"><span class="hljs-type">Any</span></span>] = <span class="hljs-type"><span class="hljs-type">List</span></span>(uid, meanDF, inputCol, outputCol, groupCol) <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">copy</span></span></span></span>(extra: <span class="hljs-type"><span class="hljs-type">ParamMap</span></span>): <span class="hljs-type"><span class="hljs-type">GroupImputerModel</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">GroupImputerModel</span></span>(uid, meanDF, inputCol, outputCol, groupCol) <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">transform</span></span></span></span>(dataset: <span class="hljs-type"><span class="hljs-type">Dataset</span></span>[_]): <span class="hljs-type"><span class="hljs-type">DataFrame</span></span> = { dataset .toDF .join(meanDF, <span class="hljs-type"><span class="hljs-type">Seq</span></span>(groupCol), <span class="hljs-string"><span class="hljs-string">"left"</span></span>) .withColumn( outputCol, coalesce(col(inputCol), col(<span class="hljs-string"><span class="hljs-string">"groupMean"</span></span>)) .cast(<span class="hljs-type"><span class="hljs-type">IntegerType</span></span>)) .drop(<span class="hljs-string"><span class="hljs-string">"groupMean"</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">transformSchema</span></span></span><span class="hljs-function"> </span></span>(schema: <span class="hljs-type"><span class="hljs-type">StructType</span></span>): <span class="hljs-type"><span class="hljs-type">StructType</span></span> = schema .add( <span class="hljs-type"><span class="hljs-type">StructField</span></span>(outputCol, schema.filter(x =&gt; x.name == inputCol)(<span class="hljs-number"><span class="hljs-number">0</span></span>).dataType) ) }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุขุฎุฑ ูุงุฆู ูุญุชุงุฌ ุฅูู ุฅุนูุงูู ูู <code>Reader</code> ุ ูุงูุฐู ูุทุจูู ุจุงุณุชุฎุฏุงู ูุฆุฉ MMLSpark <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ConstructorReadable</a> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">object</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GroupImputerModel</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ConstructorReadable</span></span></span><span class="hljs-class">[</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">GroupImputerModel</span></span></span><span class="hljs-class">]</span></span></code> </pre> <br><h2 id="sozdanie-pipeline" style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุฎุทูุท ุงูุฃูุงุจูุจ </h2><br><p style=";text-align:right;direction:rtl">  ูู Pipeline ุ ุฃูุฏ ุฃู ุฃุนุฑุถ ููุงู ูู ูุตูู SparkML ุงููุนุชุงุฏุฉ ูุงูุดูุก ุงููุฑูุญ ุจุดูู ูุง ูุตุฏู ูู MMLSpark - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">MultiColumnAdapter</a> ุ ูุงูุฐู ูุณูุญ ูู ุจุชุทุจูู ูุญููุงุช SparkML ุนูู ุงูุนุฏูุฏ ูู ุงูุฃุนูุฏุฉ ูู ููุช ูุงุญุฏ (ููุฑุฌุน ุ ุนูู ุณุจูู ุงููุซุงู ุ StringIndexer ู OneHotEncoder ูุฃุฎุฐุงู ุนููุฏูุง ูุงุญุฏูุง ุจุงูุถุจุท ุฅูู ุงูุฅุฏุฎุงู ุ ุงูุฃูุฑ ุงูุฐู ูุญููููุง ุฅุนูุงู ูู ุงูุฃูู): </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.ml.feature.{<span class="hljs-type"><span class="hljs-type">StringIndexer</span></span>, <span class="hljs-type"><span class="hljs-type">VectorAssembler</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.ml.<span class="hljs-type"><span class="hljs-type">Pipeline</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.microsoft.ml.spark.{<span class="hljs-type"><span class="hljs-type">MultiColumnAdapter</span></span>, <span class="hljs-type"><span class="hljs-type">LightGBMClassifier</span></span>}</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃููุงู ุ ุณูุนูู ุนู ุงูุฃุนูุฏุฉ ุงูุชู ูุฏููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> catCols = <span class="hljs-type"><span class="hljs-type">Array</span></span>(<span class="hljs-string"><span class="hljs-string">"Sex"</span></span>, <span class="hljs-string"><span class="hljs-string">"Embarked"</span></span>, <span class="hljs-string"><span class="hljs-string">"NameType"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> numCols = <span class="hljs-type"><span class="hljs-type">Array</span></span>(<span class="hljs-string"><span class="hljs-string">"PClass"</span></span>, <span class="hljs-string"><span class="hljs-string">"AgeNoMissings"</span></span>, <span class="hljs-string"><span class="hljs-string">"SibSp"</span></span>, <span class="hljs-string"><span class="hljs-string">"Parch"</span></span>, <span class="hljs-string"><span class="hljs-string">"CabinCount"</span></span>, <span class="hljs-string"><span class="hljs-string">"CabinNumber"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ูู ุจุฅูุดุงุก ุชุดููุฑ ุงูุณูุณูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> stringEncoder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">MultiColumnAdapter</span></span>() .setBaseStage(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">StringIndexer</span></span>().setHandleInvalid(<span class="hljs-string"><span class="hljs-string">"keep"</span></span>)) .setInputCols(catCols) .setOutputCols(catCols.map(x =&gt; x + <span class="hljs-string"><span class="hljs-string">"_freqEncoded"</span></span>))</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ููุงุญุธุฉ:</strong> ุจุฎูุงู scikit-Learn ูู SparkML ุ ุชุนูู <code>StringIndexer</code> ุนูู ูุจุฏุฃ ุชุดููุฑ ุงูุชุฑุฏุฏ ุ ููููู ุงุณุชุฎุฏุงูู ูุชุญุฏูุฏ ุนูุงูุฉ ุงูุทูุจ (ุนูู ุณุจูู ุงููุซุงู ุงููุฆุฉ 0 &lt;ุงููุฆุฉ 1 ุ ููุฐุง ููุทูู ูู ูุซูุฑ ูู ุงูุฃุญูุงู) ุฃุดุฌุงุฑ ุญุงุณูุฉ. </p><br><p style=";text-align:right;direction:rtl">  <code>Imputer</code> ูุฏููุง <code>Imputer</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> missingImputer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">GroupImputerEstimator</span></span>() .setInputCol(<span class="hljs-string"><span class="hljs-string">"Age"</span></span>) .setOutputCol(<span class="hljs-string"><span class="hljs-string">"AgeNoMissings"</span></span>) .setGroupCol(<span class="hljs-string"><span class="hljs-string">"Sex"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ู <code>VectorAssembler</code> ุ ูุธุฑูุง ูุฃู ูุตููุงุช SparkML ุฃูุซุฑ ุฑุงุญุฉ ูู ุงูุนูู ูุน <code>VectorType</code> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> assembler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">VectorAssembler</span></span>() .setInputCols(stringEncoder.getOutputCols ++ numCols) .setOutputCol(<span class="hljs-string"><span class="hljs-string">"features"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุขู ุณูู ูุณุชุฎุฏู ุชุนุฒูุฒ ุงูุชุฏุฑุฌ ุงููุฒูุฏ ุจู MMLSpark - LightGBM ุ ูุงูุฐู ุชู ุชุถูููู ูู "ุงูุซูุงุซุฉ ุงููุจุงุฑ" ูู ุฃูุถู ุชุทุจููุงุช ูุฐู ุงูุฎูุงุฑุฒููุฉ ุฅูู ุฌุงูุจ XGBoost ู CatBoost.  ุฅูู ูุนูู ุนุฏุฉ ูุฑุงุช ุจุดูู ุฃุณุฑุน ูุฃูุถู ูุฃูุซุฑ ุงุณุชูุฑุงุฑูุง ูู ุชุทุจูู GBM ุงูุฐู ูุฏู SparkML (ุญุชู ูุน ูุฑุงุนุงุฉ ุฃู ูููุฐ JVM ูุง ูุฒุงู ููุฏ ุงูุชุทููุฑ ุงููุดุท): </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> catColIndices = <span class="hljs-type"><span class="hljs-type">Array</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> lgbClf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">LightGBMClassifier</span></span>() .setFeaturesCol(<span class="hljs-string"><span class="hljs-string">"features"</span></span>) .setLabelCol(<span class="hljs-string"><span class="hljs-string">"Survived"</span></span>) .setProbabilityCol(<span class="hljs-string"><span class="hljs-string">"predictedProb"</span></span>) .setPredictionCol(<span class="hljs-string"><span class="hljs-string">"predictedLabel"</span></span>) .setRawPredictionCol(<span class="hljs-string"><span class="hljs-string">"rawPrediction"</span></span>) .setIsUnbalance(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) .setCategoricalSlotIndexes(catColIndices) .setObjective(<span class="hljs-string"><span class="hljs-string">"binary"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ููุงุญุธุฉ:</strong> ูุฏุนู LightGBM ุงูุนูู ูุน ุงููุชุบูุฑุงุช ุงููุฆููุฉ (ูุซู ุชูุฑูุจูุง catboost) ุ ูุฐูู ุฃุดุฑูุง ุฅูููุง ููุฏููุง ุญูุซ ุชูุฌุฏ ุณูุงุช ุงููุฆุฉ ูู ูุชุฌููุง ุ ูุณูููู ูู ุจููุณู ุจูุนุฑูุฉ ูุง ูุฌุจ ูุนูู ุจูุง ูููููุฉ ุชุดููุฑูุง. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงููุฒูุฏ ุนู ููุฒุงุช LightGBM ูู Spark</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนูู ุงูุนูุฏ ุงูุชู ุชุดุบู RadHat LightGBM ุ ูุฅู ุฃู ุฅุตุฏุงุฑ ุจุงุณุชุซูุงุก ุฃุญุฏุซ ุฅุตุฏุงุฑ ุณูู ูุชุนุทู ุจุณุจุจ ุญูููุฉ ุฃูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุง ูุญุจ</a> ุฅุตุฏุงุฑ <code>glibc</code> .  ุชู ุฅุตูุงุญ ูุฐุง <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุคุฎุฑูุง</a> ุ ุนูุฏ ุงูุชุซุจูุช ุนุจุฑ Maven ุ ุชููู MMLSpark ุจุณุญุจ ุงูุฅุตุฏุงุฑ ูุจู ุงูุฃุฎูุฑ ูู LightGBM ุนูุฏ ุงูุชุซุจูุช ุนุจุฑ Maven ุ ูุฐูู ุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ุชุจุนูุฉ ุฃุญุฏุซ ุฅุตุฏุงุฑ ุนูู RadHat ุจูุฏูู. </li><li style=";text-align:right;direction:rtl">  ุชููู LightGBM ูู ุนูููุง ุจุฅูุดุงุก ููุจุณ ุนูู ุจุฑูุงูุฌ ุงูุชุดุบูู ููุชูุงุตู ูุน ุงููุฏูุฑูู ุงูุชูููุฐููู ุ ููููู ุจุฐูู ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><code>new java.net.ServerSocket(0)</code></a> ุ ูุจุงูุชุงูู ูุชู ุงุณุชุฎุฏุงู ูููุฐ ุนุดูุงุฆู ูู ุงูููุงูุฐ ุงููุคูุชุฉ ููุธุงู ุงูุชุดุบูู.  ุฅุฐุง ูุงู ูุทุงู ุงูููุงูุฐ ุงููุคูุชุฉ ูุฎุชูู ุนู ูุทุงู ุงูููุงูุฐ ุงูููุชูุญุฉ ุจูุงุณุทุฉ ุฌุฏุงุฑ ุงูุญูุงูุฉ ุ ุฅุฐู <del>  ูููู ุฃู ูุญุฑู ุงููุซูุฑ </del>  ููููู ุงูุญุตูู ุนูู ุชุฃุซูุฑ ูุซูุฑ ููุงูุชูุงู ุนูุฏูุง ูุนูู LightGBM ุฃุญูุงููุง (ุนูุฏูุง ุงุฎุชุฑุช ูููุฐูุง ุฌูุฏูุง) ููู ุจุนุถ ุงูุฃุญูุงู ูุง.  ูุณุชููู ููุงู ุฃุฎุทุงุก ูุซู <code>ConnectionTimeOut</code> ุ ูุงูุชู ูููู ุฃู ุชุดูุฑ ุฃูุถูุง ุ ุนูู ุณุจูู ุงููุซุงู ุ ุฅูู ุงูุฎูุงุฑ ุนูุฏ ุชุนููู GC ุนูู ุงููุฏูุฑูู ุงูุชูููุฐููู ุฃู ุดูุก ูู ูุฐุง ุงููุจูู.  ุจุดูู ุนุงู ุ ูุง ุชูุฑุฑ ุฃุฎุทุงุฆู. </li></ul></div></div><br><p style=";text-align:right;direction:rtl">  ุญุณููุง ุ ุฃุฎูุฑูุง ุ ุฃุนูู ุฎุท ุฃูุงุจูุจูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> pipeline = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">Pipeline</span></span>() .setStages( <span class="hljs-type"><span class="hljs-type">Array</span></span>( missingImputer, nameTransformer, cabinsCountTransformer, numbersFromCabinTransformer, stringEncoder, assembler, lgbClf ) )</code> </pre> <br><h2 id="obuchenie" style=";text-align:right;direction:rtl">  ุชุฏุฑูุจ </h2><br><p style=";text-align:right;direction:rtl">  ุณูููู ุจุชูุณูู ูุฌููุนุฉ ุงูุชุฏุฑูุจ ุงูุฎุงุตุฉ ุจูุง ุฅูู ูุทุงุฑ ูุงุฎุชุจุงุฑ ูุงูุชุญูู ูู ุฎุท ุฃูุงุจูุจูุง.  ููุง ููููู ููุท ุชูููู ุฑุงุญุฉ ุฎุท ุงูุฃูุงุจูุจ ุ ูุฃูู ูุณุชูู ุชูุงููุง ุนู ุงููุณู ููุถูู ุฃููุง ุณูุทุจู ููุณ ุงูุชุญูููุงุช ุนูู ุงูุชุฏุฑูุจ ูุงูุงุฎุชุจุงุฑ ุ ูุณูุชู ุชุนูู ุฌููุน ูุนููุงุช ุงูุชุญูู ูู ุงููุทุงุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> <span class="hljs-type"><span class="hljs-type">Array</span></span>(trainDF, testDF) = trainFiltered.randomSplit(<span class="hljs-type"><span class="hljs-type">Array</span></span>(<span class="hljs-number"><span class="hljs-number">0.8</span></span>, <span class="hljs-number"><span class="hljs-number">0.2</span></span>)) println(<span class="hljs-string"><span class="hljs-string">s"Train rows: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${trainDF.count}</span></span></span><span class="hljs-string">\nTest rows: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${testDF.count}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-comment"><span class="hljs-comment">// Train rows: 708 // Test rows: 158 val predictions = pipeline .fit(trainDF) .transform(testDF)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุญุณุงุจ ููุงุณุจ ููููุงููุณ ุ ุณูู ูุณุชุฎุฏู ูุฆุฉ ุฃุฎุฑู ูู MMLSpark - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ComputeModelStatistics</a> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.microsoft.ml.spark.<span class="hljs-type"><span class="hljs-type">ComputeModelStatistics</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.microsoft.ml.spark.metrics.<span class="hljs-type"><span class="hljs-type">MetricConstants</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> modelEvaluator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">ComputeModelStatistics</span></span>() .setLabelCol(<span class="hljs-string"><span class="hljs-string">"Survived"</span></span>) .setScoresCol(<span class="hljs-string"><span class="hljs-string">"predictedProb"</span></span>) .setScoredLabelsCol(<span class="hljs-string"><span class="hljs-string">"predictedLabel"</span></span>) .setEvaluationMetric(<span class="hljs-type"><span class="hljs-type">MetricConstants</span></span>.<span class="hljs-type"><span class="hljs-type">ClassificationMetrics</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/we/rc/ba/wercbac58qpt0hsygugtqqkhc3u.png"></p><br><p style=";text-align:right;direction:rtl">  ููุณ ุณูุฆูุง ุ ูุธุฑูุง ูุฃููุง ูู ูุบูุฑ ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ. </p><br><h2 id="podbor-giperparametrov" style=";text-align:right;direction:rtl">  ุงุฎุชูุงุฑ hyperparameters </h2><br><p style=";text-align:right;direction:rtl">  ูุชุญุฏูุฏ ูุนููุงุช ุชุดุนุจูุฉ ูู MMLSpark ุ ููุฌุฏ TuneHyperparameters ุจุงุฑุฏุฉ ูููุตูุฉ ุ ูุงูุชู ุชููุฐ ุนูููุฉ ุจุญุซ ุนุดูุงุฆูุฉ ุนูู ุงูุดุจูุฉ.  ููุน ุฐูู ุ ูุณูุก ุงูุญุธ ุ ูุง ูุฏุนู <code>Pipeline</code> ุญุชู ุงูุขู ุ ูุฐูู ุณูุณุชุฎุฏู <code>CrossValidator</code> CrossValidator ุงููุนุชุงุฏ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.ml.tuning.{<span class="hljs-type"><span class="hljs-type">ParamGridBuilder</span></span>, <span class="hljs-type"><span class="hljs-type">CrossValidator</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> org.apache.spark.ml.evaluation.<span class="hljs-type"><span class="hljs-type">BinaryClassificationEvaluator</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> paramSpace = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">ParamGridBuilder</span></span>() .addGrid(lgbClf.maxDepth, <span class="hljs-type"><span class="hljs-type">Array</span></span>(<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>)) .addGrid(lgbClf.learningRate, <span class="hljs-type"><span class="hljs-type">Array</span></span>(<span class="hljs-number"><span class="hljs-number">0.05</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>)) .addGrid(lgbClf.numIterations, <span class="hljs-type"><span class="hljs-type">Array</span></span>(<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">300</span></span>)) .build println(<span class="hljs-string"><span class="hljs-string">s"Size of ParamsGrid: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${paramSpace.size}</span></span></span><span class="hljs-string">"</span></span>) <span class="hljs-comment"><span class="hljs-comment">// Size of ParamsGrid: 8 val crossValidator = new CrossValidator() .setEstimator(pipeline) .setEstimatorParamMaps(paramSpace) .setNumFolds(3) .setSeed(42L) .setEvaluator( new BinaryClassificationEvaluator() .setMetricName("areaUnderROC") .setLabelCol("Survived") .setRawPredictionCol("rawPrediction") ) val bestModel = crossValidator .fit(trainFiltered)</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุณูุก ุงูุญุธ ุ ูู ุฃุฌุฏ ุทุฑููุฉ ููุงุณุจุฉ ูููููุฉ ุฑุคูุฉ ุงููุชุงุฆุฌ ูุน ุชูู ุงููุนุงููุฑ ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุนูููุง.  ูุฐูู ุ ูู ุงูุถุฑูุฑู ุงุณุชุฎุฏุงู ุงูุชุตูููุงุช "ุงููุญุดูุฉ": </p><br><pre style=";text-align:right;direction:rtl"> <code class="scala hljs">crossValidator .getEstimatorParamMaps .zip(bestModel.avgMetrics) .foreach(x =&gt; { println( <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + x._1 .toSeq .foldLeft(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-type"><span class="hljs-type">StringBuilder</span></span>())( (a, b) =&gt; a .append(<span class="hljs-string"><span class="hljs-string">s"\n\t</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${b.param.name}</span></span></span><span class="hljs-string"> : </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${b.value}</span></span></span><span class="hljs-string">"</span></span>)) .toString + <span class="hljs-string"><span class="hljs-string">s"\n\tMetric: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${x._2}</span></span></span><span class="hljs-string">"</span></span> ) })</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุฐู ูุนุทููุง ุดูุก ูุซู ูุฐุง: <br><img src="https://habrastorage.org/webt/xl/li/o7/xllio7tbr67gq_wqolrqwzkzswu.png"></p><br><p style=";text-align:right;direction:rtl">  ุญุตููุง ุนูู ุฃูุถู ูุชูุฌุฉ ุนู ุทุฑูู ุชูููู ุณุฑุนุฉ ุงูุชุนูู ูุฒูุงุฏุฉ ุนูู ุงูุฃุดุฌุงุฑ.  ุนูู ูุฐุง ุงูุฃุณุงุณ ุ ุณูููู ูู ุงููููู ุถุจุท ูุณุงุญุฉ ุงูุจุญุซ ูุงูุชูุตู ุฅูู ูุชูุฌุฉ ุฃูุถู ุ ููู ุจุจุณุงุทุฉ ููุณ ูุฏููุง ูุซู ูุฐุง ุงููุฏู. </p><br><h2 id="zaklyuchenie" style=";text-align:right;direction:rtl">  ุงุณุชูุชุงุฌ </h2><br><p style=";text-align:right;direction:rtl">  ูู ุงููุงูุน ุ ูู ุญูู ุฃู MMLSpark ูุฏูู ุงูุฅุตุฏุงุฑ 0.17 ููุง ูุฒุงู ูุญุชูู ุนูู ุฃุฎุทุงุก ูููุตูุฉ.  ูููู ูู ุจูู ุฌููุน ุงูุชุฏุงุฏุงุช Spark ุงูุชู ุฑุฃูุชูุง ุ ูุฅู MMLSpark ูู ุฑุฃูู ูุฏูู ุฃูุซุฑ ุงููุณุชูุฏุงุช ุดูููุงู ูุนูููุฉ ุงูุชุซุจูุช ูุงูุชูููุฐ ุงูุฃูุซุฑ ูุงุจููุฉ ููููู.  ูู ุชูู Microsoft ุจุงูุชุฑููุฌ ูู ุจุงููุนู ุ ูู ููู ููุงู ุณูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชูุฑูุฑ ุญูู Databricks</a> ุ ูููู ูุงู ููุงู ุงููุฒูุฏ ุญูู DeepLearning ุ ูููุณ ุญูู ูุฐู ุงูุฃุดูุงุก ุงูุฑูุชูููุฉ ุงูุชู ูุชุจุช ุนููุง. </p><br><p style=";text-align:right;direction:rtl">  ุดุฎุตููุง ุ ูู ููุงููุง ุ ุณุงุนุฏุช ูุฐู ุงูููุชุจุฉ ูุซูุฑูุง ุ ุญูุซ ุณูุญุช ูู ุจุงููุตูู ุฅูู ุงููููู ูู ุบุงุจุฉ ูุตุงุฏุฑ Spark ูุนุฏู ุงุณุชุฎุฏุงู ุงูููุนูุณ ูููุตูู ุฅูู ุทุฑู [ml] ุฎุงุตุฉ ุ ููุฌุฏ ุฃุญุฏ ุงูุฒููุงุก ุงูููุชุจุฉ ุนู ุทุฑูู ุงูุตุฏูุฉ ุชูุฑูุจูุง.  ูู ุงูููุช ููุณู ุ ููุฑุฌุน ุฐูู ุฅูู ุญูููุฉ ุฃู ุงูููุชุจุฉ ููุฏ ุงูุชุทููุฑ ุงููุดุท ุ ุจููุฉ ุงูููู ุงููุตุฏุฑ <del>  ุนุตูุฏุฉ ูุงููุฉ </del>  ูุฑุจูุฉ ุฅูู ุญุฏ ูุง.  ุญุณููุง ุ ูุธุฑูุง ูุญูููุฉ ุนุฏู ูุฌูุฏ ุฃูุซูุฉ ุฎุงุตุฉ ุฃู ูุณุชูุฏุงุช ุฃุฎุฑู (ุจุงุณุชุซูุงุก scaladoc ุงูุนุงุฑูุฉ) ุ ููุฏ ุงุถุทุฑุฑูุง ูู ุงูุจุฏุงูุฉ ุฅูู ุงูุฒุญู ุฅูู ุดูุฑุฉ ุงููุตุฏุฑ ุจุงุณุชูุฑุงุฑ. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุขูู ุญููุง ุฃู ูููู ูุฐุง ุงูุจุฑูุงูุฌ ุงูุชุนูููู ุงููุตุบุฑ (ุนูู ุงูุฑุบู ูู ูุถูุญู ูุจุณุงุทุชู) ูููุฏูุง ูุดุฎุต ูุง ูุณูุณุงุนุฏ ูู ุชูููุฑ ุงููุซูุฑ ูู ุงูููุช ูุงูุฌูุฏ! </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar456668/">https://habr.com/ru/post/ar456668/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar456654/index.html">ููุณ ูุฎูู ุฌุฏุง ูุดุฑูุน ุชุฎุทูุท ููุงุฑุฏ ุงููุคุณุณุงุช ููุง ุฑุณูุช</a></li>
<li><a href="../ar456656/index.html">ุงูุฏุฑูุณ ุงููุณุชูุงุฏุฉ ุญูู SDL 2: ุงูุฏุฑุณ 4 - ุชูุฏูุฏ PNG</a></li>
<li><a href="../ar456658/index.html">ุงูููู: ููู ูููู ุงูููุงุฑุงุช ูู ุงููุฑูู</a></li>
<li><a href="../ar456662/index.html">ููููุฉ ุชูููุฑ ุงููุงู ุนูู ุงููุนุงูุฌ ุจุงุณุชุฎุฏุงู ุชุทููุฑ ูุญุฑููุง ุงูุงุฎุชุจุงุฑ</a></li>
<li><a href="../ar456664/index.html">ูู ููุงุถู ุนูุฏูุง ูููุฏ ุงูุฑูุจูุช ุฃููุงูู</a></li>
<li><a href="../ar456670/index.html">ุญูู ุทุฑููุฉ ูุตุงุฏูุฉ ุชุฌุณุณ ุฌุฏุง</a></li>
<li><a href="../ar456672/index.html">ูุตูุงุช Nginx: ุฅุนูุงูุงุช ุบูุฑ ูุชุฒุงููุฉ ูู PostgreSQL ุฅูู websocket</a></li>
<li><a href="../ar456674/index.html">ูุฑุต ุฌุฏูุฏุฉ ููุชุฑููุฉ ุนูู Facebook ูู ุชูู ุชุนุฑููุง</a></li>
<li><a href="../ar456676/index.html">ุชุณุฌูู ุงูุฏุฎูู ุฅูู ุชุทุจูู php ุงูููุฒุน</a></li>
<li><a href="../ar456678/index.html">ุงูุญุงูุฉ ุงูุฅููุชุฑูููุฉ ูููุณุชูุจู. ุงูุฌุฒุก 4</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>