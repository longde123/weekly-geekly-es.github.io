<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìú üßó üíº HighLoad ++, Mikhail Makurov (Intersvyaz): experi√™ncia na cria√ß√£o de um servi√ßo Zabbix de backup e em cluster üíü üö© ‚ô®Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O Zabbix √© um sistema popular de monitoramento aberto usado por um grande n√∫mero de empresas. Vou falar sobre a experi√™ncia de criar um cluster de mon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>HighLoad ++, Mikhail Makurov (Intersvyaz): experi√™ncia na cria√ß√£o de um servi√ßo Zabbix de backup e em cluster</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/485534/">  O Zabbix √© um sistema popular de monitoramento aberto usado por um grande n√∫mero de empresas.  Vou falar sobre a experi√™ncia de criar um cluster de monitoramento. <br><br>  No relat√≥rio, mencionei brevemente as altera√ß√µes feitas anteriormente (patches), que expandem significativamente os recursos do sistema e preparam a base para o cluster (upload de hist√≥rico para ‚ÄúClickhouse‚Äù, pesquisa ass√≠ncrona).  E analisarei em detalhes os problemas que surgiram durante o clustering do sistema - resolvendo conflitos de identidade no banco de dados, um pouco sobre o teorema do CAP e monitoramento com bancos de dados distribu√≠dos, sobre as nuances do Zabbix trabalhando no modo de cluster: backup e coordena√ß√£o de servidores e proxies, sobre "dom√≠nios de monitoramento" e uma nova apar√™ncia na arquitetura do sistema. <br><br>  Falarei brevemente sobre como iniciar um cluster em casa, onde obter as fontes e quais outras.  ser√£o necess√°rias configura√ß√µes para o cluster. <br><br><img src="https://habrastorage.org/webt/uv/cy/1r/uvcy1rw-6ttiumnzmjuizgl4ml4.jpeg"><br><br>  HighLoad ++ Siberia 2019. Tomsk Hall.  24 de junho, 17h  Resumos e <a href="https://www.highload.ru/siberia/2019/abstracts/5210">apresenta√ß√£o</a> .  A pr√≥xima confer√™ncia HighLoad ++ ser√° realizada nos dias 6 e 7 de abril de 2020 em S√£o Petersburgo.  Detalhes e ingressos <a href="http://bit.ly/2sSxgBx">aqui</a> . <a name="habracut"></a><br><br>  <b>Mikhaili Makurov (a seguir - MM):</b> - Trabalho para uma empresa prestadora.  O fornecedor √© chamado Intersvyaz, funciona na cidade de Chelyabinsk.  Temos aproximadamente 1,5 milh√£o de pessoas.  E para que o provedor funcione, existe uma enorme infraestrutura.  Temos cerca de 70 mil equipamentos: comutadores, dispositivos IoT ... - muito de tudo que precisa ser monitorado.  Especificamente, este relat√≥rio √© sobre o uso do Zabbix, sobre a cria√ß√£o de um cluster baseado no Zabbix para monitoramento de infraestrutura. <br><br>  Eu tenho 12 anos no provedor.  Agora, n√£o estou fazendo nada t√©cnico, trata-se mais de gerenciar pessoas.  E esse (material t√©cnico) √© realmente o meu hobby.  Vou desenvolver este t√≥pico um pouco. <br><br><h3>  Problemas de monitoramento </h3><br>  Eu acho que tenho sorte.  Cerca de um ano e meio atr√°s, eu terminei em um projeto que soava assim: "Precisamos resolver alguns problemas com nosso monitoramento".  Eu herdei uma zona de responsabilidade (monitoramento), que consistia em v√°rios servidores, especificamente em 21 servidores: <br><br><img src="https://habrastorage.org/webt/eu/om/mx/euommxg6onyd7rdbncwqbnrhvtc.jpeg"><br><br>  Havia 4 servidores poderosos e 15 proxies - era tudo hardware.  Houve algumas reclama√ß√µes sobre esse monitoramento.  A primeira √© que foi muito.  N√£o temos um √∫nico servidor com o provedor que ocupa muito espa√ßo.  Isso √© dinheiro, eletricidade ... De fato, isso n√£o √© um grande problema. <br><br><img src="https://habrastorage.org/webt/ui/jf/u3/uijfu32ebg7upocsepwtvptenk4.jpeg"><br><br>  O grande problema era que o monitoramento n√£o acompanhava o quanto quer√≠amos dele.  Para aqueles que n√£o usaram o Zabbix ativamente, este √© um painel que mostra atraso nas verifica√ß√µes: <br><br><img src="https://habrastorage.org/webt/ig/jd/ti/igjdtilbejkchus711uvbzzeuyo.jpeg"><br><br>  A maioria dos nossos cheques estava na zona vermelha.  Eles correram mais de 10 minutos mais devagar do que quer√≠amos, ou seja, estavam 10 minutos atrasados.  N√£o era muito agrad√°vel, mas ainda era poss√≠vel viver mais ou menos.  O maior problema foi este: <br><br><img src="https://habrastorage.org/webt/vf/ai/nw/vfainwua91q6pgxnj2msbx_tzle.jpeg"><br><br>  Era um sistema de monitoramento de uma rede em funcionamento.  Quando o trabalho planejado foi realizado, um segmento de milhares caiu em cinco interruptores.  Juntamente com esses comutadores, o comutador e o monitoramento foram esquecidos.  Quando tudo foi restaurado, duas horas depois e o monitoramento foi restaurado.  Foi dolorosamente desagrad√°vel, e essa frase deve constar em todos os relat√≥rios: <br><br><img src="https://habrastorage.org/webt/aw/o-/t3/awo-t3j-xbu181dyneis-q4ozjo.jpeg"><br><br><h3>  "N√≥s devemos fazer algo com este projeto!" </h3><br>  E aqui vou contar duas hist√≥rias.  Ent√£o tentamos ir simultaneamente de duas maneiras.  Temos um grupo de integra√ß√£o - ele escolheu a maneira de construir um sistema modular (houve um relat√≥rio muito interessante do Avito para o Highload em novembro do ano passado em Moscou - eles conversaram sobre isso): <br><br><img src="https://habrastorage.org/webt/qg/f5/nv/qgf5nvonycfltfd8vge1tbeloj8.jpeg"><br><br><h3>  Zabbix = pessoas + API + efici√™ncia </h3><br>  Os caras de pequenos peda√ßos come√ßaram a construir um sistema.  E com v√°rios entusiastas, continuei trabalhando no Zabbix.  Havia raz√µes para isso.  Quais s√£o as raz√µes? <br><br><ul><li>  Em primeiro lugar, h√° uma API legal.  E quando voc√™ tem de 60 a 70 mil elementos de monitoramento, fica claro que tudo isso funciona apenas automaticamente - voc√™ n√£o pode adicionar tantas m√£os sem erros. </li><li>  Pessoal.  Existem turnos de monitoramento de plant√£o 24 horas por dia, 7 dias por semana.  Estes n√£o s√£o especialistas em TI, s√£o pessoas de plant√£o.  Mostramos ao "Grafan" alguns outros sistemas - √© dif√≠cil para eles.  Existem administradores acostumados √† diversidade, √† conveni√™ncia de monitorar no pr√≥prio Zabbix: modelos, detec√ß√£o autom√°tica - e isso √© legal! </li><li>  O Zabbix pode ser eficaz. </li></ul><br><h3>  O banco de dados SQL fica mais lento?  Uma resposta - Clickhouse </h3><br>  A primeira raz√£o era √≥bvia.  Em seguida, trabalhamos no MySQL e encontramos cerca de 6 a 7 mil m√©tricas por segundo, observamos atrasos constantes nos discos. <br><br><img src="https://habrastorage.org/webt/kb/ke/wf/kbkewfpy7l6b2qdexbuljdwr6ia.jpeg"><br><br>  Hoje j√° soou 100 vezes: a √∫nica resposta √© Clickhouse: <br><br><img src="https://habrastorage.org/webt/w-/lm/iw/w-lmiwpxynx-rmj4spjyv_gc1cc.jpeg"><br><br>  Na estrutura das consultas, a maior parte das consultas (nosso perfil em poucas horas) s√£o registros de m√©tricas.  Gravar m√©tricas em um banco de dados SQL √© extremamente caro.  Aqui o TimeScaleDB apareceu ... Ent√£o, tivemos um "Clickhouse" em opera√ß√£o por cerca de um ano para outras tarefas (fazemos grandes dados, temos um grande aplicativo - em geral, um provedor agora √© um neg√≥cio de TI completo). <br><br>  Depois de analisar belos gr√°ficos da Internet (que o ‚ÄúClickhouse‚Äù √© centenas de vezes mais r√°pido, que precisa de muito pouco espa√ßo) e com a experi√™ncia atual, escrevemos nosso m√≥dulo HistoryStorage para o ‚ÄúZabbix‚Äù para que ele possa salvar os dados do ‚ÄúClickhouse‚Äù diretamente (ou seja, n√£o da exporta√ß√£o de arquivos, mas diretamente). <br><br><img src="https://habrastorage.org/webt/tp/f4/p2/tpf4p2z5jftziqwqhtdtxsb99-g.jpeg"><br><br>  Al√©m disso, escrevemos um m√≥dulo para a "frente".  Todos esses belos gr√°ficos no painel de administra√ß√£o do Zabbix podem ser criados a partir da Clickhouse.  √â claro que a API tamb√©m funciona. <br><br>  O efeito √© aproximadamente o mesmo - o servidor SQL como uma entidade dedicada n√£o se tornou completamente, ou seja, a carga caiu para zero.  O mais not√°vel √© que j√° t√≠nhamos um cluster dedicado ‚ÄúClickhouse‚Äù: quando demos toda a nossa carga l√°, ela aumentou de 6 para 10 mil m√©tricas.  Os funcion√°rios que administram disseram: "Mas n√£o vemos algo que chegou.  N√£o! <br><br><h3>  Como expandimos a Clickhouse </h3><br>  Vou dizer ainda mais: para testes, tentamos carregar de 140 a 150 mil m√©tricas por segundo (n√£o conseguimos mais extrair do Zabbix, depois vou dizer o porqu√™), e o Clickhouse tamb√©m n√£o v√™ essa carga.  Ou seja, √© muito confort√°vel, carga legal.  Em geral, existe esse m√≥dulo. <br><br>  Al√©m disso, expandimos um pouco: <br><br><img src="https://habrastorage.org/webt/_u/ha/aj/_uhaajlqcp9mcjuh-ih8sc-dn3k.jpeg"><br><br>  Em nossa vers√£o, voc√™ pode desativar os nanossegundos.  Voc√™ provavelmente sabe: o Zabbix grava segundos e nanossegundos em dois campos.  Nos campos "Clickhouse" nos quais a variabilidade √© muito grande, ocupe muito espa√ßo. <br><br>  A prop√≥sito, sobre o lugar.  Uma m√©trica no Clickhouse (agora temos aproximadamente 700 bilh√µes de m√©tricas registradas) ocupa 2,9 bytes.  De acordo com a documenta√ß√£o do Zabbix, uma m√©trica nos bancos de dados SQL leva de 40 a 100 bytes.  Desativar os nanossegundos economiza outros 40%, ou seja, cerca de 1,5 bytes por m√©trica.  Ou seja, "Clickhouse" √© muito eficaz em termos de localiza√ß√£o. <br><br>  A pedido de nossos funcion√°rios envolvidos no aprendizado de m√°quina, optamos por escrever o host e o nome da m√©trica.  Como a variabilidade dos dados √© grande, isso n√£o ocupa muito espa√ßo adicional, apesar de os dados de texto poderem ser significativos (ainda n√£o foram verificados com testes longos). <br><br>  Al√©m disso, fizemos duas adi√ß√µes, pois desenvolvemos o Zabbix e muitas vezes tivemos que remov√™-lo.  Uma adi√ß√£o muito interessante: no in√≠cio, como o ‚ÄúClickhouse‚Äù permite a leitura de milh√µes de registros, podemos preencher o cache do hist√≥rico.  No in√≠cio, estamos atrasados ‚Äã‚Äãpor 30 a 40 segundos extras, mas obtemos um servi√ßo iniciado imediatamente com um cache aquecido. <br><br>  Nos casos em que √© mais f√°cil coletar da infraestrutura, ainda existe uma op√ß√£o: proibir a leitura do cache por algum tempo.  √â melhor trabalhar rapidamente por 5 minutos, sem contar os gatilhos, e o cache ser√° preenchido. Se voc√™ n√£o fizer isso, a estagna√ß√£o dos afundadores de hist√≥ria come√ßa. <br><br>  Em geral, existe um m√≥dulo "Clickhouse".  Pode ser usado. <br><br><h3>  Efici√™ncia de sondagem </h3><br>  Apesar de termos resolvido os problemas com a base, os freios e o problema com quinze proxies ainda permaneciam.  Eles estavam conectados com isso: <br><br><img src="https://habrastorage.org/webt/un/ec/u8/unecu8ujsgk7scstaonbt3dueim.jpeg"><br><br>  Este √© o principal pipeline de processamento de dados no Zabbix.  H√° um est√°gio de coleta de dados, h√° pr√©-processamento e sincronizadores hist√≥ricos que fazem todo o trabalho (c√°lculo de gatilhos, alertas, salvamento de hist√≥rico).  O gargalo do cache acabou por ser: <br><br><img src="https://habrastorage.org/webt/er/jg/ei/erjgein-xwdpitoa8eql3b5dw1g.jpeg"><br><br>  Por que a pesquisa √© lenta?  Porque os encadeamentos que fazem os pedidos v√£o para a fila na configura√ß√£o de cache para m√©tricas de unidade e bloqueiam.  Existem outros lugares, mas eles n√£o s√£o t√£o estreitos.  Por exemplo, existe um pr√©-processamento em si e um cache de hist√≥rico.  Em nosso SQL, recebemos as seguintes restri√ß√µes: <br><br><img src="https://habrastorage.org/webt/-w/ys/-b/-wys-btlu1uxulrqcinsvbmac5a.jpeg"><br><br>  Talvez isso se deva ao fato de que, no nosso caso, a base √© de aproximadamente 5 milh√µes de m√©tricas, que removemos.  Com todas as otimiza√ß√µes que fizemos, conseguimos obter 70 mil m√©tricas no gargalo (no cache de configura√ß√£o), mas apenas no caso em que as processamos em massa. <br><br>  O que √© processamento em massa?  O Poller acessa o cache de configura√ß√£o e executa a tarefa n√£o por uma m√©trica, mas por 4 ou 8 mil.  Ao mesmo tempo, ele tem outra oportunidade maravilhosa: agora ele pode fazer pesquisas de forma ass√≠ncrona, porque ele tem 4 mil m√©tricas ... Por que eles fazem um ap√≥s o outro?  Voc√™ pode perguntar tudo imediatamente! <br><br><h3>  A pesquisa ass√≠ncrona √© mais eficiente que o proxy! </h3><br>  Para os principais tipos usados ‚Äã‚Äãpelo provedor - SNMP e AGENT, reescrevemos a sondagem para o modo ass√≠ncrono e, agregadamente, isso aumentou a velocidade de 100 para 200 vezes.  T√≠nhamos 15 proxies, os divid√≠amos em 150 - eles haviam desaparecido completamente.  Como resultado, tudo se transformou em dois bancos, necess√°rios apenas para a reserva: <br><br><img src="https://habrastorage.org/webt/ax/7z/lk/ax7zlkk-yg9oafyuruz9blq7l-q.jpeg"><br><br>  Banco uniprocessador (um custo Xeon 1280).  Este √© o meu tempo: <br><br><img src="https://habrastorage.org/webt/zq/qf/nc/zqqfncyu4fxo38fiegvr0kunhhw.jpeg"><br><br>  Cerca de 60% √© gratuito, mas esse toque de 60% a 40% √© executado scripts peri√≥dicos na pr√≥pria m√°quina (scripts externos).  Eles podem ser otimizados at√© que os problemas sejam criados. <br><br>  Escala √© algo como isto: <br><br><img src="https://habrastorage.org/webt/km/pa/nj/kmpanjjtpdm3660spp8haz7ypo0.jpeg"><br><br>  S√£o 62 mil hosts, cerca de 5 milh√µes de m√©tricas.  Nossa necessidade atual √© de aproximadamente 20 mil m√©tricas por segundo. <br><br>  Bem, como tudo?  Resolvemos os problemas de desempenho, o hist√≥rico expandido, a pesquisa √© incr√≠vel.  O problema foi resolvido?  Na verdade n√£o ... Tudo seria muito simples. <br><br>  Eu joguei um truque no gr√°fico anterior (nem todos mostrados): <br><br><img src="https://habrastorage.org/webt/ds/ag/k5/dsagk5zrh8bog_ogrq35w1uvawy.jpeg"><br><br>  Existem dois problemas.  Eu quero dizer: "Tolos, estradas".  H√° um fator humano, h√° equipamentos. <br><br>  Um servidor ainda n√£o √© suficiente.  Em cerca de um ano de opera√ß√£o, houve dois casos com problemas de hardware - uma unidade SSD e outra coisa.  A maioria dos problemas √© o fator humano quando as pessoas fazem algum tipo de teste.  Em nossa empresa, o Zabbix √© usado como um servi√ßo: todos os departamentos podem escrever algo pr√≥prio l√°. <br><br>  Eu gostaria de expandir.  Eu gostaria de n√£o depender de uma lata.  Eu queria que pud√©ssemos ficar ainda mais fortes.  E eu gostaria de expandir de acordo com o princ√≠pio de expans√£o.  N√£o h√° nada a discutir aqui: crescer, aumentar a capacidade de uma lata, √© irrelevante h√° 20 anos. <br><br><img src="https://habrastorage.org/webt/yl/hy/vn/ylhyvn7za42rcr2allqhjzlmw2i.jpeg"><br><br><h3>  O cluster solicitou ... </h3><br>  Em algum lugar de dezembro, a primeira vers√£o apareceu.  Uma unidade de cluster at√¥mica √© o que √© processado em um host separado.  O host foi selecionado. <br><br><img src="https://habrastorage.org/webt/9j/yo/sy/9jyosycj6yj7ecx7k5mn0esrfnu.jpeg"><br><br>  O fato √© que no Zabbix existem conex√µes bastante fortes entre itens que podem estar no mesmo host, ou seja, os gatilhos podem ser conectados, eles podem ser processados ‚Äã‚Äãjuntos no pr√©-processamento.  Por√©m, entre os hosts, a conectividade n√£o √© t√£o alta; portanto, √© normal usar esse cluster entre os n√≥s do cluster - haver√° muito tr√°fego l√°.  A principal tarefa dos clusters √© concordar entre si quem est√° envolvido em quais hosts. <br><br>  Eu gostaria de contornar nosso limite m√°ximo de 60 a 70 mil m√©tricas, porque o apetite vem da comida.  Temos pessoas envolvidas em QoE ... Qualidade da experi√™ncia - uma an√°lise de como a Internet funciona para assinantes com base em m√©tricas de tr√¢nsito, ou seja, voc√™ fornece todas as m√©tricas de TCP a 1,5 milh√£o de pessoas, despejando-as no monitoramento - h√° muitos dados. <br><br>  E eu queria confiabilidade.  Eu queria que algo acontecesse ... O funcion√°rio de plant√£o ligou e disse: "Temos problemas com o servidor", desligou-o e resolveremos amanh√£. <br><br><h3>  Primeiro cluster </h3><br>  A primeira vers√£o foi implementada com base no etcd: <br><br><img src="https://habrastorage.org/webt/oh/kr/qu/ohkrqu9wh-gldd6q6yheyoztro4.jpeg"><br><br>  Etcd √© um armazenamento de valor-chave distribu√≠do usado em muitos projetos progressivos (tanto quanto eu entendo, no Kubernetes).  Tudo foi √≥timo.  O Etcd fornece ferramentas muito interessantes - por exemplo, resolve o problema de escolher o servidor principal.  Mas esse problema ... <br><br>  T√≠nhamos um "Zabbix" cl√°ssico de tr√™s links: "web" - a base - o pr√≥prio servidor.  E adicionamos "Clickhouse" l√°, e agora adicionamos o etcd tamb√©m.  Os administradores come√ßaram a se esquivar: existem muitas depend√™ncias aqui - provavelmente n√£o ser√° confi√°vel.  No processo de desenvolvimento, mais uma coisa ficou clara: no pr√≥prio Zabbix j√° existe uma maneira interna de comunica√ß√£o entre servidores, √© usada apenas entre o servidor e o proxy, o chamado processo de pesquisa de proxy: <br><br><img src="https://habrastorage.org/webt/4x/cf/jh/4xcfjhgqaf-2h33nnzrjduw8rn8.jpeg"><br><br>  √â muito legal para comunica√ß√£o entre servidores com altera√ß√µes m√≠nimas.  Isso permitiu que o etcd n√£o usasse (pelo menos temporariamente), simplificasse bastante o c√≥digo e, o mais importante, trabalhasse no c√≥digo que foi verificado (parece que h√° 5 ou 7 anos nesse c√≥digo). <br><br><h3>  Como os servidores s√£o coordenados em um cluster? </h3><br>  A coordena√ß√£o √© feita por tipo, como o protocolo IGP.  Para que os servidores tenham prioridade (agora vou dizer por que isso √© necess√°rio) e para evitar conflitos no banco de dados SQL ao gravar logs, cada servidor recebe um identificador (at√© agora manualmente) - este √© um n√∫mero de 0 a 63 (63 - √© apenas uma constante, talvez mais): <br><br><img src="https://habrastorage.org/webt/kb/ei/xf/kbeixf3xjk6fo4oucwf9yk9yi9c.jpeg"><br><br>  O servidor com o identificador m√°ximo se torna o "mestre".  Quando lan√ßamos nossos primeiros clusters de teste, a primeira coisa que nossos administradores disseram foi: ‚ÄúUau!  E vamos coloc√°-los em sites diferentes.  Bem, √≥timo! ‚Äù(Voltaremos a isso).  E quando algu√©m distribuir clusters, ser√° poss√≠vel controlar como a topologia √© redistribu√≠da: para onde ser√° a fun√ß√£o do "mestre" em caso de queda no servidor "Zabbix" principal: <br><br><img src="https://habrastorage.org/webt/fa/n8/nx/fan8nxkovjbepqscnyljtfbc00o.jpeg"><br><br>  Nesse caso, assim: <br><br><img src="https://habrastorage.org/webt/5l/qu/ou/5lquouk5h0tkzky-e6_m8dfdkn4.jpeg"><br><br><h3>  Pisar </h3><br>  No Zabbix original, isso √© feito da seguinte maneira: o pr√≥prio servidor √© respons√°vel por gerar √≠ndices de incremento autom√°tico.  Para impedir que muitas inst√¢ncias pisem umas nas outras (para n√£o criar logs com os mesmos √≠ndices), √© usada a etapa: "Zabbix" com o identificador "1" gerar√° m√∫ltiplos de um - 1, 11, 21;  com o identificador "7" - 7, 17, 27 (com nuances). <br>  Dirigimos com modificadores. <br><br><img src="https://habrastorage.org/webt/t3/fo/2-/t3fo2-qoqlx0zwmxds7vc_7y2pw.jpeg"><br><br><h3>  Como os servidores interagem entre si? </h3><br>  Esse √© o legado dos Hello Packets do IGP a cada 5 segundos.  Portanto, os servidores sabem que t√™m vizinhos.  Portanto, o "mestre" sabe que h√° vizinhos por perto e, com base nisso, o "mestre" decide quais hosts podem ser distribu√≠dos para quais servidores. <br><br><img src="https://habrastorage.org/webt/um/vm/pn/umvmpn5x2hljbhbuzfp6b3umqpo.jpeg"><br><br>  Por conseguinte, existe uma configura√ß√£o.  De acordo com a mem√≥ria antiga, eu chamo de topologia.  Uma topologia √© essencialmente uma lista de servidores e hosts que pertencem a eles. <br><br>  O protocolo √© simples - este √© JSON: <br><br><img src="https://habrastorage.org/webt/qd/xx/rz/qdxxrzw2rj3akue1h8nwcqum1cc.jpeg"><br><br>  Este tamb√©m √© o legado do proxy Zabbix e da comunica√ß√£o do servidor Zabbix.  Em geral, n√£o faz sentido usar outra coisa.  A √∫nica coisa √© que, no caso do Zabbix, existem 4 bytes (ZBXD), mas esse n√£o √© o ponto. <br><br>  No pacote hello, o identificador do servidor √© transmitido: quando o servidor envia o pacote, ele diz seu identificador e sua vers√£o da topologia - dessa forma, os servidores descobrem rapidamente que h√° uma nova vers√£o da topologia e s√£o atualizados rapidamente. <br><br>  Na verdade, a topologia em si √© apenas uma √°rvore, uma lista de servidores.  Para cada servidor, uma lista de hosts suportados: <br><br><img src="https://habrastorage.org/webt/xp/dv/ec/xpdvecth8pp7eaukwxmykgysqiu.jpeg"><br><br>  E ent√£o surge um problema interessante. <br><br><h3>  Existe uma frase t√£o m√°gica - monitorar dom√≠nios </h3><br>  Qual √© o objetivo?  No Zabbix cl√°ssico, tudo era simples - uma atitude inequ√≠voca: esse host √© monitorado por esse proxy, esse proxy fornece dados ao servidor.  Se o proxy n√£o foi instalado (ou n√£o √© necess√°rio), esse servidor monitora todos os hosts: <br><br><img src="https://habrastorage.org/webt/x2/ly/fh/x2lyfh4prsystuyggxb0elwclx4.jpeg"><br><br>  Quando temos muitos servidores, o que fazer?  Al√©m disso, pode haver um problema com o fato de termos servidores distribu√≠dos geograficamente, e o servidor em um escrit√≥rio que trabalha lentamente em Kemerovo come√ßar√° a tentar monitorar toda a infraestrutura de Novosibirsk. <br><br><img src="https://habrastorage.org/webt/ep/06/cy/ep06cyiqx3dx4kkyfer1wcgn8um.jpeg"><br><br>  N√≥s n√£o queremos isso.  Queremos ter algum tipo de mecanismo para que nem todos os servidores, mas os que selecionamos (possivelmente com base na geografia), possam monitorar um host espec√≠fico.  Ao mesmo tempo, queremos gerenciar isso e queremos que seja simples.  Para isso, a id√©ia de monitorar dom√≠nios foi inventada.  Na verdade, esses s√£o grupos simples - simplesmente j√° existem grupos no registro. <br>  E quando eu fiz isso, os caras da opera√ß√£o conversaram comigo - disseram: ‚ÄúOs grupos nos confundem muito.  Sempre come√ßamos a pensar em grupos normais. ‚Äù  Portanto, este nome: monitorando dom√≠nios. <br><br>  Os hosts se relacionam sem ambiguidade: um host - um dom√≠nio: <br><br><img src="https://habrastorage.org/webt/6x/hi/z5/6xhiz5ocnajnjzoxin17log0liq.jpeg"><br><br>  O dom√≠nio do host pode incluir qualquer n√∫mero de servidores.  Os servidores podem estar em qualquer n√∫mero de dom√≠nios.  Isso √© uma coisa muito flex√≠vel.  Para expandir a flexibilidade e quebrar completamente o c√©rebro, h√° tamb√©m um dom√≠nio padr√£o: <br><br><img src="https://habrastorage.org/webt/ad/zl/2x/adzl2xgso7st_v9c7vg9-fyryvg.jpeg"><br><br>  Os servidores que s√£o membros do dom√≠nio padr√£o s√£o monitorados por todos os hosts que n√£o possuem servidores ativos ou que n√£o possuem um dom√≠nio de monitoramento. <br><br>  Isso apenas nos permite vincular topologicamente os hosts a alguns servidores e controlar como os hosts s√£o distribu√≠dos no caso de um servidor cair: <br><br><img src="https://habrastorage.org/webt/fm/og/nr/fmognrgop74jgnsqkwtxdzddqgw.jpeg"><br><br>  O pr√≥ximo problema que encontramos ... <br><br><h3>  Cluster: pense diferente </h3><br>  Quando temos muitos servidores, h√° novas oportunidades para construir um cluster, para construir uma topologia.  Esse √© um cl√°ssico quando temos algum tipo de site central e h√° sites remotos;  ou, digamos, um proxy onde a carga √© delegada: <br><br><img src="https://habrastorage.org/webt/rn/ar/qd/rnarqdcbs1knledntrvqoibsozs.jpeg"><br><br>  No caso do cluster Zabbix, ele pode ser implementado de duas maneiras.  Voc√™ pode seguir o caminho cl√°ssico: apenas o dobro da infraestrutura.  No centro, temos dois servidores que formam um cluster, podem reorganizar os hosts ou se responsabilizarem se o vizinho cair.  Assim, voc√™ pode criar proxies adicionais nos mesmos servidores - temos uma reserva dupla: <br><br><img src="https://habrastorage.org/webt/bx/es/g4/bxesg4ijxn4b9pirro22u3-omoa.jpeg"><br><br>  Voc√™ pode usar os novos "recursos" e fazer o seguinte: <br><br><img src="https://habrastorage.org/webt/v0/-o/ki/v0-okiiibpq1yyurxipbugjqfwq.jpeg"><br><br>  O principal n√£o √© ir para uma situa√ß√£o em que um servidor geograficamente remoto esteja monitorando alguma infraestrutura grande em outro local.  Este √© mais um problema de administra√ß√£o (eu chamo de neg√≥cio) porque √© um problema de configura√ß√£o. <br><br><h3>  Cluster: c√©rebro dividido e ponto de vista </h3><br>       ,    : <br><br><ul><li> split brain; </li><li> point of view ( ). </li></ul><br>   . Split brain ‚Äì       ,         .     ,  -  ‚Äì     ? ,      ,            ( ). <br><br>  point of view  : ,      ,          ,    .     . ,   RTT ,    . <br>       : <br><br><img src="https://habrastorage.org/webt/ab/qa/gc/abqagc2w3ky3kufvm6omjfsjheo.jpeg"><br><br>      ,   .   ,   ,       .    ,   ‚Äì   .    ,       ,  ,  . <br><br><h3>  SQL- </h3><br> ,     ,    ,       .       .  , ,       ‚Ä¶      .    . <br><br> -,  , ,  -      ‚Äì    . , Galera  MySQL. <br><br>        PostgreSQL.    ¬´¬ª   :    ,   ,           ‚Äì   . ¬´¬ª, ,    . <br><br><h3>    ? </h3><br>        ,    : <br><br><img src="https://habrastorage.org/webt/q4/u1/4s/q4u14s11rryz7afktbdfkn0s9sy.jpeg"><br><br><img src="https://habrastorage.org/webt/pj/0p/uq/pj0puqdn9zkhsm2uwolcaw40a1w.jpeg"><br><br>           ‚Äì  .      : <br><br><ul><li>  -  (Logs),    .   problems, events  events recovery.  ,   ‚Äì   ,   . </li><li>  15   (State).  ‚Äì     (    ‚Äì   ‚Äì ¬´¬ª   ).        .   ,  ;   ‚Äì        ‚Ä¶ </li><li>  -       (Configuration update). </li></ul><br>   ¬´.    ¬´¬ª,    SQL-: <br><br><img src="https://habrastorage.org/webt/ne/if/cc/neifccswcjikrxfetvhuip-agva.jpeg"><br><br> -,       : <br><br><img src="https://habrastorage.org/webt/4f/o4/ti/4fo4ticljuykrkh6zjmop4qc5sg.jpeg"><br><br>  .          -,   ,   ‚Ä¶    ‚Äì   ,   2  !    : ¬´  ,    ¬ª.  -  ,       ,    . <br><br> .         ,           : <br><br><img src="https://habrastorage.org/webt/lj/wh/ug/ljwhugg1tdfbehcxjcrloiolwks.jpeg"><br><br>   ,  .  SQL-     .     ,   SQL-.       (   -  ),        ¬´¬ª (        ). ‚Ä¶ <br><br><h3> .  </h3><br> , , ¬´¬ª  . .       ,   ? <br><br><img src="https://habrastorage.org/webt/ci/yo/ne/ciyonezibe3bfla-7xodyyx_zwg.jpeg"><br><br>    ¬´¬ª- (. .  ¬´¬ª daemon).       (   ):   (  1  63,      ¬´¬ª)    (   ,       ). <br><br>      ServerIP  IP-.    ,      ,     IP-   . -    ,         proxy poller,    trapper  hello-,  proxy poller  . <br><br>   . ,       ,    ¬´ ¬ª: <br><br><img src="https://habrastorage.org/webt/dr/1z/pi/dr1zpi2hbe9penikzazqcycw-oa.jpeg"><br><br>      : <br><br><img src="https://habrastorage.org/webt/kf/pg/jb/kfpgjbghzsonjmsizlbcatyo3ja.jpeg"><br><br>  ,       default.       .  ‚Äì   ,     IP-,    ,      (  ).      ¬´¬ª ‚Äì   default. <br><br>  -, . <br><br><ul><li>   . </li><li> ,      : ¬´    ,    ¬ª.   . </li><li>  - ,   . </li><li>     ,    hello-time,  : ¬´   ¬ª;    . </li><li>  . </li></ul><br> ,   , ,   .               30-40 .   ,      ,    ,   . <br><br><h3>    </h3><br>            ,      .      -   : ¬´    ,  !¬ª  -! <br><br><img src="https://habrastorage.org/webt/nq/ta/ah/nqtaahv3gipyew36m8nhrmwukew.jpeg"><br><br>   ‚Äì  :  -  ,  - , ,  GitLab, CI/CD,   . , ,  ‚Äì    . <br><br>  ,      ,       ‚Äì  4.0.9  (4.2   ).   Roadmap ‚Äì        -. -,    ¬´¬ª;   ,   RPM'. <br><br><img src="https://habrastorage.org/webt/er/kn/2r/erkn2r6h9law8l3xynd6i8_jwne.jpeg"><br><br>      (   )  ¬´¬ª       ¬´¬ª-.   .         ,    .   ‚Äì   :   , -   ‚Ä¶  ? !..   ¬´¬ª,  . <br><br>        SQL-   ,    ,   . History Storage. <br><br><h3>  Refer√™ncias </h3><br>     5 .      . <br> -, ,   ,      , . .      -. <br><br><img src="https://habrastorage.org/webt/zp/3a/gr/zp3agr9epncvnjndf-hgpwt_zke.jpeg"><br><br><h3>     </h3><br> ,     ?     !  , , ,  .   -   - ,         . ,         ,        .       ,    : <br><br><img src="https://habrastorage.org/webt/ac/fo/pf/acfopfqzuwvtfvtni2n9rjx-ywy.jpeg"><br><br>  . ¬´¬ª- ,      . <br><br><ul><li>    ,         ,     , . </li><li>   ¬´¬ª  :  ,       Configuration Cache,   . </li><li>   ,           ,     .        ,    ,   . </li><li>   -    ,   .      ,    ,    .    200     ,     ‚Äì   . </li></ul><br><h3>   </h3><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota: o proxy passivo ainda n√£o √© suportado! </font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eu removi o c√≥digo. </font><font style="vertical-align: inherit;">Isso se deve ao fato de ser dif√≠cil para as pessoas criar outro mecanismo, que servidor ainda ser√° respons√°vel por esse proxy. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pr√≥ximos proxies ativos v√£o para os servidores. </font><font style="vertical-align: inherit;">Existe uma op√ß√£o de servidor para isso (proxy padr√£o). </font><font style="vertical-align: inherit;">O proxy modificado possui a op√ß√£o Servidores: </font></font><br><br><img src="https://habrastorage.org/webt/jm/ym/6t/jmym6tfhwlg_ix6o5xnnkbwphri.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E o que esse servidor modificado faz? </font><font style="vertical-align: inherit;">Mant√©m uma conex√£o KPI com todos os servidores especificados para ele; </font><font style="vertical-align: inherit;">solicita configura√ß√£o, envia dados para o primeiro servidor dispon√≠vel da lista. </font><font style="vertical-align: inherit;">Isso resolve o problema. </font><font style="vertical-align: inherit;">Suponha que se voc√™ possui um proxy configurado no servidor Zabbix e o servidor Zabbix caiu, existe outro no cluster para n√£o ficar sem um proxy; </font><font style="vertical-align: inherit;">ent√£o o proxy simplesmente se conecta a outro.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Perguntas </font></font></h3><br>  Pergunta da plat√©ia (doravante - A): - Gostaria de esclarecer como est√£o as coisas entre os servidores?  Com qual protocolo eles se comunicam?  Existe algum tipo de seguran√ßa?  Porque n√£o √© muito "seguro" levar a comunica√ß√£o entre os servidores √† Internet ... Como est√° indo? <br><br>  <b>MM:</b> - Eu acho que este √© um candidato √† melhor pergunta - direto ao ponto!  De fato, quando mudamos para a comunica√ß√£o padr√£o, os servidores para a comunica√ß√£o entre servidores herdaram todos os recursos do protocolo de comunica√ß√£o que existem entre o servidor e o proxy.  Vou esclarecer: h√° criptografia, compacta√ß√£o de dados.  Por favor - da mesma maneira que tudo √© configurado via web, como √© padr√£o para o servidor e proxy;  tudo vai funcionar. <br><br>  <b>A:</b> - Como o Hauskiper funciona para voc√™ no caso da Clickhouse? <br><br>  <b>MM:</b> - No ‚ÄúZabbix‚Äù padr√£o, n√£o h√° interface da ‚ÄúGovernanta‚Äù para a Interface do Hist√≥rico, ou seja, a Interface do Hist√≥rico n√£o suporta a rota√ß√£o de dados (o ElasticSearch, por exemplo, n√£o suporta).  Talvez no 4.2 seja (eu n√£o olhei), mas at√© agora no 4.0.9. <br><br>  Facilite isso!  O novo "Clickhouse" possui uma parti√ß√£o.  Eu gostaria de fazer desativando parti√ß√µes desatualizadas.  √â claro que n√£o haver√° rota√ß√£o no n√≠vel de itens individuais, mas h√° um truque no Zabbix: voc√™ pode especificar valores globais (por exemplo, armazenar o hist√≥rico inteiro por n√£o mais de 90 dias) - voc√™ pode limpar todos os itens, o hist√≥rico inteiro desses valores globais .  E ser√° feito!  H√° mais sobre este t√≥pico no Gitlab. <br><br>  Queremos fazer o direito arquitet√¥nico: expandir a Interface do Hist√≥rico, para que basicamente seja ... Em geral, n√£o quero deixar d√≠vidas t√©cnicas, mas isso ser√° feito.  Por ser necess√°rio, mais "Clickhouse" come√ßou a apoiar. <br><br>  <b>A:</b> - Como voc√™ se sente sobre isso?  Acontece que voc√™ est√° realizando bastante trabalho de n√£o fornecedor. <br><br>  <b>MM:</b> - Eu provavelmente n√£o coloquei muito corretamente.  Este √© o meu hobby!  Na verdade, n√£o sou especialista t√©cnico - sou gerente.  No meu tempo livre eu pratico. <br><br>  <b>A:</b> - Pensei que voc√™ estivesse fazendo isso como parte do seu neg√≥cio principal ... <br><br>  <b>MM:</b> - Os neg√≥cios me d√£o um lugar legal para testar.  Na verdade, eu recomendo - alivia o c√©rebro.  Em algum lugar da "coisa" administrativa, eu diria isso - quando voc√™ pode mudar de problemas humanos para esses.  Eles s√£o t√£o legais resolvidos!  Essas s√£o quest√µes t√©cnicas.  Voc√™ programou e funciona da maneira que voc√™ programou!  √â uma pena que as pessoas n√£o devam fazer isso. <br><br>  <b>R:</b> - Voc√™ escreve para ‚ÄúClickhouse‚Äù atrav√©s de algum proxy ou diretamente? <br><br>  <b>MM:</b> - Diretamente.  De fato, a Interface de Hist√≥ria alterada, usada para o "Elastix", tamb√©m √© herdada.  O URL √© usado, ou seja, atrav√©s da interface http "Zabbiks" envia "Clickhouse".  O que √© legal, o Zabbix agrega quando h√° um grande fluxo de hist√≥ria, milhares de m√©tricas em um pacote e isso cai muito bem na Clickhouse. <br><br>  <b>A:</b> - De fato, ele escreve bachi para ele? <br><br>  <b>MM:</b> - Sim.  Uma consulta SQL executada pelo URL geralmente cont√©m mil m√©tricas.  Admins "Clickhouse" apenas feliz. <br><br>  Apresentador: - Este √© o final do programa nesta sala.  H√° um programa noturno organizado e h√° algo que somente voc√™ pode fazer.  E sugiro que, enquanto voc√™ se comunica, pense sobre quais coisas interessantes voc√™ pode ... Quando voc√™ conta um ao outro sobre seus casos, √© mais prov√°vel que voc√™ possa falar disso.  Ao discutir um com o outro, voc√™ pode encontrar apenas algumas dicas - o comit√™ do programa aceitar√° sua inscri√ß√£o, considerar√° e ajudar√° a criar uma boa hist√≥ria sobre ela.  Talvez voc√™ tenha algum tipo de hist√≥ria sobre como trabalhar com o comit√™ do programa? <br><br>  <b>MM:</b> - Na verdade, muitos coment√°rios s√£o dados.  Tive muita sorte: uma pessoa do comit√™ do programa mora em Chelyabinsk e Highload √© a √∫nica confer√™ncia que trabalha t√£o de perto com os palestrantes.  Eu nunca vi nada assim em nenhum outro lugar.  √â muito ben√©fico!  Diferentes est√°gios: os caras assistem ao v√≠deo, comentam os slides - isso realmente acontece no assunto (ortografia, erros de digita√ß√£o).  Muito legal!  Eu recomendo!  Tente voc√™ mesmo! <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wbIpn44Z2_8" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Um pouco de publicidade :) </h3><br>  Obrigado por ficar conosco.  Voc√™ gosta dos nossos artigos?  Deseja ver materiais mais interessantes?  Ajude-nos fazendo um pedido ou recomendando aos seus amigos <a href="https://ua-hosting.company/cloudvps/nl">VPS baseado em nuvem para desenvolvedores a partir de US $ 4,99</a> , um <b>anal√≥gico exclusivo de servidores</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">b√°sicos</a> <b>que foi inventado por n√≥s para voc√™:</b> <a href="https://habr.com/company/ua-hosting/blog/347386/">Toda a verdade sobre o VPS (KVM) E5-2697 v3 (6 n√∫cleos) 10GB DDR4 480GB SSD 1Gbps de 10GB de US $ 19 ou como dividir o servidor?</a>  (as op√ß√µes est√£o dispon√≠veis com RAID1 e RAID10, at√© 24 n√∫cleos e at√© 40GB DDR4). <br><br>  <b>Dell R730xd 2 vezes mais barato no data center Equinix Tier IV em Amsterd√£?</b>  Somente temos <b><a href="https://ua-hosting.company/serversnl">2 TVs Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100 TV a partir de US $ 199</a> na Holanda!</b>  <b><b>Dell R420 - 2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB - a partir de US $ 99!</b></b>  Leia sobre <a href="https://habr.com/company/ua-hosting/blog/329618/">Como criar um pr√©dio de infraestrutura.</a>  <a href="https://habr.com/company/ua-hosting/blog/329618/">classe usando servidores Dell R730xd E5-2650 v4 custando 9.000 euros por um centavo?</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt485534/">https://habr.com/ru/post/pt485534/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt485524/index.html">O resumo de materiais interessantes para o desenvolvedor m√≥vel n¬∫ 330 (de 20 a 26 de janeiro)</a></li>
<li><a href="../pt485526/index.html">Quem e por que deseja tornar a Internet "compartilhada"</a></li>
<li><a href="../pt485528/index.html">Como finalizar um projeto de desenvolvimento de software da maneira certa</a></li>
<li><a href="../pt485530/index.html">Aprendizagem Guiada</a></li>
<li><a href="../pt485532/index.html">Guia de Entrevistas para programadores que n√£o os entendem</a></li>
<li><a href="../pt485536/index.html">√â poss√≠vel invadir um avi√£o - 2</a></li>
<li><a href="../pt485538/index.html">Zabbix: monitore tudo em uma fileira (no exemplo do Redis)</a></li>
<li><a href="../pt485542/index.html">Adicionar gr√°ficos ao No√ß√£o</a></li>
<li><a href="../pt485544/index.html">O xadrez como um sistema din√¢mico</a></li>
<li><a href="../pt485546/index.html">O apocalipse est√° chegando</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>