<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕵🏾 💇🏿 🈴 Vida cotidiana MT_FREE: varias historias sobre la influencia de los servicios de terceros en el trabajo de Wi-Fi público 🤙🏿 🤳 🦌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Internet es un entorno grande y dinámico donde todo está conectado entre sí de una manera u otra y puede influirse entre sí. Tal relación, cuando un p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vida cotidiana MT_FREE: varias historias sobre la influencia de los servicios de terceros en el trabajo de Wi-Fi público</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/maximatelecom/blog/457958/"><img src="https://habrastorage.org/webt/p5/iu/35/p5iu35hkztdmnqhghvtkz5zos8y.jpeg"><br><br>  Internet es un entorno grande y dinámico donde todo está conectado entre sí de una manera u otra y puede influirse entre sí.  Tal relación, cuando un pequeño cambio en una parte del sistema puede conducir a un cambio completo en otra, se conoce popularmente como el "efecto mariposa".  El efecto ilustra perfectamente cómo una "botas bien colocadas en la consola" puede hacer caer un servicio importante y, al mismo tiempo, un par de extraños ... Hablaremos de esto. <br><a name="habracut"></a><br><h3>  Hace cinco años, cuando apareció el Wi-Fi en el metro ... </h3><br>  ... fue un fenómeno que dividió la vida de los moscovitas en "antes" y "después".  En ese momento, el proyecto era el único en el mundo, y todo en él era igual de único: estructura de red, modelo de monetización, servicios de usuario, enfoques de construcción y operación. <br><br>  Casi desde el lanzamiento del primer segmento de Wi-Fi en el metro, obtuvimos autorización y nuestro propio portal de medios.  Experimentamos generosamente con el portal en términos de integración con servicios de terceros, de hecho, exploramos las capacidades de nuestro modelo de negocio ("¿y si vendemos café en el metro con entrega a la entrada desde el lobby?"). <br><br>  Al principio, involucramos activamente a socios de diversos campos en nuestro trabajo.  Pero casi todas las publicaciones de un nuevo servicio de afiliación llevaron a la caída de este último bajo carga y la necesidad de una reversión de emergencia de los cambios.  Pocas personas pueden sobrevivir a miles de nuevas solicitudes por minuto, y algunas son incapaces de hacerlo en principio debido a la arquitectura no escalable.  La presencia de tal problema nos hizo monitorear el desempeño de los servicios de afiliados, de los cuales la experiencia del usuario depende directamente.  Y también desarrollar mecanismos para reducir esta dependencia (proxy, caché). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xz/w-/iz/xzw-iz9s8mekuznsiqzcnq1vxna.jpeg"></div> <i><font color="999999">Una vez que un fuerte grito en la oficina de "Five Hundred" puso en marcha a toda la compañía, ahora tales situaciones prácticamente no ocurren.</font></i>  <i><font color="999999">En la pantalla de julio de 2015, el resultado del lanzamiento de un servicio de venta de flores con entrega en nuestro subdominio.</font></i> <br><br>  Pero la evolución nunca va rápido.  Antes de construir el sistema actual, teníamos que "llenar conos" y experimentar toda una serie de accidentes por nuestra propia experiencia.  Además, el proceso no se detiene: cuanto más profundizamos en los problemas, más identificamos las dependencias más inesperadas.  Mirando hacia atrás, entendemos lo importante que es a veces tener un ejemplo de cómo sucede.  Eso es lo que queremos compartir. <br><br><h3>  El nuevo iOS redujo el tráfico en un 20% </h3><br>  MaximaTelecom se especializa en la construcción de redes en el transporte.  La gran mayoría de los dispositivos de suscriptores que usan nuestra red son móviles, teléfonos inteligentes y tabletas basados ​​en Android e iOS.  Ambos proveedores, Google y Apple, tienen hojas de ruta para lanzar actualizaciones a sus sistemas operativos.  En las nuevas versiones, los módulos responsables de conectarse a Wi-Fi a menudo cambian.  En el mejor de los casos, el día del lanzamiento de la actualización, el tráfico está creciendo debido a que los dispositivos descargan la actualización a través de Wi-Fi.  Pero hay casos catastróficos. <br><br>  El año pasado, Apple lanzó una nueva versión de iOS 10.3.1, después de lo cual el tráfico de la red se estrelló en casi un 20%.  Resultó que en la nueva versión, Apple "rompió" el proceso de conexión a la red: la mecánica de autorización en Captive dejó de funcionar y los dispositivos no pudieron iniciar sesión en MT_FREE.  Tuve que liberar una solución en modo de emergencia y corregir la situación.  El problema se solucionó después de tres actualizaciones menores, después de que abrimos un caso en el rastreador de errores de Apple. <br><br><img src="https://habrastorage.org/webt/1m/78/p0/1m78p0wtyc0jsjrq4cbsdq4jw5e.png"><br><br><img src="https://habrastorage.org/webt/1y/zi/vk/1yzivkvarkgotniqq3ulbshzsi4.png"><br>  <i><font color="999999">El número de llamadas a la página de autorización auth.wi-fi.ru por minuto.</font></i>  <i><font color="999999">El gráfico muestra claramente un retraso significativo de los indicadores para el período anterior.</font></i> <br><br>  La situación se ve agravada por el hecho de que el Wi-Fi es una tecnología bastante antigua y muy extendida, cuya creación no se suponía que se utilizaría en una escala como la que tenemos en el Metro de Moscú.  Entonces, tenemos que lidiar con una "ensalada" completa de varios dispositivos, cada uno de los cuales se comporta en la red a su manera.  Las métricas planas del número de megabytes abstractos o "suscriptores esféricos en la red" no son aplicables a nosotros.  Cualquier servicio, ya sea acceso básico a Internet, un portal de medios o una aplicación móvil, debe considerarse en el contexto de dispositivos y / o sistemas operativos específicos, ya que el problema puede afectar a un grupo específico y bastante limitado. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xs/fh/lv/xsfhlvo2p6acl4lyhwhy-g4fk0c.png"></div><br>  <i><font color="999999">... y algunas docenas de las opciones más exóticas.</font></i> <br><br><h3>  Esto no es DDOS: el accidente de un operador móvil provocó un salto en el tráfico de casi un tercio </h3><br>  Hace dos años, uno de los operadores móviles tuvo un accidente grave.  En tales casos, los usuarios buscan una alternativa al servicio de comunicación.  Si hablamos del metro, entonces no había formas alternativas de comunicación en los trenes. <br><br><div class="spoiler">  <b class="spoiler_title">Aclaracion</b> <div class="spoiler_text">  <i>Y ahora, solo unos pocos operadores brindan servicio en áreas equipadas con un cable radiante.</i>  <i>Pero esta tecnología tiene una capacidad muy limitada y no puede proporcionar un nivel de servicio comparable para una proporción significativa de usuarios.</i>  <i>Sin mencionar el costo del tráfico en los planes de tarifas límite.</i> </div></div><br>  Pero en las estaciones, las comunicaciones celulares se han desarrollado con bastante fuerza, sin mencionar los segmentos terrestres, donde el Wi-Fi compite directamente con él. <br><br>  Nos enteramos del accidente en la red del operador de telefonía móvil a través de nuestro servicio de despacho, que anunció que nos estaban atacando.  El crecimiento en el número de usuarios y el tráfico fue tal que al principio pensamos que estábamos basados ​​en DDOS.  Luego nos enteramos de las razones reales del aumento del tráfico, descubriendo que un tercio de los empleados no tienen teléfonos celulares. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ib/kn/gt/ibkngtawi8us5ut2nbjehrjauim.png"></div><br>  <i><font color="999999">Así es como se veían nuestros usuarios de Wi-Fi sobre el suelo.</font></i> <br><br>  La especificidad de nuestra situación específicamente es que tenemos redes Wi-Fi, lo que significa que no nos importa qué tarjeta SIM de qué operador de telecomunicaciones esté instalado en el dispositivo del usuario. <br><br>  Vale la pena mencionar que el accidente que ocurrió afectó nuestro servicio en parte y negativamente.  Algunos segmentos de la red MT_FREE, en particular, la red en autobuses urbanos y trenes de cercanías, utilizan la comunicación celular como una red troncal, lo que significa que un accidente en las redes celulares conduce a la degradación del servicio en estos segmentos. <br><br><cut></cut><h3>  Wi-Fi en el metro sin anuncios?  Si! </h3><br>  La publicidad es la base del acceso gratuito a la red MT_FREE, porque es gracias a ella que el servicio existe y vale la pena.  Como AdServer base, hemos estado usando AdFox durante muchos años.  Es interesante que AdServer en sí no sufrió cambios significativos durante todo el tiempo que trabajamos con él.  Uno de sus detalles es el sistema de recopilación de estadísticas sobre impresiones, que se forma por intervalos por hora.  Esto provoca picos rítmicos en el tiempo de respuesta del servicio (cada hora, exactamente al borde de la hora, el "giro" comienza a "jugar bromas" y pensar en cada respuesta).  ¡No captamos este matiz muy inmediatamente! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kx/rb/f_/kxrbf_wkx_0tddvalyqm7xqaxnq.jpeg"></div><br>  <i><font color="999999">Cronología de respuesta de AdFox para una solicitud de anuncio.</font></i>  <i><font color="999999">Las explosiones y caídas en el borde de la hora son claramente visibles.</font></i> <br><br>  De hecho, observamos los mismos "picos" característicos por hora en el número de impresiones para otras herramientas de monitoreo, para la misma métrica.  Pero quiero hablar sobre una situación más extrema.  El invierno pasado, AdFox sufrió un grave accidente: el servicio no respondió durante mucho tiempo.  En nuestras métricas, esto se manifestó como una falta de autorización del usuario y una fuerte caída en el rendimiento del portal.  Al mismo tiempo, la interfaz de administración de AdFox con un error de certificado no estaba disponible. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/eq/ke/gn/eqkegna6sr78wztahh1jcrrazue.jpeg"></div><br>  <i><font color="999999">Ilustración del error del certificado adfox.ru.</font></i> <br><br>  Después de realizar un par de pruebas y llamar al propio AdFox, descubrimos el accidente y no tuvimos más remedio que dejar que todos los usuarios identificados ingresaran a la red sin publicidad. <br><br><img src="https://habrastorage.org/webt/ht/ad/jv/htadjvxzmar6wtjwixtd0yfk45w.jpeg"><br>  <i><font color="999999">Y aquí está el accidente en las métricas de Yandex en nuestro portal.</font></i> <br><br><h3>  Las descargas más rápidas a veces producen resultados inesperados </h3><br>  La calidad percibida de nuestro servicio depende no solo del trabajo de la infraestructura de otras personas, actualizaciones del sistema operativo y fallas en los recursos masivos, sino también del comportamiento de navegadores específicos en dispositivos específicos.  En este sentido, tenemos muchas más oportunidades de influencia, por lo que trabajamos constantemente para mejorar los productos.  En promedio, publicamos una actualización por día.  Pero a veces una actualización aparentemente simple, que debería conducir a una mejora en la experiencia del usuario, conlleva consecuencias impredecibles. <br><br>  Dado que tenemos la oportunidad de influir en la operación de los servicios a nivel de red (por ejemplo, al cambiar la prioridad de un tipo de tráfico en relación con otro), surgió la idea de acelerar la autorización al priorizar el tráfico.  Publicamos los cambios correspondientes y, con asombro, comenzamos a observar numerosos errores y una caída del 20% en los ingresos publicitarios.  Las pruebas técnicas mostraron que el circuito funciona absolutamente correctamente desde el punto de vista de la red.  Sin embargo, la reversión de los cambios confirmó que la razón estaba precisamente en la nueva configuración. <br><br>  Como resultado, descubrimos que al aumentar la prioridad de algunos scripts sobre otros, cambiamos el orden de ejecución de las funciones en el nivel de carga de la página de autorización en el navegador.  Esto ha afectado significativamente la experiencia del usuario.  De hecho, los scripts de autorización comenzaron a cargarse y ejecutarse más rápido que los scripts de anuncios.  Debido a la relación existente entre ellos, surgieron situaciones en las que una función espera el resultado de otra, cuyo archivo aún no se ha descargado en el dispositivo. <br><br><h3>  Redes sociales vs medios </h3><br>  El comportamiento de los usuarios en Internet corresponde a patrones estándar.  Las personas están acostumbradas a comunicarse a través de mensajeros, buscar contenido en portales de medios, leer noticias a través de redes sociales y agregadores de noticias.  Es bastante obvio, pero aún se centra en el hecho de que las redes sociales son una alternativa a las noticias, y viceversa.  Cuando algo sucede repentinamente con una de las fuentes de información, la atención de los usuarios se redistribuye al resto, generalmente el más accesible.  Entonces, en 2017 hubo una falla global en VKontakte.  Por nuestra parte, este evento parecía un fuerte aumento en los usuarios y el tiempo en nuestro portal de noticias wi-fi.ru.  De hecho, los usuarios, al darse cuenta de que su red social favorita no funciona, nos leyeron las noticias. <br><br><img src="https://habrastorage.org/webt/8e/pm/nx/8epmnxp_aabhtaw6yyr3uufkdjq.png">  <i><font color="999999">El momento del colapso de VK estuvo marcado por un aumento del 30% en la carga en el portal wi-fi.ru.</font></i> <br><br>  Este caso ilustra la importancia de que los servicios de masas tengan un margen de seguridad para "digerir" las consecuencias de un accidente informativo de "vecino". <br><br><h3>  Verde: sin accidentes </h3><br>  Las situaciones descritas nos animan constantemente a mejorar la supervisión de los servicios de terceros en MT_FREE.  Así es como se ve el tablero para operar nuestra red. <br><br><img src="https://habrastorage.org/webt/ne/rt/tz/nerttzur3msulj1hgz7umxvecig.png">  <i><font color="999999">Operación de la red del tablero en San Petersburgo.</font></i> <br><br>  Un tablero de instrumentos consta de muchos indicadores del tipo de "semáforo": estado verde - todo es normal, color rojo - alarma.  El color de los indicadores varía con el tiempo.  Esto puede ser un comportamiento normal o un signo de anormalidad.  Pero si "estira" todos los indicadores con una línea y coloca cada paso de medida de tal manera en el tablero, obtendrá una imagen bidimensional y en constante crecimiento que describe la evolución de la red en su conjunto.  Esta imagen se puede "alimentar" fácilmente con algoritmos de aprendizaje automático estándar diseñados para reconocer patrones gráficos (una especie de FindFace, solo para patrones de sensores). <br><br><img src="https://habrastorage.org/webt/l1/du/ja/l1duja5zbh99hhct0req-owgnvu.png">  <i><font color="999999">La tabla de colores de los indicadores basada en el tiempo no es más que una imagen que describe la evolución de la red.</font></i> <br><br>  A continuación, se agregan algoritmos de autoaprendizaje (como AI) que pueden clasificar automáticamente patrones e identificar causas de desviaciones o datos incompletos.  Todo parece simple, pero ¿qué opinas, cuántos operadores de telecomunicaciones realmente lo usan? <br><br><h3>  Pocos, y no estamos entre ellos. </h3><br>  Para ser justos, la aplicación de esta tecnología en el marco de MaximTelecom se encuentra en una etapa bastante temprana, en gran parte porque no está claro dónde está la línea entre lo que debe recibirse desde fuera de la red y lo que puede obtenerse desde adentro.  Nuestra ventaja aquí es que comenzamos a desarrollar la base algorítmica necesaria desde el principio como parte de nuestra plataforma para la monetización de la red publicitaria. <br><br>  Maxima es el operador, en primer lugar, del servicio gratuito de acceso a Wi-Fi.  Además, a diferencia de un número suficientemente grande de Wi-Fi "social", somos un operador de comunicaciones comerciales completo.  De hecho, esta es nuestra idea corporativa: nos esforzamos por hacer que la comunicación sea gratuita y rentable al mismo tiempo, y ya hemos demostrado que esto es posible.  Casi ningún operador de telecomunicaciones en el mundo puede (o no) querer esto, y por lo tanto no desarrolla tecnología para esto.  Esto da la esperanza de que en el futuro podamos llevar nuestras tecnologías al punto en que la experiencia del usuario de MT_FREE no difiera de lo que proporcionan los operadores tradicionales pagados.  Al mismo tiempo, el nivel de confiabilidad será mayor debido a un sistema de control y operación inteligente más desarrollado. <br><br>  Pero, desafortunadamente, no todos los problemas pueden resolverse dentro de las capacidades de una compañía, aunque solo sea porque hay muchos fabricantes de suscriptores y equipos de Wi-Fi de red, y el nivel de unificación es significativamente inferior al de las redes celulares.  Resolvemos problemas con varios dispositivos al conectarnos a la red desde el momento del lanzamiento.  La "raíz del mal" aquí está en ausencia de cualquier estándar y, como resultado, cada fabricante crea algo propio. <br><br>  Para resolver estos problemas de la industria, existen asociaciones internacionales.  Por ejemplo, ahora lideramos el proyecto para estandarizar la experiencia del usuario cuando se conecta a redes Wi-Fi mediante monetización publicitaria.  Pero este es un tema para otro artículo. <br><br>  Por cierto, estamos constantemente expandiendo el personal de desarrollo, las vacantes relevantes se pueden encontrar en nuestra <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">página de carrera</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/457958/">https://habr.com/ru/post/457958/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457946/index.html">10 mejores bibliotecas de JavaScript para visualizar datos en gráficos y tablas</a></li>
<li><a href="../457948/index.html">Juegos de mesa en los que tienes que aplastarte la cabeza</a></li>
<li><a href="../457952/index.html">Cómo se diseñan y fabrican los procesadores: fabricación de chips</a></li>
<li><a href="../457954/index.html">Por qué Swift puede convertirse en un gran evento en el aprendizaje profundo</a></li>
<li><a href="../457956/index.html">Cómo elegir el almacenamiento sin dispararte en el pie</a></li>
<li><a href="../457960/index.html">Sala de reuniones L̶i̶t̶t̶l̶e̶ Helper v 2</a></li>
<li><a href="../457962/index.html">Al igual que en la arquitectura thrash y la falta de habilidades en Scrum, creamos equipos de componentes cruzados</a></li>
<li><a href="../457964/index.html">Virtualidad real: estaciones de trabajo ++</a></li>
<li><a href="../457966/index.html">"Abriría una zona de TI especial en el sur de Rusia" - 10 preguntas al programador # 11. Nueva temporada</a></li>
<li><a href="../457968/index.html">Paralelos que se cruzan: el Ministerio de Comunicaciones quemó durante la noche miles de millones en presupuestos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>