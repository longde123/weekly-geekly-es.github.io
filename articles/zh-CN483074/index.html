<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>â¿ ğŸš£ğŸ» ğŸ’¸ TensorRT 6.xxx-æ·±åº¦å­¦ä¹ æ¨¡å‹çš„é«˜æ€§èƒ½æ¨ç†ï¼ˆå¯¹è±¡æ£€æµ‹å’Œåˆ†æ®µï¼‰ ğŸ¤½ğŸ¿ ğŸ›¥ï¸ ğŸ¥€</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç¬¬ä¸€æ¬¡æ‰ç–¼ï¼ 

 å¤§å®¶å¥½ï¼ äº²çˆ±çš„æœ‹å‹ä»¬ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³åˆ†äº«åŸºäºgithub.com/aidonchuk/retinanet-exampleså­˜å‚¨åº“çš„TensorRTï¼ŒRetinaNetçš„ç»éªŒï¼ˆè¿™æ˜¯nvidiaçš„å®˜æ–¹äº¤é’¥åŒ™çš„åˆ†æ”¯ï¼Œè¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿå°½å¿«å¼€å§‹åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ä¼˜åŒ–çš„æ¨¡å‹ï¼‰ã€‚ æ»šåŠ¨æµè§ˆods.a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>TensorRT 6.xxx-æ·±åº¦å­¦ä¹ æ¨¡å‹çš„é«˜æ€§èƒ½æ¨ç†ï¼ˆå¯¹è±¡æ£€æµ‹å’Œåˆ†æ®µï¼‰</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/483074/"><img src="https://habrastorage.org/webt/qr/je/yu/qrjeyup390z-iv5uyduultmmxcs.png" alt="å›¾ç‰‡"><br>  <i>ç¬¬ä¸€æ¬¡æ‰ç–¼ï¼</i> <br><br> å¤§å®¶å¥½ï¼ äº²çˆ±çš„æœ‹å‹ä»¬ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘æƒ³åˆ†äº«åŸºäº<a href="https://github.com/aidonchuk/retinanet-examples">github.com/aidonchuk/retinanet-examples</a>å­˜å‚¨åº“çš„TensorRTï¼ŒRetinaNetçš„ç»éªŒï¼ˆè¿™æ˜¯<a href="https://github.com/NVIDIA/retinanet-examples">nvidia</a>çš„å®˜æ–¹äº¤é’¥åŒ™çš„åˆ†æ”¯ï¼Œè¿™å°†ä½¿æˆ‘ä»¬èƒ½å¤Ÿå°½å¿«å¼€å§‹åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ä¼˜åŒ–çš„æ¨¡å‹ï¼‰ã€‚  <a href="https://ods.ai/">æ»šåŠ¨æµè§ˆods.ai</a>ç¤¾åŒº<a href="https://ods.ai/">é¢‘é“æ—¶</a> ï¼Œæˆ‘é‡åˆ°äº†æœ‰å…³ä½¿ç”¨TensorRTçš„é—®é¢˜ï¼Œå¹¶ä¸”å¤§å¤šæ•°é—®é¢˜éƒ½åœ¨é‡å¤ï¼Œå› æ­¤æˆ‘å†³å®šç¼–å†™<i>å°½å¯èƒ½å…¨é¢çš„</i>æŒ‡å—<i>ï¼Œ</i>ä»¥åŸºäºTensorRTï¼ŒRetinaNetï¼ŒUnetå’Œdockerä½¿ç”¨å¿«é€Ÿæ¨ç†ã€‚ <br><a name="habracut"></a><br>  <b>ä»»åŠ¡è¯´æ˜</b> <br><br> æˆ‘å»ºè®®ä»¥è¿™ç§æ–¹å¼è®¾ç½®ä»»åŠ¡ï¼šæˆ‘ä»¬éœ€è¦æ ‡è®°æ•°æ®é›†ï¼Œåœ¨Pytorch1.3 +ä¸Šè®­ç»ƒRetinaNet / Unetç½‘ç»œï¼Œå°†æ¥æ”¶åˆ°çš„æƒé‡è½¬æ¢ä¸ºONNXï¼Œç„¶åå°†å…¶è½¬æ¢ä¸ºTensorRTå¼•æ“ï¼Œç„¶ååœ¨dockerä¸­è¿è¡Œæ•´ä¸ªè¿‡ç¨‹ï¼Œæœ€å¥½åœ¨Ubuntu 18ä¸Šè¿è¡Œï¼Œæœ€å¥½åœ¨ARMï¼ˆJetsonï¼‰*ä½“ç³»ç»“æ„ä¸Šä½¿ç”¨ï¼Œä»è€Œæœ€å¤§ç¨‹åº¦åœ°å‡å°‘äº†ç¯å¢ƒçš„æ‰‹åŠ¨éƒ¨ç½²ã€‚ ç»“æœï¼Œæˆ‘ä»¬å°†å‡†å¤‡å¥½ä¸€ä¸ªå®¹å™¨ï¼Œä¸ä»…å¯ä»¥ç”¨äºRetinaNet / Unetçš„å¯¼å‡ºå’ŒåŸ¹è®­ï¼Œè¿˜å¯ä»¥ç”¨äºåˆ†ç±»ï¼Œåˆ†æ®µå’Œæ‰€æœ‰å¿…è¦ç»‘å®šçš„å…¨é¢å¼€å‘å’ŒåŸ¹è®­ã€‚ <br><cut></cut><br>  <b>é˜¶æ®µ1.å‡†å¤‡ç¯å¢ƒ</b> <br><br> é‡è¦çš„æ˜¯è¦æ³¨æ„ï¼Œæœ€è¿‘æˆ‘å®Œå…¨æ”¾å¼ƒäº†å°å¼æœºä»¥åŠdevboxä¸Šè‡³å°‘æŸäº›åº“çš„ä½¿ç”¨å’Œéƒ¨ç½²ã€‚ æ‚¨å”¯ä¸€éœ€è¦åˆ›å»ºå’Œå®‰è£…çš„æ˜¯pythonè™šæ‹Ÿç¯å¢ƒå’Œæ¥è‡ªdebçš„cuda 10.2ï¼ˆå¯ä»¥å°†è‡ªå·±é™åˆ¶ä¸ºå•ä¸ªnvidiaé©±åŠ¨ç¨‹åºï¼‰ã€‚ <br><br> å‡è®¾æ‚¨å·²ç»å…¨æ–°å®‰è£…äº†Ubuntu18ã€‚è¯·å®‰è£…cuda 10.2ï¼ˆdebï¼‰ï¼Œåœ¨æ­¤æˆ‘ä¸ä¼šè¯¦ç»†ä»‹ç»å®‰è£…è¿‡ç¨‹ï¼Œå®˜æ–¹æ–‡æ¡£å·²ç»è¶³å¤Ÿã€‚ <br><br> ç°åœ¨æˆ‘ä»¬å°†å®‰è£…dockerï¼Œå¯ä»¥è½»æ¾æ‰¾åˆ°dockerå®‰è£…æŒ‡å—ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹<a href="https://www.digitalocean.com/community/tutorials/docker-ubuntu-18-04-1-ru">www.digitalocean.com/community/tutorials/docker-ubuntu-18-04-1-en</a> ï¼Œå·²ç»æä¾›19+ç‰ˆæœ¬ã€‚ å¥½å§ï¼Œä¸è¦å¿˜è®°ä½¿ä¸ä½¿ç”¨sudoçš„dockeræˆä¸ºå¯èƒ½ï¼Œå®ƒå°†æ›´åŠ æ–¹ä¾¿ã€‚ ä¸€åˆ‡éƒ½å®Œæˆä¹‹åï¼Œæˆ‘ä»¬è¿™æ ·åšï¼š <br><br><pre><code class="bash hljs">distribution=$(. /etc/os-release;<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$ID</span></span><span class="hljs-variable"><span class="hljs-variable">$VERSION_ID</span></span>) curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add - curl -s -L https://nvidia.github.io/nvidia-docker/<span class="hljs-variable"><span class="hljs-variable">$distribution</span></span>/nvidia-docker.list | sudo tee /etc/apt/sources.list.d/nvidia-docker.list sudo apt-get update &amp;&amp; sudo apt-get install -y nvidia-container-toolkit sudo systemctl restart docker</code> </pre> <br> è€Œä¸”ï¼Œæ‚¨ç”šè‡³ä¸å¿…æŸ¥çœ‹å®˜æ–¹èµ„æºåº“<a href="https://github.com/NVIDIA/nvidia-docker">github.com/NVIDIA/nvidia-docker</a> ã€‚ <br><br> ç°åœ¨æ‰§è¡Œgit clone <a href="https://github.com/aidonchuk/retinanet-examples">github.com/aidonchuk/retinanet-examples</a> ã€‚ <br><br> å‰©ä¸‹çš„åªæ˜¯ä¸€ç‚¹ç‚¹ï¼Œä¸ºäº†å¼€å§‹å°†dockerä¸nvidia-imageç»“åˆä½¿ç”¨ï¼Œæˆ‘ä»¬éœ€è¦åœ¨NGC Cloudä¸­æ³¨å†Œå¹¶ç™»å½•ã€‚ æˆ‘ä»¬è¿›å…¥<a href="https://ngc.nvidia.com/">ngc.nvidia.com</a> ï¼Œè¿›è¡Œæ³¨å†Œï¼Œç„¶åè¿›å…¥NGCäº‘ï¼Œè¯·æŒ‰å±å¹•å·¦ä¸Šè§’çš„SETUPæˆ–<a href="https://ngc.nvidia.com/setup/api-key">å•å‡»</a>æ­¤é“¾æ¥<a href="https://ngc.nvidia.com/setup/api-key">ngc.nvidia.com/setup/api-key</a> ã€‚ ç‚¹å‡»â€œç”Ÿæˆå¯†é’¥â€ã€‚ æˆ‘å»ºè®®ä¿å­˜å®ƒï¼Œå¦åˆ™ä¸‹æ¬¡è®¿é—®å®ƒæ—¶ï¼Œæ‚¨å°†ä¸å¾—ä¸é‡æ–°ç”Ÿæˆå®ƒï¼Œå¹¶å› æ­¤å°†å…¶éƒ¨ç½²åœ¨æ–°çš„ç‹¬è½®è½¦ä¸Šï¼Œé‡å¤æ­¤æ“ä½œã€‚ <br><br> è¿è¡Œï¼š <br><br><pre> <code class="bash hljs">docker login nvcr.io Username: <span class="hljs-variable"><span class="hljs-variable">$oauthtoken</span></span> Password: &lt;Your Key&gt; -  </code> </pre><br> ç”¨æˆ·ååªéœ€å¤åˆ¶ã€‚ å¥½å§ï¼Œè€ƒè™‘ä¸€ä¸‹ï¼Œç¯å¢ƒå·²ç»éƒ¨ç½²å¥½äº†ï¼ <br><cut></cut><br>  <b>é˜¶æ®µ2.ç»„è£…Dockerå®¹å™¨</b> <br><br> åœ¨å·¥ä½œçš„ç¬¬äºŒé˜¶æ®µï¼Œæˆ‘ä»¬å°†ç»„è£…dockerå¹¶ç†Ÿæ‚‰å…¶å†…éƒ¨ã€‚ <br> æˆ‘ä»¬è½¬åˆ°ç›¸å¯¹äºretina-examplesé¡¹ç›®çš„æ ¹æ–‡ä»¶å¤¹å¹¶è¿è¡Œ <br><br><pre> <code class="bash hljs">docker build --build-arg USER=<span class="hljs-variable"><span class="hljs-variable">$USER</span></span> --build-arg UID=<span class="hljs-variable"><span class="hljs-variable">$UID</span></span> --build-arg GID=<span class="hljs-variable"><span class="hljs-variable">$GID</span></span> --build-arg PW=alex -t retinanet:latest retinanet/</code> </pre><br> æˆ‘ä»¬é€šè¿‡å°†å½“å‰ç”¨æˆ·æ‰”è¿›æ¥æ¥æ”¶é›†docker-å¦‚æœæ‚¨åœ¨å…·æœ‰å½“å‰ç”¨æˆ·æƒé™çš„å·²æŒ‚è½½VOLUMEä¸Šç¼–å†™æŸäº›å†…å®¹ï¼Œè¿™å°†éå¸¸æœ‰ç”¨ï¼Œå¦åˆ™ä¼šäº§ç”Ÿéº»çƒ¦ã€‚ <br><br> åœ¨Dockerè¿è¡Œæ—¶ï¼Œè®©æˆ‘ä»¬æ¢ç´¢Dockerfileï¼š <br><br><pre> <code class="powershell hljs">FROM nvcr.io/nvidia/pytorch:<span class="hljs-number"><span class="hljs-number">19.10</span></span><span class="hljs-literal"><span class="hljs-literal">-py3</span></span> ARG USER=alex ARG UID=<span class="hljs-number"><span class="hljs-number">1000</span></span> ARG GID=<span class="hljs-number"><span class="hljs-number">1000</span></span> ARG PW=alex RUN useradd <span class="hljs-literal"><span class="hljs-literal">-m</span></span> <span class="hljs-variable"><span class="hljs-variable">$</span></span>{USER} -<span class="hljs-literal"><span class="hljs-literal">-uid</span></span>=<span class="hljs-variable"><span class="hljs-variable">$</span></span>{UID} &amp;&amp; echo <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">{USER}:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$</span></span></span><span class="hljs-string">{PW}"</span></span> | chpasswd RUN apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> update &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> upgrade &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> install curl &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> install wget &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> install git &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> install automake &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> install <span class="hljs-literal"><span class="hljs-literal">-y</span></span> sudo &amp;&amp; adduser <span class="hljs-variable"><span class="hljs-variable">$</span></span>{USER} sudo RUN pip install git+https://github.com/bonlime/pytorch<span class="hljs-literal"><span class="hljs-literal">-tools</span></span>.git@master COPY . retinanet/ RUN pip install -<span class="hljs-literal"><span class="hljs-literal">-no</span></span><span class="hljs-literal"><span class="hljs-literal">-cache</span></span><span class="hljs-literal"><span class="hljs-literal">-dir</span></span> <span class="hljs-literal"><span class="hljs-literal">-e</span></span> retinanet/ RUN pip install /workspace/retinanet/extras/tensorrt<span class="hljs-literal"><span class="hljs-literal">-6</span></span>.<span class="hljs-number"><span class="hljs-number">0.1</span></span>.<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-literal"><span class="hljs-literal">-cp36</span></span><span class="hljs-literal"><span class="hljs-literal">-none</span></span><span class="hljs-literal"><span class="hljs-literal">-linux_x86_64</span></span>.whl RUN pip install tensorboardx RUN pip install albumentations RUN pip install setproctitle RUN pip install paramiko RUN pip install flask RUN pip install mem_top RUN pip install arrow RUN pip install pycuda RUN pip install torchvision RUN pip install pretrainedmodels RUN pip install efficientnet<span class="hljs-literal"><span class="hljs-literal">-pytorch</span></span> RUN pip install git+https://github.com/qubvel/segmentation_models.pytorch RUN pip install pytorch_toolbelt RUN chown <span class="hljs-literal"><span class="hljs-literal">-R</span></span> <span class="hljs-variable"><span class="hljs-variable">$</span></span>{USER}:<span class="hljs-variable"><span class="hljs-variable">$</span></span>{USER} retinanet/ RUN cd /workspace/retinanet/extras/cppapi &amp;&amp; mkdir build &amp;&amp; cd build &amp;&amp; cmake <span class="hljs-literal"><span class="hljs-literal">-DCMAKE_CUDA_FLAGS</span></span>=<span class="hljs-string"><span class="hljs-string">"--expt-extended-lambda -std=c++14"</span></span> .. &amp;&amp; make &amp;&amp; cd /workspace RUN apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> install <span class="hljs-literal"><span class="hljs-literal">-y</span></span> openssh<span class="hljs-literal"><span class="hljs-literal">-server</span></span> &amp;&amp; apt install <span class="hljs-literal"><span class="hljs-literal">-y</span></span> tmux &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> install bison flex &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-cache</span></span> search pcre &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> install net<span class="hljs-literal"><span class="hljs-literal">-tools</span></span> &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> install nmap RUN apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> install libpcre3 libpcre3<span class="hljs-literal"><span class="hljs-literal">-dev</span></span> &amp;&amp; apt<span class="hljs-literal"><span class="hljs-literal">-get</span></span> <span class="hljs-literal"><span class="hljs-literal">-y</span></span> install iputils<span class="hljs-literal"><span class="hljs-literal">-ping</span></span> RUN mkdir /var/run/sshd RUN echo <span class="hljs-string"><span class="hljs-string">'root:pass'</span></span> | chpasswd RUN sed <span class="hljs-literal"><span class="hljs-literal">-i</span></span> <span class="hljs-string"><span class="hljs-string">'s/PermitRootLogin prohibit-password/PermitRootLogin yes/'</span></span> /etc/ssh/sshd_config RUN sed <span class="hljs-string"><span class="hljs-string">'s@session\s*required\s*pam_loginuid.so@session optional pam_loginuid.so@g'</span></span> <span class="hljs-literal"><span class="hljs-literal">-i</span></span> /etc/pam.d/sshd ENV NOTVISIBLE <span class="hljs-string"><span class="hljs-string">"in users profile"</span></span> RUN echo <span class="hljs-string"><span class="hljs-string">"export VISIBLE=now"</span></span> &gt;&gt; /etc/profile CMD [<span class="hljs-string"><span class="hljs-string">"/usr/sbin/sshd"</span></span>, <span class="hljs-string"><span class="hljs-string">"-D"</span></span>]</code> </pre><br> ä»æ–‡æœ¬ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨æ‰€æœ‰æˆ‘ä»¬å–œæ¬¢çš„å·¥å…·ï¼Œç¼–è¯‘retinanetï¼Œåˆ†å‘åŸºæœ¬å·¥å…·ä»¥æ–¹ä¾¿ä½¿ç”¨Ubuntuï¼Œå¹¶é…ç½®opensshæœåŠ¡å™¨ã€‚ ç¬¬ä¸€è¡Œåªæ˜¯nvidiaæ˜ åƒçš„ç»§æ‰¿ï¼Œæˆ‘ä»¬åœ¨NGC Cloudä¸­è¿›è¡Œäº†ç™»å½•ï¼Œå…¶ä¸­åŒ…å«Pytorch1.3ï¼ŒTensorRT6.xxxå’Œä¸€å †åº“ï¼Œè¿™äº›åº“ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸ºæ£€æµ‹å™¨ç¼–è¯‘cppæºä»£ç ã€‚ <br><cut></cut><br>  <b>é˜¶æ®µ3.å¯åŠ¨å’Œè°ƒè¯•Dockerå®¹å™¨</b> <br><br> è®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨å®¹å™¨å’Œå¼€å‘ç¯å¢ƒçš„ä¸»è¦æƒ…å†µï¼Œä»¥å¯åŠ¨ï¼Œè¿è¡Œnvidia dockerã€‚ è¿è¡Œï¼š <br><br><pre> <code class="bash hljs">docker run --gpus all --net=host -v /home/&lt;your_user_name&gt;:/workspace/mounted_vol -d -P --rm --ipc=host -it retinanet:latest</code> </pre> <br> ç°åœ¨ï¼Œè¯¥å®¹å™¨ä½äºssh &lt;curr_user_name&gt; @localhostã€‚ æˆåŠŸå¯åŠ¨åï¼Œåœ¨PyCharmä¸­æ‰“å¼€é¡¹ç›®ã€‚ æ¥ä¸‹æ¥æ‰“å¼€ <br><br><pre> <code class="bash hljs">Settings-&gt;Project Interpreter-&gt;Add-&gt;Ssh Interpreter</code> </pre> <br>  <i>ç¬¬ä¸€æ­¥</i> <br><img src="https://habrastorage.org/webt/g0/qc/e4/g0qce4xw2pe0arglt4b4iu4jfle.png" alt="å›¾ç‰‡"><br><br>  <i>ç¬¬äºŒæ­¥</i> <br><img src="https://habrastorage.org/webt/nf/m_/cu/nfm_cuj84kymlgofajbo-go8dwy.png" alt="å›¾ç‰‡"><br><br>  <i>ç¬¬ä¸‰æ­¥</i> <br><img src="https://habrastorage.org/webt/w6/nn/eg/w6nnegihsdou1fhoy75p7g9evhi.png" alt="å›¾ç‰‡"><br><br> æˆ‘ä»¬é€‰æ‹©æ‰€æœ‰å†…å®¹ï¼Œå¦‚å±å¹•æˆªå›¾æ‰€ç¤ºï¼Œ <br><br><pre> <code class="bash hljs">Interpreter -&gt; /opt/conda/bin/python</code> </pre> <br>  -è¿™å°†åœ¨python3.6å’Œ <br><br><pre> <code class="bash hljs">Sync folder -&gt; /workspace/retinanet</code> </pre> <br> æˆ‘ä»¬æŒ‰å®Œç»ˆç‚¹çº¿ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å…¶ç¼–å…¥ç´¢å¼•ï¼Œå°±è¿™æ ·ï¼Œç¯å¢ƒå°±å¯ä»¥ä½¿ç”¨äº†ï¼ <br><br>  <i><b>é‡è¦ï¼</b></i> ç´¢å¼•åï¼Œç«‹å³ä»Dockeræå–Retinanetçš„å·²ç¼–è¯‘æ–‡ä»¶ã€‚ åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ä¸Šä¸‹æ–‡èœå•ä¸­ï¼Œé€‰æ‹© <br><br><pre> <code class="bash hljs">Deployment-&gt;Download</code> </pre> <br> å°†æ˜¾ç¤ºä¸€ä¸ªæ–‡ä»¶å’Œä¸¤ä¸ªæ„å»ºæ–‡ä»¶å¤¹retinanet.egg-infoå’Œ_so <br><br><img src="https://habrastorage.org/webt/ti/uo/pp/tiuoppum1j_wx2yfxlkl8i-gdle.png" alt="å›¾ç‰‡"><br><br> å¦‚æœæ‚¨çš„é¡¹ç›®çœ‹èµ·æ¥åƒè¿™æ ·ï¼Œé‚£ä¹ˆç¯å¢ƒå°†çœ‹åˆ°æ‰€æœ‰å¿…éœ€çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬å·²ç»å‡†å¤‡å¥½å­¦ä¹ RetinaNetã€‚ <br><br>  <b>é˜¶æ®µ4.æ ‡è®°æ•°æ®å¹¶è®­ç»ƒæ£€æµ‹å™¨</b> <br><br> å¯¹äºæ ‡è®°ï¼Œæˆ‘ä¸»è¦ä½¿ç”¨<a href="https://supervise.ly/">supervise.ly-</a>ä¸€ä¸ªå¾ˆå¥½ç”¨ä¸”æ–¹ä¾¿çš„å·¥å…·ï¼Œåœ¨æœ€åä¸€æ¬¡ä¿®å¤ä¸€å †é—¨æ¡†åï¼Œå®ƒçš„è¡Œä¸ºå˜å¾—æ›´å¥½äº†ã€‚ <br><br> å‡è®¾æ‚¨æ ‡è®°äº†ä¸€ä¸ªæ•°æ®é›†å¹¶ä¸‹è½½äº†å®ƒï¼Œä½†æ˜¯ç”±äºå®ƒæ˜¯è‡ªå·±çš„æ ¼å¼ï¼Œå› æ­¤æ— æ³•ç«‹å³å°†å…¶æ”¾å…¥æˆ‘ä»¬çš„RetinaNetä¸­ï¼Œä¸ºæ­¤æˆ‘ä»¬éœ€è¦å°†å…¶è½¬æ¢ä¸ºCOCOã€‚ è½¬æ¢å·¥å…·ä½äºï¼š <br><br><pre> <code class="bash hljs">markup_utils/supervisly_to_coco.py</code> </pre> <br> è¯·æ³¨æ„ï¼Œè„šæœ¬ä¸­çš„ç±»åˆ«æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæ‚¨éœ€è¦æ’å…¥è‡ªå·±çš„ç±»åˆ«ï¼ˆæ— éœ€æ·»åŠ ç±»åˆ«ç±»åˆ«ï¼‰ <br><br><pre> <code class="json hljs">categories = [{'id': <span class="hljs-number"><span class="hljs-number">1</span></span>, 'name': '<span class="hljs-number"><span class="hljs-number">1</span></span>'}, {'id': <span class="hljs-number"><span class="hljs-number">2</span></span>, 'name': '<span class="hljs-number"><span class="hljs-number">2</span></span>'}, {'id': <span class="hljs-number"><span class="hljs-number">3</span></span>, 'name': '<span class="hljs-number"><span class="hljs-number">3</span></span>'}, {'id': <span class="hljs-number"><span class="hljs-number">4</span></span>, 'name': '<span class="hljs-number"><span class="hljs-number">4</span></span>'}]</code> </pre> <br> å‡ºäºæŸç§åŸå› ï¼ŒåŸå§‹å­˜å‚¨åº“çš„ä½œè€…å†³å®šé™¤äº†åŸ¹è®­COCO / VOCä¹‹å¤–ï¼Œæ‚¨å°†ä¸è®­ç»ƒå…¶ä»–ä»»ä½•ä¸œè¥¿ï¼Œå› æ­¤æˆ‘ä¸å¾—ä¸ç¨ç¨ä¿®æ”¹æºæ–‡ä»¶ <br><br><pre> <code class="bash hljs">retinanet/dataset.py</code> </pre> <br> é€šè¿‡æ·»åŠ tutdaï¼Œæ‚¨æœ€å–œæ¬¢çš„å¢å¼ºç¨‹åºalbumentations.readthedocs.io/en/latestå¹¶ä»COCOä¸­åˆ é™¤ç¡¬è¿çº¿çš„ç±»åˆ«ã€‚ å¦‚æœè¦åœ¨å¤§å›¾ç‰‡ä¸­æŸ¥æ‰¾å°ç‰©ä½“ï¼Œå¹¶ä¸”æ•°æ®é›†å¾ˆå°ï¼Œ=ï¼‰ï¼Œåˆ™å¯èƒ½ä¼šæ•£å¸ƒè¾ƒå¤§çš„æ£€æµ‹åŒºåŸŸï¼Œä½†æ²¡æœ‰ä»»ä½•æ•ˆæœï¼Œä½†æ˜¯åœ¨å¦ä¸€æ—¶é—´æ›´æœ‰ç”¨ã€‚ <br><br> é€šå¸¸ï¼Œç«è½¦å¾ªç¯ä¹Ÿå¾ˆå¼±ï¼Œæœ€åˆå®ƒæ²¡æœ‰ä¿å­˜æ£€æŸ¥ç‚¹ï¼Œå®ƒä½¿ç”¨äº†ä¸€äº›ç³Ÿç³•çš„è°ƒåº¦ç¨‹åºï¼Œç­‰ç­‰ã€‚ ä½†æ˜¯ç°åœ¨æ‚¨è¦åšçš„å°±æ˜¯é€‰æ‹©ä¸»å¹²å¹¶æ‰§è¡Œ <br><br><pre> <code class="bash hljs">/opt/conda/bin/python retinanet/main.py</code> </pre> <br> å¸¦æœ‰å‚æ•°ï¼š <br><br><pre> <code class="bash hljs">train retinanet_rn34fpn.pth --backbone ResNet34FPN --classes 12 --val-iters 10 --images /workspace/mounted_vol/dataset/train/images --annotations /workspace/mounted_vol/dataset/train_12_class.json --val-images /workspace/mounted_vol/dataset/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>/images_small --val-annotations /workspace/mounted_vol/dataset/val_10_class_cropped.json --jitter 256 512 --max-size 512 --batch 32</code> </pre><br> åœ¨æ§åˆ¶å°ä¸­ï¼Œæ‚¨å°†çœ‹åˆ°ï¼š <br><br><pre> <code class="plaintext hljs">Initializing model... model: RetinaNet backbone: ResNet18FPN classes: 2, anchors: 9 Selected optimization level O0: Pure FP32 training. Defaults for this optimization level are: enabled : True opt_level : O0 cast_model_type : torch.float32 patch_torch_functions : False keep_batchnorm_fp32 : None master_weights : False loss_scale : 1.0 Processing user overrides (additional kwargs that are not None)... After processing overrides, optimization options are: enabled : True opt_level : O0 cast_model_type : torch.float32 patch_torch_functions : False keep_batchnorm_fp32 : None master_weights : False loss_scale : 128.0 Preparing dataset... loader: pytorch resize: [1024, 1280], max: 1280 device: 4 gpus batch: 4, precision: mixed Training model for 20000 iterations... [ 1/20000] focal loss: 0.95619, box loss: 0.51584, 4.042s/4-batch (fw: 0.698s, bw: 0.459s), 1.0 im/s, lr: 0.0001 [ 12/20000] focal loss: 0.76191, box loss: 0.31794, 0.187s/4-batch (fw: 0.055s, bw: 0.133s), 21.4 im/s, lr: 0.0001 [ 24/20000] focal loss: 0.65036, box loss: 0.30269, 0.173s/4-batch (fw: 0.045s, bw: 0.128s), 23.1 im/s, lr: 0.0001 [ 36/20000] focal loss: 0.46425, box loss: 0.23141, 0.178s/4-batch (fw: 0.047s, bw: 0.131s), 22.4 im/s, lr: 0.0001 [ 48/20000] focal loss: 0.45115, box loss: 0.23505, 0.180s/4-batch (fw: 0.047s, bw: 0.133s), 22.2 im/s, lr: 0.0001 [ 59/20000] focal loss: 0.38958, box loss: 0.25373, 0.184s/4-batch (fw: 0.049s, bw: 0.134s), 21.8 im/s, lr: 0.0001 [ 71/20000] focal loss: 0.37733, box loss: 0.23988, 0.174s/4-batch (fw: 0.049s, bw: 0.125s), 22.9 im/s, lr: 0.0001 [ 83/20000] focal loss: 0.39514, box loss: 0.23878, 0.181s/4-batch (fw: 0.048s, bw: 0.133s), 22.1 im/s, lr: 0.0001 [ 94/20000] focal loss: 0.39947, box loss: 0.23817, 0.185s/4-batch (fw: 0.050s, bw: 0.134s), 21.6 im/s, lr: 0.0001 [ 105/20000] focal loss: 0.37343, box loss: 0.20238, 0.182s/4-batch (fw: 0.048s, bw: 0.134s), 22.0 im/s, lr: 0.0001 [ 116/20000] focal loss: 0.19689, box loss: 0.17371, 0.183s/4-batch (fw: 0.050s, bw: 0.132s), 21.8 im/s, lr: 0.0001 [ 128/20000] focal loss: 0.20368, box loss: 0.16538, 0.178s/4-batch (fw: 0.046s, bw: 0.131s), 22.5 im/s, lr: 0.0001 [ 140/20000] focal loss: 0.22763, box loss: 0.15772, 0.176s/4-batch (fw: 0.050s, bw: 0.126s), 22.7 im/s, lr: 0.0001 [ 148/20000] focal loss: 0.21997, box loss: 0.18400, 0.585s/4-batch (fw: 0.047s, bw: 0.144s), 6.8 im/s, lr: 0.0001 Average Precision (AP) @[ IoU=0.50:0.95 | area= all | maxDets=100 ] = 0.52674 Average Precision (AP) @[ IoU=0.50 | area= all | maxDets=100 ] = 0.91450 Average Precision (AP) @[ IoU=0.75 | area= all | maxDets=100 ] = 0.35172 Average Precision (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.61881 Average Precision (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = -1.00000 Average Precision (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = -1.00000 Average Recall (AR) @[ IoU=0.50:0.95 | area= all | maxDets= 1 ] = 0.58824 Average Recall (AR) @[ IoU=0.50:0.95 | area= all | maxDets= 10 ] = 0.61765 Average Recall (AR) @[ IoU=0.50:0.95 | area= all | maxDets=100 ] = 0.61765 Average Recall (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.61765 Average Recall (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = -1.00000 Average Recall (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = -1.00000 Saving model: 148</code> </pre> <br> è¦ç ”ç©¶æ•´ä¸ªå‚æ•°é›†ï¼Œè¯·çœ‹ <br><br><pre> <code class="bash hljs">retinanet/main.py</code> </pre> <br> é€šå¸¸ï¼Œå®ƒä»¬æ˜¯æ£€æµ‹çš„æ ‡å‡†ï¼Œå¹¶æœ‰æè¿°ã€‚ è¿è¡ŒåŸ¹è®­ï¼Œç„¶åç­‰å¾…ç»“æœã€‚ å¯ä»¥åœ¨ä»¥ä¸‹ç¤ºä¾‹ä¸­æ‰¾åˆ°æ¨è®ºçš„ç¤ºä¾‹ï¼š <br><br><pre> <code class="bash hljs">retinanet/infer_example.py</code> </pre> <br> æˆ–æ‰§è¡Œå‘½ä»¤ï¼š <br><br><pre> <code class="bash hljs">/opt/conda/bin/python retinanet/main.py infer retinanet_rn34fpn.pth --images /workspace/mounted_vol/dataset/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>/images --annotations /workspace/mounted_vol/dataset/val.json --output result.json --resize 256 --max-size 512 --batch 32</code> </pre><br> ç„¦ç‚¹æŸå¤±å’Œå‡ ä¸ªéª¨å¹²å·²ç»å†…ç½®åˆ°å­˜å‚¨åº“ä¸­ï¼Œå¹¶ä¸”å®ƒä»¬ <br><br><pre> <code class="bash hljs">retinanet/backbones/*.py</code> </pre> <br> ä½œè€…åœ¨é“­ç‰Œä¸Šç»™å‡ºäº†ä¸€äº›ç‰¹å¾ï¼š <br><br><img src="https://habrastorage.org/webt/z2/rj/3c/z2rj3cuo4rvxgnqfdx-rntclfm0.png" alt="å›¾ç‰‡"><br><br> è¿˜æœ‰ä¸€ä¸ªä¸»å¹²ResNeXt50_32x4dFPNå’ŒResNeXt101_32x8dFPNï¼Œå–è‡ªTorchvisionã€‚ <br> å¸Œæœ›æˆ‘ä»¬å¯¹æ£€æµ‹æœ‰æ‰€<i><b>äº†è§£</b></i> ï¼Œä½†æ˜¯æ‚¨ç»å¯¹åº”è¯¥é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼Œä»¥<i><b>äº†è§£å¯¼å‡ºå’Œæ—¥å¿—è®°å½•æ¨¡å¼</b></i> ã€‚ <br><br>  <b>é˜¶æ®µ5.ä½¿ç”¨Resnetç¼–ç å™¨å¯¼å‡ºå’Œæ¨æ–­Unetæ¨¡å‹</b> <br><br> æ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œç”¨äºåˆ†æ®µçš„åº“å·²å®‰è£…åœ¨Dockerfileä¸­ï¼Œå°¤å…¶æ˜¯ç²¾ç¾çš„åº“<a href="https://github.com/qubvel/segmentation_models.pytorch">github.com/qubvel/segmentation_models.pytorch</a> ã€‚ åœ¨Yunetè½¯ä»¶åŒ…ä¸­ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°åœ¨TensorRTå¼•æ“ä¸­æ¨æ–­å’Œå¯¼å‡ºpytorchæ£€æŸ¥ç‚¹çš„ç¤ºä¾‹ã€‚ <br><br> ä»ONNXå¯¼å‡ºç±»ä¼¼Unetçš„æ¨¡å‹åˆ°TensoRTæ—¶çš„ä¸»è¦é—®é¢˜æ˜¯éœ€è¦è®¾ç½®å›ºå®šçš„Upsampleå¤§å°æˆ–ä½¿ç”¨ConvTranspose2Dï¼š <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> torch.onnx.symbolic_opset9 <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> onnx_symbolic <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">upsample_nearest2d</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(g, input, output_size)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Currently, TRT 5.1/6.0 ONNX Parser does not support all ONNX ops # needed to support dynamic upsampling ONNX forumlation # Here we hardcode scale=2 as a temporary workaround scales = g.op("Constant", value_t=torch.tensor([1., 1., 2., 2.])) return g.op("Upsample", input, scales, mode_s="nearest") onnx_symbolic.upsample_nearest2d = upsample_nearest2d</span></span></code> </pre><br> ä½¿ç”¨æ­¤è½¬æ¢ï¼Œæ‚¨å¯ä»¥åœ¨å¯¼å‡ºåˆ°ONNXæ—¶è‡ªåŠ¨æ‰§è¡Œæ­¤æ“ä½œï¼Œä½†æ˜¯å·²ç»åœ¨TensorRTçš„ç‰ˆæœ¬7ä¸­è§£å†³äº†æ­¤é—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦ç­‰å¾…å¾ˆå°‘çš„æ—¶é—´ã€‚ <br><br>  <b>ç»“è®º</b> <br><br> å½“æˆ‘å¼€å§‹ä½¿ç”¨Dockeræ—¶ï¼Œæˆ‘å¯¹å…¶æ‰§è¡Œä»»åŠ¡çš„æ€§èƒ½æ„Ÿåˆ°æ€€ç–‘ã€‚ åœ¨æˆ‘çš„ä¸€ä¸ªå•å…ƒä¸­ï¼Œç°åœ¨æœ‰å¤šä¸ªæ‘„åƒæœºåˆ›å»ºäº†å¾ˆå¤šç½‘ç»œæµé‡ã€‚ <br><br><img src="https://habrastorage.org/webt/3p/b9/1q/3pb91qmq_vcanxwqlskw3aervtu.png" alt="å›¾ç‰‡"><br><br> äº’è”ç½‘ä¸Šçš„å„ç§æµ‹è¯•è¡¨æ˜ï¼Œç½‘ç»œäº¤äº’å’Œåœ¨VOLUMEä¸Šå½•åˆ¶çš„å¼€é”€ç›¸å¯¹è¾ƒå¤§ï¼ŒåŠ ä¸ŠæœªçŸ¥ä¸”å¯æ€•çš„GILï¼Œå¹¶ä¸”ç”±äºæ‹æ‘„å¸§ï¼Œåœ¨ç½‘ç»œä¸Šé©±åŠ¨ç¨‹åºå¹¶é€šè¿‡ç½‘ç»œä¼ è¾“å¸§æ˜¯<i>ç¡¬å®æ—¶</i>æ¨¡å¼ä¸‹çš„åŸå­æ“ä½œï¼Œå› æ­¤ä¼šäº§ç”Ÿå»¶è¿Ÿåœ¨çº¿å¯¹æˆ‘æ¥è¯´è‡³å…³é‡è¦ã€‚ <br><br> ä½†æ˜¯ä»€ä¹ˆéƒ½æ²¡å‘ç”Ÿ=ï¼‰ <br><br>  PSä»ç„¶éœ€è¦æ·»åŠ æ‚¨æœ€å–œæ¬¢çš„ç«è½¦ç¯ä»¥è¿›è¡Œåˆ†æ®µå’Œåˆ¶ä½œï¼ <br><br>  <b>è°¢è°¢å•¦</b> <br><br> æ„Ÿè°¢<a href="http://ods.ai/">ods.ai</a>ç¤¾åŒºï¼Œæ²¡æœ‰å®ƒå°±ä¸å¯èƒ½å‘å±•ï¼ éå¸¸æ„Ÿè°¢DLï¼Œå¸Œæœ›æˆ‘èƒ½æ¥å—DL <a href="https://habr.com/ru/users/n01z3/" class="user_link">n01z3</a>çš„å®è´µå»ºè®®å’Œéå‡¡çš„æ•¬ä¸šç²¾ç¥ï¼ <br><br>  <i>åœ¨ç”Ÿäº§ä¸­ä½¿ç”¨ä¼˜åŒ–çš„æ¨¡å‹ï¼</i> <br><br><img src="https://habrastorage.org/webt/xv/x3/yv/xvx3yvszd_twqjbrtk3rjaxrxpk.png">  Auroraiï¼Œllc </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN483074/">https://habr.com/ru/post/zh-CN483074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN483056/index.html">æ•°æ®åº“ä¸­çš„é€»è¾‘å­—æ®µï¼Œæ˜¯å¦æœ‰è§£è¯ï¼Ÿ</a></li>
<li><a href="../zh-CN483058/index.html">å‡æœŸè°ƒæŸ¥ç»“æœ</a></li>
<li><a href="../zh-CN483064/index.html">Vueæ˜¯æ‰€æœ‰æ³•è§„ä¸Šæœ€å°çš„akaå°åšå®¢</a></li>
<li><a href="../zh-CN483066/index.html">æ¯”å°”Â·ç›–èŒ¨çš„ä¼ ç»Ÿäº”æœ¬ä¹¦</a></li>
<li><a href="../zh-CN483068/index.html">æµè¡Œçš„åä½œå¼ŠBattlEyeçš„é€†å‘å·¥ç¨‹</a></li>
<li><a href="../zh-CN483076/index.html">2020å¹´ç”¨äºAndroid Appå¼€å‘çš„é¡¶çº§ç¼–ç¨‹è¯­è¨€</a></li>
<li><a href="../zh-CN483078/index.html">æ·±åº¦å¼ºåŒ–å­¦ä¹ ï¼šå¦‚ä½•æ•™èœ˜è››èµ°è·¯</a></li>
<li><a href="../zh-CN483082/index.html">æ¼æ´æœå¯»æ•ˆç‡æé«˜7ï¼…</a></li>
<li><a href="../zh-CN483084/index.html">å…·æœ‰è·Ÿè¸ªåŠŸèƒ½çš„ç›¸æœº</a></li>
<li><a href="../zh-CN483086/index.html">2019å¹´ä¸šç»©ï¼šå“ªäº›èµ„äº§è¢«è¯æ˜æ˜¯ä¿„ç½—æ–¯æŠ•èµ„è€…æœ€èµšé’±çš„</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>