<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåú üõÅ üçû Classifica√ß√£o da biblioteca üê∑ ü§≥üèª üôåüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pegue uma matriz de ordem inversa e aplique a classifica√ß√£o a ela com inser√ß√µes simples . 



 Veja com que rangido o pr√≥ximo elemento √© inserido no l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Classifica√ß√£o da biblioteca</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416653/"><div style="text-align:center;"><img width="700" height="394" src="https://habrastorage.org/webt/8i/bj/do/8ibjdoxetlxsby3qiaj5seokxxa.jpeg"></div><br><br><a name="habracut"></a><br>  Pegue uma matriz de ordem inversa e aplique a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classifica√ß√£o</a> a ela <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">com inser√ß√µes simples</a> . <br><br><img width="684" height="95" src="https://habrastorage.org/webt/il/qa/vz/ilqavzmmhgxwuhcityv7wuqqqig.gif"><br><br>  Veja com que rangido o pr√≥ximo elemento √© inserido no lugar certo.  Para isso, √© necess√°rio liberar o local de inser√ß√£o, pelo qual √© necess√°rio mudar todos os elementos inseridos anteriormente. <br><br>  E como seria bom se houvesse espa√ßos vazios entre os elementos que foram inseridos anteriormente!  Ent√£o n√£o seria necess√°rio arrastar as linhas de elementos apenas para inserir um. <br><br>  Em 2004, tr√™s especialistas em ci√™ncia da computa√ß√£o - Michael Bender, Martin Farah-Colton e Miguel Mostiro - decidiram modificar a classifica√ß√£o com inser√ß√µes simples dessa maneira.  Eles sugeriram formar uma parte ordenada da matriz, deixando espa√ßos entre os elementos inseridos. <br><blockquote>  O bibliotec√°rio precisa que os livros sejam organizados em ordem alfab√©tica em uma estante comprida: come√ßando √† esquerda da letra "A", os livros ficam um ao lado do outro no pr√≥prio "eu".  Se a biblioteca recebeu um novo livro relacionado √† se√ß√£o "B", para coloc√°-lo na prateleira no lugar certo, voc√™ deve mover cada livro, come√ßando em algum lugar do meio da se√ß√£o "B" at√© o √∫ltimo "I".  Esta √© a classifica√ß√£o por inser√ß√µes simples.  No entanto, se o bibliotec√°rio reservasse o espa√ßo livre em cada se√ß√£o, bastava mover apenas alguns livros para abrir espa√ßo para novidades.  Este √© o princ√≠pio b√°sico da classifica√ß√£o de bibliotecas. </blockquote><h2>  Algoritmo </h2><br><img width="693" height="168" src="https://habrastorage.org/webt/jl/-l/wc/jl-lwclcowy6aohvc82uksordtg.gif"><br><br><ul><li>  <strong>1. Crie uma matriz auxiliar vazia, v√°rias vezes maior que a matriz principal.</strong> </li><li>  <strong>2. Para o pr√≥ximo elemento, procuramos o local de inser√ß√£o na matriz auxiliar.</strong> <ul><li>  <strong>2.1</strong>  <strong>Se voc√™ encontrar um local para inserir, transfira o item e retorne √† etapa 2.</strong> </li><li>  <strong>2.2</strong>  <strong>Se n√£o houver lugar para inser√ß√£o, reequilibre a matriz auxiliar e retorne ao ponto 2.</strong> </li></ul></li><li>  <strong>3. Ap√≥s processar todos os elementos, transfira-os de volta para a matriz principal.</strong> </li></ul><br>  √Ä primeira vista, parece que a classifica√ß√£o √© f√°cil e simples.  Para dissipar essa ilus√£o, consideramos os pontos principais do algoritmo em mais detalhes. <br><br><h2>  Tamanho da matriz auxiliar </h2><br>  Embora n√£o exista uma opini√£o estabelecida, quantas vezes a matriz auxiliar deve ser maior que a matriz principal. <br><br>  Se voc√™ demorar demais, haver√° muito espa√ßo entre os elementos; no entanto, a pesquisa pelo site de inser√ß√£o e o reequil√≠brio ser√£o mais lentos, devido √†s grandes dist√¢ncias entre os elementos.  O reequil√≠brio acontecer√° com menos frequ√™ncia, mas eles ter√£o que gastar mais recursos com eles.  Se voc√™ tomar muito pouco, a pesquisa e o reequil√≠brio ser√£o mais baratos, mas voc√™ precisar√° reformatar a matriz com mais frequ√™ncia.  Em geral, ainda precisa ser testado com valores diferentes e o m√©todo de cutucada cient√≠fica determina a melhor op√ß√£o. <br><br>  Se decidirmos quantas vezes a matriz auxiliar √© maior que a matriz principal, a f√≥rmula para determinar o n√∫mero exato de elementos para ela √© assim: <br><br>  <b>NewSize = Œµ √ó (tamanho + 1) - 1</b> <br><br>  <i>NewSize - o n√∫mero de elementos na matriz auxiliar</i> <i><br></i>  <i>Œµ - quantas vezes a matriz auxiliar √© maior que a principal</i> <i><br></i>  <i>Tamanho - o n√∫mero de elementos na matriz principal</i> <br><br>  Se simplesmente multiplicarmos o tamanho por um fator: <b>NewSize = Size √ó Œµ</b> , para uma distribui√ß√£o uniforme, n√£o teremos c√©lulas suficientes na quantidade de <b>Œµ - 1</b> pe√ßas.  Ou seja, √© poss√≠vel organiz√°-los uniformemente, mas a primeira c√©lula preenchida ou a √∫ltima estar√° localizada perto da borda da matriz auxiliar.  E precisamos que os lugares vazios nas c√©lulas preenchidas sejam reservados de todos os lados - inclusive antes do primeiro elemento e depois do √∫ltimo. <br><br><img width="692" height="312" src="https://habrastorage.org/webt/am/np/py/amnppyndj34-6az2hiyjakiakbk.png"><br><br>  Parece um pouco, mas, de fato, √© importante para o reequil√≠brio garantir locais livres para inser√ß√£o em qualquer lugar, inclusive ao processar os √∫ltimos elementos da matriz principal. <br><br><h2>  Procure o local de inser√ß√£o na matriz auxiliar </h2><br>  Claro, aqui voc√™ precisa de uma pesquisa bin√°ria.  No entanto, a implementa√ß√£o cl√°ssica n√£o funcionar√° para n√≥s. <br><br>  Em primeiro lugar, a matriz auxiliar consiste principalmente em vazio.  Portanto, dicotomizando recursivamente a estrutura, encontraremos na maioria das vezes c√©lulas n√£o preenchidas.  Nesses casos, voc√™ precisa ir um pouco para a esquerda ou direita, para a c√©lula n√£o vazia mais pr√≥xima.  No final do segmento, haver√° elementos significativos que permitem calcular a m√©dia aritm√©tica e continuar a pesquisa bin√°ria em profundidade. <br><br>  Em segundo lugar, n√£o se esque√ßa das bordas.  Se voc√™ precisar inserir um elemento m√≠nimo ou m√°ximo, uma pesquisa bin√°ria entre os inseridos anteriormente n√£o resultar√° em nada.  Portanto, vale a pena considerar casos de fronteira - primeiro verifique se √© necess√°rio colocar um elemento pr√≥ximo √† borda esquerda ou direita da matriz e, se n√£o, use a pesquisa bin√°ria. <br><br>  Em terceiro lugar, levando em considera√ß√£o as especificidades do aplicativo, vale a pena fazer altera√ß√µes adicionais para minimizar o n√∫mero de reequil√≠brios de matriz.  Se o elemento inserido for igual ao valor em uma das extremidades do segmento, talvez voc√™ n√£o deva inseri-lo no meio do segmento.  √â mais l√≥gico colocar ao lado de um elemento igual em valor a ele.  Isso preencher√° com mais efici√™ncia o espa√ßo vazio da matriz auxiliar. <br><br>  Quarto, quinto e assim por diante.  A qualidade da pesquisa para o local de inser√ß√£o afeta diretamente a velocidade da classifica√ß√£o, pois a sele√ß√£o de locais sem √™xito para inser√ß√£o leva a um reequil√≠brio desnecess√°rio.  Por exemplo, pode valer a pena dividir os segmentos n√£o exatamente no meio, mas mais perto da borda esquerda ou direita do segmento, dependendo de qual borda o elemento de inser√ß√£o est√° mais pr√≥ximo em valor? <br><br>  O pr√≥prio algoritmo de busca bin√°ria est√° repleto de armadilhas e, levando em considera√ß√£o as nuances adicionais acima mencionadas, ele finalmente se torna de modo algum uma tarefa n√£o trivial. <br><br><h2>  Reequil√≠brio de matriz </h2><br>  A pesquisa bin√°ria n√£o √© a coisa mais dif√≠cil de implementar nessa classifica√ß√£o.  Ainda h√° reequil√≠brio. <br><br>  Quando n√£o h√° lugar para inser√ß√£o (elementos semelhantes foram encontrados, mas n√£o houve c√©lulas livres entre eles), voc√™ precisa agitar a matriz auxiliar para que o local de inser√ß√£o seja liberado.  Essa agita√ß√£o da matriz est√° se reequilibrando. <br><br>  Al√©m disso, o reequil√≠brio √© <i>local</i> ou <i>completo</i> . <br><br><h3>  Rebalanceamento local </h3><br>  Mudamos quantos elementos forem necess√°rios para liberar o ponto de inser√ß√£o.  A implementa√ß√£o desse balanceamento √© muito simples, basta encontrar a c√©lula vazia mais pr√≥xima do ponto de inser√ß√£o e us√°-la para mover v√°rios elementos. <br><br>  Existem poss√≠veis nuances.  Por exemplo, que maneira de procurar o lugar vago mais pr√≥ximo?  Para evitar a situa√ß√£o em que uma mudan√ßa √© imposs√≠vel (ou seja, se de algum lado todas as c√©lulas estiverem ocupadas at√© a borda da matriz), voc√™ poder√° se concentrar na posi√ß√£o do ponto de inser√ß√£o em rela√ß√£o ao meio da matriz.  Se voc√™ precisar inserir no lado esquerdo da matriz, mude para a direita, se estiver do lado direito - para a esquerda.  Se <b>Œµ</b> ‚â• 2, essa abordagem elimina a situa√ß√£o em que uma mudan√ßa √© imposs√≠vel (porque na metade da matriz auxiliar h√° espa√ßo mais que suficiente para todos os elementos). <br><br>  Na interpreta√ß√£o do autor do algoritmo, o reequil√≠brio local est√° impl√≠cito. <br><br><h3>  Rebalanceamento completo </h3><br>  Uma alternativa interessante ao local √© o reequil√≠brio completo.  Ou seja, na matriz auxiliar, altere todos os elementos dispon√≠veis para que haja (quase) os mesmos espa√ßos entre eles. <br><br><img width="693" height="168" src="https://habrastorage.org/webt/xg/yi/nr/xgyinrhnartyvwhdgqvmucrmx7m.gif"><br><br>  Tentei as duas op√ß√µes e at√© agora estou observando que, com o reequil√≠brio local, o algoritmo funciona de 1,5 a 2 vezes mais r√°pido que o completo.  No entanto, um reequil√≠brio completo ainda pode ser √∫til.  Por exemplo, se voc√™ precisar fazer o reequil√≠brio local com muita frequ√™ncia, isso significa que, em algumas √°reas, muitos ‚Äúco√°gulos sangu√≠neos‚Äù se acumularam que inibem todo o processo.  Um reequil√≠brio completo realizado uma vez permite eliminar todo o congestionamento local de uma s√≥ vez. <br><br>  Vamos descobrir como reequilibrar completamente. <br><br>  Primeiro, voc√™ precisa calcular quantas c√©lulas m√°ximas podemos alocar para cada elemento na matriz auxiliar.  Deve-se lembrar que as c√©lulas vazias devem estar antes da primeira e depois da √∫ltima c√©lula preenchida.  A f√≥rmula √©: <br><br><img width="186" height="52" src="https://habrastorage.org/webt/9n/he/da/9nhedamesorkojp6daccahjow2q.png"><br><br>  <i>M - o n√∫mero de c√©lulas que podem ser alocadas para cada elemento</i> <i><br></i>  <i>NewSize - tamanho da matriz auxiliar</i> <i><br></i>  <i>Contagem - o n√∫mero atual de elementos n√£o vazios na matriz auxiliar</i> <br><br>  Essa fra√ß√£o deve ser reduzida para um valor inteiro (ou seja, arredondado para baixo).  √â √≥bvio pela f√≥rmula que quanto mais elementos j√° forem transferidos para a matriz auxiliar, menos c√©lulas podemos selecionar para a vizinhan√ßa de cada elemento. <br><br>  Conhecendo <b>M</b> , obtemos facilmente a posi√ß√£o exata para cada elemento n√£o vazio na matriz auxiliar na qual ele deve estar localizado ap√≥s a conclus√£o do reequil√≠brio. <br><br>  <b>NewPos = N√∫mero √ó M</b> <br><br>  <i>NewPos - nova posi√ß√£o do item ap√≥s o reequil√≠brio</i> <i><br></i>  <i>Number - qual √© o elemento n√£o vazio na matriz auxiliar <nobr>(1 ‚â§ Number ‚â§ Count)</nobr></i> <i><br></i>  <i>M - o n√∫mero de c√©lulas que s√£o alocadas para cada elemento</i> <br><br>  Novas posi√ß√µes s√£o conhecidas; voc√™ pode simplesmente separar elementos n√£o vazios na matriz auxiliar e transferi-los para outros lugares?  Oh n√£o, n√£o se apresse.  N√£o √© apenas necess√°rio transferir elementos, √© importante manter a ordem deles.  E, como resultado da pesquisa e inser√ß√£o bin√°rias, os elementos podem ficar muito √† esquerda e muito √† direita da posi√ß√£o em que deveriam estar ap√≥s o reequil√≠brio.  E no local em que voc√™ deseja mover, pode haver outro elemento que tamb√©m precisa ser anexado em algum lugar.  Al√©m disso, voc√™ n√£o pode transferir um elemento se houver outros elementos entre suas posi√ß√µes antiga e nova na matriz auxiliar - caso contr√°rio, os elementos ser√£o confundidos e √© extremamente importante para n√≥s n√£o confundir a ordem. <br><br>  Portanto, para reequilibrar, n√£o ser√° suficiente passar pelo ciclo usual e simplesmente mudar cada elemento de um bolso para outro.  Ainda √© necess√°rio usar recurs√£o.  Se um elemento n√£o puder ser movido para um novo local (outros elementos apareceram entre suas posi√ß√µes antiga e nova), primeiro voc√™ precisar√° descobrir (recursivamente) esses convidados n√£o convidados.  E ent√£o tudo ser√° organizado corretamente. <br><br><h2>  Caso degenerado </h2><br>  Para a maioria das ordena√ß√µes por inser√ß√µes, uma matriz de ordem inversa √© a pior situa√ß√£o.  E classificar um bibliotec√°rio, infelizmente, n√£o √© uma exce√ß√£o. <br><br><img width="693" height="168" src="https://habrastorage.org/webt/mm/zm/_c/mmzm_cvt2fvcawbrkkswtav0huo.gif"><br><br>  Os elementos tendem para a borda esquerda da matriz auxiliar, como resultado dos pontos vazios rapidamente se esgotam.  Voc√™ precisa reequilibrar a matriz com muita frequ√™ncia. <br><br>  A prop√≥sito, se pegarmos uma matriz quase ordenada (o melhor caso para classificar por inser√ß√µes simples), obteremos o mesmo problema.  Os elementos que chegam recentemente n√£o obstruem a esquerda, mas o lado direito da matriz auxiliar, o que tamb√©m levar√° a um reequil√≠brio muito frequente. <br><br>  A classifica√ß√£o da biblioteca lida com conjuntos de dados aleat√≥rios com efici√™ncia.  A encomenda parcial (direta e reversa) prejudica o desempenho da velocidade. <br><br><h2>  Complexidade Algor√≠tmica </h2><br>  Em grandes conjuntos de dados aleat√≥rios, o algoritmo fornece a complexidade de tempo O ( <b>n</b> log <b>n</b> ).  Nada mal! <br><br>  Em conjuntos de dados √∫nicos aleat√≥rios (ou principalmente √∫nicos) com a sele√ß√£o correta do coeficiente <strong>Œµ</strong> e a implementa√ß√£o bem-sucedida da pesquisa bin√°ria, o n√∫mero de reequil√≠brios pode ser minimizado ou mesmo evitado.  Pode-se argumentar que o algoritmo possui a melhor complexidade de tempo O ( <b>n</b> ). <br><br>  Uma grande porcentagem de dados repetidos em valor, bem como a presen√ßa na matriz de subsequ√™ncias ordenadas (em ordem direta ou reversa), leva a um reequil√≠brio frequente da matriz auxiliar e, como resultado, √† degrada√ß√£o da complexidade do tempo para O <b>(n <sup>2</sup></b> ) nos casos mais desfavor√°veis. <br><br>  O ponto negativo do algoritmo, √© claro, √© que a matriz auxiliar requer O ( <b>n</b> ) mem√≥ria adicional. <br><br><h2>  Poss√≠veis maneiras de melhorar </h2><br>  Embora o pr√≥prio algoritmo seja instrutivo e eficiente em dados aleat√≥rios, em uma d√©cada e meia, poucos demonstraram interesse nele. <br><br>  Se voc√™ pesquisar na solicita√ß√£o "classifica√ß√£o da biblioteca", encontrar√° um artigo superficial na Wikipedia em ingl√™s, o PDF do autor (do qual pouco se sabe) e uma rara reedi√ß√£o dessas informa√ß√µes escassas.  Al√©m disso, h√° uma boa visualiza√ß√£o no YouTube, onde as matrizes principal e auxiliar foram originalmente combinadas.  Todos os links est√£o no final do artigo. <br><br>  A busca por ‚Äúclassifica√ß√£o da biblioteca‚Äù √© ainda mais divertida - no exemplo, voc√™ encontrar√° as diferentes classifica√ß√µes inclu√≠das em diferentes bibliotecas, no entanto, esses algoritmos n√£o estar√£o relacionados √† <i>classifica√ß√£o aut√™ntica da biblioteca</i> . <br><br>  E h√° algo a melhorar: <br><br><ol><li>  Sele√ß√£o emp√≠rica do coeficiente √≥timo <strong>Œµ</strong> . </li><li>  Modifica√ß√£o (levando em considera√ß√£o as especificidades do algoritmo geral) da pesquisa bin√°ria para a determina√ß√£o mais eficiente do ponto de inser√ß√£o. </li><li>  Minimizando os custos de reequil√≠brio. </li></ol><br>  Se voc√™ polir esses lugares, talvez a classifica√ß√£o da biblioteca em velocidade seja igual √† classifica√ß√£o r√°pida? <br><br><h2>  C√≥digo fonte </h2><br>  N√£o consegui preparar a implementa√ß√£o em Python, existe uma vers√£o funcional em PHP. <br><br><div class="spoiler">  <b class="spoiler_title">Algoritmo b√°sico</b> <div class="spoiler_text"><pre><code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LibrarySort</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($arr)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> $arr_new;<span class="hljs-comment"><span class="hljs-comment">//  $e = 3;//     $rebalance_local = true;// (true)   (false)  //   $newSize = $e * (count($arr) + 1) - 1; $arr_new = array_fill(0, $newSize, null); //       $arr_new[LibrarySort_Pos(1, 1, $newSize)] = $arr[0]; //    -    //     $start = 0; $finish = $newSize - 1; $i = 1; //      while($i &lt; count($arr)) { //        $pos = LibrarySort_BinarySearch($arr[$i], $start, $finish, $newSize); if($pos === false) {//        //    LibrarySort_Rebalance_Total($i, $newSize); } else {//  ,   ,    if($arr_new[$pos] !== null) {//   if($rebalance_local) {//  (+ ) LibrarySort_Rebalance_Local($arr[$i++], $pos, $newSize); } else {//  LibrarySort_Rebalance_Total($i, $newSize); } } else {//   ,   $arr_new[$pos] = $arr[$i++]; } } } //      $pos = 0; for($i = 0; $i &lt;= $newSize - 1; $i++) { if($arr_new[$i] !== null) $arr[$pos++] = $arr_new[$i]; } return $arr; }</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">A nova posi√ß√£o do elemento na matriz adicional ap√≥s o reequil√≠brio completo</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// $number-    $count //     //$number -      ( )  //$count -       //$newSize -     //$number &lt;= $count &lt;= count($arr) &lt;= $newSize) function LibrarySort_Pos($number, $count, $newSize) { return $number * floor(($newSize + 1) / ($count + 1)) - 1; }</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Pesquisa bin√°ria do local de inser√ß√£o na matriz auxiliar</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//       //$search -     ,      //($start, $finish) -   ,     //$newSize -     function LibrarySort_BinarySearch($search, $start, $finish, $newSize) { global $arr_new;//  //      //      ,     //  ,       while($arr_new[$start] === null &amp;&amp; $start &lt; $newSize - 1) { ++$start; } //         , //         if($search == $arr_new[$start]) { return LibrarySort_PosNearby($start, $newSize); //  ,        } elseif($search &lt; $arr_new[$start]) { //      //     if($start &gt; 0) {// $start    $finish = $start; $start = 0; return floor(($start + $finish) / 2); } else {//$start == 0,      return $start;//    ,    } } //      ,     //  ,       while($arr_new[$finish] === null &amp;&amp; $finish &gt; 0) { --$finish; } //         , //         if($search == $arr_new[$finish]) { return LibrarySort_PosNearby($finish, $newSize); //  ,        } elseif($search &gt; $arr_new[$finish]) { //      //     if($finish &lt; $newSize - 1) {// $finish    $start = $finish; $finish = $newSize - 1; return ceil(($start + $finish) / 2); } else {//$finish == $newSize - 1,      return $finish;//    ,    } } //     , //,    -   //   ,       If($finish - $start &gt; 1) {//   ,    3  $middle = ceil(($start + $finish) / 2); //   $middle_Pos = 0; // ""     $offset = 0; //         //,    /,      while($middle - $offset &gt; $start &amp;&amp; $middle_Pos == 0){ if($arr_new[$middle - $offset] !== null) { $middle_Pos = $middle - $offset; } elseif($middle + $offset &lt; $finish &amp;&amp; $arr_new[$middle + $offset] !== null) { $middle_Pos = $middle + $offset; } ++$offset; } //    , ,     , //              If($middle_Pos) { if($arr_new[$middle_Pos] == $search) { return LibrarySort_PosNearby($middle_Pos, $newSize); } else { if($arr_new[$middle_Pos] &gt; $search) { $finish = $middle_Pos; } else {//$arr_new[$middle_Pos] &lt; $search $start = $middle_Pos; } return LibrarySort_BinarySearch($search, $start, $finish, $newSize); } } else {//$middle_Pos == 0 -   (   )     return $middle;//   - ,     } } else {//  ,       return floor(($start + $finish) / 2); } return false;//  ,       }</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Se durante a pesquisa o elemento for igual a um dos extremos do segmento</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//    ,        //$start - ,        //$newSize -     function LibrarySort_PosNearby($start, $newSize) { global $arr_new;//  //       for($left = $start - 1; $left &gt;= 0; $left--) { if($arr_new[$left] === null) {//  return $left;//   } elseif($arr_new[$left] &lt;&gt; $arr_new[$start]) {//     break; //   ,      } } //     ,    for($right = $start + 1; $right &lt;= $newSize - 1; $right++) { if($arr_new[$right] === null) {//  return $right; //   } elseif($arr_new[$right] &lt;&gt; $arr_new[$start]) {//     break; //   ,      } } return $start; //          .      ,     }</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Rebalanceamento local de uma matriz adicional</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//    //$insert - ,    //$pos -            //$newSize -     function LibrarySort_Rebalance_Local($insert, $pos, $newSize) { global $arr_new;//  // $pos  $insert,       while($pos - 1 &gt;= 0 &amp;&amp; $arr_new[$pos - 1] !== null &amp;&amp; $arr_new[$pos - 1] &gt; $insert) {--$pos;} while($pos + 1 &lt;= $newSize - 1 &amp;&amp; $arr_new[$pos + 1] !== null &amp;&amp; $arr_new[$pos + 1] &lt; $insert) {++$pos;} $middle = (integer) $newSize / 2;//  if($pos &lt;= $middle) {//      if($arr_new[$pos] !== null &amp;&amp; $arr_new[$pos] &lt; $insert) ++$pos; //  $right = $pos; while($arr_new[++$right] !== null) {} for($i = $right; $i &gt; $pos; $i--) { $arr_new[$i] = $arr_new[$i - 1]; } } else {//      if($arr_new[$pos] !== null &amp;&amp; $insert &lt; $arr_new[$pos]) --$pos; //  $left = $pos; while($arr_new[--$left] !== null) {} for($i = $left; $i &lt; $pos; $i++) { $arr_new[$i] = $arr_new[$i + 1]; } } $arr_new[$pos] = $insert; }</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Rebalanceamento total da matriz adicional</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//    //$count -        //$newSize -     function LibrarySort_Rebalance_Total($count, $newSize) { global $arr_new;//  global $library_Number;//     global $library_LeftPos;//        $library_Number = $count; //        $library_LeftPos = $newSize - 1;// ,     //         $i = $newSize - 1; while($i &gt;= 0) { if($arr_new[$i] !== null) {//   $pos = LibrarySort_Pos($library_Number, $count, $newSize);//   newSize=$newSize"); if($i == $pos) {//      --$i;//      } elseif($i &lt; $pos) {//    $arr_new[$pos] = $arr_new[$i]; $arr_new[$i] = null; --$i;//      } else {//$i &gt; $pos -     //      LibrarySort_RemoveLeft($i, $pos, $count, $newSize); $i = ($i &gt; $library_LeftPos) ? $library_LeftPos - 1 : --$i; } --$library_Number;//      } else {// ,   --$i;//      } } }</span></span></code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Movimento do elemento para a esquerda com rebalanceamento total</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//     . //    ,   //$i -     ,    //$pos -       //$count -        //$newSize -     function LibrarySort_RemoveLeft($i, $pos, $count, $newSize) { global $arr_new;//  global $library_Number;//     global $library_LeftPos;//        $left = false; $left_Pos = false;//      $j = $i;//      //     while($j &gt; 0 &amp;&amp; $left === false) {//            --$j; //     if($arr_new[$j] !== null) $left = $j;//    } if($left === false || $left &lt; $pos) {//   (  )    //     } else { //$left &gt;= $pos,     --$library_Number;//,       $left_Pos = LibrarySort_Pos($library_Number, $count, $newSize);//     //        LibrarySort_RemoveLeft($left, $left_Pos, $count, $newSize); //  ,     } //    ,   $arr_new[$pos] = $arr_new[$i]; $arr_new[$i] = null; //,         if($pos &lt; $library_LeftPos) $library_LeftPos = $pos; }</span></span></code> </pre> </div></div><br>  Eu tive que codificar do zero, com base em uma descri√ß√£o geral do m√©todo.  N√£o vi uma velocidade pr√≥xima √† classifica√ß√£o r√°pida; minha op√ß√£o de classifica√ß√£o da biblioteca √© 10 a 20 vezes mais lenta que a classifica√ß√£o r√°pida.  Mas a raz√£o, √© claro, √© que minha implementa√ß√£o √© muito grosseira, muito n√£o foi levado em considera√ß√£o. <br><br>  Eu gostaria de ver uma vers√£o dos criadores do algoritmo.  Escreverei hoje para os autores (e colocarei um link para este habrastatu), eles responder√£o repentinamente.  Embora ... eu lembrei, tentei entrar em contato com Allen Beachich ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classifica√ß√£o ABC</a> ) e Jason Morrison ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">classifica√ß√£o J</a> ), mas o resultado foi o mesmo que se eu escrevesse no Sportloto. <br><br>  <b>UPD</b>  <b>Martin Farah-Colton me respondeu que eles nunca fizeram a implementa√ß√£o:</b> <blockquote>  Receio que nunca implementemos esses algoritmos. </blockquote>  <b>A principal coisa √© a id√©ia :)</b> <br><br><h2>  Caracter√≠sticas do algoritmo </h2><div class="scrollable-table"><table><tbody><tr><th align="left">  T√≠tulo </th><td align="left" colspan="2">  Classifica√ß√£o da biblioteca, Classifica√ß√£o da biblioteca </td></tr><tr><th align="left">  Outro nome </th><td align="left" colspan="2">  Classifica√ß√£o de inser√ß√£o aberta </td></tr><tr><th align="left">  Os autores </th><td align="left" colspan="2">  Michael A. Bender, Mart√≠n Farach-Colton, Miguel Mosteiro </td></tr><tr><th align="left">  Ano </th><td align="left" colspan="2">  2004 </td></tr><tr><th align="left">  Class </th><td align="left" colspan="2">  Classifica√ß√µes de inser√ß√£o </td></tr><tr><th align="left">  Compara√ß√µes </th><td align="left" colspan="2">  Existe </td></tr><tr><th align="left" rowspan="3">  Complexidade do tempo </th><th align="left">  o melhor </th><td align="left">  O ( <b>n</b> ) </td></tr><tr><th align="left">  m√©dia </th><td align="left">  O ( <b>n</b> log <b>n</b> ) </td></tr><tr><th align="left">  o pior </th><td align="left">  O ( <b>n <sup>2</sup></b> ) </td></tr><tr><th align="left">  Complexidade extra de mem√≥ria </th><td align="left" colspan="2">  O ( <b>n</b> ) </td></tr></tbody></table></div><br><h2>  Refer√™ncias </h2><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><img width="30" height="30" src="https://habrastorage.org/webt/3y/wq/mh/3ywqmhuo7fv68jggkc416kbzuw4.png"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Classifica√ß√£o da biblioteca</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><img width="30" height="30" src="https://habrastorage.org/webt/sb/ln/dw/sblndwenhewoyoas_n3xp7tyuuu.png"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Visualiza√ß√£o do algoritmo de classifica√ß√£o da biblioteca</a> <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow"><img width="84" height="30" src="https://habrastorage.org/webt/yv/lm/2t/yvlm2t2kl5affkpm0hzqh7qw5ly.png"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">A classifica√ß√£o de inser√ß√£o √© O (n log n)</a> <br><br><h3>  Autores do algoritmo: </h3><br><img align="right" width="392" height="120" src="https://habrastorage.org/webt/il/dh/l9/ildhl9tnc4alqaexulf-kw2rmt0.png"><br clear="left"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Michael A. Bender</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Martin Farah-Colton</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" rel="nofollow">Miguel Mostiro</a> </p><br><br><h3>  Artigos da s√©rie: </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aplicativo Excel AlgoLab.xlsm</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classifica√ß√µes de C√¢mbio</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classifica√ß√µes de inser√ß√£o</a> <ul><li>  <b>Bibliotec√°rio</b> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Paci√™ncia Sort</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classificar "Torre de Han√≥i"</a> </li><li>  Classifica√ß√£o de mesa jovem </li><li>  Inverter classifica√ß√£o </li><li>  Inserir compara√ß√£o de classifica√ß√£o </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classificar por sele√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mesclar classifica√ß√µes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classificar por distribui√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Classifica√ß√£o h√≠brida</a> </li></ul><br><br><img align="right" width="364" height="192" src="https://habrastorage.org/webt/9y/1b/d5/9y1bd57yvcw4rt65o3ztjb59xum.png"><br clear="left"><p>  Classifica√ß√£o adicionada ao AlgoLab.  Assim, voc√™ pode experimentar com pequenos conjuntos de dados. <br><br>  Nesse caso, voc√™ pode decidir quantas vezes a matriz auxiliar √© maior que a matriz principal.  Para selecionar o coeficiente <strong>Œµ,</strong> clique com o bot√£o direito do mouse na c√©lula com "Classifica√ß√£o da biblioteca" e selecione "Alterar nota".  E na nota, defina cuidadosamente o valor inteiro para <b>e</b> de 2 a 5. Se voc√™ digitar outra coisa em vez desses n√∫meros, o valor padr√£o = 2 ser√° usado. <br><br>  Voc√™ tamb√©m pode selecionar o tipo de reequil√≠brio.  Se voc√™ definir local = 1, o reequil√≠brio local ser√° usado.  Se local = 0 - cheio. <br><br>  E n√£o esque√ßa de definir a escala ideal para a planilha de processo antes de iniciar a visualiza√ß√£o, caso contr√°rio, a matriz auxiliar n√£o caber√° na tela. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt416653/">https://habr.com/ru/post/pt416653/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt416641/index.html">8 etapas do processo de desenvolvimento de uma interface de aplicativo m√≥vel</a></li>
<li><a href="../pt416643/index.html">Implantando o Elasticsearch na AWS com o Kubernetes em 10 etapas</a></li>
<li><a href="../pt416645/index.html">MIS. Padr√µes de pesquisa</a></li>
<li><a href="../pt416647/index.html">As ag√™ncias governamentais sonham com riscos el√©tricos?</a></li>
<li><a href="../pt416651/index.html">1M HTTP rps em 1 n√∫cleo de CPU. DPDK em vez de nginx + linux kernel TCP / IP</a></li>
<li><a href="../pt416657/index.html">Dois ter√ßos dos cart√µes de mem√≥ria usados ‚Äã‚Äãcont√™m dados pessoais de propriet√°rios anteriores</a></li>
<li><a href="../pt416659/index.html">Devido a que o volume de pagamentos digitais para a economia do show chegar√° a US $ 1,2 trilh√£o de d√≥lares</a></li>
<li><a href="../pt416661/index.html">Quais tend√™ncias devem ser consideradas pelos usu√°rios e fornecedores de banco m√≥vel</a></li>
<li><a href="../pt416665/index.html">Reutilizando Bibliotecas Privadas do Android com o Sonatype Nexus Repository OSS</a></li>
<li><a href="../pt416667/index.html">Or√ßamento de isolamento de poeira e ru√≠do da antiga unidade de sistema</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>