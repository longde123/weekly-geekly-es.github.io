<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üî¢ ‚è≥ üö¨ Edition-basierte Neudefinition. Teil 2 üîì üë©‚Äç‚úàÔ∏è üõ£Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo! Wie in einem fr√ºheren Beitrag √ºber Edition-Based Redefinition versprochen, ist dies der zweite Teil. 

  

 Womit arbeiten wir also? Unser Haup...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Edition-basierte Neudefinition. Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/sportmaster_lab/blog/470423/">  Hallo!  Wie in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">fr√ºheren Beitrag</a> √ºber Edition-Based Redefinition versprochen, ist dies der zweite Teil. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/fw/cn/5m/fwcn5mwqouhgqal64ozpfwavw1w.png" width="800"></a> <br><br>  Womit arbeiten wir also?  Unser Hauptproduktionsserver ist Oracle 12C, Enterprise Edition.  Und was wichtig ist, es werden mehrere Dutzend Anwendungen gleichzeitig ausgef√ºhrt.  Warum konzentrieren wir uns darauf?  Die Technologie ist relativ neu, sie ist nicht sehr gut eingefahren.  Und es w√§re unlogisch, einige kritische Systeme sofort darauf zu √ºbertragen.  Aus diesem Grund haben wir uns entschlossen, langsam von weniger kritischen zu kritischeren Systemen √ºberzugehen.  Dementsprechend mussten wir das n√§chste Problem verstehen: wie man mit EBR-Technologie arbeitet und wie man die Integration in der Situation organisiert, in der wir eine versionierte Version haben und die andere nicht.  Wie sich herausstellte, k√∂nnen Sie in Version 12 von Oracle nichtversionierte Objekte, nichtversionierte Pakete und nichtversionierte Darstellungen in einem versionierten Schema erstellen, um die Integration zu organisieren. <br><a name="habracut"></a><br>  Nat√ºrlich k√∂nnen wir eine nicht versionierte API erstellen und sie dem nicht versionierten Schema zur Verwendung geben.  Aber was ist, wenn diese Nicht-Versions-API (oder ein Teil davon) in unserer Anwendung verwendet wird und wir sie in uns selbst versionieren und nicht-Versions-Objekte zur Seite stellen m√ºssen?  Dies ist nur das n√§chste Problem, mit dem wir zu k√§mpfen hatten.  Wir verwenden die API h√§ufig, aber wie Sie sich erinnern, gibt es eine Einschr√§nkung, dass versionierte Objekte nicht ohne Version verwendet werden k√∂nnen.  Vorausgesetzt, dass mehrere Anwendungen auf dem Server ausgef√ºhrt wurden, war es nat√ºrlich erforderlich zu verstehen, wie wir eine Anwendung auf die neue Edition umstellen und die API dieses Schemas mit anderen Datenbankschemata verwenden k√∂nnen. <br><br>  Es gibt verschiedene Optionen f√ºr die Installation von Edition: <br><br><ul><li>  Legen Sie den Standardwert f√ºr die Edition auf die gesamte Datenbank fest </li><li>  Installieren Sie die Umgebung erneut in der gesamten Datenbank. </li>
</ul><br>  Diese Optionen werden sofort verworfen, da zumindest einige Anwendungen nicht auf die Verwendung von EBR umstellen. <br><br>  Es ist auch m√∂glich, einen Dienst zum Ermitteln der Version oder zum Ermitteln der Version beim Verbinden der Anwendung mit der Schaltung zu erstellen.  Dies ist praktisch, wenn wir √ºber eine Drittanbieteranwendung eine Verbindung zur Datenbank herstellen. <br><br>  Und wenn wir Jobs brauchen, die planm√§√üig ausgef√ºhrt werden und in einer bestimmten Ausgabe arbeiten?  Dementsprechend gibt es eine andere M√∂glichkeit, zu einer neuen Version zu wechseln - dies dient dazu, <b>die aktuelle Sitzung an einer bestimmten Version auszurichten</b> . <br><br>  Eigentlich haben wir uns das als L√∂sung ausgesucht.  Sie k√∂nnen nach der Anmeldung einen Trigger an das versionierte Schema anh√§ngen, der besagt, dass die aktuelle Sitzung in diesem Schema in dieser Edition funktioniert. <br><br><img src="https://habrastorage.org/webt/pu/rf/qy/purfqyxkj-ya3rxtm9xbtem561q.png" width="800"><br><br>  Zur√ºck zur Integration und Vervielf√§ltigung der Logik.  Es gibt Aufgaben: Ich m√∂chte eine Art Anwendungslogik in meinem Schema versionieren und sie auch einem Benutzer ohne Version zur Verf√ºgung stellen.  Zuerst schien es, dass dies nicht implementiert werden konnte, aber nachdem wir uns mit der Frage befasst hatten, sahen wir, dass das √ºbliche dbms_sql-Paket, das im Prinzip auf die Durchf√ºhrung dynamischer Abfragen abzielt, zur L√∂sung dieses Problems beitragen kann.  Wie?  Sehr einfach: Wenn Sie eine Anforderung verarbeiten oder einen anonymen Block aufrufen, k√∂nnen Sie den Bedingungsnamen als Parameter ausgeben und so die Version angeben, in der dieser Code analysiert und ausgef√ºhrt wird.  Wenn wir eine Prozedur in uns selbst verwenden und dieselbe Prozedur einem Schema eines Drittanbieters zuweisen m√ºssen, schlie√üen wir sie einfach mit einem Aufruf in die Prozedur dbms_sql.parse ein und erstellen so einen Wrapper, der in ein Objekt ohne Version eingef√ºgt werden kann, und - bitte, wir k√∂nnen unser versioniertes Objekt verwenden nicht versionierter Benutzer. <br><br>  Was sehen Sie hier?  Aus irgendeinem Grund werden bei der Angabe der Bedingung keine Out-Parameter in den Prozeduren ausgegeben.  Warum - es ist nicht klar, aber in den Schemata, in denen wir gearbeitet haben, wird dies nicht oft verwendet.  Vielleicht werden wir die Logik irgendwie wiederholen oder nach weiteren L√∂sungen suchen. <br><br><img src="https://habrastorage.org/webt/q9/m-/cv/q9m-cvm7psxxryvi_e_bpgkilug.png" width="800"><br><br>  Die folgenden Probleme sind Fehler oder Funktionen des EBR, auf die wir gesto√üen sind.  Das erste ist ein Problem mit konstruierten Typen und Pipeline-Funktionen.  Was hat Pipeline damit zu tun?  Neben der Tatsache, dass wir wirklich bestimmte Algorithmen haben, die auf der Basis von Pipeline-Funktionen arbeiten, ist Pipeline eine bestimmte L√∂sung, um die versionierte Ansicht zur Seite zu stellen.  Wir haben die Ansichten geerbt, die eine ziemlich komplizierte Logik f√ºr die Datenvorverarbeitung enthalten, und Schemata von Drittanbietern verwenden diese Ansichten ebenfalls.  Dementsprechend war es notwendig zu verstehen, wie unsere Versionsansichten auf eine Nicht-Versionsdaten-Verbraucherschaltung gesetzt werden, vorausgesetzt, der Ausgabensatz von Spalten √§ndert sich nicht.  Als eine L√∂sung dieser Art war klar, dass Sie alle diese Ansichten mit dbms_sql in die Pipeline-Funktion einschlie√üen und sie f√ºr den Verbraucher in die endg√ºltige Ansicht einf√ºgen k√∂nnen. Ja, dies ist ressourcenintensiv f√ºr den Server, erfordert jedoch keine √Ñnderungen seitens des empfangenden Systems. <br><br>  Zur√ºck zur Verwendung von Pipeline-Funktionen stellte sich heraus, dass das Paket einfach nicht kompiliert wird und auseinanderf√§llt, wenn der zu erstellende Typ nicht in dem erstellten Versionspaket erstellt wird und zum ersten Mal erstellt wird.  Sofort kam keine L√∂sung, ging nach suchen, was von anderen Programmierern vorgeschlagen wurde?  Jemand sagte, dass es erforderlich ist, diesen Typ in der Nullversion des Pakets oder ein Paket mit dem entsprechenden Typ in der Nullversion der Datenbank zu erstellen.  Es war nicht klar, warum das so war.  Sie fanden eine L√∂sung, dass diese Typen, die implizit beim Kompilieren des Pakets erstellt wurden, einfach als Datenbankobjekt in einen separaten Typ eingef√ºgt werden k√∂nnen.  Dadurch wird das Problem mit den F√∂rderfunktionen gel√∂st. <br>  Das n√§chste Feature, auf das wir gesto√üen sind, ist das nicht standardm√§√üige Verhalten versionierter Ansichten. <br><br>  Denken Sie daran, ich habe dar√ºber gesprochen, dass Objekte geerbt und aktualisiert werden.  Es stellte sich also heraus, dass wir, wenn Sie und ich eine versionierte Ansicht f√ºr eine Ausgabe mit bedingtem Nullwert erstellten, bei der f√ºnften Ausgabe feststellten, dass die Kommentare Ungenauigkeiten aufwiesen.  Ich stelle zum Beispiel fest, dass ich in einem Kommentar zu einer Spalte zwei Buchstaben an bestimmten Stellen austauschen kann.  Hinterlasse keine solche Unvollkommenheit! <br><br>  Der √ºbliche Kommentarbefehl f√ºhrt also dazu, dass unsere versionierte Ansicht in der aktuellen Version aktualisiert wird.  Aus diesem Grund fallen alle abh√§ngigen Pakete auseinander und wie geht man damit um?  Zu diesem Zweck haben sie ein bestimmtes Skript geschrieben, das beim Erstellen einer neuen Edition die Versionsansicht jedes Mal aktualisiert, wenn die n√§chste Version ver√∂ffentlicht wird.  Dies stellt keine gro√üe Belastung f√ºr das Datenbankw√∂rterbuch dar. Nehmen Sie jedoch bei Bedarf geringf√ºgige Korrekturen vor oder stellen Sie beispielsweise neue Zusch√ºsse aus. Wir m√ºssen keine neue Edition erstellen <br><br>  Nun, der letzte Fehler oder diese Funktion ... Es ist nicht klar, warum beim √Ñndern von nicht null die Einschr√§nkungen f√ºr die Spalte der versionierten Ansichten auseinanderfielen.  Das hei√üt, sobald wir sagen, dass unsere Spalte der Basistabelle jetzt keine Null-Einschr√§nkungen haben sollte, f√§llt die Ansicht selbst bei Verwendung der DBMS-Redifinition auseinander.  Wir konnten dieses Ding in keiner Weise besiegen, vielleicht sind die Leser darauf gesto√üen, es wird interessant sein herauszufinden, ob eine L√∂sung gefunden wurde. <br><br><img src="https://habrastorage.org/webt/ns/99/i3/ns99i3pxy6azxgaokdjnnvo7fea.png" width="800"><br><br>  Was m√∂chte ich abschlie√üend sagen?  Die Edition-basierte Neudefinition ist eine effektive Technologie f√ºr eine echte M√∂glichkeit, eine Version oder einen Hotfix im Benutzermodus online zu stellen.  Wir haben ber√ºhrt, gef√ºhlt und erkannt, dass das Organisieren der Integration auf einem Server, wenn nicht alle Schemata diese Technologie verwenden, real ist, ganz zu schweigen davon, dass das versionierte Schema auf einem dedizierten Server oder in einer separaten Containerdatenbank funktionieren kann. <br><br>  Und als Anwendung und als Antwort auf die Schl√ºsselfrage: "Ist es in der Produktion m√∂glich?" ... Wir hoffen, dass die Edition-basierte Neudefinition fr√ºher oder sp√§ter in alle unsere Projekte √ºbergeht, und vielleicht ist dies die letzte Station unserer Anwendungen und garantiert eine Ruhe Schlaf des Entwicklers, der f√ºr die Installation der neuen Version verantwortlich ist. <br><br>  Eigentlich ist das alles.  Vielen Dank f√ºr Ihre Aufmerksamkeit. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de470423/">https://habr.com/ru/post/de470423/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de470407/index.html">Wie Yandex mir beigebracht hat, wie man Programmierer interviewt</a></li>
<li><a href="../de470411/index.html">10 wenig bekannte Funktionen der Chrome Developer Tools</a></li>
<li><a href="../de470413/index.html">Was ist im Jahr 2020 besser zu w√§hlen - Reagieren oder Vue?</a></li>
<li><a href="../de470415/index.html">FAQ.Net - ein kostenloses Notizbuch oder Notizprogramm f√ºr Windows</a></li>
<li><a href="../de470417/index.html">Industrie 4.0: Autonome Unternehmensideen von SAP und KUKA</a></li>
<li><a href="../de470425/index.html">30.000 US-Dollar f√ºr die L√∂sung der Probleme von Regel 30 f√ºr zellulare Automaten - ein Wettbewerb von Stephen Wolfram</a></li>
<li><a href="../de470429/index.html">Unentwickeltes ERP in der Produktion: auf der Intensivstation oder in einer Leichenhalle? (Fortsetzung)</a></li>
<li><a href="../de470437/index.html">Digitaler Durchbruch: Finale des weltgr√∂√üten Hackathons</a></li>
<li><a href="../de470441/index.html">Gr√∂√üen verschiedener Arten von Java-Objekten</a></li>
<li><a href="../de470443/index.html">Kontinuierliche Profilerstellung in Go</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>