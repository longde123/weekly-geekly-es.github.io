<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧜🏼 🙎🏾 💃 Integração simples do MS Project e Redmine 👰🏻 👩🏼‍🤝‍👩🏻 🖍️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Epígrafe 


 "Se eu colocasse os lábios de Nikanor Ivanovich no nariz de Ivan Kuzmich, levasse alguma arrogância como a de Baltazar Baltazarych e, tal...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Integração simples do MS Project e Redmine</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452982/"><h4 id="epigraf">  Epígrafe </h4><br><p>  <em>"Se eu colocasse os lábios de Nikanor Ivanovich no nariz de Ivan Kuzmich, levasse alguma arrogância como a de Baltazar Baltazarych e, talvez, acrescentasse mais a adversidade de Ivan Pavlovich a isso, eu decidi imediatamente".</em>  N.V.  Gogol.  Casar. </p><br><p><img src="https://habrastorage.org/webt/nx/cv/ga/nxcvgacl4ywzb0ypkmtx5y1wtj0.png"></p><br><p>  Existem duas ferramentas de gerenciamento de projetos bem conhecidas e muito diferentes: MS Project e Redmine.  Cada um deles tem seus próprios méritos, e esses méritos poderiam se complementar perfeitamente. </p><br><p>  Quero chamar a atenção de um pequeno utilitário chamado P2R, que permite sem instalação e com um mínimo de configurações garantir a sincronização on-line de projetos no MS Project e Redmine.  Está disponível <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">em</a> . </p><a name="habracut"></a><br><p>  Que bom é o projeto: </p><br><ul><li>  É conveniente editar o projeto como um todo no modo de documento - uma planilha.  Também é uma vantagem que vários projetos possam ser rapidamente combinados em um consolidado e visualizados como um todo.  (No Redmine, as tarefas do projeto são editadas apenas uma por vez no formulário da tarefa). </li><li> Todos os tipos de variedade e flexibilidade de conexões entre tarefas (no Redmine, as comunicações são implementadas de forma minimalista). </li><li>  Monitorar o carregamento de recursos e a capacidade de distribuir tarefas automaticamente em um calendário, levando em consideração os relacionamentos e o carregamento de recursos.  Incluindo recursos "desumanos", como equipamentos, instalações etc.  (Não há nada disso no Redmine; a ferramenta foi criada para outro.) </li></ul><br><p>  O que é bom no Redmine: </p><br><ul><li>  Um produto gratuito no Ruby On Rails, bastante simples, bem personalizável e extensível, com uma comunidade ativa, uma grande variedade de plugins, desenvolvidos ativamente </li><li>  Web e trabalho em equipe.  Como resultado, é muito conveniente registrar o progresso de cada tarefa, incluindo o log de alterações, correspondência e discussões sobre a tarefa, arquivos, relatórios individuais sobre as horas gastas etc. (Não há nada disso no Project.) </li></ul><br><p>  Seria conveniente preparar projetos no MS Project, enviá-los para execução no Redmine, obter os termos reais das tarefas e as horas estimadas / passadas a partir daí, compará-los com a linha de base salva anteriormente, fazendo ajustes, se necessário.  (É especialmente conveniente, por exemplo, em uma situação como a nossa no trabalho: há um fluxo de projetos com uma estrutura regular, que deve ser formada de acordo com modelos, ligeiramente especificados e dados para o trabalho.) </p><br><p>  Existem plugins Rredmine para essa integração.  Mas eles fazem integração através do upload e download de arquivos xml, mas eu quero isso sem arquivos e mais fácil. </p><br><p>  O script P2R proposto é escrito em ruby ​​e funciona com o MS Project via OLE e com o Redfmine pela API.  Se o ruby ​​não estiver instalado, você poderá usar o mesmo script compilado em .exe (ele está na pasta de downloads, gerada pelo utilitário ocra). </p><br><p>  A preparação de um projeto MSP para publicação e sincronização requer um mínimo de ação. </p><br><ol><li>  O P2R armazena identificadores de tarefa Redmine no atributo Hyperlink das tarefas MSP.  Para marcar uma tarefa para publicação, você precisa colocar 0 nesse atributo.  Após a publicação, o P2R alterará automaticamente esse campo para o ID da tarefa real e, ao mesmo tempo, gerará a URL correta no atributo HyperlinkAddress, para que o link seja clicável.  (Obviamente, não se esqueça de salvar o projeto MSP, ele não será salvo automaticamente.) </li><li>  O P2R também armazena IDs de usuário Redmine no atributo "Hiperlink" dos recursos MSP.  Para associar esse recurso a um usuário Redmine, você precisa encontrar o ID do usuário no administrador do Redmine.  (O administrador tem acesso à lista de usuários e pode ver seu ID, por exemplo, nos links da lista). </li><li>  O P2R pega os parâmetros de acesso no Redmine a partir de uma tarefa especial chamada “Sincronização do Redmine”.  Você precisa criar uma tarefa e colocar os parâmetros de acesso no campo "Notas" no formato YAML de acordo com a amostra (os valores dos parâmetros, é claro, devem ser substituídos pelos seus): <br><br><pre><code class="plaintext hljs">redmine_host: 192.168.10.10 redmine_port: 3000 redmine_api_key: a21e583e7670b1fc79378441d485b9608e4c2dc4c redmine_project_uuid: test task_default_redmine_tracker_id: 4 resource_default_redmine_role_id: 4</code> </pre> </li></ol><br><p>  Depois disso, o projeto está pronto para sincronização.  A finalidade dos parâmetros é clara em seus nomes. </p><br><p>  O parâmetro <code>redmine_project_uuid</code> contém um código de projeto exclusivo que deve ser inventado de acordo com as regras do Redmine, que podem ser encontradas na página de configurações de qualquer projeto.  Se ocorrer um erro de "Entrada não processável" ao criar um projeto, provavelmente você selecionou o uuid incorreto do projeto. </p><br><p>  O parâmetro <code>task_default_redmine_tracker_id</code> opcional.  Se você omitir, a faixa padrão das configurações do Redmine será aposta. </p><br><p>  Se você não deseja criar um novo projeto no Redmine, mas conectar um existente, faça o seguinte: </p><br><ol><li>  Adicione o parâmetro <code>redmine_project_id</code> às configurações de sincronização do Redmine e coloque o ID do projeto Redmine <code>redmine_project_id</code> não é uuid!  Esse número inteiro é o ID da entrada no banco de dados Redmine.  Você pode encontrar esse ID, por exemplo, no cartão do projeto no formato XML ou JSON (no exemplo acima, você pode obtê-lo em <a href="">http://192.168.10.10/10000000/projects/test.json</a> ). </li><li>  Para que as tarefas sejam sincronizadas com as existentes no Redmine, coloque no campo Hyperlink não seus zeros, mas seus IDs reais do Redmine. </li></ol><br><p>  Há uma pequena restrição na atribuição de recursos a uma tarefa: </p><br><ul><li>  Como apenas um executor pode ser atribuído a uma tarefa no Redmine, o script irá xingar e parar quando encontrar mais de um recurso na tarefa MSP marcada para sincronização.  (1) É possível que em versões futuras esse comportamento seja substituído por um comportamento mais moderado, como emitir um aviso e escolher aleatoriamente um deles.  (2) Os recursos que não são sincronizados podem ser atribuídos quantos você desejar, o P2R os ignora. </li></ul><br><p>  O seguinte algoritmo de sincronização é implementado: </p><br><ul><li>  O nome da tarefa, a estrutura de subordinação e a pessoa responsável têm precedência no lado MSP, ou seja,  eles precisam ser editados no MS Project, e as alterações irão para o Redmine durante a sincronização. </li><li>  O início da tarefa, o fim, os custos de mão-de-obra (avaliação e reais) têm prioridade no lado do Redmine e vão para o MSP durante a sincronização. </li></ul><br><p>  Há também um problema com os custos da mão-de-obra: no MSP, a estimativa dos custos da mão-de-obra, os custos reais da mão-de-obra e a porcentagem de conclusão são fortemente conectados pela fórmula, enquanto no Redmine são definidos de forma independente.  Ou seja, eles o avaliaram em 10 horas, passaram 40 horas e, ao mesmo tempo, concluíram a tarefa em 30%.  Isso acontece na vida, e Redmine não se importa.  A solução escolhida é: </p><br><ul><li>  Os custos reais são sempre escritos como estão </li><li>  Se os custos reais forem maiores que a estimativa e a porcentagem de conclusão for 0, ignore a estimativa </li><li>  Se os custos reais forem maiores que a estimativa e a porcentagem de conclusão não for 0, calcularemos uma nova estimativa com base no fato e na porcentagem de conclusão. </li></ul><br><p>  No total, o processo de sincronização é assim: </p><br><ol><li>  Abrimos nosso projeto no MS Project e o deixamos ativo. </li><li>  Se quisermos, iniciaremos a execução ociosa do P2R e veremos quais serão as mudanças. </li><li>  Iniciamos a sincronização real: com a opção –e. </li></ol><br><p>  O diretório de trabalho a partir do qual o script é iniciado não importa. </p><br><p>  Você pode iniciar o script por timer e a sincronização se tornará completamente automática. </p><br><p>  Obrigado pela atenção. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt452982/">https://habr.com/ru/post/pt452982/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt452966/index.html">O mito da atenção plena: uma visão "neurocêntrica" ​​da meditação</a></li>
<li><a href="../pt452968/index.html">Índices no PostgreSQL - 10 (Bloom)</a></li>
<li><a href="../pt452974/index.html">Programação assíncrona (curso completo)</a></li>
<li><a href="../pt452978/index.html">ok.tech: dados explicados</a></li>
<li><a href="../pt452980/index.html">AWP KBR-N - O dia X chegará em breve, que não se preparou para culpar</a></li>
<li><a href="../pt452984/index.html">Arduino e Framboesa proibidos</a></li>
<li><a href="../pt452986/index.html">Bloqueios no Postgres: 7 dicas para trabalhar com bloqueios</a></li>
<li><a href="../pt452988/index.html">Integração com o Kubernetes Dashboard e GitLab</a></li>
<li><a href="../pt452990/index.html">“Você precisa conhecer a pilha da web e o C ++”: uma entrevista com Alexei Kozyatinsky sobre o desenvolvimento do Chrome DevTools e não apenas</a></li>
<li><a href="../pt452992/index.html">CATIA CAD na plataforma 3DEXPERIENCE ajudou a recriar o navio de guerra de Leonardo da Vinci</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>