<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽‍🎓 ✊ 🍤 Caixa preta para a casa: coletamos o NAS com nossas próprias mãos, parte 2 - magnífico NAS4Free 💸 👐 👩🏼‍🤝‍👨🏻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A publicação é direcionada a pessoas distantes da administração do sistema. Este post demonstra os recursos básicos do maravilhoso sistema operacional...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Caixa preta para a casa: coletamos o NAS com nossas próprias mãos, parte 2 - magnífico NAS4Free</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/397575/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A publicação é direcionada a pessoas distantes da administração do sistema. </font><font style="vertical-align: inherit;">Este post demonstra os recursos básicos do maravilhoso sistema operacional NAS4Free, que permite implantar o NAS doméstico, mesmo em hardware de baixa potência, com um completo desconhecimento do FreeBSD e da linha de comando. </font><font style="vertical-align: inherit;">A primeira parte da publicação está localizada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, temos uma caixa com as seguintes características:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Caso: Thermaltake Core V1;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fonte de alimentação: Chieftec HPS-350NS;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Placa-mãe: GIGABYTE GA-J1800N-D2H;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RAM: Transcende SO-DIMM 2Gb DDR-III 1333Mhz x 2;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HDD: WD Re 2004FBYZ x 2 (antes de fazer olhos redondos, leia a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primeira parte</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> );</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Arrefecimento: VENTILADOR TITAN DC (80 mm, 2000 rpm) x 2.</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
É hora de transformá-lo em um NAS doméstico, o mais confiável possível no ambiente atual. </font><font style="vertical-align: inherit;">E o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zettabyte File System</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nos ajudará com isso </font><font style="vertical-align: inherit;">- talvez a melhor solução para organizar um armazenamento de arquivos tolerante a falhas e, ao mesmo tempo, produtivo. </font><font style="vertical-align: inherit;">Desenvolvido pela Sun Microsistems para Solaris, o ZFS foi posteriormente portado para Linux e FreeBSD. </font><font style="vertical-align: inherit;">Entre suas muitas vantagens, estaremos interessados ​​no seguinte:</font></font><br>
<br>
<ol>
<li> ,          ,   ,    –   ,  LVM;</li>
<li>     256-  ;</li>
<li>      ;</li>
<li>    RAID-    .</li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Entre as soluções especializadas capazes de trabalhar com o ZFS, dois concorrentes se destacam claramente - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FreeNAS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NAS4Free</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Esses nomes de "espelho" não são de forma alguma acidentais - ambos os conjuntos são baseados no FreeBSD, e o próprio NAS4Free é um fork do FreeNAS 0.7, que se originou no momento em que o sistema operacional original ficou sob as asas da iXsystems e entrou nos trilhos. É o NAS4Free que é o meu favorito. Porque Vamos acertar.</font></font><br>
<br>
<ol>
<li>.   ,       NAS,     ,   NAS4Free   .       ?   , 4  RAM,  4-  ,       .     512    2-   .  FreeNAS   :      8  RAM  8- ,          1616 (    ).</li>
<li>.   NAS4Free       “ ” –         :<br>
<img src="https://habrastorage.org/files/db0/488/59d/db048859d2fd48b891142fb3bdb4b3b5.JPG"></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conveniência. </font><font style="vertical-align: inherit;">No NAS4Free, quase tudo pode ser controlado através de uma interface web realmente intuitiva, além de conter muitas dicas e bem traduzida para o russo em comparação com um concorrente. </font><font style="vertical-align: inherit;">Você poderá trabalhar com discos e serviços, gerenciar o sistema de arquivos, tirar instantâneos e montar clones sem iniciar o console em princípio, o que atrairá usuários iniciantes e pessoas que não estão familiarizadas com a administração * nix.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Penso que os argumentos acima são suficientes para fazer uma escolha inequívoca. </font><font style="vertical-align: inherit;">Agora, trataremos da instalação e configuração inicial do sistema.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instale o NAS4Free</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como existem apenas dois discos no sistema, usaremos uma unidade flash USB como unidade de inicialização. Qual deles é absolutamente irrelevante, qualquer antiguidade de 2 GB será suficiente. Se houver dúvidas sobre a saúde do dispositivo, você pode usar o mesmo </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Rufus</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , após executar vários testes. Então tudo é simples - faça o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">download do LiveCD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e prossiga com a instalação. Primeiro, você verá a seguinte tela: </font></font><br>
<br>
<img src="https://habrastorage.org/files/fbf/648/4da/fbf6484daa0547b0909f3c6ae628055c.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de um tempo, o menu de texto aparece no visor: </font></font><br>
<br>
<img src="https://habrastorage.org/files/a67/f79/d38/a67f79d38d184d7398b43e8e47ec31e6.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Estamos interessados ​​no nono item - nós o selecionamos. O processo de instalação é iniciado:</font></font><br>
<br>
<img src="https://habrastorage.org/files/e0b/749/0b5/e0b7490b5b9249e3afe759a0338f00ac.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Não tocamos no modo especialista, mas a escolha entre GPT e MBR depende da idade da placa-mãe da sua máquina. Se você é fã do "clássico" na face da BIOS, selecione o segundo item. Vale UEFI - escolha o primeiro. Após a confirmação, o NAS4Free informará quais operações serão executadas - concordamos com tudo: a </font></font><br>
<br>
<img src="https://habrastorage.org/files/9e0/573/d3d/9e0573d3d97748f9886e27cfce14abd7.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
seguir, selecione a unidade com o disco de instalação (no nosso exemplo, é o único): </font></font><br>
<br>
<img src="https://habrastorage.org/files/4e4/6e0/278/4e46e0278ccd4e81ac36823d4deaae17.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, especifique a unidade flash USB na qual a instalação será executada. É fácil diferenciá-lo da unidade do sistema em tamanho e nome:</font></font><br>
<br>
<img src="https://habrastorage.org/files/2ab/ab6/10c/2abab610c86a4e088662cc49dadb6788.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O próximo passo é definir o tamanho do arquivo de paginação. A regra é simples: se você usar uma unidade de 2 GB - coloque 512 MB, 4 GB - coloque 1024 MB, se 8 - 2. Muitos têm uma pergunta justa nos comentários, mas quão confiável é instalar o sistema operacional em uma unidade flash USB, tanto mais que trocá-lo ? Considero necessário esclarecer este ponto. Primeiramente, um recurso da versão incorporada é que uma imagem de disco do sistema é criada na RAM, ou seja, uma unidade flash é acessada apenas no momento do carregamento do NAS, bem como ao salvar as configurações. Em segundo lugar, o instalador requer a criação de um arquivo de troca sem falha, enquanto determina seu tamanho incorretamente. Fazer uma troca de 8 GB em um dispositivo de 4 GB? Fácil! De qualquer forma, de acordo com o programa, vale a pena tentar. Para evitar erros, é mais fácil definir um dos valores corretos fornecidos acima.E, finalmente, o arquivo de troca é conectado manualmente nas configurações - ele não será usado, o que significa que a unidade flash também não será eliminada.</font></font><br>
<br>
<img src="https://habrastorage.org/files/f60/05b/781/f6005b78119547c887160a817bc13307.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O processo de instalação será iniciado, após o qual você verá a seguinte tela: </font></font><br>
<br>
<img src="https://habrastorage.org/files/899/565/757/89956575762146aa86febf2e095cf33e.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode desconectar a unidade flash USB e reiniciar - a instalação foi bem-sucedida. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos trabalhar com o próprio NAS. Como escolhemos a opção de orçamento para o thin client como placa-mãe, teremos que começar ajustando os parâmetros de inicialização, conectando não apenas uma unidade flash USB, mas também um monitor com um teclado no dispositivo. Como as saídas de vídeo apresentam D-Sub e HDMI, para que não haja problemas. Depois de ligar a máquina, pressionamos "Excluir" e configuramos nossa unidade flash USB no menu "Inicialização" como o principal dispositivo de inicialização (por padrão, o UEFI Shell inicializa, mas não precisamos disso). Salvamos as alterações, reiniciamos o NAS e, se tudo for feito corretamente, vemos um menu familiar:</font></font><br>
<br>
<img src="https://habrastorage.org/files/145/570/2e1/1455702e1f1845a79781dfc2fcf7f1f7.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Você pode conectar o NAS ao ambiente de trabalho por qualquer meio: através de um roteador, switch, hub zero - tudo depende de suas necessidades pessoais. </font><font style="vertical-align: inherit;">Como você provavelmente deseja levar a máquina à sua rede doméstica, a melhor opção é um roteador, portanto, vamos configurar um endereço IP estático na etapa 2. Responda consistentemente às perguntas feitas pelo sistema:</font></font><br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deseja usar o DHCP para esta interface? </font><font style="vertical-align: inherit;">- Não (queremos definir um IP estático)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digite o novo endereço IPv4 da LAN - 192.168.1.250 (instalado por padrão, se já estiver sendo usado na sua rede - digite qualquer endereço gratuito)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digite a nova máscara de sub-rede da LAN - 24 (máscara de sub-rede 255.255.255.0)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digite o gateway padrão IPv4 - 192.168.1.1 (especifique o endereço do roteador)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Digite o endereço IPv4 do DNS - 192.168.1.1 (também especifique o endereço do roteador)</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deseja configurar o IPv6 para esta interface? </font><font style="vertical-align: inherit;">- Não (simplesmente não precisamos de uma rede doméstica IPv6)</font></font></li>
</ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Essa tela atesta a conclusão bem-sucedida da configuração: </font></font><br>
<br>
<img src="https://habrastorage.org/files/e11/c1a/3b2/e11c1a3b258a446984032148e61f0d6c.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é aqui que a preparação do NAS é concluída - agora você pode conectar o armazenamento à rede e prosseguir com a configuração.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Personalizar unidades</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Todas as operações são realizadas através da conveniente WebGUI - basta digitar o endereço IP que foi definido anteriormente (no nosso caso - 192.168.1.250) e imediatamente acessar o formulário de autorização: O </font></font><br>
<br>
<img src="https://habrastorage.org/files/844/ba8/a75/844ba8a75db746cc88c0d4ab6107eeff.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
login padrão é admin, a senha (quem pensaria) é nas4free. </font><font style="vertical-align: inherit;">Entre e veja o monitor do sistema: </font></font><br>
<br>
<img src="https://habrastorage.org/files/7ee/93c/0d5/7ee93c0d52084fdba42170d9f4a9be33.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos mudar para o excelente e poderoso imediatamente: vá para “Sistema” -&gt; “Geral” e altere o idioma para russo: </font></font><br>
<br>
<img src="https://habrastorage.org/files/6f7/99d/35b/6f799d35b471485697b7a7284a8e2589.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui você também pode definir um novo nome de usuário e senha para a interface da web. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos configurar os discos. </font><font style="vertical-align: inherit;">Vamos para a seção "Drives" -&gt; "Management" e ... não encontramos nada:</font></font><br>
<br>
<img src="https://habrastorage.org/files/fa5/4b0/53a/fa54b053a6a94984b083c298b52930f6.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Somente sem pânico - no NAS4Free você precisa fazer tudo com as mãos. </font><font style="vertical-align: inherit;">A opção mais fácil é clicar em "Limpar configuração e importar discos", mas eu recomendo clicar no sinal de mais azul à direita e adicionar unidades uma por vez. </font><font style="vertical-align: inherit;">O menu é o seguinte: </font></font><br>
<br>
<img src="https://habrastorage.org/files/aac/ab4/fc0/aacab4fc02874f59a086427a3ae2bcbd.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vamos percorrer as opções:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A descrição pode ser deixada em branco, eu dirigi com o nome abreviado do disco;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O modo de transferência deixa Auto;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Especifique o período de transferência das unidades para o modo de espera, dependendo de suas necessidades pessoais. </font><font style="vertical-align: inherit;">No entanto, isso deve ser levado em consideração: o reinício frequente nem é benéfico para o WD Re confiável, portanto, não faz sentido definir de 5 a 10 minutos - isso só acelera o desgaste do disco rígido;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gerenciamento de energia - defino o Nível 127 - uma troca entre desempenho e consumo de energia;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nível de ruído - não considero necessário usá-lo, pois o WD funciona muito silenciosamente;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se você deseja ativar o monitoramento SMART, marque a caixa;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como os discos são novos, deixamos Não formatado (não formatado) na última linha.</font></font></li>
</ol><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora clique no botão "Adicionar" e repita o procedimento para os discos restantes. </font><font style="vertical-align: inherit;">Você não precisa adicionar uma unidade flash para evitar mal-entendidos (formate-a com pressa e tudo terá que começar do zero). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Após todas as manipulações, vemos o seguinte no menu de configurações do disco: </font></font><br>
<br>
<img src="https://habrastorage.org/files/f7d/1d9/ca0/f7d1d9ca037f40d286c4fa1f4edf577b.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Leia o aviso na captura de tela. </font><font style="vertical-align: inherit;">Sim, esse é um recurso do NAS4Free: primeiro fazemos as configurações e depois confirmamos a escolha clicando em "Aplicar alterações" - você terá que se acostumar. </font><font style="vertical-align: inherit;">Depois disso, observamos o resultado de nossas ações: </font></font><br>
<br>
<img src="https://habrastorage.org/files/aef/a97/cd9/aefa97cd9662417f8a71903c3f408636.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se você deseja receber dados SMART monitorando o status dos discos, vá para a guia com o mesmo nome.</font></font><br>
<br>
<img src="https://habrastorage.org/files/972/633/2f8/9726332f81f54e4fbcc01c31ebf99db3.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Marque a caixa de seleção "Ativar", selecione o modo de energia em espera (para não perturbar os discos rígidos no modo de espera) e salve as alterações. Também há a capacidade de configurar alertas. Agora você pode visualizar dados detalhados de cada unidade na seção “Diagnósticos” -&gt; “Informações” -&gt; “SMART”, </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
portanto, ambas as unidades estão on-line, todos os sistemas funcionam bem. Mas este é apenas o começo da jornada. Vamos para a aba “HDD Formatting”. Como concordamos no início do artigo, usaremos o ZFS. Selecione as duas unidades e clique em "Avançar":</font></font><br>
<br>
<img src="https://habrastorage.org/files/1eb/08e/72e/1eb08e72e4b5475d872eaa8975b111ae.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na próxima etapa, defina o rótulo do volume - escolhi WDREZFS% 1. A construção de "% 1" significa que os discos que formatamos receberão números de série começando com um. Ou seja, o primeiro será nomeado WDREZFS1, o segundo - WDREZFS2, etc. Se você não especificar um ponto de partida, colocando um sinal de "%" sem um dígito, o próprio sistema numerará o HDD. Você também pode dar nomes por números de série. Por exemplo, "[4" significa que os últimos quatro dígitos do número de série serão usados ​​como etiqueta. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Além disso, eu recomendo marcar a caixa “Criando ZFS na partição GPT” se você estiver criando um pool complexo de vários discos, planejando adicionar novas unidades no futuro. </font></font><br>
<br>
<img src="https://habrastorage.org/files/191/bd3/bc8/191bd3bc8f494c89b9eb38abd80c8890.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Formaizamos os discos, aguardamos a conclusão da operação e clicamos no botão "OK".</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora precisamos construir um dispositivo virtual. Vá para "Drives" -&gt; "ZFS" -&gt; "Pools" -&gt; "Virtual Device", clique no sinal de mais azul e veja a seguinte imagem: </font></font><br>
<br>
<img src="https://habrastorage.org/files/90c/f28/391/90cf28391fee481b9fb04c0f94e72fb8.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui podemos coletar os discos em uma matriz. Como preciso de um análogo do RAID-1, selecionei “Mirror” (para referência, “Stripe” é essencialmente o mesmo RAID-0). Após confirmar a seleção, não se esqueça de aplicar as alterações: </font></font><br>
<br>
<img src="https://habrastorage.org/files/8b0/b18/5c7/8b0b185c703c4208b4ae127141cc9b47.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora vamos para a guia "Pools" e adicionamos um novo usando o dispositivo virtual recém-criado: </font></font><br>
<br>
<img src="https://habrastorage.org/files/44a/2ad/fa5/44a2adfa59424164917a37b8f5dc902d.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tudo o que é necessário é criar um nome, você não precisa configurar mais nada.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em princípio, você já pode começar a enviar arquivos, mas é melhor aproveitar a principal vantagem do ZFS - a capacidade de criar conjuntos de dados. Na verdade, eles são sistemas de arquivos subsidiários, portanto, temos a oportunidade de escolher um método de compactação para cada conjunto de dados, definir direitos de acesso e cotas de disco (o que elimina a situação em que sua coleção de vídeos consome com segurança todo o espaço livre para documentos) e, o mais importante - cria instantâneos que permitem recuperar quase instantaneamente as informações perdidas. Portanto, vamos aos "Conjuntos de dados" e criamos alguns: </font></font><br>
<br>
<img src="https://habrastorage.org/files/89f/4e1/1be/89f4e11be0744aeda26a792ef9bf26dd.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na captura de tela acima, o único pool é selecionado - WDREP e o método de compactação lzjb (um compromisso entre eficiência e desempenho). </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deduplicação de dados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deixe-o desligado, pois seu funcionamento adequado requer um mínimo de 16 gigabytes de RAM. O próprio termo denota um método de compactar uma matriz de dados eliminando cópias duplicadas. É útil, por exemplo, se você criar regularmente cópias de backup de grandes volumes de informações, enquanto a diferença entre eles for mínima. Se o NAS desempenhar apenas o papel de armazenamento de filmes, músicas, fotos e outros conteúdos de mídia, você simplesmente não perceberá os benefícios da duplicação, o que significa que não deve gastar dinheiro adicional em hardware. O restante das configurações são deixadas por padrão. A única coisa, para fins de demonstração, colocarei uma marca na frente de "Visibility Snapshots" - agora as imagens serão visíveis de outros dispositivos. No campo "Espaço reservado", você pode especificar o volume mínimo garantido do conjunto de dados, e "Cota" permite definir a barra superior.Abaixo, você pode selecionar usuários e configurar direitos de acesso:</font></font><br>
<br>
<img src="https://habrastorage.org/files/6ec/2ba/9d4/6ec2ba9d4925465faa41e66dfb7f324f.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da mesma maneira, você pode adicionar quantos conjuntos de dados desejar:</font></font><br>
<br>
<img src="https://habrastorage.org/files/466/fbd/283/466fbd2831a44e5a84b7745a1d27795f.JPG"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hora de fazer upload de arquivos</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O NAS está totalmente operacional, resta ensiná-lo a se comunicar com o mundo exterior. </font><font style="vertical-align: inherit;">Para isso, o sistema operacional oferece um conjunto muito impressionante de ferramentas para todos os gostos, localizado no menu "Serviços". </font><font style="vertical-align: inherit;">Do que você precisa - decida por si mesmo, agora vou me restringir à configuração básica do FTP: </font></font><br>
<br>
<img src="https://habrastorage.org/files/fba/8fa/c95/fba8fac9596241358493ce24f5630068.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Não se esqueça de marcar a caixa de seleção "Ativar" (por padrão, todos os serviços estão desativados). </font><font style="vertical-align: inherit;">O número de clientes é definido pelo número de dispositivos que entrarão em contato com o armazenamento simultaneamente (3 são relevantes para mim). </font><font style="vertical-align: inherit;">Eu recomendo deixar o número de conexões 2. Em seguida, o upload / download de arquivos será realizado em um fluxo, o que evitará a fragmentação e atingirá a velocidade máxima. </font><font style="vertical-align: inherit;">Salve as configurações e tente conectar-se ao NAS:</font></font><br>
<br>
<img src="https://habrastorage.org/files/052/afa/e33/052afae33a9942d9a619b994ea98ef44.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como você pode ver, o pool e os conjuntos de dados são apresentados na forma de diretórios, e os diretórios .zfs são exibidos nos quais os instantâneos serão salvos. E, parece-me, chegou a hora de falar sobre eles com mais detalhes. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Instantâneos - instantâneos de todo o pool ou do conjunto de dados selecionado. Sem entrar em detalhes, um instantâneo é a maneira mais rápida e "mais barata" de fazer backup em termos de espaço. Atualmente, a funcionalidade de gerenciamento de imagens implementada no WebGUI é um pouco limitada, mas é capaz de satisfazer totalmente as necessidades de um usuário comum. Quer mais - você precisa usar o console.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O NAS4Free suporta a criação manual e automática de instantâneos. Para tirar uma foto manualmente, vá para a guia "ZFS" -&gt; "Snapshots" -&gt; "Snapshot", clique no sinal de mais, especifique o caminho (por exemplo, criei o conjunto de dados do Music) e pense em um nome para a imagem futura: Uma </font></font><br>
<br>
<img src="https://habrastorage.org/files/7f9/b24/baa/7f9b24baa4654293b8c185dca3194338.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
marca de seleção na coluna "Recursive" ”Significa que serão criados instantâneos de todos os conjuntos de dados filhos no Music, se houver. O resultado será o seguinte: </font></font><br>
<br>
<img src="https://habrastorage.org/files/a55/41b/3fa/a5541b3fa5f54b359cae79e9825ddddc.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sim, isso não é um erro - um instantâneo não ocupa espaço livre até que os dados no conjunto de dados sejam alterados. Por exemplo, ele aumentará à medida que você exclui arquivos mp3 do Music. O processo de instantâneo pode ser automatizado na guia "Instantâneo automático".</font></font><br>
<br>
<img src="https://habrastorage.org/files/f4c/8b3/e4b/f4c8b3e4bdbf412a83c6072edce9cf48.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui, além das configurações discutidas acima, você pode escolher a hora em que a foto foi tirada e o período de armazenamento. Você não pode especificar um tipo diferente de diário aqui (isso é possível apenas através do console). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bem, digamos que você excluiu acidentalmente arquivos importantes. Como eles podem ser restaurados? Isso é feito criando clones. Vamos voltar para a guia "Instantâneo" e clicar no ícone de chave inglesa na frente do instantâneo. A seguinte janela será exibida: </font></font><br>
<br>
<img src="https://habrastorage.org/files/526/7dd/131/5267dd131142459faee1659b7a207e56.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui você precisa escolher o caminho no qual o clone será localizado. Obviamente, deve ser exclusivo e não repetir os nomes dos conjuntos de dados. Clique em "Executar" e verifique o resultado via FTP:</font></font><br>
<br>
<img src="https://habrastorage.org/files/ae5/e3e/771/ae5e3e77122a46cdb4a769a024e686a2.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como você pode ver, o clone do MusicSnap repete completamente o conteúdo do conjunto de dados original. </font><font style="vertical-align: inherit;">Agora você pode extrair os arquivos perdidos do clone e copiá-los novamente para o Music. </font><font style="vertical-align: inherit;">Após o clone poder ser excluído na mesma aba:</font></font><br>
<br>
<img src="https://habrastorage.org/files/c50/efe/325/c50efe325b014a7f99d97c77428886d2.JPG"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Toque final</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Portanto, o ZFS Mirror baseado no Western Digital Re praticamente indestrutível permite criar um NAS doméstico com confiabilidade bastante aceitável, apesar da falta de suporte ECC da placa-mãe. No entanto, há um ponto fraco no sistema descrito - uma unidade flash. A memória flash não pode ser considerada confiável, a menos que você use </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chips industriais</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mas o NAS4Free fornece um mecanismo muito conveniente para elevar o servidor do zero. Na seção "Sistema" - "Salvando / Restaurando", você pode obter o arquivo XML com as configurações com apenas um clique: </font></font><br>
<br>
<img src="https://habrastorage.org/files/da2/325/19b/da232519b3b347d3b2773b3b171972cb.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A criptografia de senha está opcionalmente disponível. Se a unidade flash falhar, tudo o que você precisa é instalar o sistema de maneira limpa e restaurar a configuração do arquivo. Todos os conjuntos e conjuntos de dados criados anteriormente, bem como as informações armazenadas, estarão disponíveis novamente.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na verdade, isso é tudo - o NAS doméstico está pronto para ir. </font><font style="vertical-align: inherit;">No momento, a montagem descrita acima me custa cerca de um mês, digerindo cerca de 500 gigabytes durante esse período. </font><font style="vertical-align: inherit;">Obviamente, isso está longe de ser um desgaste, no entanto, o armazenamento está funcionando perfeitamente, não houve problemas durante esse período. </font><font style="vertical-align: inherit;">E agora vou organizar um pouco de interação: escreva nos comentários quais recursos do NAS4Free você gostaria de ver ou quais soluções não-padrão você gostaria de implementar com base nele. </font><font style="vertical-align: inherit;">Assim, por exemplo, a   </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dispi estava</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interessada na possibilidade de criar um LAMP completo - o aplicativo foi aceito, embora eu não prometa a publicação em um futuro próximo.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt397575/">https://habr.com/ru/post/pt397575/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt397561/index.html">Audio Digest 9: Blogs sobre som, música e tecnologia de áudio</a></li>
<li><a href="../pt397563/index.html">A autenticidade do Código de Grolier, o quarto códice maia sobrevivente, é comprovada.</a></li>
<li><a href="../pt397565/index.html">Como a Lyft vê o transporte rodoviário em 10 anos</a></li>
<li><a href="../pt397567/index.html">No Nokia Bell Labs, eles conseguiram transmissão de dados a uma velocidade de 1 Tbit / s sobre fibra</a></li>
<li><a href="../pt397571/index.html">Tecido híbrido converte luz solar e energia mecânica em eletricidade</a></li>
<li><a href="../pt397577/index.html">Processador Terminator, Bender, Dandy e Apple 2: MOS 6502</a></li>
<li><a href="../pt397579/index.html">Histórico inesperado do microprocessador</a></li>
<li><a href="../pt397581/index.html">Chute agora! Com o Kickstarter, o futuro está mais próximo</a></li>
<li><a href="../pt397583/index.html">Uma reunião inesperada. Capítulo 4</a></li>
<li><a href="../pt397585/index.html">"Sim, você dirige!". Como os overclockers mudaram a indústria de computadores</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>