<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คธ ๐๐พ ๐จโ๐จโ๐ฆ ุงูุนู ุฐูู ุจููุณู ูููุงุก DNS ุนูู Node.JS ๐ฉ๐ผโ๐คโ๐ฉ๐ป ๐จ ๐ฐ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุญุฒูุฉ ููู ุงููุทุจุงุช ูู ูุฌููุนุฉ ุชูุฑุนุงุช ุจุนูุฏุฉ ุนู DNS ... 
 ู. ูุงุฌุงููู "ูุงููุช ูู ุงููุงุน" 

 ุนูุฏ ุชุทููุฑ ุชุทุจูู ุดุจูุฉ ุ ูุฏ ูููู ูู ุงูุถุฑูุฑู ูู ุจุนุถ ุงูุฃุญูุงู ุชุดุบููู ูุญ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุนู ุฐูู ุจููุณู ูููุงุก DNS ุนูู Node.JS</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440050/" style=";text-align:right;direction:rtl"><blockquote style=";text-align:right;direction:rtl"> ุญุฒูุฉ ููู ุงููุทุจุงุช ูู ูุฌููุนุฉ ุชูุฑุนุงุช ุจุนูุฏุฉ ุนู DNS ... <br>  <em>ู. ูุงุฌุงููู "ูุงููุช ูู ุงููุงุน"</em> </blockquote><p style=";text-align:right;direction:rtl">  ุนูุฏ ุชุทููุฑ ุชุทุจูู ุดุจูุฉ ุ ูุฏ ูููู ูู ุงูุถุฑูุฑู ูู ุจุนุถ ุงูุฃุญูุงู ุชุดุบููู ูุญูููุง ุ ูููู ุงููุตูู ุฅููู ุจุงุณุชุฎุฏุงู ุงุณู ูุฌุงู ุญูููู.  ุงูุญู ุงูููุงุณู ุงููุซุจุช ูู ุชุณุฌูู ุงููุฌุงู ูู ููู ุงููุถูููู.  ูุงูุต ุงููููุฌ ูู ุฃู ุงููุถูููู ูุญุชุงุฌูู ุฅูู ูุฑุงุณูุงุช ูุงุถุญุฉ ูุฃุณูุงุก ุงููุฌุงู ุ ุฃู  ูุง ูุฏุนู ุงููุฌูู.  ุฃู  ุฅุฐุง ูุงูุช ููุงู ูุฌุงูุงุช ูู ุงููููุฐุฌ: </p><br><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">dom1.example.com, dom2.example.com, dom3.example.com, ................ domN.example.com,</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุซู ูู ุงููุถูููู ุชุญุชุงุฌ ุฅูู ุชุณุฌูู ูู ูููู.  ูู ุจุนุถ ุงูุญุงูุงุช ุ ูุง ูุนุฑู ูุทุงู ุงููุณุชูู ุงูุซุงูุซ ููุฏููุง.  ููุงู ุฑุบุจุฉ (ุฃูุง ุฃูุชุจ ูููุณู ุ ูุฏ ูููู ุดุฎุต ูุง ุฃูู ูู ุงูุทุจูุนู) ุฃู ุฃุชูุฏู ุจุฎุท ูุซู ูุฐุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">*.example.com</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฏ ูููู ุญู ุงููุดููุฉ ูู ุงุณุชุฎุฏุงู ุฎุงุฏู DNS ุงูุฎุงุต ุจู ุ ูุงูุฐู ุณูุนุงูุฌ ุงูุทูุจุงุช ููููุง ููููุทู ุงููุญุฏุฏ.  ููุงู ูุซู ูุฐู ุงูุฎูุงุฏู ุ ูุฌุงููุฉ ุชูุงููุง ูุน ูุงุฌูุฉ ุฑุณูููุฉ ูุฑูุญุฉ ุ ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CoreDNS</a> .  ููููู ุฃูุถูุง ุชุบููุฑ ุณุฌูุงุช DNS ุนูู ุฌูุงุฒ ุงูุชูุฌูู.  ุฃุฎูุฑูุง ุ ุงุณุชุฎุฏู ุฎุฏูุฉ ูุซู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">xip.io</a> ุ ููู ููุณุช ุฎุงุฏู DNS ูุชูุงูู ุชูุงููุง ุ ูููููุง ูุซุงููุฉ ูุจุนุถ ุงูููุงู.  ุจุงุฎุชุตุงุฑ ุ ุชูุฌุฏ ุญููู ุฌุงูุฒุฉ ุ ููููู ุงุณุชุฎุฏุงููุง ูููุณ ุนูุงุก. </p><br><p style=";text-align:right;direction:rtl">  ููู ูุฐู ุงูููุงูุฉ ุชุตู ุทุฑููุฉ ุฃุฎุฑู - ูุชุงุจุฉ ุงูุฏุฑุงุฌุฉ ุงูุฎุงุตุฉ ุจู ุ ููู ููุทุฉ ุงูุงูุทูุงู ูุฅูุดุงุก ุฃุฏุงุฉ ูุซู ุชูู ุงููุฐููุฑุฉ ุฃุนูุงู.  ุณููุชุจ ูููู DNS ุงูุฎุงุต ุจูุง ุ ูุงูุฐู ุณูุณุชูุน ุฅูู ุงุณุชูุณุงุฑุงุช DNS ุงููุงุฑุฏุฉ ุ ูุฅุฐุง ูุงู ุงุณู ุงููุฌุงู ุงููุทููุจ ูู ุงููุงุฆูุฉ ุ ูุณูู ููุฑุฌุน ุนููุงู IP ุงููุญุฏุฏ ุ ูุฅุฐุง ูู ููู ูุฐูู ุ ูุณูู ูุทูุจ ูููู DNS ุฃุนูู ููุนูุฏ ุชูุฌูู ุงูุงุณุชุฌุงุจุฉ ุงููุณุชููุฉ ุฏูู ุชุบููุฑุงุช ูู ุงูุจุฑูุงูุฌ ุงูุทุงูุจ. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุช ููุณู ุ ููููู ุชุณุฌูู ุงูุทูุจุงุช ูุงูุฑุฏูุฏ ุงููุงุฑุฏุฉ ุนูููุง.  ูุธุฑูุง ูุฃู DNS ูุญุชุงุฌู ุงูุฌููุน - ุงููุชุตูุญุงุช ูุงููุฑุงุณูุงุช ูููุงูุญุฉ ุงูููุฑูุณุงุช ูุฎุฏูุงุช ูุธุงู ุงูุชุดุบูู ุ ููุง ุฅูู ุฐูู ุ ููุฏ ุชููู ูููุฏุฉ ููุบุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงููุจุฏุฃ ุจุณูุท.  ูู ุฅุนุฏุงุฏุงุช ุงุชุตุงู ุงูุดุจูุฉ ูู IPv4 ุ ูุบูุฑ ุนููุงู ุฎุงุฏู DNS ุฅูู ุนููุงู ุงูุฌูุงุฒ ูู ุฎูุงู ูููู DNS ุงูููุชูุจ ุฐุงุชู ุงูุชุดุบูู (127.0.0.1 ุ ุฅุฐุง ูู ูุนูู ุนูู ุงูุดุจูุฉ) ุ ููู ุฅุนุฏุงุฏุงุชู ุ ูุญุฏุฏ ุนููุงู ุฎุงุฏู DNS ุงูุฃุนูู.  ููุจุฏู ุฃู ูุฐุง ูู ุดูุก! </p><br><p style=";text-align:right;direction:rtl">  ูู ูุณุชุฎุฏู ุงููุธุงุฆู ุงูููุงุณูุฉ ูุญู ุฃุณูุงุก ุงููุทุงูุงุช <em>nslookup</em> ู <em>nsresol</em> ุ ูุฐูู ูู ุชุคุซุฑ ุฅุนุฏุงุฏุงุช ูุธุงู DNS ููุญุชููุงุช <em>ููู ุงููุถูููู</em> ุนูู ุชุดุบูู ุงูุจุฑูุงูุฌ.  ุงุนุชูุงุฏูุง ุนูู ุงููููู ุ ูุฏ ูููู ูููุฏูุง ุฃู ูุง ุ ุชุญุชุงุฌ ููุท ุฅูู ุชุฐูุฑ ูุฐุง.  ููุจุณุงุทุฉ ุ ูุญู ููุชุตุฑ ุนูู ุชูููุฐ ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ ููุณูุง: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฎุฏุงุน IP ููุท ูุณุฌูุงุช ุงูููุน A (ุนููุงู ุงููุถูู) ูุงููุฆุฉ IN (ุงูุฅูุชุฑูุช) </li><li style=";text-align:right;direction:rtl">  ุนูุงููู IP ุงููุฎุงุฏุนุฉ ููุท ุงูุฅุตุฏุงุฑ 4 </li><li style=";text-align:right;direction:rtl">  ุงุชุตุงู ููุทูุจุงุช ุงููุงุฑุฏุฉ ุงููุญููุฉ ุนุจุฑ UDP ููุท </li><li style=";text-align:right;direction:rtl">  ุงุชุตุงู ุฎุงุฏู DNS ุงูููุจุน ุนุจุฑ UDP ุฃู TLS </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู ููุงู ุงูุนุฏูุฏ ูู ูุงุฌูุงุช ุงูุดุจูุฉ ุ ุณูุชู ูุจูู ุงูุทูุจุงุช ุงููุญููุฉ ุงููุงุฑุฏุฉ ุนูู ุฃู ูููุง </li><li style=";text-align:right;direction:rtl">  ูุง ููุฌุฏ ุฏุนู EDNS </li></ul><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุญุฏูุซ ุนู ุงูุงุฎุชุจุงุฑุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ููุงู ุนุฏุฏ ูููู ูู ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ ูู ุงููุดุฑูุน.  ุตุญูุญ ุฃููู ูุนูููู ููููุง ูููุจุฏุฃ: ููุฏ ุฃุทููุชู ุ ูุฅุฐุง ุชู ุนุฑุถ ุดูุก ุนุงูู ูู ูุญุฏุฉ ุงูุชุญูู ุ ููู ุดูุก ุนูู ูุง ูุฑุงู ุ ูููู ุฅุฐุง ุญุฏุซ ุงุณุชุซูุงุก ุ ูููุงู ูุดููุฉ.  ูููู ุญุชู ูุซู ูุฐุง ุงูููุฌ ุงูุฎุฑูุงุก ูุณูุญ ูู ุจุชุญุฏูุฏ ููุงู ุงููุดููุฉ ุจูุฌุงุญ ุ ูุฐูู ุงููุญุฏุฉ. </p></div></div><br><h2 id="nachalo--server-na-53-m-portu" style=";text-align:right;direction:rtl">  ุงุจุฏุฃ - ุงูุฎุงุฏู ุนูู ุงููููุฐ 53 </h2><br><p style=";text-align:right;direction:rtl">  ููุจุฏุฃ.  ุจุงุฏุฆ ุฐู ุจุฏุก ุ ุชุญุชุงุฌ ุฅูู ุชุนููู ุงูุชุทุจูู ููุจูู ุงุณุชุนูุงูุงุช DNS ุงููุงุฑุฏุฉ.  ููุชุจ ุฎุงุฏู TCP ุจุณูุท ูุณุชูุน ุฅูู ุงููููุฐ 53 ููุณุฌู ุงูุงุชุตุงูุงุช ุงููุงุฑุฏุฉ.  ูู ุฎุตุงุฆุต ุงุชุตุงู ุงูุดุจูุฉ ุ ููุชุจ ุนููุงู ุฎุงุฏู DNS 127.0.0.1 ุ ููุทูู ุงูุชุทุจูู ุ ููุฐูุจ ุฅูู ุงููุชุตูุญ ูุนุฏุฉ ุตูุญุงุช - ู ... ุงูุตูุช ูู ูุญุฏุฉ ุงูุชุญูู ุ ูุนุฑุถ ุงููุณุชุนุฑุถ ุงูุตูุญุฉ ุจุดูู ุทุจูุนู.  ุญุณููุง ุ ูุบูุฑ TCP ุฅูู UDP ุ ูุจุฏุฃ ุ ูุฐูุจ ูู ุฎูุงู ุงููุชุตูุญ - ูู ุงููุชุตูุญ ููุฌุฏ ุฎุทุฃ ูู ุงูุงุชุตุงู ุ ุณูุจ ุจุนุถ ุงูุจูุงูุงุช ุงูุซูุงุฆูุฉ ูู ูุญุฏุฉ ุงูุชุญูู.  ูุฐูู ุ ูุฑุณู ุงููุธุงู ุงูุทูุจุงุช ุนุจุฑ UDP ุ ูุณูู ูุณุชูุน ุฅูู ุงูุงุชุตุงูุงุช ุงููุงุฑุฏุฉ ุนุจุฑ UDP ุนูู ุงููููุฐ 53.  ูุตู ุณุงุนุฉ ูู ุงูุนูู ุ ูููุง 15 ุฏูููุฉ google ููููุฉ ุฑูุน ุฎุงุฏู TCP ู UDP ุนูู NodeJS - ููููุง ุจุญู ูููุฉ ุญุฌุฑ ุงูุฃุณุงุณ ูููุดุฑูุน ุ ุงูุฐู ูุญุฏุฏ ูููู ุงูุชุทุจูู ูู ุงููุณุชูุจู.  ุงูููุฏ ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dgram = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'dgram'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> server = dgram.createSocket(<span class="hljs-string"><span class="hljs-string">'udp4'</span></span>); <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">function</span></span></span></span><span class="hljs-function"><span class="hljs-params">(</span></span></span><span class="hljs-function">) { </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">server</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">on</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'error'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, (err</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">`server error:\n</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${err.stack}</span></span></span><span class="hljs-string">`</span></span>); server.close(); }); server.on(<span class="hljs-string"><span class="hljs-string">'message'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (localReq, linfo) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(localReq); <span class="hljs-comment"><span class="hljs-comment">//            }); server.on('listening', () =&gt; { const address = server.address(); console.log(`server listening ${address.address}:${address.port}`); }); const localListenPort = 53; const localListenAddress = 'localhost'; server.bind(localListenPort, localListenAddress); // server listening 0.0.0.0:53 }());</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ุงููุงุฆูุฉ 1. ุงูุญุฏ ุงูุฃุฏูู ููุฑูุฒ ุงููุทููุจ ูุชููู ุงุณุชุนูุงูุงุช DNS ุงููุญููุฉ</em> </p><br><p style=";text-align:right;direction:rtl">  ุงูููุทุฉ ุงูุชุงููุฉ ูู ูุฑุงุกุฉ ุงูุฑุณุงูุฉ ูููู ูุง ุฅุฐุง ูุงู ูู ุงูุถุฑูุฑู ุฅุนุงุฏุฉ ุนููุงู IP ุงูุฎุงุต ุจูุง ุงุณุชุฌุงุจุฉู ูู ุ ุฃู ุจุจุณุงุทุฉ ูููู. </p><br><h2 id="dns-soobschenie" style=";text-align:right;direction:rtl">  ุฑุณุงูุฉ DNS </h2><br><p style=";text-align:right;direction:rtl">  ุชู ูุตู ุจููุฉ ุฑุณุงูุฉ DNS ูู RFC-1035.  ุชุชุจุน ูู ูู ุงูุทูุจุงุช ูุงูุงุณุชุฌุงุจุงุช ูุฐุง ุงููููู ุ ููู ุญูุซ ุงููุจุฏุฃ ุ ุชุฎุชูู ูู ุนูุงูุฉ ูุงุญุฏุฉ (ุญูู QR) ูู ุฑุฃุณ ุงูุฑุณุงูุฉ.  ุชุชุถูู ุงูุฑุณุงูุฉ ุฎูุณุฉ ุฃูุณุงู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">+---------------------+ | Header | +---------------------+ | Question | the question for the name server +---------------------+ | Answer | RRs answering the question +---------------------+ | Authority | RRs pointing toward an authority +---------------------+ | Additional | RRs holding additional information +---------------------+</code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ุจููุฉ (ููุงูู) ุฑุณุงุฆู DNS ุงูุนุงูุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://tools.ietf.org/html/rfc1035#section-4.1</a></em> </p><br><p style=";text-align:right;direction:rtl">  ุชุจุฏุฃ ุฑุณุงูุฉ DNS ุจุฑุฃุณ ุจุทูู ุซุงุจุช (ูุฐุง ูุง ูุณูู ูุณู <em>ุฑุฃุณ</em> ) ุ ูุงูุฐู ูุญุชูู ุนูู ุญููู ูู 1 ุจุช ุฅูู ูุญุฏุชู ุจุงูุช (ูุจุงูุชุงูู ุ ูููู ุฃู ุชุญุชูู ุจุงูุช ูุงุญุฏ ูู ุงูุฑุฃุณ ุนูู ุนุฏุฉ ุญููู).  ูุจุฏุฃ ุงูุนููุงู ุจุญูู ุงููุนุฑู - ูุฐุง ูู ูุนุฑูู ุงูุทูุจ 16 ุจุช ุ ููุฌุจ ุฃู ูููู ููุฑุฏ ููุณ ุงููุนุฑู.  ูููุง ููู ุงูุญููู ุงูุชู ุชุตู ููุน ุงูุทูุจ ููุชุงุฆุฌ ุชูููุฐู ูุนุฏุฏ ุงูุณุฌูุงุช ูู ูู ูุณู ูู ุงูุฃูุณุงู ุงูุชุงููุฉ ูู ุงูุฑุณุงูุฉ.  ุตููู ุฌููุนูุง ููุชุฑุฉ ุทูููุฉ ุ ูุฐุง ูู ููุชู - ุฌูุฏูุง ูู RFC: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://tools.ietf.org/html/rfc1035#section-4.1.1</a> .  ูุณู <em>ุงูุฑุฃุณ</em> ููุฌูุฏ ุฏุงุฆููุง ูู ุฑุณุงูุฉ DNS. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> 1 1 1 1 1 1 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+ | ID | +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+ |QR| Opcode |AA|TC|RD|RA| Z | RCODE | +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+ | QDCOUNT | +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+ | ANCOUNT | +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+ | NSCOUNT | +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+ | ARCOUNT | +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+</code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ูููู (ููุงูู) ุฑุฃุณ ุฑุณุงูุฉ DNS <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://tools.ietf.org/html/rfc1035#section-4.1.1</a></em> </p><br><h3 id="sekciya-question" style=";text-align:right;direction:rtl">  ูุณู ุงูุฃุณุฆูุฉ </h3><br><p style=";text-align:right;direction:rtl">  ูุญุชูู ูุณู <em>ุงูุฃุณุฆูุฉ</em> ุนูู ุฅุฏุฎุงู ูุฎุจุฑ ุงูุฎุงุฏู ุจุงูุชุญุฏูุฏ ุนู ุงููุนูููุงุช ุงููุทููุจุฉ ููู.  ูู ุงููุงุญูุฉ ุงููุธุฑูุฉ ุ ูู ูุณู ูุฐู ุงูุณุฌูุงุช ุ ูููู ุฃู ูููู ููุงู ุณุฌู ูุงุญุฏ ุฃู ุนุฏุฉ ุฃุฑูุงู ุ ูููุดุงุฑ ุฅูู ุฑูููุง ูู ุญูู QDCOUNT ูู ุฑุฃุณ ุงูุฑุณุงูุฉ ุ ููููู ุฃู ูููู 0 ุฃู 1 ุฃู ุฃูุซุฑ.  ูููู ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ูููู ุฃู ูุญุชูู ูุณู ุงูุฃุณุฆูุฉ ุนูู ุฅุฏุฎุงู ูุงุญุฏ ููุท.  ุฅุฐุง ุงุญุชูู ูุณู <em>ุงูุฃุณุฆูุฉ</em> ุนูู ุนุฏุฉ ุณุฌูุงุช ุ ููุฏ ูุคุฏู ุฃุญุฏูุง ุฅูู ุญุฏูุซ ุฎุทุฃ ุฃุซูุงุก ูุนุงูุฌุฉ ุงูุทูุจ ุนูู ุงูุฎุงุฏู ุ ูุณูุธูุฑ ูููู ุบูุฑ ูุญุฏุฏ.  ุนูู ุงูุฑุบู ูู ุฃู ุงูุฎุงุฏู ุณูุนูุฏ ุจุฑูุฒ ุฎุทุฃ ูู ุญูู RCODE ูู ุฑุณุงูุฉ ุงูุงุณุชุฌุงุจุฉ ุ ุฅูุง ุฃูู ูู ูููู ูุงุฏุฑูุง ุนูู ุงูุฅุดุงุฑุฉ ุนูุฏ ูุนุงูุฌุฉ ุงูุณุฌู ุงูุฐู ุญุฏุซุช ููู ุงููุดููุฉ ุ ูุง ุชูุถุญ ุงูููุงุตูุงุช ุฐูู.  ูุง ุชุญุชูู ุงูุณุฌูุงุช ุฃูุถูุง ุนูู ุญููู ุชุญุชูู ุนูู ุฅุดุงุฑุฉ ููุฎุทุฃ ูููุนู.  ูุฐูู ุ ููุงู ุงุชูุงููุฉ (ุบูุฑ ููุซูุฉ) ุ ูุงูุชู ุจููุฌุจูุง ูููู ุฃู ูุญุชูู ูุณู <em>ุงูุฃุณุฆูุฉ</em> ุนูู ุณุฌู ูุงุญุฏ ููุท ุ ูุญูู QDCOUNT ูู ูููุฉ 1. ููุง ุฃูู ููุณ ูู ุงููุงุถุญ ุชูุงููุง ููููุฉ ูุนุงูุฌุฉ ุงูุทูุจ ุนูู ุฌุงูุจ ุงูุฎุงุฏู ุ ุฅุฐุง ูุงู ูุง ูุฒุงู ูุญุชูู ุนูู ุนุฏุฉ ุณุฌูุงุช ูู <em>ุงูุณุคุงู</em> .  ููุตุญ ุดุฎุต ูุง ุจุฅุฑุฌุงุน ุฑุณุงูุฉ ุจูุง ุฎุทุฃ ูู ุงูุทูุจ.  ุนูู ุณุจูู ุงููุซุงู ุ ูุนุงูุฌ Google DNS ุงูุณุฌู ุงูุฃูู ููุท ูู ูุณู <em>ุงูุฃุณุฆูุฉ</em> ุ ุจู ูุชุฌุงูู ุงูุจุงูู.  ุนูู ูุง ูุจุฏู ุ ูุจูู ูุฐุง ููููุง ูุชูุฏูุฑ ูุทูุฑู ุฎุฏูุงุช DNS. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงุณุชุฌุงุจุฉ ุฑุณุงูุฉ DNS ูู ุงูุฎุงุฏู ุ ููุฌุฏ ูุณู <em>ุงูุณุคุงู</em> ุฃูุถูุง ููุฌุจ ูุณุฎ ูุณุฎุฉ <em>ุงูุณุคุงู</em> ุจุงููุงูู (ูุชุฌูุจ ุงูุชุนุงุฑุถุงุช ุ ูู ุญุงูุฉ ุนุฏู ููุงูุฉ ุญูู ูุนุฑู ูุงุญุฏ). </p><br><p style=";text-align:right;direction:rtl">  ูุญุชูู ุงูุฅุฏุฎุงู ุงููุญูุฏ ูู ูุณู <em>ุงูุฃุณุฆูุฉ</em> ุนูู ุงูุญููู: QNAME (ุงุณู ุงููุฌุงู) ุ QTYPE (ุงูููุน) ุ QCLASS (ุงููุฆุฉ).  QTYPE ู QCLASS ุนุจุงุฑุฉ ุนู ุฃุฑูุงู ูุฒุฏูุฌุฉ ุงูุจุงูุช ุชุดูุฑ ุฅูู ููุน ุงูุทูุจ ููุฆุฉ ุงูุทูุจ.  ูุชู ูุตู ุงูุฃููุงุน ูุงููุฆุงุช ุงููุญุชููุฉ ูู RFC-1035 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://tools.ietf.org/html/rfc1035#section-3.2</a> ุ ูู ุดูุก ูุงุถุญ ููุงู.  ููู ูููุง ูุชุนูู ุจุทุฑููุฉ ุชุณุฌูู ุงุณู ุงููุทุงู ุ ุณููุงูุด ุจูุฒูุฏ ูู ุงูุชูุตูู ูู ูุณู "ุชูุณูู ุชุณุฌูู ุฃุณูุงุก ุงููุทุงูุงุช". </p><br><p style=";text-align:right;direction:rtl">  ูู ุญุงูุฉ ูุฌูุฏ ุงุณุชุนูุงู ุ ุชูุชูู ุฑุณุงูุฉ DNS ุบุงูุจูุง ุจูุณู <em>ุงูุณุคุงู</em> ุ ูุฃุญูุงููุง ูุชุจุนูุง ุงููุณู <em>ุงูุฅุถุงูู</em> . </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ูุนุงูุฌุฉ ุงูุทูุจ ุนูู ุงูุฎุงุฏู (ุนูู ุณุจูู ุงููุซุงู ุ ุชู ุชุดููู ุทูุจ ูุงุฑุฏ ุจุดูู ุบูุฑ ุตุญูุญ) ุ ูุฅู ุฑุณุงูุฉ ุงูุงุณุชุฌุงุจุฉ ุณุชูุชูู ุฃูุถูุง ุจูุณู <em>ุงูุณุคุงู</em> ุฃู ุงููุณู <em>ุงูุฅุถุงูู</em> ุ ูุณูุญุชูู ุญูู RCODE ูุฑุฃุณ ุฑุณุงูุฉ ุงูุงุณุชุฌุงุจุฉ ุนูู ุฑูุฒ ุฎุทุฃ. </p><br><h3 id="sekcii-answer-authority-i-additional" style=";text-align:right;direction:rtl">  <em>ุงูุฅุฌุงุจุฉ</em> ุ <em>ุงูุณูุทุฉ ุ</em> ูุฃูุณุงู <em>ุฅุถุงููุฉ</em> </h3><br><p style=";text-align:right;direction:rtl">  ุงูุฃูุณุงู ุงูุชุงููุฉ ูู " <em>ุงูุฅุฌุงุจุฉ"</em> ู " <em>ุงูุตูุงุญูุฉ"</em> ู " <em>ุฅุถุงููุฉ"</em> (ูุชู ุชุถููู " <em>ุงูุฅุฌุงุจุฉ"</em> ู " <em>ุงูุชูููุถ"</em> ููุท ูู ุฑุณุงูุฉ DNS ุงูุฎุงุตุฉ ุจุงูุฑุฏ ุ ููุฏ ุชุธูุฑ " <em>ุฅุถุงููุฉ"</em> ูู ุงูุทูุจ ููู ุงูุฑุฏ).  ุฅููุง ุงุฎุชูุงุฑูุฉ ุ ุฃู  ูุฏ ูููู ุฃู ูููุง ุญุงุถุฑูุง ุฃู ูุง ุ ุญุณุจ ุงูุทูุจ.  ูุฐู ุงูุฃูุณุงู ููุง ููุณ ุงูุจููุฉ ูุชุญุชูู ุนูู ูุนูููุงุช ูู ุดูู ูุง ูุณูู "ุณุฌูุงุช ุงูููุงุฑุฏ" ( <em>ุณุฌู resourse</em> ุ ุฃู RR).  ุจุงููุนูู ุงููุฌุงุฒู ุ ูู ูุณู ูู ูุฐู ุงูุฃูุณุงู ุนุจุงุฑุฉ ุนู ูุฌููุนุฉ ูู ุณุฌูุงุช ุงูููุงุฑุฏ ุ ูุงูุณุฌู ุนุจุงุฑุฉ ุนู ูุงุฆู ุจู ุญููู.  ูููู ุฃู ูุญุชูู ูู ูุณู ุนูู ุณุฌู ูุงุญุฏ ุฃู ุฃูุซุฑ ุ ููุดุงุฑ ุฅูู ุฑูููู ูู ุงูุญูู ุงูููุงุจู ูู ุฑุฃุณ ุงูุฑุณุงูุฉ (ANCOUNT ุ NSCOUNT ุ ARCOUNT ุ ุนูู ุงูุชูุงูู).  ุนูู ุณุจูู ุงููุซุงู ุ ูุคุฏู ุทูุจ IP ุงูุฎุงุต ุจุงููุฌุงู "google.com" ุฅูู ุฅุฑุฌุงุน ุนุฏุฉ ุนูุงููู IP ุ ูุฐูู ุณูููู ููุงู ุฃูุถูุง ุนุฏุฉ ุฅุฏุฎุงูุงุช ูู ูุณู " <em>ุงูุฅุฌุงุจุฉ"</em> ุ ูุงุญุฏ ููู ุนููุงู.  ุฅุฐุง ูุงู ุงููุณู ุบุงุฆุจูุง ุ ูุณูุญุชูู ุญูู ุงูุฑุฃุณ ุงูููุงุจู ุนูู 0. </p><br><p style=";text-align:right;direction:rtl">  ูุจุฏุฃ ูู <em>ุณุฌู ููุฑุฏ</em> (RR) ุจุญูู NAME ูุญุชูู ุนูู ุงุณู ูุฌุงู.  ุชูุณูู ูุฐุง ุงูุญูู ูู ููุณู ุญูู QNAME ูู ูุณู <em>ุงูุฃุณุฆูุฉ</em> . <br>  ุจุฌุงูุจ NAME ุชูุฌุฏ ุงูุญููู TYPE (ููุน ุงูุณุฌู) ุ ู CLASS (ูุฆุชูุง) ุ ููุง ุงูุญูููู ุฑููู 16 ุจุช ุ ููุดูุฑ ุฅูู ููุน ุงูุณุฌู ููุฆุชู.  ูุดุจู ูุฐุง ุฃูุถูุง ูุณู <em>ุงูุฃุณุฆูุฉ</em> ุ ูุน ุงุฎุชูุงู ุฃู QTYPE ู QCLASS ูููู ุฃู ูููู ูููุง ููุณ ุงูููู ูุซู TYPE ู CLASS ุ ูุจุนุถููุง ุฎุงุต ุจููุง.  ูุฐุง ูู ุ ูู ูุบุฉ ุนูููุฉ ุฌุงูุฉ ุ ูุฌููุนุฉ ูู ุงูููู QTYPE ู QCLASS ูู ูุฌููุนุฉ ุดุงููุฉ ูู ุงูููู TYPE ู CLASS.  ุงูุฑุฃ ุงููุฒูุฏ ุญูู ุงูุงุฎุชูุงูุงุช ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://tools.ietf.org/html/rfc1035#section-3.2.2</a> . <br>  ุงูุญููู ุงููุชุจููุฉ ูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  TTL ูู ุฑูู 32 ุจุช ูุดูุฑ ุฅูู ุงูููุช ุงูุฐู ุงุณุชุบุฑูู ุงูุณุฌู (ุจุงูุซูุงูู). </li><li style=";text-align:right;direction:rtl">  RDLENGTH ูู ุฑูู 16 ุจุช ูุดูุฑ ุฅูู ุทูู ุญูู RDATA ุงูุชุงูู ุจุงูุจุงูุช. </li><li style=";text-align:right;direction:rtl">  RDATA ูู ูู ุงููุงูุน ุญูููุฉ ุ ููุนุชูุฏ ุงูุชูุณูู ุนูู ููุน ุงูุณุฌู.  ุนูู ุณุจูู ุงููุซุงู ุ ุจุงููุณุจุฉ ูุณุฌู ุงูููุน A (ุนููุงู ุงููุถูู) ูุงููุฆุฉ IN (ุงูุฅูุชุฑูุช) ุ ููุฐู ูู 4 ุจุงูุช ุชูุซู ุนููุงู IPv4. </li></ul><br><h2 id="format-zapisi-domennyh-imyon" style=";text-align:right;direction:rtl">  ุชูุณูู ุณุฌู ุงุณู ุงููุฌุงู </h2><br><p style=";text-align:right;direction:rtl">  ุชูุณูู ุชุณุฌูู ุฃุณูุงุก ุงููุทุงู ูู ููุณู ุจุงููุณุจุฉ ูุญููู QNAME ู NAME ุ ููุฐูู ุจุงููุณุจุฉ ูุญูู RDATA ุ ุฅุฐุง ูุงู CNAME ุฃู MX ุฃู NS ุฃู ุณุฌู ูุฆุฉ ุขุฎุฑ ููุชุฑุถ ุฃู ูููู ุงุณู ุงููุฌุงู ูู ุงููุชูุฌุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงุณู ุงููุทุงู ูู ุณูุณูุฉ ูู ุงูุชุณููุงุช (ุฃูุณุงู ุงูุงุณู ุ ูุงููุทุงูุงุช ุงููุฑุนูุฉ - ูุฐู <strong>ุชุณููุฉ</strong> ุจุงููุบุฉ ุงูุฃุตููุฉ ุ ููู ุฃุฌุฏ ุชุฑุฌูุฉ ุฃูุถู).  ุงูุชุณููุฉ ุนุจุงุฑุฉ ุนู ุจุงูุช ูุงุญุฏ ูู ุงูุทูู ูุญุชูู ุนูู ุฑูู - ุทูู ูุญุชููุงุช ุงูุชุณููุฉ ุจุงูุจุงูุช ุ ูุชุจูุนูุง ุจุชุณูุณู ุจุงูุช ูู ุงูุทูู ุงููุญุฏุฏ.  ุชุชุจุน ุงูููุตูุงุช ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู ุญุชู ูุชู ุงูุนุซูุฑ ุนูู ุจุงูุช ุทููู ูุญุชูู ุนูู 0. ูููู ุฃู ูููู ุงูุชุตููู ุงูุฃูู ุนูู ุงูููุฑ ุจุทูู ุงูุตูุฑ ุ ููุฐุง ูุดูุฑ ุฅูู ูุฌุงู ุงูุฌุฐุฑ (ูุฌุงู ุงูุฌุฐุฑ) ุจุงุณู ูุฌุงู ูุงุฑุบ (ุชุชู ูุชุงุจุชู ุฃุญูุงููุง ุจุงุณู ""). </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุฅุตุฏุงุฑุงุช ุงูุณุงุจูุฉ ูู DNS ุ ูููู ุฃู ูููู ููุจุงูุชุงุช ูู ุงูุชุตููู ุฃู ูููุฉ ูู (0 ุฅูู 255).  ูุงูุช ููุงู ููุงุนุฏ ุฐุงุช ุทุจูุนุฉ ุชูุตูุฉ ุนุงุฌูุฉ: ุฃู ุชุจุฏุฃ ุงูุชุณููุฉ ุจุญุฑู ุ ูุชูุชูู ุจุญุฑู ุฃู ุฑูู ุ ูุชุญุชูู ููุท ุนูู ุฃุญุฑู ุฃู ุฃุฑูุงู ุฃู ูุงุตูุงุช ูู ุชุฑููุฒ ASCII ุฐู 7 ุจุชุงุช ุ ูุน ุตูุฑ ุจุช ููู.  ุชุชุทูุจ ููุงุตูุงุช EDNS ุงูุญุงููุฉ ุจุงููุนู ุงูุงูุชุซุงู ููุฐู ุงูููุงุนุฏ ุจูุถูุญ ุ ุฏูู ุงูุญุฑุงู. </p><br><p style=";text-align:right;direction:rtl">  ูุชู ุงุณุชุฎุฏุงู ุงูุจุชุงุช ุงูุฃูุซุฑ ุฃูููุฉ ูู ุงูุจุงูุช ุงูุทูู ูุณูุฉ ููุน ุนูุงูุฉ.  ุฅุฐุง ูุงูุช ุตูุฑูุฉ ( <em>0b00xxxxxx</em> ) ุ ููุฐู ุชุณููุฉ ุนุงุฏูุฉ ุ ูุชุดูุฑ ุงูุจุชุงุช ุงููุชุจููุฉ ูู ุจุงูุช ุงูุทูู ุฅูู ุนุฏุฏ ุจุงูุชุงุช ุงูุจูุงูุงุช ุงููุถููุฉ ูู ุชูููููุง.  ุงูุญุฏ ุงูุฃูุตู ูุทูู ุงูุชุณููุฉ ูู 63 ุญุฑููุง.  63 ูู ุงูุชุฑููุฒ ุงูุซูุงุฆู ูู <em>0b00111111</em> ููุท. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงู <em>ุงูุจุงูุชุงู</em> ุงูุฃูุซุฑ ุฃูููุฉ ููุง 0 ู 1 ( <em>0b01xxxxxx</em> ) ุ <em>ุนูู ุงูุชูุงูู</em> ุ ููุฐุง ูุนุฏ ุชุณููุฉ ูู ุงูููุน ุงูููุชุฏ ููุนูุงุฑ EDNS ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://tools.ietf.org/html/rfc2671#section-3.1</a> ) ุ ูุงูุชู ุฌุงุกุช ุฅูููุง ูู 1 ูุจุฑุงูุฑ 2019.  ุณุชุญุชูู ุงูุจุชุงุช ุงูุณุชุฉ ุงูุฃุฏูู ุนูู ูููุฉ ุงูุชุณููุฉ.  ูุญู ูุง ููุงูุด EDNS ูู ูุฐู ุงูููุงูุฉ ุ ูููู ูู ุงููููุฏ ูุนุฑูุฉ ุฃู ูุฐุง ูุญุฏุซ ุฃูุถูุง. </p><br><p style=";text-align:right;direction:rtl">  ูุฒูุฌ ูู ุงุซููู ูู ุฃูู ุงูุจุชุงุช ุ ุฃู ูุง ูุนุงุฏู 1 ู 0 ( <em>0b10xxxxxx</em> ) ุ ูุญููุธุฉ ููุงุณุชุฎุฏุงู ูู ุงููุณุชูุจู. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูุงูุช ููุชุง ุงูุจุชุงุช ุงูุนุงููุฉ ุชุณุงูู 1 ( <em>0b11xxxxxx</em> ) ุ ููุฐุง ูุนูู ุฃู ุฃุณูุงุก ุงููุทุงู ูุถุบูุทุฉ ( <em>ุถุบุท</em> ) ุ <em>ูุณูุชูุงูู</em> ูุฐุง ุจูุฒูุฏ ูู ุงูุชูุงุตูู. </p><br><h3 id="szhatie-domennyh-imyon" style=";text-align:right;direction:rtl">  ุถุบุท ุงุณู ุงููุฌุงู </h3><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุฅุฐุง ูุงูุช ุงูุจุงูุชุฉ ุฐุงุช ุงูุทูู ุจูุง ุงุซููู ูู ุงูุจุชุงุช ุงูุนุงููุฉ ุชุณุงูู 1 ( <em>0b11xxxxxx</em> ) ุ ููุฐู ุนูุงูุฉ ุนูู ุถุบุท ุงุณู ุงููุฌุงู.  ูุณุชุฎุฏู ุงูุถุบุท ูุฌุนู ุงูุฑุณุงุฆู ุฃูุตุฑ ูุฃูุซุฑ ุฅูุฌุงุฒูุง.  ูุฐุง ุตุญูุญ ุจุดูู ุฎุงุต ุนูุฏ ุงูุนูู ุนูู UDP ุ ุนูุฏูุง ููุชุตุฑ ุงูุทูู ุงูุฅุฌูุงูู ูุฑุณุงูุฉ DNS ุนูู 512 ุจุงูุช (ุนูู ุงูุฑุบู ูู ุฃู ูุฐุง ูู ุงููุนูุงุฑ ุงููุฏูู ุ ุฑุงุฌุน <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://tools.ietf.org/html/rfc1035#section-2.3.4</a> ุญุฏูุฏ ุงูุญุฌู</em> ุ EDNS ุงูุฌุฏูุฏุฉ ูุณูุญ ุจุฅุฑุณุงู ุฑุณุงุฆู UPD ูุฃุทูู).  ูููู ุฌููุฑ ุงูุนูููุฉ ูู ุฃูู ุฅุฐุง ูุงูุช ุฑุณุงูุฉ DNS ุชุญุชูู ุนูู ุฃุณูุงุก ูุฌุงู ููุง ููุณ ุงููุทุงูุงุช ุงููุฑุนูุฉ ุฐุงุช ุงููุณุชูู ุงูุฃุนูู (ุนูู ุณุจูู ุงููุซุงู ุ <em>mail.yandex.ru</em> ู <em>yandex.ru</em> ) ุ ูุจุฏูุงู ูู ุฅุนุงุฏุฉ ุชุญุฏูุฏ ุงุณู ุงููุฌุงู ุจุงููุงูู ุ ุฑูู ุงูุจุงูุช ูู ุฑุณุงูุฉ DNS ุงูุชู ูููุง ููุงุตูุฉ ุงููุฑุงุกุฉ ุงุณู ุงููุฌุงู.  ูููู ุฃู ูููู ูุฐุง ุฃู ุจุงูุช ูู ุฑุณุงูุฉ DNS ุ ููุณ ููุท ูู ุงูุณุฌู ุฃู ุงููุณู ุงูุญุงูู ุ ูููู ุจุดุฑุท ุฃู ูููู ุจุงูุช ูุทูู ุชุณููุฉ ุงููุฌุงู.  ูุง ููููู ุงูุฑุฌูุน ุฅูู ููุชุตู ุงูุนูุงูุฉ.  ูููุชุฑุถ ูุฌูุฏ ูุฌุงู <em>mail.yandex.ru</em> ูู ุงูุฑุณุงูุฉ ุ ุซู ุจูุณุงุนุฏุฉ ุงูุถุบุท ุ ููููู ุฃูุถูุง ุชุนููู ูุทุงูุงุช <em>yandex.ru</em> ู <em>ru</em> ู root (ุจุงูุทุจุน ุ ูู ุงูุณูู ุงููุชุงุจุฉ ุงูุฌุฐุฑ ุฏูู ุถุบุท ุ ููู ูู ุงููููู ุชููููุง ุงูููุงู ุจุฐูู ุจุงุณุชุฎุฏุงู ุงูุถุบุท) ุ ููุง ูุฌุนู <em>ndex.ru</em> ูู ุชุนูู.  ุฃูุถูุง ุ ุณุชูุชูู ุฌููุน ุฃุณูุงุก ุงููุทุงูุงุช ุงููุณุชูุฏุฉ ูู ูุฌุงู ุงูุฌุฐุฑ ุ ุฃู ุ ุงููุชุงุจุฉ ุ ุนูู ุณุจูู ุงููุซุงู ุ <em>mail.yandex</em> ุณุชูุดู ุฃูุถูุง. </p><br><p style=";text-align:right;direction:rtl">  ุงุณู ุงููุฌุงู ููููู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃู ุชููู ูุณุฌูุฉ ุจุงููุงูู ุฏูู ุถุบุท ุ </li><li style=";text-align:right;direction:rtl">  ุชุจุฏุฃ ูู ุงูููุงู ุงูุฐู ูุณุชุฎุฏู ุงูุถุบุท </li><li style=";text-align:right;direction:rtl">  ุงุจุฏุฃ ุจุชุณููุฉ ูุงุญุฏุฉ ุฃู ุฃูุซุฑ ุจุฏูู ุถุบุท ุ ุซู ุงูุชูู ุฅูู ุงูุถุบุท ุ </li><li style=";text-align:right;direction:rtl">  ุชููู ูุงุฑุบุฉ (ูููุฌุงู ุงูุฌุฐุฑ). </li></ul><br><p style=";text-align:right;direction:rtl">  ุนูู ุณุจูู ุงููุซุงู ุ ูููู ุจุชุฌููุน ุฑุณุงูุฉ DNS ุ ููุฏ ุตุงุฏููุง ุจุงููุนู ุงุณู "dom3.example.com" ูููุง ุ ูุงูุขู ูุญุชุงุฌ ุฅูู ุชุญุฏูุฏ "dom4.dom3.example.com".  ูู ูุฐู ุงูุญุงูุฉ ุ ููููู ุชุณุฌูู ูุณู "dom4" ุจุฏูู ุถุบุท ุ ุซู ุงูุชุจุฏูู ุฅูู ุถุบุท ุ ุฃู ุฅุถุงูุฉ ุฑุงุจุท ุฅูู "dom3.example.com".  ุฃู ุจุงูุนูุณ ุ ุฅุฐุง ูุงู ุงูุงุณู "dom4.dom3.example.com" ูุฏ ุชูุช ูุตุงุฏูุชู ูุณุจููุง ุ ุซู ููุฅุดุงุฑุฉ ุฅูู "dom3.example.com" ููููู ุงุณุชุฎุฏุงู ุงูุถุบุท ุนูู ุงูููุฑ ุจุงูุฑุฌูุน ุฅูู ุงูุชุตููู "dom3" ููู.  ูุง ูุง ูููููุง ูุนูู ูู ุ ููุง ููู ุจุงููุนู ุ ุงูุฅุดุงุฑุฉ ุฅูู ุฌุฒุก "dom4.dom3" ูู ุฎูุงู ุงูุถุบุท ุ ูุฃู ุงูุงุณู ูุฌุจ ุฃู ููุชูู ุจูุณู ุงููุณุชูู ุงูุฃุนูู.  ุฅุฐุง ููุช ุจุญุงุฌุฉ ูุฌุฃุฉ ุฅูู ุชุญุฏูุฏ ุดุฑุงุฆุญ ูู ุงููุณุท ุ ูุณูุชู ุงูุฅุดุงุฑุฉ ุฅูููุง ุจุจุณุงุทุฉ ุฏูู ุถุบุท. </p><br><p style=";text-align:right;direction:rtl">  ููุจุณุงุทุฉ ุ ูุง ูุนุฑู ุจุฑูุงูุฌูุง ููููุฉ ูุชุงุจุฉ ุฃุณูุงุก ุงููุทุงูุงุช ุจุงูุถุบุท ุ ุจู ููููู ุงููุฑุงุกุฉ ููุท.  ุงููุนูุงุฑ ูุณูุญ ุจุฐูู ุ ูุฌุจ ุชูููุฐ ุงููุฑุงุกุฉ ุจุงูุถุฑูุฑุฉ ุ ูุงููุชุงุจุฉ ุงุฎุชูุงุฑูุฉ.  ูู ุงููุงุญูุฉ ุงููููุฉ ุ ูุชู ุชูููุฐ ุงููุฑุงุกุฉ ุนูู ูุฐุง ุงููุญู: ุฅุฐุง ูุงูุช ุงูุจุชุงุช ุงูุฃูุซุฑ ุฏูุงูุฉ ูู ุงูุจุงูุชุฉ ุงูุทูููุฉ ุชุญุชูู ุนูู 1 ุ ูุณููุฑุฃ ุงูุจุงูุช ุงูุฐู ูุชุจุนู ุ ููุชุนุงูู ูุน ูุงุชูู ุงูุจุงูุชุชูู ูุนุฏุฏ ุตุญูุญ ุบูุฑ ูููููุน 16 ุจุช ุ ุจุชุฑุชูุจ ุงูุจุชุงุช End End ุงููุจูุฑุฉ.  ูุญู ูุชุฌุงูู ุฃูู ุงุซููู ูู ุงูุจุชุงุช (ุชุญุชูู ุนูู 1) ุ ููุฑุงุกุฉ ุงูุฑูู 14 ุจุช ุงููุงุชุฌ ุ ูููุงุตูุฉ ูุฑุงุกุฉ ุงุณู ุงููุฌุงู ูู ุงูุจุงูุช ูู ุฑุณุงูุฉ DNS ุชุญุช ุงูุฑูู ุงูููุงุจู ููุฐุง ุงูุฑูู. </p><br><p style=";text-align:right;direction:rtl">  ุฑูุฒ ูุธููุฉ ูุฑุงุกุฉ ุงุณู ุงููุฌุงู ูู ููุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">readDomainName</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">buf, startOffset, objReturnValue = {}</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> currentByteIndex = startOffset; <span class="hljs-comment"><span class="hljs-comment">//    ,  DNS- ,      let initOctet = buf.readUInt8(currentByteIndex); let domain = ''; //      , ..       0, //  ,      // "the root domain name has no labels." (c) RFC-1035, p. 4.1.4. Message compression objReturnValue['endOffset'] = currentByteIndex; let lengthOctet = initOctet; while (lengthOctet &gt; 0) { //     var label; if (lengthOctet &gt;= 192) { //   :  0b1100 0000   const pointer = buf.readUInt16BE(currentByteIndex) - 49152; // 49152 === 0b1100 0000 0000 0000 === 192 * 256 const returnValue = {} label = readDomainName(buf, pointer, returnValue); domain += ('.' + label); objReturnValue['endOffset'] = currentByteIndex + 1; //      ,      break; } else { currentByteIndex++; label = buf.toString('ascii', currentByteIndex, currentByteIndex + lengthOctet); domain += ('.' + label); currentByteIndex += lengthOctet; lengthOctet = buf.readUInt8(currentByteIndex); objReturnValue['endOffset'] = currentByteIndex; } } return domain.substring(1); //    โ  "." }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  <em>ุณุฑุฏ 2. ูุฑุงุกุฉ ุฃุณูุงุก ุงููุฌุงู ูู ุงุณุชุนูุงู DNS</em> </p><br><p style=";text-align:right;direction:rtl">  ุฑูุฒ ูุงูู ููุธููุฉ ููุฑุงุกุฉ ุณุฌู DNS ูู ุงููุฎุฒู ุงููุคูุช ุงูุซูุงุฆู: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุณุฑุฏ 3. ูุฑุงุกุฉ ุณุฌู DNS ูู ุงููุฎุฒู ุงููุคูุช ุซูุงุฆู</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parseDnsMessageBytes</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">buf</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> msgFields = {}; <span class="hljs-comment"><span class="hljs-comment">// (c) RFC 1035 p. 4.1.1. Header section format msgFields['ID'] = buf.readUInt16BE(0); const byte_2 = buf.readUInt8(2); //  #2 (starting from 0) const mask_QR = 0b10000000; msgFields['QR'] = !!(byte_2 &amp; mask_QR); //  : 0 "false" =&gt; , 1 "true" =&gt;  const mask_Opcode = 0b01111000; const opcode = (byte_2 &amp; mask_Opcode) &gt;&gt;&gt; 3; //   (): 0, 1, 2,   msgFields['Opcode'] = opcode; const mask_AA = 0b00000100; msgFields['AA'] = !!(byte_2 &amp; mask_AA); const mask_TC = 0b00000010; msgFields['TC'] = !!(byte_2 &amp; mask_TC); const mask_RD = 0b00000001; msgFields['RD'] = !!(byte_2 &amp; mask_RD); const byte_3 = buf.readUInt8(3); //  #3 const mask_RA = 0b10000000; msgFields['RA'] = !!(byte_3 &amp; mask_RA); const mask_Z = 0b01110000; msgFields['Z'] = (byte_3 &amp; mask_Z) &gt;&gt;&gt; 4; //  0,  const mask_RCODE = 0b00001111; msgFields['RCODE'] = (byte_3 &amp; mask_RCODE); // 0 =&gt; no error; (dec) 1, 2, 3, 4, 5 - errors, see RFC msgFields['QDCOUNT'] = buf.readUInt16BE(4); //     Question,   0  1 msgFields['ANCOUNT'] = buf.readUInt16BE(6); //     Answer msgFields['NSCOUNT'] = buf.readUInt16BE(8); //     Authority msgFields['ARCOUNT'] = buf.readUInt16BE(10); //     Additional //    Question let currentByteIndex = 12; //  Question   12-  DNS- (c) RFC 1035 p. 4.1.2. Question section format msgFields['questions'] = []; for (let qdcount = 0; qdcount &lt; msgFields['QDCOUNT']; qdcount++) { const question = {}; const resultByteIndexObj = { endOffset: undefined }; const domain = readDomainName(buf, currentByteIndex, resultByteIndexObj); currentByteIndex = resultByteIndexObj.endOffset + 1; question['domainName'] = domain; question['qtype'] = buf.readUInt16BE(currentByteIndex); // 1 =&gt; "A" record currentByteIndex += 2; question['qclass'] = buf.readUInt16BE(currentByteIndex); // 1 =&gt; "IN" Internet currentByteIndex += 2; msgFields['questions'].push(question); } // (c) RFC 1035 p. 4.1.3. Resource record format //    (Resourse Records, RR)  Answer, Authority, Additional ['answer', 'authority', 'additional'].forEach(function(section, i, arr) { let msgFieldsName, countFieldName; switch(section) { case 'answer': msgFieldsName = 'answers'; countFieldName = 'ANCOUNT'; break; case 'authority': msgFieldsName = 'authorities'; countFieldName = 'NSCOUNT'; break; case 'additional': msgFieldsName = 'additionals'; countFieldName = 'ARCOUNT'; break; } msgFields[msgFieldsName] = []; for (let recordsCount = 0; recordsCount &lt; msgFields[countFieldName]; recordsCount++) { let record = {}; const objReturnValue = {}; const domain = readDomainName(buf, currentByteIndex, objReturnValue); currentByteIndex = objReturnValue['endOffset'] + 1; record['domainName'] = domain; record['type'] = buf.readUInt16BE(currentByteIndex); // 1 =&gt; "A" record currentByteIndex += 2; record['class'] = buf.readUInt16BE(currentByteIndex); // 1 =&gt; "IN" Internet currentByteIndex += 2; // TTL  4  record['ttl'] = buf.readUIntBE(currentByteIndex, 4); currentByteIndex += 4; record['rdlength'] = buf.readUInt16BE(currentByteIndex); currentByteIndex += 2; const rdataBinTempBuf = buf.slice(currentByteIndex, currentByteIndex + record['rdlength']); record['rdata_bin'] = Buffer.alloc(record['rdlength'], rdataBinTempBuf); if (record['type'] === 1 &amp;&amp; record['class'] === 1) { //      IPv4,      let ipStr = ''; for (ipv4ByteIndex = 0; ipv4ByteIndex &lt; 4; ipv4ByteIndex++) { ipStr += '.' + buf.readUInt8(currentByteIndex).toString(); currentByteIndex++; } record['IPv4'] = ipStr.substring(1); //    '.' } else { //    ,   currentByteIndex += record['rdlength']; } msgFields[msgFieldsName].push(record); } }); return msgFields; }</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุฑุฏ 3. ูุฑุงุกุฉ ุณุฌู DNS ูู ุงููุฎุฒู ุงููุคูุช ุซูุงุฆู</font></font></em> </p></div></div><br><p style=";text-align:right;direction:rtl"> ,       . ,     ,   ,    .   ,     DNS-,     ,   .  ,       . </p><br><p style=";text-align:right;direction:rtl">  ,        - <code>server.on("message", () =&gt; {})</code>   1.   : </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"> 4.    DNS-</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs">server.on(<span class="hljs-string"><span class="hljs-string">'message'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> (localReq, linfo) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> dnsRequest = functions.parseDnsMessageBytes(localReq); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> question = dnsRequest.questions[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// currently, only one question per query is supported by DNS implementations let forgingHostParams = undefined; // ,         IP for (let i = 0; i &lt; config.requestsToForge.length; i++) { const requestToForge = config.requestsToForge[i]; const targetDomainName = requestToForge.hostName; if (functions.domainNameMatchesTemplate(question.domainName, targetDomainName) &amp;&amp; question.qclass === 1 &amp;&amp; question.qtype === 1) { forgingHostParams = requestToForge; break; } } //  ,    DNS-      if (!!forgingHostParams) { const forgeIp = forgingHostParams.ip; const answers = []; answers.push({ domainName: question.domainName, type: question.qtype, class: question.qclass, ttl: forgedRequestsTTL, rdlength: 4, rdata_bin: functions.ip4StringToBuffer(forgeIp), IPv4: forgeIp }); const localDnsResponse = { ID: dnsRequest.ID, QR: dnsRequest.QR, Opcode: dnsRequest.Opcode, AA: dnsRequest.AA, TC: false, // dnsRequest.TC, RD: dnsRequest.RD, RA: true, Z: dnsRequest.Z, RCODE: 0, // dnsRequest.RCODE, 0 - no errors, look in RFC-1035 for other error conditions QDCOUNT: dnsRequest.QDCOUNT, ANCOUNT: answers.length, NSCOUNT: dnsRequest.NSCOUNT, ARCOUNT: dnsRequest.ARCOUNT, questions: dnsRequest.questions, answers: answers } //     DNS-    const responseBuf = functions.composeDnsMessageBin(localDnsResponse); console.log('response composed for: ', localDnsResponse.questions[0]); server.send(responseBuf, linfo.port, linfo.address, (err, bytes) =&gt; {}); } // ,     DNS-,         else { //     DNS-  UDP,     const responseBuf = await functions.getRemoteDnsResponseBin(localReq, upstreamDnsIP, upstreamDnsPort); //        server.send(responseBuf, linfo.port, linfo.address, (err, bytes) =&gt; {}); //     DNS-  TLS,   , .  9 } });</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ุณุฑุฏ 4. ูุนุงูุฌุฉ ุงุณุชุนูุงู DNS ูุงุฑุฏ</font></font></em> </p></div></div><br><h2 id="dobavlyaem-podderzhku-tls" style=";text-align:right;direction:rtl">   TLS </h2><br><p style=";text-align:right;direction:rtl">        DNS-.    ,      DNS-   TLS (HTTPS    ).  DNS-  TLS     TCP,    ,   TLS    .          TCP,   RFC-7766 DNS Transport over TCP ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://tools.ietf.org/html/rfc7766</a> ).    ,  :      TLS,   TCP   ( ,       DNS  TCP,      TLS-  TCP-,     ). </p><br><h3 id="ustanovka-tls-soedineniya" style=";text-align:right;direction:rtl">  TLS- </h3><br><p style=";text-align:right;direction:rtl">  TLS-           ,       ,   .  ,         TLS-,       .  RFC-7858 -        : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">In order to amortize TCP and TLS connection setup costs, clients and servers SHOULD NOT immediately close a connection after each response. Instead, clients and servers SHOULD reuse existing connections for subsequent queries as long as they have sufficient resources. In some cases, this means that clients and servers may need to keep idle connections open for some amount of time. () https://tools.ietf.org/html/rfc7858#section-3.4</code> </pre> <br><p style=";text-align:right;direction:rtl">       ,   TLS-,   ,     ,   ,   ,       .   ,        30 ,   ,      ,        DNS-.  30  ~  ~   ,   15  60 ,         .        ,         .   - . </p><br><p style=";text-align:right;direction:rtl"> TLS-     NodeJS.    ,    TLS-     : </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> tls = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'tls'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> TLS_SOCKET_IDLE_TIMEOUT = <span class="hljs-number"><span class="hljs-number">30000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    ,     TLS- function Module(connectionOptions, funcOnData, funcOnError, funcOnClose, funcOnEnd) { let socket; function connect() { socket = tls.connect(connectionOptions, () =&gt; { console.log('client connection established:', socket.authorized ? 'authorized' : 'unauthorized'); }); socket.on('data', funcOnData); // connection.on('end', () =&gt; {}); socket.on('close', (hasTransmissionError) =&gt; { //   ,     . //   ,     console.log('connection closed; transmission error:', hasTransmissionError); }); socket.on('end', () =&gt; { console.log('remote TLS server connection closed.') }); socket.on('error', (err) =&gt; { console.log('connection error:', err); console.log('\tmessage:', err.message); console.log('\tstack:', err.stack); }) socket.setTimeout(TLS_SOCKET_IDLE_TIMEOUT); socket.on('timeout', () =&gt; { console.log('socket idle timeout, disconnected.'); socket.end(); }); } this.write = function (dataBuf) { if (socket &amp;&amp; socket.writable) { //  ,     } else { connect(); } socket.write(dataBuf); } return this; } module.exports = Module;</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <em> 5. ,   TLS-</em> </p><br><p style=";text-align:right;direction:rtl">       DNS-over-TLS ,   Google DNS.        ,               <code>socket = tls.connect(connectionOptions, () =&gt; {})</code> .     NodeJS: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://nodejs.org/api/tls.html#tls_tls_connect_options_callback</a> ,       . </p><br><p style=";text-align:right;direction:rtl">  TLS-   : </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> options = { <span class="hljs-attr"><span class="hljs-attr">port</span></span>: config.upstreamDnsTlsPort, <span class="hljs-comment"><span class="hljs-comment">//        host: config.upstreamDnsTlsHost } const onData = (data) =&gt; { //     , .       7 }; remoteTlsClient = new TlsClient(options, onData);</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <em> 6.  TLS-</em> </p><br><p style=";text-align:right;direction:rtl">     ,        TCP-.   TCP/TLS-      DNS-,     ,    ,     ,   .    TCP (  TLS),  DNS-   512 ,    UDP (,  EDNS    UDP  ).  ,  DNS-    UDP,             .       <strong>onData()</strong>   6. </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> onData = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-comment"><span class="hljs-comment">//    DNS-,       TLS-   //    ,     2 ,       let dataCurrentPos = 0; try { while (dataCurrentPos &lt; data.length) { const respLen = data.readUInt16BE(dataCurrentPos); respBuf = data.slice(dataCurrentPos + 2, dataCurrentPos + 2 + respLen); const respData = functions.parseDnsMessageBytes(respBuf); const requestKey = functions.getRequestIdentifier(respData); const localResponseParams = localRequestsAwaiting.get(requestKey); localRequestsAwaiting.delete(requestKey); server.send(respBuf, localResponseParams.port, localResponseParams.address, (err, bytesNum) =&gt; {}); dataCurrentPos += 2 + respLen; } } catch (err) { console.error(err); //   ,     throw err; } };</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <em> 7.   TLS-   DNS-   6</em> </p><br><h3 id="poryadok-otvetov-ot-udalyonnogo-dns-servera" style=";text-align:right;direction:rtl">     DNS- </h3><br><p style=";text-align:right;direction:rtl">  ,            ,     .   ,         ID     QNAME, QTYPE  QCLASS  <em>Question</em> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Since pipelined responses can arrive out of order, clients MUST match responses to outstanding queries on the same TLS connection using the Message ID. If the response contains a Question Section, the client MUST match the QNAME, QCLASS, and QTYPE fields. () https://tools.ietf.org/html/rfc7858#section-3.3</code> </pre> <br><p style=";text-align:right;direction:rtl">     ,  ,    ,   ID   <em>Question</em> (   ,      ). </p><br><p style=";text-align:right;direction:rtl">        UDP (.  4),    ,         -,    ,   UDP-     .        ,       DNS-,       .          ,       -.  ,         ,      UDP-         -.  ,  ,    . </p><br><p style=";text-align:right;direction:rtl">      TLS,               .         (IP  ),    ,       . </p><br><p style=";text-align:right;direction:rtl">        IP      "-".   ,    ,   ,     DNS-.   ,    ,         IP  ,     .        7: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//        const requestKey = functions.getRequestIdentifier(respData); //    IP    ,   const localResponseParams = localRequestsAwaiting.get(requestKey); localRequestsAwaiting.delete(requestKey); //      IP   server.send(respBuf, localResponseParams.port, localResponseParams.address, (err, bytesNum) =&gt; {});</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <em> 8.        7</em> </p><br><p style=";text-align:right;direction:rtl">      TLS-: </p><br><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,     const localReqParams = { address: linfo.address, port: linfo.port }; //        const requestKey = functions.getRequestIdentifier(dnsRequest); //       localRequestsAwaiting.set(requestKey, localReqParams); //       ,      const lenBuf = Buffer.alloc(2); lenBuf.writeUInt16BE(localReq.length); const prepReqBuf = Buffer.concat([lenBuf, localReq], 2 + localReq.length); remoteTlsClient.write(prepReqBuf); //  RFC-7766 p.8, 2               </span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <em> 9.    DNS-  TLS- (  .  4)</em> </p><br><h2 id="chtenie-konfiguracii-iz-fayla-i-eyo-obnovlenie" style=";text-align:right;direction:rtl">        </h2><br><p style=";text-align:right;direction:rtl">   ,   ,      .     JSON,    ,   NodeJS   JSON-      .  JSON โ      ,      .  ,    JSON-  "comment" (  )       . ,  ,  ,    ,  .  ,        ,     .      ,   -  ,    ,            NodeJS.    ,   ,     .  ,         ,       ;   ,   .           ,     - . </p><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"> 10.     </b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> path = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'path'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> fs = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fs'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> CONFIG_FILE_PATH = path.resolve(<span class="hljs-string"><span class="hljs-string">'./config.json'</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Module</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// config  -,       . //    config        , //         . ,    : // const conf = config; //   conf     ,    : // const requestsToForge = config.requestsToForge; //    , requestsToForge   . const config = {}; Object.defineProperty(this, 'config', { get() { return config; }, enumerable: true }) this.initConfig = async function() { const fileContents = await readConfigFile(CONFIG_FILE_PATH); console.log('initConfig:'); console.log(fileContents); console.log('fileContents logged ^^'); const parsedConfigData = parseConfig(fileContents); Object.assign(config, parsedConfigData); }; async function readConfigFile(configPath) { const promise = new Promise((resolve, reject) =&gt; { fs.readFile(configPath, { encoding: 'utf8', flag: 'r' }, (err, data) =&gt; { if (err) { console.log('readConfigFile err to throw'); throw err; } resolve(data); }); }) .then( fileContents =&gt; { return fileContents; } ) .catch(err =&gt; { console.log('readConfigFile error: ', err); }); return promise; } function parseConfig(fileContents) { const configData = JSON.parse(fileContents); return configData; } //   ,       . //  Windows,    fs.watch     , //      ,   configReadInProgress let configReadInProgress = false; fs.watch(CONFIG_FILE_PATH, async () =&gt; { if(!configReadInProgress) { configReadInProgress = true; console.log('===== config changed, run initConfig() ====='); try { await this.initConfig(); } catch (err) { console.log('===== error initConfig(), skip =====,', err); configReadInProgress = false; } configReadInProgress = false; } else { console.log('===== config changed, initConfig() already running, skip ====='); } }); } let instance; async function getInstance() { if(!instance) { instance = new Module(); await instance.initConfig(); } return instance; } module.exports = getInstance;</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <em><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ูุงุฆูุฉ 10. ุงููุงุฑุฆ ูุญุฏุฉ ุงูุชูููู ุงูุชูููู</font></font></em> </p></div></div><br><h2 id="itogo" style=";text-align:right;direction:rtl">  ุงููุฌููุน </h2><br><p style=";text-align:right;direction:rtl">    DNS-  NodeJS,     <em>npm</em>   .    ,        ,   ,  ,         . </p><br><p style=";text-align:right;direction:rtl"> <strong><a href="">   GitHub</a></strong> </p><br><h3 id="istochniki" style=";text-align:right;direction:rtl"> : </h3><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RFC-1035</a> DOMAIN NAMES โ IMPLEMENTATION AND SPECIFICATION </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RFC-7858</a> Specification for DNS over Transport Layer Security (TLS) </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">RFC-7766</a> DNS Transport over TCP โ Implementation Requirements </li><li style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">https://stackoverflow.com/questions/4082081/requesting-a-and-aaaa-records-in-single-dns-query/4083071#4083071</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar440050/">https://habr.com/ru/post/ar440050/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar440036/index.html">ุงููุณ ุงููุชุงุจุฉ</a></li>
<li><a href="../ar440040/index.html">ูู ุงูุชูููุฉ - ูู ูููุณู. ููู ูู ุจุนุถ ุงูุฃุญูุงู ูุคุฏู ุฅูู ุทุฑูู ูุณุฏูุฏ.</a></li>
<li><a href="../ar440044/index.html">ููุงูููู ุงูุชุงุฑูุฎ ุงูููุตู</a></li>
<li><a href="../ar440046/index.html">ุงูุฏุฑุณ ุงูููุชูุญ "ุฅูุดุงุก ุนููุงุก REST ูู ุงูุฑุจูุน"</a></li>
<li><a href="../ar440048/index.html">ุงูููุงููุณ ุงูููุถูุฉ: 5 ูุคุดุฑุงุช ูุฌุจ ุนูู ูู ูุฑูู ูุจูุนุงุช ุงุชุจุงุนูุง</a></li>
<li><a href="../ar440052/index.html">ุซุงุจุช BIOS / UEFI ุชุญููู ุฃู ููููุฉ ุงูุญุตูู ุนูู ุงูุฑุณู ุงูุจูุงูู ุงูุชุจุนูุฉ</a></li>
<li><a href="../ar440054/index.html">ููู ุฎุฏูุฉ ุงูููุจ ุฅูู Yandex.Cloud ูุน AWS</a></li>
<li><a href="../ar440058/index.html">ุชูุฑูุฑ ูุดููุงุช ูุชูุงูุฑ ุงูุฅูุชุฑูุช 2018โ2019</a></li>
<li><a href="../ar440060/index.html">TensorFlow ุนูู ุงูุฃุจุงุชุดู ุฅุดุนุงู</a></li>
<li><a href="../ar440062/index.html">ุงูุชุฎุทูุท ุจุณุฑูุฑ. ููู ุฃูุดุฃูุง ุนูููุงุช ุจุฏูู ูุฏูุฑูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>