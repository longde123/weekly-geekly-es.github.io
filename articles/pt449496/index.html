<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôçüèæ üë®üèø‚Äçüè≠ üêΩ Hackathon DevDays'19 (parte 2): analisador de mensagem de √°udio para verifica√ß√£o de telegrama e gram√°tica no IntelliJ IDEA üêØ üìì üé∏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Continuamos a falar sobre os projetos da primavera hackathon DevDays, da qual participaram os alunos do programa de mestrado "Engenharia de Software /...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hackathon DevDays'19 (parte 2): analisador de mensagem de √°udio para verifica√ß√£o de telegrama e gram√°tica no IntelliJ IDEA</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/JetBrains-education/blog/449496/">  Continuamos a falar sobre os projetos da primavera hackathon DevDays, da qual participaram os alunos do programa de mestrado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Engenharia de Software / Engenharia de Software"</a> . <br><br><img src="https://habrastorage.org/webt/cz/gr/an/czgran29lxbwd-wwbrkoj3jquio.jpeg"><br><br>  A prop√≥sito, queremos convidar os leitores a se juntarem ao <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">grupo VK da magistratura</a> .  Nele publicaremos as √∫ltimas not√≠cias sobre recrutamento e estudo.  O v√≠deo do dia aberto tamb√©m pode ser encontrado no grupo.  Lembramos: o evento ser√° realizado no dia 29 de abril, com detalhes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no site</a> . <br><a name="habracut"></a><br><h2>  Analisador de Mensagens de Voz do Telegram Desktop </h2><br><img src="https://habrastorage.org/webt/md/sa/oo/mdsaoonicw-hw7y0d2_1jfzapsy.png"><br><br>  <b>O autor da ideia</b> <br>  Khoroshev Artyom <br><br>  <b>Composi√ß√£o da equipe</b> <br><br>  Khoroshev Artem - gerente de projetos / desenvolvedor / QA <br>  Eliseev Anton - Analista de Neg√≥cios / Especialista em Marketing <br>  Kuklina Maria - UI designer / desenvolvedor <br>  Bakhvalov Pavel - UI designer / desenvolvedor / QA <br><br>  Do nosso ponto de vista, o Telegram √© um mensageiro moderno e conveniente, e sua vers√£o para PC √© popular e de c√≥digo aberto, por isso √© poss√≠vel modific√°-lo.  O cliente oferece uma funcionalidade bastante rica.  Al√©m das mensagens de texto padr√£o, ele cont√©m chamadas de voz, mensagens de v√≠deo e mensagens de voz.  E √© este √∫ltimo que √†s vezes incomoda seu destinat√°rio.  Geralmente, n√£o h√° como ouvir uma mensagem de voz em um computador ou laptop.  Ru√≠do ambiente, falta de fones de ouvido podem interferir ou voc√™ n√£o deseja que o conte√∫do da mensagem seja ouvido por ningu√©m.  Esses problemas quase nunca ocorrem se voc√™ usar telegramas em seu smartphone, porque voc√™ pode traz√™-lo ao ouvido, ao contr√°rio de um laptop ou PC.  Tentamos resolver esse problema. <br><br>  O objetivo do nosso projeto no DevDays era adicionar a capacidade de converter mensagens de voz recebidas em texto no cliente de desktop Telegram (a seguir, Telegram Desktop). <br><br>  Todos os an√°logos no momento s√£o bots para os quais voc√™ pode enviar uma mensagem de √°udio e, em troca, receber um texto.  Isso n√£o √© muito conveniente para n√≥s: encaminhar uma mensagem para um bot n√£o √© muito conveniente, eu gostaria de ter uma funcionalidade nativa.  Al√©m disso, qualquer bot √© um terceiro que atua como intermedi√°rio entre a API de reconhecimento de fala e o usu√°rio, e isso √© pelo menos inseguro. <br><br>  Como observado anteriormente, o telegrama-desktop tem duas vantagens de peso: leveza e velocidade.  E isso n√£o √© coincid√™ncia, porque est√° completamente escrito em C ++.  E como decidimos adicionar novas funcionalidades diretamente ao cliente, tivemos que desenvolv√™-las em C ++. <br><br><img align="right" src="https://habrastorage.org/webt/8w/wp/n2/8wwpn2h7s2duvglwj4_b-xlhykk.jpeg">  Havia 4 pessoas em nossa equipe.  Inicialmente, dois estavam procurando uma biblioteca adequada para reconhecimento de fala, uma pessoa estudou o c√≥digo-fonte do Telegram-desktop e outra estava implantando a constru√ß√£o do projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Telegram Desktop</a> .  Mais tarde, todos estavam ocupados com corre√ß√µes da interface do usu√°rio e depura√ß√£o. <br><br>  Parecia que a implementa√ß√£o da funcionalidade pretendida n√£o seria dif√≠cil, mas, como sempre, surgiram dificuldades. <br><br>  A solu√ß√£o para o problema consistiu em duas subtarefas independentes: selecionar os meios apropriados para reconhecimento de fala e implementar a interface do usu√°rio para novas funcionalidades. <br><br>  Ao escolher uma biblioteca para reconhecimento de voz, tivemos que abandonar imediatamente todas as APIs offline, porque os modelos de idioma ocupam muito espa√ßo.  Mas este √© apenas um idioma.  Ficou claro que voc√™ precisaria usar a API online.  Mais tarde, constatou-se que os servi√ßos de reconhecimento de fala de gigantes como Google, Yandex e Microsoft n√£o s√£o gratuitos e teremos que nos contentar com um per√≠odo de teste.  Como resultado, o Google Speech-To-Text foi escolhido, pois permite que voc√™ obtenha um token para usar o servi√ßo, que durar√° um ano inteiro. <br><br>  O segundo problema que encontramos est√° associado a algumas das desvantagens do C ++ - o zool√≥gico de v√°rias bibliotecas na aus√™ncia de um reposit√≥rio centralizado.  Aconteceu que o Telegram Desktop depende de muitas outras bibliotecas de vers√µes espec√≠ficas.  O reposit√≥rio oficial possui <a href="">instru√ß√µes</a> para a constru√ß√£o do projeto.  E tamb√©m um grande n√∫mero de quest√µes abertas sobre problemas de constru√ß√£o, por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">uma</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">duas vezes</a> .  Todos os problemas acabaram devido ao fato de o script de compila√ß√£o ter sido escrito para o Ubuntu 14.04, e para construir um telegrama com sucesso no Ubuntu 18.04, tive que fazer altera√ß√µes. <br><br>  O pr√≥prio Telegram Desktop levar√° um bom tempo: em um laptop com um Intel Core i5-7200U, o conjunto completo (sinalizador -j 4) com todas as depend√™ncias leva cerca de tr√™s horas.  Destas, s√£o necess√°rias cerca de 30 minutos para vincular o pr√≥prio cliente (mais tarde, na configura√ß√£o de Depura√ß√£o, a vincula√ß√£o leva cerca de 10 minutos), mas a etapa de vincula√ß√£o deve ser repetida todas as vezes ap√≥s as altera√ß√µes. <br><br>  Apesar dos problemas, conseguimos implementar nossa ideia e atualizar o <a href="">script de compila√ß√£o</a> para o Ubuntu 18.04.  A demonstra√ß√£o do trabalho pode ser vista <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Tamb√©m aplicamos v√°rias anima√ß√µes.  Um bot√£o apareceu perto de todas as mensagens de voz, permitindo que voc√™ traduza a mensagem em texto.  Quando voc√™ clica com o bot√£o direito do mouse, pode opcionalmente especificar o idioma que ser√° usado para tradu√ß√£o.  O cliente est√° dispon√≠vel para download <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">atrav√©s do link</a> . <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Reposit√≥rio.</a> <br><br>  Em nossa opini√£o, obtivemos uma boa funcionalidade de Prova de conceito que seria conveniente para muitos usu√°rios.  Esperamos v√™-lo em vers√µes futuras do Telegram Desktop. <br><br><h2>  Suporte expandido a idiomas naturais no IntelliJ IDEA </h2><br><img src="https://habrastorage.org/webt/xt/bu/ep/xtbuep8pkflphnvfvcfb6hm4eio.png"><br><br>  <b>O autor da ideia</b> <br><br>  Tanques Vladislav <br><br>  <b>Composi√ß√£o da equipe</b> <br><br>  Tanques Vladislav (l√≠der da equipe, trabalhando com o LanguageTool e o IntelliJ IDEA) <br>  Sokolov Nikita (trabalhando com o LanguageTool e criando UI) <br>  Hvorov Alexander (trabalhando com o LanguageTool e otimizando o desempenho) <br>  Sadovnikov Alexander (suporte para analisar linguagens e c√≥digos de marca√ß√£o) <br><br>  Desenvolvemos um plug-in para o IntelliJ IDEA que verifica v√°rios textos (coment√°rios e documenta√ß√£o, linhas literais no c√≥digo, texto formatado em Markdown ou marca√ß√£o XML) quanto √† fidelidade gramatical, ortogr√°fica e estil√≠stica (em ingl√™s, isso √© chamado de revis√£o). <br><br>  A id√©ia do projeto era expandir a verifica√ß√£o ortogr√°fica padr√£o do IntelliJ IDEA para a escala Grammarly, para criar uma esp√©cie de gram√°tica dentro do IDE. <br><br>  Voc√™ pode ver o que aconteceu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">clicando no link</a> . <br><br>  Bem, abaixo, falaremos mais sobre as capacidades do plugin, bem como sobre as dificuldades que surgiram durante a sua cria√ß√£o. <br><br>  <b>Motiva√ß√£o</b> <br><br>  Existem muitos produtos projetados para escrever textos em idiomas naturais, mas a documenta√ß√£o e os coment√°rios sobre o c√≥digo s√£o escritos com mais frequ√™ncia em ambientes de desenvolvimento.  Ao mesmo tempo, os IDEs fazem um excelente trabalho para encontrar erros na escrita de c√≥digo, mas s√£o pouco adaptados para textos em idiomas naturais.  Por isso, √© muito f√°cil cometer erros de gram√°tica, pontua√ß√£o ou estilo, e o ambiente de desenvolvimento n√£o os aponta.  √â mais cr√≠tico cometer um erro ao escrever a interface do usu√°rio, pois isso afetar√° n√£o apenas a compreensibilidade do c√≥digo, mas tamb√©m os pr√≥prios usu√°rios do aplicativo desenvolvido. <br><br>  Um dos ambientes de desenvolvimento mais populares e desenvolvidos √© o IntelliJ IDEA, bem como os IDEs baseados na plataforma IntelliJ.  A plataforma IntelliJ j√° possui um corretor ortogr√°fico integrado, mas n√£o salva nem mesmo os erros gramaticais mais simples.  Decidimos integrar um dos sistemas populares de an√°lise de linguagem natural no IntelliJ IDEA. <br><br>  <b>Implementa√ß√£o</b> <br><br><img align="right" src="https://habrastorage.org/webt/e2/5_/cr/e25_crjowbelpxdvftvxetn-ut4.jpeg">  N√£o nos propusemos a tarefa de criar nosso pr√≥prio sistema de verifica√ß√£o de textos, por isso aproveitamos a solu√ß√£o existente.  A op√ß√£o mais adequada foi o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LanguageTool</a> .  A licen√ßa nos permitiu us√°-la livremente para nossos prop√≥sitos: √© gratuita, escrita em Java e definida em c√≥digo aberto.  Al√©m disso, ele suporta 25 idiomas e vem sendo desenvolvido h√° mais de quinze anos.  Apesar de sua abertura, o LanguageTool √© um concorrente s√©rio das solu√ß√µes de verifica√ß√£o de texto paga, e o fato de poder trabalhar localmente √© literalmente o seu principal recurso. <br><br>  O c√≥digo do plug-in est√° no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio no GitHub</a> .  Todo o projeto foi escrito em Kotlin com uma pequena adi√ß√£o de Java para a interface do usu√°rio.  Durante o hackathon, conseguiu implementar suporte para Markdown, JavaDoc, HTML e texto sem formata√ß√£o.  Ap√≥s o hackathon, uma grande atualiza√ß√£o adicionou suporte para XML, literais de strings em Java, Kotlin e Python, al√©m de verifica√ß√£o ortogr√°fica. <br><br>  <b>Dificuldades</b> <br><br>  Muito rapidamente, percebemos que, se alimentarmos todo o texto toda vez para a verifica√ß√£o do LanguageTool, a interface do IDEA permanecer√° com textos mais ou menos s√©rios, pois a inspe√ß√£o em si bloqueia o fluxo da interface do usu√°rio.  O problema foi resolvido atrav√©s da verifica√ß√£o do `ProgressManager.checkCancelled` - essa fun√ß√£o gera uma exce√ß√£o se o IDEA considerar que a inspe√ß√£o deve ser interrompida. <br><br>  Isso eliminou completamente os travamentos, mas √© imposs√≠vel us√°-lo: o texto foi processado por muito tempo.  Al√©m disso, no nosso caso, na maioria das vezes uma parte muito pequena do texto muda e eu quero, de alguma forma, armazenar em cache os resultados.  Foi o que fizemos.  Para n√£o checar tudo o tempo todo, deterministicamente dividimos o texto em peda√ßos e verificamos apenas os que foram alterados.  Como os textos podem ser grandes e n√£o desejarem carregar o cache, armazenamos n√£o os textos em si, mas seus hashes.  Isso permitiu que o plug-in funcionasse sem problemas, mesmo em arquivos grandes. <br><br>  O LanguageTool suporta mais de 25 idiomas, mas dificilmente um usu√°rio precisa de todos.  Eu queria dar a oportunidade de baixar bibliotecas para um idioma espec√≠fico, mediante solicita√ß√£o (se marcada por uma marca na interface do usu√°rio).  N√≥s at√© o implementamos, mas ficou muito complicado e n√£o confi√°vel.  Em particular, tivemos que carregar o LanguageTool com um novo conjunto de idiomas como um carregador de classes separado e, em seguida, inicializ√°-lo cuidadosamente.  Ao mesmo tempo, todas as bibliotecas estavam no reposit√≥rio .m2 do usu√°rio e, a cada in√≠cio, t√≠nhamos que verificar sua integridade.  No final, decidimos que, se os usu√°rios tivessem problemas com o tamanho do plug-in, fornecer√≠amos um plug-in separado para v√°rios dos idiomas mais populares. <br><br>  <b>Ap√≥s hackathon</b> <br><br>  O hackathon terminou, mas o trabalho no plug-in continuou com uma composi√ß√£o mais restrita.  Eu queria dar suporte a linhas, coment√°rios e at√© constru√ß√µes de linguagem, como nomes de vari√°veis ‚Äã‚Äãe classes.  Atualmente, isso √© suportado apenas para Java, Kotlin e Python, mas esperamos que esta lista aumente.  Corrigimos muitos bugs pequenos e nos tornamos mais compat√≠veis com o corretor ortogr√°fico embutido Idea.  Al√©m disso, o suporte a XML e a verifica√ß√£o ortogr√°fica apareceram.  Tudo isso pode ser encontrado na segunda vers√£o que publicamos recentemente. <br><br>  <b>O que vem a seguir?</b> <br><br>  Esse plug-in pode ser √∫til n√£o apenas para desenvolvedores, mas tamb√©m para escritores t√©cnicos (geralmente trabalhando, por exemplo, com XML no IDE).  Todos os dias eles precisam trabalhar com a linguagem natural, sem ter um assistente na forma de dicas do editor sobre poss√≠veis erros.  Nosso plugin fornece essas dicas e o faz com um alto grau de precis√£o. <br>  Planejamos desenvolver o plugin adicionando novos idiomas e explorando a abordagem geral para organizar a valida√ß√£o de texto.  Em um futuro pr√≥ximo, a implementa√ß√£o de perfis de estilo (conjuntos de regras que definem o guia de estilo do texto, por exemplo, "n√£o escreva, por exemplo, mas escreva a forma completa"), expanda o dicion√°rio e melhore a interface do usu√°rio (em particular, queremos dar ao usu√°rio a capacidade de n√£o apenas ignorar a palavra, mas adicionar ele no dicion√°rio, indicando parte do discurso). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt449496/">https://habr.com/ru/post/pt449496/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt449484/index.html">Criamos um sensor de controle de qualidade do ar no InfluxDB, Grafana, Docker e Raspberry Pi</a></li>
<li><a href="../pt449486/index.html">√äxodo em massa de jogos de navegador</a></li>
<li><a href="../pt449488/index.html">Dias sombrios do cataclismo √† frente: an√°lise est√°tica e jogos do tipo Roguelike</a></li>
<li><a href="../pt449490/index.html">Slurm: Intenso por Kubernetes. Programa e b√¥nus</a></li>
<li><a href="../pt449494/index.html">Interfaces de IA e onde eles moram</a></li>
<li><a href="../pt449498/index.html">Analistas: estimativa da Microsoft exceder√° em breve US $ 1 trilh√£o</a></li>
<li><a href="../pt449500/index.html">Como n√£o entrar em p√¢nico se muitos programadores vieram nos visitar?</a></li>
<li><a href="../pt449502/index.html">Antiguidades: cassete de v√≠deo incr√≠vel</a></li>
<li><a href="../pt449506/index.html">Vis√£o geral: seis maneiras de usar proxies residentes para resolver problemas corporativos</a></li>
<li><a href="../pt449508/index.html">10 recursos √∫teis do R que voc√™ talvez n√£o conhe√ßa</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>