<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ˜‡ ğŸ‘ğŸ¾ ğŸ¥  ACS LCD saya - pengaman di dua baut ğŸ¤˜ ğŸ“™ ğŸ••</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saya segera memperingatkan pembaca: Artikel ini ditulis hanya untuk informasi, dan dalam kasus apa pun tidak menyerukan tindakan ilegal. Penulis tidak...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ACS LCD saya - pengaman di dua baut</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/439278/"> Saya segera memperingatkan pembaca: Artikel ini ditulis hanya untuk informasi, dan dalam kasus apa pun tidak menyerukan tindakan ilegal.  Penulis tidak bertanggung jawab atas tindakan ilegal yang dilakukan oleh orang-orang yang menggunakan informasi dalam artikel ini. <br><br><img src="https://habrastorage.org/webt/yk/fs/p-/ykfsp-giznlsydndwjjukl8hzyw.png"><br><br>  Salam untuk pembaca.  Hari ini saya ingin berbicara tentang keamanan kontrol akses dan sistem manajemen (ACS) secara umum dan contoh LCD saya.  Kerentanan utama akan diperiksa, serta upaya yang berhasil untuk menyalin kunci.  Semua manipulasi pada dasarnya adalah perangkat keras. <br><a name="habracut"></a><br>  Di kompleks perumahan saya, sistem doorphone Sinthesi S2 dipasang, serta sistem akses halaman / pintu masuk / lantai yang diproduksi oleh Urmet Group.  Begitulah kerennya tampilan panel jalan. <br><br><img src="https://habrastorage.org/webt/fm/mr/b1/fmmrb1xbkfetetbxhurozddrtfi.png"><br><br>  sampai suatu hari saya mulai terlihat seperti ini: <br><br><img src="https://habrastorage.org/webt/fv/7q/hq/fv7qhqsdztc7j5h9la_ww4k38sw.png"><br><br>  Dia nongkrong seperti itu selama beberapa hari, dan kemudian pindah ke tempat sampah di dekatnya.  Itu hanya pembaca dan keypad.  Karena salah satu area di perusahaan saya adalah pengembangan pembaca HF, saya tidak bisa menolak dan memutuskan untuk mempelajari pembaca RFID ini dengan lebih detail.  Dari dokumentasi saya menemukan hanya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">katalog</a> besar yang dapat disimpulkan bahwa ini adalah FD-020-017 - pembaca 13,56 MHz dengan antarmuka Wiegand26.  Di dalamnya ada sandwich papan pembaca ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MFRC531</a> ) dan MK dengan BLE ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CC2541</a> ) yang dilem dengan perekat hot-melt untuk kasus ini, yang jelas dikembangkan bukan untuk papan ini. <br><br><img src="https://habrastorage.org/webt/-l/qq/yt/-lqqyti00ujmciyzmppzpkzcbn8.png"><br><br>  Papan MK dibanjiri dengan senyawa lunak yang tampaknya melindungi bagian radio dari kelembaban.  Memutar papan di tangan saya, saya menunda. <br><br>  Sampai baru-baru ini, sistem tidak menarik bagi saya, karena sudah mulai sebagian (hanya kunci akses yang berfungsi, tetapi mereka memiliki kode akses yang saya tahu dan tidak menggunakan kunci).  Setelah sistem mulai sepenuhnya dan kode akses dibatalkan, saya mulai mempelajarinya secara lebih rinci.  Itu bermula pada suatu malam ketika saya kembali ke rumah dan mendapati bahwa pintu ruang depan sudah berfungsi dan istri saya sudah tidur.  Saya hanya membawa barang-barang saku, tetapi ternyata, ini sudah cukup untuk mengatasi semua keamanan elit (seperti yang diyakinkan Urmet). <br><br><img src="https://habrastorage.org/webt/ip/9o/av/ip9oavphdqdmspjusi-wbwkvlsy.png"><br><br>  Yang saya butuhkan adalah membuka 2 sekrup memegang bingkai panel dengan kunci mobil, menghapus 2 blok dan menggunakan kunci yang sama untuk menutup saluran relay yang masuk ke kunci pintu ruang depan.  Semua ... <br>  Setelah kejadian ini, ketika saya menonton film Hollywood lainnya ("Penumpang" (2016) di KDPV) dan melihat bagaimana pintu super rahasia dibuka dengan melepas panel kode dan meletakkan pin di papan (tentu dengan percikan api dan pembukaan pintu yang spektakuler), saya melihat situasi nyata. <br><br>  Dalam ingatan saya, sebagian besar ACS yang saya lihat memiliki akses ke kunci langsung dari panel kode dan ini adalah kerentanan utama.  Semua keamanan disediakan oleh beberapa baut yang memegang panel ini, dan dengan keyakinan bahwa sistem ini dapat diandalkan.  Tetapi pada saat yang sama, dimungkinkan untuk secara signifikan meningkatkan ambang entri (sebut saja perlindungan terhadap seseorang dengan obeng) dengan menggunakan kunci dengan otak yang dikendalikan oleh antarmuka - bahkan jika itu adalah yang paling sederhana.  Ukuran ini akan secara drastis mengurangi kemungkinan masuk secara spontan. <br><br><h3>  Sumber data </h3><br>  ACS LCD secara keseluruhan, operasinya, reaksi terhadap kunci lain, serta cara menambahkan kunci: <br><br><ul><li>  Satu kunci gratis untuk apartemen dikeluarkan, masing-masing berikutnya adalah 300 rubel, terdaftar di akun pribadi ACS.  Anda hanya dapat membeli dari Inggris.  Obrolan LCD menulis bahwa mesin fotokopi pasar tidak dapat membuat duplikat - itu berarti sistem lebih dingin daripada hanya membaca UID. </li><li>  Saat menyajikan kartu mifare lainnya, pembaca bahkan tidak menunjukkan bahwa ia melihatnya. </li><li>  Ketika Anda membawa kunci ke tangga / lantai lain, pembaca mengambil bacaan, tetapi tidak ada yang terjadi. </li><li>  Saat membaca isi fob kunci 8 dan 12, blok-bloknya disembunyikan dan memiliki kunci akses yang berbeda dari kunci Mifare yang terkenal.  Jadi rahasianya ada di suatu tempat. </li></ul><br><img src="https://habrastorage.org/webt/nr/1k/xl/nr1kxljcz-vzxdgknnfcmyz0jh0.png"><br><br><h3>  Mulai kerja </h3><br>  Pertama-tama, saya menyalin Block0 (yang berisi informasi UID dan Pabrikan) ke cakram Mifare Zero dan memeriksa bahwa ini tidak cukup - kunci fob tidak berfungsi.  Pembaca bahkan tidak menanggapi presentasi klon semacam itu.  Menjadi jelas bahwa Anda perlu mencari kunci untuk sektor 8 dan 12. Setelah membaca semua pernak-pernik yang tersedia, saya melihat bahwa hanya satu dari mereka yang memiliki 12 blok terkunci, sisanya adalah nol, jadi jelaslah bahwa sihir terkandung dalam blok 8. <br><br>  Sudah waktunya untuk mendapatkan pembaca yang berbakat dan memeriksanya lebih dekat.  Jadi kami memiliki FD-020-017 - 13,56 MHz, antarmuka Wiegand26.  MFRC531 dan CC2541 dihubungkan oleh sisir 10-pin.  Dan dia bekerja dengan sempurna di atas meja - tanpa sisa sistem.  Bereaksi terhadap tombol dengan cara yang sama seperti sisa pembaca.  Pertama, mari kita lihat apa yang keluar: <br><br><img src="https://habrastorage.org/webt/kf/sy/wm/kfsywm6pgxzqcggydxffit8-nnw.png"><br><br>  Diam sebelum presentasi keyring yang valid.  Setelah membaca antarmuka, pesan meninggalkan sepenuhnya sesuai dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Wiegand26</a> .  Jadi saya mendekodekan paket yang dikirimkan kunci saya.  Dengan bantuan multimeter, saya mengembalikan pinout, ternyata chip tersebut berkomunikasi oleh SPI.  Kami menghubungkan alat analisa, <br><br><img src="https://habrastorage.org/webt/2s/z6/pu/2sz6pu-h8fykc157m8vbc3xgfyy.png"><br><br>  kami membawa gantungan kunci yang valid dan menonton pertukaran dengan SPI: <br><br><img src="https://habrastorage.org/webt/j3/gd/ui/j3gduiwafbqwrjznhpjmvlq3p2u.png"><br><br>  Selanjutnya, saya mulai melihat dokumentasi untuk chip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">MFRC531</a> dan hampir menjatuhkan tangan saya ketika melihat bahwa ia memiliki EEPROM khusus untuk menyimpan kunci.  Saya menemukan perintah untuk memuat kunci: <br><br><img src="https://habrastorage.org/webt/gm/zb/x6/gmzbx6c4cu4de6ut89jbkfxkwbe.png"><br><br>  Perintah 0x0B dimuat dari EEPROM, perintah 0x19 dari FIFO, yang pada gilirannya menerima kunci melalui SPI.  Tampaknya jika Anda memuat kunci dari EEPROM, maka saya tidak memiliki kesempatan untuk membalikkan cara ini, TAPI saya terkejut, tidak ada perintah pertukaran 0x0B, tetapi ada perintah 0x19 <br><br><img src="https://habrastorage.org/webt/qj/wi/zk/qjwizk-mxiizgq5kgafox6puguu.png"><br><br>  Tinggal mengumpulkan kunci saja sesuai format <br><br><img src="https://habrastorage.org/webt/rh/ef/ak/rhefak-ucxfeotu8c5_aps6xm0k.png"><br><br>  Dan tambahkan ke lembar kunci. <br><br><img src="https://habrastorage.org/webt/tt/ga/nz/ttganzuuekb2ntx4xwjeucldgbm.png"><br><br>  Bingo !!!  Ternyata blok 8 dimulai dengan 3 byte non-nol, yang hanya pergi ke Wiegand ketika kunci fob dan pembaca cocok.  Data ini tidak ada hubungannya dengan UID - kemungkinan besar itu hanya nomor seri ketika dikeluarkan dalam KUHP.  Gantungan kunci saya memiliki 3 angka berturut-turut + satu sangat berbeda.  Rekaman yang kosong berhasil, saya menggabungkan kunci ke LCD dengan kunci ke kantor, yang bekerja oleh UID. <br><br><h3>  Kesimpulan </h3><br>  Untuk peretasan sistem yang berhasil, saya perlu berterima kasih kepada programmer dari Urmet Group yang terus terang menipu ketika menulis perangkat lunak untuk pembaca, karena jika ada perangkat keras yang mampu menghilangkan metode peretasan seperti itu (umumnya cukup sederhana), Anda tidak dapat melakukan ini, Anda tidak dapat menyebut apa pun selain hack. <br><br>  Sebagian besar orang yang bekerja dengan teknologi RFID tahu bahwa algoritma enkripsi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Crypto-1</a> yang digunakan dalam kartu Mifare (Klasik) telah lama retak dan memungkinkan untuk mendapatkan kunci blok dengan cara yang lebih "bersih", tetapi saya tetap maju. <br><br>  Dalam proyek kami sendiri, kami menggunakan pembaca yang dapat diprogram dengan kamus kata sandi satu kali untuk enkripsi.  Ini memungkinkan Anda untuk melindungi diri dari kloning jika kartu asli dilampirkan ke pembaca sebelum klon, jika tidak akan mendeteksi duplikasi (kartu asli akan berhenti berfungsi). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id439278/">https://habr.com/ru/post/id439278/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id439264/index.html">Cara mengelola proyek teknis yang rumit tanpa mempekerjakan PM: Pengalaman DataLine</a></li>
<li><a href="../id439266/index.html">Pengalaman membuat game untuk Android sendiri dari awal dan bagaimana itu dikreditkan ke Google Play</a></li>
<li><a href="../id439268/index.html">Bagaimana VR, AR, dan pencetakan 3D bekerja bersama: Pengalaman Konsep VR</a></li>
<li><a href="../id439270/index.html">Contoh parsing kode C ++ menggunakan libclang dengan Python</a></li>
<li><a href="../id439272/index.html">Notebook Jupyter di Netflix</a></li>
<li><a href="../id439280/index.html">Trautonium: gelombang Jerman dalam sejarah synthesizer</a></li>
<li><a href="../id439282/index.html">Efek penyaringan SVG. Bagian 1. Filter SVG 101</a></li>
<li><a href="../id439286/index.html">Tentang analisis statis dalam semua kejujuran</a></li>
<li><a href="../id439288/index.html">SciPy, optimasi</a></li>
<li><a href="../id439290/index.html">Mempercepat kompilasi dalam Xcode saat swift</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>