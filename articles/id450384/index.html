<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👱 🕧 🤴 Kisah studi kode warisan kecil 🖕🏽 👆🏿 🤽🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Adalah baik ketika ada seseorang yang lebih berpengalaman dalam tim yang akan menunjukkan apa dan bagaimana melakukan, apa yang menyapu dan menyudutka...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kisah studi kode warisan kecil</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/450384/">  Adalah baik ketika ada seseorang yang lebih berpengalaman dalam tim yang akan menunjukkan apa dan bagaimana melakukan, apa yang menyapu dan menyudutkan apa, dan di mana untuk mengunduh gambar sepeda terbaik untuk tahun 2007 di DVD.  Kisah ini adalah tentang bagaimana harapan itu dinyatakan sah, apa hasilnya, dan bagaimana krisis itu diatasi. <br><br>  Ini terjadi pada saat, setelah, menurut saya, pengalaman yang biasa-biasa saja dalam pengembangan, saya sedang mencari tempat di mana Anda dapat berevolusi (atau bermutasi) dari non-junior menjadi bahkan junior yang percaya diri.  Dalam cara-cara misterius Tuhan tempat seperti itu ditemukan, sebuah proyek melekat pada tempat itu, dan pemrogram "sekolah tua", yang menulis lebih banyak daripada anak perempuan daripada kariernya dalam sistem.  “Hebat!  Proyek, dan oleh karena itu ada uang untuk RFP, mentornya terpasang, kita hidup! ”  Saya berpikir, tetapi kemudian, seperti dalam deskripsi horor yang khas, para pahlawan dalam kegelapan menghadapi horor yang mengerikan ... <br><a name="habracut"></a><br>  Hal pertama yang pertama: <br><br><h4>  1. Ukuran penting </h4><br>  Kami memulai pengembangan pada mesin php yang dulu eksklusif, yang digunakan untuk menyimpan data (di sini Anda mungkin berpikir MySQL \ PostgreSQL \ SQLite \ MongoDB \ Sesuatu-lain-tetapi-tentu-dengan-akhiran DB-jika tidak- guys-tidak mengerti, tetapi mereka tidak menebak) api-gateway. <br><br>  “Haha, menggunakan php, apakah kamu memasang api-gateway lain untuk itu, dan menyimpan data di dalamnya?  Bukankah lebih mudah untuk bekerja dengan api langsung dari js-code?  Atau gunakan DBMS + PHP? "  - Tanyakan pembaca berpengalaman.  Dan dia akan benar.  Tetapi pada saat itu, saya, yang belum melihat spesies itu, tidak berpikir begitu, yah, siapa tahu, orang-orang keren mungkin melakukan itu, dan para programmer "jadul" tahu lebih baik. <br><br>  Seperti yang saya jelaskan lebih lanjut: <br><br><ol><li>  Gateway = keamanan, tidak ada yang akan masuk dan keluar begitu saja </li><li>  Gateway = penyimpanan data aman, Anda tidak bisa masuk ke dalamnya, + backup </li><li>  Gateway = kecepatan, bekerja dengan cepat dan tanpa kegagalan, teruji oleh waktu </li><li>  Sudut pandang otoritatif dari programer "old-school" adalah bahwa php Anda penuh dengan lubang, aplikasi web apa pun diretas secara default, jadi tidak ada yang menyimpan data di sebelahnya </li></ol><br>  Fitur khas dari gerbang api adalah bahwa data json ditransmisikan dalam permintaan dapatkan.  Ya, ya, benda-benda json yang sangat indah itu, dikenai url-encoding, dan dimasukkan ke dalam string kueri.  Dan semuanya akan baik-baik saja, ketika tiba-tiba suatu hari ... lamanya permintaan diterima tidak lagi cukup.  Bodoh, json yang dikodekan-url, kanalya, tidak cocok di sana!  Programmer "old-school", menggaruk kepalanya, bertanya: <br>  “Apa yang akan kita lakukan?  Json kami telah berkembang, tetapi kami belum menyadarinya ... " <br>  "Yah, uh, mungkin kalau begitu kita akan mempostingnya di pos?"  Saya menyarankan, jadi sepertinya lebih benar. <br>  "Oke, lulus untuk mengirim." <br>  Itu atas nomor satu. <br><br><h4>  2. Manajemen waktu dan cadangan </h4><br>  Untuk memasukkan fungsi baru ke dalam proyek, itu perlu untuk diterapkan <br>  permintaan CRUD yang sesuai di gateway, itulah yang sebenarnya dilakukan oleh kawan “sekolah lama” kami.  Masalahnya adalah dia melakukan ini setiap 3 hari sekali, membagikan "Selesai, periksa."  Cek pada waktu menunjukkan bahwa tidak semuanya bekerja, misalnya, mendapatkan daftar tidak apa-apa, menambahkan item baru tidak ok.  Butuh beberapa waktu untuk memperbaiki dan memperbaiki, setelah itu dimungkinkan untuk melepaskan fungsionalitas dalam akses massal.  Proposal untuk melakukan implementasi kueri di gateway sendiri, karena setidaknya lebih cepat, ditolak, karena "sulit di sana, Anda tidak akan menemukannya."  Hasil dari pendekatan ini adalah penutupan pekerjaan "pada diriku sendiri".  Jika, misalnya, perlu untuk memperbaiki sesuatu secara massal dalam database, maka, memilih antara menunggu 3 hari dan pelaksanaan koreksi sendiri melalui kueri - saya memilih opsi ke-2.  Pelanggan tidak suka menunggu, pengantar baru terbang stabil.  Salah satu dari pengantar tersebut, yaitu pembubuhan tanda untuk pengguna tanda, dipercayakan kepada saya untuk diimplementasikan, ada satu jam untuk segala sesuatu tentang segala sesuatu, pihak berwenang sedang menunggu laporan yang indah.  Di sini menanti kita atas nomor dua-s. <br><br>  Faktanya adalah bahwa format data json yang ditransmisikan dalam permintaan hanya menyiratkan beberapa bidang yang diperlukan, yang lainnya sewenang-wenang, struktur yang jelas dan final tidak ada.  Misalnya, untuk menambahkan pengguna, saya memberikan json formulir: <br><br><pre><code class="json hljs">POST /api/users { <span class="hljs-attr"><span class="hljs-attr">"email"</span></span>:<span class="hljs-string"><span class="hljs-string">"ivanov@mail.ru"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"password"</span></span>:<span class="hljs-string"><span class="hljs-string">"myEmailIsVeryBig"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name_last"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name_first"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name_middle"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"birth"</span></span>:<span class="hljs-string"><span class="hljs-string">"01.01.1961"</span></span>, //     ,    -    <span class="hljs-attr"><span class="hljs-attr">"living_at"</span></span>:<span class="hljs-string"><span class="hljs-string">"., .3 .4 .24"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"phone_num"</span></span>:<span class="hljs-string"><span class="hljs-string">"+70000000000"</span></span> }</code> </pre> <br>  Bagian opsional yang dikirim dalam permintaan tambah / perbarui disimpan dan diberikan secara keseluruhan (saya akan memberi tahu tentang bagaimana ini diterapkan di bawah).  Intinya adalah, waktu tidak berhenti, akan perlu untuk menyelesaikan masalah - untuk memperbarui pengguna, letakkan label mereka.  Tapi jangan mendorong seluruh struktur setiap saat?  Harus memeriksa!  Saya mengujinya sendiri - saya hanya mengirim satu bidang dalam permintaan pembaruan, memeriksa, bidang muncul, sisa data ada di tempat.  Intinya kecil - loop dan perbarui sisanya. <br><br>  Script itu mengembang pelan, menerima dan mengirimkan data, dan semuanya tampak berjalan dengan baik ... ketika tiba-tiba - panggilan.  "Kami tidak melihat nama pengguna di sistem!"  - melaporkan dari ujung kawat itu.  “Ayo!  Ya berhasil! ”  - Hawa dingin yang tidak menyenangkan berlari melintasi punggungku.  Penyelidikan lebih lanjut menunjukkan bahwa memang, nama "" ditunjukkan dalam nama, meskipun semua data lain ada di tempat.  Apa yang harus dilakukan dalam situasi seperti itu?  Sebarkan cadangan! <br><br>  Programmer "Kamerad" old-school ", akan ada masalah!  Perlu cadangan!  Kapan relevan terbaru dilakukan? "  - Saya bertanya. <br><br>  "Uhh ... Aku akan melihat sekarang ....  Tidak, tidak ada bakapa. " <br><br>  Situasi diselamatkan oleh fakta bahwa beberapa jam sebelumnya saya menyelesaikan dan menguji modul dengan laporan, saya memiliki kotak csv dengan semua data yang diperlukan, pesanan dikembalikan dalam waktu satu jam lagi. <br><br>  Kurangnya dokumentasi yang dapat dipahami, deskripsi algoritma operasi, pemeriksaan validitas input, dan yang paling penting - backup database - atas nomor dua-s. <br><br>  Sejak itu, cadangan mulai dihapus setiap hari. <br><br><h4>  3. Sangat mencolok </h4><br>  Shaky, tetapi pekerjaan itu bergerak, masalah terselesaikan, beberapa lebih cepat, beberapa lebih lambat, ketika tiba-tiba ... pelanggan menyadari bahwa sistem tidak dipahami oleh server orang lain, dan untuk sikap seperti itu terhadap PD dan mengatur kegiatan ZI di ISPD mereka tidak akan membelai kepala.  Anda perlu mentransfer server ke diri Anda sendiri. <br><br>  Mengapa sistem tidak ditransfer pada awalnya?  Kepemimpinan memiliki satu gairah - sentralisasi.  Manajemen memimpikan sistem yang akan melakukan segalanya!  Apakah Anda perlu melampirkan anak ke sekolah?  Anda masuk ke sistem, di kantor khusus, di sana Anda mengirimkan aplikasi.  Anda perlu, katakanlah, memesan pizza - Anda masuk ke sistem, ke kantor khusus lain, melamar pizza.  Mungkin Anda ingin berkomunikasi dengan wanita cantik?  Melayani Anda adalah kabinet khusus ketiga - Anda juga mengirimkan aplikasi di sana, dan seterusnya tanpa batas. <br><br>  Keuntungan - satu login dan kata sandi untuk semuanya, data disimpan dengan aman dan aman di gateway.  Bahkan ada backup.  Dan, ingatlah, tidak ada yang akan mengambil sistem ini dari kami!  Dan bahkan jika itu menghilangkannya - selanjutnya apa?  Semua sama, mereka tidak akan mengerti sistem perlindungan terhadap programer "old-school" - semuanya rumit di sana. <br><br>  VDS dengan sistem diturunkan, dikaitkan dengan pelanggan, mereka menyebarkannya, semua orang menari dan bernyanyi, cantik! <br><br>  Dan kemudian gelombang keingintahuan dan kecurigaan menutupi saya. <br><br>  Jika aplikasi web kita penuh dengan lubang, lalu di mana datanya?  Apakah Anda benar-benar tetap di server lain?  Dan jika mereka memutuskan untuk menutup sistem dari luar, maka semuanya akan runtuh? <br><br>  Pemeriksaan sederhana menunjukkan bahwa data, serta prosesor gateway itu sendiri, berada di server yang sama.  Dan, tidak, mereka tidak ditransfer ke sana karena transfer server, mereka selalu ada di sana. <br>  Sekarang saya memiliki pengembangan "sekolah tua" yang sangat rahasia, yang saya mulai selidiki.  Tentu saja, rekayasa balik keren dalam gaya artikel dari majalah Hacker, dengan ollydbg, offset, dan hal-hal keren lainnya tidak berhasil, jadi saya membagikan apa yang saya miliki. <br>  Pengembangan itu sendiri diimplementasikan dalam python, hanya ada file .pyc yang dapat dengan mudah didekompilasi kembali menjadi kode yang dapat dibaca.  Terus terang, butuh banyak waktu, sebanyak 25 menit, untuk mencari tahu cara kerjanya. <br><br>  Jadi, sistem kompleks yang dikembangkan oleh pemrogram "sekolah tua", yang hanya bisa dimengerti oleh beberapa orang, terdiri dari: <br><br><ol><li>  Script diproses oleh Apache, yang sebenarnya menerima permintaan.  Apa yang dilakukan skrip ini?  Membuka koneksi ke port localhost tertentu dan melewati permintaan di sana dengan semua datanya.  Itu saja.  Minat lebih lanjut. </li><li>  Bagian server yang memproses permintaan dari skrip.  Logika tindakannya cukup menarik.  Pertama, tidak ada manipulasi data dalam kode, dan tidak ada permintaan dalam database, sebagai gantinya, fungsi database dalam PL \ SQL dipanggil.  Semua logika, cek, dan sebagainya, semuanya diletakkan dalam fungsi basis data.  50% dari skrip adalah kamus yang berisi nama permintaan, fungsi yang terkait dengannya, dan nama-nama parameter fungsi yang harus sesuai dengan data yang diteruskan di baris dapatkan-permintaan.  Data JSON, jika perlu, diteruskan sebagai parameter terpisah.  Fitur organisasi bagian server adalah koneksi cadangan selama otentikasi pengguna.  Jika login dan kata sandi ditemukan dalam database, ID sesi dibuat, dan contoh koneksi terbuka dilipat ke dalam kamus (dan terbunuh oleh batas waktu 10 menit sehingga tidak akan terbunuh - ada metode khusus untuk memperpanjang umur sesi), kuncinya adalah ID sesi, yang langsung di dalam database tidak disimpan.  Bagaimana tepatnya ID sesi dikaitkan dengan data pengguna?  Lagi pula, apakah ada permintaan untuk data di mana ID pengguna tidak dikirim?  Ini berfungsi, yang berarti ada sesuatu yang salah di sini. </li></ol><br>  Perkembangan yang sangat sulit diberikan kepada kesadaran dengan kesulitan dan tidak terburu-buru untuk mengungkapkan rahasia lama yang telah hilang dari para penguasa masa lalu. <br><br>  Luar biasa (Pergi ke&gt; Definisi, terima kasih kepada PhpStorm untuk memahami PL \ SQL), tidak dapat dipahami oleh pikiran orang awam yang menderita Pengetahuan Sejati tentang Peradaban yang Hilang dari Programmer Sekolah Lama tetap diperoleh.  Secara umum, ketika terhubung, tabel sementara dihasilkan dalam fungsi verifikasi data otentikasi, di mana id pengguna disimpan. <br><br>  Ini baru permulaan, daftar indikatif dari kerentanan serius yang ditemukan: <br><br><ul><li>  DDoS menggunakan otentikasi massal (koneksi dicadangkan, dan, oleh karena itu, bertumpu pada batas koneksi DBMS, yang, mengingat kemungkinan memperpanjang waktu hidup sesi, memungkinkan untuk sepenuhnya mengisi memori dengan koneksi, dan pekerjaan pengguna baru dalam sistem tidak mungkin dilakukan); </li><li>  kurangnya perlindungan terhadap brute force (jumlah upaya login gagal tidak terdeteksi, tidak disimpan, tidak dicentang; </li><li>  kurangnya kontrol atas tindakan dengan entitas (misalnya, daftar dokumen yang diminta oleh pengguna dikeluarkan dengan mempertimbangkan organisasi yang dilampirkan pengguna, dan jika Anda tahu ID dokumen, Anda dapat berhasil menyelesaikan permintaan untuk memperbarui / menghapus dokumen, dan daftar pengguna baik bahkan tanpa kata sandi, yang, secara kebetulan, disimpan dalam database secara jelas, tanpa hashing, dapat diterima oleh siapa saja). </li></ul><br>  Dan masalah serius lainnya bukanlah skema penyimpanan data yang diformalkan.  Seperti yang dijanjikan sebelumnya, saya berbicara tentang menyimpan "semua bidang" dari JSON.  Tidak, mereka tidak disimpan sebagai baris di tabel.  Mereka dibagi menjadi pasangan nilai kunci dan disimpan dalam tabel terpisah.  Misalnya, untuk pengguna ada 2 tabel - pengguna, dan users_data (kunci string, nilai string) - di mana data sebenarnya disimpan.  Hasil dari pendekatan ini adalah peningkatan waktu dengan sampel kompleks dari database. <br><br>  Sebenarnya ini sudah cukup untuk membuat dan mengimplementasikan keputusan untuk mentransfer sistem ke api baru, dapat dimengerti, didokumentasikan, dan didukung. <br><br><h4>  Akhlak </h4><br>  Mungkin sistem ini adalah "Legacy", dan programmer "old-school" yang menciptakannya adalah inti dari Legacy. <br><br>  Namun demikian, kesimpulannya adalah sebagai berikut: <br><br><ol><li>  Jika Anda diberi tahu "itu sulit, Anda tidak akan mengerti" - itu berarti ada bagian atas yang lengkap </li><li>  Jika mereka dihancurkan oleh otoritas, maka ada sesuatu yang najis </li><li>  Percaya, tetapi verifikasi - keamanan bukan negara, keamanan adalah proses yang berkelanjutan, oleh karena itu lebih baik untuk memverifikasi kualitas yang dinyatakan kenyataan daripada untuk mengetahui nanti bahwa semua pengguna tiba-tiba menjadi "Ivanov Ivanov Ivanitch", tetapi tidak ada bacaps. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id450384/">https://habr.com/ru/post/id450384/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id450368/index.html">Dapatkan kurs absolut dari nilai tukar lintas mata uang berpasangan</a></li>
<li><a href="../id450372/index.html">Bagaimana Algoritma Amazon Menentukan Siapa Saatnya untuk Memberhentikan</a></li>
<li><a href="../id450374/index.html">Papan Ekspansi RAM untuk Apple IIgs</a></li>
<li><a href="../id450376/index.html">Bagaimana Yandex.Taxi mencari mobil ketika tidak</a></li>
<li><a href="../id450378/index.html">GitLab 11.10</a></li>
<li><a href="../id450386/index.html">Antarmuka sebagai tipe data abstrak di Go</a></li>
<li><a href="../id450394/index.html">Investigasi satu arsip yang tidak diketahui</a></li>
<li><a href="../id450396/index.html">Cara meningkatkan bahasa Inggris tertulis Anda: kiat praktis dan alat yang bermanfaat</a></li>
<li><a href="../id450398/index.html">Racun paling tak kenal takut</a></li>
<li><a href="../id450410/index.html">Terraformer - Infrastruktur Untuk Kode</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>