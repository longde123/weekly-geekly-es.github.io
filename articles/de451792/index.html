<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äç‚öñÔ∏è ‚úãüèæ ü¶ç Vier Javascript-Sniffer, die Sie in Online-Shops fangen üñåÔ∏è üëµüèº ‚úãüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fast jeder von uns nutzt die Dienste von Online-Shops, was bedeutet, dass er fr√ºher oder sp√§ter Gefahr l√§uft, Opfer von JavaScript-Schn√ºfflern zu werd...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vier Javascript-Sniffer, die Sie in Online-Shops fangen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/451792/"><img src="https://habrastorage.org/webt/m2/18/ri/m218ribvsirj8bn0787eizy9oei.jpeg"><br><br>  Fast jeder von uns nutzt die Dienste von Online-Shops, was bedeutet, dass er fr√ºher oder sp√§ter Gefahr l√§uft, Opfer von JavaScript-Schn√ºfflern zu werden - ein spezieller Code, den Cyberkriminelle auf die Website injizieren, um Bankkarteninformationen, Adressen, Anmeldungen und Benutzerkennw√∂rter zu stehlen. <br><br>  Fast 400.000 Nutzer der Website und der mobilen Anwendung der British Airways Airline sowie Besucher der britischen Website des Sportgiganten FILA und des amerikanischen Ticketvertriebs Ticketmaster waren bereits von Schn√ºfflern betroffen. <br><br>  Viktor Okorokov, Analyst der Threat Intelligence Group-IB, spricht dar√ºber, wie Sniffer in Site-Code eingebettet sind und Rechnungsinformationen stehlen und welche CRMs sie angreifen. <a name="habracut"></a><br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/l_/b0/sa/l_b0sa5cjkma2zr779uhbfi5h8m.jpeg"></div><br><br><h2>  Die Phantombedrohung </h2><br>  Es stellte sich heraus, dass JS-Sniffer lange Zeit nicht in Sichtweite von Antiviren-Analysten waren und Banken und Zahlungssysteme keine ernsthafte Bedrohung in ihnen sahen.  Und v√∂llig vergebens.  Group-IB-Experten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">analysierten</a> 2.440 infizierte Online-Shops, deren Besucher - etwa 1,5 Millionen Menschen pro Tag - einem Kompromissrisiko ausgesetzt waren.  Unter den Opfern sind nicht nur Benutzer, sondern auch Online-Shops, Zahlungssysteme und Banken, die kompromittierte Karten ausgestellt haben. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der</a> Group-IB- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bericht</a> war die erste Studie √ºber den Darknet-Markt f√ºr Sniffer, ihre Infrastruktur und M√∂glichkeiten zur Monetarisierung, die ihren Entwicklern Millionen von Dollar einbrachte.  Wir identifizierten 38 Familien von Schn√ºfflern, von denen den Forschern bisher nur 12 bekannt waren. <br><br>  Lassen Sie uns im Detail auf die vier Familien von Schn√ºfflern eingehen, die w√§hrend der Studie untersucht wurden. <br><br><h2>  ReactGet-Familie </h2><br>  Schn√ºffler der ReactGet-Familie werden verwendet, um Bankkartendaten auf Websites von Online-Shops zu stehlen.  Ein Sniffer kann mit einer gro√üen Anzahl verschiedener Zahlungssysteme arbeiten, die auf der Website verwendet werden: Ein Parameterwert entspricht einem Zahlungssystem, und einzelne erkannte Sniffer-Versionen k√∂nnen verwendet werden, um Anmeldeinformationen zu stehlen sowie Bankkartendaten aus Zahlungsformen mehrerer Zahlungssysteme gleichzeitig zu stehlen, z der sogenannte Universalschn√ºffler.  Es wurde festgestellt, dass Angreifer in einigen F√§llen Phishing-Angriffe auf Administratoren von Online-Shops ausf√ºhren, um Zugriff auf das Verwaltungsfenster der Website zu erhalten. <br><br>  Die Kampagne mit dieser Familie von Sniffern begann im Mai 2017, Websites unter der Kontrolle von CMS und den Plattformen Magento, Bigcommerce, Shopify wurden angegriffen. <br><br><h3>  Wie ReactGet in Online-Shop-Code eingebettet ist </h3><br>  Zus√§tzlich zur ‚Äûklassischen‚Äú Implementierung eines Skripts als Referenz verwendet die ReactGet-Sniffer-Familie eine spezielle Technik: Mithilfe von JavaScript-Code wird √ºberpr√ºft, ob die aktuelle Adresse, an der sich der Benutzer befindet, bestimmte Kriterien erf√ºllt.  Sch√§dlicher Code wird nur gestartet, wenn die aktuelle URL den Teilstring- <b>Checkout</b> oder den <b>Onestepcheckout</b> , <b>onepage /</b> , <b>out / onepag</b> , <b>checkout / one</b> , <b>ckout / one enth√§lt</b> .  Somit wird der Sniffer-Code genau zu dem Zeitpunkt ausgef√ºhrt, zu dem der Benutzer die Eink√§ufe bezahlt und die Zahlungsinformationen in das Formular auf der Website eingibt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kz/fz/lr/kzfzlrityshdouqlvh5ns14vlhm.png"></div><br>  Dieser Schn√ºffler verwendet eine nicht standardm√§√üige Technik.  Die Zahlungs- und pers√∂nlichen Daten des Opfers werden zusammen gesammelt, mit <b>base64</b> codiert. Anschlie√üend wird die resultierende Zeichenfolge als Parameter verwendet, um eine Anfrage an die Website des Angreifers zu senden.  Meistens simuliert der Pfad zum Gate eine JavaScript-Datei, z. B. <b>resp.js</b> , <b>data.js</b> usw., aber auch Links zu Bilddateien, <b>GIFs</b> und <b>JPGs</b> .  Die Besonderheit besteht darin, dass der Schn√ºffler ein Bildobjekt mit einer Gr√∂√üe von 1 x 1 Pixel erstellt und den zuvor erhaltenen Link als <b>src-</b> Parameter des Bildes verwendet.  Das hei√üt, f√ºr den Benutzer sieht eine solche Anforderung im Verkehr wie eine Anforderung f√ºr ein regul√§res Bild aus.  Eine √§hnliche Technik wurde bei den Sniffern der ImageID-Familie verwendet.  Dar√ºber hinaus wird die Technik der Verwendung eines 1 x 1-Pixel-Bildes in vielen legitimen Online-Analyseskripten verwendet, was den Benutzer auch irref√ºhren kann. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/jo/bf/xm/jobfxmbqsrjqolrvo84fkstgrhi.png"></div><br><h3>  Versionsanalyse </h3><br>  Eine Analyse der aktiven Dom√§nen, die von den ReactGet-Sniffer-Operatoren verwendet werden, ergab viele verschiedene Versionen der Sniffer-Familie.  Versionen unterscheiden sich in der Anwesenheit oder Abwesenheit von Verschleierung, und au√üerdem ist jeder Sniffer f√ºr ein bestimmtes Zahlungssystem ausgelegt, das Bankkartenzahlungen f√ºr Online-Shops verarbeitet.  Nachdem die Group-IB-Spezialisten den Wert des Parameters entsprechend der Versionsnummer sortiert hatten, erhielten sie eine vollst√§ndige Liste der verf√ºgbaren Sniffer-Variationen und bestimmten anhand der Namen der Formularfelder, nach denen jeder Sniffer im Seitencode sucht, die Zahlungssysteme, auf die der Sniffer abzielt. <br><br><div class="spoiler">  <b class="spoiler_title">Liste der Schn√ºffler und ihrer entsprechenden Zahlungssysteme</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Sniffer URL <br></th><th width="200">  Zahlungssystem <br></th></tr><tr><td align="center">  <a href="">reactjsapi.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.1</a> </td><td align="center">  Karten <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.4</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.5</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.6</a> </td><td align="center">  Adyen </td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.7</a> </td><td align="center">  USAePay </td></tr><tr><td align="center">  <a href="">ajaxstatic.com/api.js?v=2.1.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.1</a> </td><td align="center">  USAePay </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.3</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.5</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.6</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.7</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.8</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.1.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=2.3.0</a> </td><td align="center">  Streifen <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.2</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.4</a> </td><td align="center">  Verbindungspunkt </td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.5</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.7</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.8</a> </td><td align="center">  Datacash <br></td></tr><tr><td align="center">  <a href="">apitstatus.com/api.js?v=3.0.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">asianfoodgracer.com/footer.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.5</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.7</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=1.8</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/api.js?v=2.0</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">billgetstatus.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=1.3</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.4</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.6</a> <br></td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.7</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.8</a> </td><td align="center">  Chase Paymentech <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.91</a> </td><td align="center">  Adyen <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.92</a> </td><td align="center">  Psigate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.93</a> </td><td align="center">  Cyber-Quelle </td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.95</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">cloudodesc.com/gtm.js?v=2.97</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">geisseie.com/gs.js</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/age.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.3</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.5</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.6</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">gtmproc.com/gtm.js?v=1.7</a> </td><td align="center">  Realex <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.0</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.2</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livecheckpay.com/api.js?v=2.4</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livecheckpay.com/react.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.2</a> </td><td align="center">  ANZ eGate <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.3</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.5</a> </td><td align="center">  Cyber-Quelle <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.8</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.1.9</a> </td><td align="center">  Realex </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.0</a> </td><td align="center">  Cyber-Quelle </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.4</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.5</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.7</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.8</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.2.9</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.2</a> </td><td align="center">  Erstes globales Daten-Gateway <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.5</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.3.8</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">livegetpay.com/pay.js?v=2.4.0</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">maxstatics.com/site.js</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=funlove.com</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=qbedding.com</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mediapack.info/track.js?d=vseyewear.com</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.4</a> </td><td align="center">  Streifen </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.7</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=1.8</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.1</a> </td><td align="center">  Braintree </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.10</a> </td><td align="center">  Braintree <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.3</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.31</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.32</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.33</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.34</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/c.js?v=2.35</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.4</a> </td><td align="center">  Streifen </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.7</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=1.8</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.1</a> </td><td align="center">  Braintree </td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.2</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.3</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.31</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.32</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.33</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.34</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/click.js?v=2.35</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">mxcounter.com/cnt.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">mxcounter.com/j.js</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=1.8</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=4.5</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">newrelicnet.com/api.js?v=4.6</a> </td><td align="center">  Westpac Payway <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.0</a> </td><td align="center">  Payfort <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.1</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.3</a> </td><td align="center">  Streifen <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.4</a> </td><td align="center">  Erstes globales Daten-Gateway <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.5</a> </td><td align="center">  Psigate </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.8</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=2.9</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.1</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.2</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.3</a> </td><td align="center">  Moneris </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.5</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.6</a> </td><td align="center">  Verbindungspunkt <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.7</a> </td><td align="center">  Westpac Payway <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=3.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.2</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.3</a> </td><td align="center">  Adyen </td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.4</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.5</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.6</a> </td><td align="center">  USAePay <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.7</a> </td><td align="center">  EBizCharge <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.0.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">nr-public.com/api.js?v=4.1.2</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.11</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.12</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.13</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.14</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.15</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.16</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.17</a> </td><td align="center">  Westpac Payway <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.18</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.19</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.21</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.22</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.23</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.24</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.25</a> </td><td align="center">  Payfort <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.29</a> </td><td align="center">  Cyber-Quelle <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.4</a> </td><td align="center">  PayPal Payflow Pro <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.8</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=2.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.2</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.3</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.5</a> </td><td align="center">  Streifen <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.8</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=3.9</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.2</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">ordercheckpays.com/api.js?v=4.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=0.1.0</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=0.1.1</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.2</a> </td><td align="center">  Feuerstein </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.4</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.5</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.51</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.7</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.8</a> </td><td align="center">  Streifen </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.1.9</a> </td><td align="center">  Fettes Zebra <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.0</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.2</a> </td><td align="center">  Erstes globales Daten-Gateway <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.4</a> </td><td align="center">  eWAY Rapid <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.5</a> </td><td align="center">  Adyen <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.7</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.8</a> </td><td align="center">  QuickBooks Merchant Services <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.9</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.91</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.92</a> </td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.2.94</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.3.97</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">reactjsapi.com/api.js?v=4.5</a> </td><td align="center">  Salbei bezahlen </td></tr><tr><td align="center">  <a href="">reactjsapi.com/react.js</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">sydneysalonsupplies.com/gtm.js</a> </td><td align="center">  eWAY Rapid </td></tr><tr><td align="center">  <a href="">tagsmediaget.com/react.js</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.2</a> </td><td align="center">  ANZ eGate </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.3</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.5</a> </td><td align="center">  Cyber-Quelle </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.7</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.8</a> </td><td align="center">  Salbei bezahlen </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.1.9</a> </td><td align="center">  Realex <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.0</a> </td><td align="center">  Cyber-Quelle </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.1</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.2</a> </td><td align="center">  Paypal </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.3</a> </td><td align="center">  Paypal <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.4</a> </td><td align="center">  Verisign <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.5</a> </td><td align="center">  eWAY Rapid </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.7</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.8</a> </td><td align="center">  Salbei bezahlen <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.2.9</a> <br></td><td align="center">  Verisign </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.0</a> </td><td align="center">  Authorize.Net </td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.1</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.2</a> </td><td align="center">  Erstes globales Daten-Gateway <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.3</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.4</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.5</a> </td><td align="center">  Moneris <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.6</a> </td><td align="center">  Authorize.Net <br></td></tr><tr><td align="center">  <a href="">tagstracking.com/tag.js?v=2.3.8</a> </td><td align="center">  Paypal <br></td></tr></tbody></table></div><br></div></div><br><h3>  Passwort-Schn√ºffler <br></h3><br>  Einer der Vorteile von JavaScript-Sniffern, die auf der Clientseite der Website arbeiten, ist ihre Vielseitigkeit: Auf der Website eingebetteter Schadcode kann jede Art von Daten stehlen, unabh√§ngig davon, ob es sich um Zahlungsdaten oder den Benutzernamen und das Kennwort eines Benutzerkontos handelt.  Group-IB-Spezialisten entdeckten eine Stichprobe eines Sniffers der ReactGet-Familie, der E-Mail-Adressen und Passw√∂rter von Site-Benutzern stehlen soll. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/7x/9c/x1/7x9cx1en90ze5etozgc6jmg5eh8.png"></div><br><h3>  Schnittpunkt mit ImageID Sniffer <br></h3><br>  Eine Analyse eines der infizierten Gesch√§fte ergab, dass seine Website zweimal infiziert war: Zus√§tzlich zum Schadcode der ReactGet-Sniffer-Familie wurde ein Sniffer-Code der ImageID-Familie erkannt.  Dieser Schnittpunkt kann darauf hinweisen, dass die Bediener, die hinter der Verwendung beider Sniffer stehen, √§hnliche Techniken verwenden, um sch√§dlichen Code einzuf√ºgen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8s/m0/ed/8sm0edvplxoguwsczm9ja3-g_ng.png"></div><br><h3>  Universalschn√ºffler <br></h3><br>  Eine Analyse eines der Domainnamen im Zusammenhang mit der ReactGet-Sniffer-Infrastruktur ergab, dass derselbe Benutzer drei weitere Domainnamen registriert hatte.  Diese drei Dom√§nen simulierten Dom√§nen von realen Standorten und wurden zuvor zum Hosten von Sniffern verwendet.  Bei der Analyse des Codes von drei legitimen Sites wurde ein unbekannter Sniffer entdeckt, und eine weitere Analyse ergab, dass dies eine verbesserte Version des ReactGet-Sniffers ist.  Alle zuvor erfassten Versionen von Sniffern dieser Familie waren auf ein einziges Zahlungssystem ausgerichtet, dh f√ºr jedes Zahlungssystem war eine spezielle Version des Sniffers erforderlich.  In diesem Fall wurde jedoch eine universelle Version des Sniffers entdeckt, die Informationen aus Formularen stehlen kann, die sich auf 15 verschiedene Zahlungssysteme und Module von E-Commerce-Websites f√ºr Online-Zahlungen beziehen. <br><br>  Zu Beginn der Arbeit suchte der Schn√ºffler nach den Basisfeldern des Formulars, das die pers√∂nlichen Informationen des Opfers enthielt: vollst√§ndiger Name, physische Adresse, Telefonnummer. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/g_/py/vs/g_pyvsjovjp7p6x2vlqzaqho5ey.png"></div><br>  Dann suchte der Schn√ºffler nach mehr als 15 verschiedenen Pr√§fixen, die verschiedenen Zahlungssystemen und Modulen f√ºr Online-Zahlungen entsprechen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dd/ty/as/ddtyasulurz4un7owfvlv-3xepu.png"></div><br>  Au√üerdem wurden die pers√∂nlichen Daten und Zahlungsinformationen des Opfers zusammen gesammelt und an die vom Angreifer kontrollierte Site gesendet. In diesem speziellen Fall wurden zwei Versionen des ReactGet Universal Sniffer entdeckt, die sich auf zwei verschiedenen gehackten Sites befinden.  Beide Versionen haben die gestohlenen Daten jedoch an dieselbe gehackte Site <b>zoobashop.com gesendet</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ee/mt/tb/eemttbv-vdn0ff9ncd3siqfzokq.png"></div><br>  Eine Analyse der Pr√§fixe, die der Sniffer verwendet, um nach Feldern zu suchen, die die Zahlungsinformationen des Opfers enthalten, erm√∂glichte es uns festzustellen, dass dieses Sniffer-Muster auf die folgenden Zahlungssysteme abzielte: <br><br><ul><li>  <b>Authorize.Net</b> </li><li>  <b>Verisign</b> </li><li>  <b>Erste Daten</b> </li><li>  <b>USAePay</b> </li><li>  <b>Streifen</b> </li><li>  <b>Paypal</b> </li><li>  <b>ANZ eGate</b> </li><li>  <b>Braintree</b> </li><li>  <b>DataCash (MasterCard)</b> </li><li>  <b>Realex-Zahlungen</b> </li><li>  <b>Psigate</b> </li><li>  <b>Heartland-Zahlungssysteme</b> </li></ul><br><h3>  Mit welchen Tools werden Rechnungsinformationen gestohlen? <br></h3><br>  Das erste Tool, das bei der Analyse der Infrastruktur des Angreifers entdeckt wurde, wird verwendet, um sch√§dliche Skripte zu verschleiern, die f√ºr den Diebstahl von Bankkarten verantwortlich sind.  Auf einem der angreifenden Hosts wurde ein Bash-Skript mithilfe der <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Javascript-Obfuscator-</a></b> CLI entdeckt, um die Verschleierung von Sniffer-Code zu automatisieren. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/5m/aw/lu/5mawlut23obt6lpoa3ed2luu8ss.png"></div><br>  Das zweite erkannte Tool dient zum Generieren von Code, der f√ºr das Laden des Haupt-Sniffers verantwortlich ist.  Dieses Tool generiert einen JavaScript-Code, der √ºberpr√ºft, ob sich der Benutzer auf der Zahlungsseite befindet, indem die aktuelle Adresse des Benutzers nach den Zeilen <b>Checkout</b> , <b>Warenkorb</b> usw. durchsucht wird. Wenn das Ergebnis positiv ist, l√§dt der Code den Haupt-Sniffer vom Server des Angreifers.  Um b√∂swillige Aktivit√§ten zu verbergen, werden alle Zeilen, einschlie√ülich Testzeilen zur Ermittlung der Zahlungsseite sowie ein Link zum Sniffer, mit <b>base64</b> codiert. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vn/ew/ym/vnewymbt1r6nc8n98roze5drnnk.png"></div><br><h3>  Phishing-Angriffe <br></h3><br>  Bei der Analyse der Netzwerkinfrastruktur der Angreifer wurde festgestellt, dass eine kriminelle Gruppe h√§ufig Phishing verwendet, um Zugriff auf das Verwaltungsfenster des Ziel-Online-Shops zu erhalten.  Angreifer registrieren eine Domain, die der Domain eines Gesch√§fts optisch √§hnlich sieht, und stellen dann ein gef√§lschtes Anmeldeformular f√ºr das Magento-Admin-Panel bereit.  Bei Erfolg erhalten Angreifer Zugriff auf das CMS Magento-Administrationsfenster, √ºber das sie Site-Komponenten bearbeiten und einen Sniffer implementieren k√∂nnen, um Kreditkarteninformationen zu stehlen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yf/-a/lz/yf-alzxabbg_kij0vkaq5qcr9vs.png"></div><br><div class="spoiler">  <b class="spoiler_title">Die Infrastruktur</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Domain <br></th><th width="200">  Entdeckungs- / Erscheinungsdatum <br></th></tr><tr><td align="center">  mediapack.info </td><td align="center">  05/04/2017 <br></td></tr><tr><td align="center">  adsgetapi.com </td><td align="center">  15.06.2017 <br></td></tr><tr><td align="center">  simcounter.com </td><td align="center">  14.08.2017 </td></tr><tr><td align="center">  mageanalytics.com </td><td align="center">  22.12.2017 </td></tr><tr><td align="center">  maxstatics.com </td><td align="center">  16.01.2008 <br></td></tr><tr><td align="center">  reactjsapi.com </td><td align="center">  19.01.2008 </td></tr><tr><td align="center">  mxcounter.com </td><td align="center">  02/02/2018 </td></tr><tr><td align="center">  apitstatus.com </td><td align="center">  03/01/2018 <br></td></tr><tr><td align="center">  orderracker.com </td><td align="center">  20.04.2008 <br></td></tr><tr><td align="center">  tagstracking.com </td><td align="center">  25.06.2008 <br></td></tr><tr><td align="center">  adsapigate.com </td><td align="center">  07/12/2018 <br></td></tr><tr><td align="center">  trust-tracker.com </td><td align="center">  15.07.2008 <br></td></tr><tr><td align="center">  fbstatspartner.com </td><td align="center">  10/02/2018 <br></td></tr><tr><td align="center">  billgetstatus.com </td><td align="center">  10/12/2018 </td></tr><tr><td align="center">  aldenmlilhouse.com </td><td align="center">  20.10.2008 <br></td></tr><tr><td align="center">  balletbeautlful.com </td><td align="center">  20.10.2008 <br></td></tr><tr><td align="center">  bargalnjunkie.com </td><td align="center">  20.10.2008 <br></td></tr><tr><td align="center">  payselector.com </td><td align="center">  21.10.2018 <br></td></tr><tr><td align="center">  tagsmediaget.com </td><td align="center">  11/02/2018 <br></td></tr><tr><td align="center">  hs-payments.com </td><td align="center">  16.11.2008 <br></td></tr><tr><td align="center">  ordercheckpays.com </td><td align="center">  19.11.2008 <br></td></tr><tr><td align="center">  geisseie.com </td><td align="center">  24.11.2008 <br></td></tr><tr><td align="center">  gtmproc.com </td><td align="center">  29.11.2008 <br></td></tr><tr><td align="center">  livegetpay.com </td><td align="center">  18.12.2008 <br></td></tr><tr><td align="center">  sydneysalonsupplies.com </td><td align="center">  18.12.2008 <br></td></tr><tr><td align="center">  newrelicnet.com <br></td><td align="center">  19.12.2008 <br></td></tr><tr><td align="center">  nr-public.com </td><td align="center">  01/03/2019 </td></tr><tr><td align="center">  cloudodesc.com </td><td align="center">  01/04/2019 <br></td></tr><tr><td align="center">  ajaxstatic.com </td><td align="center">  01/11/2019 <br></td></tr><tr><td align="center">  livecheckpay.com </td><td align="center">  21.01.2019 <br></td></tr><tr><td align="center">  asianfoodgracer.com </td><td align="center">  25.01.2019 <br></td></tr></tbody></table></div><br></div></div><br><h2>  G-Analytics-Familie <br></h2><br>  Diese Familie von Schn√ºfflern wird verwendet, um Karten von Kunden von Online-Shops zu stehlen.  Der allererste von der Gruppe verwendete Domainname wurde im April 2016 registriert, was auf den Beginn der Aktivit√§t der Gruppe Mitte 2016 hinweisen kann. <br><br>  In der aktuellen Kampagne verwendet die Gruppe Domain-Namen, die reale Dienste wie Google Analytics und jQuery imitieren und die Sniffer-Aktivit√§ten mit legitimen Skripten maskieren und legitimen Domain-Namen √§hneln.  Der Angriff wurde auf Websites ausgef√ºhrt, auf denen CMS Magento ausgef√ºhrt wird. <br><br><h3>  Wie G-Analytics in Online-Shop-Code eingebettet ist <br></h3><br>  Ein charakteristisches Merkmal dieser Familie ist die Verwendung verschiedener Methoden zum Diebstahl von Benutzerzahlungsinformationen.  Zus√§tzlich zur klassischen Implementierung von JavaScript-Code im Client-Teil der Site verwendete die kriminelle Gruppe auch die Technik des Einbettens von Code in den Server-Teil der Site, n√§mlich PHP-Skripte, die die vom Benutzer eingegebenen Daten verarbeiten.  Diese Technik ist insofern gef√§hrlich, als sie es Forschern von Drittanbietern erschwert, b√∂sartigen Code zu erkennen.  Group-IB-Spezialisten entdeckten eine Version eines <b>Snifters</b> , der in den PHP-Code der Site eingebettet ist und die Domain <b>dittm.org</b> als Gate verwendet. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ud/m_/dk/udm_dkzu4pw_4pbxhrstk0e9oo8.png"></div><br>  Es wurde auch eine fr√ºhere Version des Sniffers entdeckt, die dieselbe <b>dittm.org-</b> Domain verwendet, um gestohlene Daten zu sammeln. Diese Version ist jedoch bereits f√ºr die Installation auf der Clientseite des Online-Shops vorgesehen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/kr/0m/nh/kr0mnhgtjfxqs5lftvx53ofrm54.png"></div><br>  Sp√§ter √§nderte die Gruppe ihre Taktik und begann, der Verschleierung b√∂swilliger Aktivit√§ten und Verkleidungen mehr Aufmerksamkeit zu widmen. <br><br>  Anfang 2017 begann die Gruppe, die als CDN f√ºr jQuery <b>getarnte</b> Domain <b>jquery-js.com</b> zu verwenden: Wenn sie zu einer Site b√∂swilliger Benutzer umleitet, leitet sie zur legitimen Site <b>jquery.com weiter</b> . <br><br>  Mitte 2018 √ºbernahm die Gruppe den Domainnamen <b>g-analytics.com</b> und begann, die Aktivit√§ten des Sniffers unter dem legitimen Google Analytics-Dienst zu maskieren. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rd/fj/mj/rdfjmj8foi7qtcv_fi_lix69a4u.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/y3/xp/24/y3xp24ypsp9vloflbz5lbnrrfnk.png"></div><br><h3>  Versionsanalyse <br></h3><br>  Bei der Analyse der Dom√§nen, die zum Speichern von Sniffer-Code verwendet werden, wurde festgestellt, dass die Site eine gro√üe Anzahl von Versionen aufweist, die sich hinsichtlich des Vorhandenseins von Verschleierung sowie des Vorhandenseins oder Nichtvorhandenseins von nicht erreichbarem Code, der der Datei hinzugef√ºgt wurde, unterscheiden, um die Aufmerksamkeit abzulenken und den sch√§dlichen Code zu verbergen. <br><br>  Insgesamt wurden sechs Versionen von Schn√ºfflern auf <b>jquery-js.com</b> identifiziert.  Diese Sniffer senden die gestohlenen Daten an die Adresse, die sich auf derselben Site befindet wie der Sniffer selbst: <b>hxxps: // jquery-js [.] Com / latest / jquery.min.js</b> : <br><br><ul><li>  <b>hxxps: // jquery-js [.] com / jquery.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.2.2.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.8.3.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.6.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.4.4.min.js</b> </li><li>  <b>hxxps: // jquery-js [.] com / jquery.1.12.4.min.js</b> </li></ul><br>  Die sp√§tere Domain <b>g-analytics.com</b> , die von der Gruppe seit Mitte 2018 bei Angriffen verwendet wird, dient als Repository f√ºr eine gr√∂√üere Anzahl von Sniffern.  Insgesamt wurden 16 verschiedene Sniffer-Versionen entdeckt.  In diesem Fall wurde das Gate zum Senden der gestohlenen Daten als Link zu einem <b>GIF-</b> Bild <b>getarnt</b> : <b>hxxp: // g-analysis [.] Com / __ utm.gif? = 2145 x 371 &amp; je = 0 &amp; _u = AACAAEAB ~ &amp; jid = 1841704724 &amp; gjid = 877686936 &amp; cid</b> <b><br></b>  <b>= 1283183910.1527732071</b> : <br><br><ul><li>  <b>hxxps: // g-analyse [.] com / libs / 1.0.1 / analyse.js</b> </li><li>  <b>hxxps: // g-analyse [.] com / libs / 1.0.10 / analyse.js</b> </li><li>  <b>hxxps: // g-analyse [.] com / libs / 1.0.11 / analyse.js</b> </li><li>  <b>hxxps: // g-analyse [.] com / libs / 1.0.12 / analyse.js</b> </li><li>  <b>hxxps: // g-analyse [.] com / libs / 1.0.13 / analyse.js</b> </li><li>  <b>hxxps: // g-analyse [.] com / libs / 1.0.14 / analyse.js</b> </li><li>  <b>hxxps: // g-analyse [.] com / libs / 1.0.15 / analyse.js</b> </li><li>  <b>hxxps: // g-analyse [.] com / libs / 1.0.16 / analyse.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.3/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.4/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.5/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.6/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.7/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.8/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/1.0.9/analytics.js</b> </li><li> <b>hxxps://g-analytics[.]com/libs/analytics.js</b> </li></ul><br><h3>    <br></h3><br>     ,       ,   .  ,  ,  ,  <b>google-analytics.cm</b>     ,    <b>cardz.vc</b> .  <b>cardz.vc</b>         Cardsurfs (Flysurfs),           AlphaBay      ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/k6/l6/-w/k6l6-wxdifwkyfd-kq-3xicgsdq.png"></div><br>   <b>analytic.is</b> ,     ,   ,      ,  Group-IB  ,   Cookie-, , ,    .        <b>iozoz.com</b> ,        ,   2016 . ,            .      email- <b>kts241@gmail.com</b> ,        <b>cardz.su</b>  <b>cardz.vc</b> ,     Cardsurfs. <br><br>    ,   ,    G-Analytics        Cardsurfs      ,       ,    . <br><br><div class="spoiler">  <b class="spoiler_title">Die Infrastruktur</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Domain <br></th><th width="200">  / <br></th></tr><tr><td align="center"> iozoz.com </td><td align="center"> 08.04.2016 </td></tr><tr><td align="center"> dittm.org </td><td align="center"> 10.09.2016 <br></td></tr><tr><td align="center"> jquery-js.com </td><td align="center">  01/02/2017 </td></tr><tr><td align="center"> g-analytics.com </td><td align="center">  31.05.2008 <br></td></tr><tr><td align="center"> google-analytics.is </td><td align="center"> 21.11.2018 <br></td></tr><tr><td align="center"> analytic.to </td><td align="center">  12/04/2018 </td></tr><tr><td align="center"> google-analytics.to </td><td align="center">  12/06/2018 <br></td></tr><tr><td align="center"> google-analytics.cm </td><td align="center"> 28.12.2018 <br></td></tr><tr><td align="center"> analytic.is </td><td align="center"> 28.12.2018 <br></td></tr><tr><td align="center"> googlc-analytics.cm </td><td align="center"> 17.01.2019 <br></td></tr></tbody></table></div><br></div></div><br><h2>  Illum </h2><br> Illum ‚Äî  ,     -,    CMS Magento.    ,          ,       . <br><br>    ,     ,      , ,   ,        .        ,  ,  ,       2016 . <br><br><h3>  Illum    - </h3><br>          .      <b>cdn.illum[.]pw/records.php</b> ,       <b>base64</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m0/ek/gs/m0ekgsjvued_xicxubpz6dprhag.png"></div><br>      ,    ‚Äî <b>records.nstatistics[.]com/records.php</b> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yy/zq/3d/yyzq3dtgunc6ansnwrk2eun4mjy.png"></div><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> Willem de Groot,      ,     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a> ,     CSU. <br><br><h3>    <br></h3><br>  Group-IB    ,           . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dm/ze/i3/dmzei3jrukearwtcs-9ch_b2nue.png"></div><br>  ,    ,           Linux:  , Linux Privilege Escalation Check Script,    (Mike Czumak),     CVE-2009-1185. <br><br>     -    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>      <b>core_config_data</b>    CVE-2016-4010, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a>    RCE    CMS Magento,       -. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/j7/st/5r/j7st5ryg0ixjehutzjvneckqaw8.jpeg"></div><br>              ,         .      ,        ,       CMS      .  ,  <b>segapay_standart.js</b>  <b>segapay_onpage.js</b>     ,    Sage Pay. <br><br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  </th><th width="200">   </th></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/visiondirect.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/topdierenshop.nl.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/tiendalenovo.es.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/pro-bolt.com.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/plae.co.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/ottolenghi.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/oldtimecandy.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/mylook.ee.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/luluandsky.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/julep.com.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/gymcompany.es.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/grotekadoshop.nl.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/fushi.co.uk.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/fareastflora.com.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs_special/compuindia.com.js </td><td align="center"> //request.payrightnow[.]cf/alldata.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs/segapay_standart.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs/segapay_onpage.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs/replace_standart.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs/all_inputs.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/mjs/add_inputs_standart.js </td><td align="center"> //request.payrightnow[.]cf/checkpayment.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/magento/payment_standart.js </td><td align="center"> //cdn.illum[.]pw/records.php <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/magento/payment_redirect.js </td><td align="center"> //payrightnow[.]cf/?payment= <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/magento/payment_redcrypt.js </td><td align="center"> //payrightnow[.]cf/?payment= <br></td></tr><tr><td align="center"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sr.illum</a> [.]pw/magento/payment_forminsite.js </td><td align="center"> //paymentnow[.]tk/?payment= <br></td></tr></tbody></table></div><br></div></div><br>  <b>paymentnow[.]tk</b> ,      <b>payment_forminsite.js</b> ,    <b>subjectAltName</b>   ,    CloudFlare.  ,     <b>evil.js</b> .    ,        CVE-2016-4010,        footer    CMS Magento.        <b>request.requestnet[.]tk</b> ,    ,    <b>paymentnow[.]tk</b> . <br><br><h3>    <br></h3><br>          .        -    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vd/vz/9b/vdvz9bvo34cv-5sp86ost9kadvg.png"></div><br>    ‚Äî     PayPal,           . <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6o/rk/92/6ork92ddgqisrzpksczgd-gcwyu.png"></div><br><div class="spoiler">  <b class="spoiler_title">Die Infrastruktur</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Domain <br></th><th width="200">  / </th></tr><tr><td align="center"> cdn.illum.pw </td><td align="center"> 27/11/2016 <br></td></tr><tr><td align="center"> records.nstatistics.com </td><td align="center"> 06/09/2018 <br></td></tr><tr><td align="center"> request.payrightnow.cf </td><td align="center"> 25/05/2018 <br></td></tr><tr><td align="center"> paymentnow.tk </td><td align="center"> 16/07/2017 <br></td></tr><tr><td align="center"> payment-line.tk </td><td align="center"> 01/03/2018 <br></td></tr><tr><td align="center"> paymentpal.cf </td><td align="center"> 04/09/2017 <br></td></tr><tr><td align="center"> requestnet.tk </td><td align="center"> 28/06/2017 <br></td></tr></tbody></table></div><br></div></div><br><h2>  CoffeMokko </h2><br>   CoffeMokko,       -,      2017 . ,        Group 1,   RiskIQ  2016 .       CMS,  Magento, OpenCart, WordPress, osCommerce, Shopify. <br><br><h3>  CoffeMokko    - </h3><br>         :      <b>src</b>  <b>js</b>   .          . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/wn/pz/s8/wnpzs8nq8gwew8hgxkmhocu8nv0.png"></div><br>        ,     .   ,      ,        . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fh/pj/am/fhpjamaj2zikswysse44wophdxq.png"></div><br>          ,      :           ,    ,      . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ia/wz/qw/iawzqwyetk6kadgy3hjgcbhalgi.png"></div><br>           <b>/savePayment/index.php  /tr/index.php</b> . ,           ,     .            <b>base64</b> ,      : <br><br><ul><li>  ¬´e¬ª   ¬´:¬ª </li><li>  ¬´w¬ª   ¬´+¬ª </li><li>  ¬´o¬ª   ¬´%¬ª </li><li>  ¬´d¬ª   ¬´#¬ª </li><li>  ¬´a¬ª   ¬´-¬ª </li><li>  ¬´7¬ª   ¬´^¬ª </li><li>  ¬´h¬ª   ¬´_¬ª </li><li>  ¬´T¬ª   ¬´@¬ª </li><li>  ¬´0¬ª   ¬´/¬ª </li><li>  ¬´Y¬ª   ¬´*¬ª </li></ul><br>        <b>base64</b>   ,    . <br><br>     ,   : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iv/rw/jv/ivrwjvwtjyflx73jxnzyedtgqxw.png"></div><br><h3>   <br></h3><br>       ,      -.           TLD.       ,       . <br><br>      ,      jQuery ( <b>slickjs[.]org</b>  ,   <b>slick.js</b> ),   ( <b>sagecdn[.]org</b>  ,    Sage Pay). <br><br>     ,          ,    . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nc/8p/mc/nc8pmckp6ig-wh6zqiflqsvvuv8.png"></div><br>    ,     <b>/js</b>  <b>/src</b> .      :       .        ,                . <br><br><h3>   <br></h3><br><h4>    <br></h4><br>  In einigen erkannten Sniffer-Beispielen dieser Familie war der Code verschleiert und enthielt die verschl√ºsselten Daten, die f√ºr das Funktionieren des Sniffers erforderlich sind: insbesondere die Adresse des Sniffer-Gates, eine Liste von Zahlungsformularfeldern und in einigen F√§llen einen gef√§lschten Zahlungsformularcode.  Im Code innerhalb der Funktion wurden die Ressourcen mit <b>XOR unter</b> Verwendung des Schl√ºssels verschl√ºsselt, der vom Argument derselben Funktion √ºbergeben wurde. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/uu/io/h2/uuioh2egdec0k1wpsa4wxti_1qc.png"></div><br>  Nachdem Sie die Zeichenfolge mit dem entsprechenden Schl√ºssel entschl√ºsselt haben, der f√ºr jedes Beispiel eindeutig ist, k√∂nnen Sie eine Zeichenfolge mit allen Zeilen aus dem Sniffer-Code √ºber das Trennzeichen erhalten. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yi/ma/ch/yimachmb5zfakdeqn-u4v-dwesc.png"></div><br><h4>  Zweiter Verschleierungsalgorithmus <br></h4><br>  In sp√§teren Sniffer-Beispielen dieser Familie wurde ein anderer Verschleierungsmechanismus verwendet: In diesem Fall wurden die Daten mit einem selbstgeschriebenen Algorithmus verschl√ºsselt.  Eine Zeichenfolge mit den verschl√ºsselten Daten, die f√ºr die Funktion des Sniffers erforderlich sind, wurde als Argument an die Entschl√ºsselungsfunktion √ºbergeben. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/co/hs/bi/cohsbisd1wm4g_46sclbiq-wngc.png"></div><br>  √úber die Browserkonsole k√∂nnen Sie die verschl√ºsselten Daten entschl√ºsseln und ein Array mit Sniffer-Ressourcen abrufen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a8/zw/eh/a8zweh8fi_s1p6x-pgl6l7ugfei.png"></div><br><h3>  Verkn√ºpfung mit fr√ºhen MageCart-Angriffen <br></h3><br>  Eine Analyse einer der Dom√§nen, die von der Gruppe als Gate zum Sammeln gestohlener Daten verwendet wurden, ergab, dass die Dom√§ne √ºber eine Infrastruktur f√ºr Kreditkartendiebstahl verf√ºgt, die mit der von Gruppe 1, einer der ersten von RiskIQ-Spezialisten, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">entdeckten</a> Gruppe, identisch ist. <br><br>  Auf dem Host der CoffeMokko-Sniffer-Familie wurden zwei Dateien gefunden: <br><br><ul><li>  <b>mage.js</b> - Datei mit Sniffer-Code der Gruppe 1 mit der Gate-Adresse <b>js-cdn.link</b> </li><li>  <b>mag.php</b> - PHP-Skript, das f√ºr das Sammeln von gestohlenen Daten verantwortlich ist </li></ul><br><div class="spoiler">  <b class="spoiler_title">Inhalt der Mage.js-Datei</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/webt/84/mx/99/84mx99wtkbnzni7faierof1lxbs.png"></div></div></div><br>  Es wurde auch festgestellt, dass die fr√ºhesten Domains, die von der Gruppe hinter der CoffeMokko-Sniffer-Familie verwendet wurden, am 17. Mai 2017 registriert wurden: <br><br><ul><li>  <b>link-js [.] link</b> </li><li>  <b>info-js [.] Link</b> </li><li>  <b>track-js [.] Link</b> </li><li>  <b>map-js [.] Link</b> </li><li>  <b>smart-js [.] Link</b> </li></ul><br>  Das Format dieser Dom√§nennamen entspricht den Dom√§nennamen der Gruppe 1, die bei den Angriffen von 2016 verwendet wurden. <br><br>  Aufgrund der festgestellten Tatsachen kann davon ausgegangen werden, dass eine Verbindung zwischen den CoffeMokko-Sniffer-Betreibern und der kriminellen Gruppe der Gruppe 1 besteht.  Vermutlich k√∂nnten CoffeMokko-Betreiber Tools und Software f√ºr Kartendiebstahl von ihren Vorg√§ngern ausleihen.  Es ist jedoch wahrscheinlicher, dass die kriminelle Gruppe, die hinter der Verwendung der CoffeMokko-Familie von Schn√ºfflern steht, dieselben Personen sind, die die Angriffe im Rahmen der Aktivit√§ten der Gruppe 1 ausgef√ºhrt haben. Nach der Ver√∂ffentlichung des ersten Berichts √ºber die Aktivit√§ten der kriminellen Gruppe wurden alle ihre Domain-Namen blockiert und die Tools wurden detailliert untersucht und beschrieben werden.  Die Gruppe war gezwungen, eine Pause einzulegen, ihre internen Tools zu verfeinern und den Sniffer-Code neu zu schreiben, um ihre Angriffe fortzusetzen und unbemerkt zu bleiben. <br><br><div class="spoiler">  <b class="spoiler_title">Die Infrastruktur</b> <div class="spoiler_text"><div class="scrollable-table"><table><tbody><tr><th width="200">  Domain </th><th width="200">  Entdeckungs- / Erscheinungsdatum </th></tr><tr><td align="center">  link-js.link </td><td align="center">  17.05.2017 </td></tr><tr><td align="center">  info-js.link </td><td align="center">  17.05.2017 </td></tr><tr><td align="center">  track-js.link </td><td align="center">  17.05.2017 </td></tr><tr><td align="center">  map-js.link </td><td align="center">  17.05.2017 </td></tr><tr><td align="center">  smart-js.link </td><td align="center">  17.05.2017 </td></tr><tr><td align="center">  adorebeauty.org </td><td align="center">  09/03/2017 </td></tr><tr><td align="center">  security-payment.su </td><td align="center">  09/03/2017 </td></tr><tr><td align="center">  braincdn.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  sagecdn.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  slickjs.org </td><td align="center">  09/04/2017 </td></tr><tr><td align="center">  oakandfort.org </td><td align="center">  09/10/2017 </td></tr><tr><td align="center">  citywlnery.org </td><td align="center">  15.09.2017 </td></tr><tr><td align="center">  dobell.su </td><td align="center">  10/04/2017 </td></tr><tr><td align="center">  childsplayclothing.org </td><td align="center">  31.10.2017 </td></tr><tr><td align="center">  jewsondirect.com </td><td align="center">  11/05/2017 </td></tr><tr><td align="center">  shop-rnib.org </td><td align="center">  15.11.2017 </td></tr><tr><td align="center">  schranklondon.org </td><td align="center">  16.11.2017 </td></tr><tr><td align="center">  misshaus.org </td><td align="center">  28.11.2017 </td></tr><tr><td align="center">  Batterie-force.org </td><td align="center">  01.12.2017 </td></tr><tr><td align="center">  kik-vape.org </td><td align="center">  01.12.2017 </td></tr><tr><td align="center">  greatfurnituretradingco.org </td><td align="center">  12/02/2017 </td></tr><tr><td align="center">  etradesupply.org </td><td align="center">  12/04/2017 </td></tr><tr><td align="center">  replaceemyremote.org </td><td align="center">  12/04/2017 </td></tr><tr><td align="center">  all-about-sneakers.org </td><td align="center">  12/05/2017 </td></tr><tr><td align="center">  mage-checkout.org </td><td align="center">  12/05/2017 </td></tr><tr><td align="center">  nililotan.org </td><td align="center">  12/07/2017 </td></tr><tr><td align="center">  lamoodbighats.net </td><td align="center">  12/08/2017 </td></tr><tr><td align="center">  walletgear.org </td><td align="center">  10.12.2017 </td></tr><tr><td align="center">  dahlie.org </td><td align="center">  12/12/2017 </td></tr><tr><td align="center">  davidsfootwear.org </td><td align="center">  20.12.2017 </td></tr><tr><td align="center">  blackriverimaging.org </td><td align="center">  23.12.2017 </td></tr><tr><td align="center">  exrpesso.org </td><td align="center">  01/02/2018 </td></tr><tr><td align="center">  parks.su </td><td align="center">  01/09/2018 </td></tr><tr><td align="center">  pmtonline.su </td><td align="center">  01/12/2018 </td></tr><tr><td align="center">  ottocap.org </td><td align="center">  15.01.2008 </td></tr><tr><td align="center">  christohperward.org </td><td align="center">  27.01.2008 </td></tr><tr><td align="center">  coffetea.org </td><td align="center">  31.01.2008 </td></tr><tr><td align="center">  energycoffe.org </td><td align="center">  31.01.2008 </td></tr><tr><td align="center">  energytea.org </td><td align="center">  31.01.2008 </td></tr><tr><td align="center">  teacoffe.net </td><td align="center">  31.01.2008 </td></tr><tr><td align="center">  adaptivecss.org </td><td align="center">  03/01/2018 </td></tr><tr><td align="center">  coffemokko.com </td><td align="center">  03/01/2018 </td></tr><tr><td align="center">  londontea.net </td><td align="center">  03/01/2018 </td></tr><tr><td align="center">  ukcoffe.com </td><td align="center">  03/01/2018 </td></tr><tr><td align="center">  labbe.biz </td><td align="center">  20.03.2008 </td></tr><tr><td align="center">  batterynart.com </td><td align="center">  04/03/2018 </td></tr><tr><td align="center">  btosports.net </td><td align="center">  04/09/2018 </td></tr><tr><td align="center">  chicksaddlery.net </td><td align="center">  16.04.2008 </td></tr><tr><td align="center">  paypaypay.org </td><td align="center">  05/11/2018 </td></tr><tr><td align="center">  ar500arnor.com </td><td align="center">  26.05.2008 </td></tr><tr><td align="center">  authorizecdn.com </td><td align="center">  28.05.2008 </td></tr><tr><td align="center">  slickmin.com </td><td align="center">  28.05.2008 </td></tr><tr><td align="center">  bannerbuzz.info </td><td align="center">  06/03/2018 </td></tr><tr><td align="center">  kandypens.net </td><td align="center">  06/08/2018 </td></tr><tr><td align="center">  mylrendyphone.com </td><td align="center">  15.06.2008 </td></tr><tr><td align="center">  freshchat.info </td><td align="center">  07/01/2018 </td></tr><tr><td align="center">  3lift.org </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  abtasty.net </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  mechat.info </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  zoplm.com </td><td align="center">  07/02/2018 </td></tr><tr><td align="center">  zapaljs.com </td><td align="center">  09/02/2018 </td></tr><tr><td align="center">  foodandcot.com </td><td align="center">  15.09.2008 </td></tr><tr><td align="center">  freshdepor.com </td><td align="center">  15.09.2008 </td></tr><tr><td align="center">  swappastore.com </td><td align="center">  15.09.2008 </td></tr><tr><td align="center">  verywellfitnesse.com </td><td align="center">  15.09.2008 </td></tr><tr><td align="center">  elegrina.com </td><td align="center">  18.11.2008 </td></tr><tr><td align="center">  majsurplus.com </td><td align="center">  19.11.2008 </td></tr><tr><td align="center">  top5value.com </td><td align="center">  19.11.2008 </td></tr></tbody></table></div><br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de451792/">https://habr.com/ru/post/de451792/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de451780/index.html">Audit in 60 Minuten - √úberpr√ºfen Sie die Resistenz der Mitarbeiter gegen Phishing-Angriffe durch Sophos Phish Threat kostenlos</a></li>
<li><a href="../de451782/index.html">Windows Subsystem f√ºr Linux (WSL) Version 2: Wie wird es sein? (FAQ)</a></li>
<li><a href="../de451784/index.html">Hybridlaufwerke f√ºr Enterprise-Speicher. Erfahrung mit Seagate EXOS</a></li>
<li><a href="../de451786/index.html">F√ºhren Sie Instrumententests im Firebase-Testlabor durch. Teil 1: iOS-Projekt</a></li>
<li><a href="../de451790/index.html">Die Gefahren der Datenerfassung im Spiel</a></li>
<li><a href="../de451794/index.html">Textur-Einr√ºckungspixel</a></li>
<li><a href="../de451796/index.html">Schreiben einer sicheren Browsererweiterung</a></li>
<li><a href="../de451798/index.html">Datenmigration mit mongoDB und Spring Boot</a></li>
<li><a href="../de451800/index.html">Ein einfaches Sonarmodem herstellen</a></li>
<li><a href="../de451802/index.html">Die .Net Community der Raiffeisenbank l√§dt zu UPD mitap Broadcast ein</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>