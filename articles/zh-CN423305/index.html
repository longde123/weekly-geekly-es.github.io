<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¿ ğŸ• ğŸ§–ğŸ» ç ´åè¡¨ç° ğŸ‘´ â” ğŸ—</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æœ¬è¯´æ˜æ˜¯JPoint 2018ä¼šè®®ä¸Šæˆ‘çš„æŠ¥å‘Šâ€œå¦‚ä½•ç”¨ä½æ•ˆç‡çš„ä»£ç ç ´åæ€§èƒ½â€çš„ä¹¦é¢ç‰ˆæœ¬ã€‚æ‚¨å¯ä»¥åœ¨ä¼šè®®é¡µé¢ä¸Šè§‚çœ‹è§†é¢‘å’Œå¹»ç¯ç‰‡ã€‚ åœ¨æ—¶é—´è¡¨ä¸­ï¼Œè¯¥æŠ¥å‘Šæ ‡æœ‰ä¸€æ¯å†°æ²™ï¼Œå› æ­¤ä¸ä¼šå‡ºç°ä»»ä½•è¶…çº§å¤æ‚çš„æƒ…å†µï¼Œè¿™å¯¹äºåˆå­¦è€…è€Œè¨€æ›´å¯èƒ½ã€‚ 


 æŠ¥å‘Šä¸»é¢˜ï¼š 


- å¦‚ä½•æŸ¥çœ‹ä»£ç ä»¥åœ¨å…¶ä¸­æ‰¾åˆ°ç“¶é¢ˆ 
- å¸¸è§çš„åæ¨¡å¼ 
- ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ç ´åè¡¨ç°</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423305/"><p> æœ¬è¯´æ˜æ˜¯JPoint 2018ä¼šè®®ä¸Šæˆ‘çš„æŠ¥å‘Šâ€œå¦‚ä½•ç”¨ä½æ•ˆç‡çš„ä»£ç ç ´åæ€§èƒ½â€çš„ä¹¦é¢ç‰ˆæœ¬ã€‚æ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨ä¼šè®®é¡µé¢</a>ä¸Šè§‚çœ‹è§†é¢‘å’Œå¹»ç¯ç‰‡ã€‚ åœ¨æ—¶é—´è¡¨ä¸­ï¼Œè¯¥æŠ¥å‘Šæ ‡æœ‰ä¸€æ¯å†°æ²™ï¼Œå› æ­¤ä¸ä¼šå‡ºç°ä»»ä½•è¶…çº§å¤æ‚çš„æƒ…å†µï¼Œè¿™å¯¹äºåˆå­¦è€…è€Œè¨€æ›´å¯èƒ½ã€‚ </p><br><p> æŠ¥å‘Šä¸»é¢˜ï¼š </p><br><ul><li> å¦‚ä½•æŸ¥çœ‹ä»£ç ä»¥åœ¨å…¶ä¸­æ‰¾åˆ°ç“¶é¢ˆ </li><li> å¸¸è§çš„åæ¨¡å¼ </li><li> éæ˜æ˜¾è€™ </li><li> è€™å¼æ—è·¯ </li></ul><br><p> åœ¨åœºå¤–ï¼Œä»–ä»¬æŒ‡å‡ºäº†æŠ¥å‘Šä¸­çš„ä¸€äº›ä¸å‡†ç¡®æ€§/é—æ¼ä¹‹å¤„ï¼Œå¹¶åœ¨æ­¤å¤„æŒ‡å‡ºã€‚ ä¹Ÿæ¬¢è¿å‘è¡¨è¯„è®ºã€‚ </p><a name="habracut"></a><br><h2 id="vliyanie-poryadka-ispolneniya-na-proizvoditelnost"> ç»©æ•ˆå¯¹ç»©æ•ˆçš„å½±å“ </h2><br><p> æœ‰ä¸€ä¸ªç”¨æˆ·ç±»ï¼š </p><br><pre><code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ String name; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age; }</code> </pre> <br><p> æˆ‘ä»¬éœ€è¦å°†å¯¹è±¡å½¼æ­¤è¿›è¡Œæ¯”è¾ƒï¼Œå› æ­¤æˆ‘ä»¬å£°æ˜<code>equals</code>å’Œ<code>hashCode</code>æ–¹æ³•ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lombok.EqualsAndHashCode; <span class="hljs-meta"><span class="hljs-meta">@EqualsAndHashCode</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ String name; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age; }</code> </pre> <br><p> è¯¥ä»£ç æ˜¯å¯è¡Œçš„ï¼Œä½†é—®é¢˜ä¸åŒï¼šè¯¥ä»£ç çš„æ€§èƒ½æ˜¯å¦æœ€ä½³ï¼Ÿ ä¸ºäº†å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬å›æƒ³ä¸€ä¸‹<code>Object::equals</code>æ–¹æ³•çš„åŠŸèƒ½ï¼šä»…å½“æ‰€æ¯”è¾ƒçš„æ‰€æœ‰å­—æ®µéƒ½ç›¸ç­‰æ—¶ï¼Œå®ƒæ‰è¿”å›æ­£ç»“æœï¼Œå¦åˆ™ç»“æœå°†ä¸ºè´Ÿã€‚ æ¢å¥è¯è¯´ï¼Œä¸€ä¸ªå·®å¼‚å·²ç»è¶³ä»¥äº§ç”Ÿè´Ÿé¢ç»“æœã€‚ </p><br><p> æŸ¥çœ‹ä¸º<code>@EqualsAndHashCode</code>ç”Ÿæˆçš„ä»£ç å<code>@EqualsAndHashCode</code>æˆ‘ä»¬å°†çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹å†…å®¹ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object that)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//... if (name == null &amp;&amp; that.name != null) { return false; } if (name != null &amp;&amp; !name.equals(that.name)) { return false; } return age == that.age; }</span></span></code> </pre> <br><p> æ£€æŸ¥å­—æ®µçš„é¡ºåºä¸å®ƒä»¬å£°æ˜çš„é¡ºåºç›¸å¯¹åº”ï¼Œåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œè¿™ä¸æ˜¯æœ€ä½³è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºä½¿ç”¨<code>equals</code>æ¯”è¾ƒå¯¹è±¡æ¯”æ¯”è¾ƒç®€å•ç±»å‹â€œéš¾â€ã€‚ </p><br><p> å¥½çš„ï¼Œè®©æˆ‘ä»¬å°è¯•ä½¿ç”¨Ideaåˆ›å»º<code>equals/hashCode</code>æ–¹æ³•ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object o)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == o) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || getClass() != o.getClass()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } User that = (User) o; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> age == that.age &amp;&amp; Objects.equals(name, that.name); }</code> </pre> <br><p> ä¸€ä¸ªæƒ³æ³•åˆ›å»ºäº†æ›´æ™ºèƒ½çš„ä»£ç ï¼Œè¯¥ä»£ç çŸ¥é“æ¯”è¾ƒä¸åŒç±»å‹çš„æ•°æ®çš„å¤æ‚æ€§ã€‚ å¥½å§ï¼Œæˆ‘ä»¬å°†<code>@EqualsAndHashCode</code> ï¼Œå¹¶å°†æ˜¾å¼ç¼–å†™<code>equals/hashCode</code> ã€‚ ç°åœ¨ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ç±»æ‰©å±•æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼š </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class"> </span></span>{ List&lt;T&gt; props; String name; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age; }</code> </pre> <br><p> é‡æ–°åˆ›å»º<code>equals/hashCode</code> ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object o)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == o) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> || getClass() != o.getClass()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } User that = (User) o; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> age == that.age &amp;&amp; Objects.equals(props, that.props) <span class="hljs-comment"><span class="hljs-comment">// &lt;---- &amp;&amp; Objects.equals(name, that.name); }</span></span></code> </pre> <br><p> åœ¨æ¯”è¾ƒå­—ç¬¦ä¸²ä¹‹å‰å…ˆæ¯”è¾ƒåˆ—è¡¨ï¼Œè¿™åœ¨å­—ç¬¦ä¸²ä¸åŒæ—¶æ²¡æœ‰æ„ä¹‰ã€‚ ä¹ä¸€çœ‹å¹¶æ²¡æœ‰å¤ªå¤§åŒºåˆ«ï¼Œå› ä¸ºç­‰é•¿å­—ç¬¦ä¸²é€šè¿‡ç¬¦å·è¿›è¡Œæ¯”è¾ƒï¼ˆå³ï¼Œæ¯”è¾ƒæ—¶é—´éšå­—ç¬¦ä¸²é•¿åº¦çš„å¢é•¿è€Œå¢åŠ ï¼‰ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">æœ‰ä¸€ä¸ªä¸å‡†ç¡®çš„åœ°æ–¹</b> <div class="spoiler_text"><p>  <code>java.lang.String::equals</code> <a href="">æ–¹æ³•æ˜¯ä¾µå…¥å¼çš„</a> ï¼Œå› æ­¤åœ¨æ‰§è¡Œæ—¶æ²¡æœ‰ç™»å½•æ¯”è¾ƒã€‚ </p></div></div><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//java.lang.String public boolean equals(Object anObject) { if (this == anObject) { return true; } if (anObject instanceof String) { String anotherString = (String) anObject; int n = value.length; if (n == anotherString.value.length) { char v1[] = value; char v2[] = anotherString.value; int i = 0; while (n-- != 0) { // &lt;---- if (v1[i] != v2[i]) return false; i++; } return true; } } return false; }</span></span></code> </pre> <br><p> ç°åœ¨è€ƒè™‘æ¯”è¾ƒä¸¤ä¸ª<code>ArrayList</code> ï¼ˆä½œä¸ºæœ€å¸¸ç”¨çš„åˆ—è¡¨å®ç°ï¼‰ã€‚ æ£€æŸ¥<code>ArrayList</code> ï¼Œæˆ‘ä»¬å¾ˆæƒŠè®¶åœ°å‘ç°å®ƒæ²¡æœ‰è‡ªå·±çš„<code>equals</code>å®ç°ï¼Œä½†æ˜¯ä½¿ç”¨äº†ç»§æ‰¿çš„å®ç°ï¼š </p><br><p><img src="https://habrastorage.org/webt/d4/hn/yg/d4hnyguezlpyxz3pgunk22ha1cm.png"></p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//AbstractList::equals public boolean equals(Object o) { if (o == this) { return true; } if (!(o instanceof List)) { return false; } ListIterator&lt;E&gt; e1 = listIterator(); ListIterator&lt;?&gt; e2 = ((List&lt;?&gt;) o).listIterator(); while (e1.hasNext() &amp;&amp; e2.hasNext()) { // &lt;---- E o1 = e1.next(); Object o2 = e2.next(); if (!(o1 == null ? o2 == null : o1.equals(o2))) { return false; } } return !(e1.hasNext() || e2.hasNext()); }</span></span></code> </pre> <br><p> è¿™é‡Œé‡è¦çš„æ˜¯åˆ›å»ºä¸¤ä¸ªè¿­ä»£å™¨å¹¶æˆå¯¹é€šè¿‡å®ƒä»¬ã€‚ å‡è®¾æœ‰ä¸¤ä¸ª<code>ArrayList</code> ï¼š </p><br><ul><li> ä»1åˆ°99çš„ä¸€ä¸ªæ•°å­— </li><li> ä»1åˆ°100çš„ç¬¬äºŒä¸ªæ•°å­— </li></ul><br><p> ç†æƒ³æƒ…å†µä¸‹ï¼Œæ¯”è¾ƒä¸¤ä¸ªåˆ—è¡¨çš„å¤§å°å°±è¶³å¤Ÿäº†ï¼Œå¦‚æœå®ƒä»¬ä¸é‡åˆï¼Œç«‹å³è¿”å›è´Ÿç»“æœï¼ˆå°±åƒ<code>AbstractSet</code>ä¸€æ ·ï¼‰ï¼Œå®é™…ä¸Šï¼Œå°†æ‰§è¡Œ99ä¸ªæ¯”è¾ƒï¼Œå¹¶ä¸”ä»…åœ¨ååˆ†ä¹‹ä¸€æ—¶å°±å¯ä»¥æ¸…æ¥šçœ‹å‡ºåˆ—è¡¨æ˜¯ä¸åŒçš„ã€‚ </p><br><h4 id="chyo-tam-u-kotlinovcev">  Kotlinitesæœ‰ä»€ä¹ˆï¼Ÿ </h4><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span></span>(<span class="hljs-keyword"><span class="hljs-keyword">val</span></span> name: String, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> age: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>);</code> </pre> <br><p> è¿™é‡Œçš„ä¸€åˆ‡å°±åƒé¾™ç›®å²›-æ¯”è¾ƒé¡ºåºå¯¹åº”äºå…¬å‘Šçš„é¡ºåºï¼š </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">equals</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Object o)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> == o) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (o <span class="hljs-keyword"><span class="hljs-keyword">instanceof</span></span> User) { User u = (User) o; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Intrinsics.areEqual(name, u.name) &amp;&amp; age == u.age) { <span class="hljs-comment"><span class="hljs-comment">// &lt;---- return true; } } return false; }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">æƒ…å†µå¦‚ä½•æ”¹å–„ï¼Ÿ</b>  <b class="spoiler_title">-æŠ±æ€¨ï¼</b> <div class="spoiler_text"><p>  IDEA-170178é›†åˆçš„æ¯”è¾ƒåº”åœ¨IDEAç”Ÿæˆçš„equalsï¼ˆï¼‰çš„æœ€åæ‰§è¡Œ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-170178</a> </p><br><p>  @EqualsAndHashCodeä¸­çš„æ¯”è¾ƒé‡æ–°æ’åºä»¥æé«˜æ€§èƒ½ï¼ƒ1543 <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://github.com/rzwitserloot/lombok/issues/1543</a> </p><br><p>  KT-23184è‡ªåŠ¨ç”Ÿæˆçš„equalsï¼ˆï¼‰æ•°æ®ç±»ä¸æ˜¯æœ€ä½³çš„ <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/KT-23184</a> </p></div></div><br><p> è§£å†³æ–¹æ³•æ˜¯ï¼Œæ‚¨å¯ä»¥æ‰‹åŠ¨ç»„ç»‡å­—æ®µå£°æ˜ã€‚ </p><br><h4 id="uslozhnim-zadachu"> è®©ä»»åŠ¡å¤æ‚åŒ– </h4><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Dto dto)</span></span></span><span class="hljs-function"> </span></span>{ SomeEntity entity = jpaRepository.findOne(dto.getId()); <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> valid = dto.isValid(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (valid &amp;&amp; entity.hasGoodRating()) { <span class="hljs-comment"><span class="hljs-comment">// &lt;---- //do smth } }</span></span></code> </pre> <br><p> è¯¥ä»£ç åŒ…æ‹¬å³ä½¿äº‹å…ˆå¯ä»¥ç¡®å®šç®­å¤´æŒ‡ç¤ºçš„æ¡ä»¶çš„æ£€æŸ¥ç»“æœä¹Ÿè¦è®¿é—®æ•°æ®åº“ã€‚ å¦‚æœ<code>valid</code>å˜é‡çš„å€¼ä¸ºfalseï¼Œåˆ™<code>if</code>å—ä¸­çš„ä»£ç å°†æ°¸è¿œä¸ä¼šæ‰§è¡Œï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥åœ¨æ²¡æœ‰è¯·æ±‚çš„æƒ…å†µä¸‹è¿›è¡Œæ“ä½œï¼š </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">check</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Dto dto)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> valid = dto.isValid(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (valid &amp;&amp; hasGoodRating(dto)) { <span class="hljs-comment"><span class="hljs-comment">//do smth } } //       ,    boolean hasGoodRating(Dto dto) { SomeEntity entity = jpaRepository.findOne(dto.getId()); return entity.hasGoodRating(); }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">è¯·æ³¨æ„</b> <div class="spoiler_text"><p> å½“ä»<code>JpaRepository::findOne</code>è¿”å›çš„å®ä½“å·²ç»åœ¨ç¬¬ä¸€çº§çš„ç¼“å­˜ä¸­æ—¶ï¼Œä¸‹æ²‰å°±å¯ä»¥å¿½ç•¥ä¸è®¡äº†-è¿™æ ·å°±ä¸ä¼šæœ‰è¯·æ±‚äº†ã€‚ </p></div></div><br><p> æ²¡æœ‰æ˜¾å¼åˆ†æ”¯çš„ç±»ä¼¼ç¤ºä¾‹ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkChild</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Dto dto)</span></span></span><span class="hljs-function"> </span></span>{ Long id = dto.getId(); Entity entity = jpaRepository.findOne(id); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dto.isValid() &amp;&amp; entity.hasChild(); }</code> </pre> <br><p> å¿«é€Ÿè¿”å›å¯è®©æ‚¨å»¶è¿Ÿè¯·æ±‚ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkChild</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Dto dto)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!dto.isValid()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> jpaRepository.findOne(dto.getId()).hasChild(); }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">æŠ¥å‘Šä¸­æœªå‡ºç°çš„ç›¸å½“æ˜æ˜¾çš„è¡¥å……</b> <div class="spoiler_text"><p> å‡è®¾æŸå¼ æ”¯ç¥¨ä½¿ç”¨ç±»ä¼¼çš„å®ä½“ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ParentEntity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@ManyToOne</span></span>(fetch = LAZY) <span class="hljs-meta"><span class="hljs-meta">@JoinColumn</span></span>(name = <span class="hljs-string"><span class="hljs-string">"CHILD_ID"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ChildEntity child; <span class="hljs-meta"><span class="hljs-meta">@Enumerated</span></span>(EnumType.String) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SomeType type;</code> </pre> <br><p> å¦‚æœæ£€æŸ¥ä½¿ç”¨ç›¸åŒçš„å®ä½“ï¼Œåˆ™åº”ç¡®ä¿åœ¨å¯¹å·²åŠ è½½çš„å­—æ®µçš„è°ƒç”¨ä¹‹åæ‰§è¡Œå¯¹â€œæƒ°æ€§â€å­å®ä½“/é›†åˆçš„è°ƒç”¨ã€‚ ä¹ä¸€çœ‹ï¼Œä¸€ä¸ªé¢å¤–çš„è¯·æ±‚ä¸ä¼šå¯¹æ•´ä½“æƒ…å†µäº§ç”Ÿé‡å¤§å½±å“ï¼Œä½†æ˜¯å½“ä¸€ä¸ªåŠ¨ä½œåœ¨ä¸€ä¸ªå¾ªç¯ä¸­æ‰§è¡Œæ—¶ï¼Œä¸€åˆ‡éƒ½ä¼šæ”¹å˜ã€‚ </p></div></div><br><p> ç»“è®ºï¼šåº”è¯¥æŒ‰é¡ºåºå¢åŠ æ“ä½œ/æ£€æŸ¥çš„é¡ºåºï¼Œä»¥å¢åŠ å•ä¸ªæ“ä½œçš„å¤æ‚æ€§ï¼Œä¹Ÿè®¸å…¶ä¸­æŸäº›æ“ä½œå°†ä¸å¿…æ‰§è¡Œã€‚ </p><br><h2 id="cikly-i-massovaya-obrabotka"> å‘¨æœŸå’Œæ‰¹é‡å¤„ç† </h2><br><p> ä»¥ä¸‹ç¤ºä¾‹ä¸éœ€è¦ç‰¹æ®Šè¯´æ˜ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enrollStudents</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Set&lt;Long&gt; ids)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long id : ids) { Student student = jpaRepository.findOne(id); <span class="hljs-comment"><span class="hljs-comment">// &lt;---- O(n) enroll(student); } }</span></span></code> </pre> <br><p> ç”±äºå­˜åœ¨å¤šä¸ªæ•°æ®åº“æŸ¥è¯¢ï¼Œå› æ­¤ä»£ç è¿è¡Œç¼“æ…¢ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">å¤‡æ³¨</b> <div class="spoiler_text"><p> å¦‚æœåœ¨äº‹åŠ¡å¤–éƒ¨æ‰§è¡Œ<code>enrollStudents</code>æ–¹æ³•ï¼Œ <code>enrollStudents</code>æ€§èƒ½ä¼šè¿›ä¸€æ­¥<code>enrollStudents</code> ï¼šç„¶åï¼Œå¯¹<code>osdjrJpaRepository::findOne</code> <strong>æ¯æ¬¡</strong>è°ƒç”¨å°†åœ¨æ–°äº‹åŠ¡ä¸­æ‰§è¡Œï¼ˆè¯·å‚è§<a href="">SimpleJpaRepository</a> ï¼‰ï¼Œè¿™æ„å‘³ç€æ¥æ”¶å¹¶è¿”å›ä¸æ•°æ®åº“çš„è¿æ¥ï¼Œä»¥åŠåˆ›å»ºå’Œåˆ·æ–°ç¬¬ä¸€çº§ç¼“å­˜ã€‚ </p></div></div><br><p> ä¿®æ­£ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enrollStudents</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Set&lt;Long&gt; ids)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ids.isEmpty()) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Student student : jpaRepository.findAll(ids)) { enroll(student); } }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">è®©æˆ‘ä»¬æµ‹é‡ä¸€ç»„é”®ï¼ˆ10å’Œ100ä¸ªï¼‰çš„è¿è¡Œæ—¶é—´ï¼ˆä»¥å¾®ç§’ä¸ºå•ä½ï¼‰</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/p2/0b/zq/p20bzq2tlnp3-mj8zlx8c96411e.png"></p></div></div><br><p>  <a href="">åŸºå‡†æµ‹è¯•</a> </p><br><div class="spoiler">  <b class="spoiler_title">å¤‡æ³¨</b> <div class="spoiler_text"><p> å¦‚æœä½¿ç”¨Oracleå¹¶ä¼ é€’è¶…è¿‡1000ä¸ªé”®æ¥<code>findAll</code> ï¼Œåˆ™å°†è·å¾—å¼‚å¸¸<code>ORA-01795: maximum number of expressions in a list is 1000</code> ã€‚ <br> åŒæ ·ï¼Œåœ¨-æŸ¥è¯¢ä¸­æ‰§è¡Œç¹é‡çš„æ“ä½œï¼ˆå…·æœ‰è®¸å¤šé”®ï¼‰å¯èƒ½æ¯”næ¬¡æŸ¥è¯¢æ›´ç³Ÿç³•ã€‚ è¿™å®Œå…¨å–å†³äºç‰¹å®šçš„åº”ç”¨ç¨‹åºï¼Œå› æ­¤å°†å¾ªç¯æœºæ¢°æ›¿æ¢ä¸ºæ‰¹é‡å¤„ç†ä¼šé™ä½æ€§èƒ½ã€‚ </p></div></div><br><h4 id="bolee-slozhnyy-primer-na-tu-zhe-temu"> å…³äºåŒä¸€ä¸»é¢˜çš„æ›´å¤æ‚çš„ç¤ºä¾‹ </h4><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long id : ids) { Region region = jpaRepository.findOne(id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (region == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// &lt;----  region = new Region(); region.setId(id); } use(region); }</span></span></code> </pre> <br><p> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸èƒ½ç”¨<code>JpaRepository::findAll</code>æ›¿æ¢å¾ªç¯ï¼Œ <code>JpaRepository::findAll</code>è¿™å°†ç ´åé€»è¾‘ï¼šä»<code>JpaRepository::findAll</code>è·å¾—çš„æ‰€æœ‰å€¼éƒ½ä¸ä¼šä¸º<code>null</code> ï¼Œå¹¶ä¸”<code>if</code>å—å°†ä¸èµ·ä½œç”¨ã€‚ </p><br><p> å¯¹äºæ¯ä¸ªæ•°æ®åº“å¯†é’¥ï¼Œè¿™ä¸€äº‹å®å°†å¸®åŠ©æˆ‘ä»¬è§£å†³è¿™ä¸€éš¾é¢˜ <br> è¿”å›å®é™…å€¼æˆ–ä¸å­˜åœ¨çš„å€¼ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œä»æŸç§æ„ä¹‰ä¸Šè¯´ï¼Œæ•°æ®åº“å°±æ˜¯å­—å…¸ã€‚ åŒ…è£…ç›’ä¸­çš„Javaä¸ºæˆ‘ä»¬æä¾›äº†å­—å…¸çš„ç°æˆå®ç°<code>HashMap</code>åœ¨å…¶ä¹‹ä¸Šï¼Œæˆ‘ä»¬å°†æ„å»ºç”¨äºæ›¿æ¢æ•°æ®åº“çš„é€»è¾‘ï¼š </p><br><pre> <code class="java hljs">Map&lt;Long, Region&gt; regionMap = jpaRepository.findAll(ids) .stream() .collect(Collectors.toMap(Region::getId, Function.identity())); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long id : ids) { Region region = map.get(id); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (region == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { region = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Region(); region.setId(id); } use(region); }</code> </pre> <br><h4 id="primer-v-obratnuyu-storonu"> åä¾‹ </h4><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// class Saver @Transactional(propagation = Propagation.REQUIRES_NEW) public void save(List&lt;AuditEntity&gt; entities) { jpaRepository.save(entities); }</span></span></code> </pre> <br><p> æ­¤ä»£ç å§‹ç»ˆåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡æ¥ä¿å­˜å®ä½“åˆ—è¡¨ã€‚ ä¸‹å‚å§‹äºå¤šæ¬¡è°ƒç”¨æ‰“å¼€æ–°äº‹åŠ¡çš„æ–¹æ³•ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//   @Transactional public void audit(List&lt;AuditDto&gt; inserts) { inserts.map(this::toEntities).forEach(saver::save); // &lt;---- } // class Saver @Transactional(propagation = Propagation.REQUIRES_NEW) // &lt;---- public void save(List&lt;AuditEntity&gt; entities) { jpaRepository.save(entities); }</span></span></code> </pre> <br><p> è§£å†³æ–¹æ¡ˆï¼šç«‹å³å¯¹æ•´ä¸ªæ•°æ®é›†åº”ç”¨<code>Saver::save</code>æ–¹æ³•ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">audit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;AuditDto&gt; inserts)</span></span></span><span class="hljs-function"> </span></span>{ List&lt;AuditEntity&gt; bulk = inserts .map(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::toEntities) .flatMap(List::stream) <span class="hljs-comment"><span class="hljs-comment">// &lt;---- .collect(toList()); saver.save(bulk); }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">è®¸å¤šäº‹åŠ¡åˆå¹¶ä¸ºä¸€ä¸ªï¼Œè¿™å¸¦æ¥äº†æ˜æ˜¾çš„å¢é•¿ï¼ˆæ—¶é—´ä»¥å¾®ç§’ä¸ºå•ä½ï¼‰ï¼š</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/f7/3r/n9/f73rn9gtjw7fdgiqrfwkq7tfme4.png"></p></div></div><br><p>  <a href="">åŸºå‡†æµ‹è¯•</a> </p><br><p> å…·æœ‰å¤šä¸ªäº‹åŠ¡çš„ç¤ºä¾‹å¾ˆéš¾å½¢å¼åŒ–ï¼Œè¿™ä¸èƒ½è¯´æ˜¯åœ¨å¾ªç¯ä¸­è°ƒç”¨<code>JpaRepository::findOne</code> ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">å› æ­¤ï¼Œæˆ‘ä»¬å°†é‡‡å–æªæ–½</b> <div class="spoiler_text"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-165730</a> <br>  IDEA-165730è­¦å‘ŠJpaRepositoryä½¿ç”¨æ•ˆç‡ä½ä¸‹ </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-165942</a> <br><del>  IDEA-165942 </del> æ£€æŸ¥ä»¥æ‰¹é‡æ“ä½œæ›¿æ¢å¾ªç¯ä¸­çš„æ–¹æ³•è°ƒç”¨ <br>  <strong>å›ºå®šäº2017.1</strong> </p></div></div><br><p> è¯¥æ–¹æ³•ä¸ä»…é€‚ç”¨äºæ•°æ®åº“ï¼Œå› æ­¤Tagir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">lany</a> Valeevèµ°å¾—æ›´è¿œã€‚ å¦‚æœæ›´æ—©äº›ï¼Œæˆ‘ä»¬è¿™æ ·å†™ï¼š </p><br><pre> <code class="java hljs">List&lt;Long&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Long id : items) { list.add(id); }</code> </pre> <br><p> ä¸€åˆ‡éƒ½å¾ˆå¥½ï¼Œç°åœ¨â€œæƒ³æ³•â€å»ºè®®çº æ­£è‡ªå·±ï¼š </p><br><pre> <code class="java hljs">List&lt;Long&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); list.addAll(items);</code> </pre> <br><p> ä½†æ˜¯ï¼Œå³ä½¿æ­¤é€‰é¡¹ä¹Ÿä¸æ€»æ˜¯ä»¤äººæ»¡æ„ï¼Œå› ä¸ºæ‚¨å¯ä»¥ä½¿å…¶æ›´çŸ­ï¼Œæ›´å¿«ï¼š </p><br><pre> <code class="java hljs">List&lt;Long&gt; list = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(items);</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">æ¯”è¾ƒï¼ˆä»¥nsä¸ºå•ä½çš„æ—¶é—´ï¼‰</b> <div class="spoiler_text"><p> å¯¹äºArrayListï¼Œæ­¤æ”¹è¿›æ˜¾ç€å¢åŠ äº†ï¼š </p><br><p><img src="https://habrastorage.org/webt/gi/6j/o8/gi6jo8xwigpdckqz6jtuw4cmane.png"></p><br><p> å¯¹äºHashSetï¼Œå®ƒå¹¶ä¸é‚£ä¹ˆä¹è§‚ï¼š </p><br><p><img src="https://habrastorage.org/webt/u9/lo/fy/u9lofyf2wy2hffk8gd0uwvrmmke.png"></p></div></div><br><p>  <a href="">åŸºå‡†æµ‹è¯•</a> </p><br><div class="spoiler">  <b class="spoiler_title">å¯¹å¼€å‘äººå‘˜æœ‰ç”¨ï¼š</b> <div class="spoiler_text"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-138456</a> <br><del> æƒ³æ³•138456 </del> æ–°æ£€æŸ¥ï¼šCollection.addAllï¼ˆï¼‰å¯æ›¿æ¢ä¸ºå‚æ•°åŒ–æ„é€ å‡½æ•° <br>  <strong>å·²åœ¨142.1217ä¸­ä¿®å¤</strong> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-178761</a> <br><del>  IDEA-178761 </del> æ£€æŸ¥'Collection.addAllï¼ˆï¼‰å¯æ›¿æ¢ä¸ºå‚æ•°åŒ–æ„é€ å‡½æ•°'åº”è¯¥é»˜è®¤æ‰“å¼€ <br>  <strong>å›ºå®šäº2017.3</strong> </p></div></div><br><h4 id="udalenie-iz-arraylist-a"> ä»<code>ArrayList</code>åˆ é™¤ </h4><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = from; i &lt; to; i++) { list.remove(from); }</code> </pre> <br><p> é—®é¢˜åœ¨äºå®ç°<code>List::remove</code>æ–¹æ³•ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> E </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">remove</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> index)</span></span></span><span class="hljs-function"> </span></span>{ Objects.checkIndex(index, size); modCount++; E oldValue = elementData(index); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> numMoved = size - index - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (numMoved &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { System.arraycopy(array, index + <span class="hljs-number"><span class="hljs-number">1</span></span>, array, index, numMoved); <span class="hljs-comment"><span class="hljs-comment">// &lt;---- } array[--size] = null; // clear to let GC do its work return oldValue; }</span></span></code> </pre> <br><p> è§£å†³æ–¹æ¡ˆï¼š </p><br><pre> <code class="java hljs">list.subList(from, to).clear();</code> </pre> <br><p> ä½†æ˜¯ï¼Œå¦‚æœæºä»£ç ä¸­ä½¿ç”¨äº†è¿œç¨‹å€¼ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿ </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = from; i &lt; to; i++) { E removed = list.remove(from); use(removed); }</code> </pre> <br><p> ç°åœ¨ï¼Œæ‚¨éœ€è¦é¦–å…ˆæµè§ˆæ¸…é™¤åˆ—è¡¨ï¼š </p><br><pre> <code class="java hljs">List&lt;String&gt; removed = list.subList(from, to); removed.forEach(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::use); removed.clear();</code> </pre> <br><p> å¦‚æœæ‚¨ç¡®å®è¦åœ¨å¾ªç¯ä¸­åˆ é™¤ï¼Œåˆ™æ›´æ”¹é€šè¿‡åˆ—è¡¨çš„æ–¹å‘å°†æœ‰åŠ©äºå‡è½»ç—›è‹¦ã€‚ å…¶å«ä¹‰æ˜¯åœ¨æ¸…æ´å•å…ƒåç§»åŠ¨è¾ƒå°‘æ•°é‡çš„å…ƒç´ ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//   , . .       for (int i = from; i &lt; to; i++) { E removed = list.remove(from); use(removed, i); } //  , . .    for (int i = to - 1; i &gt;= from; i--) { E removed = list.remove(i); use(removed, reverseIndex(i)); }</span></span></code> </pre> <br><p> æ¯”è¾ƒæ‰€æœ‰ä¸‰ç§æ–¹æ³•ï¼ˆåœ¨åˆ—ä¸‹æ–¹æ˜¯å¤§å°ä¸º100çš„åˆ—è¡¨ä¸­å·²åˆ é™¤é¡¹ç›®çš„ç™¾åˆ†æ¯”ï¼‰ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">Java 8</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/4h/ii/tq/4hiitqg5a7d3bk6lxi8od422yky.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Java 9</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ow/mo/ty/owmotysgwdqquagklf1yhlrquz0.png"></p></div></div><br><p> é¡ºä¾¿è¯´ä¸€å¥ï¼Œæœ‰äººæ³¨æ„åˆ°å¼‚å¸¸äº†å—ï¼Ÿ </p><br><div class="spoiler">  <b class="spoiler_title">çœ‹</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xm/ni/s9/xmnis9jllk8rozgh8xacdneyhd8.png"></p><br><p> å¦‚æœæˆ‘ä»¬åˆ é™¤ä»æœ«å°¾ç§»åŠ¨çš„æ‰€æœ‰æ•°æ®çš„ä¸€åŠï¼Œé‚£ä¹ˆæœ€åä¸€ä¸ªå…ƒç´ å°†å§‹ç»ˆè¢«åˆ é™¤ï¼Œå¹¶ä¸”æ²¡æœ‰ç§»ä½ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// ArrayList public E remove(int index) { rangeCheck(index); modCount++; E oldValue = elementData(index); int numMoved = size - index - 1; if (numMoved &gt; 0) { // &lt;----     System.arraycopy(elementData, index+1, elementData, index, numMoved); } elementData[--size] = null; // clear to let GC do its work return oldValue; }</span></span></code> </pre> </div></div><br><p>  <a href="">åŸºå‡†æµ‹è¯•</a> </p><br><div class="spoiler">  <b class="spoiler_title">å¯¹å¼€å‘è€…æœ‰ç”¨</b> <div class="spoiler_text"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-177466</a> <br><del> æƒ³æ³•-177466 </del> æ£€æµ‹åœ¨å¾ªç¯ä¸­è°ƒç”¨çš„List.removeï¼ˆç´¢å¼•ï¼‰ <br>  <strong>å·²äº2018.2ä¿®å¤</strong> </p></div></div><br><p> ç»“è®ºï¼šæ‰¹é‡æ“ä½œé€šå¸¸æ¯”å•ä¸ªæ“ä½œæ›´å¿«ã€‚ </p><br><h2 id="oblast-vidimosti-i-proizvoditelnost"> èŒƒå›´å’Œè¡¨ç° </h2><br><p> æ­¤ä»£ç ä¸éœ€è¦ä»»ä½•ç‰¹æ®Šè¯´æ˜ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">leaveForTheSecondYear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ List&lt;Student&gt; naughty = repository.findNaughty(); List&lt;Student&gt; underAchieving = repository.findUnderAchieving(); <span class="hljs-comment"><span class="hljs-comment">// &lt;---- if (settings.leaveBothCategories()) { leaveForTheSecondYear(naughty, underAchieving); // &lt;---- return; } leaveForTheSecondYear(naughty); }</span></span></code> </pre> <br><p> æˆ‘ä»¬ç¼©å°èŒƒå›´ï¼Œè¿™ç»™äº†å‡å·1çš„æŸ¥è¯¢ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">leaveForTheSecondYear</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ List&lt;Student&gt; naughty = repository.findNaughty(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Settings.leaveBothCategories()) { List&lt;Student&gt; underAchieving = repository.findUnderAchieving(); <span class="hljs-comment"><span class="hljs-comment">// &lt;---- leaveForTheSecondYear(naughty, underAchieving); // &lt;---- return; } leaveForTheSecondYear(naughty); }</span></span></code> </pre> <br><p> åœ¨è¿™é‡Œï¼Œç»†å¿ƒçš„è¯»è€…åº”è¯¥é—®ï¼šé™æ€åˆ†æå¦‚ä½•ï¼Ÿ ä¸ºä»€ä¹ˆIdeaä¸å‘Šè¯‰æˆ‘ä»¬è¡¨é¢ä¸Šçš„æ”¹è¿›ï¼Ÿ </p><br><p> äº‹å®æ˜¯é™æ€åˆ†æçš„å¯èƒ½æ€§æ˜¯æœ‰é™çš„ï¼šå¦‚æœè¯¥æ–¹æ³•å¾ˆå¤æ‚ï¼ˆç‰¹åˆ«æ˜¯ä¸æ•°æ®åº“äº¤äº’ï¼‰å¹¶ä¸”å½±å“äº†å¸¸è§„çŠ¶æ€ï¼Œé‚£ä¹ˆè½¬ç§»å…¶æ‰§è¡Œå¯èƒ½ä¼šç ´ååº”ç”¨ç¨‹åºã€‚ é™æ€åˆ†æå™¨èƒ½å¤ŸæŠ¥å‘Šéå¸¸ç®€å•çš„æ‰§è¡Œï¼Œä¾‹å¦‚ï¼Œåœ¨å—å†…çš„ä¼ è¾“ä¸ä¼šç ´åä»»ä½•å†…å®¹ã€‚ </p><br><p> æ‚¨å¯ä»¥å°†å˜é‡çªå‡ºæ˜¾ç¤ºç”¨ä½œeratzï¼Œä½†å†æ¬¡ä½¿ç”¨å®ƒæ—¶è¦å°å¿ƒï¼Œå› ä¸ºæ€»æ˜¯å¯èƒ½äº§ç”Ÿå‰¯ä½œç”¨ã€‚ æ‚¨å¯ä»¥ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">jetbrains-annotations</a>åº“ä¸­æä¾›çš„æ³¨è§£<code>@org.jetbrains.annotations.Contract(pure = true)</code>æ¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æŒ‡ç¤ºæ— çŠ¶æ€</a>æ–¹æ³•ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// com.intellij.util.ArrayUtil @Contract(pure = true) public static int find(@NotNull int[] src, int obj) { return indexOf(src, obj); }</span></span></code> </pre> <br><p> ç»“è®ºï¼šè¿‡å¤šçš„å·¥ä½œåªä¼šä½¿æ€§èƒ½æ¶åŒ–ï¼Œè¿™ç§æƒ…å†µå¸¸å¸¸å‘ç”Ÿã€‚ </p><br><h2 id="samyy-neobychnyy-primer"> æœ€ä¸å¯»å¸¸çš„ä¾‹å­ </h2><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Service</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RemoteService</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ContractCounter contractCounter; <span class="hljs-meta"><span class="hljs-meta">@Transactional</span></span>(readOnly = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) <span class="hljs-comment"><span class="hljs-comment">// &lt;---- public int countContracts(Dto dto) { if (dto.isInvalid()) { return -1; // &lt;---- } return contractCounter.countContracts(dto); } }</span></span></code> </pre> <br><p> å³ä½¿ä¸éœ€è¦äº‹åŠ¡ï¼ˆæ­¤æ–¹æ³•çš„å¿«é€Ÿè¿”å›-1ï¼‰ï¼Œæ­¤å®ç°ä¹Ÿä¼šæ‰“å¼€äº‹åŠ¡ã€‚ </p><br><p> æ‚¨éœ€è¦åšçš„å°±æ˜¯åœ¨éœ€è¦çš„åœ°æ–¹åˆ é™¤<code>ContractCounter::countContracts</code>å†…çš„äº‹åŠ¡æ€§ï¼Œç„¶åå°†å…¶ä»â€œå¤–éƒ¨â€æ–¹æ³•ä¸­åˆ é™¤ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">æ¯”è¾ƒè¿”å›-1ï¼ˆnsï¼‰æ—¶çš„æ‰§è¡Œæ—¶é—´ï¼š</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/8k/uu/lp/8kuulppcl4vli1c5ir-txozcemi.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">æ¯”è¾ƒå†…å­˜æ¶ˆè€—ï¼ˆå­—èŠ‚ï¼‰ï¼š</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xp/du/ke/xpdukewr4nnooj2vtaktok4ngnm.png"></p></div></div><br><p>  <a href="">åŸºå‡†æµ‹è¯•</a> </p><br><p> ç»“è®ºï¼šæ§åˆ¶å™¨å’Œâ€œå¤–å‘â€æœåŠ¡éœ€è¦æ‘†è„±äº‹åŠ¡æ€§ï¼ˆè¿™ä¸æ˜¯ä»–ä»¬çš„è´£ä»»ï¼‰ï¼Œå¹¶ä¸”åº”è¯¥åˆ é™¤ä¸éœ€è¦è®¿é—®æ•°æ®åº“å’Œäº‹åŠ¡æ€§ç»„ä»¶çš„è¾“å…¥æ•°æ®éªŒè¯çš„æ•´ä¸ªé€»è¾‘ã€‚ </p><br><h2 id="preobrazovanie-datyvremeni-v-stroku"> å°†æ—¥æœŸ/æ—¶é—´è½¬æ¢ä¸ºå­—ç¬¦ä¸² </h2><br><p> æ°¸æ’çš„ä»»åŠ¡ä¹‹ä¸€æ˜¯å°†æ—¥æœŸ/æ—¶é—´è½¬æ¢ä¸ºå­—ç¬¦ä¸²ã€‚ åœ¨å…«å›½é›†å›¢ä¹‹å‰ï¼Œæˆ‘ä»¬è¿™æ ·åšï¼š </p><br><pre> <code class="java hljs">SimpleDateFormat formatter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleDateFormat(<span class="hljs-string"><span class="hljs-string">"dd.MM.yyyy"</span></span>); String dateAsStr = formatter.format(date);</code> </pre> <br><p> éšç€JDK 8çš„å‘å¸ƒï¼Œæˆ‘ä»¬è·å¾—äº†<code>LocalDate/LocalDateTime</code>ä»¥åŠç›¸åº”çš„<code>DateTimeFormatter</code> </p><br><pre> <code class="java hljs">DateTimeFormatter formatter = ofPattern(<span class="hljs-string"><span class="hljs-string">"dd.MM.yyyy"</span></span>); String dateAsStr = formatter.format(localDate);</code> </pre> <br><p> è®©æˆ‘ä»¬è¡¡é‡ä¸€ä¸‹å®ƒçš„æ€§èƒ½ï¼š </p><br><pre> <code class="java hljs">Date date = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Date(); LocalDate localDate = LocalDate.now(); SimpleDateFormat sdf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SimpleDateFormat(<span class="hljs-string"><span class="hljs-string">"dd.MM.yyyy"</span></span>); DateTimeFormatter dtf = DateTimeFormatter.ofPattern(<span class="hljs-string"><span class="hljs-string">"dd.MM.yyyy"</span></span>); <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">simpleDateFormat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sdf.format(date); } <span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dateTimeFormatter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dtf.format(localDate); }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">æ—¶é—´ï¼ˆnsï¼‰ï¼š</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/zq/jq/sx/zqjqsxjevqpmuckdddvu4gysaoa.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">å†…å­˜ï¼ˆå­—èŠ‚ï¼‰ï¼š</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/9j/yq/sw/9jyqswjtyiwq3i8fkutenvyuj7g.png"></p></div></div><br><p> é—®é¢˜ï¼šå‡è®¾æˆ‘ä»¬çš„æœåŠ¡ä»å¤–éƒ¨æ¥æ”¶æ•°æ®ï¼Œæˆ‘ä»¬ä¸èƒ½æ‹’ç»<code>java.util.Date</code> ã€‚ å¦‚æœå°†<code>LocalDate</code>æ›´å¿«åœ°è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œå°†<code>Date</code>è½¬æ¢ä¸º<code>LocalDate</code>æ˜¯å¦å¯¹æˆ‘ä»¬æœ‰åˆ©ï¼Ÿ è®¡ç®—ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Benchmark</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">measureDateConverted</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Data data)</span></span></span><span class="hljs-function"> </span></span>{ LocalDate localDate = toLocalDate(data.date); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data.dateTimeFormatter.format(localDate); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> LocalDate </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toLocalDate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Date date)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> date.toInstant().atZone(ZoneId.systemDefault()).toLocalDate(); }</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">æ—¶é—´ï¼ˆnsï¼‰ï¼š</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/j5/ob/mf/j5obmfec_kvfivo46wat9rmf8e8.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">å†…å­˜ï¼ˆå­—èŠ‚ï¼‰ï¼š</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/hx/hm/on/hxhmon8ss12qyv9s4is6byoy164.png"></p></div></div><br><p> å› æ­¤ï¼Œåœ¨ä½¿ç”¨â€œä¹â€æ—¶ï¼Œè½¬æ¢<code>Date</code> -&gt; <code>LocalDate</code>æœ‰ç›Šçš„ã€‚ åœ¨G8ä¸Šï¼Œè½¬æ¢æˆæœ¬å°†åå™¬<code>DateTimeFormatter</code> -açš„æ‰€æœ‰å¥½å¤„ã€‚ </p><br><p>  <a href="">åŸºå‡†æµ‹è¯•</a> </p><br><p> ç»“è®ºï¼šåˆ©ç”¨æ–°çš„è§£å†³æ–¹æ¡ˆã€‚ </p><br><h2 id="eschyo-vosmyorka"> å¦ä¸€ä¸ªâ€œå…«â€ </h2><br><p> åœ¨è¿™æ®µä»£ç ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†æ˜æ˜¾çš„å†—ä½™ï¼š </p><br><pre> <code class="java hljs">Iterator&lt;Long&gt; iterator = items <span class="hljs-comment"><span class="hljs-comment">// ArrayList&lt;Integer&gt; .stream() .map(Long::valueOf) .collect(toList()) // &lt;----    ? .iterator(); while (iterator.hasNext()) { bh.consume(iterator.next()); }</span></span></code> </pre> <br><p> æˆ‘ä»¬å°†å…¶åˆ é™¤ï¼š </p><br><pre> <code class="java hljs">Iterator&lt;Long&gt; iterator = items <span class="hljs-comment"><span class="hljs-comment">// ArrayList&lt;Integer&gt; .stream() .map(Long::valueOf) .iterator(); while (iterator.hasNext()) { bh.consume(iterator.next()); }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">è®©æˆ‘ä»¬çœ‹çœ‹æ€§èƒ½æé«˜äº†å¤šå°‘ï¼š</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/un/mp/pf/unmppfr6sd8ybi3k7r7jrdsdfty.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">ä¸ä¹ä¸ªæ¯”è¾ƒï¼š</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/hc/rb/p9/hcrbp98qezjcm5fegv27cywcadu.png"></p></div></div><br><p> å¯¹ä¸å¯¹ï¼Ÿ æˆ‘åœ¨ä¸Šé¢å·²ç»è®ºè¯è¿‡åˆ†çš„å·¥ä½œä¼šé™ä½æ€§èƒ½ã€‚ ä½†æ˜¯åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬åˆ é™¤äº†å¤šä½™çš„éƒ¨åˆ†-å¹¶ä¸”ï¼ˆçªç„¶ï¼‰æƒ…å†µå˜å¾—æ›´ç³Ÿã€‚ è¦äº†è§£æ­£åœ¨å‘ç”Ÿçš„æƒ…å†µï¼Œè¯·ä½¿ç”¨ä¸¤ä¸ªè¿­ä»£å™¨ï¼Œå¹¶åœ¨æ”¾å¤§é•œä¸‹æŸ¥çœ‹å®ƒä»¬ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">å…¬å¼€</b> <div class="spoiler_text"><pre> <code class="java hljs">Iterator iterator1 = items.stream().collect(toList()).iterator(); Iterator iterator2 = items.stream().iterator();</code> </pre> <br><p><img src="https://habrastorage.org/webt/rn/ah/kf/rnahkfz2qdyuw0k_cjeorqawqki.png"></p></div></div><br><p> ç¬¬ä¸€ä¸ªè¿­ä»£å™¨æ˜¯å¸¸è§„<code>ArrayList$Itr</code> ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">é€šè¿‡å®ƒå¾ˆç®€å•ï¼š</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hasNext</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> cursor != size; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> E </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">next</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ checkForComodification(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = cursor; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i &gt;= size) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NoSuchElementException(); } Object[] elementData = ArrayList.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.elementData; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i &gt;= elementData.length) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ConcurrentModificationException(); } cursor = i + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (E) elementData[lastRet = i]; }</code> </pre> <br><p><img src="https://habrastorage.org/webt/ug/yb/pi/ugybpiiwmjj5-fbcazvmfdjd2tq.png"></p></div></div><br><p> ç¬¬äºŒä¸ªæ›´æœ‰è¶£ï¼Œå®ƒæ˜¯åŸºäº<code>ArrayList$ArrayListSpliterator</code> <code>Spliterators$Adapter</code> ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">é€šè¿‡å®ƒæ›´å›°éš¾</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// java.util.Spliterators$Adapter public boolean hasNext() { if (!valueReady) spliterator.tryAdvance(this); return valueReady; } public T next() { if (!valueReady &amp;&amp; !hasNext()) throw new NoSuchElementException(); else { valueReady = false; return nextElement; } }</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/pf/5p/gj/pf5pgjkfhhfw__h8ie7m6oflxqq.png"></p></div></div><br><p> è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹é€šè¿‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">async-profiler</a>è¿›è¡Œçš„è¿­ä»£å™¨è¿­ä»£ï¼š </p><br><pre> <code class="hljs mel"><span class="hljs-number"><span class="hljs-number">15.64</span></span>% juArrayList$ArrayListSpliterator.tryAdvance <span class="hljs-number"><span class="hljs-number">10.67</span></span>% jusSpinedBuffer.<span class="hljs-keyword"><span class="hljs-keyword">clear</span></span> <span class="hljs-number"><span class="hljs-number">9.86</span></span>% juSpliterators$1Adapter.hasNext <span class="hljs-number"><span class="hljs-number">8.81</span></span>% jusStreamSpliterators$AbstractWrappingSpliterator.fillBuffer <span class="hljs-number"><span class="hljs-number">6.01</span></span>% oojiBlackhole.consume <span class="hljs-number"><span class="hljs-number">5.71</span></span>% jusReferencePipeline$3$1.accept <span class="hljs-number"><span class="hljs-number">5.57</span></span>% jusSpinedBuffer.accept <span class="hljs-number"><span class="hljs-number">5.06</span></span>% cllbir.IteratorFromStreamBenchmark.iteratorFromStream <span class="hljs-number"><span class="hljs-number">4.80</span></span>% jlLong.valueOf <span class="hljs-number"><span class="hljs-number">4.53</span></span>% cllbiIteratorFromStreamBenchmark$$Lambda$8<span class="hljs-number"><span class="hljs-number">.885721577</span></span>.apply</code> </pre> <br><p> å¯ä»¥çœ‹å‡ºï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨äº†éå†è¿­ä»£å™¨ä¸Šï¼Œå°½ç®¡æ€»çš„æ¥è¯´ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å®ƒï¼Œå› ä¸ºå¯ä»¥è¿™æ ·è¿›è¡Œæœç´¢ï¼š </p><br><pre> <code class="java hljs">items .stream() .map(Long::valueOf) .forEach(bh::consume);</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">ä¸å…¶ä½™çš„æ¯”è¾ƒï¼š</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/rf/is/i0/rfisi0vsfoezlcvtd43h2lhlvfi.png"></p></div></div><br><p>  <code>Stream::forEach</code>æ˜¾ç„¶æ˜¯èµ¢å®¶ï¼Œä½†è¿™å¾ˆå¥‡æ€ªï¼šå®ƒä»ç„¶åŸºäº<code>ArrayListSpliterator</code> ï¼Œä½†æ˜¯å…¶ä½¿ç”¨å·²å¤§å¤§æ”¹å–„ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸ªäººèµ„æ–™ï¼š</b> <div class="spoiler_text"><pre> <code class="hljs powershell"><span class="hljs-number"><span class="hljs-number">29.04</span></span>% oojiBlackhole.consume <span class="hljs-number"><span class="hljs-number">22.92</span></span>% juArrayList<span class="hljs-variable"><span class="hljs-variable">$ArrayListSpliterator</span></span>.forEachRemaining <span class="hljs-number"><span class="hljs-number">14.47</span></span>% jusReferencePipeline<span class="hljs-variable"><span class="hljs-variable">$3</span></span><span class="hljs-variable"><span class="hljs-variable">$1</span></span>.accept <span class="hljs-number"><span class="hljs-number">8.79</span></span>% jlLong.valueOf <span class="hljs-number"><span class="hljs-number">5.37</span></span>% cllbiIteratorFromStreamBenchmark<span class="hljs-variable"><span class="hljs-variable">$</span></span><span class="hljs-variable"><span class="hljs-variable">$Lambda</span></span><span class="hljs-variable"><span class="hljs-variable">$9</span></span>.<span class="hljs-number"><span class="hljs-number">617691115</span></span>.accept <span class="hljs-number"><span class="hljs-number">4.84</span></span>% cllbiIteratorFromStreamBenchmark<span class="hljs-variable"><span class="hljs-variable">$</span></span><span class="hljs-variable"><span class="hljs-variable">$Lambda</span></span><span class="hljs-variable"><span class="hljs-variable">$8</span></span>.<span class="hljs-number"><span class="hljs-number">1964917002</span></span>.apply <span class="hljs-number"><span class="hljs-number">4.43</span></span>% jusForEachOps<span class="hljs-variable"><span class="hljs-variable">$ForEachOp</span></span><span class="hljs-variable"><span class="hljs-variable">$OfRef</span></span>.accept <span class="hljs-number"><span class="hljs-number">4.17</span></span>% jusSink<span class="hljs-variable"><span class="hljs-variable">$ChainedReference</span></span>.end <span class="hljs-number"><span class="hljs-number">1.27</span></span>% jlInteger.longValue <span class="hljs-number"><span class="hljs-number">0.53</span></span>% jusReferencePipeline.map</code> </pre> </div></div><br><p> åœ¨æ­¤é…ç½®æ–‡ä»¶ä¸­ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨â€œåå™¬â€ <code>Blackhole</code>å†…éƒ¨çš„å€¼ä¸Šã€‚ ä¸è¿­ä»£å™¨ç›¸æ¯”ï¼Œå¤§éƒ¨åˆ†æ—¶é—´ç›´æ¥ç”¨äºæ‰§è¡ŒJavaä»£ç ã€‚ å¯ä»¥è®¤ä¸ºï¼ŒåŸå› æ˜¯åƒåœ¾å›æ”¶å™¨çš„æ¯”é‡æ¯”è¿­ä»£å™¨è›®åŠ›ä½ã€‚ æ£€æŸ¥ï¼š </p><br><pre> <code class="java hljs">forEach:Â·gc.alloc.rate.norm <span class="hljs-number"><span class="hljs-number">100</span></span> avgt <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">216</span></span>,<span class="hljs-number"><span class="hljs-number">001</span></span> Â± <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">002</span></span> B/op iteratorFromStream:Â·gc.alloc.rate.norm <span class="hljs-number"><span class="hljs-number">100</span></span> avgt <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">416</span></span>,<span class="hljs-number"><span class="hljs-number">004</span></span> Â± <span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">006</span></span> B/op</code> </pre> <br><p> å®é™…ä¸Šï¼Œ <code>Stream::forEach</code>æä¾›äº†ä¸€åŠçš„å†…å­˜æ¶ˆè€—ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ä¸ºä»€ä¹ˆä¼šæ›´å¿«ï¼Ÿ</b> <div class="spoiler_text"><p> ä»å¤´åˆ°é»‘æ´çš„å‘¼å«é“¾å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><p><img src="https://habrastorage.org/webt/2f/5w/1y/2f5w1ydxlo5oomf8bfmhbqtynze.png"></p><br><p> å¦‚æ‚¨æ‰€è§ï¼Œå¯¹<code>ArrayListSpliterator::tryAdvance</code>çš„è°ƒç”¨ä»é“¾ä¸­æ¶ˆå¤±äº†ï¼Œ <code>ArrayListSpliterator::forEachRemaining</code>å‡ºç°äº†<code>ArrayListSpliterator::forEachRemaining</code> ï¼š </p><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// ArrayListSpliterator public void forEachRemaining(Consumer&lt;? super E&gt; action) { int i, hi, mc; // hoist accesses and checks from loop ArrayList&lt;E&gt; lst; Object[] a; if (action == null) throw new NullPointerException(); if ((lst = list) != null &amp;&amp; (a = lst.elementData) != null) { if ((hi = fence) &lt; 0) { mc = lst.modCount; hi = lst.size; } else mc = expectedModCount; if ((i = index) &gt;= 0 &amp;&amp; (index = hi) &lt;= a.length) { for (; i &lt; hi; ++i) { @SuppressWarnings("unchecked") E e = (E) a[i]; // &lt;---- action.accept(e); } if (lst.modCount == mc) return; } } throw new ConcurrentModificationException(); }</span></span></code> </pre> <br><p> é«˜é€Ÿ<code>ArrayListSpliterator::forEachRemaining</code>é€šè¿‡åœ¨1ä¸ªæ–¹æ³•è°ƒç”¨ä¸­ä½¿ç”¨å¯¹æ•´ä¸ªæ•°ç»„çš„ä¼ é€’æ¥å®ç°ã€‚ å½“ä½¿ç”¨è¿­ä»£å™¨æ—¶ï¼Œæ®µè½ä»…é™äºä¸€ä¸ªå…ƒç´ ï¼Œå› æ­¤æˆ‘ä»¬å§‹ç»ˆåå¯¹<code>ArrayListSpliterator::tryAdvance</code> ã€‚ <br>  <code>ArrayListSpliterator::forEachRemaining</code>å¯ä»¥è®¿é—®æ•´ä¸ªæ•°ç»„ï¼Œå¹¶ä»¥ä¸€ä¸ªè®¡æ•°å‘¨æœŸå¯¹å…¶è¿›è¡Œ<code>ArrayListSpliterator::forEachRemaining</code> ï¼Œè€Œæ— éœ€å…¶ä»–è°ƒç”¨ã€‚ </p></div></div><br><div class="spoiler">  <b class="spoiler_title">é‡è¦å‘Šç¤º</b> <div class="spoiler_text"><p> è¯·æ³¨æ„æœºæ¢°æ›´æ¢ </p><br><pre> <code class="java hljs">Iterator&lt;Long&gt; iterator = items .stream() .map(Long::valueOf) .collect(toList()) .iterator(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (iterator.hasNext()) { bh.consume(iterator.next()); }</code> </pre> <br><p> åœ¨ </p><br><pre> <code class="java hljs">items .stream() .map(Long::valueOf) .forEach(bh::consume);</code> </pre> <br><p> å®ƒå¹¶ä¸æ€»æ˜¯ç­‰æ•ˆçš„ï¼Œå› ä¸ºåœ¨ç¬¬ä¸€ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨ä¸å½±å“æµæœ¬èº«çš„æƒ…å†µä¸‹å°†æ•°æ®çš„å‰¯æœ¬ç”¨äºé€šé“ï¼Œè€Œåœ¨ç¬¬äºŒç§æƒ…å†µä¸‹ï¼Œåˆ™ç›´æ¥ä»æµä¸­è·å–æ•°æ®ã€‚ </p></div></div><br><p>  <a href="">åŸºå‡†æµ‹è¯•</a> </p><br><p> ç»“è®ºï¼šåœ¨å¤„ç†å¤æ‚çš„æ•°æ®è¡¨ç¤ºæ—¶ï¼Œè¯·åšå¥½å‡†å¤‡ï¼Œå³ä½¿â€œé“â€è§„åˆ™ï¼ˆé¢å¤–çš„å·¥ä½œå±å®³ï¼‰ä¹Ÿä¼šåœæ­¢å·¥ä½œã€‚ ä¸Šé¢çš„ç¤ºä¾‹è¡¨æ˜ï¼Œçœ‹ä¼¼å¤šä½™çš„ä¸­é—´åˆ—è¡¨å…·æœ‰æ›´å¿«å®ç°æšä¸¾çš„ä¼˜ç‚¹ã€‚ </p><br><h4 id="dva-podvoha"> ä¸¤ä¸ªæŠ€å·§ </h4><br><pre> <code class="java hljs">StackTraceElement[] trace = th.getStackTrace(); StackTraceElement[] newTrace = Arrays .asList(trace) .subList(<span class="hljs-number"><span class="hljs-number">0</span></span>, depth) .toArray(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StackTraceElement[newDepth]); <span class="hljs-comment"><span class="hljs-comment">// &lt;----</span></span></code> </pre> <br><p> å¼•èµ·æ‚¨æ³¨æ„çš„ç¬¬ä¸€ä»¶äº‹æ˜¯ä¸€ä¸ªçƒ‚çš„â€œæ”¹è¿›â€ï¼Œå³ï¼Œå°†ä¸€ä¸ªéé›¶é•¿åº¦çš„æ•°ç»„ä¼ é€’ç»™<code>Collection::toArray</code>æ–¹æ³•ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®ƒ</a>è¯¦ç»†è§£é‡Šäº†ä¸ºä»€ä¹ˆè¿™æ ·åšæœ‰å®³ã€‚ </p><br><p> ç¬¬äºŒä¸ªé—®é¢˜ä¸æ˜¯é‚£ä¹ˆæ˜æ˜¾ï¼Œå¹¶ä¸”ç”±äºå…¶ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®¡æŸ¥è€…å’Œå†å²å­¦å®¶çš„å·¥ä½œä¹‹é—´å¾—å‡ºç›¸ä¼¼ä¹‹å¤„ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">è¿™æ˜¯ç½—å®¾Â·ç§‘æ—ä¼å¾·å…³äºæ­¤çš„â€‹â€‹å†…å®¹ï¼š</b> <div class="spoiler_text"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¾‹å¦‚ï¼Œå‡è®¾ä»–ï¼ˆå†å²å­¦å®¶ï¼‰é˜…è¯»äº†ã€Šç‹„å¥¥å¤šè¥¿æ³•å…¸ã€‹ï¼Œè€Œåœ¨ä»–ä¹‹å‰æ˜¯çš‡å¸çš„eä»¤ã€‚</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç®€å•åœ°é˜…è¯»å•è¯å’Œç¿»è¯‘å®ƒä»¬çš„èƒ½åŠ›å¹¶ä¸èƒ½ç†è§£å…¶å†å²æ„ä¹‰</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">è¦æ¬£èµå®ƒï¼Œ</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">å†å²å­¦å®¶å¿…é¡»æƒ³è±¡çš‡å¸è¯•å›¾è§£å†³çš„æƒ…å†µ</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ...</font></font></p></div></div><br><p>       <strong></strong>      .      : </p><br><p> 1)     <br> 2)    <br> 3)       </p><br><p>      ,      : </p><br><pre> <code class="java hljs">StackTraceElement[] trace = th.getStackTrace(); StackTraceElement[] newTrace = Arrays.copyOf(trace, depth); <span class="hljs-comment"><span class="hljs-comment">//    0 //  StackTraceElement[] newTrace = Arrays.copyOfRange(trace, 0, depth); //   0</span></span></code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ():</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/xg/ia/-8/xgia-8mdesgh-cpqm1cla0n8zz4.png"></p></div></div><br><p> <a href=""></a> </p><br><h4 id="strimoz-golovnogo-mozga">    </h4><br><pre> <code class="java hljs">List&lt;T&gt; list = getList(); Set&lt;T&gt; set = getSet(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> list.stream().allMatch(set::contains); <span class="hljs-comment"><span class="hljs-comment">//     ?</span></span></code> </pre> <br><p>       ,      ,    : </p><br><pre> <code class="java hljs">List&lt;T&gt; list = getList(); Set&lt;T&gt; set = getSet(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> set.containsAll(list);</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ():</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/3c/tc/pr/3ctcprq3scexhaaifc9hiywbj98.png"></p></div></div><br><p> <a href=""></a> </p><br><h4 id="nenuzhnye-obyortki">   </h4><br><p>  : </p><br><pre> <code class="java hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FileNameLoader</span></span></span><span class="hljs-class"> </span></span>{ String[] loadFileNames(); }</code> </pre> <br><p>     : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FileNameLoader loader; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String str : asList(loader.loadFileNames())) { <span class="hljs-comment"><span class="hljs-comment">// &lt;----   use(str); } }</span></span></code> </pre> <br><p>   ,   <code>forEach</code>    ,      : </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> FileNameLoader loader; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">load</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String str : loader.loadFileNames()) { <span class="hljs-comment"><span class="hljs-comment">// &lt;----    use(str); } }</span></span></code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ():</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/pa/kn/hc/paknhcvrp1cf7g-fw3cn4euxrse.png"></p></div></div><br><p> <a href=""></a> </p><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-182206</a> <br><del> IDEA-182206 </del> Simplification for Arrays.asList().subList().toArray() <br> <strong>  2018.1</strong> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-180847</a> <br><del> IDEA-180847 </del> Inspection 'Call to Collection.toArray with zero-length array argument' brings pessimization <br> <strong>  2018.1</strong> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-181928</a> <br><del> IDEA-181928 </del> Stream.allMatch(Collection::contains) can be simplified to Collection.containsAll() <br> <strong>  2018.1</strong> </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">https://youtrack.jetbrains.com/issue/IDEA-184240</a> <br><del> IDEA-184240 </del> Unnecessary array-to-collection wrapping should be detected <br> <strong>  2018.1</strong> </p></div></div><br><p> :       : </p><br><ul><li>  </li><li>  </li><li>    </li></ul><br><p>       ,   ,         ,     .  ,   :         "" (        ),       ""     (      ),        . </p><br><p> â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">   </a> </p><br><p> â†’ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">  </a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN423305/">https://habr.com/ru/post/zh-CN423305/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN423293/index.html">å¦‚ä½•ä¸ä½¿ç”¨çŠ¶æ€æœºå°„å‡»è‡ªå·±çš„è…¿</a></li>
<li><a href="../zh-CN423295/index.html">æœ€æœ‰ç”¨çš„ç§»åŠ¨å¼€å‘å¤§ä¼š</a></li>
<li><a href="../zh-CN423297/index.html">ä»Androidå¼€å‘äººå‘˜åˆ°DevOps</a></li>
<li><a href="../zh-CN423299/index.html">iOSåº”ç”¨ç¨‹åºä¸­çš„åº”ç”¨ç¨‹åºåè°ƒå™¨</a></li>
<li><a href="../zh-CN423303/index.html">AIï¼Œå®è·µè¯¾ç¨‹ã€‚ åŸºäºæƒ…æ„Ÿçš„éŸ³ä¹è½¬å‹</a></li>
<li><a href="../zh-CN423307/index.html">Visual Studioä»£ç ä¸­çš„GitHubæå–è¯·æ±‚</a></li>
<li><a href="../zh-CN423309/index.html">DBMSäº¤æ˜“</a></li>
<li><a href="../zh-CN423311/index.html">ä¼™ä¼´å…³ç³»Naviaddresså’ŒACTUM</a></li>
<li><a href="../zh-CN423313/index.html">è§¦æ‘¸I2Cã€‚ åˆ¶ä½œä¸€ä¸ªç®€å•çš„é€»è¾‘åˆ†æä»ª</a></li>
<li><a href="../zh-CN423315/index.html">é€šç”¨é“¾æ¥ç†è®º</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>