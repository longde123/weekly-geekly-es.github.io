<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🆓 🤚 🦌 我们不仅使用概率数据结构来加速大型图的分布式处理 🌍 🕉️ 🧖🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="在任何社交网络中，最有价值的资源之一就是“友谊图”-通过此列中的连接传播信息，将有趣的内容发送给用户，并将建设性的反馈发送给内容作者。 此外，图形还是重要的信息来源，可让您更好地了解用户并不断改善服务。 但是，在图形增长的那些情况下，从技术上提取信息在技术上越来越困难。 在本文中，我们将讨论OK.r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>我们不仅使用概率数据结构来加速大型图的分布式处理</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/odnoklassniki/blog/465985/"><p><img src="https://habrastorage.org/webt/u1/y0/hk/u1y0hkslkriigc-z1_wkrilk2bm.jpeg"></p><br><p> 在任何社交网络中，最有价值的资源之一就是“友谊图”-通过此列中的连接传播信息，将有趣的内容发送给用户，并将建设性的反馈发送给内容作者。 此外，图形还是重要的信息来源，可让您更好地了解用户并不断改善服务。 但是，在图形增长的那些情况下，从技术上提取信息在技术上越来越困难。 在本文中，我们将讨论OK.ru中用于处理大型图形的一些技巧。 </p><a name="habracut"></a><br><p> 首先，请考虑一个来自现实世界的简单任务：确定用户的年龄。 知道年龄可以使社交网络选择更多相关内容并更好地适应人。 在社交网络上创建页面时，似乎已经表明了年龄，但实际上，用户经常会狡猾，并指出与实际年龄不同的年龄。 社交图谱可以帮助纠正这种情况：）。 </p><br><p>以鲍勃（Bob）为例（文章中的所有字符都是虚构的，与现实的任何巧合都是随机房子创造力的结果）： </p><br><p><img src="https://habrastorage.org/webt/wq/ht/tp/wqhttpoxzxunnad14b4csy9owhe.png"></p><br><p> 一方面，鲍勃的朋友中有一半是青少年，这表明鲍勃也是青少年。 但是他也有老朋友，所以对答案的信心很低。 来自社交图谱的其他信息可以帮助阐明答案： </p><br><p><img src="https://habrastorage.org/webt/w5/ef/ku/w5efku89o5lqu0hrv0kbrl9nte8.png"></p><br><p> 不仅考虑鲍勃直接参与的活动，还考虑了他的朋友之间的活动，我们可以看到鲍勃是青少年社区的一员，这使我们可以更加自信地得出他的年龄结论。 </p><br><p> 这种数据结构被称为<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">自我网络</a>或自我子图；长期以来，它已成功用于解决许多问题：搜索社区，识别漫游器和垃圾邮件，来自好友和内容的推荐等。 但是，为具有数亿个节点和数百亿弧的图中的<strong>所有</strong>用户计算子图的自我的过程充满了许多“小技术难题” ：）。 </p><br><p> 主要问题是，当考虑图形中有关“第二步”的信息时，连接数将发生二次爆炸。 例如，对于具有150个直接自我链接的用户，子图最多可以包含 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>150</mn><mo>+</mo><mn>150</mn><mo>&amp;#x2217;</mo><mn>149</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>$</mo></mrow><mn>11</mn><mo>,</mo><mn>32</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.767ex" height="2.66ex" viewBox="0 -832 11955.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-30" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-2B" x="1723" y="0"></use><g transform="translate(2724,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-35" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-30" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-2217" x="4448" y="0"></use><g transform="translate(5170,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-34" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-39" x="1001" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-2F" x="6672" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-32" x="7172" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-3D" x="7951" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-24" x="9007" y="0"></use><g transform="translate(9507,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-31" x="500" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-2C" x="10508" y="0"></use><g transform="translate(10954,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-33"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/odnoklassniki/blog/465985/&amp;usg=ALkJrhg0iXKf9xnjaIy84JdStAm8Y20eAQ#MJMAIN-32" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>150</mn><mo>+</mo><mn>150</mn><mo>∗</mo><mn>149</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>2</mn><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo>$</mo></mrow><mn>11</mn><mo>,</mo><mn>32</mn></math></span></span><script type="math/tex" id="MathJax-Element-1"> 150 + 150 * 149/2 = $ 11,32</script> 链接，对于拥有5,000个朋友的活跃用户，自我子图可以增长到超过1200万个链接。 </p><br><p> 另一个复杂的事实是该图存储在分布式环境中，并且没有节点在内存中具有该图的完整映像。 在学院和行业中都进行<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">平衡图分区</a>的工作，但是即使在收集自我子图时获得最高的结果也会导致“所有人共享”的交流：为了获得有关用户朋友的朋友的信息，您将必须转到所有“分区”。在大多数情况下。 </p><br><p> 在这种情况下，一种可行的替代方法是强制数据复制（例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Google</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章中的</a>算法3），但是这种复制也不是免费的。 让我们尝试找出在此过程中可以改进的地方。 </p><br><h3 id="naivnyy-algoritm"> 天真的算法 </h3><br><p> 首先，请考虑用于生成自我子图的“朴素”算法： </p><br><p><img src="https://habrastorage.org/webt/1o/zn/qz/1oznqzgjwr2iadbhoko7vgvp7hm.png"></p><br><p> 该算法假定原始图被存储为邻接表，即 有关用户所有朋友的信息存储在单个记录中，键中包含用户ID，值中包含朋友ID列表。 为了执行第二步并获取有关朋友的信息，您需要： </p><br><ol><li> 将图形转换为边列表，其中每个边都是单独的条目。 </li><li> 使边列表自身相连，这将在长度为2的图形中给出所有路径。 </li><li> 按路径开始分组。 </li></ol><br><p> 在每个用户的输出中，我们获得每个用户的长度为2的路径列表。 在这里应该注意，结果结构实际上是<strong>用户的两步式邻域</strong> ，而自我子图是其子集。 因此，要完成此过程，我们需要过滤掉直交朋友之外的所有弧。 </p><br><p> 该算法很好，因为它是在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Apache Spark</a>下<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在Scala的两行中</a>实现的。 但是优势不止于此：对于工业规模的图表而言，网络通信的数量已超出限制，并且运行时间以天为单位。 主要困难是由我们进行合并和分组时发生的两个随机操作造成的。 是否可以减少发送的数据量？ </p><br><h3 id="ego-podgraf-v-odin-shuffle"> 自我子图在一个洗牌 </h3><br><p> 鉴于我们的友谊图是对称的，您可以使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Tomas Schank</a>提出的优化方法： </p><br><ol><li> 您可以不加入而获得所有长度为2的路径-如果Bob拥有朋友Alice和Harry，那么就有Alice-Bob-Harry和Harry-Bob-Alice路径。 </li><li> 分组时，入口处的两条路径对应于同一条新边。 路径Bob-Alice-Dave和Bob-Dave-Alice包含与Bob相同的信息，这意味着您只能发送第二条路径，并按用户ID对其进行排序。 </li></ol><br><p> 应用优化后，工作方案将如下所示： </p><br><p><img src="https://habrastorage.org/webt/zp/jx/da/zpjxdat-xtd9tqukfqt9tta8n0i.png"></p><br><ol><li> 在生成的第一阶段，我们获得了长度为2的路径列表，其中包含订单ID过滤器。 </li><li> 第二，我们在路上按第一个用户分组。 </li></ol><br><p> 在这种设置下，该算法完成一次混洗操作，并且通过网络传输的数据大小减半。  :) </p><br><h3 id="raskladyvaem-ego-podgraf-v-pamyati"> 在内存中布置自我子图 </h3><br><p> 我们尚未考虑的重要问题是如何将子图的自我中的数据分解为内存。 为了存储整个图，我们使用了邻接表。 这种结构对于需要从整体上完成成品图的任务很方便，但是如果我们要从各个部分构建一个图并进行更细微的分析，则该结构将非常昂贵。 我们任务的理想结构应有效执行以下操作： </p><br><ol><li> 从不同分区获得的两个图的并集。 </li><li> 得到所有人类朋友。 </li><li> 检查是否连接了两个人。 </li><li> 存储在内存中，无需装箱。 </li></ol><br><p> 满足这些要求的最合适的格式之一是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">稀疏CSR矩阵</a>的模拟： </p><br><p><img src="https://habrastorage.org/webt/nm/rl/ch/nmrlchko5kxd5cslkvu2kh37vkq.png"></p><br><p> 在这种情况下，图形以三个数组的形式存储： </p><br><ol><li>  users-一个排序的数组，其中包含参与图形的所有用户的ID。 </li><li>  index-与用户大小相同的数组，其中为每个用户存储一个指向第三数组中有关用户关系信息开头的索引指针。 </li><li> 朋友-大小等于数组边数的数组，其中依次为用户的相应ID显示相关用户的ID。 在有关单个用户链接的信息内，将数组排序以提高处理速度。 </li></ol><br><p> 在这种格式中，合并两个图的操作是在线性时间内执行的，并且每个顶点数量的对数获取有关特定用户或一对用户的信息的操作。 在这种情况下，内存的开销不取决于图形的大小，因为使用了固定数目的数组。 通过添加大小等于朋友大小的第四个数据数组，可以在图形中保存与关系相关的其他信息。 </p><br><p> 使用图对称性，您只能存储“上三角”弧的一半（当弧仅从较小的ID到较大的ID存储），但是在这种情况下，单个用户的所有连接的重建将花费线性时间。 在这种情况下，一个很好的折衷方法可能是使用“上三角”编码进行节点之间的存储和传输，以及在将子图的自我加载到内存中进行分析时使用对称编码。 </p><br><h3 id="umenshaem-shuffle"> 减少洗牌 </h3><br><p> 但是，即使执行了上述所有优化之后，构造所有自我子图的任务仍然会花费很长时间。 在我们的例子中，集群的利用率很高，大约需要6个小时。 仔细研究表明，复杂性的主要来源仍然是混洗操作，而混洗中涉及的数据的很大一部分将在接下来的阶段中丢弃。 事实是，所描述的方法为每个用户建立了一个完整的两步式邻域，而自我子图只是该邻域的一个相对较小的子集，仅包含<em>内部</em>弧。 </p><br><p> 例如，如果通过与鲍勃的直接邻居哈利和弗兰克交往，我们知道他们不是彼此的朋友，那么我们已经可以在第一步中过滤掉此类外部路径。 但是为了找出所有Gary和Frenkov是否是朋友，您将不得不将友谊图拖到所有计算节点的内存中，或者在处理每条记录时进行远程调用，根据任务的条件，这是不可能的。 </p><br><p> 尽管如此，如果我们在很小的情况下允许自己发现友谊而实际上却不存在，那就有解决方案。 整个系列的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">概率数据结构</a>可以将数据存储期间的内存消耗减少几个数量级，同时允许一定数量的错误。 这种类型最著名的结构是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Bloom过滤器</a> ，该<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">过滤器</a>已在工业数据库中成功使用多年，以补偿“长尾”缓存中的遗漏。 </p><br><p>  Bloom过滤器的主要任务是回答以下问题：“此元素是否包含在许多以前见过的元素中？” 此外，如果过滤器回答“否”，则该元素可能不包含在集合中，但如果回答“是”，则该元素仍不存在的可能性很小。 </p><br><p> 在我们的例子中，“元素”将是一对用户，而“集合”将是图形的所有边。 然后可以成功应用Bloom过滤器以减少随机播放的大小： </p><br><p><img src="https://habrastorage.org/webt/eo/_e/ua/eo_eua9cf1wxdkxttwevejawbje.png"></p><br><p> 预先准备好有关图表信息的Bloom过滤器后，我们可以查看Harry的朋友，发现Bob和Ilona不是朋友，这意味着我们不需要向Bob发送有关Gary和Ilona之间的联系的信息。 但是，仍然必须发送有关Harry和Bob自己是朋友的信息，以便Bob分组后可以完全恢复他的友谊。 </p><br><h3 id="ubiraem-shuffle"> 去除混洗 </h3><br><p> 应用过滤器后，发送的数据量减少了约80％，并且任务在1小时内完成了中等的群集负载，使您可以自由地并行执行其他任务。 在这种模式下，它已经可以“投入运行”并每天使用，但仍有优化的潜力。 </p><br><p> 听起来很矛盾，但是如果您允许自己犯一定比例的错误，就可以解决问题而无需重新洗牌。 布隆过滤器可以帮助我们： </p><br><p><img src="https://habrastorage.org/webt/el/zv/ya/elzvyazgijeu9ew7yt8te-xvmm8.png"></p><br><p> 如果使用过滤器查看Bob的朋友列表，我们<em>几乎可以确定</em> Alice和Charlie是朋友，我们可以立即将相应的弧添加到Bob的自我子图中。 在这种情况下，整个过程将花费不到15分钟的时间，并且不需要通过网络进行数据传输，但是实际上，取决于过滤器设置，可能没有一定比例的电弧。 </p><br><p> 过滤器添加的额外电弧不会对某些任务造成明显的失真：例如，在计算三角形时，我们可以轻松地校正结果，而在为机器学习算法准备属性时，则可以在下一步中学习ML校正。 </p><br><p> 但是在某些任务中，额外的电弧会导致结果质量的严重恶化：例如，当使用远程自我（没有用户的顶点）在自我子图中搜索<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">连接的组件</a>时<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">，组件</a>之间的“幻影桥”的概率相对于其大小呈二次方增长，从而导致几乎在所有地方我们都有一个重要组成部分。 </p><br><p> 有一个中间区域，需要通过实验评估额外电弧的负面影响：例如，某些<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">社区</a>搜索算法可以非常成功地应对少量噪声，返回几乎相同的社区结构。 </p><br><h3 id="vmesto-zaklyucheniya"> 而不是结论 </h3><br><p> 自我用户子图是OK积极使用的重要信息来源，以提高建议的质量，完善人口统计信息和打击垃圾邮件，但它们的计算存在许多困难。 </p><br><p> 在本文中，我们研究了为社交网络的所有用户构建自我子图的任务方法的演变，并且能够将工作时间从最初的20小时缩短为1小时，并且在错误率很小的情况下，可以将工作时间缩短至10-15分钟。 </p><br><p> 最终决定所依据的三个“支柱”是： </p><br><ol><li> 使用图对称属性和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Tomas Schank</a>算法。 </li><li> 使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">稀疏CSR矩阵</a>有效地存储自我子图。 </li><li> 使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">布隆过滤器</a>减少网络上的数据传输。 </li></ol><br><p> 可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Zeppelin笔记本中</a>找到有关算法代码如何演变的示例。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN465985/">https://habr.com/ru/post/zh-CN465985/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN465975/index.html">SQL指南：如何更好地编写查询（第2部分）</a></li>
<li><a href="../zh-CN465977/index.html">培训Cisco 200-125 CCNA v3.0。 第31天。CDP，系统日志和NTP</a></li>
<li><a href="../zh-CN465979/index.html">记住所有^ W就是您所需要的。 体验使用Anki。 第1部分（入门级，倒数第二级）</a></li>
<li><a href="../zh-CN465981/index.html">与1C一起使用时，我的IBM DB2 Express-C管理经验：企业</a></li>
<li><a href="../zh-CN465983/index.html">英特尔Comet Lake：第十代仅14 nm</a></li>
<li><a href="../zh-CN465987/index.html">鹦鹉降落了。 宣布“生成式深度学习”书</a></li>
<li><a href="../zh-CN465989/index.html">系统工程方面的产品策略和组织策略</a></li>
<li><a href="../zh-CN465991/index.html">干净迅速的建筑工人</a></li>
<li><a href="../zh-CN465993/index.html">无需节省数字安全性</a></li>
<li><a href="../zh-CN465995/index.html">最不发达国家-游览</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>