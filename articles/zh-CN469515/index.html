<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ•ºğŸ¼ ğŸ‘´ğŸ¾ ğŸ ä¸ºIstioå‡†å¤‡åº”ç”¨ç¨‹åº ğŸ§–ğŸ¾ ğŸ‘¨ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¼ ğŸ˜±</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Istioæ˜¯è¿æ¥ï¼Œä¿æŠ¤å’Œç›‘è§†åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„ä¾¿æ·å·¥å…·ã€‚ Istioä½¿ç”¨å„ç§æŠ€æœ¯æ¥å¤§è§„æ¨¡å¯åŠ¨å’Œç®¡ç†è½¯ä»¶ï¼ŒåŒ…æ‹¬ç”¨äºåŒ…è£…åº”ç”¨ç¨‹åºä»£ç çš„å®¹å™¨å’Œç”¨äºéƒ¨ç½²çš„ä¾èµ–é¡¹ï¼Œä»¥åŠç”¨äºç®¡ç†è¿™äº›å®¹å™¨çš„Kubernetesã€‚ å› æ­¤ï¼Œè¦ä½¿ç”¨Istioï¼Œæ‚¨å¿…é¡»çŸ¥é“åœ¨æ²¡æœ‰ Istioçš„æƒ…å†µä¸‹å…·æœ‰åŸºäºè¿™äº›æŠ€æœ¯çš„å¤šç§æœåŠ¡çš„åº”ç”¨ç¨‹åºå¦‚ä½•å·¥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ä¸ºIstioå‡†å¤‡åº”ç”¨ç¨‹åº</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/469515/"><p><img src="https://habrastorage.org/webt/qy/yw/v1/qyywv1qmzphh1svbblasrxjc6ym.jpeg"></p><br><p>  Istioæ˜¯è¿æ¥ï¼Œä¿æŠ¤å’Œç›‘è§†åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„ä¾¿æ·å·¥å…·ã€‚  Istioä½¿ç”¨å„ç§æŠ€æœ¯æ¥å¤§è§„æ¨¡å¯åŠ¨å’Œç®¡ç†è½¯ä»¶ï¼ŒåŒ…æ‹¬ç”¨äºåŒ…è£…åº”ç”¨ç¨‹åºä»£ç çš„å®¹å™¨å’Œç”¨äºéƒ¨ç½²çš„ä¾èµ–é¡¹ï¼Œä»¥åŠç”¨äºç®¡ç†è¿™äº›å®¹å™¨çš„Kubernetesã€‚ å› æ­¤ï¼Œè¦ä½¿ç”¨Istioï¼Œæ‚¨å¿…é¡»çŸ¥é“åœ¨<em>æ²¡æœ‰</em> Istioçš„<em>æƒ…å†µä¸‹</em>å…·æœ‰åŸºäºè¿™äº›æŠ€æœ¯çš„å¤šç§æœåŠ¡çš„åº”ç”¨ç¨‹åºå¦‚ä½•å·¥ä½œã€‚ å¦‚æœæ‚¨å·²ç»äº†è§£è¿™äº›å·¥å…·å’Œæ¦‚å¿µï¼Œè¯·éšæ—¶è·³è¿‡æœ¬æŒ‡å—ï¼Œç›´æ¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è½¬åˆ°åœ¨Google Kubernetes Engineï¼ˆGKEï¼‰ä¸Š</a>å®‰è£…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Istio</a>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨GKE</a>æ‰©å±•<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¨‹åºä¸Š</a>å®‰è£…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Istio</a> ã€‚ </p><br><p> è¿™æ˜¯ä¸€ä¸ªå¾ªåºæ¸è¿›çš„æŒ‡å—ï¼Œåœ¨å…¶ä¸­æˆ‘ä»¬å°†ä»‹ç»ä»æºä»£ç åˆ°GKEä¸Šçš„å®¹å™¨çš„æ•´ä¸ªè¿‡ç¨‹ï¼Œä»¥ä¾¿æ‚¨é€šè¿‡ç¤ºä¾‹äº†è§£è¿™äº›æŠ€æœ¯çš„åŸºæœ¬æ¦‚å¿µã€‚ æ‚¨è¿˜å°†çœ‹åˆ°Istioå¦‚ä½•åˆ©ç”¨è¿™äº›æŠ€æœ¯ã€‚ å‡å®šæ‚¨å¯¹å®¹å™¨ï¼ŒKubernetesï¼ŒæœåŠ¡ç½‘æ ¼æˆ–Istioä¸€æ— æ‰€çŸ¥ã€‚ </p><a name="habracut"></a><br><h3 id="zadachi"> ä»»åŠ¡ </h3><br><p> åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæ‚¨å°†å®Œæˆä»¥ä¸‹ä»»åŠ¡ï¼š </p><br><ol><li> æ¢ç´¢å¸¦æœ‰å¤šä¸ªæœåŠ¡çš„ç®€å•hello worldåº”ç”¨ç¨‹åºã€‚ </li><li> ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åºã€‚ </li><li>å°†åº”ç”¨ç¨‹åºåŒ…è£…åœ¨å®¹å™¨ä¸­ã€‚ </li><li> åˆ›å»ºä¸€ä¸ªKubernetesé›†ç¾¤ </li><li> å°†å®¹å™¨éƒ¨ç½²åˆ°ç¾¤é›†ã€‚ </li></ol><br><h3 id="prezhde-chem-nachat"> å¼€å§‹ä¹‹å‰ </h3><br><p> æŒ‰ç…§è¯´æ˜å¯ç”¨Kubernetes Engine APIï¼š </p><br><ol><li> è½¬åˆ°Google Cloud Platformæ§åˆ¶å°ä¸­<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„Kubernetes Engineé¡µé¢</a> ã€‚ </li><li> åˆ›å»ºæˆ–é€‰æ‹©ä¸€ä¸ªé¡¹ç›®ã€‚ </li><li> ç­‰å¾…APIå’Œç›¸å…³æœåŠ¡æ‰“å¼€ã€‚ è¿™å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿã€‚ </li><li> ç¡®ä¿ä¸ºGoogle Cloud Platformé¡¹ç›®é…ç½®äº†ç»“ç®—æ–¹å¼ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äº†è§£å¦‚ä½•å¯ç”¨ç»“ç®—</a> ã€‚ </li></ol><br><p> åœ¨æœ¬æŒ‡å—ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Cloud Shellï¼Œå®ƒå¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨</a>å…·æœ‰åŸºäºDebiançš„Linuxæˆ–Linuxæˆ–macOSè®¡ç®—æœº<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„Google Compute Engineä¸­</a>å‡†å¤‡<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">g1å°å‹</a>è™šæ‹Ÿæœºã€‚ </p><br><h3 id="variant-a-ispolzovanie-cloud-shell"> é€‰é¡¹Aï¼šä½¿ç”¨Cloud Shell </h3><br><p> ä½¿ç”¨Cloud Shellçš„å¥½å¤„ï¼š </p><br><ul><li> å®Œå…¨å®šåˆ¶äº†Python 2å’ŒPython 3å¼€å‘ç¯å¢ƒï¼ˆåŒ…æ‹¬<strong>virtualenv</strong> ï¼‰ã€‚ </li><li> æˆ‘ä»¬å°†ä½¿ç”¨çš„<strong>gcloud</strong> ï¼Œ <strong>docker</strong> ï¼Œ <strong>git</strong>å’Œ<strong>kubectl</strong>å‘½ä»¤è¡Œ<strong>å·¥å…·</strong>å·²ç»å®‰è£…ã€‚ </li><li> æ‚¨å¯ä»¥ä»ä»¥ä¸‹å‡ ç§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ–‡æœ¬ç¼–è¾‘å™¨ä¸­</a>è¿›è¡Œé€‰æ‹©ï¼š <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨</a> Cloud Shellçª—å£é¡¶éƒ¨çš„ç¼–è¾‘å›¾æ ‡æ‰“å¼€<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„ä»£ç ç¼–è¾‘å™¨</a> ã€‚ </li><li> ä»Cloud Shellä¸­çš„å‘½ä»¤è¡Œæ‰“å¼€çš„Emacsï¼ŒVimæˆ–Nanoã€‚ </li></ol></li></ul><br><p> è¦ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Cloud Shell</a> ï¼š </p><br><ol><li> è½¬åˆ°GCPæ§åˆ¶å°ã€‚ </li><li> å•å‡»GCPæ§åˆ¶å°çª—å£é¡¶éƒ¨çš„â€œ <strong>æ¿€æ´»Cloud Shellâ€</strong>æŒ‰é’®ã€‚ </li></ol><br><p><img src="https://habrastorage.org/webt/yu/sh/9x/yush9xie9_peummad02lgu2n5x8.png"></p><br><p> åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GCPæ§åˆ¶å°</a>çš„åº•éƒ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ï¼Œ</a>åœ¨æ–°çª—å£ä¸­ï¼Œä½¿ç”¨å‘½ä»¤è¡Œæ‰“å¼€Cloud Shellä¼šè¯ã€‚ </p><br><p><img src="https://habrastorage.org/webt/yi/no/-q/yino-qj5bwaluwxlo3xtf0yr7ty.png"></p><br><h3 id="variant-b-ispolzovanie-instrumentov-komandnoy-stroki-lokalno"> é€‰é¡¹Bï¼šåœ¨æœ¬åœ°ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…· </h3><br><p> å¦‚æœè¦åœ¨è£…æœ‰Linuxæˆ–macOSçš„è®¡ç®—æœºä¸Šå·¥ä½œï¼Œåˆ™éœ€è¦é…ç½®å’Œå®‰è£…ä»¥ä¸‹ç»„ä»¶ï¼š </p><br><ol><li><p> è®¾ç½®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Python 3å’ŒPython 2å¼€å‘ç¯å¢ƒ</a> ã€‚ </p><br></li><li><p> ä½¿ç”¨<strong>gcloud</strong>å‘½ä»¤è¡Œ<strong>å·¥å…·</strong> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®‰è£…Cloud SDK</a> ã€‚ </p><br></li><li><p> å®‰è£…<strong>kubectl</strong> ï¼Œè¿™æ˜¯ç”¨äº<strong>Kubernetes</strong>çš„å‘½ä»¤è¡Œå·¥å…·ã€‚ </p><br><pre><code class="plaintext hljs">gcloud components install kubectl</code> </pre> <br></li><li><p> å®‰è£…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Docker Community Editionï¼ˆCEï¼‰</a> ã€‚ æ‚¨å°†ä½¿ç”¨<strong>docker</strong>å‘½ä»¤è¡Œå·¥å…·ä¸ºç¤ºä¾‹åº”ç”¨ç¨‹åºåˆ›å»ºå®¹å™¨æ˜ åƒã€‚ </p><br></li><li><p> å®‰è£…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Gitç‰ˆæœ¬æ§åˆ¶</a>å·¥å…·ä»¥é€šè¿‡GitHubè·å–ç¤ºä¾‹åº”ç”¨ç¨‹åºã€‚ </p><br></li></ol><br><h3 id="zagruzka-primera-koda"> ä¸‹è½½ç¤ºä¾‹ä»£ç  </h3><br><ol><li><p> ä¸‹è½½<strong>helloserver</strong>æºä»£ç ï¼š </p><br><pre> <code class="plaintext hljs">git clone https://github.com/GoogleCloudPlatform/istio-samples</code> </pre> <br></li><li><p> è½¬åˆ°ç¤ºä¾‹ä»£ç ç›®å½•ï¼š </p><br><pre> <code class="plaintext hljs">cd istio-samples/sample-apps/helloserver</code> </pre> <br></li></ol><br><h3 id="izuchenie-prilozheniya-s-neskolkimi-servisami"> æ¢ç´¢å¤šæœåŠ¡åº”ç”¨ç¨‹åº </h3><br><p> è¯¥ç¤ºä¾‹åº”ç”¨ç¨‹åºæ˜¯ç”¨Pythonç¼–å†™çš„ï¼Œç”±ä¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">REST</a>äº¤äº’çš„ä¸¤ä¸ªç»„ä»¶ç»„æˆï¼š </p><br><ul><li>  <strong>æœåŠ¡å™¨</strong> ï¼šå…·æœ‰ä¸€ä¸ª<strong>GET</strong>ç«¯ç‚¹<strong>/</strong>çš„ç®€å•æœåŠ¡å™¨ï¼Œè¯¥æ§åˆ¶å°åœ¨æ§åˆ¶å°ä¸Šæ˜¾ç¤ºâ€œ hello worldâ€ã€‚ </li><li>  <strong>loadgen</strong> ï¼šä¸€ä¸ªè„šæœ¬ï¼Œå®ƒå°†æµé‡å‘é€åˆ°<strong>æœåŠ¡å™¨</strong> ï¼Œæ¯ç§’å¯é…ç½®çš„è¯·æ±‚æ•°ã€‚ </li></ul><br><p><img src="https://habrastorage.org/webt/b1/ky/lj/b1kyljxdkjdci12qtle2w3dmtjw.png"></p><br><h3 id="zapusk-prilozheniya-iz-ishodnogo-koda"> ä»æºä»£ç è¿è¡Œåº”ç”¨ç¨‹åº </h3><br><p> è¦äº†è§£ç¤ºä¾‹åº”ç”¨ç¨‹åºï¼Œè¯·åœ¨Cloud Shellæˆ–è®¡ç®—æœºä¸Šè¿è¡Œå®ƒã€‚ <br>  1ï¼‰åœ¨<strong>istio-samples / sample-apps / helloserver</strong>ç›®å½•ä¸­ï¼Œè¿è¡Œ<strong>server</strong> ï¼š </p><br><pre> <code class="plaintext hljs">python3 server/server.py</code> </pre> <br><p>  <strong>æœåŠ¡å™¨</strong>å¯åŠ¨æ—¶ï¼Œå°†æ˜¾ç¤ºä»¥ä¸‹å†…å®¹ï¼š </p><br><pre> <code class="plaintext hljs">INFO:root:Starting server...</code> </pre> <br><p>  2ï¼‰æ‰“å¼€å¦ä¸€ä¸ªç»ˆç«¯çª—å£ï¼Œä»¥å°†è¯·æ±‚å‘é€åˆ°<strong>æœåŠ¡å™¨</strong> ã€‚ å¦‚æœæ‚¨ä½¿ç”¨çš„æ˜¯Cloud Shellï¼Œè¯·å•å‡»æ·»åŠ å›¾æ ‡ä»¥æ‰“å¼€å¦ä¸€ä¸ªä¼šè¯ã€‚ <br>  3ï¼‰å‘<strong>æœåŠ¡å™¨</strong>å‘é€è¯·æ±‚ï¼š </p><br><pre> <code class="plaintext hljs">curl http://localhost:8080</code> </pre> <br><p> æœåŠ¡å™¨ç­”æ¡ˆï¼š </p><br><pre> <code class="plaintext hljs">Hello World!</code> </pre> <br><p>  4ï¼‰ä»ä¸‹è½½ç¤ºä¾‹ä»£ç çš„ç›®å½•ä¸­ï¼Œè½¬åˆ°åŒ…å«<strong>loadgen</strong>çš„ç›®å½•ï¼š </p><br><pre> <code class="plaintext hljs">cd YOUR_WORKING_DIRECTORY/istio-samples/sample-apps/helloserver/loadgen</code> </pre> <br><p>  5ï¼‰åˆ›å»ºä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š </p><br><pre> <code class="plaintext hljs">export SERVER_ADDR=http://localhost:8080 export REQUESTS_PER_SECOND=5</code> </pre> <br><p>  6ï¼‰è¿è¡Œ<strong>virtualenv</strong> ï¼š </p><br><pre> <code class="plaintext hljs">virtualenv --python python3 env</code> </pre> <br><p>  7ï¼‰æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼š </p><br><pre> <code class="plaintext hljs">source env/bin/activate</code> </pre> <br><p>  8ï¼‰è®¾ç½®<strong>loadgençš„</strong>è¦æ±‚ï¼š </p><br><pre> <code class="plaintext hljs">pip3 install -r requirements.txt</code> </pre> <br><p>  9ï¼‰è¿è¡Œ<strong>loadgen</strong> ï¼š </p><br><pre> <code class="plaintext hljs">python3 loadgen.py</code> </pre> <br><p> å¯åŠ¨æ—¶ï¼Œ <strong>loadgenå°†</strong>æ˜¾ç¤ºä»¥ä¸‹æ¶ˆæ¯ï¼š </p><br><pre> <code class="plaintext hljs">Starting loadgen: 2019-05-20 10:44:12.448415 5 request(s) complete to http://localhost:8080</code> </pre> <br><p> åœ¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£ä¸­ï¼Œ <strong>æœåŠ¡å™¨</strong>å‘æ§åˆ¶å°æ˜¾ç¤ºä»¥ä¸‹æ¶ˆæ¯ï¼š </p><br><pre> <code class="plaintext hljs">127.0.0.1 - - [21/Jun/2019 14:22:01] "GET / HTTP/1.1" 200 - INFO:root:GET request, Path: / Headers: Host: localhost:8080 User-Agent: python-requests/2.22.0 Accept-Encoding: gzip, deflate Accept: */*</code> </pre> <br><p> ä»ç½‘ç»œè§’åº¦æ¥çœ‹ï¼Œæ•´ä¸ªåº”ç”¨ç¨‹åºéƒ½åœ¨åŒä¸€ä¸»æœºï¼ˆæœ¬åœ°è®¡ç®—æœºæˆ–Cloud Shellè™šæ‹Ÿæœºï¼‰ä¸Šè¿è¡Œã€‚ å› æ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨<strong>localhost</strong>å°†è¯·æ±‚å‘é€åˆ°<strong>server</strong> ã€‚ <br>  10ï¼‰è¦åœæ­¢<strong>loadgen</strong>å’Œ<strong>server</strong> ï¼Œè¯·åœ¨æ¯ä¸ªç»ˆç«¯çª—å£ä¸­è¾“å…¥<strong>Ctrl-c</strong> ã€‚ <br>  11ï¼‰åœ¨<strong>loadgen</strong>ç»ˆç«¯<strong>çª—å£ä¸­ï¼Œ</strong>ç¦ç”¨è™šæ‹Ÿç¯å¢ƒï¼š </p><br><pre> <code class="plaintext hljs">deactivate</code> </pre> <br><h3 id="upakovka-prilozheniya-v-konteynery"> å°†åº”ç”¨ç¨‹åºåŒ…è£…åœ¨å®¹å™¨ä¸­ </h3><br><p> è¦åœ¨GKEä¸Šè¿è¡Œè¯¥åº”ç”¨ç¨‹åºï¼Œæ‚¨éœ€è¦å°†ç¤ºä¾‹åº”ç”¨ç¨‹åº<strong>æœåŠ¡å™¨</strong> - <strong>æœåŠ¡å™¨</strong>å’Œ<strong>loadgen-æ‰“åŒ…</strong>åˆ°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®¹å™¨ä¸­</a> ã€‚ å®¹å™¨æ˜¯æ‰“åŒ…åº”ç”¨ç¨‹åºä»¥ä½¿å…¶ä¸ç¯å¢ƒéš”ç¦»çš„ä¸€ç§æ–¹å¼ã€‚ </p><br><p> è¦å°†åº”ç”¨ç¨‹åºæ‰“åŒ…åœ¨å®¹å™¨ä¸­ï¼Œæ‚¨éœ€è¦ä¸€ä¸ª<strong>Dockerfile</strong> ã€‚  <strong>Dockerfile</strong>æ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œå®šä¹‰ç”¨äºå°†åº”ç”¨ç¨‹åºæºä»£ç åŠå…¶ä¾èµ–é¡¹æ„å»ºåˆ°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Dockeræ˜ åƒä¸­çš„å‘½ä»¤ã€‚</a> æ„å»ºåï¼Œå°†æ˜ åƒä¸Šä¼ åˆ°å®¹å™¨æ³¨å†Œè¡¨ï¼Œä¾‹å¦‚Docker Hubæˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Container Registry</a> ã€‚ </p><br><p> è¯¥ç¤ºä¾‹å·²ç»å…·æœ‰ç”¨äº<strong>æœåŠ¡å™¨</strong>å’Œ<strong>loadgen</strong>çš„<strong>Dockerfile</strong> ï¼Œä»¥åŠç”¨äºç»„è£…æ˜ åƒçš„æ‰€æœ‰å¿…éœ€å‘½ä»¤ã€‚ ä»¥ä¸‹æ˜¯<strong>æœåŠ¡å™¨</strong>çš„<strong>Dockerfile</strong> ï¼š </p><br><pre> <code class="plaintext hljs">FROM python:3-slim as base FROM base as builder RUN apt-get -qq update \ &amp;&amp; apt-get install -y --no-install-recommends \ g++ \ &amp;&amp; rm -rf /var/lib/apt/lists/* # Enable unbuffered logging FROM base as final ENV PYTHONUNBUFFERED=1 RUN apt-get -qq update \ &amp;&amp; apt-get install -y --no-install-recommends \ wget WORKDIR /helloserver # Grab packages from builder COPY --from=builder /usr/local/lib/python3.7/ /usr/local/lib/python3.7/ # Add the application COPY . . EXPOSE 8080 ENTRYPOINT [ "python", "server.py" ]</code> </pre> <br><ul><li>  <strong>FROM pythonï¼š3-slim as base</strong>å‘½ä»¤å¯ä»¥å‘Šè¯‰Dockerä½¿ç”¨æœ€æ–°çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Python 3æ˜ åƒ</a>ä½œä¸ºåŸºç¡€ã€‚ </li><li>  <strong>COPY</strong>å›¢é˜Ÿ<strong>ã€‚</strong>  <strong>ã€‚</strong> å°†æºæ–‡ä»¶å¤åˆ¶åˆ°å®¹å™¨æ–‡ä»¶ç³»ç»Ÿä¸­çš„å½“å‰å·¥ä½œç›®å½•ï¼ˆåœ¨æœ¬ç¤ºä¾‹ä¸­ï¼Œä»…æ˜¯<strong>server.py</strong> ï¼‰ã€‚ </li><li>  <strong>ENTRYPOINT</strong>å®šä¹‰ç”¨äºå¯åŠ¨å®¹å™¨çš„å‘½ä»¤ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œæ­¤å‘½ä»¤ä¸ç”¨äºä»æºä»£ç è¿è¡Œ<strong>server.pyçš„</strong>å‘½ä»¤å‡ ä¹ç›¸åŒã€‚ </li><li>  <strong>EXPOSE</strong>å‘½ä»¤æŒ‡ç¤º<strong>æœåŠ¡å™¨</strong>æ­£åœ¨ä¾¦å¬ç«¯å£<strong>8080</strong> ã€‚ è¯¥å‘½ä»¤ä¸<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æä¾›ç«¯å£</a> ã€‚ è¿™æ˜¯åœ¨å®¹å™¨å¯åŠ¨æ—¶æ‰“å¼€ç«¯å£<strong>8080</strong>æ‰€éœ€çš„æŸç§æ–‡æ¡£ã€‚ </li></ul><br><h3 id="podgotovka-k-konteynerizacii-prilozheniya"> å‡†å¤‡åº”ç”¨ç¨‹åºå®¹å™¨åŒ– </h3><br><p>  1ï¼‰è®¾ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ã€‚ ç”¨æ‚¨çš„GCPé¡¹ç›®æ ‡è¯†ç¬¦æ›¿æ¢<strong>PROJECT_ID</strong> ã€‚ </p><br><pre> <code class="plaintext hljs">export PROJECT_ID="PROJECT_ID"</code> </pre> <br><pre> <code class="plaintext hljs">export GCR_REPO="preparing-istio"</code> </pre> <br><p> ä½¿ç”¨<strong>PROJECT_ID</strong>å’Œ<strong>GCR_REPOå€¼ï¼Œ</strong>æ‚¨å¯ä»¥åœ¨æ”¶é›†Dockeræ˜ åƒå¹¶å°†å…¶å‘é€åˆ°ç§æœ‰Container Registryæ—¶å¯¹å…¶è¿›è¡Œæ ‡è®°ã€‚ </p><br><p>  2ï¼‰ä¸º<strong>gcloud</strong>å‘½ä»¤è¡Œ<strong>å·¥å…·</strong>è®¾ç½®é»˜è®¤çš„GCPé¡¹ç›®ã€‚ </p><br><pre> <code class="plaintext hljs">gcloud config set project $PROJECT_ID</code> </pre> <br><p>  3ï¼‰è®¾ç½®<strong>gcloud</strong>å‘½ä»¤è¡Œ<strong>å·¥å…·</strong>çš„é»˜è®¤åŒºåŸŸã€‚ </p><br><pre> <code class="plaintext hljs">gcloud config set compute/zone us-central1-b</code> </pre> <br><p>  4ï¼‰ç¡®ä¿GCPé¡¹ç›®ä¸­åŒ…å«Container RegistryæœåŠ¡ã€‚ </p><br><pre> <code class="plaintext hljs">gcloud services enable containerregistry.googleapis.com</code> </pre> <br><h3 id="konteynerizaciya-server"> é›†è£…ç®±åŒ–æœåŠ¡å™¨ </h3><br><ol><li><p> åˆ‡æ¢åˆ°<strong>æœåŠ¡å™¨</strong>ç¤ºä¾‹æ‰€åœ¨çš„ç›®å½•ï¼š </p><br><pre> <code class="plaintext hljs">cd YOUR_WORKING_DIRECTORY/istio-samples/sample-apps/helloserver/server/</code> </pre> <br></li><li><p> ä½¿ç”¨å…ˆå‰å®šä¹‰çš„<strong>Dockerfile</strong>å’Œç¯å¢ƒå˜é‡æ„å»ºæ˜ åƒï¼š </p><br><pre> <code class="plaintext hljs">docker build -t gcr.io/$PROJECT_ID/$GCR_REPO/helloserver:v0.0.1 .</code> </pre> <br></li></ol><br><p>  <strong>-té€‰é¡¹</strong>ä»£è¡¨Dockeræ ‡ç­¾ã€‚ è¿™æ˜¯æ‚¨åœ¨éƒ¨ç½²å®¹å™¨æ—¶ä½¿ç”¨çš„æ˜ åƒçš„åç§°ã€‚ </p><br><ol><li> å°†å›¾åƒå‘é€åˆ°å®¹å™¨æ³¨å†Œè¡¨ï¼š <br><pre> <code class="plaintext hljs">docker push gcr.io/$PROJECT_ID/$GCR_REPO/helloserver:v0.0.1</code> </pre> </li></ol><br><h3 id="konteynerizaciya-loadgen"> é›†è£…ç®±è£…è½½æœº </h3><br><p>  1ï¼‰è½¬åˆ°<strong>loadgen</strong>ç¤ºä¾‹æ‰€åœ¨çš„ç›®å½•ï¼š </p><br><pre> <code class="plaintext hljs">cd ../loadgen</code> </pre> <br><p>  2ï¼‰ç»„è£…å›¾ç‰‡ï¼š </p><br><pre> <code class="plaintext hljs">docker build -t gcr.io/$PROJECT_ID/$GCR_REPO/loadgen:v0.0.1 .</code> </pre> <br><p>  3ï¼‰å°†å›¾ç‰‡å‘é€åˆ°Container Registryï¼š </p><br><pre> <code class="plaintext hljs">docker push gcr.io/$PROJECT_ID/$GCR_REPO/loadgen:v0.0.1</code> </pre> <br><h3 id="prosmotr-spiska-obrazov"> æŸ¥çœ‹å›¾åƒåˆ—è¡¨ </h3><br><p> æµè§ˆå­˜å‚¨åº“ä¸­çš„å›¾åƒåˆ—è¡¨ï¼Œå¹¶ç¡®ä¿å·²å‘é€å›¾åƒï¼š </p><br><pre> <code class="plaintext hljs">gcloud container images list --repository gcr.io/$PROJECT_ID/preparing-istio</code> </pre> <br><p> è¯¥å‘½ä»¤æ˜¾ç¤ºåˆšå‘é€çš„å›¾åƒçš„åç§°ï¼š </p><br><pre> <code class="plaintext hljs">NAME gcr.io/PROJECT_ID/preparing-istio/helloserver gcr.io/PROJECT_ID/preparing-istio/loadgen</code> </pre> <br><h3 id="sozdanie-klastera-gke"> åˆ›å»ºä¸€ä¸ªGKEé›†ç¾¤ </h3><br><p> å¯ä»¥ä½¿ç”¨<strong>docker runå‘½ä»¤</strong>åœ¨Cloud Shellè™šæ‹Ÿæœºæˆ–è®¡ç®—æœºä¸Šè¿è¡Œè¿™äº›å®¹å™¨ã€‚ ä½†æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ‚¨éœ€è¦ä¸€ç§å¯¹å®¹å™¨è¿›è¡Œé›†ä¸­ç¼–æ’çš„æ–¹æ³•ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç¡®ä¿å®¹å™¨å§‹ç»ˆè¿è¡Œçš„ç³»ç»Ÿï¼Œå¹¶ä¸”éœ€è¦ä¸€ç§æ–¹æ³•æ¥åœ¨æµé‡å¢åŠ æ—¶æ”¾å¤§å¹¶å¯åŠ¨å…¶ä»–å®¹å™¨å®ä¾‹ã€‚ </p><br><p> æ‚¨å¯ä»¥ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GKE</a>è¿è¡Œå®¹å™¨åº”ç”¨ç¨‹åºã€‚  GKEæ˜¯å¯¹è™šæ‹Ÿæœºè¿›è¡Œé›†ç¾¤çš„å®¹å™¨ç¼–æ’å¹³å°ã€‚ æ¯ä¸ªè™šæ‹Ÿæœºç§°ä¸ºä¸»æœºã€‚  GKEé›†ç¾¤åŸºäºå¼€æºé›†ç¾¤ç®¡ç†ç³»ç»ŸKubernetesã€‚  Kubernetesæä¾›äº†ä¸é›†ç¾¤äº¤äº’çš„æœºåˆ¶ã€‚ </p><br><p> åˆ›å»ºä¸€ä¸ªGKEé›†ç¾¤ï¼š </p><br><p>  1ï¼‰åˆ›å»ºä¸€ä¸ªé›†ç¾¤ï¼š </p><br><pre> <code class="plaintext hljs">gcloud container clusters create istioready \ --cluster-version latest \ --machine-type=n1-standard-2 \ --num-nodes 4</code> </pre> <br><p>  <strong>gcloud</strong>å‘½ä»¤åœ¨GCPé¡¹ç›®å’Œæ‚¨æŒ‡å®šçš„é»˜è®¤åŒºåŸŸä¸­åˆ›å»ºä¸€ä¸ª<strong>istioready</strong>ç¾¤é›†ã€‚ è¦å¯åŠ¨Istioï¼Œå»ºè®®æ‚¨è‡³å°‘æœ‰4ä¸ªèŠ‚ç‚¹å’Œä¸€å°<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">n1-standard-2</a>è™šæ‹Ÿæœºã€‚ </p><br><p> è¯¥å›¢é˜Ÿå°†åˆ›å»ºä¸€ä¸ªé›†ç¾¤å‡ åˆ†é’Ÿã€‚ é›†ç¾¤å°±ç»ªåï¼Œè¯¥å‘½ä»¤å°†å‘å‡ºç±»ä¼¼çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ¶ˆæ¯</a> ã€‚ </p><br><p>  2ï¼‰åœ¨<strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">kubectl</a></strong>å‘½ä»¤è¡Œ<strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å·¥å…·ä¸­</a></strong>æŒ‡å®šå‡­æ®ä»¥ä½¿ç”¨å®ƒæ¥ç®¡ç†é›†ç¾¤ï¼š </p><br><pre> <code class="plaintext hljs">gcloud container clusters get-credentials istioready</code> </pre> <br><p>  3ï¼‰ç°åœ¨æ‚¨å¯ä»¥é€šè¿‡<strong>kubectl</strong>ä¸Kubernetesè¿›è¡Œé€šä¿¡äº†ã€‚ ä¾‹å¦‚ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼Œæ‚¨å¯ä»¥æ‰¾åˆ°èŠ‚ç‚¹çš„çŠ¶æ€ï¼š </p><br><pre> <code class="plaintext hljs">kubectl get nodes</code> </pre> <br><p> è¯¥å‘½ä»¤æ˜¾ç¤ºèŠ‚ç‚¹åˆ—è¡¨ï¼š </p><br><pre> <code class="plaintext hljs">NAME STATUS ROLES AGE VERSION gke-istoready-default-pool-dbeb23dc-1vg0 Ready &lt;none&gt; 99s v1.13.6-gke.13 gke-istoready-default-pool-dbeb23dc-36z5 Ready &lt;none&gt; 100s v1.13.6-gke.13 gke-istoready-default-pool-dbeb23dc-fj7s Ready &lt;none&gt; 99s v1.13.6-gke.13 gke-istoready-default-pool-dbeb23dc-wbjw Ready &lt;none&gt; 99s v1.13.6-gke.13</code> </pre> <br><h3 id="klyuchevye-ponyatiya-kubernetes">  Kubernetesçš„å…³é”®æ¦‚å¿µ </h3><br><p> è¯¥å›¾æ˜¾ç¤ºäº†GKEä¸Šçš„åº”ç”¨ç¨‹åºï¼š </p><br><p><img src="https://habrastorage.org/webt/-s/x2/uj/-sx2ujtlifvzdtixzdqpnr9jzva.png"></p><br><p> åœ¨å°†å®¹å™¨éƒ¨ç½²åˆ°GKEä¹‹å‰ï¼Œè¯·æŸ¥çœ‹Kubernetesçš„å…³é”®æ¦‚å¿µã€‚ å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·åœ¨æœ€åæ‰¾åˆ°é“¾æ¥ã€‚ </p><br><ul><li>  <strong>èŠ‚ç‚¹å’Œé›†ç¾¤</strong> ã€‚ åœ¨GKEä¸­ï¼ŒèŠ‚ç‚¹æ˜¯è™šæ‹Ÿæœºã€‚ åœ¨å…¶ä»–Kuberneteså¹³å°ä¸Šï¼Œä¸»æœºå¯ä»¥æ˜¯è®¡ç®—æœºæˆ–è™šæ‹Ÿæœºã€‚ ç¾¤é›†æ˜¯èŠ‚ç‚¹çš„é›†åˆï¼Œå¯ä»¥å°†å®ƒä»¬è§†ä¸ºä¸€ä¸ªæ•´ä½“ï¼Œå¹¶åœ¨å…¶ä¸­éƒ¨ç½²å®¹å™¨åŒ–çš„åº”ç”¨ç¨‹åºã€‚ </li><li>  <strong>è±†èš</strong> ã€‚ åœ¨Kubernetesä¸­ï¼Œå®¹å™¨åœ¨podä¸­è¿è¡Œã€‚  Kubernetesä¸­çš„Podæ˜¯ä¸å¯åˆ†å‰²çš„å•å…ƒã€‚ åŠèˆ±å¯å®¹çº³ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚ æ‚¨å°†æœåŠ¡å™¨<strong>å®¹å™¨</strong>å’Œ<strong>loadgenå®¹å™¨</strong>éƒ¨ç½²åœ¨å•ç‹¬çš„<strong>å®¹å™¨</strong>ä¸­ã€‚ å½“Podä¸­æœ‰å¤šä¸ªå®¹å™¨æ—¶ï¼ˆä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºæœåŠ¡å™¨å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»£ç†æœåŠ¡å™¨</a> ï¼‰ï¼Œè¿™äº›å®¹å™¨å°†ä½œä¸ºå•ä¸ªå¯¹è±¡è¿›è¡Œç®¡ç†å¹¶å…±äº«Podçš„èµ„æºã€‚ </li><li>  <strong>éƒ¨ç½²</strong> ã€‚ åœ¨Kubernetesä¸­ï¼Œéƒ¨ç½²æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯ç›¸åŒpodçš„é›†åˆã€‚ éƒ¨ç½²è¿è¡Œåˆ†å¸ƒåœ¨é›†ç¾¤èŠ‚ç‚¹ä¸Šçš„å¤šä¸ªPodå‰¯æœ¬ã€‚ éƒ¨ç½²ä¼šè‡ªåŠ¨æ›¿æ¢å¤±è´¥æˆ–ä¸å“åº”çš„Podã€‚ </li><li>  <strong>KubernetesæœåŠ¡</strong> ã€‚ åœ¨GKEä¸­è¿è¡Œåº”ç”¨ç¨‹åºä»£ç æ—¶ï¼Œ <strong>loadgen</strong>å’Œ<strong>æœåŠ¡å™¨</strong>ä¹‹é—´çš„è¿æ¥ä¼šæ›´æ”¹ã€‚ åœ¨Cloud Shellè™šæ‹Ÿæœºæˆ–è®¡ç®—æœºä¸Šå¯åŠ¨æœåŠ¡æ—¶ï¼Œæ‚¨å‘<strong>localhostï¼š8080</strong>çš„<strong>æœåŠ¡å™¨</strong>å‘é€äº†è¯·æ±‚ã€‚ éƒ¨ç½²åˆ°GKEåï¼Œpodå°†åœ¨å¯ç”¨èŠ‚ç‚¹ä¸Šè¿è¡Œã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‚¨æ— æ³•æ§åˆ¶æ­£åœ¨è¿è¡Œçš„ä¸»æœºPodï¼Œå› æ­¤<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Pod</a>æ²¡æœ‰æ°¸ä¹…IPåœ°å€ã€‚ <br> è¦è·å–<strong>æœåŠ¡å™¨</strong>çš„IPåœ°å€ï¼Œæ‚¨éœ€è¦åœ¨Podé¡¶éƒ¨å®šä¹‰ç½‘ç»œæŠ½è±¡ã€‚ è¿™å°±æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">KubernetesæœåŠ¡</a> ã€‚  KubernetesæœåŠ¡ä¸ºä¸€ç»„Podæä¾›äº†ä¸€ä¸ªæ°¸ä¹…ç«¯ç‚¹ã€‚ æœ‰å‡ ç§<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç±»å‹çš„æœåŠ¡</a> ã€‚  <strong>æœåŠ¡å™¨</strong>ä½¿ç”¨<strong>LoadBalancer</strong> ï¼Œè¯¥<strong>è´Ÿè½½</strong>æä¾›ä¸€ä¸ªå¤–éƒ¨IPåœ°å€ä»¥ä»ç¾¤é›†å¤–éƒ¨ä¸<strong>æœåŠ¡å™¨</strong>è”ç³»ã€‚ <br>  Kubernetesè¿˜å…·æœ‰ä¸€ä¸ªé›†æˆçš„DNSç³»ç»Ÿï¼Œè¯¥ç³»ç»Ÿä¸ºæœåŠ¡åˆ†é…DNSåç§°ï¼ˆä¾‹å¦‚<strong>helloserver.default.cluster.local</strong> ï¼‰ã€‚ å› æ­¤ï¼Œç¾¤é›†ä¸­çš„Podä¸ç¾¤é›†ä¸­å…¶ä»–Podåœ¨å›ºå®šåœ°å€è¿›è¡Œé€šä¿¡ã€‚ æ— æ³•åœ¨ç¾¤é›†å¤–éƒ¨ï¼ˆä¾‹å¦‚åœ¨Cloud Shellæˆ–è®¡ç®—æœºä¸Šï¼‰ä½¿ç”¨DNSåç§°ã€‚ </li></ul><br><h3 id="manifesty-kubernetes">  Kubernetesæ¸…å• </h3><br><p> ä»æºä»£ç å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶ï¼Œæ‚¨ä½¿ç”¨äº†å‘½ä»¤å¼<strong>python3</strong>å‘½ä»¤ </p><br><p>  <strong>server.py</strong> </p><br><p> å‘½ä»¤å¼éšå«äº†åŠ¨è¯ï¼šâ€œåšâ€ã€‚ </p><br><p>  Kubernetesä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å£°æ˜æ€§æ¨¡å‹</a> ã€‚ è¿™æ„å‘³ç€æˆ‘ä»¬ä¸ä¼šå‘Šè¯‰Kubernetesåˆ°åº•éœ€è¦åšä»€ä¹ˆï¼Œè€Œæ˜¯è¦æè¿°æ‰€éœ€çš„çŠ¶æ€ã€‚ ä¾‹å¦‚ï¼ŒKubernetesä¼šæ ¹æ®éœ€è¦å¯åŠ¨å’Œåœæ­¢Podï¼Œå› æ­¤ç³»ç»Ÿçš„å®é™…çŠ¶æ€æ˜¯æ‰€éœ€çš„ã€‚ </p><br><p> æ‚¨å¯ä»¥åœ¨æ¸…å•æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">YAML</a>æ–‡ä»¶ä¸­æŒ‡å®šæ‰€éœ€çš„çŠ¶æ€ã€‚  YAMLæ–‡ä»¶åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªKuberneteså¯¹è±¡çš„è§„èŒƒã€‚ </p><br><p> è¯¥ç¤ºä¾‹åŒ…å«ç”¨äº<strong>server</strong>å’Œ<strong>loadgen</strong>çš„YAMLæ–‡ä»¶ã€‚ æ¯ä¸ªYAMLæ–‡ä»¶éƒ½æŒ‡ç¤ºéƒ¨ç½²å¯¹è±¡å’ŒKubernetesæœåŠ¡çš„æ‰€éœ€çŠ¶æ€ã€‚ </p><br><p>  <strong>server.yaml</strong> </p><br><pre> <code class="plaintext hljs">apiVersion: apps/v1 kind: Deployment metadata: name: helloserver spec: selector: matchLabels: app: helloserver replicas: 1 template: metadata: labels: app: helloserver spec: terminationGracePeriodSeconds: 5 restartPolicy: Always containers: - name: main image: gcr.io/google-samples/istio/helloserver:v0.0.1 imagePullPolicy: Always</code> </pre> <br><ul><li>  <strong>kind</strong>æŒ‡ç¤ºå¯¹è±¡çš„ç±»å‹ã€‚ </li><li>  <strong>metadata.name</strong>æŒ‡ç¤ºéƒ¨ç½²çš„åç§°ã€‚ </li><li> ç¬¬ä¸€å­—æ®µ<strong>è§„èŒƒ</strong>åŒ…å«å¯¹æ‰€éœ€çŠ¶æ€çš„æè¿°ã€‚ </li><li>  <strong>spec.replicas</strong>æŒ‡ç¤ºæ‰€éœ€çš„è±†èšæ•°é‡ã€‚ </li><li>  <strong>spec.template</strong>éƒ¨åˆ†å®šä¹‰äº†<strong>pod</strong>æ¨¡æ¿ã€‚ åœ¨podè§„èŒƒä¸­ï¼Œæœ‰ä¸€ä¸ª<strong>image</strong>å­—æ®µï¼Œå…¶ä¸­æŒ‡ç¤ºè¦ä»Container Registryä¸­æå–çš„å›¾åƒçš„åç§°ã€‚ </li></ul><br><p> æœåŠ¡å®šä¹‰å¦‚ä¸‹ï¼š </p><br><pre> <code class="plaintext hljs">apiVersion: v1 kind: Service metadata: name: hellosvc spec: type: LoadBalancer selector: app: helloserver ports: - name: http port: 80 targetPort: 8080</code> </pre> <br><ul><li>  <strong>LoadBalancer</strong> ï¼šå®¢æˆ·ç«¯å°†è¯·æ±‚å‘é€åˆ°è´Ÿè½½å¹³è¡¡å™¨çš„IPåœ°å€ï¼Œè¯¥åœ°å€å…·æœ‰å›ºå®šçš„IPåœ°å€ï¼Œå¹¶ä¸”å¯ä»¥ä»ç¾¤é›†å¤–éƒ¨è®¿é—®ã€‚ </li><li>  <strong>targetPort</strong> ï¼šæ‚¨è¿˜è®°å¾—ï¼Œ <strong>Dockerfileä¸­çš„EXPOSE 8080</strong>å‘½ä»¤æ²¡æœ‰æä¾›ç«¯å£ã€‚ æ‚¨æä¾›ç«¯å£<strong>8080ï¼Œ</strong>ä»¥ä¾¿å¯ä»¥ä»ç¾¤é›†å¤–éƒ¨è®¿é—®<strong>æœåŠ¡å™¨</strong>å®¹å™¨ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œ <strong>hellosvc.default.cluster.localï¼š80</strong> ï¼ˆçŸ­åç§°ï¼š <strong>hellosvc</strong> ï¼‰å¯¹åº”äº<strong>helloserver</strong>å®¹å™¨IPåœ°å€çš„ç«¯å£<strong>8080</strong> ã€‚ </li><li>  <strong>port</strong> ï¼šè¿™æ˜¯é›†ç¾¤ä¸­å…¶ä»–æœåŠ¡å°†å‘é€è¯·æ±‚çš„ç«¯å£å·ã€‚ </li></ul><br><p>  <strong>loadgen.yaml</strong> </p><br><p>  <strong>loadgen.yamlä¸­</strong>çš„éƒ¨ç½²å¯¹è±¡ç±»ä¼¼äº<strong>server.yaml</strong> ã€‚ åŒºåˆ«åœ¨äºéƒ¨ç½²å¯¹è±¡åŒ…å«ä¸€ä¸ª<strong>env</strong>éƒ¨åˆ†ã€‚ å®ƒå®šä¹‰äº†<strong>loadgen</strong>æ‰€éœ€çš„ç¯å¢ƒå˜é‡ä»¥åŠæ‚¨ä»æºä»£ç å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶è®¾ç½®çš„ç¯å¢ƒå˜é‡ã€‚ </p><br><pre> <code class="plaintext hljs">apiVersion: apps/v1 kind: Deployment metadata: name: loadgenerator spec: selector: matchLabels: app: loadgenerator replicas: 1 template: metadata: labels: app: loadgenerator spec: terminationGracePeriodSeconds: 5 restartPolicy: Always containers: - name: main image: gcr.io/google-samples/istio/loadgen:v0.0.1 imagePullPolicy: Always env: - name: SERVER_ADDR value: "http://hellosvc:80/" - name: REQUESTS_PER_SECOND value: "10" resources: requests: cpu: 300m memory: 256Mi limits: cpu: 500m memory: 512Mi</code> </pre> <br><p> ç”±äº<strong>loadgen</strong>ä¸æ¥å—ä¼ å…¥è¯·æ±‚ï¼Œ <strong>å› æ­¤</strong>ä¸º<strong>type</strong>å­—æ®µæŒ‡å®šäº†<strong>ClusterIP</strong> ã€‚ æ­¤ç±»å‹æä¾›äº†ç¾¤é›†ä¸­çš„æœåŠ¡å¯ä»¥ä½¿ç”¨çš„å›ºå®šIPåœ°å€ï¼Œä½†æ˜¯æœªå‘å¤–éƒ¨å®¢æˆ·ç«¯æä¾›æ­¤IPåœ°å€ã€‚ </p><br><pre> <code class="plaintext hljs">apiVersion: v1 kind: Service metadata: name: loadgensvc spec: type: ClusterIP selector: app: loadgenerator ports: - name: http port: 80 targetPort: 8080</code> </pre> <br><h3 id="razvertyvanie-konteynerov-v-gke"> åœ¨GKEä¸­éƒ¨ç½²å®¹å™¨ </h3><br><p>  1ï¼‰è½¬åˆ°<strong>æœåŠ¡å™¨</strong>ç¤ºä¾‹æ‰€åœ¨çš„ç›®å½•ï¼š </p><br><pre> <code class="plaintext hljs">cd YOUR_WORKING_DIRECTORY/istio-samples/sample-apps/helloserver/server/</code> </pre> <br><p>  2ï¼‰åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰“å¼€<strong>server.yaml</strong> ã€‚ <br>  3ï¼‰å°†<strong>image</strong>å­—æ®µä¸­çš„åç§°æ›¿æ¢ä¸ºDockeræ˜ åƒçš„åç§°ã€‚ </p><br><pre> <code class="plaintext hljs">image: gcr.io/PROJECT_ID/preparing-istio/helloserver:v0.0.1</code> </pre> <br><p> å°†<strong>PROJECT_ID</strong>æ›¿æ¢ä¸ºGCPé¡¹ç›®çš„æ ‡è¯†ç¬¦ã€‚ <br>  4ï¼‰ä¿å­˜å¹¶å…³é—­<strong>server.yaml</strong> ã€‚ <br>  5ï¼‰åœ¨Kubernetesä¸­å±•å¼€YAMLæ–‡ä»¶ï¼š </p><br><pre> <code class="plaintext hljs">kubectl apply -f server.yaml</code> </pre> <br><p> æˆåŠŸå®Œæˆåï¼Œè¯¥å‘½ä»¤å°†å‘å‡ºä»¥ä¸‹ä»£ç ï¼š </p><br><pre> <code class="plaintext hljs">deployment.apps/helloserver created service/hellosvc created</code> </pre> <br><p>  6ï¼‰è½¬åˆ°<strong>loadgen</strong>æ‰€åœ¨çš„ç›®å½•ï¼š </p><br><pre> <code class="plaintext hljs">cd ../loadgen</code> </pre> <br><p>  7ï¼‰åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰“å¼€<strong>loadgen.yaml</strong> ã€‚ <br>  8ï¼‰å°†<strong>image</strong>å­—æ®µä¸­çš„åç§°æ›¿æ¢ä¸ºDockeræ˜ åƒçš„åç§°ã€‚ </p><br><pre> <code class="plaintext hljs">image: gcr.io/PROJECT_ID/preparing-istio/loadgenv0.0.1</code> </pre> <br><p> å°†<strong>PROJECT_ID</strong>æ›¿æ¢ä¸ºGCPé¡¹ç›®çš„æ ‡è¯†ç¬¦ã€‚ <br>  9ï¼‰ä¿å­˜å¹¶å…³é—­<strong>loadgen.yaml</strong> ï¼Œå…³é—­æ–‡æœ¬ç¼–è¾‘å™¨ã€‚ <br>  10ï¼‰åœ¨Kubernetesä¸­å±•å¼€YAMLæ–‡ä»¶ï¼š </p><br><pre> <code class="plaintext hljs">kubectl apply -f loadgen.yaml</code> </pre> <br><p> æˆåŠŸå®Œæˆåï¼Œè¯¥å‘½ä»¤å°†å‘å‡ºä»¥ä¸‹ä»£ç ï¼š </p><br><pre> <code class="plaintext hljs">deployment.apps/loadgenerator created service/loadgensvc created</code> </pre> <br><p>  11ï¼‰æ£€æŸ¥ç‚‰è†›çŠ¶æ€ï¼š </p><br><pre> <code class="plaintext hljs">kubectl get pods</code> </pre> <br><p> è¯¥å‘½ä»¤æ˜¾ç¤ºçŠ¶æ€ï¼š </p><br><pre> <code class="plaintext hljs">NAME READY STATUS RESTARTS AGE helloserver-69b9576d96-mwtcj 1/1 Running 0 58s loadgenerator-774dbc46fb-gpbrz 1/1 Running 0 57s</code> </pre> <br><p>  12ï¼‰ä»<strong>loadgen</strong> podä¸­æå–åº”ç”¨ç¨‹åºæ—¥å¿—ã€‚  <strong>ç”¨ä¸Š</strong>ä¸€ä¸ªç­”æ¡ˆä¸­çš„æ ‡è¯†ç¬¦æ›¿æ¢<strong>POD_ID</strong> ã€‚ </p><br><pre> <code class="plaintext hljs">kubectl logs loadgenerator-POD_ID</code> </pre> <br><p>  13ï¼‰è·å–å¤–éƒ¨<strong>hellosvc IP</strong> ï¼š </p><br><pre> <code class="plaintext hljs">kubectl get service</code> </pre> <br><p> å‘½ä»¤å“åº”å¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="plaintext hljs">NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE hellosvc LoadBalancer 10.81.15.158 192.0.2.1 80:31127/TCP 33m kubernetes ClusterIP 10.81.0.1 &lt;none&gt; 443/TCP 93m loadgensvc ClusterIP 10.81.15.155 &lt;none&gt; 80/TCP 4m52s</code> </pre> <br><p>  14ï¼‰å‘<strong>hellosvc</strong>å‘é€è¯·æ±‚ï¼šå°†<strong>EXTERNAL_IP</strong>æ›¿æ¢ä¸º<strong>hellosvc</strong>çš„å¤–éƒ¨IPåœ°å€ã€‚ </p><br><pre> <code class="plaintext hljs">curl http://EXTERNAL_IP</code> </pre> <br><h3 id="beremsya-za-istio"> æŠ¢åŠ«ä¼Šæ–¯è’‚å¥¥ </h3><br><p> æ‚¨å·²ç»æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°GKEã€‚  <strong>loadgen</strong>å¯ä»¥ä½¿ç”¨Kubernetes DNSï¼ˆ <strong>hellosvcï¼š80</strong> ï¼‰å°†è¯·æ±‚å‘é€åˆ°<strong>æœåŠ¡å™¨</strong> ï¼Œå¹¶ä¸”æ‚¨å¯ä»¥ä½¿ç”¨å¤–éƒ¨IPåœ°å€å°†è¯·æ±‚å‘é€åˆ°<strong>æœåŠ¡å™¨</strong> ã€‚ å°½ç®¡Kuberneteså…·æœ‰è®¸å¤šåŠŸèƒ½ï¼Œä½†æ˜¯ç¼ºå°‘æœ‰å…³æœåŠ¡çš„ä¸€äº›ä¿¡æ¯ï¼š </p><br><ul><li>  <strong>æœåŠ¡å¦‚ä½•ç›¸äº’ä½œç”¨ï¼Ÿ</strong> æœåŠ¡ä¹‹é—´æ˜¯ä»€ä¹ˆå…³ç³»ï¼Ÿ æœåŠ¡ä¹‹é—´çš„æµé‡å¦‚ä½•ï¼Ÿ æ‚¨çŸ¥é“<strong>loadgen</strong>å°†è¯·æ±‚å‘é€åˆ°<strong>æœåŠ¡å™¨</strong> ï¼Œä½†å¯ä»¥æƒ³è±¡æ‚¨å¯¹åº”ç”¨ç¨‹åºä¸€æ— æ‰€çŸ¥ã€‚ ä¸ºäº†å›ç­”è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬æŸ¥çœ‹äº†GKEä¸­è¿è¡Œçš„ç‚‰åºŠæ¸…å•ã€‚ </li><li>  <strong>æŒ‡æ ‡</strong> ã€‚  <strong>æœåŠ¡å™¨</strong>å¯¹ä¼ å…¥è¯·æ±‚çš„å“åº”æ—¶é—´ä¸ºå¤šé•¿æ—¶é—´ï¼Ÿ æ¯ç§’æœ‰å¤šå°‘ä¸ªè¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ï¼Ÿ å®ƒä¼šç»™å‡ºé”™è¯¯æ¶ˆæ¯å—ï¼Ÿ </li><li>  <strong>å®‰å…¨ä¿¡æ¯</strong> ã€‚  <strong>loadgen</strong>å’Œ<strong>æœåŠ¡å™¨</strong>ä¹‹é—´<strong>çš„</strong>é€šä¿¡<strong>æ˜¯å¦</strong>ä»…é€šè¿‡<strong>HTTP</strong>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">mTLSè¿›è¡Œ</a> ï¼Ÿ </li></ul><br><p>  Istioå›ç­”äº†æ‰€æœ‰è¿™äº›é—®é¢˜ã€‚ ä¸ºæ­¤ï¼ŒIstioåœ¨æ¯ä¸ªåŠèˆ±ä¸­æ”¾ç½®ä¸€ä¸ª<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Envoy</a>è¾¹è½¦ä»£ç†ã€‚  Envoyä»£ç†æ‹¦æˆªåˆ°åº”ç”¨ç¨‹åºå®¹å™¨çš„æ‰€æœ‰ä¼ å…¥å’Œä¼ å‡ºæµé‡ã€‚ è¿™æ„å‘³ç€<strong>æœåŠ¡å™¨</strong>å’Œ<strong>loadgen</strong>æ¥æ”¶Envoy sidecarä»£ç†ï¼Œå¹¶ä¸”ä»<strong>loadgen</strong>åˆ°<strong>æœåŠ¡å™¨çš„</strong>æ‰€æœ‰æµé‡éƒ½é€šè¿‡Envoyä»£ç†ã€‚ </p><br><p>  Envoyä»£ç†ä¹‹é—´çš„è¿æ¥å½¢æˆæœåŠ¡ç½‘æ ¼ã€‚ æœåŠ¡ç½‘æ ¼ä½“ç³»ç»“æ„æä¾›äº†å¯¹Kubernetesçš„æ§åˆ¶å±‚ã€‚ </p><br><p><img src="https://habrastorage.org/webt/7n/sk/z-/7nskz-5os2onyoaaf5kz5x38ve4.png"></p><br><p> ä¸€æ—¦Envoyä»£ç†åœ¨å…¶å®¹å™¨ä¸­æ‰§è¡Œï¼Œå°±å¯ä»¥åœ¨å‡ ä¹ä¸æ›´æ”¹åº”ç”¨ç¨‹åºä»£ç çš„æƒ…å†µä¸‹å°†Istioå®‰è£…åœ¨GKEç¾¤é›†çš„é¡¶éƒ¨ã€‚ ä½†æ˜¯æ‚¨åšäº†ä¸€äº›å·¥ä½œæ¥å‡†å¤‡ä½¿ç”¨Istioè¿›è¡Œç®¡ç†çš„åº”ç”¨ç¨‹åºï¼š </p><br><ul><li> æ‰€æœ‰å®¹å™¨çš„æœåŠ¡ã€‚  <strong>æœåŠ¡å™¨</strong>å’Œ<strong>loadgenéƒ¨ç½²</strong>ç”±KubernetesæœåŠ¡é“¾æ¥ã€‚ ç”šè‡³ä¸æ¥æ”¶ä¼ å…¥è¯·æ±‚çš„<strong>loadgen</strong>éƒ½æœ‰æœåŠ¡ã€‚ </li><li> æœåŠ¡ä¸­çš„ç«¯å£å¿…é¡»å…·æœ‰åç§°ã€‚ å°½ç®¡å¯ä»¥åœ¨GKEä¸­ä¿ç•™æœåŠ¡ç«¯å£çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åç§°</a> ï¼Œä½†Istioä»éœ€è¦æ ¹æ®å…¶åè®®æŒ‡å®š<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç«¯å£åç§°</a> ã€‚ åœ¨YAMLæ–‡ä»¶ä¸­ï¼Œ <strong>æœåŠ¡å™¨</strong>çš„ç«¯å£ç§°ä¸º<strong>httpï¼Œ</strong>å› ä¸ºæœåŠ¡å™¨ä½¿ç”¨<strong>HTTPåè®®</strong> ã€‚ å¦‚æœ<strong>æœåŠ¡</strong>ä½¿ç”¨<strong>gRPC</strong> ï¼Œåˆ™å°†ç«¯å£å‘½åä¸º<strong>grpc</strong> ã€‚ </li><li> éƒ¨ç½²å·²æ ‡è®°ã€‚ å› æ­¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨Istioçš„æµé‡ç®¡ç†åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼Œåœ¨åŒä¸€æœåŠ¡çš„å„ä¸ªç‰ˆæœ¬ä¹‹é—´å…±äº«æµé‡ã€‚ </li></ul><br><h3 id="ustanovka-istio"> å®‰è£…Istio </h3><br><p> æœ‰ä¸¤ç§å®‰è£…Istioçš„æ–¹æ³•ã€‚ æ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨GKEæ‰©å±•ä¸Šå¯ç”¨Istio</a>æˆ–<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨ç¾¤é›†ä¸Š</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®‰è£…Istioçš„å¼€æºç‰ˆæœ¬</a> ã€‚ ä½¿ç”¨GKEä¸Šçš„Istioï¼Œæ‚¨å¯ä»¥åœ¨GKEé›†ç¾¤ç”Ÿå‘½å‘¨æœŸä¸­è½»æ¾ç®¡ç†Istioçš„å®‰è£…å’Œå‡çº§ã€‚ å¦‚æœæ‚¨éœ€è¦æœ€æ–°ç‰ˆæœ¬çš„Istioæˆ–å¯¹Istioæ§åˆ¶é¢æ¿çš„é…ç½®è¿›è¡Œæ›´å¤šæ§åˆ¶ï¼Œè¯·å®‰è£…å¼€æºç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯GKEæ‰©å±•ä¸Šçš„Istioã€‚ è¦å†³å®šé‡‡ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å“ªç§</a>æ–¹æ³•ï¼Œè¯·é˜…è¯»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">GKEä¸Š</a>çš„æ–‡ç« <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Istioå—ï¼Ÿ</a>  ã€‚ </p><br><p> é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ï¼Œç ”ç©¶é€‚å½“çš„æ‰‹å†Œï¼Œç„¶åæŒ‰ç…§è¯´æ˜åœ¨ç¾¤é›†ä¸Šå®‰è£…Istioã€‚ å¦‚æœè¦åœ¨æ–°éƒ¨ç½²çš„åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨Istioï¼Œè¯·ä¸º<strong>é»˜è®¤</strong>åç§°ç©ºé—´<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¯ç”¨sidecaråµŒå…¥</a> ã€‚ </p><br><h3 id="ochistka"> æ¸…æ´ç”¨å“ </h3><br><p> ä¸ºç¡®ä¿æœ¬æŒ‡å—ä¸­ä½¿ç”¨çš„èµ„æºä¸ä¼šä»æ‚¨çš„Google Cloud Platformå¸æˆ·ä¸­æ‰£é™¤ï¼Œè¯·åœ¨å®‰è£…Istioå¹¶ä½¿ç”¨ç¤ºä¾‹åº”ç”¨ç¨‹åºæ—¶åˆ é™¤å®¹å™¨ç¾¤é›†ã€‚ è¿™å°†åˆ é™¤æ‰€æœ‰ç¾¤é›†èµ„æºï¼Œä¾‹å¦‚è®¡ç®—å®ä¾‹ï¼Œç£ç›˜å’Œç½‘ç»œèµ„æºã€‚ </p><br><h3 id="chto-dalshe"> æ¥ä¸‹æ¥æ˜¯ä»€ä¹ˆï¼Ÿ </h3><br><ul><li><p> äº†è§£ä»¥ä¸‹æŠ€æœ¯ï¼š </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç å¤´å·¥äºº</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è´§æŸœ</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å®¹å™¨æ³¨å†Œè¡¨</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Kubernetes</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ ¼å…‹</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœåŠ¡ç½‘</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¼Šæ–¯æ–¯è’‚å¥¥</a> </li></ol><br></li><li><p> äº†è§£ä»¥ä¸‹å·¥å…·ï¼š </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äº‘SDK</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>Gcloudå‚è€ƒ</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>Kubectl</strong></a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><strong>ç å¤´å·¥äºº</strong></a> </li></ol><br></li><li><p> äº†è§£Kubernetesçš„æ¦‚å¿µï¼š </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é›†ç¾¤</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç»“</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è±†èš</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœåŠ¡é¡¹ç›®</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">éƒ¨ç½²æ–¹å¼</a> </li></ol><br></li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN469515/">https://habr.com/ru/post/zh-CN469515/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN469499/index.html">æˆ‘ä»¬åœ¨Parallelså¾æœäº†Appleçš„æ–¹å¼</a></li>
<li><a href="../zh-CN469503/index.html">ç½‘ç»œå®‰å…¨ï¼šæˆ‘ä»¬åœ¨2019å¹´ä¿æŠ¤è®¢æˆ·æ•°æ®å…å—æ³„éœ²</a></li>
<li><a href="../zh-CN469505/index.html">å°†ä¸šåŠ¡æ¨å‘å›½å¤–å¸‚åœºçš„3ç§å®ç”¨æ–¹æ³•ï¼šå®é™…å…¬å¸çš„æ–¹æ³•å’ŒæŠ€å·§</a></li>
<li><a href="../zh-CN469507/index.html">ç¬¬ä¸‰ä¸ªSteam Windows Clientæ¼æ´ï¼Œä½†ä¸æ˜¯0day</a></li>
<li><a href="../zh-CN469509/index.html">è§’åº¦ç¤ºæ„å›¾ï¼Œæˆ–æˆ‘å¦‚ä½•ç¼–å†™è§’åº¦cliæ¨¡æ¿</a></li>
<li><a href="../zh-CN469521/index.html">æˆ‘ä¹°äº†æ‘©æ‰˜è½¦éª‘ï¼Œä¸æ‘”å€’</a></li>
<li><a href="../zh-CN469523/index.html">ä»£ç æ€§èƒ½å¯¹JavaScriptä¸­å˜é‡å£°æ˜ä¸Šä¸‹æ–‡çš„ä¾èµ–</a></li>
<li><a href="../zh-CN469525/index.html">çŸ¿ç”¨æŒ–æ˜æœºçš„è‡ªåŠ¨æ§åˆ¶ç³»ç»Ÿ</a></li>
<li><a href="../zh-CN469527/index.html">å¯¹è®²æœºæ˜¯é—´è°çš„è€³æœµå—ï¼Ÿ</a></li>
<li><a href="../zh-CN469529/index.html">æ–‡å­—æ¸²æŸ“è®¨åŒä½ </a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>