<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöü üê≤ üïã Analisis kode sumber Emby dengan penganalisa PVS-Studio üêà üßùüèø üè¨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Emby adalah server media yang cukup terkenal, bersama dengan Plex dan Kodi. Pada artikel ini, kami akan mencoba memverifikasi kode sumbernya menggunak...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Analisis kode sumber Emby dengan penganalisa PVS-Studio</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/484050/"><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/rr/ar/h3/rrarh3smm2vkgpopwdn2fgqan0s.png" alt="Gambar 3"></div><br>  Emby adalah server media yang cukup terkenal, bersama dengan Plex dan Kodi.  Pada artikel ini, kami akan mencoba memverifikasi kode sumbernya menggunakan penganalisa statis PVS-Studio.  Di situs web resmi Emby ada tanda kecil "Dibangun dengan ReSharper".  Yah, ini bahkan lebih menarik. <br><a name="habracut"></a><br><h2>  Penganalisa kode PVS-Studio </h2><br>  PVS-Studio berjalan pada sistem 64-bit pada Windows, Linux dan macOS.  Dia tahu bagaimana mencari kesalahan dalam kode sumber program yang ditulis dalam C, C ++, C # dan Java. <br><br><h2>  Proyek yang Diaudit </h2><br>  Emby adalah server media yang kode sumbernya dapat ditemukan di <a href="https://github.com/MediaBrowser/Emby">GitHub</a> .  Ini memungkinkan Anda untuk mengatur siaran dan memungkinkan untuk mengakses konten media (video, audio, foto) dari perangkat apa pun.  Peras dari situs web resmi <a href="https://emby.media/">Emby</a> : <br><br><ul><li>  Emby secara otomatis mengonversi media Anda dengan cepat untuk diputar di perangkat apa pun; </li><li>  Kontrol orangtua yang luas memudahkan untuk mengontrol akses ke konten, yang akan relevan untuk keluarga dengan anak kecil; </li><li>  Emby mengatur media Anda menjadi presentasi yang sederhana dan elegan.  Mereka tidak akan pernah terlihat sama; </li><li>  Streaming data dengan sinkronisasi di cloud; </li><li>  Bagikan file media Anda dengan mudah ke teman dan keluarga; </li><li>  Dan masih banyak lagi. </li></ul><br><h2>  Potongan kode yang menarik perhatian saat memeriksa laporan penganalisa </h2><br>  <b>Peringatan PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3001/">V3001</a> Ada sub-ekspresi yang identik 'c! =' &lt;'' Di sebelah kiri dan di sebelah kanan operator '&amp;&amp;'.  HttpListenerRequest.Managed.cs 49 <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetRequestLine</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> req</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((ic &gt;= <span class="hljs-string"><span class="hljs-string">'A'</span></span> &amp;&amp; ic &lt;= <span class="hljs-string"><span class="hljs-string">'Z'</span></span>) || (ic &gt; <span class="hljs-number"><span class="hljs-number">32</span></span> &amp;&amp; c &lt; <span class="hljs-number"><span class="hljs-number">127</span></span> &amp;&amp; c != <span class="hljs-string"><span class="hljs-string">'('</span></span> &amp;&amp; c != <span class="hljs-string"><span class="hljs-string">')'</span></span> &amp;&amp; c != <span class="hljs-string"><span class="hljs-string">'&lt;'</span></span> &amp;&amp; <span class="hljs-comment"><span class="hljs-comment">// &lt;= c != '&lt;' &amp;&amp; c != '&gt;' &amp;&amp; c != '@' &amp;&amp; c != ',' &amp;&amp; c != ';' &amp;&amp; // &lt;= c != ':' &amp;&amp; c != '\\' &amp;&amp; c != '"' &amp;&amp; c != '/' &amp;&amp; c != '[' &amp;&amp; c != ']' &amp;&amp; c != '?' &amp;&amp; c != '=' &amp;&amp; c != '{' &amp;&amp; c != '}')) continue; .... }</span></span></code> </pre> <br>  Penganalisa mendeteksi duplikat subekspresi <i>c! = '&lt;'</i> .  Mungkin kesalahan merayap ke dalam kode ini, dan sesuatu yang lain seharusnya ada di <i>'&lt;'</i> .  Atau, lebih mungkin, subekspresi kedua tidak perlu dan Anda hanya perlu menghapusnya. <br><br>  <b>PVS-Studio Peringatan:</b> <a href="https://www.viva64.com/ru/w/v3001/">V3001</a> Ada sub-ekspresi identik 'SmbConstants.AttrHidden' ke kiri dan ke kanan '|'  operator.  SmbComDelete.cs 29 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SmbComDelete</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fileName</span></span></span><span class="hljs-function">)</span></span> { Path = fileName; Command = SmbComDelete; _searchAttributes = SmbConstants.AttrHidden | SmbConstants.AttrHidden | SmbConstants.AttrSystem; }</code> </pre> <br>  Penganalisa lagi menemukan kesalahan ketik yang terkait dengan subekspresi berulang.  Ke depan, saya akan mengatakan bahwa dalam proyek ini ada sedikit kesalahan serupa yang dibuat oleh kecerobohan.  Saya tidak menyalahkan pencipta Emby sama sekali, kita kadang-kadang tersebar dengan cara ini ( <a href="https://www.viva64.com/ru/examples/v501/">contoh</a> , <a href="https://www.viva64.com/ru/examples/v3001/">contoh</a> , <a href="https://www.viva64.com/ru/examples/v6001/">contoh</a> ), dan untuk aman dari kesalahan seperti itu, hanya ada analisis statis. <br><br>  <b>PVS-Studio Warning:</b> <a href="https://www.viva64.com/ru/w/v3004/">V3004</a> Pernyataan 'then' setara dengan pernyataan 'else'.  SqliteItemRepository.cs 5648 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> QueryResult&lt;Tuple&lt;BaseItem, ItemCounts&gt;&gt; GetItemValues(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (typesToCount.Length == <span class="hljs-number"><span class="hljs-number">0</span></span>) { whereText += <span class="hljs-string"><span class="hljs-string">" And CleanName In (Select CleanValue from ItemValues where "</span></span> + typeClause + <span class="hljs-string"><span class="hljs-string">" AND ItemId in (select guid from TypedBaseItems"</span></span> + innerWhereText + <span class="hljs-string"><span class="hljs-string">"))"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//whereText += " And itemTypes not null"; whereText += " And CleanName In (Select CleanValue from ItemValues where " + typeClause + " AND ItemId in (select guid from TypedBaseItems" + innerWhereText + "))"; } .... }</span></span></code> </pre> <br>  Dan ini sangat mirip dengan masalah yang muncul karena copy-paste, karena  <i>jika</i> dan yang <i>lain</i> memblokir tubuh benar-benar identik.  Mengapa Anda perlu memeriksa ukuran array <i>typesToCount</i> jika, terlepas dari jumlah elemen yang ditulis di dalamnya, kode yang sama akan dieksekusi - hanya diketahui oleh pengembang. <br><br>  <b>PVS-Studio Warning:</b> <a href="https://www.viva64.com/ru/w/v3005/">V3005 Variabel</a> '_validProviderIds' ditugaskan untuk dirinya sendiri.  BaseNfoParser.cs 77 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt; _validProviderIds; .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Fetch</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... _validProviderIds = _validProviderIds = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;....&gt;(....); .... }</code> </pre> <br>  Sekali lagi, salah ketik, yang mensyaratkan penugasan variabel untuk dirinya sendiri.  Perlu memeriksa ulang bagian kode ini. <br><br>  <b>PVS-Studio Warning:</b> <a href="https://www.viva64.com/ru/w/v3008/">V3008 Variabel</a> 'Chapters' diberi nilai dua kali berturut-turut.  Mungkin ini sebuah kesalahan.  Periksa baris: 29, 28. Judul.cs 29 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Title</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">uint</span></span></span></span><span class="hljs-function"><span class="hljs-params"> titleNum</span></span></span><span class="hljs-function">)</span></span> { ProgramChains = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;ProgramChain&gt;(); Chapters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Chapter&gt;(); Chapters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;Chapter&gt;(); TitleNumber = titleNum; }</code> </pre> <br>  Kurang perhatian dan kesalahan ketik, sekali lagi ... <i>Bab</i> variabel diberi nilai dua kali.  Jelas bahwa kode tambahan ini tidak mengancam hal buruk, tetapi tetap saja.  Tidak masuk akal untuk berlama-lama pada contoh ini, mari kita lanjutkan. <br><br>  <b>Peringatan PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3013/">V3013</a> Aneh bahwa tubuh fungsi 'Baca' sepenuhnya setara dengan tubuh fungsi 'Tulis' (407, baris 415).  BaseSqliteRepository.cs 407 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> IDisposable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Read</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ReaderWriterLockSlim obj</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WriteLockToken(obj); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> IDisposable </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Write</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ReaderWriterLockSlim obj</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WriteLockToken(obj); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">WriteLockToken</span></span> : <span class="hljs-title"><span class="hljs-title">IDisposable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ReaderWriterLockSlim _sync; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLockToken</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ReaderWriterLockSlim sync</span></span></span><span class="hljs-function">)</span></span> { _sync = sync; sync.EnterWriteLock(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_sync != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _sync.ExitWriteLock(); _sync = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } }</code> </pre> <br>  Badan fungsi <i>Baca</i> dan <i>Tulis</i> benar-benar identik satu sama lain, sebagaimana dibuktikan oleh teks peringatan penganalisa.  Metode <a href="https://docs.microsoft.com/en-us/dotnet/api/system.threading.readerwriterlockslim.enterwritelock%3Fview%3Dnetframework-4.8"><i>EnterWriteLock</i></a> diperlukan untuk memasukkan kunci dalam mode tulis.  Untuk mode membaca, ada baiknya menggunakan metode <i>EnterReadLock</i> , yang memungkinkan kemampuan membaca sumber daya secara bersamaan di beberapa utas. <br><br>  Pengembang harus melihat lebih dekat pada bagian kode ini, mungkin ada kesalahan.  Selain itu, kelas berikut ini ditemukan dalam kode, yang tidak digunakan: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">sealed</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ReadLockToken</span></span> : <span class="hljs-title"><span class="hljs-title">IDisposable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ReaderWriterLockSlim _sync; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadLockToken</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ReaderWriterLockSlim sync</span></span></span><span class="hljs-function">)</span></span> { _sync = sync; sync.EnterReadLock(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_sync != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { _sync.ExitReadLock(); _sync = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } }</code> </pre> <br>  <b>Peringatan PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3021/">V3021</a> Ada dua pernyataan 'jika' dengan ekspresi kondisional yang identik.  Pernyataan 'jika' pertama berisi pengembalian metode.  Ini berarti bahwa pernyataan 'jika' yang kedua adalah SkiaEncoder.cs 537 yang tidak masuk akal <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">EncodeImage</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> inputPath, DateTime dateModified, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> outputPath, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> autoOrient, ImageOrientation? orientation, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> quality, ImageProcessingOptions options, ImageFormat selectedOutputFormat</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(inputPath)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-string"><span class="hljs-string">"inputPath"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.IsNullOrWhiteSpace(inputPath)) { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentNullException(<span class="hljs-string"><span class="hljs-string">"outputPath"</span></span>); } .... }</code> </pre> <br>  Di sini, tampaknya, pengembang menyalin empat baris pertama, tetapi lupa untuk mengubah variabel yang sedang diuji dari <i>inputPath</i> ke <i>outputPath</i> .  Ada beberapa baris dalam kode yang menggunakan <i>outputPath</i> tanpa memeriksa <i>nol</i> , yang dapat menyebabkan pengecualian dilemparkan. <br><br>  <b>Peringatan PVS-Studio:</b> <br><br><ul><li>  V3022 Expression 'processUnsupportedFrame (frame, CloseStatusCode.PolicyViolation, null)' selalu salah.  WebSocket.cs 462 </li><li>  Ekspresi V3022 'processCloseFrame (frame)' selalu salah.  WebSocket.cs 461 </li><li>  V3022 Expression 'frame.IsClose?  processCloseFrame (frame): processUnsupportedFrame (frame, CloseStatusCode.PolicyViolation, null) 'selalu salah.  WebSocket.cs 460 </li><li>  Ekspresi V3022 'processPongFrame (frame)' selalu benar.  WebSocket.cs 459 </li><li>  Ekspresi V3022 'processPingFrame (frame)' selalu benar.  WebSocket.cs 457 </li><li>  Ekspresi V3022 'processDataFrame (frame)' selalu benar.  WebSocket.cs 455 </li><li>  Ekspresi V3022 selalu salah.  WebSocket.cs 448 </li></ul><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processWebSocketFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebSocketFrame frame</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> frame.IsCompressed &amp;&amp; _compression == CompressionMethod.None ? processUnsupportedFrame(....) : frame.IsFragmented ? processFragmentedFrame(frame) : frame.IsData ? processDataFrame(frame) : frame.IsPing ? processPingFrame(frame) : frame.IsPong ? processPongFrame(frame) : frame.IsClose ? processCloseFrame(frame) : processUnsupportedFrame(....); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processUnsupportedFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { processException(....); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processDataFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebSocketFrame frame</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processPingFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebSocketFrame frame</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mask = Mask.Unmask; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processPongFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebSocketFrame frame</span></span></span><span class="hljs-function">)</span></span> { _receivePong.Set(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">processCloseFrame</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">WebSocketFrame frame</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> payload = frame.PayloadData; close(payload, !payload.ContainsReservedCloseStatusCode, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br>  Di akun saya, tidak banyak, dibandingkan dengan tim PVS-Studio lainnya, diverifikasi oleh penganalisa proyek, dan mungkin ini entah bagaimana terhubung dengan fakta bahwa saya pertama kali melihat bahwa sebanyak 13 peringatan penganalisa dikeluarkan pada 13 baris kode (sedikit lebih dari setiap baris kedua).  Karena itu, saya percaya bahwa kode ini layak untuk dimasukkan dalam artikel.  Selanjutnya, saya akan menuliskan apa yang disumpah oleh penganalisa secara spesifik. <br><br><ol><li>  Pertama, <i>bingkai</i> ekspresi.IsCompressed <i>&amp;&amp; _compression == CompressionMethod.Tidak ada yang dipertimbangkan</i> dan, jika ekspresi itu benar, metode <i>processUnsupportedFrame</i> akan dieksekusi, yang dalam kasus apa pun mengembalikan <i>false</i> (karenanya peringatan pertama dari penganalisa).  Jika itu salah, maka beralihlah ke poin berikutnya. </li><li>  Selanjutnya, nilai <i>frame.IsFragmented diperiksa</i> .  Tidak ada masalah, jadi mari kita lanjutkan. </li><li>  Di sini nilai <i>frame.IsData diperiksa</i> .  Jika benar, maka metode <i>processDataFrame</i> akan kembali <i>benar</i> pula.  Oleh karena itu peringatan penganalisa kedua. </li><li>  Kemudian kita periksa <i>frame</i> .  Benar - <i>processPingFrame akan</i> mengembalikan <i>true</i> .  Ini adalah peringatan penganalisa ketiga. </li><li>  Kami melihat <i>bingkai</i> .  Semuanya mirip dengan yang sebelumnya. </li><li>  Dan yang terakhir: <i>frame.IsClose</i> .  <i>processCloseFrame</i> dan <i>processUnsupportedFrame</i> dalam kasus apa pun mengembalikan <i>false</i> . </li></ol><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/sq/ut/pe/squtpenxx02rmgsg31uyqk7yt6q.png" alt="Gambar 1"></div><br>  Saya harap saya tidak membuat Anda bosan.  Ini akan lebih sederhana lagi. <br><br>  <b>PVS-Studio Warning:</b> <a href="https://www.viva64.com/ru/w/v3085/">V3085</a> Nama bidang 'RtpHeaderBytes' dalam tipe bersarang adalah ambigu.  Tipe luar berisi bidang statis dengan nama yang identik.  HdHomerunUdpStream.cs 200 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HdHomerunUdpStream</span></span> : <span class="hljs-title"><span class="hljs-title">LiveStream</span></span>, <span class="hljs-title"><span class="hljs-title">IDirectStreamProvider</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> RtpHeaderBytes = <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">UdpClientStream</span></span> : <span class="hljs-title"><span class="hljs-title">Stream</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> RtpHeaderBytes = <span class="hljs-number"><span class="hljs-number">12</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> PacketSize = <span class="hljs-number"><span class="hljs-number">1316</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> MediaBrowser.Model.Net.ISocket _udpClient; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> disposed; .... } .... }</code> </pre> <br>  Kelas bersarang <i>UdpClientStream</i> menggunakan bidang dengan nama yang mirip dengan yang digunakan di kelas eksternal <i>HdHomerunUdpStream</i> .  Ini bukan kesalahan, tetapi merupakan alasan yang bagus untuk memeriksa apakah semuanya baik-baik saja dengan kode ini.  Masalahnya adalah bahwa ada kemungkinan untuk membingungkan kedua variabel ini, dan kode tidak akan berfungsi sebagaimana dimaksud oleh pengembang, meskipun tidak akan menimbulkan keluhan dari kompiler. <br><br>  <b>Peringatan PVS-Studio:</b> <br><br><ul><li>  V3090 Tidak aman mengunci suatu jenis.  Semua instance dari suatu tipe akan memiliki objek 'Type' yang sama.  Lmhosts.cs 49 </li><li>  V3090 Tidak aman mengunci suatu jenis.  Semua instance dari suatu tipe akan memiliki objek 'Type' yang sama.  Lmhosts.cs 57 </li></ul><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Lmhosts</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> NbtAddress </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetByName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> host</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Lmhosts)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetByName(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Name(host, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>)); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> NbtAddress </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetByName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Name name</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Lmhosts)) { .... } } }</code> </pre> <br>  Penganalisis memperingatkan bahwa kunci tidak aman digunakan dalam fragmen kode ini.  Menggunakan <i>kunci</i> tidak diinginkan karena objek yang digunakan untuk mengunci dibagikan dan dapat digunakan untuk mengunci di tempat lain tanpa sepengetahuan pengembang yang menggunakan objek ini untuk pertama kalinya.  Hasilnya akan menjadi jalan buntu pada objek yang sama. <br><br>  Idealnya, Anda harus menggunakan bidang pribadi untuk mengunci, misalnya, seperti ini: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Object locker = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> NbtAddress </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetByName</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> host</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> (locker) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> GetByName(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Name(host, <span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>)); } }</code> </pre> <br>  <b>Peringatan PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3142/">V3142</a> Kode <a href="https://www.viva64.com/ru/w/v3142/">unreacheble</a> terdeteksi.  Mungkin saja ada kesalahan.  HdHomerunHost.cs 621 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task&lt;ILiveStream&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetChannelStream</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> enableHttpStream = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (enableHttpStream) { mediaSource.Protocol = MediaProtocol.Http; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> httpUrl = channelInfo.Path; <span class="hljs-comment"><span class="hljs-comment">// If raw was used, the tuner doesn't support params if (!string.IsNullOrWhiteSpace(profile) &amp;&amp; !string.Equals(profile, "native", StringComparison.OrdinalIgnoreCase)) { httpUrl += "?transcode=" + profile; } mediaSource.Path = httpUrl; return new SharedHttpStream(....); } return new HdHomerunUdpStream(....); }</span></span></code> </pre> <br>  Penganalisa menunjukkan bahwa baris terakhir dalam fragmen kode ini tidak akan pernah dieksekusi.  Dan mengapa pengembang menyatakan dan mengatur variabel enableHttpStream menjadi true dan kemudian segera memeriksa variabel ini dalam pernyataan if? <br><br>  Mungkin kode ini hanya mubazir.  Bagaimanapun, perlu dicek kembali. <br><br>  <b>Peringatan PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3083/">V3083</a> Doa yang tidak aman dari acara 'RefreshStarted', NullReferenceException dimungkinkan.  Pertimbangkan menugaskan acara ke variabel lokal sebelum menjalankannya.  ProviderManager.cs 943 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnRefreshStart</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">BaseItem item</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (RefreshStarted != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { RefreshStarted(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GenericEventArgs&lt;BaseItem&gt;(item)); } }</code> </pre> <br>  Metode ini menggunakan panggilan yang berpotensi tidak aman ke event <i>handler RefreshStarted</i> , seperti yang ditunjukkan oleh penganalisa. <br><br>  Sekarang saya akan menjelaskan mengapa penganalisa menganggap panggilan ini <i>RefreshStarted</i> dalam kode tidak aman.  Misalkan, pada saat antara memeriksa <i>null</i> dan langsung memanggil event handler di badan <i>if</i> , berhenti berlangganan dibuat dari acara di utas lain.  Dan, jika tidak ada lagi pelanggan, <i>RefreshStarted</i> akan menjadi <i>nol</i> .  Tetapi di utas lain, di mana pemeriksaan <i>null</i> telah terjadi, baris berikut akan dieksekusi: <br><pre> <code class="cs hljs">RefreshStarted(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GenericEventArgs&lt;BaseItem&gt;(item));</code> </pre> <br>  Ini akan melempar <i>NullReferenceException</i> . <br><br>  <b>PVS-Studio Warning:</b> <a href="https://www.viva64.com/ru/w/v3029/">V3029</a> Ekspresi kondisional dari pernyataan 'jika' yang terletak bersebelahan adalah identik.  Periksa baris: 142, 152. LocalImageProvider.cs 142 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PopulateImages</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-comment"><span class="hljs-comment">// Logo if (!isEpisode &amp;&amp; !isSong &amp;&amp; !isPerson) { added = AddImage(....); if (!added) { added = AddImage(....); } } // Art if (!isEpisode &amp;&amp; !isSong &amp;&amp; !isPerson) { AddImage(....); } .... }</span></span></code> </pre> <br>  Dalam potongan kode ini di sebelah satu sama lain adalah dua <i>pernyataan if</i> dengan kondisi yang sama.  Badan <i>pernyataan if</i> berbeda.  Sulit mengatakan apakah ini kesalahan atau kode yang berlebihan.  Mungkin semuanya baik-baik saja dan penulis hanya ingin secara logis memisahkan dua tindakan yang berbeda, salah satunya dikaitkan dengan "Logo" tertentu, dan yang kedua dengan "Seni" tertentu. <br><br>  <b>Peringatan PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3041/">V3041</a> Ungkapan itu secara implisit dilemparkan dari tipe 'int' ke tipe 'double'.  Pertimbangkan untuk menggunakan pemeran tipe eksplisit untuk menghindari hilangnya bagian fraksional.  Contoh: double A = (double) (X) / Y;  LiveTvManager.cs 1085 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> Task </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RefreshChannelsInternal</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> progressPerService = _services.Length == <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span> / _services.Length; .... }</code> </pre> <br>  Kode ini berisi operasi membagi tipe data integer.  Nilai yang dihasilkan secara implisit dikonversi ke tipe floating-point, yang sangat mencurigakan. <br><br>  Sebenarnya, <i>progressPerService</i> variabel akan sama dengan 1.0 hanya jika <i>_services.Length = 1</i> .  Untuk nilai-nilai <i>_services</i> lainnya. <i>Panjang</i> , hasilnya adalah <i>0,0</i> . <br><br>  Rupanya, itu harus ditulis di sini: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">double</span></span> progressPerService = _services.Length == <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)<span class="hljs-number"><span class="hljs-number">1</span></span> / _services.Length;</code> </pre> <br><br>  <b>Peringatan PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3050/">V3050</a> Mungkin salah HTML.  Tag penutup &lt;/u&gt; ditemukan, sedangkan tag &lt;/i&gt; diharapkan.  SrtParserTests.cs 64 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TestParse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> expectedSubs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubtitleTrackInfo { TrackEvents = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubtitleTrackEvent[] { .... <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SubtitleTrackEvent { Id = <span class="hljs-string"><span class="hljs-string">"6"</span></span>, StartPositionTicks = <span class="hljs-number"><span class="hljs-number">330000000</span></span>, EndPositionTicks = <span class="hljs-number"><span class="hljs-number">339990000</span></span>, Text = <span class="hljs-string"><span class="hljs-string">"This contains nested &lt;b&gt;bold, &lt;i&gt;italic, &lt;u&gt;underline&lt;/u&gt; and &lt;s&gt;strike-through&lt;/s&gt;&lt;/u&gt;&lt;/i&gt;&lt;/b&gt; HTML tags"</span></span> }, .... } }; }</code> </pre> <br>  Perhatikan garisnya <br><br><pre> <code class="cs hljs">&lt;u&gt;underline&lt;/u&gt;</code> </pre> <br>  Itu sudah memiliki tag penutup <i>&lt;/u&gt;</i> .  Selanjutnya kita melihat teks ini: <br><pre> <code class="cs hljs">&lt;/s&gt;&lt;/u&gt;&lt;/i&gt;&lt;/b&gt; HTML tags<span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre> <br>  Di sini tag penutup <i>&lt;/u&gt;</i> berlebihan, seperti yang ditunjukkan oleh penganalisa. <br>  <b>Peringatan PVS-Studio:</b> <a href="https://www.viva64.com/ru/w/v3051/">V3051</a> Pemeriksaan tipe berlebihan.  Objek sudah dari tipe 'Pengecualian'.  SmbFileInputStream.cs 107 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">internal</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> IOException </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SeToIoe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">SmbException se</span></span></span><span class="hljs-function">)</span></span> { IOException ioe = se; Exception root = se.GetRootCause(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (root <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> TransportException) { ioe = (TransportException)root; root = ((TransportException)ioe).GetRootCause(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (root <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> Exception) { ioe = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IOException(root.Message); ioe.InitCause(root); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ioe; }</code> </pre> <br>  Dan di sini, terus terang, tidak sepenuhnya jelas apa yang ingin dicapai pengembang pada umumnya.  Penganalisa memperingatkan bahwa <i>pernyataan if</i> kedua memeriksa objek <i>root</i> untuk kompatibilitas dengan tipenya sendiri.  Kemungkinan besar, ini hanya kode yang berlebihan, tetapi terlihat mencurigakan, pengembang harus melihatnya lebih dekat. <br><br><h2>  Kesimpulan </h2><br>  Dalam segala hal, para pengembang melakukan pekerjaan besar menciptakan Emby (proyek ini memiliki 215 539 baris kode, 4,6% - komentar).  Mereka hebat, sungguh.  Namun, penganalisa juga mencoba dengan mengeluarkan peringatan <a href="https://www.viva64.com/ru/m/0007/">tingkat</a> Tinggi - 113, Menengah - 213, dan Rendah - 112. Beberapa dari mereka adalah positif palsu, tetapi sebagian besar kesalahan tidak muncul dalam artikel karena mereka mirip. <br><br>  Misalnya, peringatan <a href="https://www.viva64.com/ru/w/v3022/">V3022 saja</a> (ekspresi selalu salah / benar) mencetak 106 buah.  Anda dapat, tentu saja, memeriksa bagian mana dari mereka yang positif palsu, dan menambahkan sisanya ke artikel, tetapi ini akan menghasilkan teks yang sangat membosankan sehingga tidak ada yang akan membaca. <br><br>  Saya harap saya berhasil menunjukkan kegunaan analisa statis dalam pengembangan.  Tentu saja, pemeriksaan satu kali saja tidak cukup, dan penganalisa statis harus digunakan secara berkelanjutan.  Anda dapat membaca lebih lanjut tentang ini di artikel <a href="https://www.viva64.com/ru/b/0594/">Godot: Tentang Penggunaan Reguler dari Kode Analisis Statis</a> . <br><br><p> <a href="https://habr.com/en/company/pvs-studio/blog/484046/"><img src="https://habrastorage.org/getpro/habr/post_images/898/3b6/5a7/8983b65a74adb29a2113eba12fbec3f1.png" align="left"></a> </p><br><br>  Jika Anda ingin berbagi artikel ini dengan audiens yang berbahasa Inggris, silakan gunakan tautan ke terjemahan: Ekaterina Nikiforova.  <a href="https://habr.com/en/company/pvs-studio/blog/484046/">Memeriksa Emby dengan PVS-Studio</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id484050/">https://habr.com/ru/post/id484050/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id484028/index.html">Horseshoe Bend - tablet konversi dengan layar lipat</a></li>
<li><a href="../id484034/index.html">Implementasi skema kerja penyimpanan target barang berdasarkan unit akuntansi gudang 1C Otomasi Terpadu 2</a></li>
<li><a href="../id484036/index.html">Grup industri baru menciptakan standar universal untuk rumah pintar</a></li>
<li><a href="../id484046/index.html">Memeriksa Emby dengan PVS-Studio</a></li>
<li><a href="../id484048/index.html">PHP dan persamaan reguler: dasar-dasar untuk pemula</a></li>
<li><a href="../id484052/index.html">Tugas untuk basis lunar</a></li>
<li><a href="../id484056/index.html">Apakah proyek Anda benar-benar membutuhkan tes?</a></li>
<li><a href="../id484062/index.html">Belajar Bahasa Inggris oleh MEMASICS</a></li>
<li><a href="../id484064/index.html">Bagaimana Cara Menyiapkan Game untuk Pelokalan? 10 Aturan Dasar</a></li>
<li><a href="../id484066/index.html">Uang vs Tim. Bukan aspek yang paling jelas dari hubungan pengusaha, pendiri dan investor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>