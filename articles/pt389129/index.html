<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôà üëáüèΩ üë®üèø‚Äçüé§ Novo microcontrolador dom√©stico de controle de motor K1921VK01T da OJSC NIIET üç≠ üö≠ üôä</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="De alguma forma, as not√≠cias sobre o surgimento de um novo microcontrolador K1921VK01T da OJSC NIIET foram passadas . Como isso √© not√°vel? Seus perif√©...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Novo microcontrolador dom√©stico de controle de motor K1921VK01T da OJSC NIIET</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/npf_vektor/blog/389129/"><img src="https://habrastorage.org/files/a97/a7f/0cf/a97a7f0cf9454cfb9f64cdb540e00f40.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
De alguma forma, as not√≠cias sobre o surgimento de um novo microcontrolador </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">K1921VK01T da OJSC NIIET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> foram passadas </font><font style="vertical-align: inherit;">. Como isso √© not√°vel? Seus perif√©ricos projetados para controlar motores el√©tricos (controle do motor). Este n√£o √© apenas um par de canais PWM. Esses s√£o nove m√≥dulos PWM sofisticados de dois canais (PWM), dos quais tr√™s s√£o m√≥dulos (HRPWM) com um modo de resolu√ß√£o "alta". Estes s√£o seis m√≥dulos de captura CAP de 32 bits separados. Vinte e quatro (!) Canais de ADCs de 12 bits com um gerenciador de inicializa√ß√£o flex√≠vel, m√©dia incorporada e comparadores digitais. Dois decodificadores de quadratura (QEP), v√°rias interfaces de comunica√ß√£o, mem√≥ria interna do usu√°rio, rel√≥gios - tudo isso no n√∫cleo do ARM Cortex-M4F com um megabyte de mem√≥ria flash "on board" e um desempenho de 100 MIPS! Interessante?</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Na verdade, para n√£o listar todas as caracter√≠sticas t√©cnicas do produto no artigo, estou enviando-o para a p√°gina do site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">do fabricante</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">H√° uma lista curta e uma folha de dados completa (embora ela esteja sempre oculta nos diferentes cantos do site e no momento da reda√ß√£o deste documento, voc√™ pode baix√°-la ... da tabela de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desenvolvimentos atuais</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">E no artigo, √© melhor dizer algo que n√£o est√° escrito nas folhas de dados.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um pouco de hist√≥ria</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Os trabalhos no microcontrolador (a seguir denominado MK) come√ßaram em 2012 pela empresa </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NPP Digital Solutions,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> por ordem de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OJSC NIIET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Voronezh.) As licen√ßas foram adquiridas para o n√∫cleo ARM Cortex-M4F e alguns m√≥dulos perif√©ricos de comunica√ß√£o, e alguns dos m√≥dulos foram desenvolvidos por esta empresa de forma independente: m√≥dulos PWM, um controlador ADC (n√£o o pr√≥prio ADC, mas um gerente para gerenci√°-lo), um m√≥dulo de captura CAP e um m√≥dulo decodificador em quadratura QEP. A NPP Digital Solutions produziu pela primeira vez um modelo de microcontrolador no Kintex7 FPGA, que implementou toda a l√≥gica do futuro microcontrolador, incluindo o n√∫cleo ARM. Mas o FPGA √© um produto livremente reprogram√°vel que permite corrigir erros na l√≥gica MK se eles forem detectados ap√≥s a aprova√ß√£o nos testes (isso √© um acr√©scimo ao teste em um simulador). Mas como testar um microcontrolador motorcontrol? Al√©m dos testes sint√©ticos, √© claro, sobre a verdadeira tarefa de controlar um motor el√©trico! Para isso, a NPP "Digital Solutions" se voltou para n√≥s - em</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">NPF Vector LLC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , j√° que temos muita experi√™ncia no campo de acionamentos el√©tricos baseados na MK Texas Instruments </font></font><strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, embora seja porque estamos sentados em um pr√©dio vizinho</font></font></strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Em discuss√µes conjuntas ao projetar perif√©ricos para controle de motores el√©tricos, foi decidido tomar o TMS320F28335 Texas Instruments (TI) como modelo, pois esse microcontrolador provavelmente possui os perif√©ricos de controle de motor mais potentes e flex√≠veis, merecidamente respeitados em todo o mundo. Portanto, armadas com as folhas de dados da TI, as ‚ÄúSolu√ß√µes Digitais‚Äù criaram com base na l√≥gica interna dos m√≥dulos PWM, CAP e QEP para o K1921VK01T. Al√©m disso, com base em nossa experi√™ncia com o TI MK, propusemos adicionalmente algumas melhorias que faltam √† TI. Este √© um filtro de pulsos curtos em um m√≥dulo PWM (nem todos os drivers de chave de alimenta√ß√£o, como abrir / fechar por um per√≠odo muito curto, o IGBT pode entrar no modo linear), essas s√£o algumas das nuances do m√≥dulo decodificador em quadratura, que permitem que voc√™ se livre de problemas com a troca de divisores de medidores em movimento etc.As ‚Äúsolu√ß√µes digitais‚Äù levaram em considera√ß√£o e expandiram a funcionalidade perif√©rica de acordo com os m√≥dulos de TI.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Enquanto a NPP Digital Solutions desenvolveu a l√≥gica interna dos m√≥dulos, n√≥s da NPF Vector decidimos testar o futuro microcontrolador. Era um pequeno conversor de frequ√™ncia com seis transistores ("servo amplificador"), que era conectado por circuitos de controle ao microcontrolador prot√≥tipo no FPGA, e a parte de pot√™ncia era conectada a um pequeno servomotor com sensores de posi√ß√£o Hall (para verificar o m√≥dulo CAP) e um sensor de posi√ß√£o em quadratura (para verificar o m√≥dulo QEP ) Nosso objetivo era o seguinte: escrever um software para o microcontrolador para garantir o controle total do vetor do motor el√©trico usando qualquer sensor de posi√ß√£o de sua escolha ou ambos de uma vez. E, √© claro, relatar todos os problemas encontrados na periferia para ‚ÄúSolu√ß√µes Digitais‚Äù.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apesar de muitos testes da MK na Digital Solutions, muitos erros foram encontrados durante os testes em um motor el√©trico ativo. Basicamente, eles foram associados a uma implementa√ß√£o imprecisa da l√≥gica de blocos internos, que n√£o foi explicitamente descrita nas folhas de dados da Texas Instruments. Por exemplo, o que o m√≥dulo PWM deve produzir se o ponto de ajuste de compara√ß√£o for definido acima do per√≠odo do temporizador? Ou, se um divisor de sinal de entrada estiver inclu√≠do para um decodificador em quadratura, o m√≥dulo deve detectar uma mudan√ßa no sentido de rota√ß√£o por um sinal dividido ou pela entrada original? As respostas para essas perguntas podem ser √≥bvias para o acionamento el√©trico, mas n√£o √≥bvias para o arquiteto da l√≥gica do microcontrolador. Na medida do poss√≠vel, detectamos erros semelhantes junto com a Digital Solutions. O inversor trabalhou com sucesso no controle vetorial sem problemas.No entanto, √© claro, n√£o conseguimos cobrir todos os erros com esses testes - com certeza em outras tarefas os erros come√ßar√£o a aparecer novamente. Mas, para isso, h√° erratas e novas revis√µes dos microcontroladores: para corrigir bugs, voc√™ deve primeiro colet√°-los. Ap√≥s depurar a l√≥gica do MK no FPGA com "Digital Solutions", a "fia√ß√£o" do MK (ou o que seja) foi feita</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> chamado microcontroladores? </font><font style="vertical-align: inherit;">Topologia?), Ap√≥s o qual todos os resultados do trabalho foram transferidos para o NIIET. </font><font style="vertical-align: inherit;">A prop√≥sito, j√° encontramos v√°rios erros ap√≥s o lan√ßamento do MK na "pedra", mas o NIIET os considerou cr√≠ticos o suficiente para alterar o layout do MK: eles acumulam mais - eles v√£o corrigi-lo.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T√≠tulo</font></font></h1><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/086/09f/ff5/08609fff50fd4295ba078743bb8a0811.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Devo tamb√©m dizer que o microcontrolador sobreviveu a v√°rios nomes. </font><font style="vertical-align: inherit;">No in√≠cio, durante o desenvolvimento, ele tinha o nome de c√≥digo "MS01", depois o lote experimental de pedras foi chamado NT32M4F1 e depois se tornou K1921VK01T (al√©m disso, em alguns lugares as letras s√£o escritas em russo, em outras letras em ingl√™s). </font><font style="vertical-align: inherit;">Portanto, se voc√™ vir esses nomes nos primeiros artigos e publica√ß√µes sobre este MK, n√£o se surpreenda.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu√£o caro?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Atualmente (no in√≠cio de 2016), o NIIET est√° pronto para vender o primeiro lote de microcontroladores, que j√° come√ßou a chegar aos clientes. Os cristais s√£o </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">envoltos</font></a><font style="vertical-align: inherit;"> em </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">parte</font></a><font style="vertical-align: inherit;"> em pl√°stico, em </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">parte</font></a><font style="vertical-align: inherit;"> em cer√¢mica (para que em aplica√ß√µes cr√≠ticas n√£o funcione como voc√™ - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">voc√™ sabe - o que</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) O pre√ßo da pedra no pl√°stico no final de 2015, ao que parece, era um pouco menor que 3 tr, o que √© mais alto que o pre√ßo da TI TMS320F28335 ao comprar na R√∫ssia (no momento da reda√ß√£o deste artigo, o coeficiente para converter os pre√ßos "de seus" em "nossos" era 76). No entanto, no TMS320F28335 n√£o h√° mem√≥ria e horas do usu√°rio, √© necess√°rio definir as externas, por causa das quais o custo no final se torna compar√°vel. Isso torna o K1921VK01T promissor n√£o apenas em termos de substitui√ß√£o de importa√ß√µes, mas tamb√©m para ‚Äúinteresses mercantis‚Äù simples. Embora essa compara√ß√£o, √© claro, n√£o esteja totalmente correta - voc√™ pode encontrar v√°rios exemplos de cristais mais baratos no Cortex-M4F e com uma frequ√™ncia de clock mais alta, mas com menos perif√©ricos. Portanto, para tarefas simples, o K1921VK01T ser√° excessivamente grande e caro. Mas para a aplica√ß√£o principal (controle de motores el√©tricos e eletr√¥nicos de pot√™ncia complexos) - √© competitivo.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que temos com o desempenho?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 Fizemos uma apresenta√ß√£o na exposi√ß√£o sobre isso h√° um ano, a apresenta√ß√£o pode ser encontrada </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Nossos testes, √© claro, n√£o pretendem ser particularmente precisos - afinal, n√£o realizamos benchmarks reais, mas "juntamos" o mesmo sistema de controle vetorial no teste (e o que mais pode excitar os acionamentos el√©tricos?). Por√©m, uma breve recontagem da apresenta√ß√£o √© a seguinte: a arquitetura ARM Cortex-M4F fica atr√°s do DSP principal da C28 TI nos c√°lculos m√©dios necess√°rios para as tarefas da unidade. Se voc√™ reduzir a precis√£o dos c√°lculos, sempre que poss√≠vel, usando fun√ß√µes trigonom√©tricas aproximadas e assim por diante, poder√° reduzir esse intervalo para cerca de 15%. Mas, ao mesmo tempo, a frequ√™ncia de clock dos principais n√∫cleos C28 (o mesmo TMS320F28335) √© de 150 MHz e a frequ√™ncia do K1921VK01T √© de 100 MHz. Portanto, com todas as otimiza√ß√µes de biblioteca, o K1921VK01T √© equivalente em pot√™ncia computacional em algum lugar √† s√©rie TI piccolo MK, com uma frequ√™ncia de 90 MHz. O que pode ser interpretado como ... muito bom, em nossa opini√£o,porque se voc√™ usar corretamente todos os sinos e apitos de hardware do novo MK, como medi√ß√µes DMA e ADC com filtragem autom√°tica, poder√° economizar muito em ciclos de clock. De uma forma ou de outra, conseguimos "empinar" o K1921VK01T em nosso projeto de desempenho mais exigente, com base no TMS320F2810 (150MHz, n√∫cleo C28), que j√° colide com o mesmo 2810.</font></font><br>
<br>
<h1>     ?</h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
E o que poderia estar errado com eles, √© o BRA√áO! Normal, sem nenhum "mas". Pegue qualquer JTAG, qualquer ambiente de desenvolvimento, mas ... n√£o, afinal, qualquer um n√£o funcionar√°. "Mas" √© o firmware da mem√≥ria flash. Apesar do fato do n√∫cleo do ARM ser padronizado e de qualquer JTAG e ambiente se conectar ao K1921VK01T, n√£o √© t√£o simples com o firmware flash. Parece que cada fabricante de microcontroladores considera seu dever fazer seus pr√≥prios registros para trabalhar com o firmware de sua mem√≥ria flash, para que os criadores de ferramentas de desenvolvimento sejam atormentados com o apoio de todo esse zool√≥gico. O K1921VK01T tamb√©m n√£o est√° muito atrasado nesse aspecto - tamb√©m existem m√©todos para trabalhar com flash. Mas se para fabricantes eminentes programadores de mem√≥ria flash (driver, pisca-pisca ou como devo cham√°-lo?) Nos ambientes de desenvolvimento s√£o escritos e funcionam imediatamente, para o K1921VK01T tudo funciona apenas nesses ambientespara os quais os programadores escreveram na NIIET. Felizmente, para o IAR e Keil, tudo est√° pronto e exemplos de projetos com instru√ß√µes de firmware podem ser encontrados em</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F√≥rum NIIET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , bem como no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reposit√≥rio</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aberto </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">no Bitbucket</font></a><font style="vertical-align: inherit;"> , que √© mantido pelo NIIET. Al√©m disso, n√≥s da NPF Vector escrevemos suporte para a programa√ß√£o do flash K1921VK01T para </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenOCD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(Abra o depurador no chip). Essa √© uma camada entre o depurador GDB e o ferro na forma de diferentes emuladores JTAG e pedras diferentes. Mas enquanto est√°vamos fazendo a "revis√£o de c√≥digo" no reposit√≥rio OpenOCD com resolu√ß√£o de conflitos, os desenvolvedores do NIIET escreveram a mesma coisa, mas a deles foi melhor (eles tamb√©m adicionaram a fun√ß√£o de grava√ß√£o do usu√°rio al√©m de queimar a mem√≥ria flash principal), mas ... essa √© a letra da m√∫sica. O que esse OpenOCD oferece? Esse √© um tipo de camada de abstra√ß√£o de ferro, que permite criar seu pr√≥prio ambiente de desenvolvimento livre e gratuito para o K1921VK01T com base em qualquer IDE popular. N√≥s, no "Vetor", adoramos o Eclipse (porque o ambiente do TI Code Composer Studio, a partir da v4, √© baseado nele, estamos acostumados a ele </font></font><strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e, geralmente, n√£o h√° IDE melhor no mundo do que o Eclipse</font></font></strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) E os desenvolvedores do NIIET criaram um ambiente de desenvolvimento no Qt Creator. Mas, em geral, o significado √© o mesmo aqui e ali: voc√™ pega o ambiente, pega o conjunto de ferramentas gratuitas de desenvolvimento cruzado para o GCC, pega o plug-in para trabalhar com o OpenOCD, o pr√≥prio OpenOCD, algumas configura√ß√µes, um pouco de m√°gica ... e voc√™ j√° trabalha totalmente com o K1921VK01T, esquecendo-se de IAR e Keil. No momento em que escrevemos, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">publicamos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nossa montagem Eclipse (denominada VectorIDE) para K1921VK01T </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">em nosso site</font></a><font style="vertical-align: inherit;"> , veja a receita do Qt Creator no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f√≥rum NIIET</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pessoalmente, conduzimos todos os projetos do K1921VK01T em um ambiente livre e aconselhamos voc√™ - o conjunto de compiladores GCC n√£o fica muito atr√°s dos IARs da marca (veja nossa mesma </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">apresenta√ß√£o</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), mas se voc√™ √© uma empresa respeit√°vel, n√£o precisa comprar software importado caro (j√° com um fator de convers√£o de </font></font><strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">76, Karl!</font></font></strike><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 78!). </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ah sim. H√° mais uma coisa. √â chamado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Codemaster ++ [ARM]</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Este √© um ambiente de desenvolvimento 100% dom√©stico, incluindo compiladores, e tamb√©m projetado para o K1921VK01T. Examinamos suas primeiras vers√µes h√° um ano, mas descobrimos que ainda n√£o estava pronta, um pouco em termos de compiladores e muito em termos de facilidade de edi√ß√£o de c√≥digo (embora nisso possa competir com o IAR, que sabe o que quero dizer). Mas √© pequeno e r√°pido, e na interface se assemelha a algum tipo de depurador "hacker" como o OllyDbg (compare: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">um</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dois</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). Em geral, talvez algu√©m se interesse. Devo dizer que os desenvolvedores (empresa</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄúFiton‚Äù</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) se esfor√ßou muito, at√© solicitou ao mesmo tempo nosso benchmark √† la ‚Äúcontrole de mecanismo de vetor‚Äù para otimizar seus compiladores.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O que temos com os kits de depura√ß√£o?</font></font></h1><br>
<img src="https://habrastorage.org/files/8ec/122/5f7/8ec1225f7ca24599a4a47bb25091e9f1.jpg"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No in√≠cio de 2016, quatro placas de depura√ß√£o no K1921VK01T s√£o conhecidas por natureza. Este √© o nosso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">VectorCARD K1921BK01T</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e outros ... dos concorrentes. Ok, assim √©, aqui est√£o os links </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">LDM-HELPER-K1921BK01T</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MBS-K1921VK01T</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Parece tamb√©m que o pr√≥prio NIIET possui seu pr√≥prio quadro NIIET_1921BK01T, mas aparentemente est√° escondido em meu site - se algu√©m encontrar um link, terei prazer em complementar o artigo. Qual √© a diferen√ßa entre eles? N√£o vendemos uma placa vazia, mas um kit com um inversor, motor el√©trico, controle vetorial em c√≥digos-fonte C (com base no que escrevemos na √©poca para a Digital Solutions), bem como com um programa de n√≠vel superior e um driver CANopen para monitorar todos os processos dentro da unidade - veja nosso </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primeiro artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Portanto, se voc√™ quiser apenas brincar com o novo MK, piscar um LED ou enviar dados por qualquer interface de comunica√ß√£o, √© melhor comprar placas de depura√ß√£o de concorrentes (embora tamb√©m tenhamos uma op√ß√£o de placa nua por 15 tr, mas √© completamente "nua" - algumas conclus√µes). No entanto, se voc√™ deseja criar uma unidade el√©trica no novo MK, nosso kit e software de depura√ß√£o podem economizar meio ano ou um ano em tempo de desenvolvimento (ou talvez mais, dependendo se voc√™ conhece a teoria da unidade el√©trica e se possui suas pr√≥prias ferramentas de depura√ß√£o e oscilografia semelhante ao nosso). Se voc√™ ler atentamente o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">primeiro artigo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ent√£o, provavelmente, lembre-se de que √© imposs√≠vel depurar um sistema de controle para um acionamento el√©trico sem meios de visualizar os processos internos. E se na Texas Instruments o ambiente de desenvolvimento √© capaz de mostrar oscilogramas "prontos para uso" com base nos dados da matriz de mem√≥ria do MK, para o ARM em ambientes de desenvolvimento universal (n√£o de um fabricante espec√≠fico do MK), essa fun√ß√£o ainda n√£o foi observada (se os desenvolvedores da Fiton lerem isso - Deseja modificar seu Codemaster ++ [ARM] com o construtor de oscilosc√≥pios? √â f√°cil faz√™-lo!). No nosso kit de depura√ß√£o, esses meios de visualiza√ß√£o de formas de onda est√£o presentes, para que voc√™ possa ver imediatamente tudo o que deve controlar motores el√©tricos: a forma de correntes de fase, tens√µes, entradas / sa√≠das de todos os reguladores, etc. O pre√ßo do nosso kit √© grande, aproximadamente 130 tr.(atualmente, apenas um motor el√©trico com todos os sensores de posi√ß√£o custa cerca de 30 tr). Mas para uma organiza√ß√£o que deseja aprender um novo produto, isso n√£o deve ser cr√≠tico - um ambiente de desenvolvimento comercial somente para a ARM pode custar mais.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desvantagens do K1921VK01T</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quais s√£o as principais desvantagens do novo K1921VK01T agora podem ser observadas? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Em primeiro lugar, este √© sem d√∫vida um produto bruto, pois foi realmente programado at√© agora por 10 a 20 pessoas. </font><font style="vertical-align: inherit;">Quando mais desenvolvedores estiverem sentados, erros ser√£o detectados - novas revis√µes ser√£o lan√ßadas. </font><font style="vertical-align: inherit;">Ent√£o prepare-se. </font><font style="vertical-align: inherit;">Mas, no entanto, eles podem torcer os motores - torcidos pessoalmente. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ No momento, a documenta√ß√£o tamb√©m est√° √∫mida. </font><font style="vertical-align: inherit;">Existem poucos erros, mas algumas coisas s√£o explicadas ... n√£o est√° totalmente claro. </font><font style="vertical-align: inherit;">Pode-se pintar um pouco mais detalhadamente, dar exemplos. </font><font style="vertical-align: inherit;">Eu acho que com o tempo ser√° finalizado.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ O microcontrolador √© muito grande e sofisticado. Isto √© para algu√©m mais, para algu√©m menos. Muito poucas aplica√ß√µes cobrem toda a gama de seus recursos. O NIIET j√° est√° pensando em uma s√©rie de MK baseada nele, com diferentes edif√≠cios e um conjunto de perif√©ricos. Mas, por enquanto - existe apenas o K1921VK01T.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ Ele tem um CPM espec√≠fico. Freq√ºentemente, os fabricantes de MK instalam um m√≥dulo ADC r√°pido (12 MS / s) e o multiplexam por v√°rios canais - por exemplo, isso foi feito pela Texas Instruments na s√©rie C2000. Mas no K1921VK01T existem 12 m√≥dulos ADC lentos de dois canais (1,7MS / s) operando em paralelo. Por que √© ruim, al√©m da incapacidade de medir algo muito rapidamente? Se houver um ADC no MK, na placa controladora voc√™ poder√° enviar sinais de refer√™ncia calibrados, digamos 1V e 2V, para dois canais n√£o utilizados e us√°-los para calcular e compensar o erro multiplicativo e o erro de deslocamento deste ADC, estendendo a corre√ß√£o a todos os canais (o ADC √© um ) Quando existem muitos ADCs no MK, esse truque n√£o funciona - todos eles ter√£o seus pr√≥prios erros pessoais. Usamos o truque de calibra√ß√£o no Texas Instruments MK tipo TMS320F2810 (isso √© descrito na ficha t√©cnica e recomendado),aqui no K1921VK01T sem calibra√ß√£o, obtivemos uma precis√£o menor do ADC em compara√ß√£o com o TMS320F2810 calibrado. Tivemos que criar um suporte especial para calibrar cada m√≥dulo ADC K1921VK01T de forma independente e costurar a tabela de calibra√ß√£o na mem√≥ria interna do usu√°rio. Ent√£o, a precis√£o das medi√ß√µes anal√≥gicas acabou sendo compar√°vel (a calibra√ß√£o quase n√£o flutua longe da temperatura - foi verificada). Provavelmente, o NIIET deve piscar uma mesa dessas na f√°brica, seria conveniente. Mas enquanto o flash estiver vazio.Ent√£o, a precis√£o das medi√ß√µes anal√≥gicas acabou sendo compar√°vel (a calibra√ß√£o quase n√£o flutua longe da temperatura - foi verificada). Provavelmente, o NIIET deve piscar uma mesa dessas na f√°brica, seria conveniente. Mas enquanto o flash estiver vazio.Ent√£o, a precis√£o das medi√ß√µes anal√≥gicas acabou sendo compar√°vel (a calibra√ß√£o quase n√£o flutua longe da temperatura - foi verificada). Provavelmente, o NIIET deve piscar uma mesa dessas na f√°brica, seria conveniente. Mas enquanto o flash estiver vazio.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ A frequ√™ncia de 100 MHz, √© claro, √© bastante baixa, eu gostaria mais r√°pido. Mas √© isso, √© isso. Embora em alguns lugares eles escrevam a frequ√™ncia de 125 MHz - tudo depende da temperatura ambiente. A "Digital Solutions" relatou essas informa√ß√µes n√£o oficiais: o interior do cristal foi projetado para um m√°ximo de 125 graus. A temperatura √© cerca de 15 graus mais alta que o meio ambiente. De acordo com o projeto, o K1921VK01T deve funcionar a 85 graus do ambiente + reserva, o que √© garantido para ser alcan√ßado a 100 MHz. De fato, o MK pode ser acelerado acima de 100 MHz, amostras individuais trabalhadas em 140-170 MHz, mas isso depende da amostra. Portanto, se o cristal n√£o estiver superaquecido, poder√° ser disperso, se algu√©m precisar. Mas se na sua aplica√ß√£o estiver quente (+85), √© melhor n√£o intimidar acima de 100 MHz.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
‚Ä¢ N√£o h√° carregador de inicializa√ß√£o oficial (programador) por meio de interfaces de comunica√ß√£o (CAN, RS). </font><font style="vertical-align: inherit;">A costura MK √© poss√≠vel apenas atrav√©s do JTAG / SWD. </font><font style="vertical-align: inherit;">Consequentemente, se o controlador do produto estiver em um estojo fechado, ser√° necess√°rio gravar o gerenciador de inicializa√ß√£o na interface de comunica√ß√£o desejada. </font><font style="vertical-align: inherit;">Ou aguarde at√© que o NIIET escreva. </font><font style="vertical-align: inherit;">At√© agora, n√£o, mas acho que aparecer√°.</font></font><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Embora o que mais seja a conclus√£o? </font><font style="vertical-align: inherit;">Tudo est√° apenas come√ßando! </font><font style="vertical-align: inherit;">Finalmente, existe um microcontrolador dom√©stico no qual voc√™ pode realmente fazer um acionamento el√©trico! </font><font style="vertical-align: inherit;">Antes disso, todos os MKs dom√©sticos existentes eram fracos pelo n√∫cleo ou pela periferia, a fim de lidar com as tarefas de controle motor. </font><font style="vertical-align: inherit;">Mas agora - total liberdade para as estruturas de controle mais complexas e a unidade de pot√™ncia mais complexa. </font><font style="vertical-align: inherit;">Gostaria especialmente de observar as perspectivas deste microcontrolador para servocontroladores de m√°quinas. </font><font style="vertical-align: inherit;">At√© agora, na R√∫ssia, n√£o era poss√≠vel fabricar uma m√°quina de precis√£o multieixos totalmente dom√©stica, j√° que (uma das raz√µes) n√£o havia nada para fazer um servo-drive de alta qualidade. </font><font style="vertical-align: inherit;">Agora existe um microcontrolador.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt389129/">https://habr.com/ru/post/pt389129/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt389119/index.html">Adicionando e configurando o banco de dados 1C ao servidor</a></li>
<li><a href="../pt389121/index.html">O Firefox 46 suportar√° v√°rios monitores com diferentes densidades de pixel</a></li>
<li><a href="../pt389123/index.html">M√©todos para depurar software de microcontrolador em uma unidade el√©trica</a></li>
<li><a href="../pt389125/index.html">Galactoseismologia: como gal√°xias an√£s constitu√≠das por mat√©ria escura deixam vest√≠gios no g√°s interestelar</a></li>
<li><a href="../pt389127/index.html">Marketing agressivo ou como a motiva√ß√£o de um arco brilhante no pulso ("enfeites") difere da motiva√ß√£o de uma pulseira de fitness</a></li>
<li><a href="../pt389133/index.html">C√£es reconhecem emo√ß√µes humanas atrav√©s de v√°rios sentidos</a></li>
<li><a href="../pt389139/index.html">Drinky √© um rob√¥ amigo que est√° sempre l√°</a></li>
<li><a href="../pt389141/index.html">Discuss√£o: Amantes da m√∫sica e audi√≥filos, players de rede e ac√∫stica embutida</a></li>
<li><a href="../pt389143/index.html">Google Street View atinge o pa√≠s das maravilhas em miniatura</a></li>
<li><a href="../pt389145/index.html">Como impedir que terroristas usem drones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>