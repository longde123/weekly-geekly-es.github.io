<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ“° ğŸ›· ğŸ‘ŒğŸ¼ ç¥ç»ç½‘ç»œï¼šåœ¨Tensor Flowå’ŒPythonä¸Šå®ç°æœ‰å…³è˜‘è‡çš„ä»»åŠ¡çš„å®ç° ğŸ‘ğŸ¼ ğŸŒ  ğŸ’ƒğŸ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tensor Flowæ˜¯ä¸€ä¸ªç”¨äºæ„å»ºå’Œä½¿ç”¨Googleç¥ç»ç½‘ç»œçš„æ¡†æ¶ã€‚ è®©æ‚¨ä»æœºå™¨å­¦ä¹ çš„å†…éƒ¨ç»†èŠ‚ä¸­æŠ½è±¡å‡ºæ¥ï¼Œç›´æ¥ä¸“æ³¨äºè§£å†³é—®é¢˜ã€‚ ä¸€ä¸ªéå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œå®ƒå…è®¸æ‚¨åˆ›å»ºï¼Œè®­ç»ƒå’Œä½¿ç”¨ä»»ä½•å·²çŸ¥ç±»å‹çš„ç¥ç»ç½‘ç»œã€‚ åœ¨æ­¤ä¸»é¢˜ä¸Šï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°æœ‰å…³å“ˆå¸ƒé›·çš„ä»»ä½•æ˜æ™ºæ–‡ç« ï¼Œæ‰€ä»¥æˆ‘å†™äº†è‡ªå·±çš„æ–‡ç« ã€‚ ä¸‹é¢æˆ‘ä»¬å°†ä½¿ç”¨Tensor ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ç¥ç»ç½‘ç»œï¼šåœ¨Tensor Flowå’ŒPythonä¸Šå®ç°æœ‰å…³è˜‘è‡çš„ä»»åŠ¡çš„å®ç°</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419917/">  Tensor Flowæ˜¯ä¸€ä¸ªç”¨äºæ„å»ºå’Œä½¿ç”¨Googleç¥ç»ç½‘ç»œçš„æ¡†æ¶ã€‚ è®©æ‚¨ä»æœºå™¨å­¦ä¹ çš„å†…éƒ¨ç»†èŠ‚ä¸­æŠ½è±¡å‡ºæ¥ï¼Œç›´æ¥ä¸“æ³¨äºè§£å†³é—®é¢˜ã€‚ ä¸€ä¸ªéå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œå®ƒå…è®¸æ‚¨åˆ›å»ºï¼Œè®­ç»ƒå’Œä½¿ç”¨ä»»ä½•å·²çŸ¥ç±»å‹çš„ç¥ç»ç½‘ç»œã€‚ åœ¨æ­¤ä¸»é¢˜ä¸Šï¼Œæˆ‘æ²¡æœ‰æ‰¾åˆ°æœ‰å…³å“ˆå¸ƒé›·çš„ä»»ä½•æ˜æ™ºæ–‡ç« ï¼Œæ‰€ä»¥æˆ‘å†™äº†è‡ªå·±çš„æ–‡ç« ã€‚ ä¸‹é¢æˆ‘ä»¬å°†ä½¿ç”¨Tensor Flowåº“æè¿°è§£å†³è˜‘è‡é—®é¢˜çš„æ–¹æ³•çš„å®ç°ã€‚ é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œä»¥ä¸‹æè¿°çš„ç®—æ³•å‡ ä¹é€‚ç”¨äºä»»ä½•é¢†åŸŸçš„é¢„æµ‹ã€‚ ä¾‹å¦‚ï¼Œå°†æ¥æŸäººæ‚£ç™Œç—‡çš„å¯èƒ½æ€§æˆ–åœ¨æ‰‘å…‹æ¸¸æˆä¸­çš„å¯¹æ‰‹å‘ç‰Œçš„å¯èƒ½æ€§ã€‚ <a name="habracut"></a><br><br><h3> æŒ‘æˆ˜èµ› </h3><br> é—®é¢˜çš„å®è´¨ï¼šæ ¹æ®çœŸèŒçš„è¾“å…¥å‚æ•°ç¡®å®šå…¶é£Ÿç”¨æ€§ã€‚ ç‰¹å¼‚æ€§æ˜¯è¿™äº›å‚æ•°æ˜¯åˆ†ç±»çš„ï¼Œè€Œä¸æ˜¯æ•°å­—çš„ã€‚ ä¾‹å¦‚ï¼Œâ€œå¸½å­å½¢çŠ¶â€å‚æ•°å¯ä»¥è¢«è®¾ç½®ä¸ºâ€œå¹³å¦â€æˆ–â€œå‡¸å½¢â€æˆ–â€œåœ†é”¥å½¢â€ã€‚ ä»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœºå™¨å­¦ä¹ å­˜å‚¨åº“ä¸­</a>è·å–çš„ç”¨äºç½‘ç»œå­¦ä¹ çš„è˜‘è‡æ•°æ®é›†ã€‚ å› æ­¤ï¼Œè¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¯ä»¥ç§°ä¸ºæœºå™¨å­¦ä¹ é¢†åŸŸä¸­çš„â€œ Hello Worldâ€ï¼Œä¹Ÿå¯ä»¥ç§°ä¸º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é¸¢å°¾èŠ±é—®é¢˜</a> ï¼Œå…¶ä¸­<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é¸¢å°¾èŠ±</a>çš„èŠ±æœµå‚æ•°ä»¥æ•°å­—å€¼è¡¨ç¤ºã€‚ <br><br><h3> æºä»£ç  </h3><br> æ‚¨å¯ä»¥åœ¨Githubï¼š <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">link</a>ä¸Šä»æˆ‘çš„å­˜å‚¨åº“ä¸‹è½½æ‰€æœ‰èµ„æºã€‚ è¿™æ ·åšå¯ä»¥æŸ¥çœ‹å®é™…çš„ä»£ç ã€‚ ä»…ä½¿ç”¨æºä»£ç ï¼Œå› ä¸ºåœ¨é‚£é‡Œä¼šè§‚å¯Ÿåˆ°æ‰€æœ‰å¿…éœ€çš„ç¼©è¿›å’Œç¼–ç ã€‚ ä¸‹é¢å°†å¯¹æ•´ä¸ªè¿‡ç¨‹è¿›è¡Œè¯¦ç»†è®¨è®ºã€‚ <br><br><h3> å‡†å¤‡å·¥ä½œ </h3><br> å‡è®¾æ‚¨å·²ç»é¢„è£…äº†Tensor Flowå®‰è£…ã€‚ å¦‚æœæ²¡æœ‰ï¼Œæ‚¨å¯ä»¥å®‰è£…<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">é“¾æ¥</a> ã€‚ <br><br><h3> æºä»£ç  </h3><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os <span class="hljs-comment"><span class="hljs-comment">#       . #     CSV-    Tensor Flow       .  ,       (0  1) def prepare_data(data_file_name): header = ['class', 'cap_shape', 'cap_surface', #  CSV-   ,     'agaricus-lepiota.name'   'cap_color', 'bruises', 'odor', 'gill_attachment', 'gill_spacing', 'gill_size', 'gill_color', 'stalk_shape', 'stalk_root', 'stalk_surface_above_ring', 'stalk_surface_below_ring', 'stalk_color_above_ring', 'stalk_color_below_ring', 'veil_type', 'veil_color', 'ring_number', 'ring_type', 'spore_print_color', 'population', 'habitat'] df = pd.read_csv(data_file_name, sep=',', names=header) #   "?"      #        df.replace('?', np.nan, inplace=True) df.dropna(inplace=True) #         #  'e'  'p' .       # ,   0  , 1 -    df['class'].replace('p', 0, inplace=True) df['class'].replace('e', 1, inplace=True) #       , #     . Tensor Flow      # .  Pandas    "get_dummies" #      cols_to_transform = header[1:] df = pd.get_dummies(df, columns=cols_to_transform) #      #    -    () #      () df_train, df_test = train_test_split(df, test_size=0.1) #           num_train_entries = df_train.shape[0] num_train_features = df_train.shape[1] - 1 num_test_entries = df_test.shape[0] num_test_features = df_test.shape[1] - 1 #      csv-, .. #          #  csv,    Tensor Flow df_train.to_csv('train_temp.csv', index=False) df_test.to_csv('test_temp.csv', index=False) #     ,    open("mushroom_train.csv", "w").write(str(num_train_entries) + "," + str(num_train_features) + "," + open("train_temp.csv").read()) open("mushroom_test.csv", "w").write(str(num_test_entries) + "," + str(num_test_features) + "," + open("test_temp.csv").read()) #   ,     os.remove("train_temp.csv") os.remove("test_temp.csv") #        Tensor Flow def get_test_inputs(): x = tf.constant(test_set.data) y = tf.constant(test_set.target) return x, y #        Tensor Flow def get_train_inputs(): x = tf.constant(training_set.data) y = tf.constant(training_set.target) return x, y #        #    ( : , ) #  ,         def new_samples(): return np.array([[0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0], [0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1]], dtype=np.int) if __name__ == "__main__": MUSHROOM_DATA_FILE = "agaricus-lepiota.data" #     Tensor Flow, #   CSV- (  ) prepare_data(MUSHROOM_DATA_FILE) #    training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename='mushroom_train.csv', target_dtype=np.int, features_dtype=np.int, target_column=0) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename='mushroom_test.csv', target_dtype=np.int, features_dtype=np.int, target_column=0) # ,        ( ) feature_columns = [tf.contrib.layers.real_valued_column("", dimension=98)] #   DNN-  10, 20  10    classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[10, 20, 10], n_classes=2, model_dir="/tmp/mushroom_model") #   classifier.fit(input_fn=get_train_inputs, steps=2000) #        accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=1)["accuracy"] print("\n : {0:f}\n".format(accuracy_score)) #         predictions = list(classifier.predict_classes(input_fn=new_samples)) print("   : {}\n" .format(predictions))</span></span></code> </pre> <br><h3> ä»å­˜å‚¨åº“ä¸‹è½½å¹¶å‡†å¤‡æ•°æ® </h3><br> æˆ‘ä»¬å°†ä»ä¸ºæ­¤ä¸“é—¨åˆ›å»º<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„æœºå™¨å­¦ä¹ å­˜å‚¨åº“ä¸­</a>ä¸‹è½½ç”¨äºè®­ç»ƒå’Œæµ‹è¯•ç¥ç»ç½‘ç»œçš„æ•°æ®ã€‚ æ‰€æœ‰æ•°æ®éƒ½æ˜¾ç¤ºåœ¨ä¸¤ä¸ªæ–‡ä»¶ä¸­ï¼šagaricus-lepiota.dataå’Œagaricus-lepiota.namesã€‚ å‰8124è¡Œå’Œ22åˆ—ã€‚ ä¸€è¡Œæä¾›ä¸€ä¸ªè˜‘è‡ï¼Œæ¯ä¸€åˆ—éƒ½æ˜¯è˜‘è‡çš„22ä¸ªå‚æ•°ä¹‹ä¸€ï¼Œå…¶å½¢å¼ä¸ºæ•´ä¸ªå‚æ•°å­—ä¸­çš„å½’çº¦å­—ç¬¦ã€‚ æ‰€æœ‰å­—ç¬¦çš„å›¾ä¾‹ä½äºagarius-lepiota.namesæ–‡ä»¶ä¸­ã€‚ <br><br> éœ€è¦å¤„ç†æ¥è‡ªå­˜å‚¨åº“ä¸­çš„æ•°æ®ï¼Œä»¥ä½¿å…¶æˆä¸ºTensor Flowå¯æ¥å—çš„å½¢å¼ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å¯¼å…¥ä¸€äº›è¦å·¥ä½œçš„åº“ <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os</code> </pre> <br> ç„¶åï¼Œæˆ‘ä»¬å°†ä»Tensor Flowçš„è˜‘è‡å½¢å‚æ•°ä¸­å½¢æˆä¸€ä¸ªæ ‡å¤´ï¼Œä»¥ä¾¿åº“çŸ¥é“æ•°æ®æ–‡ä»¶ä¸­çš„å“ªåˆ—ä¸å“ªä¸ªå‚æ•°ç›¸å¯¹åº”ã€‚ å¸½å­è¢«ç²˜åˆ°æ•°æ®æ–‡ä»¶ä¸Šã€‚ æˆ‘ä»¬ä»¥æ•°ç»„çš„å½¢å¼å½¢æˆï¼Œå…¶å…ƒç´ å–è‡ªæ–‡ä»¶agaricus-lepiota.namesã€‚ <br><br><pre> <code class="python hljs">header = [<span class="hljs-string"><span class="hljs-string">'class'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_shape'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_surface'</span></span>, <span class="hljs-string"><span class="hljs-string">'cap_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'bruises'</span></span>, <span class="hljs-string"><span class="hljs-string">'odor'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_attachment'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_spacing'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_size'</span></span>, <span class="hljs-string"><span class="hljs-string">'gill_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_shape'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_root'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_surface_above_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_surface_below_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_color_above_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'stalk_color_below_ring'</span></span>, <span class="hljs-string"><span class="hljs-string">'veil_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'veil_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'ring_number'</span></span>, <span class="hljs-string"><span class="hljs-string">'ring_type'</span></span>, <span class="hljs-string"><span class="hljs-string">'spore_print_color'</span></span>, <span class="hljs-string"><span class="hljs-string">'population'</span></span>, <span class="hljs-string"><span class="hljs-string">'habitat'</span></span>] df = pd.read_csv(data_file_name, sep=<span class="hljs-string"><span class="hljs-string">','</span></span>, names=header)</code> </pre> <br> ç°åœ¨ï¼Œæ‚¨éœ€è¦å¤„ç†ä¸¢å¤±çš„æ•°æ®ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨agaricus-lepiota.dataæ–‡ä»¶ä¸­è®¾ç½®ç¬¦å·â€œï¼Ÿâ€è€Œä¸æ˜¯å‚æ•°ã€‚ æœ‰è®¸å¤šæ–¹æ³•å¯ä»¥å¤„ç†è¿™ç§æƒ…å†µï¼Œä½†æ˜¯æˆ‘ä»¬å°†åˆ é™¤è‡³å°‘åŒ…å«ä¸€ä¸ªç¼ºå¤±å‚æ•°çš„æ•´è¡Œã€‚ <br><br><pre> <code class="python hljs">df.replace(<span class="hljs-string"><span class="hljs-string">'?'</span></span>, np.nan, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br> æ¥ä¸‹æ¥ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨æ•°å­—æ•°å­—æ‰‹åŠ¨æ›¿æ¢ç¬¦å·å¯ç¼–è¾‘æ€§å‚æ•°ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå°†â€œ pâ€å’Œâ€œ eâ€æ›¿æ¢ä¸º0å’Œ1ã€‚ <br><br><pre> <code class="python hljs">df[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'p'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) df[<span class="hljs-string"><span class="hljs-string">'class'</span></span>].replace(<span class="hljs-string"><span class="hljs-string">'e'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br> ç„¶åï¼Œæ‚¨å¯ä»¥å°†å…¶ä½™æ•°æ®è½¬æ¢ä¸ºæ•°å­—ã€‚ è¿™å°±æ˜¯ç†ŠçŒ«åº“çš„get_dummieså‡½æ•°æ‰€åšçš„ã€‚ <br><br><pre> <code class="python hljs">cols_to_transform = header[<span class="hljs-number"><span class="hljs-number">1</span></span>:] df = pd.get_dummies(df, columns=cols_to_transform)</code> </pre> <br> ä»»ä½•ç¥ç»ç½‘ç»œéƒ½éœ€è¦è®­ç»ƒã€‚ ä½†æ˜¯é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜éœ€è¦å¯¹å…¶è¿›è¡Œæ ¡å‡†ï¼Œä»¥æé«˜å®é™…æ¡ä»¶ä¸‹çš„å·¥ä½œç²¾åº¦ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†æ•°æ®é›†åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šè®­ç»ƒå’Œæ ¡å‡†ã€‚ ç¬¬ä¸€ä¸ªåº”è¯¥å¤§äºç¬¬äºŒä¸ªã€‚ <br><br><pre> <code class="python hljs">df_train, df_test = train_test_split(df, test_size=<span class="hljs-number"><span class="hljs-number">0.1</span></span>)</code> </pre> <br> è¿˜æœ‰æœ€åä¸€ä¸ªã€‚  Tensor Flowè¦æ±‚åœ¨æ•°æ®æ–‡ä»¶çš„å¼€å¤´æŒ‡ç¤ºæ–‡ä»¶çš„è¡Œæ•°å’Œåˆ—æ•°ã€‚ æˆ‘ä»¬å°†ä»è®­ç»ƒå’Œæ ¡å‡†æ•°æ®é›†ä¸­æ‰‹åŠ¨æå–æ­¤ä¿¡æ¯ï¼Œç„¶åå†™å…¥ç”Ÿæˆçš„CSVæ–‡ä»¶ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#         num_train_entries = df_train.shape[0] num_train_features = df_train.shape[1] - 1 num_test_entries = df_test.shape[0] num_test_features = df_test.shape[1] - 1 #     CSV df_train.to_csv('train_temp.csv', index=False) df_test.to_csv('test_temp.csv', index=False) #       CSV,      open("mushroom_train.csv", "w").write(str(num_train_entries) + "," + str(num_train_features) + "," + open("train_temp.csv").read()) open("mushroom_test.csv", "w").write(str(num_test_entries) + "," + str(num_test_features) + "," + open("test_temp.csv").read())</span></span></code> </pre> <br> æœ€åï¼Œæ‚¨åº”è¯¥è·å¾—ä»¥ä¸‹æ–‡ä»¶ï¼š <a href="">åŸ¹è®­</a>å’Œ<a href="">æ ¡å‡†</a> ã€‚ <br><br><h3> å°†ç”Ÿæˆçš„æ•°æ®æ”¾å…¥Tensor Flow </h3><br> ç°åœ¨æˆ‘ä»¬å·²ç»ä»å­˜å‚¨åº“ä¸‹è½½å¹¶ä½¿ç”¨è˜‘è‡æ•°æ®å¤„ç†äº†CSVæ–‡ä»¶ï¼Œæ‚¨å¯ä»¥å°†å®ƒä»¬å‘é€åˆ°Tensor Flowè¿›è¡ŒåŸ¹è®­ã€‚ è¿™æ˜¯ä½¿ç”¨æ¡†æ¶æœ¬èº«æä¾›çš„load_csv_with_headerï¼ˆï¼‰å‡½æ•°å®Œæˆçš„ï¼š <br><br><pre> <code class="python hljs">training_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=<span class="hljs-string"><span class="hljs-string">'mushroom_train.csv'</span></span>, target_dtype=np.int, features_dtype=np.int, target_column=<span class="hljs-number"><span class="hljs-number">0</span></span>) test_set = tf.contrib.learn.datasets.base.load_csv_with_header( filename=<span class="hljs-string"><span class="hljs-string">'mushroom_test.csv'</span></span>, target_dtype=np.int, features_dtype=np.int, target_column=<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br>  load_csv_with_headerï¼ˆï¼‰å‡½æ•°ç”¨äºä»ä¸Šé¢æ”¶é›†çš„æ–‡ä»¶ä¸­å½¢æˆè®­ç»ƒæ•°æ®é›†ã€‚ é™¤äº†æ•°æ®æ–‡ä»¶å¤–ï¼Œè¯¥å‡½æ•°è¿˜å°†target_dtypeä½œä¸ºå‚æ•°ï¼Œè¿™æ˜¯æœ€åé¢„æµ‹çš„æ•°æ®ç±»å‹ã€‚ åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œæœ‰å¿…è¦è®²æˆç¥ç»ç½‘ç»œæ¥é¢„æµ‹çœŸèŒçš„å¯é£Ÿç”¨æ€§æˆ–æ¯’æ€§ï¼Œå¯ä»¥ç”¨å€¼1æˆ–0è¡¨ç¤ºã€‚å› æ­¤ï¼Œåœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œtarget_dtypeæ˜¯æ•´æ•°å€¼ã€‚  features_dtype-è®¾ç½®æ¥å—è®­ç»ƒçš„å‚æ•°ç±»å‹çš„å‚æ•°ã€‚ åœ¨æˆ‘ä»¬çš„ä¾‹å­ä¸­ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ä¸ªæ•´æ•°ï¼ˆæœ€åˆå®ƒä»¬æ˜¯å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ï¼Œå¦‚æ‚¨æ‰€è®°å¾—ï¼Œæˆ‘ä»¬å°†å®ƒä»¬æ”¹å†™ä¸ºæ•°å­—ï¼‰ã€‚ æœ€åï¼Œè®¾ç½®äº†target_columnå‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯å…·æœ‰ç¥ç»ç½‘ç»œè¦é¢„æµ‹çš„å‚æ•°çš„åˆ—çš„ç´¢å¼•ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œå¸¦æœ‰edibilityå‚æ•°ã€‚ <br><br><h3> åˆ›å»ºä¸€ä¸ªTensor Flowåˆ†ç±»å™¨å¯¹è±¡ </h3><br> å³ï¼Œç›´æ¥å‚ä¸é¢„æµ‹ç»“æœçš„ç±»çš„å¯¹è±¡ã€‚ æ¢å¥è¯è¯´ï¼Œç¥ç»ç½‘ç»œæœ¬èº«çš„ç±»åˆ«ã€‚ <br><br><pre> <code class="python hljs">feature_columns = [tf.contrib.layers.real_valued_column(<span class="hljs-string"><span class="hljs-string">""</span></span>, dimension=<span class="hljs-number"><span class="hljs-number">98</span></span>)] classifier = tf.contrib.learn.DNNClassifier( feature_columns=feature_columns, hidden_units=[<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>], n_classes=<span class="hljs-number"><span class="hljs-number">2</span></span>, model_dir=<span class="hljs-string"><span class="hljs-string">"/tmp/mushroom_model"</span></span>)</code> </pre> <br> ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯feature_columnsã€‚ è¿™äº›æ˜¯è˜‘è‡çš„å‚æ•°ã€‚ è¯·æ³¨æ„ï¼Œå‚æ•°å€¼æ˜¯åœ¨æ­¤å¤„åˆ›å»ºçš„ï¼Œç¨é«˜ä¸€äº›ã€‚ åœ¨é‚£é‡Œï¼Œåœ¨è¾“å…¥å¤„è·å–äº†ç»´åº¦å‚æ•°çš„å€¼98ï¼Œè¿™æ„å‘³ç€è˜‘è‡çš„98ä¸ªä¸åŒå‚æ•°ï¼ˆå¯é£Ÿæ€§é™¤å¤–ï¼‰ã€‚ <br><br>  hidden_â€‹â€‹units-ç¥ç»ç½‘ç»œæ¯ä¸€å±‚ä¸­çš„ç¥ç»å…ƒæ•°é‡ã€‚ åœ¨æœºå™¨å­¦ä¹ é¢†åŸŸä¸­ï¼Œæ­£ç¡®é€‰æ‹©å±‚å’Œç¥ç»å…ƒçš„æ•°é‡æ˜¯ä¸€é¡¹æŠ€æœ¯æ°´å¹³çš„å·¥ä½œã€‚ ä»…åœ¨ç»å†åæ‰å¯èƒ½æ­£ç¡®ç¡®å®šè¿™äº›å€¼ã€‚ æˆ‘ä»¬é‡‡ç”¨è¿™äº›æ•°å­—åªæ˜¯å› ä¸ºå®ƒä»¬åœ¨Tensor Flowæ•™ç¨‹ä¹‹ä¸€ä¸­åˆ—å‡ºã€‚ ä»–ä»¬å·¥ä½œã€‚ <br><br>  n_classes-è¦é¢„æµ‹çš„ç±»æ•°ã€‚ æˆ‘ä»¬æœ‰ä¸¤ä¸ª-å¯é£Ÿç”¨å’Œä¸å¯é£Ÿç”¨ã€‚ <br><br>  model_dir-å°†ä¿å­˜ç¥ç»ç½‘ç»œçš„è®­ç»ƒæ¨¡å‹çš„è·¯å¾„ã€‚ å¹¶ä¸”å°†æ¥å®ƒå°†ç”¨äºé¢„æµ‹ç»“æœï¼Œä»¥å…æ¯æ¬¡éƒ½è®­ç»ƒç½‘ç»œã€‚ <br><br><h3> åŸ¹è®­è¯¾ç¨‹ </h3><br> ä¸ºäº†å°†æ¥çš„å·¥ä½œç®€ä¾¿ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªå‡½æ•°ï¼š <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_test_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> x = tf.constant(test_set.data) y = tf.constant(test_set.target) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x, y <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_train_inputs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> x = tf.constant(training_set.data) y = tf.constant(training_set.target) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> x, y</code> </pre> <br> æ¯ä¸ªåŠŸèƒ½éƒ½æä¾›è‡ªå·±çš„ä¸€ç»„è¾“å…¥æ•°æ®-ç”¨äºè®­ç»ƒå’Œæ ¡å‡†ã€‚  xå’Œyæ˜¯æ¡†æ¶éœ€è¦å·¥ä½œçš„Tensor Flowå¸¸æ•°ã€‚ ä¸è¦èµ˜è¿°ï¼Œåªæ˜¯æ¥å—è¿™äº›åŠŸèƒ½åº”è¯¥æ˜¯æ•°æ®å’Œç¥ç»ç½‘ç»œä¹‹é—´çš„ä¸­ä»‹ã€‚ <br><br> æˆ‘ä»¬è®­ç»ƒä¸€ä¸ªç½‘ç»œï¼š <br><br><pre> <code class="python hljs">classifier.fit(input_fn=get_train_inputs, steps=<span class="hljs-number"><span class="hljs-number">2000</span></span>)</code> </pre> <br> ç¬¬ä¸€ä¸ªå‚æ•°é‡‡ç”¨åˆšåˆšå½¢æˆçš„è¾“å…¥æ•°æ®ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºè®­ç»ƒæ­¥éª¤çš„æ•°é‡ã€‚ åŒæ ·ï¼Œè¯¥æ•°å­—å·²åœ¨Tensor Flowæ‰‹å†Œä¹‹ä¸€ä¸­ä½¿ç”¨ï¼Œå¹¶ä¸”æ‚¨ä¼šç»éªŒä¸°å¯Œåœ°äº†è§£æ­¤è®¾ç½®ã€‚ <br><br> æ¥ä¸‹æ¥ï¼Œæ ¡å‡†ç»è¿‡è®­ç»ƒçš„ç½‘ç»œã€‚ è¿™æ˜¯ä½¿ç”¨ä¸Šé¢ç”Ÿæˆçš„æ ¡å‡†æ•°æ®é›†å®Œæˆçš„ã€‚ å·¥ä½œçš„ç»“æœå°†æ˜¯æœªæ¥ç½‘ç»œé¢„æµ‹çš„å‡†ç¡®æ€§ï¼ˆaccuracy_scoreï¼‰ã€‚ <br><br><pre> <code class="python hljs">accuracy_score = classifier.evaluate(input_fn=get_test_inputs, steps=<span class="hljs-number"><span class="hljs-number">1</span></span>)[<span class="hljs-string"><span class="hljs-string">"accuracy"</span></span>] print(<span class="hljs-string"><span class="hljs-string">"\n : {0:f}\n"</span></span>.format(accuracy_score))</code> </pre> <br><h3> æˆ‘ä»¬å°†åœ¨ </h3><br> ç°åœ¨ç¥ç»ç½‘ç»œå·²ç»å‡†å¤‡å°±ç»ªï¼Œæ‚¨å¯ä»¥å°è¯•å€ŸåŠ©å…¶é¢„æµ‹çœŸèŒçš„å¯é£Ÿç”¨æ€§ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">new_samples</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.array([[<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]], dtype=np.int)</code> </pre> <br> ä¸Šé¢çš„å‡½æ•°æä¾›äº†ä¸¤ä¸ªå…¨æ–°çš„è˜‘è‡çš„æ•°æ®ï¼Œè¿™äº›è˜‘è‡æ—¢ä¸åœ¨è®­ç»ƒä¸­ä¹Ÿä¸åœ¨æ ¡å‡†é›†ä¸­ï¼ˆå®é™…ä¸Šï¼Œå®ƒä»¬åªæ˜¯ä»åè€…ä¸­æå–çš„ï¼‰ã€‚ ä¾‹å¦‚ï¼Œæƒ³è±¡ä¸€ä¸‹ï¼Œæ‚¨åœ¨å¸‚åœºä¸Šè´­ä¹°äº†å®ƒä»¬ï¼Œå¹¶è¯•å›¾äº†è§£å®ƒä»¬æ˜¯å¦å¯ä»¥é£Ÿç”¨ã€‚ ä¸‹é¢çš„ä»£ç å°†å¯¹æ­¤è¿›è¡Œå®šä¹‰ï¼š <br><br><pre> <code class="python hljs">predictions = list(classifier.predict(input_fn=new_samples)) print(<span class="hljs-string"><span class="hljs-string">"   : {}\n"</span></span> .format(predictions))</code> </pre> <br> å·¥ä½œçš„ç»“æœåº”ä¸ºï¼š <br><br><pre> <code class="python hljs">   : [<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>]</code> </pre> <br> è¿™æ„å‘³ç€ç¬¬ä¸€ä¸ªè˜‘è‡æœ‰æ¯’ï¼Œç¬¬äºŒä¸ªå®Œå…¨é£Ÿç”¨ã€‚ å› æ­¤ï¼Œæ‚¨å¯ä»¥æ ¹æ®ä»»ä½•æ•°æ®åšå‡ºé¢„æµ‹ï¼Œæ— è®ºæ˜¯è˜‘è‡ï¼Œäººï¼ŒåŠ¨ç‰©è¿˜æ˜¯å…¶ä»–ä»»ä½•ä¸œè¥¿ã€‚ è¶³ä»¥æ­£ç¡®å½¢æˆè¾“å…¥æ•°æ®ã€‚ å¹¶ä¾‹å¦‚é¢„æµ‹æ‚£è€…å°†æ¥å‘ç”Ÿå¿ƒå¾‹å¤±å¸¸çš„å¯èƒ½æ€§æˆ–è¯åˆ¸äº¤æ˜“æ‰€çš„è‚¡ä»·èµ°åŠ¿ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN419917/">https://habr.com/ru/post/zh-CN419917/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN419905/index.html">è‹±å›½å‘å°„ä¸šå”¤é†’å¹¶è®¾å®šç›®æ ‡-åœ¨ã€Šé»‘ç®­ã€‹è¯ç”ŸåŠä¸ªä¸–çºªä¹‹å</a></li>
<li><a href="../zh-CN419907/index.html">æ‰‹æœºæ¸¸æˆå‘å¸ƒæç¤ºï¼šç¬¬2éƒ¨åˆ†ï¼Œå…¨çƒå‘å¸ƒ</a></li>
<li><a href="../zh-CN419911/index.html">ä½¿ç”¨Pythonå»ºç«‹å¤©ä½“çš„è½¨é“</a></li>
<li><a href="../zh-CN419913/index.html">å®œå®¶å’Œæ™ºèƒ½å®¶å±…ã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN419915/index.html">initramfsä¸­çš„ç»‘å®šå’ŒSSHæœåŠ¡å™¨</a></li>
<li><a href="../zh-CN419919/index.html">SQL Serverä¸­çš„ç‰ˆæœ¬æ§åˆ¶</a></li>
<li><a href="../zh-CN419921/index.html">å¦‚ä½•æ¯ç§’ä¸¢å¼ƒ1000ä¸‡ä¸ªæ•°æ®åŒ…</a></li>
<li><a href="../zh-CN419923/index.html">æˆ‘çš„ä¸´æ—¶å·¥ä½œï¼Œä¸»æ¿æ‰‹è¡¨</a></li>
<li><a href="../zh-CN419925/index.html">ä½¿ç”¨GitHub Gistå¯¹å•ä¸ªæ–‡ä»¶è¿›è¡Œç‰ˆæœ¬æ§åˆ¶</a></li>
<li><a href="../zh-CN419927/index.html">[DotNetBook]ä¾‹å¤–ï¼šç±»å‹ç³»ç»Ÿä½“ç³»ç»“æ„</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>