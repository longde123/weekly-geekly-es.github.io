<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üÜì üë®‚Äçüë©‚Äçüëß‚Äçüëß ‚ÅâÔ∏è Telefoniert! So bauen Sie Ihren Web-Dialer in einer Stunde zusammen üï∫üèø üåà ü§∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Freunde, heute m√∂chte ich mit Ihnen √ºber Anrufe sprechen. F√ºr einige ist dies ein v√∂llig neues Thema. F√ºr andere ist es purer Fan-Spa√ü auf der Ebene "...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Telefoniert! So bauen Sie Ihren Web-Dialer in einer Stunde zusammen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/2gis/blog/448266/"><img src="https://habrastorage.org/webt/li/yz/m7/liyzm7mhhxjuc1oeyzofjmqmob8.jpeg"><br><br><p>  Freunde, heute m√∂chte ich mit Ihnen √ºber Anrufe sprechen.  F√ºr einige ist dies ein v√∂llig neues Thema.  F√ºr andere ist es purer Fan-Spa√ü auf der Ebene "Aber soll ich mir mein Skype schicken?"  Zum dritten ein pl√∂tzliches Lebensbed√ºrfnis.  Die letzte Option ist unsere Option. </p><br><p>  In diesem Artikel zeige ich Ihnen ein kleines, aber sehr praktikables Implementierungsbeispiel, mit dem Sie buchst√§blich Ihren eigenen WEB-Dialer erstellen und einen Freund direkt aus dem Browser buchst√§blich auf dem Knie mehrerer zehn Javascript-Zeilen anrufen k√∂nnen. </p><a name="habracut"></a><br><h3 id="pro-tehnologii-i-protokoly">  √úber Technologien und Protokolle </h3><br><img src="https://habrastorage.org/webt/8w/sw/sh/8wswshoy0tsia7gpl51lynbu7-c.png"><br><br><p>  Es ist 2019, und zu unserer Freude gibt es bereits ein vorgefertigtes Tool f√ºr die Implementierung von Real Time Communication (RTC) f√ºr das Web, n√§mlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WebRTC</a> .  Vor einigen Jahren war er in der aktiven Entwicklung.  Die API wird noch finalisiert, aber die Technologie ist zum De-facto-Standard geworden und wird in den meisten g√§ngigen Browsern unterst√ºtzt.  In diesem Artikel werden wir uns nicht mit der Technologie selbst befassen. Sie k√∂nnen mehr auf der Entwickler-Website lesen oder nach Artikeln im Hub suchen  Zum Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . </p><br><p>  Aber bevor wir beginnen, m√∂chte ich einige Punkte klarstellen. </p><br><ol><li>  Erstens l√§uft WebRTC auf einem B√ºndel von Protokollen, und selbst f√ºr die P2P-Kommunikation ben√∂tigen Sie eine Art Server, √ºber den Ihre Kunden Freunde finden und sich mit ihnen anfreunden k√∂nnen.  In unserem Beispiel wird das SIP-Protokoll verwendet, √ºber das Sie beispielsweise hier mehr lesen k√∂nnen. </li><li>  Sie ben√∂tigen einen Server mit Unterst√ºtzung f√ºr alle oben genannten Dinge - wie FreeSwitch oder Asterisk. </li></ol><br><p>  Wir lassen diese Dinge au√üerhalb des Geltungsbereichs des Artikels.  Wir gehen davon aus, dass Sie genauso viel Gl√ºck haben wie wir und dass Sie bereits VoIP-Telefonie konfiguriert haben. </p><br><p>  Nun, der l√§ngste Teil des Artikels ist dahinter, lasst uns codieren! </p><br><h3 id="verstaem-stranichku">  Seitenlayout </h3><br><img src="https://habrastorage.org/webt/55/zn/km/55znkm3wc6qbka1zce5iskukjbg.png"><br><br><p>  Zuerst ben√∂tigen wir eine Seite, mit der wir anrufen, Felder zur Eingabe eines Benutzernamens, eines Passworts, einer Telefonnummer und einige Schaltfl√§chen.  In der einfachsten Version sieht es ungef√§hr so ‚Äã‚Äãaus: </p><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group mb-6"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group-prepend"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group-text"</span></span></span><span class="hljs-tag">&gt;</span></span>Login<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"loginText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form-control"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group-prepend"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group-text"</span></span></span><span class="hljs-tag">&gt;</span></span>Password<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"passwordText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"password"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form-control"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"loginButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-primary"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"login()"</span></span></span><span class="hljs-tag">&gt;</span></span>Login<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logOutButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-primary d-none"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"logout()"</span></span></span><span class="hljs-tag">&gt;</span></span>LogOut<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"input-group mb-6 d-none"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"callPanel"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"callNumberText"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"form-control"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Call number"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"callNumberButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-success"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"call()"</span></span></span><span class="hljs-tag">&gt;</span></span>Call<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hangUpButton"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btn btn-danger d-none"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hangUp()"</span></span></span><span class="hljs-tag">&gt;</span></span>Hang Up<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">audio</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"localAudio"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autoPlay</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">muted</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">audio</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">audio</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"remoteAudio"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autoPlay</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">audio</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">audio</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sounds"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">autoPlay</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">audio</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Audioelemente ‚Äûsenden‚Äú und ‚Äûempfangen‚Äú Sound und spielen f√ºr die Sch√∂nheit durch Sounds DF√ú-Sounds ab. </p><br><p>  Die Benutzeroberfl√§che ist bereit. Sie k√∂nnen UX nicht bem√§ngeln. Lassen Sie es funktionieren. </p><br><h3 id="prikruchivaem-jssip">  Wir befestigen JSSIP </h3><br><img src="https://habrastorage.org/webt/uj/im/ma/ujimma62qvgawzhngknhm337rze.png"><br><br><p>  Wir werden eine Bibliothek verwenden, in der alles, was ben√∂tigt wird, bereits implementiert ist - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">JSSIP</a> .  Sie k√∂nnen sich die Dokumentation ansehen: Dort wird alles ausreichend detailliert beschrieben und es gibt sogar ein fertiges Implementierungsbeispiel.  Das hei√üt, wir m√ºssen praktisch nichts tun - vereinfachen Sie einfach alles so weit wie m√∂glich und finden Sie heraus, was was ist. </p><br><p>  Nach Eingabe des Logins / Passworts (muss auf Ihrem Telefonieserver registriert sein) m√ºssen Sie sich beim Server anmelden.  Wir machen das: </p><br><pre> <code class="javascript hljs">socket = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JsSIP.WebSocketInterface(<span class="hljs-string"><span class="hljs-string">"wss://webrtcserver:port/ws"</span></span>); _ua = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JsSIP.UA( { <span class="hljs-attr"><span class="hljs-attr">uri</span></span>: <span class="hljs-string"><span class="hljs-string">"sip:"</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginText.val() + <span class="hljs-string"><span class="hljs-string">"@webrtcserver"</span></span>, <span class="hljs-attr"><span class="hljs-attr">password</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.passwordText.val(), <span class="hljs-attr"><span class="hljs-attr">display_name</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginText.val(), <span class="hljs-attr"><span class="hljs-attr">sockets</span></span>: [socket] });</code> </pre> <br><p>  Unterwegs k√∂nnen Sie die verbindenden und verbundenen Ereignisse abonnieren und dort etwas N√ºtzliches tun.  Aber gehen wir weiter zum Registrierungsereignis: </p><br><pre> <code class="javascript hljs">his._ua.on(<span class="hljs-string"><span class="hljs-string">'registered'</span></span>, () =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">"UA registered"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginButton.addClass(<span class="hljs-string"><span class="hljs-string">'d-none'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.logOutButton.removeClass(<span class="hljs-string"><span class="hljs-string">'d-none'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.loginText.prop(<span class="hljs-string"><span class="hljs-string">'disabled'</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.passwordText.prop(<span class="hljs-string"><span class="hljs-string">'disabled'</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>); $(<span class="hljs-string"><span class="hljs-string">"#callPanel"</span></span>).removeClass(<span class="hljs-string"><span class="hljs-string">'d-none'</span></span>); });</code> </pre> <br><p>  Hier m√ºssen wir nur den Status der Schaltfl√§chen √§ndern: Zeigen Sie das Notwendige an, verstecken Sie das Unn√∂tige.  Und wenn beim Anmelden pl√∂tzlich etwas schief gelaufen ist, haben wir den Fehler im Protokoll ausgespuckt: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._ua.on(<span class="hljs-string"><span class="hljs-string">'registrationFailed'</span></span>, (data) =&gt; { <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.error(<span class="hljs-string"><span class="hljs-string">"UA registrationFailed"</span></span>, data.cause); });</code> </pre> <br><p>  Dies reicht f√ºr die Anmeldung.  Es bleibt die Fassorgel mit zu bekommen <br>  this._ua.start (); </p><br><p>  Wenn der Server korrekt angegeben ist und Ihr Benutzername / Passwort akzeptiert wird, werden ein Feld zur Eingabe des Telefons und die Schaltfl√§che Anrufen angezeigt. </p><br><p>  F√ºr die Protokollierung m√ºssen Sie this._ua.stop () aufrufen, alles ist einfach. </p><br><h3 id="delaem-zvonok">  Rufen Sie an </h3><br><p>  Jetzt - das Wichtigste: Sie m√ºssen die eingegebene Nummer anrufen. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.session = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._ua.call(number, { <span class="hljs-attr"><span class="hljs-attr">pcConfig</span></span>: { <span class="hljs-attr"><span class="hljs-attr">hackStripTcp</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-comment"><span class="hljs-comment">//   ,       rtcpMuxPolicy: 'negotiate', //   ,   multiplexing.       . iceServers: [] }, mediaConstraints: { audio: true, //    video: false }, rtcOfferConstraints: { offerToReceiveAudio: 1, //    offerToReceiveVideo: 0 } });</span></span></code> </pre> <br><p>  Bitte beachten Sie: Wir aktivieren explizit das Multiplexen. Diese Einstellung muss auch auf Ihrem Server aktiviert sein.  Im Fall eines Sternchens ist dies in den Einstellungen von sip.conf rtcp_mux = yes. </p><br><p>  Die weitere Interaktion basiert auf R√ºckrufen, bei denen wir die Richtung des Audio-Video-Streams zum entsprechenden Seitenelement sicherstellen und die erforderlichen Nachrichten in der richtigen Reihenfolge an den Server senden m√ºssen. </p><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//    this.session.on('progress', () =&gt; { console.log("UA session progress"); playSound("ringback.ogg", true); }); //      this.session.on('connecting', () =&gt; { console.log("UA session connecting"); playSound("ringback.ogg", true); //          ,     let peerconnection = this.session.connection; let localStream = peerconnection.getLocalStreams()[0]; // Handle local stream if (localStream) { // Clone local stream this._localClonedStream = localStream.clone(); console.log('UA set local stream'); let localAudioControl = document.getElementById("localAudio"); localAudioControl.srcObject = this._localClonedStream; } //       ,        peerconnection.addEventListener('addstream', (event) =&gt; { console.log("UA session addstream"); let remoteAudioControl = document.getElementById("remoteAudio"); remoteAudioControl.srcObject = event.stream; }); }); //   , ,    this.session.on('failed', (data) =&gt; { console.log("UA session failed"); stopSound("ringback.ogg"); playSound("rejected.mp3", false); this.callButton.removeClass('d-none'); this.hangUpButton.addClass('d-none'); }); // ,  this.session.on('ended', () =&gt; { console.log("UA session ended"); playSound("rejected.mp3", false); JsSIP.Utils.closeMediaStream(this._localClonedStream); this.callButton.removeClass('d-none'); this.hangUpButton.addClass('d-none'); }); //  ,    this.session.on('accepted', () =&gt; { console.log("UA session accepted"); stopSound("ringback.ogg"); playSound("answered.mp3", false); });</span></span></code> </pre> <br><p>  Im Allgemeinen ist alles ziemlich logisch.  W√§hrend des W√§hlens ['Fortschritt'] - spielen Sie die W√§hlger√§usche ab.  In unserem Beispiel spielen wir unseren eigenen Sound, aber wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link">pvsur zu</a> Recht bemerkte, k√∂nnen Sie ihn auch von der angerufenen Seite abrufen und die Antwort des Autoinformers wie "Hinterlassen Sie eine Nachricht nach dem Piepton" h√∂ren, falls es einen gibt. <br>  Sobald ich durch ['akzeptiert'] gekommen bin - spielen Sie den Ton beantwortet.  Sobald der Teilnehmer den H√∂rer abhebt, erhalten wir seinen Sound-Stream und legen ihn in das Element remoteAudio ['verbinden' und 'addstream']. <br>  F√ºhren Sie am Ende des Anrufs closeMediaStream aus.  Sie k√∂nnen sich entspannen. </p><br><h3 id="nemnogo-pro-ekspluataciyu">  Ein bisschen √ºber die Bedienung </h3><br><p>  Beim Testen wurden zwei Dinge entdeckt. </p><br><ol><li>  In Chrom gab es zu Beginn des W√§hlens eine Verz√∂gerung von mehreren Sekunden, was sehr √§rgerlich war.  Wir haben aus den Protokollen herausgefunden, dass er zum Eisserver gegangen ist, was √ºberhaupt nicht erforderlich war, da wir unseren eigenen Server haben.  Daher haben wir sie in der Konfiguration f√ºr JSSIP einfach entfernt und sind sofort h√ºbscher geworden.  Siehe pcConfig.iceServers und pcConfig.hackStripTcp. </li><li>  Unser Stern hat ein WSS-Protokoll mit Verschl√ºsselung f√ºr SIP.  Dies wird vom Browser bei Verwendung der HTTPS-Website ben√∂tigt.  Das Sternchen verwendet jedoch WS basierend auf den Kontaktparametern, in denen die JSSIP-Bibliothek einen fest codierten WS-Deskriptor enth√§lt.  Die Entwickler der Bibliothek verweisen gleichzeitig auf Standards, in denen zu diesem Thema wirklich keine Anforderungen bestehen.  Und Kollegen von der Aster wollen beharrlich nichts reparieren.  Im Allgemeinen eine Sackgasse.  Nun, zu diesem Zeitpunkt finden wir in der Quelle die Zeile this._configuration.contact_uri = new URI (...), √§ndern Sie transport: 'ws' in transport: 'wss' und genie√üen Sie weiterhin das Leben. </li></ol><br><p>  Im Allgemeinen ist das Beispiel fertig, Sie k√∂nnen es annehmen und anrufen.  Sie m√ºssen keine Softphones verwenden oder eigene entwickeln.  Sie m√ºssen sich keine Gedanken √ºber die Bereitstellung dieser Software f√ºr Kundenautos machen.  √ñffnen Sie einfach den Browser und rufen Sie an. </p><br><p>  In einer anderen Bibliothek k√∂nnen Sie im Tonmodus zus√§tzliche Nummern w√§hlen.  Das hei√üt, Sie k√∂nnen beispielsweise das Callcenter der Bank anrufen und zum gew√ºnschten Element im Sprachmen√º gelangen.  F√ºhren Sie dazu einfach den folgenden Befehl aus: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._call.sendDTMF(<span class="hljs-string"><span class="hljs-string">'. '</span></span>)</code> </pre> <br><h3 id="pro-fakapy">  √úber Fakapy </h3><br><img src="https://habrastorage.org/webt/kv/_l/sa/kv_lsarz4y173fa0ojus_vx_26q.png"><br><br><p>  Es gab mehrere Punkte, die mich wirklich nerv√∂s machten. </p><br><p>  Ich habe diesen Teil au√üerhalb des Geltungsbereichs des Artikels belassen, aber zus√§tzlich zu ausgehenden Anrufen mussten wir auch eingehende Anrufe annehmen.  Und f√ºr einige Zeit musste ich mich mit einem eingehenden Anruf hocken, der kam und dann abbrach.  Alles wurde durch die oben erw√§hnte Einstellung rtcpMuxPolicy entschieden, die das Multiplexen auf dem Sternchen erm√∂glichte, aber wir waren einige Zeit dumm. </p><br><p>  Und es gibt immer noch Probleme, sich selbst zu w√§hlen - wenn ein Anruf und ein Anruf auf demselben Computer get√§tigt werden.  Ich erinnere mich nicht genau, aber die Verbindung wurde erfolgreich hergestellt, es gab keine Fehler und auch keinen Ton :) Die Zeit lief ab, also haben wir diesen Spezialeffekt erzielt.  Beachten Sie jedoch, dass das Testen eingehender Anrufe in einem separaten Auto besser ist. </p><br><h3 id="zaklyuchenie">  Fazit </h3><br><p>  Abschlie√üend m√∂chte ich darauf hinweisen, dass wir das JSSIP + Asterisk-Bundle in unserem Callcenter getestet haben. Alles funktioniert einwandfrei, zumindest in Chrom, was uns vollkommen zusagt.  Die Hauptsache ist, dem Browser den Zugriff auf Medienger√§te zu erm√∂glichen und Benutzer auf dem Dialer-Server zu registrieren. </p><br><p>  Sie k√∂nnen das fertige Beispiel auf dem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github sehen</a> . </p><br><h3 id="poleznye-ssylki">  N√ºtzliche Links </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úber webrct</a> <br>  √úber SIP: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">tyts</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">tyts</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">√úber Asterisk</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Jssip-Bibliothek</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de448266/">https://habr.com/ru/post/de448266/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de448254/index.html">IPhone ist nicht das erste Apple-Handy</a></li>
<li><a href="../de448258/index.html">Advantech FPM-7002 Modulare Industriemonitore</a></li>
<li><a href="../de448260/index.html">Konfigurieren Sie Visual Studio in Ihrer Organisation mit .vsconfig</a></li>
<li><a href="../de448262/index.html">Wie man Speedgate spielt, die erste Sportart, die von AI entwickelt wurde</a></li>
<li><a href="../de448264/index.html">Lipid kalt nichts: Verhindert die Kristallisation von Wasser bei -263 ¬∞ C.</a></li>
<li><a href="../de448268/index.html">Boxed Telephone Systems</a></li>
<li><a href="../de448270/index.html">√Ñndern Sie die Programmeinstellungen, w√§hrend Sie die pers√∂nlichen Einstellungen beibehalten</a></li>
<li><a href="../de448272/index.html">Warum das Flugzeug vor dem Abflug speziell √ºbergossen und was passiert, wenn dies nicht getan wird?</a></li>
<li><a href="../de448274/index.html">SMS-√úberwachung des Gewichts von drei Bienenst√∂cken f√ºr 35 US-Dollar</a></li>
<li><a href="../de448276/index.html">Wie die Alfa Bank in einer Zeit des Wandels lebt und was wir durch die Kombination von IT-Entwicklung und Alfa Lab geschafft haben</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>