<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⤴️ 🥕 👩🏾‍🤝‍👨🏻 Vue.js: 3 Anti-Patterns 🥧 🏼 📍</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Vue.js ist wahrscheinlich eines der schönsten JavaScript-Frameworks. Es verfügt über eine intuitive API, ist schnell, flexibel und einfach zu bedienen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vue.js: 3 Anti-Patterns</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/463327/">  Vue.js ist wahrscheinlich eines der schönsten JavaScript-Frameworks.  Es verfügt über eine intuitive API, ist schnell, flexibel und einfach zu bedienen.  Die Flexibilität von Vue.js birgt jedoch gewisse Gefahren.  Einige Entwickler, die mit diesem Framework arbeiten, neigen zu kleinen Versehen.  Dies kann sich nachteilig auf die Anwendungsleistung oder auf lange Sicht auf die Fähigkeit auswirken, diese zu unterstützen. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/webt/mt/rp/bs/mtrpbsevaksphoeiwzgs4efaqkg.jpeg"></a> <br><br>  Der Autor des Materials, dessen Übersetzung wir heute veröffentlichen, bietet an, einige häufige Fehler zu analysieren, die von denjenigen gemacht wurden, die Anwendungen auf Vue.js entwickeln. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">Nebenwirkungen innerhalb berechneter Eigenschaften</font> </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Berechnete Eigenschaften</a> sind ein sehr praktischer Vue.js-Mechanismus, mit dem Sie die Arbeit mit Statusfragmenten organisieren können, die von anderen Statusfragmenten abhängen.  Berechnete Eigenschaften sollten nur verwendet werden, um Daten anzuzeigen, die in einem Zustand gespeichert sind, der von anderen Daten aus dem Zustand abhängt.  Wenn sich herausstellt, dass Sie einige Methoden innerhalb der berechneten Eigenschaften aufrufen oder einige Werte in andere Statusvariablen schreiben, kann dies bedeuten, dass Sie etwas falsch machen.  Betrachten Sie ein Beispiel. <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> {   data() {     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> {       <span class="hljs-attr"><span class="hljs-attr">array</span></span>: [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>]     };   },   <span class="hljs-attr"><span class="hljs-attr">computed</span></span>: {     reversedArray() {       <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.array.reverse(); <span class="hljs-comment"><span class="hljs-comment">//   -         }   } };</span></span></code> </pre> <br>  Wenn wir versuchen, <code>array</code> und <code>reversedArray</code> zu drucken, werden wir feststellen, dass beide Arrays dieselben Werte enthalten. <br><br><pre> <code class="javascript hljs"> : [ <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> ]  : [ <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> ]</code> </pre> <br>  Dies liegt daran, dass die berechnete Eigenschaft <code>reversedArray</code> die ursprüngliche <code>array</code> Eigenschaft durch Aufrufen der Methode <code>.reverse()</code> .  Dies ist ein ziemlich einfaches Beispiel, das unerwartetes Systemverhalten demonstriert.  Schauen Sie sich ein anderes Beispiel an. <br><br>  Angenommen, wir haben eine Komponente, die detaillierte Informationen zum Preis von Waren oder Dienstleistungen anzeigt, die in einer bestimmten Bestellung enthalten sind. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> {  <span class="hljs-attr"><span class="hljs-attr">props</span></span>: {    <span class="hljs-attr"><span class="hljs-attr">order</span></span>: {      <span class="hljs-attr"><span class="hljs-attr">type</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Object</span></span>,      <span class="hljs-attr"><span class="hljs-attr">default</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> ({})    }  },  <span class="hljs-attr"><span class="hljs-attr">computed</span></span>:{    grandTotal() {      <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> total = (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.order.total + <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.order.tax) * (<span class="hljs-number"><span class="hljs-number">1</span></span> - <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.order.discount);      <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.$emit(<span class="hljs-string"><span class="hljs-string">'total-change'</span></span>, total)      <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> total.toFixed(<span class="hljs-number"><span class="hljs-number">2</span></span>);    }  } }</code> </pre> <br>  Hier haben wir eine berechnete Eigenschaft erstellt, die die Gesamtkosten der Bestellung einschließlich Steuern und Rabatten anzeigt.  Da wir wissen, dass sich der Gesamtauftragswert hier ändert, können wir versuchen, ein Ereignis <code>grandTotal</code> , das die übergeordnete Komponente über eine Änderung von <code>grandTotal</code> benachrichtigt. <br><br><pre> <code class="javascript hljs">&lt;price-details :order=<span class="hljs-string"><span class="hljs-string">"order"</span></span>               @total-change=<span class="hljs-string"><span class="hljs-string">"totalChange"</span></span>&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">price-details</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> export default {  //        methods: {    totalChange(grandTotal) {      if (this.isSpecialCustomer) {        this.order = {          ...this.order,          discount: this.order.discount + 0.1        };      }    }  } };</span></span></code> </pre> <br>  Stellen Sie sich nun vor, dass manchmal, wenn auch sehr selten, Situationen auftreten, in denen wir mit speziellen Kunden zusammenarbeiten.  Wir gewähren diesen Kunden einen zusätzlichen Rabatt von 10%.  Wir können versuchen, das Bestellobjekt zu ändern und die Rabattgröße zu erhöhen, indem wir der Rabatteigenschaft <code>0.1</code> hinzufügen. <br><br>  Dies führt jedoch zu einem schlimmen Fehler. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/067/865/193/0678651933e04231a483eeb7497c8dac.png"></div><br>  <i><font color="#999999">Fehlermeldung</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e31/2ac/db6/e312acdb688bafe5b4af85077c5f6c02.png"></div><br>  <i><font color="#999999">Falsche Bestellwertberechnung für einen speziellen Kunden</font></i> <br><br>  In einer ähnlichen Situation tritt Folgendes auf: Die berechnete Eigenschaft wird in einer Endlosschleife ständig „nachgezählt“.  Wir ändern den Rabatt, die berechnete Immobilie reagiert darauf, berechnet die Gesamtkosten der Bestellung neu und generiert ein Ereignis.  Bei der Verarbeitung dieses Ereignisses erhöht sich der Rabatt erneut, dies führt zu einer Neuberechnung der berechneten Eigenschaft usw. bis ins Unendliche. <br><br>  Es mag Ihnen scheinen, dass ein solcher Fehler in einer realen Anwendung nicht gemacht werden kann.  Aber ist es wirklich so?  Unser Skript (wenn so etwas in dieser Anwendung passiert) ist sehr schwer zu debuggen.  Ein solcher Fehler wird äußerst schwer zu verfolgen sein.  Tatsache ist, dass für diesen Fehler die Bestellung von einem speziellen Käufer ausgeführt werden muss und eine solche Bestellung 1000 reguläre Bestellungen haben kann. <br><br><h2>  <font color="#3AC1EF">Verschachtelte Eigenschaften ändern</font> </h2><br>  Manchmal ist ein Entwickler versucht, etwas in einer Eigenschaft aus <code>props</code> zu bearbeiten, bei denen es sich um ein Objekt oder ein Array handelt.  Ein solcher Wunsch kann durch die Tatsache diktiert werden, dass es sehr „einfach“ ist, dies zu tun.  Aber ist es das wert?  Betrachten Sie ein Beispiel. <br><br><pre> <code class="javascript hljs">&lt;template&gt;  <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"hello"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">    </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Name: {{product.name}}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">    </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Price: {{product.price}}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">    </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Stock: {{product.stock}}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">    </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> @</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">click</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"addToCart"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:disabled</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"product.stock &lt;= 0"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Add to card</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">  </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/template&gt; export default {  name: "HelloWorld",  props: {    product: {      type: Object,      default: () =&gt; ({})    }  },  methods: {    addToCart() {      if (this.product.stock &gt; 0) {        this.$emit("add-to-cart");        this.product.stock--;      }    }  } };</span></span></code> </pre> <br>  Hier haben wir die <code>Product.vue</code> Komponente, die den Namen des Produkts, seinen Wert und die Menge der Waren anzeigt, die wir haben.  Die Komponente zeigt auch eine Schaltfläche an, mit der der Käufer die Waren in den Warenkorb legen kann.  Es scheint sehr einfach und bequem zu sein, den Wert der Eigenschaft <code>product.stock</code> nach dem Klicken auf die Schaltfläche zu verringern.  Dies zu tun ist wirklich einfach.  Wenn Sie genau das tun, können jedoch mehrere Probleme auftreten: <br><br><ul><li>  Wir führen eine Änderung (Mutation) der Eigenschaft durch und melden nichts an die übergeordnete Entität. </li><li>  Dies kann zu unerwartetem Systemverhalten oder, noch schlimmer, zum Auftreten seltsamer Fehler führen. </li><li>  Wir führen eine Logik in die <code>product</code> , die wahrscheinlich nicht darin vorhanden sein sollte. </li></ul><br>  Stellen Sie sich eine hypothetische Situation vor, in der ein anderer Entwickler zuerst auf unseren Code stößt und die übergeordnete Komponente sieht. <br><br><pre> <code class="javascript hljs">&lt;template&gt;   <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Product</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:product</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"product"</span></span></span></span><span class="xml"><span class="hljs-tag"> @</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">add-to-cart</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"addProductToCart(product)"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Product</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;<span class="hljs-regexp"><span class="hljs-regexp">/template&gt; import Product from "./</span></span>components/Product<span class="hljs-string"><span class="hljs-string">"; export default {  name: "</span></span>App<span class="hljs-string"><span class="hljs-string">",  components: {    Product  },  data() {    return {      product: {        name: "</span></span>Laptop<span class="hljs-string"><span class="hljs-string">",        price: 1250,        stock: 2      }    };  },  methods: {    addProductToCart(product) {      if (product.stock &gt; 0) {        product.stock--;      }    }  } };</span></span></code> </pre> <br>  Dieser Entwickler könnte wie folgt denken: "Anscheinend muss ich den <code>product.stock</code> in der <code>addProductToCart</code> Methode reduzieren <code>addProductToCart</code> "  Aber wenn dies getan wird, werden wir auf einen kleinen Fehler stoßen.  Wenn Sie jetzt die Taste drücken, wird die Warenmenge nicht um 1, sondern um 2 reduziert. <br><br>  Stellen Sie sich vor, dies ist ein Sonderfall, wenn eine solche Prüfung nur für seltene Waren oder im Zusammenhang mit der Verfügbarkeit eines Sonderrabattes durchgeführt wird.  Wenn dieser Code in Produktion geht, kann alles dazu führen, dass unsere Kunden anstelle von 1 Kopie des Produkts 2 Kopien kaufen. <br><br>  Wenn Ihnen dieses Beispiel nicht überzeugend erschien, stellen Sie sich ein anderes Szenario vor.  Es sei das Formular, das der Benutzer ausfüllt.  Wir übergeben die Essenz des <code>user</code> als Eigenschaft an das Formular und werden den Namen und die E-Mail-Adresse des Benutzers bearbeiten.  Der unten gezeigte Code scheint "korrekt" zu sein. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   &lt;template&gt;  &lt;div&gt;    &lt;span&gt; Email {{user.email}}&lt;/span&gt;    &lt;span&gt; Name {{user.name}}&lt;/span&gt;    &lt;user-form :user="user" @submit="updateUser"/&gt;  &lt;/div&gt; &lt;/template&gt; import UserForm from "./UserForm" export default {  components: {UserForm},  data() {   return {     user: {      email: 'loreipsum@email.com',      name: 'Lorem Ipsum'     }   }  },  methods: {    updateUser() {     //            }  } } //   UserForm.vue &lt;template&gt;  &lt;div&gt;   &lt;input placeholder="Email" type="email" v-model="user.email"/&gt;   &lt;input placeholder="Name" v-model="user.name"/&gt;   &lt;button @click="$emit('submit')"&gt;Save&lt;/button&gt;  &lt;/div&gt; &lt;/template&gt; export default {  props: {    user: {     type: Object,     default: () =&gt; ({})    }  } }</span></span></code> </pre> <br>  Mit der <code>v-model</code> Direktive können Sie ganz einfach mit dem <code>user</code> .  Vue.js erlaubt dies.  Warum nicht einfach das tun?  Denken Sie darüber nach: <br><br><ul><li>  Was ist, wenn Sie dem Formular eine Schaltfläche Abbrechen hinzufügen müssen, indem Sie darauf klicken, welche Schaltfläche die vorgenommenen Änderungen abbricht? </li><li>  Was ist, wenn ein Serveraufruf fehlschlägt?  Wie mache ich <code>user</code> rückgängig? </li><li>  Möchten wir den geänderten Namen und die geänderte E-Mail-Adresse wirklich in der übergeordneten Komponente anzeigen, bevor wir die entsprechenden Änderungen speichern? </li></ul><br>  Eine einfache Möglichkeit, das Problem zu beheben, besteht darin, das <code>user</code> zu klonen, bevor es als Eigenschaft gesendet wird: <br><br><pre> <code class="javascript hljs">&lt;user-form :user=<span class="hljs-string"><span class="hljs-string">"{...user}"</span></span>&gt;</code> </pre> <br>  Obwohl dies funktionieren mag, umgehen wir das Problem nur, lösen es aber nicht.  Unsere <code>UserForm</code> Komponente muss einen eigenen lokalen Status haben.  Folgendes können wir tun. <br><br><pre> <code class="javascript hljs">&lt;template&gt;  <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">   </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Email"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"email"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">v-model</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"form.email"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml">   </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">input</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">placeholder</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Name"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">v-model</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"form.name"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml">   </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> @</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">click</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"onSave"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Save</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">   </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag"> @</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">click</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"onCancel"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">Save</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">button</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">  </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">template</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> export default {  props: {    user: {     type: Object,     default: () =&gt; ({})    }  },  data() {   return {    form: {}   }  },  methods: {   onSave() {    this.$emit('submit', this.form)   },   onCancel() {    this.form = {...this.user}    this.$emit('cancel')   }  }  watch: {    user: {     immediate: true,     handler: function(userFromProps){      if(userFromProps){        this.form = {          ...this.form,          ...userFromProps        }      }     }    }  } }</span></span></code> </pre> <br>  Obwohl dieser Code definitiv ziemlich kompliziert erscheint, ist er besser als die vorherige Version.  Es ermöglicht Ihnen, die oben genannten Probleme zu beseitigen.  Wir erwarten ( <code>watch</code> ) Änderungen an der <code>user</code> und kopieren sie in die internen <code>form</code> .  Infolgedessen hat das Formular jetzt einen eigenen Status, und wir erhalten die folgenden Funktionen: <br><br><ul><li>  Sie können die Änderungen rückgängig machen, indem Sie das Formular neu <code>this.form = {...this.user}</code> : <code>this.form = {...this.user}</code> . </li><li>  Wir haben einen isolierten Zustand für die Form. </li><li>  Unsere Aktionen wirken sich nicht auf die übergeordnete Komponente aus, falls wir sie nicht benötigen. </li><li>  Wir kontrollieren, was passiert, wenn wir versuchen, Änderungen zu speichern. </li></ul><br><h2>  <font color="#3AC1EF">Direkter Zugriff auf übergeordnete Komponenten</font> </h2><br>  Wenn eine Komponente auf eine andere Komponente verweist und einige Aktionen darauf ausführt, kann dies zu Widersprüchen und Fehlern führen. Dies kann zu einem merkwürdigen Verhalten der Anwendung und zum Auftreten verwandter Komponenten führen. <br><br>  Stellen Sie sich ein sehr einfaches Beispiel vor - eine Komponente, die ein Dropdown-Menü implementiert.  Stellen Sie sich vor, wir haben eine <code>dropdown</code> Komponente (übergeordnet) und eine <code>dropdown-menu</code> <code>dropdown</code> ( <code>dropdown-menu</code> ).  Wenn der Benutzer auf einen bestimmten Menüpunkt klickt, müssen wir das <code>dropdown-menu</code> .  Das Ausblenden und <code>dropdown</code> dieser Komponente erfolgt durch die übergeordnete <code>dropdown</code> Komponente.  Schauen Sie sich ein Beispiel an. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Dropdown.vue ( ) &lt;template&gt;  &lt;div&gt;    &lt;button @click="showMenu = !showMenu"&gt;Click me&lt;/button&gt;    &lt;dropdown-menu v-if="showMenu" :items="items"&gt;&lt;/dropdown-menu&gt;  &lt;/div&gt; &lt;template&gt; export default {  props: {   items: Array  },  data() {   return {     selectedOption: null,     showMenu: false   }  } } // DropdownMenu.vue ( ) &lt;template&gt;  &lt;ul&gt;    &lt;li v-for="item in items" @click="selectOption(item)"&gt;{{item.name}}&lt;/li&gt;  &lt;/ul&gt; &lt;template&gt; export default {  props: {   items: Array  },  methods: {    selectOption(item) {     this.$parent.selectedOption = item     this.$parent.showMenu = false    }  } }</span></span></code> </pre> <br>  <code>selectOption</code> auf die <code>selectOption</code> Methode.  Obwohl dies sehr selten vorkommt, möchte jemand möglicherweise <code>$parent</code> direkt kontaktieren.  Dieser Wunsch kann durch die Tatsache erklärt werden, dass es sehr einfach ist, dies zu tun. <br><br>  Auf den ersten Blick scheint es, dass ein solcher Code korrekt funktioniert.  Aber hier sehen Sie ein paar Probleme: <br><br><ul><li>  Was ist, wenn wir die Eigenschaft <code>showMenu</code> oder <code>selectedOption</code> ändern?  Das Dropdown-Menü kann nicht geschlossen werden und keines seiner Elemente wird ausgewählt. </li><li>  Was ist, wenn Sie das <code>dropdown-menu</code> mithilfe eines Übergangs animieren <code>dropdown-menu</code> ? </li></ul><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Dropdown.vue ( ) &lt;template&gt;  &lt;div&gt;    &lt;button @click="showMenu = !showMenu"&gt;Click me&lt;/button&gt;    &lt;transition name="fade"&gt;      &lt;dropdown-menu v-if="showMenu" :items="items"&gt;&lt;/dropdown-menu&gt;    &lt;/dropdown-menu&gt;  &lt;/div&gt; &lt;template&gt;</span></span></code> </pre> <br>  Dieser Code funktioniert aufgrund einer Änderung in <code>$parent</code> nicht.  Die <code>dropdown</code> Komponente ist nicht mehr das übergeordnete <code>dropdown-menu</code> des <code>dropdown-menu</code> .  Jetzt ist das <code>dropdown-menu</code> die <code>transition</code> . <br><br>  Eigenschaften werden in der Komponentenhierarchie weitergegeben, Ereignisse werden weitergegeben.  Diese Wörter enthalten die Bedeutung des richtigen Ansatzes zur Lösung unseres Problems.  Hier ist ein Beispiel, das für Ereignisse geändert wurde. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// Dropdown.vue ( ) &lt;template&gt;  &lt;div&gt;    &lt;button @click="showMenu = !showMenu"&gt;Click me&lt;/button&gt;    &lt;dropdown-menu v-if="showMenu" :items="items" @select-option="onOptionSelected"&gt;&lt;/dropdown-menu&gt;  &lt;/div&gt; &lt;template&gt; export default {  props: {   items: Array  },  data() {   return {     selectedOption: null,     showMenu: false   }  },  methods: {    onOptionSelected(option) {      this.selectedOption = option      this.showMenu = true    }  } } // DropdownMenu.vue ( ) &lt;template&gt;  &lt;ul&gt;    &lt;li v-for="item in items" @click="selectOption(item)"&gt;{{item.name}}&lt;/li&gt;  &lt;/ul&gt; &lt;/template&gt; export default {  props: {   items: Array  },  methods: {    selectOption(item) {     this.$emit('select-option', item)    }  } }</span></span></code> </pre> <br>  Dank der Verwendung von Ereignissen ist die untergeordnete Komponente nicht mehr an die übergeordnete Komponente gebunden.  Wir können Eigenschaften mit Daten in der übergeordneten Komponente frei ändern und animierte Übergänge verwenden.  Wir denken jedoch möglicherweise nicht darüber nach, wie sich unser Code auf die übergeordnete Komponente auswirken kann.  Wir benachrichtigen diese Komponente einfach über das, was passiert ist.  In diesem Fall <code>dropdown</code> die <code>dropdown</code> Komponente selbst Entscheidungen darüber, wie die Auswahl eines <code>dropdown</code> den Benutzer und das Schließen des Menüs behandelt werden sollen. <br><br><h2>  <font color="#3AC1EF">Zusammenfassung</font> </h2><br>  Der kürzeste Code ist nicht immer der erfolgreichste.  Entwicklungstechniken mit „einfachen und schnellen“ Ergebnissen sind häufig fehlerhaft.  Um eine Programmiersprache, Bibliothek oder ein Framework richtig verwenden zu können, benötigen Sie Geduld und Zeit.  Dies gilt für Vue.js. <br><br>  <b>Liebe Leser!</b>  Haben Sie in der Praxis Probleme festgestellt, wie sie in diesem Artikel beschrieben werden? <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de463327/">https://habr.com/ru/post/de463327/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de463311/index.html">CTT in Serverlösungen. Die zweite Version + die Ankündigung der dritten, mit der Fähigkeit zu berühren</a></li>
<li><a href="../de463313/index.html">Ein alternativer Ansatz zum Abonnieren von Ereignissen, oder ist EventObject wirklich notwendig?</a></li>
<li><a href="../de463317/index.html">Technische Details zum Hacken der Capital One Bank auf AWS</a></li>
<li><a href="../de463321/index.html">Usability-Körbe und Kassen: Analyse der 20 besten russischen Nischen-Online-Shops</a></li>
<li><a href="../de463325/index.html">Game Designer Reflection: Charaktere für ein Spiel, das nicht herausgekommen ist</a></li>
<li><a href="../de463329/index.html">Entwicklung dynamischer Baumdiagramme mit SVG und Vue.js.</a></li>
<li><a href="../de463331/index.html">Apollo Client. Jetzt mit React Hooks</a></li>
<li><a href="../de463333/index.html">Wahl eines Testmanagementsystems im Jahr 2019</a></li>
<li><a href="../de463335/index.html">Verwendung des statischen Analysators PVS-Studio in der Entwicklung für eingebettete Systeme in C und C ++</a></li>
<li><a href="../de463337/index.html">Verwenden von Immer zum Verwalten des Anwendungsstatus</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>