<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öñÔ∏è üïµüèø üåØ Desarrollo de una aplicaci√≥n m√≥vil sin servidor. üö∫ üõ•Ô∏è üåó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Muy a menudo, al desarrollar aplicaciones m√≥viles (quiz√°s el mismo problema con las aplicaciones web), los desarrolladores se encuentran en una situac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Desarrollo de una aplicaci√≥n m√≥vil sin servidor.</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/surfstudio/blog/477506/">  Muy a menudo, al desarrollar aplicaciones m√≥viles (quiz√°s el mismo problema con las aplicaciones web), los desarrolladores se encuentran en una situaci√≥n en la que el backend no funciona o no proporciona los m√©todos necesarios. <br><br>  Esta situaci√≥n puede ocurrir por varias razones.  Sin embargo, con mayor frecuencia al comienzo del desarrollo, el backend simplemente no est√° escrito y el cliente comienza sin √©l.  En este caso, el inicio del desarrollo se retrasa de 2 a 4 meses. <br><br>  A veces el servidor simplemente se apaga (se bloquea), a veces no tiene tiempo para implementar los m√©todos necesarios, a veces hay problemas de datos, etc.  Todos estos problemas nos llevaron a escribir un peque√±o servicio Mocker, que le permite reemplazar el backend real. <br><br><img src="https://habrastorage.org/webt/xj/8e/it/xj8eitbqje5bpz5trubpbzav_qa.png"><br><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">¬øC√≥mo llegu√© a esto?</b> <div class="spoiler_text"> ¬øC√≥mo llegu√© a esto?  Mi primer a√±o en la compa√±√≠a estaba terminando y me pusieron en un nuevo proyecto de comercio electr√≥nico.  El gerente dijo que el proyecto debe completarse en 4 meses, pero el equipo de back-end (en el lado del cliente) comenzar√° el desarrollo solo despu√©s de 1,5 meses.  Y durante este tiempo tenemos que lanzar muchas funciones de UI. <br><br>  Suger√≠ escribir un backend moch (antes de convertirme en desarrollador de iOS, jugu√© con .NET en la uni).  La idea de implementaci√≥n era simple: de acuerdo con una especificaci√≥n dada, era necesario escribir m√©todos de c√≥digo auxiliar que tomaran datos de archivos JSON preparados previamente.  Se decidieron por eso. <br><br>  Despu√©s de 2 semanas, me fui de vacaciones y pens√©: "¬øPor qu√© no genero autom√°ticamente todo esto?"  Entonces, durante 2 semanas de vacaciones, escrib√≠ una especie de int√©rprete que toma la especificaci√≥n APIBlueprint y genera la aplicaci√≥n web .NET a partir de ella (c√≥digo C #). <br><br>  Como resultado, apareci√≥ la primera versi√≥n de esta cosa y la vivimos durante casi 2.5 meses.  No puedo dar cifras reales, cu√°nto nos ayud√≥ esto, pero recuerdo c√≥mo dijeron en retrospectiva que si no fuera por este sistema, no habr√≠a lanzamiento. <br><br>  Ahora, despu√©s de varios a√±os, tom√© en cuenta los errores cometidos por m√≠ (y hubo muchos de ellos) y reescrib√≠ completamente el instrumento. <br><br>  Aprovechando esta oportunidad, muchas gracias a los colegas que ayudaron con sus comentarios y consejos.  Y tambi√©n a los l√≠deres que soportaron toda mi "arbitrariedad de ingenier√≠a". <br></div></div><br><h3>  Introduccion </h3><br>  Como regla, cualquier aplicaci√≥n cliente-servidor se ve as√≠: <br><br><img src="https://habrastorage.org/webt/fs/bh/xa/fsbhxawsxnmbtygz0pxuc7-nbri.png"><br><br>  Cada pantalla tiene al menos 1 consulta (y a menudo m√°s).  Movi√©ndonos profundamente en las pantallas, necesitamos hacer m√°s y m√°s solicitudes.  A veces ni siquiera podemos hacer la transici√≥n hasta que el servidor nos diga "Mostrar el bot√≥n".  Es decir, la aplicaci√≥n m√≥vil est√° muy vinculada al servidor, no solo durante su trabajo inmediato, sino tambi√©n en la etapa de desarrollo.  Considere el ciclo de desarrollo de producto abstracto: <br><br><img src="https://habrastorage.org/webt/xc/o6/pm/xco6pm2ekp91qzev1lgowrriyle.png"><br><br><ol><li>  Primero dise√±amos.  Descomponemos, describimos y discutimos. </li><li>  Habiendo recibido las tareas y requisitos, comenzamos el desarrollo.  Escribimos el c√≥digo, tipograf√≠a, etc. </li><li>  Despu√©s de que hayamos implementado algo, se est√° preparando un ensamblaje, que pasa a pruebas manuales, donde se verifica la aplicaci√≥n para diferentes casos. </li><li>  Si todo est√° bien con nosotros, y los probadores prueban el ensamblaje, el cliente lo lleva a cabo. </li></ol><br>  Cada uno de estos procesos es muy importante.  Especialmente lo √∫ltimo, ya que el cliente debe comprender en qu√© etapa estamos realmente y, a veces, debe informar los resultados a la gerencia o a los inversores.  Como regla, tales informes ocurren, incluso en el formato de una demostraci√≥n de una aplicaci√≥n m√≥vil.  En mi pr√°ctica, hubo un caso en el que un cliente demostr√≥ solo la mitad del MVP, que solo funcionaba en mokas.  La aplicaci√≥n mok se parece al presente y grazna como el presente.  Entonces es real (: <br>  Sin embargo, este es un sue√±o rosado.  Veamos qu√© sucede realmente si no tenemos un servidor. <br><br><img src="https://habrastorage.org/webt/v6/gp/vp/v6gpvpbngkjv_mk4mnalkbxulpe.png"><br><br><ol><li>  El proceso de desarrollo ser√° m√°s lento y doloroso, ya que no podemos escribir servicios normalmente, tampoco podemos verificar todos los casos, tenemos que escribir talones que deber√°n eliminarse m√°s adelante. </li><li>  Despu√©s de que hicimos la asamblea por la mitad con pena, llega a los evaluadores que la miran y no entienden qu√© hacer con ella.  No puede verificar nada, la mitad no funciona en absoluto, porque no hay servidor.  Como resultado, se pierden muchos errores: tanto l√≥gicos como visuales. </li><li>  Bueno, despu√©s de "c√≥mo podr√≠an haberse visto", debe entregar el ensamblaje al cliente y luego comienza lo m√°s desagradable.  El cliente realmente no puede evaluar el trabajo, ve 1-2 casos fuera de todo posible y ciertamente no puede mostr√°rselo a sus inversores. </li></ol><br>  En general, todo va cuesta abajo.  Y desafortunadamente, tales situaciones ocurren casi siempre: a veces no hay servidor durante un par de meses, a veces medio a√±o, a veces solo en el proceso, el servidor llega muy tarde o debe verificar r√°pidamente los casos l√≠mite que se pueden reproducir utilizando manipulaciones de datos en un servidor real. <br><br>  Por ejemplo, queremos verificar c√≥mo se comporta la aplicaci√≥n si el pago del usuario es mayor que la fecha de vencimiento.  Es muy dif√≠cil (y largo) reproducir tal situaci√≥n en el servidor y necesitamos hacerlo artificialmente. <br><br>  Por lo tanto, existen los siguientes problemas: <br><br><ol><li>  Falta el servidor por completo.  Debido a esto, es imposible dise√±ar, probar y presentar. </li><li>  El servidor no tiene tiempo, lo que interfiere con el desarrollo y puede interferir con las pruebas. </li><li>  Queremos probar los casos l√≠mite, y el servidor no puede permitir esto sin gestos largos. </li><li>  Afecta las pruebas y las presentaciones amenazantes. </li><li>  El servidor se bloquea (una vez, durante el desarrollo estable, perdimos el servidor durante 3,5 d√≠as). </li></ol><br>  Para combatir estos problemas, se cre√≥ Mocker. <br><br><h3>  Principio de funcionamiento </h3><br>  Mocker es un peque√±o servicio web que est√° alojado en alg√∫n lugar, escucha el tr√°fico en un puerto espec√≠fico y puede responder con datos preparados previamente a solicitudes de red espec√≠ficas. <br><br>  La secuencia es la siguiente: <br><br>  1. El cliente env√≠a una solicitud. <br>  2. Mocker recibe la solicitud. <br>  3. Mocker encuentra el simulacro deseado. <br>  4. Mocker devuelve el simulacro deseado. <br><br>  Si todo est√° claro con los puntos 1,2 y 4, 3 plantea preguntas. <br><br>  Para entender c√≥mo el servicio encuentra el simulacro necesario para el cliente, primero consideramos la estructura del simulacro en s√≠. <br><br>  Mock es un archivo JSON en el siguiente formato: <br><br><pre><code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"method"</span></span>: <span class="hljs-string"><span class="hljs-string">"string"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusCode"</span></span>: <span class="hljs-string"><span class="hljs-string">"number"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"response"</span></span>: <span class="hljs-string"><span class="hljs-string">"object"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"request"</span></span>: <span class="hljs-string"><span class="hljs-string">"object"</span></span> }</code> </pre> <br>  Analicemos cada campo por separado. <br><br><h4>  url </h4><br>  Este par√°metro se utiliza para especificar la URL de la solicitud a la que accede el cliente. <br><br>  Por ejemplo, si una aplicaci√≥n m√≥vil realiza una solicitud para url <code>host.dom/path/to/endpoint</code> , entonces en el campo <code>url</code> necesitamos escribir <code>/path/to/endpoint</code> . <br>  Es decir, este campo almacena la <b>ruta relativa al punto final</b> . <br><br>  Este campo debe formatearse en el formato de plantilla de URL, es decir, se permiten los siguientes formatos: <br><br><ol><li>  <code>/path/to/endpoint</code> : direcci√≥n URL normal.  Cuando se recibe la solicitud, el servicio comparar√° las l√≠neas car√°cter por car√°cter. </li><li>  <code>/path/to/endpoint/{number}</code> : url con patr√≥n de ruta.  Un simulacro con dicha URL responder√° a cualquier solicitud que coincida con este patr√≥n. </li><li>  <code>/path/to/endpoint/data?param={value}</code> - url con patr√≥n de par√°metros.  Simulacros con tal url activar√° una solicitud que contenga los par√°metros dados.  Adem√°s, si uno de los par√°metros no est√° en la solicitud, no coincidir√° con la plantilla. </li></ol><br>  Por lo tanto, al controlar los par√°metros de URL, puede determinar claramente que un simulacro determinado volver√° a una URL espec√≠fica. <br><br><h4>  m√©todo </h4><br>  Este es el m√©todo http esperado.  Por ejemplo <code>POST</code> o <code>GET</code> . <br>  La cadena debe contener solo letras may√∫sculas. <br><br><h4>  statusCode </h4><br>  Este es el c√≥digo de estado http para la respuesta.  Es decir, al solicitar este simulacro, el cliente recibir√° una respuesta con el estado registrado en el campo statusCode. <br><br><h4>  respuesta </h4><br>  Este campo contiene el objeto JSON que se enviar√° al cliente en el cuerpo de la respuesta a su solicitud. <br><br><h4>  solicitud </h4><br>  Este es el cuerpo de la solicitud que se espera recibir del cliente, que se utilizar√° para dar la respuesta deseada seg√∫n el cuerpo de la solicitud.  Por ejemplo, si queremos cambiar las respuestas seg√∫n los par√°metros de la solicitud. <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"/auth"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"method"</span></span>: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusCode"</span></span>: <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-attr"><span class="hljs-attr">"response"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"token"</span></span>: <span class="hljs-string"><span class="hljs-string">"cbshbg52rebfzdghj123dsfsfasd"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"request"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"login"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tester"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"password"</span></span>: <span class="hljs-string"><span class="hljs-string">"Valid"</span></span> } }</code> </pre><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"/auth"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"method"</span></span>: <span class="hljs-string"><span class="hljs-string">"POST"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusCode"</span></span>: <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-attr"><span class="hljs-attr">"response"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"message"</span></span>: <span class="hljs-string"><span class="hljs-string">"Bad credentials"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"request"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"login"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tester"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"password"</span></span>: <span class="hljs-string"><span class="hljs-string">"Invalid"</span></span> } }</code> </pre><br>  Si el cliente env√≠a una solicitud con el cuerpo: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"login"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tester"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"password"</span></span>: <span class="hljs-string"><span class="hljs-string">"Valid"</span></span> }</code> </pre><br>  Luego, en respuesta, recibir√°: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"token"</span></span>: <span class="hljs-string"><span class="hljs-string">"cbshbg52rebfzdghj123dsfsfasd"</span></span> }</code> </pre><br>  Y en caso de que queramos verificar c√≥mo funcionar√° la aplicaci√≥n si la contrase√±a se ingresa incorrectamente, se enviar√° una solicitud con el cuerpo: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"login"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tester"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"password"</span></span>: <span class="hljs-string"><span class="hljs-string">"Invalid"</span></span> }</code> </pre><br>  Luego, en respuesta, recibir√°: <br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"message"</span></span>: <span class="hljs-string"><span class="hljs-string">"Bad credentials"</span></span> }</code> </pre><br>  Y podemos verificar el caso con la contrase√±a incorrecta.  Y as√≠ para todos los dem√°s casos. <br><br>  Y ahora descubriremos c√≥mo funciona la agrupaci√≥n y la b√∫squeda del moq deseado. <br><br><img src="https://habrastorage.org/webt/3g/r4/yj/3gr4yj1z0c4pamlfipuvnoculhg.png"><br><br>  Para buscar r√°pida y f√°cilmente el mok deseado, el servidor carga todos los mokas en la memoria y los agrupa de la manera correcta.  La imagen de arriba muestra un ejemplo de agrupaci√≥n. <br><br>  El servidor combina diferentes mokas por <b>url</b> y <b>m√©todo</b> .  Esto es necesario, entre otras cosas, para que podamos crear muchos moks diferentes en una url. <br><br>  Por ejemplo, deseamos que constantemente tire de Pull-To-Refresh, lleguen diferentes respuestas y el estado de la pantalla cambie todo el tiempo (para verificar todos los casos l√≠mite). <br><br>  Luego podemos crear muchos moks diferentes con el mismo <b>m√©todo</b> y par√°metros de <b>URL</b> , y el servidor nos los devolver√° de forma iterativa (a su vez). <br>  Por ejemplo, tengamos tales mokas: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"/products"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"method"</span></span>: <span class="hljs-string"><span class="hljs-string">"GET"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusCode"</span></span>: <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-attr"><span class="hljs-attr">"response"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"product"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"currency"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> } }</code> </pre><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"/products"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"method"</span></span>: <span class="hljs-string"><span class="hljs-string">"GET"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusCode"</span></span>: <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-attr"><span class="hljs-attr">"response"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"gdshfjshhkfhsdgfhshdjgfhjkshdjkfsfgbjsfgskdf"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"currency"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">100000000000</span></span> } }</code> </pre><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"/products"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"method"</span></span>: <span class="hljs-string"><span class="hljs-string">"GET"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusCode"</span></span>: <span class="hljs-number"><span class="hljs-number">200</span></span>, <span class="hljs-attr"><span class="hljs-attr">"response"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }</code> </pre><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"url"</span></span>: <span class="hljs-string"><span class="hljs-string">"/products"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"method"</span></span>: <span class="hljs-string"><span class="hljs-string">"GET"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"statusCode"</span></span>: <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-attr"><span class="hljs-attr">"response"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }</code> </pre><br>  Luego, cuando llamamos al m√©todo GET / productos por primera vez, primero obtendremos la respuesta: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"product"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"currency"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">20</span></span> }</code> </pre><br>  Cuando llamamos por segunda vez, el puntero iterador cambiar√° al siguiente elemento y volver√° a nosotros: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"gdshfjshhkfhsdgfhshdjgfhjkshdjkfsfgbjsfgskdf"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"currency"</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">100000000000</span></span> }</code> </pre><br>  Y podemos comprobar c√≥mo se comporta la aplicaci√≥n si obtenemos algunos valores importantes.  Y as√≠ sucesivamente. <br><br>  Bueno, y cuando lleguemos al √∫ltimo elemento y llamemos al m√©todo nuevamente, el primer elemento volver√° a nosotros nuevamente, porque el iterador volver√° al primer elemento. <br><br><h3>  Proxy de almacenamiento en cach√© </h3><br>  Mocker puede funcionar en modo proxy de almacenamiento en cach√©.  Esto significa que cuando un servicio recibe una solicitud de un cliente, saca la direcci√≥n del host en el que se encuentra el servidor real y el esquema (para determinar el protocolo).  Luego toma la solicitud recibida (con todos sus encabezados, por lo que si el m√©todo requiere autenticaci√≥n, entonces est√° bien, su <code>Authorization: Bearer ...</code> transferido) y corta la informaci√≥n del servicio (el mismo <code>host</code> y <code>scheme</code> ) y env√≠a la solicitud al servidor real. <br><br>  Despu√©s de recibir la respuesta con el c√≥digo 200, Mocker guarda la respuesta en el archivo Mock (s√≠, puede copiarlo o cambiarlo) y devuelve al cliente lo que recibi√≥ del servidor real.  Adem√°s, no solo guarda el archivo en un lugar aleatorio, sino que organiza los archivos para que luego pueda trabajar con ellos manualmente. Por ejemplo, Mocker env√≠a una solicitud a la siguiente URL: <code>hostname.dom/main/products/loans/info</code> .  Luego crear√° una carpeta <code>hostname.dom</code> , luego dentro de ella crear√° una carpeta <code>main</code> , dentro de ella una carpeta de <code>products</code> ... <br><br>  Para evitar simulacros duplicados, el nombre se forma sobre la base del <b>m√©todo http</b> (GET, PUT ...) y un <b>hash del cuerpo de respuesta del servidor real</b> .  En este caso, si ya hay un simulacro en una respuesta espec√≠fica, simplemente se sobrescribir√°. <br><br>  Esta caracter√≠stica se puede activar individualmente para cada solicitud.  Para hacer esto, agregue tres encabezados a la solicitud: <br><br><pre> <code class="plaintext hljs">X-Mocker-Redirect-Is-On: "true", X-Mocker-Redirect-Host: "hostaname.ex:1234", X-Mocker-Redirect-Scheme: "http"</code> </pre><br><h3>  Indicaci√≥n expl√≠cita de la ruta a los simulacros. </h3><br>  A veces quieres que Mocker devuelva solo los mokas que queremos, y no todos los que est√°n en el proyecto. <br><br>  Especialmente relevante para probadores.  Ser√≠a conveniente para ellos tener alg√∫n tipo de conjunto de mokas preparado para cada uno de los casos de prueba.  Y luego, durante las pruebas, el control de calidad solo selecciona la carpeta que necesita y funciona silenciosamente, porque no hay m√°s ruido de simulacros de terceros. <br><br>  Ahora esto es posible.  Para habilitar esta funci√≥n, debe usar un encabezado especial: <br><br><pre> <code class="plaintext hljs">X-Mocker-Specific-Path: path</code> </pre><br>  Por ejemplo, deje que Mocker tenga dicha estructura de carpetas en la ra√≠z <br><br><pre> <code class="plaintext hljs">root/ block_card_test_case/ mocks.... main_test_case/ blocked_test_case/ mocks...</code> </pre><br>  Si necesita ejecutar un caso de prueba sobre tarjetas bloqueadas, entonces <br> <b><code>X-Mocker-Specific-Path: block_card_test_case</code></b> <br>  Si necesita ejecutar un caso de prueba asociado con el bloqueo de la pantalla principal, entonces <br> <b><code>X-Mocker-Specific-Path: main_test_case/blocked_test_case</code></b> <br> <br><h3>  Interfaz </h3><br>  Al principio trabajamos con mokas directamente a trav√©s de ssh, pero con un aumento en el n√∫mero de mokas y usuarios, cambiamos a una opci√≥n m√°s conveniente.  Ahora estamos usando CloudCommander. <br>  En el ejemplo docker-compose, se une al contenedor Mocker. <br><br>  Se parece a esto: <br><br><img src="https://habrastorage.org/webt/g8/ix/y2/g8ixy2mxaomzvo7zwknzhjf33jw.png"><br><br>  Bueno, el bono es un editor web, que le permite agregar / cambiar moki directamente desde el navegador. <br><br><img src="https://habrastorage.org/webt/2o/_d/ut/2o_dutkmga1j_dkuwor2isr4jxq.png"><br><br>  Esta tambi√©n es una soluci√≥n temporal.  En los planes para evitar trabajar con moks a trav√©s del sistema de archivos a alguna base de datos.  Y en consecuencia, ser√° posible controlar los propios mokas desde la GUI a este DB. <br><br><h3>  Despliegue </h3><br>  La forma m√°s f√°cil de implementar Mocker es usar Docker.  Adem√°s, la implementaci√≥n del servicio desde la ventana acoplable desplegar√° autom√°ticamente una interfaz basada en web a trav√©s de la cual es m√°s conveniente trabajar con mokas.  Los archivos necesarios para la implementaci√≥n a trav√©s de Docker est√°n en el repositorio. <br><br>  Sin embargo, si esta opci√≥n no le conviene, puede ensamblar independientemente el servicio desde la fuente.  Suficiente para esto: <br><br><pre> <code class="plaintext hljs">git clone https://github.com/LastSprint/mocker.git cd mocker go build .</code> </pre><br>  Luego debe escribir un archivo de configuraci√≥n ( <a href="">ejemplo</a> ) e iniciar el servicio: <br><br><pre> <code class="plaintext hljs">mocker config.json</code> </pre><br><h3>  Problemas conocidos </h3><br><ul><li>  Despu√©s de cada archivo nuevo, debe hacer <code>curl mockerhost.dom/update_models</code> para que el servicio lea los archivos nuevamente.  No encontr√© una manera r√°pida y elegante de actualizarlo de otra manera </li><li>  A veces, los errores de CloudCommander (o hice algo mal) y no permiten editar moki que se crearon a trav√©s de la interfaz web.  Se trata borrando la memoria cach√© del navegador. </li><li>  El servicio solo funciona con <code>application/json</code> .  Los planes admiten <code>form-url-encoding</code> . </li></ul><br><h3>  Resumen </h3><br>  Mocker es un servicio web que resuelve los problemas de desarrollar aplicaciones cliente-servidor cuando el servidor no est√° listo por alguna raz√≥n. <br><br>  El servicio le permite crear muchos simulacros diferentes en una sola URL, le permite conectar Solicitud y Respuesta entre s√≠ especificando expl√≠citamente los par√°metros en la URL, o directamente configurando el cuerpo de solicitud esperado.  El servicio tiene una interfaz basada en la web que simplifica enormemente la vida de los usuarios. <br><br>  Cada usuario del servicio puede agregar independientemente el punto final necesario y la solicitud que necesita.  En este caso, en el cliente, para cambiar a un servidor real, es suficiente simplemente reemplazar la constante con la direcci√≥n del host. <br><br>  Espero que este art√≠culo ayude a las personas que sufren problemas similares y, quiz√°s, trabajaremos juntos para desarrollar esta herramienta. <br><br>  <a href="https://github.com/LastSprint/mocker">Repositorio de GitHub</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/477506/">https://habr.com/ru/post/477506/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../477496/index.html">M√°scara de vidrio agrietado: ¬øes una RP planificada?</a></li>
<li><a href="../477498/index.html">Recopilamos registros de Nginx usando nginx-clickhouse, los enviamos a Clickhouse y los mostramos en Grafana</a></li>
<li><a href="../477500/index.html">Modelo de aplicaci√≥n (Avalanche: marco de aplicaci√≥n para Java)</a></li>
<li><a href="../477502/index.html">Trabajo remoto de un empleador saludable</a></li>
<li><a href="../477504/index.html">Las mejores pr√°cticas de desarrollo de aplicaciones a seguir en 2020</a></li>
<li><a href="../477508/index.html">Detectores de radar: algunas palabras m√°s sobre √©tica y muchas palabras sobre leyes</a></li>
<li><a href="../477510/index.html">Copia de seguridad autom√°tica y recuperaci√≥n de listas de direcciones din√°micas en Mikrotik</a></li>
<li><a href="../477512/index.html">Batalla de L2TP, RRAS vs SoftEther</a></li>
<li><a href="../477514/index.html">Sistemas Embebidos Automatizaci√≥n de Pruebas de Hardware</a></li>
<li><a href="../477518/index.html">Microarquitectura √≥sea como base para materiales ultraligeros y duraderos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>