<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ›¢ï¸ ğŸ“¶ ğŸ« ChipWhispererï¼šå¯¹å²©æµ†çš„èƒ½é‡æ”»å‡» ğŸ†™ â›°ï¸ ğŸ­</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å‘è¡¨è€…rakf 





 åœ¨Digital Securityçš„Hack of Summer 2019çš„ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘å¤„ç†äº†ç”µæºæ”»å‡»å¹¶ä¸ChipWhispereråˆä½œã€‚ 
 è¿™æ˜¯ä»€ä¹ˆ 


 èƒ½é‡åˆ†ææ˜¯é€šè¿‡ç¬¬ä¸‰æ–¹æ¸ é“è¿›è¡Œçš„ä¸€ç§æ”»å‡»ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ”»å‡»ä½¿ç”¨çš„ä¿¡æ¯æ˜¯ç”±äºç³»ç»Ÿçš„ç‰©ç†å®æ–½è€Œå‡ºç°çš„ã€‚ 


 å“ª...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ChipWhispererï¼šå¯¹å²©æµ†çš„èƒ½é‡æ”»å‡»</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/477730/"><p> å‘è¡¨è€…<a href="https://habr.com/ru/users/rakf/" class="user_link">rakf</a> </p><br><p><img src="https://habrastorage.org/webt/t1/qx/44/t1qx44fuppd2dlfmn-vvb6fsriq.jpeg"></p><br><p> åœ¨Digital Securityçš„Hack of Summer 2019çš„ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘å¤„ç†äº†ç”µæºæ”»å‡»å¹¶ä¸ChipWhispereråˆä½œã€‚ </p><br><h2 id="chto-eto"> è¿™æ˜¯ä»€ä¹ˆ </h2><br><p> èƒ½é‡åˆ†ææ˜¯é€šè¿‡ç¬¬ä¸‰æ–¹æ¸ é“è¿›è¡Œçš„ä¸€ç§æ”»å‡»ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œæ”»å‡»ä½¿ç”¨çš„ä¿¡æ¯æ˜¯ç”±äºç³»ç»Ÿçš„ç‰©ç†å®æ–½è€Œå‡ºç°çš„ã€‚ </p><br><p> å“ªäº›ä¿¡æ¯å¯èƒ½å¯¹æ”»å‡»è€…æœ‰ç”¨ï¼š </p><br><ul><li> å¯†ç è½¬æ¢æ—¶é—´ï¼› </li><li> åŠŸè€—ï¼› </li><li> ç”µç£åœº </li><li> å™ªéŸ³ç­‰ </li></ul><br><p> èƒ½é‡æ”»å‡»è¢«è®¤ä¸ºæ˜¯æœ€æ™®éçš„ã€‚ </p><a name="habracut"></a><br><h2 id="pochemu-rabotaet"> ä¸ºä»€ä¹ˆè¡Œå¾—é€šï¼Ÿ </h2><br><p> å¾®å¤„ç†å™¨ï¼Œå¾®æ§åˆ¶å™¨ï¼ŒRAMå’Œè®¸å¤šå…¶ä»–é€»è¾‘ç”µè·¯å‡åŸºäºCMOSæŠ€æœ¯ã€‚  CMOSç”µè·¯çš„åŠŸè€—åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼šé™æ€å’ŒåŠ¨æ€ã€‚ é™æ€åŠŸè€—éå¸¸å°ï¼Œè¿™æ˜¯æŠ€æœ¯å„æ–­çš„åŸå› ä¹‹ä¸€ã€‚ åŠ¨æ€åŠŸç‡å½’å› äºæ™¶ä½“ç®¡çš„å¼€å…³ï¼Œå¹¶å–å†³äºå¤„ç†åçš„æ•°æ®å’Œæ‰§è¡Œçš„æ“ä½œã€‚ ç”±äºé™æ€åˆ†é‡ä¸»è¦æ˜¯æ’å®šçš„ï¼Œå› æ­¤æ€»åŠŸç‡çš„å˜åŒ–å®Œå…¨æ˜¯ç”±åŠ¨æ€åŠŸç‡å¼•èµ·çš„ï¼Œå› æ­¤æ€»èƒ½è€—å¯ç”¨äºåˆ†æã€‚ </p><br><h2 id="instrumentariy"> å·¥å…·åŒ… </h2><br><p>  <a href="https://newae.com/tools/chipwhisperer/">ChipWhisperer</a> ï¼Œæˆ‘ä½¿ç”¨äº†ä¸¤éƒ¨åˆ†ç‰ˆæœ¬ï¼š </p><br><p><img src="https://habrastorage.org/webt/56/p3/p4/56p3p4nq89l3drktqn9c0eo1mta.jpeg" alt="ChipWhisperer 2éƒ¨åˆ†ç‰ˆæœ¬"></p><br><p>  ChipWhispereræ˜¯ç”¨äºç ”ç©¶åµŒå…¥å¼è®¾å¤‡å®‰å…¨æ€§çš„å¼€æºå·¥å…·åŒ…ã€‚ å®ƒå…è®¸è¿›è¡Œèƒ½é‡åˆ†æå’ŒåŸºäºé”™è¯¯çš„æ”»å‡»ã€‚ </p><br><p> è¯¥è´¹ç”¨ä¸º250ç¾å…ƒã€‚ å¼€å‘äººå‘˜å°†å…¶å®šä½ä¸ºé©å‘½æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œå› ä¸ºæ ¹æ®åˆ›å»ºè€…çš„è¯´æ³•ï¼Œæ­¤ç±»å¤æ‚ç»“æ„çš„æˆæœ¬ä»3ä¸‡ç¾å…ƒèµ·ã€‚ è¯¥è®¾å¤‡åŒ…æ‹¬2ä¸ªæ¿ï¼šç›®æ ‡æ¿å’Œæ•è·æ¿ã€‚ </p><br><p> è¿˜æœ‰å…¶ä»–ç‰ˆæœ¬ï¼Œå®ƒä»¬å…·æœ‰ä¼˜ç‚¹ï¼ˆä½†ä»·æ ¼æ˜‚è´µï¼‰ï¼Œæ‚¨ä¹Ÿå¯ä»¥å•ç‹¬è´­ä¹°å„ç§ç›®æ ‡æ¿ï¼Œæ‰©å±•å¡ï¼Œæ¢é’ˆä»¥å¯¹è®¾å¤‡è¿›è¡Œå…¨é¢åˆ†æï¼Œå¹¶ä»…ä½¿ç”¨ChipWhispererè¿›è¡Œæ‹†å¸ã€‚ </p><br><p>  ChipWhispereræ‹¥æœ‰å‡ºè‰²çš„<a href="https://wiki.newae.com/Main_Page">Wiki</a>å’Œå°å‹å¼€å‘<a href="https://chipwhisperer.readthedocs.io/en/latest/tutorials.html">å®éªŒå®¤</a> ï¼Œåˆ°äº†ç¬¬5ç‰ˆï¼Œä»–ä»¬ç”šè‡³<a href="https://chipwhisperer.readthedocs.io/en/latest/api.html">ç¼–å†™</a>äº†ä¸é”™çš„API <a href="https://chipwhisperer.readthedocs.io/en/latest/api.html">æ–‡æ¡£</a> ã€‚ ä½¿ç”¨æ›²ç›®çš„è½¯ä»¶å°†æ›²ç›®ä»è¿æ¥çš„è®¾å¤‡ä¸­åˆ é™¤ï¼Œå¹¶è®°å½•ä¸ºNumPyé˜µåˆ—ã€‚ </p><br><p> é¦–å…ˆï¼Œæ‚¨éœ€è¦ä¸ºç›®æ ‡è®¾å¤‡ç¼–å†™å›ºä»¶ã€‚ ä½œä¸ºå®éªŒçš„ä¸€éƒ¨åˆ†ï¼Œè€ƒè™‘äº†å¯†ç AESï¼ŒDESï¼ŒTEAã€‚ å¯¹äºä»–ä»¬æ¥è¯´ï¼Œå·²ç»æœ‰ç°æˆçš„å›ºä»¶å’Œåˆ é™¤è¿¹çº¿çš„è®¾ç½®ï¼ˆè¦é‡‡é›†çš„æ ·æœ¬æ•°ï¼Œåç§»é‡ï¼ŒADCé¢‘ç‡ç­‰ï¼‰ã€‚ å¯¹äºç‹¬ç«‹ç ”ç©¶ï¼Œå¿…é¡»é€šè¿‡å®éªŒé€‰æ‹©è®¾ç½®ã€‚ </p><br><p> å¦‚ä¸Šæ‰€è¿°ï¼Œæ‚¨å¯èƒ½ä¼šå¼•èµ·ç›®æ ‡æ¿æ•…éšœï¼šå¼•èµ·æ—¶é’Ÿä¿¡å·æ•…éšœï¼Œè·³è¿‡æŒ‡ä»¤å¹¶æå–æœºå¯†ä¿¡æ¯ã€‚ </p><br><p> åœ¨å¤§å‹ç»¼åˆä½“ä¸­ï¼Œä½¿ç”¨ç¤ºæ³¢å™¨è·Ÿè¸ªè½¨è¿¹ã€‚ </p><br><h2 id="analiz"> åˆ†ææ–¹æ³• </h2><br><p> æœ‰å‡ ç§åŸºæœ¬åˆ†ææ–¹æ³•ï¼š </p><br><ul><li> ç®€å•åŠŸç‡åˆ†æï¼ˆSPAï¼‰ï¼› </li><li> å·®åˆ†åŠŸç‡åˆ†æï¼ˆDPAï¼‰ï¼› </li><li> åŠŸç‡ç›¸å…³åˆ†æï¼ˆCPAï¼‰ã€‚ </li></ul><br><p> ç®€å•çš„åŠŸç‡åˆ†æåŒ…æ‹¬åŠŸç‡å›¾çš„å¯è§†åŒ–åˆ†æã€‚ ä¾‹å¦‚ï¼Œå½“è¾“å…¥æ­£ç¡®çš„å­—ç¬¦å¹¶ä¸é”™è¯¯çš„å­—ç¬¦è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œé€šè¿‡è§‚å¯Ÿç”µæºé…ç½®æ–‡ä»¶ï¼Œå¯ä»¥ä¸€æ¬¡è·å¾—ä¸€ä¸ªå­—ç¬¦çš„å¯†ç ã€‚ </p><br><p><img src="https://habrastorage.org/webt/ep/rf/tg/eprftggxt26idk5tq4uccp3p9kq.png" alt="å¯†ç èƒ½åŠ›åˆ†æ"></p><br><p> æˆ–è€…ï¼Œæ‚¨å¯ä»¥åœ¨è½¨é“ä¸Šçœ‹åˆ°åŠ å¯†å›åˆã€‚ æ²¡æœ‰è¶³å¤Ÿçš„æ•°æ®æ¥è·å–å¯†é’¥ï¼Œä½†æ˜¯å¯ä»¥å‡å®šæ‰§è¡Œäº†å“ªç§ç®—æ³•ã€‚ è¯¥å›¾æ¸…æ¥šåœ°æ˜¾ç¤ºäº†10è½®AESã€‚ </p><br><p><img src="https://habrastorage.org/webt/ib/pl/e7/ibple7hxooxtxb1bkah2d1k-i_s.png" alt="AES SPA"></p><br><p> å·®åˆ†åˆ†æï¼ˆDPAï¼‰æ¯”ç®€å•åˆ†ææœ‰æ•ˆå¾—å¤šï¼ŒDPAåŸºäºç»Ÿè®¡åˆ†ææ–¹æ³•æ¥æ£€æµ‹åŠŸç‡æ›²çº¿çš„å·®å¼‚ã€‚ ä½†æ˜¯ï¼Œä¸€ç§éå¸¸æœ‰æ•ˆçš„å·¥å…·æ¥â€œæ‰“å¼€â€é’¥åŒ™å°†éœ€è¦å¤§é‡çš„è·¯çº¿ã€‚ æˆ‘æ²¡æœ‰ä½¿ç”¨è¿™ç§æ–¹æ³•è¿›è¡Œåˆ†æï¼Œä½†æ˜¯æœ€åï¼Œæˆ‘å°†æä¾›ä¸€äº›é“¾æ¥ï¼Œè¿™äº›é“¾æ¥å·²è¢«å¾ˆå¥½åœ°æè¿°ã€‚ </p><br><p> ç›¸å…³æ€§åˆ†æçš„åŸºç¡€æ˜¯ç”¨äºç¡®å®šç§˜å¯†åŠ å¯†å¯†é’¥çš„ç»Ÿè®¡è®¾å¤‡ã€‚ æœ‰æ—¶ï¼Œå®ƒä»¥å•ç‹¬çš„ç±»å‹è¢«éš”ç¦»ï¼Œæœ‰æ—¶ç§°ä¸ºDPAã€‚ ä¸DPAç›¸æ¯”ï¼Œæ­¤æ–¹æ³•æ‰€éœ€çš„è¿¹çº¿æ›´å°‘ï¼Œæˆ‘å°†å…¶ç”¨äºåŠŸè€—åˆ†æã€‚ æˆ‘ä¼šå‘Šè¯‰ä½ æ›´å¤šã€‚ </p><br><p> ä¸»è¦ä»»åŠ¡æ˜¯å»ºç«‹æ‰€ç ”ç©¶è®¾å¤‡çš„èƒ½è€—çš„å‡†ç¡®æ¨¡å‹ã€‚ å¦‚æœå»ºç«‹äº†å‡†ç¡®çš„æ¨¡å‹ï¼Œåˆ™é¢„æµ‹å€¼å’Œå®é™…å€¼ä¹‹é—´ä¼šå­˜åœ¨æ˜æ˜¾çš„ç›¸å…³æ€§ã€‚ </p><br><p> å¯ä»¥ä½¿ç”¨çš„åŠŸç‡æ¨¡å‹ä¹‹ä¸€æ˜¯æ±‰æ˜é‡é‡æ¨¡å‹ã€‚  Hammingçš„æƒé‡æ˜¯äºŒè¿›åˆ¶è¡¨ç¤ºå½¢å¼ä¸­éé›¶å€¼çš„æ•°é‡ã€‚ è¯¥æ¨¡å‹çš„å‡è®¾æ˜¯å¯„å­˜å™¨ä¸­è®¾ç½®çš„ä½æ•°å°†ä¸è®¾å¤‡æ¶ˆè€—çš„èƒ½é‡ç›¸å…³ã€‚ æ±‰æ˜çš„ä½“é‡è‡ªæ­¤è¢«ç”¨ä½œå¸¸è§„çš„èƒ½é‡å•ä½ã€‚ è¿˜ä½¿ç”¨æ±‰æ˜è·ç¦»æ¨¡å‹-2ä¸ªå€¼ä¸­ä¸åŒä½æ•°çš„æ•°é‡ã€‚ </p><br><p> ä¸ºäº†æ¯”è¾ƒæ±‰æ˜é‡é‡æ¨¡å‹å’Œå®é™…åŠŸè€—ï¼Œä½¿ç”¨äº†çº¿æ€§çš®å°”é€Šç³»æ•°ã€‚ å®ƒæ˜¾ç¤ºäº†ä¸€ä¸ªé‡å¯¹å¦ä¸€ä¸ªé‡çš„çº¿æ€§ä¾èµ–æ€§ã€‚ ä½¿ç”¨æ­£ç¡®æ„å»ºçš„æ¨¡å‹ï¼Œè¯¥ç³»æ•°å°†è¶‹äº1ã€‚ </p><br><p> é€šç”¨CPAç®—æ³•åŒ…æ‹¬ä»¥ä¸‹ä¸»è¦æ­¥éª¤ï¼š </p><br><ul><li> æ¶ˆé™¤è½¬æ¢æœªçŸ¥å¯†é’¥ä¸Šçš„æ¶ˆæ¯æ—¶çš„åŠŸè€—ï¼› </li><li> å½“åœ¨å…³é”®å­å—çš„æ‰€æœ‰å¯èƒ½å˜ä½“ä¸Šè½¬æ¢ç›¸åŒçš„æ¶ˆæ¯æ—¶ï¼Œæˆ‘ä»¬å»ºç«‹ä¸€ä¸ªèŠ¯ç‰‡èƒ½è€—æ¨¡å‹ï¼ˆæ¯ä¸ªå­—èŠ‚256ä¸ªé€‰é¡¹ï¼‰ï¼› </li><li> æˆ‘ä»¬æ‰¾åˆ°äº†æ¨¡æ‹ŸåŠŸè€—å’Œå®æ•°çš„çº¿æ€§ç›¸å…³ç³»æ•°ã€‚ å¦‚æœæ˜¯çœŸå¯†é’¥ï¼Œç³»æ•°å°†è¶‹äº1ï¼›å¦åˆ™ä¸º0ã€‚ </li><li> å¯¹å…¶ä½™å…³é”®å­å—é‡å¤è¯¥ç®—æ³•ã€‚ </li></ul><br><p> ç»“æœï¼Œå¯†é’¥è¢«ä¸€å°éƒ¨åˆ†ä¾æ¬¡æ¢å¤ã€‚ å¦‚æœæˆ‘ä»¬ä¸€æ¬¡æ”»å‡»å¯†é’¥çš„ä¸€ä¸ªå­—èŠ‚ï¼Œåˆ™æ¯ä¸ªå¯†é’¥è¦è¿›è¡Œ2 <sup>8æ¬¡</sup>å°è¯•ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœé€‰æ‹©AES-128ï¼Œåˆ™å¯†é’¥çš„16ä¸ªå­—èŠ‚çš„æ€»å°è¯•æ¬¡æ•°å°†ä¸º2 <sup>12</sup> ï¼Œè¿™æ¯”å‘½ä¸­2 <sup>128</sup>æ›´å¥½ã€‚ </p><br><h3 id="analiz-shifra-magma"> å²©æµ†å¯†ç åˆ†æ </h3><br><p> å²©æµ†æ˜¯GOST R 34.12-2015ä¸­å®šä¹‰çš„ä»£ç ï¼Œå®é™…ä¸Šæ˜¯GOST 28147-89ä¸­å®šä¹‰çš„ä»£ç ï¼Œä»…åœ¨é…ç½®æ–‡ä»¶ä¸­ã€‚ åŠ å¯†çš„å—ç»è¿‡32è½®ï¼Œå…¶ä¸­å‘ç”Ÿä¸€äº›è½¬æ¢ã€‚ å¯†é’¥åŒ…å«256ä½ï¼Œæ¯ä¸ªå›åˆå¯†é’¥éƒ½æ˜¯åŸå§‹å¯†é’¥çš„ä¸€éƒ¨åˆ†ã€‚ </p><br><p><img src="https://habrastorage.org/webt/il/lf/jg/illfjg84nei10xf2xgboiifkmjy.png" alt="FeistelåŠŸèƒ½GOST"></p><br><p> æˆ‘ä»¬å°†åˆ†æä½¿ç”¨CPAæ–¹æ³•è·å¾—çš„æ•°æ®ã€‚ </p><br><p> é¦–å…ˆï¼Œæ‚¨éœ€è¦é€‰æ‹©ç®—æ³•çš„ä¸­é—´å€¼ï¼Œè¯¥ä¸­é—´å€¼å–å†³äºå·²çŸ¥æ•°æ®å’Œå¯†é’¥çš„ä¸€å°éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡ç®€å•çš„è½¬æ¢æ¥è®¡ç®—ã€‚ é€šå¸¸ï¼Œæ­¤å€¼æ˜¯ç¬¬ä¸€ä¸ªï¼ˆå·²çŸ¥å¼€æ”¾æ–‡æœ¬ï¼‰æˆ–æœ€åä¸€ä¸ªå›åˆï¼ˆå·²çŸ¥å¯†æ–‡ï¼‰çš„S-boxè¾“å‡ºï¼ˆå²©æµ†ç°åœ¨æœ‰1ä¸ªæ›¿æ¢è¡¨ï¼Œå› æ­¤æ›´å®¹æ˜“è¿›è¡Œæ­¤ç±»æ”»å‡»ï¼‰ã€‚ </p><br><p> æˆ‘ç”¨è‘—åçš„å¼€æ”¾æ–‡æœ¬ç ”ç©¶äº†ä¸€ç§å¯†é’¥ï¼Œå› æ­¤å°†è¿›ä¸€æ­¥è€ƒè™‘è¯¥é€‰é¡¹ã€‚ åœ¨Magmaç®—æ³•ä¸­ï¼Œä¸DESï¼ŒAESä¸åŒï¼Œæ·»åŠ äº†å¸¦æœ‰å›åˆå¯†é’¥çš„32ä½å—ä»¥2 <sup>32</sup>ä¸ºæ¨¡ï¼Œå› æ­¤æœ€å¥½ä»S-boxçš„æœ€åä¸€ä¸ªè¾“å‡ºå¼€å§‹åˆ†æï¼Œå› ä¸ºæ·»åŠ æœ€å¤§å€¼ä¸ä¼šå½±å“è¾ƒå¹´è½»çš„å€¼ã€‚ æˆ‘ä»¬è€ƒè™‘æ¯ä¸ªS-boxçš„è¾“å‡ºï¼šé¦–å…ˆæ˜¯8ï¼Œç„¶åæ˜¯8ã€7ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªã€‚ è½¨é“å»é™¤æ˜¯åœ¨8ä½å¾®æ§åˆ¶å™¨ä¸Šè¿›è¡Œçš„ï¼Œæˆ‘ä»¬å¯ä»¥å‡å®šå®ƒä¸åŒSç›’é…åˆä½¿ç”¨ã€‚ å› æ­¤ï¼Œæˆ‘å°†ç«‹å³æ”»å‡»1ä¸ªå­—èŠ‚ã€‚ </p><br><p> æœ€åä¸€ä¸ªå…³é”®å­—èŠ‚çš„èƒ½é‡æ¨¡å‹çš„è®¡ç®—ï¼š </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): <span class="hljs-comment"><span class="hljs-comment">#Initialize arrays &amp; variables to zero sumnum = np.zeros(numpoint) sumden1 = np.zeros(numpoint) sumden2 = np.zeros(numpoint) hyp = np.zeros(numtraces) for tnum in range(numtraces): hyp[tnum] = HW[leak("Gost28147_tc26_ParamZ", kguess, block2ns(text[tnum])[0], 0)]</span></span></code> </pre> <br><p> å…¶ä¸­æ³„æ¼å‡½æ•°ä»…è¿”å›æœ€åä¸€ä¸ªå­—èŠ‚çš„S-boxè¾“å‡ºã€‚ </p><br><p> æˆ‘ä»¬æ ¹æ®ä»¥ä¸‹å…¬å¼è®¡ç®—æ¨¡æ‹Ÿå€¼å’Œå®é™…å€¼çš„çº¿æ€§çš®å°”é€Šç³»æ•°ï¼š </p><br><p><img src="https://habrastorage.org/webt/yt/wd/f-/ytwdf-ah0p0fshbi-i83_tldkvs.png" alt="ç›¸å…³æ€§"></p><br><pre> <code class="python hljs"> cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-comment"><span class="hljs-comment">#Mean of hypothesis meanh = np.mean(hyp, dtype=np.float64) #Mean of all points in trace meant = np.mean(traces, axis=0, dtype=np.float64) #For each trace, do the following for tnum in range(0, numtraces): hdiff = (hyp[tnum] - meanh) tdiff = traces[tnum,:] - meant sumnum = sumnum + (hdiff*tdiff) sumden1 = sumden1 + hdiff*hdiff sumden2 = sumden2 + tdiff*tdiff cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 ) maxcpa[kguess] = max(abs(cpaoutput[kguess]))</span></span></code> </pre> <br><p> å½“é€‰æ‹©ä¸€ä¸ªçœŸæ­£çš„å­é¡¹æ—¶ï¼Œç›¸å…³ç³»æ•°å°†æ˜¾ç€å¢åŠ ï¼š </p><br><p><img src="https://habrastorage.org/webt/8o/7j/8z/8o7j8zrfxosgutb_eymflrxxhp0.png" alt="ç›¸å…³1"></p><br><p> å› æ­¤ï¼Œåˆ†æäº†å›åˆå¯†é’¥çš„æ¯ä¸ªå­—èŠ‚ã€‚ </p><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): best_round_key = kguess &lt;&lt; (bnum * <span class="hljs-number"><span class="hljs-number">8</span></span>) | best_round ...</code> </pre> <br><p> ç»™å®šç¬¬ä¸€ä¸ªå›åˆå¯†é’¥ï¼Œæˆ‘ä»¬å¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼è®¡ç®—2ä¸ªå’Œéšåçš„å›åˆå¯†é’¥ã€‚ å®Œæ•´çš„å²©æµ†é’¥åŒ™å¯ä»¥é€šè¿‡å–å‡º8ä¸ªåœ†å½¢é’¥åŒ™æ¥è·å¾—ã€‚ </p><br><p> åœ¨è§£å†³è¿™ä¸ªé—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œå‡ºç°äº†ä¸€äº›ç»†å¾®å·®åˆ«ã€‚ ä¸AESï¼ŒDESï¼ŒGrasshopperå¯†ç ä¸åŒï¼Œæ·»åŠ æ˜æ–‡è½®å›å¯†é’¥çš„æ¨¡æ•°ä¸º2 <sup>32</sup> ã€‚ ä¸XORaä¸åŒï¼Œä½ä½çš„æ·»åŠ ä¼šå½±å“é«˜ä½ã€‚ åœ¨è®¡ç®—æ¯ä¸ªåç»­å­é¡¹æ—¶ï¼Œå¿…é¡»è€ƒè™‘è¿‡å»çš„ç»“æœã€‚ åœ†å½¢é”®ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ æ•°æ®éå¸¸æ•æ„Ÿã€‚ å¦‚æœå…¶ä¸­ä¸€ä¸ªå€¼çš„è®¡ç®—ä¸æ­£ç¡®ï¼Œåˆ™æ•´ä¸ªå¯†é’¥çš„è¿›ä¸€æ­¥è®¡ç®—å°†ä¸æ­£ç¡®ã€‚ </p><br><p> è¿˜å€¼å¾—è€ƒè™‘çš„æ˜¯ï¼Œç°åœ¨å¾ˆéš¾æ‰¾åˆ°å…·æœ‰å››ä½æ¶æ„çš„èŠ¯ç‰‡ï¼šå¤§å¤šæ•°èŠ¯ç‰‡å…·æœ‰å…«ä½ã€‚ å½“ç„¶ï¼Œæœ‰ä¸“é—¨ç”¨äºç‰¹å®šå®‰å…¨è½¬æ¢ç®—æ³•ï¼ˆæˆ–å‡ ç§ç®—æ³•ï¼‰çš„ä¸“ç”¨å¯†ç èŠ¯ç‰‡ï¼Œå®ƒä»¬å…·æœ‰æœ€æœ‰æ•ˆçš„ä½“ç³»ç»“æ„ã€‚ </p><br><p> ä¸ºäº†æ‰§è¡ŒDESå¯†ç ï¼Œå¯¹äºMagmaï¼Œè¿™ç§å¯†ç å¤„ç†å™¨å¯ä»¥å…·æœ‰å…­ä½ä½“ç³»ç»“æ„-å››ä½ä½“ç³»ç»“æ„ï¼Œå®ƒå…è®¸åˆ†åˆ«å¤„ç†æ¯ä¸ªS-boxã€‚ æˆ‘çš„ç›®æ ‡è®¾å¤‡æ˜¯8ä½ï¼Œåœ¨â€œå²©æµ†â€çš„æƒ…å†µä¸‹ï¼Œå°†ä»¥ä¸€ç§æ–¹æ³•å¯¹8ä½è¿›è¡Œè½¬æ¢ï¼Œå³ æ›¿æ¢å°†åœ¨2ä¸ªS-boxä¸Šè¿›è¡Œï¼Œå°†è€ƒè™‘2ä¸ªS-boxçš„åŠŸè€—ã€‚ å¦‚æœS-boxï¼ˆé«˜çº§æˆ–åˆçº§ï¼‰ä¸­çš„ä¸€ä¸ªä¸çœŸå®å¯†é’¥åŒ¹é…ï¼Œè€Œå¦ä¸€ä¸ªä¸ä¹‹ä¸åŒ¹é…ï¼Œåˆ™å¯èƒ½ä¼šå‘ç”Ÿé«˜ç›¸å…³æ€§çªå‘ã€‚ </p><br><p> é‰´äºä»¥ä¸Šæ‰€æœ‰å†…å®¹ï¼Œåœ¨è¾“å‡ºä¸­ï¼Œæˆ‘ä»¬å…·æœ‰ä»¥ä¸‹è„šæœ¬ï¼Œç”¨äºåˆ†æå²©æµ†å¯†ç çš„èƒ½è€—è·¯å¾„ï¼š </p><br><div class="spoiler">  <b class="spoiler_title">Pythonè„šæœ¬</b> <div class="spoiler_text"><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np path = <span class="hljs-string"><span class="hljs-string">r'C:\Users\user\chipwhisperer\projects\gost_10000_2_data\traces\2019.08.11-19.53.25_'</span></span> traces = np.load(path + <span class="hljs-string"><span class="hljs-string">'traces.npy'</span></span>) text = np.load(path + <span class="hljs-string"><span class="hljs-string">'textin.npy'</span></span>) keys = np.load(path + <span class="hljs-string"><span class="hljs-string">'keylist.npy'</span></span>) HW = [bin(n).count(<span class="hljs-string"><span class="hljs-string">"1"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">256</span></span>)] SBOXES = {<span class="hljs-string"><span class="hljs-string">"Gost28147_tc26_ParamZ"</span></span>: ( (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>), (<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>), (<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>), (<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>), (<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>), (<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>), (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), )} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_K</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s, _in)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" S-box substitution :param s: S-box :param _in: 32-bit word :returns: substituted 32-bit word """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( (s[<span class="hljs-number"><span class="hljs-number">0</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">1</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">4</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">2</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">3</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">12</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">12</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">4</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">5</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">20</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">20</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">6</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">24</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>) + (s[<span class="hljs-number"><span class="hljs-number">7</span></span>][(_in &gt;&gt; <span class="hljs-number"><span class="hljs-number">28</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0x0F</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">28</span></span>) ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">block2ns</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Convert block to N1 and N2 integers """</span></span> data = bytearray(data) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( data[<span class="hljs-number"><span class="hljs-number">7</span></span>] | data[<span class="hljs-number"><span class="hljs-number">6</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | data[<span class="hljs-number"><span class="hljs-number">5</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | data[<span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>, data[<span class="hljs-number"><span class="hljs-number">3</span></span>] | data[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | data[<span class="hljs-number"><span class="hljs-number">0</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span>, ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addmod</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, mod=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ** </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">32</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" Modulo adding of two integers """</span></span> r = x + int(y) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> r <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> r &lt; mod <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> r - mod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_shift11</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" 11-bit cyclic shift """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((x &lt;&lt; <span class="hljs-number"><span class="hljs-number">11</span></span>) &amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)) | ((x &gt;&gt; (<span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">11</span></span>)) &amp; (<span class="hljs-number"><span class="hljs-number">2</span></span> ** <span class="hljs-number"><span class="hljs-number">32</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sbox, key, data, byte)</span></span></span><span class="hljs-function">:</span></span> s = SBOXES[sbox] _in = addmod(data, key) sbox_leak = _K(s, _in); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (sbox_leak &gt;&gt; (<span class="hljs-number"><span class="hljs-number">8</span></span> * byte)) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Feistel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(sbox, key, data, nround)</span></span></span><span class="hljs-function">:</span></span> s = SBOXES[sbox] w = bytearray(key) x = [ w[<span class="hljs-number"><span class="hljs-number">3</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] | w[<span class="hljs-number"><span class="hljs-number">2</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> | w[<span class="hljs-number"><span class="hljs-number">1</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">16</span></span> | w[<span class="hljs-number"><span class="hljs-number">0</span></span> + i * <span class="hljs-number"><span class="hljs-number">4</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">8</span></span>) ] n1, n2 = block2ns(data) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(nround): n1, n2 = _shift11(_K(s, addmod(n1, x[i]))) ^ n2, n1 <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n1 numtraces = len(traces) numpoint = np.shape(traces)[<span class="hljs-number"><span class="hljs-number">1</span></span>] bestguess = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">32</span></span> round_data = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * numtraces <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(numtraces): round_data[i] = [<span class="hljs-number"><span class="hljs-number">0</span></span>] * <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>): best_round = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> tnum_r <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(numtraces): round_data[tnum_r][rnum] = Feistel(<span class="hljs-string"><span class="hljs-string">"Gost28147_tc26_ParamZ"</span></span>, bestguess, text[tnum_r], rnum) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> bnum <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): cpaoutput = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> maxcpa = [<span class="hljs-number"><span class="hljs-number">0</span></span>]*<span class="hljs-number"><span class="hljs-number">256</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> kguess <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">256</span></span>): <span class="hljs-comment"><span class="hljs-comment">#Initialize arrays &amp; variables to zero best_round_key = kguess &lt;&lt; (bnum * 8) | best_round sumnum = np.zeros(numpoint) sumden1 = np.zeros(numpoint) sumden2 = np.zeros(numpoint) hyp = np.zeros(numtraces) for tnum in range(numtraces): hyp[tnum] = HW[round("Gost28147_tc26_ParamZ", best_round_key, round_data[tnum][rnum], bnum)] #Mean of hypothesis meanh = np.mean(hyp, dtype=np.float64) #Mean of all points in trace meant = np.mean(traces, axis=0, dtype=np.float64) #For each trace, do the following for tnum in range(0, numtraces): hdiff = (hyp[tnum] - meanh) tdiff = traces[tnum,:] - meant sumnum = sumnum + (hdiff*tdiff) sumden1 = sumden1 + hdiff*hdiff sumden2 = sumden2 + tdiff*tdiff cpaoutput[kguess] = sumnum / np.sqrt( sumden1 * sumden2 ) maxcpa[kguess] = max(abs(cpaoutput[kguess])) best_round = best_round | (np.argmax(maxcpa) &lt;&lt; (bnum * 8)) bestguess[((rnum + 1) * 4)-bnum - 1] = np.argmax(maxcpa) print "Best Key Guess: " for b in bestguess: print "%02x "%b,</span></span></code> </pre> </div></div><br><p>  <a href="https://github.com/rakf/ChipWhisperer/tree/master/GOST">GitHubç»“æœå­˜å‚¨åº“</a> </p><br><h2 id="vyvody"> ç»“è®º </h2><br><p> ä½œä¸ºç ”ç©¶çš„ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä¸ChipWhispereråˆä½œã€‚ å°½ç®¡æˆ‘æ²¡æœ‰å°è¯•æ‰€æœ‰å·¥å…·ï¼ˆä¾‹å¦‚ï¼Œæ•…éšœï¼‰ï¼Œä½†æˆ‘ç¡®å®å‘ç°ChipWhispererå¾ˆæœ‰ç”¨ï¼Œå°¤å…¶æ˜¯åœ¨æ‚¨ä¸æƒ³è´­ä¹°æ˜‚è´µçš„ä¸“ç”¨ç¡¬ä»¶çš„æƒ…å†µä¸‹ã€‚ </p><br><p> å…³äºæˆ‘ä»¬çš„åŠŸè€—å¯†ç åˆ†æï¼Œå®ƒæ¯”ä¸Šè¿°å¯†ç æ›´èƒ½æŠµæŠ—è¿™ç§æ”»å‡»ï¼Œä½†æ˜¯æœ‰äº†è¶³å¤Ÿçš„æ•°æ®ï¼Œå°±å¯ä»¥æ¯«æ— é—®é¢˜åœ°è·å¾—å¯†é’¥ã€‚ </p><br><p> æœ‰è¶£çš„ææ–™ï¼š </p><br><ul><li>  P. Kocherå·®åˆ†åŠŸç‡åˆ†æ </li><li>  â€œåŠŸè€—åˆ†ææ”»å‡»ï¼šæ­ç¤ºæ™ºèƒ½å¡çš„ç§˜å¯†â€ </li><li>  <a href="https://xakep.ru/2015/01/29/crypto-i-keys/">æªå£ä¸‹çš„å¯†ç å­¦Iï¼šå¯»æ‰¾å¯†ç ç®—æ³•</a> R. Korkikyançš„å¯†é’¥ã€‚ </li><li>  <a href="https://xakep.ru/2015/01/27/kriptogry-191/">æªå£ä¸‹çš„å¯†ç å­¦IIï¼šå·®å¼‚è¥å…»åˆ†æ</a> R. Korkikyanã€‚ </li><li>  <a href="https://xakep.ru/2015/01/27/kriptogry-191/">ZeroNightsçš„æŠ¥å‘Š2014</a> R. Korkikyanã€‚ </li><li>  ZeroNights 2014çš„å¯†ç åŠ å¯†<a href="http://2014.zeronights.org/assets/files/slides/cryptocodingv2.pdf">v2</a>æœ‰å…³è½¯ä»¶å®æ–½ã€‚ </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN477730/">https://habr.com/ru/post/zh-CN477730/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN477716/index.html">æ•°å­¦å®¶ä»¥â€œæ ‡ç­¾â€ä¸ºä¾‹è®¡ç®—éšæœºæ€§å¦‚ä½•å‘ç”Ÿ</a></li>
<li><a href="../zh-CN477718/index.html">å·ç§¯å±‚ï¼šæ ¹æ®Shmuel Vinogradçš„æ–¹æ³•è¿›è¡Œå¿«é€Ÿå·ç§¯</a></li>
<li><a href="../zh-CN477722/index.html">C ++ä¸­çš„Googleæ ·å¼æŒ‡å—ã€‚ ç¬¬8éƒ¨åˆ†</a></li>
<li><a href="../zh-CN477724/index.html">HRå“ç‰Œhabraseminarï¼šå…³äºäººæ‰ï¼Œç‹©çŒå’Œå†…å®¹</a></li>
<li><a href="../zh-CN477728/index.html">å›¢é˜Ÿé¢†å¯¼åšä»€ä¹ˆï¼Œä»¥å…å›¢é˜Ÿç–²å€¦</a></li>
<li><a href="../zh-CN477732/index.html">æ°´ä¸‹å¯¼èˆªç³»ç»Ÿçš„æ‰‹æŒ‡åˆ†ç±»é”™è¯¯</a></li>
<li><a href="../zh-CN477734/index.html">ä½¿ç”¨Photosåº”ç”¨ç¨‹åºäº†è§£UICollectionViewLayout</a></li>
<li><a href="../zh-CN477736/index.html">æµ‹è¯•äººå‘˜çš„è·¯å¾„ï¼šä»â€œæ‰‹åˆ¹â€åˆ°è‡ªåŠ¨åŒ–</a></li>
<li><a href="../zh-CN477738/index.html">iKassaæˆ–æˆ‘ä»¬å¦‚ä½•é©¯æœâ€œæ•°å­—æ”¶é“¶å‘˜â€</a></li>
<li><a href="../zh-CN477740/index.html">åœ¨å“ªé‡Œå¯ä»¥ç”¨çœ¼ç›è§‚å¯Ÿè¿™æ¶æœ›è¿œé•œï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>