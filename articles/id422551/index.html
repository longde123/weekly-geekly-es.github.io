<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⚾️ 🥠 👨‍👧‍👦 Cara mencuri uang dari kartu contactless dan Apple Pay 📡 🤰🏾 🏫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Artikel ini membahas mitos dan skenario penipuan pembayaran tanpa kontak menggunakan contoh terminal POS nyata, kartu PayPass / payWave dan telepon de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cara mencuri uang dari kartu contactless dan Apple Pay</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422551/"><img alt="Bagaimana cara menyimpan uang dari kartu contactless dari saku Anda?  Seberapa amankah PayPass dan Apple Pay?" src="https://habrastorage.org/webt/gb/2f/ry/gb2frybl-08fyn1a0w1xxjap9f0.jpeg"><br><br>  Artikel ini membahas mitos dan skenario penipuan pembayaran tanpa kontak menggunakan contoh terminal POS nyata, kartu PayPass / payWave dan telepon dengan fungsi Google Pay / Apple Pay. <br><br>  Topik yang dibahas: <br><br><ul><li>  <b>Apakah benar-benar mungkin untuk mencuri uang dengan menyandarkan terminal POS saya di saku saya?</b>  - Kami akan mencoba untuk mereproduksi sepenuhnya skenario penipuan ini dari awal hingga akhir, menggunakan terminal POS nyata dan kartu pembayaran dalam kondisi nyata. </li><li>  <b>Apa perbedaan antara kartu Apple Pay fisik dan virtual?</b>  - cara kartu fisik dan token Apple Pay ditautkan, dan mengapa Apple Pay jauh lebih aman daripada kartu biasa. </li><li>  <b>Kami menggunakan perangkat keras NFC sniffer (ISO 14443A)</b> - kami akan menggunakan perangkat HydraNFC untuk memotong data antara terminal POS dan kartu.  Pertimbangkan data sensitif apa yang dapat diekstraksi dari lalu lintas yang dicegat. </li><li>  <b>Kami menganalisis protokol EMV</b> - data apa yang ditukar kartu dengan terminal POS, format permintaan yang digunakan, mekanisme untuk melindungi terhadap penipuan dan serangan replay. </li><li>  <b>Kami mempelajari operasi tanpa kartu (CNP, MO / TO)</b> - dalam kasus apa sebenarnya (!) Anda dapat mencuri uang dari kartu, hanya memiliki detail yang dibaca tanpa kontak, dan di mana itu tidak mungkin. </li></ul><br>  <font color="red"><b>Perhatian!</b></font> <br><br>  Artikel ini menjelaskan secara rinci skema hipotetis penipuan, dari awal hingga akhir, melalui mata seorang penipu, untuk mencakup semua aspek di mana mitos dan kesalahan dikembangkan.  Terlepas dari judul yang provokatif, kesimpulan utama artikel ini adalah bahwa <b>pembayaran tanpa kontak cukup aman, dan serangan terhadap mereka memakan waktu dan tidak menguntungkan</b> . <br><br>  <font color="red">Materi dalam artikel disajikan hanya untuk tujuan informasi.</font>  <font color="red">Semua adegan penipuan dipentaskan dan dieksekusi dengan persetujuan pihak-pihak yang terlibat.</font>  <font color="red">Semua uang yang dipotong dari kartu dikembalikan ke pemiliknya.</font>  <font color="red">Pencurian uang kartu adalah tindak pidana dan dapat dihukum oleh hukum.</font> <a name="habracut"></a><br><h1>  Bagaimana cara kerjanya? </h1><br>  Untuk memulai, pertimbangkan konsep dasar: setiap pergerakan uang menggunakan kartu pembayaran hanya dimungkinkan melalui perantara yang terhubung ke sistem pembayaran, seperti VISA atau MasterCard.  Tidak seperti transfer antar individu, debit uang dari kartu hanya tersedia untuk badan hukum (pedagang) dengan perjanjian akuisisi dengan bank. <br><br><img src="https://habrastorage.org/webt/d5/1w/ce/d51wcetyqo_5ppr5467wwknaaus.png"><br>  <i><font color="99999">Tahapan transaksi ketika membayar melalui terminal POS</font></i> <br><br>  Ilustrasi di atas menunjukkan skema pembayaran klasik melalui terminal POS.  Ini adalah urutan tindakan yang terjadi ketika setelah pembayaran di kasir Anda sedang menunggu konfirmasi di terminal. <br><br><ol><li>  Pembeli menerapkan / menahan / memasukkan kartu ke dalam terminal POS; </li><li>  Terminal POS mengirimkan data ke bank yang mengakuisisi melalui Internet; </li><li>  Bank yang mengakuisisi melalui sistem pembayaran internasional (MPS) menghubungi bank penerbit dan menanyakan apakah pemegang kartu tertentu dapat membayar pembelian tersebut; </li><li>  Bank penerbit mengkonfirmasi atau menolak pembelian, setelah slip dicetak (cek kedua). </li></ol><br>  Ada pengecualian untuk skema ini, misalnya, transaksi offline, kami akan mempertimbangkannya lebih lanjut.  Juga, jika bank yang mengakuisisi dan bank yang menerbitkan adalah bank yang sama, langkah 2 dan 4 dilakukan dalam bank yang sama. <br><br>  <b>Penjual</b> (Pedagang) - orang atau organisasi yang menyediakan barang atau jasa <br><br>  Acquiring bank adalah bank yang menyediakan penjual dengan layanan penerimaan pembayaran melalui kartu bank.  Di bank ini, biasanya, ada rekening bank penjual di mana uang yang didebit dari kartu dikreditkan. <br><br>  <b>Penerbit</b> bank - bank yang mengeluarkan kartu.  Berisi akun pemegang kartu, dari mana uang didebit. <br><br>  <b>Sistem Pembayaran Internasional</b> (MPS) adalah sistem perantara internasional antara bank-bank di seluruh dunia yang memungkinkan bank untuk membuat penyelesaian di antara mereka sendiri tanpa membuat perjanjian dengan masing-masing bank secara terpisah.  Semua bank yang terhubung dengan Kementerian Kereta Api setuju untuk bekerja sesuai dengan aturan yang sama, yang sangat menyederhanakan interaksi.  Misalnya, Visa, MasterCard, UnionPay, American Express, <s>MIR</s> (tidak, MIR tidak bekerja di luar negeri). <br><br>  <b>Pemegang Kartu</b> - orang yang telah menandatangani perjanjian layanan kartu dengan bank penerbit. <br><br><h1>  Apa perbedaan antara kartu biasa dari Apple Pay atau Google Pay? </h1><br>  Prosedur untuk menghubungkan kartu bank ke sistem Apple Pay atau Google Pay karena proses yang tidak dapat dipahami sering menimbulkan kesalahpahaman bahkan di kalangan profesional TI.  Saya telah mendengar banyak mitos berbeda tentang teknologi ini. <br><br><h4>  Mitos Bayar Apple Populer </h4><br><ul><li>  <b><font color="D13CB8">Kartu disalin ke telepon</font></b> <br>  Ini tidak demikian, kartu mikroprosesor berisi area memori yang dilindungi dengan informasi kriptografi yang tidak dapat diekstraksi setelah kartu dikeluarkan.  Karena itu, kartu chip tidak dapat disalin, dengan cara apa pun, sama sekali.  <i><font color="99999">Dalam keadilan, harus dikatakan bahwa serangan semacam itu mungkin terjadi, tetapi biayanya melebihi jumlah total uang yang akan dihabiskan sebagian besar pembaca artikel ini sepanjang hidup mereka.</font></i> </li><li>  <b><font color="D13CB8">Setiap kali telepon terhubung ke Internet selama pembayaran</font></b> <br>  Google Pay / Apple Pay tidak terhubung ke Internet selama pembayaran melalui terminal POS.  Semua informasi yang diperlukan disimpan secara lokal di telepon. </li><li>  <b><font color="D13CB8">Nomor kartu (PAN) baru dihasilkan untuk setiap pembayaran</font></b> <br>  Mungkin terlihat begitu jika Anda membaca siaran pers Apple tentang teknologi Apple Pay.  Tapi ini adalah interpretasi yang salah dari konsep token.  Bahkan, detail kartu virtual tetap tidak berubah untuk waktu yang lama, Anda dapat memeriksanya dengan angka terakhir dari nomor kartu dalam slip (cek bank) saat membayar pembelian. </li><li>  <b><font color="D13CB8">Saat membayar melalui Apple Pay / Google Pay, dikenakan biaya tambahan</font></b> <br>  Ini tidak demikian, Anda akan membayar persis seperti yang ditunjukkan pada label harga, dan sesuai dengan ketentuan perjanjian Anda dengan bank penerbit kartu yang Anda tautkan. </li><li>  <b><font color="D13CB8">Uang bisa didebet dua kali</font></b> <br>  Mitos ini berlaku tidak hanya untuk Google Pay / Apple Pay, tetapi juga untuk kartu bank biasa.  Saya percaya itu muncul karena sistem pembayaran angkutan umum, di mana terminal mengurangi uang dari tiket setiap kali disajikan, sehingga Anda dapat mendebit dua kali atau lebih jika Anda membawa kartu secara tidak akurat.  Dalam kasus terminal POS, risiko ini tidak ada, karena terminal berhenti bertukar dengan kartu segera setelah menerima data yang diperlukan. </li></ul><br><br><img src="https://habrastorage.org/webt/z5/mt/og/z5mtogccxmh5picpde0ng_nmnnk.png"><br>  <i><font color="99999">Mengaitkan kartu fisik dengan token di telepon</font></i> <br><br>  Sistem seperti Apple Pay ditenagai oleh <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Spesifikasi Tokenisasi Pembayaran EMV</a> .  Prosedur untuk mengaitkan kartu fisik dan telepon dengan Apple Pay belum dijelaskan secara publik, jadi kami akan menganalisis proses berdasarkan data yang diketahui: <br><br><ol><li>  Penyedia (Google, Apple, Samsung) menerima informasi peta; </li><li>  Melalui MPS, penyedia meminta apakah kartu ini (bank penerbit ini) mendukung Tokenisasi EMV; </li><li>  Di sisi MPS, kartu virtual (token) dihasilkan, yang diunduh ke penyimpanan aman di telepon.  <i><font color="99999">Saya tidak tahu di mana tepatnya kunci pribadi dari kartu virtual dihasilkan, apakah itu dikirim melalui Internet atau dibuat secara lokal di telepon, dalam hal ini tidak masalah.</font></i> </li><li>  Kartu token virtual yang dihasilkan muncul di telepon, operasi yang diinterpretasikan oleh bank penerbit sebagai operasi pada kartu fisik pertama.  Dalam hal memblokir kartu fisik, token juga diblokir. </li></ol><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Browser Anda tidak mendukung video HTML5. <source src="https://zhovner.com/forever/applepay_different_pan.mp4" type="video/mp4"></video></div></div></div><br>  <i><font color="99999">Apple Pay memungkinkan Anda membaca detail kartu virtual.</font></i>  <i><font color="99999">Nomor PAN dan tanggal kedaluwarsa berbeda dari kartu tertaut dari Alfa-Bank Rusia.</font></i>  <i><font color="99999">BIN kartu virtual (480099) ditentukan oleh BANK AMERIKA MBNA.</font></i> <br><br>  Saat membayar melalui telepon, terminal POS melihat VISA atau MasterCard biasa, dan berkomunikasi dengannya seperti halnya dengan kartu fisik.  Kartu token virtual berisi semua atribut kartu biasa: nomor PAN, tanggal kedaluwarsa, dll.  Pada saat yang sama, nomor kartu virtual dan masa berlaku berbeda dari kartu asli terlampir. <br><br><h2>  Skenario 1 - terminal POS biasa </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fw/jz/mj/fwjzmjgmj7beldkf8bh4hdwmlay.jpeg"></div><br>  <i><font color="99999">Penipu terminal POS</font></i> <br><br>  Plot penipuan paling populer di benak orang biasa: penipu dengan terminal yang dihidupkan ditekan terhadap mereka di kerumunan dan menghapus uang.  Kami akan mencoba mereproduksi skenario ini dalam kenyataan. <br><br>  <b>Syaratnya adalah sebagai berikut</b> : <br><br><ul><li>  Penipu memiliki <b>terminal POS biasa yang</b> berfungsi penuh yang terhubung ke bank pengakuisisi, sama seperti di toko dan kurir.  Firmware terminal tidak dimodifikasi.  Dalam kasus kami - Ingenico iWL250.  Ini adalah terminal POS portabel dengan modem GPRS yang mendukung pembayaran tanpa kontak, beroperasi dengan daya baterai dan sepenuhnya mobile. </li><li>  Penipu tidak menggunakan cara teknis tambahan, hanya terminal POS </li><li>  Dana yang didebit dikreditkan ke rekening giro penipu, sesuai dengan semua aturan sistem perbankan </li></ul><br><h3>  Badan hukum </h3><br><img src="https://habrastorage.org/webt/do/f_/qs/dof_qscba68g-7za5caz02pszqi.jpeg"><br><br>  Pertama, kita membutuhkan badan hukum dengan akun berjalan dan mengakuisisi terhubung.  Kami, seperti scammers nyata, tidak akan melihat apa pun atas nama kami, tetapi mencoba untuk membeli badan hukum siap pakai.  orang di situs untuk scammers yang sama.  Untuk melakukan ini, lihat iklan di halaman pertama Google untuk "beli ip" dan "beli ooo". <br><br> <a href=""><img src="https://habrastorage.org/webt/lu/7v/yc/lu7vycgengac_zvziy7cltrjl-k.png"></a> <br>  <i><font color="99999">Menawarkan untuk menjual perusahaan siap pakai dari penipu (dapat diklik)</font></i> <br><br>  Harga sebuah perusahaan di pasar gelap dengan akun lancar berkisar antara 20 hingga 300 ribu rubel.  Saya berhasil menemukan beberapa penawaran LLC dengan terminal POS dari 200 ribu rubel.  Perusahaan semacam itu dibingkai oleh boneka, dan pembeli menerima seluruh paket dokumen, bersama dengan "kartu cache" - ini adalah kartu bank yang diikat ke akun penyelesaian perusahaan boneka.  Dengan kartu seperti itu, penipu dapat menguangkan uang di ATM. <br><br><blockquote>  Untuk mempermudah, kami menganggap bahwa mengakuisisi LLC + rekening bank + dan terminal POS akan membebani penipu <b>100.000 rubel</b> .  Sebenarnya lebih banyak, tetapi kita akan menyederhanakan kehidupan scammer hipotetis kita, mengurangi biaya serangan.  Bagaimanapun, semakin rendah biaya serangan, semakin mudah untuk diimplementasikan. </blockquote><br><h2>  Mari kita curi uang </h2><br>  Jadi, penipu mendapatkan terminal POS dan siap untuk pergi ke tempat yang ramai untuk bersandar pada korban dan mencuri uang dari sakunya.  Dalam percobaan kami, semua korban sudah diinstruksikan tentang niat kami, dan semua upaya untuk menghapus uang dilakukan dengan persetujuan mereka.  Dalam kasus di mana subjek tidak memiliki kartu bank contactless mereka sendiri, mereka diminta untuk memasukkan kartu kami di dompet mereka.  Sebelumnya, subjek mengetahui persis di mana dan bagaimana mereka menyimpan kartu mereka, sehingga penipu tahu sebelumnya di mana kartu contactless berada di dalam tas / saku. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Browser Anda tidak mendukung video HTML5. <source src="https://zhovner.com/forever/nfc_fraud_in_public.mp4" type="video/mp4"></video></div></div></div><br>  <i><font color="99999">Video: penipu mengamuk di pusat perbelanjaan</font></i> <br><br>  Dalam hal penghapusan yang berhasil, transaksi dibatalkan melalui menu terminal, dan uang dikembalikan ke akun subyek.  Untuk keseluruhan durasi percobaan, kami mencoba "mencuri" uang dari 20 subjek di gedung pusat perbelanjaan dan di jalan.  Hasil tes dijelaskan di bawah ini. <br><br><h1>  Masalah: Batas transaksi tanpa PIN </h1><br>  Batas jumlah transaksi maksimum tanpa mengonfirmasi kode PIN dapat diatur baik pada terminal POS itu sendiri (Batas Wajib CVM) dan di sisi bank.  Di Rusia, pembatasan ini sama dengan 1000 rubel. <br><br><hr><br>  <font color="99999"><i><b>UPD</b> Dalam pengaturan kartu, jenis otorisasi metode verifikasi Pemegang Kartu (CVM) dapat ditetapkan sebagai tanda tangan pada cek.</i></font>  <font color="99999"><i>Dalam hal ini, transaksi tanpa kontak akan dilakukan untuk jumlah berapa pun tanpa kode PIN.</i></font> <br><br><hr><br>  Penipu kami memutuskan untuk menghapus 999,99 rubel sekaligus.  Jika Anda diminta untuk mencoba lagi untuk menghapus jumlah di bawah batas dalam periode waktu yang singkat, Anda juga akan diminta untuk memasukkan kode PIN dan, dalam kebanyakan kasus, tidak mungkin untuk menghapus 999,99 rubel beberapa kali berturut-turut.  Oleh karena itu, strategi yang paling optimal adalah tidak lebih dari satu tagihan dari satu kartu. <br><br><div style="text-align:center;"><img width="300" alt="Terminal POS dengan jumlah 999,99" src="https://habrastorage.org/webt/at/kg/lt/atkgltocfv4dmqiutgb-8rbcej8.png"></div><br>  <i><font color="99999">Di Rusia, jumlah maksimum yang didebit tanpa kode PIN adalah 1000 rubel.</font></i> <br><br>  Bahkan, banyak penghapusbukuan dengan jumlah 999,99 rubel dalam waktu singkat dapat memicu sistem anti penipuan di sisi bank yang mengakuisisi, sehingga strategi ini tidak optimal bagi penipu.  Jadi, dalam kehidupan nyata, ia harus memilih jumlah yang lebih beragam, sehingga mengurangi potensi pendapatan. <br><br>  Omong-omong, banyak artikel tentang topik ini dalam bahasa Rusia mengatakan bahwa Anda dapat secara manual menetapkan batas Anda sendiri untuk transaksi tanpa kontak tanpa kode PIN.  Saya tidak dapat menemukan opsi seperti itu di bank-bank utama Rusia.  Mungkin Anda tahu tentang kemungkinan ini?  Ini tentang pembayaran tanpa kontak, dan bukan transaksi chip &amp; pin. <br><br><h2>  Masalah: Banyak kartu di dompet </h2><br>  Ini adalah poin penting dalam skenario serangan ini, karena pada kenyataannya hampir tidak ada yang membawa <b>satu kartu pun</b> di sakunya.  Dalam kebanyakan kasus, kartu disimpan di dompet bersama dengan kartu tanpa kontak lainnya, seperti tiket perjalanan atau kartu bank lainnya. <br><br><div style="text-align:center;"><img width="300" src="https://habrastorage.org/webt/im/x5/j1/imx5j1sci8ml-89qidz1_w8tdow.png" alt="Dompet bengkak kartu"></div><br>  Khususnya, terminal Igenico iWL250 saya, ketika mendeteksi lebih dari satu kartu di bidang aksi dengan SAK yang menunjukkan dukungan untuk protokol 14443-4, mengembalikan kesalahan: "hadir satu kartu." <br><br>  Tetapi tidak semua terminal melakukan ini.  Misalnya, terminal POS VeriFone Sberbank memilih kartu acak dari beberapa.  Beberapa terminal mengabaikan semua kartu jika ada lebih dari satu, tanpa menunjukkan pesan kesalahan. <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Browser Anda tidak mendukung video HTML5. <source src="https://zhovner.com/forever/pos_terminal_declines_few_cards.mp4" type="video/mp4"></video></div></div></div><br>  <i><font color="99999">Mencoba membaca beberapa kartu dalam dompet.</font></i>  <i><font color="99999">Terminal POS mengembalikan kesalahan.</font></i> <br><br><h3>  Anti-tabrakan ISO 14443-3 </h3><br>  Membaca satu kartu khusus dari beberapa bukanlah tugas yang mudah di tingkat fisik.  Untuk mengatasi masalah ini, ada mekanisme antikolonisasi.  Ini memungkinkan Anda memilih satu kartu jika respons diterima dari beberapa kartu sekaligus.  Ini adalah langkah pertama dalam menjalin kontak dengan kartu tanpa kontak dalam protokol ISO-14443A.  Pada tahap ini, pembaca tidak dapat mengetahui kartu mana yang disajikan adalah perbankan.  Satu-satunya pilihan adalah memilih kurang lebih mirip dengan kartu bank, berdasarkan respons SAK (Pilih Akui). <br><br><div style="text-align:center;"><img width="600" src="https://habrastorage.org/webt/_k/ie/yz/_kieyz-qmexulctjyhmfnjyvff8.png"></div>  <i><font color="99999">Nilai bit dalam respons SAK</font></i> <br><br>  Jadi, misalnya, kartu Troika (standar Mifare) yang digunakan dalam angkutan umum Moskow memiliki nilai <b>SAK = 0x08 (b00001000)</b> , di mana bit keenam adalah nol.  Sementara untuk semua kartu bank dalam respons SAK, bit keenam adalah 1, yang berarti dukungan untuk protokol ISO 14443-4. <br><br>  Oleh karena itu, yang dapat dilakukan terminal ketika beberapa kartu terdeteksi pada saat yang sama adalah untuk mengecualikan kartu yang tidak mendukung ISO 14443-4 dan memilih yang serupa dengan perbankan.  Dukungan untuk protokol ISO 14443-4, omong-omong, tidak menjamin bahwa kartu ini akan menjadi kartu bank, tetapi kemungkinan besar, dalam dompet orang biasa tidak akan ada jenis kartu lain yang mendukung ISO 14443-4. <br><br><div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/4l/q0/e_/4lq0e_bzubjholfmtdiu29fmlxe.png"></div><br>  <i><font color="99999">Bagan alir protokol anti-tabrakan</font></i> <br><br>  Dari pengalaman pribadi: meskipun ada protokol anti-tabrakan, jika ada setidaknya tiga kartu tanpa kontak di dompet Anda, <b><font color="red">sangat</font></b> sulit untuk membaca kartu yang diinginkan dengan <b><font color="red">sukses</font></b> .  Sebagian besar upaya menghasilkan kesalahan baca.  Bahkan lebih sulit untuk melakukan ini dalam pelarian, menempel di saku dan tas orang lain. <br><br>  Namun, kami akan menganggap bahwa penipu kami sangat beruntung, dan pembatasan ini tidak mengganggunya. <br><br><h2>  Transaksi Offline vs Online </h2><br>  Dalam kisah-kisah berita yang menakutkan, mereka berbicara tentang scammer dengan terminal POS di mobil kereta bawah tanah, yang menulis uang dari kantong Anda tepat di jalan.  Kisah-kisah ini tidak menyebutkan dari mana scammer mendapatkan Internet seluler dari dalam kereta bawah tanah.  Mungkin terminalnya mendukung transaksi offline? <br><br>  Spesifikasi EMV memungkinkan transaksi offline.  Dalam mode ini, pendebitan terjadi tanpa konfirmasi online dari bank penerbit.  Ini berfungsi, misalnya, dalam transportasi umum di Moskow dan St. Petersburg.  Agar tidak mengambil antrian di pintu masuk bus, sementara terminal menyelesaikan konfirmasi online, mereka membiarkan Anda masuk segera tanpa memeriksa apakah Anda memiliki cukup uang di akun Anda untuk membayar ongkos.  Pada akhirnya, ketika Internet muncul di terminal, transaksi yang ditandatangani dikirim ke bank penerbit.  Jika ternyata saat ini Anda tidak punya uang untuk membayar ongkos, kartu akan ditambahkan ke daftar berhenti di semua terminal di kota.  Anda dapat melunasi hutang melalui akun pribadi Anda dengan nomor kartu.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Baca lebih lanjut</a> tentang membayar bus di St. Petersburg. <br><br>  Secara pribadi, saya tidak bisa mendapatkan terminal POS yang mendukung fungsi ini, jadi dalam skenario dengan terminal POS "sipil" yang biasa, kami tidak akan mempertimbangkan kemungkinan mendebit offline.  Ini tidak mengubah apa pun, kecuali bahwa penyerang akan membutuhkan Internet di terminal, jadi serangan itu, misalnya, di kereta bawah tanah, jauh lebih rumit. <br>  Ada model terminal yang mendukung WiFi, dan secara teori, penipu kami dapat menggunakan WiFi di metro, setelah sebelumnya membeli akses bebas iklan untuk alamat MAC terminal POS-nya sehingga otentikasi tidak perlu dilakukan melalui captive portal, karena pada POS terminal tidak dapat melakukan ini. <br><br><h2>  Hitung untung </h2><br>  Dalam skenario kami, biaya serangan itu 100.000 rubel.  Ini berarti bahwa untuk setidaknya mengembalikan investasi, pahlawan kita perlu menyelesaikan setidaknya 100 transaksi masing-masing 1.000 rubel.  Bayangkan dia cukup gesit dan berlari-lari di kota sepanjang hari, berpegangan erat pada semua orang, sehingga pada akhirnya dia berhasil membuat 120 penghapusan buku yang sukses.  Kami tidak akan mempertimbangkan komisi perolehan (rata-rata 2%), komisi pencairan (4-10%) dan komisi lainnya. <br><br>  Bisakah dia berhasil mencairkan uang menggunakan kartu yang terikat pada akun saat ini? <br><br>  Pada kenyataannya, tidak semuanya begitu sederhana.  <b>Uang akan dikreditkan ke akun penipu hanya dalam beberapa hari!</b>  Selama waktu ini, penipu kita harus berharap bahwa tidak satu pun dari seratus dua puluh korban akan menentang transaksi, yang sangat tidak mungkin.  Oleh karena itu, pada kenyataannya, akun penipu akan diblokir bahkan sebelum uang dikreditkan padanya. <br><br><blockquote>  <i>Jika seseorang memperhatikan bahwa pembelian dilakukan pada kartunya yang tidak dia lakukan, dia harus menghubungi bank penerbit dan mengajukan klaim.</i> <i>         30 ,   ,    —  60 .    -   -,   -     ,          .</i> <br><br> <b> ,           ()</b> <br></blockquote><br><h2>  Kesimpulan </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Biaya serangan dalam skenario kami adalah 100.000 rubel. Bahkan, itu akan beberapa kali lebih tinggi, sehingga penipu akan membutuhkan lebih banyak upaya untuk menghasilkan keuntungan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam skenario kami, penipu selalu menghapuskan 999,99 rubel, yang, kemungkinan besar, akan memerlukan pengoperasian sistem anti penipuan di sisi bank yang mengakuisisi. Pada kenyataannya, penipu perlu menghapuskan jumlah yang lebih kecil. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Untuk setidaknya mengembalikan investasi, penipu perlu memproses beberapa ratus korban. Jika bahkan selusin dari mereka menghubungi bank penerbit dan menyengketakan transaksi, akun penipu kemungkinan besar akan diblokir. Skenario di mana bank yang mengakuisisi berkolusi dengan penipu tidak mungkin, karena lisensi untuk bekerja dengan MPS jauh lebih mahal daripada potensi keuntungan dari jenis penipuan ini.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dari 20 mata pelajaran, hanya tiga yang berhasil menghapus uang dari kartu, yang merupakan 15% keberhasilan dari semua upaya. Ini adalah kasus-kasus buatan ketika ada satu kartu di saku Anda. Dalam kasus dengan dompet dan beberapa kartu, terminal mengembalikan kesalahan. Dalam skenario dengan terminal yang menggunakan firmware yang dimodifikasi dan menerapkan mekanisme anti-tabrakan, persentase biaya yang berhasil mungkin lebih tinggi. Namun, bahkan dalam kasus menggunakan anti-tabrakan, dalam kondisi nyata dalam pelarian, sangat sulit untuk menghitung satu kartu dari beberapa kartu sehingga keberhasilan mendebit dalam kondisi seperti itu dapat dianggap sebagai keberuntungan. Pada kenyataannya, bagian dari penghapusan yang berhasil hampir tidak akan melebihi 10% dari jumlah upaya.</font></font><br><br><blockquote> ,   ,      ,         .    -   ,     . <br></blockquote><br><h2>  2 —  POS- </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Katakanlah scammer kami bekerja di kasir di toko atau kurir dengan terminal POS seluler. </font><font style="vertical-align: inherit;">Dalam hal ini, ia memiliki peluang untuk menangkap data kartu, yang, dalam beberapa kasus, mungkin cukup untuk membayar di Internet. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pertama, mari kita cari tahu bagaimana transaksi tanpa kontak terlihat persis, dan data apa yang ditukar kartu dengan terminal POS. </font><font style="vertical-align: inherit;">Karena kami terlalu malas untuk membaca ribuan halaman dokumentasi </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spesifikasi Tanpa Kontak EMV</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , kami cukup mencegat pertukaran di tingkat fisik menggunakan sniffer HydraNFC. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada beberapa perbedaan antara spesifikasi EMV untuk MasterCard PayPass dan Visa payWave. </font><font style="vertical-align: inherit;">Ini adalah perbedaan dalam format tanda tangan dan beberapa data. </font><font style="vertical-align: inherit;">Tetapi bagi kami ini tidak penting.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pelacak NFC </font></font></h2><br><img src="https://habrastorage.org/webt/bs/sx/oy/bssxoy5b-wmgyab33hakrihmfyc.png"><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HydraNFC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> adalah sniffer mandiri open-source ISO-14443A sepenuhnya yang menyimpan perintah APDU yang dicegat ke kartu SD. </font><font style="vertical-align: inherit;">Antena sniffer terletak di antara terminal dan kartu, dan secara pasif menangkap semua informasi yang dikirimkan. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Situs web tentang HydraBus dan perisai HydraNFC</font></font></a> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> → </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sumber firmware</font></font></a> <br><br><div class="oembed"><div><div style="left: 0; width: 100%; height: 0; position: relative; padding-bottom: 56.25%;"><video controls="" style="top: 0; left: 0; width: 100%; height: 100%; position: absolute;">  Browser Anda tidak mendukung video HTML5. <source src="https://zhovner.com/forever/hydranfc_pos_terminal_sniff.mp4" type="video/mp4"></video></div></div></div><br> <i><font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Demonstrasi intersepsi pertukaran antara terminal POS dan telepon dengan Apple Pay</font></font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Ke depan, saya harus mengatakan bahwa pada tingkat ini pembayaran melalui telepon dan kartu plastik biasa tidak berbeda. </font><font style="vertical-align: inherit;">Untuk terminal POS, ini adalah kartu VISA biasa. </font><font style="vertical-align: inherit;">Namun, membayar melalui telepon jauh lebih aman daripada menggunakan kartu fisik, dan kemudian kita akan menganalisis alasannya.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Penguraian protokol EMV </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Inilah yang terlihat seperti tempat pembuangan sampah saat membayar cokelat dan sebotol air dengan nilai total 142,98 rubel menggunakan Apple Pay: </font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data mentah diterima dari sniffer (spoiler terbuka)</font></font></b> <div class="spoiler_text"><a href=""><img width="200" src="https://habrastorage.org/webt/ia/by/xg/iabyxg1ocokwqruiq9ew3qmwqws.png"></a><br>
<i><font color="99999">      ()</font></i><br>
<br>
<b>R (READER)</b> — POS-<br>
<b>T (TAG)</b> —  (   )<br>
<code>R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
R&gt;&gt; 52 <br>
T&lt;&lt; 04 00<br>
R&gt;&gt; 93 20 <br>
T&lt;&lt; 08 fe e4 ec fe <br>
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e <br>
T&lt;&lt; 20 fc 70 <br>
R&gt;&gt; 50 00 57 cd <br>
R&gt;&gt; 26 <br>
R&gt;&gt; 52 <br>
T&lt;&lt; 04 00 <br>
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e <br>
T&lt;&lt; 20 fc 70 <br>
R&gt;&gt; e0 80 31 73 <br>
T&lt;&lt; 05 78 80 70 02 a5 46 <br>
R&gt;&gt; 02 00 a4 04 00 0e 32 50 41 59 2e 53 59 53 2e 44 44 46 30 31 00 e0 42 <br>
T&lt;&lt; 02 6f 23 84 0e 32 50 41 59 2e 53 59 53 2e 44 44 46 30 31 a5 11 bf 0c 0e 61 0c 4f 07 a0 00 00 00 03 10 10 87 01 01 90 00 4b b3 <br>
R&gt;&gt; 03 00 a4 04 00 07 a0 00 00 00 03 10 10 00 bc 41 <br>
T&lt;&lt; 03 6f 31 84 07 a0 00 00 00 03 10 10 a5 26 9f 38 18 9f 66 04 9f 02 06 9f 03 06 9f 1a 02 95 05 5f 2a 02 9a 03 9c 01 9f 37 04 bf 0c 08 9f 5a 05 60 08 40 06 43 90 00 1d 66 <br>
R&gt;&gt; 02 80 a8 00 00 23 83 21 36 a0 40 00 00 00 00 01 42 98 00 00 00 00 00 00 06 43 00 00 00 00 00 06 43 18 09 18 00 e0 11 01 03 00 f9 14 <br>
T&lt;&lt; 02 77 62 82 02 00 40 94 04 18 01 01 00 9f 36 02 02 06 9f 26 08 d6 f5 6b 8a be d7 8f 23 9f 10 20 1f 4a ff 32 a0 00 00 00 00 10 03 02 73 00 00 00 00 40 00 00 00 00 00 00 00 00 00 00 00 00 00 00 9f 6c 02 00 80 57 13 48 00 99 72 50 51 17 56 d2 31 22 01 00 00 05 20 99 99 5f 9f 6e 04 23 88 00 00 9f 27 01 80 90 00 af c8 <br>
R&gt;&gt; 03 00 b2 01 1c 00 c9 05 <br>
T&lt;&lt; 03 70 37 5f 28 02 06 43 9f 07 02 c0 00 9f 19 06 04 00 10 03 02 73 5f 34 01 00 9f 24 1d 56 30 30 31 30 30 31 34 36 31 38 30 34 30 31 37 37 31 30 31 33 39 36 31 36 37 36 32 35 90 00 a7 7b <br>
</code><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita menguraikan setiap baris dari dump yang dicegat secara terpisah. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">R &gt;&gt; - data yang dikirimkan oleh terminal POS </font></font></b><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">T &gt;&gt; - data yang dikirimkan oleh kartu (dalam kasus kami, telepon dengan Apple Pay)</font></font></b><br>
<br>
<h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">14443-A Pilih</font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Di awal pertukaran, terminal membuat koneksi dengan kartu di tingkat saluran. </font><font style="vertical-align: inherit;">Bagi mereka yang terbiasa dengan jaringan dan model OSI, akan lebih mudah untuk menyajikan ini sebagai tingkat L2, dan UID (Pengidentifikasi Unik) kartu sebagai alamat MAC host.</font></font><br>
<br>
<blockquote><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dalam terminologi standar ISO-14443: </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PCD</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (proximity coupling device) adalah nama pembaca, dalam kasus kami ini adalah </font></font><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PICC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> terminal-PIC </font><font style="vertical-align: inherit;">(proximity circuit circuit card) adalah sebuah kartu, dalam kasus kami telepon memainkan peran ini</font></font><br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Perbedaan penting antara kartu pembayaran reguler dari Apple Pay adalah bahwa kartu selalu dapat dibaca dan tidak memungkinkan Anda untuk mengontrol proses membaca. Itu dapat secara tak terkendali membaca pakaian, sementara telepon, jatuh ke dalam bidang tindakan pembaca, meminta pengguna untuk mengaktifkan kartu virtual. Sampai pengguna mengonfirmasi, ponsel tidak mengirimkan data apa pun, dan pembaca bahkan tidak tahu bahwa ada kartu virtual di dekatnya.</font></font><br>
<br>
<pre><code class="plaintext">R&gt;&gt; 52 // WUPA (wake up)<font></font>
R&gt;&gt; 52 // WUPA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
T&lt;&lt; 04 00 // ATQA (Answer To Request type A) <font></font>
R&gt;&gt; 93 20 // Select cascade 1 (Anti Collision CL1 SEL)<font></font>
T&lt;&lt; 08 fe e4 ec fe // UID (4 bytes) + BCC (Bit Count Check)<font></font>
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e // SEL (select tag 0x9370) + UID + CRC16<font></font>
T&lt;&lt; 20 fc 70  // SAK (Select Acknowledge 0x20) + CRC16 <font></font>
R&gt;&gt; 50 00 57 cd // HALT (Disable communocaion 0x5000) + CRC16<font></font>
R&gt;&gt; 26 // REQA<font></font>
R&gt;&gt; 52 // WUPA<font></font>
T&lt;&lt; 04 00 // ATQA<font></font>
R&gt;&gt; 93 70 08 fe e4 ec fe dd 6e // SELECT<font></font>
T&lt;&lt; 20 fc 70 // SAK<font></font>
R&gt;&gt; e0 80 31 73 // RATS (Request Answer to Select 0xE080) + CRC16<font></font>
T&lt;&lt; 05 78 80 70 02 a5 46 // ATS (Answer to select response)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal terus-menerus mengirimkan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">perintah</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wake-up (WUPA) 0x52, dan segera setelah kartu muncul di bidang tindakan, </font><font style="vertical-align: inherit;">terminal </font><font style="vertical-align: inherit;">merespons dengan perintah Answer To Request tipe A (ATQA), dalam kasus kami adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x04 0x00</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Respons ATQA dapat bervariasi menurut produsen chip. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menerima respons ATQA, terminal memulai prosedur deteksi tabrakan untuk menentukan apakah ada lebih dari satu kartu di bidang tindakan. Perintah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x93 0x20</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Select cascade level 1 (SEL CL1) meminta semua kartu di bidang tindakan untuk melaporkan bagian pertama UID mereka. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kartu merespons dengan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x08 0xFE 0xE4 0xEC 0xFE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , empat byte pertama adalah UID kartu virtual Apple Pay dan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xFE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Bit Count Check (BCC) pada akhirnya.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah menerima pengidentifikasi kartu, pembaca mengakses kartu khusus dengan perintah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x93 0x70</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (SELECT). Untuk sebuah tim untuk menjadi kartu UID </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x08 0xFE 0xe4 0xec</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xFE</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> BCC + </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xdd 0x6e</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CRC16. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kartu merespons dengan </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x20</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Pilih Pengakuan (SAK) + </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xfc 0x70</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CRC16. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika beberapa respons SAK diterima pada langkah ini, pembaca dapat mengurangi panjang UID dalam perintah SELECT hingga satu kartu merespons. Namun, seperti yang ditunjukkan di atas, beberapa terminal POS menolak untuk melanjutkan jika tabrakan terdeteksi pada tahap ini, yaitu adanya beberapa kartu pada saat yang sama.</font></font><br>
<br>
<blockquote> UID   4, 7  10 .    ,   ,      Apple Pay, UID   4 . ,  Apple Pay   UID   ,     ,  UID  . ,     ,         ,       UID     . <br>
</blockquote><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pembaca mengirimkan perintah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x50 0x00</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> HALT + </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x57 0xcd</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CRC16. Ini adalah perintah terminasi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kemudian prosedur diulangi lagi, pembaca membangunkan kartu lagi (WUPA), tetapi tanpa memeriksa tabrakan, SELECT segera dieksekusi. Mengapa ini dilakukan - saya tidak tahu, mungkin ini adalah cara yang lebih dapat diandalkan untuk menentukan tabrakan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kali kedua pembaca sudah mengirimkan perintah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xE0 0x80</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Minta Jawaban untuk Memilih (RATS) + </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x31 0x73</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CRC16. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kartu merespons </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x05 0x78 0x80 0x70 0x02</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jawaban untuk memilih respons (ATS) + </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0xA5 0x46</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CRC16. </font></font><br>
<br>
<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jawab untuk memilih</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Jawabannya mirip dengan Answer To Reset (ATR) untuk kartu kontak. </font><font style="vertical-align: inherit;">Ini berisi informasi tentang ukuran bingkai maksimum dan parameter lapisan tautan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pada tahap ini, level "saluran" selesai, kemudian pertukaran dimulai pada protokol level yang lebih tinggi, tergantung pada aplikasi yang terdapat pada kartu. </font><font style="vertical-align: inherit;">Operasi SELECT adalah sama untuk semua kartu tanpa kontak dengan standar ISO 14443A, termasuk tag NFC, tiket angkutan umum, dll.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Permintaan untuk aplikasi yang tersedia - SELECT PPSE</font></font></h4><br>
<font color="grey"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Deskripsi resmi: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spesifikasi Tanpa Kontak EMV - PPSE dan Manajemen Aplikasi untuk Elemen Aman</font></font></a></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Awal komunikasi dengan kartu EMV selalu terjadi dengan membaca PPSE (Lingkungan Sistem Pembayaran). </font><font style="vertical-align: inherit;">Terminal menanyakan kartu apa aplikasi pembayaran yang ada di dalamnya. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Paling sering ini adalah satu aplikasi, seperti dalam contoh kita - VISA. </font><font style="vertical-align: inherit;">Namun, ada kartu dengan beberapa aplikasi pembayaran, misalnya, ada kartu MIR domestik khusus dengan dua aplikasi pembayaran di dalamnya. </font><font style="vertical-align: inherit;">Karena sistem pembayaran MIR tidak berfungsi di luar negeri, aplikasi pembayaran kedua terintegrasi ke dalam kartu, bahkan kartu kedua. </font><font style="vertical-align: inherit;">Ini bisa berupa aplikasi sistem pembayaran JCB atau UnionPay. </font><font style="vertical-align: inherit;">Kartu-kartu semacam itu disebut cobaging. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perintah PPSE APDU SELECT</font></font></b><br>
<br>
<pre><code class="cpp">'00 A4 04 00 0E 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 00'<font></font>
  00 A4 04 00 //  select <font></font>
   0E //  command data (14 )<font></font>
    32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 // command data 2PAY.SYS.DDF01<font></font>
    00 //  <font></font>
</code></pre><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Balas ke SELECT PPSE</font></font></b><br>
<br>
<pre><code class="cpp">'6F 23 84 0E 32 50 41 59 2E 53 59 53 2E 44 44 46 30 31 A5 11 BF 0C 0E 61 0C 4F 07 A0 00 00 00 03 10 10 87 01 01 90 00'</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Untuk kenyamanan, kami akan menganalisis jawabannya menggunakan parser online format TVL </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iso8583.info/lib/EMV/TLVs</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Jawaban yang sama diproses oleh parser: </font></font><br>
<br>
<img width="900" alt="EMV SELECT PPSE VISA RESPONE diuraikan" src="https://habrastorage.org/webt/yi/x_/_y/yix__y6me7kqdg9inwi05eyk1yq.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dari semua ini, kami hanya tertarik pada pengenal aplikasi pembayaran (AID). Dalam hal ini, nilai ini adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A0000000031010</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , yang berarti Visa Internasional. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AID ditandai dengan penanda </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4F</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Bit kedua setelah token adalah panjang data yang dikandungnya. Meskipun panjang AID dapat bervariasi dari 5 hingga 16 byte, dalam kebanyakan kasus itu adalah 7 byte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daftar Besar AID: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">eftlab.co.uk/knowledge-base/211-emv-aid-rid-pix</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Beberapa </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;">AID</font></a><font style="vertical-align: inherit;"> Populer</font></font><br>
<br>
<pre><code class="plaintext">A0000000031010 Visa International<font></font>
A0000000032020 Visa International<font></font>
A0000000041010 Mastercard International<font></font>
A0000000043060 Mastercard International United States Maestro (Debit)<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Indikator Prioritas Aplikasi - menunjukkan prioritas aplikasi pembayaran. </font><font style="vertical-align: inherit;">Misalnya, dalam pembuatan kartu MIR yang memiliki beberapa aplikasi pembayaran di dalam, bidang ini menunjukkan yang mana dari dua aplikasi yang diprioritaskan. </font><font style="vertical-align: inherit;">Karena kami hanya memiliki satu aplikasi Visa International, itu menunjuk ke sana dan tidak ada prioritas. </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Buka aplikasi pembayaran - SELECT AID</font></font></b><br>
<br>
<pre><code class="cpp">'00 A4 04 00 07 A0 00 00 00 03 10 10'<font></font>
  00 A4 04 00 //  select <font></font>
   07 //  command data (7 )<font></font>
    A0 00 00 00 03 10 10 // AID Visa International<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Setelah memilih aplikasi pembayaran yang diperlukan, terminal meluncurkannya. </font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PDOL (Memproses Opsi Daftar Objek Data)</font></font></h4><br>
<pre><code class="cpp">'6f 31 84 07 a0 00 00 00 03 10 10 a5 26 9f 38 18 9f 66 04 9f 02 06 9f 03 06 9f 1a 02 95 05 5f 2a 02 9a 03 9c 01 9f 37 04 bf 0c 08 9f 5a 05 60 08 40 06 43 90 00'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita parsing jawaban dengan parser </font></font><br>
<br>
<img src="https://habrastorage.org/webt/lo/jr/dh/lojrdhsptl6kkauc02a5c0qwnme.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sebagai tanggapan terhadap peluncuran aplikasi pembayaran, kartu melaporkan seperangkat parameter yang diharapkan akan diterima dari terminal - PDOL (Memproses Opsi Data Objek Daftar). </font><font style="vertical-align: inherit;">Terminal harus merespons sesuai dengan urutan ini. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PDOL untuk kartu yang berbeda dapat bervariasi. </font><font style="vertical-align: inherit;">Jumlah total parameter PDOL adalah beberapa puluh. </font><font style="vertical-align: inherit;">Daftar lengkap parameter PDOL dapat ditemukan di </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sini</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita lihat lebih dekat pada PDOL. </font><font style="vertical-align: inherit;">Panjang yang ditunjukkan setelah penanda adalah panjang respons yang diharapkan dari terminal terhadap permintaan ini. </font><font style="vertical-align: inherit;">Jawaban kosong diisi dengan nol hingga panjang yang diinginkan. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Permintaan parsing PDOL:</font></font><br>
<br>
<pre><code class="cpp">9F 38 18 //   PDOL.  18 (24 ) <font></font>
 9F 66 ( 04) // Terminal Transaction Qualifiers (TTQ).    . <font></font>
  9F 02 ( 06) //  <font></font>
   9F 03 ( 06) //  <font></font>
   9F 1A ( 02) //     ISO3166-1<font></font>
   95 ( 05) // Terminal Verification Results<font></font>
    5F 2A ( 02) //  ,    ,   ISO4217<font></font>
     9A ( 03) //    YYMMDD<font></font>
      9C ( 01) //   <font></font>
       9F 37 ( 04) //   <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hingga saat ini, semua data yang dikirimkan sama untuk setiap transaksi pada kartu ini.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Permintaan Biaya - DAPATKAN OPSI PENGOLAHAN </font></font></h4><br>
<pre><code class="cpp">'80A8000023832136A0400000000001429800000000000006430000000000064318091800E011010300'<font></font>
 80 A8 00 00 //  GET PROCESSING OPTIONS (GPO)<font></font>
  23 //    (35 )<font></font>
   83 //  PDOL-<font></font>
    21 //  PDOL- (33 )<font></font>
     36 A0 40 00 // Terminal Transaction Qualifiers (TTQ)<font></font>
      00 00 00 01 42 98 //   (142,98 )<font></font>
       00 00 00 00 00 00 //   <font></font>
        06 43 //    (643 - )<font></font>
         00 00 00 00 00 // Terminal Verification Results (TVR)<font></font>
          06 43 //  (643 - russian ruble) <font></font>
           18 09 18 //  (18  2018 )<font></font>
            00 //  <font></font>
             E0 11 01 03 //   <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jawaban ini jelas menunjukkan bagaimana terminal, yang terletak di Rusia, meminta untuk didebit dari kartu dalam jumlah 142,98 rubel. </font><font style="vertical-align: inherit;">Kami menarik perhatian ke nomor acak di akhir (E0110103). </font><font style="vertical-align: inherit;">Ini adalah parameter </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F37 Nomor Tidak Dapat Diprediksi</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Ini adalah penyebutan pertama dari kriptografi. </font><font style="vertical-align: inherit;">Di masa mendatang, nomor ini, bersama dengan data transaksi, kartu harus masuk dengan tanda tangan kriptografi. </font><font style="vertical-align: inherit;">Ini memberikan terminal kontrol atas relevansi tanda tangan dari kartu dan melindungi terhadap serangan replay.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Respons kartu terhadap DAPATKAN OPSI PENGOLAHAN </font></font></h4><br>
<pre><code class="cpp">'7762820200409404180101009F360202069F2608D6F56B8ABED78F239F10201F4AFF32A00000000010030273000000004000000000000000000000000000009F6C02008057134800997250511756D23122010000052099995F9F6E04238800009F2701809000'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jawaban ini berisi bidang data khusus VISA, jadi saya menggunakan parser dengan dukungan untuk </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Spesifikasi Pembayaran Tanpa Kontak VISA (VCSP)</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br>
<img width="600" src="https://habrastorage.org/webt/n-/b0/la/n-b0laaskytjo0ahyyvlo6e7js0.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Application Interchange Profile (AIP) - berisi informasi tentang parameter aplikasi pembayaran. Dalam kasus kami, AIP adalah </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">00 40</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pertimbangkan nilai-nilai parameter ini dari </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EMV 4.3 Buku 3</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div style="text-align:center;"><img width="400" src="https://habrastorage.org/webt/rp/tc/ya/rptcyalvdwd6oaycintkbt02krq.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kasus kami, satu bit diatur dalam byte kedua, yang, menurut tabel ini, dicadangkan untuk Penggunaan Masa Depan (RFU). Apa artinya ini, dan apa gunanya berinvestasi di Apple Pay, saya tidak tahu. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
AIP berisi informasi penting tentang metode otentikasi yang didukung (SDA, CDA, DDA) pembayaran. Mengapa dalam kasus saya semua bendera ini sama dengan nol - Saya tidak mengerti. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Application File Locator (AFL) - Berisi SFI rentang informasi catatan dalam AID tertentu. Berdasarkan respons ini, terminal akan menghasilkan permintaan READ RECORD. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Mari kita menganalisis jawaban AFL lebih terinci: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Short File Identifier (SFI) adalah 0x18. Parameter ini dikodekan dengan lima bit, bukan delapan. Dengan demikian, nilai 0x18 (b00011000) dikonversi ke b00000011, dan kami mendapatkan 0x3. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rekor pertama = 1</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Rekor terakhir = 1 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
yaitu. dalam "folder" No. 3 ada entri dari 1 hingga 1, yaitu, satu entri. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Application Transaction Counter (ATC) adalah counter transaksi tambahan yang bertambah satu setiap kali OPSI PENGOLAHAN MENDAPAT diminta. Setelah mencapai nilai 0xFFFF atau 0x7FFF, aplikasi pembayaran akan diblokir secara permanen. Saya percaya bahwa ini dilakukan untuk melindungi terhadap kekuatan kasar dari kunci pribadi kartu. Dalam kasus kami, dapat dilihat bahwa iPhone dengan Apple Pay ini sudah digunakan untuk membayar 518 (0x206) kali.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Application Cryptogram (AC) - tanda tangan kriptografi yang dihitung oleh kartu menggunakan kunci privatnya. Tanda tangan ini dikirimkan bersama dengan sisa data ke bank penerbit, dan keaslian transaksi diverifikasi berdasarkan basisnya. Karena kunci pribadi kartu tidak dapat (cara diakses) diambil dari kartu, ini menghilangkan kemungkinan menyalin kartu. </font></font><br>
 <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Data Aplikasi Penerbit (IAD) - Berisi data eksklusif untuk VISA. </font></font><i><font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya tidak menguasai analisis struktur ini, tolong.</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Kualifikasi Transaksi Kartu (CTQ) - daftar spesifik kartu yang didukung oleh VISA. Misalnya, apakah mungkin untuk menggunakan kartu tanpa kontak ini untuk transaksi di ATM atau tidak, dan konfirmasi seperti apa yang diperlukan. </font></font><br>
<br>
<img align="right" width="200" src="https://habrastorage.org/webt/vd/aw/ny/vdawnyz0tkkjbs-rradkbk0loiy.png"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lacak 2 Data Setara - </font></font><font color="red"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Oppa!</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bidang ini berisi nomor kartu dan tanggal kedaluwarsa, detail lebih lanjut tentang informasi ini akan dibahas nanti. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Form Facto Indicator (FFI) - bidang khusus VISA. </font><font style="vertical-align: inherit;">Menjelaskan faktor bentuk dan karakteristik perangkat pembayaran. </font><font style="vertical-align: inherit;">Dalam kasus kami, jelas bahwa ini adalah ponsel. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Data Informasi Kriptogram (CID) - </font></font><i><font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya belum menguasai analisis struktur ini, tolong.</font></font></font></i><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BACA permintaan REKAM DATA</font></font></h4><br>
<pre><code class="cpp">'00 b2 01 1c 00'
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Terminal mengirim permintaan untuk membaca catatan yang diterima dari AFL: </font></font><br>
<br>
<img src="https://habrastorage.org/webt/od/jw/mv/odjwmvemclc5gd4q6dhvlcmqfjy.png"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam kasus ini, mulai dari byte </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0x1C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dibaca sebagai dua nilai, di mana lima bit pertama adalah 0x18 (b000011) dan SFI, dan tiga bit berikutnya adalah 0x04 (d100), dan membuat nomor catatan.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Balas ke READ RECORD</font></font></h2><br>
<pre><code class="cpp">'70375F280206439F0702C0009F19060400100302735F3401009F241D5630303130303134363138303430313737313031333936313637363235'
</code></pre><br>
<img src="https://habrastorage.org/webt/x9/ke/vv/x9kevvho_se85wg6vlgkwrd4jtw.png"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Application Usage Control (AUC) - menentukan apakah diizinkan untuk membayar dengan kartu di luar negeri, dan jenis operasi yang diizinkan. </font></font><br>
<br>
<i><font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9F19 adalah sesuatu yang tidak dapat dipahami, tampaknya - Daftar Obyek Data Otentikasi Data Dinamis (DDOL)</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
EMV yang sudah ketinggalan zaman, Referensi Akun Pembayaran (PAR) adalah parameter khusus untuk kartu token (virtual). </font></font><i><font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Saya tidak menguasai analisis struktur ini, tolong.</font></font></font></i><br>
<br>
<h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apa yang bisa diekstraksi dari transaksi yang dicegat?</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Kami menganalisis satu contoh spesifik dari lalu lintas yang dicegat dari transaksi tanpa kontak Apple Pay dengan kartu VISA yang ditautkan. Protokol MasterCard sedikit berbeda, tetapi secara keseluruhan serupa. Dari analisis dapat dilihat bahwa transaksi dilindungi oleh crypto-signature, dan protokol dilindungi dari serangan replay. </font></font><i><font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ada protokol pembayaran contactless yang ketinggalan zaman dalam mode Magnetic Stripe (MSD), yang jauh lebih terlindungi dari serangan replay, tetapi dalam artikel ini saya tidak akan membongkarnya, karena, sejauh yang saya tahu, hampir tidak didukung dalam CIS, mungkin saya salah. </font></font></font><br>
</i><br>
<img src="https://habrastorage.org/webt/ys/kk/8_/yskk8_eztdatvwiziqusnqsa2ee.png"><br>
<i><font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dari data yang dicegat, Anda dapat mengekstrak nomor kartu (PAN) dan tanggal kedaluwarsa</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Seperti yang Anda lihat, dari lalu lintas yang dicegat, Anda dapat mengekstrak nomor kartu lengkap dan tanggal kedaluwarsa. </font><font style="vertical-align: inherit;">Meskipun CVV tidak ada dalam dump ini, data ini sudah cukup untuk membayar di beberapa toko online. </font><font style="vertical-align: inherit;">Dalam kasus kartu plastik fisik biasa, data yang dicegat akan berisi </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PAN yang sama dan tanggal kedaluwarsa yang tertera pada kartu itu sendiri!</font></font></b><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pembayaran internet tanpa CVV (CNP, MO / TO)</font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dalam artikel saya sebelumnya </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Kami menggunakan kartu Apple Pay dan Troika sebagai izin untuk bekerja"</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tentang ACS berdasarkan Apple Pay, saya dikritik dalam komentar, mengatakan bahwa dengan hanya 10 digit kartu terakhir Anda dapat mencuri uang. Dalam dump di atas, tidak hanya jumlah penuh kartu saya ditunjukkan, tetapi juga tanggal kedaluwarsa. Data ini cukup untuk membayar di beberapa toko di Internet. Nah, coba lakukan itu. </font></font><br>
<br>
<img src="https://habrastorage.org/webt/ue/-q/wt/ue-qwtah0au0uftojwdu8qsrs3m.png"><br>
<i><font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Formulir penambahan kartu Amazon tidak memerlukan CVV</font></font></font></i><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Jika itu nomor kartu fisik, uang memang bisa dicuri, tetapi data token Apple Pay HANYA dapat digunakan untuk operasi Client Present (CP) ketika kartu menandatangani transaksi kriptografi dengan tanda tangan. </font><font style="vertical-align: inherit;">Data ini tidak dapat digunakan untuk pembayaran di Internet dan operasi lain seperti Kartu tidak ada (CNP), yaitu melalui telepon atau email. </font><font style="vertical-align: inherit;">Itu dia! </font></font><br>
<br>
<font color="r"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kepada semua orang yang ingin memverifikasi ini, saya memberitahu Anda bahwa perincian dari tempat pembuangan Apple Pay yang dicegat di atas saat ini relevan dan terkait dengan kartu yang valid yang memiliki uang. </font><font style="vertical-align: inherit;">Pada saat penulisan, ini adalah 5 ribu rubel. </font><font style="vertical-align: inherit;">Saya sarankan mencoba mencuri mereka :)</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mengapa Apple Pay lebih aman daripada kartu biasa?</font></font></h2><br>
<div style="text-align:center;"><img width="500" src="https://habrastorage.org/webt/jz/cn/2n/jzcn2ndu1pfw-znat4mxtab6k8k.png"></div><br>
<i><font color="99999"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Apple Pay vs kartu contactless biasa</font></font></font></i><br>
<br>
<ul>
<li> <b>Apple Pay   (  )    .</b>            POS-.  , «»        ,       ,   ,     ,   ,   .  Apple Pay  ,            ,       .</li>
<li><b>     </b> —    Apple Pay      (13,56 ),   ,           .       .     Apple Pay     ,     .</li>
<li><b>       </b> —         Card not present (CNP),      ,    ..     Apple Pay    . </li>
<li><b>   </b> —        (Cardholder name)    .   ,   ,    .  Apple Pay    . </li>
</ul><br>
<h2></h2><br>
     .     ,         .         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">   </a>.<br>
<br>
  , Apple Pay     .      CNP- (  )    ,         .<br>
<br>
<hr><br>
 :<br>
<br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Perusahaan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tehpos.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk hardware.</font></font></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bank Ural untuk Rekonstruksi dan Pengembangan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , dan secara pribadi kepada Alexander Paderin (Direktur Pelaksana Pusat Keamanan Informasi) untuk konsultasi.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menyimpan </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aj.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk menyediakan iPhone untuk pengujian.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Valeria </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aquamine</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk ilustrasi untuk artikel ini.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gleb </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JRun</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dari Digital Security untuk saran teknis.</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexander </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AlexGre</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> untuk konsultasi tentang protokol EMV.</font></font></li>
<li><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bentuk</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Habrauser </font><font style="vertical-align: inherit;">untuk parser EMV yang sangat baik: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">iso8583.info</font></font></a></li>
</ul></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id422551/">https://habr.com/ru/post/id422551/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id422541/index.html">Drama lubang di Union berubah menjadi phantasmagoria</a></li>
<li><a href="../id422543/index.html">Berpikirlah seperti seorang programmer. Tutorial Pemecahan Masalah</a></li>
<li><a href="../id422545/index.html">Cara menyinkronkan tab browser</a></li>
<li><a href="../id422547/index.html">Untuk menghilangkan Specter dan Meltdown, Anda mungkin harus membuat jenis prosesor yang sama sekali baru</a></li>
<li><a href="../id422549/index.html">Corda: Kotlin</a></li>
<li><a href="../id422553/index.html">Ekstensi browser resmi Mega mencuri data berbagi file dan cryptocurrency</a></li>
<li><a href="../id422555/index.html">Arsitektur multi-modul Android. A hingga Z</a></li>
<li><a href="../id422561/index.html">Bagaimana Yandex menerapkan visi komputer untuk meningkatkan kualitas siaran video. Teknologi DeepHD</a></li>
<li><a href="../id422565/index.html">Webmaster Skillbox Friday: Semuanya untuk Programer dan Desainer</a></li>
<li><a href="../id422569/index.html">Setiap jam, aplikasi pelacakan waktu</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>