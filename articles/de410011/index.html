<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ò∏Ô∏è üöÆ üî∫ Die Geschichte der Erstellung einer Home Cloud. Teil 3. Erstellen einer pers√∂nlichen Cloud - Installieren und Konfigurieren von Nextcloud üç± üôåüèΩ üìë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Auf dem Weg zur Erstellung unseres eigenen Cloud-Service haben wir uns an das Debian-System gew√∂hnt und einen Webserver erstellt . Jetzt ist es Zeit f...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Die Geschichte der Erstellung einer Home Cloud. Teil 3. Erstellen einer pers√∂nlichen Cloud - Installieren und Konfigurieren von Nextcloud</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/410011/">  Auf dem Weg zur Erstellung unseres eigenen Cloud-Service haben wir uns <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">an das Debian-System gew√∂hnt</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">einen Webserver erstellt</a> .  Jetzt ist es Zeit f√ºr den letzten Schritt - das Erstellen und Konfigurieren einer pers√∂nlichen Cloud basierend auf dem Nextcloud-Server. <br><br><img src="https://habrastorage.org/webt/hd/zf/np/hdzfnpy3coj3pu5hr6xs8ssjop8.jpeg"><br><a name="habracut"></a><br><hr><a name="chap0"></a><br><h3>  Inhaltsverzeichnis </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Teil 1. Einrichten Ihrer Debian-Umgebung f√ºr den t√§glichen Gebrauch</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Teil 2. Server erstellen - LAMP in Debian einrichten</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Teil 3. Erstellen einer pers√∂nlichen Cloud - Installieren und Konfigurieren von Nextcloud</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">Teil 4. Update 2018 - Debian 9 und Nextcloud 13</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 5. Aktualisierung 2019 - PHP 7.2, MariaDB 10.4 und Nextcloud 17</a> <br><br><hr><br><h3>  Schnelle Kapitelnavigation </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vorwort</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vorbereiten eines Servers f√ºr die Installation von Nextcloud</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Installieren Sie Nextcloud</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Organisation des Nextcloud-Speichers</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Konfigurieren Sie den Nextcloud Virtual Machine-Zugriff √ºber das lokale Netzwerk</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nextcloud-Setup</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erweiterte Feinabstimmung von Nextcloud</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schutz f√ºr Nextcloud</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Smartphone Cloud Sync</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Personal Computer Cloud Sync</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nachwort</a> <br><br><hr><a name="chap1"></a><br><h3>  Vorwort </h3><br>  So kamen wir zu dem Punkt, f√ºr den alles begonnen hatte und zu dem wir nicht schnell vorangekommen sind.  In diesem Teil werden die Installation und einige Punkte bei der Konfiguration des Nextcloud-Servers in der virtuellen VMWare-Maschine sowie einige Erfahrungen mit der Synchronisierung des Inhalts eines Windows-basierten Smartphones und Ordners auf einem Desktop-Computer beschrieben.  Die folgenden Installationsanweisungen f√ºr Nextcloud implizieren, dass der Dienst auf einem Server bereitgestellt wird, der gem√§√ü den Anweisungen im vorherigen Teil meiner Geschichte erstellt wurde. <br><br>  Urspr√ºnglich sollte dieses Kapitel klein sein, da ich mich nur auf die Beschreibung der Installation und Konfiguration von Nextcloud beschr√§nken wollte, um diese Geschichte √ºber "nur Linux f√ºr eine bestimmte Aufgabe eingeben" zu beenden.  Da er jedoch dachte, dass dies f√ºr jemanden interessant erscheinen k√∂nnte, beschloss er zu zeigen, wie ich das Problem der Synchronisierung der Ordner meines Heimcomputers gel√∂st habe, sodass dieses letzte Kapitel reibungslos aus klaren Anweisungen dar√ºber resultierte, was und wie beim Programmieren zu tun ist.  Dies erkl√§rt einige ‚ÄûVinaigrette‚Äú in diesem Teil - sie beginnt mit der Arbeit und den Einstellungen unter Linux, geht auf die Ebene der Netzwerk- und virtuellen Softwareeinstellungen √ºber und endet mit dem Planen von Kr√ºcken unter Windows.  Andererseits hat diese Artikelserie den Titel "Geschichte der Sch√∂pfung ..." und ich habe beschlossen, ihn bis zum Ende zu erz√§hlen. <br><br>  <b>Hinweis</b> <br>  Beim weiteren Lesen der Konstruktionen des Formulars http: // 127.0.0.1 (https: // 127.0.0.1) muss der Leerzeichen nach http: // (https: //) beim Aufrufen der Adressleiste des Browsers entfernt werden.  Beim Ver√∂ffentlichen dieses Artikels wurde ein Leerzeichen eingef√ºgt, um zu verhindern, dass die Engine automatisch Text in Links konvertiert. <br><br><hr><a name="chap2"></a><br><h3>  Vorbereiten eines Servers f√ºr die Installation von Nextcloud </h3><br>  Nextcloud ist eine Webanwendung, die eine Reihe von Dateien enth√§lt und mit einer bestimmten MySQL-Datenbank arbeitet.  Die Webanwendung wird als regul√§re Site installiert, f√ºr deren Installation Sie die "Engine" -Dateien auf den Server hochladen, die Installationsdatei ausf√ºhren und die Details des Zugriffs auf die Datenbank angeben m√ºssen, die zuvor f√ºr diese Site w√§hrend der Installation erstellt wurde. <br><br>  Erstellen Sie ein Verzeichnis, in dem Nextcloud-Dateien abgelegt werden: <br>  <b># mkdir / var / www / nextcloud</b> <br><br>  Ich habe beschlossen, HTTP abzulehnen und den Zugriff nur √ºber HTTPS zu belassen.  Dazu m√ºssen Sie Apache konfigurieren. <br><br>  √ñffnen Sie die Datei: <br>  <b># nano /etc/apache2/sites-available/default-ssl.conf</b> <br>  F√ºgen Sie vor dem Tag den folgenden Inhalt hinzu: <br><br><pre><code class="apache hljs"><span class="hljs-section"><span class="hljs-section">&lt;Directory /var/www/nextcloud&gt;</span></span> <span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Options</span></span></span></span> FollowSymLinks AllowOverride <span class="hljs-literal"><span class="hljs-literal">All</span></span> Require <span class="hljs-literal"><span class="hljs-literal">all</span></span> granted &lt;/Directory&gt;</code> </pre> <br><br>  HTTP-Konfiguration deaktivieren: <br>  <b># a2dissite 000-default.conf</b> <br><br>  Port 80 schlie√üen: <br>  <b># ufw delete allow 80</b> <br><br>  Und starten Sie den Webserver neu: <br>  <b># service apache2 restart</b> <br><br>  Jetzt m√ºssen Sie eine Datenbank f√ºr nextcloud erstellen.  Wir geben MySQL ein, indem wir das Passwort vom MySQL-Superuser eingeben: <br>  <b># mysql -u root -p</b> <br><br>  Erstellen Sie eine Datenbank mit dem Namen nextcloud: <br>  <b>mysql&gt; CREATE DATABASE `nextcloud`;</b> <br><br>  Erstellen Sie einen Benutzer mit dem Namen nextcloud und dem einfachen Passwort nc123: <br>  <b>mysql&gt; CREATE USER 'nextcloud' @ 'localhost' IDENTIFIED BY 'nc123';</b> <br><br>  Wir gew√§hren dem nextcloud-Benutzer vollen Zugriff auf die nextcloud-Datenbank: <br>  <b>mysql&gt; GEW√ÑHRLEISTUNG F√úR ALLE PRIVILEGIEN F√úR "nextcloud". * TO "nextcloud" @ "localhost";</b> <br><br>  Berechtigungstabelle aktualisieren: <br>  <b>mysql&gt; FLUSH PRIVILEGES;</b> <br><br>  Beenden Sie mysql: <br>  <b>mysql: mysql&gt; exit</b> <br><br>  Dar√ºber hinaus m√ºssen Sie zus√§tzliche Module f√ºr PHP installieren: <br>  <b># apt-get install curl libcurl3 libcurl3-dev php5-curl</b> <b><br></b>  <b># a2enmod umschreiben</b> <br><br>  Im ersten Teil dieser Geschichte haben wir Ports f√ºr die Netzwerk- und E-Mail-Interaktion ge√∂ffnet, aber f√ºr unser Ziel sind sie nicht erforderlich und es ist besser, sie zu schlie√üen.  L√∂schen Sie die Regeln: <br>  <b># ufw delete allow 138 / udp</b> <b><br></b>  <b># ufw delete allow 139 / udp</b> <b><br></b>  <b># ufw delete allow 139 / tcp</b> <b><br></b>  <b># ufw delete allow 445 / tcp</b> <b><br></b>  <b># ufw delete allow 25</b> <b><br></b>  <b># ufw delete allow 465</b> <b><br></b>  <b># ufw delete allow 110</b> <b><br></b>  <b># ufw delete allow 143</b> <b><br></b>  <b># ufw delete allow 993</b> <br><br><hr><a name="chap3"></a><br><h3>  Installieren Sie Nextcloud </h3><br>  Laden Sie die Dateien herunter und entpacken Sie sie in das vorgesehene Verzeichnis: <br>  <b># wget <a href="" rel="nofollow">download.nextcloud.com/server/releases/nextcloud-11.0.2.tar.bz2</a></b> <b><br></b>  <b># tar xjf nextcloud-11.0.2.tar.bz2 -C / var / www</b> <br><br>  Ordnerberechtigungen √§ndern: <br>  <b># chmod 755 / var / www / nextcloud</b> <br><br>  Und wir weisen dem Besitzer dieses Ordners einen Webserver zu, damit es keine Probleme beim Schreiben gibt: <br>  <b># chown -R www-data: www-data / var / www / nextcloud</b> <br><br>  Das ist alles!  Der Dienst wird installiert. Wenn Sie im Browser https: // 127.0.0.1/nextcloud eingeben, wird der Installationsassistent ge√∂ffnet.  Aber warten wir damit, nachdem wir zuvor einen Ort zum Speichern von Benutzerdaten vorbereitet haben. <br><br>  Es ist erw√§hnenswert, dass Nextcloud Version 11.0.2 derzeit ziemlich veraltet ist und Schwachstellen enth√§lt, die in neueren und aktuelleren Versionen nicht vorhanden sind. Wenn Sie also den 11.x-Zweig installieren, ist es besser, eine neuere Version zu installieren (Anfang 2018 - dies Version 11.0.7). <br><br><hr><a name="chap4"></a><br><h3>  Organisation des Nextcloud-Speichers </h3><br>  Dieser Teil ist optional und kann problemlos √ºbersprungen werden - alles wird ohne ihn funktionieren.  Wenn Sie jedoch ein Datenverzeichnis au√üerhalb der virtuellen Maschine erstellen, empfehlen wir Ihnen, sich damit vertraut zu machen. <br><br>  Standardm√§√üig werden synchronisierte Inhalte im Verzeichnis / var / www / nextcloud / nxcdata gespeichert.  Diese Option passte aus mehreren Gr√ºnden nicht sofort zu mir.  Einerseits m√∂chte ich die Dateigr√∂√üe einer virtuellen Festplatte nicht st√§ndig erh√∂hen.  Andererseits m√∂chte ich eine separate und von der Datenspeicherl√∂sung der virtuellen Maschine unabh√§ngige L√∂sung haben.  Das Einfachste, was einem sofort in den Sinn kommt, ist die Verwendung eines USB-Laufwerks.  Wenn nicht gen√ºgend Platz vorhanden ist, kann das Laufwerk einfach ausgetauscht werden.  Bei Bedarf kann es an einen anderen Computer angeschlossen werden und die erforderlichen Dateien herunterladen.  Mobil und bequem.  Ich wollte USB 2.0 jedoch nicht verwenden, da die Bandbreite f√ºr moderne Standards relativ gering ist, und ich war mit USB 3.0 nicht erfolgreich - die Virtualisierungssoftware (WMVare und VirtualBox) wollte normalerweise keine Ger√§te weiterleiten, die √ºber einen USB 3.0-Controller verbunden sind. <br><br>  Mein Appetit beim Erstellen der Cloud hat zugenommen und ich hatte nicht mehr als ein Terabyte. Am Ende entschied ich mich, eine normale Zwei-Terabyte-Festplatte an die virtuelle Maschine anzuschlie√üen, die sich bereits im Computer befand und mit diesem verbunden war.  Bei Bedarf kann es problemlos herausgezogen und √ºber den vorhandenen SATA &lt;-&gt; USB 3.0-Adapter angeschlossen werden. <br><br>  Die Hauptidee besteht also darin, einen permanenten Punkt zum Verbinden eines Verzeichnisses mit Benutzerinhalten au√üerhalb des Verzeichnisses / var / www / nextcloud zu organisieren, in dem ein symbolischer Link namens nxcdata erstellt wird, der auf das Verzeichnis der realen Daten verweist, das auf verschiedene Weise auf verschiedenen Medien verbunden werden kann. <br><br>  Erstellen Sie ein Verzeichnis: <br>  <b># mkdir / mnt / nxcdata</b> <br><br>  Wir √§ndern die Rechte: <br>  <b># chmod 770 / mnt / nxcdata</b> <br><br>  Wir machen den Webserver-Besitzer: <br>  <b># chown www-data: www-data / mnt / nxcdata</b> <br><br>  Ich kann die Daten √ºberall und √ºberall platzieren. Die Hauptsache ist, einen symbolischen Link zu diesem Verzeichnis im Verzeichnis / mnt / nxcdata zu platzieren und es nxcdata zu nennen, d. H.  Der vollst√§ndige Pfad sieht aus wie / mnt / nxcdata / nxcdata. <br><br>  Zuerst habe ich die L√∂sung f√ºr den lokalen Ordner getestet, den ich im Home-Verzeichnis erstellt habe. <br><br>  Erstellt einen Ordner an der richtigen Stelle: <br>  <b>$ mkdir / home / user / nxcdata</b> <br><br>  Rechte ge√§ndert: <br>  <b># chmod 755 / home / user / nxcdata</b> <br><br>  Besa√ü den Webserver: <br>  <b># chown -R www-data: www-data / home / user / nxcdata</b> <br><br>  Erstellt eine symbolische Verkn√ºpfung: <br>  <b># ln -s / home / user / nxcdata / mnt / nxcdata / nxcdata</b> <br><br>  Diese L√∂sung war praktikabel, sodass Sie weitermachen k√∂nnen.  Das externe Datenverzeichnis kann auf zwei Arten verbunden werden - √ºber den gemeinsam genutzten VMWare-Dienst oder direkt als physische Festplatte oder Partition.  Es versteht sich, dass die erste L√∂sung nur m√∂glich ist, wenn VMware-Tools installiert sind, die nur dann problemlos installiert werden, wenn eine grafische Oberfl√§che des Betriebssystems vorhanden ist (andernfalls m√ºssen Sie die Installationsskripte von VMware-Tools bearbeiten).  Wenn wir die grafische Oberfl√§che verlassen, bleibt nur die M√∂glichkeit, das Laufwerk direkt mit der virtuellen Maschine zu verbinden, aber mit dieser L√∂sung musste ich viel leiden.  Nach einiger Zeit fand ich immer noch eine stabile Arbeitsversion, unter Ber√ºcksichtigung der Tatsache, dass ein universelles Skript erfunden wurde, das beide Verbindungsoptionen enthielt. <br><br>  F√ºr einen Ordner, der √ºber freigegebene VMWare-Ordner im Abschnitt Freigegebene Ordner der Einstellungen der virtuellen Maschine verbunden ist, m√ºssen Sie den erforderlichen Ordner vom Hostsystem aus verbinden und ihm den Namen vmw-nxcdata geben.  Dieser Ordner kann auf ein Verzeichnis auf der Festplatte oder direkt auf das Stammverzeichnis einer Festplatte auf dem Hostsystem verweisen. <br><br>  Der bereitgestellte Ordner wird im virtuellen System automatisch unter dem Pfad / mnt / hgfs / vmw-nxcdata angezeigt.  Das Problem ist jedoch, dass der Webserver nicht √ºber gen√ºgend Rechte zum Schreiben von Dateien entlang dieses Pfads verf√ºgt und die Standardmittel des Systems die Rechte f√ºr dieses Verzeichnis nicht neu zuweisen k√∂nnen.  Daher musste ich herausfinden, wie solche Ressourcen manuell bereitgestellt werden k√∂nnen. <br><br>  Erstellen Sie einen Ordner: <br>  <b># mkdir / mnt / vmw-nxcdata</b> <br><br>  Wir mounten mit dem vmhgfs-Modul, das mit vmware-tools installiert wurde: <br>  <b># mount -t vmhgfs -o uid = www-data, gid = www-data, fmask = 007, dmask = 007 .host: / vmw-nxcdata / mnt / vmw-nxcdata</b> <br><br>  Die Montage muss mit genau diesen Parametern durchgef√ºhrt werden, damit der Webserver in Zukunft problemlos funktioniert.  Anfangs habe ich ohne Angabe von UID / GID und Masken gemountet, aber dann hat es zu nichts Gutem gef√ºhrt, da es nicht mehr m√∂glich war, die Rechte nach dem Mounten zu √§ndern.  Nach Abschluss des Mount wird m√∂glicherweise Folgendes angezeigt: "Eintrag zu mtab konnte nicht hinzugef√ºgt werden, Fortsetzung", aber es wird gemountet und funktioniert. <br><br>  Gro√üartig, wir haben das Verzeichnis gemountet.  Jetzt k√∂nnen Sie einen symbolischen Link zu diesem Verzeichnis in / mnt / nxcdata platzieren.  Ich m√∂chte dies jedoch nicht jedes Mal manuell tun, wenn ich den Server starte oder neu starte.  Am einfachsten ist es, den obigen Befehl in die Datei /etc/rc.local einzugeben, um ihn in die Zeile ‚Äûexit 0‚Äú einzubinden.  Ich wollte jedoch, dass das automatische Aush√§ngen erfolgt, wenn die virtuelle Maschine aus Gr√ºnden der zuverl√§ssigen Datensicherheit ausgeschaltet wird.  Und ich habe mich entschlossen, alles auf Service-Ebene zu tun und mich ein wenig mit den init / update-rc-Mechanismen zu besch√§ftigen. Umso mehr war ich neugierig und es stellte sich als ziemlich interessant heraus. <br><br>  Die folgenden Aktionen bedeuten, dass ein Systemdienst erstellt wird, der aufgerufen wird und vordefinierte Befehle ausf√ºhrt, wenn das System ein- oder ausgeschaltet wird.  Der Dienst wird durch ein Skript beschrieben, das nach bestimmten Regeln kompiliert wurde und sich in /etc/init.d befindet.  Der INIT INFO-Block befindet sich ganz am Anfang des Skripts und enth√§lt Zusatzinformationen, in denen ich die Anweisungen Default-Start und Default-Stop erw√§hnen m√∂chte. Sie geben die Ausf√ºhrungsebenen an, auf denen das Skript standardm√§√üig gestartet oder gestoppt werden soll. <br><br>  Ausf√ºhrungsstufen: <br><br>  0 - Skriptausf√ºhrung beim Ausschalten des Systems <br>  1 - Skriptausf√ºhrung beim Systemstart im Einzelbenutzermodus <br>  2 - Skriptausf√ºhrung beim Systemstart im Mehrbenutzermodus <br>  3 - 5 - reserviert <br>  6 - Skriptausf√ºhrung beim Systemneustart <br><br>  Nach dem Schreiben des Skripts wird es mithilfe des update-rc-Mechanismus aktiviert, der tats√§chlich Links zum Skript in den erforderlichen Verzeichnissen /etc/rc0.d - /etc/rc6.d erstellt, deren Inhalt den von den Ausf√ºhrungsebenen ausgef√ºhrten Aufgaben entspricht.  Links k√∂nnen unabh√§ngig voneinander erstellt werden. Im Gegensatz zum Aktivieren oder Deaktivieren der Apache-Webserverkonfigurationen m√ºssen Sie hier jedoch viele Nuancen ber√ºcksichtigen, sodass Sie den Dienst √ºber update-rc aktivieren oder deaktivieren m√ºssen. <br><br>  Erstellen Sie also eine Datei: <br>  <b># nano /etc/init.d/nxcdata_automount.sh</b> <br><br>  Und schreiben Sie den folgenden Inhalt hinein: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/sh # nxcdata_automount.sh 1.0 ### BEGIN INIT INFO # Provides: myscript # Required-Start: # Required-Stop: # Default-Start: 1 2 3 4 5 # Default-Stop: 0 6 # Short-Description: nxcdata_automount.sh 1.0 # Description: nxcdata_automount.sh 1.0 ### END INIT INFO . /lib/lsb/init-functions # Start actions perform_start() { log_daemon_msg ¬´Start nxcdata_automount¬ª sleep 30 mount -t vmhgfs -o uid=www-data,gid=www-data,fmask=007,dmask=007 .host:/vmw-nxcdata /mnt/vmw-nxcdata #mount -t ntfs-3g -o uid=www-data,gid=www-data,fmask=007,dmask=007 /dev/sdb1 /mnt/sdb1 #mount -t ext4 /dev/sdb1 /mnt/sdb1 sleep 5 service fail2ban restart log_end_msg 0 return 0 } # Stop actions perform_stop() { log_daemon_msg ¬´Stop nxcdata_automount¬ª umount /mnt/nxcdata log_end_msg 0 return 0 } case $1 in start) perform_start ;; stop) perform_stop ;; *) echo ‚ÄúUsage: /etc/init.d/myscript {start|stop}‚Äù exit 3 ;; esac</span></span></code> </pre><br><br>  Achten Sie auf einige auskommentierte Teams im Abschnitt perform_start - dies ist unsere Grundlage f√ºr die Zukunft.  Nach dem Mounten wird der fail2ban-Dienst neu gestartet. <br><br>  Das Paradoxe ist, dass ich mich nach einem Jahr nicht mehr daran erinnere, warum ich das getan habe, aber ich bezweifle sehr, dass es einfach so gemacht wurde.  Offensichtlich st√ºrzte der Dienst nach dem Mounten des Dienstes aus irgendeinem Grund ab oder konnte zun√§chst nicht gestartet werden und musste manuell neu gestartet werden. <br><br>  Nach einer solchen Ablenkung konfigurieren wir weiter.  Erstellen Sie eine symbolische Verkn√ºpfung: <br>  <b># ln -s / mnt / vmw-nxcdata / mnt / nxcdata / nxcdata</b> <br><br>  Wir machen unser Skript ausf√ºhrbar: <br>  <b># chmod + x /etc/init.d/nxcdata_automount.sh</b> <br><br>  F√ºgen Sie das Skript zum Start hinzu: <br>  <b># update-rc.d nxcdata_automount.sh Standardeinstellungen</b> <br><br>  Wir starten das System neu und stellen sicher, dass die automatische Bereitstellung erfolgreich war und alles auf die richtige Weise zug√§nglich ist. <br><br>  Um das Skript zu entfernen, m√ºssen Sie einige Befehle ausf√ºhren: <br>  <b># update-rc.d -f nxcdata_automount.sh entfernen</b> <b><br></b>  <b># rm -f /etc/init.d/nxcdata_automount.sh</b> <br><br>  Wenn Sie ein Laufwerk nicht √ºber freigegebene VMWare-Ordner bereitstellen, sollten Sie die gleichen Schritte wie beim Bereitstellen √ºber freigegebene VMWare-Ordner ausf√ºhren, jedoch die Tatsache ber√ºcksichtigen, dass im System ein vollst√§ndiges zweites Laufwerk angezeigt wird.  Wie finde ich den Laufwerksbuchstaben heraus? <br><br>  Die meisten Linux-Blockger√§te sind √ºber die SCSI-Schnittstelle verbunden, sodass Festplatten in den meisten F√§llen mit den Buchstaben sd beginnen.  Der dritte Buchstabe im Datentr√§gernamen bedeutet die Seriennummer im System und wird alphabetisch angegeben: sda - die erste Festplatte, sdb - die zweite Festplatte, sdc - die dritte und so weiter.  Dann kommt die Nummer, die die Partitionsnummer auf der Festplatte definiert: sda1, sda2 und so weiter.  Der einfachste Weg, alle zugeordneten Laufwerke anzuzeigen, besteht darin, den Inhalt des Verzeichnisses / dev / zu √ºberpr√ºfen und die SD-Ger√§te herauszufiltern: <br><br>  <b>$ ls -l / dev / |</b>  <b>grep sd</b> <br><br>  Zum Beispiel m√ºssen wir ein SDB1-Laufwerk mit einem NTFS-Dateisystem verbinden. <br><br>  Erstellen Sie ein Verzeichnis und h√§ngen Sie die Festplatte darin ein: <br>  <b># mkdir / mnt / sdb1</b> <b><br></b>  <b># mount -t ext4 / dev / sdb1 / mnt / sdb1</b> <br><br>  Erstellen Sie ein Verzeichnis f√ºr die Daten, legen Sie die Rechte und den Benutzer daf√ºr fest: <br>  <b># mkdir / mnt / sdb1 / nxcdata &amp; chmod 770 / mnt / sdb1 / nxcdata &amp; chown -R www-Daten: www-Daten / mnt / sdb1 / nxcdata</b> <br><br>  Als N√§chstes m√ºssen Sie au√üerdem ein Skript f√ºr die automatische Bereitstellung erstellen und den Befehl mount im Skript anpassen (Beispiele f√ºr das Verbinden eines Laufwerks mit NTFS und EXT4 sind bereits im Skript enthalten und auskommentiert) und das Skript zum Start hinzuf√ºgen. <br><br>  B Erstellen Sie eine symbolische Verkn√ºpfung zum Datenverzeichnis: <br>  <b># ln -s / mnt / sdb1 / nxcdata / mnt / nxcdata / nxcdata</b> <br><br>  Tats√§chlich ist all dieses Problem mit einer Reihe von nxcdata-Verzeichnissen auf eine Sache ausgelegt: Um in Zukunft eine einfache √úbertragung des Datenverzeichnisses zu erm√∂glichen - Sie m√ºssen die Konfiguration in der Nextcloud-Engine nicht bearbeiten und im Allgemeinen darauf zugreifen - m√ºssen Sie lediglich eine neue Festplatte anschlie√üen und kopieren ihm Daten und erstellen Sie eine symbolische Verkn√ºpfung, die zu einem neuen Verzeichnis mit Daten f√ºhrt.  Gleichzeitig gehen alle Aktionen nicht √ºber das Verzeichnis / mnt hinaus.  Es stellte sich heraus, dass alles evolution√§r kompliziert war. Ich wollte einfach nicht die L√∂sungen verlieren, die ich hatte. <br><br>  Was ist der beste Weg, um Daten au√üerhalb der virtuellen Maschine zu √ºbertragen?  Ich werde meine Erfahrungen dar√ºber teilen, welche Option ich gestoppt habe und warum. <br><br>  USB-Laufwerke wurden automatisch erfasst, wenn die virtuelle Maschine hochfuhr, sich korrekt und vollst√§ndig einschaltete, und alles funktionierte immer, jedoch nur, bis das Laufwerk aus irgendeinem Grund vom System getrennt wurde.  Neustart oder physische Trennung und Verbindung einer Festplatte halfen.  Die Entscheidung erwies sich als unzuverl√§ssig.  Es gab kein solches Problem mit Flash-Laufwerken, aber das Volumen und die Geschwindigkeit der Arbeit passten kategorisch nicht zu mir.  Vielleicht hat es sich gelohnt, ein externes Laufwerk mit autonomer Leistung zu testen. <br><br>  Die Verzeichnisweiterleitung √ºber freigegebene VMWare-Ordner funktionierte stabil und perfekt.  Diese L√∂sung erf√ºllte die Aufgabe der Synchronisierung zweier Smartphones vollst√§ndig.  Alles funktionierte mehrere Tage, zehn Gigabyte Daten wurden gepumpt.  Als ich mich jedoch entschied, Daten vom Computer zur Cloud hinzuzuf√ºgen, stellte ich pl√∂tzlich ein Problem mit langen Pfaden und Dateinamen fest.  Theoretisch betr√§gt das NTFS-Datei- / Ordnernamenlimit 255 Zeichen, in der Praxis jedoch die Windows-API 244 Zeichen.  Theoretisch betr√§gt die Begrenzung der L√§nge des Pfads zu einer Datei oder einem Ordner in NTFS 32.767 Zeichen. In der Praxis beschr√§nkt die Windows-API die L√§nge jedoch auf 245 Zeichen.  Da ich ein gro√üer Fan von Strukturierungsinformationen bin, kann die L√§nge meines Pfades sehr gro√ü sein.  Der nicht abgek√ºrzte Titel der B√ºcher kann auch leicht 100-150 Zeichen enthalten, einschlie√ülich Leerzeichen.  Diese Einschr√§nkung ist ein bekanntes Problem bei freigegebenen VMWare-Ordnern, das selbst bei Verwendung von Windows 10 mit allen m√∂glichen cleveren Schl√ºsseln in der Registrierung zum Entfernen der Beschr√§nkung auf 255 Zeichen nicht behoben werden konnte.  Ein m√∂glicher Grund sind die Einschr√§nkungen von vmhgfs.  Diese bequeme Art der Verbindung musste aufgegeben werden.  Der Grund ist sicher behoben - das Problem liegt im virtuellen Dateisystem, das im Mechanismus f√ºr freigegebene VMWare-Ordner verwendet wird. <br><br>  Die n√§chste L√∂sung besteht darin, die Festplatte direkt mit der virtuellen Maschine zu verbinden.  Es hat auch nicht reibungslos geklappt.  Die Datenstruktur (oder das Dateisystem, und dies war sowohl f√ºr NTFS als auch f√ºr EXT2 / 3/4 offensichtlich) brach st√§ndig zusammen, entweder wenn die Festplatte oder ihre Partition von der Software der virtuellen Maschine ‚Äûerfasst‚Äú wurde oder wenn sie an das Hostsystem zur√ºckgegeben wurde, selbst wenn ich das Ganze √ºbertragen habe Fahren Sie auf dem Hostsystem offline.  In einigen Modi schreibe oder lese ich keine Daten - ich konnte die weitergeleitete Festplatte oder Partition nicht einmal richtig formatieren.  Es ist uns jedoch gelungen, einen Arbeitsmodus zu finden: Eine in NTFS formatierte physische Festplatte mit einer Partition wurde in einem bestimmten Verbindungsmodus mit der virtuellen Maschine verbunden: SATA / Independent / Persistent / Einzelne Partition verwenden.  Der Ordner nxcdata mit den Daten sollte sich auf der Festplatte befinden. <br><br><hr><a name="chap5"></a><br><h3>  Konfigurieren Sie den Nextcloud Virtual Machine-Zugriff √ºber das lokale Netzwerk </h3><br>  Wir haben keine Probleme beim √ñffnen von Websites innerhalb einer virtuellen Maschine oder von einem Hostsystem aus.  Aber wie kann man die erstellte Site von einem anderen Computer im lokalen Netzwerk aus √∂ffnen?  Schauen wir uns die unten abgebildete Struktur unseres Netzwerks an. <br><br><img src="https://habrastorage.org/webt/vt/ge/zt/vtgeztmrqy5y22zje4pgdn-40ro.png"><br><br>  Das Bild zeigt, dass der Router direkt mit dem Internet verbunden und so konfiguriert ist, dass er automatisch IP-Adressen an verbundene Ger√§te im Bereich 192.168.0.2-192.168.0.254 verteilt.  Die Adresse 192.168.0.2 wurde von unserem Computer empfangen und 192.168.0.3 - der zweite Computer, auf dem wir den Server herstellen.  Die Virtualisierungssoftware ist jedoch auf dem zweiten Computer installiert, der einen eigenen virtuellen Router erstellt und sein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow">DHCP</a> im Subnetz 192.168.233.0/24 konfiguriert hat.  Unser virtueller Server hat die IP 192.168.133.138 erhalten. <br><br>  Ich kann die Site in der virtuellen Maschine 192.168.233.138 problemlos √∂ffnen.  Ich kann die Site einfach vom Computer 192.168.0.3 aus √∂ffnen, indem ich einfach die gew√ºnschte IP-Adresse in den Browser eingebe. Die Virtualisierungssoftware hat sich bereits um die korrekte Konfiguration der Netzwerkumgebung auf dem Hostcomputer gek√ºmmert.  Aber wie komme ich vom Computer 192.168.0.2 zur Site?  Wenn ich die IP-Adresse 192.168.233.138 eingebe, √∂ffnet sich nichts f√ºr mich, da weder mein Computer noch der echte Router etwas √ºber dieses Subnetz wissen.  Wenn ich die Adresse 192.168.0.3 eingebe, wird auch f√ºr mich nichts ge√∂ffnet, da sich auf diesem Computer wirklich keine Site befindet - sie befindet sich in der virtuellen Maschine. <br><br>  Um dieses Problem zu beheben, m√ºssen Sie den virtuellen Router des Computers 192.168.0.3 konfigurieren.  Wir wissen bereits, dass der Zugriff auf die Sites √ºber die Ports 80 und 443 erfolgt. Beim Zugriff auf diese Ports auf die Maschine 192.168.0.3 m√ºssen wir das Routing erstellen, damit Anforderungen an die virtuelle Maschine 192.168.233.138 umgeleitet werden.  Zum Gl√ºck haben wir die Tools zur Verf√ºgung.  VMWare Workstation verf√ºgt √ºber ein Tool f√ºr den virtuellen Netzwerkeditor, das √ºber das Men√º der virtuellen Maschine (Bearbeiten -&gt; Editor f√ºr virtuelle Netzwerke) ge√∂ffnet werden kann. <br><br><img src="https://habrastorage.org/webt/07/-x/ml/07-xmlj7novkph4sr6e0yrmabnw.jpeg"><br><br>  Mit diesem Tool k√∂nnen Sie Netzwerkeinstellungen sehr flexibel verwalten.  Wir m√ºssen die virtuelle Netzwerkkarte VMNet8 ausw√§hlen und auf die Schaltfl√§che "NAT-Einstellungen ..." klicken, die verf√ºgbar geworden ist.  In dem sich √∂ffnenden Fenster m√ºssen Sie Regeln hinzuf√ºgen, um das ben√∂tigte Routing zu erstellen. <br><br><img src="https://habrastorage.org/webt/uc/jh/dp/ucjhdp0cif4azermsxbwfra4v-o.jpeg"><br><br>  Geben Sie den Host-System-Port an und geben Sie dann die IP-Adresse und den Port der virtuellen Maschine an, an die Anforderungen umgeleitet werden sollen.  Um HTTPS-Verkehr weiterzuleiten, m√ºssen Sie den Hostsystem-Port 443 und -Port 443 sowie die Adresse der virtuellen Maschine 192.168.233.138 angeben.  Klicken Sie nach dem Erstellen der Regeln in allen Fenstern auf ‚ÄûOK‚Äú. Die virtuelle Netzwerkumgebung wird automatisch neu konfiguriert. <br><br>  Nach diesen √Ñnderungen werden unsere Websites vom Computer 192.168.0.2 aus ge√∂ffnet, wenn Sie auf die Adresse 192.168.0.3 zugreifen. <br><br>  √Ñhnliche Einstellungen f√ºr die Portweiterleitung sind nicht nur f√ºr VMWare, sondern auch f√ºr VirtualBox verf√ºgbar (Einstellungen ‚Üí Netzwerk ‚Üí W√§hlen Sie den gew√ºnschten Adapter aus ‚Üí Erweitert ‚Üí Portweiterleitung).  W√§hrend der Experimente zum Anschlie√üen der Festplatte an diese Phase fand ich jedoch den kostenlosen VMWare Player installiert, in dem sich der Virtual Network Editor nicht befand.  Ich habe im Internet nichts √ºber die Portweiterleitung f√ºr VMWare Player gefunden und musste eine Testversion von VMWare Workstation verwenden. Bei der Installation des Produkts steht eine kostenlose Nutzung von 30 Tagen zur Verf√ºgung.  Nach 30 Tagen kann das Produkt entfernt, gereinigt und wieder installiert werden, aber eine solche Aufmerksamkeit f√ºr den Server ist irgendwie redundant und eindeutig unerw√ºnscht.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und dann ging ich zu einem kleinen (oder gro√üen) Trick. Der VMWare Workstation-Dateisatz enth√§lt das Dienstprogramm vmnetcfg, das im Wesentlichen √ºber das Element Virtual Network Editor ausgef√ºhrt wird. Es befand sich jedoch nicht im VMWare Player-Dateisatz. Aber konfiguriert VMWare Player bei der Installation irgendwie seine Netzwerkumgebung? Ich habe dieses Dienstprogramm einfach genommen und mit VMWare Player in den Ordner kopiert und dann gestartet. √úberraschenderweise hat alles geklappt. Es ist m√∂glich, dass Thin Network-Einstellungen in der VMWare Player-Umgebung nicht funktionieren, aber eine Portweiterleitung bereitgestellt wird und ich keine weiteren ben√∂tige.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um √ºber das Internet auf unseren Server zuzugreifen, m√ºssen Sie die Ports eines Routers weiterleiten, der auf die gleiche Weise mit dem Internet verbunden ist. In der Firmware der meisten Router gibt es einen Abschnitt zur Portweiterleitung, in dem Sie das Routing konfigurieren k√∂nnen, indem Sie den externen Port sowie den Port und die IP-Adresse des internen Computers angeben. Es gibt jedoch eine leichte Nuance. Wenn der Anbieter uns eine echte IP-Adresse gegeben hat oder wir sie von ihm gekauft haben, gibt es keine Probleme - wir geben diese IP-Adresse von einem Computer von √ºberall auf der Welt ein. Der reale Router leitet den Datenverkehr zu einem Computer mit einer virtuellen Maschine um, auf der der virtuelle Router den Datenverkehr direkt zur virtuellen umleitet ein Auto. Aber was tun mit jemandem, der nicht die M√∂glichkeit hat, eine echte IP-Adresse zu erhalten, dynamische Adressen erh√§lt oder hinter </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;">NAT</font></a><font style="vertical-align: inherit;"> steht </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">?</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Anbieter, eine "graue" IP-Adresse bekommen? </font><font style="vertical-align: inherit;">Ich musste ein solches Problem nicht l√∂sen, da ich eine statische "wei√üe" IP habe. </font><font style="vertical-align: inherit;">Jeder, der ein solches Problem auf die eine oder andere Weise l√∂sen muss, muss sich mit diesem Problem befassen. </font><font style="vertical-align: inherit;">Ich w√ºrde empfehlen, bei dynamischen Adressen in Richtung dyndns oder freedns.afraid.org zu schauen oder ein billiges VDS zu kaufen, um selbst ein Routing zu entwickeln, da dieses Problem auf jeden Fall ohne einen externen Server mit einer statischen IP-Adresse nicht gel√∂st werden kann. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nach der Konfiguration des Routings habe ich die IP-Adressen der Computer 192.168.0.3 und 192.168.233.138 korrigiert und sie manuell in die Netzwerkkarteneinstellungen dieser Computer geschrieben, um deren automatische Neuzuweisung auszuschlie√üen.</font></font><br><br><hr><a name="chap6"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nextcloud-Setup </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt ist es Zeit, https: // 127.0.0.1/nextcloud im Browser der virtuellen Maschine, https: // 192.168.233.138/nextcloud vom Host-System oder, basierend auf dem oben beschriebenen konfigurierten Routing, https: // 192.168.0.3/nextcloud von einem beliebigen zu √∂ffnen Computer im lokalen Netzwerk. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als N√§chstes legen wir die Anmeldung / das Kennwort f√ºr den Administrator fest, greifen auf die zuvor erstellte Datenbank zu und geben als Speicherort den vollst√§ndigen Pfad zum Verzeichnis nxcdata an: / mnt / nxcdata / nxcdata. Dieser Einrichtungsschritt unterscheidet sich nicht von der Installation einer Site. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In den Administratoreinstellungen habe ich die folgenden einfachen √Ñnderungen vorgenommen: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Pers√∂nlich ‚Üí Russisch ausgew√§hlt und eine E-Mail f√ºr den Administrator user @ localhost angegeben </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Administration ‚Üí Freigabe ‚Üí Alle Elemente deaktiviert </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Administration ‚Üí Nutzungsumfrage ‚Üí Alle Elemente deaktiviert</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Administration ‚Üí Erweiterte Einstellungen ‚Üí Dateiverwaltung: ‚ÄûMaximale Upload-Dateigr√∂√üe‚Äú auf 25 GB festgelegt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Benutzer ‚Üí hat die Benutzergruppe erstellt und dem Benutzer einen neuen Benutzer hinzugef√ºgt. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nach dem Einrichten m√ºssen Sie das Caching aktivieren. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√ñffnen Sie die Datei: </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano /var/www/nextcloud/config/config.php</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Und ganz am Ende vor ");" F√ºgen Sie Folgendes hinzu: </font><font style="vertical-align: inherit;">Jetzt m√ºssen Sie den externen Zugriff auf die Site auf der Ebene ihrer "Engine" zulassen. </font><font style="vertical-align: inherit;">√ñffnen Sie die Datei: </font><b><font style="vertical-align: inherit;"># nano /var/www/nextcloud/config/config.php</font></b><font style="vertical-align: inherit;"> F√ºgen Sie im Abschnitt trust_domains die Server-IP-Adresse zum Array hinzu und f√ºgen Sie die Adresse hinzu, auf der Nexcloud installiert ist. Der Abschnitt "trust_domains" in unserem Fall sieht folgenderma√üen aus:</font></font><br><br> <code>'memcache.local' =&gt; '\OC\Memcache\Memcached', <br> 'memcache.distributed' =&gt; '\OC\Memcache\Memcached', <br> 'memcached_servers' =&gt; array( <br> array('localhost', 11211), <br> ), <br></code> <br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br> <b><font style="vertical-align: inherit;"></font></b> <br><br><font style="vertical-align: inherit;"></font><br><br> <code>'trusted_domains' =&gt; <br> array ( <br> 0 =&gt; '127.0.0.1', <br> 1 =&gt; '192.168.233.138', <br> ), <br></code> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt k√∂nnen Sie die Wartungsfreundlichkeit des Dienstes √ºberpr√ºfen - √∂ffnen Sie die Site und melden Sie sich als Benutzer an. Wenn die Autorisierung erfolgreich war, ist der Dienst kampfbereit. Sie k√∂nnen die Anwendung f√ºr die Synchronisierung auf Computern und Smartphones installieren. Geben Sie f√ºr den Zugriff die IP-Adresse 192.168.0.3 und die f√ºr jedes Ger√§t erstellten Kontozugriffsdetails ein. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gl√ºcklicherweise oder ungl√ºcklicherweise musste ich nicht das volle Potenzial des erstellten Dienstes nutzen, da ich anfangs ein Backup-System mit Verifikation brauchte und anfangs nur mit Subversion auskommen wollte, aber die Geschwindigkeit der Festschreibungen einer besonders gro√üen Anzahl kleiner Dateien machte mich sehr traurig. Ich habe alles getan, um zu wachsen, aber ich wollte es nicht ausnutzen, und dann wurde es irgendwie nicht mehr der Cloud gewachsen.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Eine detailliertere √úbersicht √ºber die Nutzung des Dienstes hat der </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wtigga-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Benutzer </font><font style="vertical-align: inherit;">Ende 2017 in seinem Artikel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚ÄûHerunterladen von VPS: Ihre Nextcloud-Cloud‚Äú erstellt</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Aus Sicht des Benutzers gibt der Artikel einen √úberblick √ºber den neueren Nextcloud-Server, Version 12.</font></font><br><br><hr><a name="chap7"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Erweiterte Feinabstimmung von Nextcloud </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">W√§hrend des Betriebs der Cloud im ersten Arbeitsmonat tauchten einige Probleme auf, die ich mithilfe der Community oder alleine l√∂sen musste. </font><font style="vertical-align: inherit;">Ich muss sagen, dass ich den Service sehr hart genutzt und ihn tats√§chlich auf Stressresistenz √ºberpr√ºft habe. </font><font style="vertical-align: inherit;">Das Synchronisieren einiger Gigabyte Daten von Telefonen √ºber den Abend und von bis zu einer Million kleiner Dateien von einem Computer war eine √ºbliche Sache. </font><font style="vertical-align: inherit;">Generell hat mich der Service sehr positiv beeindruckt.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich w√ºrde nicht sagen, dass die folgenden L√∂sungen korrekt und sch√∂n sind, aber diese Kr√ºcken funktionieren zumindest f√ºr Version 11.0.2, da es sonst unm√∂glich w√§re, den Dienst zu nutzen. In Version 12.x wurde m√∂glicherweise etwas verbessert und behoben, daher w√ºrde ich nicht empfehlen, diese Einstellungen sofort als Teil der Starteinstellungen festzulegen, w√§hrend sie f√ºr die 11.x-Zeile sofort angewendet werden k√∂nnen. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problem 1</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> W√§hrend der Synchronisation tritt ein Fehler wie "Datei ist gesperrt" auf. Die Synchronisation wird gestoppt. Das Problem ist bekannt - Sie m√ºssen den Inhalt der Tabelle oc_file_locks l√∂schen, indem Sie die folgende Abfrage √ºber die MySQL-Konsole ausf√ºhren (wenn Sie den Benutzer nextcloud autorisieren): </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mysql&gt; DELETE FROM oc_file_locks WHERE 1</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Da solche Fehler nicht ungew√∂hnlich sind, habe ich mir nichts Besseres </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ausgedacht,</font></font></b> <font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> als ein Skript zu erstellen und es direkt im Stammordner </font><b><font style="vertical-align: inherit;">abzulegen</font></b><font style="vertical-align: inherit;"> : </font><b><font style="vertical-align: inherit;"># nano / root / empty_oc_file_locks Skriptinhalt</font></b></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash mysql -unextcloud &gt; -pnc123 -D nextcloud &lt;&lt;MY_QUERY DELETE FROM oc_file_locks WHERE 1 MY_QUERY</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Skript kann manuell ausgef√ºhrt werden, dies ist jedoch nicht unsere Methode. </font><font style="vertical-align: inherit;">Ich habe beschlossen, es automatisch alle 15 Minuten mit cron (https://ru.wikipedia.org/wiki/Cron) auszuf√ºhren. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie dazu eine Datei: </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano / root / crontab</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mit folgendem Inhalt: </font><font style="vertical-align: inherit;">Jetzt m√ºssen Sie √Ñnderungen am Scheduler vornehmen: </font><b><font style="vertical-align: inherit;"># crontab / root / crontab</font></b><font style="vertical-align: inherit;"> Sie k√∂nnen nach folgenden √Ñnderungen </font><font style="vertical-align: inherit;">suchen </font><font style="vertical-align: inherit;">: </font><b><font style="vertical-align: inherit;"># crontab -l </font></b><b><font style="vertical-align: inherit;">Problem 2</font></b><font style="vertical-align: inherit;"> Bei der Synchronisierung √ºber webDAV in den Protokollen (siehe Admin-Panel, vom Administrator autorisiert) Die folgenden Fehler k√∂nnen auftreten:</font></font><br><br> <code>*/15 * * * * root bash /root/empty_oc_file_locks <br></code> <br><br><font style="vertical-align: inherit;"></font><br> <b><font style="vertical-align: inherit;"></font></b> <br><br><font style="vertical-align: inherit;"></font><br> <b><font style="vertical-align: inherit;"></font></b> <br><br> <b><font style="vertical-align: inherit;"></font></b> <br><br><font style="vertical-align: inherit;"></font><br><br> <code>Error PHP reset() expects parameter 1 to be array, null given at /var/www/nextcloud/apps/files_versions/lib/Storage.php#783 <br> Error PHP ksort() expects parameter 1 to be array, null given at /var/www/nextcloud/apps/files_versions/lib/Storage.php#782 <br> Error PHP Invalid argument supplied for foreach() at /var/www/nextcloud/apps/files_versions/lib/Storage.php#759 <br> Error PHP Undefined index: by_file at /var/www/nextcloud/apps/files_versions/lib/Storage.php#759 <br> Error PHP Undefined index: all at /var/www/nextcloud/apps/files_versions/lib/Storage.php#757 <br></code> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diesmal tat die Gemeinde nichts und musste die Ermittlungen alleine durchf√ºhren. Der Grund lag im Fehler "Undefinierter Index ... Storage.php # 757", der mehrere weitere Fehler kaskadiert. Wir sehen uns den Code f√ºr diese Datei an. Das ganze Problem lag in der Quote. In dieser Zeile im Code (Storage.php # 757) wird der freie Speicherplatz unter Ber√ºcksichtigung des Volumens der Archivdateien berechnet. Bei der Berechnung geht etwas schief, obwohl das Kontingent auf "unbegrenzt" festgelegt ist. Um den Fehler im Administrationsbereich zu beheben, habe ich f√ºr jeden Benutzer ein "unendliches, aber numerisches" Kontingent festgelegt, z. B. 100 TB. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problem 3</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Problem beim Synchronisieren von .htaccess-Dateien - sie werden einfach nicht synchronisiert! </font><font style="vertical-align: inherit;">Und ich war nicht allein, in einigen Foren stellten sie √§hnliche Fragen. </font><font style="vertical-align: inherit;">Ich habe jedoch keine fertige L√∂sung gefunden. </font><font style="vertical-align: inherit;">Ich musste selbst noch einmal nachdenken. </font><font style="vertical-align: inherit;">Als Ergebnis von Googeln, Anzeigen von Protokollen und Code-Analyse fiel mir nichts Besseres ein, als die nextcloud-Engine-Datei zu reparieren. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In der Datei /var/www/nextcloud/lib/private/Files/filesystem.php suchen wir nach der folgenden Zeile: </font><font style="vertical-align: inherit;">Und wir bringen sie in die folgende Form:</font></font><br><br> <code>$blacklist = \OC::$server-&gt;getConfig()-&gt;getSystemValue('blacklisted_files', array('.htaccess')); <br></code> <br><br><font style="vertical-align: inherit;"></font><br><br> <code>$blacklist = \OC::$server-&gt;getConfig()-&gt;getSystemValue('blacklisted_files', array('')); <br></code> <br><br><hr><a name="chap8"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Schutz f√ºr Nextcloud </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mit fail2ban k√∂nnen Sie unseren Service vor der Auswahl von Passw√∂rtern f√ºr das Admin-Panel sch√ºtzen. Dazu m√ºssen Sie den charakteristischen Ausdruck beschreiben, der in nextcloud-Protokollen auftritt, wenn die Authentifizierung fehlschl√§gt. Danach wird der entsprechende Trigger ausgel√∂st. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Erstellen Sie die Datei: </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano /etc/fail2ban/filter.d/nextcloud.conf</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mit folgendem Inhalt: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[Definition] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">failregex = {"reqId": ". *", "RemoteAddr": ". *", "App": " core "," message ":" Login fehlgeschlagen: '. *' \ (Remote IP: '' \) "," level ": 2," time ":". * "} </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ignoreregex = </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√ñffnen Sie die Datei: </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># nano / etc. /fail2ban/jail.local F√ºgen Sie</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> am Ende der Datei Folgendes hinzu: </font><font style="vertical-align: inherit;">Starten Sie den Dienst neu: </font><b><font style="vertical-align: inherit;"># service fail2ban </font></b><b><font style="vertical-align: inherit;">restart Suchen</font></b><font style="vertical-align: inherit;"> Sie nach einem aktiven Filter:</font></font><br><br> <code>#       nextcloud <br> [nextcloud] <br> enabled = true <br> port = http,https <br> protocol = tcp <br> filter = nextcloud <br> logpath = /var/log/nextcloud.log <br></code> <br><br><font style="vertical-align: inherit;"></font><br> <b><font style="vertical-align: inherit;"></font></b> <br><br><font style="vertical-align: inherit;"></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"># fail2ban-client status nextcloud</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Vergessen Sie nicht, dass gem√§√ü den fail2ban-Einstellungen aus dem vorherigen Teil Ihre IP- </font><b><font style="vertical-align: inherit;">Adresse</font></b><font style="vertical-align: inherit;"> 30 Tage lang blockiert wird, wenn das Kennwort 12 Stunden lang sechsmal hintereinander falsch eingegeben wird. </font><font style="vertical-align: inherit;">Ich habe irgendwie zwei Abende wegen eines falschen Passworts auf einem der Telefone verbracht, bis ich diese einfache Tatsache in den Systemprotokollen herausgefunden habe.</font></font><br><br><hr><a name="chap9"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Smartphone Cloud Sync </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um den Inhalt von Telefonen mit Android zu synchronisieren, gibt es eine wunderbare Anwendung FolderSync. Das Programm rechtfertigt seinen niedrigen Preis voll und ganz. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zuerst m√ºssen Sie ein neues Konto erstellen, in dem Sie https: // 192.168.0.3/nextcloud als Serveradresse angeben, die Anmeldung und das Kennwort f√ºr das zuvor erstellte Konto eingeben und das selbstsignierte Zertifikat aktivieren. Klicken Sie auf die Schaltfl√§che "Test" und stellen Sie sicher, dass die Verbindung zum Server in Ordnung ist.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als n√§chstes m√ºssen Sie eine Aufgabe erstellen. Geben Sie in der Aufgabe das zuvor erstellte Konto an und w√§hlen Sie die Art der Synchronisierung aus - "Zum Remote-Ordner". Geben Sie den Remote-Ordner an (Sie k√∂nnen ihn direkt aus der Anwendung erstellen "und w√§hlen Sie den lokalen Ordner f√ºr die Synchronisierung aus. Ich habe den Zeitplan jeden Tag auf 2 Uhr morgens festgelegt. In den Synchronisierungseinstellungen habe ich" Synchronisierung von Unterordnern "und" Synchronisierung der enthaltenen Ordner "aktiviert Die Option, alte Dateien immer zu ersetzen, und im Konfliktfall erlaubte ich standardm√§√üig, die lokale Datei zu verwenden. Im Abschnitt "Verbindungen" habe ich alle Verbindungen au√üer Wi-Fi deaktiviert und die SSID meines Heim-Wi-Fi-Netzwerks im Abschnitt "Zul√§ssige WiFi-SSIDs" - Anwendung registriert Knospe Ich kann nur in meinem Heimnetzwerk synchronisieren und nicht versuchen, den Server in anderen Netzwerken zu durchsuchen. Die restlichen Einstellungen habe ich standardm√§√üig beibehalten.Hier k√∂nnen Sie Filter hinzuf√ºgen. Ich habe einen neuen Filter "Der Ordnername enth√§lt" erstellt und den Wert [nosync] angegeben. Daher kann ich einige Ordner im angegebenen lokalen Ordner von der Synchronisierung ausschlie√üen, indem ich am Ende einfach den Namen "[nosync]" hinzuf√ºge.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diese Einstellung wurde f√ºr lokale Ordner wie DCIM, Download, Telegramm, Viber, WhatsApp vorgenommen. </font><font style="vertical-align: inherit;">Plus ein paar meiner Benutzerordner von mehreren Gigabyte Gr√∂√üe. </font><font style="vertical-align: inherit;">Einmal am Tag wird der Inhalt dieser Ordner mit dem Server synchronisiert, und alte Versionen von Dateien auf dem Server werden nicht gel√∂scht, sondern umbenannt und in das Archiv verschoben. </font><font style="vertical-align: inherit;">Dadurch konnte ich versehentlich versehentlich gel√∂schte Dateien schnell wiederherstellen oder √Ñnderungen in einigen anderen Dateien r√ºckg√§ngig machen.</font></font><br><br><hr><a name="chap10"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Personal Computer Cloud Sync </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich betrachte mich nicht als echten Programmierer. In den letzten zehn Jahren habe ich in Programmiersprachen programmiert, die nur bei der Entwicklung von Prozessoren oder Chips√§tzen verwendet werden. Aufgrund der Tatsache, dass ich 15 Jahre lang nichts in C / C ++ getan hatte, aber etwas auf dem Computer automatisieren musste, verwendete ich eher aktiv Skriptsprachen wie BAT / CMD oder Software wie Sign 0f Mistery oder xStarter. Nachdem ich herausgefunden und ausprobiert hatte, was AutoIt ist, ist dies eine neue √Ñra in meiner PC-Automatisierung.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nachdem ich von der Stabilit√§t und Zuverl√§ssigkeit des Synchronisationssystems auf Smartphones √ºberzeugt war, dachte ich, dass es sch√∂n w√§re, Daten auf meinem Heimcomputer zu synchronisieren. Nextcloud hat einen eigenen Client f√ºr Windows und war nat√ºrlich der erste Kandidat f√ºr Tests. Ich wollte ein Datenvolumen in der Gr√∂√üenordnung von einem Terabyte synchronisieren, das aus Hunderttausenden von Dateien unterschiedlicher Gr√∂√üe bestand. Die Daten waren unterschiedlich: Musik, Bilder, Dokumente, E-Books, Distributionen, Backup-Sites und so weiter und so fort. Es w√§re vern√ºnftig, all dies auf die Synchronisation kritischerer Daten wie beispielsweise Dokumente zu reduzieren, aber die Aufregung ergriff mich und ich wollte die St√§rke des Dienstes √ºberpr√ºfen.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Zehn Stunden nach dem Start der Synchronisierung und dem ersten Hochladen von Inhalten auf den Server stolperte der Client √ºber eine Datei mit einem langen Namen. Zu diesem Zeitpunkt habe ich auf dem Server auch die externe Speicherverbindung √ºber freigegebene VMWare-Ordner verwendet. Ich musste ein Dutzend Clients ausprobieren und dann einfache Experimente zum manuellen Kopieren von Dateien auf den Server durchf√ºhren, um zu verstehen, dass das Problem auf der Serverseite liegt. Nach einer Woche erfolgreichem Start des Dienstes musste ich ein Rollback auf die virtuelle Backup-Maschine durchf√ºhren und den Mechanismus f√ºr freigegebene VMWare-Ordner aufgeben, um von vorne zu beginnen. Am Ende habe ich diesen Engpass auf der Serverseite beseitigt, die Zuverl√§ssigkeit der L√∂sung f√ºr eine Woche der Synchronisierung von Smartphones getestet und mich entschlossen, wieder zu meinem Heimcomputer zur√ºckzukehren. Diesmal stolperte der Kunde nicht √ºber die ungl√ºckselige Akte und ich war bereits frohNach einem halben Tag der Synchronisierung kleiner Dateien fror der Client jedoch erneut ein. Nun stellte sich heraus, dass der Pfad auf der Seite des Heimcomputers zu lang ist und der Nextcloud-Client ihn nicht richtig verarbeiten kann. Leider funktionierte der native Nextcloud-Client nicht und sein Informationsgehalt war nicht sehr hoch, so dass ich ihn aufgeben musste.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich habe einige Zeit damit verbracht, ein geeignetes Programm f√ºr die Synchronisierung zu finden, das die Befehlszeilenverwaltung unterst√ºtzt. Ich wollte meine Aufgabe f√ºr jeden gro√üen Ordner auf dem Computer erledigen und sie im Batch-Modus ausf√ºhren. Zuvor hatte ich bereits eine Reihe von BAT-Dateien f√ºr die Synchronisierung mithilfe von Skripten und die Verwaltung von FreeFileSync √ºber die Befehlszeile erstellt und ausgearbeitet. Das Problem langer Pfade oder Dateinamen wurde gel√∂st, indem lokale Ordner der Form "\\? \ D: \ Info" festgelegt wurden, d. H. Im Wesentlichen wird der lokale Ordner als Netzwerkordner bezeichnet. Was jedoch webdav FreeFileSync ist, wei√ü nicht. Leider gab es keine vollst√§ndigen Analoga von FolderSync f√ºr Windows, aber mehr als einmal in den Foren wurde GoodSync empfohlen, und nachdem ich ein Dutzend anderer Programme gecastet hatte, entschied ich mich, es zu versuchen. Leider ist GoodSync viel teurer,Aber eine einmalige Verschwendung von 15 US-Dollar f√ºr die Sicherheit ihrer wertvollen Daten ist im Prinzip eine machbare Verschwendung. Das Programm verf√ºgt √ºber einen Testmodus, sodass Sie zun√§chst die Leistung und Stabilit√§t √ºberpr√ºfen k√∂nnen.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GoodSync erwies sich als ziemlich freundliche Software. Es gibt eine spezielle tragbare Version namens GoodSync2Go. Also interessierte sie mich. W√§hrend der Installation m√ºssen Sie den Laufwerksbuchstaben ausw√§hlen und das Programm wird darauf im GoodSync-Ordner installiert. Ich habe den Synchronisierungsordner im Stammverzeichnis des Laufwerks erstellt, sagen wir D, und den erstellten GoodSync-Ordner mit dem gesamten Inhalt dorthin verschoben. </font></font><br><br> <sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dieser Text wurde</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> speziell f√ºr die Site </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">geektimes.ru</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AlexanderS geschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Der Link zur Quelle ist optional, aber die Referenz ist sehr w√ºnschenswert!</font></font></sup>  <sup>]]</sup> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nach der Installation muss das Programm Aufgaben erstellen: Der lokale Ordner und der Remote-Ordner f√ºr die Synchronisierung werden angezeigt. In den Auftragsparametern habe ich die Synchronisierung von links nach rechts mit den Optionen "Synchrones L√∂schen" und "Fr√ºhere Versionen gel√∂schter / ersetzter Dateien speichern" ausgew√§hlt. In den Einstellungen auf der linken Seite habe ich "Sichere Kopie" und "Ordner _gsdata_ nicht erstellen" auf der rechten Seite ausgew√§hlt - "Sichere Kopie" und "Schnelle Voranalyse nach Zeitstempeln". Somit werden Aufgaben f√ºr jeden erforderlichen Ordner erstellt. Angenommen, ich habe die Aufgabe im Ordner "Info" konfiguriert und "bck_Info" genannt. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Als N√§chstes wird im Ordner D: \ Sync die Datei bck_Info.bat mit den folgenden Inhalten erstellt:</font></font><br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dir=%~dp0 @%dir%GoodSync\GoodSync2Go-v10.exe /miniwin /<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> sync <span class="hljs-string"><span class="hljs-string">"%~n0"</span></span></code> </pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies ist die BAT-Skriptsprache. In der ersten Codezeile wird der aktuelle Pfad f√ºr das ausgef√ºhrte Skript auf die Variable festgelegt. In der zweiten Zeile wird die Datei GoodSync2Go-v10.exe aus dem Ordner GoodSync in diesem Pfad gestartet, in dem die Aufgabe mit dem Namen dieser Datei ausgef√ºhrt werden soll (bck_Info), das Fenster zur Ausf√ºhrung der Aufgabe minimiert wird und das Programm nach Abschluss der Aufgabe automatisch geschlossen wird. Ich kann dieses Skript mehrmals kopieren und jedes Mal nur seinen Namen in den Namen einer zuvor in GoodSync erstellten Aufgabe √§ndern. Durch einfaches Klicken auf die Eingabetaste in der BAT-Datei kann ich die Synchronisierung der Ordner starten, die ich einzeln ben√∂tige.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um eine neue Aufgabe in FreeFileSync hinzuzuf√ºgen, k√∂nnte ich einfach die XML-Skriptdatei kopieren und manuell korrigieren, d. H. </font><font style="vertical-align: inherit;">Das Ausf√ºhren der grafischen Shell des Programms war √ºberhaupt nicht erforderlich. </font><font style="vertical-align: inherit;">In GoodSync werden alle Aufgaben in der Datei D: \ Sync \ GoodSync \ GoodSync \ Profile \ jobs.tic registriert. Um eine neue Aufgabe hinzuzuf√ºgen, m√ºssen Sie das Programm √∂ffnen und erstellen, da </font><font style="vertical-align: inherit;">Das Bearbeiten dieser Datei ist etwas problematisch und es ist nicht bekannt, wozu dies f√ºhren k√∂nnte. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um alle Ordner zu synchronisieren, k√∂nnen Sie jetzt ein einfaches Skript bck_all.bat schreiben:</font></font><br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dir=%~dp0 call %dir%bck_Info.bat call %dir%bck_Info2.bat call %dir%bck_Info3.bat call %dir%bck_Info4.bat</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Jede Zeile des Skripts bewirkt einfach die Ausf√ºhrung eines separaten Skripts, das die Synchronisierung startet. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dies alles funktioniert sehr gut und bequem, aber es gibt keine Fehlerkontrolle w√§hrend der Synchronisation. Wenn der Server beispielsweise nicht eingeschaltet ist, werden alle Aufgaben schnell abgeschlossen, und ich bin nach einer Stunde zur√ºckgekehrt und denke, dass die Synchronisierung bereits abgeschlossen ist. Gleichzeitig werden die Protokolle aller Aufgaben entlang des Pfads D: \ Sync \ GoodSync \ GoodSync \ Profile \ * erstellt. Protokoll. Es reicht aus, nur das Protokoll jeder Synchronisation auf das Vorhandensein des Wortes "ERROR" zu √ºberpr√ºfen. Aus irgendeinem Grund werden die Synchronisationsfehler auf diese Weise im Protokoll gemeldet. Daher wurde beschlossen, nach allen Synchronisierungen ein kleines Programm zur Analyse dieser Protokolle zu schreiben, das nach der Synchronisierung aller Ordner automatisch gestartet werden sollte. Das Programm erhielt den stolzen Namen log_analayser und ist in der Semi-Scripting-Sprache </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AutoIt geschrieben</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Wenn jemand interessiert ist, dann </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">laden Sie die Vollversion herunter</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sie k√∂nnen auf der offiziellen AutoIt-Website, die die erforderlichen Bibliotheken enth√§lt, den Compiler und SciTE - einen plattform√ºbergreifenden Editor f√ºr den Code, aus dem Sie das Programm kompilieren k√∂nnen. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Zeit, die ich f√ºr die Entwicklung und das Debuggen des Codes aufgewendet habe, war eine log_analayser.au3-Datei mit folgendem Inhalt:</font></font><br><br><pre> <code class="plaintext hljs">; LOG Analyser 1.0 ;      - #Region ;**** Directives created by AutoIt3Wrapper_GUI **** #AutoIt3Wrapper_Res_Field=ProductName|LOG Analyser #AutoIt3Wrapper_Res_Fileversion=1.0.0.0 #AutoIt3Wrapper_Res_Field=OriginalFilename|log_analyser.exe #AutoIt3Wrapper_Res_Comment=     - #AutoIt3Wrapper_Res_Description= - ;**** #AutoIt3Wrapper_Res_Language=1049 #AutoIt3Wrapper_Res_ProductVersion=1.0 #AutoIt3Wrapper_Compile_Both=y #EndRegion ;**** Directives created by AutoIt3Wrapper_GUI **** ;AutoItSetOption ("WinTitleMatchMode", 2) ;       ;#NoTrayIcon ;         If WinExists('[CLASS:AutoIt v3;TITLE:' &amp; @ScriptName &amp; ']') Then MsgBox(48, @ScriptName, "     !"); ;             ;WinActivate('  ') Exit EndIf AutoItWinSetTitle(@ScriptName) #include &lt;Array.au3&gt; #include &lt;_FileDirList.au3&gt; ;  Local $msg_title = "LOG Analyser 1.0" Local $path = @ScriptDir Local $soft_open_log = "notepad.exe" Local $path, $dir_mode, $word, $file_analyse_name, $file_analyse_ext, $log_path, $log_msg_on Local $file_log, $word_detect, $file_analyse, $cnt_files, $i ;    if ($CmdLine[0] &lt; 6) then MsgBox(0x10, $msg_title, "   !" &amp; @CRLF &amp; @CRLF &amp; "  ") Exit else if (StringCompare($CmdLine[1], "file") = 0) then $dir_mode = 0 elseif (StringCompare($CmdLine[1], "dir") = 0) then $dir_mode = 1 else MsgBox(0x10, $msg_title, "     'file'  'dir'!" &amp; @CRLF &amp; @CRLF &amp; "  ") Exit endif $word = $CmdLine[2] if ($dir_mode = 0) then $file_analyse_name = $CmdLine[3] else $dir_analyse = $CmdLine[3] endif $file_analyse_ext = $CmdLine[4] $log_path = $CmdLine[5] if (StringCompare($CmdLine[6], "err_msg_on") = 0) then $log_msg_on = 1 elseif (StringCompare($CmdLine[6], "err_msg_off") = 0) then $log_msg_on = 0 else MsgBox(0x10, $msg_title, "     'log_msg_on'  'log_msg_off'!" &amp; @CRLF &amp; @CRLF &amp; "  ") Exit endif endIf ;   $file_log = $log_path &amp; "\" &amp; "log_analyser" &amp; "-" &amp; @YEAR &amp; "-" &amp; @MON &amp; "-" &amp; @MDAY &amp; "-" &amp; @HOUR &amp; "-" &amp; @MIN &amp; "-" &amp; @SEC &amp; ".log" $word_detect = 0 ;    if ($dir_mode = 0) then $file_analyse = $file_analyse_name &amp; "." &amp; $file_analyse_ext if (_file_analyser($file_analyse, $msg_title, $word, $file_log, $word_detect) = 1) then $word_detect = 1 endif else ;     $dir_arr = _FileDirList($dir_analyse, "*."&amp;$file_analyse_ext, 1, 1, 0) ;_ArrayDisplay($dir_arr) ;    -       if ($dir_arr = 0) then MsgBox(0x10, $msg_title, "       !" &amp; @CRLF &amp; @CRLF &amp; "  ") Exit endif $cnt_files = $dir_arr[0] ;    $i = 0 While $i &lt;&gt; $cnt_files $i = $i + 1 $file_analyse = $dir_arr[$i] if (_file_analyser($file_analyse, $msg_title, $word, $file_log, $word_detect) = 1) then $word_detect = 1 endif WEnd endif ;    if ($word_detect = 1) and ($log_msg_on = 1) then if (MsgBox (0x41034, $msg_title, " !" &amp; @CRLF &amp; "      : " &amp; $file_log &amp; @CRLF &amp; @CRLF &amp; "   ?")) = 6 then ShellExecuteWait($soft_open_log, $file_log) endif endif Exit ;                    ;   ,   ,     Func _file_analyser($file_analyse, $msg_title, $word, $file_log, $word_detect) Local $file1, $file2, $file_line, $write_once $word_detect = 0 $write_once = 0 $file1 = FileOpen($file_analyse, 0) ;     If $file1 = -1 Then FileClose($file1) MsgBox(0x10, $msg_title, "   !" &amp; @CRLF &amp; @CRLF &amp; "  ") Exit EndIf ;       While 1 $file_line = FileReadLine($file1) If @error = -1 Then ExitLoop if (StringInStr($file_line, $word) &lt;&gt; 0) then $word_detect = 1 ;            if (FileExists($file_log) = 0) then $file2 = FileOpen($file_log, 1) FileClose($file2) endif ;        if ($write_once = 0) then $write_once = 1 $file2 = FileOpen($file_log, 1) FileWriteLine($file2, " : " &amp; $file_analyse) FileClose($file2) endif ;       $file2 = FileOpen($file_log, 1) FileWriteLine($file2, $file_line) FileClose($file2) endif WEnd ;     ,          if ($word_detect = 1) then $file2 = FileOpen($file_log, 1) FileWriteLine($file2, @CRLF) FileClose($file2) endif FileClose($file1) Return $word_detect EndFunc</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dr√ºcken Sie nach Eingabe des Codes die Taste F7 im SciTE-Editor und rufen Sie die Datei log_analayser.exe am Ausgang ab. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Programm analysiert die Datei auf das Vorhandensein eines Wortes. Wenn es gefunden wird, wird eine Protokolldatei erstellt, in die die gefundene Zeile mit diesem Wort kopiert wird. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Programm kann in zwei Modi arbeiten: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Analyse einer bestimmten Datei </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Analyse des Ordners mit den zu analysierenden Dateien (alle Unterordner werden ebenfalls analysiert). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie einen Konsolenaufruf t√§tigen, m√ºssen Sie sechs Parameter f√ºr das Programm festlegen: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 - Betriebsmodus [Datei = Dateianalyse; dir = Analyse des Ordners mit den Dateien] </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 - Suchwort </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 - Dateiname oder vollst√§ndiger Pfad zum Ordner </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 - Dateierweiterung oder Dateien zur Analyse im Ordner</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5 - der vollst√§ndige Pfad zu dem Ordner, in dem sich das Programmprotokoll befindet; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">6 - Fensteranzeige nach Analyse aller Dateien, wenn das angegebene Wort gefunden wird [err_msg_on = display; </font><font style="vertical-align: inherit;">err_msg_off = nicht anzeigen] </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Daher haben wir ein neues Skript bck_auto.bat erhalten:</font></font><br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Start Backup @<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dir=%~dp0 call %dir%bck_all.bat log_analyser.exe dir  %dir%GoodSync\Profile <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> %dir%LOG err_msg_on <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Skript startet eine Datei, aus der die Aufgaben zum Synchronisieren aller erforderlichen Ordner einzeln nacheinander aufgerufen werden. Anschlie√üend wird der Synchronisationsprotokollanalysator aufgerufen. Im Fehlerfall wird eine Meldung angezeigt, in der Sie aufgefordert werden, die Protokollzeilen zu √ºberpr√ºfen, in denen diese Fehler gefunden wurden, und zu verstehen, welche Aufgabe Sie ausf√ºhren k√∂nnen Probleme sind aufgetreten. </font><font style="vertical-align: inherit;">Diese Zeilen werden in eine separate Protokolldatei im Ordner D: \ Sync \ LOG geschrieben.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Und dann erlitt ich einen schrecklichen Misserfolg. Log Analyzer hat nicht funktioniert. Nein, es hat bei Testdateien hervorragend funktioniert, wollte aber hartn√§ckig keine Fehler in den Protokollen sehen. Lange Zeit konnte ich nicht verstehen, was der Grund war, bis ich eine schreckliche Sache herausfand: Nicht nur, dass im englischsprachigen Protokoll der Fehler durch das einzige russischsprachige Wort "ERROR" angezeigt wird, sondern auch die Kodierung dieses kyrillischen Alphabets ist Macintosh! Ich wei√ü nicht, warum die Programmierer von Siber Systems dies getan haben. Dies ist h√∂chstwahrscheinlich das Ergebnis einer schrecklichen Kr√ºcke in der Software. Wer hat gesagt, dass Programmieren langweilig sein sollte? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es blieb keine andere Wahl, als eine Kr√ºcke mit einer anderen zu st√ºtzen, und als Ergebnis erschien eine funktionierende Konstruktion:</font></font><br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Start Backup @<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dir=%~dp0 call %dir%bck_all.bat log_analyser.exe dir –ãÀú‚Ç¨–É–â–Ç %dir%GoodSync\Profile <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> %dir%LOG err_msg_on <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das folgende Problem trat jedoch auf: GoodSync selbst l√∂scht keine Protokolldateien, bei jeder neuen Aufgabenausf√ºhrung werden neue Dateien angezeigt. </font><font style="vertical-align: inherit;">Und wenn eine Synchronisierung fehlgeschlagen ist, findet unser Analysator diese Datei immer und meldet den Fehler fr√∂hlich. </font><font style="vertical-align: inherit;">Daher wurde vor dem Start der Synchronisierung beschlossen, den Ordner D: \ Sync automatisch von allen Protokolldateien zu bereinigen. </font><font style="vertical-align: inherit;">Hierzu wurde ein elegantes Skript clean_logs.bat erstellt:</font></font><br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dir=%~dp0 For /R %dir% %%i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (*.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>) Do ( Del /q <span class="hljs-string"><span class="hljs-string">"%%i"</span></span>) @<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> on</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Skript deaktiviert die Ausgabe von Nachrichten, ermittelt das Skriptstartverzeichnis, durchsucht alle Dateien (einschlie√ülich Unterordner) bis zum Ende und l√∂scht alle Dateien mit der Protokollerweiterung. </font><font style="vertical-align: inherit;">Am Ende der Arbeit wird die Nachrichtenausgabe eingeschaltet. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Skript bck_auto.bat wurde ge√§ndert:</font></font><br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Start Backup @<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dir=%~dp0 @call clean_logs.bat call %dir%bck_all.bat log_analyser.exe dir –ãÀú‚Ç¨–É–â–Ç %dir%GoodSync\Profile <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> %dir%LOG err_msg_on <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alles funktioniert sehr gut, aber es geht darum, Routinema√ünahmen zu automatisieren. </font><font style="vertical-align: inherit;">Warum nicht einfach den Computer nachts ausschalten und schlafen gehen, und er wird eine Reihe von Dateien selbst synchronisieren, analysieren und den Pfad ausschalten? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√Ñndern wir unser Skript bck_auto.bat:</font></font><br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Start Backup &amp; PCOFF @<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dir=%~dp0 start MonitorOnOff.exe 0 @call clean_logs.bat call %dir%bck_all.bat log_analyser.exe dir –ãÀú‚Ç¨–É–â–Ç %dir%GoodSync\Profile <span class="hljs-built_in"><span class="hljs-built_in">log</span></span> %dir%LOG err_msg_off shutdown /s /t 0 <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im Skript wurden zwei neue Zeilen angezeigt. </font><font style="vertical-align: inherit;">Die MonitorOnOff-Anwendung schaltet den Monitor einfach aus (damit er den Raum nicht beleuchtet, aber jeden Abend manuell auszuschalten und jeden Morgen einzuschalten ist sehr faul), und der Befehl zum Herunterfahren schaltet den Computer aus. </font><font style="vertical-align: inherit;">Der Parameter, der f√ºr die Anzeige von Nachrichten verantwortlich ist, wenn ein Fehler gefunden wurde, hat sich in log_analyser ge√§ndert, da es nach der Synchronisierung nicht erforderlich ist, die Ausf√ºhrung des Skripts durch diese Nachricht zu verlangsamen, sondern den Computer auszuschalten. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MonitorOnOff ist auch in AutoIt geschrieben.</font></font><br><br><pre> <code class="plaintext hljs">; Monitor On Off 1.0 ;   /  #Region ;**** Directives created by AutoIt3Wrapper_GUI **** #AutoIt3Wrapper_Res_Field=ProductName|Monitor On Off #AutoIt3Wrapper_Res_Fileversion=1.0.0.0 #AutoIt3Wrapper_Res_Field=OriginalFilename|MonitorOnOff.exe #AutoIt3Wrapper_Res_Comment=  /  #AutoIt3Wrapper_Res_Description=  /  ;**** #AutoIt3Wrapper_Res_Language=1049 #AutoIt3Wrapper_Res_ProductVersion=1.0 #AutoIt3Wrapper_Compile_Both=y #EndRegion ;**** Directives created by AutoIt3Wrapper_GUI **** ;AutoItSetOption ("WinTitleMatchMode", 2) ;       ;#NoTrayIcon ;         If WinExists('[CLASS:AutoIt v3;TITLE:' &amp; @ScriptName &amp; ']') Then MsgBox(48, @ScriptName, "     !"); ;             ;WinActivate('  ') Exit EndIf AutoItWinSetTitle(@ScriptName) HotKeySet("{F10}", "_Monitor_ON") HotKeySet("{F11}", "_Monitor_OFF") HotKeySet("{Esc}", "_Quit") Global Const $lciWM_SYSCommand = 274 Global Const $lciSC_MonitorPower = 61808 Global Const $lciPower_Off = 2 Global Const $lciPower_On = -1 Global $MonitorIsOff = False if ($CmdLine[0] &lt;&gt; 0) then _Monitor_OFF() endif While 1 Sleep(10) WEnd Func _Monitor_ON() $MonitorIsOff = False Local $Progman_hwnd = WinGetHandle('[CLASS:Progman]') DllCall('user32.dll', 'int', 'SendMessage', _ 'hwnd', $Progman_hwnd, _ 'int', $lciWM_SYSCommand, _ 'int', $lciSC_MonitorPower, _ 'int', $lciPower_On) EndFunc Func _Monitor_OFF() $MonitorIsOff = True Local $Progman_hwnd = WinGetHandle('[CLASS:Progman]') While $MonitorIsOff = True DllCall('user32.dll', 'int', 'SendMessage', _ 'hwnd', $Progman_hwnd, _ 'int', $lciWM_SYSCommand, _ 'int', $lciSC_MonitorPower, _ 'int', $lciPower_Off) _IdleWaitCommit(0) Sleep(20) WEnd EndFunc Func _IdleWaitCommit($idlesec) Local $iSave, $LastInputInfo = DllStructCreate ("uint;dword") DllStructSetData ($LastInputInfo, 1, DllStructGetSize ($LastInputInfo)) DllCall ("user32.dll", "int", "GetLastInputInfo", "ptr", DllStructGetPtr ($LastInputInfo)) Do $iSave = DllStructGetData ($LastInputInfo, 2) Sleep(60) DllCall ("user32.dll", "int", "GetLastInputInfo", "ptr", DllStructGetPtr ($LastInputInfo)) Until (DllStructGetData ($LastInputInfo, 2)-$iSave) &gt; $idlesec Or $MonitorIsOff = False Return DllStructGetData ($LastInputInfo, 2)-$iSave EndFunc Func _Quit() _Monitor_ON() Exit EndFunc</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das gestartete Programm wird √ºber drei Tasten gesteuert: F10 schaltet den Monitor ein, F11 - schaltet sich aus und die ESC-Taste beendet das Programm und entl√§dt es aus dem Speicher. Wenn Sie beim Starten des Programms einen Parameter angeben, schaltet das laufende Programm den Bildschirm sofort aus.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt war alles in Ordnung - bevor ich ins Bett ging, lief ich einfach bck_all.bat anstelle von "Computer ausschalten" und ging ins Bett. Der Monitor beleuchtete nicht den gesamten Raum, die Synchronisation wurde automatisch durchgef√ºhrt und der Erfolg wurde automatisch analysiert. Am Morgen mussten Sie nur den Inhalt des Ordners D: \ Sync \ GoodSync \ LOG \ nach mindestens einigen Dateien durchsuchen. Dies ist aber auch nicht der Fall - warum Zeit verschwenden, wenn alles in Ordnung ist? Ich muss einen Protokollanalysator f√ºr den Protokollanalysator erstellen und ihn beim Systemstart aufh√§ngen, damit er am n√§chsten Tag beim Hochfahren des Computers funktioniert und meine Aufmerksamkeit nur dann beeintr√§chtigt, wenn die Synchronisierung fehlschl√§gt. So entstand das Programm check_file_exist.</font></font><br><br><pre> <code class="plaintext hljs">; Check File Exist 1.0 ;        #Region ;**** Directives created by AutoIt3Wrapper_GUI **** #AutoIt3Wrapper_Res_Field=ProductName|Check File Exist #AutoIt3Wrapper_Res_Fileversion=1.0.0.0 #AutoIt3Wrapper_Res_Field=OriginalFilename|check_file_exist.exe #AutoIt3Wrapper_Res_Comment=       #AutoIt3Wrapper_Res_Description=   ;**** #AutoIt3Wrapper_Res_Language=1049 #AutoIt3Wrapper_Res_ProductVersion=1.0 #AutoIt3Wrapper_Compile_Both=y #EndRegion ;**** Directives created by AutoIt3Wrapper_GUI **** ;AutoItSetOption ("WinTitleMatchMode", 2) ;       ;#NoTrayIcon ;         If WinExists('[CLASS:AutoIt v3;TITLE:' &amp; @ScriptName &amp; ']') Then MsgBox(48, @ScriptName, "     !"); ;             ;WinActivate('  ') Exit EndIf AutoItWinSetTitle(@ScriptName) #include &lt;Array.au3&gt; #include &lt;_FileDirList.au3&gt; ;  Local $msg_title = "Check File Exist 1.0" Local $path = @ScriptDir Local $soft_open_dir = "explorer.exe" Local $path, $dir_analyse, $words, $msg_open ;    if ($CmdLine[0] &lt; 5) then MsgBox(0x10, $msg_title, "   !" &amp; @CRLF &amp; @CRLF &amp; "  ") Exit else $dir_analyse = $CmdLine[1] $file = $CmdLine[2] $words0 = $CmdLine[3] $words1 = $CmdLine[4] if (StringCompare($CmdLine[5], "msg_on") = 0) then $msg_open = 1 elseif (StringCompare($CmdLine[5], "msg_off") = 0) then $msg_open = 0 else MsgBox(0x10, $msg_title, "     'msg_on'  'msg_off'!" &amp; @CRLF &amp; @CRLF &amp; "  ") Exit endif endIf ;      $dir_arr = _FileDirList($dir_analyse, "*"&amp;$file&amp;"*", 1, 0, 0) ;_ArrayDisplay($dir_arr) ;      if ($dir_arr = 0) then if (StringCompare($words0, "0") &lt;&gt; 0) then if ($msg_open = 0) then MsgBox(0x41030, $msg_title, $words0) else if (MsgBox(0x41034, $msg_title, $words0 &amp; @CRLF &amp; @CRLF &amp; "     ?")) = 6 then ShellExecuteWait($soft_open_dir, $dir_analyse) endif endif endif else if (StringCompare($words1, "0") &lt;&gt; 0) then if ($msg_open = 0) then MsgBox(0x41030, $msg_title, $words1) else if (MsgBox(0x41034, $msg_title, $words1 &amp; @CRLF &amp; @CRLF &amp; "    ?")) = 6 then ShellExecuteWait($soft_open_dir, $dir_analyse) endif endif endif endif Exit</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Im Wesentlichen handelt es sich bei diesem Programm um eine leicht verk√ºrzte log_analyser-Funktionalit√§t. Das Programm analysiert den angegebenen Ordner (ausgenommen Unterordner) auf Dateien und Namen, die zumindest teilweise mit dem angegebenen Suchwort √ºbereinstimmen, und zeigt eine Meldung √ºber das Ergebnis des Scans an. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Programmparameter: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 - der vollst√§ndige Pfad zum Ordner (ohne Schr√§gstrich - /) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 - das Schl√ºsselwort f√ºr die Suche in Dateinamen oder der vollst√§ndige Dateiname </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3 - Textzeichenfolge, die angezeigt wird, wenn die Datei nicht gefunden wird, wenn = 0 - Meldung </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4 - Text </font><font style="vertical-align: inherit;">nicht anzeigen </font><font style="vertical-align: inherit;">Die Zeile, die angezeigt wird, wenn die Datei gefunden wird. Wenn = 0 - Keine Meldung anzeigen</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5 - Nachrichtenausgabe: msg_off - es wird nur eine Nachricht √ºber das Vorhandensein / Fehlen von Dateien angezeigt, msg_on - im angezeigten Fenster wird auch vorgeschlagen, den Ordner zu √∂ffnen, in dem die Dateien erkannt oder nicht gefunden werden. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jetzt habe ich f√ºr dieses Programm das Skript Check_LOG_from_log_analyser.bat erstellt, dessen Link ich in das √ºbliche eingef√ºgt habe Windows-Start:</font></font><br><br><pre> <code class="bash hljs">@<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> dir=%~dp0LOG start check_file_exist.exe %dir% .<span class="hljs-built_in"><span class="hljs-built_in">log</span></span> 0 <span class="hljs-string"><span class="hljs-string">"     !"</span></span> msg_on <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Somit haben wir im Finale eine v√∂llig autonome L√∂sung erhalten, die nicht vom Speicherort des Synchronisierungsordners abh√§ngt und von √ºberall auf unserem Computer korrekt funktioniert. </font><font style="vertical-align: inherit;">Die L√∂sung ist nicht nur praktikabel, sondern auch stabil - unter Windows 7 x64 funktionierte dieser Satz von Skripten ein Jahr lang und es gab absolut keine Probleme damit.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vielleicht scheint das alles jetzt etwas monstr√∂s, aber es ist nichts Kompliziertes daran. </font><font style="vertical-align: inherit;">Wenn Sie sich den AutoIt-Code genau ansehen, ist die Grundkonstruktion die √ºbliche If-Then-else-End-Schleife des gleichen Typs f√ºr jede Programmiersprache, in der einige sich wiederholende AutoIt-Operatoren und -Funktionen gelernt werden, die an einigen Abenden buchst√§blich gelernt werden. </font><font style="vertical-align: inherit;">Die Skriptsprache BAT kann nicht einmal unterrichtet werden, da die meisten L√∂sungen Standard sind und seit langem im Internet beschrieben werden. </font><font style="vertical-align: inherit;">Programmieren zu k√∂nnen ist nicht nur interessant, sondern kann auch sehr n√ºtzlich sein.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ode an den Code von Dark Dragon</font></font></b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/mt/oe/bi/mtoebi7ufvsfmzqjs52tihnxwiy.jpeg"><br></div></div><br><hr><a name="chap11"></a><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Nachwort </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Um ehrlich zu sein, nahm ich an, aber ich hatte nicht mit einer solchen Menge an Artikeln gerechnet, die ich bis zu f√ºnfzig Stunden verbringen musste. In der Regel reduziert sich die Installation Ihrer Cloud im Internet auf folgende Aussagen: "Ja, Sie m√ºssen dort mehrere Befehle ausf√ºhren." Es ist wahr - die Installation ist trivial. Wenn Sie wissen, welche Befehle in die Konsole eingegeben werden m√ºssen und was sie bedeuten. Wenn Sie die Essenz des Routings im Netzwerk verstehen. Wenn Sie bereits einen funktionierenden Server haben und wissen, wie Sie einen Host hinzuf√ºgen. Wenn Sie wissen, wie Sie eine Site einrichten. Das hei√üt, um diese verschiedenen Befehle anzuwenden, m√ºssen Sie √ºber ein gewisses Ma√ü an Wissen und Erfahrung verf√ºgen. Der Zweck dieser drei Artikel ist der Versuch, ein solches Gep√§ck zu erstellen, indem die erforderlichen ausreichenden Informationen an einem Ort gesammelt und die korrekte Verwendung erl√§utert werden. Ich hoffe aufrichtigdass diese Artikelserie jemandem hilft, seine ersten bewussten Schritte in die Welt der freien Software zu unternehmen.</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kehren Sie </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zum Anfang zur√ºck, zum Inhaltsverzeichnis</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><hr><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Die Geschichte der Erstellung einer Home Cloud. </font><font style="vertical-align: inherit;">Teil 3. Erstellen einer pers√∂nlichen Cloud - Installieren und Konfigurieren von Nextcloud. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Textversion: 1.2.1. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Datum der Erstver√∂ffentlichung: 02/08/2018. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Letzte √Ñnderung: 15.01.2020.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Protokoll aktualisieren</font></font></b> <div class="spoiler_text"> 1.2.1 [15-01-2020] <br>  . <br><br> 1.2.0 [08-02-2018] <br>  . <br><br> 1.1.0 [08-02-2018] <br>  . <br><br> 1.0.0 [08-02-2018] <br>  . <br>     Nextcloud 11.0.2    VMWare,    VMWare     ,     Nextcloud. <br></div></div><br><hr><a name="bug"></a><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Informationen zur Verwaltung der Ressource (vermuteter Fehler)</font></font></b> <div class="spoiler_text">   -  (, code  blockquote) <b>  </b>   : <br><blockquote> [Definition] <br> failregex={¬´reqId¬ª:".*",¬´remoteAddr¬ª:".*",¬´app¬ª:¬´core¬ª,¬´message¬ª:¬´Login failed: '.*' \(Remote IP: ''\)¬ª,¬´level¬ª:2,¬´time¬ª:".*"} <br> ignoreregex = <br></blockquote><br>          !       , ..      .    (/)  ‚Äî    .  : <br> ‚Äî   <br> ‚Äî          <br> ‚Äî  ,   ¬´  Nextcloud¬ª   , ,  <br> ‚Äî  ,         <br><br></div></div><br><hr></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de410011/">https://habr.com/ru/post/de410011/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de410001/index.html">Wie hat sich die menschliche Wahrnehmung des Raums entwickelt und warum brauchen wir Messungen?</a></li>
<li><a href="../de410003/index.html">Forschungsergebnisse: Piraterie hilft vielen K√ºnstlern, den Umsatz zu verbessern</a></li>
<li><a href="../de410005/index.html">Strom auspressen</a></li>
<li><a href="../de410007/index.html">Distr. √úberpr√ºfung n√ºtzlicher Programme sp√§t f√ºr 16 Jahre</a></li>
<li><a href="../de410009/index.html">Ist Blockchain pers√∂nliche Sicherheit oder pers√∂nliche Gefahr?</a></li>
<li><a href="../de410013/index.html">8 Kommunikationsregeln in einem mehrsprachigen Umfeld: Anweisungen f√ºr Mitarbeiter internationaler Unternehmen</a></li>
<li><a href="../de410017/index.html">UNICEF ermutigt Spieler, Sendungen f√ºr syrische Kinder abzubauen</a></li>
<li><a href="../de410019/index.html">Was Sie √ºber Kinderaugen wissen m√ºssen</a></li>
<li><a href="../de410023/index.html">Dell Precision 5720 All-in-One-Test: Leistungsstarkes All-in-One-All-in-One</a></li>
<li><a href="../de410025/index.html">Was wird sich 2018 an SSD und RAM √§ndern - der neue Kingston und HyperX</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>