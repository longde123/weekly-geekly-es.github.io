<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü¶Ü üë®üèª‚Äçüíº ‚òéÔ∏è Transmita v√≠deo h264 sem transcodifica√ß√£o de uma c√¢mera Logitech C920 üë©üèæ‚Äçüî¨ ‚òÆÔ∏è üéß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O atraso n√£o foi superior a 0,3 segundos, devido ao fato de a c√¢mera estar conectada a um BeagleBone Blue fraco com uma carga de processador n√£o super...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Transmita v√≠deo h264 sem transcodifica√ß√£o de uma c√¢mera Logitech C920</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/415567/"><img src="https://habrastorage.org/webt/dc/by/xs/dcbyxsicqllz2-jksmikcesodlu.jpeg"><br><br>  O atraso n√£o foi superior a 0,3 segundos, devido ao fato de a c√¢mera estar conectada a um BeagleBone Blue fraco com uma carga de processador n√£o superior a 30% e o fluxo de v√≠deo ser transmitido por um roteador wifi a um laptop. <br><a name="habracut"></a><br>  Inicialmente, a tarefa era transmitir v√≠deo do rob√¥ para um computador grande sem carregar o processador e sem atrasos.  No processo de busca de c√¢meras e programas para esta tarefa, verificou-se que existem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√¢meras com codifica√ß√£o de v√≠deo baseada em hardware na pr√≥pria c√¢mera</a> , ap√≥s as quais a c√¢mera Logitech C920 foi comprada.  E come√ßaram os testes e as experi√™ncias, durante os quais duas op√ß√µes de tradu√ß√£o foram encontradas sem transcodifica√ß√£o. <br><br>  Todas as a√ß√µes adicionais s√£o verificadas no Ubuntu 16.04, a segunda op√ß√£o provavelmente funciona no Windows <br><br><h3>  Transmita v√≠deo codificado por hardware de uma c√¢mera Logitech C920 via cvlc e v4l2 </h3><br>  clvc - transmiss√£o de v√≠deo do servidor via vlc na linha de comando. <br><br><h4>  Hardware que codifica um fluxo de v√≠deo </h4><br>  Defina as c√¢meras de formato de pixel como H264 <br><br><pre><code class="bash hljs">v4l2-ctl --device=/dev/video1 --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span>-fmt-video=width=800,height=600,pixelformat=1</code> </pre> <br>  Teste o H264 com vlc, para que n√£o redefina as configura√ß√µes: <br><br><pre> <code class="bash hljs">cvlc v4l2:///dev/video1 --demux h264</code> </pre> <br>  Se voc√™ tentar isso, o vlc redefinir√° as configura√ß√µes antes de jogar: <br><br><pre> <code class="bash hljs">cvlc v4l2:///dev/video1:chroma=h264</code> </pre> <br>  A reprodu√ß√£o funciona.  Obtemos o fluxo H264 da c√¢mera.  Agora vamos passar pela rede via HTTP: <br><br><pre> <code class="bash hljs">cvlc v4l2:///dev/video1:chroma=h264:width=800:height=600 --sout <span class="hljs-string"><span class="hljs-string">'#standard{access=http,mux=ts,dst=localhost:8080,name=stream,mime=video/ts}'</span></span> -vvv</code> </pre> <br>  (na rede, voc√™ precisa usar o endere√ßo IP do seu dispositivo local em vez do host local) <br><br>  Lan√ßamento do receptor: <br><br><pre> <code class="bash hljs">mplayer http://localhost:8080/</code> </pre> <br>  Acontece que o MPEG-TS permite que o mplayer se conecte ao fluxo a qualquer momento com um pequeno atraso (provavelmente esperando por um quadro-chave ou sth). <br><br>  Se voc√™ usar mux = avi, mime = video / avi, precisar√° executar o mplayer no momento em que iniciar o vlc, caso contr√°rio, o mplayer n√£o come√ßar√° a ser reproduzido. <br><br><h4>  Erro Ffmpeg </h4><br><ul><li>  Se voc√™ tentar jogar o ffmpeg em vez do vlc, provavelmente encontrar√° este problema: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ffmpeg.org/trac/ffmpeg/ticket/1387</a> </li><li>  Assim que voc√™ executar o ffmpeg, ele mudar√° para "V√≠deo: rawvideo (YUY2 / 0x32595559)" </li><li>  Enquanto estiver aceitando MJPEG, ele n√£o funcionar√° com o H.264 </li><li>  O mesmo acontece ao usar qv4l2: iniciar a captura no modo H264 na verdade fornece a janela de v√≠deo YUY2 </li></ul><br><h4>  Reproduzir v√≠deo decodificado por hardware </h4><br>  O Mplayer pode reproduzir o buffer de quadros, verifique se o X n√£o est√° funcionando e digite: <br><br><pre> <code class="bash hljs">mplayer http://192.168.1.100:8080/ -fs -framedrop -vo fbdev</code> </pre> <br>  Voc√™ tamb√©m pode jogar na janela X se quiser: execute o X na linha de comando: <br><br><pre> <code class="bash hljs">Xorg -retro &amp;&gt; /dev/zero</code> </pre> <br>  H√° toneladas de mensagens de erro fbdev que silenciosamente colocamos em / dev / zero <br><br>  Reproduza um fluxo de v√≠deo de uma fonte LAN vlc (consulte a se√ß√£o acima): <br><br><pre> <code class="bash hljs">DISPLAY=<span class="hljs-string"><span class="hljs-string">":0"</span></span> mplayer http://192.168.1.100:8080/ -fs -framedrop</code> </pre> <br><ul><li>  Se fizermos isso, perceberemos que ainda n√£o estamos usando o Xvideo ou qualquer acelera√ß√£o de hardware </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O linux-sunxi.org/CedarX</a> parece nos fornecer uma biblioteca VPU, que infelizmente √© uma coisa insegura do Allwinner </li><li>  Mas h√° um VLC hackeado que pode us√°-lo: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">linux-sunxi.org/VLC</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Compilado com sucesso</a> </li></ul><br><h4>  Raspberry pi </h4><br>  Caso voc√™ tenha artefatos na imagem e os fluxos do Raspberry Pi, use: <br><br><pre> <code class="bash hljs">cvlc v4l2:///dev/video0:chroma=h264 ...</code> </pre> <br>  Pode ser necess√°rio atualizar o firmware: <br><br><pre> <code class="bash hljs">apt-get install rpi-update raspi-config rpi-update reboot</code> </pre> <br><h4>  Resumo de transmiss√£o via cvlc e v4l2 </h4><br>  Os testes mostraram que a carga do processador no Beaglebone Blue n√£o ultrapassa 30%, o que √© muito bom para um processador fraco, mas n√£o est√° claro como enviar esse v√≠deo para o ROS. <br><br>  Se a largura de banda do wifi n√£o for suficiente, o atraso do v√≠deo aumentar√° bastante. Em teoria, isso pode ser resolvido alternando de tcp para udp, a documenta√ß√£o do cvlc menciona a possibilidade de transmiss√£o via udp. <br><br><h3>  Transmita v√≠deo codificado por hardware de uma c√¢mera Logitech C920 via Gstreamer </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Artigo original do desenvolvedor que suporta este m√©todo no Gstreamer.</a> <br>  Instale o gstreamer no Ubuntu 16.04 <br><br><pre> <code class="bash hljs">sudo apt-get install libgstreamer1.0-0 gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly gstreamer1.0-libav gstreamer1.0-doc gstreamer1.0-tools sudo apt-get install libgstreamer-plugins-base1.0-dev</code> </pre> <br><h4>  A fonte uvch264src permite: </h4><br><ul><li>  Capture simultaneamente um fluxo de v√≠deo codificado em hardware h264 e um fluxo de v√≠deo de rastreador. </li><li>  Configurar codifica√ß√£o de v√≠deo por hardware (taxa de bits, quadros-chave e mais) </li></ul><br>  A fonte secund√°ria do visor √© um conceito interessante.  Al√©m do fluxo principal H.264, voc√™ obt√©m um fluxo secund√°rio de baixa resolu√ß√£o no formato MJPG ou YUV.  N√£o tenho certeza se esse √© um recurso da c√¢mera gstreamer, driver ou bloco de origem, mas espero que seja √∫til para nossas c√¢meras Beaglebone, desde que a fun√ß√£o n√£o use um processador muito grande para converter entre raw e jpg. <br><br>  A seguir, √© apresentado um exemplo de um pipeline que exibe um fluxo H.264 de alta resolu√ß√£o e um fluxo no visor: <br><br><pre> <code class="bash hljs">gst-launch-1.0 -v -e uvch264src device=/dev/video0 name=src auto-start=<span class="hljs-literal"><span class="hljs-literal">true</span></span> src.vfsrc ! queue ! video/x-raw,format=YUY2,width=320,height=240,framerate=10/1 ! xvimagesink sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span> src.vidsrc ! queue ! video/x-h264,width=1280,height=720,framerate=30/1 ! h264parse ! avdec_h264 ! xvimagesink sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  O fluxo prim√°rio H.264 √© decodificado usando o bloco avdec_h264, acess√≠vel atrav√©s do pacote gst-libav, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">veja notas no wiki do oz9aec</a> .  O painel do visor pode ser conectado ao fakelink, se n√£o for necess√°rio, mas n√£o acho que possa ser desativado (voc√™ ainda pode desativ√°-lo).  Pelo menos √© a impress√£o de que estou lendo a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">postagem</a> original do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">KaKaRoTo</a> . <br><br>  Voc√™ provavelmente ficar√° sobrecarregado quando vir um grande n√∫mero de par√¢metros que podem ser configurados para este bloco de origem: <br><br><pre> <code class="bash hljs">gst-inspect-1.0 uvch264src</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Lista de par√¢metros Uvch264src</b> <div class="spoiler_text">  Detalhes da f√°brica: <br>  Classifica√ß√£o nenhuma (0) <br>  Fonte UVC H264 de nome longo <br>  Fonte / v√≠deo do Klass <br>  Descri√ß√£o Fonte de c√¢mera de codifica√ß√£o UVC H264 <br>  Autor Youness Alaoui &lt;youness.alaoui@collabora.co.uk&gt; <br><br>  Detalhes do plug-in: <br>  Nome uvch264 <br>  Descri√ß√£o Plugin de c√¢meras de codifica√ß√£o H264 compat√≠vel com UVC <br>  Nome do arquivo /usr/lib/x86_64-linux-gnu/gstreamer-1.0/libgstuvch264.so <br>  Vers√£o 1.8.3 <br>  Licen√ßa LGPL <br>  M√≥dulo de origem gst-plugins-bad <br>  Data de lan√ßamento da fonte 19/08/2016 <br>  Pacote bin√°rio GStreamer Bad Plugins (Ubuntu) <br>  URL de origem <a href="">launchpad.net/distros/ubuntu/+source/gst-plugins-bad1.0</a> <br><br>  GObject <br>  + ---- GInitiallyUnowned <br>  + ---- GstObject <br>  + ---- GstElement <br>  + ---- GstBin <br>  + ---- GstBaseCameraSrc <br>  + ---- GstUvcH264Src <br><br>  Interfaces implementadas: <br>  Gstchildproxy <br><br>  Modelos de bloco: <br>  Modelo SRC: 'vidsrc' <br>  Disponibilidade: Sempre <br>  Recursos: <br>  video / x-raw <br>  formato: {I420, YV12, YUY2, UYVY, AYUV, RGBx, BGRx, xRGB, xBGR, RGBA, BGRA, ARGB, ABGR, RGB, BGR, Y41B, Y42B, YVYU, Y444, v210, v216, NV12, NV21, NV16 , NV61, NV24, GREY8, GREY16_BE, GREY16_LE, v308, RGB16, BGR16, RGB15, BGR15, UYVP, A420, RGB8P, YUV9, YVU9, IYU1, ARGB64, AYUV64, r210, I420_10LE, I420_10_10410 , GBR, GBR_10LE, GBR_10BE, NV12_64Z32, A420_10LE, A420_10BE, A422_10LE, A422_10BE, A444_10LE, A444_10BE} <br>  largura: [1, 2147483647] <br>  altura: [1, 2147483647] <br>  taxa de quadros: [0/1, 2147483647/1] <br>  image / jpeg <br>  largura: [1, 2147483647] <br>  altura: [1, 2147483647] <br>  taxa de quadros: [0/1, 2147483647/1] <br>  video / x-h264 <br>  largura: [1, 2147483647] <br>  altura: [1, 2147483647] <br>  taxa de quadros: [0/1, 2147483647/1] <br>  formato de fluxo: {byte-stream, avc} <br>  alinhamento: au <br>  perfil: {alto, principal, linha de base, linha de base restrita} <br><br>  Modelo SRC: 'imgsrc' <br>  Disponibilidade: Sempre <br>  Recursos: <br>  VAZIO <br><br>  Modelo SRC: 'vfsrc' <br>  Disponibilidade: Sempre <br>  Recursos: <br>  video / x-raw <br>  formato: {I420, YV12, YUY2, UYVY, AYUV, RGBx, BGRx, xRGB, xBGR, RGBA, BGRA, ARGB, ABGR, RGB, BGR, Y41B, Y42B, YVYU, Y444, v210, v216, NV12, NV21, NV16 , NV61, NV24, GREY8, GREY16_BE, GREY16_LE, v308, RGB16, BGR16, RGB15, BGR15, UYVP, A420, RGB8P, YUV9, YVU9, IYU1, ARGB64, AYUV64, r210, I420_10LE, I420_10_10410 , GBR, GBR_10LE, GBR_10BE, NV12_64Z32, A420_10LE, A420_10BE, A422_10LE, A422_10BE, A444_10LE, A444_10BE} <br>  largura: [1, 2147483647] <br>  altura: [1, 2147483647] <br>  taxa de quadros: [0/1, 2147483647/1] <br>  image / jpeg <br>  largura: [1, 2147483647] <br>  altura: [1, 2147483647] <br>  taxa de quadros: [0/1, 2147483647/1] <br><br>  Sinalizadores de elemento: <br>  nenhum conjunto de sinalizadores <br><br>  Sinalizadores de lixeira: <br>  nenhum conjunto de sinalizadores <br><br>  Implementa√ß√£o do elemento: <br>  Possui a fun√ß√£o change_state (): 0x7ff438f22ba0 <br><br>  O elemento n√£o possui recursos de rel√≥gio. <br>  O elemento n√£o possui recursos de manipula√ß√£o de URI. <br><br>  Almofadas: <br>  Src: 'vfsrc' <br>  Src: 'imgsrc' <br>  SRC: 'vidsrc' <br><br>  Propriedades do elemento: <br>  nome: o nome do objeto <br>  sinalizadores: ler, escrever <br>  String  Padr√£o: "uvch264src0" <br>  pai: o pai do objeto <br>  sinalizadores: ler, escrever <br>  Objeto do tipo "GstObject" <br>  manipula√ß√£o ass√≠ncrona: a lixeira manipular√° altera√ß√µes de estado ass√≠ncronas <br>  sinalizadores: ler, escrever <br>  Booleano.  Padr√£o: false <br>  encaminhamento de mensagem: Encaminha todas as mensagens filhas <br>  sinalizadores: ler, escrever <br>  Booleano.  Padr√£o: false <br>  mode: O modo de captura (captura de imagem fixa ou grava√ß√£o de v√≠deo) <br>  sinalizadores: ler, escrever <br>  Enum "GstCameraBin2Mode" Padr√£o: 2, "mode-video" <br>  (1): modo-imagem - Captura de imagem fixa (padr√£o) <br>  (2): mode-video - grava√ß√£o de v√≠deo <br>  zoom: fator de zoom digital (por exemplo, 1,5 significa 1,5x) <br>  sinalizadores: ler, escrever <br>  Flutuar.  Intervalo: 1 - 3.402823e + 38 Padr√£o: 1 <br>  zoom m√°ximo: fator de zoom digital (por exemplo, 1,5 significa 1,5x) <br>  flags: leg√≠vel <br>  Flutuar.  Intervalo: 1 - 3.402823e + 38 Padr√£o: 10 <br>  Pronto para captura: informa que este elemento est√° pronto para iniciar outra captura <br>  flags: leg√≠vel <br>  Booleano.  Padr√£o: true <br>  p√≥s-pr√©-visualiza√ß√µes: se as imagens de pr√©-visualiza√ß√£o de captura devem ser postadas no barramento <br>  sinalizadores: ler, escrever <br>  Booleano.  Padr√£o: true <br>  preview-caps: os limites da imagem de visualiza√ß√£o a ser publicada (NULL significa QUALQUER) <br>  sinalizadores: ler, escrever <br>  QUALQUER <br><br>  filtro de visualiza√ß√£o: um filtro de visualiza√ß√£o personalizado para processar os dados da imagem de visualiza√ß√£o <br>  sinalizadores: ler, escrever <br>  Objeto do tipo "GstElement" <br>  auto-start: inicia automaticamente a captura ao ir para o estado PAUSED <br>  sinalizadores: ler, escrever <br>  Booleano.  Padr√£o: false <br>  colorspace-name: o nome do elemento colorspace <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  String  Padr√£o: "videoconvert" <br>  jpeg-decoder-name: o nome do elemento decodificador jpeg <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  String  Padr√£o: "jpegdec" <br>  num-clock-samples: n√∫mero de amostras de rel√≥gio a serem coletadas para a sincroniza√ß√£o do PTS (-1 = ilimitado) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro  Intervalo: 0 - 2147483647 Padr√£o: 0 <br>  buffers num: n√∫mero de buffers a serem enviados antes do envio do EOS (-1 = ilimitado) <br>  sinalizadores: ler, escrever <br>  Inteiro  Intervalo: -1 - 2147483647 Padr√£o: -1 <br>  device: localiza√ß√£o do dispositivo <br>  sinalizadores: ler, escrever <br>  String  Padr√£o: "/ dev / video0" <br>  nome do dispositivo: nome do dispositivo <br>  flags: leg√≠vel <br>  String  Padr√£o: "" <br>  bitrate inicial: Taxa de bits inicial em bits / segundo (controle est√°tico) <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  Inteiro n√£o assinado.  Intervalo: 0 - 4294967295 Padr√£o: 3.000.000 <br>  unidades de fatia: unidades de fatia (controle est√°tico) <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  Inteiro n√£o assinado.  Intervalo: 0 - 65535 Padr√£o: 4 <br>  modo de fatia: define a unidade da propriedade de unidades de fatia (controle est√°tico) <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  Enumera√ß√£o "UvcH264SliceMode" Padr√£o: 3, "fatia / quadro" <br>  (0): ignorado - ignorado <br>  (1): bits / fatia - bits por fatia <br>  (2): MBs / fatia - MBs por fatia <br>  (3): fatia / quadro - Fatia por quadro <br>  iframe-period: tempo entre os quadros IDR em milissegundos (controle est√°tico) <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  Inteiro n√£o assinado.  Intervalo: 0 - 65535 Padr√£o: 10000 <br>  tipo de uso: o tipo de uso (controle est√°tico) <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  Enumera√ß√£o "UvcH264UsageType" Padr√£o: 1, "tempo real" <br>  (1): tempo real - Tempo real (videoconfer√™ncia) <br>  (2): broadcast - Transmiss√£o <br>  (3): armazenamento - armazenamento <br>  (4): ucconfig0 - UCConfig 0 <br>  (5): ucconfig1 - UCConfig 1 <br>  (6): ucconfig2q - UCConfig 2Q <br>  (7): ucconfig2s - UCConfig 2S <br>  (8): ucconfig3 - UCConfig 3 <br>  entropia: Entropia (controle est√°tico) <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  Enumera√ß√£o "UvcH264Entropy" Padr√£o: 0, "cavlc" <br>  (0): cavlc - CAVLC <br>  (1): cabac - CABAC <br>  enable-sei: Ativa o tempo da imagem SEI (controle est√°tico) <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  Booleano.  Padr√£o: false <br>  num-reorder-frames: N√∫mero de quadros B entre os quadros de refer√™ncia (controle est√°tico) <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  Inteiro n√£o assinado.  Intervalo: 0 - 255 Padr√£o: 0 <br>  visualiza√ß√£o invertida: imagem invertida horizontal para fluxos n√£o H.264 (controle est√°tico) <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  Booleano.  Padr√£o: false <br>  tamanho do balde com vazamento: tamanho do tamanho do balde com vazamento em milissegundos (controle est√°tico) <br>  flags: ler, escrever, s√≥ pode ser NULL ou READY <br>  Inteiro n√£o assinado.  Intervalo: 0 - 65535 Padr√£o: 1000 <br>  controle de taxa: modo de controle de taxa (controle est√°tico e din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Enumera√ß√£o "UvcH264RateControl" Padr√£o: 1, "cbr" <br>  (1): cbr - Taxa de bits constante <br>  (2): vbr - Taxa de bits vari√°vel <br>  (3): qp - QP constante <br>  framerate fixo: Taxa de quadros fixa (controle est√°tico e din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Booleano.  Padr√£o: false <br>  max-mbps: o n√∫mero de macroblocos por segundo para a taxa m√°xima de processamento <br>  flags: leg√≠vel <br>  Inteiro n√£o assinado.  Intervalo: 0 - 4294967295 Padr√£o: 0 <br>  level-idc: IDC de n√≠vel (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro n√£o assinado.  Intervalo: 0 - 255 Padr√£o: 40 <br>  pico de taxa de bits: o pico de taxa de bits em bits / segundo (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro n√£o assinado.  Intervalo: 0 - 4294967295 Padr√£o: 3.000.000 <br>  bitrate m√©dio: o bitrate m√©dio em bits / segundo (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro n√£o assinado.  Intervalo: 0 - 4294967295 Padr√£o: 3.000.000 <br>  min-iframe-qp: o tamanho m√≠nimo da etapa de quantiza√ß√£o para quadros I (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro  Intervalo: -127 - 127 Padr√£o: 10 <br>  max-iframe-qp: o tamanho m√≠nimo da etapa de quantiza√ß√£o para quadros I (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro  Intervalo: -127 - 127 Padr√£o: 46 <br>  min-pframe-qp: o tamanho m√≠nimo da etapa de quantiza√ß√£o para quadros P (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro  Intervalo: -127 - 127 Padr√£o: 10 <br>  max-pframe-qp: o tamanho m√≠nimo da etapa de quantiza√ß√£o para quadros P (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro  Intervalo: -127 - 127 Padr√£o: 46 <br>  min-bframe-qp: o tamanho m√≠nimo da etapa de quantiza√ß√£o para quadros B (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro  Intervalo: -127 - 127 Padr√£o: 10 <br>  max-bframe-qp: o tamanho m√≠nimo da etapa de quantiza√ß√£o para quadros B (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro  Intervalo: -127 - 127 Padr√£o: 46 <br>  ltr-buffer-size: n√∫mero total de quadros de refer√™ncia de longo prazo (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro  Intervalo: 0 - 255 Padr√£o: 0 <br>  ltr-encoder-control: n√∫mero de quadros LTR que o dispositivo pode controlar (controle din√¢mico) <br>  sinalizadores: ler, escrever, pode ser NULL, PRONTO, PAUSADO ou REPRODUZIDO <br>  Inteiro  Intervalo: 0 - 255 Padr√£o: 0 <br><br>  A√ß√µes do elemento: <br>  "Get-enum-setting": gboolean user_function (GstElement * objeto, <br>  gchararray arg0, <br>  gpointer arg1, <br>  gpointer arg2); <br>  "Get-boolean-setting": gboolean user_function (GstElement * objeto, <br>  gchararray arg0, <br>  gpointer arg1, <br>  gpointer arg2); <br>  "Get-int-setting": gboolean user_function (GstElement * objeto, <br>  gchararray arg0, <br>  gpointer arg1, <br>  gpointer arg2, <br>  gpointer arg3); <br>  "Start-capture": void user_function (objeto GstElement *); <br>  "Stop-capture": void user_function (objeto GstElement *); <br></div></div><br>  Muitos desses par√¢metros podem ser usados ‚Äã‚Äãpara configurar par√¢metros na compacta√ß√£o H.264.  Acho isso surpreendente, uma vez que a compress√£o √© realizada pelo chip dentro da c√¢mera.  O exemplo a seguir aumenta a taxa de dados padr√£o de 3 para 5 Mbps e reduz o intervalo do quadro-chave padr√£o de 10 para 3 segundos: <br><br><pre> <code class="bash hljs">gst-launch-1.0 -v -e uvch264src initial-bitrate=5000000 average-bitrate=5000000 iframe-period=3000 device=/dev/video0 name=src auto-start=<span class="hljs-literal"><span class="hljs-literal">true</span></span> src.vfsrc ! queue ! video/x-raw,format=YUY2,width=320,height=240,framerate=10/1 ! xvimagesink sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span> src.vidsrc ! queue ! video/x-h264,width=1280,height=720,framerate=30/1 ! h264parse ! avdec_h264 ! xvimagesink sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  Por outro lado, n√£o h√° par√¢metros para ajustar os par√¢metros usuais da webcam, como contraste, brilho, foco, etc. Portanto, para configur√°-los, ainda precisamos de ferramentas externas, como v4l2.ctl, ou a op√ß√£o mencionada em pr√≥xima se√ß√£o. <br><br><h4>  v4l2src </h4><br>  Parece que tamb√©m podemos usar o bom e velho v4l2src para capturar fluxos codificados em H.264 do Logitech C920: <br><br><pre> <code class="bash hljs">gst-launch-1.0 -v -e v4l2src device=/dev/video1 ! queue ! video/x-h264,width=1280,height=720,framerate=30/1 ! h264parse ! avdec_h264 ! xvimagesink sync=<span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre> <br>  Isto √© provavelmente devido √† evolu√ß√£o do gstreamer e do V4L2.  Essa op√ß√£o parece mais simples se voc√™ n√£o precisar alterar as configura√ß√µes de compacta√ß√£o H.264, e isso nos d√° acesso √†s configura√ß√µes da c√¢mera, como brilho e contraste.  Ele tamb√©m tem a vantagem de estar em um bom pacote de plugins que pode ser melhor guardado no futuro. <br><br><h4>  Webcasting via Gstreamer </h4><br>  No computador receptor, inicie o receptor: <br><br><pre> <code class="bash hljs">gst-launch-1.0 -v udpsrc port=6666 ! application/x-rtp, encoding-name=H264 ! rtph264depay ! h264parse ! avdec_h264 ! videoconvert ! autovideosink</code> </pre> <br>  Em um dispositivo com uma c√¢mera, iniciamos a transmiss√£o de v√≠deo codificado por hardware: <br><br><pre> <code class="bash hljs">gst-launch-1.0 uvch264src name=src auto-start=<span class="hljs-literal"><span class="hljs-literal">true</span></span> src.vidsrc ! video/x-h264,width=160,height=120,framerate=30/1 ! h264parse ! rtph264pay ! udpsink host=192.168.1.196 port=6666</code> </pre> <br>  Agradecimentos especiais a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Amomum</a> por me ajudar a escrever este c√≥digo. <br><br><h4>  Resumo do atraso na transmiss√£o de v√≠deo atrav√©s do Gstreamer </h4><br>  Mesmo com uma resolu√ß√£o de 1920 * 1080, a carga do processador no Beaglebone Blue n√£o excedeu 30% e o atraso do v√≠deo n√£o foi superior a 0,3 segundos.  Sim, como o v√≠deo nesta vers√£o foi transmitido via udp, quando os pacotes s√£o perdidos, a imagem desmorona para o pr√≥ximo quadro-chave, mas podemos configur√°-lo para que os quadros-chave sejam enviados com mais frequ√™ncia. <br><br><h3>  Tarefas ROS </h3><br>  Agora resta apenas enviar o v√≠deo recebido para o ROS, se algu√©m puder ajudar com isso, escreva em um arquivo pessoal. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt415567/">https://habr.com/ru/post/pt415567/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt415557/index.html">Rede neural do codec 2 + = podcast inteiro em um disquete</a></li>
<li><a href="../pt415559/index.html">A hist√≥ria do desenvolvimento de call centers ou como as tecnologias mudaram o trabalho dos operadores com os clientes</a></li>
<li><a href="../pt415561/index.html">Como enviar eventos do Veeam Backup & Replication para mensageiros instant√¢neos</a></li>
<li><a href="../pt415563/index.html">O tratamento do Scrum "mec√¢nico". Parte 2. Equipe</a></li>
<li><a href="../pt415565/index.html">Por que (hoje) o retorno 444 nem sempre √© √∫til</a></li>
<li><a href="../pt415569/index.html">Como configurar o ubuntu 18.04 sendmail + DKIM + SPF + DMARC ou como eu consegui entrar no basti√£o do Gmail</a></li>
<li><a href="../pt415571/index.html">kaggle: Identifica√ß√£o do modelo de c√¢mera do IEEE</a></li>
<li><a href="../pt415573/index.html">Otimiza√ß√£o de um modelo para impress√£o 3D usando o software Blender como exemplo</a></li>
<li><a href="../pt415575/index.html">Fun√ß√µes para documentar bancos de dados PostgreSQL. Parte um</a></li>
<li><a href="../pt415577/index.html">Slides do curso "DBMS Technologies and Development"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>