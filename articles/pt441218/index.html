<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∏üèª üò≤ üòæ OpenAI Gym + ROS + Gazebo: treinando um rob√¥ aut√¥nomo em casa. Parte 1 üë©üèæ‚Äçüè´ üë®üèº‚Äçüíº üë©üèΩ‚Äçü§ù‚Äçüë©üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nos √∫ltimos anos, testemunhamos a introdu√ß√£o de tecnologias de intelig√™ncia artificial em nossas vidas di√°rias - de aspiradores de p√≥ rob√≥ticos a dron...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OpenAI Gym + ROS + Gazebo: treinando um rob√¥ aut√¥nomo em casa. Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/441218/">  Nos √∫ltimos anos, testemunhamos a introdu√ß√£o de tecnologias de intelig√™ncia artificial em nossas vidas di√°rias - de aspiradores de p√≥ rob√≥ticos a drones n√£o tripulados.  Todos eles, controlados pela intelig√™ncia artificial, j√° s√£o comuns para n√≥s.  Mas, apesar disso, o processo de desenvolvimento, do design √† implementa√ß√£o, leva anos e n√£o √© barato.  Al√©m disso, os algoritmos de aprendizado de m√°quina exigem big data e n√£o h√° garantia de que tudo funcione a longo prazo. <br><br>  Mais cedo ou mais tarde, todo desenvolvedor chega √† conclus√£o de que, antes de criar um rob√¥ real, √© necess√°rio testar o conceito em uma simula√ß√£o, depurar todos os sistemas e, no final, entender se o caminho de desenvolvimento foi escolhido. <br><br>  O Dr. Andrew Howard tamb√©m teve pensamentos semelhantes quando, com sua aluna Nathon Koenig, iniciou em 2002 o desenvolvimento do simulador 3D Gazebo na Universidade do Sul da Calif√≥rnia.  O conceito de um simulador de alta precis√£o surgiu devido √† necessidade de testar rob√¥s em v√°rias condi√ß√µes externas dif√≠ceis.  Nos primeiros est√°gios de desenvolvimento, essa abordagem economiza tempo e dinheiro na compra do equipamento necess√°rio. <br><br>  Nesta s√©rie de artigos, gostaria de compartilhar minha experi√™ncia em simular e treinar um ve√≠culo n√£o tripulado com apenas uma c√¢mera comum como sensor. <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/w6/mr/no/w6mrnofkyjq2p79saxfdw8xns7u.png"><br><br>  Ol√° pessoal.  Sou mestre em Ci√™ncia da Computa√ß√£o na Universidade de Ci√™ncias Aplicadas de Berlim (HTW-Berlim). <br><br>  Como parte do meu curso, trabalho em m√©todos para treinar rob√¥s aut√¥nomos em um ambiente simulado usando ROS [1], Gazebo [2] e OpenAI Gym [3].  Este trabalho do curso est√° dividido em duas partes. <br><br>  A primeira parte √© dedicada ao desenvolvimento de uma estrutura que simplificaria o teste dos algoritmos de Aprendizado por Refor√ßo (treinamento com refor√ßo) em v√°rios rob√¥s aut√¥nomos dentro da simula√ß√£o do Gazebo. <br><br>  Na segunda parte, vou me concentrar na implementa√ß√£o do algoritmo para dire√ß√£o aut√¥noma.  Vou trabalhar nisso no pr√≥ximo semestre, portanto, este e os pr√≥ximos artigos se concentrar√£o principalmente na implementa√ß√£o do ambiente OpenAI Gym para o Gazebo.  A aprendizagem por refor√ßo (PR) ser√° afetada superficialmente. <br><br>  O c√≥digo completo do projeto pode ser encontrado <a href="">aqui</a> . <br><br><h3>  Requisitos de sistema </h3><br><ul><li>  Ubuntu 18.04 ou Windows WSL Ubuntu 18.04 </li><li>  Python 2.7 </li><li>  pip </li><li>  CPU ou GPU Tenserflow </li></ul><br>  Usaremos a vers√£o ROS do Melodic.  Esta vers√£o possui v√°rias limita√ß√µes e a mais significativa delas √© o Ubuntu 18 (tamb√©m √© poss√≠vel instalar o ROS no Windows WSL e no Ubuntu Headless, mas mais nessa outra hora).  Al√©m disso, o ROS ainda n√£o suporta Python 3. <br><br><h3>  Parte Um: Introdu√ß√£o </h3><br>  Nesta parte piloto, falarei brevemente sobre as tecnologias que ser√£o usadas para criar o ambiente.  Tamb√©m descreverei o processo de instala√ß√£o e, no final, lan√ßaremos uma simula√ß√£o completa, que pode ser controlada pela API do Gym. <br><br><h4>  ROS: "n√£o reinvente a roda" </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Robot Operating System (ROS)</a> √© uma estrutura para programa√ß√£o de rob√¥s.  ROS √© uma "cola de software" que permite que os desenvolvedores se concentrem em suas tarefas espec√≠ficas.  Embora o ROS n√£o seja um sistema operacional, ele fornece servi√ßos como abstra√ß√£o de hardware, gerenciamento de dispositivos de baixo n√≠vel, implementa√ß√£o de fun√ß√µes comumente usadas, passagem de mensagens entre processos e gerenciamento de pacotes (plug-ins). <br><br>  O ROS foi projetado como um sistema fracamente acoplado no qual um processo chamado n√≥ deve ser respons√°vel por uma tarefa.  Os n√≥s se comunicam usando mensagens que passam por canais l√≥gicos chamados t√≥picos.  Cada n√≥ pode enviar ou receber dados de outro n√≥ usando o padr√£o de publica√ß√£o - assinatura <br><br>  Para o ROS, j√° foram implementados drivers que permitem trabalhar de maneira √∫nica com muitos dispositivos, como controladores, GPS, c√¢meras, tel√©metros a laser, etc. <br><br>  E assim, instale o ROS Melodic ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">instru√ß√µes completas</a> ) <br><br><pre><code class="bash hljs">sudo sh -c <span class="hljs-string"><span class="hljs-string">'echo "deb http://packages.ros.org/ros/ubuntu $(lsb_release -sc) main" &gt; /etc/apt/sources.list.d/ros-latest.list'</span></span> sudo apt-key adv --keyserver hkp://ha.pool.sks-keyservers.net:80 --recv-key 421C365BD9FF1F717815A3895523BAEEB01FA116 sudo apt update sudo apt install ros-melodic-desktop-full sudo rosdep init rosdep update <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"source /opt/ros/melodic/setup.bash"</span></span> &gt;&gt; ~/.bashrc <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> /opt/ros/melodic/setup.bash</code> </pre> <br>  Por alguma raz√£o, o pacote de instala√ß√£o completo n√£o inclui alguns pacotes necess√°rios.  Instale-os separadamente: <br><br><pre> <code class="bash hljs">sudo apt install ros-melodic-ackermann-msgs sudo apt install ros-melodic-effort-controllers sudo apt install ros-melodic-joy sudo apt install ros-melodic-tf2-sensor-msgs</code> </pre> <br>  N√£o vamos nos deter neles em detalhes.  Eles s√£o necess√°rios para controlar nosso rob√¥, que ser√° discutido mais adiante. <br><br><h4>  Gazebo </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O Gazebo</a> √© um simulador 3D din√¢mico de c√≥digo aberto desenvolvido pela <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Open Source Robotic Foundation</a> e interage bastante com o ROS.  O Gazebo permite simular com precis√£o e efici√™ncia os rob√¥s em condi√ß√µes internas e externas dif√≠ceis. <br><br>  O simulador consiste no servidor <i>gzserver</i> , envolvido no c√°lculo da f√≠sica, colis√µes e simula√ß√£o de sensores.  Os clientes podem se conectar ao servidor, por exemplo, <i>gzclient</i> (para a √°rea de trabalho) e <i>gzweb</i> (para o navegador).  Eles s√£o os que renderizam os modelos. <br><br>  Tudo isso torna poss√≠vel testar sistemas rob√≥ticos complexos no espa√ßo virtual muito mais rapidamente e sem risco de danificar rob√¥s reais caros. <br><br>  O Gazebo est√° inclu√≠do no pacote de instala√ß√£o completo do ROS, portanto voc√™ n√£o precisa instalar mais nada.  Para configura√ß√£o sem cabe√ßa, √© necess√°rio o <i>gzweb</i> .  Vou falar sobre ele nas seguintes partes. <br><br><h4>  OpenAI Gym </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A OpenAI</a> √© uma empresa de pesquisa em intelig√™ncia artificial sem fins lucrativos, fundada por Ilon Max. <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O OpenAI Gym</a> √© uma biblioteca Python que fornece uma API para desenvolver e comparar algoritmos de RL com um grande n√∫mero de ambientes virtuais e uma API comum.  A academia j√° possui muitos ambientes prontos, inclusive para os jogos da Atari. <br><br><h4>  openai_ros </h4><br>  Meu projeto √© baseado no pacote <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">openai_ros</a> .  Este pacote implementa a arquitetura proposta pela equipe do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Construct</a> .  Os caras do Construct desenvolveram uma estrutura comum que implementa a API necess√°ria para gerenciar a simula√ß√£o e descreve uma API para integrar o Gazebo ao Gym, exigindo uma implementa√ß√£o m√≠nima.  A estrutura proposta consiste em tr√™s camadas l√≥gicas (voc√™ pode realmente usar qualquer n√∫mero), a menor delas √© outra "cola" que conecta a API do Gym ao Gazebo.  Mais sobre isso na pr√≥xima parte, quando analisaremos o c√≥digo. <br><br><h3>  Juntando tudo </h3><br>  Primeiro, precisamos criar um diret√≥rio de trabalho para o catkin.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">catkin</a> √© um sistema de automa√ß√£o de constru√ß√£o como o CMake, que √© inclu√≠do por padr√£o no pacote de instala√ß√£o do ROS: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~ mkdir catkin_ws <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> catkin_ws/ mkdir src <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> src/</code> </pre> <br>  e clone os pacotes ROS necess√°rios. <br><br><h4>  Mit racecar </h4><br>  Precisamos de um modelo de rob√¥ desenvolvido pelo MIT com todos os sensores. <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/mit-racecar/racecar.git git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/mit-racecar/racecar-simulator.git</code> </pre> <br><h4>  openai_ros </h4><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://bitbucket.org/theconstructcore/openai_ros.git</code> </pre> <br><h4>  neuroracer </h4><br>  Bem, na verdade, o pr√≥prio projeto <br><br><pre> <code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/karray/neuroracer.git</code> </pre> <br>  Em seguida, voc√™ precisa compilar todos esses pacotes <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/catkin_ws catkin_make</code> </pre> <br>  Voc√™ tamb√©m precisa instalar todas as bibliotecas python necess√°rias. <br><br><pre> <code class="bash hljs">pip install -U numpy tensorflow gym keras</code> </pre> <br><h3>  Simula√ß√£o em execu√ß√£o </h3><br>  Para executar qualquer pacote ROS, primeiro precisamos carregar na sess√£o atual do terminal todos os pacotes ROS que compilamos: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ~/catkin_ws/devel/setup.bash</code> </pre> <br>  Agora podemos executar a simula√ß√£o do rob√¥ Racecar: <br><br><pre> <code class="bash hljs">roslaunch racecar_gazebo racecar_tunnel.launch</code> </pre> <br>  Este comando iniciar√° o servidor mestre do ROS, o servidor Gazebo, juntamente com sua interface do usu√°rio (na √°rea de trabalho), carregar√° o rob√¥ e o mundo para ele. <br><br>  Captura de tela: <br><br><div class="spoiler">  <b class="spoiler_title">T√≠tulo de spoiler</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/ii/4m/70/ii4m70_-eybulu76xoi_d2_qmq8.png"><br></div></div><br>  E a mesma coisa no segundo terminal do nosso algoritmo RL: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ~/catkin_ws/devel/setup.bash roslaunch neuroracer_gym_rl qlearning.launch</code> </pre> <br>  Essa equipe lan√ßar√° nosso pacote <i>neuroracer_gym_rl</i> , que implementa um algoritmo simples de Q-Learning em nosso ambiente de academia.  Vamos analis√°-lo na pr√≥xima parte. <br><br>  Quem n√£o pode esperar pode encontrar o c√≥digo fonte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Olhando para o futuro, direi que, ap√≥s v√°rios dias de treinamento em um servidor com uma placa de GeForce GTX 1080 Ti de 11 GB de RAM, esse algoritmo simples realmente n√£o aprendeu nada.  Na pr√≥xima parte, listarei os poss√≠veis motivos, mas agora voc√™ pode experimentar sua implementa√ß√£o. <br><br><h3>  Conclus√£o </h3><br>  E assim, temos uma simula√ß√£o totalmente funcional de um carro aut√¥nomo e um modelo de algoritmo RL pronto.  Na pr√≥xima parte, analisaremos o openai_ros com mais detalhes e discutiremos os sensores instalados no rob√¥.Depois disso, mostrarei como implementar meus algoritmos e quais problemas podem surgir durante o treinamento. <br><br>  PS: Esta √© minha primeira experi√™ncia escrevendo um artigo.  Portanto, n√£o hesite em escrever se encontrar erros ou se tiver id√©ias ou cr√≠ticas construtivas.  Vou tentar levar isso em considera√ß√£o nas seguintes partes. <br><br><h3>  Refer√™ncias </h3><br>  [1] (M. Quigley, K. Conley, B. Gerkey, J. Faust, T. Foote, J. Leibs, R. Wheeler e AY Ng. Ros: um sistema operacional de rob√¥ de c√≥digo aberto. No workshop da ICRA sobre software de c√≥digo aberto, volume 3, p√°gina 5. Kobe, Jap√£o, 2009. <br><br>  [2] NP Koenig e A. Howard.  Projete e use paradigmas para o gazebo, um simulador de v√°rios rob√¥s de c√≥digo aberto.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">No IROS, volume 4, p√°ginas 2149-2154</a> .  Citeseer, 2004. <br><br>  [3] LPJSJSJTWZ, Greg Brockman, Vicki Cheung.  Openai gym, 2016, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=http://https/%2520">arXiv: 1606.01540</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt441218/">https://habr.com/ru/post/pt441218/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt441208/index.html">Como reduzimos a emiss√£o de empr√©stimos para 2 cliques</a></li>
<li><a href="../pt441210/index.html">Marca-passo de armazenamento em cluster + DRBD (prim√°rio duplo) + samba</a></li>
<li><a href="../pt441212/index.html">Trabalhar com prote√ß√£o de informa√ß√µes criptogr√°ficas e portadores de chaves de hardware no Linux</a></li>
<li><a href="../pt441214/index.html">Guia do Usu√°rio Kibana. Visualiza√ß√£o. Parte 1</a></li>
<li><a href="../pt441216/index.html">Espelho preto ou an√∫ncio Picooc?</a></li>
<li><a href="../pt441220/index.html">An√°lise de recentes ataques em massa com captura de DNS</a></li>
<li><a href="../pt441222/index.html">Por que o Kubernetes √© t√£o complicado com reposit√≥rios?</a></li>
<li><a href="../pt441224/index.html">Crie um exemplo do ARCore de faces aumentadas no Unity</a></li>
<li><a href="../pt441226/index.html">A Forbes publicou uma lista das empresas russas de Internet mais caras em 2019</a></li>
<li><a href="../pt441234/index.html">Efeitos de filtragem SVG. Parte 6. Criando texturas com feTurbulence</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>