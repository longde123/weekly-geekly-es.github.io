<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõÄüèª üëáüèº ‚ô¶Ô∏è Schnelleres Reagieren mit staatlichem Co-Hosting ‚ò£Ô∏è üîò üéå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In dem Artikel geht es um die Colokation von Bundesstaaten, dh um die Colokation von Bundesstaaten . Dieser Begriff k√∂nnte auch als Colokation von Bun...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Schnelleres Reagieren mit staatlichem Co-Hosting</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485032/"><p>  <em>In dem Artikel geht es um <strong>die Colokation</strong> von <strong>Bundesstaaten, dh</strong> um die <strong>Colokation von Bundesstaaten</strong> . Dieser Begriff k√∂nnte auch als <strong>Colokation von Bundesstaaten</strong> oder <strong>Colokation</strong> <strong>von Bundesstaaten</strong> √ºbersetzt werden.</em> </p><br><p>  Einer der Hauptgr√ºnde f√ºr die Verlangsamung einer React-Anwendung ist ihr globaler Status.  Ich werde dies anhand eines Beispiels einer sehr einfachen Anwendung zeigen, wonach ich ein Beispiel geben werde, das dem wirklichen Leben n√§her kommt. </p><br><p>  Hier ist eine einfache Anwendung, in der Sie einen Namen f√ºr den Hund eingeben k√∂nnen (wenn das Fenster nicht funktioniert, ist <a href="https://uy9h3.csb.app/">hier der Link</a> ): </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p> Wenn Sie mit dieser Anwendung spielen, werden Sie bald feststellen, dass sie sehr langsam funktioniert.  Bei der Interaktion mit einem Eingabefeld treten merkliche Leistungsprobleme auf.  In einer solchen Situation k√∂nnen Sie einen Rettungsring in Form von <code>React.memo</code> und ihn mit allen Komponenten mit einem langsamen Rendering umwickeln.  Aber lassen Sie uns versuchen, dieses Problem anders zu l√∂sen. </p><br><p>  Hier ist der Code f√ºr diese Anwendung: </p><a name="habracut"></a><br><pre> <code class="xml hljs">function sleep(time) { const done = Date.now() + time while (done &gt; Date.now()) { // ... } } //      // -       function SlowComponent({time, onChange}) { sleep(time) return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> Wow, that was{' '} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"number"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{e</span></span></span><span class="hljs-tag"> =&gt;</span></span> onChange(Number(e.target.value))} /&gt; ms slow <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) } function DogName({time, dog, onChange}) { return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">htmlFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag">&gt;</span></span>Dog Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{e</span></span></span><span class="hljs-tag"> =&gt;</span></span> onChange(e.target.value)} /&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {dog ? `${dog}'s favorite number is ${time}.` : 'enter a dog name'} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) } function App() { //   " " (global state) const [dog, setDog] = React.useState('') const [time, setTime] = React.useState(200) return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DogName</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dog</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{setDog}</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">SlowComponent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{setTime}</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) }</code> </pre> <br><p>  Wenn Sie den Artikel √ºber <a href="https://kentcdodds.com/blog/colocation">Colocation</a> ( <a href="https://kentcdodds.com/blog/colocation">Kollokation</a> ) nicht gelesen haben, empfehle ich Ihnen, ihn zu lesen.  Da wir wissen, dass Co-Hosting die Arbeit mit unserer Anwendung erleichtern kann, wenden wir dieses Prinzip bei der Arbeit mit Staaten an. </p><br><p>  Beachten Sie den Code unserer Anwendung, n√§mlich den Zeitstatus - er wird von jeder Komponente unserer Anwendung verwendet, daher wurde er auf die <code>App</code> Komponente (die Komponente, die unsere gesamte Anwendung umschlie√üt) angehoben ( <a href="https://ru.reactjs.org/docs/lifting-state-up.html">lift - raise the state</a> ).  Der Status "dog" ( <code>dog</code> und <code>setDog</code> ) wird jedoch nur von einer Komponente verwendet. Er wird in der <code>App</code> Komponente nicht ben√∂tigt. Verschieben wir ihn in die <code>DogName</code> Komponente: </p><br><pre> <code class="xml hljs">function DogName({time}) { // <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">-</span></span></span><span class="hljs-tag">    </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">const</span></span></span><span class="hljs-tag"> [</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dog</span></span></span><span class="hljs-tag">, </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">setDog</span></span></span><span class="hljs-tag">] = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">React.useState(</span></span></span><span class="hljs-tag">'') // &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">-</span></span></span><span class="hljs-tag">   </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">return</span></span></span><span class="hljs-tag"> ( &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">htmlFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag">&gt;</span></span>Dog Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{e</span></span></span><span class="hljs-tag"> =&gt;</span></span> setDog(e.target.value)} /&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {dog ? `${dog}'s favorite number is ${time}.` : 'enter a dog name'} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) } function App() { //   " " (global state) const [time, setTime] = React.useState(200) return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DogName</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> /&gt;</span></span> // <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">-</span></span></span><span class="hljs-tag">    &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">SlowComponent</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{setTime}</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) }</code> </pre> <br><p>  Und hier ist unser Ergebnis (wenn das Fenster nicht funktioniert, <a href="https://9nqld.csb.app/">verlinken Sie</a> ): </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Wow!  Das Eingeben eines Namens geht jetzt VIEL schneller.  Dar√ºber hinaus ist das Bauteil durch die gemeinsame Platzierung wartungsfreundlicher geworden.  Aber warum hat es schneller geklappt? </p><br><p>  Sie sagen, dass der beste Weg, etwas schnell zu erledigen, darin besteht, so wenig wie m√∂glich zu tun.  Genau das passiert hier.  Wenn wir den Status verwalten, der sich ganz oben im Komponentenbaum befindet, macht jede Aktualisierung dieses Status den gesamten Baum ung√ºltig.  Die Reaktion wei√ü nicht, was sich ge√§ndert hat. Aus diesem Grund muss er alle Komponenten √ºberpr√ºfen, um festzustellen, ob sie DOM-Aktualisierungen ben√∂tigen.  Dieser Prozess ist nicht kostenlos und verbraucht Ressourcen (insbesondere, wenn Sie absichtlich langsame Komponenten haben).  Wenn Sie jedoch den Status im Komponentenbaum so niedrig wie m√∂glich verschieben, wie wir es mit dem Status <code>dog</code> und der Komponente <code>DogName</code> , f√ºhrt React weniger √úberpr√ºfungen durch.  Die Komponente <code>SlowComponent</code> die wir absichtlich verlangsamt haben, wird von React nicht √ºberpr√ºft, da React wei√ü, dass diese Komponente die Ausgabe weiterhin nicht beeinflussen kann. </p><br><p>  Kurz gesagt, fr√ºher, als der Name des Hundes ge√§ndert wurde, wurde jede Komponente auf √Ñnderungen √ºberpr√ºft (neu gerendert).  Und nach den √Ñnderungen, die wir am Code vorgenommen hatten, √ºberpr√ºfte React nur die <code>DogName</code> Komponente.  Dies hat zu einer deutlichen Steigerung der Produktivit√§t gef√ºhrt! </p><br><h2 id="v-realnoy-zhizni">  Im wirklichen Leben </h2><br><p>  Ich sehe, dass Entwickler in das Redux Global Repository oder in den globalen Kontext stellen, was eigentlich nicht global sein sollte.  <code>DogName</code> wie der <code>DogName</code> aus dem obigen Beispiel sind h√§ufig Stellen, an denen ein Leistungsproblem auftritt.  Ich sehe oft, dass sich dieses Problem bei der Interaktion mit der Maus manifestiert (z. B. beim Anzeigen eines Tooltips √ºber einem Diagramm oder √ºber einer Datentabelle). </p><br><p>  Eine L√∂sung f√ºr dieses Problem besteht darin, die Benutzerinteraktion abzubrechen (das hei√üt, wir warten, bis der Benutzer aufh√∂rt zu tippen, und wenden dann die Statusaktualisierung an).  Manchmal ist dies das Beste, was wir tun k√∂nnen, aber es kann zu einer schlechten Benutzererfahrung f√ºhren (der zuk√ºnftige gleichzeitige Modus sollte die Notwendigkeit dazu minimieren. <a href="https://youtu.be/nLF0n9SACd4%3Ft%3D181">Siehe diese Demo von Dan Abramov</a> ). </p><br><p>  Eine andere von Entwicklern h√§ufig verwendete L√∂sung ist die Verwendung eines der React-Rescue-Renderings, z. B. <code>React.memo</code> .  Dies funktioniert in unserem weit hergeholten Beispiel sehr gut, da die React das erneute Rendern der <code>SlowComponent</code> √ºberspringen kann. In der Praxis kann die Anwendung jedoch unter dem ‚ÄûTod durch tausend Schnitte‚Äú leiden, da in einer realen Anwendung die Verlangsamung in der Regel nicht durch eine Verz√∂gerung verursacht wird Komponente, und aufgrund der unzureichend schnellen Arbeit vieler Komponenten, m√ºssen Sie <code>React.memo</code> √ºberall verwenden.  Wenn Sie dies getan haben, m√ºssen Sie <code>useMemo</code> und <code>useCallback</code> . Andernfalls ist die Arbeit, die Sie in <code>React.memo</code> , vergeblich.  Diese Aktionen k√∂nnen das Problem l√∂sen, erh√∂hen jedoch die Komplexit√§t Ihres Codes erheblich und sind in der Tat immer noch weniger effektiv als das Freigeben von Zust√§nden, da die Reaktion jede Komponente (von oben beginnend) durchlaufen muss, um zu bestimmen, ob sie erneut gerendert werden muss. </p><br><p>  Wenn Sie mit einem etwas weniger weit hergeholten Beispiel <a href="https://codesandbox.io/s/colocate-state-ts1x9">herumspielen m√∂chten</a> , <a href="https://codesandbox.io/s/colocate-state-ts1x9">gehen Sie hier zu codesandbox</a> . </p><br><h2 id="chto-takoe-sovmestnoe-razmeschenie-sostoyaniy">  Was ist Co-Location? </h2><br><p>  Das Prinzip der <a href="https://kentcdodds.com/blog/colocation">gemeinsamen Platzierung</a> lautet: </p><br><blockquote>  Der Code sollte sich so nahe wie m√∂glich an dem Ort befinden, auf den er sich bezieht. </blockquote><p>  Um diesem Prinzip zu entsprechen, sollte sich unser <code>DogName</code> <em>in</em> der <code>DogName</code> Komponente befinden: </p><br><pre> <code class="xml hljs">function DogName({time}) { const [dog, setDog] = React.useState('') return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">htmlFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag">&gt;</span></span>Dog Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{e</span></span></span><span class="hljs-tag"> =&gt;</span></span> setDog(e.target.value)} /&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {dog ? `${dog}'s favorite number is ${time}.` : 'enter a dog name'} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) }</code> </pre> <br><p>  Was aber, wenn wir diese Komponente in mehrere Komponenten aufteilen?  Wohin soll der Staat gehen?  Die Antwort ist dieselbe: "so nah wie m√∂glich an dem Ort, auf den sie sich bezieht", und dies wird die <strong>n√§chste gemeinsame Elternkomponente sein</strong> .  Lassen Sie uns als Beispiel die <code>DogName</code> Komponente <code>DogName</code> , <code>DogName</code> <code>input</code> und <code>p</code> in verschiedenen Komponenten angezeigt werden: </p><br><pre> <code class="xml hljs">function DogName({time}) { const [dog, setDog] = React.useState('') return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DogInput</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dog</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{setDog}</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DogFavoriteNumberDisplay</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">time</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{time}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dog</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> ) } function DogInput({dog, onChange}) { return ( <span class="hljs-tag"><span class="hljs-tag">&lt;&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">htmlFor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag">&gt;</span></span>Dog Name<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dog"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{dog}</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onChange</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">{e</span></span></span><span class="hljs-tag"> =&gt;</span></span> onChange(e.target.value)} /&gt; <span class="hljs-tag"><span class="hljs-tag">&lt;/&gt;</span></span> ) } function DogFavoriteNumberDisplay({time, dog}) { return ( <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> {dog ? `${dog}'s favorite number is ${time}.` : 'enter a dog name'} <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> ) }</code> </pre> <br><p>  Der <code>DogInput</code> kann nicht in die <code>DogInput</code> Komponente <code>DogInput</code> werden, da die <code>DogFavoriteNumberDisplay</code> Komponente auch Zugriff auf den Status ben√∂tigt. <code>DogFavoriteNumberDisplay</code> wechseln wir vom unteren zum oberen Rand des Komponentenbaums, bis wir das gemeinsame √ºbergeordnete <code>DogFavoriteNumberDisplay</code> dieser beiden Komponenten finden und die <code>DogFavoriteNumberDisplay</code> organisieren. </p><br><p>  All dies gilt f√ºr Situationen, in denen Sie den Status von Dutzenden von Komponenten auf einem bestimmten Bildschirm Ihrer Anwendung steuern m√ºssen.  Sie k√∂nnen dies sogar in den Kontext verschieben, um das <a href="https://kentcdodds.com/blog/prop-drilling">Bohren von Requisiten</a> zu vermeiden.  Halten Sie diesen Kontext jedoch so nah wie m√∂glich an dem Ort, zu dem er geh√∂rt, und behalten Sie dann weiterhin die gute Leistung (und Verwendbarkeit des Codes) bei, die die Freigabe bietet.  Denken Sie daran, dass Sie nicht <em>alle</em> Kontexte auf der obersten Ebene Ihrer React-Anwendung platzieren m√ºssen.  Bewahren Sie sie dort auf, wo es am sinnvollsten ist. </p><br><p>  Dies ist die Hauptidee meines anderen Beitrags, <a href="https://kentcdodds.com/blog/application-state-management-with-react">Application State Management with React</a> .  Halten Sie Ihre Zust√§nde so nah wie m√∂glich an dem Ort, an dem sie verwendet werden. Dies verbessert sowohl die Leistung als auch die Benutzerfreundlichkeit des Codes.  Bei diesem Ansatz kann die Leistung Ihrer Anwendung nur durch besonders komplexe Interaktionen mit Oberfl√§chenelementen beeintr√§chtigt werden. </p><br><h2 id="tak-chto-ispolzovat-konteksty-ili-redux">  Also, was zu verwenden, Kontexte oder Redux? </h2><br><p>  Wenn Sie <a href="https://kentcdodds.com/blog/optimize-react-re-renders">"Ein einfacher Trick zum Optimieren von React Re-Renderings"</a> lesen, k√∂nnen Sie sicherstellen, dass nur die Komponenten aktualisiert werden, die den ge√§nderten Status verwenden.  Auf diese Weise k√∂nnen Sie dieses Problem einfach umgehen.  Bei der Verwendung des Editors treten jedoch weiterhin Leistungsprobleme auf.  Das Problem ist, <a href="https://react-redux.js.org/using-react-redux/connect-mapstate">dass React-Redux von Ihnen erwartet, dass Sie die Empfehlungen befolgen, um ein unn√∂tiges Rendern der verbundenen Komponenten zu vermeiden</a> .  Es besteht immer die M√∂glichkeit eines Fehlers: Sie k√∂nnen Komponenten versehentlich so konfigurieren, dass sie zu oft gerendert werden, wenn sich andere globale Zust√§nde √§ndern.  Und je gr√∂√üer Ihre Anwendung ist, desto negativer ist der Effekt, insbesondere wenn Sie dem Editor zu viele Status hinzuf√ºgen. </p><br><p>  Es gibt Methoden, mit denen Sie diese Probleme vermeiden k√∂nnen. Verwenden <a href="https://blog.isquaredsoftware.com/2018/11/react-redux-history-implementation/"><code>memoized Reselect     mapState</code></a> beispielsweise <a href="https://blog.isquaredsoftware.com/2018/11/react-redux-history-implementation/"><code>memoized Reselect     mapState</code></a> , oder lesen Sie die <a href="https://redux.js.org/faq">Dokumentation</a> des <a href="https://redux.js.org/faq">Editors, um weitere Informationen zur Verbesserung der Anwendungsleistung zu erhalten</a> . </p><br><p>  Es ist erw√§hnenswert, dass die gemeinsame Platzierung zusammen mit dem Editor durchgef√ºhrt werden kann.  Verwenden Sie die Editoren nur f√ºr globale Zust√§nde und f√ºr alles andere verwenden Sie die Kollokation.  <a href="https://redux.js.org/faq/organizing-state">In den h√§ufig gestellten</a> Fragen <a href="https://redux.js.org/faq/organizing-state">des</a> Editors <a href="https://redux.js.org/faq/organizing-state">finden Sie einige n√ºtzliche Regeln</a> , anhand <a href="https://redux.js.org/faq/organizing-state">derer Sie entscheiden k√∂nnen, ob der Status im Editor funktionieren oder in der Komponente verbleiben soll</a> . </p><br><p>  √úbrigens, wenn Sie Ihren Status in Dom√§nen aufteilen (abh√§ngig von der Dom√§ne in mehreren Kontexten), ist das Problem weniger ausgepr√§gt. </p><br><p>  Die Tatsache bleibt jedoch bestehen: Die gemeinsame Suche nach Status reduziert Leistungsprobleme und vereinfacht die Codewartung. </p><br><h2 id="prinimaem-reshenie-o-tom-kuda-pomestit-sostoyanie">  Entscheide, wo der Staat platziert werden soll </h2><br><p>  Entscheidungsbaum: </p><br><p><img src="https://habrastorage.org/webt/oj/z8/pt/ojz8ptwezz3qmxqicorsrsh1bku.jpeg" alt="Wohin-zu-setzen-zustand"></p><br><p>  Textversion, falls das Bild nicht angezeigt werden kann: </p><br><ul><li>  1 Wir beginnen mit der Entwicklung der Anwendung.  Gehe zu 2 </li><li>  2 Status in der Komponente.  Gehe zu 3 </li><li>  3 Wird die Bedingung <strong>nur von</strong> dieser Komponente verwendet? <br><ul><li>  Huh?  Wir gehen zu 4 </li><li>  Nein?  <strong>Ben√∂tigt</strong> dieser Status nur <em>eine</em> untergeordnete Komponente? </li><li>  Huh?  Verschieben Sie es in diese untergeordnete Komponente (verwenden Sie die gemeinsame Position).  Wir gehen zu 3. </li><li>  Nein?  Ben√∂tigt dieser Status √ºbergeordnete oder benachbarte Komponenten ("br√ºderliche" Komponenten, dh untergeordnete Komponenten derselben √ºbergeordneten Komponente)? <br><ul><li>  Huh?  Verschieben Sie den obigen Status in die √ºbergeordnete Komponente.  Gehe zu 3 </li><li>  Nein?  Wir gehen zu 4 </li></ul></li></ul></li><li>  4 Belassen Sie es wie es ist.  Gehe zu 5 </li><li>  5 Gibt es ein Problem beim Bohren von Propellern? <br><ul><li>  Huh?  Wir verschieben diesen Status in den Kontextanbieter und rendern diesen Anbieter in der Komponente, in der der Status verwaltet wird.  Gehe zu 6 </li><li>  Nein?  Gehe zu 6 </li></ul></li><li>  6 Wir senden die Bewerbung.  Wenn neue Anforderungen angezeigt werden, fahren Sie mit Schritt 1 fort </li></ul><br><p>  Es ist wichtig, dass dieser Prozess Teil Ihres regul√§ren Prozesses zur √úberarbeitung / Wartung von Anwendungen ist.  Wenn Ihr Zustand nicht an der Stelle ausgel√∂st wird, an der er ausgel√∂st werden soll, funktioniert dieser Zustand nicht mehr ordnungsgem√§√ü und Sie werden es bemerken.  Wenn Sie jedoch nicht die Methode f√ºr die gemeinsame Position von Zust√§nden befolgen und die Zust√§nde in der Hierarchie der Komponenten nicht verringern, funktioniert Ihre Anwendung weiterhin.  Aus diesem Grund werden Sie Performance- und Verwaltbarkeitsprobleme, die sich allm√§hlich ansammeln, nicht sofort bemerken. </p><br><h2 id="zaklyuchenie">  Fazit </h2><br><p>  Im Allgemeinen verstehen Entwickler recht gut, wann es notwendig ist, den Status zu erh√∂hen ("Lifting State"), wenn dies erforderlich ist, aber wir verstehen nicht so gut, wann der Status gesenkt werden muss.  Ich schlage vor, Sie werfen einen Blick auf den Code Ihrer Bewerbung und √ºberlegen, wo der Staat durch Anwendung des Prinzips der "Kollokation" weggelassen werden k√∂nnte.  Fragen Sie sich: " <code>isOpen</code> ich den <code>isOpen</code> Status eines modalen Fensters im Editor?"  (die Antwort ist h√∂chstwahrscheinlich nein). </p><br><p>  Verwenden Sie das Prinzip der Kollokation, und Ihr Code wird einfacher und schneller. </p><br><p>  Viel gl√ºck </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de485032/">https://habr.com/ru/post/de485032/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de485022/index.html">Playme Sigma: Funktioneller und erschwinglicher DVR</a></li>
<li><a href="../de485024/index.html">Was verbirgt sich hinter den Optimierungen des GraalVM-Compilers?</a></li>
<li><a href="../de485026/index.html">Georgiens Chancen f√ºr IT-Profis</a></li>
<li><a href="../de485028/index.html">CRM 2020</a></li>
<li><a href="../de485030/index.html">Top 8 IEO Geb√ºhren und deren Aktivierung jetzt</a></li>
<li><a href="../de485034/index.html">Automatisieren der Erstellung eines Qt-Projekts unter Windows in Travis CI</a></li>
<li><a href="../de485036/index.html">Warum brauche ich instrumentelle Unterst√ºtzung f√ºr die Schl√ºsselpagination?</a></li>
<li><a href="../de485042/index.html">Aufgrund der obligatorischen 5G-Unterst√ºtzung werden Smartphones mit Snapdragon 865 im Jahr 2020 schlechter sein</a></li>
<li><a href="../de485044/index.html">Wir zerlegen die Digitaluhr vom Sojus-Raumschiff</a></li>
<li><a href="../de485046/index.html">So planen Sie eine erfolgreiche Produktstrategie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>