<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüë¶‚Äçüë¶ üåñ üë®üèº‚Äç‚öñÔ∏è OpenGL ultramoderne. Partie 1 üïó üöö üç∞</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous. Tous ceux qui connaissent un peu le sujet OpenGL savent qu'il existe un grand nombre d'articles et de cours sur ce sujet, mais beaucou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>OpenGL ultramoderne. Partie 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/456932/"><img src="https://habrastorage.org/webt/ui/wu/2k/uiwu2kjzkvznzwubjaqnk7lkoz0.jpeg"><br><br>  Bonjour √† tous.  Tous ceux qui connaissent un peu le sujet OpenGL savent qu'il existe un grand nombre d'articles et de cours sur ce sujet, mais beaucoup n'affectent pas l'API moderne, et certains d'entre eux parlent g√©n√©ralement de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glBegin</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glEnd</a> .  J'essaierai de couvrir certaines des nuances de la nouvelle API √† partir de la version 4.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lien vers la deuxi√®me partie de l'article</a> <br><a name="habracut"></a><br>  Cette fois, j'essaierai d'√©crire un article int√©ressant et informatif, et ce qui s'est pass√©, c'est aux bons habitants d'habra d'en d√©cider.  Veuillez me pardonner ma pauvre grammaire (je serai reconnaissant pour les corrections). <br><br>  Si vous l'aimez, j'√©crirai sur l'optimisation d'OpenGL et la r√©duction de DrawCalls. <br><br>  Commen√ßons! <br><br>  <font color="#008000">Ce qui sera dans cet article - la fonctionnalit√© d'OpenGL moderne</font> <br>  <font color="#FF0000">Ce qui ne sera pas dans cet article - approches modernes du rendu sur OpenGL</font> <br><br><div class="spoiler">  <b class="spoiler_title">Contenu:</b> <div class="spoiler_text"><ul><li>  Acc√®s direct √† l'√âtat </li><li>  D√©boguer </li><li>  Objets Shader s√©par√©s </li><li>  Tableaux de texture </li><li>  Vue de texture </li><li>  Tampon unique pour l'index et le sommet </li><li>  Pavage et ombrage de calcul </li><li>  Rendu de chemin </li></ul><br></div></div><br><h3>  <font color="#4682B4">DSA (Direct State Access)</font> </h3><br>  Acc√®s direct √† l'√âtat - Acc√®s direct √† l'√âtat.  Un outil pour modifier les objets OpenGL sans avoir √† les accrocher au contexte.  Cela vous permet de modifier l'√©tat d'un objet dans un contexte local sans affecter l'√©tat global partag√© par toutes les parties de l'application.  Cela rend √©galement l'API un peu plus orient√©e objet, car les fonctions qui changent l'√©tat des objets peuvent √™tre clairement d√©finies.  C'est ce que le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">wiki OpenGL</a> nous dit. <br><br>  Comme nous le savons, OpenGL est une API avec de nombreux boutons radio - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glActiveTexture</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glBindTexture</a> , etc. <br><br>  De l√†, nous avons quelques <font color="#DC143C">probl√®mes</font> : <br><br><ul><li>  Le s√©lecteur et les √©tats actuels peuvent effectuer un changement d'√©tat plus profond. </li><li>  Il peut √™tre n√©cessaire de lier / changer l'unit√© active pour d√©finir un filtre pour les textures </li><li>  La gestion des √©tats devient probl√©matique √† la suite de laquelle la complexit√© de l'application augmente </li><li>  Un √©tat inconnu conduit √† des param√®tres suppl√©mentaires </li><li>  Les tentatives de sauvegarde / restauration de l'√©tat peuvent √™tre probl√©matiques </li></ul><br>  Qu'est-ce que le groupe Khronos nous a offert et comment l'aide DSA? <br><br><ul><li>  Ajoute des fonctions qui fonctionnent directement avec l'objet / les objets </li><li>  D√©finit le filtre de texture pour l'objet de texture sp√©cifi√©, pas celui en cours. </li><li>  Lie une texture √† une unit√© sp√©cifique, pas √† l'actif </li><li>  Ajoute un tr√®s grand nombre de nouvelles fonctionnalit√©s </li><li>  Couvre les choses jusqu'√† OpenGL 1.x </li><li>  Ajoute des fonctionnalit√©s suppl√©mentaires. </li></ul><br>  En th√©orie, un DSA peut aider √† r√©duire √† z√©ro le nombre d'op√©rations de non-rendu et de changement d'√©tat ... Mais ce n'est pas exact. <br><br>  Maintenant, je vais bri√®vement passer en revue certaines des nouvelles fonctionnalit√©s, je ne m'attarderai pas sur les param√®tres en d√©tail, je laisserai des liens sur le wiki. <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glCreateTextures</a> remplace <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glGenTextures</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glBindTexture</a> (initialisation). <br>  C'√©tait: <br><pre><code class="cpp hljs">glGenTextures(<span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;name); glBindTexture(GL_TEXTURE_2D, name);</code> </pre>  C'est devenu: <br><pre> <code class="cpp hljs">glCreateTextures(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;name);</code> </pre> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glTextureParameterX</a> √©quivalent √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glTexParameterX</a> <pre> <code class="cpp hljs">glGenTextures(<span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;name); glBindTexture(GL_TEXTURE_2D, name); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_NEAREST); glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_NEAREST); glTexStorage2D(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">1</span></span>, GL_RGBA8, width, height); glTexSubImage2D(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, width, height, GL_RGBA, GL_UNSIGNED_BYTE, pixels);</code> </pre>  Maintenant, nous allons l'√©crire comme ceci: <br><pre> <code class="cpp hljs">glCreateTextures(GL_TEXTURE_2D, <span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;name); glTextureParameteri(name, GL_TEXTURE_WRAP_S, GL_CLAMP); glTextureParameteri(name, GL_TEXTURE_WRAP_T, GL_CLAMP); glTextureParameteri(name, GL_TEXTURE_MIN_FILTER, GL_NEAREST); glTextureParameteri(name, GL_TEXTURE_MAG_FILTER, GL_NEAREST); glTextureStorage2D(name, <span class="hljs-number"><span class="hljs-number">1</span></span>, GL_RGBA8, width, height); glTextureSubImage2D(name, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, width, height, GL_RGBA, GL_UNSIGNED_BYTE, pixels);</code> </pre> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glBindTextureUnit</a> remplacer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glActiveTexture</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glBindTexture</a> <br>  Voici comment nous l'avons fait: <br><pre> <code class="cpp hljs">glActiveTexture(GL_TEXTURE0 + <span class="hljs-number"><span class="hljs-number">3</span></span>); glBindTexture(GL_TEXTURE_2D, name);</code> </pre>  Maintenant: <br><pre> <code class="cpp hljs">glBindTextureUnit(<span class="hljs-number"><span class="hljs-number">3</span></span>, name);</code> </pre> </li></ul><br>  Les changements ont √©galement affect√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glTextureImage</a> , il n'est plus utilis√©, et voici pourquoi: <br><br>  glTexImage est plut√¥t dangereux, il est tr√®s facile d'obtenir des textures invalides, car la fonction ne v√©rifie pas les valeurs lorsqu'elle est appel√©e, le pilote le fait pendant le dessin.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GlTexStorage a</a> √©t√© ajout√© pour le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">remplacer</a> . <br><br>  glTexStorage fournit un moyen de cr√©er des textures avec des v√©rifications effectu√©es pendant un appel, ce qui minimise les erreurs.  Le r√©f√©rentiel de textures est r√©solu par la plupart, sinon la totalit√©, des probl√®mes caus√©s par les textures mutables, bien que les textures immuables soient plus fiables. <br><br>  Les modifications ont √©galement affect√© le tampon de trame: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glCreateFramebuffers</a> au lieu de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glGenFramebuffers</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glNamedFramebufferTexture</a> remplace <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glFramebufferTexture</a> </li></ul><br>  Ce ne sont pas toutes les fonctionnalit√©s modifi√©es.  Les lignes suivantes sont les fonctions des tampons: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glCreateBuffers</a> au lieu de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glGenBuffers</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glBindBuffer</a> (initialisation) </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glNamedBufferData</a> remplace <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glBufferData</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glVertexAttribFormat</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glBindVertexBuffer</a> au lieu de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glVertexAttribPointer</a> </li></ul><br>  Voici une liste de ce qui est d√©sormais inclus dans le support DSA: <br><br><ul><li>  Objets de tableau de sommets </li><li>  Objets Framebuffer </li><li>  Objets de programme </li><li>  Objets tampons </li><li>  Piles matricielles </li><li>  Beaucoup de choses obsol√®tes </li></ul><br><h3>  <font color="#4682B4">D√©boguer</font> </h3><br>  Depuis la version 4.3, de nouvelles fonctionnalit√©s ont √©t√© ajout√©es pour le d√©bogage, √† mon avis tr√®s utiles et pratiques.  Maintenant OpenGL appellera notre rappel pour les erreurs et les messages de d√©bogage, dont nous pouvons ajuster le niveau. <br><br><img src="https://habrastorage.org/webt/t-/m7/1n/t-m71nmkhv4-khfdlpb99wekjxq.jpeg"><br><br>  Nous devons appeler seulement deux fonctions pour activer: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glEnable</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glDebugMessageCallback</a> , nulle part plus facile. <br><br><pre> <code class="cpp hljs">glEnable(GL_DEBUG_OUTPUT); glDebugMessageCallback(message_callback, <span class="hljs-literal"><span class="hljs-literal">nullptr</span></span>);</code> </pre> <br>  Nous allons maintenant √©crire une fonction de rappel pour obtenir le message: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callback</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(GLenum source, GLenum type, GLuint id, GLenum severity, GLsizei length, GLchar </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* message, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params">* user_param)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> source_str = [source]() -&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (source) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_API: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"API"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_WINDOW_SYSTEM: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"WINDOW SYSTEM"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_SHADER_COMPILER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"SHADER COMPILER"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_THIRD_PARTY: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"THIRD PARTY"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_APPLICATION: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"APPLICATION"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SOURCE_OTHER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"OTHER"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"UNKNOWN"</span></span>; } }(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> type_str = [type]() { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (type) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_ERROR: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"ERROR"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_DEPRECATED_BEHAVIOR: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"DEPRECATED_BEHAVIOR"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_UNDEFINED_BEHAVIOR: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"UNDEFINED_BEHAVIOR"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_PORTABILITY: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"PORTABILITY"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_PERFORMANCE: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"PERFORMANCE"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_MARKER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"MARKER"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_TYPE_OTHER: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"OTHER"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"UNKNOWN"</span></span>; } }(); <span class="hljs-keyword"><span class="hljs-keyword">auto</span></span> severity_str = [severity]() { <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span> (severity) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SEVERITY_NOTIFICATION: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"NOTIFICATION"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SEVERITY_LOW: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"LOW"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SEVERITY_MEDIUM: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"MEDIUM"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> GL_DEBUG_SEVERITY_HIGH: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"HIGH"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"UNKNOWN"</span></span>; } }(); <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; source_str &lt;&lt; <span class="hljs-string"><span class="hljs-string">", "</span></span> &lt;&lt; type_str &lt;&lt; <span class="hljs-string"><span class="hljs-string">", "</span></span> &lt;&lt; severity_str &lt;&lt; <span class="hljs-string"><span class="hljs-string">", "</span></span> &lt;&lt; id &lt;&lt; <span class="hljs-string"><span class="hljs-string">": "</span></span> &lt;&lt; message &lt;&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">endl</span></span>; }</code> </pre> <br>  Nous pouvons √©galement configurer le filtre √† l'aide de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glDebugMessageControl</a> .  Le filtre peut fonctionner en mode de filtrage par source / type / importance ou un ensemble de messages en utilisant leurs identifiants. <br><br>  Filtrer les messages dans une port√©e sp√©cifique: <br><br><pre> <code class="cpp hljs">glPushDebugGroup( GL_DEBUG_SOURCE_APPLICATION, DEPTH_FILL_ID, <span class="hljs-number"><span class="hljs-number">11</span></span>, ‚ÄúDepth Fill‚Äù); <span class="hljs-comment"><span class="hljs-comment">//  Render_Depth_Only_Pass(); //  glPopDebugGroup(); // </span></span></code> </pre> <br>  Il sera tr√®s utile de d√©sactiver l'appel asynchrone afin de pouvoir d√©terminer l'ordre des appels de fonction, ainsi que de trouver la place de l'erreur sur la pile lors du d√©bogage.  Cela se fait tout simplement: <br><br><pre> <code class="cpp hljs">glEnable(GL_DEBUG_OUTPUT_SYNCHRONOUS);</code> </pre> <br>  Il convient de rappeler qu'il n'est pas s√ªr d'appeler OpenGL ou des fonctions de fen√™tre dans une fonction d'appel encapsul√©e, ainsi que les rappels ne sont pas gratuits et vous ne devez pas les laisser inclus dans la version. <br>  Plus de d√©tails sur ces petites choses et d'autres - des gadgets, vous pouvez lire <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h3>  <font color="#4682B4">SSO (objets de shader s√©par√©s)</font> </h3><br>  Une fois OpenGL fonctionnait comme un ¬´pipeline fixe¬ª - cela signifiait qu'un traitement pr√©programm√© √©tait appliqu√© √† toutes les donn√©es transf√©r√©es pour la visualisation.  L'√©tape suivante √©tait un ¬´pipeline programmable¬ª - o√π la partie programmable impl√©mente des shaders, √©crits en GLSL, le programme GLSL classique consistait en vertex et fragment shaders, mais dans OpenGL moderne de nouveaux types de shaders ont √©t√© ajout√©s, √† savoir les shaders de g√©om√©trie, de pond√©ration et de calculs (√† leur sujet, je Je le dirai dans la partie suivante). <br><br><img src="https://habrastorage.org/webt/lg/or/rg/lgorrggfshrf8xdb6vbwu4fw-so.jpeg"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Les SSO</a> nous permettent de modifier les √©tapes du shader √† la vol√©e sans les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">reconnecter</a> .  La cr√©ation et la configuration d'un pipeline logiciel simple sans d√©bogage sont les suivantes: <br><br><pre> <code class="cpp hljs">GLuint pipe = GL_NONE; <span class="hljs-comment"><span class="hljs-comment">// Create shaders GLuint fprog = glCreateShaderProgramv( GL_FRAGMENT_SHADER, 1, &amp;text); GLuint vprog = glCreateShaderProgramv( GL_VERTEX_SHADER, 1, &amp;text); // Bind pipeline glGenProgramPipelines( 1, &amp;pipe); glBindProgramPipelines( pipe); // Bind shaders glUseProgramStages( pipe, GL_FRAGMENT_SHADER_BIT, fprog); glUseProgramStages( pipe, GL_VERTEX_SHADER_BIT, vprog);</span></span></code> </pre> <br>  Comme nous le voyons, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glCreateProgramPipelines</a> g√©n√®re un descripteur et initialise l'objet, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glCreateShaderProgramv</a> g√©n√®re, initialise, compile et lie le programme de shader en utilisant les sources sp√©cifi√©es, et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glUseProgramStages</a> attache les √©tapes du programme √† l'objet pipeline.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">glBindProgramPipeline</a> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Associe un</a> pipeline √† un contexte. <br><br>  Mais il y a une mise en garde, maintenant les param√®tres d'entr√©e et de sortie des shaders doivent correspondre.  Nous pouvons d√©clarer les param√®tres d'entr√©e / sortie dans le m√™me ordre, avec les m√™mes noms, ou nous faisons clairement co√Øncider leur emplacement √† l'aide de qualificatifs. <br>  Je recommande cette derni√®re option, cela nous permettra de configurer une interface clairement d√©finie, ainsi que d'√™tre flexible en ce qui concerne les noms et l'ordre. <br><br>  Pour fournir une interface plus rigoureuse, nous devons √©galement d√©clarer les blocs d'entr√©e et de sortie int√©gr√©s que nous voulons utiliser pour chaque √©tape. <br><br>  Les interfaces de blocs int√©gr√©es sont d√©finies comme (√† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">partir d'un wiki</a> ): <br>  Sommet: <br><br><pre> <code class="cpp hljs">out gl_PerVertex { vec4 gl_Position; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_PointSize; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_ClipDistance[]; };</code> </pre> <br>  Contr√¥le de la tesselation: <br><pre> <code class="cpp hljs">out gl_PerVertex { vec4 gl_Position; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_PointSize; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_ClipDistance[]; } gl_out[];</code> </pre> <br>  √âvaluation de la tesselation: <br><pre> <code class="cpp hljs">out gl_PerVertex { vec4 gl_Position; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_PointSize; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_ClipDistance[]; };</code> </pre> <br>  G√©om√©trie: <br><pre> <code class="cpp hljs">out gl_PerVertex { vec4 gl_Position; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_PointSize; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> gl_ClipDistance[]; };</code> </pre> <br>  Un exemple de re-d√©claration d'un module int√©gr√© et d'utilisation de l'emplacement d'attribut dans un vertex shader r√©gulier: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#version 450 out gl_PerVertex { vec4 gl_Position; }; layout (location = 0) in vec3 position; layout (location = 1) in vec3 color; layout (location = 0) out v_out { vec3 color; } v_out; void main() { v_out.color = color; gl_Position = vec4(position, 1.0); }</span></span></code> </pre> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr456932/">https://habr.com/ru/post/fr456932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr456920/index.html">Sony Xperia 1 en Russie - prix et bonus de pr√©commande</a></li>
<li><a href="../fr456922/index.html">Comment les processeurs sont con√ßus et fabriqu√©s: les bases de l'architecture informatique</a></li>
<li><a href="../fr456926/index.html">Comment nous faisons Sportmaster</a></li>
<li><a href="../fr456928/index.html">JMeter - Swiss Tester Knife (Partie 1)</a></li>
<li><a href="../fr456930/index.html">Amener l'IoT √† la masse: r√©sultats du premier hackathon IoT de GeekBrains et Rostelecom</a></li>
<li><a href="../fr456936/index.html">Cartes anim√©es sur SwiftUI</a></li>
<li><a href="../fr456938/index.html">Lancement d'une application de taxi-toiling √† Tokyo: comment Sony le fait-il avec S. Ride?</a></li>
<li><a href="../fr456942/index.html">Le dieu aux multiples armes de l'√©ch√©ance ou l'utilisation g√©n√©ralis√©e de l'analyse</a></li>
<li><a href="../fr456944/index.html">3 exemples pratiques d'utilisation de la d√©structuration en JavaScript</a></li>
<li><a href="../fr456946/index.html">Panneaux Grafana pour l'administration Kubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>