<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🥓 🌭 👴 Medición del rendimiento de Qt ⛴️ 🤟 🧕🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Decidí continuar la serie de artículos sobre Aurora OS (hasta hace poco llamado Sailfish). Durante el tiempo que trabajo con este sistema operativo, h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Medición del rendimiento de Qt</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/digdes/blog/457622/">  Decidí continuar la serie de artículos sobre Aurora OS (hasta hace poco llamado Sailfish).  Durante el tiempo que trabajo con este sistema operativo, he acumulado varias observaciones relacionadas con el rendimiento de las aplicaciones en Qt y el sistema en su conjunto, ya que está colgado con una variedad de dispositivos, como un árbol de Navidad, noto todas las pequeñas cosas al inicio.  Creo que esto puede ser interesante y útil para los colegas que también trabajan con Qt (o lo harán pronto).  Sugiere que puedas probar más. <br><br><img src="https://habrastorage.org/webt/rw/uu/ze/rwuuzedwibb0ocithqms-janr-u.jpeg"><br><a name="habracut"></a><br>  Programa en Qt y a menudo discuto con colegas, desarrolladores de iOS, las similitudes, diferencias y beneficios de los enfoques.  En algún momento, aún decidimos pasar de las palabras a los hechos y tomar medidas.  No encontramos un programador de Android que estuviera listo para participar en nuestro entretenimiento, por lo que una comparación con la participación de números y tablas será solo para Swift y C ++. <br><br>  Quiero recordarle que Qt / C ++ no impone su mecanismo de administración de memoria, y el usuario mismo resuelve este problema dentro del marco de las capacidades disponibles en C ++, mientras que en Swift se usa el conteo de referencias, y en Java es un recolector de basura.  Por lo tanto, el programador tiene la oportunidad de interactuar con la memoria de manera más eficiente.  Para enviar una solicitud http o leer datos de una base de datos, Qt se basa en sus propios puntos fuertes y no utiliza los marcos ya preparados que proporciona el sistema operativo.  Excepciones: interacción con el teclado, dibujar la ventana de inicio de la aplicación, mostrar notificaciones y otras cosas. <br><br><h2>  Prueba 1 </h2><br>  En primer lugar, decidimos escribir un algoritmo simple (el tamiz de Eratóstenes), ejecutarlo en grandes cantidades y comparar el tiempo de cálculo.  Lanzado en iPhone 7. <br><br>  <b>Programa Swift:</b> <br><br><pre><code class="swift hljs">swift <span class="hljs-comment"><span class="hljs-comment">// // ViewController.swift // Eratosthenes // // Created by Dmitry Shadrin on 22/11/2018. // Copyright 2018 Digital Design. All rights reserved. // import UIKit class ViewController: UIViewController { @IBOutlet weak var digitTextField: UITextField! @IBOutlet weak var timeLabel: UILabel! @IBAction func startAction(_ sender: UIButton) { guard let text = digitTextField.text, let number = Int(text) else { return } prime(n: number) } func prime(n: Int) { let startTime = DispatchTime.now() let _ = PrimeSequence(upTo: n) .reduce(into: [], { $0.append($1) }) //      let endTime = DispatchTime.now() let time = (endTime.uptimeNanoseconds - startTime.uptimeNanoseconds) timeLabel.text = "\(time)" } } public struct PrimeSequence: Sequence { private let iterator: AnyIterator&lt;Int&gt; public init(upTo limit: Int) { self.iterator = AnyIterator(EratosthenesIterator(upTo: limit)) } public func makeIterator() -&gt; AnyIterator&lt;Int&gt; { return iterator } } private struct EratosthenesIterator: IteratorProtocol { let n: Int var composite: [Bool] var current = 2 init(upTo n: Int) { self.n = n self.composite = [Bool](repeating: false, count: n + 1) } mutating func next() -&gt; Int? { while current &lt;= self.n { if !composite[current] { let prime = current for multiple in stride(from: current * current, through: self.n, by: current) { composite[multiple] = true } current += 1 return prime } current += 1 } return nil } }</span></span></code> </pre> <br><br>  No me detendré en el código en detalle, el Eratóstenes lineal no es obvio de entender, especialmente si uno de los idiomas no le es familiar.  Aquí hay un enlace con una descripción: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://e-maxx.ru/algo/prime_sieve_linear</a> , quienes estén interesados, pueden verificar la honestidad.  Por cierto, la versión rápida resultó estar un poco más optimizada en detalles (puede buscarlos), lo que no impidió que la versión plus ganara el rendimiento. <br><br>  <b>Programa Qt:</b> <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"eratosthenes.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;time.h&gt; #include &lt;QVector&gt; #include &lt;QDebug&gt; #include &lt;vector&gt; #include &lt;cmath&gt; Eratosthenes::Eratosthenes(QObject *parent) { time = 0; } void Eratosthenes::qtFunction(int n) { clock_t start, end; start = clock(); std::vector&lt;int&gt; lp = std::vector&lt;int&gt;(n + 1, 0); std::vector&lt;int&gt; pr; //       pr.reserve(std::sqrt(n) / 2); for (int i = 2; i &lt;= n; ++i) { if (lp[i] == 0) { lp[i] = i; pr.emplace_back(i); } for (int j = 0; j &lt; pr.size() &amp;&amp; pr[j] &lt;= lp[i] &amp;&amp; i * pr[j] &lt;= n; ++j) { lp[i * pr[j]] = pr[j]; } } end = clock(); time = (end - start) / (double)CLOCKS_PER_SEC; pTimeChanged(); qDebug() &lt;&lt; "  " &lt;&lt; pr.size() &lt;&lt; "" &lt;&lt; time; }</span></span></span></span></code> </pre> <br>  Ejecute el programa  Las aplicaciones tienen un campo para ingresar el número n, un botón de inicio y un campo con un tiempo total: <br><br><img src="https://habrastorage.org/webt/tf/q_/ck/tfq_ckywno1xmgpvylnfwwti12e.jpeg"><img src="https://habrastorage.org/webt/je/si/ta/jesita9gyvvdgv1nrtx-zcrhuu8.jpeg"><br>  <i>Swift - a la izquierda, Qt - a la derecha.</i> <br><br>  <b>Resultado</b>  Daré una tabla de medidas para diferentes ny en diferentes momentos: <br><img src="https://habrastorage.org/webt/w2/ck/cd/w2ckcddlg_p18aeq8lon2cagqpq.jpeg"><br>  Como puede ver, una aplicación C ++ es ~ 1.5 veces más rápida que una nativa con algoritmos idénticos. <br><br><h2>  Prueba 2 </h2><br>  Naturalmente, la informática en el contexto de las aplicaciones móviles es algo importante, pero lejos de ser la única.  Por lo tanto, dibujamos un ListView que consta de 1000 elementos, cada uno de los cuales contiene texto y una imagen, para ver la velocidad de representación de elementos gráficos.  A continuación, en los videos, puede ver el resultado: <br><br>  Qt: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/aC5tDt9xs7M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Rápido: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/7Lgp7waMvsw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Visualmente, la diferencia no es notable. <br><br><h2>  Prueba 3 </h2><br>  En el sistema operativo Sailfish, tenemos un kernel de Linux y un shell nativo gráfico en Qt, y esto en sí mismo lleva a pensar en el buen rendimiento de este sistema operativo.  A menudo noto que el Inoi R7 gana en términos de la velocidad de algunas tareas, aunque el Samsung Galaxy S8 hace lo mismo.  Entonces, por ejemplo, el Samsung Galaxy S8 envía, recibe, procesa, empaqueta en una base de datos, etc.  10K solicitudes http en unos 3-4 minutos, e Inoi R7 hace lo mismo durante 5-6 minutos.  Dada la diferencia en el rendimiento del hierro, el resultado es impresionante. <br><br>  Para una prueba más honesta del rendimiento del sistema operativo, decidí mirar la velocidad de respuesta de la carretilla. <br><br><h4>  Test.cpp: </h4><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"mypainter.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;QPainter&gt; MyPainter::MyPainter(QQuickItem *parent) : QQuickPaintedItem(parent) { } void MyPainter::paint(QPainter *painter) { QPen pen; pen.setWidth(10); pen.setColor(Qt::red); painter-&gt;setPen(pen); painter-&gt;drawPolyline(pol); } void MyPainter::xyCanged(int x, int y) { pol.append(QPoint(x, y)); update(); }</span></span></span></span></code> </pre><br><h4>  Test.qml: </h4><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> QtQuick <span class="hljs-number"><span class="hljs-number">2.9</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> QtQuick.Window <span class="hljs-number"><span class="hljs-number">2.2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Painter <span class="hljs-number"><span class="hljs-number">1.0</span></span> Window { visible: <span class="hljs-literal"><span class="hljs-literal">true</span></span> Painter { id: painter anchors.fill: parent MouseArea { anchors.fill: parent onPressed: { painter.xyCanged(mouseX, mouseY) } onMouseXChanged: { painter.xyCanged(mouseX, mouseY) } onMouseYChanged: { painter.xyCanged(mouseX, mouseY) } } } }</code> </pre><br>  Simple y sin pretensiones.  No tengo un teléfono que sea compatible con Sailfish y Android para uso personal, así que tuve que mirar a mis colegas por un teléfono que esté lo más cerca posible de Inoi r7, pero en Android.  Lo que de repente resultó ser muy difícil, teniendo en cuenta que estoy sentado en una oficina de desarrollo móvil. <br><br>  <i><b>Sony Xperia Z5 compact:</b></i> <i><br></i>  <i>Procesador - Qualcomm Snapdragon 810 MSM8994, 2000 MHz</i> <i><br></i>  <i>El número de núcleos de procesador: 8</i> <i><br></i>  <i>Procesador de video - Adreno 430</i> <i><br></i>  <i>La cantidad de memoria interna - 32 GB</i> <i><br></i>  <i>La cantidad de RAM - 2 GB</i> <br><br>  <i><b>Inoi R7:</b></i> <i><br></i>  <i>Procesador - Qualcomm Snapdragon 212 MSM8909AA, 1200 MHz</i> <i><br></i>  <i>El número de núcleos de procesador: 4</i> <i><br></i>  <i>Procesador de video - Adreno 304</i> <i><br></i>  <i>La cantidad de memoria interna - 16 GB</i> <i><br></i>  <i>La cantidad de RAM - 2 GB</i> <br><br>  Sin embargo, Sony resultó ser más potente, pero para la ecuación de probabilidades activamos el modo de ahorro de energía, de todos modos no conducirá a la igualdad completa de la potencia de los dispositivos.  En el video puedes ver que en Android la línea no es tan fluida como en Sailfish. <br><br>  Izquierda - Sony, derecha - Inoi: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/bmYRRemNb5M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  No discuto, este no es un indicador muy serio, necesita comparar no solo las capacidades de un lenguaje puro, sino también diferentes bibliotecas, nativas y multiplataforma, para comparar su rendimiento y facilidad de uso, porque hay muy pocas aplicaciones que usan solo ListView y el tamiz Eratosthenes.  Aunque todas estas pequeñas cosas juntas me parecen muy convincentes. <br><br><h4>  Contras </h4><br>  Por supuesto, todo no es tan optimista con Qt, ya que trato de pintar aquí, hay inconvenientes.  Por ejemplo, al trabajar con TextInput en Android, puede torturar a los perfeccionistas que son especialmente sensibles a las muletas, porque en cada dispositivo Qt logra colocar palos absolutamente únicos en las ruedas cuando interactúa con el teclado.  En un teléfono, la imagen sube, en el otro se detiene, pero EnterKey no funciona, en el tercero solo se ingresan letras mayúsculas y no hay forma de convencerlo de que cambie a minúsculas.  Puedes ir ad infinitum.  ¡Y todo esto también se ralentiza!  (Los gruñidos son relevantes solo para Android, no hay tales problemas en Sailfish, todo funciona bien).  Además, en Qt es difícil lograr la apariencia nativa de la aplicación. <br><br><h3>  Conclusión </h3><br>  La principal conclusión que se puede extraer: Qt, al ser una herramienta multiplataforma, no es inferior en rendimiento a las herramientas de desarrollo nativas.  Es perfecto para programas en los que, además de la interfaz gráfica de usuario, todavía hay muchas matemáticas, y especialmente para aplicaciones empresariales, donde hay muchos matices y pocos empleados, para no crear una versión independiente para cada sistema operativo.  Las funciones son más importantes para los usuarios corporativos que la IU nativa.  Para Aurora, Qt es una herramienta nativa para el desarrollo de aplicaciones, que probablemente brinda algún otro impulso de rendimiento. <br><br>  Sería interesante probar el Aurora en un hardware potente como mi Galaxy S8. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/457622/">https://habr.com/ru/post/457622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../457610/index.html">Análisis de vulnerabilidades de Evil Parcel</a></li>
<li><a href="../457612/index.html">¿Cómo acelerar la descompresión de LZ4 en ClickHouse?</a></li>
<li><a href="../457614/index.html">Secretos de encontrar un trabajo en el extranjero de un cazatalentos en ejercicio</a></li>
<li><a href="../457616/index.html">Mi "¡Guau, no lo sabía!" momentos con broma</a></li>
<li><a href="../457618/index.html">Ser un desarrollador moderno de pila completa</a></li>
<li><a href="../457624/index.html">Cómo rompimos la vieja choza y construimos un rascacielos en su lugar</a></li>
<li><a href="../457626/index.html">Revisión de los niveles de acceso del usuario utilizando Power BI utilizando el ejemplo de Bitrix CMS (BUS)</a></li>
<li><a href="../457628/index.html">Programa P2M efectivo y gestión de proyectos</a></li>
<li><a href="../457630/index.html">Experiencia desarrollando requisitos para el científico de datos de cualidades profesionales</a></li>
<li><a href="../457632/index.html">¿Cuánto cuestan las pruebas unitarias?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>