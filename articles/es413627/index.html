<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üì† üòé üîÄ Generaci√≥n de clave jer√°rquica ‚ÑπÔ∏è üöõ üë®‚Äç‚úàÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En este art√≠culo, hablaremos sobre billeteras deterministas, generaci√≥n de claves jer√°rquicas y c√≥mo funciona matem√°ticamente y en qu√© casos es conven...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Generaci√≥n de clave jer√°rquica</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/distributedlab/blog/413627/">  En este art√≠culo, hablaremos sobre billeteras deterministas, generaci√≥n de claves jer√°rquicas y c√≥mo funciona matem√°ticamente y en qu√© casos es conveniente ponerlas en pr√°ctica.  Este material ser√° √∫til para especialistas cuyas actividades est√°n relacionadas con pasarelas de pago, billeteras Bitcoin y otras tiendas de monedas.  Adem√°s, el material ser√° de inter√©s para quienes est√©n interesados ‚Äã‚Äãen la criptograf√≠a el√≠ptica y los esquemas de implementaci√≥n de claves de firma electr√≥nica. <br><a name="habracut"></a><br><h2>  <b>Billetera determinista</b> </h2><br>  En primer lugar, definamos qu√© es una billetera determinista.  Cuando hablamos de generaci√≥n de claves, a menudo usamos la palabra "billetera", porque en el contexto de las criptomonedas, poseer una clave privada es una prueba de propiedad de monedas, y en este caso, la billetera y la llave tienen un significado similar. <br><br>  La billetera determinista es una billetera en la que todas las claves privadas utilizadas se generaron a partir de un secreto compartido por todas las claves.  La peculiaridad es que es posible desde un secreto generar cualquier n√∫mero de pares de claves para la firma electr√≥nica.  Puede usar nuevas direcciones para cada pago entrante y cambio. <br><br>  Convenientemente, las claves de dicha billetera se pueden transferir f√°cilmente a otro dispositivo, hacer una copia de seguridad y luego restaurarla, porque de hecho solo necesita reservar un secreto principal.  Adem√°s, todas las claves privadas generadas a partir del secreto principal no est√°n conectadas entre s√≠.  Es imposible rastrear la conexi√≥n entre las direcciones generadas (para determinar que todas pertenecen a un usuario), y al tener la clave privada generada, no puede restaurar el secreto compartido. <br><br><h3>  Codificaci√≥n secreta b√°sica </h3><br>  Ahora hablemos de codificar el secreto principal.  Hay un enfoque estandarizado que se defini√≥ en BIP39.  Esta es la codificaci√≥n de codificaci√≥n de verificaci√≥n del secreto principal en una frase mnem√≥nica: un conjunto de palabras que es f√°cil de escribir en papel y, si es necesario, recordar.  Al ingresar, es posible verificar la suma de verificaci√≥n, es decir, identificar un error, si lo hay, con una probabilidad bastante alta. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00e/c02/e0f/00ec02e0fe0b361673229ecc9fa59e14.png" alt="imagen"><br><br>  Como funciona  De hecho, tiene el secreto principal (Entrop√≠a): los datos a partir de los cuales se expanden todas las claves personales de la billetera.  Este secreto puede tener diferentes longitudes.  En cuanto a la suma de verificaci√≥n: por cada 32 bits de entrop√≠a hay 1 bit de la suma de verificaci√≥n, es decir, la f√≥rmula calcula la suma de verificaci√≥n como la longitud de la entrop√≠a en bits divididos por 32. <br><br>  La entrop√≠a se concatena con una suma de comprobaci√≥n, que se calcula como un doble hash SHA-256 (SHA-2 con una longitud de 256 bits), despu√©s de lo cual se corta el n√∫mero requerido de bits.  Los datos concatenados se transfieren a otro sistema de n√∫meros: del sistema binario al sistema de n√∫meros en la base de 2048 (como puede ver, 2048 es <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>11</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-31" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-1"> 2 ^ {11} </script>  )  Y si agrega la longitud de los bits de entrop√≠a y la suma de verificaci√≥n, obtendr√° un m√∫ltiplo de 11.  Por lo tanto, obtenemos el n√∫mero de palabras en la frase mnem√≥nica de salida. <br><br>  De hecho, los datos se "dividen" en partes de 11 bits.  Hay un diccionario de 2048 palabras ( <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>11</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-31" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>11</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-2"> 2 ^ {11} </script>  ) a los que se aplican ciertos requisitos.  El idioma predeterminado del diccionario es el ingl√©s, pero se puede usar cualquier persona.  Las palabras no deben exceder una cierta longitud (generalmente un l√≠mite de hasta 7 caracteres).  Todos ellos deben estar codificados en UTF-8 con una cierta normalizaci√≥n de todos los caracteres.  Obligatorio es la unicidad de cada palabra en los primeros cuatro caracteres. <br><br>  Los primeros cuatro caracteres identifican de manera √∫nica la palabra en el diccionario, y los caracteres restantes se usan para completar esta palabra en una forma conveniente para leer, memorizar, etc. Por lo tanto, cada pieza de datos que consta de 11 bits recibe una coincidencia inequ√≠voca en la forma de una palabra de diccionario  Si la entrop√≠a de su secreto es de 256 bits, los datos para la codificaci√≥n ser√°n de 264 bits y su frase mnem√≥nica contendr√° 24 palabras.  Este es el enfoque principal para cifrar secretos de billetera en BIP39, que se usa con mayor frecuencia en la pr√°ctica. <br><br>  Para hacer una copia de seguridad en el futuro y usarla, est√° invitado a escribir esta frase en un medio externo.  El papel que guardar√° en un lugar seguro es lo mejor.  Para que pueda restaurar el acceso completo a todas sus claves. <br><br><h3>  Tipos de carteras deterministas </h3><br>  Las carteras deterministas vienen en dos tipos.  Considere sus principales diferencias. <br><br>  El primero es el m√°s simple.  El secreto principal aqu√≠ se concatena con el √≠ndice de la clave secundaria que queremos obtener, despu√©s de lo cual se trituran los datos concatenados.  La mayor√≠a de las veces esto sucede usando la funci√≥n hash SHA-256. <br><br>  El segundo tipo incluye billeteras deterministas jer√°rquicas (billeteras HD), cuyos principios se definen en BIP32, y son un enfoque muy com√∫n para la generaci√≥n de claves jer√°rquicas. <br><br><h3>  Generaci√≥n determinista </h3><br>  Considere las diferencias entre estos tipos de billeteras en el diagrama. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/271/a5a/477/271a5a47790684700751178bcee9d340.png" alt="imagen"><br><br>  Una billetera determinista ordinaria tiene una semilla, a partir de la cual se genera directamente una gran cantidad de claves privadas.  Su n√∫mero solo puede estar limitado por la dimensi√≥n del √≠ndice, que se concatena con el secreto antes del hash.  Por lo general, son 4 bytes, es decir, el espacio de opciones posibles permite alrededor de 4 mil millones de claves de billetera deterministas √∫nicas.  En la pr√°ctica, esto deber√≠a ser suficiente para cualquier situaci√≥n. <br><br><h3>  Generaci√≥n determinista jer√°rquica </h3><br>  Pasemos a una billetera determinista jer√°rquica, cuyo esquema de implementaci√≥n clave se presenta de forma simplificada hasta ahora.  Hay semilla, de la cual se obtiene un par de claves maestras directamente.  Si en una billetera determinista ordinaria obtenemos una clave privada, entonces aqu√≠ obtenemos un par de claves.  Adem√°s, hay niveles de jerarqu√≠a, en cada uno de los cuales calculamos el √≠ndice para generar la clave secundaria.  Tambi√©n podemos construir ramas de clave p√∫blica y ramas de clave privada. <br><br><h3>  Niveles de jerarqu√≠a </h3><br>  Con respecto a las billeteras HD, vale la pena se√±alar que de acuerdo con las reglas BIP32 en cada nivel de la jerarqu√≠a, un nodo de generaci√≥n tiene tres objetos: una clave privada, una clave p√∫blica y un c√≥digo de cadena que se utiliza para generar el siguiente nivel de jerarqu√≠a. <br><br><h3>  Esquema de generaci√≥n jer√°rquica </h3><br>  Consideremos con m√°s detalle el esquema de generaci√≥n de claves para BIP32. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/685/e79/e3e/685e79e3eae45b867f3033aad03f1743.png" alt="imagen"><br><br>  Todo comienza con semilla, tambi√©n se llama semilla maestra, a partir de la cual se calcula el nivel cero de la jerarqu√≠a: un par de claves maestras y c√≥digo de cadena. <br><br>  Se puede generar una gran cantidad de pares de claves con √≠ndices espec√≠ficos a partir de un par de claves maestras.  Se est√° formando un nuevo nivel de jerarqu√≠a, que se utiliza para generar cuentas.  Supongamos que un usuario tiene semilla y quiere crear varias direcciones que ser√°n diferentes entre s√≠.  Las monedas de estas direcciones no se mezclar√°n, no se publicar√°n juntas, y en las transacciones terminadas entre ellas no ser√° posible encontrar una conexi√≥n.  Estas teclas se usar√°n completamente por separado una de la otra.  En una de las cuentas, el grupo clave se utilizar√° para el presupuesto de trabajo, en la otra para el presupuesto personal y otra cuenta para la contabilidad negra.  Las monedas no se mezclar√°n entre s√≠. <br><br>  El siguiente nivel de jerarqu√≠a define diferentes cadenas de generaci√≥n de claves.  Con mayor frecuencia, se utilizan cadenas con los √≠ndices 0 y 1. Una cadena con √≠ndice 0 generar√° claves finales para formar una direcci√≥n para los pagos entrantes, y una cadena con √≠ndice 1 generar√° billeteras para monedas enviadas por el usuario, es decir, el cambio.  Esto es necesario para que la billetera a nivel del programa distinga los pagos enviados desde el exterior del cambio, calcule los cambios en el saldo de cada transacci√≥n y compile una lista visual con el historial de todos los pagos.  Esto simplifica el desarrollo de la billetera y su uso para pagos diarios. <br><br><h3>  C√≥digo de autenticaci√≥n de mensaje basado en hash </h3><br>  Ahora pasemos al componente matem√°tico de los procesos jer√°rquicos de generaci√≥n de claves.  Para empezar, considere el c√≥digo de autenticaci√≥n de mensaje basado en hash.  Esta es una clase diferente para calcular funciones hash.  Se diferencia en que toma dos valores en la entrada, y no uno.  El primer valor es la clave privada y el segundo es el mensaje en s√≠. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy=&quot;false&quot;>(</mo><mi>K</mi><mo>,</mo><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><mo stretchy=&quot;false&quot;>(</mo><msup><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>p</mi><mi>a</mi><mi>d</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>H</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>p</mi><mi>a</mi><mi>d</mi></mrow></msup><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>m</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="44.281ex" height="3.021ex" viewBox="0 -987.6 19065.2 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-48" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-4D" x="888" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-41" x="1940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-43" x="2690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-28" x="3451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-4B" x="3840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-2C" x="4730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-6D" x="5175" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-29" x="6053" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-3D" x="6720" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-48" x="7777" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-28" x="8665" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-28" x="9055" y="0"></use><g transform="translate(9444,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-4B" x="0" y="0"></use><g transform="translate(901,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-70" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-61" x="989" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-64" x="1518" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-29" x="11890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-7C" x="12279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-7C" x="12558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-48" x="12836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-28" x="13725" y="0"></use><g transform="translate(14114,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-4B" x="0" y="0"></use><g transform="translate(901,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-70" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-61" x="849" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-64" x="1378" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-29" x="16461" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-7C" x="16850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-7C" x="17129" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-6D" x="17407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-29" x="18286" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-29" x="18675" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>H</mi><mi>M</mi><mi>A</mi><mi>C</mi><mo stretchy="false">(</mo><mi>K</mi><mo>,</mo><mi>m</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><msup><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>p</mi><mi>a</mi><mi>d</mi></mrow></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>H</mi><mo stretchy="false">(</mo><msup><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>p</mi><mi>a</mi><mi>d</mi></mrow></msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>m</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> HMAC (K, m) = H ((K ^ {opad}) || H (K ^ {ipad}) || m)) </script></p><br><br>  K es la clave <br>  m - mensaje <br>  opad, ipad: algunos valores constantes necesarios para generar claves que difieren entre s√≠ en diferentes etapas de hashing. <br>  Como funci√≥n hash, se utiliza SHA-512. <br><br>  La peculiaridad es que para usar HMAC, debe poseer una clave secreta para obtener el valor hash correcto del mensaje. <br><br>  Por lo tanto, para calcular el valor hash de HMAC, el valor de la clave XOR es con el valor constante de ipad, despu√©s de lo cual se divide el resultado.  Un mensaje se concatena a este valor, despu√©s de lo cual la clave XOR se calcula con un valor constante, se concatena con un valor hash y luego se vuelve a aplicar hash.  Como resultado, obtenemos 512 bits del valor hash. <br><br><h3>  Funciones de derivaci√≥n </h3><br>  Veamos algunas funciones que se utilizan para calcular claves jer√°rquicas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/96e/f47/b41/96ef47b4141a2060395a9933dd56c52f.png" alt="imagen"><br><br>  En primer lugar, estamos interesados ‚Äã‚Äãen convertir la semilla maestra en un par de llaves maestras.  Despu√©s de eso, debe obtener la clave privada secundaria y la clave p√∫blica secundaria de la clave primaria personal.  En el segundo caso, se usa exactamente la misma funci√≥n que en el primero, pero se agrega la multiplicaci√≥n del n√∫mero por el punto base, por lo tanto, no se considerar√° por separado.  El siguiente paso es obtener el p√∫blico secundario de la clave primaria p√∫blica.  Vale la pena se√±alar que no es posible obtener un elemento personal secundario de la clave p√∫blica principal.  Esta limitaci√≥n se debe a ciertas propiedades inherentes a las billeteras HD, que consideraremos m√°s a fondo. <br><br>  Entonces, repasemos cada una de las funciones de generaci√≥n por separado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/736/372/31c/73637231c62a14b4bf5f8e7a5d498d01.png" alt="imagen"><br><br>  Para obtener la clave maestra del sid maestro, se utiliza la funci√≥n HMAC, donde la cadena constante "semilla de Bitcoin" se transmite como la clave, y los datos secretos principales en s√≠ como un mensaje.  Por lo tanto, se obtiene un valor hash de 512 bits, que consideramos como dos partes: izquierda y derecha.  El lado izquierdo es la clave privada maestra, y el lado derecho ser√° el c√≥digo de cadena.  Adem√°s, estos valores se utilizar√°n para generar niveles posteriores de claves secundarias. <br><br>  Para obtener un maestro p√∫blico, simplemente multiplique el valor del punto base por el valor de la clave privada maestra.  Como puede ver, esto sucede por analog√≠a con las teclas ordinarias en un grupo de puntos en una curva el√≠ptica. <br><br>  Ahora veamos c√≥mo la clave privada secundaria proviene de la clave privada primaria. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a6f/eeb/022/a6feeb0227ea2d2ba18ed42ce4d47d01.png" alt="imagen"><br><br>  Usaremos la funci√≥n HMAC nuevamente.  Como clave, pasamos el c√≥digo de cadena del nivel de jerarqu√≠a actual, y como mensaje, concatenaci√≥n, donde la primera parte ser√° la clave principal personal multiplicada por el punto base.  De hecho, este es un reparto a un punto y la serializaci√≥n de este punto.  La concatenaci√≥n se produce con el √≠ndice de la clave secundaria que queremos recibir, serializado en 32 bits, es decir, 4 bytes. <br><br>  Seg√∫n el resultado de la funci√≥n HMAC, obtenemos el valor I, y nuevamente lo consideramos por separado: las partes izquierda y derecha de los valores de salida son 256 bits.  Entonces la clave privada del ni√±o <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>k</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.011ex" height="2.419ex" viewBox="0 -780.1 865.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-69" x="737" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>k</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-4"> k_i </script>  calculamos agregando al valor de salida izquierdo <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>l</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.746ex" height="2.419ex" viewBox="0 -780.1 751.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-6C" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>l</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-5"> I_l </script>  valores de la clave privada principal.  La adici√≥n se realiza m√≥dulo n, donde n es el orden del punto base de la curva el√≠ptica, para no exceder el valor m√°ximo de la clave privada.  Por lo tanto, recibimos una clave privada secundaria. <br><br>  En consecuencia, el c√≥digo de la cadena secundaria ser√° igual al valor de salida correcto de la funci√≥n HMAC, es decir <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>I</mi><mi>R</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.503ex" height="2.419ex" viewBox="0 -780.1 1077.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-52" x="622" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>I</mi><mi>R</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-6"> I_R </script>  .  Si queremos encontrar la clave p√∫blica secundaria a partir de la clave primaria personal, multiplicamos el valor <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>k</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.011ex" height="2.419ex" viewBox="0 -780.1 865.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-69" x="737" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>k</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-7"> k_i </script>  por el valor del punto base en la curva el√≠ptica.  Entonces obtenemos la clave p√∫blica <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>K</mi><mi>i</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.773ex" height="2.419ex" viewBox="0 -780.1 1193.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMATHI-69" x="1201" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>i</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-8"> K_i </script>  . <br><br>  ¬øC√≥mo calculamos la clave p√∫blica secundaria a partir de la clave primaria p√∫blica? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/39a/bbe/e55/39abbee5560b44abbe7a271a88153198.png" alt="imagen"><br><br>  Aqu√≠ el c√°lculo ser√° un poco diferente.  Pasamos la jerarqu√≠a de cadena del nivel de jerarqu√≠a actual como una clave en la funci√≥n HMAC, despu√©s de lo cual serializamos la clave p√∫blica principal y la concatenamos con el √≠ndice deseado serializado a 32 bits.  Los datos de entrada se obtienen exactamente de la misma manera que en el caso anterior.  Para calcular la clave p√∫blica, tomamos el lado izquierdo del valor de salida de la funci√≥n HMAC y lo consideramos como 256 bits tomados m√≥dulo del orden del punto base, lo llevamos a un punto en la curva el√≠ptica, es decir, lo multiplicamos por el punto base y luego agregamos el resultado con la clave p√∫blica principal .  El resultado de la adici√≥n tambi√©n ser√° un punto, y ser√° una clave secundaria p√∫blica.  El c√≥digo de cadena para esta clave ser√° el lado derecho del valor de salida de la funci√≥n HMAC. <br><br><h3>  Claves coincidentes entre s√≠ </h3><br>  Esto puede plantear una pregunta l√≥gica sobre c√≥mo las claves privadas y p√∫blicas obtenidas de diferentes maneras se corresponder√°n entre s√≠.  ¬øEs realmente posible obtener exactamente el mismo valor de una clave p√∫blica generada por una v√≠a p√∫blica tomando una clave privada obtenida de otra manera y multiplic√°ndola por un punto base?  Esto es f√°cil de verificar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e44/ac2/851/e44ac28516cc2774373bc76d94d0c244.png" alt="imagen"><br><br>  Si recordamos c√≥mo calculamos la clave secundaria personal y la multiplicamos por el punto base, es decir, la llevamos a la funci√≥n de punto, y luego recordamos el c√°lculo de la clave p√∫blica secundaria y comparamos estos c√°lculos, veremos que si consideramos la clave p√∫blica primaria como un producto de la clave personal clave del punto base, luego veremos que se realizaron los mismos c√°lculos, solo en un orden diferente. <br><br>  En un caso, agregamos las claves privadas y las multiplicamos por el punto base, y en el segundo caso, primero multiplicamos los valores por el punto base, luego los agregamos y obtuvimos el resultado.  Basado en el hecho de que la operaci√≥n de sumar puntos en una curva el√≠ptica es aditiva, podemos decir que estos dos valores son iguales: obtendremos la misma clave p√∫blica calculada de dos maneras. <br><br><h3>  Ejemplo de clave p√∫blica </h3><br>  En aras del inter√©s, podemos ver un ejemplo de una clave p√∫blica que se obtuvo para los valores de prueba y los c√°lculos BIP32.  Si nuestra entrop√≠a consist√≠a en 128 bits, en el sistema de n√∫meros hexadecimales se ver√° como la imagen de abajo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/64c/ca1/01a/64cca101a12268bda803fd8f447c719e.png" alt="imagen"><br><br>  El mismo valor codificado en la frase mnem√≥nica BIP39 se ver√° como las 12 palabras que se muestran.  Si utiliza esta frase mnem√≥nica como semilla maestra para la generaci√≥n de claves jer√°rquicas, obtendr√° dicha clave privada maestra con el c√≥digo de cadena de 256 bits correspondiente. <br><br><h3>  Llaves extendidas </h3><br>  Tambi√©n existen conceptos como clave p√∫blica extendida y clave privada extendida.  Como se usa  Para comprender mejor, describimos la situaci√≥n visual. <br><br>  Digamos que tenemos un usuario espec√≠fico y alg√∫n servicio.  Un servicio transfiere pagos, por ejemplo en bitcoins, a un usuario con cierta frecuencia.  Tanto el usuario como el servicio est√°n interesados ‚Äã‚Äãen utilizar una nueva direcci√≥n para cada pago, a fin de dificultar que un observador externo establezca un hecho y confunda el historial de interacci√≥n entre ellos. <br><br>  En el caso m√°s simple, se ver√≠a as√≠: el usuario para cada pago entrante genera un nuevo par de claves, calcula la direcci√≥n que pasa al servicio, despu√©s de lo cual el servicio puede generar una transacci√≥n y realizar el pago.  Sin embargo, esto es inconveniente para cualquiera de las partes si la intensidad de estos pagos es alta. <br><br><h3>  Clave p√∫blica extendida </h3><br>  En una situaci√≥n similar, la clave p√∫blica extendida (xPubKey) ayuda a eliminar las molestias.  El usuario puede habilitar un servicio de terceros para generar direcciones en lugar de s√≠ mismas que ser√°n conocidas por el servicio, pero solo el usuario tendr√° claves privadas.  El servicio puede generar cualquier n√∫mero de direcciones sin el conocimiento del usuario y enviarles fondos, y el usuario puede, a su conveniencia, implementar claves privadas y obtener acceso a cualquiera de estas direcciones. <br><br>  Como funciona  El usuario necesita generar una nueva cuenta en el segundo nivel de la jerarqu√≠a de claves, calcular para √©l la clave p√∫blica y el c√≥digo de cadena para el nivel actual.  Despu√©s de eso, debe transferir la clave p√∫blica y el c√≥digo de cadena al servicio.  Por conveniencia, se introdujo la codificaci√≥n Base58Check, de la que hablamos (aqu√≠ hay una versi√≥n especial).  A continuaci√≥n, la clave p√∫blica, el c√≥digo de cadena y la suma de verificaci√≥n se concatenan.  Todo esto est√° codificado en el sistema de n√∫meros base 58 y obtenemos una clave p√∫blica extendida ya codificada de acuerdo con cierto est√°ndar.  Comienza con los caracteres "xpub", que se reconoce f√°cilmente.  Se ver√° como se muestra en la imagen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c61/aae/082/c61aae082f6a423d35712fcf63246f68.png" alt="imagen"><br><br>  Un servicio puede aceptar dicha clave e implementar claves p√∫blicas para el usuario a trav√©s de BIP32, recibir direcciones de ellas y pagarlas.  Sin embargo, solo el usuario puede calcular las claves privadas correspondientes. <br><br><h3>  Derivaci√≥n endurecida </h3><br>  En la generaci√≥n jer√°rquica de claves existe una derivaci√≥n reforzada.  Este es un enfoque que no permite el c√°lculo de claves p√∫blicas secundarias a partir de la clave p√∫blica principal correspondiente.  Esto difiere de la generaci√≥n normal en que en √©l usamos la concatenaci√≥n del punto serializado como la clave p√∫blica principal como un mensaje para la funci√≥n HMAC, y en la derivaci√≥n reforzada usamos la serializaci√≥n de la clave privada principal. <br><br>  Adem√°s, el c√°lculo del √≠ndice es diferente.  El √≠ndice en la generaci√≥n normal se serializa directamente a 32 bits, y en la derivaci√≥n reforzada se convierte ligeramente: se le agrega un valor constante <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>31</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-31" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-9"> 2 ^ {31} </script>  eso establece el bit m√°s significativo en 1 (se hace f√°cil distinguir entre los tipos de derivaci√≥n).  En consecuencia, el espacio de variantes de posibles claves es el mismo para la generaci√≥n normal y la derivaci√≥n endurecida, y es igual a <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>31</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.039ex" height="2.419ex" viewBox="0 -935.7 1308.3 1041.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,393)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=https://habr.com/ru/company/distributedlab/blog/413627/&amp;usg=ALkJrhhlCa7J1j_8Nscst-Aezgw-qe4kfQ#MJMAIN-31" x="500" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mn>31</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-10"> 2 ^ {31} </script>  . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cea/160/ab3/cea160ab30c57ea702407dd53893d25e.png" alt="imagen"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo tanto, al tener una clave p√∫blica principal y una derivaci√≥n reforzada, no es posible calcular las claves p√∫blicas secundarias. </font><font style="vertical-align: inherit;">Si el atacante recibe la clave p√∫blica principal, no podr√° calcular las claves secundarias. </font><font style="vertical-align: inherit;">Por lo tanto, no podr√° calcular las direcciones y su relaci√≥n con la clave principal recibida. </font><font style="vertical-align: inherit;">En el caso de la derivaci√≥n normal, es decir, en la forma habitual, dicha funci√≥n se puede utilizar y rastrear la relaci√≥n de direcciones entre ellos.</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Caminos de generacion </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hablemos sobre las formas en que se pueden generar claves. </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c7d/0bc/006/c7d0bc0061acf64d206c73d305de73c4.png" alt="imagen"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En cada nivel de la jerarqu√≠a, hay un √≠ndice espec√≠fico que define aspectos de la generaci√≥n de claves. La ruta de la clave maestra a la clave final se puede escribir mediante barras inclinadas como √≠ndices. Si estamos hablando de una clave privada, entonces la grabaci√≥n comienza con una peque√±a "m", y si estamos hablando de generar una clave p√∫blica, entonces con una "M" grande. Si el √≠ndice est√° indicado por un ap√≥strofe, entonces debe entenderse que estamos hablando de derivaci√≥n endurecida, sin un ap√≥strofe - derivaci√≥n normal. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Considere una de las rutas populares de generaci√≥n de claves utilizadas en BIP32, donde se definieron las claves jer√°rquicas.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ab/564/b7c/1ab564b7cbe935bfbe5aa2075c1fce31.png" alt="imagen"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Utiliza una ruta donde la clave maestra es el nivel cero de la jerarqu√≠a. Los siguientes son los √≠ndices de cuentas que designan al mismo usuario, seguidos por cadenas donde puede haber cadenas de direcciones que se publican afuera para aceptar pagos entrantes, y con el √≠ndice 1, se crear√°n esas cadenas a las que el usuario se env√≠a los pagos a s√≠ mismo (m√°s a menudo todo esto es rendici√≥n). El √≠ndice final se utilizar√° para generar las claves a partir de las cuales se calcular√°n las direcciones. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para calcular la primera clave con √≠ndice 0 de acuerdo con el est√°ndar BIP32, tendremos m, 0 con la generaci√≥n de endurecido, cadena - 0, √≠ndice - 0 (m / 0 '/ 0/0). Entonces obtenemos la ruta para la primera clave generada jer√°rquicamente.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hay una sugerencia para mejorar Bitcoin, se llama BIP43, que implica escribir en el primer nivel de la jerarqu√≠a el n√∫mero de mejora, que ofrece una nueva ruta de generaci√≥n (m / bip_number '/ *). </font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/68c/652/61f/68c65261f576ac3e75c412c2de9b50b5.png" alt="imagen"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo tanto, apareci√≥ BIP44, que us√≥ la caracter√≠stica de la oraci√≥n anterior, es decir, el √≠ndice 44 est√° escrito para el primer nivel de jerarqu√≠a, y propuso las siguientes mejoras: en el √≠ndice del segundo nivel de jerarqu√≠a, registre un cierto valor que corresponder√° al tipo de moneda que usamos para esta billetera. Ahora, las claves para diferentes monedas se pueden implementar y usar en una billetera.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/23b/739/3bd/23b7393bd44abf5568d476c03d0a8bf8.png" alt="imagen"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para Bitcoin, la ruta se ver√° como ‚Äúm / 44 '/ 0' / 0 '/ 0/0‚Äù, para Bitcoin testnet - ‚Äúm / 44' / 1 '/ 0' / 0/0‚Äù, para Litecoin - ‚Äúm / 44 '/ 2' / 0 '/ 0/0 ‚Äù, para Dash -‚Äú m / 44' / 5 '/ 0' / 0/0 ‚Äù. Curiosamente, Ethereum usa exactamente la misma curva el√≠ptica para calcular claves y firmar digitalmente y para su billetera la ruta se ver√° como "m / 44 '/ 60' / 0 '/ 0/0". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hay otra mejora: BIP45. La mejora est√° dirigida a determinar las reglas para generar claves en caso de su uso en billeteras de m√∫ltiples firmas y la formaci√≥n de direcciones usando BIP16, es decir, P2SH. Incluye la oraci√≥n BIP43 e indica el √≠ndice 45 en el primer nivel de la jerarqu√≠a; en el segundo nivel de la jerarqu√≠a, requiere una indicaci√≥n de un firmante (cosignatario).</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4bc/2c8/fd1/4bc2c8fd1c785ef5c9deb48417db9c53.png" alt="imagen"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por ejemplo, hay una regla de firma m√∫ltiple 3 de 5. Por lo tanto, hay 5 signatarios, pero para gastar monedas, necesita al menos 3 firmas. Por lo tanto, cada uno de los firmantes tendr√° una billetera HD con su propia semilla maestra e indicar√° su n√∫mero de serie en su camino. Se puede calcular como un √≠ndice al ordenar las claves generadas en el primer nivel de la jerarqu√≠a de cada usuario. Supongamos que, en el primer nivel, cada usuario genera claves, intercambian entre s√≠, clasifican y descubren qui√©n tiene qu√© √≠ndice para el segundo nivel de la jerarqu√≠a. Esto es necesario para eliminar a√∫n m√°s la necesidad de interactuar de esta manera, e inmediatamente generar direcciones correctamente y conocer su n√∫mero de serie.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Es decir, puede intercambiar la clave p√∫blica extendida una vez para poder, independientemente, independientemente de otros miembros del grupo, formar direcciones de m√∫ltiples firmas y aceptar pagos en ellas. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Preguntas </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pasemos a las preguntas frecuentes. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ¬øC√≥mo difieren las semillas maestras en diferentes monedas?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> La semilla es un n√∫mero generado aleatoriamente, alguna secuencia de bits, o es una frase mnem√≥nica generada, por ejemplo, de acuerdo con BIP39, que se utiliza para generar claves. Se puede usar tanto para una moneda como para cualquier otra; no es necesario usar diferentes frases mnemot√©cnicas para diferentes monedas. Adem√°s, existe BIP44, que define las reglas para generar claves para diferentes monedas a partir de la misma frase mnem√≥nica. Estas claves privadas no se cruzar√°n entre s√≠, sino que se utilizar√°n para diferentes direcciones de diferentes monedas. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- Diccionario de BIP39, donde se estandarizan 2048 palabras para una frase mnem√≥nica? ¬øPuedo usarlo en todas las billeteras y aplicaciones?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El hecho es que este est√°ndar se describe para BIP39. Es para BIP39 que hay diccionarios: ingl√©s, dos japoneses, chinos, italianos, rusos, ucranianos, etc. Es decir, si alguna aplicaci√≥n afirma que usa BIP39 y permite importar y exportar una frase mnem√≥nica, significa que tambi√©n usa un conjunto de palabras lo mismo Sin embargo, hay billeteras que no usan BIP39, sino su propia modificaci√≥n. Debe mirar la descripci√≥n de la billetera y usar el desarrollo estandarizado o su propio desarrollo o el desarrollo del servicio que ofrece la billetera. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- En los intercambios y almacenes centralizados como Coinbase, ¬ølas claves de billetera para todos los usuarios se generan a partir de la misma frase com√∫n para todos o no?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Es dif√≠cil de decir, porque no abren su estructura interna, pero los nuevos servicios que aparecen pueden generar claves por separado, o usar el est√°ndar BIP32, o usar su versi√≥n modificada. Esos servicios que exist√≠an antes de que aparecieran los est√°ndares para la generaci√≥n de claves jer√°rquicas, muy probablemente, contin√∫an generando claves privadas separadas. Quiz√°s es as√≠ como son m√°s f√°ciles de administrar si hay una gran rotaci√≥n de todas las claves. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"¬øEs la clave un punto en la curva el√≠ptica, es decir, dos n√∫meros muy grandes X e Y?"</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La clave p√∫blica: s√≠, este es un punto en la curva el√≠ptica, y la clave privada es un n√∫mero natural que muestra cu√°ntas veces debe agregarse el punto base. La clave p√∫blica en s√≠ consta de dos valores: estas son las coordenadas X e Y, cada una de las cuales tiene un tama√±o de 256 bits. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ¬øQu√© es "lanzar a punto" y la serializaci√≥n de punto e √≠ndice?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La reducci√≥n a un punto significa que hay un n√∫mero natural, que consideramos como una clave privada. Agregamos el punto base con nosotros tantas veces, es decir, en el grupo de puntos en la curva el√≠ptica, solo se define la operaci√≥n de suma, luego podemos multiplicar el punto por un n√∫mero natural. La serializaci√≥n de un punto significa registrar de cierta manera dos coordenadas. Esto puede ser un registro comprimido, pero no es necesario. Comprimido en el sentido de que una de las coordenadas, a saber, Y se convierte en un signo, luego los datos se sustituyen en la ecuaci√≥n y observa d√≥nde est√° el punto: arriba o abajo. En el caso de la serializaci√≥n de √≠ndice, debe comprender que un n√∫mero regular, que, seg√∫n el tama√±o, se puede escribir en bytes o bits. Cuanto mayor sea el n√∫mero, se necesitar√°n m√°s datos. En el caso de los c√°lculos que examinamos,se requiere un n√∫mero de cierta longitud. Debe serializarlo a una longitud espec√≠fica: 4 bytes. Como resultado, esto se refiere a convertir el √≠ndice a un n√∫mero de 4 bytes. Si los valores superiores permanecen vac√≠os all√≠, ser√°n cero.</font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ¬øA qui√©n se le ocurrieron estos c√°lculos para las funciones de derivaci√≥n de las billeteras HD? ¬øPor qu√© tales f√≥rmulas donde hay justificaciones y donde puedes leer m√°s sobre esto?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Puede leer con mayor precisi√≥n en BIP32, si est√° interesado en una frase mnem√≥nica, luego en BIP39, etc. Puede abrir GitHub y encontrar un usuario con el apodo de Bitcoin. Tiene un repositorio de Bitcoin donde se almacena el c√≥digo fuente de Bitcoin, y tiene un repositorio de BIP (fuente primaria), donde se registran todas las sugerencias para mejorar Bitcoin.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Se les ocurri√≥ la idea de hacer c√°lculos de esta manera, porque est√° vinculada a un grupo de puntos de una curva el√≠ptica. Cuando deseaba lograr una funcionalidad que le permitiera calcular por separado las ramas de las claves p√∫blicas y privadas, manteniendo su correspondencia entre ellas, esta fue la opci√≥n de implementaci√≥n m√°s f√°cil. De hecho, los desarrolladores utilizaron la opci√≥n m√°s simple, que le permite obtener propiedades interesantes utilizando la criptograf√≠a que ha sido probada por el tiempo. Los autores de las mejoras propuestas son muchos. La comunidad de Bitcoin, cuyos participantes ofrecen alg√∫n tipo de desarrollo de mejoras y transformaciones matem√°ticas, es bastante grande. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ¬øLa derivaci√≥n endurecida siempre est√° solo en el segundo nivel de la jerarqu√≠a?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Todo depende de la situaci√≥n. En el caso de generar claves para la firma m√∫ltiple, tiene sentido hacer una derivaci√≥n reforzada solo en el primer nivel de la jerarqu√≠a. En BIP44, la derivaci√≥n endurecida se aplica a los primeros tres niveles: en el primer nivel est√° el n√∫mero del BIP en s√≠, en el segundo est√° el n√∫mero de cuenta donde es relevante, en el tercero est√° el n√∫mero de moneda, donde tambi√©n tiene sentido. Suponga que es poco probable que le guste si publica la clave p√∫blica, y a trav√©s de ella las personas pueden rastrear todas sus direcciones en Bitcoin. Si usa una cuenta para recibir pagos de ciertos servicios, puede revelar esta clave y no necesita derivaci√≥n reforzada aqu√≠. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- ¬øD√≥nde es posible aplicar la generaci√≥n de claves jer√°rquicas?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Puede aplicarlo cuando trabaje con el intercambio para que el intercambio siempre le pague a diferentes direcciones. </font><font style="vertical-align: inherit;">Aunque en este caso es mejor organizar todo esto manualmente. </font><font style="vertical-align: inherit;">Esto es m√°s relevante para las billeteras digitales cotidianas, porque aqu√≠ es un proceso muy simple crear una copia de seguridad de claves privadas y restaurar una billetera. </font><font style="vertical-align: inherit;">Tambi√©n se admite la generaci√≥n de claves para diferentes monedas, y el est√°ndar en s√≠ ya se usa en diferentes implementaciones de billeteras digitales. </font><font style="vertical-align: inherit;">Las claves entre estas billeteras son convenientes para transferir usando la misma frase mnem√≥nica. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Este tema se trata en una de las conferencias del curso en l√≠nea de blockchain " </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Generaci√≥n de claves jer√°rquicas</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ".</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es413627/">https://habr.com/ru/post/es413627/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es413615/index.html">El virus VPNFilter, que infect√≥ 500 mil enrutadores, result√≥ ser a√∫n m√°s peligroso de lo que se pensaba.</a></li>
<li><a href="../es413617/index.html">Cambi√≥ el 30% de los t√©rminos de referencia y super√≥ dos veces el plan: c√≥mo VTB automatiz√≥ los informes</a></li>
<li><a href="../es413619/index.html">Nueva informaci√≥n sobre VPNFilter: realizando un ataque a los dispositivos de los usuarios, ampli√≥ la lista de equipos de red</a></li>
<li><a href="../es413621/index.html">V√≠velo Morir. Resucitar Repetir</a></li>
<li><a href="../es413623/index.html">C√≥mo hacer hablar a Omega 2 o la leyenda de I2S</a></li>
<li><a href="../es413631/index.html">Certificado de cifrado de token en un token en Linux utilizando el ejemplo de JaCarta, Debian y el cliente de correo Evolution</a></li>
<li><a href="../es413633/index.html">C√≥mo domine el ingl√©s</a></li>
<li><a href="../es413635/index.html">Dise√±amos una granja ganadera. ¬øY usar nanoCAD VK?</a></li>
<li><a href="../es413637/index.html">Google public√≥ 7 principios de √©tica de IA</a></li>
<li><a href="../es413639/index.html">Tel√©fonos inteligentes protegidos: ¬øqui√©n lo necesita y en qu√© se diferencian entre s√≠?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>