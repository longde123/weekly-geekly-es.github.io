<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêÑ üòØ üôçüèª Choisir un entrep√¥t de donn√©es pour Prometheus: Thanos vs VictoriaMetrics üöÆ üë©‚Äçüîß ü¶è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous. Vous trouverez ci-dessous une transcription du rapport avec Big Monitoring Meetup 4 . 


 Prometheus est un syst√®me de surveillance de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Choisir un entrep√¥t de donn√©es pour Prometheus: Thanos vs VictoriaMetrics</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482272/"><p>  Bonjour √† tous.  Vous trouverez ci-dessous une transcription du <a href="https://www.youtube.com/watch%3Fv%3DHyOXAdQE0Pk" rel="nofollow">rapport avec Big Monitoring Meetup 4</a> . </p><br><p>  <strong><a href="https://github.com/prometheus" rel="nofollow">Prometheus</a></strong> est un syst√®me de surveillance de divers syst√®mes et services, avec lequel les administrateurs syst√®me peuvent collecter des informations sur les param√®tres actuels des syst√®mes et configurer des alertes pour recevoir des notifications de d√©viations dans le fonctionnement des syst√®mes. </p><br><p>  Le rapport comparera <a href="https://github.com/thanos-io/thanos" rel="nofollow">Thanos</a> et <a href="https://github.com/VictoriaMetrics/VictoriaMetrics" rel="nofollow">VictoriaMetrics</a> , des projets de stockage √† long terme des m√©triques Prometheus. </p><a name="habracut"></a><br><p><img src="https://habrastorage.org/webt/vm/ha/hd/vmhahdu2edj4dsc6o3lvzaf-noo.png"></p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/HyOXAdQE0Pk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p><img src="https://habrastorage.org/webt/op/ni/ao/opniaodpqcis34bw3f4-twdnsic.png"></p><br><p>  Je vais d'abord parler de Prom√©th√©e.  Il s'agit d'un syst√®me de surveillance qui collecte des m√©triques √† partir de cibles donn√©es et les enregistre dans le stockage local.  Prometheus peut √©crire des m√©triques dans un r√©f√©rentiel distant, g√©n√©rer des alertes et des r√®gles d'enregistrement. </p><br><p><img src="https://habrastorage.org/webt/dl/ji/yn/dljiynnywlw3fcjl7oc3m7lgstw.png"></p><br><h3 id="ogranicheniya-prometheus">  Limitations de Prom√©th√©e: </h3><br><ul><li>  Il n'a pas de vue de requ√™te globale.  C'est quand vous avez plusieurs instances ind√©pendantes de prometheus.  Ils collectent des m√©triques.  Et vous voulez faire une demande en plus de toutes ces m√©triques collect√©es √† partir de diff√©rentes instances de prometheus.  Prom√©th√©e ne le permet pas. </li><li>  Avec prometheus, les performances sont limit√©es √† un seul serveur.  Prometheus ne peut pas √©voluer automatiquement sur plusieurs serveurs.  Vous pouvez uniquement diviser manuellement vos cibles entre plusieurs Prometheus. </li><li>  Le volume de m√©triques dans Prometheus est limit√© √† un seul serveur pour la m√™me raison qu'il ne peut pas automatiquement √©voluer vers plusieurs serveurs. </li><li>  Dans Prometheus, il n'est pas si facile d'organiser la s√©curit√© des donn√©es. </li></ul><br><p><img src="https://habrastorage.org/webt/t3/wi/lf/t3wilf2sbn7ndupjqbe1wgxqrzw.png"></p><br><h3 id="resheniya-etih-problemzadach">  R√©soudre ces probl√®mes / d√©fis? </h3><br><p>  Les solutions sont: </p><br><ul><li>  <a href="https://github.com/thanos-io/thanos" rel="nofollow">Thanos</a> </li><li>  <a href="https://github.com/VictoriaMetrics/VictoriaMetrics" rel="nofollow">VictoriaMetrics</a> </li><li>  <a href="https://github.com/m3db" rel="nofollow">Uber m3</a> </li><li>  <a href="https://github.com/cortexproject/cortex" rel="nofollow">Cortex</a> </li></ul><br><p>  Toutes ces solutions de stockage √† distance collect√©es par Prometheus.  Ils r√©solvent le probl√®me de stockage √† distance de la diapositive pr√©c√©dente de diff√©rentes mani√®res.  Dans cette pr√©sentation, je ne parlerai que des deux premi√®res solutions: <a href="https://github.com/thanos-io/thanos" rel="nofollow">Thanos</a> et <a href="https://github.com/VictoriaMetrics/VictoriaMetrics" rel="nofollow">VictoriaMetrics</a> . </p><br><p>  Pour la premi√®re fois, des informations sur <a href="https://github.com/thanos-io/thanos" rel="nofollow">Thanos</a> sont apparues sur <a href="https://improbable.io/blog/thanos-prometheus-at-scale" rel="nofollow">ce lien</a> .  Il d√©crit l'architecture de <a href="https://github.com/thanos-io/thanos" rel="nofollow">Thanos</a> et son fonctionnement. </p><br><p><img src="https://habrastorage.org/webt/wg/bq/-b/wgbq-b3pwr1emeewan-q5hszprs.png"></p><br><p>  Thanos prend les donn√©es que Prometheus a enregistr√©es sur le disque local et les copie sur S3, sur <a href="https://cloud.google.com/storage/" rel="nofollow">GCS</a> ou sur un autre stockage d'objets. </p><br><p><img src="https://habrastorage.org/webt/p7/4g/rj/p74grj159fi9xb58vq-hphcrqyi.png"></p><br><p>  De cette fa√ßon, Thanos fournit une vue de requ√™te globale.  Vous pouvez demander des donn√©es stock√©es dans le stockage d'objets √† partir de plusieurs instances de Prometheus. </p><br><p><img src="https://habrastorage.org/webt/aj/3u/wi/aj3uwi8dd4wgy-fyogditn--kek.png"></p><br><p>  Thanos prend en charge PromQL et l' <a href="https://prometheus.io/docs/prometheus/latest/querying/api/" rel="nofollow">API d'interrogation Prometheus</a> . </p><br><p><img src="https://habrastorage.org/webt/sr/t7/ql/srt7qlyoruhbxr5wglfuyhi9jp4.png"></p><br><p>  Thanos utilise le code Prometheus pour stocker des donn√©es. </p><br><p><img src="https://habrastorage.org/webt/3y/ws/ik/3ywsiklzziqimz1aig7uzieblqw.png"></p><br><p>  Thanos est d√©velopp√© par les m√™mes d√©veloppeurs que Prometheus. </p><br><p>  √Ä propos de <a href="https://github.com/VictoriaMetrics/VictoriaMetrics" rel="nofollow">VictoriaMetrics</a> .  Voici le <a href="https://medium.com/faun/victoriametrics-creating-the-best-remote-storage-for-prometheus-5d92d66787ac" rel="nofollow">lien</a> o√π nous avons parl√© pour la premi√®re fois de <a href="https://github.com/VictoriaMetrics/VictoriaMetrics" rel="nofollow">VictoriaMetrics</a> . </p><br><p><img src="https://habrastorage.org/webt/z9/q2/wv/z9q2wvhshsoqb1ron0jx47djiwc.png"></p><br><p>  VictoriaMetrics re√ßoit des donn√©es de plusieurs prometheus via le protocole <a href="https://prometheus.io/docs/practices/remote_write/" rel="nofollow">API d'√©criture √† distance</a> pris en charge par Prometheus. </p><br><p><img src="https://habrastorage.org/webt/pl/xl/ad/plxladg1rdvyudc0wzs5oc2ljsa.png"></p><br><p>  VictoriaMetrics fournit une vue de requ√™te globale, car plusieurs instances de Prometheus peuvent √©crire des donn√©es sur un VictoriaMetrics.  En cons√©quence, vous pouvez demander toutes ces donn√©es. </p><br><p><img src="https://habrastorage.org/webt/9l/cp/aw/9lcpawp68_pq2mrhzya9okprroy.png"></p><br><p>  VictoriaMetrics prend √©galement en charge, comme Thanos, PromQL et l'API d'interrogation Prometheus. </p><br><p><img src="https://habrastorage.org/webt/d1/t1/ek/d1t1ek9rbq_ftlasl48scoriyq0.png"></p><br><p>  Contrairement √† Thanos, le code source de VictoriaMetrics est √©crit √† partir de z√©ro et optimis√© pour la vitesse et les ressources. </p><br><p><img src="https://habrastorage.org/webt/ps/t6/gu/pst6guuoseu2dicx9tra1bvjhry.png"></p><br><p>  Contrairement √† Thanos, VictoriaMetrics √©volue verticalement et horizontalement.  Il existe une <a href="" rel="nofollow">version √† n≈ìud unique</a> qui √©volue verticalement.  Vous pouvez commencer avec un processeur et 1 Go de m√©moire et passer progressivement √† des centaines de processeurs et 1 To de m√©moire.  VictoriaMetrics peut utiliser toutes ces ressources.  Ses performances augmenteront d'environ 100 fois par rapport √† un syst√®me monoc≈ìur. </p><br><p><img src="https://habrastorage.org/webt/tb/s7/t4/tbs7t4unnruaytt7duwambgofne.png"></p><br><p>  L'histoire de Thanos a commenc√© en novembre 2017, lorsque le premier engagement public est apparu.  Avant cela, Thanos a √©t√© d√©velopp√© en interne par <a href="https://improbable.io/" rel="nofollow">improbable.io</a> . </p><br><p><img src="https://habrastorage.org/webt/ik/g7/dg/ikg7dgnmbyiph40zo7v7kyhxrdy.png"></p><br><p>  En juin 2019, il y a eu une version historique 0.5.0, dans laquelle le protocole <a href="https://en.wikipedia.org/wiki/Gossip_protocol" rel="nofollow">Gossip a</a> √©t√© <a href="https://thanos.io/proposals/201809_gossip-removal.md/" rel="nofollow">supprim√©</a> .  Il a √©t√© retir√© de Thanos parce qu'il n'a pas fait de son mieux.  Souvent, le cluster Thanos ne fonctionnait pas correctement, les n≈ìuds y √©tant mal connect√©s en raison du protocole Gossip.  Par cons√©quent, ils ont d√©cid√© de le retirer de l√†.  Je pense que c'est la bonne d√©cision. </p><br><p><img src="https://habrastorage.org/webt/5y/bu/cu/5ybucuovkh85tqwsrv3cjre-zmu.png"></p><br><p>  Toujours en juin 2019, ils ont envoy√© la demande num√©ro <a href="https://github.com/cncf/toc/pull/256" rel="nofollow">256</a> √† la <a href="https://www.cncf.io/" rel="nofollow">Cloud Native Computing Foundation</a> . </p><br><p><img src="https://habrastorage.org/webt/16/rz/x_/16rzx_bswddquoqw4cmw9txobxa.png"></p><br><p>  Et apr√®s quelques mois, Thanos a rejoint la <a href="https://www.cncf.io/" rel="nofollow">Cloud Native Computing Foundation</a> , qui comprend Prometheus, Kubernetes et d'autres projets populaires. </p><br><p><img src="https://habrastorage.org/webt/9c/i2/ic/9ci2ictg_n0xtgdcxtklghw4n2w.png"></p><br><p>  En janvier 2018, le d√©veloppement de VictoriaMetrics a commenc√©. </p><br><p><img src="https://habrastorage.org/webt/wi/li/co/wiliconuw5mwhyzizzthqk8a2og.png"></p><br><p>  En septembre 2018, j'ai mentionn√© publiquement VictoriaMetrics pour la premi√®re fois. </p><br><p><img src="https://habrastorage.org/webt/gd/th/ka/gdthkaxubi8jzg8gedilcotjdje.png"></p><br><p>  En d√©cembre 2018, la version √† n≈ìud unique a √©t√© publi√©e. </p><br><p><img src="https://habrastorage.org/webt/ui/r7/23/uir723wmd-l1dwxds6katr8cfco.png"></p><br><p>  En mai 2019 <a href="https://blog.usejournal.com/open-sourcing-victoriametrics-f31e34485c2b" rel="nofollow">, les</a> sources de la version √† n≈ìud unique et de la version en cluster <a href="https://blog.usejournal.com/open-sourcing-victoriametrics-f31e34485c2b" rel="nofollow">ont √©t√© publi√©es</a> . </p><br><p><img src="https://habrastorage.org/webt/a7/tk/ug/a7tkughz1ut9dmlfb6ued1irbh8.png"></p><br><p>  En juin 2019, comme Thanos, nous avons d√©pos√© une demande aupr√®s de la fondation CNCF au num√©ro <a href="https://github.com/cncf/toc/pull/255" rel="nofollow">255</a> .  Nous avons postul√© un jour avant la candidature de Thanos. </p><br><p><img src="https://habrastorage.org/webt/pk/dm/zr/pkdmzr2xn880osldinx6sb10-ai.png"></p><br><p>  Mais, malheureusement, nous n'y sommes toujours pas accept√©s.  Besoin d'aide de la communaut√©. </p><br><p><img src="https://habrastorage.org/webt/mw/2w/we/mw2wwenfu8tecrrkyrkx-8dhf-8.png"></p><br><p>  Consid√©rez les diapositives les plus importantes montrant l'architecture de Thanos et VictoriaMetrics. </p><br><p><img src="https://habrastorage.org/webt/1w/by/96/1wby96ev7cqhx7-psbem1b-bf-i.png"></p><br><p>  Commen√ßons par Thanos.  Les composants jaunes sont des composants Prometheus.  Tout le reste, ce sont les composants de Thanos.  Commen√ßons par le composant le plus important.  Thanos Sidecar est un composant install√© √† c√¥t√© de chaque Prom√©th√©e.  Il s'engage √† charger les donn√©es Prometheus du stockage local dans S3 ou dans un autre stockage d'objets. </p><br><p>  Il existe √©galement un composant tel que Thanos Store Gateway, qui peut lire ces donn√©es √† partir du stockage d'objets sur les demandes entrantes de Thanos Query.  Thanos Query impl√©mente PromQL et l'API Prometheus.  Autrement dit, de l'ext√©rieur, il ressemble √† un Prom√©th√©e.  Il accepte les requ√™tes PromQL, les envoie √† Thanos Store Gateway, Thanos Store Gateway r√©cup√®re les donn√©es n√©cessaires du stockage d'objets, les renvoie. </p><br><p>  Mais nous avons stock√© des donn√©es dans Object Storage sans les deux derni√®res heures en raison de la particularit√© de l'impl√©mentation de Thanos Sidecar, qui ne peut pas t√©l√©charger les deux derni√®res heures vers Object Storage S3, car pendant ces deux heures, Prometheus n'a pas encore cr√©√© de fichiers dans le stockage local. </p><br><p>  Comment ont-ils d√©cid√© de contourner cela?  Thanos Query, en plus des demandes de Thanos Store Gateway, envoie des demandes parall√®les √† chaque Thanos Sidecar situ√© √† c√¥t√© de Prometheus. </p><br><p>  Et Thanos Sidecar, √† son tour, proc√®de √† des requ√™tes suppl√©mentaires dans Prometheus et obtient des donn√©es pour les deux derni√®res heures. </p><br><p>  En plus de ces composants, il existe √©galement un composant optionnel sans lequel Thanos ne se sentira pas bien.  Il s'agit de Thanos Compact, qui fusionne de petits fichiers sur le stockage d'objets dans des fichiers plus gros qui ont √©t√© t√©l√©charg√©s ici par Thanos Sidecar.  Thanos Sidecar y t√©l√©charge des fichiers de donn√©es en deux heures.  Ces fichiers, si vous ne les fusionnez pas en fichiers plus volumineux, leur nombre peut augmenter de mani√®re tr√®s significative.  Plus ces fichiers sont nombreux, plus il faut de m√©moire pour Thanos Store Gateway, plus il faut de ressources pour transf√©rer des donn√©es sur le r√©seau, des m√©tadonn√©es.  Thanos Store Gateway devient inefficace.  Par cons√©quent, vous devez absolument ex√©cuter Thanos Compact, qui fusionne les petits fichiers en plus gros afin qu'il y ait moins de tels fichiers et pour r√©duire la surcharge sur Thanos Store Gateway. </p><br><p>  Il existe √©galement un composant tel que la r√®gle de Thanos.  Il suit les r√®gles d'alerte Prometheus et peut calculer les r√®gles d'enregistrement Prometheus afin de r√©√©crire les donn√©es dans Object Storage.  Mais ce composant n'est pas recommand√©, car  il est <a href="" rel="nofollow">enclin √† renvoyer des donn√©es incompl√®tes</a> . </p><br><p>  Il s'agit d'un sch√©ma simple pour Thanos. </p><br><p><img src="https://habrastorage.org/webt/os/em/y4/osemy4ys_bkpy-ngxj7jg-gdmom.png"></p><br><p>  Comparez maintenant avec le sch√©ma VictoriaMetrics. </p><br><p>  VictoriaMetrics a 2 versions: version √† n≈ìud unique et en cluster.  Un n≈ìud unique s'ex√©cute sur un seul ordinateur.  Un seul n≈ìud n'a pas ces composants, juste un binaire.  Ce binaire sur la diapositive ressemble √† ce carr√©.  Tout ce qui se trouve √† l'int√©rieur du carr√© est le contenu du fichier binaire pour la version √† n≈ìud unique.  Vous n'avez pas besoin de le conna√Ætre.  Commencez simplement le binaire - et tout fonctionne pour nous. </p><br><p>  La version cluster est plus compliqu√©e.  √Ä l'int√©rieur, il y a trois composants diff√©rents: vmselect, vminsert et vmstorage.  D'apr√®s leur nom, il devrait √™tre clair ce que chacun d'eux fait.  Le composant Insert accepte des donn√©es dans diff√©rents formats: √† partir de l'API d'√©criture √† distance Prometheus, du protocole de ligne Influx, du protocole Graphite et du protocole OpenTSDB.  Le composant Ins√©rer les accepte, les analyse et les distribue entre les composants de stockage existants, o√π les donn√©es sont d√©j√† stock√©es.  Le composant Select, √† son tour, accepte les requ√™tes PromQL.  Il impl√©mente <a href="https://medium.com/%40valyala/promql-tutorial-for-beginners-9ab455142085" rel="nofollow">PromQL</a> ainsi que l'API d'interrogation Prometheus et peut √™tre utilis√© en remplacement de Prometheus dans Grafana ou d'autres clients API Prometheus.  Select accepte une demande promql, l'analyse, lit les donn√©es n√©cessaires pour ex√©cuter cette demande √† partir du n≈ìud de stockage, traite ces donn√©es et renvoie une r√©ponse. </p><br><p><img src="https://habrastorage.org/webt/sb/co/mx/sbcomx2usdrwzbyfgqjubvoichg.png"></p><br><p>  Comparez la difficult√© d'installation de Thanos et de VictoriaMetrics. </p><br><p><img src="https://habrastorage.org/webt/hv/gw/r6/hvgwr6nk7yh4nog7rpjac4fn0se.png"></p><br><p>  Commen√ßons par Thanos.  Avant de commencer √† travailler avec Thanos, vous devez cr√©er un compartiment dans le stockage d'objets, tel que S3 ou GCS, afin que Thanos Sidecar puisse y √©crire des donn√©es. </p><br><p><img src="https://habrastorage.org/webt/st/hk/5s/sthk5swss1mkaalb4p3oiebnesq.png"></p><br><p>  Ensuite, pour chaque Prometheus, vous devez installer Thanos Sidecar.  Avant cela, vous devez vous rappeler de d√©sactiver le compactage des donn√©es dans Prometheus.  Le compactage des donn√©es comprime p√©riodiquement les donn√©es dans le stockage local Prometheus afin de r√©duire la consommation de ressources. </p><br><p>  Lorsque vous installez Thanos Sidecar sur votre Prometheus, vous devez d√©sactiver ce compactage des donn√©es, car Thanos Sidecar ne peut pas fonctionner normalement lorsque le compactage des donn√©es est activ√©.  Cela signifie que votre Prometheus commence √† enregistrer les donn√©es en blocs de deux heures et cesse de fusionner ces blocs en blocs plus grands.  Par cons√©quent, si vous effectuez des requ√™tes plus longues que les deux derni√®res heures, elles ne fonctionneront pas aussi efficacement qu'elles le pourraient si le compactage des donn√©es √©tait activ√©. </p><br><p><img src="https://habrastorage.org/webt/gd/as/pw/gdaspwys_r63cegoxqovl9bcmie.png"></p><br><p>  Par cons√©quent, Thanos recommande de r√©duire le temps de r√©tention des donn√©es dans le stockage local √† 6-8 heures afin de r√©duire cette surcharge d'un grand nombre de petits blocs. </p><br><p>  Apr√®s avoir install√© Thanos Sidecar, vous devez installer deux composants pour chaque compartiment de stockage d'objets.  Ce sont Thanos Compactor et Thanos Store Gateway. </p><br><p><img src="https://habrastorage.org/webt/cw/4f/yk/cw4fyksvnkmp1tcn-clf-2gzx3q.png"></p><br><p>  Apr√®s cela, vous devez installer Thanos Query et le configurer pour qu'il sache comment se connecter √† tous les Thanos Store Gateway que vous avez, et sait √©galement comment se connecter √† tous les Thanos Sidecar. </p><br><p>  Il peut y avoir un petit probl√®me. </p><br><p><img src="https://habrastorage.org/webt/vf/sc/30/vfsc30z00pvcnupbdym2jztx09k.png"></p><br><p>  Vous devez configurer une connexion fiable et s√©curis√©e entre Thanos Query et ces composants.  Et si vos Prometheus sont situ√©s dans diff√©rents centres de donn√©es ou dans diff√©rents VPC, les connexions externes √† ces derniers sont interdites.  Mais pour que Thanos Query fonctionne, vous devez en quelque sorte configurer la connexion l√†-bas, et vous devez trouver un moyen. </p><br><p>  Si vous disposez d'un grand nombre de ces centres de donn√©es, la fiabilit√© de l'ensemble du syst√®me diminue en cons√©quence.  √âtant donn√© que Thanos Query doit rester connect√© en permanence √† tous les Sidos Sidos situ√©s dans diff√©rents centres de donn√©es.  Avec chaque demande entrante, il transmettra les demandes √† tous les Sidos Sidos.  Si la connexion est interrompue, vous recevrez soit un ensemble de donn√©es incomplet, soit vous obtiendrez la r√©ponse ¬´le cluster ne fonctionne pas¬ª. </p><br><p><img src="https://habrastorage.org/webt/rb/ka/aw/rbkaawevhardp1d85mhgdejylxg.png"></p><br><p>  Dans VictoriaMetrics, les choses sont un peu plus faciles.  Pour la version √† n≈ìud unique, il suffit d'ex√©cuter un seul binaire et tout fonctionne. </p><br><p><img src="https://habrastorage.org/webt/co/ui/ll/couillafhtmobnbutejgs6qvszu.png"></p><br><p>  Dans une version en cluster, il suffit d'ex√©cuter les trois types de composants ci-dessus dans la quantit√© dont vous avez besoin, ou d'utiliser le <a href="https://github.com/VictoriaMetrics/helm-charts/" rel="nofollow">graphique de barre</a> pour automatiser le lancement de composants dans Kubernetes.  Nous pr√©voyons toujours de faire un op√©rateur Kubernetes.  Le graphique du casque ne couvre pas certains cas et vous permet de tirer sur votre jambe.  Par exemple, il vous permet de r√©duire le nombre de n≈ìuds de stockage, ce qui entra√Ænera une perte de donn√©es. </p><br><p><img src="https://habrastorage.org/webt/jb/ta/0t/jbta0t7qcko6jov_x1ximqkfni0.png"></p><br><p>  Apr√®s avoir ex√©cut√© une version binaire ou de cluster, il vous suffit d'ajouter le <a href="" rel="nofollow">param√®tre d'URL d'√©criture √† distance</a> √† la configuration Prometheus afin qu'il commence √† √©crire des donn√©es en parall√®le au stockage local et au stockage distant.  Comme vous l'avez remarqu√©, cette configuration devrait fonctionner de mani√®re beaucoup plus fiable par rapport √† la configuration de Thanos.  Nous n'avons pas besoin de garder VictoriaMetrics connect√© √† tous les Prometheus, car les Prometheus eux-m√™mes se connectent √† VictoriaMetrics et transmettent les donn√©es. </p><br><p><img src="https://habrastorage.org/webt/u3/3a/if/u33aifuu7myx3vvs0mkbeysfnei.png"></p><br><p>  Consid√©rez les escortes Thanos et VictoriaMetrics. </p><br><p><img src="https://habrastorage.org/webt/fq/dt/d2/fqdtd27cjx-yktnyozgxoon2pte.png"></p><br><p>  Thanos doit garder un ≈ìil sur Sidecar afin qu'il n'arr√™te pas de charger des donn√©es dans Object Storage.  Ils peuvent arr√™ter ce chargement de donn√©es en raison d'erreurs de chargement, par exemple, votre connexion r√©seau avec Object Storage est temporairement d√©connect√©e ou Object Storage est temporairement indisponible.  Thanos Sidecar le remarquera en ce moment, signalera une erreur, pourrait tomber et cesser de fonctionner.  Si vous ne le surveillez pas, vos donn√©es ne seront plus transf√©r√©es vers Object Storage.  Si le temps de r√©tention passe (6-8 heures recommand√©es), vous perdrez des donn√©es qui ne sont pas tomb√©es dans Object Storage. </p><br><p><img src="https://habrastorage.org/webt/z7/bm/cx/z7bmcxgwyscnrnnehhtjvuqipho.png"></p><br><p>  Les compacteurs Thanos peuvent cesser de fonctionner en raison de la <a href="https://github.com/thanos-io/thanos/issues/1919" rel="nofollow">course avec Sidecar</a> .  Les compacteurs prennent les donn√©es d'Object Storage et les fusionnent en de plus gros morceaux de donn√©es.  Comme les compacteurs ne sont pas synchronis√©s avec le Sidecar, cela peut arriver: Sidecar n'a pas encore fini d'√©crire le bloc, Compactor d√©cide que ce bloc est compl√®tement enregistr√©.  Le compacteur commence √† le lire.  Il ne lit pas le bloc dans son int√©gralit√© et cesse de fonctionner.  Voir les d√©tails <a href="https://thanos.io/proposals/201901-read-write-operations-bucket.md/" rel="nofollow">ici</a> . </p><br><p><img src="https://habrastorage.org/webt/_u/c6/hb/_uc6hbgr_kl9l2an5yl0cs9hfba.png"></p><br><p>  Store Gateway peut fournir des donn√©es incoh√©rentes en raison de la course entre Compactor et Sidecar.  C'est la m√™me chose, car le Store Gateway n'est en aucun cas synchronis√© avec Compactor et Sidecar.  Par cons√©quent, une condition de concurrence critique peut se produire lorsque la passerelle de stockage ne voit pas une partie des donn√©es ou voit des donn√©es en exc√®s. </p><br><p><img src="https://habrastorage.org/webt/-y/20/ur/-y20urze7qgwxkrklj8ave_ct3i.png"></p><br><p>  Le composant Query dans Thanos utilise par d√©faut des r√©sultats partiels si certains Sidecar ou Store Gateway ne sont pas actuellement disponibles.  Vous recevrez une partie des donn√©es et vous ne saurez m√™me pas que toutes les donn√©es n'ont pas √©t√© re√ßues.  Que cela fonctionne comme √ßa par d√©faut.  Dans une situation similaire, VictoriaMetrics renvoie les donn√©es marqu√©es comme partielles. </p><br><p><img src="https://habrastorage.org/webt/2g/op/wp/2gopwpbh41vviugdebarsjuql4w.png"></p><br><p>  Contrairement √† Thanos, VictoriaMetrics perd rarement des donn√©es.  M√™me si la connexion de Prometheus √† VictoriaMetrics est interrompue, ce n'est pas un probl√®me, car Prometheus continue d'enregistrer les nouvelles donn√©es entrantes dans Write Ahead Log, qui a une taille de 2 heures.  Si vous vous reconnectez √† VictoriaMetrics dans les deux heures, les donn√©es ne seront pas perdues.  Prometheus <a href="https://grafana.com/blog/2019/03/25/whats-new-in-prometheus-2.8-wal-based-remote-write/" rel="nofollow">peut ajouter des donn√©es apr√®s une reconnexion √† VictoriaMetrics</a> . </p><br><p><img src="https://habrastorage.org/webt/kg/nl/mv/kgnlmvkqxfagsjhodoybpwzl7am.png"></p><br><p>  Contrairement √† Thanos, qui n'√©crit les donn√©es dans le stockage d'objets qu'apr√®s deux heures, Prometheus r√©plique automatiquement les donn√©es via le protocole d'√©criture √† distance vers le stockage √† distance, comme VictoriaMetrics.  Vous n'avez pas peur de perdre le stockage local dans Prometheus.  S'il a soudainement perdu le stockage local, dans le pire des cas, vous perdrez les derni√®res secondes de donn√©es qui n'ont pas eu le temps d'√©crire sur le stockage distant. </p><br><p><img src="https://habrastorage.org/webt/ba/xj/90/baxj90beqmojti9xkubodbkbvdw.png"></p><br><p>  Kubernetes g√®re automatiquement le cluster, contrairement √† Thanos.  Tous les composants Thanos sont difficiles √† mettre dans un seul cluster Kubernetes, contrairement aux composants du cluster VictoriaMetrics. </p><br><p><img src="https://habrastorage.org/webt/gz/lb/6l/gzlb6lg2dkrabcovqcohvovd-mk.png"></p><br><p>  VictoriaMetrics propose une mise √† niveau tr√®s simple vers la nouvelle version.  Arr√™tez simplement VictoriaMetrics, mettez √† jour les fichiers binaires et ex√©cutez.  Lors de l'arr√™t via un signal SIGINT, tous les binaires VictoriaMetrics effectuent un arr√™t gracieux.  Ils enregistrent correctement les donn√©es n√©cessaires, ferment correctement les connexions entrantes afin de ne rien perdre.  Par cons√©quent, vous ne perdrez rien lors de la mise √† niveau. </p><br><p><img src="https://habrastorage.org/webt/qz/yf/8c/qzyf8cvpqlimwabno0zx7v5_rxw.png"></p><br><p>  VictoriaMetrics propose un moyen tr√®s simple de d√©velopper un cluster.  Ajoutez simplement les composants n√©cessaires et continuez √† travailler. </p><br><p><img src="https://habrastorage.org/webt/hl/le/sj/hllesjwiv-f1wosgssd7wp6aclo.png"></p><br><p>  √Ä propos des pi√®ges de Thanos et Victoria Metrics. </p><br><p><img src="https://habrastorage.org/webt/xs/ec/b0/xsecb0yy15vimtsl9k9quqplyiw.png"></p><br><p>  Thanos a les pi√®ges suivants.  Prometheus doit stocker les donn√©es des deux derni√®res heures.  S'ils sont perdus, vous les perdrez compl√®tement, car ils n'ont pas encore r√©ussi √† s'enregistrer dans Object Storage, comme S3. </p><br><p><img src="https://habrastorage.org/webt/fg/xo/yo/fgxoyo1q8mihcdy7m_yyio_pyum.png"></p><br><p>  Le composant Store Gateway et le composant compacteur peuvent n√©cessiter beaucoup de m√©moire pour fonctionner avec un stockage d'objets volumineux si de nombreux petits fichiers y sont stock√©s.  Plus le nombre et le volume de fichiers sont importants, plus la passerelle de stockage et la m√©moire du compacteur sont n√©cessaires pour stocker des m√©ta-informations.  Thanos a beaucoup de probl√®mes avec la <a href="https://github.com/thanos-io/thanos/issues/448" rel="nofollow">perte de la passerelle de stockage et du compacteur avec des donn√©es enregistr√©es moyennes</a> . </p><br><p><img src="https://habrastorage.org/webt/-n/k3/rg/-nk3rgph8ghszyegz1j8jx89bio.png"></p><br><p>  Thanos est vant√© qu'il peut √©voluer ind√©finiment en fonction de la quantit√© de votre Prom√©th√©e.  Ce n'est en fait pas vrai.  √âtant donn√© que toutes les demandes passent par le composant Query, qui doit interroger simultan√©ment tous les composants Store Gateway et tous les composants Sidecar, extraire les donn√©es √† partir de l√†, puis les pr√©traiter.  De toute √©vidence, la vitesse de requ√™te est limit√©e par le maillon faible le plus lent, la passerelle de magasin la plus lente ou le Sidecar le plus lent. </p><br><p>  Ces composants peuvent √™tre in√©galement charg√©s.  Par exemple, vous avez un Prom√©th√©e qui collecte des millions de m√©triques par seconde.  Et il y a Prometheus, qui collecte des milliers de m√©triques par seconde.  Prometheus, qui collecte des millions de m√©triques par seconde, charge bien plus le serveur sur lequel il s'ex√©cute.  En cons√©quence, Sidecar y est plus lent.  En g√©n√©ral, tout y fonctionne lentement.  Et le composant Query extraira les donn√©es tr√®s lentement √† partir de l√†.  En cons√©quence, les performances de l'ensemble de votre cluster seront limit√©es par ce lent Sidecar. </p><br><p><img src="https://habrastorage.org/webt/mg/an/ra/mganracsmhkyz1_1aq014v_6cfc.png"></p><br><p>  Par d√©faut, Thanos renvoie des donn√©es partielles si certains Sidecar et Store Gateway ne sont pas disponibles.  Par exemple, si Sidecar est dispers√© dans le monde entier dans diff√©rents centres de donn√©es, la probabilit√© de d√©connexion et d'indisponibilit√© des composants augmente consid√©rablement.  En cons√©quence, dans la plupart des cas, vous recevrez des donn√©es partielles sans m√™me le savoir. </p><br><p><img src="https://habrastorage.org/webt/1t/m2/j7/1tm2j75o5cpscbevahbz4m0wusk.png"></p><br><p>  VictoriaMetrics a √©galement des pi√®ges.  Le premier √©cueil est une option qui limite la quantit√© de RAM utilis√©e pour le cache VictoriaMetrics.  Par d√©faut, il est √©gal √† 60% de la RAM sur la machine sur laquelle VictoriaMetrics s'ex√©cute, ou 60% de la RAM du pod VictoriaMetrics dans Kubernetes. </p><br><p>  Si vous modifiez incorrectement cette valeur, vous pouvez ruiner les performances de VictoriaMetrics.  Par exemple, si vous d√©finissez une valeur trop faible, les donn√©es risquent de ne plus tenir dans le cache VictoriaMetrics.  Pour cette raison, elle devra faire un travail suppl√©mentaire et charger le processeur avec le disque.  Si vous rendez cette option trop grande, cela augmente, d'une part, la probabilit√© que VictoriaMetrics se bloque avec une erreur de m√©moire insuffisante, et, d'autre part, cela entra√Ænera tr√®s peu de m√©moire op√©rationnelle dans le syst√®me d'exploitation. m√©moire pour le cache de fichiers.  Et VictoriaMetrics s'appuie sur un cache de fichiers pour les performances.  Si cela ne suffit pas, la charge sur le disque peut augmenter consid√©rablement.  Par cons√©quent, un conseil: ne modifiez pas le param√®tre √† moins que cela ne soit absolument n√©cessaire. </p><br><p><img src="https://habrastorage.org/webt/3q/eo/25/3qeo25x5juqpyquhllrhpt9eh34.png"></p><br><p>  La deuxi√®me option.  Il s'agit de retentionPeriod - la p√©riode d√©finie sur 1 mois par d√©faut.  C'est le moment o√π VictoriaMetrics stocke les donn√©es.  Apr√®s cette p√©riode, VictoriaMetrics supprime les donn√©es. </p><br><p>  Beaucoup ex√©cutent VictoriaMetrics sans ce param√®tre, ils enregistrent des donn√©es pendant un mois.  Et puis ils demandent: pourquoi les donn√©es ont-elles disparu pour le mois pr√©c√©dent?  Parce que retentionPeriod est de 1 mois par d√©faut.  Par cons√©quent, vous devez conna√Ætre et d√©finir la p√©riode de r√©tention correcte. </p><br><p><img src="https://habrastorage.org/webt/n1/5a/jm/n15ajmeqozq7zfzc0uv3imzfebw.png"></p><br><p>  Passons en revue les opportunit√©s uniques. </p><br><p><img src="https://habrastorage.org/webt/k8/b7/br/k8b7brhqxwy1fa1vdurx0yolgra.png"></p><br><p>  Thanos a une fonctionnalit√© telle que le sous-√©chantillonnage: intervalles de 5 minutes et heures, qui souvent ne <a href="https://github.com/thanos-io/thanos/issues%3Futf8%3D%25E2%259C%2593%26q%3Dis%253Aissue%2Bis%253Aopen%2Bdownsampling" rel="nofollow">fonctionnent pas correctement</a> .  Si vous le recherchez sur Google et examinez leur probl√®me sur github, il y a beaucoup de probl√®mes li√©s √† ce sous-√©chantillonnage, qui parfois ne fonctionnent pas correctement ou ne fonctionnent pas comme les utilisateurs s'y attendent. </p><br><p><img src="https://habrastorage.org/webt/iv/nq/4v/ivnq4vtxkkwf_1hs40ttkyhd1ie.png"></p><br><p>  Thanos propose la d√©duplication des donn√©es pour les paires Prometheus HA.  Lorsque deux Prometheus'a collectent les m√™mes m√©triques de la m√™me cible'et Thanos les place dans le stockage d'objets. Thanos     ,    VictoriaMetrics. </p><br><p><img src="https://habrastorage.org/webt/wn/rv/jh/wnrvjhzqrcx6_o9hoojijeivb8o.png"></p><br><p>  Thanos  alert ,     Thanos.   <a href="" rel="nofollow">    production</a> . </p><br><p><img src="https://habrastorage.org/webt/ti/qp/ci/tiqpcidg_t_ahj9lornrey8_rda.png"></p><br><p>  Thanos ,    Thanos   Prometheus ‚Äî . Thanos  Prometheus      .    Thanos  Prometheus   . </p><br><p><img src="https://habrastorage.org/webt/en/vo/o-/envoo-2amya3w4xo2c5lg-pa1bo.png"></p><br><p>  VictoriaMetrics    ‚Äî MetricsQL.   VictoriaMetrics  PromQL,       big monitoring metup. </p><br><p><img src="https://habrastorage.org/webt/yk/xq/hi/ykxqhipgapygdv7ra2c6rmaitnk.png"></p><br><p> VictoriaMetrics       . VictoriaMetrics       Prometheus,     Influx, OpenTSDB  Graphite. </p><br><p><img src="https://habrastorage.org/webt/0k/zy/jp/0kzyjptb5sbscny1ffsdh2irqau.png"></p><br><p>  VictoriaMetrics         Thanos  Prometheus. </p><br><p>    ,     2-5          Prometheus  Thanos. </p><br><p><img src="https://habrastorage.org/webt/2y/xz/yg/2yxzygpbfnqt3ldibpggeo35rpw.png"></p><br><p>    VictoriaMetrics ‚Äî    . </p><br><p><img src="https://habrastorage.org/webt/kk/jd/hy/kkjdhy-zae6bc_3uqu6yp3q1gwy.png"></p><br><p>    . </p><br><p><img src="https://habrastorage.org/webt/79/yz/yw/79yzywujo1uxm6zc5rti6ebjzpq.png"></p><br><p>    Thanos  ,      object storage,   . </p><br><p>     object storage,         ($10   ).      object storage,          ,       AWS ‚Äî  .    ,    $10  $230  1.    ,        Thanos . </p><br><p><img src="https://habrastorage.org/webt/eg/--/mv/eg--mv_wpjcv4m-tojp8l9r60ea.png"></p><br><p>  Thanos      Compact, Store Gateway, Query ,    ,     . </p><br><p><img src="https://habrastorage.org/webt/pz/0v/np/pz0vnpflfebkxmaqi3sbbucktz0.png"></p><br><p>  VictoriaMetrics  .     GCE HDD ,   $40  1.  VictoriaMetrics   HDD ,    SSD,      . VictoriaMetrics   HDD. </p><br><p><img src="https://habrastorage.org/webt/dr/6q/lz/dr6qlzowqew8et2zpev1wkrq4cs.png"></p><br><p> VictoriaMetrics a besoin de serveurs pour les composants: Single-nod ou pour les composants de cluster, qui, contrairement aux composants de Thanos, n√©cessitent beaucoup moins de CPU, de RAM - ce sera moins cher en cons√©quence. </p><br><p><img src="https://habrastorage.org/webt/ja/72/cr/ja72crhogqpdixrt8jzj-komdcq.png"></p><br><p>  Exemples de mise en ≈ìuvre. </p><br><p><img src="https://habrastorage.org/webt/od/ji/fw/odjifwunkpjdwuqq-hbpwswu_cy.png"></p><br><p>  L'exemple d'impl√©mentation de Thanos est Gitlab.  Gitlab est enti√®rement propuls√© par Thanos.  Mais il n'y a pas si lisse.  Si vous regardez leurs <a href="https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8647" rel="nofollow">probl√®mes</a> , vous pouvez voir qu'ils ont constamment des <a href="https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8413" rel="nofollow">probl√®mes</a> de <a href="https://gitlab.com/gitlab-com/gl-infra/infrastructure/issues/8413" rel="nofollow">fonctionnement avec Thanos</a> : il n'y a pas assez de m√©moire pour les composants Store Gateway ou Query.  Ils doivent constamment augmenter la quantit√© de m√©moire. </p><br><p>  De ce fait, les co√ªts de r√©solution de ces probl√®mes augmentent. </p><br><p>  La deuxi√®me impl√©mentation, qui peut √™tre plus r√©ussie, est la soci√©t√© Improbable, qui a commenc√© le d√©veloppement de Thanos.  Ils ont publi√© la source de Thanos.  Improbable est une entreprise qui d√©veloppe des moteurs de jeux. </p><br><p><img src="https://habrastorage.org/webt/t4/yh/y4/t4yhy4gyfrimyzyfopgdwk1ixyc.png"></p><br><p>  Exemples de mise en ≈ìuvre publique de VictoriaMetrics: </p><br><ul><li>  Constructeur de site wix.com </li><li>  Adidas pr√©sente VictoriaMetrics et a m√™me fait une pr√©sentation lors du dernier PromCon 2019 </li><li>  TrafficStars - r√©seau publicitaire </li><li>  Seznam.cz est un moteur de recherche tch√®que populaire. </li></ul><br><p>  Et puis je suis all√© au nom de la soci√©t√©, que je ne peux pas nommer maintenant.  Ils n'√©taient pas d'accord. </p><br><ul><li>  Un d√©veloppeur de jeux majeur.  Plus grand qu'eux Improbable. </li><li>  Un d√©veloppeur de logiciels graphiques majeur. </li><li>  Grande banque russe. </li><li>  Fabricant europ√©en d'√©oliennes qui a test√© avec succ√®s VictoriaMetrics.  Ce fabricant met en ≈ìuvre VictoriaMetrics pour surveiller les donn√©es des √©oliennes √† une vitesse de 50 √©chantillons par seconde par capteur.  Chaque √©olienne poss√®de plusieurs centaines de capteurs.  Ils ont plusieurs centaines d'√©oliennes. </li><li>  Les compagnies a√©riennes russes qui souhaitent introduire VictoriaMetrics, mais ne le peuvent toujours pas.  Nous sommes au stade du contrat avec eux. </li></ul><br><p><img src="https://habrastorage.org/webt/lw/0f/r3/lw0fr3hdyce3yw6n0i3ywjnpxhs.png">  Conclusions </p><br><p>  VictoriaMetrics et Thanos r√©solvent des probl√®mes similaires, mais de diff√©rentes mani√®res: </p><br><ul><li>  Vue de requ√™te globale </li><li>  mise √† l'√©chelle horizontale </li><li>  r√©tention arbitraire </li></ul><br><p><img src="https://habrastorage.org/webt/pv/-b/ob/pv-bobndxjkjrcukph5xm3sa-98.png"></p><br><p>  Je vous remercie </p><br><p>  Nous vous attendons sur notre <a href="https://t.me/VictoriaMetrics_ru1" rel="nofollow">cha√Æne t√©l√©gramme</a> . </p><br><p><img src="https://habrastorage.org/webt/gu/0s/w5/gu0sw56ppge1icdy-ensv-wl3f4.png"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr482272/">https://habr.com/ru/post/fr482272/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr482258/index.html">Comment fonctionnent les r√©seaux de neurones et pourquoi ils ont commenc√© √† rapporter beaucoup d'argent</a></li>
<li><a href="../fr482260/index.html">TelegramBot. La fonctionnalit√© de base. Autocollants et √©motic√¥nes. (Partie 3)</a></li>
<li><a href="../fr482262/index.html">Comment se connecter √† Talend Open Studio</a></li>
<li><a href="../fr482264/index.html">Br√©sil, magie noire, Mortal Kombat, Mars et 15 000 personnes. R√©sultats de l'ann√©e Ontiko</a></li>
<li><a href="../fr482268/index.html">M√©gastructures du futur: la sph√®re Dyson, le moteur stellaire et la ¬´bombe du trou noir¬ª</a></li>
<li><a href="../fr482274/index.html">5 raisons pour lesquelles vous devriez cesser d'utiliser System.Drawing dans ASP.NET</a></li>
<li><a href="../fr482276/index.html">GOST R 57580. Des tendances √† l'automatisation efficace</a></li>
<li><a href="../fr482280/index.html">Comment se fait le cosplay. Costume de costume avanc√© d'Isaac Clarke de Dead Space 2</a></li>
<li><a href="../fr482282/index.html">La fin de l'√®re ARMv7 ou un peu sur le portage de jeux</a></li>
<li><a href="../fr482284/index.html">"50 nuances de brun" ou "Comment en sommes-nous arriv√©s l√†"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>