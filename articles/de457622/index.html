<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåÜ ü§¥ üòì Qt-Leistung messen ü§≥üèº ü§ü üë©üèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich beschloss, die Artikelserie √ºber das Aurora-Betriebssystem (bis vor kurzem Sailfish genannt) fortzusetzen. W√§hrend der Zeit, in der ich mit diesem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Qt-Leistung messen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/digdes/blog/457622/">  Ich beschloss, die Artikelserie √ºber das Aurora-Betriebssystem (bis vor kurzem Sailfish genannt) fortzusetzen.  W√§hrend der Zeit, in der ich mit diesem Betriebssystem arbeite, habe ich verschiedene Beobachtungen gesammelt, die sich auf die Leistung von Anwendungen auf Qt und dem gesamten System beziehen, da es mit einer Vielzahl von Ger√§ten wie einem Weihnachtsbaum aufgeh√§ngt ist. Ich bemerke all die kleinen Dinge beim Start.  Ich denke, dass dies f√ºr Kollegen interessant und n√ºtzlich sein kann, die auch mit Qt arbeiten (oder bald arbeiten werden).  Schlagen Sie vor, dass Sie mehr testen k√∂nnen. <br><br><img src="https://habrastorage.org/webt/rw/uu/ze/rwuuzedwibb0ocithqms-janr-u.jpeg"><br><a name="habracut"></a><br>  Ich programmiere in Qt und diskutiere oft mit Kollegen, iOS-Entwicklern, die √Ñhnlichkeiten, Unterschiede und Vorteile von Ans√§tzen.  Irgendwann beschlossen wir immer noch, von Worten zu Taten zu wechseln und Messungen vorzunehmen.  Wir haben keinen Android-Programmierer gefunden, der bereit war, an unserer Unterhaltung teilzunehmen. Ein Vergleich mit der Teilnahme von Zahlen und Tabellen ist daher nur f√ºr Swift und C ++ m√∂glich. <br><br>  Ich m√∂chte Sie daran erinnern, dass Qt / C ++ seinen Speicherverwaltungsmechanismus nicht auferlegt, und der Benutzer selbst l√∂st dieses Problem im Rahmen der in C ++ verf√ºgbaren Funktionen, w√§hrend in Swift die Referenzz√§hlung verwendet wird, und in Java - einem Garbage Collector.  Somit hat der Programmierer die M√∂glichkeit, effizienter mit dem Speicher zu interagieren.  Um eine http-Anfrage zu senden oder Daten aus einer Datenbank zu lesen, st√ºtzt sich Qt auf seine eigenen St√§rken und verwendet nicht die vom Betriebssystem bereitgestellten vorgefertigten Frameworks.  Ausnahmen - Interaktion mit der Tastatur, Zeichnen des Anwendungsstartfensters, Anzeigen von Benachrichtigungen und anderen Dingen. <br><br><h2>  Test 1 </h2><br>  Zun√§chst haben wir beschlossen, einen einfachen Algorithmus (das Sieb von Eratosthenes) zu schreiben, ihn mit gro√üen Zahlen auszuf√ºhren und die Berechnungszeit zu vergleichen.  Auf dem iPhone 7 gestartet. <br><br>  <b>Schnelles Programm:</b> <br><br><pre><code class="swift hljs">swift <span class="hljs-comment"><span class="hljs-comment">// // ViewController.swift // Eratosthenes // // Created by Dmitry Shadrin on 22/11/2018. // Copyright 2018 Digital Design. All rights reserved. // import UIKit class ViewController: UIViewController { @IBOutlet weak var digitTextField: UITextField! @IBOutlet weak var timeLabel: UILabel! @IBAction func startAction(_ sender: UIButton) { guard let text = digitTextField.text, let number = Int(text) else { return } prime(n: number) } func prime(n: Int) { let startTime = DispatchTime.now() let _ = PrimeSequence(upTo: n) .reduce(into: [], { $0.append($1) }) //      let endTime = DispatchTime.now() let time = (endTime.uptimeNanoseconds - startTime.uptimeNanoseconds) timeLabel.text = "\(time)" } } public struct PrimeSequence: Sequence { private let iterator: AnyIterator&lt;Int&gt; public init(upTo limit: Int) { self.iterator = AnyIterator(EratosthenesIterator(upTo: limit)) } public func makeIterator() -&gt; AnyIterator&lt;Int&gt; { return iterator } } private struct EratosthenesIterator: IteratorProtocol { let n: Int var composite: [Bool] var current = 2 init(upTo n: Int) { self.n = n self.composite = [Bool](repeating: false, count: n + 1) } mutating func next() -&gt; Int? { while current &lt;= self.n { if !composite[current] { let prime = current for multiple in stride(from: current * current, through: self.n, by: current) { composite[multiple] = true } current += 1 return prime } current += 1 } return nil } }</span></span></code> </pre> <br><br>  Ich werde nicht im Detail auf den Code eingehen, das lineare Eratosthenes ist f√ºr das Verst√§ndnis nicht offensichtlich, insbesondere wenn eine der Sprachen Ihnen nicht vertraut ist.  Hier ist ein Link mit einer Beschreibung: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://e-maxx.ru/algo/prime_sieve_linear</a> , die interessiert sind, k√∂nnen auf Ehrlichkeit pr√ºfen.  √úbrigens stellte sich heraus, dass die schnelle Version in den kleinen Dingen etwas optimierter war (Sie k√∂nnen danach suchen), was die Plus-Version nicht daran hinderte, die Leistung zu gewinnen. <br><br>  <b>Qt-Programm:</b> <br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"eratosthenes.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;time.h&gt; #include &lt;QVector&gt; #include &lt;QDebug&gt; #include &lt;vector&gt; #include &lt;cmath&gt; Eratosthenes::Eratosthenes(QObject *parent) { time = 0; } void Eratosthenes::qtFunction(int n) { clock_t start, end; start = clock(); std::vector&lt;int&gt; lp = std::vector&lt;int&gt;(n + 1, 0); std::vector&lt;int&gt; pr; //       pr.reserve(std::sqrt(n) / 2); for (int i = 2; i &lt;= n; ++i) { if (lp[i] == 0) { lp[i] = i; pr.emplace_back(i); } for (int j = 0; j &lt; pr.size() &amp;&amp; pr[j] &lt;= lp[i] &amp;&amp; i * pr[j] &lt;= n; ++j) { lp[i * pr[j]] = pr[j]; } } end = clock(); time = (end - start) / (double)CLOCKS_PER_SEC; pTimeChanged(); qDebug() &lt;&lt; "  " &lt;&lt; pr.size() &lt;&lt; "" &lt;&lt; time; }</span></span></span></span></code> </pre> <br>  F√ºhren Sie das Programm aus.  Anwendungen haben ein Feld zur Eingabe der Nummer n, eine Startschaltfl√§che und ein Feld mit einer Gesamtzeit: <br><br><img src="https://habrastorage.org/webt/tf/q_/ck/tfq_ckywno1xmgpvylnfwwti12e.jpeg"><img src="https://habrastorage.org/webt/je/si/ta/jesita9gyvvdgv1nrtx-zcrhuu8.jpeg"><br>  <i>Schnell - links, Qt - rechts.</i> <br><br>  <b>Ergebnis.</b>  Ich werde eine Ma√ütabelle f√ºr verschiedene n und zu verschiedenen Zeitpunkten geben: <br><img src="https://habrastorage.org/webt/w2/ck/cd/w2ckcddlg_p18aeq8lon2cagqpq.jpeg"><br>  Wie Sie sehen k√∂nnen, ist eine C ++ - Anwendung etwa 1,5-mal schneller als eine native Anwendung mit identischen Algorithmen. <br><br><h2>  Test 2 </h2><br>  Nat√ºrlich ist das Rechnen im Kontext mobiler Anwendungen eine wichtige Sache, aber bei weitem nicht die einzige.  Aus diesem Grund haben wir eine ListView erstellt, die aus 1000 Elementen besteht, von denen jedes Text und ein Bild enth√§lt, um die Geschwindigkeit des Renderns grafischer Elemente zu √ºberpr√ºfen.  Unten in den Videos sehen Sie das Ergebnis: <br><br>  Qt: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/aC5tDt9xs7M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  Swift: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/7Lgp7waMvsw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Optisch ist der Unterschied nicht sp√ºrbar. <br><br><h2>  Test 3 </h2><br>  Im Sailfish-Betriebssystem haben wir einen Linux-Kernel und eine grafische native Shell auf Qt, und dies f√ºhrt an sich zu Gedanken √ºber die gute Leistung dieses Betriebssystems.  Ich stelle oft fest, dass das Inoi R7 in Bezug auf die Geschwindigkeit einiger Aufgaben gewinnt, obwohl das Samsung Galaxy S8 dasselbe tut.  So sendet, empf√§ngt, verarbeitet, packt das Samsung Galaxy S8 beispielsweise in eine Datenbank usw.  10K http-Anfragen in ca. 3-4 Minuten, und Inoi R7 macht dasselbe f√ºr 5-6 Minuten.  Angesichts der unterschiedlichen Eisenleistung ist das Ergebnis beeindruckend. <br><br>  Um die Leistung des Betriebssystems ehrlicher zu testen, habe ich mich f√ºr die Reaktionsgeschwindigkeit der Schubkarre entschieden. <br><br><h4>  Test.cpp: </h4><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"mypainter.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;QPainter&gt; MyPainter::MyPainter(QQuickItem *parent) : QQuickPaintedItem(parent) { } void MyPainter::paint(QPainter *painter) { QPen pen; pen.setWidth(10); pen.setColor(Qt::red); painter-&gt;setPen(pen); painter-&gt;drawPolyline(pol); } void MyPainter::xyCanged(int x, int y) { pol.append(QPoint(x, y)); update(); }</span></span></span></span></code> </pre><br><h4>  Test.qml: </h4><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> QtQuick <span class="hljs-number"><span class="hljs-number">2.9</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> QtQuick.Window <span class="hljs-number"><span class="hljs-number">2.2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Painter <span class="hljs-number"><span class="hljs-number">1.0</span></span> Window { visible: <span class="hljs-literal"><span class="hljs-literal">true</span></span> Painter { id: painter anchors.fill: parent MouseArea { anchors.fill: parent onPressed: { painter.xyCanged(mouseX, mouseY) } onMouseXChanged: { painter.xyCanged(mouseX, mouseY) } onMouseYChanged: { painter.xyCanged(mouseX, mouseY) } } } }</code> </pre><br>  Einfach und unpr√§tenti√∂s.  Ich habe kein Telefon, das Sailfish und Android f√ºr den pers√∂nlichen Gebrauch unterst√ºtzt, daher musste ich bei meinen Kollegen nach einem Telefon suchen, das Inoi r7 so nahe wie m√∂glich kommt, aber auf Android.  Was sich pl√∂tzlich als sehr schwierig herausstellte, wenn man bedenkt, dass ich in einem mobilen Entwicklungsb√ºro sitze. <br><br>  <i><b>Sony Xperia Z5 compact:</b></i> <i><br></i>  <i>Prozessor - Qualcomm Snapdragon 810 MSM8994, 2000 MHz</i> <i><br></i>  <i>Die Anzahl der Prozessorkerne - 8</i> <i><br></i>  <i>Videoprozessor - Adreno 430</i> <i><br></i>  <i>Die Gr√∂√üe des internen Speichers - 32 GB</i> <i><br></i>  <i>Die Gr√∂√üe des Arbeitsspeichers - 2 GB</i> <br><br>  <i><b>Inoi R7:</b></i> <i><br></i>  <i>Prozessor - Qualcomm Snapdragon 212 MSM8909AA, 1200 MHz</i> <i><br></i>  <i>Die Anzahl der Prozessorkerne - 4</i> <i><br></i>  <i>Videoprozessor - Adreno 304</i> <i><br></i>  <i>Die Gr√∂√üe des internen Speichers - 16 GB</i> <i><br></i>  <i>Die Gr√∂√üe des Arbeitsspeichers - 2 GB</i> <br><br>  Sony erwies sich dennoch als leistungsst√§rker, aber f√ºr die Odds-Gleichung aktivieren wir den Energiesparmodus, obwohl dies nicht zur vollst√§ndigen Gleichheit der Leistung der Ger√§te f√ºhrt.  Auf dem Video k√∂nnen Sie sehen, dass die Linie unter Android nicht so glatt ist wie bei Sailfish. <br><br>  Links - Sony, rechts - Inoi: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/bmYRRemNb5M" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Ich behaupte nicht, dies ist kein sehr ernstzunehmender Indikator. Sie m√ºssen nicht nur die F√§higkeiten einer reinen Sprache vergleichen, sondern auch verschiedene Bibliotheken, native und plattform√ºbergreifende, um deren Leistung und Benutzerfreundlichkeit zu vergleichen, da es nur sehr wenige Anwendungen gibt, die nur ListView und das Eratosthenes-Sieb verwenden.  Obwohl all diese kleinen Dinge zusammen f√ºr mich sehr √ºberzeugend aussehen. <br><br><h4>  Nachteile </h4><br>  Nat√ºrlich ist bei Qt nicht alles so rosig, da ich hier zu malen versuche, gibt es Nachteile.  Wenn Sie beispielsweise mit TextInput unter Android arbeiten, k√∂nnen Sie Perfektionisten qu√§len, die besonders empfindlich auf Kr√ºcken reagieren, da Qt auf jedem Ger√§t bei der Interaktion mit der Tastatur absolut einzigartige St√∂cke in die R√§der steckt.  Auf einem Telefon geht das Bild nach oben, auf dem anderen steht es still, aber EnterKey funktioniert nicht, auf dem dritten werden immer nur Gro√übuchstaben eingegeben, und es gibt keine M√∂glichkeit, es davon zu √ºberzeugen, in Kleinbuchstaben zu wechseln.  Sie k√∂nnen ad infinitum weitermachen.  Und das alles verlangsamt sich auch!  (Grunts sind nur f√ºr Android relevant, es gibt keine derartigen Probleme bei Sailfish, alles funktioniert gut).  Dar√ºber hinaus ist es bei Qt schwierig, das native Erscheinungsbild der Anwendung zu erreichen. <br><br><h3>  Fazit </h3><br>  Die wichtigste Schlussfolgerung, die gezogen werden kann: Qt ist ein plattform√ºbergreifendes Tool, dessen Leistung den nativen Entwicklungstools nicht unterlegen ist.  Es ist perfekt f√ºr Programme, in denen neben der grafischen Benutzeroberfl√§che noch viel Mathematik vorhanden ist, und insbesondere f√ºr Unternehmensanwendungen, in denen es viele Nuancen und wenige Mitarbeiter gibt, um nicht f√ºr jedes Betriebssystem eine unabh√§ngige Version zu erstellen.  Funktionen sind f√ºr Unternehmensbenutzer wichtiger als die native Benutzeroberfl√§che.  F√ºr Aurora ist Qt ein natives Tool f√ºr die Anwendungsentwicklung, das wahrscheinlich eine weitere Leistungssteigerung bietet. <br><br>  Es w√§re interessant, die Aurora auf einer leistungsstarken Hardware wie meinem Galaxy S8 zu testen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de457622/">https://habr.com/ru/post/de457622/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de457610/index.html">Evil Parcel Schwachstellenanalyse</a></li>
<li><a href="../de457612/index.html">Wie kann die LZ4-Dekomprimierung in ClickHouse beschleunigt werden?</a></li>
<li><a href="../de457614/index.html">Geheimnisse der Arbeitssuche im Ausland bei einem praktizierenden Headhunter</a></li>
<li><a href="../de457616/index.html">Mein "Wow, das wusste ich nicht!" Momente mit Scherz</a></li>
<li><a href="../de457618/index.html">Ein moderner Full-Stack-Entwickler sein</a></li>
<li><a href="../de457624/index.html">Wie wir die alte H√ºtte zerbrochen und an ihrer Stelle einen Wolkenkratzer gebaut haben</a></li>
<li><a href="../de457626/index.html">√úberarbeitung der Benutzerzugriffsebenen mithilfe von Power BI am Beispiel von Bitrix CMS (BUS)</a></li>
<li><a href="../de457628/index.html">Effektives P2M-Programm- und Projektmanagement</a></li>
<li><a href="../de457630/index.html">Erfahrung in der Entwicklung von Anforderungen an professionelle Datenwissenschaftler</a></li>
<li><a href="../de457632/index.html">Was kosten Unit-Tests?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>