<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèµÔ∏è üêå üç© Test de la technologie de cache RAID Adaptec ‚ùï ü¶á üê≠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les solutions pour travailler avec des matrices RAID √† partir de disques durs sont utilis√©es depuis tr√®s longtemps. En g√©n√©ral, ils restent populaires...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Test de la technologie de cache RAID Adaptec</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419053/">  Les solutions pour travailler avec des matrices RAID √† partir de disques durs sont utilis√©es depuis tr√®s longtemps.  En g√©n√©ral, ils restent populaires dans de nombreux domaines o√π un r√©seau √† faible volume √©lev√© et tol√©rant aux pannes est n√©cessaire.  Compte tenu de la taille des disques durs modernes, de leur vitesse, ainsi que d'autres raisons, le plus grand int√©r√™t pratique est les baies de RAID6 (ou RAID60, s'il y a beaucoup de disques).  Mais ce type de tableaux a de faibles performances sur les op√©rations d'√©criture al√©atoire et il n'est pas facile de faire quoi que ce soit avec lui. <br><br>  Bien s√ªr, dans ce cas, nous parlons de la vitesse du "volume brut".  Dans la vraie vie, le syst√®me de fichiers, le syst√®me d'exploitation, les applications et tout ce qui s'y ajoute.  Donc en fait, tout n'est pas si mal.  Cependant, il existe √©galement des m√©thodes mat√©rielles et logicielles pour augmenter la productivit√© qui sont ind√©pendantes de ces sous-syst√®mes.  Nous parlons de technologies de mise en cache lorsqu'un lecteur de m√©moire flash beaucoup plus rapide est ajout√© √† un ensemble de disques durs. <br><a name="habracut"></a><br>  En particulier, dans les contr√¥leurs RAID Adaptec, cette technologie est appel√©e maxCache et sa version 3.0 est impl√©ment√©e dans les mod√®les ASR-8885Q et ASR-81605ZQ.  Lors de son utilisation, plusieurs fonctionnalit√©s doivent √™tre prises en compte: un seul volume maxCache par contr√¥leur est autoris√©, le volume maximal du volume maxCache est de 1 To, pour que la mise en cache d'√©criture fonctionne, vous devez avoir une configuration √† tol√©rance de pannes du volume maxCache lui-m√™me (par exemple, un miroir).  Dans le m√™me temps, l'utilisateur peut sp√©cifier ind√©pendamment pour chaque volume logique comment exactement il travaillera avec maxCache - pour la lecture et / ou l'√©criture et dans quel mode. <br>  Pour les tests, nous avons utilis√© un serveur bas√© sur la carte m√®re Supermicro X10SLM-F, un processeur Intel Xeon E3-1225 v3 (4C / 8T, 3,2 GHz), 32 Go de RAM, fonctionnant sous Debian 9. <br><br><img src="https://habrastorage.org/webt/dg/sb/uf/dgsbufgn7nmom7dyat2wqc3mb44.jpeg" alt="image"><br><br>  Le contr√¥leur ASR-81605ZQ test√© poss√®de une unit√© de protection de la m√©moire et lorsqu'il travaille avec un ensemble de disques durs, il a des caches de lecture et d'√©criture actifs.  Rappelons que la m√©moire interne de ce mod√®le est de 1 Go.  Une matrice RAID6 avec un bloc de 256 Ko a √©t√© cr√©√©e √† partir de six disques durs Seagate ST10000NM0086 SATA d'une capacit√© de 10 To.  Le volume total du volume √©tait d'environ 36 To. <br><br>  Deux paires d'appareils ont fait office de SSD pour le volume maxCache: deux Samsung 850 EVO de 1 g√©n√©ration de 1 To chacun avec interface SATA et deux Seagate 1200 SSD (ST400FM0053) 400 Go chacun avec interface SAS √† partir desquels les matrices RAID1 ont √©t√© cr√©√©es.  Bien s√ªr, le premier mod√®le peut d√©j√† √™tre consid√©r√© comme obsol√®te et pas seulement moralement.  Mais pour illustrer le sc√©nario budg√©taire, cela suffira.  Le second s'inscrit formellement mieux dans la cat√©gorie ¬´corporate¬ª, mais il est √©galement difficile de le consid√©rer comme moderne.  Dans les param√®tres du tableau maxCache lui-m√™me, il n'y a que l'option Flush and Fetch Rate, qui est rest√©e √† la valeur par d√©faut (Medium).  Il n'y a aucun moyen de s√©lectionner une priorit√© pour les op√©rations ou les volumes de disque.  Notez que les disques n'√©taient pas dans un nouvel √©tat et TRIM n'est pas utilis√© dans cette configuration. <br><br>  Apr√®s avoir cr√©√© le volume maxCache, vous devez activer les param√®tres pour l'utiliser dans les propri√©t√©s du volume logique.  Il existe trois options au total: activer le cache de lecture, activer le cache d'√©criture et le type de cache d'√©criture. <br><br>  L'utilitaire fio a √©t√© utilis√© comme outil de test et l'ensemble de scripts comprenait des op√©rations s√©quentielles et al√©atoires avec un nombre diff√©rent de threads.  Il convient de noter que l'√©tude des performances des produits dot√©s de technologies de mise en cache de technologie synth√©tique est difficile √† reconna√Ætre comme la meilleure option.  Il est pr√©f√©rable d'√©valuer correctement l'effet sur les t√¢ches r√©elles, car la charge synth√©tique contredit dans une certaine mesure l'id√©e m√™me de la mise en cache.  De plus, dans ce cas, nous consid√©rons les op√©rations de bas niveau, et en fait, l'utilisateur traite g√©n√©ralement les fichiers et, comme nous l'avons dit ci-dessus, le syst√®me de fichiers du volume, le syst√®me d'exploitation et le logiciel lui-m√™me sont inclus dans le travail avec eux.  Ce sont donc les synth√©tiques, attractifs pour leur simplicit√© et leur r√©p√©tabilit√©, qui n'ont pas de sens √† eux seuls, mais surtout pour comparer ¬´comment c'√©tait et comment c'est devenu¬ª dans des sc√©narios difficiles √† mettre en cache des algorithmes et une estimation assez grossi√®re de l'effet. <br><br>  Voyons d'abord ce que notre tableau est capable de faire par lui-m√™me.  Rappelons que dans les op√©rations s√©quentielles, la vitesse en Mo / s et les retards (√† l'√©chelle logarithmique) sont int√©ressants, et dans les op√©rations al√©atoires, les IOPS et les retards sont √©galement int√©ressants. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/3s/19/mm/3s19mmb6cs1rao3dpq-owfkvovk.jpeg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1n/fd/-p/1nfd-phxwyyxec9whbch84diblc.jpeg" alt="image"></div><br>  La vitesse des op√©rations de flux avec un tableau de cette configuration est au niveau de 900 Mo / s.  Dans le m√™me temps, les retards ne d√©passent pas 70 ms m√™me avec un grand nombre de threads. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2b/jy/xb/2bjyxbmkl9r0qfb-zolkda7snuc.jpeg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/24/kz/t2/24kzt2cyodl7hknyw0ujgvn2nja.jpeg" alt="image"></div><br>  Pour les disques durs, les op√©rations al√©atoires sont la charge la plus difficile, comme le montrent les r√©sultats.  Si vous d√©finissez le seuil de latence √† 100 ms, vous pouvez obtenir environ 1100 IOPS √† la lecture et sur l'enregistrement, quelle que soit la charge, la baie peut fournir environ 300 IOPS.  Notez qu'avec une matrice RAID60 de 36 disques sur le m√™me contr√¥leur, vous pouvez obtenir des nombres plus int√©ressants, gr√¢ce √† la configuration de trois blocs de 12 disques durs.  Cela vous permet d'ajouter la rotation et d'augmenter les vitesses √† 3500 et 1200 IOPS en lecture et en √©criture al√©atoires, respectivement (dans cette configuration, il y avait des disques durs SAS assez anciens de HGST √† 2 To).  Le c√¥t√© n√©gatif de cette option est le co√ªt suppl√©mentaire du volume, car non pas deux disques par volume sont ¬´perdus¬ª, mais deux par groupe. <br><br>  Ainsi, sans mise en cache, notre tableau semble assez triste pour des op√©rations al√©atoires.  Bien s√ªr, c'est la vitesse ¬´brute¬ª du volume, et les programmes donnent rarement une charge exclusivement al√©atoire (rappelez-vous qu'ici nous avons encore un tableau pour stocker de gros fichiers, pas la base de donn√©es). <br><br><img src="https://habrastorage.org/webt/aw/db/fa/awdbfaorgnfjipkfdtlwejc12u4.png" alt="image"><br><br>  Voyons comment les SSD peuvent aider dans cette situation.  Dans les tests, quatre options de configuration disponibles seront utilis√©es - uniquement lire, lire et √©crire Write Through, lire et √©crire Write Back, lire et √©crire Instant Write Back: <br><br><ul><li>  WB - r√©√©criture activ√©e.  maxCache stockera les donn√©es sur le SSD et les r√©√©crira sur les disques durs lorsqu'il y a peu ou pas d'impact sur les performances.  Il s'agit de la strat√©gie par d√©faut. </li><li>  INSTWB - r√©√©criture instantan√©e activ√©e.  En plus de la politique par d√©faut, maxCache cr√©era des pages sales √† la vol√©e pour des √©critures pleine bande s'il y a de la place sur le SSD et que le nombre de pages sales est inf√©rieur au seuil. </li><li>  WT - √©criture via activ√©e.  Similaire √† la r√©√©criture instantan√©e, mais les √©critures pleine bande vont √† la fois au cache et au disque dur et aucune page sale n'est cr√©√©e √† la vol√©e. </li></ul><br>  Commen√ßons par les disques SATA, qui sont assez volumineux.  Les graphiques cette fois seront s√©par√©s - vitesse et d√©lais pour chacun des quatre sc√©narios de test. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fx/uq/c6/fxuqc6pydfis8whfyji2bwgqdes.jpeg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pq/l6/ly/pql6lypcnqudq_qymja9_hbp1_s.jpeg" alt="image"></div><br>  Lors des op√©rations de lecture s√©quentielle, le tableau affiche des r√©sultats stables quel que soit le type de cache utilis√©, ce qui est normal.  En m√™me temps, ils diff√®rent peu d'une baie sans cache - tout de m√™me 900 Mo / s et des retards d'environ 70 ms. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/87/sl/cd/87slcdfkyy9bahurephtbevd_va.jpeg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/go/1d/xn/go1dxnn30tkp-ltqdrbeqe3qnru.jpeg" alt="image"></div><br>  Il existe deux groupes en √©criture s√©quentielle - uniquement pour la lecture et avec Write Back, ils affichent des r√©sultats similaires √† un tableau sans cache - environ 900 Mo / s et jusqu'√† 100 ms, et Write Through et Instant Write Back ne peuvent pas extraire plus de 100 Mo / s et avec une taille nettement sup√©rieure retards. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sj/v_/w8/sjv_w8bpjqwt1i7f8opfov1z3l8.jpeg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/di/tl/cn/ditlcnsltth8nbfqvfykhjtiyxy.jpeg" alt="image"></div><br>  Rappelons qu'√† la lecture, la matrice de disques durs a montr√© un maximum d'environ 1100 IOPS, mais √† cette limite, les retards ont d√©j√† commenc√© √† d√©passer 100 ms.  Avec la mise en cache SSD SATA, vous pouvez obtenir des r√©sultats l√©g√®rement meilleurs - environ 1 500 IOPS et avec les m√™mes retards. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4x/st/bx/4xstbxk1q9rlf0zoavgk7m_lfky.jpeg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/tx/dj/nu/txdjnuopc4qxxfkqoz6xzixbxx4.jpeg" alt="image"></div><br>  Dans les op√©rations d'enregistrement al√©atoire, nous voyons le plus grand effet - une augmentation des indicateurs de deux fois et demie avec une augmentation simultan√©e de la capacit√© de charge.  Lorsque vous utilisez le cache, vous pouvez avoir des retards allant jusqu'√† 100 ms avec deux √† trois fois plus de threads. <br><br>  La conclusion g√©n√©rale √† propos de cette configuration est la suivante: elle n'interf√®re pas avec la lecture s√©quentielle, n'interf√®re pas avec l'√©criture s√©quentielle dans certaines configurations, ajoute environ 35% aux lectures al√©atoires et augmente les performances plusieurs fois lors des √©critures al√©atoires. <br><br>  Examinons maintenant une variante du volume de mise en cache de la deuxi√®me paire de disques SSD.  Notez que dans notre cas, ils avaient beaucoup moins de volume, une interface SAS 12 Gb / s et des caract√©ristiques de vitesse plus √©lev√©es (d√©clar√©es par le fabricant). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/8e/xq/x3/8exqx3s3i0_hsravea2fylcoh8s.jpeg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lv/sp/rw/lvsprwwd1m1r2svgrcmjo9awbxs.jpeg" alt="image"></div><br>  En lecture s√©quentielle, les r√©sultats ne diff√®rent pas de ceux donn√©s pr√©c√©demment, ce qui est tout √† fait attendu. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gu/dl/gd/gudlgdgjmsedwol2_ybhl2tmiia.jpeg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/d0/jv/pv/d0jvpv9izv19wdnz91b23kjnt7c.jpeg" alt="image"></div><br>  En enregistrement s√©quentiel, nous avons maintenant trois groupes - la configuration avec le cache d'√©criture en √©criture est √† la tra√Æne, environ Instant Write Back affiche environ la moiti√© de la vitesse maximale et seul Write Back n'est pas diff√©rent d'un tableau sans cache.  La m√™me situation avec le temps d'attente. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/el/p-/v-/elp-v-kgirb2hea_ba3vwxtdqsm.jpeg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sw/tp/v5/swtpv5z6q0yztaso_t9wpmba8cg.jpeg" alt="image"></div><br>  Mais en lecture al√©atoire, Instant Write Back s'est av√©r√© √™tre le meilleur, atteignant 2500 IOPS, tandis que le reste des configurations ne peut s'√©tendre jusqu'√† 1800 IOPS.  Notez que toutes les options avec mise en cache d'√©criture sont sensiblement plus rapides qu'un tableau ¬´propre¬ª.  Dans le m√™me temps, le temps d'attente ne d√©passe pas 100 ms m√™me avec un grand nombre de threads. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/38/wi/6p/38wi6pe6ly2lkwjmemab1l3dukw.jpeg" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lr/qo/cu/lrqocuuewpw6hzpmnagy8ga3muq.jpeg" alt="image"></div><br>  Lors des op√©rations de lecture al√©atoire, Instant Write Back revient √† nouveau, affichant pr√®s de 2 000 IOPS.  Le deuxi√®me groupe contient les configurations Write Through et Write Back avec 1000 IOPS. <br><br>  Le dernier participant, qui n'utilise pas le cache pour les op√©rations d'√©criture, affiche environ 300 IOPS, ainsi qu'un ensemble de disques durs. <br><br>  La r√©√©criture instantan√©e est peut-√™tre l'option la plus int√©ressante pour ce volume de cache.  Certes, il est plus lent dans les op√©rations de lecture en continu.  Il peut √™tre possible de r√©soudre ce probl√®me en utilisant la configuration RAID10 pour le volume maxCache, mais cela co√ªtera d√©j√† quatre baies dans le bo√Ætier de stockage. <br><br>  En g√©n√©ral, nous pouvons dire que l'utilisation de la technologie maxCache peut vraiment √™tre utile pour augmenter les performances des baies de disques durs, surtout s'il y a beaucoup d'op√©rations al√©atoires dans la charge.  Cependant, il est toujours impossible de consid√©rer qu'il est aussi efficace que de remplacer le disque dur par un SSD dans un ordinateur de bureau ou une station de travail. <br><br>  Le plus grand effet qui a √©t√© not√© dans les tests est une augmentation de la vitesse des op√©rations al√©atoires de 2-3 fois.  Bien s√ªr, les disques SSD les plus rapides n'ont pas √©t√© utilis√©s, ce qui a √©t√© clairement refl√©t√© dans certains tests (par exemple, l'enregistrement s√©quentiel en mode Write Through).  De plus, je voudrais une fois de plus attirer l'attention sur le fait que le choix de la configuration de la mise en cache affecte de mani√®re significative les r√©sultats.  √âtant donn√© que la modification des param√®tres est possible "√† la vol√©e" sans perte de donn√©es, il vaut la peine de v√©rifier vous-m√™me toutes les options de vos t√¢ches et de choisir la meilleure option. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr419053/">https://habr.com/ru/post/fr419053/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr419041/index.html">Les neuf r√¢teaux Elasticsearch sur lesquels j'ai march√©</a></li>
<li><a href="../fr419043/index.html">Le probl√®me insaisissable de synchronisation de trame</a></li>
<li><a href="../fr419047/index.html">Reddit pirat√©, fuite de base de donn√©es avec mots de passe et e-mail pour 2005-2007</a></li>
<li><a href="../fr419049/index.html">GeekBrains lance le marathon √©ducatif en ligne gratuit ¬´Find Yourself in Digital¬ª</a></li>
<li><a href="../fr419051/index.html">Comment Flant aide les d√©butants</a></li>
<li><a href="../fr419055/index.html">En th√©orie des cordes, vous pouvez vous en tirer avec beaucoup moins d'univers.</a></li>
<li><a href="../fr419061/index.html">Nouveaut√©s de GoLand 2018.2</a></li>
<li><a href="../fr419063/index.html">Automatisation de l'obtention d'informations aupr√®s d'USRLE √† l'aide de Freepascal</a></li>
<li><a href="../fr419065/index.html">Monde virtuel Intel. Pratique</a></li>
<li><a href="../fr419067/index.html">Comment vendre des donn√©es personnelles ou pourquoi il est difficile de mettre un prix sur les informations</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>