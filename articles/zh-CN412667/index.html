<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🚸 🐎 👦🏾 Cyber​​group Turla在灭蚊运动中使用Metasploit 🌀 🍊 🎅🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Turla是一个知名的网络间谍组织，至少运营了十年。 该小组的首次提及日期为2008年，与美国国防部的入侵有关 。 随后，Turla因无数信息安全事件而受到赞誉-对政府和战略性行业，包括国防工业的攻击。 



 2018年1月，我们发布了新的Turla Mosquito后门分发活动和感染指标的第一...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cyber​​group Turla在灭蚊运动中使用Metasploit</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/412667/"> Turla是一个知名的网络间谍组织，至少运营了十年。 该小组的首次提及日期为2008年，与<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">美国国防部</a>的入侵<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">有关</a> 。 随后，Turla因无数信息安全事件而受到赞誉-对政府和战略性行业，包括<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">国防工业的</a>攻击。 <br><br><img src="https://habrastorage.org/webt/ap/0v/ol/ap0vol968enwh-o3wzpmde0pily.jpeg"><br><br>  2018年1月，我们发布了新的Turla Mosquito后门分发活动和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">感染指标</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第一份报告</a> 。 该活动仍在进行中； 攻击者改变了战术以避免被发现。 <br><br> 自2018年3月以来，我们在此活动中看到了重大变化-现在Turla使用开源Metasploit框架分发Mosquito。 这不是Turla第一次放弃自己的工具-以前我们看到使用实用程序来提取凭证（Mimikatz）。 但是在这里值得注意的是，Turla首次使用Metasploit作为攻击第一阶段的后门，而不是像<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Skipper</a>这样的发展。 <br><br><a name="habracut"></a><h3> 经销 </h3><br> 正如我们在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">上一份报告</a>中所述，当前Turla广告系列中的目标设备感染媒介是一个伪造的安装程序，该安装程序会与合法的Adobe Flash Player一起下载该组织的后门之一。 重点目标是东欧国家的领事馆和使馆。 <br><br> 当用户通过HTTP从get.adobe.com下载Flash安装程序时，就会发生妥协。 在终端设备和Adobe服务器之间拦截了流量，这使Turla操作员可以使用木马版本替换合法文件。 下图显示了<b>理论上</b>可以拦截流量的点。  <b>请注意，不包括第五种情况-损害Adobe / Akamai。</b>  <b>攻击者仅使用Adobe品牌来欺骗用户。</b> <br><br><img src="https://habrastorage.org/webt/nf/m7/1e/nfm71ehwwthy_sowqybn2xmnpbg.png"><br><br> 我们没有设置流量拦截点，但是找到了一个模拟可执行文件Flash安装程序的新可执行文件，名为<code>flashplayer28_xa_install.exe</code> 。 因此，原始的折衷方法仍在使用。 <br><br><h3> 分析方法 </h3><br> 在2018年3月上旬，作为Turla活动跟踪工作的一部分，我们注意到蚊子分发活动发生了变化。 尽管该小组没有使用任何创新工具，但这是其战术，技术和程序（TTR）的重大转变。 <br><br> 以前，泄密链包括一个伪造的Flash安装程序，用于重置引导程序和主后门（请参见下图）。 <br><br><img src="https://habrastorage.org/webt/pn/3p/jf/pn3pjfskupo5civ_zdc_rsrsxg4.png"><br><br> 最近，我们已经看到重置最后一个后门的方法已经改变。 假冒的Flash安装程序仍参与该活动，但它没有直接删除两个恶意DLL，而是执行Metasploit shellcode并从Google云端硬盘重置或下载合法的安装程序。 然后，shellcode通过使攻击者访问受感染的系统来加载Meterpreter（ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">典型的Metasploit有效负载）</a> 。 最后，在工作站上安装了一个Mosquito后门。 新方案如下图所示。 <br><br><img src="https://habrastorage.org/webt/3b/wq/lb/3bwqlbedx5jju5brj7kssskdz0a.png"><br><br> 结合使用Metasploit，我们可以假定操作员手动控制过程。 攻击的持续时间相对较短-在尝试进行攻击后的三十分钟内，最后一个后门被重置。 <br><br> 使用的shellcode是Metasploit的典型代表。 它受<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">shikata_ga_nai编码器</a>的七次迭代保护。 下面的屏幕截图显示了加密和解密的有效负载。 <br><br><img src="https://habrastorage.org/webt/1o/mi/bq/1omibquibw80gy63_0ycbiw8ing.png"><br><br><img src="https://habrastorage.org/webt/b0/et/l0/b0etl0zvxhzpqaho624c2lebvui.png"><br><br> 解密后，shellcode在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">209.239.115</a> [。] 91 / 6OHEJ上与C＆C服务器通信，该服务器控制其他shellcode的加载。 根据ESET遥测技术，下一步是加载Meterpreter。 该IP地址对应于psychology-blog.ezua [。] Com域，该域自2017年10月起在蚊子运动中使用。 <br><br> 接下来，伪造的Flash安装程序将从Google云端硬盘URL下载合法的Adobe安装程序并运行它，以使用户不会怀疑任何东西。 <br><br><h3> 其他工具 </h3><br> 除了新的假安装程序和Meterpreter外，我们还注意到Turla使用了其他工具： <br><br><ul><li> 一个仅包含Metasploit shellcode的自定义可执行文件。 用于维持对Meterpreter会话的访问。 保存在 <pre>  C：\ Users \ &lt;用户名&gt; \ AppData \漫游\ Microsoft \ Windows \开始菜单\程序\启动\ msupdateconf.exe </pre> 提供持久性。 </li><li> 用于运行PowerShell脚本的另一个自定义可执行文件。 </li><li> 使用Google Apps脚本作为C＆C服务器的Mosquito jscript后门程序。 </li><li> 使用Metasploit模块<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ext_server_priv.x86.dll的</a>特权升级。 </li></ul><br><h3> 结论 </h3><br> 该帖子介绍了过去几个月中Turla蚊子分发活动的演变。 主要的变化是使用流行的渗透测试框架Metasploit作为自定义Mosquito后门程序的第一步。 <br><br><h3> 折衷指标 </h3><br><img src="https://habrastorage.org/webt/z5/0b/nm/z50bnmvydvbo9msk392rv6z47p8.png"><br><br>  C＆C <br><br>  • <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">209.239.115</a> [。] 91 / 6OHEJ <br>  • <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">70.32.39</a> [。] 219 / n2DE3 <br><br> 链接到合法的Flash安装程序 <br><br>  • <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">drive.google</a> [。] Com / uc？Authuser = 0＆id = 1s4kyrwa7gCH8I5Z1EU1IZ_JaR48A7UeP＆export =下载 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN412667/">https://habr.com/ru/post/zh-CN412667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN412655/index.html">多签名钱包层次结构（信任系统）</a></li>
<li><a href="../zh-CN412657/index.html">实用代币或股票：ICO的未来将是什么</a></li>
<li><a href="../zh-CN412661/index.html">在国外市场工作的英语：教科书不讲什么</a></li>
<li><a href="../zh-CN412663/index.html">AI出售比萨饼或Voximplant如何与Dialogflow交朋友</a></li>
<li><a href="../zh-CN412665/index.html">每周时间表编辑器</a></li>
<li><a href="../zh-CN412669/index.html">时间管理并不可怕：如何做得更多</a></li>
<li><a href="../zh-CN412671/index.html">BLE控制台：与BLE设备交互的全新方法</a></li>
<li><a href="../zh-CN412675/index.html">比特币和以太坊中的Multisig合约和地址</a></li>
<li><a href="../zh-CN412677/index.html">追溯矩阵</a></li>
<li><a href="../zh-CN412679/index.html">在10分钟内创建一个用于文本识别的Android应用程序。 移动视觉CodeLab</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>