<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò¥ ü§æüèæ üèÖ Modification des fichiers CSV pour ne pas casser les donn√©es üçó üë©üèª üßùüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les produits HFLabs en volumes industriels traitent les donn√©es: adresses, noms complets, coordonn√©es de l'entreprise et m√™me un chariot au total. Nat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Modification des fichiers CSV pour ne pas casser les donn√©es</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hflabs/blog/432906/"><img src="https://habrastorage.org/webt/xr/j1/ia/xrj1ia0lo_magqpxw2sr51g-9dg.jpeg"><br><br>  Les produits HFLabs en volumes industriels traitent les donn√©es: adresses, noms complets, coordonn√©es de l'entreprise et m√™me un chariot au total.  Naturellement, les testeurs traitent ces donn√©es tous les jours: mettre √† jour les cas de test, √©tudier les r√©sultats du nettoyage.  Souvent, les clients donnent une base ¬´en direct¬ª au testeur pour configurer le service pour lui. <br><br>  La premi√®re chose que nous enseignons aux nouveaux AQ est de sauvegarder les donn√©es dans leur forme originale.  Le tout selon les alliances: "Ne faites pas de mal".  Dans cet article, je vais vous montrer comment travailler avec soin avec les fichiers CSV dans Excel et Open Office.  Les conseils vous aideront √† ne rien g√¢cher, √† enregistrer les informations apr√®s la modification et √† vous sentir g√©n√©ralement plus en confiance. <br><br>  <i>Le mat√©riel est basique, les professionnels s'ennuieront certainement.</i> <br><a name="habracut"></a><br><h2>  Que sont les fichiers CSV? </h2><br>  Le format CSV est utilis√© pour stocker des tableaux dans des fichiers texte.  Les donn√©es sont souvent regroup√©es dans des tableaux, les fichiers CSV sont donc tr√®s populaires. <br><br><img src="https://habrastorage.org/webt/ya/z5/vw/yaz5vwq0sruyxaqvir0cnxvu7je.png"><br>  <sub>Un fichier CSV se compose de lignes de donn√©es et de d√©limiteurs qui indiquent les limites des colonnes</sub> <br><br>  CSV signifie valeurs s√©par√©es par des virgules - ¬´valeurs s√©par√©es par des virgules¬ª.  Mais ne vous laissez pas berner par le nom: les points-virgules et les tabulations peuvent servir de s√©parateurs de colonnes dans un fichier CSV.  Ce sera toujours un fichier CSV. <br><br>  CSV pr√©sente de nombreux avantages par rapport au m√™me format Excel: les fichiers texte sont simples comme un bouton, s'ouvrent rapidement, peuvent √™tre lus sur n'importe quel appareil et dans n'importe quel environnement sans outils suppl√©mentaires. <br><br>  En raison de ses avantages, le CSV est un format d'√©change de donn√©es tr√®s populaire, bien qu'il ait d√©j√† 40 ans. Les CSV utilisent des applications industrielles, ils t√©l√©chargent des donn√©es √† partir de bases de donn√©es. <br><br>  Un probl√®me - un √©diteur de texte pour travailler avec CSV ne suffit pas.  N√©anmoins, si le tableau est simple: dans le premier champ, l'ID est de la m√™me longueur, dans le second, la date est du m√™me format et dans le troisi√®me, une adresse.  Mais lorsque les champs de longueurs diff√©rentes et qu'il y en a plus de trois, les tourments commencent. <br><br><img src="https://habrastorage.org/webt/cv/lb/mm/cvlbmmwfjujdiowdolcfjgwbiik.png"><br>  <sub>Gardez une trace des s√©parateurs et des colonnes - vous vous brisez les yeux</sub> <br><br>  Pire encore avec l'analyse des donn√©es - essayez le Bloc-notes pour au moins ajouter tous les nombres dans une colonne.  Je ne parle pas de beaux graphismes. <br><br>  Par cons√©quent, les fichiers CSV sont analys√©s et modifi√©s dans Excel et ses analogues: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Open Office</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">LibreOffice</a> et autres. <br><br>  <i>Aux v√©t√©rans qui lisent n√©anmoins: les gars, nous connaissons l'analyse directement dans la base de donn√©es en utilisant SQL, nous connaissons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Tableau</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Talend Open Studio</a> .</i>  <i>Cet article est destin√© aux d√©butants, mais √† un niveau de base et une petite quantit√© de donn√©es Excel avec des analogues est suffisante.</i> <br><br><h2>  Comment Excel g√¢che les donn√©es: des classiques </h2><br>  Tout irait bien, mais Excel, ouvrant √† peine le fichier CSV, commence ses astuces astucieuses.  Il modifie les donn√©es sans demande pour qu'elles deviennent sans valeur.  Et il le fait compl√®tement inaper√ßu.  Pour cette raison, √† un moment donn√©, nous avons saisi un tas de probl√®mes. <br><br>  La plupart des incidents sont dus au fait que le programme convertit les cha√Ænes avec un ensemble de nombres en nombres sans demande. <br><br>  <b>Arrondit.</b>  Par exemple, dans la cellule d'origine, deux t√©l√©phones sont stock√©s s√©par√©s par des virgules sans espaces: ¬´5235834.5235835¬ª.  Que fera Excel?  Convertit les nombres en un seul nombre et arrondit √† deux d√©cimales: ¬´5235834.52¬ª.  Nous perdons donc le deuxi√®me t√©l√©phone. <br><br>  <b>Conduit √† une forme exponentielle.</b>  Excel convertit soigneusement "123456789012345" en nombre "1,2E + 15".  Nous perdons compl√®tement la valeur d'origine. <br><br>  Le probl√®me concerne les longs caract√®res de quinze lignes num√©riques.  Par exemple, les codes CLADR (il s'agit par exemple d'un identifiant d'√©tat d'un objet d'adresse: ville, rue, maison). <br><br>  <b>Supprime les principaux avantages.</b>  Excel pense que le plus au d√©but d'une ligne avec des chiffres est un caract√®re compl√®tement superflu.  Comme, et c'est tellement clair que le nombre est positif, car il n'y a pas de moins devant.  Par cons√©quent, le principal plus dans le nombre "+74955235834" sera rejet√© comme inutile - il se r√©v√©lera "74955235834".  (En r√©alit√©, le nombre souffrira encore plus, mais pour plus de clart√©, je m'entendrai avec le plus). <br><br>  La perte d'un plus est critique, par exemple, si les donn√©es sont transmises √† un syst√®me tiers et que celui-ci v√©rifie rigoureusement le format lors de l'importation. <br><br>  <b>D√©compose trois chiffres.</b>  Excel est une bonne √¢me qui analysera une cha√Æne num√©rique de plus de trois caract√®res.  Par exemple, ¬´8 495 5235834¬ª deviendra ¬´84 955 235 834¬ª. <br><br>  Le formatage est important au moins pour les num√©ros de t√©l√©phone: les espaces s√©parent les codes de pays et de ville du reste du num√©ro et les uns des autres.  Excel viole facilement la division correcte du t√©l√©phone. <br><br>  <b>Supprime les z√©ros non significatifs.</b>  Excel transformera la cha√Æne ¬´00523446¬ª en ¬´523446¬ª. <br>  Et dans le TIN, par exemple, les deux premiers chiffres sont le code de r√©gion.  Pour la R√©publique de l'Alta√Ø, tout part de z√©ro - ¬´04¬ª.  Sans z√©ro, la signification du nombre sera d√©form√©e et la v√©rification du format INN ne passera pas du tout. <br><br>  <b>Modifie les dates aux param√®tres locaux.</b>  Excel se fera un plaisir de corriger le num√©ro de maison "1/2" √† "01. f√©v."  Parce que Windows l'a sugg√©r√© dans ce formulaire, il est plus pratique pour vous de lire les dates. <br><br><h2>  Nous vainquons la corruption des donn√©es par une importation appropri√©e </h2><br>  Mais s√©rieusement, Excel n'est pas √† bl√¢mer pour les probl√®mes, mais un moyen non √©vident d'importer des donn√©es dans le programme. <br><br>  Par d√©faut, Excel applique le type G√©n√©ral aux donn√©es du fichier CSV t√©l√©charg√© - le type G√©n√©ral.  Pour cette raison, le programme reconna√Æt les cha√Ænes num√©riques comme des nombres.  Cet ordre peut √™tre annul√© √† l'aide de l'outil d'importation int√©gr√©. <br><br>  <b>Je d√©marre le m√©canisme d'importation int√©gr√© dans Excel.</b>  Dans le menu, il s'agit de ¬´Donn√©es ‚Üí Obtenir des donn√©es externes ‚Üí Du texte¬ª. <br><br>  <b>Je s√©lectionne un fichier CSV avec des donn√©es, une bo√Æte de dialogue s'ouvre.</b>  Dans la bo√Æte de dialogue, je clique sur le type de fichier D√©limit√© (d√©limit√©).  Encodage - celui du fichier est g√©n√©ralement d√©termin√© automatiquement.  Si la premi√®re ligne du fichier est un en-t√™te, je marque ¬´Mes donn√©es ont des en-t√™tes¬ª. <br><br>  <b>Je passe √† la deuxi√®me √©tape du dialogue.</b>  Je s√©lectionne le s√©parateur de champ (g√©n√©ralement un point-virgule - point-virgule).  Je d√©sactive ¬´Traitez les d√©limiteurs cons√©cutifs comme un seul¬ª et d√©finissez ¬´Qualificateur de texte¬ª sur ¬´{aucun}¬ª.  (Le qualificatif de texte est un symbole du d√©but et de la fin du texte. Si le s√©parateur dans le CSV est une virgule, le qualificatif de texte est n√©cessaire pour distinguer les virgules √† l'int√©rieur du texte des virgules de s√©parateur.) <br><br>  <b>√Ä la troisi√®me √©tape, je choisis le format des champs</b> , pour le plaisir tout a commenc√©.  Pour toutes les colonnes, j'ai d√©fini le type sur ¬´Texte¬ª.  Soit dit en passant, si vous cliquez sur la premi√®re colonne, maintenez la touche Maj enfonc√©e et cliquez sur la derni√®re, toutes les colonnes seront mises en surbrillance √† la fois.  Id√©alement. <br><br>  Ensuite, Excel vous demandera o√π coller les donn√©es du CSV - vous pouvez simplement cliquer sur "OK", et les donn√©es appara√Ætront dans une feuille ouverte. <br><br><img src="https://habrastorage.org/webt/rl/rf/cw/rlrfcwbol_yygemdyub2caobfpk.gif"><br>  <sub>Vous devez cr√©er un nouveau classeur dans Excel avant d'importer</sub> <br><br>  <b>Mais!</b>  <b>Si je pr√©vois d'ajouter des donn√©es au CSV via Excel, il y a autre chose √† faire.</b> <br><br>  Apr√®s l'importation, il est n√©cessaire de forcer toutes les cellules de la feuille au format "Texte".  Sinon, les nouveaux champs acquerront le m√™me type g√©n√©ral. <br><br><ul><li>  J'appuie deux fois sur Ctrl + A, Excel s√©lectionne toutes les cellules de la feuille; </li><li>  Je clique sur le bouton droit de la souris; </li><li>  Je s√©lectionne "Formater les cellules" dans le menu contextuel; </li><li>  dans la bo√Æte de dialogue qui s'ouvre, s√©lectionnez le type de donn√©es Texte √† gauche. </li></ul><br><img src="https://habrastorage.org/webt/3s/ux/aw/3suxawbdhnfuj5mokakdb8v6y74.gif"><br>  <sub>Pour s√©lectionner toutes les cellules, vous devez appuyer deux fois sur Ctrl + A.</sub>  <sub>Exactement deux, ce n'est pas une blague, essayez</sub> <br><br>  Apr√®s cela, avec un peu de chance, Excel laissera les donn√©es originales seules.  Mais ce n'est pas la garantie la plus difficile, donc apr√®s l'enregistrement, nous v√©rifierons certainement le fichier via une visionneuse de texte. <br><br><h2>  Alternative: Open Office Calc </h2><br>  Pour travailler avec des fichiers CSV, j'utilise Calc.  Ce n'est pas qu'il ne consid√®re pas les donn√©es num√©riques comme des cha√Ænes, mais au moins ne leur applique pas de reformatage conform√©ment aux param√®tres r√©gionaux de Windows.  Oui, et l'importation est plus simple. <br><br>  Bien s√ªr, vous aurez besoin du package Open Office (OO).  Lors de l'installation, il proposera de r√©affecter les fichiers MS Office √† lui-m√™me.  Je ne le recommande pas: bien que OO soit assez fonctionnel, il ne comprend pas parfaitement la mise en forme d√©licate de Microsoft des documents. <br><br>  Mais faire d'OO le programme par d√©faut pour les fichiers CSV est tout √† fait raisonnable.  Vous pouvez le faire apr√®s avoir install√© le package. <br><br>  Nous commen√ßons donc l'importation de donn√©es depuis CSV.  Apr√®s avoir double-cliqu√© sur le fichier, Open Office affiche une bo√Æte de dialogue. <br><br><img src="https://habrastorage.org/webt/xe/uh/zy/xeuhzy60ogakabxxxoiwc8pcdq8.png"><br>  <sub>Notez que dans OO, vous n'avez pas besoin de cr√©er un nouveau classeur et de forcer l'importation √† d√©marrer, tout seul</sub> <br><br><ol><li>  Encodage - comme dans le fichier. </li><li>  "S√©parateur" est un point-virgule.  Naturellement, s'il s'agit pr√©cis√©ment du s√©parateur dans le fichier. </li><li>  "S√©parateur de texte" - vide (tout comme dans Excel). </li><li>  Dans la section "Champs", je clique dans le carr√© en haut √† gauche du tableau, toutes les colonnes sont mises en surbrillance.  J'indique le type de "Texte". </li></ol><br>  Une chose qui a g√¢t√© beaucoup de sang: si vous s√©lectionnez par erreur plusieurs s√©parateurs de champs ou si le mauvais texte est divis√©, le fichier peut s'ouvrir correctement, mais il peut √™tre enregistr√© de mani√®re incorrecte. <br><br>  En plus de Calc, libreOffice est populaire dans les HFLabs, en particulier sous Linux.  Les deux sont utilis√©s plus activement pour CSV qu'Excel. <br><br><h2>  Bonus track: probl√®mes lors de l'enregistrement de Calc vers .xlsx </h2><br>  Si vous enregistrez des donn√©es de Calc au format Excel .xlsx, gardez √† l'esprit - OO parfois inexplicablement et √† grande √©chelle perd des donn√©es. <br><br><img src="https://habrastorage.org/webt/yv/bw/7u/yvbw7u8x4lzavz3hztn4pff9wvw.jpeg"><br>  <sub>La friche blanche au milieu est richement remplie de donn√©es dans le fichier CSV d'origine</sub> <br><br>  Par cons√©quent, apr√®s avoir enregistr√©, j'ouvre √† nouveau le fichier et m'assure que les donn√©es sont en place. <br><br>  Si quelque chose est perdu, le traitement consiste √† enregistrer de CSV en .xlsx.  Ou, si Windows est install√©, importez de CSV vers Excel et enregistrez √† partir de l√†. <br><br>  Apr√®s la r√©-enregistrement, je vais certainement v√©rifier une fois de plus que toutes les donn√©es sont en place et qu'il n'y a pas de lignes vides suppl√©mentaires. <br><br>  <i>Si vous souhaitez travailler avec des donn√©es, consultez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nos offres d'emploi</a> .</i>  <i>HFLabs a presque toujours besoin d'analystes, de testeurs, d'ing√©nieurs d'impl√©mentation, de d√©veloppeurs.</i>  <i>Nous fournirons des donn√©es pour que peu semble :)</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr432906/">https://habr.com/ru/post/fr432906/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr432896/index.html">AXIS P1425-LE Mk II vs IDIS DC-T3233HRXL: Comparez les cam√©ras CCTV</a></li>
<li><a href="../fr432898/index.html">Panoramas sur StereoPi</a></li>
<li><a href="../fr432900/index.html">Caract√©ristiques du travail dans une √©quipe internationale. Japon</a></li>
<li><a href="../fr432902/index.html">√âchec du vol vers la lune: ce qui est devenu connu sur l'une des missions</a></li>
<li><a href="../fr432904/index.html">Meilleurs employeurs en TI 2018: cote annuelle My Circle</a></li>
<li><a href="../fr432908/index.html">En Russie, ils pr√©voient d'introduire un contr√¥le suppl√©mentaire sur les paiements sur Internet</a></li>
<li><a href="../fr432910/index.html">Il est dangereux de consid√©rer la r√©alit√© virtuelle comme une machine d'empathie</a></li>
<li><a href="../fr432912/index.html">Comment obtenir un stage chez Google</a></li>
<li><a href="../fr432914/index.html">Un bot de chat tr√®s simple pour Telegram pour les plus petits</a></li>
<li><a href="../fr432918/index.html">D√©sol√©, j'ai cass√© votre recovery.conf</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>