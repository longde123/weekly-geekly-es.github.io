<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😴 🤾🏾 🏅 Modification des fichiers CSV pour ne pas casser les données 🍗 👩🏻 🧝🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les produits HFLabs en volumes industriels traitent les données: adresses, noms complets, coordonnées de l'entreprise et même un chariot au total. Nat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Modification des fichiers CSV pour ne pas casser les données</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hflabs/blog/432906/"><img src="https://habrastorage.org/webt/xr/j1/ia/xrj1ia0lo_magqpxw2sr51g-9dg.jpeg"><br><br>  Les produits HFLabs en volumes industriels traitent les données: adresses, noms complets, coordonnées de l'entreprise et même un chariot au total.  Naturellement, les testeurs traitent ces données tous les jours: mettre à jour les cas de test, étudier les résultats du nettoyage.  Souvent, les clients donnent une base «en direct» au testeur pour configurer le service pour lui. <br><br>  La première chose que nous enseignons aux nouveaux AQ est de sauvegarder les données dans leur forme originale.  Le tout selon les alliances: "Ne faites pas de mal".  Dans cet article, je vais vous montrer comment travailler avec soin avec les fichiers CSV dans Excel et Open Office.  Les conseils vous aideront à ne rien gâcher, à enregistrer les informations après la modification et à vous sentir généralement plus en confiance. <br><br>  <i>Le matériel est basique, les professionnels s'ennuieront certainement.</i> <br><a name="habracut"></a><br><h2>  Que sont les fichiers CSV? </h2><br>  Le format CSV est utilisé pour stocker des tableaux dans des fichiers texte.  Les données sont souvent regroupées dans des tableaux, les fichiers CSV sont donc très populaires. <br><br><img src="https://habrastorage.org/webt/ya/z5/vw/yaz5vwq0sruyxaqvir0cnxvu7je.png"><br>  <sub>Un fichier CSV se compose de lignes de données et de délimiteurs qui indiquent les limites des colonnes</sub> <br><br>  CSV signifie valeurs séparées par des virgules - «valeurs séparées par des virgules».  Mais ne vous laissez pas berner par le nom: les points-virgules et les tabulations peuvent servir de séparateurs de colonnes dans un fichier CSV.  Ce sera toujours un fichier CSV. <br><br>  CSV présente de nombreux avantages par rapport au même format Excel: les fichiers texte sont simples comme un bouton, s'ouvrent rapidement, peuvent être lus sur n'importe quel appareil et dans n'importe quel environnement sans outils supplémentaires. <br><br>  En raison de ses avantages, le CSV est un format d'échange de données très populaire, bien qu'il ait déjà 40 ans. Les CSV utilisent des applications industrielles, ils téléchargent des données à partir de bases de données. <br><br>  Un problème - un éditeur de texte pour travailler avec CSV ne suffit pas.  Néanmoins, si le tableau est simple: dans le premier champ, l'ID est de la même longueur, dans le second, la date est du même format et dans le troisième, une adresse.  Mais lorsque les champs de longueurs différentes et qu'il y en a plus de trois, les tourments commencent. <br><br><img src="https://habrastorage.org/webt/cv/lb/mm/cvlbmmwfjujdiowdolcfjgwbiik.png"><br>  <sub>Gardez une trace des séparateurs et des colonnes - vous vous brisez les yeux</sub> <br><br>  Pire encore avec l'analyse des données - essayez le Bloc-notes pour au moins ajouter tous les nombres dans une colonne.  Je ne parle pas de beaux graphismes. <br><br>  Par conséquent, les fichiers CSV sont analysés et modifiés dans Excel et ses analogues: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Open Office</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">LibreOffice</a> et autres. <br><br>  <i>Aux vétérans qui lisent néanmoins: les gars, nous connaissons l'analyse directement dans la base de données en utilisant SQL, nous connaissons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Tableau</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Talend Open Studio</a> .</i>  <i>Cet article est destiné aux débutants, mais à un niveau de base et une petite quantité de données Excel avec des analogues est suffisante.</i> <br><br><h2>  Comment Excel gâche les données: des classiques </h2><br>  Tout irait bien, mais Excel, ouvrant à peine le fichier CSV, commence ses astuces astucieuses.  Il modifie les données sans demande pour qu'elles deviennent sans valeur.  Et il le fait complètement inaperçu.  Pour cette raison, à un moment donné, nous avons saisi un tas de problèmes. <br><br>  La plupart des incidents sont dus au fait que le programme convertit les chaînes avec un ensemble de nombres en nombres sans demande. <br><br>  <b>Arrondit.</b>  Par exemple, dans la cellule d'origine, deux téléphones sont stockés séparés par des virgules sans espaces: «5235834.5235835».  Que fera Excel?  Convertit les nombres en un seul nombre et arrondit à deux décimales: «5235834.52».  Nous perdons donc le deuxième téléphone. <br><br>  <b>Conduit à une forme exponentielle.</b>  Excel convertit soigneusement "123456789012345" en nombre "1,2E + 15".  Nous perdons complètement la valeur d'origine. <br><br>  Le problème concerne les longs caractères de quinze lignes numériques.  Par exemple, les codes CLADR (il s'agit par exemple d'un identifiant d'état d'un objet d'adresse: ville, rue, maison). <br><br>  <b>Supprime les principaux avantages.</b>  Excel pense que le plus au début d'une ligne avec des chiffres est un caractère complètement superflu.  Comme, et c'est tellement clair que le nombre est positif, car il n'y a pas de moins devant.  Par conséquent, le principal plus dans le nombre "+74955235834" sera rejeté comme inutile - il se révélera "74955235834".  (En réalité, le nombre souffrira encore plus, mais pour plus de clarté, je m'entendrai avec le plus). <br><br>  La perte d'un plus est critique, par exemple, si les données sont transmises à un système tiers et que celui-ci vérifie rigoureusement le format lors de l'importation. <br><br>  <b>Décompose trois chiffres.</b>  Excel est une bonne âme qui analysera une chaîne numérique de plus de trois caractères.  Par exemple, «8 495 5235834» deviendra «84 955 235 834». <br><br>  Le formatage est important au moins pour les numéros de téléphone: les espaces séparent les codes de pays et de ville du reste du numéro et les uns des autres.  Excel viole facilement la division correcte du téléphone. <br><br>  <b>Supprime les zéros non significatifs.</b>  Excel transformera la chaîne «00523446» en «523446». <br>  Et dans le TIN, par exemple, les deux premiers chiffres sont le code de région.  Pour la République de l'Altaï, tout part de zéro - «04».  Sans zéro, la signification du nombre sera déformée et la vérification du format INN ne passera pas du tout. <br><br>  <b>Modifie les dates aux paramètres locaux.</b>  Excel se fera un plaisir de corriger le numéro de maison "1/2" à "01. fév."  Parce que Windows l'a suggéré dans ce formulaire, il est plus pratique pour vous de lire les dates. <br><br><h2>  Nous vainquons la corruption des données par une importation appropriée </h2><br>  Mais sérieusement, Excel n'est pas à blâmer pour les problèmes, mais un moyen non évident d'importer des données dans le programme. <br><br>  Par défaut, Excel applique le type Général aux données du fichier CSV téléchargé - le type Général.  Pour cette raison, le programme reconnaît les chaînes numériques comme des nombres.  Cet ordre peut être annulé à l'aide de l'outil d'importation intégré. <br><br>  <b>Je démarre le mécanisme d'importation intégré dans Excel.</b>  Dans le menu, il s'agit de «Données → Obtenir des données externes → Du texte». <br><br>  <b>Je sélectionne un fichier CSV avec des données, une boîte de dialogue s'ouvre.</b>  Dans la boîte de dialogue, je clique sur le type de fichier Délimité (délimité).  Encodage - celui du fichier est généralement déterminé automatiquement.  Si la première ligne du fichier est un en-tête, je marque «Mes données ont des en-têtes». <br><br>  <b>Je passe à la deuxième étape du dialogue.</b>  Je sélectionne le séparateur de champ (généralement un point-virgule - point-virgule).  Je désactive «Traitez les délimiteurs consécutifs comme un seul» et définissez «Qualificateur de texte» sur «{aucun}».  (Le qualificatif de texte est un symbole du début et de la fin du texte. Si le séparateur dans le CSV est une virgule, le qualificatif de texte est nécessaire pour distinguer les virgules à l'intérieur du texte des virgules de séparateur.) <br><br>  <b>À la troisième étape, je choisis le format des champs</b> , pour le plaisir tout a commencé.  Pour toutes les colonnes, j'ai défini le type sur «Texte».  Soit dit en passant, si vous cliquez sur la première colonne, maintenez la touche Maj enfoncée et cliquez sur la dernière, toutes les colonnes seront mises en surbrillance à la fois.  Idéalement. <br><br>  Ensuite, Excel vous demandera où coller les données du CSV - vous pouvez simplement cliquer sur "OK", et les données apparaîtront dans une feuille ouverte. <br><br><img src="https://habrastorage.org/webt/rl/rf/cw/rlrfcwbol_yygemdyub2caobfpk.gif"><br>  <sub>Vous devez créer un nouveau classeur dans Excel avant d'importer</sub> <br><br>  <b>Mais!</b>  <b>Si je prévois d'ajouter des données au CSV via Excel, il y a autre chose à faire.</b> <br><br>  Après l'importation, il est nécessaire de forcer toutes les cellules de la feuille au format "Texte".  Sinon, les nouveaux champs acquerront le même type général. <br><br><ul><li>  J'appuie deux fois sur Ctrl + A, Excel sélectionne toutes les cellules de la feuille; </li><li>  Je clique sur le bouton droit de la souris; </li><li>  Je sélectionne "Formater les cellules" dans le menu contextuel; </li><li>  dans la boîte de dialogue qui s'ouvre, sélectionnez le type de données Texte à gauche. </li></ul><br><img src="https://habrastorage.org/webt/3s/ux/aw/3suxawbdhnfuj5mokakdb8v6y74.gif"><br>  <sub>Pour sélectionner toutes les cellules, vous devez appuyer deux fois sur Ctrl + A.</sub>  <sub>Exactement deux, ce n'est pas une blague, essayez</sub> <br><br>  Après cela, avec un peu de chance, Excel laissera les données originales seules.  Mais ce n'est pas la garantie la plus difficile, donc après l'enregistrement, nous vérifierons certainement le fichier via une visionneuse de texte. <br><br><h2>  Alternative: Open Office Calc </h2><br>  Pour travailler avec des fichiers CSV, j'utilise Calc.  Ce n'est pas qu'il ne considère pas les données numériques comme des chaînes, mais au moins ne leur applique pas de reformatage conformément aux paramètres régionaux de Windows.  Oui, et l'importation est plus simple. <br><br>  Bien sûr, vous aurez besoin du package Open Office (OO).  Lors de l'installation, il proposera de réaffecter les fichiers MS Office à lui-même.  Je ne le recommande pas: bien que OO soit assez fonctionnel, il ne comprend pas parfaitement la mise en forme délicate de Microsoft des documents. <br><br>  Mais faire d'OO le programme par défaut pour les fichiers CSV est tout à fait raisonnable.  Vous pouvez le faire après avoir installé le package. <br><br>  Nous commençons donc l'importation de données depuis CSV.  Après avoir double-cliqué sur le fichier, Open Office affiche une boîte de dialogue. <br><br><img src="https://habrastorage.org/webt/xe/uh/zy/xeuhzy60ogakabxxxoiwc8pcdq8.png"><br>  <sub>Notez que dans OO, vous n'avez pas besoin de créer un nouveau classeur et de forcer l'importation à démarrer, tout seul</sub> <br><br><ol><li>  Encodage - comme dans le fichier. </li><li>  "Séparateur" est un point-virgule.  Naturellement, s'il s'agit précisément du séparateur dans le fichier. </li><li>  "Séparateur de texte" - vide (tout comme dans Excel). </li><li>  Dans la section "Champs", je clique dans le carré en haut à gauche du tableau, toutes les colonnes sont mises en surbrillance.  J'indique le type de "Texte". </li></ol><br>  Une chose qui a gâté beaucoup de sang: si vous sélectionnez par erreur plusieurs séparateurs de champs ou si le mauvais texte est divisé, le fichier peut s'ouvrir correctement, mais il peut être enregistré de manière incorrecte. <br><br>  En plus de Calc, libreOffice est populaire dans les HFLabs, en particulier sous Linux.  Les deux sont utilisés plus activement pour CSV qu'Excel. <br><br><h2>  Bonus track: problèmes lors de l'enregistrement de Calc vers .xlsx </h2><br>  Si vous enregistrez des données de Calc au format Excel .xlsx, gardez à l'esprit - OO parfois inexplicablement et à grande échelle perd des données. <br><br><img src="https://habrastorage.org/webt/yv/bw/7u/yvbw7u8x4lzavz3hztn4pff9wvw.jpeg"><br>  <sub>La friche blanche au milieu est richement remplie de données dans le fichier CSV d'origine</sub> <br><br>  Par conséquent, après avoir enregistré, j'ouvre à nouveau le fichier et m'assure que les données sont en place. <br><br>  Si quelque chose est perdu, le traitement consiste à enregistrer de CSV en .xlsx.  Ou, si Windows est installé, importez de CSV vers Excel et enregistrez à partir de là. <br><br>  Après la ré-enregistrement, je vais certainement vérifier une fois de plus que toutes les données sont en place et qu'il n'y a pas de lignes vides supplémentaires. <br><br>  <i>Si vous souhaitez travailler avec des données, consultez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">nos offres d'emploi</a> .</i>  <i>HFLabs a presque toujours besoin d'analystes, de testeurs, d'ingénieurs d'implémentation, de développeurs.</i>  <i>Nous fournirons des données pour que peu semble :)</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr432906/">https://habr.com/ru/post/fr432906/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr432896/index.html">AXIS P1425-LE Mk II vs IDIS DC-T3233HRXL: Comparez les caméras CCTV</a></li>
<li><a href="../fr432898/index.html">Panoramas sur StereoPi</a></li>
<li><a href="../fr432900/index.html">Caractéristiques du travail dans une équipe internationale. Japon</a></li>
<li><a href="../fr432902/index.html">Échec du vol vers la lune: ce qui est devenu connu sur l'une des missions</a></li>
<li><a href="../fr432904/index.html">Meilleurs employeurs en TI 2018: cote annuelle My Circle</a></li>
<li><a href="../fr432908/index.html">En Russie, ils prévoient d'introduire un contrôle supplémentaire sur les paiements sur Internet</a></li>
<li><a href="../fr432910/index.html">Il est dangereux de considérer la réalité virtuelle comme une machine d'empathie</a></li>
<li><a href="../fr432912/index.html">Comment obtenir un stage chez Google</a></li>
<li><a href="../fr432914/index.html">Un bot de chat très simple pour Telegram pour les plus petits</a></li>
<li><a href="../fr432918/index.html">Désolé, j'ai cassé votre recovery.conf</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>