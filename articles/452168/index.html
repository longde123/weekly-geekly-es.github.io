<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§¥üèº üëçüèΩ üë©‚Äçüë¶ Creando un juego de ritmo en Unity üö∫ ‚õ∫Ô∏è üßìüèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduccion 
 Entonces, quieres o intentaste crear un juego de ritmo, pero los elementos del juego y la m√∫sica r√°pidamente no est√°n sincronizados, y ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Creando un juego de ritmo en Unity</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452168/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/98c/c5f/e21/98cc5fe21847a5826eb9fb9e396e3379.jpg" alt="imagen"></div><br><h1>  Introduccion </h1><br>  Entonces, quieres o intentaste crear un juego de ritmo, pero los elementos del juego y la m√∫sica r√°pidamente no est√°n sincronizados, y ahora no sabes qu√© hacer.  Este art√≠culo te ayudar√° con esto.  Jugu√© juegos de ritmo desde la escuela secundaria y, a menudo, pasaba el rato en DDR en la sala de juegos.  Hoy siempre estoy buscando nuevos juegos de este g√©nero, y proyectos como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Crypt of the Necrodancer</a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Bit.Trip.Runner</a> muestran que se puede hacer mucho m√°s en este g√©nero.  Trabaj√© un poco en prototipos de juegos de ritmo en Unity, y como resultado pas√© un mes creando un juego de ritmo corto / rompecabezas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Atomic Beats</a> .  En este art√≠culo, hablar√© sobre las t√©cnicas de creaci√≥n de c√≥digo m√°s √∫tiles que aprend√≠ al crear estos juegos.  No pude encontrar informaci√≥n sobre ellos en ning√∫n otro lado, o se present√≥ con menos detalle. <br><br>  Primero, debo expresar mi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">profunda</a> gratitud a Yu Chao por la publicaci√≥n de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Music Syncing in Rhythm Games</a> [ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">traducci√≥n al Habr√©</a> ].  Yu revis√≥ los conceptos b√°sicos de la sincronizaci√≥n de los tiempos de audio con el motor del juego en Unity y subi√≥ el c√≥digo fuente de su juego Boots-Cut, que me ayud√≥ mucho a crear mi proyecto.  Puede estudiar su publicaci√≥n si desea obtener una breve introducci√≥n a la sincronizaci√≥n de m√∫sica de Unity, pero abordar√© este tema con m√°s detalle y de manera m√°s extensa.  Mi c√≥digo utiliza activamente la informaci√≥n del art√≠culo y el c√≥digo Boots-Cut. <br><a name="habracut"></a><br>  En el coraz√≥n de cualquier juego de ritmo est√°n los tiempos.  Las personas son extremadamente sensibles a cualquier distorsi√≥n en los tiempos de ritmo, por lo que es muy importante que todas las acciones, movimientos y entradas en el juego de ritmo est√©n directamente sincronizados con la m√∫sica.  Desafortunadamente, los m√©todos tradicionales de seguimiento de tiempo de Unity como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Time.timeSinceLevelLoad</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Time.time perder√°n</a> r√°pidamente la sincronizaci√≥n con el sonido que se est√° reproduciendo.  Por lo tanto, accederemos al sistema de audio directamente usando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">AudioSettings.dspTime</a> , que usa la cantidad real de muestras de audio procesadas por el sistema de audio.  Gracias a esto, siempre mantiene la sincronizaci√≥n con la m√∫sica que se est√° reproduciendo (quiz√°s este no sea el caso con archivos de audio muy largos, cuando entran en juego los efectos de muestreo, pero en el caso de canciones de una duraci√≥n normal, el sistema deber√≠a funcionar perfectamente).  Esta funci√≥n ser√° el n√∫cleo de nuestro seguimiento del tiempo de composici√≥n, y en base a ella crearemos la clase principal. <br><br><h1>  Conductor de clase </h1><br>  La clase Conductor es la clase principal de gesti√≥n de composici√≥n sobre la base de la cual se construir√° el resto del juego de ritmo.  Con √©l, realizaremos un seguimiento de la posici√≥n de la composici√≥n y administraremos todas las dem√°s acciones sincronizadas.  Para rastrear la composici√≥n necesitamos algunas variables <br><br><pre><code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//Song beats per minute //This is determined by the song you're trying to sync up to public float songBpm; //The number of seconds for each song beat public float secPerBeat; //Current song position, in seconds public float songPosition; //Current song position, in beats public float songPositionInBeats; //How many seconds have passed since the song started public float dspSongTime; //an AudioSource attached to this GameObject that will play the music. public AudioSource musicSource;</span></span></code> </pre> <br>  Al comenzar la escena, necesitamos realizar c√°lculos para determinar las variables, y tambi√©n registrar como referencia el tiempo de inicio de la composici√≥n. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//Load the AudioSource attached to the Conductor GameObject musicSource = GetComponent&lt;AudioSource&gt;(); //Calculate the number of seconds in each beat secPerBeat = 60f / songBpm; //Record the time when the music starts dspSongTime = (float)AudioSettings.dspTime; //Start the music musicSource.Play(); }</span></span></code> </pre> <br>  Si crea un GameObject vac√≠o con dicho script adjunto, y luego agrega la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Fuente de audio</a> con la composici√≥n y ejecuta el programa, ver√° que el script registrar√° la hora de inicio de la composici√≥n, pero no suceder√° nada m√°s.  Tambi√©n necesitaremos ingresar manualmente los BPM de la m√∫sica que agreguemos a la fuente de audio. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7fc/3ac/550/7fc3ac5504438ff8bd050c50283250c6.png"></div><br>  Gracias a todos estos valores, podemos rastrear la posici√≥n en la composici√≥n en tiempo real al actualizar el juego.  Determinaremos el tiempo de la composici√≥n, primero en segundos, luego en fracciones.  Las fracciones son una forma mucho m√°s conveniente de rastrear una composici√≥n, ya que nos permiten agregar acciones y temporizaciones en el tiempo en paralelo con la composici√≥n, por ejemplo, en las fracciones 1, 3 y 5.5, sin la necesidad de calcular segundos entre fracciones.  Agregue los siguientes c√°lculos a la funci√≥n Update () de la clase Conductor: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//determine how many seconds since the song started songPosition = (float)(AudioSettings.dspTime - dspSongTime); //determine how many beats since the song started songPositionInBeats = songPosition / secPerBeat; }</span></span></code> </pre> <br>  Entonces obtenemos la diferencia entre la hora actual de acuerdo con el sistema de audio y la hora de inicio de la composici√≥n, que da el n√∫mero total de segundos que se reproduce la composici√≥n.  Lo guardaremos en la variable songPosition. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/84e/f20/a32/84ef20a3208c566d97332c89549c5a7a.png"></div><br>  Tenga en cuenta que la partitura en la m√∫sica generalmente comienza con una unidad con fracciones 1-2-3-4 y as√≠ sucesivamente, y songPositionInBeats comienza en 0 y aumenta a partir de este valor, por lo que la tercera parte de la composici√≥n corresponder√° a songPositionInBeats, que es 2.0, no 3.0. <br><br>  En este punto, si desea crear un juego tradicional de estilo Dance Dance Revolution, debe crear notas de acuerdo con la fracci√≥n en la que necesita presionarlas, interpolar su posici√≥n con respecto a la l√≠nea de clic y luego grabar songPositionInBeats cuando se presiona la tecla, y Compare el valor con la proporci√≥n deseada de notas.  Yu Chao analiza un ejemplo de tal esquema en su <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">art√≠culo</a> .  Para no repetirme, considerar√© otras t√©cnicas potencialmente √∫tiles que se pueden construir sobre la clase de Conductor.  Los us√© al crear <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Atomic Beats</a> . <br><br><h1>  Nos adaptamos a la cuota inicial </h1><br>  Si crea su propia m√∫sica para un juego de ritmo, es f√°cil hacer que el primer ritmo coincida exactamente con el comienzo de la m√∫sica, que, si se especifica correctamente, unir√° de manera confiable la canci√≥n de la clase ConductorPositionInBeats a la composici√≥n. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/56a/acd/dfd/56aacddfd077d0d5890fdea4acb9d667.png"></div><br>  Sin embargo, si usa m√∫sica ya preparada, existe una alta probabilidad de que haya una peque√±a pausa antes del comienzo de la composici√≥n.  Si esto no se tiene en cuenta, la canci√≥n de la clase ConductorPositionInBeats pensar√° que el primer ritmo comenz√≥ cuando comenz√≥ a sonar la canci√≥n, y no el ritmo ahora.  Todo lo que estar√° m√°s vinculado a los valores de las acciones no est√° sincronizado con la m√∫sica. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/981/9cc/e24/9819cce244fe54f954e0205345ec86fb.png"></div><br>  Para solucionar esto, puede agregar una variable que tenga en cuenta este desplazamiento.  Agregue lo siguiente a la clase Conductor: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//The offset to the first beat of the song in seconds public float firstBeatOffset;</span></span></code> </pre> <br>  En Update (), la variable songPosition: <br><br><pre> <code class="cs hljs">songPosition = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)(AudioSettings.dspTime - dspSongTime);</code> </pre> <br>  reemplazado por: <br><br><pre> <code class="cs hljs">songPosition = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)(AudioSettings.dspTime - dspSongTime - firstBeatOffset);</code> </pre> <br>  Ahora songPosition calcular√° correctamente la posici√≥n en la canci√≥n, teniendo en cuenta el verdadero primer tiempo.  Sin embargo, deber√° ingresar manualmente el desplazamiento al primer tiempo, por lo que para cada archivo ser√° √∫nico.  Adem√°s, durante este cambio habr√° una peque√±a ventana en la que songPosition resultar√° negativa.  Es posible que esto no afecte el juego, pero algunos c√≥digos, dependiendo de los valores de songPosition o songPositionInBeats, pueden no ser capaces de procesar n√∫meros negativos en este momento. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/125/bfd/ab7/125bfdab794789a5920f1ef07bea8a26.png"><br><br><h1>  Repeticiones </h1><br>  Si trabaja con una composici√≥n que se reproduce de principio a fin, la clase de Director que se muestra arriba ser√° suficiente para seguir la posici√≥n.  Pero si tiene una pista corta que est√° en bucle y desea trabajar con este bucle, debe incorporar el soporte de repetidor en Conductor. <br><br>  Si tiene un fragmento en bucle perfecto (por ejemplo, si el tempo de la composici√≥n es de 120 lpm y el fragmento en bucle tiene una longitud de 4 latidos, deber√≠a ser exactamente 8,0 segundos a 2,0 segundos por acci√≥n) cargado en la clase de fuente de audio del conductor, luego marque la casilla de bucle.  Conductor funcionar√° de la misma manera que antes, y transferir√° el tiempo total a songPosition despu√©s del <em>primer</em> inicio del clip.  Para determinar la posici√≥n del bucle, necesitamos decirle al conductor cu√°ntas acciones hay en un bucle y cu√°ntos bucles ya se han reproducido.  Agregue las siguientes variables a la clase Conductor: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//the number of beats in each loop public float beatsPerLoop; //the total number of loops completed since the looping clip first started public int completedLoops = 0; //The current position of the song within the loop in beats. public float loopPositionInBeats;</span></span></code> </pre> <br>  Ahora con cada actualizaci√≥n de SongPositionInBeats, tambi√©n podemos actualizar la posici√≥n Update () del bucle. <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//calculate the loop position if (songPositionInBeats &gt;= (completedLoops + 1) * beatsPerLoop) completedLoops++; loopPositionInBeats = songPositionInBeats - completedLoops * beatsPerLoop;</span></span></code> </pre> <br>  Esto nos da un marcador que le dice a loopPositionInBeats cu√°ntos recursos compartimos por el bucle, lo que es √∫til para muchos otros elementos sincronizados.  Recuerde ingresar el n√∫mero de acciones del bucle en GameObject Conductor. <br><br>  Tambi√©n debemos considerar cuidadosamente el c√°lculo de las acciones.  La m√∫sica siempre comienza en 1, por lo que la medici√≥n de 4 partes toma la forma 1-2-3-4-, y en nuestra clase loopPositionInBeats comienza en 0.0 y pasa por encima de 4.0.  Por lo tanto, el centro exacto del bucle, que al calcular las proporciones musicales ser√° 3, en loopPositionInBeats tendr√° un valor de 2.0.  Puede modificar loopPositionInBeats para tener esto en cuenta, pero esto afectar√° a todos los dem√°s c√°lculos, as√≠ que tenga cuidado al insertar notas. <br><br>  Tambi√©n para las herramientas restantes ser√° √∫til agregar dos aspectos m√°s a la clase Conductor.  En primer lugar, una versi√≥n anal√≥gica de LoopPositionInBeats llamada LoopPositionInAnalog, que mide la posici√≥n en el bucle en el rango de 0 a 1.0.  El segundo es una instancia de la clase Conductor para llamadas convenientes desde otras clases.  Agregue las siguientes variables a la clase Conductor: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//The current relative position of the song within the loop measured between 0 and 1. public float loopPositionInAnalog; //Conductor instance public static Conductor instance;</span></span></code> </pre> <br>  En la funci√≥n Despertar (), agregue: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Awake</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { instance = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; }</code> </pre> <br>  y agregue a la funci√≥n Update (): <br><br><pre> <code class="cs hljs">loopPositionInAnalog = loopPositionInBeats / beatsPerLoop;</code> </pre> <br><h1>  Turn Sync </h1><br>  Ser√≠a muy √∫til sincronizar el movimiento o la rotaci√≥n con los l√≥bulos para que los elementos est√©n en los lugares correctos.  En mi juego Atomic Beats, us√© esto para rotar din√°micamente las notas alrededor de un eje central.  Inicialmente, se colocaron alrededor de la circunferencia de acuerdo con su parte dentro del bucle, y luego se rot√≥ toda el √°rea de juego para que las notas coincidieran con la l√≠nea de depresi√≥n en su parte. <br><br>  Para lograr esto, cree un nuevo script llamado SyncedRotation y adj√∫ntelo al GameObject que desea rotar.  Agregue a la funci√≥n Update () del script SyncedRotation: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.gameObject.transform.rotation = Quaternion.Euler(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, Mathf.Lerp(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">360</span></span>, Conductor.instance.loopPositionInAnalog)); }</code> </pre> <br>  Este c√≥digo interpolar√° la rotaci√≥n del GameObject al que est√° vinculado este juego en el rango de 0 a 360 grados, gir√°ndolo para que complete una revoluci√≥n completa al final de cada ciclo.  Esto es √∫til como ejemplo, pero para la animaci√≥n en bucle o cuadro por cuadro, ser√≠a m√°s √∫til sincronizar las animaciones en bucle para que encajen perfectamente con el tempo. <br><br><h1>  Sincronizaci√≥n de animaci√≥n </h1><br>  Unity <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Animator es</a> extremadamente poderoso, pero no siempre es preciso.  Para una alineaci√≥n confiable de animaciones y m√∫sica, tuve que competir con la clase Animator y su tendencia a desincronizarse gradualmente con el ritmo.  Adem√°s, era dif√≠cil ajustar las mismas animaciones a diferentes tempos, de modo que al cambiar entre composiciones, no ten√≠a que redefinir los fotogramas clave de la animaci√≥n al tempo actual.  En cambio, podemos ir directamente al bucle de animaci√≥n y establecer la posici√≥n en este bucle de acuerdo con el lugar en el que nos encontramos en el bucle de la clase Conductor. <br><br>  Primero, cree una nueva clase llamada SyncedAnimation y agr√©guele las siguientes variables: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//The animator controller attached to this GameObject public Animator animator; //Records the animation state or animation that the Animator is currently in public AnimatorStateInfo animatorStateInfo; //Used to address the current state within the Animator using the Play() function public int currentState;</span></span></code> </pre> <br>  Adj√∫ntelo a un GameObject nuevo o existente que desee animar.  En este ejemplo, simplemente moveremos el objeto de un lado a otro de la pantalla, pero el mismo principio se puede aplicar a cualquier animaci√≥n, ya sea antes de establecer la propiedad, o de la animaci√≥n cuadro por cuadro.  Agregue un elemento Animator a GameObject y cree un nuevo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Controlador Animator</a> llamado SyncedAnimController, as√≠ como un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Clip de Animaci√≥n</a> llamado BackAndForth.  Cargamos el controlador en la clase Animator adjunta al GameObject y agregamos Animaci√≥n al √°rbol de animaci√≥n como animaci√≥n predeterminada. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d5f/582/0e3/d5f5820e383580dbc69b18dd037a67a1.png"></div><br>  Por ejemplo, configur√© la animaci√≥n para que primero mueva el objeto a la derecha en 6 unidades, luego a la izquierda en -6 y luego nuevamente a 0. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/dbc/d3a/0b9/dbcd3a0b909bb95cc0a91aaf2eaf65e0.png"></div><br>  Ahora, para sincronizar la animaci√≥n, agregue el siguiente c√≥digo a la funci√≥n Start () de la clase SyncedAnimation, que inicializa la informaci√≥n sobre Animator: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//Load the animator attached to this object animator = GetComponent&lt;Animator&gt;(); //Get the info about the current animator state animatorStateInfo = animator.GetCurrentAnimatorStateInfo(0); //Convert the current state name to an integer hash for identification currentState = animatorStateInfo.fullPathHash; }</span></span></code> </pre> <br>  Luego agregue el siguiente c√≥digo a Update () para configurar la animaci√≥n: <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Update</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//Start playing the current animation from wherever the current conductor loop is animator.Play(currentState, -1, (Conductor.instance.loopPositionInAnalog)); //Set the speed to 0 so it will only change frames when you next update it animator.speed = 0; }</span></span></code> </pre> <br>  Entonces colocamos la animaci√≥n en el cuadro exacto de la animaci√≥n en relaci√≥n con un bucle completo.  Por ejemplo, si usa la animaci√≥n anterior, cuando se encuentra en el medio del bucle, la posici√≥n de GameObject solo cruzar√° 0. Esto se puede aplicar a cualquier animaci√≥n que cree que desee sincronizar con el tempo del Conductor. <br><br>  Tambi√©n vale la pena se√±alar que para crear un bucle continuo de animaciones, debe configurar las tangentes de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fotogramas clave</a> individuales <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de la animaci√≥n</a> en la curva de animaci√≥n.  La configuraci√≥n Lineal crear√° una l√≠nea recta que va de un cuadro clave al siguiente, y Constant mantendr√° la animaci√≥n en un valor hasta el siguiente cuadro clave, lo que dar√° un movimiento brusco y brusco. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f4c/68e/db4/f4c68edb4ab3e874379d8f6874b74fea.png"></div><br>  Aunque este m√©todo es √∫til, afecta a todas las transiciones de la animaci√≥n, ya que hace que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">animationState</a> permanezca en el estado en que estaba cuando se ejecut√≥ el script por primera vez.  Este m√©todo es √∫til para los objetos que solo necesitan usar infinitamente una animaci√≥n sincronizada, pero para crear objetos m√°s complejos con diferentes animaciones sincronizadas, debe agregar c√≥digo que procese estas transiciones y establezca la variable currentState de acuerdo con el estado de animaci√≥n deseado. <br><br><h1>  Conclusi√≥n </h1><br>  Estos son solo algunos de los aspectos que me han sido √∫tiles para crear Atomic Beats.  Algunos de ellos fueron recolectados de otras fuentes o creados por necesidad, pero la mayor√≠a de ellos no los pude encontrar en la forma final, ¬°as√≠ que espero que esto sea √∫til!  Quiz√°s parte de mi sistema ya no sea √∫til en proyectos grandes debido a limitaciones de la CPU o del sistema de audio, pero ser√° una buena base para jugar un atasco o un proyecto de pasatiempo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ae/2a4/f7b/9ae2a4f7be098cc23e5b7283d5b1b9ba.png" alt="imagen"></div><br>  Crear un juego de ritmo o elementos de juego sincronizados con m√∫sica puede ser dif√≠cil.  Para mantener todo a un ritmo constante, es posible que necesite un c√≥digo complicado; un resultado que le permita jugar a un ritmo constante puede ser muy atractivo para el jugador.  Se puede hacer mucho m√°s en este g√©nero que los juegos en el estilo tradicional Dance Dance Revolution, y espero que este art√≠culo te ayude a realizar tales proyectos.  Tambi√©n recomiendo, si es posible, evaluar mi juego <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Atomic Beats</a> .  Lo hice en un mes en la primavera de este a√±o, tiene 8 pistas cortas y es gratis. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/452168/">https://habr.com/ru/post/452168/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452152/index.html">¬øQu√© soluciones tiene Rostelecom para IIoT?</a></li>
<li><a href="../452154/index.html">Cubo virtual: en lugar de OLAP</a></li>
<li><a href="../452158/index.html">TOPchik: un complemento abierto de WordPress para la verificaci√≥n gratuita de las posiciones del sitio para consultas de b√∫squeda, a trav√©s de la API Yandex.XML</a></li>
<li><a href="../452162/index.html">Bot para VK en Python con MySQL en una hora, parte 1</a></li>
<li><a href="../452164/index.html">ModLook: esc√°ner de registro ModBus. Celebrando el 20 aniversario del programa</a></li>
<li><a href="../452172/index.html">Sistemas complejos Alcanzando un nivel cr√≠tico</a></li>
<li><a href="../452174/index.html">El no te necesita</a></li>
<li><a href="../452178/index.html">An√°lisis: 23 errores populares en ingl√©s escrito y c√≥mo evitarlos</a></li>
<li><a href="../452180/index.html">Elevamos el rendimiento de SSD desde las rodillas, d√≥nde hacer clic y por qu√©</a></li>
<li><a href="../452182/index.html">Encuesta de empleados. El principal error</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>