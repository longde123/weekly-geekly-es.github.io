<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôÑ üîâ üë®üèº‚Äçüöí KVM, PCI passthrough, Looking Glass dan semuanya üë®üèæ‚Äçüé§ ü§≤üèª üêÖ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Setelah transisi yang sukses ke pengembang perangkat lunak Linux, momen datang ketika sedikit bekerja, dan juga mengubah OS utama. Kekhawatiran diseba...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>KVM, PCI passthrough, Looking Glass dan semuanya</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433878/"> Setelah transisi yang sukses ke pengembang perangkat lunak Linux, momen datang ketika sedikit bekerja, dan juga mengubah OS utama.  Kekhawatiran disebabkan oleh perangkat lunak necro-platform untuk mendukung proyek yang ada.  Sebagian dari perangkat lunak bekerja melalui anggur.  Namun, ternyata perangkat lunak tertentu menolak untuk bekerja di bawah anggur.  Diputuskan untuk menjalankan perangkat lunak pada mesin virtual QEMU + KVM.  Perangkat lunak mulai berjalan, tetapi bekerja di dalamnya agak tidak nyaman.  Perangkat lunak kartu video virtual tidak berbeda dalam kinerja, dan dukungan grafis 3D sangat sederhana.  Saya harus mengungkap rebana dan mencari jalan keluar. <br><a name="habracut"></a><br><h1>  Alokasikan kartu video terpisah ke sistem tamu! </h1><br>  Tidak butuh waktu lama untuk menemukan jalan keluar, tetapi gagasan untuk memukul rebana dengan lampu sorot ternyata sangat aneh.  Pada topik meneruskan kartu video ke mesin virtual, Internet penuh dengan instruksi dari berbagai waktu dan untuk berbagai perangkat keras.  Apa itu artikel besar di situs Arch Linux <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[0]</a> .  Saya akan memberikan versi singkat dari instruksi untuk meneruskan kartu video. <br><br><h3>  0. Periksa apakah perangkat keras mendukung IOMMU </h3><br>  Misalnya, di sini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[1]</a> . <br><br><h3>  1. Kami menyertakan dukungan IOMMU dalam kernel. </h3><br><div class="spoiler">  <b class="spoiler_title">cat / etc / default / grub</b> <div class="spoiler_text"><blockquote>  GRUB_CMDLINE_LINUX_DEFAULT = "quiet splash amd_iommu = on" <br>  atau <br>  GRUB_CMDLINE_LINUX_DEFAULT = "quiet splash intel_iommu = on" <br></blockquote><br></div></div><br>  Jangan lupa <code>sudo update-grub</code> . <br><br><h3>  2. Kami memilih kartu video dari driver </h3><br>  Kami mencari perangkat yang diperlukan dan melihat driver mana yang menggunakannya. <br><br><div class="spoiler">  <b class="spoiler_title">lspci -nnk</b> <div class="spoiler_text"><blockquote>  <b>04: 00.0</b> Pengontrol kompatibel VGA [0300]: NVIDIA Corporation GT218 [GeForce 210] [ <b>10de: 0a65</b> ] (rev a2) <br>  Driver kernel yang digunakan: <b>nouveau</b> <br>  Modul kernel: nvidiafb, nouveau <br>  <b>04: 00.1</b> Perangkat audio [0403]: NVIDIA Corporation High Definition Audio Controller [ <b>10de: 0be3</b> ] (rev a1) <br>  Driver kernel yang digunakan: <b>snd_hda_intel</b> <br>  Modul kernel: snd_hda_intel <br></blockquote><br></div></div><br>  Tambahkan modul VFIO sehingga mereka dimuat saat boot. <br><br><div class="spoiler">  <b class="spoiler_title">cat / etc / modules |</b>  <b class="spoiler_title">grep vfio</b> <div class="spoiler_text"><blockquote>  vfio <br>  vfio_iommu_type1 <br>  vfio_pci <br>  vfio_virqfd <br></blockquote><br></div></div><br>  Kami mengkonfigurasi modul VFIO sehingga memotong perangkat, mencegah driver utama memuat.  Jika perlu, tambahkan ke daftar hitam driver utama. <br><br><div class="spoiler">  <b class="spoiler_title">cat /etc/modprobe.d/vfio.conf</b> <div class="spoiler_text"><blockquote>  Pilihan vfio-pci id = <b>10de: 0a65,10de: 0be3</b> <br>  blacklist nouveau <br></blockquote><br></div></div><br><h3>  3. Reboot dan periksa apakah semuanya berhasil </h3><br>  IOMMU dihidupkan. <br><br><div class="spoiler">  <b class="spoiler_title">dmesg |</b>  <b class="spoiler_title">grep -e DMAR -e IOMMU -e AMD-Vi</b> <div class="spoiler_text"><blockquote>  DMAR: Teknologi Virtualisasi Intel¬Æ untuk I / O Sutradara <br>  atau <br>  AMD-Vi: Ditemukan IOMMU pada 0000: 00: 00.2 cap 0x40 <br>  AMD-Vi: Memetakan ulang interrupt diaktifkan <br>  AMD-Vi: Lazy IO / TLB flushing diaktifkan <br></blockquote><br></div></div><br>  Perangkat komposit jatuh ke dalam satu grup. <br><br><div class="spoiler">  <b class="spoiler_title">untuk in / sys / kernel / iommu_groups / *;</b>  <b class="spoiler_title">temukan $ a -type l;</b>  <b class="spoiler_title">selesai |</b>  <b class="spoiler_title">sort --version-sort</b> <div class="spoiler_text"><blockquote>  <b>/sys/kernel/iommu_groups/15/devices/0000:01:00.0</b> <b><br></b>  <b>/sys/kernel/iommu_groups/15/devices/0000:01:00.1</b> <br>  /sys/kernel/iommu_groups/16/devices/0000:02:00.0 <br>  /sys/kernel/iommu_groups/17/devices/0000:03:00.0 <br>  <b>/sys/kernel/iommu_groups/18/devices/0000:04:00.0</b> <b><br></b>  <b>/sys/kernel/iommu_groups/18/devices/0000:04:00.1</b> <br></blockquote><br></div></div><br>  Driver KVM dan VFIO dimuat. <br><br><div class="spoiler">  <b class="spoiler_title">lsmod |</b>  <b class="spoiler_title">grep -e kvm -e vfio</b> <div class="spoiler_text"><blockquote><pre> kvm_amd 94208 0
 ccp 90112 1 kvm_amd
 kvm 622592 1 kvm_amd
 vfio_pci 45056 0
 vfio_virqfd 16384 1 vfio_pci
 irqbypass 16384 2 vfio_pci, kvm
 vfio_iommu_type1 24576 0
 vfio 28672 2 vfio_iommu_type1, vfio_pci
</pre></blockquote><br></div></div><br>  Kartu video untuk OS tamu yang ditangkap oleh VFIO. <br><br><div class="spoiler">  <b class="spoiler_title">lspci -nnk</b> <div class="spoiler_text"><blockquote>  <b>04: 00.0</b> Pengontrol kompatibel VGA [0300]: NVIDIA Corporation GT218 [GeForce 210] [ <b>10de: 0a65</b> ] (rev a2) <br>  Driver kernel yang digunakan: <b>vfio-pci</b> <br>  Modul kernel: nvidiafb, nouveau <br>  <b>04: 00.1</b> Perangkat audio [0403]: NVIDIA Corporation High Definition Audio Controller [ <b>10de: 0be3</b> ] (rev a1) <br>  Driver kernel yang digunakan: <b>vfio-pci</b> <br>  Modul kernel: snd_hda_intel <br></blockquote><br></div></div><br><h3>  4. Konfigurasikan QEMU dan luncurkan OS tamu </h3><br><div class="spoiler">  <b class="spoiler_title">Instal, jika belum diinstal</b> <div class="spoiler_text"><blockquote>  sudo apt install qemu-kvm qemu-utils seabios ovmf virt-viewer <br></blockquote></div></div><br><div class="spoiler">  <b class="spoiler_title">Buat disk tempat OS tamu akan diinstal</b> <div class="spoiler_text"><blockquote>  qemu-img create -f raw -o preallocation = guest.img penuh 50G <br>  atau <br>  fallocate -l 50G guest.img <br></blockquote></div></div><br>  Kami memulai mesin virtual tanpa meneruskan kartu video untuk menginstal OS tamu.  Karena ada pemandangan di Looking Glass, maka untuk para tamu ada baiknya memilih Windows 10. Windows 8 / 8.1 menurut data terbaru juga didukung. <br><br><div class="spoiler">  <b class="spoiler_title">vga_qxl.sh</b> <div class="spoiler_text"><blockquote>  #! / bin / bash <br>  rempah-rempah penampil jarak jauh: //127.0.0.1: 5900 &amp; <br>  sudo qemu-system-x86_64 \ <br>  -machine q35, accel = kvm \ <br>  -mengaktifkan-kvm \ <br>  -cpu host, kvm = off, centang \ <br>  -smp cpus = 2, soket = 1, core = 2, utas = 1 \ <br>  -m 6G \ <br>  -rtc base = localtime, clock = host \ <br>  -device piix3-usb-uhci \ <br>  -lengkapan usb-tablet \ <br>  -drive if = pflash, format = mentah, hanya baca, file = / usr / share / OVMF / OVMF_CODE.fd \ <br>  -drive file = 'w10.iso', jika = ide, format = mentah, indeks = 2, media = cdrom, cache = tidak ada \ <br>  -drive file = 'virtio-win-0.1.141_st.iso', jika = ide, format = mentah, indeks = 3, media = cdrom, cache = tidak ada \ <br>  -drive file = 'guest.img', if = ide, format = raw, index = 4, media = disk, cache = writeback \ <br>  -vga qxl \ <br>  -spice port = 5900, addr = 127.0.0.1, disable-ticketing \ <br>  -monitor stdio \ <br>  pengguna -netdev, id = n1, ipv6 = off, smb = "/ media / pengguna / data" \ <br>  -lengkapan e1000, netdev = n1, mac = 67: 77: 78: 88: 89: 99 \ <br>  "$ @" <br></blockquote></div></div><br><h3>  5. Kami meneruskan kartu video ke OS tamu </h3><br>  Untuk memulai, boot dengan dua kartu video.  Kami melihat bahwa kartu yang diteruskan muncul di sistem, meletakkan driver di dalamnya dan memastikan bahwa mereka berfungsi. <br><br><div class="spoiler">  <b class="spoiler_title">vga_qxl_pass.sh</b> <div class="spoiler_text"><blockquote>  #! / bin / bash <br>  rempah-rempah penampil jarak jauh: //127.0.0.1: 5900 &amp; <br>  sudo qemu-system-x86_64 \ <br>  -machine q35, accel = kvm \ <br>  -mengaktifkan-kvm \ <br>  -cpu host, kvm = off, centang \ <br>  -smp cpus = 2, soket = 1, core = 2, utas = 1 \ <br>  -m 6G \ <br>  -rtc base = localtime, clock = host \ <br>  -device piix3-usb-uhci \ <br>  -lengkapan usb-tablet \ <br>  -drive if = pflash, format = mentah, hanya baca, file = / usr / share / OVMF / OVMF_CODE.fd \ <br>  -drive file = 'virtio-win-0.1.141_st.iso', jika = ide, format = mentah, indeks = 3, media = cdrom, cache = tidak ada \ <br>  -drive file = 'guest.img', if = ide, format = raw, index = 4, media = disk, cache = writeback \ <br>  -vga qxl \ <br>  -spice port = 5900, addr = 127.0.0.1, disable-ticketing \ <br>  <b>-perangkat ioh3420, bus = pcie.0, addr = 1c.0, multifungsi = aktif, port = 1, sasis = 1, id = root \</b> <b><br></b>  <b>-device vfio-pci, host = 04: 00.0, bus = root, addr = 00.0, multifungsi = on \</b> <b><br></b>  <b>-device vfio-pci, host = 04: 00.1, bus = root, addr = 00.1 \</b> <br>  -monitor stdio \ <br>  pengguna -netdev, id = n1, ipv6 = off, smb = "/ media / pengguna / data" \ <br>  -lengkapan e1000, netdev = n1, mac = 67: 77: 78: 88: 89: 99 \ <br>  "$ @" <br></blockquote></div></div><br>  Setelah bagaimana kartu video yang diteruskan bekerja, dan di manajer perangkat menulis "Perangkat bekerja dengan baik", kami memulai mesin virtual hanya dengan kartu video yang diteruskan. <br><br><div class="spoiler">  <b class="spoiler_title">vga_pass.sh</b> <div class="spoiler_text"><blockquote>  #! / bin / bash <br>  sudo qemu-system-x86_64 \ <br>  -machine q35, accel = kvm \ <br>  -mengaktifkan-kvm \ <br>  -cpu host, kvm = off, centang \ <br>  -smp cpus = 2, soket = 1, core = 2, utas = 1 \ <br>  -m 6G \ <br>  -rtc base = localtime, clock = host \ <br>  -device piix3-usb-uhci \ <br>  -lengkapan usb-tablet \ <br>  -drive if = pflash, format = mentah, hanya baca, file = / usr / share / OVMF / OVMF_CODE.fd \ <br>  -drive file = 'virtio-win-0.1.141_st.iso', jika = ide, format = mentah, indeks = 3, media = cdrom, cache = tidak ada \ <br>  -drive file = 'guest.img', if = ide, format = raw, index = 4, media = disk, cache = writeback \ <br>  -tidak <b>ada</b> \ <br>  -perangkat ioh3420, bus = pcie.0, addr = 1c.0, multifungsi = aktif, port = 1, sasis = 1, id = root \ <br>  -device vfio-pci, host = 04: 00.0, bus = root, addr = 00.0, multifungsi = on \ <br>  -device vfio-pci, host = 04: 00.1, bus = root, addr = 00.1 \ <br>  -monitor stdio \ <br>  pengguna -netdev, id = n1, ipv6 = off, smb = "/ media / pengguna / data" \ <br>  -lengkapan e1000, netdev = n1, mac = 67: 77: 78: 88: 89: 99 \ <br>  "$ @" <br></blockquote></div></div><br>  Kami menghubungkan monitor ke sana dan mengagumi gambar desktop OS tamu. <br><br><h1>  Tempat di mana keputusan sederhana berakhir </h1><br>  Dan kemudian kesenangan dimulai.  Seseorang, semuanya baik-baik saja, gambarnya sudah hilang dan semuanya sederhana.  Pengalaman saya tersandung dua kali pada tahap kekurangan gambar.  Pertama kali adalah penerusan kartu grafis terintegrasi dari prosesor Intel 6700T HD 530, output video kosong dan kegagalan itu disebabkan oleh fakta bahwa plug-in tidak berfungsi dengan baik.  Kali kedua Nvidia GF210 eksternal terlempar, yang sudah dibeli secara khusus untuk percobaan.  Hasilnya bahkan lebih menarik.  Dalam mode non EFI, kartu video berhasil diteruskan dan bahkan menunjukkan gambar, tetapi mematikan OS tamu <abbr title="sekitar 50 hingga 50">gagal</abbr> . <br><br>  Penerusan berikutnya hanya bisa menggantung tuan rumah.  Beberapa jam googling mudah mengarah pada fakta bahwa masalah pembekuan kartu video cukup umum.  Ini mengarah ke shutdown yang salah dari mesin virtual, dan dengan beberapa kemungkinan bahkan shutdown yang benar.  Sebagai output, disarankan untuk meneruskan dalam mode EFI.  Tetapi VBIOS Nvidia GF210 tidak mendukung EFI ... <br><br><h3>  Menjahit atau tidak menjahit, itulah pertanyaannya </h3><br>  Jangan dijahit.  QEMU mendukung spoofing VBIOS saat meneruskan kartu video.  Tetapi VBIOS masih harus diajarkan untuk mendukung mode EFI.  Biasanya disarankan untuk memeriksa ini sebelum Anda mulai meneruskan kartu video, misalnya di sini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[2]</a> .  Tetapi kita harus berurusan dengan apa yang ada, dan tidak ingin mencari kartu video baru dengan dukungan EFI.  Jadi, Anda perlu menambal VBIOS.  <u>Semua operasi yang dilakukan dengan VBIOS dilakukan dengan risiko Anda sendiri.</u>  Saya menggunakan paket perangkat lunak dan instruksi untuknya dari sini <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[3]</a> .  Setelah membaca VBIOS kita mendapatkan file <code>gt210.rom</code> , tambalan dan pada output kita memiliki <code>gt210_uefi.rom</code> .  Di sinilah Anda perlu menyelipkan kartu video saat memuat mesin virtual. <br><br><div class="spoiler">  <b class="spoiler_title">vga_pass_rom.sh</b> <div class="spoiler_text"><blockquote>  #! / bin / bash <br>  sudo qemu-system-x86_64 \ <br>  -machine q35, accel = kvm \ <br>  -mengaktifkan-kvm \ <br>  -cpu host, kvm = off, centang \ <br>  -smp cpus = 2, soket = 1, core = 2, utas = 1 \ <br>  -m 6G \ <br>  -rtc base = localtime, clock = host \ <br>  -device piix3-usb-uhci \ <br>  -lengkapan usb-tablet \ <br>  -drive if = pflash, format = mentah, hanya baca, file = / usr / share / OVMF / OVMF_CODE.fd \ <br>  -drive file = 'virtio-win-0.1.141_st.iso', jika = ide, format = mentah, indeks = 3, media = cdrom, cache = tidak ada \ <br>  -drive file = 'guest.img', if = ide, format = raw, index = 4, media = disk, cache = writeback \ <br>  -tidak ada \ <br>  -perangkat ioh3420, bus = pcie.0, addr = 1c.0, multifungsi = aktif, port = 1, sasis = 1, id = root \ <br>  -device vfio-pci, host = 04: 00.0, bus = root, addr = 00.0, multifungsi = aktif, <b>romfile = gt210_uefi.rom</b> \ <br>  -device vfio-pci, host = 04: 00.1, bus = root, addr = 00.1 \ <br>  -monitor stdio \ <br>  pengguna -netdev, id = n1, ipv6 = off, smb = "/ media / pengguna / data" \ <br>  -lengkapan e1000, netdev = n1, mac = 67: 77: 78: 88: 89: 99 \ <br>  "$ @" <br></blockquote></div></div><br>  Kami memulai mesin virtual dan mencari. <br><br><h3>  Kegelapan </h3><br>  Output kartu video bersinar dalam gelap.  Sekali lagi, moralitas lulus ujian kegagalan.  Hal pertama yang terlintas dalam pikiran adalah bahwa OS tamu lumpuh saat startup.  Log, aku butuh log-nya.  Untuk melakukan ini, jalankan <code>vga_qxl.sh</code> .  Kami melihat peluncuran sebelumnya.  Dan di sana semuanya baik-baik saja, kecuali bahwa makanan itu ditarik dengan tajam.  Ternyata itu berfungsi, meskipun tidak berhasil.  Gagasan pertama adalah terhubung melalui RDP dan melihat apa yang terjadi di sana, tetapi tetap lebih baik menggunakan VNC, misalnya tightvnc <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[4]</a> .  Kami menginstal VNC, mengkonfigurasi port <code>5600</code> dan meneruskan port ini untuk akses dari host. <br><br><div class="spoiler">  <b class="spoiler_title">vga_vnc_pass_rom.sh</b> <div class="spoiler_text"><blockquote>  #! / bin / bash <br>  sudo qemu-system-x86_64 \ <br>  -machine q35, accel = kvm \ <br>  -mengaktifkan-kvm \ <br>  -cpu host, kvm = off, centang \ <br>  -smp cpus = 2, soket = 1, core = 2, utas = 1 \ <br>  -m 6G \ <br>  -rtc base = localtime, clock = host \ <br>  -device piix3-usb-uhci \ <br>  -lengkapan usb-tablet \ <br>  -drive if = pflash, format = mentah, hanya baca, file = / usr / share / OVMF / OVMF_CODE.fd \ <br>  -drive file = 'virtio-win-0.1.141_st.iso', jika = ide, format = mentah, indeks = 3, media = cdrom, cache = tidak ada \ <br>  -drive file = 'guest.img', if = ide, format = raw, index = 4, media = disk, cache = writeback \ <br>  -tidak ada \ <br>  -perangkat ioh3420, bus = pcie.0, addr = 1c.0, multifungsi = aktif, port = 1, sasis = 1, id = root \ <br>  -device vfio-pci, host = 04: 00.0, bus = root, addr = 00.0, multifungsi = aktif, romfile = gt210_uefi.rom \ <br>  -device vfio-pci, host = 04: 00.1, bus = root, addr = 00.1 \ <br>  -monitor stdio \ <br>  pengguna -netdev, id = n1, <b>hostfwd = tcp: 127.0.0.1: 5600-: 5600,</b> ipv6 = mati, seseorang = "/ media / pengguna / data" \ <br>  -lengkapan e1000, netdev = n1, mac = 67: 77: 78: 88: 89: 99 \ <br>  "$ @" <br></blockquote></div></div><br>  Kami terhubung dan melihat mesin yang berfungsi, hanya monitor yang memiliki Monitor Non-PnP Generik yang aneh (Monitor Universal bukan PnP).  Ada gambar, jadi Anda bisa mencoba menjalankan Looking Glass. <br><br><h3>  Mencari kaca </h3><br>  Meskipun teknologi ini menggunakan OpenGL, tidak ada ruang yang diperlukan setelah gl.  Tetapi Anda perlu membaca instruksi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[5]</a> di situs web proyek.  Untuk OS tamu, unduh layar <b>-</b> ambil aplikasi <b>mencari-glass-host.exe</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[6]</a> , unduh dan instal Microsoft Visual C ++ 2015 Redistributable <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[7]</a> , unduh driver untuk perangkat IVSHMEM <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[8]</a> .  Untuk tuan rumah, kami menambahkan dependensi, mengunduh dan membangun aplikasi klien. <br><br><div class="spoiler">  <b class="spoiler_title">build_looking_glass_a12.sh</b> <div class="spoiler_text"><blockquote>  #! / bin / bash <br>  sudo apt-get install cmake libsdl2-dev libsdl2-ttf-dev nettle-dev libspice-protocol-dev libfontconfig1-dev libx11-dev font-freefont-ttf libconfig-dev <br>  wget <a href="">github.com/gnif/LookingGlass/archive/a12.tar.gz</a> <br>  tar -xf a12.tar.gz <br>  cd LookingGlass-a12 <br>  mkdir client / build <br>  klien cd / build <br>  cmake ../ <br>  membuat <br></blockquote></div></div><br>  Kami memulai mesin virtual dengan perangkat IVSHMEM.  Ukuran memori 32Mb dipilih untuk resolusi 1920x1080. <br><br><div class="spoiler">  <b class="spoiler_title">vga_vnc_lg_pass_rom.sh</b> <div class="spoiler_text"><blockquote>  #! / bin / bash <br>  <b>jika [!</b>  <b>-f / dev / shm / looking-glass];</b>  <b>lalu</b> <b><br></b>  <b>sentuh / dev / shm / looking-glass</b> <b><br></b>  <b>chown `whoami`: kvm / dev / shm / looking-glass</b> <b><br></b>  <b>chmod 660 / dev / shm / looking-glass</b> <b><br></b>  <b>fi</b> <br>  sudo qemu-system-x86_64 \ <br>  -machine q35, accel = kvm \ <br>  -mengaktifkan-kvm \ <br>  -cpu host, kvm = off, centang \ <br>  -smp cpus = 2, soket = 1, core = 2, utas = 1 \ <br>  -m 6G \ <br>  -rtc base = localtime, clock = host \ <br>  -device piix3-usb-uhci \ <br>  -lengkapan usb-tablet \ <br>  -drive if = pflash, format = mentah, hanya baca, file = / usr / share / OVMF / OVMF_CODE.fd \ <br>  -drive file = 'virtio-win-0.1.141_st.iso', jika = ide, format = mentah, indeks = 3, media = cdrom, cache = tidak ada \ <br>  -drive file = 'guest.img', if = ide, format = raw, index = 4, media = disk, cache = writeback \ <br>  -tidak ada \ <br>  -perangkat ioh3420, bus = pcie.0, addr = 1c.0, multifungsi = aktif, port = 1, sasis = 1, id = root \ <br>  -device vfio-pci, host = 04: 00.0, bus = root, addr = 00.0, multifungsi = aktif, romfile = gt210_uefi.rom \ <br>  -device vfio-pci, host = 04: 00.1, bus = root, addr = 00.1 \ <br>  <b>-perangkat ivshmem-plain, memdev = ivshmem, bus = pcie.0 \</b> <b><br></b>  <b>-mencoba memori-backend-file, id = ivshmem, share = aktif, mem-path = / dev / shm / looking-glass, size = 32M \</b> <br>  -monitor stdio \ <br>  pengguna -netdev, id = n1, hostfwd = tcp: 127.0.0.1: 5600-: 5600, ipv6 = mati, seseorang = "/ media / pengguna / data" \ <br>  -lengkapan e1000, netdev = n1, mac = 67: 77: 78: 88: 89: 99 \ <br>  "$ @" <br></blockquote></div></div><br>  Kami terhubung melalui VNC, instal driver pada perangkat IVSHMEM, mungkin driver standar akan diinstal di atasnya, yang terletak di "System Devices".  Kami mulai <b>mencari-kaca-host.exe</b> .  Di host, jalankan <code>./LookingGlass-a12/client/build/looking-glass-client</code> . <br><br>  Mengenai hal ini, sistem dengan NVidia GF210 bekerja untuk saya, dan kemudian Intel HD530 diluncurkan di rute yang sama.  Ada masalah kecil dengan resolusi layar, untuk mengubah ke resolusi langka, misalnya 2048x1152, saya harus menggunakan Custom Resolution Utility <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[9]</a> . <br><br>  Nuansa lain, ketika menambahkan aplikasi <b>mencari-kaca-host.exe</b> ke autoload, Anda perlu mengkonfigurasi login pengguna otomatis, untuk alasan keamanan, OS tamu tidak memungkinkan menangkap layar login. <br><br><h1>  Kata penutup </h1><br>  Jika Anda tidak menetapkan tugas, memperoleh gambar pada output video fisik, maka hasil ini akan cukup untuk mendapatkan mesin virtual yang berfungsi dengan kartu video fisik dan kontrol responsif.  Manajemen dilakukan dari host di jendela terpisah atau di layar penuh.  Namun, ada nuansa. <br><br>  <b>Performa</b> .  Sumber daya overhead untuk virtualisasi dan bukan OS tamu yang paling efisien tidak akan memungkinkan Anda untuk bekerja dengan nyaman pada perangkat keras yang lemah dan sedang-rendah.  Ini akan membutuhkan prosesor yang kuat setidaknya 6-8 core, kartu grafis yang bagus untuk OS tamu, 16GB + RAM, setidaknya 8GB untuk setiap OS.  Dan menari dengan rebana untuk mendapatkan hasil maksimal dari besi. <br>  <b>Sabar</b> .  Jika tidak segera bekerja, maka Anda harus menghabiskan waktu dan waktu dengan sopan.  Cari, baca, coba.  Sekali lagi, lihat, baca, dan coba lagi.  Saya akan meninggalkan beberapa tautan lagi yang saya jumpai, mungkin akan ada beberapa informasi yang lebih berguna.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[10]</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[11]</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">[12]</a> <br><br>  <b>Referensi</b> <br><br>  Perhatian, tautan terbuka di jendela ini. <br><br><a name="L0"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">0. https://wiki.archlinux.org/index.php/PCI_passthrough_via_OVMF</a> <br><a name="L1"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1. https://en.wikipedia.org/wiki/List_of_IOMMU-supporting_hardware</a> <br><a name="L2"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2. https://www.techpowerup.com/vgabios/</a> <br><a name="L3"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">3. https://www.win-raid.com/t892f16-AMD-and-Nvidia-GOP-update-No-requests-DIY.html</a> <br><a name="L4"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4. https://www.tightvnc.com/download.php</a> <br><a name="L5"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">5. https://looking-glass.hostfission.com/quickstart</a> <br><a name="L6"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">6. https://github.com/gnif/LookingGlass/releases</a> <br><a name="L7"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">7. https://www.microsoft.com/en-us/download/details.aspx?id=48145</a> <br><a name="L8"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">8. https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/upstream-virtio/</a> <br><a name="L9"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">9. https://www.monitortests.com/forum/Thread-Custom-Resolution-Utility-CRU</a> <br><a name="L10"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">10. https://heiko-sieger.info/running-windows-10-on-linux-using-kvm-with-vga-passthrough</a> <br><a name="L11"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">11. https://ycnrg.org/vga-passthrough-with-ovmf-vfio/</a> <br><a name="L12"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">12. https://www.reddit.com/r/VFIO/comments/8h352p/guide_running_windows_via_qemukvm_and_intel_gvtg/</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id433878/">https://habr.com/ru/post/id433878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id433868/index.html">Mengapa meteran glukosa Alphabet tidak terbang</a></li>
<li><a href="../id433870/index.html">Mengapa sangat sulit untuk mengukur glukosa secara terus menerus?</a></li>
<li><a href="../id433872/index.html">Akses seluler - menggunakan smartphone dalam sistem kontrol akses</a></li>
<li><a href="../id433874/index.html">Eksperimen Antarmuka Neural JavaScript</a></li>
<li><a href="../id433876/index.html">Presentasi produk tiga dimensi di Three.js untuk yang terkecil</a></li>
<li><a href="../id433880/index.html">Life Hacks for Developers: Menggunakan SQ (Source Qualifier) ‚Äã‚ÄãSecara Efektif di Informatica Power Center</a></li>
<li><a href="../id433884/index.html">Aspek hukum dari pengawasan video: bagaimana cara menghindari masalah dengan hukum</a></li>
<li><a href="../id433886/index.html">Pembelajaran Mesin Python dengan Demo Jupyter Interaktif</a></li>
<li><a href="../id433888/index.html">Penggunaan baterai lithium-ion dalam UPS satu fase</a></li>
<li><a href="../id433892/index.html">FSTEC vs NIST: perlindungan kebocoran di Rusia dan Amerika</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>