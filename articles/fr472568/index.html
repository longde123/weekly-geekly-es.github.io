<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèéÔ∏è ü§≥üèø üìî D√©ploiement d'Apache Ignite Zero: exactement z√©ro? üö¥ üçÜ ü•©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous sommes un d√©partement de d√©veloppement technologique de vente au d√©tail. Une fois, la direction a d√©fini la t√¢che d'acc√©l√©rer les calculs volum√©t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>D√©ploiement d'Apache Ignite Zero: exactement z√©ro?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/472568/"><p><img src="https://habrastorage.org/webt/3n/sz/ql/3nszqltvkgimlabres4hunyxfc0.jpeg"></p><br><p> Nous sommes un d√©partement de d√©veloppement technologique de vente au d√©tail.  Une fois, la direction a d√©fini la t√¢che d'acc√©l√©rer les calculs volum√©triques en utilisant Apache Ignite en conjonction avec MSSQL, et a montr√© un site avec de belles illustrations et des exemples de code Java.  Le site a imm√©diatement aim√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Zero Deployment</a> , dont la description promet des miracles: vous n'avez pas √† d√©ployer manuellement votre code Java ou Scala sur chaque n≈ìud de la grille et √† le red√©ployer √† chaque fois qu'il change.  Au cours du travail, il s'est av√©r√© que Zero Deployment a un usage sp√©cifique, dont je souhaite partager les fonctionnalit√©s.  Sous les r√©flexions de chat et les d√©tails de mise en ≈ìuvre. </p><a name="habracut"></a><br><h2 id="1-postanovka-zadachi">  1. √ânonc√© du probl√®me </h2><br><p>  L'essence du probl√®me est la suivante.  Il existe un annuaire des points de vente pour SalesPoint et un annuaire des produits Sku (Stock Keeping Unit).  Le point de vente a l'attribut "Type de magasin" avec les valeurs "petit" et "grand".  Un assortiment (une liste de produits d'un point de vente) est connect√© (charg√© √† partir d'un SGBD) √† chaque point de vente et des informations sont fournies indiquant que le produit sp√©cifi√© a √©t√© dat√© <br>  exclus de l'assortiment ou ajout√©s √† l'assortiment. </p><br><p>  Il est n√©cessaire d'organiser un cache partitionn√© des points de vente et d'y stocker des informations sur les biens connect√©s pendant un mois √† l'avance.  La compatibilit√© avec le syst√®me de combat n√©cessite que le n≈ìud client Ignite t√©l√©charge les donn√©es, calcule un agr√©gat du type (type de magasin, code produit, jour, nombre de points de vente) et les t√©l√©charge √† nouveau dans le SGBD. </p><br><h2 id="2-izuchenie-literatury">  2. L'√©tude de la litt√©rature </h2><br><p>  Aucune exp√©rience pour le moment, donc je commence √† danser du po√™le.  Autrement dit, avec un examen des publications. </p><br><p>  Un article de 2016 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pr√©sentation d'Apache Ignite: Les premi√®res √©tapes</a> fournissent un lien vers la documentation du projet Apache Ignite et en m√™me temps lui reprochent de cr√©er un flou.  Je l'ai lu plusieurs fois, la clart√© ne vient pas.  Passant au didacticiel de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©marrage</a> officiel, qui <br>  promet avec optimisme "Vous serez op√©rationnel en un tournemain!".  Je comprends les param√®tres des variables d'environnement, regarde deux vid√©os Apache Ignite Essentials, elles se sont av√©r√©es peu utiles pour ma t√¢che sp√©cifique.  Je lance avec succ√®s Ignite √† partir de la ligne de commande avec le fichier standard "example-ignite.xml", je cr√©e la premi√®re <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">application de calcul √† l'</a> aide de Maven.  L'application fonctionne et utilise Zero Deployment, quelle beaut√©! </p><br><p>  J'ai lu plus loin, et l√† l'exemple utilise imm√©diatement affinityKey (cr√©√© plus t√¥t via une requ√™te SQL), et m√™me le myst√©rieux BinaryObject est appliqu√©: </p><br><pre><code class="plaintext hljs">IgniteCache&lt;BinaryObject, BinaryObject&gt; people = ignite.cache("Person").withKeepBinary();</code> </pre> <br><p>  Je lis un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">peu</a> : le format binaire est un peu une r√©flexion, l'acc√®s aux champs d'un objet par son nom.  Il peut lire la valeur d'un champ sans d√©s√©rialiser compl√®tement l'objet (sauvegarde de la m√©moire).  Mais pourquoi BinaryObject est-il utilis√© √† la place de Person, car il n'y a aucun d√©ploiement?  Pourquoi IgniteCache &lt;Cl√©, Personne&gt; est-il traduit en IgniteCache &lt;BinaryObject, BinaryObject&gt;?  Ce n'est pas encore clair. </p><br><p>  Je refais l'application Compute √† mon cas.  La cl√© primaire du r√©pertoire de point de vente dans MSSQL est d√©finie comme [id] [int] NOT NULL, je cr√©e un cache par analogie </p><br><pre> <code class="plaintext hljs">IgniteCache&lt;Integer, SalesPoint&gt; salesPointCache=ignite.cache("spCache")</code> </pre> <br><p>  Dans la configuration xml, j'indique que le cache est partitionn√© </p><br><pre> <code class="plaintext hljs">&lt;bean class="org.apache.ignite.configuration.CacheConfiguration"&gt; &lt;property name="name" value="spCache"/&gt; &lt;property name="cacheMode" value="PARTITIONED"/&gt; &lt;/bean&gt;</code> </pre> <br><p>  Le partitionnement par points de vente suppose que l'agr√©gat requis sera construit sur chaque n≈ìud du cluster pour les enregistrements salesPointCache, apr√®s quoi le n≈ìud client effectuera la sommation finale. </p><br><p>  J'ai lu le tutoriel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">First Ignite Compute Application</a> , je le fais par analogie.  Sur chaque n≈ìud du cluster, je lance IgniteRunnable (), quelque chose comme ceci: </p><br><pre> <code class="plaintext hljs"> @Override public void run() { SalesPoint sp=salesPointCache.get(spId); sp.calculateSalesPointCount(); .. }</code> </pre> <br><p>  J'ajoute une logique d'agr√©gation et de t√©l√©chargement, ex√©cut√©e sur un ensemble de donn√©es de test.  Localement, tout fonctionne sur le serveur de d√©veloppement. </p><br><p>  Je lance deux serveurs de test CentOs, sp√©cifie les adresses IP dans default-config.xml, ex√©cute sur chaque </p><br><pre> <code class="plaintext hljs">./bin/ignite.sh config/default-config.xml</code> </pre> <br><p>  Les deux n≈ìuds Ignite d√©marrent et se voient.  Je sp√©cifie les adresses n√©cessaires dans la configuration xml de l'application cliente, elle d√©marre, ajoute un troisi√®me n≈ìud √† la topologie et imm√©diatement il y a √† nouveau deux n≈ìuds.  Le journal indique "ClassNotFoundException: model.SalesPoint" dans la ligne </p><br><pre> <code class="plaintext hljs">SalesPoint sp=salesPointCache.get(spId);</code> </pre> <br><p>  StackOverflow indique que la cause de l'erreur est que les serveurs CentOs n'ont pas de classe SalesPoint personnalis√©e.  Arriv√©.  Alors, comment n'avez-vous pas √† d√©ployer manuellement votre code Java sur chaque n≈ìud et au-del√†?  Ou votre code Java ne concerne-t-il pas SalesPoint? </p><br><p>  J'ai probablement rat√© quelque chose - je recommence √† chercher, √† lire et √† chercher.  Au fil du temps, on a l'impression que j'ai tout lu sur le sujet, il n'y a rien de nouveau.  En cherchant, j'ai trouv√© des commentaires int√©ressants. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Valentin Kulichenko</a> , architecte en chef chez GridGain Systems, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">r√©ponse</a> √† StackOverflow, avril 2016: </p><br><pre> <code class="plaintext hljs">Model classes are not peer deployed, but you can use withKeepBinary() flag on the cache and query BinaryObjects. This way you will avoid deserialization on the server side and will not get ClassNotFoundException.</code> </pre> <br><p>  Autre avis faisant autorit√©: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Denis Magda</a> , directeur de la gestion des produits, GridGain Systems. </p><br><p>  Un article sur Habr√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sur les microservices</a> fait r√©f√©rence √† trois articles de Denis Magda: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Microservices Part I</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Microservices Part II</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Microservices Part III</a> 2016-2017.  Dans un deuxi√®me article, Denis sugg√®re de d√©marrer un n≈ìud de cluster via MaintenanceServiceNodeStartup.jar.  Vous pouvez √©galement utiliser le lancement avec la configuration xml et la ligne de commande, mais vous devez ensuite placer manuellement des classes personnalis√©es sur chaque n≈ìud de cluster d√©ploy√©: </p><br><pre> <code class="plaintext hljs">That's it. Start (..) node using MaintenanceServiceNodeStartup file or pass maintenance-service-node-config.xml to Apache Ignite's ignite.sh/bat scripts. If you prefer the latter then make sure to build a jar file that will contain all the classes from java/app/common and java/services/maintenance directories. The jar has to be added to the classpath of every node where the service might be deployed.</code> </pre> <br><p>  En effet, c'est tout.  Ici, il s'av√®re, pourquoi, ce myst√©rieux format binaire! </p><br><h2 id="3-singlejar">  3. SingleJar </h2><br><p>  Denis a pris la premi√®re place dans ma note personnelle, √† mon humble avis le tutoriel le plus utile de tous disponibles.  Son <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> MicroServicesExample contient un exemple compl√®tement pr√™t √† l'emploi de configuration de n≈ìuds de cluster, qui se compile sans squats suppl√©mentaires. </p><br><p>  Je le fais √† l'image et √† la ressemblance, j'obtiens un seul fichier jar qui ex√©cute le "n≈ìud de donn√©es" ou le "n≈ìud client" selon l'argument de la ligne de commande.  L'assemblage d√©marre et s'ex√©cute.  Le d√©ploiement z√©ro est vaincu. </p><br><p>  Le passage de m√©gaoctets de donn√©es de test √† des dizaines de gigaoctets de donn√©es de combat a montr√© que le format binaire existe pour une bonne raison.  Il √©tait n√©cessaire d'optimiser la consommation de m√©moire sur les n≈ìuds, et ici BinaryObject √©tait tr√®s utile. </p><br><h2 id="4-vyvody">  4. Conclusions </h2><br><p>  Le premier reproche que nous avons rencontr√© avec la documentation floue du projet Apache Ignite s'est av√©r√© juste, il a un peu chang√© depuis 2016.  Il n'est pas facile pour un d√©butant de construire un prototype fonctionnel bas√© sur un site et / ou un r√©f√©rentiel. </p><br><p>  √Ä la suite du travail effectu√©, il semblait que Zero Deployment fonctionne, mais uniquement au niveau du syst√®me.  Quelque chose comme ceci: BinaryObject est utilis√© pour enseigner aux n≈ìuds de cluster distants comment travailler avec des classes personnalis√©es;  D√©ploiement z√©ro - M√©canisme interne <br>  Apache s'enflamme et distribue les objets syst√®me √† travers le cluster. </p><br><p>  J'esp√®re que mon exp√©rience sera utile aux nouveaux utilisateurs d'Apache Ignite. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr472568/">https://habr.com/ru/post/fr472568/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr472552/index.html">63 c≈ìurs verrouill√©s par sept instructions</a></li>
<li><a href="../fr472556/index.html">Le secret du bonheur des employ√©s est la nature au bureau?</a></li>
<li><a href="../fr472560/index.html">Test de Gestalt: une nouvelle approche pour l'optimisation des listes de diffusion bas√©e sur la th√©orie bay√©sienne et l'apprentissage automatique</a></li>
<li><a href="../fr472562/index.html">Tendances financi√®res: les grandes entreprises ont besoin de plus en plus de professionnels de l'informatique</a></li>
<li><a href="../fr472566/index.html">L'enfer personnel de l'√©crivain Fraerman, ou le conte du premier amour</a></li>
<li><a href="../fr472570/index.html">Intel Xeon W Big Update</a></li>
<li><a href="../fr472572/index.html">DevOps et Chaos: livraison de logiciels dans un monde d√©centralis√©</a></li>
<li><a href="../fr472574/index.html">Cr√©ez votre Minecraft: g√©n√©rez des niveaux 3D √† partir de cubes</a></li>
<li><a href="../fr472576/index.html">XVIe conf√©rence des d√©veloppeurs de logiciels libres ou o√π trouver des contributeurs gratuits</a></li>
<li><a href="../fr472580/index.html">Gestion des services d'entreprise: pourquoi √©tendre la gestion des services au-del√† de l'informatique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>