<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍💻 🐟 🕴🏼 培训Cisco 200-125 CCNA v3.0。 第48天。OSPF多区域 👨‍🔧 👩‍🚀 🖊️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="今天，我们将考虑为多个区域设置OSPFv2 IPv4协议的问题，该问题包含在ICND2主题的第2.4节中。 我们将使用网络拓扑，其中包括7个路由器，其中六个在OSPF协议下运行。 位于最底部的7号路由器采用RIPv2协议。 



 在先前的课程中，我们研究了所有OSPF设备都在一个公共区域中工作的...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>培训Cisco 200-125 CCNA v3.0。 第48天。OSPF多区域</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ua-hosting/blog/466677/">今天，我们将考虑为多个区域设置OSPFv2 IPv4协议的问题，该问题包含在ICND2主题的第2.4节中。 我们将使用网络拓扑，其中包括7个路由器，其中六个在OSPF协议下运行。 位于最底部的7号路由器采用RIPv2协议。 <br><br><img src="https://habrastorage.org/webt/zo/3e/tk/zo3etknflczswh_1tdbkvp15tss.jpeg"><br><br> 在先前的课程中，我们研究了所有OSPF设备都在一个公共区域中工作的网络。 现在，我们将使用几个单独的区域。 <br><br> 路由器R1和R6属于区域45，路由器R5在区域12中工作。这些是为本地网络服务的内部路由器。 路由器R2和R4是ABR边缘路由器。 这些路由器与具有根或骨干区域（数量始终为0）的其余常规区域区域的路由器进行通信。 <a name="habracut"></a><br><br> 从该图可以看出，R3路由器在其设备以RIP协议运行的区域上具有边界。 当组织遵循在其网络中使用RIP或EIGRP协议的其他网络策略时，就会发生这种情况。 将来，您可以将该公司的设备转移到OSPF协议，但是在那之前，您需要以某种方式提供网络与另一公司的计算机之间的通信。 在这种情况下，将使用路由的重新分配或重新分配：将所有OSPF路由重新分配给RIP，并将所有RIP路由重新分配给OSPF。 由于对Cisco重新分配的深入研究不是CCNA计划的一部分，因此我将简要介绍一下。 请记住，如果您的网络使用不同的协议，则必须重新分配路由。 路由器位于使用不同路由协议的区域之间，称为ASBR-自治系统的边缘路由器。 在这种情况下，使用RIP的独立系统。 <br><br>  R6和R2路由器是点对点连接的，它们之间是网络10.1.26.0/24，其中IP地址26的第三个八位位组指示第二（2）和第六（6）路由器的连接。  R1路由器也使用p2p网络10.1.12.0/24连接到R2。  R6和R1路由器通过网络10.1.16.0/24连接。 类似的点对点连接将路由器R3和R7（网络10.1.37.0/24）与路由器R4和R5（网络10.1.45.0/24）连接。 <br><br>  R2网络具有10.1.20.0/24网络。 由于没有其他路由器连接到该网络，因此我将该网络的第三个八位字节分配给20个（路由器2到0个路由器），只是为了表明与路由器R2的连接。 我指定的10.1.50.0/24网络汇总到R5路由器。 <br> 外部网络10.1.20.0/24不支持OSPF。 内部网络10.1.50.0/24支持OSPF，称为被动网络被动网络。 稍后我们将考虑它是什么。 <br><br><img src="https://habrastorage.org/webt/sa/1t/g4/sa1tg4y-rrogn2s7bv1xmbtjltq.jpeg"><br><br> 让我们继续进行Packet Tracer并尝试建立我们由多个区域组成的网络。 在设置过程中，我们将熟悉各种技术。 您可以从本视频教程下方提供的链接下载此拓扑的文件。 <br> 由于我们将不考虑分发，因此这里没有包括受RIP控制的自治网络，仅将三个区域置于OSPF控制下：蓝色区域45，黄色根区域0和绿色区域12。 <br><br> 路由器R1和R6是区域45的内部路由器，路由器R5是区域12的内部路由器。路由器R2和R4是BDR边界路由器。 <br><br><img src="https://habrastorage.org/webt/as/hf/jr/ashfjrotkm6nssm8gkzxlyadip0.jpeg"><br><br> 正如我所说，R2-SW3网络是外部的，不属于OSPF，而SW2-PC0网络是指被动网络。 让我们从R6路由器开始。 由于它是指区域45的内部结构，因此其配置与上一课相同。 如果我只想用一个命令来组织OSPF，则必须在此路由器的设置中输入配置t，路由器ospf 1和网络10.1.0.0 0.0.255.255区域45命令，如果按Enter键会怎样？  Cisco IOS操作系统将评估当前配置，并使OSPF可用于IP地址在10.1的前两个八位位组中的所有接口。 可以通过运行show ospf interface命令来验证。 <br><br><img src="https://habrastorage.org/webt/tc/k7/t9/tck7t9ckkjm7vh3d6pvfqjiqzxe.jpeg"><br><br> 我们看到OSPF在两个接口上运行：FastEthernet 0/0和串行接口Serial 0/3/0。 第一个接口的IP地址为10.1.16.6，第二个接口的IP地址为10.1.26.6。 此处还指示区域号45，网络类型为广播，DR状态和优先级1。专用路由器的接口地址为10.1.26.6，路由器的接口地址为10.1.16.6。 以下是Hello计时器值-10 s和Dead 40c响应间隔的值。 目前，路由器没有邻居，因此它们的邻居计数数为0。 <br><br> 串行接口的说明指出了点对点连接的类型，优先级为0，因为没有举行选举。 也没有DR和BDR，因为它是点对点网络。 邻居数也为0，因为我们没有在其余路由器上运行OSPF。 如果发出show ospf neighbor命令，我们可以验证这一点-邻居表将为空。 <br><br> 通过输入config t和router ospf 10命令，我们将对R1路由器的设置进行相同的操作，我想表明进程标识符不必匹配，我键入10而不是1。我们没有OSPF进程ID 10，对于R6，该值也是等于1，但对于系统而言，这无关紧要，邻居仍将建立。 接下来，我键入命令network 10.1.0.0 0.0.255.255区域45。此后，OSPF将在两个接口上都起作用，并且我们看到GigabitEthernet 0/0已从“加载”状态切换为“完整”状态。 不要被其他路由器接口所迷惑-R1型号2911，因此它具有千兆以太网接口，而路由器R6型号2811。 <br><br><img src="https://habrastorage.org/webt/aj/mi/bc/ajmibchuvumhz-kqtnkbrgiyl6y.jpeg"><br><br> 您会看到R1被选为BDR，因为它的路由器ID为10.1.16.1，较小。 因此，将具有较大RID的路由器选为DR。  Hello定时器为10，即每隔10秒，相邻路由器将交换信息。 还指示与邻居10.1.26.6（即R6路由器）建立了邻接关系。 然后给出了串行接口serial 0/3/0的特性。 如果现在键入show ospf neighbor命令，则可以看到通过GigabitEthernet 0/0接口建立了与R6的邻近性。 <br> 让我们继续R2路由器的设置。 它与路由器R1和R6之间的区别在于R2是位于两个不同区域中的边界ABR路由器。 我们以与R1和R6路由器相同的方式配置OSPF-键入路由器ospf 1和网络10.1.0.0 0.0.255.255命令。 然后出现问题，您需要输入哪个区域编号。 如果在命令末尾键入区域0，则系统将查找IP地址包含10.1的所有接口，并在我指定的区域（即区域0）中启动OSPF。但是，这根本不是我们所需要的。 我们只希望两个串行接口可与区域45一起使用，R6和R1路由器连接到该区域，而交换机所连接的FastEthernet接口仅与区域0一起使用。 <br><br><img src="https://habrastorage.org/webt/sh/vu/5x/shvu5xflgjatumky_llunnqb-bm.jpeg"><br><br> 为此我们能做什么？ 像以前一样更改反掩码，并使用值0.0.127.255而不是0.0.255.255。 对于我们所有的设备，IP地址的前两个八位位组是相同的，不同之处在于第三个八位位组。 在区域45中，它们是数字26和12，在区域0-234中。使用反掩码中的数字127，对于前两个八位字节，我们得到0，对于第三个八位位组的第一位，我们得到零。 值26和12对应于第三个八位位组的第一个零位，但是数字234表示IP地址的第三个八位位组的第一个位为1。因此，使用的反掩码只会影响IP地址10.1.26.0和10.1.12.0，但是不会影响IP地址10.1.234.0。 因此，我实现了目标-OSPF将仅在区域45中的路由器接口上工作，并且与根区域0中的路由器接口R2没有任何关系。 <br><br> 我可以通过键入network 10.1.26.2 0.0.0.0 area 45命令来使用另一种方法，该特定的反向掩码值意味着IP地址为10.1.26.2的任何网络或接口都只能在区域45中工作。并使用do show ip ospf interface命令检查结果。 <br><br><img src="https://habrastorage.org/webt/js/yh/2b/jsyh2bel6bv11se3lxkiwqqrssg.jpeg"><br><br> 我们看到R6路由器连接到的Serial 0/3/0接口现在可以在OSPF协议下工作，并且属于区域45。 <br><br> 接下来，我使用network 10.1.12.2 0.0.0.0 area 45命令在R1路由器所连接的接口上启动OSPF。 <br><br> 区别在于，与10.1.234.0/24网络连接的接口必须在区域0中工作。在这里，几乎使用相同的命令，但IP地址和区域号除外：network 10.1.234.2 0.0.0.0 area 0因此，当两个接口在区域45中使用此协议，而一个接口在区域0中使用时，我们在多个区域中创建了OSPF。 <br> 如果键入do show ip ospf interface，我们将看到OSPF现在在3个接口上运行。 这些是区域0中的Serial 0/3/1，序列0/3/0和区域0中的FastEthernet 0/0。要查看使用的协议，我键入show ip route命令，我们看到所有可用的网络都使用通用的OSPF协议。 。 <br><br><img src="https://habrastorage.org/webt/fa/m2/ze/fam2zeuchx6efvymvl18bwho6ce.jpeg"><br><br> 我注意到，与网络10.1.16.0进行通信，即与交换机SW1进行通信时，使用OSPF接口10.1.26.6和10.1.12.1。  OSPF根据路由成本提供负载平衡。 从R2的角度来看，到路由器R6的路由成本为64，与路由R2-R1的成本相同。 因此，在蓝色网络中，路由的成本是相同的，并且在第1节中将其添加到交换机SW1中，每条路由的总成本变为65。这就是IP地址10.1.16.0：110后面方括号中的数字，这是默认的管理距离，而65是到达SW1的路线费用。 如果OSPF看到两条成本相同的路由，则两条路由都将包含在路由表中。 这样就实现了负载平衡：定向到10.1.16.0/24网络的所有流量都将平均分配到两条路由上。 <br><br> 一个重要的功能是10.1.20.0网络。 让我们看看R6路由器对网络的了解。 多亏有了OSPF，他知道网络10.1.12.0，尽管他没有直接连接到该网络。 他还“知道”网络10.1.234.0，在表示OSPF协议的字母“ O”旁边，我们看到字母IA，它表示“ OSPF区域间”。 这意味着该网络属于另一个区域，也就是说，它不在区域45中。该网络在区域0中，因此将其路径指定为区域间OSPF路由。 <br><br><img src="https://habrastorage.org/webt/39/gh/zy/39ghzyjjqk8e1krarwd7uavkpl4.jpeg"><br><br> 通往SW3交换机的网络10.1.20.0直接连接到R2路由器，但是它不在OSPF路由表中，因为它不参与OSPF。 <br><br> 让我们继续R4路由器。 它也位于两个区域中，因此我们将对其进行类似于R2路由器的配置。 为此，我将输入config t，路由器ospf 1，网络10.1.45.4 0.0.0.0区域12和网络10.1.234.4 0.0.0.0区域0。 <br><br>  show ip ospf interface命令显示OSPF在2个接口上运行：区域12中的串行0/3/0和区域0中的FastEthernet 0/0。在多个区域中组织OSPF时输入这些命令时最常见的错误之一是错误的区域号，因此请始终在纸质网络图中检查参数，以确保命令中的区域号与拓扑中列出的数字相对应。 <br><br> 接下来，我们转到R5路由器。 让我们看一下网络10.1.20.0和网络10.1.50.0之间的区别。 第一个网络不参与OSPF，第二个网络参与。 网络10.1.20.0不接收来自路由器R2的Hello消息，因为它不使用OSPF。 即使将另一个路由器连接到SW3交换机并在其上启用OSPF模式，R2仍将看不到它，因为它不会通过该网络发送Hello。 <br><br> 让我们通过发出config t，路由器ospf 1和网络10.1.0.0 0.0.255.255 area 12命令为R5路由器配置OSPF，并使用show ip ospf interface命令查看导致的结果。 如预期的那样，OSPF在两个接口上运行：区域12的FastEthernet 0/0和Serial 0/3/0。 <br><br> 让我们看看拓扑变化如何在R6路由器的路由表中反映出来。 该路由器“知道”接口10.1.45.0-它是R5，地址为10.1.50.0的交换机SW2和地址10.1.234.0的交换机SW0。 所有这些设备都支持OSPF，因此很自然。 但是，这可能会导致我们的网络出现问题。 <br><br> 让我们看一下R5路由器-它每10秒通过10.1.50.0网络发送一次Hello数据包，但是PC0不响应它们，因为它不支持OSPF。 问题在于PC0通过常规的墙壁插座连接到网络，“坏蛋”可以连接到该墙壁插座。 他可以使用计算机来更改OSPF的设置和路由表，因为这很容易做到。 <br><br><img src="https://habrastorage.org/webt/xf/sd/vm/xfsdvmmnvunlmcxbtrsekopdrg0.jpeg"><br><br> 通过连接计算机而不是PC0，他可以说服R5路由器拥有最高优先级并提供最佳路由，并且R5将向他发送所有网络流量。 因此，黑客可以破坏您的整个网络。 因此，作为网络管理员，必须阻止将Hello数据包分发到那些未连接路由器的接口。 <br><br> 防止这种可能性的另一种方法是身份验证。 假设某台计算机连接到黄色网络开关SW0。 由于此网络上的所有设备都是邻居，因此它们交换Hello数据包。 攻击者可以拦截此类数据包，并作为伪路由器连接到网络。 如果使用身份验证，则在收到Hello数据包后，必须在设备上输入密码以建立邻居关系。 这种身份验证不在CCNA课程范围之内，因此我们将考虑另一种解决OSPF网络中未经授权的干扰的方法，称为“被动接口”。 这是OSPF的一部分，但未建立邻居关系。 <br><br> 要创建一个被动接口，我进入R5设置并依次输入命令config t，路由器ospf 1，被动接口fastEthernet 0/0。 同时，仍然可以通过OSPF协议访问10.1.50.0网络-通过查看R6路由器的接口可以看到这一点。 但是，现在R5路由器不向其发送Hello数据包。 您可以通过在R5设置中输入show ip ospf interface命令来验证这一点。 <br><br><img src="https://habrastorage.org/webt/uf/75/a3/uf75a3rq4-gnkm8yp6b4uu7rozk.jpeg"><br><br> 我们看到Hello数据包将在5秒内发送出去，但是系统在上面报告说，对于FastEthernet 0/0接口，Hello数据包被拒绝，因为它是一个被动接口。 <br><br><img src="https://habrastorage.org/webt/5i/hv/hp/5ihvhpl1k0rvyxvacak8f3axt6u.jpeg"><br><br> 如果您在考试中遇到问题，如何确定这是否是被动界面，那么当您在界面规范中看到“ No Hellos”消息时，您可以放心地回答它是被动界面。 <br><br> 假设您有20个网络，并且只需要1个被动接口。 在这种情况下，您输入一个命令，例如网络10.1.0.0 0.0.255.255区域12，包括所有接口上的OSPF，然后转到特定接口并使用Passive-interface命令。 <br><br> 如果您有15个网络，并且希望5个接口支持OSPF，而其他10个是被动的，则默认情况下可以组织无源性。 <br><br> 为此，在R5设置中，您需要依次输入config t，路由器ospf 1和被动接口默认命令。 这意味着默认情况下，该路由器的所有接口都是被动的。 为了组织OSPF，即激活特定接口发送Hello报文，需要使用no Passive-interface命令。 <br> 因此，有两种创建被动接口的方法：在所有接口上启用OSPF模式，并手动分配一个被动接口，或者默认情况下使所有接口为被动，然后为所选接口取消此模式。 <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/HE03E-FzXuo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> 感谢您与我们在一起。 你喜欢我们的文章吗？ 想看更多有趣的资料吗？ 通过下订单或将其推荐给您的朋友来支持我们，为我们为您<b>开发的独特入门级服务器模拟为Habr用户</b>提供<b>30％的折扣：</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">关于VPS（KVM）E5-2650 v4（6核）的全部真相10GB DDR4 240GB SSD 1Gbps从$ 20还是如何划分服务器？</a>  （RAID1和RAID10提供选件，最多24个内核和最大40GB DDR4）。 <br><br>  <b>戴尔R730xd便宜2倍？</b> 仅<b>在荷兰，</b>我们有<b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">2台Intel TetraDeca-Core Xeon 2x E5-2697v3 2.6GHz 14C 64GB DDR4 4x960GB SSD 1Gbps 100电视</a> ！</b>  <b><b>戴尔R420-2x E5-2430 2.2Ghz 6C 128GB DDR3 2x960GB SSD 1Gbps 100TB-$ 99起！</b></b> 阅读有关<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">如何构建基础架构大厦的信息。</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">使用价格为9000欧元的Dell R730xd E5-2650 v4服务器的上等课程？</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN466677/">https://habr.com/ru/post/zh-CN466677/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN466667/index.html">上周第379期（2019年9月2日至8日）来自前端世界的新鲜材料摘要</a></li>
<li><a href="../zh-CN466669/index.html">特斯拉开发无需更换即可运行160万公里的电池</a></li>
<li><a href="../zh-CN466671/index.html">PHP文摘第164号（2019年8月27日至9月9日）</a></li>
<li><a href="../zh-CN466673/index.html">培训Cisco 200-125 CCNA v3.0。 第46天。OSPF性能检查</a></li>
<li><a href="../zh-CN466675/index.html">培训Cisco 200-125 CCNA v3.0。 第47天。OSPF故障排除</a></li>
<li><a href="../zh-CN466679/index.html">培训Cisco 200-125 CCNA v3.0。 第49天。EIGRP简介</a></li>
<li><a href="../zh-CN466681/index.html">培训Cisco 200-125 CCNA v3.0。 第50天。配置EIGRP</a></li>
<li><a href="../zh-CN466683/index.html">9月9日至15日在莫斯科举行的数字活动</a></li>
<li><a href="../zh-CN466685/index.html">看到钱</a></li>
<li><a href="../zh-CN466689/index.html">如何在移动MMO Action中创建角色类</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>