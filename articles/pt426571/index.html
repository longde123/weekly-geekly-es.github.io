<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò≤ üôáüèª üï¶ Uma abordagem sistem√°tica da velocidade: medi√ß√µes on-line no front-end üß§ üôéüèΩ üë•</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O comando Yandex speed otimiza manualmente os resultados da pesquisa. Faz√™-lo √†s cegas √© dif√≠cil e muitas vezes simplesmente in√∫til. Portanto, a empre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Uma abordagem sistem√°tica da velocidade: medi√ß√µes on-line no front-end</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jugru/blog/426571/">  O comando Yandex speed otimiza manualmente os resultados da pesquisa.  Faz√™-lo √†s cegas √© dif√≠cil e muitas vezes simplesmente in√∫til.  Portanto, a empresa construiu uma infraestrutura para coletar m√©tricas, testar a velocidade e analisar os dados. <br><br>  Sobre quais m√©tricas devem ser usadas e como otimizar tudo, o desenvolvedor do Yandex interfaces <b>Andrei Prokopyuk</b> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=" class="user_link">Andre_487</a> ). <br><br><img src="https://habrastorage.org/webt/jh/gn/r4/jhgnr48w9fhjphnfjkjcggtsdds.png"><br><br>  O material √© baseado no discurso de Andrey na confer√™ncia do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HolyJS</a> .  Sob o corte - e v√≠deo, e uma vers√£o em texto do relat√≥rio. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/Whm2FMBIgA0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote>  Al√©m deste relat√≥rio sobre medi√ß√µes on-line, h√° um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">relat√≥rio de Alexei Kalmakov</a> (tamb√©m da Yandex) sobre medi√ß√µes off-line; nesse caso, n√£o h√° vers√£o em texto, mas um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">v√≠deo</a> est√° dispon√≠vel. </blockquote><br><br>  Os resultados da pesquisa Yandex consistem em muitos blocos diferentes, classes de respostas para consultas de usu√°rios.  Mais de 50 pessoas trabalham neles na empresa e, para que a taxa de emiss√£o n√£o caia, cuidamos constantemente do desenvolvimento. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/044/4e1/e2a/0444e1e2a6db39e37b9c2a085c7433db.jpg"><br><br>  Ningu√©m argumentar√° que os usu√°rios gostam mais da interface r√°pida do que da lenta.  Por√©m, antes de come√ßar a otimizar, √© importante entender como isso afetar√° seus neg√≥cios.  Os desenvolvedores precisam gastar tempo acelerando a interface se isso n√£o afetar as m√©tricas de neg√≥cios? <br><br>  Para responder a essa pergunta, vou contar duas hist√≥rias. <br><br><h2>  Hist√≥rico da introdu√ß√£o de uma fonte da web espec√≠fica na emiss√£o </h2><br>  Ap√≥s estabelecer um experimento com fontes, descobrimos que o tempo m√©dio para renderiza√ß√£o do conte√∫do se deteriorou em 3%, em 62 milissegundos.  N√£o tanto se voc√™ tomar um delta no v√°cuo.  O atraso percept√≠vel a olho nu come√ßa com apenas 100 milissegundos - e, no entanto, o tempo at√© o primeiro clique aumentou imediatamente um por cento e meio. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4ef/2b5/548/4ef2b5548ae1789980552312d0b92857.jpg"><br><br>  Os usu√°rios come√ßaram a interagir mais tarde com a p√°gina.  O n√∫mero de p√°ginas clicadas diminuiu quase meio por cento.  O tempo de presen√ßa no servi√ßo foi reduzido e o tempo de aus√™ncia foi aumentado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c15/215/b5f/c15215b5fb72633582890da9e018d4a4.jpg"><br><br>  N√£o come√ßamos a implementar o recurso com fontes.  Afinal, esses n√∫meros parecem pequenos at√© voc√™ lembrar a escala do servi√ßo.  Na realidade, um por cento e meio - centenas de milhares de pessoas. <br><br>  Al√©m disso, a velocidade tem um efeito cumulativo.  Para uma atualiza√ß√£o com uma parcela de n√£o reclamados - 0,4% seguir√° cada vez mais.  No Yandex, esses recursos s√£o lan√ßados em dezenas por dia e, se voc√™ n√£o lutar por cada compartilhamento, ele n√£o durar√° muito e atingir√° 10%. <br><br><h2>  Hist√≥rico de armazenamento em cache do LS </h2><br>  Essa hist√≥ria est√° relacionada ao fato de incorporarmos muito conte√∫do est√°tico na p√°gina. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c33/3fd/7d2/c333fd7d205cc0695c8934cb0111c820.jpg"><br><br>  Devido √† sua alta variabilidade, n√£o podemos compil√°-lo em um √∫nico pacote ou entreg√°-lo com recursos externos.  A pr√°tica demonstrou que, com a entrega em linha, a renderiza√ß√£o e a inicializa√ß√£o do JavaScript s√£o as mais r√°pidas. <br><br>  Uma vez que decidimos que usar um reposit√≥rio de navegador seria uma boa ideia.  Coloque tudo no localStorage e, nas entradas subsequentes da p√°gina, carregue-o a partir da√≠ e n√£o o transmita pela rede. <br><br>  Depois, focamos principalmente nas m√©tricas "tamanho HTML" e "tempo de entrega HTML" e obtivemos bons resultados.  Com o passar do tempo, inventamos novos m√©todos de medir velocidade, adquirimos experi√™ncia e decidimos verificar novamente, realizar um experimento reverso, desativando a otimiza√ß√£o. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b9/37c/2c9/3b937c2c9c4f0a85c2e76a26d6fdfacf.jpg"><br><br>  O tempo m√©dio de entrega de HTML (a principal m√©trica no momento do desenvolvimento da otimiza√ß√£o) aumentou 12%, o que √© muito.  Mas, ao mesmo tempo, o tempo at√© o cabe√ßalho ser desenhado, antes da an√°lise do conte√∫do come√ßar e antes da inicializa√ß√£o do JavaScript.  Tamb√©m reduziu o tempo para o primeiro clique.  A porcentagem √© pequena - 0,6, mas se voc√™ se lembrar da escala ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f88/35c/0fd/f8835c0fdce5780914f129f41f445f8d.jpg"><br><br>  Ao desativar a otimiza√ß√£o, obtivemos uma piora na m√©trica, percept√≠vel apenas para especialistas e, ao mesmo tempo, uma melhoria percept√≠vel para o usu√°rio. <br><br>  As seguintes conclus√µes podem ser tiradas disso: <br><br>  Primeiro, a velocidade afeta realmente os neg√≥cios e as m√©tricas de neg√≥cios. <br><br>  Em segundo lugar, as otimiza√ß√µes devem ser precedidas de medi√ß√µes.  Se voc√™ implementar algo, depois de fazer medi√ß√µes ruins, √© prov√°vel que voc√™ n√£o fa√ßa nada √∫til.  A composi√ß√£o do p√∫blico, a frota de dispositivos, os cen√°rios de intera√ß√£o e as redes s√£o diferentes em todos os lugares, e voc√™ precisa verificar o que exatamente funcionar√° para voc√™. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0bf/2c6/06b/0bf2c606bacfb7bc5769594fbc326a52.jpg"><br><br>  Certa vez, Ash nos ensinou desde os mortos sinistros primeiro a atirar, depois a pensar ou n√£o pensar.  Em velocidade, voc√™ n√£o precisa fazer isso. <br><br>  E o terceiro ponto: as medi√ß√µes devem refletir a experi√™ncia do usu√°rio.  Por exemplo, o tamanho do HTML e o tempo de entrega s√£o m√©tricas de velocidade ruins, porque o usu√°rio n√£o se senta no devTools e n√£o seleciona um servi√ßo com menos atraso.  Mas quais m√©tricas s√£o boas e corretas - contaremos mais adiante. <br><br><h2>  O que e como medir? </h2><br>  As medi√ß√µes devem come√ßar com algumas m√©tricas importantes que, diferentemente do tamanho do HTML, est√£o pr√≥ximas da experi√™ncia do usu√°rio. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ec1/3c5/783/ec13c57830d7b1b3b8380273dda5bbc8.jpg"><br><br>  Se TTFCP (tempo para a primeira pintura completa do conte√∫do) e TTFMP (tempo para a primeira pintura significativa) indicam o tempo at√© a primeira renderiza√ß√£o do conte√∫do e o tempo antes da renderiza√ß√£o do conte√∫do significativo, ent√£o o terceiro √© o tempo antes da inicializa√ß√£o da estrutura, vale a pena explicar. <br><br>  Este √© o momento em que a estrutura j√° passou pela p√°gina, coletou todos os dados necess√°rios e travou os manipuladores.  Se o usu√°rio clicar em algum lugar naquele momento, ele receber√° uma resposta din√¢mica. <br><br>  E a √∫ltima, quarta m√©trica, o tempo at√© a primeira interatividade, geralmente √© chamada de tempo para interatividade (TTI). <br><br>  Essas m√©tricas, diferentemente do tamanho html ou do tempo de entrega, est√£o pr√≥ximas da experi√™ncia do usu√°rio. <br><br><h2>  Hora de pintar primeiro o conte√∫do completo </h2><br>  Para medir o tempo em que o usu√°rio viu o primeiro conte√∫do na p√°gina, existe uma API de tempo de pintura, dispon√≠vel at√© agora apenas no cromo.  Os dados dele podem ser obtidos da seguinte maneira. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e16/80a/c27/e1680ac270e35eaad20070c90e47066d.jpg"><br><br>  Com essa chamada, obtemos um conjunto de eventos de renderiza√ß√£o.  At√© agora, dois tipos de eventos s√£o suportados: primeira pintura - qualquer renderiza√ß√£o e primeira pintura com conte√∫do completo - qualquer renderiza√ß√£o de conte√∫do que n√£o seja o fundo branco da guia vazia e o conte√∫do de fundo da p√°gina. <br><br>  Portanto, obtemos uma s√©rie de eventos, filtramos a tinta primeiro e o conte√∫do completo e enviamos com um determinado ID. <br><br><h2>  Hora da primeira pintura significativa </h2><br>  N√£o h√° nenhum evento na API de sincroniza√ß√£o do Paint sinalizando que um conte√∫do significativo foi renderizado na p√°gina.  Isso se deve ao fato de que esse conte√∫do em cada p√°gina √© diferente.  Se estamos falando de servi√ßo de v√≠deo, o principal √© o player, nos resultados da pesquisa - o primeiro resultado que n√£o √© de publicidade.  Existem muitos servi√ßos e uma API universal ainda n√£o foi desenvolvida.  Mas aqui muletas boas e comprovadas entram em jogo. <br><br>  Existem duas escolas de muletas no Yandex para medir essa m√©trica: usando RequestAnimationFrame e medindo com InterceptionObserver. <br><br>  No RequestAnimationFrame, a renderiza√ß√£o √© medida usando um intervalo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/22b/dfe/945/22bdfe945df84617220936267638cc21.jpg"><br><br>  Suponha que haja algum conte√∫do significativo.  Aqui est√° uma div com o conte√∫do principal da classe.  Um script √© colocado na frente dele, em que RequestAnimationFrame √© chamado duas vezes. <br><br>  No retorno de chamada da primeira chamada, escreva o limite inferior do intervalo.  No retorno de chamada do segundo - o topo.  Isso ocorre devido √† estrutura de quadros que o navegador renderiza. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/79d/783/a88/79d783a883b6a718095228cfbea29469.jpg"><br><br>  O primeiro √© a execu√ß√£o do JavaScript, a an√°lise dos estilos e o c√°lculo do layout, renderiza√ß√£o e composi√ß√£o. <br><br>  O retorno de chamada, chamando RequestAnimationFrame, √© ativado no mesmo est√°gio do JavaScript e o conte√∫do √© renderizado na √∫ltima se√ß√£o do quadro durante a composi√ß√£o.  Portanto, na primeira chamada, obtemos apenas o limite inferior, visivelmente removido no tempo da sa√≠da de pixels na tela. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/81c/788/f38/81c788f38c68e241cf3a34612503f9d0.jpg"><br><br>  Coloque dois quadros lado a lado.  Pode-se ver que no final do primeiro deles o conte√∫do foi renderizado.  Anotamos a borda inferior de RequestAnimationFrame, chamada dentro do primeiro retorno de chamada e o retorno de chamada no segundo quadro.  Assim, obtemos o intervalo do JavaScript chamado no quadro em que o conte√∫do foi renderizado para JavaScript no segundo quadro. <br><br><h2>  InterceptionObserver </h2><br>  Nossa segunda muleta com o mesmo conte√∫do funciona de maneira diferente.  Desta vez, o script √© colocado abaixo.  Nele, criamos InterceptionObserver e assinamos o domNode. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fd6/dea/87d/fd6dea87dd53e374e2ba19aa79d4a379.jpg"><br><br>  Como n√£o passamos par√¢metros adicionais, medimos sua interse√ß√£o com a viewport.  Esse tempo √© registrado como o tempo exato da renderiza√ß√£o. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/549/5ab/d02/5495abd0268d0d59077d00ade282989a.jpg"><br><br>  Isso funciona porque a interse√ß√£o do conte√∫do principal e da janela de visualiza√ß√£o √© a interse√ß√£o exata que o usu√°rio v√™.  Essa API foi projetada para saber exatamente quando um usu√°rio viu um an√∫ncio, mas nossa pesquisa mostrou que isso tamb√©m funciona em blocos que n√£o s√£o de an√∫ncios. <br><br>  Desses dois m√©todos, ainda √© melhor usar o RequestAnimationFrame: seu suporte √© mais amplo e √© testado por n√≥s na pr√°tica. <br><br><h2>  Js inited </h2><br>  Imagine uma estrutura que tenha algum tipo de evento ‚Äúinit‚Äù no qual voc√™ possa se inscrever, mas lembre-se de que, na pr√°tica, o JS Inited √© uma m√©trica simples e complexa. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3bf/6fe/85c/3bf6fe85c743f0ad6c255d8e4c448eae.jpg"><br><br>  Simples - porque voc√™ s√≥ precisa encontrar o momento em que a estrutura terminou a organiza√ß√£o dos eventos.  Complexo - porque voc√™ precisa procurar esse ponto por conta pr√≥pria para cada estrutura. <br><br><h2>  Tempo para interativo </h2><br>  O TTI costuma ser confundido com a m√©trica anterior, mas, na verdade, √© um indicador do momento em que o fluxo principal do navegador √© lan√ßado.  Durante o carregamento da p√°gina, muitas tarefas s√£o executadas: da renderiza√ß√£o de v√°rios elementos √† inicializa√ß√£o da estrutura.  Somente quando √© descarregado √© que chega a primeira interatividade. <br><br>  O conceito de tarefas longas e a API de tarefas longas ajudam a medir isso. <br><br>  Primeiro sobre as longas tarefas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f79/67b/828/f7967b8283a7302b1d8d9b1bd076cfac.jpg"><br><br>  Entre as breves tarefas indicadas pelas setas, o navegador pode empacotar facilmente o processamento de um evento do usu√°rio, por exemplo, entrada, porque possui uma alta prioridade.  Mas com as longas tarefas indicadas pelas setas vermelhas, isso n√£o funcionar√°. <br><br>  O usu√°rio ter√° que esperar at√© que se esgote e somente depois que o navegador iniciar o processamento de sua entrada.  Ao mesmo tempo, a estrutura j√° pode ser inicializada e os bot√µes funcionar√£o, mas lentamente.  Uma resposta t√£o adiada √© uma experi√™ncia do usu√°rio bastante desagrad√°vel.  No momento em que a √∫ltima Tarefa Longa √© conclu√≠da e o encadeamento fica vazio por um longo tempo, a ilustra√ß√£o aparece em 7 segundos e 300 milissegundos. <br><br>  Como medir esse intervalo dentro do JavaScript? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/66f/f1b/114/66ff1b114d718aa4e31cf8c2f1094525.jpg"><br><br>  A primeira etapa √© designada condicionalmente como a etiqueta do corpo de abertura, ap√≥s o que vem o script.  Isso cria um PerformanceObserver que assina o evento Long Task.  Dentro do retorno de chamada PerformanceObserver, as informa√ß√µes do evento s√£o coletadas em uma matriz. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3e3/1c4/c60/3e31c4c60298c19431ca84a93c908394.jpg"><br><br>  Depois de coletar os dados, chega a hora do segundo passo.  Ele √© designado condicionalmente como uma etiqueta de corpo de fechamento.  Pegamos o √∫ltimo elemento da matriz, a √∫ltima tarefa longa, examinamos o momento de sua conclus√£o e verificamos se j√° passou tempo suficiente. <br><br>  No trabalho original dessa m√©trica, 5 segundos foram tomados como constantes, mas a escolha n√£o foi substanciada de forma alguma.  Acabou sendo suficiente por 3 segundos.  Se passarem 3 segundos, contamos o tempo at√© a primeira interatividade; caso contr√°rio, definimos Timeout e verificamos essa constante novamente. <br><br><h2>  Como processar os dados? </h2><br>  Os dados precisam ser recebidos dos clientes, processados ‚Äã‚Äãe apresentados de maneira conveniente.  Nosso conceito de envio de dados √© bastante simples.  √â chamado de contador. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/38f/158/cba/38f158cbaf1233223fdca1ba255f9e25.jpg"><br><br>  Transferimos os dados de uma determinada m√©trica para uma caneta especial no back-end e os coletamos no reposit√≥rio. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/884/cda/04a/884cda04a3b619b084dfde376a0645cc.jpg"><br><br>  Aqui, a agrega√ß√£o de dados √© designada convencionalmente como uma consulta SQL.  Aqui est√£o as principais agrega√ß√µes que geralmente consideramos de acordo com as m√©tricas de velocidade: m√©dia aritm√©tica e grupo de percentis (50, 75, 95, 99). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/354/84a/d7c/35484ad7c51d967118abb42646a09801.jpg"><br><br>  A m√©dia aritm√©tica em nossa s√©rie num√©rica √© quase 1900. √â visivelmente maior que a maioria dos elementos do conjunto, porque essa agrega√ß√£o √© muito sens√≠vel aos valores extremos.  Essa propriedade ainda √© √∫til para n√≥s. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d6b/2ac/b00/d6b2acb00b844c6294fa80a50e03495c.jpg"><br><br>  Para calcular percentis para o mesmo conjunto, classifique-o e coloque o ponteiro no √≠ndice de percentil.  Digamos que o 50, que tamb√©m √© chamado de mediana.  N√≥s ca√≠mos entre os elementos.  Nesse caso, voc√™ pode sair da situa√ß√£o de maneiras diferentes, calculamos a m√©dia entre elas.  Temos 150. Quando comparado com a m√©dia aritm√©tica, √© claramente visto que os percentis s√£o insens√≠veis aos valores extremos. <br><br>  Levamos em conta e usamos esses recursos de agrega√ß√µes.  A sensibilidade aritm√©tica das emiss√µes √© uma desvantagem se voc√™ tentar avaliar a experi√™ncia do usu√°rio.  De fato, um usu√°rio sempre pode conectar-se √† rede, por exemplo, de um trem e estragar a sele√ß√£o. <br><br>  Mas a mesma sensibilidade √© uma vantagem quando se trata de monitoramento.  Para n√£o perder um problema importante, usamos a m√©dia aritm√©tica.  Ele muda facilmente, mas o risco de um falso positivo nesse caso n√£o √© um problema t√£o grande.  Melhor ignorar do que ignorar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dcb/e92/a6b/dcbe92a6baf2a4ec1e2ef01580dd948d.jpg"><br><br>  Al√©m disso, consideramos a mediana (se anexarmos √†s m√©tricas de tempo, a mediana √© um indicador do tempo em que 50% das solicita√ß√µes se encaixam) e o 75¬∫ percentil.  No momento, 75% das solicita√ß√µes se encaixam. Consideramos a estimativa da velocidade geral.  Os percentis 95 e 99 s√£o considerados para medir a cauda longa e lenta.  Estes s√£o n√∫meros muito grandes.  95 √© considerado o pedido mais lento.  O percentil 99 √© anormal. <br><br>  N√£o faz sentido contar o m√°ximo.  Este √© o caminho da loucura.  Depois de calcular o m√°ximo, pode acontecer que o usu√°rio aguarde o carregamento da p√°gina h√° 20 anos. <br><br>  Tendo considerado as agrega√ß√µes, resta apenas aplicar esses n√∫meros, e a coisa mais √≥bvia que se pode fazer com eles √© apresent√°-los em gr√°ficos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8d/552/3e9/e8d5523e9eeebf2545a7f214b75b8ede.jpg"><br><br>  No gr√°fico, nosso tempo real at√© o primeiro conte√∫do cont√©m m√©tricas completas de tinta para pesquisa.  A linha azul reflete a din√¢mica dos desktops, a vermelha - para dispositivos m√≥veis. <br><br>  Temos que monitorar constantemente os gr√°ficos de velocidade e confiamos essa tarefa ao rob√¥. <br><br><h2>  Monitoramento </h2><br>  Como as m√©tricas de velocidade s√£o vol√°teis e constantemente flutuam com diferentes per√≠odos, o monitoramento precisa ser ajustado.  Para isso, usamos o conceito de frustra√ß√µes. <br><br>  Depura√ß√£o √© o momento em que um processo aleat√≥rio altera suas caracter√≠sticas, como varia√ß√£o ou expectativa matem√°tica.  No nosso caso, esta √© a amostra m√©dia.  Como mencionado, a m√©dia √© sens√≠vel √†s emiss√µes e adequada para o monitoramento. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/621/9a7/c0b/6219a7c0bc99aef5991cda07179a487a.jpg"><br><br>  Aqui est√° um exemplo de um gr√°fico em que o alinhamento ocorreu e o rob√¥ registrou o incidente.  Como ele isolou esse momento de v√°rias outras hesita√ß√µes?  Para entender isso, impomos dados adicionais. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/93e/d21/ec4/93ed21ec4f2a624e3d703dc90b2c2530.jpg"><br><br>  O gr√°fico amarelo √© um indicador m√©trico e o gr√°fico azul √© uma m√©dia m√≥vel com um per√≠odo suficientemente grande.  Vermelho √© a m√©dia mais tr√™s desvios padr√£o.  Verde √© o mesmo, apenas com um sinal de menos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4c8/899/b90/4c8899b90f7e2696100aa4c7069a868c.jpg"><br><br>  Indicadores vermelhos e verdes formam um corredor seguro.  Enquanto a m√©trica e a m√©dia m√≥vel flutuam entre elas - tudo √© normal, essas s√£o flutua√ß√µes comuns.  Mas se eles sa√≠rem da zona segura, o monitoramento √© acionado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9fb/d41/25e/9fbd4125ece689bd90a84e520304fd3a.jpg"><br><br><h2>  Verificando a velocidade dos recursos </h2><br>  Tudo o que foi discutido foi trabalhar com os dados de velocidade de um projeto j√° lan√ßado, mas quero medir a velocidade de recursos individuais antes de envi√°-los para grandes produ√ß√µes.  Para fazer isso, usamos o teste A / B - uma compara√ß√£o de m√©tricas para os grupos controle e experimental. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/819/128/e94/819128e94c08fec52e22da5914d28cbe.jpg"><br><br>  Dividimos os usu√°rios em grupos experimentais e de controle.  As leituras de cada slot s√£o coletadas separadamente, agregadas e tabuladas. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/31d/89b/1eb/31d89b1eb1915e2a0f8f29bc986f0521.jpg"><br><br>  Nos testes A / B, como regra, a m√©dia aritm√©tica tamb√©m √© usada.  Aqui vemos um delta e, para determinar com precis√£o se √© um acidente ou um resultado significativo, um teste estat√≠stico √© aplicado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e78/37d/134/e7837d1340c59e00cf61a132c6ac72c9.jpg"><br><br>  √â designado como "MW" porque o teste de Mann-Whitney √© usado no c√°lculo.  Com sua ajuda, a chamada "porcentagem de corre√ß√£o" √© calculada.  Este indicador tem um limite, ap√≥s o qual tomamos o delta como verdadeiro.  Aqui √© fixado em 99,9%. <br><br>  Quando o teste atinge esse valor, o delta √© destacado na interface.  N√≥s chamamos isso de colora√ß√£o.  Aqui vemos o verde, ou seja, uma boa colora√ß√£o na hora da primeira tinta cheia de conte√∫do.  O tempo para a primeira pintura significativa n√£o atingir esse valor, ou seja, o delta tamb√©m √© bom, mas n√£o 99,9%.  √â completamente imposs√≠vel confiar nela.  Ap√≥s a inicializa√ß√£o da estrutura e o tempo de interatividade, √© observada uma colora√ß√£o vermelha com confian√ßa ruim.  A partir disso, podemos tirar a mesma conclus√£o que no caso de fontes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/25b/415/b14/25b415b14b30b25549f514aced7b52dd.jpg"><br><br><h2>  Como fazer voc√™ mesmo? </h2><br>  Voc√™ pode implementar medi√ß√µes de velocidade de duas maneiras.  O primeiro √© fazer tudo o que √© seu. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e30/344/cb5/e30344cb56179ed9a633ff26c187291e.jpg"><br><br>  Um identificador para receber dados de clientes, um back-end, que coloca tudo isso em um banco de dados, MongoDB, PostgreSQL, MySQL, qualquer DBMS (eles possuem agrega√ß√µes prontas para uso), al√©m de uma das muitas solu√ß√µes de c√≥digo aberto - para desenhar gr√°ficos e organizar o monitoramento. <br><br>  A segunda solu√ß√£o √© usar os sistemas de an√°lise Yandex Metric ou Google Analytics.  No exemplo das m√©tricas Yandex, √© assim. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/424/a97/f61/424a97f61a797dff9419d7df8828046b.jpg"><br><br>  Aqui est√£o as m√©tricas que a m√©trica fornece ao usu√°rio imediatamente.  Claro, isso n√£o √© tudo o que foi exposto acima, mas j√° √© algo.  O restante pode ser adicionado manualmente atrav√©s das configura√ß√µes do usu√°rio.  Testes e monitoramento A / B tamb√©m est√£o dispon√≠veis. <br><br><h2>  Conclus√£o </h2><br>  O conceito de medi√ß√£o de velocidade on-line sobre o qual falamos √© conhecido como RUM - Real User Monitoring.  N√≥s a amamos tanto que at√© desenhamos um logotipo com um trema legal de rock and roll. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e5f/8a9/448/e5f8a94489f01743c09e5ec04453cc56.jpg"><br><br>  Essa abordagem √© boa porque se baseia em n√∫meros do mundo real, nos indicadores que o p√∫blico do seu servi√ßo possui.  Usando m√©tricas, voc√™ parece receber feedback de cada usu√°rio.  Ent√£o comece a otimizar e n√£o pare. <br><blockquote>  O an√∫ncio no final.  Se voc√™ gostou desta conversa com o <b>HolyJS 2018 Piter</b> , provavelmente estar√° interessado no pr√≥ximo <b><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HolyJS 2018 Moscow</a></b> , que ser√° <b>realizado de 24 a 25 de novembro</b> .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L√°, voc√™ pode n√£o apenas ver </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muitos outros</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> relat√≥rios JS, mas tamb√©m perguntar a qualquer orador na √°rea de discuss√£o ap√≥s o relat√≥rio. </font><font style="vertical-align: inherit;">E amanh√£, a partir de 1¬∫ de novembro, os pre√ßos dos ingressos subir√£o para a final, ent√£o hoje √© a √∫ltima oportunidade de compr√°-los com desconto!</font></font></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt426571/">https://habr.com/ru/post/pt426571/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt426559/index.html">Redes neurais para processamento de imagens. Diz Alexander Savsunenko da Skylum Software</a></li>
<li><a href="../pt426561/index.html">Os Cinco Grandes: deve ter ferramentas para acelerar o desenvolvimento</a></li>
<li><a href="../pt426563/index.html">Cat√°logo de endere√ßos hier√°rquico, altera√ß√£o de email principal e outras inova√ß√µes no Zimbra 8.8.10</a></li>
<li><a href="../pt426565/index.html">‚ÄúO mundo Java nunca mais ser√° o mesmo‚Äù - entrevista com Alexander Belokrylov e Alexey Voitilov da BellSoft</a></li>
<li><a href="../pt426567/index.html">O livro ‚ÄúCaos matem√°tico. Da matem√°tica elementar √†s abstra√ß√µes sublimes ‚Äù</a></li>
<li><a href="../pt426573/index.html">ZeroNights 2018. Recarregar</a></li>
<li><a href="../pt426575/index.html">Relat√≥rio do Clube de Roma de 2018, cap√≠tulo 1.12: ‚ÄúDe um mundo vazio para um mundo completo‚Äù</a></li>
<li><a href="../pt426579/index.html">Engie e Ledger desenvolvem uma solu√ß√£o blockchain de hardware para armazenar dados gerados por fontes de energia verde</a></li>
<li><a href="../pt426581/index.html">Li√ß√£o aberta "Vis√£o geral dos recursos do Node.js."</a></li>
<li><a href="../pt426583/index.html">Dez pessoas em 90 mil sites: como n√£o enlouquecer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>