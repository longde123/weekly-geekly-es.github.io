<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü•Å ‚ö™Ô∏è üòí Eine weitere intelligente Uhr mit eigenen H√§nden üé≠ ü§© üî¶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inspiriert vor einiger Zeit von dem Artikel ‚ÄûSmartwatches mit eigenen H√§nden f√ºr 1500r.‚Äú Ich habe mich auch entschlossen, ein √§hnliches Ger√§t herzuste...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Eine weitere intelligente Uhr mit eigenen H√§nden</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/404737/"><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/web/603/ba0/2c4/603ba02c4cbf47ae94b451b9dedfdc7d.png"></a> </p><br><p>  Inspiriert vor einiger Zeit von dem Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚ÄûSmartwatches mit eigenen H√§nden f√ºr 1500r.‚Äú</a>  Ich habe mich auch entschlossen, ein √§hnliches Ger√§t herzustellen. </p><br><p>  Dieser Artikel ist nicht als Leitfaden f√ºr Ma√ünahmen oder Anweisungen gedacht, sondern als Hinweis auf die wichtigsten Punkte, denen ich mich stellen musste.  Vielleicht dient es jemandem als Inspirationsquelle und n√ºtzliche Information. </p><br><p>  Komponentenauswahl, Leiterplattenlayout, L√∂ten unter rauen Bedingungen, 3D-gedrucktes Geh√§use und JavaScript auf der Uhr - unter dem Schnitt.  Willkommen! </p><a name="habracut"></a><br><h2 id="trebovaniya">  Anforderungen </h2><br><ul><li>  Sie m√ºssen die Zeit herausfinden, ohne hinter Ihrem Telefon in die Tasche greifen zu m√ºssen </li><li>  Es sollten Benachrichtigungen √ºber eingehende Anrufe, SMS und Benachrichtigungen von Instant Messenger eingehen </li><li>  Die Akkulaufzeit sollte mindestens eine Woche betragen </li><li>  Sei so kompakt wie m√∂glich </li></ul><br><p>  Bereits anhand dieser kleinen Liste von Anforderungen k√∂nnen Sie mit der Auswahl der Komponenten beginnen und die technischen Merkmale der Implementierung kl√§ren.  Das Zeit- und Finanzbudget des Projekts war nicht besonders begrenzt, die Massenproduktion war nicht geplant, sodass Sie es sich leisten konnten, einen Spaziergang zu machen und sich nicht wirklich darum zu sorgen, jeden Cent zu sparen. </p><br><p>  Neben dem allgemeinen Plan gab es rein technische: </p><br><ul><li>  Erstellen und Ausf√ºhren von benutzerdefinierten Anwendungen auf der Uhr.  Wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pebble</a> .  Im Allgemeinen √§hnelt die Uhr im Folgenden immer mehr einem Pebble-Klon, aber warum nicht? </li><li>  Speicher f√ºr Anwendungen und deren Daten </li><li>  Angemessene Kontrolle des Ladezustands, damit die Uhr beim Entladen des Akkus nicht pl√∂tzlich ausgeht, sondern ‚ÄûSticks‚Äú anzeigt und im Voraus gewarnt wird </li><li>  Beschleunigungsmesser, Gyroskop und Magnetometer zur vollst√§ndigen Verfolgung der Benutzerbewegung.  In der Lage sein, einen Schrittz√§hler oder einen intelligenten Wecker herzustellen, der die Schlafphasen durch das Vorhandensein von Bewegung √ºberwacht </li></ul><br><p>  All dies kristallisierte sich schlie√ülich zu einem kleinen Diagramm heraus: </p><br><p><img src="https://habrastorage.org/web/6b6/b29/8b4/6b6b298b4ae848cf84df6ab2bb900ee1.png"><br>  <em>Der Mikrocontroller kombiniert BLE 4.x f√ºr die Kommunikation mit einem Smartphone, I¬≤C- und SPI-Bussen f√ºr Sensoren und einem Display mit Speicher, steuert Vibrationen und reagiert auf Tastendr√ºcke. Alles wird von einem Li-Po-Akku gespeist.</em> </p><br><p>  Jetzt k√∂nnen Sie mit der Auswahl von Chips und Teilen beginnen.  In Bezug auf Arbeitsaufwand und Zeitaufwand war es der schwierigste und langwierigste Prozess. Es war notwendig, viel zu vergleichen, zu suchen und kopf√ºber zu tauchen, wo ich vorher nicht geschwommen war. </p><br><h2 id="vybor-komponentov">  Komponentenauswahl </h2><br><h3 id="mikrokontroller">  Mikrocontroller </h3><br><p>  Zun√§chst m√ºssen Sie einen Controller ausw√§hlen, der das "Gehirn" des Ger√§ts ist, und alles andere auf dem Board wird ihm zum Wohle dienen. </p><br><p>  Um das Ger√§t kompakter zu machen, m√ºssen so wenige Komponenten und Module wie m√∂glich verwendet werden.  Hier kommen verschiedene <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Systeme auf einem Chip</a> zum Einsatz, die die Funktionalit√§t eines Bluetooth-Moduls und eines Mikrocontrollers kombinieren. </p><br><div class="spoiler">  <b class="spoiler_title">Was bietet uns der Markt?</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/979/a27/5f2/979a275f28bf4e8fade3f573c1677038.png" alt="Bild"><br>  <em>Quelle: www.argenox.com</em> </p><br><ul><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Cypress PSoC BLE-</a></strong> Kern ARM Cortex-M0, BLE 4.2, 256 kB FLASH, 32 kB RAM, eine Reihe von Peripherieger√§ten und ein integrierter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Balun</a> , ein breiter Bereich von Versorgungsspannungen: 1,9-5 Volt </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Texas Insturments CC2541</a></strong> - BLE 4.0 und 8051-Core, 256 KB FLASH, 8 KB RAM </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Texas Instruments CC2640</a></strong> - BLE 4.1, Cortex-M3, 128 kB FLASH, 20 kB RAM </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dialog DA-14580</a></strong> - Cortex-M0, BLE 4.1, 16 MHz, 42 + 8 KB RAM, 32 KB OTP (einmalig programmierbarer Speicher, aber es ist m√∂glich, Code von einem externen SPI FLASH auszuf√ºhren), dem kleinsten und am wenigsten verbrauchenden Chip der oben genannten </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SiLabs EFR32</a></strong> - Cortex-M4F, 40 MHz, BLE 4.x, Bluetooth 5, bis zu 1 MB FLASH, bis zu 256 KB RAM </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nordic nRF52832</a></strong> - Cortex-M4F, 64 MHz, BLE 4.x, Bluetooth 5, 512 kB FLASH, 64 kB RAM, NFC-Tag-Emulation, integrierter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ballon</a> </li></ul></div></div><br><p>  In der Menge der leckeren und nicht sehr Entscheidungen fiel die Wahl auf den <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nRF52832</a></strong> , dieser Chip erwies sich als der produktivste und recht praktischste in Bezug auf das Geh√§use (6 x 6 mm 48-poliger QFN).  Eine schicke Option, die die Verkabelung der Karte erheblich vereinfacht, ist die M√∂glichkeit, Peripherieger√§te programmgesteuert einem der GPIO-Pins zuzuweisen.  Dies ist etwas, was vielen Mikrocontrollern fehlt.  Dank der NFC-Unterst√ºtzung k√∂nnen Sie der Uhr die Funktionalit√§t eines NFC-Emulators hinzuf√ºgen und alle Ihre Passkarten in die Uhr n√§hen. </p><br><p><img src="https://habrastorage.org/web/e58/636/0f5/e586360f52d647bc83189ba795011014.jpg"></p><br><p>  Das Datenblatt besagt, dass es eine eingebaute RTC (Echtzeituhr) gibt, dies ist praktisch.  Sp√§ter stellte sich jedoch heraus, dass dies keine Uhr ist, sondern ein Echtzeitz√§hler, d.h.  Dies ist der am h√§ufigsten verwendete Timer, der mit 32,768 kHz Quarz arbeitet, auch im Ruhemodus.  Daher werde ich in der n√§chsten Version des Ger√§ts einen separaten Chip f√ºr RTC verwenden, z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">STMicroelectronics M41T62LC6F</a> .  Es verf√ºgt √ºber eingebauten Quarz bei 32,768 kHz und arbeitet an der I¬≤C-Schnittstelle. </p><br><p>  Das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nRF52-DK-Debugboard</a> kostet ziemlich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">billig</a> , ungef√§hr 4 Tausend.  Rubel.  Auf Aliexpress finden Sie f√ºr ~ 3tys. </p><br><div class="spoiler">  <b class="spoiler_title">√úbrigens</b> <div class="spoiler_text"><p>  Da das Ger√§t keine Massenproduktion und keinen Marktverkauf umfasst, ist es eine faszinierende Aufgabe ohne ernsthafte Konsequenzen, ein eigenes Board zu zeichnen und Ihre L√∂sung auf BLE SoC aufzubauen.  F√ºr diejenigen, die schnell auf den Markt kommen m√∂chten, wird empfohlen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vorgefertigte vorzertifizierte Module zu verwenden</a> . </p><br><p>  Daf√ºr gibt es mehrere Gr√ºnde, die mit dem Radio zusammenh√§ngen: F√ºr jedes neue elektronische Ger√§t auf dem Markt ist es erforderlich, eine Genehmigung einzuholen und die Zertifizierung von Regulierungsbeh√∂rden wie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CE</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">FCC zu bestehen</a> . <br><img src="https://habrastorage.org/web/024/c98/5d7/024c985d746a4223b8dba41f7ec4d1f5.jpg" alt="Logos von Reglern, h√§ufig auf dem Ger√§tegeh√§use zu finden"></p><br><p>  Begleitende Freuden sind ein spezielles Layout der Platine, das die Ausbreitungseigenschaften von Signalen mit einer Frequenz von 2,4 GHz, Abschirmung, Messungen in einer schalltoten Kammer, Impedanzanpassung und andere Mikrowellenmagie ber√ºcksichtigt.  In den fertigen Modulen wurde all diese Arbeit bereits von den Entwicklern ausgef√ºhrt. Der Benutzer muss das Modul nur in seine L√∂sung einbetten und es muss nichts zertifiziert werden. </p></div></div><br><h3 id="kvarcevye-rezonatory">  Quarzresonatoren </h3><br><p>  Quarzresonatoren werden an den ausgew√§hlten nRF52832-Chip angeschlossen: </p><br><ol><li>  Bei 32 MHz zum Takten des Kerns und des Radios erforderlich </li><li>  Bei 32,768 kHz, um den Taktgeber und die BLE-Zeitschlitze im Schlafmodus zu takten.  Optional, aber der Anschluss reduziert den Stromverbrauch (Zeitschlitze k√∂nnen verk√ºrzt werden) und erh√∂ht die Genauigkeit der RTC-Uhr. </li></ol><br><p>  Beide Quarzarten werden bei Aliexpress in einem oberfl√§chenmontierten Geh√§use bestellt: </p><br><div class="spoiler">  <b class="spoiler_title">Bild</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/46f/ab8/e9c/46fab8e9c84641629e77bb14ddf5c620.png"></p></div></div><br><h3 id="displey">  Anzeige </h3><br><p>  Damit die Uhr mindestens eine Woche lang ohne Aufladen tickt, muss das Problem gel√∂st werden, dass die Anzeigematrix im Betriebsmodus viel Strom verbraucht.  So wie ich es verstehe, l√∂sen Uhrenhersteller dieses Problem auf zwei Arten: </p><br><ol><li>  Schalten Sie das Display ein und zeigen Sie den Inhalt nur an, wenn eine Handbewegung auftritt und der Bildschirm in das Sichtfeld des Benutzers f√§llt oder wenn die Aufmerksamkeit des Benutzers bereits durch eine Benachrichtigung oder einen Wecker erregt wurde </li><li>  Zeigen Sie Inhalte st√§ndig an, indem Sie Anzeigen verwenden, die praktisch keinen Strom verbrauchen, um das Bild anzuzeigen, und nur, um den Inhalt zu aktualisieren.  Sie m√ºssen f√ºr Beispiele nicht weit gehen: Dies ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">E-Ink</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Memory LCD</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">IMOD / Mirasol</a> </li></ol><br><div class="spoiler">  <b class="spoiler_title">Was bietet uns der Markt?</b> <div class="spoiler_text"><p>  F√ºr die Option, dass das Display die meiste Zeit von Malevich stammt, gibt es solche Optionen auf dem Markt: OLED-, TFT-, Amoled- und LCD-Telefonmodule (Nokia, Siemens usw.).  Es bleibt eine Anzeige mit einer geeigneten Diagonale zu finden. </p><br><p>  Beispiele: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kleine OLED-Displays</a> wie Ali Express kosten einen Cent. <br>  Eine Reihe von Minuspunkten: kleine Diagonale, monochrom, Verbrauch 10-20 mA, sperriges Modul.  Ohne Modulplatine - eine breite Schlaufe und ein Meer von Umreifungsb√§ndern, die einen erheblichen Teil der Fl√§che auf der Platine absorbieren. </li><li>  TFT LCD, z.B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ILI9341</a> .  Von den Minuspunkten: Verbrauch, breite Schleife </li></ul><br><p>  Die Bildschirme auf der E-Ink verschwanden sofort, da die Aktualisierungsgeschwindigkeit des Bildschirms zu langsam und monochrom ist und es h√∂chstwahrscheinlich schwierig ist, ein relativ kleines E-Ink-Display auf dem freien Markt zu finden. </p><br><p>  Wenn Sie sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Pebble</a> ansehen, k√∂nnen Sie sehen, dass es die Anzeige ‚ÄûImmer an‚Äú verwendet.  Pebble Classic verwendet ein monochromes <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SHARP Memory LCD-</a> Display. Pebble Time verwendet ein Farbdisplay (64 Farben) mit einer √§hnlichen Technologie, das jedoch von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">JDI</a> hergestellt wird und nicht zum Verkauf angeboten wird. </p><br><p>  In Bezug auf IMOD / Mirasol konnte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Qualcomm</a> nur Marketingbrosch√ºren und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Toq-Uhren von Qualcomm finden</a> . </p></div></div><br><p>  Ich wollte ein Farbdisplay wie die Pebble Time machen.  Das n√§chste Analogon, das zum Verkauf steht, war <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SHARP LS013B7DH06</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">sein Datenblatt</a> ). </p><br><p><img src="https://habrastorage.org/web/843/c78/b5e/843c78b5e870402cbba399bdede1fb0e.JPG"></p><br><p>  Eigenschaften </p><br><ul><li>  Diagonale 1,33 " </li><li>  Aufl√∂sung: 128 x 128, 8 Farben (3 Bit pro Pixel) </li><li>  Abmessungen: 26,82 x 31,3 mm </li><li>  Schnittstelle: SPI </li><li>  Versorgungsspannung: 5 V, aber Logikpegel SPI von 2,7 V. </li></ul><br><p>  Der Hinterhalt stellte sich mit der Versorgungsspannung heraus, da der Li-Po-Akku ohne zus√§tzliche Aufw√§rtswandler nicht die erforderliche 5-V-Spannung erh√§lt.  Der Strom am Display ist jedoch gering und mit einer Ladungspumpe vom Typ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Linear LTC1754-5</a> ist es recht einfach, die erforderlichen 5 V zu erhalten: </p><br><p><img src="https://habrastorage.org/web/4fa/599/9d6/4fa5999d699540c1b25fdcf02d5ccc36.jpg"><br>  Ein weiteres Merkmal war die Notwendigkeit, den Status des EXTCOMIN-Pins (Externe COM-Inversion) mindestens einmal pro Sekunde von einem hohen auf einen niedrigen Pegel und umgekehrt umzuschalten, damit sich die Ladung nicht auf dem Bildschirm ansammelte und das Bild an einem Punkt nicht einfrierte.  Zu diesem Zweck k√∂nnen Sie die eingebaute PWM (PWM) des Mikrocontrollers, die auf ein Tastverh√§ltnis von 50% (Rechteckwelle) und eine Frequenz von 1 Hz oder h√∂her abgestimmt ist, oder einen anderen (einschlie√ülich externen) Rechteckwellengenerator entsorgen. </p><br><p>  Das Display wird √ºber ein kleines Kabel mit der Platine verbunden. Es ist sehr praktisch, einen 10-poligen FPC-Anschluss in Schritten von 0,5 mm zu verwenden, z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hirose FH12-10S-0.5SH</a> : </p><br><p><img src="https://habrastorage.org/web/cd6/c7e/1d8/cd6c7e1d8d6e41e9af61a05b705f9ea0.jpg"><br>  Das Anzeigemodul hat keine eigene Hintergrundbeleuchtung und scheint nicht wie ein gew√∂hnlicher LCD-Bildschirm durch die LEDs. Daher haben wir vorerst keine Zeit, die Uhr ohne Hintergrundbeleuchtung zu sehen.  <em>Wenn jemand mit dem Erstellen eines Hintergrundbeleuchtungsmoduls f√ºr diese Art von Bildschirmen vertraut ist, antworten Sie bitte.</em> </p><br><h3 id="akkumulyator">  Batterie </h3><br><p>  Ich musste einige Zeit damit verbringen, die richtige Batteriegr√∂√üe aus dem Standardgr√∂√üenbereich auszuw√§hlen.  Ich suchte nach einer Lithium-Polymer-Batterie mit einer Spannung von 3,7 V und einer Kapazit√§t von ca. 100 mAh. </p><br><p>  Die Batterie sollte unter die Platine gelegt werden. Wenn Sie die Gr√∂√üe der Platine kennen, k√∂nnen Sie leicht eine Batterie aufnehmen, die passt und nichts hervorsteht. </p><br><div class="spoiler">  <b class="spoiler_title">Was bietet der Markt?</b> <div class="spoiler_text"><p>  Bei Aliexpress k√∂nnen Sie eine ganze Reihe von Batterien f√ºr fast jede Gr√∂√üe bestellen. Die Hauptsache ist, das Codierungssystem f√ºr deren Namen zu kennen.  Und es ist so: HHWWLL, wobei HH die Dicke (H√∂he) der Batterie in Zehntel Millimetern ist, WW ihre Breite und LL ihre L√§nge in Millimetern. </p><br><p>  Beispiel: 402025 - Batterie mit einer Dicke von 4 mm und einer Gr√∂√üe von 20 x 25 mm <br><img src="https://habrastorage.org/web/a8b/a4e/129/a8ba4e1299df4be69ab9048680ae8da4.png"></p></div></div><br><p>  <strong>302025</strong> (3x20x25mm) Batterien mit einer Kapazit√§t von 110mAh wurden ausgew√§hlt und bei Aliexpress bestellt. </p><br><p><img src="https://habrastorage.org/web/b54/87c/266/b5487c2667514d8ea864e303af4fcc54.png"></p><br><h3 id="pitanie">  Ern√§hrung </h3><br><p>  Da es sinnvoll ist, Lithium-Polymer-Batterien nur bis zu 3 Volt zu entladen, wurde beschlossen, den gesamten Stromkreis mit stabilisierten 3 V zu versorgen. Wenn die Spannung an der Batterie unter 3 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">V abf√§llt</a> , den Hauptleistungsregler f√ºr den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schutzchip abhacken</a> ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Maxim MAX809TEUR + T</a> ). </p><br><p>  Die Gesamtversorgungsspannung von 3 V passt in die Leistungsbereiche aller Elemente der Schaltung, mit Ausnahme des Displays, das 5 V ben√∂tigt.  Daher wird das Display √ºber den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">linearen Aufw√§rtswandler LTC1754-5</a> direkt von der Batterie gespeist. </p><br><p>  Wenn Sie sich die Entladekurve dieses Batterietyps ansehen, <br><img src="https://habrastorage.org/web/6f9/d21/e2c/6f9d21e2cd6b475b913667c1f667fe32.gif"></p><br><p>  Es ist ersichtlich, dass die gesamte Batteriekapazit√§t in den Spannungsbereich von ~ 4 V bis 3 V f√§llt, sodass ein herk√∂mmlicher 3 V-Abw√§rtswandler ausreicht, um das System mit einer stabilen Spannung zu versorgen und gleichzeitig die gesamte Energie effektiv aus der Batterie abzusaugen, ohne etwas zu hinterlassen, ohne sie jedoch zu √ºberladen . </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Texas Instruments TPS78230DRVT</a> wurde als <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abw√§rtswandler</a> ausgew√§hlt. Es hat einen kleinen Betriebsstrom von 500 nA und einen maximalen Strom von 150 mA, was v√∂llig ausreichend ist.  Das SON-6-Geh√§use ist kompakt und gut zu bezahlen: </p><br><p><img src="https://habrastorage.org/web/f31/c89/056/f31c89056e624439af40162263e57c18.jpg"></p><br><h3 id="zaryadka-akkumulyatora">  Batterieladung </h3><br><p>  Es wurde beschlossen, den Akku √ºber einen Standard-Micro-USB-Anschluss ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Molex 47346-0001</a> ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufzuladen</a> . Es reicht jedoch nicht aus, den Akku direkt an den 5-V-USB-Bus anzuschlie√üen und auf diese Weise aufzuladen. Es ist erforderlich, den korrekten Ladevorgang sicherzustellen, der in mehrere Phasen unterteilt ist: Vorkonditionierung, Konstantstrom, Konstante Spannung. </p><br><div class="spoiler">  <b class="spoiler_title">Typisches Ladeprofil f√ºr einen 180-mAh-Akku</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/f70/022/db6/f70022db6ac747c089c50bfa34320854.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Gute Erkl√§rung des Ladevorgangs auf EEVBlog</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/A6mKd5_-abk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div></div><br><p>  Eine beliebte L√∂sung zum Laden von Batterien mit geringer Kapazit√§t (bis zu 500 mAh) ist der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Microchip MCP73831-Chip</a> .  Der Ladestrom (abh√§ngig von der Batteriekapazit√§t) wird von einem Widerstand programmiert. Es gibt einen Drei-Zustands- oder Open-Drain-Ausgang, der Sie √ºber den Beginn und das Ende des Ladevorgangs informiert. </p><br><p>  Ich habe auch einen anderen Chip gew√§hlt - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Maxim MAX1555EZK-T</a> .  Es hat einen festen Ladestrom von 100 mAh und das gleiche Geh√§use wie der Mikrochip-Chip. Gleichzeitig erfordert es ein Minimum an externen Komponenten und einen Open-Drain-Ausgang, um √ºber den Ladevorgang zu informieren: </p><br><p><img src="https://habrastorage.org/web/b33/64a/b80/b3364ab804ef4332abb7c68fdd9452d8.jpg"></p><br><div class="spoiler">  <b class="spoiler_title">Datenblattbild</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/092/c7b/994/092c7b994d134222a43096e9eaa4fa22.png"></p></div></div><br><p>  In der n√§chsten Version der Karte werde ich immer noch auf den Mikrochip-Chip umsteigen, da der Ladestrom von 100 mA f√ºr einen 110-mAh-Akku wahrscheinlich etwas hoch ist. </p><br><h3 id="kontroller-yomkosti-akkumulyatora">  Batteriekapazit√§tsregler </h3><br><p>  Es gibt verschiedene Techniken zur √úberwachung des Batterieladegrads, die sich in der Ausf√ºhrung und Genauigkeit des Endergebnisses etwas unterscheiden (in englischen Quellen wird dies als Ladezustand bezeichnet): </p><br><div class="spoiler">  <b class="spoiler_title">Liste</b> <div class="spoiler_text"><ol><li><p>  Messen Sie die sogenannten  Leerlaufspannung / OCV (Spannung auf den Platten) der Batterie durch den ADC und schlie√üen Sie eine Schlussfolgerung √ºber die Batteriekapazit√§t.  Meistens ist es notwendig, den Spannungsbereich unter Verwendung eines Spannungsteilers auf einen Bereich zu √ºbertragen, der f√ºr den Betrieb des ADC akzeptabel ist.  Die Nachteile dieses Ansatzes bestehen darin, dass das Diagramm der Spannung gegen√ºber der Kapazit√§t f√ºr Lithium-Polymer-Batterien ziemlich flach ist und sich die Messwerte selbst mit jedem Zyklus √§ndern und aufgrund des Einflusses des Laststroms Rauschen und der Unf√§higkeit unterliegen, die wahre Spannung an den Platten zu messen </p><br></li><li><p>  Eine andere M√∂glichkeit besteht darin, den Strom zu messen, der in die Batterie hinein und aus dieser heraus flie√üt, anstatt die Spannung an den Platten zu messen.  Dies ist die sogenannte Coulomb-Z√§hlung.  Eine typische L√∂sung besteht darin, den Wert des Spannungsabfalls √ºber einen Shunt-Widerstand mit kleinem Widerstand (ca. 100 mOhm) zu integrieren.  Wenn wir die Kapazit√§t der Batterie kennen, k√∂nnen wir anhand des Stroms, der f√ºr einen bestimmten Zeitraum aus ihr herausfloss, schlie√üen, wie viel mehr Energie in der Batterie verbleibt (ohne Selbstentladung).  Die Nachteile dieses Ansatzes sind, dass die Selbstentladung nicht ber√ºcksichtigt wird und dass sich die tats√§chliche Batteriekapazit√§t mit jedem Lade- / Entladezyklus √§ndert.  Grob gesagt flie√üt weniger Strom aus dem Akku als beim Laden in den Akku.  Aus diesem Grund wird sich im Laufe der Zeit zwangsl√§ufig ein Fehler in den Messwerten ansammeln </p><br></li><li>  Die Kombination der ersten und zweiten Methode: Messung und Spannung an den Platten und der flie√üende Strom.  Eine kompetente Kombination der beiden Ans√§tze wird dazu beitragen, ein Modell zu erstellen, das die Batteriekapazit√§t mit guter Genauigkeit bewertet.  Damit dieser Ansatz funktioniert, muss mindestens ein Lade- / Entladezyklus erstellt werden, um Daten √ºber die Abh√§ngigkeit der Spannung zwischen den Platten von der Kapazit√§t zu sammeln.  Dar√ºber hinaus muss jeder n√§chste Zyklus √Ñnderungen am Batteriemodell vornehmen, damit sich der Fehler nicht ansammelt.  Es gibt Artikel, in denen beschrieben wird, wie mithilfe des Kalman-Filters Daten aus verschiedenen Messungen kombiniert wurden, um die verbleibende Ladung vorherzusagen ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[1]</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">[2]</a> ). </li></ol></div></div><br><div class="spoiler">  <b class="spoiler_title">Was bietet uns der Markt?</b> <div class="spoiler_text"><ul><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Maxim MAX17043</a></strong> - Unter Verwendung eines <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">propriet√§ren Algorithmus</a> f√ºr die Spannung an den Platten wird ein Batteriemodell in sich selbst erstellt.  Verspricht eine Genauigkeit der Messung der verbleibenden Ladung von 3%.  Schnittstelle I¬≤C.  Sch√∂ner und kleiner K√∂rper </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OnSemi LC709203F</a></strong> - misst OCV, I¬≤C-Schnittstelle, Genauigkeit von 2,8%, es erfolgt eine Temperaturkompensation durch einen externen Thermistor.  Teuer und schlecht in Russland </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Texas Instruments BQ27621</a></strong> - misst die Spannung an den Platten, I¬≤C, Genauigkeit nicht angegeben, teuer, BGA-Paket </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Texas Instruments BQ27421</a></strong> - misst gleichzeitig die flie√üende Spannung und den flie√üenden Strom.  I¬≤C-Schnittstelle, Genauigkeit nicht angegeben, teuer, BGA-Paket </li><li>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Linear LTC2941</a></strong> - misst den flie√üenden Strom, I¬≤C-Schnittstelle, 1% Genauigkeit, erfordert zus√§tzlich einen externen Shunt-Widerstand (er ist in LTC2941-1 eingebaut), Geh√§use: 2x3mm DFN-6 </li></ul></div></div><br><p>  Von den verf√ºgbaren Optionen wurde der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lineare LTC2941-</a> Chip f√ºr den kleinsten, aber zu zahlenden Fall und einen klaren Arbeitsalgorithmus ausgew√§hlt.  Bei Aliexpress bestellt. </p><br><div class="spoiler">  <b class="spoiler_title">Datenblattbild</b> <div class="spoiler_text"><p><img src="http://cds.linear.com/image/8650.png" alt="Bild"><br>  <em>Quelle: Lineare Technologie</em> </p></div></div><br><p>  Die Mikroschaltung verwendet die Coulomb-Z√§hlertechnik und z√§hlt den flie√üenden Strom mit einer Genauigkeit von 1%, arbeitet √ºber die I¬≤C (SMBus) -Schnittstelle und verf√ºgt √ºber ein kleines, aber praktisches Geh√§use: 2x3 mm DFN-6: <br><img src="https://habrastorage.org/web/348/3e8/90b/3483e890b3e34789ad68abaa6cf19c0a.jpg"></p><br><p>  √úber I¬≤C im Mikrokreis k√∂nnen Sie den Wert des Gegenst√ºcks zum aktuellen Messger√§t einstellen sowie den Wert des Z√§hlers selbst einstellen oder ablesen.  Der Z√§hler ist 16-Bit und erh√∂ht sich, wenn Strom in die Batterie flie√üt, und verringert sich, wenn Strom aus der Batterie flie√üt.  Der maximale Z√§hlerwert (0xFFFF) kann als vollst√§ndig geladener Akku und der minimale (0x0000) als vollst√§ndig entladener Akku verwendet werden.  Mit einem gut gew√§hlten Z√§hler-Vorw√§hler kann erreicht werden, dass der Z√§hler w√§hrend des Ladevorgangs sein Maximum erreicht und Null erreicht, wenn der Akku vollst√§ndig entladen ist.  Es ist m√∂glich, den Grenzwert f√ºr den Z√§hlerwert festzulegen, unterhalb dessen die Mikroschaltung einen Alarm ausl√∂st und einen Interrupt ausl√∂st. </p><br><h3 id="akselerometr">  Beschleunigungsmesser </h3><br><p>  Unter den zahlreichen Optionen auf dem Markt wurde ein recht beliebter Chip ausgew√§hlt: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">InvenSense MPU-9250</a> .  Dies ist ein System in einem Fall (SiP), das MEMS-Beschleunigungsmesser, MEMS-Gyroskop und Magnetometer-Chip kombiniert. </p><br><p><img src="https://habrastorage.org/web/1d8/c0d/685/1d8c0d6854a7433e9d6ccb6e2ffebf08.png"></p><br><div class="spoiler">  <b class="spoiler_title">Eigenschaften</b> <div class="spoiler_text"><ul><li>  Versorgungsspannung von 2,4 V bis 3,6 V. </li><li>  16-Bit-Dreiachsen-MEMS-Beschleunigungsmesser mit Messbereichen von ¬± 2 g, ¬± 4 g, ¬± 8 g, ¬± 16 g </li><li>  16-Bit-Dreiachsen-MEMS-Gyroskop bis 2000 ¬∞ / s </li><li>  16-Bit-Dreiachsen-Magnetometer mit Messbereich bis ¬± 4800ŒºT </li><li>  Eingebaute digitale Filter </li><li>  Schnittstellen I¬≤C und SPI </li><li>  Programmierbare Interrupts </li><li>  Co-Prozessor zum Lesen von DMP (Digital Motion Processor) </li></ul></div></div><br><p>  Der Chip ist exzellent, aber am Ende schien es ein Overkill zu sein und ein einfacher Beschleunigungsmesser reicht f√ºr die Verwendung in einer Uhr aus.  Zum Beispiel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Analog ADXL362</a> - laut Hersteller ist dies der wirtschaftlichste dreiachsige MEMS-Beschleunigungsmesser. </p><br><h3 id="flesh-pamyat">  Flash-Speicher </h3><br><p>  Es wurde beschlossen, einen externen SPI-FLASH-Speicher f√ºr Anwendungen und Daten zu verwenden.  Aus einer Vielzahl von Optionen wurde der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Winbond W25Q256FV-</a> Chip im kompakten WSON-8-Paket ausgew√§hlt: </p><br><p><img src="https://habrastorage.org/web/7ca/6f6/617/7ca6f6617c454838be1f4b0ee964779f.jpg"></p><br><p>  Die Gr√∂√üe des Flash-Speichers betr√§gt 256 Megabyte (oder 32 Megabyte), es reicht aus.  Der Speicher ist in Seiten mit 256 Bytes unterteilt, die in Sektoren mit 4 Kilobyte und Bl√∂cke mit 32 Kilobyte gruppiert sind.  Im aktiven Modus (Lesen oder Schreiben) verbraucht es bis zu 20 mA, im Standby-Modus weniger als 1 ŒºA. </p><br><p>  Wie beim Beschleunigungsmesser schien es sp√§ter, dass 32 Megabyte auch ein Overkill sind, und Sie k√∂nnten stattdessen den eingebauten FLASH-Speicher des Mikrocontrollers verwenden, er hat bereits 512 Kilobyte.         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="> </a>     . </p><br><h3 id="knopki">  Kn√∂pfe </h3><br><p>  ,           (   Pebble,  ).             .          ,            : </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wealth Metal TD-26EA</a> : </p><br><p><img src="https://habrastorage.org/web/55f/13a/47d/55f13a47d7c6491094d471c3a94af858.jpg"><br> <em>: &amp;</em> </p><br><p>  ,              . </p><br><p>       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Omron B3U-3000P</a> : </p><br><div class="spoiler"> <b class="spoiler_title">  </b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/889/246/2d0/8892462d032444d691d70ef546c62743.png"></p></div></div><br><p>       . </p><br><h3 id="vibromotorchik">  </h3><br><p>     ,    ,  . </p><br><p>  Aliexpress       ,   3V   (HxWxL) 3x3x12mm: </p><br><div class="spoiler"> <b class="spoiler_title"></b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/147/477/5c7/1474775c7260460896a4ea3b080e5571.jpg"></p></div></div><br><p>         ,    100mA      . </p><br><h3 id="antenna">  Antenne </h3><br><p> -     ,      -  .   ,      ,    .      ,          .    ,          . </p><br><p>   -  2.4GHz  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Johanson 2450AT18B100</a> : <br><img src="https://habrastorage.org/web/84b/dc7/0e5/84bdc70e556b490896f937b3aa23f574.jpg"></p><br><p> ,    ,   Johanson    ,     ,      Nordic.   nRF52 Johanson    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Johanson 2450FM07A0029</a> ,     - LC-  . </p><br><p> Die Antennen wurden auf Aliexpress mit 10 St√ºck Klebeband bestellt.  f√ºr 214r / Band. </p><br><h3 id="vsyo-ostalnoe">  Alles andere </h3><br><p>  Passive Komponenten f√ºr Hosentr√§ger und Umreifungsb√§nder sind haupts√§chlich Chips der Gr√∂√üen 0402 und 0603, die in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Elitan</a> bestellt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> .  Neben passiven Komponenten befinden sich zwei Transistoren und ein Diodenpaar auf der Platine.  Sie sind an der Steuerung des Vibrationsmotors sowie am Stromkreis beteiligt und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">entkoppeln USB-Strom und Batterie</a> . </p><br><h2 id="shema-i-plata">  Schaltung und Platine </h2><br><p>  <em>Das Erscheinungsbild der Tafel in den Screenshots unterscheidet sich geringf√ºgig von der Bestellung und ist auf den Fotos des Ger√§ts enthalten.</em>  <em>Die Board-Screenshots sind nur eine etwas sp√§tere √úberarbeitung mit geringf√ºgigen √Ñnderungen.</em> </p><br><p>  Nachdem ich mich entschlossen hatte, etwas Neues auszuprobieren, zeichnete ich die Schaltung und die Platine nicht im √ºblichen DipTrace, sondern im Cloud-EDA-Upverter: eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verkn√ºpfung zum Design</a> . </p><br><p>  Mit dem Upverter k√∂nnen Sie die Platine und die Schaltung gleichzeitig durchg√§ngig konstruieren, sodass einige der Verdrahtungselemente gem√§√ü dem Schema ausgef√ºhrt wurden und ein Teil der Schaltung unter Ber√ºcksichtigung der Verdrahtungsmerkmale entworfen wurde. </p><br><p>  Ein weiteres Killer-Feature von Upverter ist eine riesige Bibliothek von Komponenten, die sorgf√§ltig von Bots und einer Reihe von Indianern erstellt wurden.  Es stellte sich als sehr praktisch heraus, das bereits gezeichnete Teil zu nehmen und zu √ºberpr√ºfen, ob alles mehr oder weniger korrekt ist, anstatt das Symbol und den Fu√üabdruck vollst√§ndig selbst zu zeichnen. </p><br><p>  Zuerst habe ich beschlossen, die Komponenten anzuordnen, deren Position genau festgelegt wird: Tasten, Micro-USB-Anschluss und ein Anschluss f√ºr den Bildschirm.  Ich habe keine Befestigungsl√∂cher gemacht, in der Hoffnung, dass die Platine durch das Geh√§use geklemmt wird und nichts h√§ngen bleibt. </p><br><p>  Befolgen Sie nach der Position der festen Elemente die "Faustregel" und wir werden zuerst das Radio z√ºchten.  Die Chipantenne hat einen kleinen Haltebereich in der N√§he, innerhalb und unter dem es nicht empfohlen wird, Spuren und Polygone auf allen Schichten zu platzieren. Daher besteht die Regel f√ºr einen guten Ton darin, die Antenne am Rand der Platine zu platzieren, vorzugsweise n√§her an einer der Ecken.  Tats√§chlich bestimmte der Standort der Antenne den Standort des Mikrocontrollers.  Damit die L√§nge des Leiters vom Antennenausgang auf dem Chip zur Antenne selbst so gering wie m√∂glich ist (unter Ber√ºcksichtigung der passenden Komponenten), platzieren wir den Controller n√§her an der Kante, an der sich die Antenne befindet. </p><br><p>  Alle anderen Komponenten k√∂nnen (ohne den gesunden Menschenverstand zu vergessen) ganz frei lokalisiert werden.  Dies liegt daran, dass die Position der Ports f√ºr die digitalen Peripherieger√§te des nRF52-Mikrocontrollers per Software bestimmt werden kann. </p><br><p>  Nach meiner geringen Erfahrung ist eine erfolgreiche gegenseitige Anordnung von Komponenten zu 90% erfolgreich und bestimmt die Qualit√§t der weiteren Verkabelung. Daher sollte diesem Prozess besondere Aufmerksamkeit gewidmet werden. </p><br><div class="spoiler">  <b class="spoiler_title">Screenshot der Tafel (Polygone werden nicht √ºberflutet, Ansicht von unten)</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/9dc/5f1/7cd/9dc5f17cd1c34a00943ebd444b28a964.png"></p></div></div><br><p>  Aus Gr√ºnden der √úbersichtlichkeit habe ich eine ungef√§hre Topologie der Schl√ºsselbereiche gezeichnet: </p><br><p><img src="https://habrastorage.org/web/fd0/136/bef/fd0136bef5c140c3bb6b069615f4837f.png"></p><br><p>  Das Board besteht aus vier Schichten. Das Platzieren der ausgew√§hlten Komponenten auf dem Board und das Aufl√∂sen ihrer Verbindungen dauerte mehrere N√§chte. Dann dauerte es ungef√§hr eine Woche, bis das Board feststeckte, nach Fehlern suchte, Datenbl√§tter ohne Eile √ºberpr√ºfte und erneut las, um pl√∂tzliche √úberraschungen zu vermeiden. </p><br><p>  Das Board wurde unter Ber√ºcksichtigung der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">technologischen Standards</a> des Board-Herstellers gezeichnet, der zum amerikanischen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">OSHPark.com wurde</a> : </p><br><ul><li>  Leiter / Abstand: 5/5 Mil </li><li>  Durchkontaktierungen: 10/4 mil Loch / Pad </li><li>  Material: FR408 </li><li>  Finish: Immersionsgold mit einer Nickel-Unterschicht (ENIG) </li><li>  Blinde Durchkontaktierungen und √úberg√§nge der inneren Schicht (vergrabene Durchkontaktierungen) werden nicht unterst√ºtzt.  <em>Und das brauchen wir nicht</em> </li></ul><br><p>  Gleichzeitig betr√§gt der Preis 10 US-Dollar pro Quadratmeter.  Zoll und die Anzahl der Bretter in der Reihenfolge - 3 St√ºck.  Dies sind sehr hochwertige und kosteng√ºnstige (f√ºr Prototypen) Motherboards mit einer erkennbaren lila Maske. Ich empfehle jedem, der nicht kritisch ist, zwei Wochen auf seine bilateralen oder vierschichtigen Motherboards einen Monat zu warten. </p><br><div class="spoiler">  <b class="spoiler_title">Screenshot bestellen</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/ab1/daf/2ae/ab1daf2ae0b64016ac897c4afd23fb51.png"></p></div></div><br><p>  Infolgedessen musste ich f√ºr drei Geb√ºhren 14 USD zahlen und einen Monat sp√§ter per Post abholen. </p><br><div class="spoiler">  <b class="spoiler_title">Board Fotos ohne Komponenten</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/a45/223/d98/a45223d982164562992fd1c3b9a9b308.jpg"><br><img src="https://habrastorage.org/web/6b0/438/119/6b043811948c4552a2d51294007dd385.jpg"></p></div></div><br><p>  Alle Komponenten befinden sich auf der Unterseite der Platine, auf der Oberseite der Platine befindet sich das Anzeigemodul, unter dem sich eine flache NFC-Spule befindet, mit der Sie mehrere Millimeter H√∂he sparen und einen reibungslosen und festen Sitz des Displays gew√§hrleisten k√∂nnen. </p><br><div class="spoiler">  <b class="spoiler_title">Es stellt sich so ein Sandwich heraus</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/18a/5c4/a32/18a5c4a320d14b31be2aad99ff8e9d7f.png"></p></div></div><br><p>  Auf der Oberseite der Platine befinden sich au√üerdem eine Reihe von Testpunkten, Testpads, an die I¬≤C-, SPI-Busleitungen, Interruptleitungen und einige Steuersignale angeschlossen sind.  An diese Plattformen kann ein Oszilloskop oder ein Logikanalysator angeschlossen werden. Diese Funktion vereinfacht das Schreiben von Treibern und das Debuggen von Firmware erheblich.  Auf der Oberseite der Platine befinden sich au√üerdem die JTAG-Debugging-Schnittstelle (SWD) zum Flashen und Debuggen √ºber Segger JLink, die im nRF52-DK-Kit enthalten ist, sowie Pads zum L√∂ten der NFC-Antennenspule. </p><br><h2 id="sborka-i-payka">  Montage und L√∂ten </h2><br><p>  Wenn Sie den gesamten Prozess der Oberfl√§chenmontage vollst√§ndig verfolgen, m√ºssen Sie eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SMD-Schablone (SMD-Schablone)</a> und eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">L√∂tpaste bestellen</a> , die L√∂tpaste durch die Schablone <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">auftragen</a> , die Komponenten anordnen und an den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reflow-Ofen</a> senden. </p><br><p>  Aber ich hatte keinen Ofen und keine Schablone.  Und der Wunsch, sich mit ihm anzulegen und auch L√∂tpaste.  Ich wollte schnell einen Prototyp zusammenbauen und anfangen, Software zu testen und zu schreiben.  Daher habe ich alle Komponenten, von denen die kleinsten Chips der Gr√∂√üe 0402 sind, manuell gel√∂tet, Paste mit einer Nadel aufgetragen, die Komponenten mit einer Vakuumpinzette platziert und mit einem Haartrockner gel√∂tet. </p><br><p>  Das Ergebnis ist auf dem Foto zu sehen: </p><br><p><img src="https://habrastorage.org/web/4e1/164/938/4e11649380fb457b9ebce97f267e32ac.jpg"></p><br>  <em>Kn√∂pfe sind nicht verl√∂tet und statt mehrerer dreibeiniger Chips - Jumper.</em> <br>  <em>Ich entschuldige mich f√ºr die minderwertigen Fotos, die auf einem Ziegelstein aufgenommen wurden.</em> <br><br><br><div class="spoiler">  <b class="spoiler_title">Foto durch x30 Lupe</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/web/8d8/25c/fed/8d825cfedfe047ddb9f260548d365219.jpg"><br>  <em>Sie k√∂nnen leicht gedrehte Komponenten und stellenweise einen L√∂tmittel√ºberschuss sehen.</em>  <em>Dies ist bei manueller Installation und Anwendung der Paste unvermeidbar.</em> </p></div></div><br><p>  Sobald die Platine zusammengebaut war, nahm ich den Tester in die Hand und klingelte, was ich f√ºr Kurzschl√ºsse erreichen konnte.  Nachdem er sichergestellt hatte, dass er nicht zu kurz zu sein schien, schloss er ein USB-Kabel an.  Es gibt keinen Rauch, die Chips erw√§rmen sich nicht, die Spannung am USB-Anschluss betr√§gt 5 Volt, der Ladeausgang betr√§gt 4,2 V, die Spannung nach LDO betr√§gt genau drei Volt.  Es scheint zu funktionieren. </p><br><p>  Selbst bei voller Stromversorgung zeigte das Ger√§t nat√ºrlich keinerlei Lebenszeichen.  Jetzt m√ºssen Sie ihm die Seele einhauchen - die Firmware (oder das ‚ÄûBetriebssystem‚Äú, wie einige Uhrenhersteller: WatchOS, PebbleOS usw.). </p><br><p>  Der n√§chste Schritt im Test bestand darin, den im nRF52-DK integrierten JLink-Debugger √ºber die SWD-Schnittstelle anzuschlie√üen.  Wir schlie√üen die Verkabelung an, f√ºhren JLinkExe aus und sehen unseren Chip!  Sie k√∂nnen mit dem Schreiben der Firmware und dem programmgesteuerten Testen der verbleibenden Eisenbl√∂cke beginnen. </p><br><h2 id="laquooperacionnaya-sistemaraquo-dlya-chasov">  "Betriebssystem" f√ºr Uhren </h2><br><p>  F√ºr periphere Arbeiten auf niedriger Ebene bietet Nordic das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nRF5-SDK an</a> , das f√ºr die Serien nRF51 und nRF52 geeignet ist. </p><br><p> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><img src="https://habrastorage.org/web/1c6/54b/0cd/1c654b0cd48540efbb8e9a2ab79dc299.png"></a> </p><br><p>SDK             , , NFC   .     Makefile    <code>arm-none-eabi-gcc</code>.        ,       .</p><br>
<p>       .hex-,      nRF52-DK    .   nRF52-DK  ,  Mass Storage Device (),      .hex         .</p><br>
<p>     <code>JLinkExe</code>   GDB-    <code>nrfjprog</code>.</p><br>
<p>        ,   .          ,     ,                 ,            ,      .</p><br>
<p>    ,             .</p><br>
<p><img src="https://habrastorage.org/web/2fe/4fb/faf/2fe4fbfaf96746da8573e732632c6fa8.png"><br>
<em> , -,  ,     .</em></p><br>
<div class="spoiler"><b class="spoiler_title"> </b><div class="spoiler_text"><p><img src="https://habrastorage.org/web/a1f/ee6/9e3/a1fee69e3bee4918babac61db1c25ca8.jpg"></p></div></div><br>
<p>     ,        ,    -   .      API     X-Lib            .             ,        .</p><br>
<p>  :</p><br>
<p><img src="https://thumbs.gfycat.com/BoldThornyBuck-size_restricted.gif"></p><br>
<div class="spoiler"><b class="spoiler_title">   </b><div class="spoiler_text"><p><img src="https://thumbs.gfycat.com/ArtisticSoupyAntlion-size_restricted.gif" alt="image"></p></div></div><br>
<p> ,    API  ,    JavaScript (ES 5),                 .   ,  .</p><br>
<p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">JerryScript</a>,         , API      ,     ,    .   ,        ,   :    Date  .., JSON-,       ..</p><br>
<div class="spoiler"><b class="spoiler_title">    JS-</b><div class="spoiler_text"><ul>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Duktape</a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Espruino</a></li>
</ul></div></div><br>
<p>   JS  :</p><br>
<p><img src="https://habrastorage.org/web/ac6/a92/c2f/ac6a92c2faab4f3bb18f65b4fa2d8968.jpg"></p><br>
<p>  API          GUI,    , Bluetooth,   ..</p><br>
<p>        ( <code>-O0</code>):</p><br>
<p><img src="https://habrastorage.org/web/a41/e24/f8f/a41e24f8faf84949a14c79d1f9938cea.png"></p><br>
<p>106kB FLASH, 12.8kB RAM.   8kB RAM ‚Äî  (heap)   JavaScript .           . ,   FLASH  nRF52832  512kB,    RAM ‚Äî 64kB.</p><br>
<p> FLASH (120kB)      RAM   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a> BLE- SoftDevice.</p><br>
<h2 id="korpus"></h2><br>
<p>    ‚Äî  3D- .    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">TinkerCad</a>    3D-.    :</p><br>
<div class="spoiler"><b class="spoiler_title">   USB-  </b><div class="spoiler_text"><p><img src="https://habrastorage.org/web/e66/5fa/e0d/e665fae0d3414e56bead2ff4ff5050e2.jpg"></p></div></div><br>
<p><em> -          3D-,          !</em></p><br>
<h2 id="zaklyuchenie"></h2><br>
<p>       ,         .       ,   ,     ,          .  ,  ,            ,      .</p><br>
<p>         ,     API-  JS-,           JS-,   -  Android.           ,     .    ,        , , Android-   .</p><br>
<p>    : <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="></a><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://upverter.com/EP/cdbd8b9abc72b7cd/nRF52-smart-watch/</a><br>
         ,     Github.</p><br>
<p>    , ,       -        ,      .</p><br>
<p>      !</p><br>
<p><strong>P.S.:</strong>  .</p></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de404737/">https://habr.com/ru/post/de404737/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de404725/index.html">Intel verl√§sst Edison, Galileo und Joule</a></li>
<li><a href="../de404727/index.html">Elon Musk sprach dar√ºber, wie er es schafft, so produktiv zu sein</a></li>
<li><a href="../de404731/index.html">Das s√ºdkoreanische Hosting-Unternehmen zahlte 1 Million US-Dollar an Entwickler der Linux-Version der Crypto Ransomware Erebus</a></li>
<li><a href="../de404733/index.html">Wir kennen elementare (scheinbar) Teilchen</a></li>
<li><a href="../de404735/index.html">Eine neue Studie zeigte, dass Katzen nicht wie andere Tiere gez√§hmt wurden</a></li>
<li><a href="../de404741/index.html">Bewertung von Kohlendioxid in einem klimatisierten Raum</a></li>
<li><a href="../de404745/index.html">Fragen Sie Ethan: Wie gro√ü sollte der Teil des Universums sein, um sich auszudehnen?</a></li>
<li><a href="../de404747/index.html">WikiLeaks ver√∂ffentlichte eine CIA-Dokumentation zur Infektion physisch isolierter Computer</a></li>
<li><a href="../de404749/index.html">Microsoft gab zu, dass es manchmal Teile von Antivirenprogrammen von Drittanbietern trennt</a></li>
<li><a href="../de404751/index.html">Router mit VoIP-Funktionen in nur hundert</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>