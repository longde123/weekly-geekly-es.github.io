<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®üèΩ‚Äç‚öïÔ∏è üå™Ô∏è üë¥ Hinweise des IoT-Anbieters. LoRaWAN und RS-485 üßíüèº üë®üèΩ‚Äç‚öñÔ∏è ü§úüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo liebe Internet der Dinge Liebhaber. Ich setze meine Artikelserie fort. 
 Teil eins ‚Üí Teil zwei ‚Üí Teil drei ‚Üí Teil vier ‚Üí Teil f√ºnf 



 Wir habe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Hinweise des IoT-Anbieters. LoRaWAN und RS-485</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/414159/"><p>  Hallo liebe Internet der Dinge Liebhaber.  Ich setze meine Artikelserie fort. </p><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil eins</a> ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zwei</a> ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">drei</a> ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil vier</a> ‚Üí <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil f√ºnf</a> <br><br><p>  Wir haben also gelernt, wie man mit der Impulsausgabe von Z√§hlern und der gemasterten Verschl√ºsselung arbeitet.  Was ist der n√§chste Schritt?  Die Antwort liegt auf der Hand.  RS-485. <br><br>  Ein bisschen Theorie.  RS-485 (Recommended Standard) ist eine asynchrone Schnittstelle der physischen Schicht.  Er erlangte im industriellen Internet immense Popularit√§t, angefangen bei Versorgungsunternehmen bis hin zu verschiedenen Fabriken und Unternehmen. </p><br><p>  Im Prinzip wird fast jedes Messger√§t, das uns nicht nur einen, sondern mehrere Parameter geben m√∂chte, h√∂chstwahrscheinlich mit RS-485 ausgestattet sein.  Seltener RS-232 oder M-Bus, aber lassen wir sie zun√§chst beiseite und analysieren das aufschlussreichste Beispiel.  Genauer gesagt, Probleme bei der Arbeit mit ihm. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/mv/l-/1o/mvl-1ovohfb0plrjqkcajlcexdg.png"></div><a name="habracut"></a><br><h2>  Geschwindigkeitsproblem </h2><br><p>  RS-485 ist ein verkabelter Standard.  LoRa - drahtlos.  Es ist logisch, dass es ein bestimmtes Ger√§t geben muss, mit dem man sich anfreunden kann. <br><br>  Alles ist richtig.  Fast jeder Hersteller des Terminals in der Linie verf√ºgt √ºber ein Funkmodul mit RS-485-Unterst√ºtzung.  Es funktioniert nach dem Prinzip eines transparenten Kanals.  Alle Pakete, die durch die Leitung gehen, werden als Nutzlast von LoRaWAN-Paketen gepackt und an die √úbertragung gesendet.  Oder werden empfangen und in elektrische Impulse umgewandelt. </p><br><p>  Und hier ist das erste Problem.  RS-485 ist eine sehr schnelle Schnittstelle.  Pakete darauf laufen mit einer Geschwindigkeit von mehreren Kilobit / s oder sogar mehreren zehn.  Eine der typischen Modbus-Geschwindigkeiten betr√§gt beispielsweise 9,6 kbit / s. </p><br><p>  LoRa dr√ºckt selbst mit dem besten SF = 7 (125 kHz, 4/5) 5,5 kbit / s.  Mit h√∂herem SF wird es noch weniger geben. <br><br>  Dies bedeutet, dass die Erfassung der Werte einiger Stromz√§hler keine Sekunden und nicht einmal zehn Sekunden dauert.  Die Partitur wird Minuten dauern.  Und das mit einer richtig eingestellten Wartezeit.  Wenn Sie die Standardeinstellungen beibehalten, endet Ihre Umfrage h√∂chstwahrscheinlich mit einem Timeout-Fehler.  Ich schweige √ºber die Einschr√§nkungen der L√§nge von LoRaWAN-Paketen.  Es gibt nur √Ñrger. </p><br><p></p><div style="text-align:center;"><img src="https://habrastorage.org/webt/bo/fc/1i/bofc1ir2_slwuqekzlcmtiwgc80.png"></div><br><h2>  Abfrageproblem </h2><br><p>  Mit Impulsausg√§ngen ist alles einfach.  Wir z√§hlen die Impulse, multiplizieren sie mit dem Teilungspreis und erhalten den Z√§hlerstand.  Jede einfache Schnittstelle kann damit umgehen.  Und eine solche Schnittstelle wird neben der Einfachheit universeller sein. </p><br><p>  Mit RS-485 ist alles viel schlimmer.  √úberraschenderweise verstehen viele eine wichtige Sache nicht. <br>  RS-485 ist KEIN AUSTAUSCHPROTOKOLL!  Das Format der darin enthaltenen Pakete wird nicht angegeben.  Tats√§chlich ist es nur ein √úbertragungsmedium.  Es werden nur elektrische und zeitliche Eigenschaften der Schnittstelle angegeben.  Das ist alles!  Alles oben muss bereits separat zerlegt werden. </p><br><p>  Und es gibt etwas zu zerlegen!  Zus√§tzlich zu unserer Umwelt kann jeder Hersteller das abwickeln, was er will.  Nun, oder was sich f√ºr ihn pers√∂nlich als bequem herausstellte.  Zum Beispiel kommuniziert der VKT-7 W√§rmez√§hler √ºber ModBus mit uns.  Und Energomera - durch GOST R IEC 61107-2001. </p><br><p>  Dies sind alles Protokolle, die dem √úbertragungsmedium von oben √ºberlagert sind und eine h√∂here Ebene haben.  Jedes Protokoll hat seine eigene Zusammensetzung des Frames, erfordert, dass seine eigenen Teams bestimmte Aktionen ausf√ºhren, sorgt f√ºr unterschiedliche Speicherung (und damit Abfrage) von Werten.  Daher ben√∂tigt jedes Ger√§t ein eigenes Abfrageskript.  Dar√ºber hinaus unterscheidet sich dieses Skript auch im Rahmen eines Protokolls (desselben ModBus) von Ger√§t zu Ger√§t. </p><br><p>  Die Protokolle selbst sind kein Geheimnis und gr√∂√ütenteils offen.  Dar√ºber hinaus enth√§lt die Website jedes Herstellers h√§ufig ein kostenloses Dienstprogramm, mit dem Sie Ger√§te abfragen k√∂nnen.  Diese Dienstprogramme sind jedoch nicht universell und f√ºr einen Hersteller gesch√§rft.  Und wir erinnern uns, dass wir fast immer einen Zoo mit Ger√§ten haben.  Und mehrere Programme gleichzeitig auf den Client zu stellen ... nun, das ist nicht allzu bequem. </p><br><p>  Es gibt zwei Auswege.  Oder schreibe etwas Eigenes.  Oder nehmen Sie ein Programm, in dem bereits Abfrageskripte f√ºr die beliebtesten Ger√§te kompiliert wurden.  Es gibt viele vorgefertigte L√∂sungen auf dem Markt, beispielsweise "LERS-Accounting" oder "YaEnergetik".  Aber sie werden bezahlt und kosten gutes Geld.  Sowie die Entwicklung seiner Software. <br><br>  Wenn wir √ºber das industrielle Internet sprechen (das hei√üt, wir gehen √ºber den Rahmen des Wohnungsbaus und der kommunalen Dienstleistungen hinaus), helfen Ihnen vorgefertigte universelle L√∂sungen nicht mehr.  Wie man ist </p><br><p>  Auf keinen Fall. </p><br><p>  Wenn Sie weiterhin vorhaben, √ºber einen transparenten Kanal √ºber LoRa abzufragen, treten weiterhin Geschwindigkeitsbegrenzungen und Zeit√ºberschreitungen auf.  Es kann nicht sofort und nicht mit dem ersten Ger√§t, aber es wird passieren. </p><br><h2>  Standardausgabe </h2><br><p>  Zus√§tzlich zu all den Problemen haben wir noch eines.  Weil  RS-485 bedeutet, dass wir das Ger√§t jederzeit kontaktieren k√∂nnen. Das LoRa-Funkmodul mit seiner Unterst√ºtzung muss der Klasse C entsprechen. H√∂ren Sie also immer die Sendung und seien Sie bereit zu antworten. <br><br>  Ich m√∂chte Sie daran erinnern, dass Klasse C keine Batterieleistung bedeutet, aber das Problem ist nicht so ernst.  In der Regel kann beim RS-485 eine externe Stromversorgung bezogen werden. </p><br><p>  Schlimmer ist ein anderer. <br><br>  Laut Gesetz k√∂nnen wir in zwei Frequenzbereichen arbeiten.  Erinnern Sie sich an die 864-865 MHz-Grenze?  Nicht mehr als 0,1% der Zeit auf Sendung?  Dies bedeutet, dass jedes separat genommene Ger√§t beispielsweise nicht l√§nger als 3,6 Sekunden pro Stunde in der Luft sein kann.  In dieser Zeit werden wir bei SF = 12 nicht einmal drei Pakete pushen. <br><br>  Sie k√∂nnen versuchen, das Maximum aus den Kan√§len 868.7-869.2 herauszuholen.  Hier tritt jedoch eine weitere Einschr√§nkung der regionalen Standards der LoRaWAN-Spezifikation in Kraft - nicht mehr als 1 Prozent der Sendezeit f√ºr jedes Endger√§t (Arbeitszyklus).  OK, schon einfacher, 36 Sekunden.  Nur der Sinn ist noch nicht wirklich. </p><br><p><img src="https://habrastorage.org/webt/e5/li/l4/e5lil4lqoixst3yyl6ong-c8j1k.png"></p><br><p>  Irgendwann k√∂nnen wir sagen - na ja, dieser Unsinn!  Ich werde so lange wie n√∂tig in der Luft sitzen!  Aber dann scheint es: </p><br><h2>  Problem mit der √Ñtherkapazit√§t </h2><br><p>  LoRa tauscht nicht umsonst kurze und seltene Pakete aus.  In der Tat ist der gesamte Standard darauf aufgebaut.  Es ist notwendig, dass jedes Ger√§t so wenig Zeit wie m√∂glich in der Luft ben√∂tigt.  Dann reduzieren wir das Kollisionsrisiko und k√∂nnen diese fantastische Dichte von mehreren tausend Radimodulen pro BS erreichen.  Was passiert, wenn ein Funkmodul wie ein Maschinengewehr in Pakete kritzelt?  Seine Frequenz ist zum Zeitpunkt der √úbertragung belegt.  Und zum Zeitpunkt der Antwort sind seitdem alle Frequenzen belegt  Die Basisstation h√∂rt nichts, wenn sie sich selbst sendet. </p><br><p>  Nat√ºrlich hat niemand die R√ºckst√§nde gestrichen, um die Kapazit√§t zu erh√∂hen.  Das hei√üt,  Wenn sich zwei BSs im Versorgungsbereich eines Funkmoduls befinden, antwortet einer immer noch und der zweite h√∂rt m√∂glicherweise ein anderes Paket.  Der √Ñther ist jedoch kein Gummi.  Wenn jedes Funkmodul eine Minute ben√∂tigt, um Pakete auszutauschen, k√∂nnen wir in einer Stunde nicht mehr als 60 Endger√§te pro BS aufh√§ngen, sofern keine Kollisionen auftreten.  Sehr wenig, besonders wenn Sie sich daran erinnern, dass der Aktionsradius jeder BS in der Stadt etwa 2 km oder mehr betr√§gt. </p><br><h2>  Also nein? </h2><br><p>  Es stellt sich heraus, dass unser LoRaWAN-Netzwerk nur auf Ger√§te mit Impulsausgang und √úberwachungssystemen beschr√§nkt ist. Wo wird die Tatsache einer Reise aufgezeichnet? </p><br><p>  Nein. <br><br>  Wir haben nur versucht, das Konzept des Internet der Menschen zu verwenden, wo dies nicht m√∂glich ist.  Stimmen Sie zu, es ist eine Gewohnheit f√ºr uns, einen stabilen Internetkanal √ºberm√§√üig zu nutzen.  √ñffnen Sie beispielsweise ein Video, greifen Sie nach Material im Puffer und schauen Sie nicht zu.  Das hei√üt,  Verkehr wird passieren, aber in der Tat wird nicht verwendet. <br><br>  Hier ist jedoch alles anders.  Wir haben wenig Geschwindigkeit, auch keine Zeit auf Sendung.  Es muss sparsam eingesetzt werden.  Woran kannst du denken? </p><br><p>  Die Antwort liegt an der Oberfl√§che.  Fahren Sie keinen Haufen Protokoll-Overhead-Verkehr √ºber RS-485 √ºber LoRa. <br><br>  Das Abfrageskript kann auf das Funkmodul selbst heruntergeladen werden.  Er wird das Messger√§t vor Ort mit einer bestimmten Frequenz abfragen und uns nur trockene, vorher vereinbarte Werte senden. </p><br><p>  Diese Methode hat zwei Minuspunkte: </p><br><p></p><ul><li>  Ein solches Funkmodul erfordert bestimmte Rechenressourcen.  Dies ist auf dem gegenw√§rtigen Stand der Technologieentwicklung kein gro√ües Problem. </li><li>  Ein solches Funkmodul verbraucht mehr Strom.  Bei einem transparenten Kanal m√ºssen wir jedoch die Klasse C verwenden, die auch nicht von Batterien lebt.  Das ist es. </li></ul><br><p>  Aber wir bekommen alle Informationen, die wir brauchen, in 2-3 Paketen.  Und dann passt alles in einen, wenn Sie buchst√§blich mehrere Parameter ben√∂tigen.  In der Tat kommt es h√§ufig vor, dass wir nicht ALL √ºbergeben m√ºssen, eine ziemlich begrenzte Menge von Werten. <br><br>  Das Funkmodul kann beispielsweise einmal pro Stunde Daten √ºbertragen.  Und auf der Serverseite werden wir sie einlagern.  Wenn Sie auf das Archiv zugreifen m√ºssen, muss der Server das Ger√§t nicht einmal abfragen. </p><br><p>  Nat√ºrlich ben√∂tigen Sie eine Art universelles Funkmodul, in das verschiedene Skripte geladen werden.  Und eine Schnittstelle, die solche Informationen wahrnehmen kann.  Dies ist kein einfacher Weg, sondern erf√ºllt nur alle Anforderungen und Einschr√§nkungen. <br><br>  Im Moment treffen immer mehr Hersteller diese Entscheidung.  Vega bereitet √§hnliche Ger√§te vor, icbcom, ORION M2M und andere haben sie bereits. <br><br>  Weil  Wenn wir eine selbstgeschriebene Schnittstelle verwenden, haben wir √§hnliche Entwicklungen.  Irgendwann wurde klar, dass wir einfach nicht arbeiten k√∂nnten, wenn wir nicht tiefer gehen w√ºrden. </p><br><p>  Zus√§tzlich zu den Tricks zum Einsparen von Datenverkehr ben√∂tigen wir noch ein gutes Netzwerk, in dem Ger√§te mit minimalem SF und maximaler Geschwindigkeit arbeiten.  Ich betone - nicht so ein Netzwerk, in dem alle Ger√§te mit SF = 7.  Sie werden dies immer noch nicht erreichen. </p><br><p>  Ein solches Netzwerk, das SF = 7 sucht.  Dies bedeutet kompetente Planung und ADR. </p><br><p>  Am Ausgang erhalten wir ausreichende Geschwindigkeiten f√ºr die √úbertragung der Pakete, immer noch eine gro√üe Anzahl von Funkmodulen pro BS und die F√§higkeit, mit Schnittstellen zu arbeiten, deren Pegel h√∂her als der Impulsausgang ist.  Welches war erforderlich. </p><br><p>  PS Kollegen, ich bin allen f√ºr das Feedback dankbar.  Sag mir, bist du immer noch daran interessiert, etwas √ºber LoRaWAN oder das Internet der Dinge zu lernen?  Antworten k√∂nnen mir per PM oder in den Kommentaren schreiben.  F√ºr die interessantesten oder umfangreichsten Anfragen werden Artikel ver√∂ffentlicht. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de414159/">https://habr.com/ru/post/de414159/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de414141/index.html">7 Regeln f√ºr die Gestaltung von Leiterplatten</a></li>
<li><a href="../de414149/index.html">Die Gr√ºnde f√ºr den schlechten Klang der meisten Android-Smartphones</a></li>
<li><a href="../de414151/index.html">Fintech-Digest: Banken melden Sch√§den durch Hackerangriffe, Western Union weigert sich, mit Kryptow√§hrungen zu arbeiten</a></li>
<li><a href="../de414155/index.html">Ereignissysteme in Unity3D</a></li>
<li><a href="../de414157/index.html">Einfacher als es klingt. Kapitel 6-7</a></li>
<li><a href="../de414161/index.html">Kampf der Titanen unserer Zeit: eine Debatte zwischen V. Vapnik und L. Jakel √ºber die Zukunft von SVM und neuronalen Netzen</a></li>
<li><a href="../de414163/index.html">Live-Bericht von der Geburt eines gro√üen Spielers in der Hardware-KI, der TensorFlow beschleunigt und mit NVidia konkurriert</a></li>
<li><a href="../de414165/index.html">Deep Learning on Toes Kurs</a></li>
<li><a href="../de414167/index.html">Spinzustand ‚Äûfest‚Äú in einem k√ºnstlichen Wabengitter</a></li>
<li><a href="../de414169/index.html">Small Business Stories: Wladiwostok</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>