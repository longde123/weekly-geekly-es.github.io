<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üôáüèª üßëüèø‚Äçü§ù‚Äçüßëüèæ üÜì Implementasi Jenis Integer di CPython üõë üâê ü¶è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sudah ada artikel tentang Habr√© tentang rincian implementasi manajer memori CPython, Pandas , saya menulis sebuah artikel tentang penerapan kamus . 

...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Implementasi Jenis Integer di CPython</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/455114/"> Sudah ada artikel tentang Habr√© tentang rincian implementasi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">manajer memori</a> CPython, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pandas</a> , saya menulis sebuah artikel tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">penerapan kamus</a> . <br><br>  Tampaknya Anda dapat menulis tentang tipe integer biasa?  Namun, tidak semuanya begitu sederhana dan tipe integer tidak begitu jelas. <br><br>  Jika Anda bertanya-tanya mengapa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">x * 2 lebih cepat dari x &lt;&lt; 1</a> . <br><br>  Dan bagaimana cara menghidupkan trik berikut: <br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-number"><span class="hljs-number">42</span></span> == <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">42</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> &gt;&gt;&gt; <span class="hljs-number"><span class="hljs-number">1</span></span> + <span class="hljs-number"><span class="hljs-number">41</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre> <br>  Maka Anda harus membaca artikel ini. <br><a name="habracut"></a><br>  Tidak ada tipe primitif dalam python - semua variabel adalah objek dan dialokasikan dalam memori dinamis.  Pada saat yang sama, bilangan bulat diwakili oleh hanya satu jenis (kami tidak mempertimbangkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">desimal</a> ) - PyLongObject.  Implementasi dan deklarasi yang terletak pada file longobject.h, longintrepr.h dan longobject.c. <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">longobject</span></span></span><span class="hljs-class"> {</span></span> PyObject_VAR_HEAD <span class="hljs-comment"><span class="hljs-comment">//       digit ob_digit[1]; //   };</span></span></code> </pre><br>  Dalam objek apa pun di CPython ada dua bidang: ob_refcnt - counter referensi ke objek dan ob_type - pointer ke jenis objek, ke objek yang dapat mengubah panjangnya, bidang ob_size ditambahkan - ukuran yang dialokasikan saat ini (digunakan mungkin kurang). <br><br>  Dengan demikian, tipe integer diwakili oleh array dengan panjang variabel dari digit yang terpisah, sehingga python di luar kotak mendukung aritmatika yang panjang, dalam versi bahasa kedua ada tipe terpisah dari bilangan bulat "biasa". Bilangan bulat panjang dibuat menggunakan huruf L atau, jika hasil operasi dengan disebabkan meluap oleh yang biasa, dalam versi ketiga diputuskan untuk menolaknya. <br><br><pre> <code class="python hljs"> <span class="hljs-comment"><span class="hljs-comment"># python2 num1 = 42 print num1, type(num1) # 42 &lt;type 'int'&gt; num2 = 42L print num2, type(num2) # 42 &lt;type 'long'&gt; num3 = 2 ** 100 print num3, type(num3) # 1267650600228229401496703205376 &lt;type 'long'&gt;</span></span></code> </pre><br>  Nilai integer yang disimpan oleh struktur _longobject sama dengan: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>a</mi><mi>b</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><mi>o</mi><mi>b</mi><msub><mtext>&amp;#xA0;</mtext><mi>s</mi></msub><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mn>1</mn></mrow></msubsup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>b</mi><msub><mtext>&amp;#xA0;</mtext><mi>d</mi></msub><mi>i</mi><mi>g</mi><mi>i</mi><msub><mi>t</mi><mi>i</mi></msub><mo>&amp;#x2217;</mo><msup><mn>2</mn><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>S</mi><mi>H</mi><mi>I</mi><mi>F</mi><mi>T</mi><mo>&amp;#x2217;</mo><mi>i</mi></mrow></msup></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.768ex" height="3.624ex" viewBox="0 -1143.2 14969.4 1560.2" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,521)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-62" x="529" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-73" x="959" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMAIN-28" x="1428" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-6F" x="1818" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-62" x="2303" y="0"></use><g transform="translate(1932,0)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-73" x="499" y="-213"></use></g><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-69" x="3518" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-7A" x="3864" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-65" x="4332" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMAIN-29" x="4799" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMAIN-2212" x="5188" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMAIN-31" x="5967" y="0"></use></g><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMAIN-30" x="1124" y="0"></use></g></g><g transform="translate(6843,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-6F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-62" x="485" y="0"></use><g transform="translate(915,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-64" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-69" x="1635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-67" x="1980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-69" x="2461" y="0"></use><g transform="translate(2806,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-69" x="511" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMAIN-2217" x="3734" y="0"></use><g transform="translate(4457,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMAIN-32" x="0" y="0"></use><g transform="translate(500,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-48" x="645" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-49" x="1534" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-46" x="2038" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-54" x="2788" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMAIN-2217" x="3492" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/post/455114/&amp;usg=ALkJrhi4tpxmiZzVLXRly4wxx4EkWOqWhA#MJMATHI-69" x="3993" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>a</mi><mi>b</mi><mi>s</mi><mo stretchy="false">(</mo><mi>o</mi><mi>b</mi><msub><mtext>&nbsp;</mtext><mi>s</mi></msub><mi>i</mi><mi>z</mi><mi>e</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mn>1</mn></mrow></msubsup><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>b</mi><msub><mtext>&nbsp;</mtext><mi>d</mi></msub><mi>i</mi><mi>g</mi><mi>i</mi><msub><mi>t</mi><mi>i</mi></msub><mo>‚àó</mo><msup><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mi>S</mi><mi>H</mi><mi>I</mi><mi>F</mi><mi>T</mi><mo>‚àó</mo><mi>i</mi></mrow></msup></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ sum_ {i = 0} ^ {abs (ob \ _size) -1} {ob \ _digit_i * 2 ^ {SHIFT * i}} </script></p><br>  Sebagai bit, tipe unsigned 32-bit (uint32_t) pada sistem 64-bit dan tipe pendek 16-bit unsigned pada tipe 32-bit digunakan. <br><br>  Algoritma yang digunakan dalam implementasi memberlakukan pembatasan ketat pada SHIFT dari formula sebelumnya, khususnya, harus dibagi 15, jadi sekarang cpython mendukung dua nilai: 30 dan 15, masing-masing, untuk sistem 64 dan 32-bit.  Untuk nilai negatif, ob_size memiliki nilai negatif, nol diberikan oleh angka yang ob_size = 0. <br><br>  Saat melakukan operasi aritmatika, penerjemah memeriksa panjang operan saat ini, jika keduanya terdiri dari satu bit, maka aritmatika standar dilakukan. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> PyObject * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">long_add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PyLongObject *a, PyLongObject *b)</span></span></span><span class="hljs-function"> </span></span>{ ... <span class="hljs-comment"><span class="hljs-comment">//   -     if (Py_ABS(Py_SIZE(a)) &lt;= 1 &amp;&amp; Py_ABS(Py_SIZE(b)) &lt;= 1) { //      return PyLong_FromLong(MEDIUM_VALUE(a) + MEDIUM_VALUE(b)); } ... };</span></span></code> </pre><br>  Multiplikasi memiliki struktur yang serupa, di samping itu, penerjemah mengimplementasikan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">algoritma Karatsuba</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">quick squaring</a> , namun, mereka tidak dilakukan untuk setiap "multiplikasi panjang", tetapi hanya untuk jumlah yang cukup besar, jumlah digit yang diberikan oleh dua konstanta: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//     #define KARATSUBA_CUTOFF 70 //      #define KARATSUBA_SQUARE_CUTOFF (2 * KARATSUBA_CUTOFF)</span></span></code> </pre><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> PyObject * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">long_mul</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PyLongObject *a, PyLongObject *b)</span></span></span><span class="hljs-function"> </span></span>{ ... <span class="hljs-comment"><span class="hljs-comment">//   -     if (Py_ABS(Py_SIZE(a)) &lt;= 1 &amp;&amp; Py_ABS(Py_SIZE(b)) &lt;= 1) { // stwodigits -  ,    // int64_t  64-   long  32-. stwodigits v = (stwodigits)(MEDIUM_VALUE(a)) * MEDIUM_VALUE(b); return PyLong_FromLongLong((long long)v); } ... // ""    O(N^2),     . i = a == b ? KARATSUBA_SQUARE_CUTOFF : KARATSUBA_CUTOFF; if (asize &lt;= i) { if (asize == 0) return (PyLongObject *)PyLong_FromLong(0); else return x_mul(a, b); } ... };</span></span></code> </pre><br>  Namun, perintah shift tidak memiliki pemeriksaan untuk kasus bilangan bulat "pendek", mereka selalu dieksekusi untuk kasus aritmatika panjang.  Oleh karena itu, mengalikan dengan 2 lebih cepat daripada shift.  Sangat menarik untuk dicatat bahwa divisi ini lebih lambat daripada shift kanan, yang juga tidak memeriksa kasus integer satu digit.  Tetapi pembagiannya lebih rumit: ada satu metode yang pertama menghitung hasil bagi, kemudian sisanya, NULL diteruskan ke sana, jika Anda perlu menghitung satu hal, yaitu, metode harus memeriksa kasus ini juga, semua ini meningkatkan overhead. <br><br>  Fungsi perbandingan juga tidak memiliki kasing khusus untuk bilangan bulat "pendek". <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">long_compare</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PyLongObject *a, PyLongObject *b)</span></span></span><span class="hljs-function"> </span></span>{ Py_ssize_t sign; <span class="hljs-comment"><span class="hljs-comment">// ,        //        if (Py_SIZE(a) != Py_SIZE(b)) { sign = Py_SIZE(a) - Py_SIZE(b); } else { Py_ssize_t i = Py_ABS(Py_SIZE(a)); //  ""        while (--i &gt;= 0 &amp;&amp; a-&gt;ob_digit[i] == b-&gt;ob_digit[i]) ; if (i &lt; 0) sign = 0; else { sign = (sdigit)a-&gt;ob_digit[i] - (sdigit)b-&gt;ob_digit[i]; if (Py_SIZE(a) &lt; 0) sign = -sign; } } return sign &lt; 0 ? -1 : sign &gt; 0 ? 1 : 0; }</span></span></code> </pre><br><h3>  Array (daftar) angka </h3><br>  Saat membuat variabel tipe integer, juru bahasa harus mengalokasikan area yang cukup dalam memori dinamis, kemudian mengatur penghitung referensi (tipe ssize_t), pointer untuk mengetik PyLongObject, ukuran saat ini dari bit array (juga ssize_t) dan menginisialisasi array itu sendiri.  Untuk sistem 64-bit, ukuran struktur minimum adalah: 2 * ssize_t + pointer + digit = 2 * 8 + 8 + 4 = 28 byte.  Masalah tambahan muncul saat membuat daftar angka: karena angka bukan tipe primitif, dan daftar dalam python menyimpan referensi ke objek, objek tidak berurutan dalam memori dinamis. <br><br>  Pengaturan ini memperlambat iterasi di atas array: pada kenyataannya, akses acak dilakukan, yang membuatnya tidak mungkin untuk memprediksi transisi. <br><br>  Untuk menghindari alokasi memori dinamis yang berlebihan, yang memperlambat waktu pengoperasian dan berkontribusi pada fragmentasi memori, optimisasi diimplementasikan dalam cpython: pada fase start-up, array bilangan bulat kecil telah dialokasikan sebelumnya: dari -5 hingga 256. <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> NSMALLPOSINTS #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> NSMALLPOSINTS 257 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//     python    . #endif #ifndef NSMALLNEGINTS #define NSMALLNEGINTS 5 #endif</span></span></span></span></code> </pre><br>  Akibatnya, daftar angka dalam cpython diwakili dalam memori sebagai berikut: <br><br><img src="https://habrastorage.org/webt/k2/1m/hj/k21mhjawz4oerssjqvnhpdz3pq4.png"><br><br>  Ada peluang untuk mencapai daftar bilangan bulat kecil yang sudah dipilih sebelumnya dari skrip, dipersenjatai dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel ini</a> dan modul ctypes standar: <br><br>  Penafian: Kode berikut diberikan sebagaimana adanya, penulis tidak bertanggung jawab dan tidak dapat menjamin keadaan penerjemah, serta kesehatan mental Anda dan kolega Anda, setelah menjalankan kode ini. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ctypes <span class="hljs-comment"><span class="hljs-comment">#  PyLongObject class IntStruct(ctypes.Structure): #   _fields_ = [("ob_refcnt", ctypes.c_long), ("ob_type", ctypes.c_void_p), ("ob_size", ctypes.c_long), ("ob_digit", ctypes.c_int)] def __repr__(self): return ("IntStruct(ob_digit={self.ob_digit}, ob_size={self.ob_size}, " "refcount={self.ob_refcnt})").format(self=self) if __name__ == '__main__': #    42 int42 = IntStruct.from_address(id(42)) print(int42) int_minus_2 = IntStruct.from_address(id(-2)) print(int_minus_2) # ob_digit=2, ob_size=-1 #       int42.ob_digit = 4 print(4 == 42) # True print(1 + 41) # 4</span></span></code> </pre><br>  PyLongObject jujur ‚Äã‚Äãdisimpan dalam daftar ini, yaitu, mereka memiliki counter referensi, misalnya, Anda dapat mengetahui berapa nol nol skrip Anda dan penggunaan interpreter. <br><br>  Dari implementasi internal bilangan bulat, aritmatika dalam cpython tidak bisa cepat, di mana bahasa lain berurutan di atas array, membaca angka ke register dan secara langsung memanggil beberapa instruksi prosesor, cpython ditandai di seluruh memori, melakukan metode yang agak rumit.  Dalam kasus bilangan bulat single-bit yang paling sederhana, di mana cukup untuk memanggil satu instruksi, penerjemah harus membandingkan ukuran, kemudian membuat objek dalam memori dinamis, mengisi bidang layanan, dan mengembalikan pointer ke dalamnya, apalagi tindakan ini memerlukan kunci GIL.  Sekarang Anda mengerti mengapa perpustakaan numpy muncul dan mengapa sangat populer. <br><br>  Saya ingin menyelesaikan artikel tentang seluruh tipe cpython, tiba-tiba, dengan informasi tentang tipe boolean. <br><br>  Faktanya adalah bahwa untuk waktu yang lama dalam python tidak ada tipe terpisah untuk variabel Boolean, semua fungsi logis mengembalikan 0 dan 1. Namun, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mereka memutuskan untuk memperkenalkan</a> tipe baru.  Apalagi itu diterapkan sebagai tipe anak untuk keseluruhan. <br><br><pre> <code class="cpp hljs">PyTypeObject PyBool_Type = { PyVarObject_HEAD_INIT(&amp;PyType_Type, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">//       // ,       //     ob_size "bool", //   sizeof(struct _longobject), //    ... &amp;PyLong_Type, //   ... bool_new, //  };</span></span></code> </pre><br>  Selain itu, masing-masing nilai dari tipe Boolean adalah singleton, variabel Boolean adalah pointer ke turunan True atau False (Tidak ada yang diimplementasikan dengan cara yang sama). <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">longobject</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Py_FalseStruct</span></span></span><span class="hljs-class"> = {</span></span> PyVarObject_HEAD_INIT(&amp;PyBool_Type, <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-number"><span class="hljs-number">0</span></span> } }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">longobject</span></span></span><span class="hljs-class"> _</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Py_TrueStruct</span></span></span><span class="hljs-class"> = {</span></span> PyVarObject_HEAD_INIT(&amp;PyBool_Type, <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-number"><span class="hljs-number">1</span></span> } }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> PyObject * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">bool_new</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(PyTypeObject *type, PyObject *args, PyObject *kwds)</span></span></span><span class="hljs-function"> </span></span>{ PyObject *x = Py_False; <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> ok; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_PyArg_NoKeywords(<span class="hljs-string"><span class="hljs-string">"bool"</span></span>, kwds)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!PyArg_UnpackTuple(args, <span class="hljs-string"><span class="hljs-string">"bool"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, &amp;x)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; ok = PyObject_IsTrue(x); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ok &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> PyBool_FromLong(ok); } <span class="hljs-function"><span class="hljs-function">PyObject *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PyBool_FromLong</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">long</span></span></span></span><span class="hljs-function"><span class="hljs-params"> ok)</span></span></span><span class="hljs-function"> </span></span>{ PyObject *result; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ok) result = Py_True; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> result = Py_False; Py_INCREF(result); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; }</code> </pre><br>  PyObject_IsTrue (x) adalah mekanisme rumit untuk menghitung nilai Boolean, Anda dapat melihatnya di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> di bagian fungsi bool atau dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi</a> . <br><br>  Warisan semacam itu mengarah ke beberapa efek lucu, seperti kesetaraan yang tepat dari True dan 1, ketidakmampuan untuk memiliki True dan 1 sebagai kunci dalam kamus dan set, dan penerimaan operasi aritmatika pada tipe Boolean: <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span><span class="hljs-keyword"><span class="hljs-keyword">True</span></span> == <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> &gt;&gt;&gt; {<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-string"><span class="hljs-string">"true"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-string"><span class="hljs-string">"one"</span></span>} {<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-string"><span class="hljs-string">'one'</span></span>} &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> * <span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> / (<span class="hljs-number"><span class="hljs-number">5</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) - (<span class="hljs-keyword"><span class="hljs-keyword">True</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>) <span class="hljs-number"><span class="hljs-number">-6.0</span></span> &gt;&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> &lt; <span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre><br>  Bahasa python luar biasa untuk fleksibilitas dan keterbacaannya, namun, harus diingat bahwa semua ini ada harganya, misalnya, dalam bentuk abstraksi dan overhead yang berlebihan, yang sering kita tidak pikirkan atau tebak.  Saya harap artikel ini memungkinkan Anda untuk menghilangkan "kabut perang" sedikit lebih dari kode sumber penerjemah, bahkan mungkin mendorong Anda untuk mempelajarinya.  Kode interpreter sangat mudah dibaca, hampir seperti kode pada python itu sendiri, dan mempelajarinya akan memungkinkan Anda untuk tidak hanya mempelajari bagaimana penerjemah diimplementasikan, tetapi juga solusi algoritmik dan sistem yang menarik, serta mungkin menulis kode yang lebih efisien atau menjadi pengembang cpython sendiri. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id455114/">https://habr.com/ru/post/id455114/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id455102/index.html">Menghubungkan antarmuka serial melalui IP</a></li>
<li><a href="../id455104/index.html">BotAuth - login dan registrasi menggunakan bot</a></li>
<li><a href="../id455106/index.html">Pengembangan perangkat lunak. Tren 2019</a></li>
<li><a href="../id455110/index.html">Apakah kebahagiaan karyawan bergantung pada tugas yang menarik? Beritahu Badoo, SKB Kontur, Dodo Pizza, Staply dan Alternativa Games</a></li>
<li><a href="../id455112/index.html">Bitrix24: "Cepat diangkat tidak dianggap jatuh"</a></li>
<li><a href="../id455118/index.html">Ke masa depan dengan integrasi layanan APEX Jenkins & Oracle</a></li>
<li><a href="../id455120/index.html">Wi-fi bukan untuk semua orang. Bagaimana cara mengotorisasi orang asing di jaringan oleh hukum?</a></li>
<li><a href="../id455126/index.html">Pakaian pintar masa depan: apakah ada potensi?</a></li>
<li><a href="../id455128/index.html">Bagaimana kami memoderasi iklan</a></li>
<li><a href="../id455130/index.html">3 alat populer untuk mengatur penyebaran berkelanjutan (Continuous Deployment)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>