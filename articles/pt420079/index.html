<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üàπ üöô üîú Criando grama interativa no Unreal Engine üóæ üò´ üà≤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At√© recentemente, a grama nos jogos era geralmente indicada por uma textura no ch√£o, em vez de renderizar caules individuais. Mas com o aumento do pod...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Criando grama interativa no Unreal Engine</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420079/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/dg/d_/sg/dgd_sg8pss1hh54majrmgysw5fi.gif"></div><br>  At√© recentemente, a grama nos jogos era geralmente indicada por uma textura no ch√£o, em vez de renderizar caules individuais.  Mas com o aumento do poder do ferro, tornou-se poss√≠vel produzir grama.  Grandes exemplos dessa renderiza√ß√£o podem ser vistos em jogos como <i>Horizon Zero Dawn</i> e <i>The Legend of Zelda: Breath of the Wild</i> .  Nesses jogos, o jogador pode percorrer os prados de grama e, mais importante, a grama <i>responde</i> √†s a√ß√µes do jogador. <br><br>  Felizmente, criar um sistema desse tipo n√£o √© muito dif√≠cil.  De fato, o artigo ensinar√° exatamente isso!  Neste tutorial, voc√™ aprender√° o seguinte: <br><br><ul><li>  Crie um campo vetorial usando um sistema de captura de cenas e part√≠culas </li><li>  Dobre a grama de um jogador com base em um campo vetorial </li></ul><a name="habracut"></a><blockquote>  <em>Nota:</em> este tutorial pressup√µe que voc√™ j√° conhece os conceitos b√°sicos de trabalho com o Unreal Engine.  Se voc√™ √© novo no Unreal Engine, confira nossa s√©rie de dez partes de tutoriais do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Unreal Engine para iniciantes</a> .  Em particular, consulte o tutorial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Particle Systems</a> para saber como usar o Cascade neste tutorial. </blockquote><blockquote>  <em>Nota:</em> este tutorial faz parte de uma s√©rie de tr√™s tutoriais sobre como trabalhar com destinos de renderiza√ß√£o: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 1: desenhando com destinos de renderiza√ß√£o</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Parte 2: neve deform√°vel</a> </li><li>  Parte 3: grama interativa </li></ul></blockquote><h2>  Come√ßando a trabalhar </h2><br>  Vamos come√ßar baixando os materiais deste tutorial (voc√™ pode baix√°-los <a href="">aqui</a> ).  Descompacte-os, v√° para <em>InteractiveGrassStarter</em> e abra <em>InteractiveGrass.uproject</em> .  Voc√™ ver√° um pequeno campo de grama que ser√° o tema deste tutorial.  Tamb√©m criei um widget para exibir o destino de renderiza√ß√£o da captura de cena. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8fa/004/60f/8fa00460f2e914dedb752443b566d226.gif"></div><br><br>  Antes de come√ßar, voc√™ deve estudar o tutorial <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">sobre como criar pegadas na neve</a> , porque vou pular algumas informa√ß√µes.  Vale a pena considerar que a captura e a proje√ß√£o tamb√©m s√£o usadas neste tutorial.  Para economizar tempo, preparei uma captura de planta, semelhante √† planta do tutorial sobre as trilhas na neve. <br><br>  Para come√ßar, vejamos outra maneira de criar grama interativa.  A maneira mais comum √© transferir as coordenadas do jogador para o material da grama e usar uma m√°scara esf√©rica para dobrar a grama em um determinado raio do jogador. <br><br>  Embora essa abordagem seja muito boa, ela n√£o aumenta quando queremos adicionar mais atores √† grama.  Para cada ator que voc√™ adicionar, voc√™ precisar√° adicionar outro par√¢metro de coordenada e uma m√°scara esf√©rica ao material.  Um m√©todo mais escal√°vel √© usar um <em>campo vetorial</em> . <br><br><h2>  O que √© um campo vetorial? </h2><br>  Um campo vetorial √© apenas uma textura, cada pixel corresponde a uma dire√ß√£o.  Se voc√™ costumava trabalhar com mapas de fluxo, eles s√£o semelhantes.  Mas, em vez de mover UV, usaremos o contato <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Deslocamento da posi√ß√£o mundial</a> para mover os v√©rtices.  Ao contr√°rio da solu√ß√£o com uma m√°scara esf√©rica, para obter a dire√ß√£o da flex√£o, √© suficiente que os materiais provem o campo vetorial apenas <i>uma vez</i> . <br><br>  Vamos descobrir como voc√™ pode salvar as dire√ß√µes em uma textura.  Veja esta grade: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/553/651/6d2/5536516d26f67d5e2e5928db30b1608a.jpg"></div><br>  Digamos que o ponto vermelho √© o objeto que queremos mover.  Se o movermos para o canto inferior direito, qual vetor denotar√° esse movimento?  Se voc√™ respondeu <em>(1, 1)</em> , est√° certo!  Como voc√™ provavelmente sabe, tamb√©m pode representar vetores como flores e, assim, salv√°-los em textura.  Vamos inserir esse vetor no seletor de cores Unreal e ver qual cor ele retorna. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b21/5d6/59b/b215d659be2f7f813add96b32fcabae4.jpg"></div><br>  Como voc√™ pode ver, a dire√ß√£o <em>(1, 1)</em> retorna em amarelo.  Isso significa que, se queremos dobrar a grama na dire√ß√£o dos eixos XY positivos, teremos que usar essa cor de textura.  Vamos agora olhar para as cores de todos os vetores. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fbf/302/8bd/fbf3028bd6456dac8ca27a9c1bf2146d.jpg"></div><br>  O quadrado inferior direito parece muito bom porque possui gradientes nos dois eixos.  Isso significa que podemos armazenar qualquer vetor nesse quadrante como uma cor, porque cada vetor tem uma cor √∫nica. <br><br>  Mas h√° um problema com os outros tr√™s quadrantes.  Temos apenas um gradiente ao longo de um eixo, ou nenhum gradiente.  Isso significa que v√°rios vetores ter√£o a mesma cor.  Por exemplo, n√£o podemos distinguir entre os vetores <em>(-1, 1)</em> e <em>(0, 1)</em> . <br><br>  Esses tr√™s quadrantes n√£o t√™m cores exclusivas para cada vetor, porque s√≥ podemos representar cores usando valores de 0 a 1. no entanto, esses tr√™s quadrantes usam valores negativos fora desse intervalo. <br><br>  A solu√ß√£o √© redistribuir os vetores para que todos eles se ajustem no intervalo de 0 a 1. Isso pode ser feito multiplicando o vetor por <em>0,5</em> e adicionando <em>0,5</em> .  Aqui est√° uma visualiza√ß√£o do que obtemos: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1c6/334/31a/1c633431aa88cde88b2f2af01ede9f89.gif"></div><br>  Agora cada vetor tem uma cor √∫nica.  Quando precisamos us√°-lo para c√°lculos, simplesmente o redistribu√≠mos de volta para o intervalo de -1 a 1. Aqui est√£o algumas cores e as dire√ß√µes correspondentes ap√≥s a redistribui√ß√£o: <br><br><ul><li>  <em>(0, 0):</em> X e Y negativos </li><li>  <em>(0,5, 0,5):</em> sem movimento </li><li>  <em>(0, 1):</em> X negativo e Y positivo </li><li>  <em>(1, 0):</em> X positivo e Y negativo </li></ul><br>  Agora vamos aprender como criar um campo vetorial no Unreal. <br><br><h3>  Criando um campo vetorial </h3><br>  Ao contr√°rio de criar tra√ßos na neve, n√£o realizaremos a captura da forma dos objetos.  Em vez disso, pintaremos o alvo de renderiza√ß√£o com pinc√©is.  Estas ser√£o apenas imagens do campo vetorial selecionado.  Vou cham√°-los de <em>pinc√©is de dire√ß√£o</em> . <br><br>  Em vez de desenhar no alvo de renderiza√ß√£o com embotamentos, podemos usar <em>part√≠culas</em> .  As part√≠culas exibir√£o um pincel de instru√ß√µes e emitidas pelo player.  Para criar um campo vetorial, basta usar a captura de cena e capturar apenas part√≠culas.  A vantagem deste m√©todo √© que a cria√ß√£o de rastreios √© muito simples.  Al√©m disso, permite gerenciar facilmente propriedades como a dura√ß√£o do armazenamento de trilhas e seu tamanho.  Al√©m disso, as part√≠culas criam tra√ßos temporariamente persistentes, porque existem ap√≥s deixar a √°rea de captura e retornar a ela. <br><br>  Abaixo est√£o alguns exemplos de pinc√©is direcionais que podemos usar, bem como seus efeitos na grama.  Observe que no exemplo abaixo, as part√≠culas s√£o invis√≠veis. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/06a/7ac/976/06a7ac9766e63da84aec88bca2338b9a.gif"></div><br>  Para come√ßar, vamos criar um material que exibir√° um pincel de dire√ß√£o. <br><br><h2>  Criando material para dire√ß√µes </h2><br>  Existem duas maneiras de criar um pincel de dire√ß√£o: <br><br><ol><li>  <em>Matem√°tico:</em> dire√ß√µes e forma s√£o definidas dentro do material.  Sua vantagem √© que ele n√£o requer software de terceiros e √© conveniente para formul√°rios simples. </li><li>  <em>Convers√£o normal de mapa:</em> crie um mapa normal das dire√ß√µes e formas desejadas.  Para converter o mapa em um campo vetorial adequado, basta remover o canal azul.  A vantagem desse m√©todo √© que voc√™ pode facilmente criar formas complexas.  Abaixo est√° um exemplo de um pincel que ser√° dif√≠cil criar matematicamente. </li></ol><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ddd/e44/0e5/ddde440e52ce5e3bbc6cdece65815265.jpg"></div><br>  Para este tutorial, criaremos um pincel matematicamente.  V√° para a pasta <em>Materiais</em> e abra <em>M_Direction</em> .  Observe que o modelo de sombreamento <em>Unlit est√°</em> selecionado para este material.  Isso √© importante porque permite a captura de uma cena para capturar part√≠culas sem afet√°-las. <br><br>  Para n√£o complicar, criaremos um material que far√° com que a grama se afaste do centro da part√≠cula.  Para fazer isso, crie o seguinte esquema: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/826/06f/fc1/82606ffc1df0425a75ef17c334a23470.jpg"></div><br>  Agora precisamos redistribuir.  Para fazer isso, adicione os n√≥s selecionados e conecte tudo da seguinte maneira: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02b/eb0/98a/02beb098a304fb3b9ff13a3852c664cd.jpg"></div><br>  Agora vamos dar ao pincel uma forma redonda.  Para fazer isso, adicione os n√≥s selecionados: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b97/4bf/702/b974bf7024f3487a8161e279ad3fb350.jpg"></div><br>  <em>RadialGradientExponential</em> controla o tamanho e a nitidez da circunfer√™ncia do c√≠rculo.  A multiplica√ß√£o pela <em>cor de part√≠culas</em> permite controlar a opacidade das part√≠culas do sistema de part√≠culas.  Vou discutir isso em mais detalhes na pr√≥xima se√ß√£o. <br><br>  Aqui est√° a apar√™ncia do pincel: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/529/d6e/349/529d6e34937588676b1a20d03fdac107.jpg"></div><br>  Clique em <em>Aplicar</em> e feche o material.  Agora que criamos o material, √© hora de embarcar em um sistema de tra√ßos de part√≠culas. <br><br><h2>  Criando um sistema de tra√ßos de part√≠culas </h2><br>  V√° para a pasta <em>ParticleSystems</em> e abra <em>PS_GrassTrail</em> .  Para economizar tempo, eu j√° criei todos os m√≥dulos necess√°rios. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6aa/008/5ee/6aa0085ee0867456e29f574511b43ec2.jpg"></div><br>  Veja como cada m√≥dulo afeta as pegadas da grama: <br><br><ul><li>  <em>Spawn: a</em> frequ√™ncia da cria√ß√£o afeta a suavidade das faixas.  Se as faixas parecerem intermitentes, voc√™ dever√° aumentar a frequ√™ncia de cria√ß√£o.  Neste tutorial, deixaremos o valor padr√£o (20). </li><li>  <em>Vida</em> √∫til <em>:</em> a vida √∫til da trilha at√© que a grama retorne ao seu estado original </li><li>  <em>Tamanho inicial:</em> tamanho do tra√ßo </li><li>  <em>Cor ao longo da vida:</em> como usamos a cor de part√≠culas no material, voc√™ pode controlar a opacidade aqui.  Voc√™ tamb√©m pode alterar a curva alfa para controlar o desaparecimento da faixa.  Por exemplo, voc√™ pode escolher o desaparecimento linear, facilitando a entrada e / ou sa√≠da.  Neste tutorial, deixaremos a configura√ß√£o padr√£o, ou seja, perda linear. </li><li>  <em>Eixo de bloqueio:</em> usado para direcionar part√≠culas em dire√ß√£o √† captura de cena </li><li>  <em>Rota√ß√£o inicial:</em> usada para garantir que as part√≠culas sejam orientadas ao longo dos eixos corretos (mais sobre isso abaixo) </li></ul><br>  Primeiro, precisamos definir o material.  Selecione o m√≥dulo <em>Necess√°rio</em> e defina <em>Material</em> como <em>M_Direction</em> .  Defina tamb√©m o <em>Modo de classifica√ß√£o</em> como <em>PSORTMODE Age Newest First</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb0/a43/fa3/bb0a43fa369abea85bc7a9ff6a80b06e.jpg"></div><br>  Este modo de classifica√ß√£o permite renderizar novas part√≠culas sobre as antigas.  Se isso n√£o for feito, n√£o ser√° novo, mas as part√≠culas antigas afetar√£o a grama. <br><br>  A seguir, √© a dura√ß√£o do rastreamento.  Selecione o m√≥dulo <em>Lifetime</em> e defina <em>Constant</em> como <em>5</em> .  Gra√ßas a isso, o rastreamento desaparecer√° dentro de cinco segundos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/505/d9d/b73/505d9db732f69d4b68b4079bd330553c.jpg"></div><br>  Agora vamos para o tamanho do rastreamento.  Selecione o m√≥dulo <em>Tamanho inicial</em> e defina a <em>constante</em> como <em>(150, 150, 0)</em> .  Devido a isso, cada part√≠cula cobrir√° uma √°rea de 150 √ó 150. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/231/dba/9c5/231dba9c5421f8bdd79aba23f8def0cd.jpg"></div><br>  Agora precisamos fazer com que pare√ßa na dire√ß√£o de capturar a cena.  Como a cena √© capturada de cima, as part√≠culas devem olhar na dire√ß√£o do eixo Z positivo. Para fazer isso, selecione o m√≥dulo <em>Lock Axis</em> e defina os <em>Flags Lock Axis</em> como <em>Z.</em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b74/b2b/69c/b74b2b69c7d38785c7ad78d8ec6f250e.jpg"></div><br>  Finalmente, precisamos definir a rota√ß√£o das part√≠culas.  Atualmente, as cores do pincel n√£o est√£o alinhadas com a dire√ß√£o que representam.  Isso aconteceu porque, por padr√£o, o sistema de part√≠culas √© aplicado com uma rota√ß√£o de 90 graus.  Para corrigir isso, selecione o m√≥dulo <em>Rota√ß√£o Inicial</em> e defina o valor <em>Constante</em> como <em>-0,25</em> .  Isso ir√° girar as part√≠culas 90 graus no sentido anti-hor√°rio. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/41d/a09/000/41da09000032c1023438b15a3a74f341.jpg"></div><br>  E √© tudo o que precisamos para o sistema de part√≠culas, ent√£o vamos fech√°-lo. <br><br>  Em seguida, precisamos anexar um sistema de part√≠culas ao que √© suposto criar tra√ßos.  No nosso caso, precisamos anex√°-lo ao personagem do jogador. <br><br><h3>  Anexando sistema de part√≠culas </h3><br>  V√° para <em>Characters \ Mannequin</em> e abra <em>BP_Mannequin</em> .  Em seguida, crie o componente <em>Sistema de part√≠culas</em> e <em>denomine GrassParticles</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b72/9e0/811/b729e08111d25a301682968f1d878da0.jpg"></div><br>  Em seguida, precisamos definir um sistema de part√≠culas.  V√° para o painel Detalhes e defina <em>Particles \ Template</em> como <em>PS_GrassTrail</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/491/45d/7d3/49145d7d362eb92443a8cfe93bd8a023.jpg"></div><br>  Seria estranho se o jogador pudesse ver a pista no jogo, ent√£o vale a pena escond√™-la.  Para fazer isso, ative <em>Rendering \ Owner No See</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ad4/de5/7a8/ad4de57a8d9f0eeee254a58c0de8e8d6.jpg"></div><br>  Como o sistema de part√≠culas est√° conectado ao jogador (propriet√°rio), o jogador n√£o o ver√°, mas ficar√° vis√≠vel para todo o resto. <br><br>  Clique em <em>Compilar</em> e, em seguida, clique em <em>Executar</em> .  Observe que as part√≠culas n√£o aparecem na c√¢mera do jogador, mas s√£o exibidas no alvo de renderiza√ß√£o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c9d/4d5/4ac/c9d4d54ac998a6aa80da5887dc199b23.gif"></div><br>  At√© agora, a captura de cena est√° configurada para capturar <i>tudo</i> .  Obviamente, isso n√£o nos conv√©m, porque apenas part√≠culas afetam a grama.  Na pr√≥xima se√ß√£o, aprenderemos como capturar apenas part√≠culas. <br><br><h2>  Captura de part√≠culas </h2><br>  Se capturarmos part√≠culas agora, realizaremos flex√µes desnecess√°rias em √°reas sem part√≠culas.  Isso ocorre porque a cor de fundo do destino de renderiza√ß√£o √© preta.  A flex√£o ocorre porque o preto denota um movimento em dire√ß√£o aos eixos XY negativos (ap√≥s a redistribui√ß√£o).  Para que as √°reas vazias n√£o contenham movimento, precisamos renderizar o destino do plano de fundo <em>(0,5, 0,5, 0)</em> .  A maneira mais f√°cil de fazer isso √© criar um avi√£o enorme e anex√°-lo ao jogador. <br><br>  Primeiro, crie material para o plano de fundo.  Volte ao Navegador de conte√∫do e abra <em>Materials \ M_Background</em> .  Em seguida, conecte a constante <em>(0,5, 0,5, 0)</em> com a <em>Emissive Color</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/31b/46f/306/31b46f306ba4f2a0df310d36e54a000b.jpg"></div><br><blockquote>  <em>Nota:</em> como no material de part√≠culas, qualquer material que capturamos deve ter um modelo de <em>shader apagado</em> . </blockquote><br>  Clique em <em>Aplicar</em> e feche o material.  Volte para <em>BP_Mannequin</em> e crie um novo componente de <em>avi√£o</em> .  Nomeie-o como <em>plano de fundo</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bc4/0aa/1ff/bc40aa1ffbb655e576ce999318f4342b.jpg"></div><br>  Em seguida, defina as seguintes propriedades: <br><br><ul><li>  <em>Localiza√ß√£o:</em> (0, 0, -5000).  Colocamos o plano t√£o baixo que n√£o sobrep√µe nenhuma part√≠cula. </li><li>  <em>Escala:</em> (100, 100, 1).  Ent√£o, escalamos para um tamanho suficiente para cobrir toda a √°rea de captura. </li><li>  <em>Material:</em> M_Background </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e6d/824/d3b/e6d824d3b427cff5e136a2861eb02bed.jpg"></div><br>  Assim como as part√≠culas, seria estranho se o jogador visse um enorme avi√£o amarelo por baixo.  Para ocult√°-lo, ative <em>Rendering \ Owner No See</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cad/164/7df/cad1647dfe62bb1e29733ac8e6d6b712.jpg"></div><br>  Agora que configuramos o plano de fundo, √© hora de capturar as part√≠culas.  Podemos fazer isso adicionando um sistema de part√≠culas √† <em>lista apenas de exibi√ß√£o</em> da captura de cena.  Esta √© uma lista de componentes que capturam a captura de cena. <br><br><h3>  Usando a lista Show-Only </h3><br>  Antes de podermos adicionar √† lista de exibi√ß√£o apenas, precisamos de uma maneira de obter todos os atores que afetam a grama.  Uma maneira de obt√™-los √© usar <em>tags</em> .  Tags s√£o cadeias simples que podem ser atribu√≠das a atores e componentes.  Em seguida, voc√™ pode usar o n√≥ Obter todos os atores com tag para obter todos os atores com a tag correspondente. <br><br>  Como o ator do jogador deve influenciar a grama, ele precisa de uma etiqueta.  Para adicionar uma marca, clique no bot√£o <em>Padr√µes</em> da <em>classe</em> .  Em seguida, crie uma nova tag em <em>Actor \ Tags</em> e <em>chame</em> -a de <em>GrassAffector</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/759/df5/711/759df57115fd0a2172f9c9c4c5b0505d.jpg"></div><br>  Como apenas os <i>componentes</i> podem ser transferidos para a lista de exibi√ß√£o apenas, precisamos adicionar tags aos <i>componentes</i> que afetam a grama.  Selecione o componente <em>GrassParticles</em> e adicione uma nova tag localizada na se√ß√£o <em>Tags</em> .  Nomeie-o <em>GrassAffector</em> tamb√©m (n√£o √© <i>necess√°rio</i> usar essa tag).  Repita o mesmo para o componente <em>Background</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8f4/3f4/05a/8f43f405a8cf96083d5df56e54d21576.jpg"></div><br>  Agora, precisamos adicionar componentes que influenciam a grama √† lista apenas de exibi√ß√£o de captura de cena.  Clique em <em>Compilar</em> e feche <em>BP_Mannequin</em> .  Em seguida, abra <em>Blueprints \ BP_Capture</em> .  V√° para <em>Event BeginPlay</em> e adicione os n√≥s destacados.  Verifique tamb√©m se os pinos marcados est√£o conectados. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7d9/e82/3cf/7d9e823cffefede4f0273a81b9363ecb.jpg"></div><br>  Este circuito percorrer√° todos os atores com a tag <em>GrassAffector</em> .  Depois disso, ela verificar√° se o ator tem componentes com essa tag e os adicionar√° √† lista de exibi√ß√£o apenas. <br><br>  Em seguida, precisamos dizer √† captura de cena para usar apenas a lista de exibi√ß√£o apenas.  Selecione o componente <em>SceneCapture</em> e v√° para a se√ß√£o <em>Captura de cena</em> .  Defina <em>o Modo de renderiza√ß√£o primitivo</em> para <em>usar a lista ShowOnly</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/675/ecd/6eb/675ecd6eb2a1c867734b920bbeaeedd4.jpg"></div><br>  Clique em <em>Compilar</em> e feche o blueprint.  Se voc√™ clicar em <em>Reproduzir</em> , ver√° que o alvo de renderiza√ß√£o agora captura apenas part√≠culas e o plano de fundo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ee0/a1f/3d7/ee0a1f3d7bb9687f81ec2e7d0faaf61b.gif"></div><br>  Na pr√≥xima se√ß√£o, chegamos ao que esper√°vamos.  √â hora de ensinar a grama a se curvar! <br><br><h2>  Dobre a grama </h2><br>  Primeiro, precisamos projetar o alvo de renderiza√ß√£o na grama.  V√° para a pasta <em>Materiais</em> e abra <em>M_Grass</em> .  Em seguida, crie os n√≥s mostrados abaixo.  Defina a textura como <em>RT_Capture</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ec0/fd7/4e6/ec0fd74e6e18c21da2d9b647c878613c.jpg"></div><br>  Como redistribu√≠mos as cores no intervalo de 0 a 1, antes de us√°-las, precisamos redistribuir as cores novamente no intervalo de -1 a 1. Para fazer isso, adicione os n√≥s destacados: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/25d/dc7/0be/25ddc70be17e726bd3089c21ee5be21e.jpg"></div><br>  Agora que temos a dire√ß√£o de flex√£o, precisamos de uma maneira de girar a grama nessa dire√ß√£o.  Felizmente, existe um n√≥ chamado <em>RotateAboutAxis</em> para isso.  Vamos cri√°-lo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a92/4a0/127/a924a0127868686cf2616c8d994e9b5a.jpg"></div><br>  Vamos come√ßar com o contato <em>NormalizedRotationAxis</em> .  Como o nome indica, esse √© o eixo em torno do qual o v√©rtice girar√°.  Para calcular, precisamos apenas de um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">produto vetorial com a</a> dire√ß√£o da dobra por <em>(0, 0, -1)</em> .  Para fazer isso, precisamos adicionar os n√≥s selecionados: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5c3/898/ece/5c3898ecee9d7a4fd9ea75e53072acd1.jpg"></div><br>  Tamb√©m precisamos especificar o <em>RotationAngle</em> , ou seja, a quantidade de rota√ß√£o do v√©rtice em rela√ß√£o ao ponto de rota√ß√£o.  Por padr√£o, o valor deve estar entre 0 e 1, onde 0 √© 0 graus e 1 √© 360 graus.  Para obter o √¢ngulo de rota√ß√£o, podemos usar o comprimento da dire√ß√£o de flex√£o, multiplicado pela rota√ß√£o m√°xima. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6d4/171/800/6d417180067018db8df09f878251f6e8.jpg"></div><br>  Multiplicar por uma rota√ß√£o m√°xima de <em>0,2</em> significa que o √¢ngulo m√°ximo de rota√ß√£o √© de <em>72</em> graus. <br><br>  O c√°lculo do <em>PivotPoint</em> √© um pouco mais dif√≠cil, porque uma √∫nica malha de grama cont√©m v√°rios caules.  Isso significa que n√£o podemos usar algo como o n√≥ <em>Posi√ß√£o</em> do <em>objeto</em> , porque ele retornar√° um √∫nico ponto para todas as hastes da grama. <br><br>  Idealmente, voc√™ deve usar um editor 3D de terceiros para salvar pontos de articula√ß√£o dentro dos canais UV.  Mas para este tutorial, apenas aproximamos o ponto de articula√ß√£o.  Isso pode ser feito movendo-se de cima para <em>baixo</em> para um determinado deslocamento. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f47/6ac/cdf/f476accdf57bca37d5bd7994f53b6b47.jpg"></div><br>  Para fazer isso, adicione os n√≥s selecionados: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/05a/1bd/208/05a1bd2082b7044a1535aaf38cf33264.jpg"></div><br>  Neste tutorial, a grama tem cerca de <em>80</em> unidades de altura, ent√£o eu configurei esse valor para <em>PivotOffset</em> . <br><br>  Em seguida, precisamos executar duas m√°scaras.  A primeira m√°scara garante que a raiz da haste n√£o se mova.  A segunda m√°scara garante que nenhum campo de vetor atue na grama fora da √°rea de captura. <br><br><h3>  Mascaramento </h3><br>  Para este tutorial, defino as cores dos topos da grama para que os v√©rtices inferiores sejam pretos e os v√©rtices superiores sejam brancos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/199/0ff/45b/1990ff45be26b99bf5330a0d2817e102.jpg"></div><br>  Para mascarar as ra√≠zes, simplesmente multiplicamos o resultado de <em>RotateAboutAxis</em> pelo n√≥ <em>Vertex Color</em> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/522/568/0fc/5225680fcb4fd4bedf2f7ec7a49ebb58.jpg"></div><br>  Para mascarar a grama fora da √°rea de captura, multiplicamos o resultado anterior pelo n√≥ selecionado: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/37b/da2/e95/37bda2e954f8e160ab3b0c80d5269acf.jpg"></div><br>  Clique em <em>Aplicar</em> e feche o material.  Clique em <em>Play</em> e corra pela grama para deixar pegadas nela! <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1dc/058/185/1dc058185c158d1ef243b04f5d041174.gif"></div><br><h2>  Para onde ir a seguir? </h2><br>  O projeto finalizado pode ser baixado <a href="">aqui</a> . <br><br>  Embora o m√©todo mostrado no tutorial funcione muito bem para objetos simples, como grama, n√£o √© suficiente ao usar objetos que exigem mais dinamismo.  Uma solu√ß√£o parcial para o problema √© usar as vers√µes f√≠sicas da folhagem.  Veja <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">este post</a> sobre folhagem interativa para obter mais informa√ß√µes. <br><br>  Finalmente, quero agradecer a Deathrey, da comunidade Unreal Engine, pela dica desse m√©todo de part√≠culas! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt420079/">https://habr.com/ru/post/pt420079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt420069/index.html">Richard Hamming: Cap√≠tulo 20. Modelagem - III</a></li>
<li><a href="../pt420071/index.html">Pre√ßos diferentes para armaz√©ns em v√°rios armaz√©ns. Refinamento 1C-Bitrix</a></li>
<li><a href="../pt420073/index.html">A arte da administra√ß√£o: uma revis√£o dos melhores relat√≥rios com o Teamlead Conf 2018. Parte 2</a></li>
<li><a href="../pt420075/index.html">Este mapa engenhoso explica como tudo na f√≠sica se encaixa.</a></li>
<li><a href="../pt420077/index.html">Novas oportunidades de negocia√ß√£o on-line</a></li>
<li><a href="../pt420081/index.html">Instale o Archlinux com criptografia completa do sistema e LVM no LUKS</a></li>
<li><a href="../pt420083/index.html">A√ß√£o ideal para o Google Assistant - 8 li√ß√µes da Hackathon de Moscou</a></li>
<li><a href="../pt420085/index.html">Reconhecimento de objetos e emo√ß√µes humanas usando o Firebase ML Kit</a></li>
<li><a href="../pt420087/index.html">Esta √© uma postagem com relat√≥rios e v√≠deos no MS SQL Server.</a></li>
<li><a href="../pt420089/index.html">Robomobiles: Pelot√£o e Enchidos da Baviera</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>