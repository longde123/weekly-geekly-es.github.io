<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßö üï¥üèª üíó Introducci√≥n a los ensambles deterministas en C / C ++. Parte 1 üíø üë©üèº‚Äçüé§ üòó</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La traducci√≥n del art√≠culo fue preparada especialmente para estudiantes del curso "Desarrollador C ++" . 



 ¬øQu√© es una asamblea determinista? 
 Un ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introducci√≥n a los ensambles deterministas en C / C ++. Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/467741/">  <i>La traducci√≥n del art√≠culo fue preparada especialmente para estudiantes del curso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Desarrollador C ++"</a> .</i> <br><br><img src="https://habrastorage.org/webt/pe/j0/5e/pej05eo-w-5tdwrp0yrlv7lbedy.png"><br><hr><br><h3>  ¬øQu√© es una asamblea determinista? </h3><br>  Un ensamblaje determinista es el proceso de construir el mismo c√≥digo fuente con el mismo entorno e instrucciones de ensamblaje, en el que se crean los mismos archivos binarios en cualquier caso, incluso si est√°n hechos en diferentes m√°quinas, en diferentes directorios y con diferentes nombres .  Tales ensamblajes tambi√©n se denominan a veces ensamblables jugables o sellados si se garantiza que crear√°n los mismos binarios incluso cuando se compilan desde diferentes carpetas. <a name="habracut"></a><br><br>  Las asambleas deterministas no son algo que sucede por s√≠ solo.  No se crean en proyectos ordinarios, y las razones por las que esto no sucede pueden ser diferentes para cada sistema operativo o compilador. <br><br>  Los ensamblajes deterministas deben estar garantizados para un <i>entorno de ensamblaje</i> dado.  Esto significa que algunas variables, como <i>el sistema operativo, las versiones del sistema de compilaci√≥n y la arquitectura de destino</i> , presumiblemente permanecen iguales en diferentes compilaciones. <br><br>  En los √∫ltimos a√±os, varias organizaciones, como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Chromium</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Construcciones</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">reproducibles</a> o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Yocto</a> , han realizado grandes esfuerzos para lograr ensamblajes deterministas. <br><br><h3>  La importancia de las asambleas deterministas </h3><br>  Hay dos razones principales por las que los conjuntos deterministas son tan importantes: <br><br><ul><li>  <b>Seguridad</b>  Cambiar los binarios en lugar del c√≥digo fuente puede hacer que los cambios sean invisibles para los autores originales.  Esto puede ser fatal en entornos cr√≠ticos para la seguridad, como la medicina, la aviaci√≥n y el espacio.  Resultados potencialmente id√©nticos para estos materiales permiten a terceros llegar a un consenso sobre el resultado correcto. </li><li>  <b>Trazabilidad y control binario</b> .  Si desea tener un repositorio para almacenar sus archivos binarios, lo m√°s probable es que no desee crear archivos binarios con sumas de verificaci√≥n aleatorias de las fuentes en la misma revisi√≥n.  Esto puede hacer que el sistema de repositorio almacene diferentes archivos binarios como versiones diferentes cuando deber√≠an ser iguales.  Por ejemplo, si trabaja en Windows o MacOS, la biblioteca tiene campos con el tiempo de creaci√≥n / modificaci√≥n de los archivos de objeto incluidos, lo que conducir√° a diferencias en los archivos binarios. </li></ul><br><h3>  Archivos binarios involucrados en el proceso de compilaci√≥n en C / C ++ </h3><br>  Existen varios tipos de archivos binarios que se crean durante el proceso de compilaci√≥n en C / C ++, seg√∫n el sistema operativo. <br><br>  <b>Microsoft Windows</b>  Los m√°s importantes son los archivos con las extensiones <code>.obj</code> , <code>.lib</code> , <code>.lib</code>  <code>dll</code> y <code>.exe</code> .  Todos cumplen con la especificaci√≥n del formato ejecutable port√°til (PE).  Estos archivos se pueden analizar con herramientas como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dumpbin</a> . <br>  <b>Linux</b>  Los archivos con las extensiones <code>.o</code> , <code>.a</code> , <code>.so</code> y sin extensiones (para archivos binarios ejecutables) corresponden al formato de archivos ejecutables y vinculables (ELF).  El contenido de los archivos ELF se puede analizar con <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">readelf</a> . <br>  <b>Mac OS</b>  Los archivos con las extensiones <code>.o</code> , <code>.a</code> , <code>.dylib</code> y sin extensiones (para archivos binarios ejecutables) cumplen con la especificaci√≥n de formato Mach-O.  Estos archivos se pueden verificar utilizando la aplicaci√≥n <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">otool</a> , que forma parte del kit de herramientas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Xcode</a> en MacOS. <br><br><h3>  Fuentes de variaciones </h3><br>  Muchos factores diferentes pueden hacer que sus ensamblajes <i>no sean deterministas</i> .  Los factores variar√°n para los diferentes sistemas operativos y compiladores.  Cada compilador tiene ciertos par√°metros para corregir las fuentes de variaci√≥n.  Hasta la fecha, <code>gcc</code> y <code>clang</code> son los compiladores que contienen m√°s opciones de reparaci√≥n.  Hay algunas opciones no documentadas para <code>msvc</code> que puede probar, pero al final, probablemente tenga que arreglar los binarios para obtener ensamblajes deterministas. <br><br><h4>  Marcas de tiempo agregadas por compilador / enlazador </h4><br>  Hay dos razones principales por las cuales nuestros archivos binarios pueden contener informaci√≥n de tiempo que los hace imposibles de reproducir: <br><br><ul><li>  Usando las <code>__TIME__</code> <code>__DATE__</code> o <code>__TIME__</code> en la fuente. </li><li>  Cuando un formato de archivo te obliga a almacenar informaci√≥n de tiempo en archivos de objetos.  Este es el caso del formato ejecutable port√°til en Windows y Mach-O en MacOS.  En Linux, los archivos ELF no codifican ninguna marca de tiempo. </li></ul><br>  Veamos un ejemplo en el que esta informaci√≥n termina compilando una biblioteca est√°tica del proyecto base hello world en MacOS. <br><br><pre> <code class="cpp hljs">. ‚îú‚îÄ‚îÄ CMakeLists.txt ‚îú‚îÄ‚îÄ hello_world.cpp ‚îú‚îÄ‚îÄ hello_world.hpp ‚îú‚îÄ‚îÄ main.cpp ‚îî‚îÄ‚îÄ run_build.sh</code> </pre> <br>  La biblioteca muestra un mensaje en la terminal: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"hello_world.hpp"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; void HelloWorld::PrintMessage(const std::string &amp; message) { std::cout &lt;&lt; message &lt;&lt; std::endl; }</span></span></span></span></code> </pre> <br>  Y la aplicaci√≥n usar√° esto para mostrar el mensaje "¬°Hola Mundo!": <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; #include "hello_world.hpp" int main(int argc, char** argv) { HelloWorld hello; hello.PrintMessage("Hello World!"); return 0; }</span></span></span></span></code> </pre> <br>  Usaremos CMake para construir el proyecto: <br><br><pre> <code class="cpp hljs">cmake_minimum_required(VERSION <span class="hljs-number"><span class="hljs-number">3.0</span></span>) project(HelloWorld) <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>(CMAKE_CXX_STANDARD <span class="hljs-number"><span class="hljs-number">11</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">set</span></span>(CMAKE_CXX_STANDARD_REQUIRED ON) add_library(HelloLibA hello_world.cpp) add_library(HelloLibB hello_world.cpp) add_executable(helloA main.cpp) add_executable(helloB main.cpp) target_link_libraries(helloA HelloLibA) target_link_libraries(helloB HelloLibB)</code> </pre> <br>  Crearemos dos bibliotecas diferentes con el mismo c√≥digo fuente, as√≠ como dos archivos binarios con las mismas fuentes.  Compile el proyecto y ejecute <code>md5sum</code> para ver las sumas de comprobaci√≥n de todos los archivos binarios: <br><br><pre> <code class="cpp hljs">mkdir build &amp;&amp; cd build cmake .. make md5sum helloA md5sum helloB md5sum CMakeFiles/HelloLibA.dir/hello_world.cpp.o md5sum CMakeFiles/HelloLibB.dir/hello_world.cpp.o md5sum libHelloLibA.a md5sum libHelloLibB.a</code> </pre> <br>  Tenemos una conclusi√≥n como esta: <br><br><pre> <code class="cpp hljs">b5dce09c593658ee348fd0f7fae22c94 helloA b5dce09c593658ee348fd0f7fae22c94 helloB <span class="hljs-number"><span class="hljs-number">0</span></span>a4a0de3df8cc7f053f2fcb6d8b75e6d CMakeFiles/HelloLibA.dir/hello_world.cpp.o <span class="hljs-number"><span class="hljs-number">0</span></span>a4a0de3df8cc7f053f2fcb6d8b75e6d CMakeFiles/HelloLibB.dir/hello_world.cpp.o adb80234a61bb66bdc5a3b4b7191eac7 libHelloLibA.a <span class="hljs-number"><span class="hljs-number">5</span></span>ac3c70d28d9fdd9c6571e077131545e libHelloLibB.a</code> </pre> <br>  Esto es interesante porque los <code>helloB</code> <code>helloA</code> y <code>helloB</code> tienen las mismas sumas de comprobaci√≥n, as√≠ como los archivos de objetos intermedios de Mach-O <code>hello_world.cpp.o</code> , pero esto no se puede decir de los archivos con la extensi√≥n <code>.a</code> .  Esto se debe a que almacenan informaci√≥n sobre archivos de objetos intermedios en un formato de archivo.  El encabezado de este formato incluye un campo llamado <code>st_time</code> establecido por la llamada al sistema de <code>stat</code> .  Verifique <code>libHelloLibA.a</code> y <code>libHelloLibB.a</code> usando <code>otool</code> para mostrar los encabezados: <br><br><pre> <code class="cpp hljs">&gt; otool -a libHelloLibA.a Archive : libHelloLibA.a <span class="hljs-number"><span class="hljs-number">0100644</span></span> <span class="hljs-number"><span class="hljs-number">503</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">612</span></span> <span class="hljs-number"><span class="hljs-number">1566927276</span></span> #<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">0100644</span></span> <span class="hljs-number"><span class="hljs-number">503</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">13036</span></span> <span class="hljs-number"><span class="hljs-number">1566927271</span></span> #<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">28</span></span> &gt; otool -a libHelloLibB.a Archive : libHelloLibB.a <span class="hljs-number"><span class="hljs-number">0100644</span></span> <span class="hljs-number"><span class="hljs-number">503</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">612</span></span> <span class="hljs-number"><span class="hljs-number">1566927277</span></span> #<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">0100644</span></span> <span class="hljs-number"><span class="hljs-number">503</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">13036</span></span> <span class="hljs-number"><span class="hljs-number">1566927272</span></span> #<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">28</span></span></code> </pre> <br>  Vemos que el archivo contiene varios campos temporales que hacen que nuestro ensamblaje no sea determinista.  Tenga en cuenta que estos campos no se aplican al archivo ejecutable final porque tienen la misma suma de verificaci√≥n.  Este problema tambi√©n puede ocurrir al compilar en Windows con Visual Studio, pero con un archivo PE en lugar de Mach-O. <br><br>  En este punto, podemos intentar empeorar las cosas y hacer que nuestros archivos binarios tambi√©n sean no deterministas.  Cambie el archivo <code>main.cpp</code> para que incluya la macro <code>__TIME__</code> : <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;iostream&gt; #include "hello_world.hpp" int main(int argc, char** argv) { HelloWorld hello; hello.PrintMessage("Hello World!"); std::cout &lt;&lt; "At time: " &lt;&lt; __TIME__ &lt;&lt; std::endl; return 0; }</span></span></span></span></code> </pre> <br>  Verifique nuevamente las sumas de verificaci√≥n de los archivos: <br><br><pre> <code class="cpp hljs"><span class="hljs-number"><span class="hljs-number">625</span></span>ecc7296e15d41e292f67b57b04f15 helloA <span class="hljs-number"><span class="hljs-number">20f</span></span>92d2771a7d2f9866c002de918c4da helloB <span class="hljs-number"><span class="hljs-number">0</span></span>a4a0de3df8cc7f053f2fcb6d8b75e6d CMakeFiles/HelloLibA.dir/hello_world.cpp.o <span class="hljs-number"><span class="hljs-number">0</span></span>a4a0de3df8cc7f053f2fcb6d8b75e6d CMakeFiles/HelloLibB.dir/hello_world.cpp.o b7801c60d3bc4f83640cadc1183f43b3 libHelloLibA.a <span class="hljs-number"><span class="hljs-number">4</span></span>ef6cae3657f2a13ed77830953b0aee8 libHelloLibB.a</code> </pre> <br>  Vemos que ahora tenemos diferentes binarios.  Podr√≠amos analizar el ejecutable con una herramienta como un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">difoscopio</a> , que muestra la diferencia entre dos archivos binarios: <br><br><pre> <code class="cpp hljs">&gt; diffoscope helloA helloB --- helloA +++ helloB ‚îú‚îÄ‚îÄ otool -arch x86_64 -tdvV {} ‚îÇ‚îÑ Code <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> architecture x86_64 ‚îÇ @@ <span class="hljs-number"><span class="hljs-number">-16</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span> +<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span> @@ ‚îÇ <span class="hljs-number"><span class="hljs-number">00000001000018</span></span>da jmp <span class="hljs-number"><span class="hljs-number">0x1000018df</span></span> ‚îÇ <span class="hljs-number"><span class="hljs-number">00000001000018</span></span>df leaq <span class="hljs-number"><span class="hljs-number">-0x30</span></span>(%rbp), %rdi ‚îÇ <span class="hljs-number"><span class="hljs-number">00000001000018e3</span></span> callq <span class="hljs-number"><span class="hljs-number">0x100002d54</span></span> #<span class="hljs-meta"><span class="hljs-meta"># symbol stub for: __ZNSt3__112basic_stringIcNS_11char_traitsIcEENS_9allocatorIcEEED1Ev ‚îÇ 00000001000018e8 movq 0x1721(%rip), %rdi ## literal pool symbol address: __ZNSt3__14coutE ‚îÇ 00000001000018ef leaq 0x162f(%rip), %rsi ## literal pool for: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"At time: "</span></span></span><span class="hljs-meta"> ‚îÇ 00000001000018f6 callq 0x100002d8a ## symbol stub for: __ZNSt3__1lsINS_11char_traitsIcEEEERNS_13basic_ostreamIcT_EES6_PKc ‚îÇ 00000001000018fb movq %rax, %rdi ‚îÇ -00000001000018fe leaq 0x162a(%rip), %rsi ## literal pool for: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"19:40:47"</span></span></span><span class="hljs-meta"> ‚îÇ +00000001000018fe leaq 0x162a(%rip), %rsi ## literal pool for: </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"19:40:48"</span></span></span><span class="hljs-meta"> ‚îÇ 0000000100001905 callq 0x100002d8a ## symbol stub for: __ZNSt3__1lsINS_11char_traitsIcEEEERNS_13basic_ostreamIcT_EES6_PKc ‚îÇ 000000010000190a movq %rax, %rdi ‚îÇ 000000010000190d leaq __ZNSt3__1L4endlIcNS_11char_traitsIcEEEERNS_13basic_ostreamIT_T0_EES7_(%rip), %rsi #</span></span></code> </pre> <br>  Muestra que la informaci√≥n <code>__TIME__</code> ha pegado en el binario, lo que la hace no determinista.  Veamos qu√© se puede hacer para evitar esto. <br><br><h4>  Posibles soluciones para Microsoft Visual Studio </h4><br>  Microsoft Visual Studio tiene un indicador de enlace / Brepro que no est√° documentado por Microsoft.  Este indicador establece las marcas de tiempo del formato ejecutable port√°til en -1, como se ve en la figura a continuaci√≥n. <br><br><img src="https://habrastorage.org/webt/oh/ds/ca/ohdsca2wvgdmv_j4zdfgbyc5xmq.png"><br><br>  Para activar este indicador con CMake, debemos agregar las siguientes l√≠neas al crear el <code>.exe</code> : <br><br><pre> <code class="cpp hljs">add_link_options(<span class="hljs-string"><span class="hljs-string">"/Brepro"</span></span>)</code> </pre> <br>  o estas l√≠neas para <code>.lib</code> <br><br><pre> <code class="cpp hljs">set_target_properties( TARGET PROPERTIES STATIC_LIBRARY_OPTIONS <span class="hljs-string"><span class="hljs-string">"/Brepro"</span></span> )</code> </pre> <br>  El problema es que este indicador hace que los binarios sean reproducibles (en relaci√≥n con las marcas de tiempo en el formato de archivo) en nuestro .exe binario final, pero no elimina todas las marcas de tiempo de .lib (el mismo problema que con los archivos de objetos Mach-O, de lo que hablamos anteriormente).  El campo TimeDateStamp del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">archivo de encabezado COFF</a> para archivos <code>.lib</code> permanecer√°.  La √∫nica forma de eliminar esta informaci√≥n del archivo binario <code>.lib</code> es arreglar el <code>.lib</code> reemplazando los bytes correspondientes al campo TimeDateStamp con cualquier valor conocido. <br><br><h4>  Posibles soluciones para GCC y CLANG </h4><br><ul><li>  gcc detecta la existencia de la variable de entorno SOURCE_DATE_EPOCH.  Si se establece esta variable, su valor indica la marca de tiempo UNIX que se usar√° para reemplazar la fecha y hora actuales en las macros <code>__DATE__</code> y <code>__TIME__</code> para que las marcas de tiempo incorporadas se vuelvan reproducibles.  El valor se puede establecer en una marca de tiempo conocida, como la hora del √∫ltimo cambio en los archivos o paquetes fuente. </li><li>  clang usa <code>ZERO_AR_DATE</code> , que, si est√° configurado, restablece la <code>ZERO_AR_DATE</code> tiempo proporcionada en los archivos de almacenamiento, configur√°ndola en 0. Tenga en cuenta que esto no solucionar√° las <code>__TIME__</code> <code>__DATE__</code> o <code>__TIME__</code> .  Si queremos corregir el efecto de esta macro, debemos corregir los binarios o simular la hora del sistema. </li></ul><br>  Continuemos con nuestro proyecto de muestra para MacOS y veamos cu√°les ser√°n los resultados al configurar la <code>ZERO_AR_DATE</code> entorno <code>ZERO_AR_DATE</code> . <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> ZERO_AR_DATE=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  Ahora, si compilamos nuestro archivo ejecutable y nuestras bibliotecas (eliminando la macro <code>__DATE__</code> en las fuentes), obtenemos: <br><br><pre> <code class="cpp hljs">b5dce09c593658ee348fd0f7fae22c94 helloA b5dce09c593658ee348fd0f7fae22c94 helloB <span class="hljs-number"><span class="hljs-number">0</span></span>a4a0de3df8cc7f053f2fcb6d8b75e6d CMakeFiles/HelloLibA.dir/hello_world.cpp.o <span class="hljs-number"><span class="hljs-number">0</span></span>a4a0de3df8cc7f053f2fcb6d8b75e6d CMakeFiles/HelloLibB.dir/hello_world.cpp.o <span class="hljs-number"><span class="hljs-number">9f</span></span>9a9af4bb3e220e7a22fb58d708e1e5 libHelloLibA.a <span class="hljs-number"><span class="hljs-number">9f</span></span>9a9af4bb3e220e7a22fb58d708e1e5 libHelloLibB.a</code> </pre> <br>  Todas las sumas de verificaci√≥n son ahora iguales.  <code>.a</code> los encabezados de los archivos con la extensi√≥n <code>.a</code> : <br><br><pre> <code class="cpp hljs">&gt; otool -a libHelloLibA.a Archive : libHelloLibA.a <span class="hljs-number"><span class="hljs-number">0100644</span></span> <span class="hljs-number"><span class="hljs-number">503</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">612</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> #<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">0100644</span></span> <span class="hljs-number"><span class="hljs-number">503</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">13036</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> #<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">28</span></span> &gt; otool -a libHelloLibB.a Archive : libHelloLibB.a <span class="hljs-number"><span class="hljs-number">0100644</span></span> <span class="hljs-number"><span class="hljs-number">503</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">612</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> #<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">0100644</span></span> <span class="hljs-number"><span class="hljs-number">503</span></span>/<span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">13036</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> #<span class="hljs-number"><span class="hljs-number">1</span></span>/<span class="hljs-number"><span class="hljs-number">28</span></span></code> </pre> <br>  Podemos ver que el campo de <code>timestamp</code> de <code>timestamp</code> del encabezado de la biblioteca se estableci√≥ en cero. <br><br>  <i>Llegamos sin problemas al final de la primera parte del art√≠culo.</i>  <i>La continuaci√≥n del material se puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">leer aqu√≠</a> .</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/467741/">https://habr.com/ru/post/467741/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../467729/index.html">Chips o paseo? Peque√±as cosas √∫nicas en tel√©fonos inteligentes</a></li>
<li><a href="../467733/index.html">Como desarrollador, nunca s√© mi propio valor, porque no hay ninguno. Pero todo el sistema est√° construido como si fuera</a></li>
<li><a href="../467735/index.html">Desaf√≠os de posici√≥n adulta</a></li>
<li><a href="../467737/index.html">Aplicaciones Bot VS: pros y contras. Caso del contador bot</a></li>
<li><a href="../467739/index.html">Un negocio sin tecnolog√≠a. Dinero que te perdi√≥</a></li>
<li><a href="../467743/index.html">SamsPcbGuide, parte 11: Tecnolog√≠a: cajas tipo BGA, pl√°stico y espacio</a></li>
<li><a href="../467745/index.html">Agrupe mejor que el "m√©todo del codo"</a></li>
<li><a href="../467747/index.html">Pruebas psicol√≥gicas: c√≥mo pasar de un psic√≥logo certificado a un probador</a></li>
<li><a href="../467749/index.html">GCP: an√°lisis de la pila de computaci√≥n de Google Cloud Platform</a></li>
<li><a href="../467751/index.html">¬øC√≥mo funciona un mensajero descentralizado en la cadena de bloques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>