<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯМ░ ЁЯР░ тШая╕П рдЙрддреНрдкрд╛рджрди рдореЗрдВ рдХреБрдмреЗрд░рдиреЗрдЯ: рд╕реЗрд╡рд╛рдПрдВ ЁЯТкЁЯП╜ ЁЯУЦ ЁЯМЭ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЫрд╣ рдорд╣реАрдиреЗ рдкрд╣рд▓реЗ, рд╣рдордиреЗ рдЕрдкрдиреА рд╕рднреА рд╕реНрдЯреЗрдЯрд▓реЗрд╕ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдкреНрд░рд╡рд╛рд╕ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рдкреВрд░рд╛ рдХрд┐рдпрд╛ред рдкрд╣рд▓реА рдирдЬрд╝рд░ рдореЗрдВ, рдХрд╛рд░реНрдп рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ: рдЖрдкрдХреЛ рдПрдХ рдХреНрд▓рд╕реНрдЯрд░ рддреИрдирд╛рдд рдХрд░рдиреЗ, рдПрдкреНрд▓рд┐рдХреЗ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдЙрддреНрдкрд╛рджрди рдореЗрдВ рдХреБрдмреЗрд░рдиреЗрдЯ: рд╕реЗрд╡рд╛рдПрдВ</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/okmeter/blog/424229/"><p><img align="left" width="250" src="https://habrastorage.org/webt/ww/yz/_z/wwyz_zvbfjx8vrreqprenpo0a00.png">  рдЫрд╣ рдорд╣реАрдиреЗ рдкрд╣рд▓реЗ, рд╣рдордиреЗ рдЕрдкрдиреА рд╕рднреА рд╕реНрдЯреЗрдЯрд▓реЗрд╕ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдкреНрд░рд╡рд╛рд╕ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рдкреВрд░рд╛ рдХрд┐рдпрд╛ред  рдкрд╣рд▓реА рдирдЬрд╝рд░ рдореЗрдВ, рдХрд╛рд░реНрдп рдХрд╛рдлреА рд╕рд░рд▓ рд╣реИ: рдЖрдкрдХреЛ рдПрдХ рдХреНрд▓рд╕реНрдЯрд░ рддреИрдирд╛рдд рдХрд░рдиреЗ, рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд╡рд┐рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рд▓рд┐рдЦрдиреЗ рдФрд░ рдЬрд╛рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред  рд╣рдорд╛рд░реА рд╕реЗрд╡рд╛ рдХреЗ рдХрд╛рдо рдореЗрдВ рд╕реНрдерд┐рд░рддрд╛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рдЬреБрдиреВрди рдХреЗ рдХрд╛рд░рдг, рдореБрдЭреЗ рддреБрд░рдВрдд рдпрд╣ рд╕рдордЭрдирд╛ рд╢реБрд░реВ рдХрд░ рджрд┐рдпрд╛ рдХрд┐ k8 рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ рдФрд░ рд╡рд┐рднрд┐рдиреНрди рд╡рд┐рдлрд▓рддрд╛ рдкрд░рд┐рджреГрд╢реНрдпреЛрдВ рдХрд╛ рдкрд░реАрдХреНрд╖рдг рдХрд░рддрд╛ рд╣реИред  рдЕрдзрд┐рдХрд╛рдВрд╢ рдкреНрд░рд╢реНрди рдореЗрд░реЗ рдкрд╛рд╕ рдиреЗрдЯрд╡рд░реНрдХ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рд╣рд░ рдЪреАрдЬ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдереЗред  рдЗрди рдлрд┐рд╕рд▓рди рдореБрджреНрджреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ kubernetes рдореЗрдВ рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рд╕рдВрдЪрд╛рд▓рди рд╣реИред </p><br><p>  рдкреНрд░рд▓реЗрдЦрди рд╣рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИ: </p><br><ul><li>  рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рд░реЛрд▓ рдЖрдЙрдЯ рдХрд░реЗрдВ </li><li>  рд╕реЗрдЯ рд▓реАрдирд┐рдВрдЧ / рддрддреНрдкрд░рддрд╛ рдХреЗ рдирдореВрдиреЗ </li><li>  рдПрдХ рд╕реЗрд╡рд╛ рдмрдирд╛рдПрдБ </li><li>  рдлрд┐рд░ рд╕рдм рдХреБрдЫ рдХрд╛рдо рдХрд░реЗрдЧрд╛: рд▓реЛрдб рд╕рдВрддреБрд▓рди, рд╡рд┐рдлрд▓рддрд╛, рдЖрджрд┐ред </li></ul><br><p>  рд▓реЗрдХрд┐рди рд╡реНрдпрд╡рд╣рд╛рд░ рдореЗрдВ, рд╕рдм рдХреБрдЫ рдХреБрдЫ рдЕрдзрд┐рдХ рдЬрдЯрд┐рд▓ рд╣реИред  рдЖрдЗрдП рджреЗрдЦреЗрдВ рдХрд┐ рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред </p><a name="habracut"></a><br><h2 id="nemnogo-teorii">  рд╕рд┐рджреНрдзрд╛рдВрдд рдХреА рдмрд┐рдЯ </h2><br><p>  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдореЗрд░рд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдкрд╛рдардХ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдбрд┐рд╡рд╛рдЗрд╕ рдФрд░ рдЗрд╕рдХреА рд╢рдмреНрджрд╛рд╡рд▓реА рд╕реЗ рдкрд░рд┐рдЪрд┐рдд рд╣реИ; рд╣рдо рдХреЗрд╡рд▓ рдпрд╛рдж рдХрд░рддреЗ рд╣реИрдВ рдХрд┐ рдПрдХ рд╕реЗрд╡рд╛ рдХреНрдпрд╛ рд╣реИред </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реЗрд╡рд╛</a> k8s рдХрд╛ рд╕рд╛рд░ рд╣реИ, рдЬреЛ рдЙрдиреНрд╣реЗрдВ рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЪреВрд▓реНрд╣рд╛</a> рдФрд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХрд╛ рдПрдХ рд╕реЗрдЯ рдХрд╛ рд╡рд░реНрдгрди рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рд╣рдордиреЗ рдЕрдкрдирд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рд▓реЙрдиреНрдЪ рдХрд┐рдпрд╛: </p><br><pre><code class="plaintext hljs">apiVersion: apps/v1 kind: Deployment metadata: name: webapp spec: selector: matchLabels: app: webapp replicas: 2 template: metadata: labels: app: webapp spec: containers: - name: webapp image: defaultxz/webapp command: ["/webapp", "0.0.0.0:80"] ports: - containerPort: 80 readinessProbe: httpGet: {path: /, port: 80} initialDelaySeconds: 1 periodSeconds: 1</code> </pre> <br><pre> <code class="bash hljs">$ kubectl get pods -l app=webapp NAME READY STATUS RESTARTS AGE webapp-5d5d96f786-b2jxb 1/1 Running 0 3h webapp-5d5d96f786-rt6j7 1/1 Running 0 3h</code> </pre> <br><p>  рдЕрдм, рдЗрд╕реЗ рдПрдХреНрд╕реЗрд╕ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдореЗрдВ рдПрдХ рд╕реЗрд╡рд╛ рдмрдирд╛рдиреА рд╣реЛрдЧреА рдЬрд┐рд╕рдореЗрдВ рд╣рдо рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╣рдо рдХрд┐рди рдЪреИрдирд▓реЛрдВ (рдПрдХреНрд╕реЗрд╕рд░) рддрдХ рдкрд╣реБрдБрдЪрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдФрд░ рдХрд┐рди рдкреЛрд░реНрдЯреНрд╕ рдкрд░ рд╣реИрдВ: </p><br><pre> <code class="plaintext hljs">kind: Service apiVersion: v1 metadata: name: webapp spec: selector: app: webapp ports: - protocol: TCP port: 80 targetPort: 80</code> </pre> <br><pre> <code class="bash hljs">$ kubectl get svc webapp NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE webapp ClusterIP 10.97.149.77 &lt;none&gt; 80/TCP 1d</code> </pre> <br><p>  рдЕрдм рд╣рдо рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдХрд┐рд╕реА рднреА рдорд╢реАрди рд╕реЗ рдЕрдкрдиреА рд╕реЗрд╡рд╛ рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="bash hljs">curl -i http://10.97.149.77 HTTP/1.1 200 OK Date: Mon, 24 Sep 2018 11:55:14 GMT Content-Length: 2 Content-Type: text/plain; charset=utf-8</code> </pre> <br><h2 id="kak-eto-vse-rabotaet">  рдпрд╣ рд╕рдм рдХреИрд╕реЗ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ </h2><br><img src="https://habrastorage.org/webt/bn/uc/y4/bnucy4fkcptbeo3fwyycr-fc6po.jpeg"><br><p>  рдмрд╣реБрдд рд╕рд░рд▓реАрдХреГрдд: </p><br><ul><li>  рдЖрдкрдиреЗ kubectl рдкрд░рд┐рдирд┐рдпреЛрдЬрди рдЪрд╢реНрдорд╛ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдерд╛ </li><li>  рдЬрд╛рджреВ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдХрд╛ рд╡рд┐рд╡рд░рдг рдЗрд╕ рд╕рдВрджрд░реНрдн рдореЗрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдирд╣реАрдВ рд╣реИ </li><li>  рдирддреАрдЬрддрди, рдЖрд╡реЗрджрди рдХреЗ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдиреЛрдб рдХреБрдЫ рдиреЛрдбреНрд╕ рдкрд░ рдирд┐рдХрд▓реЗ </li><li>  рдПрдХ рдмрд╛рд░ рдкреНрд░рддреНрдпреЗрдХ рдХреНрдпреВрдмрд▓реЗрдЯ рдЕрдВрддрд░рд╛рд▓ (рдкреНрд░рддреНрдпреЗрдХ рдиреЛрдб рдкрд░ k8s рдПрдЬреЗрдВрдЯ) рдЕрдкрдиреЗ рдиреЛрдб рдкрд░ рдЪрд▓рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдкреЙрдбреНрд╕ рдХреА рд▓реАрдирд┐рдВрдЧ / рддрддреНрдкрд░рддрд╛ рдХреЗ рдирдореВрдиреЗ рдХрд╛ рдкреНрд░рджрд░реНрд╢рди рдХрд░рддрд╛ рд╣реИ, рдпрд╣ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдПрдкреЗрд╕реЗрд╡рд░ (k8s рджрд┐рдорд╛рдЧ рдХреЛ рдЗрдВрдЯрд░рдлрд╝реЗрд╕) рднреЗрдЬрддрд╛ рд╣реИ </li><li>  рдкреНрд░рддреНрдпреЗрдХ рдиреЛрдб рдкрд░ рдХреНрдпреВрдм-рдкреНрд░реЙрдХреНрд╕реА рдХреЛ рд╕реЗрд╡рд╛рдУрдВ рдФрд░ рдЪреВрд▓реНрд╣рд╛ рдореЗрдВ рд╕рднреА рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдПрдкрд╕реЗрд╡рд░ рд╕реЗ рд╕реВрдЪрдирд╛рдПрдВ рдорд┐рд▓рддреА рд╣реИрдВ рдЬреЛ рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рднрд╛рдЧ рд▓реЗрддреЗ рд╣реИрдВ </li><li>  рдХреНрдпреВрдм-рдкреНрд░реЙрдХреНрд╕реА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рд╕рдмрд╕рд┐рд╕реНрдЯрдо</a> рдХреЗ рд╡рд┐рдиреНрдпрд╛рд╕ рдореЗрдВ рд╕рднреА рдкрд░рд┐рд╡рд░реНрддрдиреЛрдВ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ (iptables, ipvs) </li></ul><br><p>  рд╕рд░рд▓рддрд╛ рдХреЗ рд▓рд┐рдП, рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░реЙрдХреНрд╕реА рд╡рд┐рдзрд┐ рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВ - iptablesред  Iptables рдореЗрдВ, рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╣рдорд╛рд░реЗ рд╡рд░реНрдЪреБрдЕрд▓ IP 10.97.149.77 рдХреЗ рд▓рд┐рдП рд╣реИ: </p><br><pre> <code class="bash hljs">-A KUBE-SERVICES -d 10.97.149.77/32 -p tcp -m comment --comment <span class="hljs-string"><span class="hljs-string">"default/webapp: cluster IP"</span></span> -m tcp --dport 80 -j KUBE-SVC-BL7FHTIPVYJBLWZN</code> </pre> <br><p>  рдЯреНрд░реИрдлрд╝рд┐рдХ <strong>KUBE-SVC-BL7FHTIPVYJBLWZN рд╢реНрд░реГрдВрдЦрд▓рд╛ рдореЗрдВ рдЬрд╛рддрд╛ рд╣реИ</strong> , рдЬрд┐рд╕рдореЗрдВ рдЗрд╕реЗ 2 рдЕрдиреНрдп рд╢реНрд░реГрдВрдЦрд▓рд╛рдУрдВ рдореЗрдВ рд╡рд┐рддрд░рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ </p><br><pre> <code class="bash hljs">-A KUBE-SVC-BL7FHTIPVYJBLWZN -m comment --comment <span class="hljs-string"><span class="hljs-string">"default/webapp:"</span></span> -m statistic --mode random --probability 0.50000000000 -j KUBE-SEP-UPKHDYQWGW4MVMBS -A KUBE-SVC-BL7FHTIPVYJBLWZN -m comment --comment <span class="hljs-string"><span class="hljs-string">"default/webapp:"</span></span> -j KUBE-SEP-FFCBJRUPEN3YPZQT</code> </pre> <br><p>  рдпреЗ рд╣рдорд╛рд░реА рдлрд▓реА рд╣реИрдВ: </p><br><pre> <code class="bash hljs">-A KUBE-SEP-UPKHDYQWGW4MVMBS -p tcp -m comment --comment <span class="hljs-string"><span class="hljs-string">"default/webapp:"</span></span> -m tcp -j DNAT --to-destination 10.244.0.10:80 -A KUBE-SEP-FFCBJRUPEN3YPZQT -p tcp -m comment --comment <span class="hljs-string"><span class="hljs-string">"default/webapp:"</span></span> -m tcp -j DNAT --to-destination 10.244.0.11:80</code> </pre> <br><h2 id="testiruem-otkaz-odnogo-iz-podov">  рдЪреВрд▓реНрд╣реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХреА рд╡рд┐рдлрд▓рддрд╛ рдХрд╛ рдкрд░реАрдХреНрд╖рдг </h2><br><p>  рдореЗрд░рд╛ рд╡реЗрдмрдПрдк рдкрд░реАрдХреНрд╖рдг рдПрдкреНрд▓рд┐рдХреЗрд╢рди "рдПрд░рд░ рд░реИрд╢" рдореЛрдб рдкрд░ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИ, рдЗрд╕рдХреЗ рд▓рд┐рдП рдЖрдкрдХреЛ "/ рдЧрд▓рдд" URL рдХреЛ рдЦреАрдВрдЪрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред </p><br><p>  рдкрд░реАрдХреНрд╖рд╛ рдХреЗ рдмреАрдЪ рдореЗрдВ ab -c 50 -n 20,000 рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдПрдХ рд╢реНрд░рд╡рдг рдкрд░ "/ рдЧрд▓рдд" рдирд┐рдХрд╛рд▓рд╛ рдЧрдпрд╛: </p><br><pre> <code class="bash hljs">Complete requests: 20000 Failed requests: 3719</code> </pre> <br><p>  рдпрд╣рд╛рдВ рдмрд┐рдВрджреБ рд╡рд┐рд╢рд┐рд╖реНрдЯ рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреА рд╕рдВрдЦреНрдпрд╛ рдирд╣реАрдВ рд╣реИ (рдЙрдирдХреА рд╕рдВрдЦреНрдпрд╛ рд▓реЛрдб рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рдЕрд▓рдЧ-рдЕрд▓рдЧ рд╣реЛрдЧреА), рд▓реЗрдХрд┐рди рд╡реЗ рд╣реИрдВред  рд╕рд╛рдорд╛рдиреНрдп рддреМрд░ рдкрд░, рд╣рдордиреЗ "рдЦрд░рд╛рдм" рдХреЛ рд╕рдВрддреБрд▓рди рд╕реЗ рдмрд╛рд╣рд░ рдлреЗрдВрдХ рджрд┐рдпрд╛, рд▓реЗрдХрд┐рди рд╕реЗрд╡рд╛ рдХреЗ рдХреНрд▓рд╛рдЗрдВрдЯ рдХреЛ рд╕реНрд╡рд┐рдЪ рдХрд░рдиреЗ рдХреЗ рд╕рдордп рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХреЛ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ред  рддреНрд░реБрдЯрд┐рдпреЛрдВ рдХрд╛ рдХрд╛рд░рдг рд╕рдордЭрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд╛рдлреА рдЖрд╕рд╛рди рд╣реИ: рддрддреНрдкрд░рддрд╛ рдкрд░реАрдХреНрд╖рдг рдкреНрд░рддрд┐ рд╕реЗрдХрдВрдб рдПрдХ рдмрд╛рд░ рдХреНрдпреВрдмрд▓реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ + рдпрд╣рд╛рдВ рддрдХ тАЛтАЛрдХрд┐ рдЬрд╛рдирдХрд╛рд░реА рдХреЗ рдкреНрд░рд╕рд╛рд░ рдХреЗ рд▓рд┐рдП рдПрдХ рдЫреЛрдЯрд╛ рд╕рдордп рдЬреЛ рдХрд┐ рдкрд░реАрдХреНрд╖рдг рдХрд╛ рдЬрд╡рд╛рдм рдирд╣реАрдВ рджрд┐рдпрд╛ред </p><br><h2 id="pomozhet-li-ipvs-bekend-dlya-kube-proxy-experimental">  рдХреНрдпрд╛ рдЖрдИрдкреАрд╡реАрдПрд╕ рдХреНрдпреВрдм-рдкреНрд░реЙрдХреНрд╕реА (рдкреНрд░рд╛рдпреЛрдЧрд┐рдХ) рдореЗрдВ рдорджрдж рдХрд░реЗрдЧрд╛? </h2><br><p>  рд╕рдЪ рдореЗрдВ рдирд╣реАрдВ!  рдпрд╣ рдкреНрд░реЙрдХреНрд╕реА рдЕрдиреБрдХреВрд▓рди рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдХрд░рддрд╛ рд╣реИ, рдПрдХ рдХрд╕реНрдЯрдо рдмреИрд▓реЗрдВрд╕рд┐рдВрдЧ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╡рд┐рдлрд▓рддрд╛ рдкреНрд░рд╕рдВрд╕реНрдХрд░рдг рдХреА рд╕рдорд╕реНрдпрд╛ рдХреЛ рд╣рд▓ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред </p><br><h2 id="kak-byt">  рдХреИрд╕реЗ рд╣реЛ? </h2><br><p>  рдЗрд╕ рд╕рдорд╕реНрдпрд╛ рдХреЛ рдХреЗрд╡рд▓ рдПрдХ рдмреИрд▓реЗрдВрд╕рд░ рджреНрд╡рд╛рд░рд╛ рд╣рд▓ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдкреБрди: рдкреНрд░рдпрд╛рд╕ (рдкреБрдирдГ рдкреНрд░рдпрд╛рд╕) рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, http рдХреЗ рд▓рд┐рдП рд╣рдореЗрдВ рдПрдХ L7 рдмреИрд▓реЗрдВрд╕рд░ рдЪрд╛рд╣рд┐рдПред  рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдЗрд╕ рддрд░рд╣ рдХреЗ рдмреИрд▓реЗрдиреНрд╕рд░ рдкрд╣рд▓реЗ рд╕реЗ рд╣реА рдкреВрд░реНрдг рд░реВрдк рд╕реЗ рдпрд╛ рддреЛ рдЗрдирдЧреНрд░реЗрд╕ рдХреЗ рд░реВрдк рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ (рдХреНрд▓рд╕реНрдЯрд░ рдХреА рдЪрд╛рд▓ рдореЗрдВ рдПрдХ рдмрд┐рдВрджреБ рдХреЗ рд░реВрдк рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИ, рд▓реЗрдХрд┐рди рдмрдбрд╝реЗ рдкреИрдорд╛рдиреЗ рдкрд░ рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрд╕реЗ рдЗрд╕рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ), рдпрд╛ рдПрдХ рдЕрд▓рдЧ рдкрд░рдд рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд░реВрдк рдореЗрдВ - рдПрдХ рд╕реЗрд╡рд╛ рдЬрд╛рд▓, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">istio</a> ред </p><br><p>  рд╣рдорд╛рд░реЗ рдЙрддреНрдкрд╛рджрди рдореЗрдВ, рд╣рдордиреЗ рдЕрднреА рддрдХ рдЕрддрд┐рд░рд┐рдХреНрдд рдЬрдЯрд┐рд▓рддрд╛ рдХреА рд╡рдЬрд╣ рд╕реЗ рдпрд╛ рддреЛ рдЗрдирдЧреНрд░реЗрд╕ рдпрд╛ рд╕рд░реНрд╡рд┐рд╕ рдореЗрд╖ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдирд╣реАрдВ рдХрд┐рдпрд╛ рд╣реИред  рдЗрд╕ рддрд░рд╣ рдХреЗ рд╕рд╛рд░, рдореЗрд░реА рд░рд╛рдп рдореЗрдВ, рдЙрди рдорд╛рдорд▓реЛрдВ рдореЗрдВ рдорджрдж рдХрд░рддреЗ рд╣реИрдВ рдЬрд╣рд╛рдВ рдЖрдкрдХреЛ рдЕрдХреНрд╕рд░ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд╕реЗрд╡рд╛рдУрдВ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИред  рд▓реЗрдХрд┐рди рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рдЖрдк "рднреБрдЧрддрд╛рди" рдирд┐рдпрдВрддреНрд░рдгреАрдпрддрд╛ рдФрд░ рд╕рд░рд▓ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗред  рдЖрдк рдпрд╣ рдЬрд╛рдирдиреЗ рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд рд╕рдордп рд╡реНрдпрддреАрдд рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП рд░рд┐рдЯрд░реНрди рдЯрд╛рдЗрдордЖрдЙрдЯ рдХреИрд╕реЗ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рдПред </p><br><h2 id="kak-delaem-my">  рд╣рдо рдХреИрд╕реЗ? </h2><br><p>  рд╣рдо рд╣реЗрдбрд▓реЗрд╕ k8s рд╕реЗрд╡рд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдРрд╕реА рд╕реЗрд╡рд╛рдУрдВ рдореЗрдВ рд╡рд░реНрдЪреБрдЕрд▓ рдЖрдИрдкреА рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ рдФрд░ рддрджрдиреБрд╕рд╛рд░, рдХреНрдпреВрдм-рдкреНрд░реЙрдХреНрд╕реА рдФрд░ рдЖрдИрдкреАрдЯреЗрдмрд▓реНрд╕ рдЙрдирдХреЗ рдХрд╛рдо рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рд╣реЛрддреЗ рд╣реИрдВред  рдРрд╕реА рдкреНрд░рддреНрдпреЗрдХ рд╕реЗрд╡рд╛ рдХреЗ рд▓рд┐рдП, рдЖрдк DNS рдпрд╛ рдПрдкреАрдЖрдИ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд▓рд╛рдЗрд╡ рдЪреВрд▓реНрд╣реЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдЕрдиреНрдп рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд╕рд╛рде рдмрд╛рддрдЪреАрдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП, рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рджреВрдд рдХреЗ</a> рд╕рд╛рде рдПрдХ рдлреБрдЯрдкрд╛рде рдХрдВрдЯреЗрдирд░ рдмрдирд╛рддреЗ рд╣реИрдВред  Evoy рд╕рдордп-рд╕рдордп рдкрд░ DNS рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рд╕реЗрд╡рд╛рдУрдВ рдХреЗ рд▓рд┐рдП рдкреЙрдбреНрд╕ рдХреА рдПрдХ рдЕрдк-рдЯреВ-рдбреЗрдЯ рд╕реВрдЪреА рдкреНрд░рд╛рдкреНрдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд╛рдд, рдпрд╣ рдПрдХ рддреНрд░реБрдЯрд┐ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ рдЕрдиреНрдп рдкреЙрдбреНрд╕ рдХреЛ рдХреНрд╡реЗрд░реА рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╛рд░-рдмрд╛рд░ рдкреНрд░рдпрд╛рд╕ рдХрд░рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реИред  рдЖрдк рдЗрд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдиреЛрдб рдкрд░ DaemonSet рдХреЗ рд░реВрдк рдореЗрдВ рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ, рд▓реЗрдХрд┐рди рдлрд┐рд░ рдпрджрд┐ рдпрд╣ рдЖрд╡реГрддреНрддрд┐ рд╡рд┐рдлрд▓ рд╣реЛ рдЬрд╛рддреА рд╣реИ, рддреЛ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд╕рднреА рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХрд╛рдо рдХрд░рдирд╛ рдмрдВрдж рдХрд░ рджреЗрдВрдЧреЗред  рдЪреВрдВрдХрд┐ рдЗрд╕ рдкреНрд░реЙрдХреНрд╕реА рджреНрд╡рд╛рд░рд╛ рд╕рдВрд╕рд╛рдзрди рдХреА рдЦрдкрдд рдХрд╛рдлреА рдХрдо рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдордиреЗ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рд╕рд╛рдЗрдбрдХрд╛рд░ рдХрдВрдЯреЗрдирд░ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХрд╛ рдирд┐рд░реНрдгрдп рд▓рд┐рдпрд╛ред </p><br><p>  рдпрд╣ рдЕрдирд┐рд╡рд╛рд░реНрдп рд░реВрдк рд╕реЗ рдмрд┐рд▓реНрдХреБрд▓ рд╡реИрд╕рд╛ рд╣реА рд╣реИ рдЬреИрд╕рд╛ рдХрд┐ istio рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ рд╕рдВрддреБрд▓рди рд╕рд╛рджрдЧреА рдХреА рдУрд░ рд╕реНрдерд╛рдирд╛рдВрддрд░рд┐рдд рд╣реЛ рдЧрдпрд╛ рд╣реИ (istio рд╕реАрдЦрдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдирд╣реАрдВ рд╣реИ, рдЗрд╕рдХреЗ рдХреАрдбрд╝реЗ рдореЗрдВ рднрд╛рдЧ рд▓реЗрдВ)ред  рд╢рд╛рдпрдж рдпрд╣ рд╕рдВрддреБрд▓рди рдмрджрд▓ рдЬрд╛рдПрдЧрд╛, рдФрд░ рд╣рдо istio рдЬреИрд╕реА рдХрд┐рд╕реА рдЪреАрдЬрд╝ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрдВрдЧреЗред </p><br><p>  <em>рд╣рдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">okmeter.io рдкрд░</a> рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдиреЗ рдирд┐рд╢реНрдЪрд┐рдд рд░реВрдк рд╕реЗ рд░реВрдЯ рд▓рд┐рдпрд╛ рд╣реИ, рдФрд░ рд╣рдо рдЗрд╕рдХреЗ рдЖрдЧреЗ рд╡рд┐рддрд░рдг рдореЗрдВ рд╡рд┐рд╢реНрд╡рд╛рд╕ рдХрд░рддреЗ рд╣реИрдВред</em>  <em>рд╣рдорд╛рд░реА рд╕реЗрд╡рд╛ рдореЗрдВ k8 рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХреЗ рд▓рд┐рдП рд╕рдорд░реНрдерди рд░рд╛рд╕реНрддреЗ рдореЗрдВ рд╣реИ, рджреЗрдЦрддреЗ рд░рд╣реЗрдВ!</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi424229/">https://habr.com/ru/post/hi424229/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi424211/index.html">рдХрдВрдЯреЗрдирд░ рднрдВрдбрд╛рд░рдг рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЛ рд╕рдордЭрдирд╛ (рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рдФрд░ рдЕрдзрд┐рдХ)</a></li>
<li><a href="../hi424215/index.html">рдПрд▓реНрдоред рдЖрд░рд╛рдорджрд╛рдпрдХ рдФрд░ рдЕрдЬреАрдм</a></li>
<li><a href="../hi424217/index.html">рдкрд╡рд┐рддреНрд░ рдпреБрджреНрдзреЛрдВ рдХреЗ рд▓рд┐рдП рддрд░реНрдХ, рд╕рд╛рде рд╣реА рд╢рд╛рдВрддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рджрд▓реАрд▓</a></li>
<li><a href="../hi424223/index.html">рдбрд┐рд╕реНрдкреЛрдЬреЗрдмрд▓ рдЧреНрд░рд╛рд╣рдХреЛрдВред рджреЛрд╣рд░рд╛рдиреЗ рдХреА рдЦрд░реАрдж рдХреЗ рд▓рд┐рдП рд╡рд┐рднрд╛рдЬрди</a></li>
<li><a href="../hi424227/index.html">рд╕рдорд╛рди рд░реВрдк рд╕реЗ рдкрд╛рдЗрдЯреЛрд░ рдФрд░ рдЯреЗрдВрд╕рд░рдлреНрд▓реЛ рдореЗрдВ рдХреНрд╖реЗрддреНрд░ рднрд░ рдореЗрдВ рдЕрдВрдХ рд╡рд┐рддрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi424231/index.html">рд╣реЙрд╕реНрдЯрд▓рд░реНрд╕ рдкрд░ рдкреИрд╕рд╛ рдХреИрд╕реЗ рдХрдорд╛рдпрд╛ рдЬрд╛рдП</a></li>
<li><a href="../hi424233/index.html">рдХрдВрдкреНрдпреВрдЯрд░ рдиреЗ 93% рд╕рдЯреАрдХрддрд╛ рдХреЗ рд╕рд╛рде рдордиреЛрднреНрд░рдВрд╢ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдирд╛ рд╕рд┐рдЦрд╛рдпрд╛</a></li>
<li><a href="../hi424235/index.html">Oracle рдорд╛рдирдХ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ AWR рдХреЗ рдмрдЬрд╛рдп STATSPACK рдХрд╛ рдЙрдкрдпреЛрдЧ рдХреИрд╕реЗ рдХрд░реЗрдВ</a></li>
<li><a href="../hi424237/index.html">рд╕реАрдзреЗ рдЕрдкрдиреЗ рджрд┐рдорд╛рдЧ рдХреЛ рдЪрд╛рд░реНрдЬ рдХрд░реЗрдВ! рдЬреЛрдХрд░ 2018 рдореЗрдВ рд░рдирдЯрд╛рдЗрдо, рд╕рдВрдХрд▓рдХ рдФрд░ рдкреНрд░рджрд░реНрд╢рди</a></li>
<li><a href="../hi424239/index.html">рдЖрдИрдмреАрдПрдо рд╢рд░рдж рдЛрддреБ рд╕реЗрдорд┐рдирд╛рд░ - рдХрдВрдЯреЗрдирд░, рдХрдВрдкреНрдпреВрдЯрд░ рд╡рд┐рдЬрди, рдбрд┐рдЬрд┐рдЯрд▓ рдкрд░рд┐рд╡рд░реНрддрди</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>