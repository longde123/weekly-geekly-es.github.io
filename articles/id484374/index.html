<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíâ üÜí ü¶ä Perjalanan ke pusat ... gambar buruh pelabuhan. Atau cara mengunduh gambar dari registri tanpa buruh pelabuhan üé° üíΩ üí™üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="3 hari sebelum tahun baru ada tugas untuk mentransfer perangkat lunak kami ke klien melalui manajer, pada flash drive. Perangkat lunak adalah platform...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Perjalanan ke pusat ... gambar buruh pelabuhan. Atau cara mengunduh gambar dari registri tanpa buruh pelabuhan</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/484374/"><p>  3 hari sebelum tahun baru ada tugas untuk mentransfer perangkat lunak kami ke klien melalui manajer, pada flash drive.  Perangkat lunak adalah platform microservice dengan lusinan gambar buruh pelabuhan dengan banyak pengaturan dan bagan helm sepanjang satu kilometer.  Apa yang kami miliki: </p><br><ul><li>  Manajer di Moskow (Saya bukan dari sana) </li><li>  Windows </li><li>  Tidak ada interaksi langsung (dan jika ada, itu tidak benar-benar membantu) </li><li>  buruh pelabuhan no </li></ul><br><p>  Pff, pikirku!  Saya akan mengambil Golang, menulis program, kompilasi untuk Windows. <br>  ... dan 5 jam kemudian saya menyadari ketergesaan kesimpulan saya.  Pada saat itu, tawa Nelson teringat untuk pertama kalinya.  HA HA  Yang menghantui saya sepanjang waktu yang saya habiskan untuk mempelajari masalah ini. <a name="habracut"></a></p><br><p>  Sebagian besar contoh yang saya temukan memerlukan dockerd.  Dua skrip yang tidak menggunakan dockerd, yang ditemukan setelah satu jam googling, <a href="" rel="nofollow">satu</a> dan <a href="https://github.com/NotGlop/docker-drag" rel="nofollow">dua</a> .  Opsi pertama membantu saya memahami proses mendapatkan semua layer gambar dan file konfigurasi, tetapi tidak mungkin untuk menggunakannya dengan Windows.  Dan opsi kedua menunjukkan bahwa bukan hanya berbagai hash yang berkedip di layar, khususnya <a href="https://github.com/NotGlop/docker-drag/blob/69b2bae59c6c0a5cbdf224feb9c067e3edcc6068/docker_pull.py" rel="nofollow">FIXME</a> ini.  Seseorang bisa, tentu saja, berhenti di sana, itu berhasil!  Transfer ke sana tidak sulit.  Tetapi bagaimana cara memverifikasi bahwa gambar manajer ternyata berada dalam bentuk yang sama seperti di registri kami?  Tapi tidak mungkin!  Oleh karena itu, saya hanya mengunggah gambar ke penyimpanan bersama, diunduh menggunakan perintah penyimpanan buruh pelabuhan, dan membagikan tautan.  Dan tenang ini. </p><br><p>  Pada hari keempat liburan, cukup bosan dengan mereka, gagasan untuk mengunduh dan merakit gambar buruh pelabuhan dengan benar menyalip saya lagi, dan saya terjun ke kode <a href="https://github.com/moby/moby" rel="nofollow">moby</a> selama beberapa jam. </p><br><p>  Apa yang saya miliki saat ini: </p><br><ul><li>  Memahami cara mendapatkan semua layer </li></ul><br><p>  Mengambil Python "di tangan" dan berdasarkan pada <a href="https://github.com/NotGlop/docker-drag" rel="nofollow">skrip</a> ini, saya memutuskan untuk memperbaikinya.  Pada hari kedua, saya memutuskan untuk menulis naskah dari awal.  Mengingat kerajinan saya untuk otorisasi-oauth, saya hanya menyalin bagian dari kode dari sana, ditambah perkembangan yang sudah saya lakukan ketika mengedit skrip.  Tidak ada masalah dengan otorisasi dan mengunduh data ini, tetapi muncul pertanyaan: </p><br><ul><li>  apa hash yang ditampilkan ketika perintah menarik buruh pelabuhan dijalankan? </li><li>  apa hash yang digunakan untuk memberi nama direktori di dalam tarball gambar? </li><li>  Bagaimana cara membuat arsip tar sehingga jumlah cek sesuai dengan gambar asli? </li></ul><br><p> Untuk belajar, saya memilih gambar ubuntu: 18.04 <br>  gambar sha256sum disimpan melalui <code>docker save</code> - 257cab9137419a53359d0ed76f680fe926ed3645238357bdcdb84070a8f26cd0. </p><br><pre> <code class="plaintext hljs">&gt; docker pull ubuntu:18.04 18.04: Pulling from library/ubuntu 2746a4a261c9: Downloading [==============&gt; ] 6.909MB/26.69MB 4c1d20cdee96: Download complete 0d3160e1d0de: Download complete c8e37668deea: Download complete Digest: sha256:250cc6f3f3ffc5cdaa9d8f4946ac79821aafb4d3afc93928f0de9336eba21aa4 Status: Downloaded newer image for ubuntu:18.04 docker.io/library/ubuntu:18.04</code> </pre> <br><p>  <strong>Konten tarbal gambar</strong> </p><br><pre> <code class="plaintext hljs">tar tvf ubuntu.tar drwxr-xr-x 0 root root 0 Dec 19 11:21 07adecfcb06a1142a69c3e769cb38f2d4ef9d772726ce1e65bc6dbd4448cccc9/ -rw-r--r-- 0 root root 3 Dec 19 11:21 07adecfcb06a1142a69c3e769cb38f2d4ef9d772726ce1e65bc6dbd4448cccc9/VERSION -rw-r--r-- 0 root root 477 Dec 19 11:21 07adecfcb06a1142a69c3e769cb38f2d4ef9d772726ce1e65bc6dbd4448cccc9/json -rw-r--r-- 0 root root 991232 Dec 19 11:21 07adecfcb06a1142a69c3e769cb38f2d4ef9d772726ce1e65bc6dbd4448cccc9/layer.tar drwxr-xr-x 0 root root 0 Dec 19 11:21 3e1d90747aa9d2a7ec6e9693bdd490dff8528b9aec4a2fac2300824e4ba3a60e/ -rw-r--r-- 0 root root 3 Dec 19 11:21 3e1d90747aa9d2a7ec6e9693bdd490dff8528b9aec4a2fac2300824e4ba3a60e/VERSION -rw-r--r-- 0 root root 477 Dec 19 11:21 3e1d90747aa9d2a7ec6e9693bdd490dff8528b9aec4a2fac2300824e4ba3a60e/json -rw-r--r-- 0 root root 15872 Dec 19 11:21 3e1d90747aa9d2a7ec6e9693bdd490dff8528b9aec4a2fac2300824e4ba3a60e/layer.tar -rw-r--r-- 0 root root 3411 Dec 19 11:21 549b9b86cb8d75a2b668c21c50ee092716d070f129fd1493f95ab7e43767eab8.json drwxr-xr-x 0 root root 0 Dec 19 11:21 b0474230e27ddbba2f46397aac85d4d2fd748064ed9c0ff1e57fec4f063fcf6b/ -rw-r--r-- 0 root root 3 Dec 19 11:21 b0474230e27ddbba2f46397aac85d4d2fd748064ed9c0ff1e57fec4f063fcf6b/VERSION -rw-r--r-- 0 root root 1264 Dec 19 11:21 b0474230e27ddbba2f46397aac85d4d2fd748064ed9c0ff1e57fec4f063fcf6b/json -rw-r--r-- 0 root root 3072 Dec 19 11:21 b0474230e27ddbba2f46397aac85d4d2fd748064ed9c0ff1e57fec4f063fcf6b/layer.tar drwxr-xr-x 0 root root 0 Dec 19 11:21 c8ba25f7db9f70220ac92449b238a0697f9eb580ef4f905225a333fc0a5e8719/ -rw-r--r-- 0 root root 3 Dec 19 11:21 c8ba25f7db9f70220ac92449b238a0697f9eb580ef4f905225a333fc0a5e8719/VERSION -rw-r--r-- 0 root root 401 Dec 19 11:21 c8ba25f7db9f70220ac92449b238a0697f9eb580ef4f905225a333fc0a5e8719/json -rw-r--r-- 0 root root 65571328 Dec 19 11:21 c8ba25f7db9f70220ac92449b238a0697f9eb580ef4f905225a333fc0a5e8719/layer.tar -rw-r--r-- 0 root root 432 Jan 1 1970 manifest.json -rw-r--r-- 0 root root 88 Jan 1 1970 repositories</code> </pre> <br><p>  <strong>Konfigurasi gambar</strong> </p><br><pre> <code class="json hljs">{ ... <span class="hljs-attr"><span class="hljs-attr">"rootfs"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"layers"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"diff_ids"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"sha256:2dc9f76fb25b31e0ae9d36adce713364c682ba0d2fa70756486e5cedfaf40012"</span></span>, <span class="hljs-string"><span class="hljs-string">"sha256:9f3bfcc4a1a8a676da07287a1aa6f2dcc8e869ea6f054c337593481a5bb1345e"</span></span>, <span class="hljs-string"><span class="hljs-string">"sha256:27dd43ea46a831c39d224e7426794145fba953cd7309feccf4d5ea628072f6a2"</span></span>, <span class="hljs-string"><span class="hljs-string">"sha256:918efb8f161b4cbfa560e00e8e0efb737d7a8b00bf91bb77976257cd0014b765"</span></span> ] } ... }</code> </pre> <br><p>  Pertanyaan pertama diselesaikan dengan cukup cepat, dokumentasi <a href="" rel="nofollow">https://github.com/opencontainers/image-spec/blob/master/config.md</a> membantu.  Hash yang muncul ketika Anda menjalankan perintah pull docker adalah chainIDs dihitung dari daftar diff_ids dari manifes config-gambar, di mana chainID pertama selalu yang pertama dari daftar diff_ids, dan yang berikutnya adalah jumlah hash dari string <code>(chain_id[i-1] + " " + diff_id[i])</code> .  Kode untuk membangun chainID chainID: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">chain_ids</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ids: list)</span></span></span><span class="hljs-function"> -&gt; list:</span></span> chain = list() chain.append(ids[<span class="hljs-number"><span class="hljs-number">0</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(ids) &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ids nxt = list() nxt.append(<span class="hljs-string"><span class="hljs-string">"sha256:"</span></span> + hashlib.sha256(<span class="hljs-string"><span class="hljs-string">f'</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{ids[</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">0</span></span></span></span><span class="hljs-string"><span class="hljs-subst">]}</span></span></span><span class="hljs-string"> </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{ids[</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">1</span></span></span></span><span class="hljs-string"><span class="hljs-subst">]}</span></span></span><span class="hljs-string">'</span></span>.encode()).hexdigest()) nxt.extend(ids[<span class="hljs-number"><span class="hljs-number">2</span></span>:]) chain.extend(chain_ids(nxt)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> chain</code> </pre> <br><p>  Menambahkan awalan dengan nama algoritma, dalam hal ini "sha256:", adalah wajib dan termasuk dalam persyaratan standar opencontainers, mis.  string harus dalam bentuk "algoritma: hash". </p><br><p>  Dia menghabiskan dua malam pada pertanyaan tentang penamaan direktori.  Untuk waktu yang cukup lama saya melihat kode sumber dari docker-daemon dan Oh!  keajaiban!  Saya berhasil menemukan kode generasi di <a href="" rel="nofollow">sini</a> dan di <a href="" rel="nofollow">sini</a> .  Untuk menghasilkan nama direktori, Anda perlu menghitung hash dari konfigurasi json layer.  Docker memiliki beberapa versi konfigurasi dan sebelum mesin docker 1.9, konfigurasi versi v1 digunakan.  Tidak lebih cepat dikatakan daripada dilakukan!  Dan lagi, siluet Nelson muncul.  Setelah debug singkat saya menyadari bahwa masalahnya bersembunyi di generasi json.  Dalam Python, urutan data dalam kamus mungkin berbeda dari urutan data dalam json yang dihasilkan dari kamus ini.  Urutan data di json akan berbeda, dan sesuai hashnya juga akan berbeda.  Saya harus pergi ke OrderedDict, mendaftar terlebih dahulu urutan data yang diinginkan di dalamnya.  Ini meningkatkan ukuran kode sebanyak satu setengah kali. </p><br><p>  Tampaknya semuanya sudah diperbaiki, saya menjalankan skrip dan ... di suatu tempat jauh di dalam, HA-HA terkenal muncul!  Hash terakhir tidak cocok.  Sekali lagi saya mempelajari kode dan <a href="" rel="nofollow">melihat</a> , dan ini adalah v1-config lain yang berisi semua informasi tentang gambar, yang dapat dilihat menggunakan <code>docker inspect</code> .  Tambahkan OrderDict lain khusus untuknya, lengkapi kodenya dan ... HA HA! <br>  Sudah jam 5 pagi dan kepala saya tidak benar-benar berpikir, jadi setelah tidur saya kembali melihat kode.  Berkali-kali melihat kode pembangkitan menemukan sebuah <a href="" rel="nofollow">garis</a> .  Betapa senangnya saya melihat itu.  Sebelum saya melihatnya, ada pemikiran untuk membangun buruh pelabuhan saya <del>  Jack hitam dan </del>  pencatatan data.  Saya mengaktifkan debug, menjalankan <code>docker save</code> dan ... Ini sama sekali tidak konyol, di docker-desktop untuk mac os ada batas pada panjang garis dalam log 947 karakter dan konfigurasi yang dihasilkan istirahat ke <code>\"</code> . Setelah melakukan semua langkah ini di Linux, saya berhasil mendapatkan konfigurasi lapisan versi pertama, atas dasar itu saya menulis kode, dan saya berhasil mendapatkan hash yang diinginkan dari lapisan terakhir. hash untuk semua file adalah sama, direktori diberi nama dengan cara yang sama seperti gambar asli. Ini waktunya untuk mengumpulkan arsip tar ... HAHA! </p><br><p>  Ukuran file tidak cocok, baca <a href="" rel="nofollow">https://github.com/opencontainers/image-spec/blob/master/layer.md</a> dan format <a href="https://www.gnu.org/software/tar/manual/html_node/Standard.html" rel="nofollow">arsip tar</a> .  <a href="https://github.com/python/cpython/blob/f04750bb7af45cb6efab8d92d1ff063f0bf2833d/Lib/tarfile.py" rel="nofollow">Nilai default adalah</a> 10240 byte, dan ukuran arsip yang saya kumpulkan adalah 9216 byte lebih besar.  Pada awalnya saya berpikir bahwa perlu untuk mengurangi ukuran blok menjadi 1024 byte, yang ternyata tidak benar dan akibatnya, ukuran blok 512 byte menyamakan ukuran arsip. </p><br><pre> <code class="python hljs">tarfile.RECORDSIZE = <span class="hljs-number"><span class="hljs-number">512</span></span></code> </pre> <br><p>  Baris pertama dari arsip yang baru dibuat berisi folder root "/".  Opsi ini tidak cocok, oleh karena itu, saya menambah kode dengan memindai isi folder dan menambahkannya secara individual ke arsip, setelah sebelumnya mengurutkannya. </p><br><p>  Akhirnya, kami berhasil mencapai ukuran file yang sama, tampilan direktori yang seragam, tetapi ini belum semuanya.  File dan direktori, dengan pengecualian manifest.json dan respoitories, dalam arsip harus memiliki atribut st_atime, st_mtime sama dengan st_ctime.  Untuk file manifest.json dan respoitories, atribut st_atime, st_mtime, dan st_ctime harus diberi tanggal pada awal era <code>1970-01-01 00:00</code> .  Semua tanggal harus ditetapkan sesuai dengan zona waktu masing-masing.  Karena saya melakukan semua pekerjaan di mac os, saya perhatikan satu perbedaan.  Saat menyimpan gambar ke Linux, daftar file dalam arsip tampak seperti ini: </p><br><pre> <code class="plaintext hljs">tar tvf ubuntu.tar drwxr-xr-x 0/0 0 Dec 19 11:21 07adecfcb06a1142a69c3e769cb38f2d4ef9d772726ce1e65bc6dbd4448cccc9/ -rw-r--r-- 0/0 3 Dec 19 11:21 07adecfcb06a1142a69c3e769cb38f2d4ef9d772726ce1e65bc6dbd4448cccc9/VERSION -rw-r--r-- 0/0 477 Dec 19 11:21 07adecfcb06a1142a69c3e769cb38f2d4ef9d772726ce1e65bc6dbd4448cccc9/json -rw-r--r-- 0/0 991232 Dec 19 11:21 07adecfcb06a1142a69c3e769cb38f2d4ef9d772726ce1e65bc6dbd4448cccc9/layer.tar drwxr-xr-x 0/0 0 Dec 19 11:21 3e1d90747aa9d2a7ec6e9693bdd490dff8528b9aec4a2fac2300824e4ba3a60e/ -rw-r--r-- 0/0 3 Dec 19 11:21 3e1d90747aa9d2a7ec6e9693bdd490dff8528b9aec4a2fac2300824e4ba3a60e/VERSION -rw-r--r-- 0/0 477 Dec 19 11:21 3e1d90747aa9d2a7ec6e9693bdd490dff8528b9aec4a2fac2300824e4ba3a60e/json -rw-r--r-- 0/0 15872 Dec 19 11:21 3e1d90747aa9d2a7ec6e9693bdd490dff8528b9aec4a2fac2300824e4ba3a60e/layer.tar -rw-r--r-- 0/0 3411 Dec 19 11:21 549b9b86cb8d75a2b668c21c50ee092716d070f129fd1493f95ab7e43767eab8.json drwxr-xr-x 0/0 0 Dec 19 11:21 b0474230e27ddbba2f46397aac85d4d2fd748064ed9c0ff1e57fec4f063fcf6b/ -rw-r--r-- 0/0 3 Dec 19 11:21 b0474230e27ddbba2f46397aac85d4d2fd748064ed9c0ff1e57fec4f063fcf6b/VERSION -rw-r--r-- 0/0 1264 Dec 19 11:21 b0474230e27ddbba2f46397aac85d4d2fd748064ed9c0ff1e57fec4f063fcf6b/json -rw-r--r-- 0/0 3072 Dec 19 11:21 b0474230e27ddbba2f46397aac85d4d2fd748064ed9c0ff1e57fec4f063fcf6b/layer.tar drwxr-xr-x 0/0 0 Dec 19 11:21 c8ba25f7db9f70220ac92449b238a0697f9eb580ef4f905225a333fc0a5e8719/ -rw-r--r-- 0/0 3 Dec 19 11:21 c8ba25f7db9f70220ac92449b238a0697f9eb580ef4f905225a333fc0a5e8719/VERSION -rw-r--r-- 0/0 401 Dec 19 11:21 c8ba25f7db9f70220ac92449b238a0697f9eb580ef4f905225a333fc0a5e8719/json -rw-r--r-- 0/0 65571328 Dec 19 11:21 c8ba25f7db9f70220ac92449b238a0697f9eb580ef4f905225a333fc0a5e8719/layer.tar -rw-r--r-- 0/0 432 Jan 1 1970 manifest.json -rw-r--r-- 0/0 88 Jan 1 1970 repositories</code> </pre> <br><p>  Berbeda dengan daftar di awal artikel, di Linux, arsip disimpan dengan bendera numerik saja.  Ada dua variabel dalam objek tarinfo yang bertanggung jawab untuk ini, tarinfo.uname dan tarinfo.gname.  Dan masalah kedua dengan mac os adalah kurangnya grup root, itu diperbaiki menggunakan variabel tarinfo.gid dalam objek tarinfo yang sama.  Yah, semuanya tampaknya membuat arsip ... </p><br><p><img src="https://habrastorage.org/webt/hp/p8/pl/hpp8plcgi09ybuarim4bb5awcga.jpeg"></p><br><p>  Untuk semua file, hash konvergen, nama direktori dan file adalah sama, atribut st_atime, st_mtime dan st_ctime menyatu dengan yang asli, hak atas file sama persis.  Membuka kedua arsip dalam hex editor melihat sedikit perbedaan: </p><br><p><img src="https://habrastorage.org/webt/qc/j6/xm/qcj6xmv9ghzaesgeaaq5owvaxnm.png"><br>  Jendela atas adalah yang asli, arsip yang lebih rendah telah saya kumpulkan. </p><br><p>  Memahami format tar.  Setelah nama direktori adalah nilai hak atas file (persegi panjang oranye).  Perbedaannya adalah bahwa informasi tentang objek yang ditambahkan ke arsip tidak ditambahkan ke hak direktori.  Nilai 40755 yang ditunjukkan dalam hak menunjukkan bahwa ini adalah direktori dengan izin 755, dan 100644 adalah file dengan hak 644. Persegi panjang merah adalah string-ajaib dan dinilai oleh kode tarfile, string-string <code>ustar\000</code> , hanya digunakan dalam format PAX dan USTAR.  Format PAX sama sekali tidak cocok, ia menggunakan jenis header khusus.  Kotak biru adalah jumlah cek dan berbeda karena penggunaan berbagai format untuk hak penulisan file dan header-ajaib. </p><br><p>  Saya mengalihkan format arsip ke USTAR, tetapi tidak jelas apa yang harus dilakukan dengan merekam izin file.  Di <a href="https://github.com/python/cpython/blob/f04750bb7af45cb6efab8d92d1ff063f0bf2833d/Lib/tarfile.py" rel="nofollow">sini</a> dan di <a href="https://github.com/python/cpython/blob/f04750bb7af45cb6efab8d92d1ff063f0bf2833d/Lib/tarfile.py" rel="nofollow">sini</a> keajaiban terjadi bagi saya, saya tidak pernah bekerja dengan sistem oktal dan saya tidak mengerti mengapa ampersand diperlukan di sini (mungkin seseorang di komentar akan berbagi pengetahuan).  Saya harus menambahkan beberapa cetakan untuk melihat data apa yang muncul dengan argumen dan data apa yang digunakan untuk membentuk blok arsip.  Mengambil bilangan bulat dari posisi kedua dari blok data, itu adalah 16877, dan membawanya ke kalkulus oktal, ternyata nilai ini adalah <code>0o40755</code> , yang <code>0o40755</code> seperti yang saya butuhkan.  Hanya mengesampingkan fungsi get_info dan _create_header, menghapus <code>&amp; 0o7777</code> dari mereka (tidak ada yang terlintas di pikiran saya), saya berhasil mengumpulkan arsip tar dengan hash sha256 yang bertepatan dengan yang asli. </p><br><p>  PS Saat menulis artikel, gambar ubuntu telah diperbarui: 18,04 di hub.docker.com.  Jadi saya harus mengunduh gambar di Digest.  Jumlah hash tidak lagi cocok dengan aslinya karena fakta bahwa Digest ditulis sebagai ganti tag, jika tidak mereka adalah gambar yang identik. </p><br><p>  Penemuan kedua bagi saya adalah tidak adanya file repositori di arsip saat menyimpan gambar dengan tag yang hilang menggunakan <code>docker save</code> . </p><br><p>  Kode kerja lengkap di sini: <a href="https://github.com/myback/docker_pull" rel="nofollow">https://github.com/myback/docker_pull</a> </p><br><p>  Gambar Nelson Manz, serta tawanya "HA-HA" adalah milik FOX :) </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id484374/">https://habr.com/ru/post/id484374/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id484358/index.html">Manajemen Portofolio di R</a></li>
<li><a href="../id484364/index.html">Pada usia 26, Yana Harlan memimpin pengembangan mesin luar angkasa. Tahun depan mereka berencana untuk meluncurkannya.</a></li>
<li><a href="../id484368/index.html">Bagaimana saya melakukan mesin pencari untuk Telegram</a></li>
<li><a href="../id484370/index.html">Slurm SRE - belajar untuk memastikan kebahagiaan pengguna</a></li>
<li><a href="../id484372/index.html">Rumah pintar dengan Xiaomi pada contoh sauna</a></li>
<li><a href="../id484376/index.html">Samsung Moscow Center for Artificial Intelligence dalam cerita karyawan</a></li>
<li><a href="../id484378/index.html">SwayWM - UnixPorn Yourself</a></li>
<li><a href="../id484380/index.html">Pindah - abad terakhir! Alternatif untuk std :: pindah di ‚ÄúC ++ of the Future‚Äù</a></li>
<li><a href="../id484382/index.html">Algoritma Bellman-Ford</a></li>
<li><a href="../id484386/index.html">Pertemuan AWS_Ru di Raiffeisenbank</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>