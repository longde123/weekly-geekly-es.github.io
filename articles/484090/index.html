<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï∂Ô∏è üë©üèæ‚Äçüåæ üéÖüèø Nueva infraestructura de TI para el centro de datos de correos de Rusia üëàüèø üë®üèø‚Äçü§ù‚Äçüë®üèº ü•í</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Estoy seguro de que todos los lectores de Habr al menos una vez ordenaron productos en tiendas en l√≠nea en el extranjero y luego fueron a recibir paqu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Nueva infraestructura de TI para el centro de datos de correos de Rusia</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/lanit/blog/484090/">  Estoy seguro de que todos los lectores de Habr al menos una vez ordenaron productos en tiendas en l√≠nea en el extranjero y luego fueron a recibir paquetes en la oficina de correos rusa.  ¬øTe imaginas a qu√© escala es esta tarea desde el punto de vista de la organizaci√≥n log√≠stica?  Multiplique la cantidad de clientes por la cantidad de sus compras, imagine un mapa de nuestro vasto pa√≠s, y hay m√°s de 40 mil oficinas de correos ... Por cierto, en 2018 Russian Post proces√≥ 345 millones de paquetes internacionales. <br><br>  En este art√≠culo, le diremos a qu√© problemas se enfrent√≥ Mail y c√≥mo fueron abordados por el equipo de integraci√≥n de LANIT, creando una nueva infraestructura de TI para centros de datos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/243/aa0/cd2/243aa0cd2d1d9e1286ab8290ba80f7a9.jpg"></div>  <i>Uno de los modernos centros log√≠sticos del Correo ruso.</i> <br><a name="habracut"></a><br><h2>  Antes del proyecto </h2><br>  Debido al fuerte aumento en el n√∫mero de paquetes de tiendas en el extranjero en China, Europa occidental y Am√©rica del Norte, la carga en las instalaciones log√≠sticas de Russian Post ha aumentado.  Por lo tanto, se construyeron centros log√≠sticos de nueva generaci√≥n que utilizan m√°quinas de clasificaci√≥n de alta capacidad.  Requieren soporte de la infraestructura inform√°tica. <br><br>  La infraestructura del centro de datos estaba desactualizada y no proporcionaba el rendimiento y la confiabilidad necesarios en la operaci√≥n de los sistemas de informaci√≥n empresariales.  Adem√°s, Russian Post experiment√≥ una falta de potencia inform√°tica para lanzar nuevos servicios. <br><br><h2>  Centros de datos de clientes y sus problemas. </h2><br>  Los centros de datos de Russian Post atienden a m√°s de 40,000 objetos y 85 departamentos territoriales.  Hay docenas de servicios comerciales las 24 horas en los centros de datos, incluidos los servicios de comercio electr√≥nico. <br><br>  Hoy en d√≠a, la compa√±√≠a utiliza sistemas para almacenar, analizar y procesar grandes datos.  Para tales sistemas, el uso de algoritmos de inteligencia artificial y aprendizaje autom√°tico juega un papel importante.  Hoy, uno de los casos m√°s importantes para la empresa es optimizar la gesti√≥n de los flujos log√≠sticos y acelerar el servicio al cliente en las oficinas de correos. <br><br>  Antes del inicio del proyecto de modernizaci√≥n, hab√≠a alrededor de 3.000 m√°quinas virtuales en los centros de datos primarios y de respaldo, la cantidad de informaci√≥n almacenada super√≥ los 2 petabytes.  Los centros de datos ten√≠an una estructura de enrutamiento de tr√°fico compleja asociada con la separaci√≥n en diferentes segmentos seg√∫n los niveles de seguridad. <br><br>  Con el desarrollo de aplicaciones y la introducci√≥n de nuevos servicios, el ancho de banda existente de los equipos de red en los centros de datos se ha vuelto insuficiente.  Se requer√≠a la transici√≥n a interfaces con nuevas velocidades: 10 Gbit / s, en lugar de 1 Gbit / s en el acceso y 40 Gbit / s en el nivel central, con redundancia total de equipos y canales de comunicaci√≥n. <br><br>  El Departamento de Seguridad de la Informaci√≥n recibi√≥ una solicitud para dividir la infraestructura en segmentos con un alto nivel de seguridad de la informaci√≥n de tr√°fico y aplicaciones (PN - Red privada y DMZ - Zona desmilitarizada).  El tr√°fico pas√≥ a trav√©s de los firewalls (ITU), que no era necesario filtrar.  VRF en los conmutadores no se utiliz√≥ para dicho tr√°fico.  Las reglas en la UIT eran sub√≥ptimas (decenas de miles de reglas en cada centro de datos). <br><br>  La migraci√≥n perfecta de m√°quinas virtuales (VM) entre centros de datos con la preservaci√≥n de la direcci√≥n IP y la ruta √≥ptima de tr√°fico entre segmentos, incluida la red de datos corporativos (KSPD), era imposible. <br><br>  Para la copia de seguridad, se utiliz√≥ MSTP, algunos de los puertos estaban bloqueados (espera activa).  El kernel y los conmutadores de acceso no se combinaron en un cl√∫ster de conmutaci√≥n por error, no se utiliz√≥ la agregaci√≥n de interfaz (LAG). <br><br>  Con la llegada del tercer centro de datos, se necesitaba una nueva arquitectura y configuraci√≥n de equipos para operar el anillo entre los centros de datos (se propuso EVPN). <br><br>  No exist√≠a un concepto √∫nico para el desarrollo de centros de datos, documentado en forma de proyecto y acordado con todos los departamentos del cliente.  La documentaci√≥n actual para operar la red estaba incompleta y desactualizada. <br><br><h3>  Expectativas del cliente </h3><br>  El equipo del proyecto tuvo las siguientes tareas: <br><br><ul><li>  preparar el concepto de arquitectura y desarrollo para construir la infraestructura de red y servidor del tercer centro de datos; </li><li>  realizar una auditor√≠a operativa de la red de clientes existente; </li><li>  expandir la capacidad del n√∫cleo de la red en m√°s de 1500 puertos Ethernet de 10/40 Gbit / s en cada centro de datos (total de 4500 puertos); </li><li>  garantizar el funcionamiento del anillo entre los tres centros de datos con la posibilidad de aumentar la velocidad de hasta 80 Gb / s en cada uno de los segmentos para combinar los recursos inform√°ticos del cliente de diferentes centros de datos en un solo sistema de TI; </li><li>  proporcionar una reserva doble del 100% de todos los elementos de la red para lograr el tiempo de actividad objetivo al nivel del 99.995%; </li><li>  minimizar los retrasos de tr√°fico entre m√°quinas virtuales para acelerar las aplicaciones comerciales; </li><li>  recopilar estad√≠sticas, hacer an√°lisis y llevar a cabo la optimizaci√≥n posterior de las reglas de filtrado de tr√°fico en los centros de datos (inicialmente hab√≠a alrededor de 80,000 reglas); </li><li>  Desarrolle una arquitectura espec√≠fica para migrar sin problemas las aplicaciones comerciales cr√≠ticas de los clientes a cualquiera de los tres centros de datos. </li></ul><br>  Por lo tanto, ten√≠amos algo en qu√© trabajar. <br><br><h2>  Equipo </h2><br>  Deteng√°monos en m√°s detalle sobre qu√© equipo usamos en el proyecto. <br><br>  <b>Cortafuegos (NGWF) USG9560:</b> <br><br><ul><li>  divisi√≥n en VSYS; </li><li>  hasta 720 Gbps; </li><li>  hasta 720 millones de sesiones concurrentes; </li><li>  8 ranuras </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/36e/523/355/36e5233550f276b92525d264c8c79ebc.png"></div><br>  <b>Router NE40E-X8:</b> <br><br><ul><li>  capacidad de conmutaci√≥n de hasta 7.08 Tbit / s; </li><li>  Rendimiento de reenv√≠o de hasta 2.880 Mpps; </li><li>  8 ranuras para tarjetas de l√≠nea (LPU); </li><li>  hasta 10 millones de rutas BGP IPv4 por MPU; </li><li>  hasta 1500K rutas OSPF IPv4 por MPU; </li><li>  hasta 3000K - FIB IPv4 (depende de LPU). </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f74/581/f63/f74581f63475eb267481b2ecfbedf56d.png" width="500"></div><br>  <b>Interruptores de la serie CE12800:</b> <br><br><ul><li>  Virtualizaci√≥n del dispositivo: VS (virtualizaci√≥n 1:16), Sistema de conmutaci√≥n de cl√∫ster (CSS), Super Virtual Fabric (SVF); </li><li>  Virtualizaci√≥n de red: M-LAG, TRILL, VXLAN y VXLAN bridging, QinQ en VXLAN, EVN (red virtual Ethernet); </li><li>  Comenzando con VRP V2, se incluye soporte EVPN. </li><li>  M-LAG: un an√°logo de vPC (canal de puerto virtual) en Cisco Nexus; </li><li>  Protocolo de √°rbol de expansi√≥n virtual (VSTP): compatible con Cisco PVST. </li></ul><br>  <b>CE12804</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/038/32b/bd6/03832bbd638493fe604e0cd2df180a26.png" width="500"></div><br>  <b>CE12808</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4ab/54b/f91/4ab54bf91ecef2a5607645c805adb69b.png" width="500"></div><br><h3>  Software </h3><br>  En el proyecto utilizamos: <br><br><ul><li>  convertidor de archivos de configuraci√≥n de cortafuegos de otros proveedores en el formato de comando para nuevos equipos; </li><li>  secuencias de comandos patentadas para optimizar y convertir configuraciones de firewall. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5ae/e32/aa1/5aee32aa1a46b56acb725054085288b6.png"></div>  <i>Aspecto del convertidor para convertir archivos de configuraci√≥n</i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c05/fb0/3ea/c05fb03ea25d97c4239d18a78a7c4abd.png"></div>  <i>El esquema de organizaci√≥n de la comunicaci√≥n entre el centro de datos (EVPN VXLAN)</i> <br><br><h2>  Matices de la configuraci√≥n del equipo </h2><br>  <b>CE12808</b> <br><br><ul><li>  EVPN (est√°ndar) en lugar de EVN (propiedad de Huawei) para la comunicaci√≥n entre centros de datos: <br><br>  ‚óã L2 encima de L3 usando iBGP en el plano de Control; <br>  ‚óã Entrenamiento MAC y su anuncio a trav√©s de la familia iBGP EVPN (rutas MAC, tipo 2); <br>  ‚óã construcci√≥n autom√°tica de t√∫neles VXLAN para tr√°fico de difusi√≥n √∫nica / desconocida (Rutas inclusivas de difusi√≥n m√∫ltiple, tipo 3). </li><li>  Dos modos de divisi√≥n en VS: <br><br>  ‚óã basado en puertos (puerto de modo de puerto) o basado en ASIC (grupo de modo de puerto, mapa de puertos del dispositivo de visualizaci√≥n); <br>  ‚óã La interfaz de dimensi√≥n dividida de puerto 40GE funciona SOLO en Admin VS (independientemente del modo de puerto). </li></ul><br>  <b>USG9560</b> <br><br><ul><li>  la posibilidad de dividir en VSYS, </li><li>  ¬°El enrutamiento din√°mico es imposible entre VSYS y la fuga de ruta! </li></ul><br>  <b>CE12804</b> <br><br>  All Active GW (VRRP Master / Master / Master) con filtrado MAC VRRP entre centros de datos <br><br> <code>acl number 4000 <br> rule 5 deny source-mac 0000-5e00-0100 ffff-ffff-ff00 <br> rule 10 deny destination-mac 0000-5e00-0100 ffff-ffff-ff00 <br> rule 15 permit <br> <br> interface Eth-Trunk1 <br> traffic-filter acl 4000 outbound</code> <br> <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4a5/ae3/2d8/4a5ae32d8dde225760aafa5e2695a9c6.png"></div>  <i>Esquema de interacci√≥n de recursos entre centros de datos (VXLAN EVPN y All Active GW)</i> <br><br><h2>  Desaf√≠os del proyecto </h2><br>  La principal dificultad era la necesidad de reservar aplicaciones existentes utilizando infraestructura inform√°tica.  El cliente ten√≠a m√°s de 100 aplicaciones diferentes, algunas de las cuales fueron escritas hace casi 10 a√±os.  Por ejemplo, si para Yandex puede apagar f√°cilmente varios cientos de m√°quinas virtuales sin da√±ar a los usuarios finales, entonces, en Russian Post, este enfoque requerir√≠a el desarrollo de una serie de aplicaciones desde cero y cambios en la arquitectura de los sistemas de informaci√≥n empresariales.  Resolvimos los problemas que surgen en el proceso de migraci√≥n y optimizaci√≥n en la etapa de una auditor√≠a conjunta de la infraestructura inform√°tica.  Todas las nuevas tecnolog√≠as de red para la empresa (como EVPN) se han probado previamente en el laboratorio. <br><br><h2>  Resumen del proyecto </h2><br>  El equipo del proyecto incluy√≥ especialistas de <a href="https://itlanit.ru/">LANIT-Integration</a> , el cliente y sus socios en la operaci√≥n de la infraestructura inform√°tica.  Tambi√©n se formaron equipos de soporte dedicados de proveedores (Check Point y Huawei).  El proyecto tom√≥ dos a√±os.  Esto es lo que se ha hecho durante este tiempo. <br><br><ul><li>  Se desarroll√≥ y acord√≥ con todos los departamentos de clientes una estrategia para el desarrollo de una red de centros de datos, una red de datos corporativos (KSPD) y un anillo entre los centros de datos. </li><li>  La disponibilidad de servicios ha aumentado.  Esto fue notado por el negocio del cliente y condujo a un crecimiento de tr√°fico a√∫n mayor debido a la introducci√≥n de nuevos servicios. </li><li>  Se han migrado y optimizado m√°s de 40,000 reglas de FWSM / ASA a USG 9560. Los diferentes contextos de ASA en UGG 9560 se combinan en una sola pol√≠tica de seguridad. </li><li>  El rendimiento del puerto del centro de datos aument√≥ de 1G a 10 / 40G mediante el uso de CE12800 / CE6850.  Esto elimin√≥ la congesti√≥n de la interfaz y la p√©rdida de paquetes. <br></li><li>  Los enrutadores de clase portadora NE40E-X8 cubrieron completamente las necesidades del centro de datos del cliente y KSPD teniendo en cuenta el desarrollo comercial futuro. </li><li>  Se solicitaron ocho solicitudes de funciones nuevas para USG 9560. De ellas, siete ya se han implementado y est√°n incluidas en la versi√≥n actual de VRP.  1 FR - a la venta en I + D Huawei.  Este es un grupo de ocho chasis con la capacidad de configurar la funcionalidad necesaria para sincronizar la configuraci√≥n sin sincronizar sesiones.  Se requiere si el retraso del tr√°fico a uno de los centros de datos es demasiado grande (Adler - Mosc√∫ 1300 km en la carretera principal y 2800 km en la carretera de respaldo). </li></ul><br>  El proyecto no tiene an√°logos en comparaci√≥n con otras compa√±√≠as postales rusas. <br><br>  La modernizaci√≥n de la infraestructura de red del centro de datos ha abierto nuevas oportunidades para que la empresa desarrolle servicios digitales. <br><br><ul><li>  Proporcionar una cuenta personal y una aplicaci√≥n m√≥vil para personas f√≠sicas y jur√≠dicas. </li><li>  Integraci√≥n con tiendas electr√≥nicas para proporcionar servicios de entrega de bienes. </li><li>  Cumplimiento - almacenamiento de bienes, la formaci√≥n y entrega de pedidos de tiendas de electr√≥nica. </li><li>  Expansi√≥n de puntos de entrega de pedidos, incluido el uso de redes afiliadas. </li><li>  Flujo de trabajo legalmente significativo con contrapartes.  Esto le permitir√° abandonar la transferencia lenta y costosa de documentos en papel. </li><li>  Aceptaci√≥n de cartas registradas en formato electr√≥nico con entrega tanto en formato electr√≥nico como en papel (con el sello de los env√≠os lo m√°s cerca posible del destinatario final).  Servicio de cartas electr√≥nicas registradas en el portal de servicios p√∫blicos. </li><li>  Plataforma para la prestaci√≥n de servicios de telemedicina. </li><li>  Recepci√≥n simplificada y entrega simplificada de correo certificado utilizando una firma electr√≥nica simple. </li><li>  Digitalizaci√≥n de la red de correos. </li><li>  Procesamiento de servicios de autoservicio (terminales y oficinas de correos). </li><li>  Creaci√≥n de una plataforma digital para gestionar un servicio de mensajer√≠a y una nueva aplicaci√≥n m√≥vil para clientes de servicios de mensajer√≠a. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Ven a nosotros a trabajar!</b> <div class="spoiler_text"><ul><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-154.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2020-01-28%26utm_campaign%3Ddsi">Ingeniero de Infraestructura Corporativa</a> </li><li>  <a href="https://job.lanit.ru/vacancy/Pages/MM-171.aspx%3Futm_source%3Dhabr%26utm_medium%3Dpost-2020-01-28%26utm_campaign%3Ddsi">Ingeniero principal de Linux / DevOps</a> </li></ul></div></div></div></div><p>Source: <a href="https://habr.com/ru/post/484090/">https://habr.com/ru/post/484090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../484070/index.html">C√≥mo escribimos un sistema antifraude en cuatro manos y tres cabezas</a></li>
<li><a href="../484072/index.html">5. Fortinet Getting Started v6.0. NAT</a></li>
<li><a href="../484076/index.html">D√≥nde almacenar la criptomoneda: impuestos de las criptomonedas en diferentes pa√≠ses</a></li>
<li><a href="../484084/index.html">1C-Bitrix y un intento de presentarlo</a></li>
<li><a href="../484088/index.html">Desfile de contrase√±as (an√°lisis de ~ 5 mil millones de contrase√±as de fugas)</a></li>
<li><a href="../484092/index.html">Algo pr√≠ncipes y nobles vestidos</a></li>
<li><a href="../484094/index.html">Crea un juego de disparos de zombis en tercera persona con DOTS</a></li>
<li><a href="../484096/index.html">La batalla de los dos Yakozun, o Cassandra vs HBase. Experiencia del equipo de Sberbank</a></li>
<li><a href="../484100/index.html">Trabajar con la interfaz en el SDK de Google Maps para Android</a></li>
<li><a href="../484102/index.html">PHP vs Python vs Ruby on Rails: Comparaci√≥n detallada</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>