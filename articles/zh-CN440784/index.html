<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏺 🧦 🐩 离开时，关灯并关水 🍷 👩🏾 Ⓜ️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="此类建议旨在保护和保护公寓（房屋等）免遭平常的麻烦到对自身和他人的严重损害。 有些人由于担心麻烦而将仪表板中的自动机关闭并关闭供水入口水龙头，因此单独手动执行此过程并不十分方便，为此，我承诺制定一个预算系统来照顾这一过程的自动化，并增加一些功能。 这是怎么回事以及效果如何-您可以在裁减下阅读它。 
...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>离开时，关灯并关水</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440784/"><img src="https://habrastorage.org/webt/xc/w3/sw/xcw3swmwgywsjkfnxjxb3b5ffoa.jpeg" alt="图片"><br> 此类建议旨在保护和保护公寓（房屋等）免遭平常的麻烦到对自身和他人的严重损害。 有些人由于担心麻烦而将仪表板中的自动机关闭并关闭供水入口水龙头，因此单独手动执行此过程并不十分方便，为此，我承诺制定一个预算系统来照顾这一过程的自动化，并增加一些功能。 这是怎么回事以及效果如何-您可以在裁减下阅读它。 <br><a name="habracut"></a><br> 首先，我要说的是，我将描述用于公寓的系统，但原则上它也适用于乡间别墅，并可选地用于其他房间。 <br><br> 解决方案的初稿如下所示：在公寓出口处，按下按钮时设置按钮，将公寓电子设备切换至以下一种操作模式：安全模式（面板上的所有用电设备均关闭，水阀关闭）和正常操作（全部打开且阀门打开）。 问题马上就出现了，如果您要离开一个月，那么一切都被砍掉了，就离开了，如果您需要短时间安全地离开公寓，工作和其他一日游，事实证明，最好不要关闭冰箱（以及建议不要关闭其他设备）特别是要通过后退按钮打开的设备）。 结果，经过深思熟虑，我得出的结论是这样做是正确的：将操作模式从安全更改为“待机”，并将正常操作模式称为“主”。 并将公寓中的布线“划分”为以下类别：主220伏，备用220伏。 <br><br>  <i>工作算法</i>如下：“主”模式是包罗万象的，“待机”模式仅是必需的消费者工作（为简便起见，用于冰箱）。 必须离开一个月或完全固定，关闭水源，切断中央自动机。 如果需要日常维护，请按一下按钮，自动装置将关闭阀门，并切断必要的机器，让冰箱保持打开状态。 到达后，我按下了按钮，自动化系统打开了所有设备，并打开了供水阀。 <br><br> 根据所采用的算法，我决定在面板中制作一个单元，该单元可以切断负责冰箱类别中未包括的设备的阶段以及负责打开和关闭供水阀的单元。 <br><br><div class="spoiler">  <b class="spoiler_title">在这里，我想从主题上退一步，并说明为什么选择了2个块而不是一个通用块。</b> <div class="spoiler_text"> 结合在设备开发过程中获得的经验，我得出以下结论：每个模块都应负责一项特定任务，该任务越简单，模块就越简单（自然，并非多余）。 块越简单，它所遇到的问题就越少-由于从其他块进行抽象的程度高。 它们也被制造为使得它们可以彼此独立地工作。 </div></div><br> 这些模块使用易于购买和更换的标准模块。 同样，通过标准化控制，您可以放置​​另一个更可靠，改进或功能更多的单元。 这些控制单元是基于Arduino nano并为其键入的，我相信该控制器模块足以控制单元。 <br><br> 我将回到电源和接线问题。 为了给单元供电，我使用恒定的12伏特。 <br><br>  <i>在这里，我还想澄清一下我对这个问题的看法：现在已经有很多12伏及更低电压的LED照明灯带开始消耗用户，将这个电压用于公寓中的低压用户是合乎逻辑的，此外，通常来说，这是一个更安全的电压。</i> <br><br> 下文中，我表示12伏的标称电压，实际上，电源的输出端将存在约13-14伏的电压，因此电线上会有压降的余量，并且12 V将以较小的容差到达消费者。 因此，我认为公寓中的通用接线图应如下所示： <br><br><img src="https://habrastorage.org/webt/4c/0l/vq/4c0lvqz276i0e5qg2ro0jdsroqm.jpeg" alt="图片"><br><br> 自然，会有更多带有插座的机器，并且一台自己的机器可以有一个以上的12伏电源设备（可能有装载或备份某些系统的选项-您可以撰写有关此内容的单独文章）。 <br><br><h3> 电源管理单元（BUE） </h3><br><img src="https://habrastorage.org/webt/-j/0g/bi/-j0gbiuu0loku--dboynvu0inqi.jpeg" alt="图片" height="60%" width="60%"><img src="https://habrastorage.org/webt/lh/q9/pt/lhq9ptiutfbgoqbpyl1vzeualdg.jpeg" alt="图片"><br><br> 该单元控制3个电源，主板上有2个机电继电器，外部有1个固态继电器。 该单元的主板不是通用的，而是专门为该单元而开发的，我不能认为理想的选择已经出现-它只是对它会产生什么的一种考验。 机电继电器最多需要16安培的电流。 <br><br><img src="https://habrastorage.org/webt/wi/3c/59/wi3c59grz5y7gjuu-lxbov3vpa4.jpeg" alt="图片"><br><br> 我知道许多与继电器相关的支持者非常不信任-即使在这里我对此数字也不信任。 在保护使用的方向上，我会说切换不会经常发生，并且它也不打算在最大负载下正常工作，通常，我会将负载除以较小的安培数，即 多台机器，每台机器的安培数都更少，但这都取决于公寓中的接线。 我将了解操作期间会发生什么，然后，如有必要，我将已经接受了一些创新。 在块中实现逐步包含负载，即 这三个继电器中的每个继电器都以一定的时间间隔打开，在我看来，这通常对公寓的电力供应产生积极影响。 在按钮外壳上有指示灯（LED），用于指示当前块模式和警告/警报状况。 单个的两色LED用于指示模式。 绿色是主要的，红色是服务员。 从一种模式转换到另一种模式期间，指示灯以彩色闪烁，进入正在转换的模式。 在设备的顶盖上有一个指示继电器（白色LED）之后是否存在电压的指示，盖子上也显示有工作模式的指示-但决定不打开它，因为 有一个指示当前模式的按钮，设备将站在防护罩中，那里的模式指示不是特别重要。 单元控制器接收有关电压存在的信息并分析该状态，如果继电器关闭但电压仍然存在（继电器被卡住），则将出现警告指示-按钮外壳中的LED经常闪烁（圆形）。 从控制器的通风情况来看，“ Siemens”案成功地出现在了DIN导轨的下面，但我仍然不得不对其进行一些修改。 <br><br><h3> 供水阀控制单元（BUPV） </h3><br><img src="https://habrastorage.org/webt/wm/l-/ql/wml-qlj4m7k1srt59t_lt5q2u38.jpeg" alt="图片" height="60%" width="60%"><img src="https://habrastorage.org/webt/fi/ot/lk/fiotlkpqoynacyxh2moabmsvloe.jpeg" alt="图片"><br><br> 该单元控制2个电动球阀（在Ali上购买，价格为1个〜900卢布）。 热水和冷水的两个阀是相同的。 球阀是通过2根线220V +零控制的，您要给一根线220供电-它会关闭阀，将它施加到另一根-会打开阀。 控制马达仅旋转一种方式，即 没有完全关闭，就不可能开始打开。 阀体内有一个微动开关，关闭或打开过程完成后，它会自动释放电动机的电压。 <br><br>  <i>本机的运行算法：</i>接受控制命令，关闭阀门或打开阀门。 该模块具有2种自动和手动控制模式。 在自动模式下，仅从电源控制单元接收命令。 在手动模式下，命令从供水控制单元盖上的按钮执行，而忽略电压控制单元的命令。 该块具有打开和关闭模式。 装置盖上有3个LED，其中2个仅指示装置所处的当前模式（绿色-阀打开，红色-阀关闭），以及在过渡过程中的BUE中，LED闪烁至装置进入哪种模式，大约3我将在下面告诉您有关此LED的信息。 该单元安装在阀门附近，可进行指示和控制。 <br><br> 在实施这些模块时，我得出的结论是，某些类别的设备已经运行了很长时间，因此不建议“立即”将它们与网络断开连接-此类设备包括洗衣机，洗碗机（很可能包括此类设备）其他设备，但我将提供一个与洗衣机相关的示例）。 有时可能会发现洗衣机已开始洗涤，如果关闭电源，该过程将仍然不完整且会损坏，因此我决定为洗衣机使用另一种算法。 <br><br>  <i>用于洗衣机的算法：</i>在洗衣机的洗涤过程中，会向供水控制单元发送正在进行洗涤的信号。 如果正在清洗，设备会分析该信号，并突然决定将其置于待机模式，设备不会关闭冷水供应阀（热水阀将关闭）。 如果在待机模式下“正在进行洗涤”（洗涤完成）信号消失，则设备将关闭冷水阀。 反向过程不会发生（也就是说，如果设备已经处于待机模式并且阀门已关闭，则在出现信号“冲洗”时，阀门将不会打开）。 <br><br> 我将返回模块盖上的第三个LED指示灯-它显示在给定时间是否正在进行清洗的状态。 <br><br>  <i>实现从洗衣机接收控制信号。</i> <br><br>  <i>而不是前言：</i>实际上，令我惊讶的是，家用电器（简单而不是专用）没有最简单的电触点（闭合状态）来指示其当前状态-即使过程正在运行或处于空闲状态，它也会大大简化了自动化过程，因此不必围墙围篱以电接收此类信息。 我认为，这将是家用电器功能的附加优点，而制造商只需花费最少的钱即可。 <br><br> 因此，您需要从洗衣机得到一个信号，表明洗衣机正在进行清洗。 在论坛上找到有关此问题的任何解决方案并观察清洗的开始和结束过程之后，我还查看了电路，发现来自不同制造商的一半以上的简单洗衣机在标准类型的电路板上工作，其工作原理的正负相同。 我得出的结论是，最合适的选择是用于装载衣物的舱口盖锁。 在清洗开始时，锁会锁定装载舱口，在清洗结束时，它会解锁。 这种锁的方案分布均匀，并且在大多数洗衣机中是相同的。 <br><br><img src="https://habrastorage.org/webt/mh/ak/zg/mhakzgngw4wjydilptwzh8nfj6u.jpeg" alt="图片" height="45%" width="45%"><img src="https://habrastorage.org/webt/m5/sx/nm/m5sxnm0xv7cf5nuyoyog-g13r1q.jpeg" alt="图片" height="45%" width="45%"><br><br>  <i>锁的操作：</i>当向其提供220伏电压（触点1和3）时，它将锁定门；如果移除了电压，它将停止阻塞门。 我的解决方案是使用继电器，其电源电压与舱口锁并联连接的220V线圈-这不会损坏洗衣机，只有洗衣机在洗涤过程中会消耗更多电流（继电器线圈消耗的电流量）。 因为 由于我的洗衣机很旧，而且无法长期保证，因此该选项非常适合我。 电接收洗衣机正在清洗的信息可能还有更多有趣的选择，我很高兴知道这些信息。 <br><br><h3> 块之间的通信组织 </h3><br> 我将给出块与带之间的电气相互作用的一般示意图 <br><br><img src="https://habrastorage.org/webt/pz/kn/7d/pzkn7dopwuwjrbh23rdnfnva2gq.jpeg" alt="图片"><br><br> 块之间的通信是通过RS-485硬件接口和软件协议SRDB2进行的，我在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">本文</a>前面已经进行<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">了介绍</a> 。 在我的情况下，BUE是领导者并发送命令之一（打开阀门，关闭阀门，给出其当前状态），BELV始终以其当前状态做出响应。 <br>  <i>协同工作的算法：</i>按下控制单元的控制按钮以切换到待机模式时，控制单元会向关闭的控制单元发送命令；  BUPV查看当前的洗涤状态;如果没有洗涤，它将开始关闭两个供水阀，同时响应BUE阀门正在关闭，如果正在进行洗涤，则仅热水阀关闭，并通知BUE有关此状态的信息。 关闭阀门后，BUPV报告阀门已成功关闭。  BUE从答案中看到阀门已成功关闭，并且如果不进行洗涤，则可减轻为洗衣机和阀门提供的电压。 如果正在清洗，则不会去除洗衣机的电压。 不断对BUPV的现状进行调查。  BUE仅在收到“清洗完成”状态（此状态由BUPV在清洗完成且热水阀关闭后发出）之后，才移除为洗衣机和阀门供应的电压。 转换到“主模式”后，BUE发送命令“打开阀门”，并按一定的时间间隔（依次包括继电器）向继电器施加电压。 <br><br> 供水阀的控制是根据一个开关继电器来组织的。 对于“打开阀”状态，它具有常闭触点状态。 如果您向洗衣机（继电器“垫圈”）施加电压，而不是向负责控制阀门的继电器施加电压，则阀门将打开-在从“待机”状态到“主”状态的转换中，这是必要的。 当从“主”模式切换到“待机”模式而没有从洗衣机上移除电压时，有必要向阀控制继电器施加电压，从而开始关闭阀的过程。 在这种情况下，阀将关闭或处于关闭状态，同时将控制信号发送到两个继电器（向洗衣机提供的电源继电器和用于控制阀的电压继电器），因为在阀关闭之后，“冲洗”继电器的电压被移除，继电器状态阀门控制不再重要（切换到待机模式后的一段时间后，我从阀门控制继电器上移除了电压，从而准备好等待过渡到打开的阀门状态）。 这样可以确保阀控制继电器上的负载最小。 <br><br><h3> 块的自主工作 </h3><br> 根据我在操作自动化方面的经验，我会说不可能将自动化发展中的所有细微差别都考虑在内，因此，我认为引入手动或自动控制单元是正确的，因为 这将有助于在异常情况下与她进行一些互动。 自动和手动模式开关位于BUPV盖板上。 上面介绍了自动交互的工作。 在手动操作中，BELV会忽略来自BUE的命令。  的盖子上有一个按钮，用于切换到打开所有阀门和关闭所有阀门的模式。 对于BUPV的手动控制，将忽略“洗涤”读数。 此操作专门用于紧急关闭阀门，即 如果在主模式下运行期间洗衣机正在运转且管道破裂，则要快速关闭水，必须将设备设置为手动控制，并通过将其置于模式下的按钮将所有阀门关闭。 当BUPV处于手动模式时，BUE不会分析来自BUPV的数据，而是在切换到工作模式时执行直接功能，它将关闭所有功能。 <br><br> 可以理解，在手动模式下，一个人独立地负责如何正确和更好地控制该设备，同时，错误信号“洗涤”的故障是“重叠的”。 <br><br><h3> 计划外紧急停电 </h3><br> 万一公寓发生断电，两个模块都将它们的状态记录在非易失性存储器中，并且在供电后，这些模块将返回到关机之前的状态。 例外是清洗过程中的状态。 当断电时，此过程很可能会被破坏，然后关闭阀门的块会进入待机模式，而未完成清洗过程中的LED会闪烁以更改BUE模式的按钮。 通过按下用于更改BUE模式的按钮，可以删除未完成洗涤过程的指示。 <br><br>  <i>附言</i> 在开发和运行开始之后，一切都按预期工作，但是已经出现了如何使模块更好的想法，即放弃220伏的阀并切换到12伏-为了从BUPV总体上去除220伏，增加BUE中的继电器数量并把它们放到箱子外面-使它们也可以快速更换-（但这是另一回事。总的来说，人们对此发展的看法很有趣（请问您是否将它放在家里）-我知道我还没有发明新的东西，我相信办公室轻松应对智能家居 他们会提出这样的建议，我只是在这种流程的自动化预算方面解决了这个问题。第二个站点都有arduino，如果有人想制造完全相同的设备，他们在联系人中有我的电子邮件，则我可以发送块的程序代码，并详细说明如何，什么以及为什么。      4-5  ,         « ». <br><br>  P.P.S. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="></a>    . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN440784/">https://habr.com/ru/post/zh-CN440784/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN440774/index.html">严重的NHTSA数学错误使特斯拉声称自动驾驶安全</a></li>
<li><a href="../zh-CN440776/index.html">电子邮件，内部视图</a></li>
<li><a href="../zh-CN440778/index.html">Mail.ru组的第二次OpenStack聚会：2月22日</a></li>
<li><a href="../zh-CN440780/index.html">Google不会在Chromium浏览器中阻止第三方广告阻止程序</a></li>
<li><a href="../zh-CN440782/index.html">我正在深入地下，或者您应该了解的有关优化网络应用程序的知识</a></li>
<li><a href="../zh-CN440786/index.html">学习和记录源代码的新外观</a></li>
<li><a href="../zh-CN440788/index.html">在实际示例中使用Spring状态机</a></li>
<li><a href="../zh-CN440790/index.html">Hi-Fi-分类问题：关于历史，标准，营销和术语</a></li>
<li><a href="../zh-CN440792/index.html">SVG过滤效果。 第5部分。使用feDisplacementMap将文本与表面纹理匹配</a></li>
<li><a href="../zh-CN440794/index.html">DEFCON会议19.第3代DoS攻击（涉及作为受害者的听众）。 第一部分</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>