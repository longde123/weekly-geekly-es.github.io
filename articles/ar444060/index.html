<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>โ ๐ฝ ๐ฐ ุงููุฌุฑุฉ ูู Nagios ุฅูู Icinga2 ูู ุฃุณุชุฑุงููุง ๐ ๐พ โข๏ธ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูุฑุญุจุง ุจุงูุฌููุน. 


 ุฃูุง ูุณุคูู ุงููุธุงู linux ุ ุงูุชููุช ูู ุฑูุณูุง ุฅูู ุฃุณุชุฑุงููุง ุจุชุฃุดูุฑุฉ ููููุฉ ูุณุชููุฉ ูู ุนุงู 2015 ุ ููู ุงูููุงู ูู ูุฏูุฑ ุญูู ููููุฉ ุงูุญุตูู ุนูู ุฌุฑ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงููุฌุฑุฉ ูู Nagios ุฅูู Icinga2 ูู ุฃุณุชุฑุงููุง</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444060/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูุฑุญุจุง ุจุงูุฌููุน. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุง ูุณุคูู ุงููุธุงู linux ุ ุงูุชููุช ูู ุฑูุณูุง ุฅูู ุฃุณุชุฑุงููุง ุจุชุฃุดูุฑุฉ ููููุฉ ูุณุชููุฉ ูู ุนุงู 2015 ุ ููู ุงูููุงู ูู ูุฏูุฑ ุญูู ููููุฉ ุงูุญุตูู ุนูู ุฌุฑุงุฑ ุฎูุฒูุฑ ุตุบูุฑ.  ูุฐู ุงูููุงูุงุช ูุงููุฉ ุจุงููุนู (ููุน ุฐูู ุ ุฅุฐุง ูุงูุช ููุงู ูุตูุญุฉ ุ ูุณุฃูุชุจ ุนููุง ุฃูุถูุง) ุ ูุฐูู ุฃูุฏ ุฃู ุฃุชุญุฏุซ ุนู ููู ููุช ูู ุนููู ูู ุฃุณุชุฑุงููุง ููููุฏุณ ูุธุงู ุชุดุบูู ููููุณ ุ ููุช ุงูุจุงุฏุฆ ุจุงููุฌุฑุฉ ูู ูุธุงู ูุงุญุฏ. ูุฑุงูุจุฉ ูุขุฎุฑ.  ุนูู ูุฌู ุงูุชุญุฏูุฏ - Nagios =&gt; Icinga2. </p><br><p style=";text-align:right;direction:rtl">  ุงูููุงู ุชููู ุฌุฒุฆููุง ูุฌุฒุฆููุง ุนู ุงูุชูุงุตู ูุน ุงูุฃุดุฎุงุต ูุงููุดุงูู ุงููุฑุชุจุทุฉ ุจุงููุฑู ูู ุงูุซูุงูุฉ ูุฃุณุงููุจ ุงูุนูู. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  ูุณูุก ุงูุญุธ ุ ูุง ุชูุจุฑุฒ ุนูุงูุฉ "ุงูุฑูุฒ" ุฑูุฒ ุงูุนูููุฉ ูุงููููู ุ ูุฐูู ุงุถุทุฑุฑุช ุฅูู ุงุณุชุฎุฏุงู "ูุต ุนุงุฏู". </p><br><p style=";text-align:right;direction:rtl">  ูุง ุดูุก ููุฐุฑ ุจุงููุฑุถ ูู ุตุจุงุญ ููู 21 ุฏูุณูุจุฑ 2016.  ูุงููุนุชุงุฏ ุ ูุฑุฃุช ูุจุฑ ูุน ูุฌููู ุงููููุฉ ุบูุฑ ูุณุฌู ูู ุงููุตู ุณุงุนุฉ ุงูุฃููู ูู ููู ุงูุนูู ุ ุญูุซ ุชูุชุต ุงููููุฉ ูุตุงุฏูุช <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง ุงูููุงู</a> . </p><br><p style=";text-align:right;direction:rtl">  ููุฐ ุฃู ุชู ุงุณุชุฎุฏุงู Nagios ูู ุดุฑูุชู ุ ุฏูู ุงูุชูููุฑ ูุฑุชูู ุ ููุช ุจุฅูุดุงุก ุชุฐูุฑุฉ ูู Redmine ูุฃูููุช ุงูุงุฑุชุจุงุท ูู ุงูุฏุฑุฏุดุฉ ุงูุนุงูุฉ ุ ูุฃููู ุงุนุชูุฏุช ุฃู ุฐูู ููู.  ุงููุจุงุฏุฑุฉ ูุนุงูุจ ุนูููุง ุญุชู ูู ุฃุณุชุฑุงููุง ุ ูุฐูู ุนูู ุงููููุฏุณ ุงูุฑุฆูุณู ูุฐู ุงููุดููุฉ ุนููู ููุฐ ุฃู ุงูุชุดูุชูุง. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุดุงุดุฉ ูู Redmine</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ge/uc/gu/geucgutwhu3_zu4uwes2ozuwa3e.jpeg"></div></div><br><p style=";text-align:right;direction:rtl">  ูู ูุณููุง ุ ูุจู ูุถุน ุฑุฃููุง ุ ูู ุงููุนุชุงุฏ ุงูุชุฑุงุญ ุจุฏูู ูุงุญุฏ ุนูู ุงูุฃูู ุ ุญุชู ูู ูุงู ุงูุฎูุงุฑ ูุงุถุญูุง ุ ูุฐูู ุจุฏุฃุช ูู ุฎูุงู googling ุฃูุธูุฉ ุงููุฑุงูุจุฉ ุจุดูู ุนุงู ุฐุงุช ุงูุตูุฉ ุญุงูููุง ุ ุญูุซ ุฃููู ูู ุฑูุณูุง ูู ุขุฎุฑ ููุงู ุนููุช ููู ุ ูุงู ูุฏู ูุธุงู ุชุณุฌูู ุดุฎุตู ุฎุงุต ุจู ุ ุจุฏุงุฆูุฉ ููุบุงูุฉ ุ ูููู ูุน ุฐูู ุชุนูู ุจุดูู ุฌูุฏ ูุชุคุฏู ุฌููุน ุงูููุงู ุงูููููุฉ ุฅูููุง.  ุจูุซูู ูุณุงูุช ุจุทุฑุณุจุฑุบ ูููููู ุงูุชุทุจูููุฉ ูุญูู ุงููุชุฑู.  ูุง ุ ุชูุชุต ุงููุชุฑู.  ูุฐู ุดุฎุตูุฉ (11 ุนุงููุง ูู ุงูุนูู) ูุชุณุชุญู ููุงูุฉ ูููุตูุฉ ุ ูููู ููุณ ุงูุขู. </p><br><p style=";text-align:right;direction:rtl">  ููููุงู ุนู ููุงุนุฏ ุฅุฌุฑุงุก ุชุบููุฑุงุช ุนูู ุชูููู ุงูุจููุฉ ุงูุชุญุชูุฉ ูู ูููุนู ุงูุญุงูู.  ูุณุชุฎุฏู ุงูุฏูู ู Gitlab ููุจุฏุฃ ุงูุจููุฉ ุงูุชุญุชูุฉ ููุงููู ุ ุจุญูุซ: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุง ุชูุฌุฏ ุชุบููุฑุงุช ูุฏููุฉ ุนุจุฑ SSH ุนู ุทุฑูู ุชุนุฏูู ุฃู ูููุงุช ุนูู ุงูุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ ูุฏูููุง.  ููุฏุฉ ุซูุงุซ ุณููุงุช ูู ุงูุนูู ุ ุชูููุช ูุจุนุฉ ููุฐุง ูุฑุงุช ุนุฏูุฏุฉ ุ ุขุฎุฑูุง ูุจู ุฃุณุจูุน ููุง ุฃุนุชูุฏ ุฃููุง ูุงูุช ุงููุฑุฉ ุงูุฃุฎูุฑุฉ.  ุญุณููุง ุ ูู ุงููุงูุน - ุฅุตูุงุญ ุณุทุฑ ูุงุญุฏ ูู ุงูุชูููู ุ ุฃุนุฏ ุชุดุบูู ุงูุฎุฏูุฉ ููุนุฑูุฉ ูุง ุฅุฐุง ูุงู ูุฏ ุชู ุญู ุงููุดููุฉ - 10 ุซูุงูู.  ุฃูุดุฆ ูุฑุนูุง ุฌุฏูุฏูุง ูู Gitlab ุ ูุงุฏูุน ุงูุชุบููุฑุงุช ุ ูุงูุชุธุฑ r10k ููุนูู ุนูู Puppetmaster ุ ููู ุจุชุดุบูู Puppet --environment = mybranch ูุงูุชุธุฑ ุจุถุน ุฏูุงุฆู ุญุชู ูุนูู ูู ูุฐุง - ุจุญุฏ ุฃุฏูู 5 ุฏูุงุฆู. </li><li style=";text-align:right;direction:rtl">  ูุชู ุฅุฌุฑุงุก ุฃู ุชุบููุฑุงุช ุนู ุทุฑูู ุฅูุดุงุก ุทูุจ ุฏูุฌ ูู Gitlab ูุชุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ููุงููุฉ ูู ุนุถู ูุงุญุฏ ุนูู ุงูุฃูู ูู ุฃุนุถุงุก ุงููุฑูู.  ุงูุชุบููุฑุงุช ุงูุฑุฆูุณูุฉ ูู ููุงุฏุฉ ุงููุฑูู ุชุชุทูุจ ููุงููุชูู ุฃู ุซูุงุซ ููุงููุงุช. </li><li style=";text-align:right;direction:rtl">  ุฌููุน ุงูุชุบููุฑุงุช ูุตูุฉ ุจุดูู ุฃู ุจุขุฎุฑ (ุจูุง ุฃู ุฅุนูุงูุงุช ุงูุนุฑุงุฆุณ ููุฎุทูุทุงุช ููุฑุง ูุงูุจูุงูุงุช ูุตูุฉ) ุ ูุฅู ุงูุซูุงุฆูุงุช ูุญุจุทุฉ ููุบุงูุฉ ุ ูููุงู ุญุงุฌุฉ ุฅูู ุฃุณุจุงุจ ูุฌููุฉ ููููุงููุฉ ุนูููุง. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูุฅู ุงูุฎูุงุฑุงุช ุงูุชู ูุธุฑุช ุฅูููุง ูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  Munin - ุฅุฐุง ูุงู ููุงู ุฃูุซุฑ ูู 10 ุฎูุงุฏู ูู ุงูุจููุฉ ุงูุชุญุชูุฉ ุ ุชุชุญูู ุงูุฅุฏุงุฑุฉ ุฅูู ุฌููู (ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐู ุงูููุงูุฉ</a> . ูู ุฃูู ุฃุฑุบุจ ูู ุงูุชุญูู ูู ุฐูู ุ ูุฐุง ุฃุฎุฐุช ููุงูู ูุฐูู). </li><li style=";text-align:right;direction:rtl">  Zabbix - ููุฐ ูุชุฑุฉ ุทูููุฉ ุชุชุทูุน ุ ูุฑุฉ ุฃุฎุฑู ูู ุฑูุณูุง ุ ูููู ุจุนุฏ ุฐูู ูุงู ูุง ูุฒูู ููุง ูููุงูู.  ููุง - ูุงู ูุง ุจุฏ ูู ุฅุณูุงุทู ุจุณุจุจ ุงุณุชุฎุฏุงู Puppet ููุฏูุฑ ููุชูููู ู Gitlab ููุธุงู ููุชุญูู ูู ุงูุฅุตุฏุงุฑ.  ูู ุชูู ุงููุญุธุฉ ุ ููุง ุฃููููุง ุ ูุฎุฒู Zabbix ุงูุชูููู ุจุงููุงูู ูู ูุงุนุฏุฉ ุจูุงูุงุช ุ ูุจุงูุชุงูู ูู ููู ูู ุงููุงุถุญ ููููุฉ ุฅุฏุงุฑุฉ ุงูุชูููู ูู ุงูุธุฑูู ุงูุญุงููุฉ ูููููุฉ ุชุชุจุน ุงูุชุบููุฑุงุช. </li><li style=";text-align:right;direction:rtl">  ุจุฑูููุซููุณ ูู ูุง ุณูุฃุชู ุฅููู ูู ุงูููุงูุฉ ุ ุฅุฐุง ุญูููุง ูู ุฎูุงู ุงูุญุงูุฉ ุงููุฒุงุฌูุฉ ูู ุงููุณู ุ ููู ูู ุฐูู ุงูููุช ูู ุฃุชููู ูู ุฅุชูุงูู ููู ุฃุณุชุทุน ุชูุฏูู ูููุฐุฌ ุนููู (ุฅุซุจุงุช ุงูููุฑุฉ) ุ ูุฐูู ุงุถุทุฑุฑุช ุฅูู ุงูุฑูุถ. </li><li style=";text-align:right;direction:rtl">  ูุงูุช ููุงู ุนุฏุฉ ุฎูุงุฑุงุช ุฃุฎุฑู ุชุชุทูุจ ุฅูุง ุฅุนุงุฏุฉ ุชุตููู ูุงููุฉ ูููุธุงู ุ ุฃู ูุงูุช ูู ููุฏูุง / ุชู ุงูุชุฎูู ุนููุง ูุชู ุฑูุถ ุงูุณุจุจ ููุณู. </li></ul><br><p style=";text-align:right;direction:rtl">  ูู ุงูููุงูุฉ ุ ุงุณุชูุฑุช ุนูู Icinga2 ูุซูุงุซุฉ ุฃุณุจุงุจ: </p><br><p style=";text-align:right;direction:rtl">  1 - ุงูุชูุงูู ูุน Nrpe (ุฎุฏูุฉ ุงูุนููุงุก ุงูุชู ุชุฏูุฑ ุนูููุงุช ุงูุชุญูู ูู ุงูุฃูุงูุฑ ูู Nagios).  ูุงู ูุฐุง ููููุง ููุบุงูุฉ ุ ูุฃูู ูู ุฐูู ุงูููุช ูุงู ูุฏููุง 135 ุฌูุงุฒูุง (ููุฌุฏ ุงูุขู 165 ุฌูุงุฒูุง ูู ุนุงู 2019) ูุน ูุฌููุนุฉ ูู ุงูุฎุฏูุงุช / ุงูุดููุงุช ุงูููุชูุจุฉ ุฐุงุชูุง ูุฅุนุงุฏุฉ ูู ูุฐุง ุณูููู ุงูุจูุงุณูุฑ ุงูุฑููุจุฉ. <br>  2 - ุฌููุน ูููุงุช ุงูุชูููู ูู ูุต ุ ููุง ูุฌุนู ูู ุงูุณูู ุชุญุฑูุฑ ูุฐู ุงููุณุฃูุฉ ุ ูุฅูุดุงุก ุทูุจุงุช ุฏูุฌ ูุน ุงููุฏุฑุฉ ุนูู ุฑุคูุฉ ูุง ุชูุช ุฅุถุงูุชู ุฃู ุญุฐูู. <br>  3 ูู ูุดุฑูุน ููุชูุญ ุงููุตุฏุฑ ุญููู ููุชูุงูู.  ูุญู ูุบุฑููู ููุบุงูุฉ ูู OpenSource ูููุฏู ูุณุงููุฉ ูุฌุฏูุฉ ูู ูู ุฎูุงู ุฅูุดุงุก ุทูุจุงุช ุงูุณุญุจ ูุงููุถุงูุง ูุญู ุงููุดุงูู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุฏุนููุง ูุฐูุจ ุ Icinga2. </p><br><p style=";text-align:right;direction:rtl">  ุฃูู ุดูุก ูุงู ุนูู ููุงุฌูุชู ูู ุงููุตูุฑ ุงูุฐุงุชู ูุฒููุงุฆู.  ููุฏ ุงุนุชุงุฏ ุงูุฌููุน ุนูู Nagios / Najios (ุฑุบู ุฃูู ุญุชู ููุง ูู ูุชููููุง ูู ุญู ูุณุท ุญูู ููููุฉ ูุทู ูุฐุง) ููุงุฌูุฉ CheckMK.  ูู icinga ุ ุชุจุฏู ุงููุงุฌูุฉ ูุฎุชููุฉ ุชูุงููุง (ูุงูุช ูุงูุตูุง) ุ ููู ูู ุงููููู ุชูููู ูุง ุชุญุชุงุฌู ุจูุฑููุฉ ูุชุชููู ูู ุฑุคูุชู ุจุงุณุชุฎุฏุงู ุงููุฑุดุญุงุช ุญุฑูููุง ุจูุงุณุทุฉ ุฃู ูุนููุฉ (ูุงูุช ุนูุงูุฉ ุฒุงุฆุฏ ุ ูููู ูุงุถูุช ูู ุฃุฌููุง ุจุดูู ุฎุงุต). </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุฑุดุญุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/kx/bf/0e/kxbf0eqj-gh7bfkpgtzgjjgvhwm.jpeg"></div></div><br><p style=";text-align:right;direction:rtl">  ูู ุจุชูุฏูุฑ ูุณุจุฉ ุญุฌู ุดุฑูุท ุงูุชูุฑูุฑ ุฅูู ุญุฌู ุญูู ุงูุชูุฑูุฑ. </p><br><p style=";text-align:right;direction:rtl">  ุซุงููุงู ุ ุงุนุชุงุฏ ุงูุฌููุน ุนูู ุฑุคูุฉ ุงูุจููุฉ ุงูุชุญุชูุฉ ุจุฃููููุง ุนูู ุดุงุดุฉ ูุงุญุฏุฉ ุ ูุฃู CheckMk ูุณูุญ ูู ุจุงูุนูู ูุน ุงูุนุฏูุฏ ูู ูุถููู Nagios ุ ููู ุฅูุณููุฌุง ูู ุชูู ุชุนุฑู ููู (ูู ุงููุงูุน ุ ูููู ุฃูุซุฑ ุญูู ุฐูู ุฃุฏูุงู).  ูุงู ููุงู ุจุฏูู ูุณูู Thruk ุ ููู ุชุตูููู ุชุณุจุจ ูู ุงูุชููุค ูุฌููุน ุฃุนุถุงุก ุงููุฑูู ุ ุจุงุณุชุซูุงุก ูุงุญุฏ - ุงูุดุฎุต ุงูุฐู ุงูุชุฑุญู (ูููุณ ุฃูุง). </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Thruk Firebox - ูุฑุงุฑ ูุฑูู ุจุงูุฅุฌูุงุน</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/tv/1c/_l/tv1c_lkx-h9rbwgpdy63jdohnve.png"></div></div><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ููููู ูู ุงูุนุงุตูุฉ ุงูุฏูุงุบูุฉ ุ ุงูุชุฑุญุช ููุฑุฉ ูุฑุงูุจุฉ ุงููุชูุฉ ุ ุนูุฏูุง ูููู ููุงู ูุถูู ุฑุฆูุณู ูุงุญุฏ ูู ููุทูุฉ ุงูุฅูุชุงุฌ ูุงุซููู ูู ุงููุฑุคูุณูู - ูุงุญุฏ ูู dev / test ููุถูู ุฎุงุฑุฌู ูุงุญุฏ ููุฌูุฏ ูู ูุฒูุฏ ุขุฎุฑ ูู ุฃุฌู ูุฑุงูุจุฉ ุฎุฏูุงุชูุง ูู ูุฌูุฉ ูุธุฑ ุงูุนููู ุฃู ูู ุงูุฎุงุฑุฌ ูุฑุงูุจ.  ุณูุญ ูู ูุฐุง ุงูุชูููู ุจุฑุคูุฉ ูู ุงููุดุงูู ูู ูุงุฌูุฉ ูุงุญุฏุฉ ุนูู ุดุจูุฉ ุงูุฅูุชุฑูุช ูุนููุช ุจุดูู ุฌูุฏ ุ ููู Puppet ... ูุงูุช ุงููุดููุฉ ูุน Puppet ูู ุฃู ุงููุถูู ุงูุฑุฆูุณู ูุงู ุนููู ุงูุขู ูุนุฑูุฉ ุฌููุน ุงููุถูููู ูุงูุฎุฏูุงุช / ุงูุงุฎุชุจุงุฑุงุช ูู ุงููุธุงู ูุงุถุทุฑ ุฅูู ุชูุฒูุนูุง ุจูู ุงูููุงุทู (dev-test ุ staging-prod ุ ext) ุ ูููู ุฅุฑุณุงู ุงูุชุบููุฑุงุช ูู ุฎูุงู Icinga API ูุณุชุบุฑู ุจุถุน ุซูุงูู ุ ููู ุชุฌููุน ุฏููู Puppet ูุฌููุน ุงูุฎุฏูุงุช ูุฌููุน ุงููุถูููู ูุณุชุบุฑู ุจุถุน ุฏูุงุฆู.  ูุฐุง ูุง ูุฒุงู ูููููู ุ ุฑุบู ุฃููู ุดุฑุญุช ุจุงููุนู ุนุฏุฉ ูุฑุงุช ููู ูุนูู ูู ุดูุก ูููุงุฐุง ูุณุชุบุฑู ูู ูุฐุง ุงูููุช ุงูุทููู. </p><br><p style=";text-align:right;direction:rtl">  ุซุงูุซูุง - ูุฌููุนุฉ ูู SnowFlakes (ุฑูุงูุงุช ุงูุซูุฌ) - ุงูุฃุดูุงุก ุงูุชู ุชู ุฅุฎุฑุงุฌูุง ูู ุงููุธุงู ุงูุนุงู ุ ูุธุฑูุง ููุฌูุฏ ุดูุก ุฎุงุต ุจูุง ุ ูุจุงูุชุงูู ูุฅู ุงูููุงุนุฏ ุงูุนุงูุฉ ูุง ุชูุทุจู ุนูููุง.  ููุฏ ุชูุฑุฑ ุฐูู ูู ุฎูุงู ูุฌูู ุฃูุงูู - ุฅุฐุง ูุงู ููุงู ุฅูุฐุงุฑ ุ ูููู ูู ุงูุญูููุฉ ูู ุดูุก ุนูู ูุง ูุฑุงู ุ ูุฃูุช ููุง ุจุญุงุฌุฉ ุฅูู ุญูุฑ ุฃุนูู ูููู ููุงุฐุง ููุจููู ุ ุนูู ุงูุฑุบู ูู ุฃูู ูุง ููุจุบู.  ุฃู ุงูุนูุณ - ููุงุฐุง ูุดุนุฑ Nagios ุจุงูุฐุนุฑ ุ ููู Icinga ููุณ ูุฐูู. </p><br><p style=";text-align:right;direction:rtl">  ุฑุงุจุนูุง - ุนูู ูุงุฌููุณ ููุง ููุฏุฉ ุซูุงุซ ุณููุงุช ุ ููู ุงูุจุฏุงูุฉ ูุงู ููุงู ุซูุฉ ุฃูุจุฑ ููู ูู ูุธุงู ูุญุจ ุฌุฏูุฏ ุ ูุฐูู ูู ูู ูุฑุฉ ุฃุซุงุฑ ุฅูุณููุบุง ุญุงูุฉ ูู ุงูุฐุนุฑ - ูู ููุนู ุฃุญุฏ ุฃู ุดูุก ุญุชู ุฃุตุจุญ ูุงุบููุณ ูุชุญูุณูุง ูููุณ ุงููุดููุฉ.  ูููู ูุงุฏุฑูุง ูุง ุฃุตุฏุฑุช Icinga ุฅูุฐุงุฑุงุช ุญููููุฉ ูู ููุช ุณุงุจู ูู Nagios ุ ูุฃุนุชูุฏ ุฃู ูุฐุง ุฏุนุงูุฉ ุฎุทูุฑุฉ ุ ูุงูุชู ุณุฃูุงูุดูุง ูู ูุณู "ุงูุงุณุชูุชุงุฌุงุช". </p><br><p style=";text-align:right;direction:rtl">  ููุชูุฌุฉ ูุฐูู ุ ุชุฃุฎุฑ ุงูุชุดุบูู ูุฃูุซุฑ ูู 5 ุฃุดูุฑ (ุชู ุงูุชุฎุทูุท ูู ูู 28 ููููู 2018 ุ ูู ุงููุงูุน - 3 ุฏูุณูุจุฑ 2018) ุ ููุนุฒู ุฐูู ุจุดูู ุฑุฆูุณู ุฅูู "ุงูุชุญูู ูู ุงูุชูุงูุค" - ูุฐุง ูุฑุงุก ุนูุฏูุง ุชูุฌุฏ ุนุฏุฉ ุฎุฏูุงุช ูู Nagios ูุง ุฃุญุฏ ูุชุญุฏุซ ุนููุง ูู ุฃุณูุน ุฃู ุดูุก ุนูู ูุฏุงุฑ ุงูุนุงููู ุงููุงุถููู ุ ูููู ุงูุขู ุฃุตุฏุฑูุง ูุนูุฉ ููุฏูุฉ ุจุฏูู ุณุจุจ ูุงุถุทุฑุฑุช ุฅูู ุชูุถูุญ ุณุจุจ ุนุฏู ูุฌูุฏูู ูู ููุญุฉ ุจูุฏู ูุงุถุทุฑุฑุช ูุฅุถุงูุชูุง ุฅูู Icinga ุฅูู "ุชูุงูุค ุงูุชุญูู" (ุฌููุน ุงูุฎุฏูุงุช / ุงูุดููุงุช ูุงููุฉ) ูู Nagios ุชุชูุงูู ูุน ุงูุฎุฏูุงุช / ุงูุดููุงุช ูู Icinga) </p><br><p style=";text-align:right;direction:rtl">  ุงูุชูููุฐ: <br>  ุงูุฃูู ูู ุงูุญุฑุจ ุนูู ุงูููุฏ ููุงุจู ุงูุจูุงูุงุช ุ ูุซู Puppet Style.  ุฌููุน ุงูุจูุงูุงุช ุ ููุง ูู ุดูุก ุจุดูู ุนุงู ุ ูุฌุจ ุฃู ุชููู ูู ูููุฑุง ููุง ุดูุก ุบูุฑ ุฐูู.  ูู ุฑูุฒ ูู ูููุงุช .pp.  ุงููุชุบูุฑุงุช ุ ุงูุชุฌุฑูุฏ ุ ุงูุฏูุงู - ูู ุดูุก ูุณูุฑ ุจุดูู pp. <br>  ูุชูุฌุฉ ูุฐูู ุ ูุฏููุง ูุฌููุนุฉ ูู ุงูุฃุฌูุฒุฉ ุงูุงูุชุฑุงุถูุฉ (165 ููุช ูุชุงุจุฉ ูุฐุง ุงูุชูุฑูุฑ) ู 68 ุชุทุจูููุง ุนูู ุงูููุจ ูุญุชุงุฌูู ุฅูู ูุฑุงูุจุชูุง ูู ุฃุฌู ุตุญุฉ ูุตูุงุญูุฉ ุดูุงุฏุงุช ุทุจูุฉ ุงูููุงุจุณ ุงูุขููุฉ.  ูููู ุจุณุจุจ ุงูุจูุงุณูุฑ ุงูุชุงุฑูุฎูุฉ ุ ูุชู ุงูุญุตูู ุนูู ูุนูููุงุช ุชุทุจููุงุช ุงููุฑุงูุจุฉ ูู ูุณุชูุฏุน gitlab ูููุตู ููู ูุชุบูุฑ ุชูุณูู ุงูุจูุงูุงุช ููุฐ Puppet 3 ุ ููุง ูุฎูู ุตุนูุจุงุช ุชูููู ุฅุถุงููุฉ. </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ููุฏ ุงูุนุฑุงุฆุณ ููุชุทุจููุงุช ุ ุงุญุฐุฑ</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs">define profiles::services::monitoring::docker_apps( Hash $app_list, Hash $apps_accessible_from, Hash $apps_access_list, Hash $webhost_defaults, Hash $webcheck_defaults, Hash $service_overrides, Hash $targets, Hash $app_checks, ) { #### APPS #### $zone = $name $app_list.each | String $app_name, Hash $app_data | { $notify_group = { 'notify_group' =&gt; ($webcheck_defaults[$zone]['notify_group'] + pick($app_data['notify_group'], {} )) } # adds notifications for default group (systems) + any group defined in int/pm_docker_apps.eyaml $data = merge($webhost_defaults, $apps_accessible_from, $app_data) $site_domain = $app_data['site_domain'] $regexp = pick($app_data['check_regex'], 'html') # Pick a regex to check $check_url = $app_data['check_url'] ? { undef =&gt; { 'http_uri' =&gt; '/' }, default =&gt; { 'http_uri' =&gt; $app_data['check_url'] } } $check_regex = $regexp ?{ 'absent' =&gt; {}, default =&gt; {'http_expect_body_regex' =&gt; $regexp} } $site_domain.each | String $vhost, Hash $vdata | { # Split an app by domains if there are two or more $vhost_name = {'http_vhost' =&gt; $vhost} $vars = $data['vars'] + $vhost_name + $check_regex + $check_url $web_ipaddress = is_array($vdata['web_ipaddress']) ? { # Make IP-address an array if it's not, because askizzy has 2 ips and it's an array true =&gt; $vdata['web_ipaddress'], false =&gt; [$vdata['web_ipaddress']], } $access_from_zones = [$zone] + $apps_access_list[$data['accessible_from']] # Merge default zone (where the app is defined) and extra zones if they exist $web_ipaddress.each | String $ip_address | { # For each IP (if we have multiple) $suffix = length($web_ipaddress) ? { # If we have more than one - add IP as a suffix to this hostname to avoid duplicating resources 1 =&gt; '', default =&gt; "_${ip_address}" } $octets = split($ip_address, '\.') $ip_tag = "${octets[2]}.${octets[3]}" # Using last octet only causes a collision between nginx-vip 203.15.70.94 and ext. ip 49.255.194.94 $access_from_zones.each | $zone_prefix |{ $zone_target = $targets[$zone_prefix] $nginx_vip_name = "${zone_prefix}_nginx-vip-${ip_tag}" # If it's a host for ext - prefix becomes 'ext_' (ext_nginx-vip...) $nginx_host_vip = { $nginx_vip_name =&gt; { ensure =&gt; present, target =&gt; $zone_target, address =&gt; $ip_address, check_command =&gt; 'hostalive', groups =&gt; ['nginx_vip',], } } $ssl_vars = $app_checks['ssl'] $regex_vars = $app_checks['http'] + $vars + $webcheck_defaults[$zone] + $notify_group if !defined( Profiles::Services::Monitoring::Host[$nginx_vip_name] ) { ensure_resources('profiles::services::monitoring::host', $nginx_host_vip) } if !defined( Icinga2::Object::Service["${nginx_vip_name}_ssl"] ) { icinga2::object::service {"${nginx_vip_name}_ssl": ensure =&gt; $data['ensure'], assign =&gt; ["host.name == $nginx_vip_name",], groups =&gt; ['webchecks',], check_command =&gt; 'ssl', check_interval =&gt; $service_overrides['ssl']['check_interval'], target =&gt; $targets['services'], apply =&gt; true, vars =&gt; $ssl_vars } } if $regexp != 'absent'{ if !defined(Icinga2::Object::Service["${vhost}${$suffix} regex"]){ icinga2::object::service {"${vhost}${$suffix} regex": ensure =&gt; $data['ensure'], assign =&gt; ["match(*_nginx-vip-${ip_tag}, host.name)",], groups =&gt; ['webchecks',], check_command =&gt; 'http', check_interval =&gt; $service_overrides['regex']['check_interval'], target =&gt; $targets['services'], enable_flapping =&gt; true, apply =&gt; true, vars =&gt; $regex_vars } } } } } } } }</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ูุจุฏู ุฃูุถูุง ุฑูุฒ ุชููุฆุฉ ุงููุถูู ูุงูุฎุฏูุฉ: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ูุฑุงูุจุฉ / config.pp</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">class profiles::services::monitoring::config( Array $default_config, Array $hostgroups, Hash $hosts = {}, Hash $host_defaults, Hash $services, Hash $service_defaults, Hash $service_overrides, Hash $webcheck_defaults, Hash $servicegroups, String $servicegroup_target, Hash $user_defaults, Hash $users, Hash $oncall, Hash $usergroup_defaults, Hash $usergroups, Hash $notifications, Hash $notification_defaults, Hash $notification_commands, Hash $timeperiods, Hash $webhost_defaults, Hash $apps_access_list, Hash $check_commands, Hash $hosts_api = {}, Hash $targets = {}, Hash $host_api_defaults = {}, ) { # Profiles::Services::Monitoring::Hostgroup &lt;&lt;| |&gt;&gt; # will be enabled when we move to icinga completely #### APPS #### case $location { 'int', 'ext': { $apps_by_zone = {} } 'pm': { $int_apps = hiera('int_docker_apps') $int_app_defaults = hiera('int_docker_app_common') $st_apps = hiera('staging_docker_apps') $srs_apps = hiera('pm_docker_apps_srs') $pm_apps = hiera('pm_docker_apps') + $st_apps + $srs_apps $pm_app_defaults = hiera('pm_docker_app_common') $apps_by_zone = { 'int' =&gt; $int_apps, 'pm' =&gt; $pm_apps, } $app_access_by_zone = { 'int' =&gt; {'accessible_from' =&gt; $int_app_defaults['accessible_from']}, 'pm' =&gt; {'accessible_from' =&gt; $pm_app_defaults['accessible_from']}, } } default: { fail('Please ensure the node has $location fact set (int, pm, ext)') } } file { '/etc/icinga2/conf.d/': ensure =&gt; directory, recurse =&gt; true, purge =&gt; true, owner =&gt; 'icinga', group =&gt; 'icinga', mode =&gt; '0750', notify =&gt; Service['icinga2'], } $default_config.each | String $file_name |{ file {"/etc/icinga2/conf.d/${file_name}": ensure =&gt; present, source =&gt; "puppet:///modules/profiles/services/monitoring/default_config/${file_name}", owner =&gt; 'icinga', group =&gt; 'icinga', mode =&gt; '0640', } } $app_checks = { 'ssl' =&gt; $services['webchecks']['checks']['ssl']['vars'], 'http' =&gt; $services['webchecks']['checks']['http_regexp']['vars'] } $apps_by_zone.each | String $zone, Hash $app_list | { profiles::services::monitoring::docker_apps{$zone: app_list =&gt; $app_list, apps_accessible_from =&gt; $app_access_by_zone[$zone], apps_access_list =&gt; $apps_access_list, webhost_defaults =&gt; $webhost_defaults, webcheck_defaults =&gt; $webcheck_defaults, service_overrides =&gt; $service_overrides, targets =&gt; $targets, app_checks =&gt; $app_checks, } } #### HOSTS #### # Profiles::Services::Monitoring::Host &lt;&lt;| |&gt;&gt; # This is for spaceship invasion when it's ready. $hosts_has_large_disks = query_nodes('mountpoints.*.size_bytes &gt;= 1099511627776') $hosts.each | String $hostgroup, Hash $list_of_hosts_with_settings | { # Splitting site lists by hostgroups - docker_host/gluster_host/etc $list_of_hosts_in_group = $list_of_hosts_with_settings['hosts'] $hostgroup_settings = $list_of_hosts_with_settings['settings'] $merged_hostgroup_settings = deep_merge($host_defaults, $list_of_hosts_with_settings['settings']) $list_of_hosts_in_group.each | String $host_name, Hash $host_settings |{ # Splitting grouplists by hosts # Is this host in the array $hosts_has_large_disks ? If so set host.vars.has_large_disks if ( $hosts_has_large_disks.reduce(false) | $found, $value| { ( $value =~ "^${host_name}" ) or $found } ) { $vars_has_large_disks = { 'has_large_disks' =&gt; true } } else { $vars_has_large_disks = {} } $host_data = deep_merge($merged_hostgroup_settings, $host_settings) $hostgroup_settings_vars = pick($hostgroup_settings['vars'], {}) $host_settings_vars = pick($host_settings['vars'], {}) $host_notify_group = delete_undef_values($host_defaults['vars']['notify_group'] + $hostgroup_settings_vars['notify_group'] + $host_settings_vars['notify_group']) $host_data_vars = delete_undef_values(deep_merge($host_data['vars'] , {'notify_group' =&gt; $host_notify_group}, $vars_has_large_disks)) # Merging vars separately $hostgroups = delete_undef_values([$hostgroup] + $host_data['groups']) profiles::services::monitoring::host{$host_name: ensure =&gt; $host_data['ensure'], display_name =&gt; $host_data['display_name'], address =&gt; $host_data['address'], groups =&gt; $hostgroups, target =&gt; $host_data['target'], check_command =&gt; $host_data['check_command'], check_interval =&gt; $host_data['check_interval'], max_check_attempts =&gt; $host_data['max_check_attempts'], vars =&gt; $host_data_vars, template =&gt; $host_data['template'], } } } if !empty($hosts_api){ # All hosts managed by API $hosts_api.each | String $zone, Hash $hosts_api_zone | { # Split api hosts by zones $hosts_api_zone.each | String $hostgroup, Hash $list_of_hosts_with_settings | { # Splitting site lists by hostgroups - docker_host/gluster_host/etc $list_of_hosts_in_group = $list_of_hosts_with_settings['hosts'] $hostgroup_settings = $list_of_hosts_with_settings['settings'] $merged_hostgroup_settings = deep_merge($host_api_defaults, $list_of_hosts_with_settings['settings']) $list_of_hosts_in_group.each | String $host_name, Hash $host_settings |{ # Splitting grouplists by hosts # Is this host in the array $hosts_has_large_disks ? If so set host.vars.has_large_disks if ( $hosts_has_large_disks.reduce(false) | $found, $value| { ( $value =~ "^${host_name}" ) or $found } ) { $vars_has_large_disks = { 'has_large_disks' =&gt; true } } else { $vars_has_large_disks = {} } $host_data = deep_merge($merged_hostgroup_settings, $host_settings) $hostgroup_settings_vars = pick($hostgroup_settings['vars'], {}) $host_settings_vars = pick($host_settings['vars'], {}) $host_api_notify_group = delete_undef_values($host_defaults['vars']['notify_group'] + $hostgroup_settings_vars['notify_group'] + $host_settings_vars['notify_group']) $host_data_vars = delete_undef_values(deep_merge($host_data['vars'] , {'notify_group' =&gt; $host_api_notify_group}, $vars_has_large_disks)) $hostgroups = delete_undef_values([$hostgroup] + $host_data['groups']) if defined(Profiles::Services::Monitoring::Host[$host_name]){ $hostname = "${host_name}_from_${zone}" } else { $hostname = $host_name } profiles::services::monitoring::host{$hostname: ensure =&gt; $host_data['ensure'], display_name =&gt; $host_data['display_name'], address =&gt; $host_data['address'], groups =&gt; $hostgroups, target =&gt; "${host_data['target_base']}/${zone}/hosts.conf", check_command =&gt; $host_data['check_command'], check_interval =&gt; $host_data['check_interval'], max_check_attempts =&gt; $host_data['max_check_attempts'], vars =&gt; $host_data_vars, template =&gt; $host_data['template'], } } } } } #### END OF HOSTS #### #### SERVICES #### $services.each | String $service_group, Hash $s_list |{ # Service_group and list of services in that group $service_list = $s_list['checks'] # List of actual checks, separately from SG settings $service_list.each | String $service_name, Hash $data |{ $merged_defaults = merge($service_defaults, $s_list['settings']) # global service defaults + service group defaults $merged_data = merge($merged_defaults, $data) $settings_vars = pick($s_list['settings']['vars'], {}) $this_service_vars = pick($data['vars'], {}) $all_service_vars = delete_undef_values($service_defaults['vars'] + $settings_vars + $this_service_vars) # If we override default check_timeout, but not nrpe_timeout, make nrpe_timeout the same as check_timeout if ( $merged_data['check_timeout'] and ! $this_service_vars['nrpe_timeout'] ) { # NB: Icinga will convert 1m to 60 automatically! $nrpe = { 'nrpe_timeout' =&gt; $merged_data['check_timeout'] } } else { $nrpe = {} } # By default we use nrpe and all commands are run via nrpe. So vars.nrpe_command = $service_name is a default value # If it's server-side Icinga command - we don't need 'nrpe_command' # but there is no harm to have that var and the code is shorter if $merged_data['check_command'] == 'nrpe'{ $check_command = $merged_data['vars']['nrpe_command'] ? { undef =&gt; { 'nrpe_command' =&gt; $service_name }, default =&gt; { 'nrpe_command' =&gt; $merged_data['vars']['nrpe_command'] } } }else{ $check_command = {} } # Assembling $vars from Global Default service settings, servicegroup settings, this particular check settings and let's not forget nrpe settings. if $all_service_vars['graphite_template'] { $graphite_template = {'check_command' =&gt; $all_service_vars['graphite_template']} }else{ $graphite_template = {'check_command' =&gt; $service_name} } $service_notify = [] + pick($settings_vars['notify_group'], []) + pick($this_service_vars['notify_group'], []) # pick is required everywhere, otherwise becomes "The value '' cannot be converted to Numeric" $service_notify_group = $service_notify ? { [] =&gt; $service_defaults['vars']['notify_group'], default =&gt; $service_notify } # Assing default group (systems) if no other groups are defined $vars = $all_service_vars + $nrpe + $check_command + $graphite_template + {'notify_group' =&gt; $service_notify_group} # This needs to be merged separately, because merging it as part of MERGED_DATA overwrites arrays instead of merging them, so we lose some "assign" and "ignore" values $assign = delete_undef_values($service_defaults['assign'] + $s_list['settings']['assign'] + $data['assign']) $ignore = delete_undef_values($service_defaults['ignore'] + $s_list['settings']['ignore'] + $data['ignore']) icinga2::object::service {$service_name: ensure =&gt; $merged_data['ensure'], apply =&gt; $merged_data['apply'], enable_flapping =&gt; $merged_data['enable_flapping'], assign =&gt; $assign, ignore =&gt; $ignore, groups =&gt; [$service_group], check_command =&gt; $merged_data['check_command'], check_interval =&gt; $merged_data['check_interval'], check_timeout =&gt; $merged_data['check_timeout'], check_period =&gt; $merged_data['check_period'], display_name =&gt; $merged_data['display_name'], event_command =&gt; $merged_data['event_command'], retry_interval =&gt; $merged_data['retry_interval'], max_check_attempts =&gt; $merged_data['max_check_attempts'], target =&gt; $merged_data['target'], vars =&gt; $vars, template =&gt; $merged_data['template'], } } } #### END OF SERVICES #### #### OTHER BORING STUFF #### $servicegroups.each | $servicegroup, $description |{ icinga2::object::servicegroup{ $servicegroup: target =&gt; $servicegroup_target, display_name =&gt; $description } } $hostgroups.each| String $hostgroup |{ profiles::services::monitoring::hostgroup { $hostgroup:} } $notifications.each | String $name, Hash $settings |{ $assign = pick($notification_defaults['assign'], []) + $settings['assign'] $ignore = pick($notification_defaults['ignore'], []) + $settings['ignore'] $merged_settings = $settings + $notification_defaults icinga2::object::notification{$name: target =&gt; $merged_settings['target'], apply =&gt; $merged_settings['apply'], apply_target =&gt; $merged_settings['apply_target'], command =&gt; $merged_settings['command'], interval =&gt; $merged_settings['interval'], states =&gt; $merged_settings['states'], types =&gt; $merged_settings['types'], assign =&gt; delete_undef_values($assign), ignore =&gt; delete_undef_values($ignore), user_groups =&gt; $merged_settings['user_groups'], period =&gt; $merged_settings['period'], vars =&gt; $merged_settings['vars'], } } # Merging notification settings for users with other settings $users_oncall = deep_merge($users, $oncall) # Magic. Do not touch. create_resources('icinga2::object::user', $users_oncall, $user_defaults) create_resources('icinga2::object::usergroup', $usergroups, $usergroup_defaults) create_resources('icinga2::object::timeperiod',$timeperiods) create_resources('icinga2::object::checkcommand', $check_commands) create_resources('icinga2::object::notificationcommand', $notification_commands) profiles::services::sudoers { 'icinga_runs_ping_l2': ensure =&gt; present, sudoersd_template =&gt; 'profiles/os/redhat/centos7/sudoers/icinga.erb', } }</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุฃูุง ูุง ุฃุฒุงู ุฃุนูู ุนูู ูุฐู ุงููุนูุฑููุฉ ูุชุญุณูููุง ูููุง ุฃููู ุฐูู.  ููุน ุฐูู ุ ูุงู ูุฐุง ุงูููุฏ ูู ุงูุฐู ุฌุนู ูู ุงููููู ุงุณุชุฎุฏุงู ุจูุงุก ุฌููุฉ ุจุณูุท ููุงุถุญ ูู ูููุฑุง: </p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ุงูุจูุงูุงุช</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">profiles::services::monitoring::config::services: perf_checks: settings: check_interval: '2m' assign: - 'host.vars.type == linux' checks: procs: {} load: {} memory: {} disk: check_interval: '5m' vars: notification_period: '24x7' disk_iops: vars: notifications: - 'silent' cpu: vars: notifications: - 'silent' dns_fqdn: check_interval: '15m' ignore: - 'xenserver in host.groups' vars: notifications: - 'silent' iftraffic_nrpe: vars: notifications: - 'silent' logging: settings: assign: - 'logserver in host.groups' checks: rsyslog: {} nginx_limit_req_other: {} nginx_limit_req_s2s: {} nginx_limit_req_s2x: {} nginx_limit_req_srs: {} logstash: {} logstash_api: vars: notifications: - 'silent'</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  ุชููุณู ุฌููุน ุนูููุงุช ุงูุชุญูู ุฅูู ูุฌููุนุงุช ุ ูููู ูุฌููุนุฉ ุฅุนุฏุงุฏุงุช ุงูุชุฑุงุถูุฉ ูุซู ููุงู ูุนุฏุฏ ูุฑุงุช ุชุดุบูู ูุฐู ุงูุดููุงุช ุ ูุงูุฅุดุนุงุฑุงุช ุงููุฑุณูุฉ ูุฅุฑุณุงููุง ุฅูู ูู. </p><br><p style=";text-align:right;direction:rtl">  ูู ูู ุนูููุฉ ุชุฏููู ุ ููููู ุชุฌุงูุฒ ุฃู ุฎูุงุฑ ุ ููุถูู ูู ูุฐุง ูู ุงูููุงูุฉ ุฅูู ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ูุฌููุน ุนูููุงุช ุงูุชุญูู ููู.  ูุฐูู ุ ุชุชู ูุชุงุจุฉ ูุซู ูุฐู ุงููุนูุฑููุฉ ูู config.pp - ููุงู ุฏูุฌ ูุฌููุน ุงูุฅุนุฏุงุฏุงุช ุงูุงูุชุฑุงุถูุฉ ูุน ุฅุนุฏุงุฏุงุช ุงููุฌููุนุงุช ุซู ูุน ูู ุชุญูู ูุฑุฏู. </p><br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ูุงู ุงูุชุบููุฑ ุงูููู ููุบุงูุฉ ูู ุงููุฏุฑุฉ ุนูู ุงุณุชุฎุฏุงู ุงููุธุงุฆู ูู ุงูุฅุนุฏุงุฏุงุช ุ ุนูู ุณุจูู ุงููุซุงู ุ ูุธููุฉ ุชุบููุฑ ุงููููุฐ ูุงูุนููุงู ูุนููุงู url ููุชุญูู ูู http_regex. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">http_regexp: assign: - 'host.vars.http_regex' - 'static_sites in host.groups' check_command: 'http' check_interval: '1m' retry_interval: '20s' max_check_attempts: 6 http_port: '{{ if(host.vars.http_port) { return host.vars.http_port } else { return 443 } }}' vars: notification_period: 'host.vars.notification_period' http_vhost: '{{ if(host.vars.http_vhost) { return host.vars.http_vhost } else { return host.name } }}' http_ssl: '{{ if(host.vars.http_ssl) { return false } else { return true } }}' http_expect_body_regex: 'host.vars.http_regex' http_uri: '{{ if(host.vars.http_uri) { return host.vars.http_uri } else { return "/" } }}' http_onredirect: 'follow' http_warn_time: 8 http_critical_time: 15 http_timeout: 30 http_sni: true</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐุง ูุนูู - ุฅุฐุง ูุงู ููุงู ูุชุบูุฑ <em>http_port</em> ูู <em>ุชุนุฑูู</em> ุงููุถูู - ุงุณุชุฎุฏุงูู ุ ูุฅูุง 443. ุนูู ุณุจูู ุงููุซุงู ุ ูุชู ุชุนููู ูุงุฌูุฉ ุงูููุจ jabber ุนูู 9090 ุ ู Unifi ุนูู 7443. <br>  <em>http_vhost</em> ูุนูู ุชุฌุงูู DNS ูุงุชุฎุงุฐ ูุฐุง ุงูุนููุงู. <br>  ุฅุฐุง ุชู ุชุญุฏูุฏ uri ูู ุงููุถูู ุ ูุงุณุชูุฑ ูู ุฐูู ุ ูุฅูุง ุฎุฐ "/". </p><br><p style=";text-align:right;direction:rtl">  ุธูุฑุช ูุตุฉ ูุถุญูุฉ ูุน http_ssl - ูุฐู ุงูุฅุตุงุจุฉ ูู ุชุฑุบุจ ูู ูุทุน ุงูุงุชุตุงู ุนูุฏ ุงูุทูุจ.  ููุฏ ุชุนุซุฑุช ุจุบุจุงุก ุนูู ูุฐุง ุงูุฎุท ููุชุฑุฉ ุทูููุฉ ุ ุญุชู ุงุชุถุญ ูู ุฃูู ูุงู ููุงู ูุชุบูุฑ ูู ุชุนุฑูู ุงููุถูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">http_ssl: false</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุจุฏุงุฆู ูู ุงูุชุนุจูุฑ </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">if(host.vars.http_ssl) { return false } else { return true }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง <strong>ุฎุทุฃ</strong> ููู ุงูููุงูุฉ ุงุชุถุญ </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">if(false) { return false } else { return true }</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุฐุง ูุนูู ุฃู ูุญุต SSL ูุดุท โโุฏุงุฆููุง.  ููุฏ ุชูุฑุฑ ุนู ุทุฑูู ุงุณุชุจุฏุงู ุจูุงุก ุงูุฌููุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">http_ssl: no</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ุงูุงุณุชูุชุงุฌุงุช</strong> : </p><br><p style=";text-align:right;direction:rtl">  ุงูุงูุฌุงุจูุงุช: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุฏููุง ุงูุขู ูุธุงู ูุฑุงูุจุฉ ูุงุญุฏ ุ ูููุณ ูุธุงูุงู ุ ููุง ูุงู ุงูุญุงู ูู ุขุฎุฑ 7-8 ุฃุดูุฑ ุ ุฃู ูุธุงู ูุงุญุฏ ุนูุง ุนููู ุงูุฒูู ูุถุนูู. </li><li style=";text-align:right;direction:rtl">  ุฃุตุจุญุช ุจููุฉ ุจูุงูุงุช ุงููุถูููู / ุงูุฎุฏูุงุช (ุงูุดููุงุช) ุงูุขู (ูู ุฑุฃูู) ุฃูุซุฑ ูุงุจููุฉ ูููุฑุงุกุฉ ูููููุง.  ุจุงููุณุจุฉ ููุขุฎุฑูู ุ ูู ููู ูุฐุง ูุงุถุญูุง ุ ูุฐุง ุงุถุทุฑุฑุช ุฅูู ูุต ุตูุญุชูู ุนูู ุงููููู ุงููุญูู ูุดุฑุญ ููููุฉ ุนููู ูููุงู ุชุญุฑูุฑู. </li><li style=";text-align:right;direction:rtl">  ูู ุงููููู ุชูููู ุงูุดููุงุช ุจูุฑููุฉ ุจุงุณุชุฎุฏุงู ุงููุชุบูุฑุงุช ูุงููุธุงุฆู ุ ุนูู ุณุจูู ุงููุซุงู ุ ููุชุญูู ูู http_regexp ุ ูููู ุชุนููู ุงูููุท ุงููุฑุบูุจ ุ ุฑูุฒ ุงูุฅุฑุฌุงุน ุ ุนููุงู url ูุงููููุฐ ูู ุฅุนุฏุงุฏุงุช ุงููุถูู. </li><li style=";text-align:right;direction:rtl">  ููุงู ุงูุนุฏูุฏ ูู ููุญุงุช ุงููุนูููุงุช ุ ููู ูููุง ููููู ุชุญุฏูุฏ ุงููุงุฆูุฉ ุงูุฎุงุตุฉ ุจู ูู ุฃุฌูุฒุฉ ุงูุฅูุฐุงุฑ ุงููุนุฑูุถุฉ ูุฅุฏุงุฑุฉ ูู ูุฐุง ูู ุฎูุงู Puppet ูุฏูุฌ ุงูุทูุจุงุช. </li></ul><br><p style=";text-align:right;direction:rtl">  ุณูุจูุงุช: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงููุตูุฑ ุงูุฐุงุชู ูุฃุนุถุงุก ุงููุฑูู - ุนููุช Nagios ูุนููุช ูุนููุช ุ ููุฐุง Isinga ุงูุฎุงุต ุจู ุงูุฎูู ุจุงุณุชูุฑุงุฑ ููุจุทุฆ.  ูููู ูููููู ุฑุคูุฉ ุงููุตุฉุ  ููุนูู ุ ูู ูุชู ุชุญุฏูุซู ... (ุงููุดููุฉ ุงูุญููููุฉ ูู ุฃู ุณุฌู ุงูุฅูุฐุงุฑ ูุง ูุชู ุชุญุฏูุซู ุชููุงุฆููุง ุ ููุท ุจูุงุณุทุฉ F5) </li><li style=";text-align:right;direction:rtl">  ุฎููู ุงููุธุงู - ุนูุฏูุง ุฃููู ุจุงูููุฑ ููู "ุชุญูู ุงูุขู" ูู ูุงุฌูุฉ ุงูููุจ - ุชุนุชูุฏ ูุชูุฌุฉ ุงูุชูููุฐ ุนูู ุญุงูุฉ ุงูุทูุณ ุนูู ุงููุฑูุฎ ุ ูุง ุณููุง ุนูู ุงูุฎุฏูุงุช ุงููุนูุฏุฉ ุงูุชู ุชุณุชุบุฑู ุนุดุฑุงุช ุงูุซูุงูู.  ูุชูุฌุฉ ููุงุซูุฉ ูู ุดูุก ุทุจูุนู. <img src="https://habrastorage.org/webt/ue/73/wa/ue73wa4yt4bhedebd1n66kizsf8.jpeg"></li><li style=";text-align:right;direction:rtl">  ุจุดูู ุนุงู ุ ููููุง ููุฅุญุตุงุฆูุงุช ูุตู ุงูุณูููุฉ ููุธุงููู ูุนููุงู ุฌูุจูุง ุฅูู ุฌูุจ ุ ูุงู Nagios ูุนูู ุฏุงุฆููุง ุจุดูู ุฃุณุฑุน ูู Icinga ููุฏ ุฃุฒุนุฌูู ุญููุง.  ูุจุฏู ูู ุฃู ููุงู ุดูุฆูุง ูุฎุฏูุนูุง ุจุฃุฌูุฒุฉ ุถุจุท ุงูููุช ูุฃู ุงููุญุต ููุฏุฉ ุฎูุณ ุฏูุงุฆู ููุญูููุฉ ูุฐูุจ ูู 5:30 ุฃู ุดูุก ูู ูุฐุง ุงููุจูู. </li><li style=";text-align:right;direction:rtl">  ุฅุฐุง ููุช ุจุฅุนุงุฏุฉ ุชุดุบูู ุงูุฎุฏูุฉ ูู ุฃู ููุช (systemctl restart icinga2) - ูุฅู ุฌููุน ุนูููุงุช ุงููุญุต ุงูุชู ูุงูุช ููุฏ ุงูุชูููุฐ ูู ุฐูู ุงูููุช ุณุชุทูู ุฅูุฐุงุฑูุง ูุงููุง &lt;ุฅููุงุก ุจุงูุฅุดุงุฑุฉ 15&gt; ุนูู ุงูุดุงุดุฉ ููู ุงูุฌุงูุจ ุณุชุจุฏู ููุง ูู ุฃู ูู ุดูุก ูุฏ ุงูุฎูุถ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฎุทุฃ ุฃููุฏ</a> ) </li></ul><br><p style=";text-align:right;direction:rtl">  ูููู ุจุดูู ุนุงู - ูุงู ูุนูู. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar444060/">https://habr.com/ru/post/ar444060/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar444048/index.html">ูุตุงุฆุญ ูุญูู ุงูุทุจ ุงูุดุฑุนู ุงูุฑููู: ููููุฉ ุงูุชุดุงู ุชุบููุฑุงุช ูู ุณูุงุณุฉ ุงููุฌููุนุฉ ูุญุฑููุง ุงูุฏุฎูุงุก</a></li>
<li><a href="../ar444050/index.html">ููุงูุดุฉ: ูู ูุตุจุญ ุชุฎุฒูู ุงูุญูุถ ุงููููู ูุงุฆููุงุ</a></li>
<li><a href="../ar444052/index.html">ููู ูุจุญุซ ูู IntelliJ IDEA ุนู ุชุนุจูุฑุงุช lambda</a></li>
<li><a href="../ar444056/index.html">ุฒุงุฏ ูุฒูุฏู ุงูุฅูุชุฑูุช ูู ุงููุฑู ุฒูุงุฏุฉ ุญุงุฏุฉ ูู ุฃุณุนุงุฑ ุงูุฎุฏูุงุช</a></li>
<li><a href="../ar444058/index.html">ุนูุฏูุง ูููู ุงูุฃุทูุงู ุฃู ุญูุงุชูู ูููุง ุฃุตุจุญุช ูุชุตูุฉ ุจุงูุฅูุชุฑูุช ุจุงููุนู</a></li>
<li><a href="../ar444062/index.html">ุชุถูุก! ุงูุชุญููุงุช ุงูููููุฉ ูู ูุฑูุฒ ูุฎุชุง</a></li>
<li><a href="../ar444064/index.html">ุฃููุงุฑ ุฌุฏูุฏุฉ ููุณุชูุจู ุฌุฏูุฏ</a></li>
<li><a href="../ar444068/index.html">ูู ูุฑุงูุจุ</a></li>
<li><a href="../ar444070/index.html">ุชุทููุฑ hexapod ูู ุงูุตูุฑ (ุงูุฌุฒุก 4) - ูุณุงุฑุงุช ุงูุฑูุงุถูุงุช ูุชุณูุณูุงุช</a></li>
<li><a href="../ar444072/index.html">Android Shopping - ุงูุนุจ ููุชุจุฉ ุงูููุงุชูุฑ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>