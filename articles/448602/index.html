<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§öüèº üÖæÔ∏è üîü ¬øEl monitoreo est√° muerto? - Larga vida al monitoreo üê§ üòà ü§±</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Desde 2008, nuestra empresa se ha dedicado principalmente a la gesti√≥n de infraestructura y al soporte t√©cnico las 24 horas para proyectos web: tenemo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¬øEl monitoreo est√° muerto? - Larga vida al monitoreo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/448602/"><img src="https://habrastorage.org/webt/rb/6a/wf/rb6awfy_oiasqde7kja4h39oczm.jpeg"><br><br>  Desde 2008, nuestra empresa se ha dedicado principalmente a la gesti√≥n de infraestructura y al soporte t√©cnico las 24 horas para proyectos web: tenemos m√°s de 400 clientes, lo que representa aproximadamente el 15% del comercio electr√≥nico en Rusia.  En consecuencia, se admite una arquitectura muy diversa.  Si algo cae, debemos arreglarlo en 15 minutos.  Pero para entender que ha ocurrido un accidente, debe monitorear el proyecto y responder a los incidentes.  Como hacerlo <br><br>  Creo que la organizaci√≥n del sistema de monitoreo correcto est√° en problemas.  Si no hubo problemas, mi discurso consisti√≥ en una tesis: "Instale Prometheus + Grafana y los complementos 1, 2, 3."  Desafortunadamente, esto no funciona ahora.  Y el principal problema es que todos siguen creyendo en algo que exist√≠a en 2008, en t√©rminos de componentes de software. <br><br>  Con respecto a la organizaci√≥n del sistema de monitoreo, me arriesgo a decir que ... no existen proyectos con monitoreo competente.  Y la situaci√≥n es tan mala si algo cae, existe el riesgo de que pase desapercibido: todos est√°n seguros de que "todo est√° siendo monitoreado". <br>  Quiz√°s todo est√° siendo monitoreado.  Pero como? <br><br>  Todos nos topamos con una historia similar a la siguiente: cierta despojo, cierto administrador est√° trabajando, un equipo de desarrollo se acerca a ellos y les dice: "lo tenemos, ahora est√° monitoreado".  Que monitor  Como funciona <br><br>  Ok  Hacemos un seguimiento de la manera antigua.  Pero ya est√° cambiando, y resulta que usted monitore√≥ el servicio A, que se convirti√≥ en el servicio B, que interact√∫a con el servicio C. Pero el equipo de desarrollo le dice: "¬°Instale el software, debe monitorear todo!" <br><br>  Entonces, ¬øqu√© ha cambiado?  - ¬°Todo ha cambiado! <br><a name="habracut"></a><br><h4>  2008 a√±o.  Todo esta bien </h4><br>  Hay un par de desarrolladores, un servidor, un servidor de base de datos.  A partir de aqu√≠ todo va.  Tenemos algunos infa, ponemos zabbix, Nagios, cactus.  Y luego establecemos alertas claras en la CPU, en el funcionamiento de los discos, en el lugar de los discos.  Tambi√©n hacemos un par de comprobaciones manuales de que el sitio responde que los pedidos llegan a la base de datos.  Y eso es todo, estamos m√°s o menos protegidos. <br><br>  Si comparamos la cantidad de trabajo que el administrador hizo para garantizar el monitoreo, entonces fue 98% autom√°tico: la persona que est√° monitoreando deber√≠a entender c√≥mo instalar Zabbix, c√≥mo configurarlo y configurar alertas.  Y 2% - para verificaciones externas: que el sitio responda y solicite a la base de datos que hayan llegado nuevos pedidos. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/846/5ae/a65/8465aea65cdf10015bb2aad7eff7ebf6.png"><br><br><h4>  A√±o 2010.  La carga est√° creciendo </h4><br>  Comenzamos a escalar la web, agregamos un motor de b√∫squeda.  Queremos asegurarnos de que el cat√°logo de productos contenga todos los productos.  Y esa b√∫squeda de productos funciona.  Que la base de datos funciona, que se est√°n haciendo pedidos, que el sitio responde externamente y que responde desde dos servidores, y que el usuario no es expulsado del sitio mientras est√° reequilibrando a otro servidor, etc.  Hay m√°s entidades. <br><br>  Adem√°s, la entidad asociada con la infraestructura sigue siendo la m√°s grande en la cabeza del gerente.  A√∫n as√≠, la idea se me ocurre que la persona que est√° monitoreando es la persona que instalar√° zabbix y podr√° configurarlo. <br><br>  Pero al mismo tiempo, hay trabajos para realizar verificaciones externas, crear un conjunto de scripts para consultar el indexador de b√∫squeda, un conjunto de scripts para verificar que la b√∫squeda cambia durante el proceso de indexaci√≥n, un conjunto de scripts que verifican que los productos se transfieren al servicio de entrega, etc.  etc. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/45c/974/24c/45c97424c842cf539e79b900b903437d.png"><br><br>  Nota: Escrib√≠ un "conjunto de guiones" 3 veces.  Es decir, la persona responsable de la supervisi√≥n ya no es la que solo instala zabbix.  Esta es la persona que comienza a codificar.  Pero nada ha cambiado en las mentes del equipo todav√≠a. <br><br>  Pero el mundo est√° cambiando, volvi√©ndose cada vez m√°s complicado.  Una capa de virtualizaci√≥n, se agregan varios sistemas nuevos.  Comienzan a interactuar entre ellos.  ¬øQui√©n dijo "huele a microservicios"?  Pero cada servicio a√∫n se ve individualmente como un sitio.  Podemos recurrir a √©l y comprender que proporciona la informaci√≥n necesaria y trabaja por s√≠ mismo.  Y si usted es un administrador que participa constantemente en un proyecto que se ha estado desarrollando durante 5-7-10 a√±os, tiene este conocimiento acumulado: aparece un nuevo nivel, se dio cuenta, aparece otro nivel, se dio cuenta ... <br><br><img src="https://habrastorage.org/webt/tc/we/qe/tcweqem6jjpldcpovhhoklgt3kq.png"><br><br>  Pero rara vez alguien acompa√±a al proyecto durante 10 a√±os. <br><br><h3>  Resumen de monitoreo del hombre </h3><br>  Supongamos que llegaste a una nueva startup que inmediatamente obtuvo 20 desarrolladores, escribi√≥ 15 microservicios y eres el administrador al que se le dice: "Construye un CI / CD.  Por favor ".  Usted construy√≥ un CI / CD y de repente escuch√≥: "Es dif√≠cil para nosotros trabajar con la producci√≥n en el" cubo "sin comprender c√≥mo funcionar√° la aplicaci√≥n en √©l.  Haznos una caja de arena en el mismo "cubo". <br>  Haces un caj√≥n de arena en este cubo.  Inmediatamente le dicen: "Queremos una base de datos de etapas, que se actualice todos los d√≠as desde la producci√≥n, para comprender que funciona en la base de datos, pero al mismo tiempo no estropear la base de datos de producci√≥n". <br><br>  Vives en todo eso.  Faltan 2 semanas para el lanzamiento, te dicen: "Ahora todo ser√≠a monitoreado ..." Eso es  supervisar la infraestructura del cl√∫ster, supervisar la arquitectura de microservicios, supervisar el trabajo con servicios externos ... <br><br>  Y sus colegas se quitan de la cabeza un esquema tan familiar y dicen: ‚Äú¬°Entonces, aqu√≠ todo est√° claro!  Instale un programa que lo supervise todo ".  S√≠: Prometheus + Grafana + complementos. <br>  Y agregan al mismo tiempo: "Tienes dos semanas, aseg√∫rate de que todo sea confiable". <br><br>  En el mont√≥n de proyectos que vemos, se asigna una persona para el monitoreo.  Imagine que queremos contratar a una persona durante 2 semanas para monitorear, y le escribiremos un curr√≠culum.  ¬øQu√© habilidades debe poseer esta persona, dado todo lo que hemos dicho antes? <br><br><ul><li>  Debe comprender el monitoreo y los detalles del trabajo de la infraestructura de hierro. </li><li>  Debe comprender los detalles espec√≠ficos del monitoreo de Kubernetes (y todos quieren un "cubo", porque puedes ignorar todo, esconderte, porque el administrador lo resolver√°), por s√≠ mismo, su infraestructura y entender c√≥mo monitorear las aplicaciones dentro. </li><li>  Debe comprender que los servicios se comunican entre s√≠ de manera especial y conocer los detalles de la interacci√≥n de los servicios entre ellos.  Es bastante realista ver un proyecto en el que algunos de los servicios se comunican sincr√≥nicamente, porque no hay otra manera.  Por ejemplo, el backend pasa a REST, en gRPC al servicio de cat√°logo, recibe una lista de productos y regresa.  No puedes esperar aqu√≠.  Y con otros servicios, funciona de forma as√≠ncrona.  Transfiera el pedido al servicio de entrega, env√≠e una carta, etc. <br>  ¬øProbablemente ya has navegado de todo esto?  Y el administrador, que necesita monitorear esto, nad√≥ a√∫n m√°s. </li><li>  Debe poder planificar y planificar correctamente, a medida que el trabajo se vuelve m√°s y m√°s. </li><li>  Por lo tanto, debe crear una estrategia a partir del servicio creado para comprender c√≥mo monitorearlo espec√≠ficamente.  Necesita una comprensi√≥n de la arquitectura del proyecto y su desarrollo + comprensi√≥n de las tecnolog√≠as utilizadas en el desarrollo. </li></ul><br>  Recordemos un caso absolutamente normal: parte de los servicios en php, parte de los servicios en Go, parte de los servicios en JS.  De alguna manera trabajan entre ellos.  De aqu√≠ proviene el t√©rmino "microservicio": hay tantos sistemas separados que los desarrolladores no pueden entender el proyecto en su conjunto.  Una parte del equipo escribe servicios en JS que funcionan por s√≠ solos y no saben c√≥mo funciona el resto del sistema.  La otra parte escribe servicios en Python y no entra en la forma en que funcionan otros servicios, est√°n aislados en su campo.  Tercero: escribe servicios en php u otra cosa. <br>  Todas estas 20 personas se dividen en 15 servicios, y solo hay un administrador que debe entender todo esto.  Basta!  acabamos de dividir el sistema en 15 microservicios, porque 20 personas no pueden entender todo el sistema. <br><br>  Pero necesita ser monitoreado de alguna manera ... <br><br>  Cual es el resultado?  Como resultado, hay una persona que incluye todo lo que un equipo completo de desarrolladores no puede entender, y sin embargo, tambi√©n debe saber y ser capaz de lo que hemos indicado anteriormente: infraestructura de hierro, infraestructura de Kubernetes, etc. <br><br>  ¬øQu√© puedo decir? Houston, tenemos problemas. <br><br><h3>  Monitorear un proyecto de software moderno es un proyecto de software en s√≠ mismo </h3><br>  Desde la falsa creencia de que el monitoreo es software, tenemos fe en los milagros.  Pero los milagros, por desgracia, no suceden.  No puedes instalar zabbix y esperar a que todo funcione.  No tiene sentido poner a Grafana y esperar que todo est√© bien.  La mayor parte del tiempo se dedicar√° a organizar controles sobre el funcionamiento de los servicios y su interacci√≥n entre ellos, controles sobre c√≥mo funcionan los sistemas externos.  De hecho, el 90% del tiempo se gastar√° no en escribir guiones, sino en el desarrollo de software.  Y debe ser un equipo que entienda el trabajo del proyecto. <br>  Si en esta situaci√≥n se arroja a una persona para ser monitoreada, entonces ocurrir√°n problemas.  Lo que est√° sucediendo en todas partes. <br><br>  Por ejemplo, hay varios servicios que se comunican entre s√≠ a trav√©s de Kafka.  Lleg√≥ una orden, enviamos un mensaje sobre la orden a Kafka.  Existe un servicio que escucha informaci√≥n sobre el pedido y realiza el env√≠o de mercanc√≠as.  Hay un servicio que escucha informaci√≥n sobre el pedido y env√≠a una carta al usuario.  Y luego todav√≠a hay un mont√≥n de servicios, y comenzamos a confundirnos. <br><br>  Y si todav√≠a se lo da al administrador y a los desarrolladores en una etapa en la que queda poco tiempo antes del lanzamiento, una persona deber√° comprender todo este protocolo.  Es decir  Un proyecto de esta escala lleva un tiempo considerable, y esto deber√≠a incorporarse al desarrollo del sistema. <br>  Pero muy a menudo, especialmente en la grabaci√≥n, en las startups, vemos c√≥mo se pospone la supervisi√≥n hasta m√°s tarde.  ‚ÄúAhora haremos la Prueba de concepto, comenzaremos con ella, la dejaremos caer, estamos listos para sacrificarnos.  Y luego lo supervisaremos todo ‚Äù.  Cuando (o si) el proyecto comienza a ganar dinero, la empresa quiere reducir a√∫n m√°s funciones, ya que comenz√≥ a funcionar, por lo que debe ir m√°s all√°.  Y est√° en el punto donde al principio necesita monitorear todo lo anterior, lo que no toma el 1% del tiempo, sino mucho m√°s.  Y, por cierto, los desarrolladores necesitar√°n monitoreo, y es m√°s f√°cil ponerlos en nuevas funciones.  Como resultado, se escriben nuevas caracter√≠sticas, todo est√° envuelto y usted est√° en un interminable punto muerto. <br><br>  Entonces, ¬øc√≥mo monitorea un proyecto desde el principio, y qu√© sucede si tiene un proyecto que necesita monitorear, pero no sabe por d√≥nde comenzar? <br><br>  Primero, necesitas planear. <br><br>  <i>Digresi√≥n de letras: muy a menudo comienza con el monitoreo de la infraestructura.</i>  <i>Por ejemplo, tenemos Kubernetes.</i>  <i>Para empezar, colocamos Prometeo con Grafana, colocamos los complementos bajo la supervisi√≥n del "cubo".</i>  <i>No solo los desarrolladores, sino tambi√©n los administradores tienen una pr√°ctica desafortunada: "Instalaremos este complemento, y el complemento probablemente sepa c√≥mo hacerlo".</i>  <i>A la gente le gusta comenzar con acciones simples y comprensibles, en lugar de acciones importantes.</i>  <i>Y la infraestructura de monitoreo es f√°cil.</i> <br><br>  Primero, decida qu√© y c√≥mo desea monitorear, y luego levante el instrumento, porque otras personas no pueden pensar por usted.  S√≠, ¬øy deber√≠an?  Otras personas pensaban para s√≠ mismas sobre el sistema universal, o no pensaban en absoluto cuando se escribi√≥ este complemento.  Y el hecho de que este complemento tenga 5 mil usuarios no significa que traiga ning√∫n beneficio.  Tal vez se convertir√° en el 5001 simplemente porque ya hab√≠a 5.000 personas all√≠ antes. <br><br>  Si comenz√≥ a monitorear la infraestructura y el back-end de su aplicaci√≥n dej√≥ de responder, todos los usuarios perder√°n contacto con la aplicaci√≥n m√≥vil.  Un error saldr√° volando.  Ellos vendr√°n a ti y te dir√°n: "La aplicaci√≥n no funciona, ¬øqu√© haces aqu√≠?"  "Estamos monitoreando".  - "¬øC√≥mo monitorea si no ve que la aplicaci√≥n no funciona?" <br><br><ol><li>  Creo que es necesario comenzar a monitorear desde el punto de entrada del usuario.  Si el usuario no ve que la aplicaci√≥n est√° funcionando, eso es todo, es un error.  Y el sistema de monitoreo deber√≠a advertir sobre esto en primer lugar. </li><li>  Y solo entonces podemos monitorear la infraestructura.  O hazlo en paralelo.  La infraestructura es m√°s simple: aqu√≠ finalmente podemos instalar zabbix. </li><li>  Y ahora necesita ir a las ra√≠ces de la aplicaci√≥n para comprender d√≥nde no funciona. </li></ol><br>  Mi pensamiento principal es que el monitoreo debe ir en paralelo con el proceso de desarrollo.  Si elimina el equipo de monitoreo para otras tareas (crear un CI / CD, cajas de arena, reorganizar la infraestructura), el monitoreo comenzar√° a retrasarse y es posible que nunca se ponga al d√≠a con el desarrollo (o tarde o temprano tendr√° que detenerse). <br><br><h3>  Todo por niveles </h3><br>  As√≠ es como veo la organizaci√≥n del sistema de monitoreo. <br><br>  1) Nivel de aplicaci√≥n: <br><ul><li>  monitorear la l√≥gica de negocios de la aplicaci√≥n; </li><li>  monitorear las m√©tricas de salud de los servicios; </li><li>  Monitoreo de integraci√≥n. </li></ul><br>  2) Nivel de infraestructura: <br><ul><li>  monitorear el nivel de orquestaci√≥n; </li><li>  software de sistema de monitoreo; </li><li>  monitoreando el nivel de "hierro". </li></ul><br>  3) Una vez m√°s, el nivel de aplicaci√≥n, pero como producto de ingenier√≠a: <br><ul><li>  recopilaci√≥n y monitoreo de registros de aplicaciones; </li><li>  APM </li><li>  rastreo. </li></ul><br>  4) Alertas: <br><ul><li>  organizaci√≥n de un sistema de alerta; </li><li>  organizaci√≥n de un sistema de vigilancia; </li><li>  organizaci√≥n de una "base de conocimiento" y procesamiento de incidentes de flujo de trabajo. </li></ul><br>  <b>Importante</b> : ¬°llegamos a la alerta no despu√©s, sino de inmediato!  No es necesario comenzar a monitorear y "de alguna manera m√°s tarde" pensar qui√©n recibir√° las alertas.  Despu√©s de todo, cu√°l es la tarea de monitoreo: comprender d√≥nde algo no funciona en el sistema y dejar que las personas adecuadas lo sepan.  Si esto se deja hasta el final, las personas correctas descubrir√°n que algo va mal, solo llamando "nada funciona para nosotros". <br><br><h3>  Capa de aplicaci√≥n: supervisi√≥n de la l√≥gica empresarial </h3><br>  Aqu√≠ estamos hablando de verificar el hecho de que la aplicaci√≥n funciona para el usuario. <br><br>  Este nivel debe hacerse en la etapa de dise√±o.  Por ejemplo, tenemos un Prometheus condicional: rastrea al servidor que se dedica a las comprobaciones, extrae el punto final y el punto final va y comprueba la API. <br><br>  Cuando a menudo se les pide que supervisen la p√°gina principal para asegurarse de que el sitio funciona, los programadores le dan un l√°piz que se puede extraer cada vez que necesite asegurarse de que la API funcione.  Y los programadores en este momento todav√≠a toman y escriben / api / test / helloworld <br>  ¬øLa √∫nica manera de asegurarse de que todo funcione?  - no! <br><br><ul><li>  Crear tales controles es esencialmente tarea de los desarrolladores.  Las pruebas unitarias deben ser escritas por programadores que escriben c√≥digo.  Porque si combina esto con el administrador "Amigo, aqu√≠ hay una lista de protocolos de API para las 25 funciones, ¬°por favor supervise todo!"  - Nada funcionar√°. </li><li>  Si imprime "hola mundo", nadie sabr√° nunca que la API deber√≠a y realmente funciona.  Cada cambio en la API deber√≠a conducir a un cambio en las comprobaciones. </li><li>  Si ya tiene un desastre de este tipo, detenga las funciones y seleccione los desarrolladores que escribir√°n estos cheques, o concilie con las p√©rdidas, concilie que nada se verifica y caer√°. </li></ul><br>  Consejos t√©cnicos <br><br><ul><li>  Aseg√∫rese de organizar un servidor externo para organizar las inspecciones; debe asegurarse de que su proyecto sea accesible al mundo exterior. </li><li>  Organice la validaci√≥n en todo el protocolo API, no solo en los puntos finales individuales. </li><li>  Cree un punto final prometeo con los resultados de la prueba. </li></ul><br><h3>  Nivel de aplicaci√≥n - Monitoreo de m√©tricas de salud </h3><br>  Ahora estamos hablando de indicadores de salud externos de los servicios. <br><br>  Decidimos monitorear todos los "bol√≠grafos" de la aplicaci√≥n utilizando controles externos que llamamos desde un sistema de monitoreo externo.  Pero estos son precisamente los "bol√≠grafos" que el usuario "ve".  Queremos asegurarnos de que los servicios en s√≠ mismos funcionen para nosotros.  Aqu√≠ hay una historia mejor: K8s tiene controles de salud para que al menos el cubo se asegure de que el servicio funcione.  Pero la mitad de los cheques que vi son la misma impresi√≥n "hola mundo".  Es decir  aqu√≠ tira una vez despu√©s del despliegue, le respondi√≥ que todo est√° bien, y eso es todo.  Y el servicio, si descansa en su propia API, tiene una gran cantidad de puntos de entrada para la misma API, que tambi√©n necesita ser monitoreada, porque queremos saber que funciona.  Y ya lo estamos monitoreando por dentro. <br><br>  C√≥mo implementarlo t√©cnicamente correctamente: cada servicio establece un punto final sobre su rendimiento actual, y en los gr√°ficos de Grafana (o cualquier otra aplicaci√≥n) vemos el estado de todos los servicios. <br><br><ul><li>  Cada cambio en la API deber√≠a conducir a un cambio en las comprobaciones. </li><li>  Cree un nuevo servicio de inmediato con m√©tricas de salud. </li><li>  El administrador puede dirigirse a los desarrolladores y preguntarles "agr√©gueme un par de funciones para que entienda todo y agregue informaci√≥n sobre esto a mi sistema de monitoreo".  Pero los desarrolladores suelen responder: "No agregaremos nada dos semanas antes del lanzamiento". <br>  Que los gerentes de desarrollo sepan que habr√° tales p√©rdidas, que los jefes de los gerentes de desarrollo tambi√©n lo sepan.  Porque cuando todo cae, alguien a√∫n llamar√° y exigir√° monitorear el "servicio en constante ca√≠da" (c) </li><li>  Por cierto, seleccione desarrolladores para escribir complementos para Grafana; esta ser√° una buena ayuda para los administradores. </li></ul><br><h3>  Capa de aplicaci√≥n - Monitoreo de integraci√≥n </h3><br>  El monitoreo de integraci√≥n se enfoca en monitorear la comunicaci√≥n entre los sistemas cr√≠ticos del negocio. <br><br>  Por ejemplo, hay 15 servicios que se comunican entre s√≠.  Estos ya no son sitios individuales.  Es decir  no podemos extraer el servicio por s√≠ solo, get / helloworld y entender que el servicio est√° funcionando.  Debido a que el servicio web para realizar un pedido debe enviar informaci√≥n sobre el pedido al bus, el servicio de almac√©n debe recibir este mensaje del bus y trabajar con √©l.  Y el servicio de distribuci√≥n de correo electr√≥nico deber√≠a manejar esto de alguna manera m√°s, etc. <br><br>  En consecuencia, no podemos entender, hurgando en cada servicio individual, que todo esto funcione.  Porque tenemos un determinado autob√∫s a trav√©s del cual todo se comunica e interact√∫a. <br>  Por lo tanto, esta etapa debe indicar la etapa de prueba de servicios para interactuar con otros servicios.  Habiendo monitoreado a un agente de mensajes, no puede organizar el monitoreo de la comunicaci√≥n.  Si hay un servicio que emite datos y un servicio que los recibe, al monitorear a un corredor, solo veremos datos que vuelan de un lado a otro.  Incluso si de alguna manera logramos monitorear la interacci√≥n de estos datos en el interior (que alg√∫n productor publique los datos, alguien los lea, esta transmisi√≥n contin√∫a yendo a Kafka), a√∫n no nos dar√° informaci√≥n si un servicio dio un mensaje en una versi√≥n, pero otro servicio no esperaba esta versi√≥n y la omiti√≥.  No lo sabremos porque los servicios nos dir√°n que todo funciona. <br><br>  Como recomiendo hacer: <br><br><ul><li>  Para comunicaci√≥n sincr√≥nica: el punto final ejecuta solicitudes de servicios relacionados.  Es decir  tomamos este punto final, sacamos la secuencia de comandos dentro del servicio, que va a todos los puntos y dice "Puedo tirar all√≠, y tirar all√≠, puedo tirar ..." </li><li>  Para la comunicaci√≥n asincr√≥nica: mensajes entrantes: el punto final verifica el bus en busca de mensajes de prueba y muestra el estado del procesamiento. </li><li>  Para comunicaci√≥n as√≠ncrona: mensajes salientes: el punto final env√≠a mensajes de prueba al bus. </li></ul><br>  Como suele suceder: tenemos un servicio que arroja datos en el bus.  Acudimos a este servicio y le pedimos que hable sobre su salud de integraci√≥n.  Y si el servicio necesita vender alg√∫n mensaje en otro lugar (WebApp), generar√° este mensaje de prueba.  Y si extraemos el servicio del lado de Procesamiento de pedidos, primero publica algo que puede publicar de forma independiente, y si hay cosas dependientes, luego lee un conjunto de mensajes de prueba del bus, comprende que puede procesarlos, informarlo y , si es necesario, publ√≠quelos m√°s, y sobre esto dice: todo est√° bien, estoy vivo. <br><br>  Muy a menudo escuchamos la pregunta "¬øc√≥mo podemos probar esto en los datos de combate?"  Por ejemplo, estamos hablando del mismo servicio de pedido.  La orden env√≠a mensajes al almac√©n donde se cancelan las mercanc√≠as: no podemos probar esto en los datos de combate, porque "¬°mis mercanc√≠as se cancelar√°n!"  Salida: en la etapa inicial, planifique toda esta prueba.  Tienes pruebas unitarias que se burlan.  Por lo tanto, h√°galo a un nivel m√°s profundo, donde tendr√° un canal de comunicaci√≥n que no da√±ar√° el negocio. <br><br><h3>  Nivel de infraestructura </h3><br>  El monitoreo de infraestructura es lo que durante mucho tiempo se ha considerado monitoreo en s√≠ mismo. <br><br><ul><li>  El monitoreo de la infraestructura puede y debe iniciarse como un proceso separado. </li><li>  No debe comenzar por monitorear la infraestructura de un proyecto en funcionamiento, incluso si realmente lo desea.  Esto es un dolor para todos los devops.  "Primero monitorizo ‚Äã‚Äãel cl√∫ster, monitorizo ‚Äã‚Äãla infraestructura", es decir  Primero, controlar√° lo que se encuentra debajo, pero no entrar√° en la aplicaci√≥n.  Porque la aplicaci√≥n es algo incomprensible para la devopa.  Se lo filtraron y √©l no comprende c√≥mo funciona.  Y comprende la infraestructura y comienza con ella.  Pero no, siempre debe controlar primero la aplicaci√≥n. </li><li>     .    ,   ,       - .   on-call,     ,  ¬´    ¬ª.       . </li></ul><br><h3>    - </h3><br>  : <br><br><ul><li> ELK.   .   -     ,    . </li><li> APM.  APM       (NewRelic, BlackFire, Datadog).      ,   - ,    . </li><li> Tracing.       ,         .    ,     tracing   ‚Äî     .     ‚Äì ! . Jaeger/Zipkin </li></ul><br><h3>  </h3><br><ul><li>   :           .   Grafana.     PagerDuty.     (,   ‚Ä¶).   ,     </li><li>   :      (    ,     ). Oncall    :    ,       ,       ,   ‚Äî     (          ‚Äî  , :         ,  ).  ,     ‚Äî    (¬´   ‚Äî    ¬ª),    . </li><li>  ¬´ ¬ª  workflow  :        ,        ,   .   ,    ‚Äî  ;        . </li></ul><br><h3>   </h3><br>  ,     : <br><br><ul><li>   ‚Äî Prometheus + Grafana; </li><li>   ‚Äî ELK; </li><li>  APM  Tracing ‚Äî Jaeger (Zipkin). </li></ul><br><img src="https://habrastorage.org/webt/tv/xl/3i/tvxl3isq0zhn8tfkeqermj9tuko.png"><br><br>   .  ,     ,      ,         .   ,     .  , , ,     ‚Äî       . <br><br>   ,       : <br><br> <i>Prometheus   Kubernetes ‚Äî   ?!</i>     ,    ?      ,        ,   ‚Äî ,      . <br><br> <i>       .</i>      .    ,   Promtheus,   ,    ,      .             ? ,     ,      . <br><br><h3>  Conclusiones </h3><br><ul><li>   ‚Äî   ,    . 98%   ‚Äî  .   ,   ,   ,  --. </li><li>      :     30%  ,   . </li><li> ,  ,      - ,     ‚Äî     .    ,    ‚Äî   . </li><li>        (  ) ‚Äî    . </li><li>     ,   ,   ¬´ ¬ª ‚Äî    ,      . </li></ul><br> <i>      Saint Highload++.</i> <br><br> UPD (       ): <br><br> 1.  ,   ,  ,   ¬´,  ,    ,   ¬ª. ,   :  DevOps    ,     ‚Äî   , ,  ,  . <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. No estoy tratando de insinuar, dicen, "todo est√° mal en todas partes, pero aqu√≠ podemos monitorearlo, vengan a ITSumma". </font><font style="vertical-align: inherit;">No, si se lanza el proyecto, el monitoreo no puede ser realizado por una compa√±√≠a externa. </font><font style="vertical-align: inherit;">Por supuesto, tambi√©n tenemos objetivos comerciales, y lo que realmente estamos pensando hacer es introducir consultor√≠a para apoyar el proyecto en el proceso de su desarrollo con el fin de transmitir c√≥mo llevar a cabo adecuadamente la parte de monitoreo del desarrollo.</font></font><br><br>  Si est√° interesado en mis ideas y pensamientos al respecto, puede <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">leer el canal</a> :-) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/448602/">https://habr.com/ru/post/448602/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../448584/index.html">7 errores comunes al usar preposiciones en ingl√©s y c√≥mo evitarlos</a></li>
<li><a href="../448590/index.html">Extra√±os familiares o una vez m√°s sobre el uso de patrones de dise√±o</a></li>
<li><a href="../448594/index.html">Antivirus y cortafuegos gratuitos (UTM, NGFW) de Sophos</a></li>
<li><a href="../448596/index.html">Soporte para tableta en la cinta de correr o busque pasos gratis</a></li>
<li><a href="../448600/index.html">C√≥mo Windows 10 Explore la vulnerabilidad cr√≠tica de DHCP detecta dos errores de seguridad m√°s</a></li>
<li><a href="../448604/index.html">Gameboy en C #</a></li>
<li><a href="../448606/index.html">Sidorin: KnowledgeConf trata sobre c√≥mo mantener el conocimiento con una duraci√≥n promedio de trabajo en un lugar en 2-3 a√±os</a></li>
<li><a href="../448608/index.html">¬øC√≥mo dar los primeros pasos en rob√≥tica?</a></li>
<li><a href="../448610/index.html">Bricolaje: c√≥mo hicimos un calendario en vivo para Codefest X</a></li>
<li><a href="../448612/index.html">Lo que se congel√≥ en Feature Freeze 2019. Parte I. JSONPath</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>