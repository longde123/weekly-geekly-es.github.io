<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙀 👩🏾‍🤝‍👨🏿 🤮 Wetterstation auf Arduino von A bis Z. Teil 4 👋🏽 👆🏾 👨🏼‍🔬</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fortsetzung folgt. Der vorherige Teil . 
 Inhaltsverzeichnis: 


- Teil 1. Anforderungen. Die Wahl des Eisens. Allgemeines Schema 
- Teil 2. Software....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wetterstation auf Arduino von A bis Z. Teil 4</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/425963/"><p>  Fortsetzung folgt.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Der vorherige Teil</a> . <br>  Inhaltsverzeichnis: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1. Anforderungen.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Wahl des Eisens.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Allgemeines Schema</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2. Software.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zentraleinheit, Eisen</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3. Zentraleinheit, Software</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 4. Fenstersensor</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 5. MySQL, PHP, WWW, Android</a> </li></ul><br><h1 id="zaokonnyy-datchik-zhelezo">  Außenborder Sensor.  Eisen </h1><br><p> Wir müssen sofort zugeben, dass die erste Version des Fenstersensors (Fernbedienungssensors) hinsichtlich Stromversorgung und Energieverbrauch nicht ganz erfolgreich war.  Wie ich bereits schrieb, hatte ich nur das Arduino Pro Mini-Modul mit 5 V zur Hand. Und ich verwendete Ni-MH-Batterien. </p><br><p>  Trotz der Tatsache, dass ich auch die Solarbatterie angeschlossen habe, arbeitete die gesamte Struktur etwa 25 Tage lang autonom.  Sehr negativ wurde die Batteriekapazität durch niedrige, oft negative Temperaturen auf der Straße am Ende des Winters beeinträchtigt. </p><br><p>  Nehmen Sie die folgenden Ersetzungen vor, damit alles viel länger für Sie funktioniert: </p><br><ul><li>  Kaufen Sie Arduino Pro Mini bei 3,3V </li><li>  Verwenden Sie einen 3,7-V-Li-Ionen-Akku NCR18650A von Panasonic, 2-tlg.  für etwa 14 $ bei 3100mAh.  Sie können CR123, CR123A Batterien ausprobieren.  Und denken Sie daran, dass eine 9-V-Batterie (wie eine Krona) eine schlechte Stromquelle ist. </li></ul><a name="habracut"></a><br><p>  Das Wichtigste ist, dass Ihre Batterien auf der Straße funktionieren, d. H.  bei negativen Temperaturen, die die in ihnen ablaufenden chemischen Prozesse verlangsamen und dadurch ihre Kapazität stark reduzieren. </p><br><p>  Der DHT22-Sensor kann auch mit 3,3 V betrieben werden. </p><br><p>  Die obigen Permutationen beinhalten keine Änderungen oder Ersetzungen anderer Komponenten. </p><br><h1 id="pitanie">  Ernährung </h1><br><p>  Ich habe ursprünglich 4 Stück verwendet.  Der Ni-MH-Akku ist mit einem Abgriff vom 3. in Reihe geschaltet, sodass wir zwei Versorgungsspannungen erhalten: 4,8 V für den DHT22-Sensor und 3,6 V für alles andere.  Ich habe keine Step-Down- (genauer gesagt, Energie zerstörenden) oder Step-Up-Elektronikschaltungen verwendet, sondern nur umweltfreundliche Spannungen und Ströme. </p><br><p><img src="https://habrastorage.org/webt/fu/y2/ug/fuy2ugymimv6bobt_raozj4phso.png" alt="Wahrnehmung"></p><br><p>  Das Solarpanel wird wie gezeigt angeschlossen.  Solarpanel 1,6 W 5,5 V 266 mA wurde für 6,64 USD gekauft. </p><br><p>  In der Schaltung werden eine Schottky-Diode vom Typ 1N914 und ein Elektrolytkondensator von 50-100 μF verwendet. </p><br><p><img src="https://habrastorage.org/webt/cb/tz/3f/cbtz3fcowam0ednzs-hrtvcgx0y.jpeg"></p><br><h1 id="raspinovka--i-soedinenie">  Pinbelegung und Anschluss </h1><br><p>  Fahren wir mit der Montage fort. </p><br><h2 id="datchik-temperatury-i-vlazhnosti-dht22">  Temperatur- und Feuchtigkeitssensor DHT22 </h2><br><p><img src="https://habrastorage.org/webt/lc/es/rh/lcesrhbcvwc62oyouhfplszy4mg.jpeg" alt="DHT22"></p><br><p>  Pinbelegung zum Anschluss eines Temperatur- und Feuchtigkeitssensors DHT22: </p><br><table><thead><tr><th>  DHT22 Vorderseite von links nach rechts </th><th>  Arduino Pro Mini </th><th>  Hinweis </th></tr></thead><tbody><tr><td>  Vcc </td><td>  3,3 - 5V </td><td>  5V empfohlen, bessere externe Stromversorgung </td></tr><tr><td>  SDA </td><td>  D2 </td><td> In der Skizze ist es <code>DHTPIN</code> </td></tr><tr><td>  NC </td><td>  Nicht verbunden </td></tr><tr><td>  GND </td><td>  GND </td></tr></tbody></table><br><p>  Optional können Sie den SDA über einen 10K-Widerstand an VCC anschließen (festziehen). </p><br><p>  Initialisierung: </p><br><pre> <code class="hljs cpp"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DHTPIN 2 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//   D2 DHT dht(DHTPIN, DHTTYPE);</span></span></span></span></code> </pre> <br><p>  Um den Sensor vor direkter Sonneneinstrahlung zu schützen, habe ich aus einer Dose ein Gehäuse dafür gemacht und es mit reflektierendem metallisiertem Klebeband überklebt. </p><br><h2 id="nrf24l01">  nRF24L01 + </h2><br><p><img src="https://habrastorage.org/webt/s6/ec/cd/s6eccdukpd6vmu3p1jxvfbswufu.png" alt="nRF24L01 +"></p><br><p>  Die Pinbelegung des Funkmoduls nRF24L01 + (sehen Sie oben auf der Platine nach, wo sich der Chip befindet, während sich die Pin-Pins unten befinden): </p><br><table><thead><tr><th></th><th></th><th></th><th></th></tr></thead><tbody><tr><td>  (2) 3,3 V. </td><td>  (4) CSN </td><td>  (6) MOSI </td><td>  (8) IRQ </td></tr><tr><td>  (1) GND </td><td>  (3) CE </td><td>  (5) SCK </td><td>  (7) MISO </td></tr></tbody></table><br><p>  NRF24L01 + Verbindung </p><br><table><thead><tr><th>  Arduino Pro Mini </th><th>  nRF24L01 + </th><th>  Hinweis </th></tr></thead><tbody><tr><td>  3,3V </td><td>  VCC (2) </td><td>  Bessere externe Stromversorgung </td></tr><tr><td>  Pin D8 </td><td>  CE (3) </td><td>  Chip aktivieren in </td></tr><tr><td>  SS Pin D10 </td><td>  CSN (4) </td><td>  Chipauswahl in </td></tr><tr><td>  SCK-Pin D13 </td><td>  SCK (5) </td><td>  SPI Uhr ein </td></tr><tr><td>  MOSI Pin D11 </td><td>  SDI (6) </td><td>  SPI-Daten in </td></tr><tr><td>  MISO Pin D12 </td><td>  SDO (7) </td><td>  SPI-Daten aus </td></tr><tr><td>  IRQ 8 </td><td>  Interrupt-Ausgang nicht angeschlossen </td></tr><tr><td>  GND </td><td>  GND (1) </td></tr></tbody></table><br><p>  Initialisierung: </p><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-function">NRF24 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">nrf24</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">8</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">10</span></span></span></span></span><span class="hljs-function">)</span></span>;</code> </pre> <br><p>  Wie in den Foren empfohlen, wurde sofort ein Elektrolytkondensator mit geringer Kapazität (10 μF) an die Leistungsklemmen nRF24L01 + gelötet. </p><br><p>  Ich habe ein Funkmodul mit einer externen Zusatzantenne, die zwei Wände zuverlässig „durchbricht“. </p><br><h1 id="voltmetr">  Voltmeter </h1><br><p>  Der externe Sensor verfügt über ein Voltmeter zur Messung der Versorgungsspannung der Batterie.  Die Messtechnik wird von Scott Daniels "Secret Arduino Voltmeter - Measure Battery Voltage", 2012, beschrieben. </p><br><p>  Die Daten werden vom analogen Pin A1 gelesen. </p><br><p><img src="https://habrastorage.org/webt/j_/z1/-x/j_z1-xvapjojymqhqvnu8xsyvkm.png"></p><br><p>  Ich habe Spannungsteilerwiderstände von 100 kOhm und 10 kOhm (Sie können leicht unterschiedliche Nennwerte haben, Sie müssen sie mit einem Ohmmeter <strong>genau</strong> messen). </p><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> r1 = <span class="hljs-number"><span class="hljs-number">100400</span></span>; <span class="hljs-comment"><span class="hljs-comment">// 100KOm const float r2 = 9960; // 10KOm</span></span></code> </pre> <br><p>  Die folgende Konstante muss wie von Scott Daniels beschrieben einzeln kalibriert werden.  Verwenden Sie eine separate <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Shemka und Skizze</a> . </p><br><p>  Wir messen zwei Werte von Vcc: echte Vcc mit einem Voltmeter (am AREF- oder 5V-Pin) und Vcc mit unserer Funktion.  Dann ersetzen wir die Konstante ( <code>1.1 * 1023.0 * 1000</code> ) durch eine neue: </p><br><pre> <code class="hljs pgsql">scale_constant = internal1<span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-keyword"><span class="hljs-keyword">Ref</span></span> * <span class="hljs-number"><span class="hljs-number">1023</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span></code> </pre> <br><p>  wobei <code>internal1.1Ref = 1.1 * Vcc1 ( ) / Vcc2 (  )</code> </p><br><p>  wo </p><br><ul><li>  Vcc1 - Vcc-Wert, der manuell mit einem Voltmeter gemessen wird </li><li>  Vcc2 - Vcc-Wert, der mit unserer Funktion ermittelt wurde </li></ul><br><p>  Dieser Referenzwert ist für einen <em>bestimmten</em> AVR-Chip individuell und hängt von Temperaturschwankungen ab. </p><br><p>  Als Ergebnis habe ich folgenden Wert erhalten: </p><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> typVbg = <span class="hljs-number"><span class="hljs-number">1.082</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    1.0 — 1.2 </span></span></code> </pre> <br><p>  Da unser Akku im Dunkeln entladen und von der Solarbatterie geladen wird, sieht der Versorgungsspannungsgraph an bewölkten Tagen sägezahnartig "nach" aus: </p><br><p><img src="https://habrastorage.org/webt/fb/ne/sg/fbnesguoqhfpwcgfa--lcrtpf4m.png" alt="Grafik"></p><br><p>  Das Diagramm ist real und stammt aus der Web-Seite des Projekts. </p><br><h1 id="sborka">  Montage </h1><br><p>  Um den Block als Ganzes zusammenzubauen, habe ich wieder das Steckbrett zum Löten verwendet. <br>  Ich habe gelötet, intuitiv ohne Vorverdrahtung verbunden, also habe ich keinen Stromkreis. </p><br><p>  Folgendes ist passiert. </p><br><p><img src="https://habrastorage.org/webt/v0/jp/wd/v0jpwdvxp-ydqtqo99byjnpk3k0.jpeg" alt="Montage"></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de425963/">https://habr.com/ru/post/de425963/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de425953/index.html">Wetterstation auf Arduino von A bis Z. Teil 3</a></li>
<li><a href="../de425955/index.html">8 interessante Beta-Bugs für iOS 12 und wie wir sie gesucht haben</a></li>
<li><a href="../de425957/index.html">Gasfahrräder oder seltsame Produktsuchen (E-Commerce)</a></li>
<li><a href="../de425959/index.html">Einige eckige Tipps</a></li>
<li><a href="../de425961/index.html">„Frühling lernen ist eine Unsinnsstunde“ - Josh Long, der Hauptevangelist von Spring in der Innenküche des Projekts</a></li>
<li><a href="../de425965/index.html">SAP Data Management Suite als Komplex für die Arbeit mit Big Data in Unternehmen</a></li>
<li><a href="../de425967/index.html">Kettensägen-Silizium-Massaker</a></li>
<li><a href="../de425969/index.html">Wie werde ich Webentwickler ... und werde ich?</a></li>
<li><a href="../de425971/index.html">Es gibt Hinweise auf das Vorhandensein von Spionagechips in Supermicro-Servern</a></li>
<li><a href="../de425973/index.html">Wie wir S3 DataLine-Speicher erstellt haben. Experimente, Tests und ein wenig über Flusspferde</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>