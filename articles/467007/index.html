<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïë üçá üë®‚Äçüíº FLProg: integraci√≥n independiente en el programa de controladores personalizados üë®üèΩ‚Äçüç≥ üßïüèº üíü</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Durante mucho tiempo, el proyecto FLProg no ha sido cubierto en Habr√©. Esto se debe a la falta de tiempo para escribir art√≠culos e incluso a mis propi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>FLProg: integraci√≥n independiente en el programa de controladores personalizados</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467007/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/m4/sc/xc/m4scxccdteuasxjzm_whvn1bs9q.png"></div><br>  Durante mucho tiempo, el proyecto FLProg no ha sido cubierto en Habr√©.  Esto se debe a la falta de tiempo para escribir art√≠culos e incluso a mis propios problemas personales.  Pero el proyecto no est√° muerto, vive y se desarrolla.  En promedio, una vez al mes, se lanza la pr√≥xima versi√≥n del programa.  Desde la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">√∫ltima publicaci√≥n</a> , la representaci√≥n del circuito se ha rehecho por completo (gracias a esto, se eliminaron los frisos durante la representaci√≥n), apareci√≥ el sistema de Referencia cruzada para el proyecto y un sistema para analizar el proyecto en busca de errores.  El c√≥digo del programa en s√≠ fue portado a una versi√≥n m√°s reciente del lenguaje de programaci√≥n.  Debido a esto, en un lado positivo (desde mi punto de vista, por supuesto, bueno, los usuarios me apoyan), la interfaz del programa ha cambiado.  Se han agregado muchos bloques interesantes.  Se implement√≥ la escala de esquemas y la b√∫squeda de bloques. <br><a name="habracut"></a><br>  Pero a√∫n as√≠, el principal problema del proyecto sigue siendo que el desarrollador del programa es una persona (este soy yo), y el n√∫mero de diferentes tarjetas controladoras, sensores, sensores, tarjetas de expansi√≥n fabricados por chinos y recientemente por nuestros fabricantes est√° en constante crecimiento.  Y los usuarios quieren probarlos o usarlos en sus proyectos.  Para dispositivos perif√©ricos, en alg√∫n momento, este problema fue m√°s o menos resuelto por m√≠ con la ayuda de crear un editor de bloques personalizado.  Este paso, como dicen, "dispar√≥", y ahora, casi en la mayor√≠a de las placas perif√©ricas existentes, en Internet o en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">foro del programa</a> , puede encontrar el bloque de usuario correspondiente.  Bueno, o en el mismo foro (o en un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">grupo en Vkontakte</a> ) pida a los gur√∫s locales que escriban uno.  Por lo general, puede aceptar de una forma u otra. <br><br>  Ahora es el momento de resolver el segundo problema: estas son placas controladoras. <br><br>  Recientemente, se lanz√≥ una versi√≥n beta del programa con el n√∫mero 6.0.  En esta versi√≥n, se implementa el editor para las descripciones de los usuarios de los controladores.  Al igual que con los bloques personalizados, las descripciones pueden agruparse en bibliotecas, guardarse como descripciones separadas, as√≠ como bibliotecas completas como un archivo, y compartirse. <br><br>  Con esta publicaci√≥n, comienzo una serie de al menos dos publicaciones en las que consideraremos c√≥mo usar este editor.  En el primer art√≠culo, con el permiso de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">shiotiny,</a> intentar√© describir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">su tablero ShIoTiny.</a>  En el segundo art√≠culo, intentaremos llegar a un an√°logo de un controlador industrial real y describirlo. <br><br>  Entonces comencemos. <br><br>  Abra el programa FLProg.  En el men√∫ "Herramientas", seleccione el "Editor de descripciones personalizadas del controlador". <br><br><img src="https://habrastorage.org/webt/x-/ut/xg/x-utxgu-j-yc6o4bxbij3ortuye.png"><br><br>  Se abre la ventana del editor de descripciones. <br><br>  Las descripciones personalizadas se pueden combinar en la biblioteca con cualquier profundidad de anidamiento.  Por lo tanto, primero creamos una biblioteca de descripci√≥n. <br><br><img src="https://habrastorage.org/webt/io/kh/cs/iokhcsgn0qt_kgc6zvf4nhmi8a4.png"><br><br>  Establece el nombre de la biblioteca. <br><br><img src="https://habrastorage.org/webt/ir/l1/bd/irl1bdlbht21as-bsinayisfuzi.png"><br><br>  Despu√©s de eso crearemos una descripci√≥n del controlador en la biblioteca. <br><br><img src="https://habrastorage.org/webt/er/fr/60/erfr60lyicwjbbppzgshkypj6ha.png"><br><br>  Y dale un nombre: <br><br><img src="https://habrastorage.org/webt/zr/vw/of/zrvwofrlxkqwswrwq149hkmxlti.png"><br><br>  Al crear una descripci√≥n del controlador, llegamos inmediatamente a la rama de par√°metros generales. <br><br><img src="https://habrastorage.org/webt/t7/u1/ct/t7u1ct8h0myo9vxvfjtapl58vpe.png"><br><br>  Aqu√≠ podemos cambiar el nombre, establecer el tipo de CPU, establecer el tama√±o de la EEPROM, cambiar el n√∫mero de versi√≥n de la descripci√≥n. <br><br>  Como la placa ShloTiny se basa en el controlador ESP8266, la seleccionamos.  Al elegir un controlador, el volumen EEPROM correspondiente se fija autom√°ticamente.  Si es necesario, este valor se puede cambiar.  El n√∫mero de versi√≥n predeterminado para la nueva descripci√≥n se establece en 1. <br><br>  En el futuro, al cambiar las descripciones existentes, se recomienda cambiarlo en la direcci√≥n del aumento.  Al usar esta descripci√≥n en un proyecto, el programa comparar√° la versi√≥n de la descripci√≥n en el proyecto y en la biblioteca.  Si el n√∫mero de versi√≥n de la descripci√≥n en la biblioteca es mayor que en el proyecto, el elemento para actualizar la descripci√≥n en el programa aparece en el men√∫ "Proyecto" del programa.  Si viceversa, aparecer√° un elemento para actualizar la descripci√≥n en la biblioteca.  Bueno, si la descripci√≥n del controlador utilizado en el proyecto no se encuentra en la biblioteca, el elemento para ingresar la descripci√≥n del proyecto en la biblioteca aparecer√° en el mismo men√∫. <br><br>  Tambi√©n en este hilo, puede escribir una descripci√≥n de texto del controlador que ayude con su selecci√≥n. <br><br>  Para aplicar los cambios realizados antes de cambiar a otra rama de los par√°metros del controlador, haga clic en el bot√≥n "Aplicar".  Si no se hace esto, los cambios no se guardar√°n. <br><br>  Ahora considere el diagrama de circuito de la placa ShloTiny. <br><br><img src="https://habrastorage.org/webt/lq/wt/de/lqwtdebl8ssogd2rvcvvxbz9rd0.png"><br><br>  La placa tiene tres entradas digitales, tres salidas digitales, una entrada anal√≥gica y una entrada para el sensor.  Un total de ocho conclusiones de la junta. <br><br>  En el editor, vaya a la rama "Conclusiones del controlador" y establezca el n√∫mero de conclusiones, no olvide hacer clic en el bot√≥n "Aplicar" despu√©s de eso. <br><br><img src="https://habrastorage.org/webt/ls/wl/lb/lswllbh_hqil-hof8ydl6z7vn9y.png"><br><br>  El programa generar√° el n√∫mero requerido de conclusiones.  Pasamos al primero de ellos. <br><br><img src="https://habrastorage.org/webt/4u/d9/ha/4ud9habaghl5ioujfwby0a-08tc.png"><br><br>  En esta rama, puede especificar un nombre de salida alternativo, que se mostrar√° en el programa.  Si est√° ausente, el programa mostrar√° PinN donde N es el n√∫mero de pin en la lista de pin.  Le recomiendo que escriba una inscripci√≥n en la pizarra en el campo de nombre alternativo.  Esto har√° que sea m√°s f√°cil entender qu√© conclusi√≥n se est√° sacando.  Para la placa descrita, colocaremos all√≠ el valor de Entrada1 de acuerdo con el diagrama del circuito.  Entonces, en este hilo, puede escribir una descripci√≥n individual de la salida, por ejemplo, para indicar las caracter√≠sticas de su aplicaci√≥n.  Si es necesario, tambi√©n puede especificar un alias para la salida, que se mostrar√° entre par√©ntesis en el programa despu√©s del nombre de la salida. <br><br>  Despu√©s de hacer los cambios, no olvide hacer clic en el bot√≥n "Aplicar".  Por el mismo principio, llamemos a las conclusiones restantes. <br><br><img src="https://habrastorage.org/webt/bp/y6/1u/bpy61u53hnwuttwg6s4ttl7kq2y.png"><br><br>  En la misma rama de los par√°metros de salida principales, se le agregan las funciones que realiza. <br><br><img src="https://habrastorage.org/webt/ks/ol/vt/ksolvtqefuyugg0s1aven_efhps.png"><br><br>  Las siguientes funciones se pueden asignar a cada pin. <br><br><img src="https://habrastorage.org/webt/y8/04/cd/y804cdepj9pr9qgnji3h9ffan38.png"><br><br><ul><li>  I2C es una funci√≥n de uno de los pines del bus I2C (SDA o SCL). </li><li>  SPI es una funci√≥n de uno de los pines del bus SPI (MISO, MOSI, SCK, SS). </li><li>  UART es una funci√≥n de uno de los pines de la interfaz UART (RX o TX). </li><li>  Funci√≥n de entrada anal√≥gica </li><li>  Funci√≥n de salida anal√≥gica (a√∫n no se utiliza en FLProg, retraso para el futuro). </li><li>  Funci√≥n de entrada / salida digital. </li></ul><br>  Asigne la funci√≥n de entrada / salida digital del pin 1.  Al asignar una nueva funci√≥n (a√∫n no configurada) a la salida, la rama "Errores" aparecer√° en el √°rbol del controlador y toda la ruta a la rama de la funci√≥n incorrecta se volver√° roja.  En la rama "Errores", puede ver una lista de errores encontrados en la descripci√≥n del controlador. <br><br><img src="https://habrastorage.org/webt/fu/c5/l6/fuc5l68t2uqnnb018st1us7kp84.png"><br><br>  En este caso, la entrada 1 en la funci√≥n "Entrada / salida digital" no especifica el n√∫mero de esta entrada como digital.  Cambiamos a la rama de esta funci√≥n (en el futuro planeo hacer una transici√≥n directa a la rama deseada cuando hago clic en un error). <br><br><img src="https://habrastorage.org/webt/m5/86/hp/m586hpytkvzarwhavx6lf1a2lcm.png"><br><br>  Seg√∫n el diagrama del circuito de la placa, la salida "Entrada1" est√° conectada al pin GPIO2 del controlador.  Ingresamos este valor en el campo "N√∫mero de entrada digital".  Al compilar un proyecto, este valor se insertar√° en el c√≥digo.  Como no se proporciona el uso de esta entrada como salida, eliminamos la casilla de verificaci√≥n "Se puede usar como salida".  Como siempre, haga clic en el bot√≥n "Aplicar".  Del mismo modo, configure las otras dos entradas digitales.  Luego vaya a la salida de la entrada anal√≥gica "ADC1" y agregue la funci√≥n "Entrada anal√≥gica". <br><br><img src="https://habrastorage.org/webt/i5/vb/6j/i5vb6johktcuk0mym00jifsptqm.png"><br><br>  En la configuraci√≥n de esta funci√≥n, debe especificar el n√∫mero de esta salida como entrada anal√≥gica.  Seg√∫n el esquema, este es 0 (en ESP8266 es uno). <br><br><img src="https://habrastorage.org/webt/jh/yl/vs/jhylvsjhmvsl6dbki2nsnmu-aoe.png"><br><br>  Luego vaya a la configuraci√≥n de salida "1WIRE".  Aqu√≠ le agregamos la funci√≥n de entrada / salida digital, pero prohibimos su uso tanto de entrada como de salida.  Como resultado, estar√° disponible para su selecci√≥n solo en los bloques de sensores y no estar√° disponible al crear entradas y salidas. <br><br><img src="https://habrastorage.org/webt/5o/s-/3i/5os-3i6f-756ojmbhfn0jrblftm.png"><br><br>  Los ajustes de las salidas ‚ÄúK1‚Äù - ‚ÄúK3‚Äù son similares a los ajustes de las entradas ‚ÄúEntrada1‚Äù - ‚ÄúEntrada3‚Äù solo en el caso de las salidas, prohibimos que se utilicen como entrada. <br><br><img src="https://habrastorage.org/webt/wc/vh/nl/wcvhnl5d42ola1rk3cmcgqltpjy.png"><br><br><img src="https://habrastorage.org/webt/e3/qj/1y/e3qj1yyzrzn36t-plzwu_nl7-sq.png"><br><br>  Vaya a la rama "Im√°genes".  En √©l, podemos agregar im√°genes cargadas en la descripci√≥n del controlador, por ejemplo, con la apariencia del controlador, pinout, etc. <br><br>  Tenga en cuenta que las im√°genes se cargan directamente en la descripci√≥n del controlador y se almacenan en un proyecto creado con √©l.  Por lo tanto, no suba im√°genes grandes.  Esto implicar√° un aumento en el tama√±o del proyecto y afectar√° la velocidad de su apertura. <br><br>  La imagen se agrega mediante el bot√≥n "Agregar imagen". <br><br><img src="https://habrastorage.org/webt/f_/ar/so/f_arso1h9wd207bcwxg0yx8rbjm.png"><br><br>  Despu√©s de seleccionar y cargar una imagen (solo se admite el formato PNG), se crea una rama separada para cada imagen en el √°rbol.  En esta rama, puede especificar un nombre para la imagen descargada, que se mostrar√° en la informaci√≥n del controlador. <br><br><img src="https://habrastorage.org/webt/9f/th/jb/9fthjbpdldgi5zzbmye2ior6kyw.png"><br><br>  Si es necesario, puede cargar varias im√°genes y configurarlas en el orden deseado. <br><br><img src="https://habrastorage.org/webt/b_/cv/lx/b_cvlxb8-0zaxazygmrj300mkhy.png"><br><br><img src="https://habrastorage.org/webt/ru/wh/nu/ruwhnuvfvcuhntsygr0hpapxed0.png"><br><br>  Pasamos a la rama "Bloques est√°ndar". <br><br><img src="https://habrastorage.org/webt/5e/nr/gg/5enrggudk1-qgs36xmh1ryem1f8.png"><br><br>  Esta rama muestra los bloques que se pueden representar en la biblioteca de bloques est√°ndar del programa de acuerdo con la configuraci√≥n actual del programa.  ¬øQu√© significa eso?  Algunos de los componentes b√°sicos del programa est√°n destinados solo a ciertos tipos de CPU.  Y su disponibilidad depende del procesador seleccionado.  Adem√°s, los bloques dise√±ados para funcionar con SPI, I2C, UART aparecer√°n en esta lista solo si las funciones correspondientes se agregan a los pines del controlador.  Los bloques dise√±ados para funcionar con la EEPROM aparecer√°n solo si el tama√±o de la EEPROM especificado en la rama de los par√°metros generales del controlador es mayor que cero, o si la funci√≥n I2C se agrega a los pines del controlador.  Por defecto, todos los bloques de la biblioteca est√°n prohibidos para su uso (marcado en naranja).  Puede permitir el uso de un bloque separado o de toda la carpeta de bloques resaltando la rama necesaria y haciendo clic en el bot√≥n "Permitir", o desde el men√∫ contextual. <br><br><img src="https://habrastorage.org/webt/_g/-f/cc/_g-fccqwf5_0twhukgxs6wfxhwo.png"><br><br>  Cuando permite que se muestre un bloque o carpeta de bloques en el programa, se pintan de negro. <br><br>  El bloqueo de un bloque o una carpeta separada est√° prohibido de la misma manera. <br><br><img src="https://habrastorage.org/webt/dc/yo/4p/dcyo4p2p6mj8c1zqtj_p_mymupw.png"><br><br>  En una carpeta en la que no se pueden mostrar todos los bloques, est√°n marcados con tres asteriscos antes y despu√©s del nombre. <br><br>  Prohibimos el uso de motores, relojes en tiempo real, pantallas, unidades de control IR, sensores (excepto los sensores DS18B20 y DHT22, ya que el desarrollador de la placa hasta ahora solo ha anunciado su soporte), chips de expansi√≥n y un altavoz piezoel√©ctrico. <br><br><img src="https://habrastorage.org/webt/co/ip/ji/coipji0n9m9oho6ed6jjpuatuu8.png"><br><br>  Haremos lo mismo para el lenguaje LAD <br><br><img src="https://habrastorage.org/webt/h9/-u/xe/h9-uxez75k-8pyzyi08vk7z-p4m.png"><br><br>  No olvides aplicarlos despu√©s de hacer cambios. <br><br>  Las ramas restantes de la descripci√≥n del controlador se discutir√°n en la pr√≥xima publicaci√≥n, mientras que la configuraci√≥n actual es suficiente para usar esta placa en particular en el programa FLProg. <br><br>  Por ahora, solo dir√© brevemente que la rama "Bloques especiales" se usa para cargar bloques personalizados en la descripci√≥n, que se mostrar√° en la biblioteca de bloques est√°ndar en el programa cuando se usa este controlador.  La rama "C√≥digo especial" se usa para registrar el c√≥digo que siempre se insertar√° en el c√≥digo compilado, y la rama "Bibliotecas especiales" se usa para cargar bibliotecas en la descripci√≥n del controlador, que se cargar√° en la carpeta \ bibliotecas ArduinoIDE con la que funciona el programa. <br><br>  Despu√©s de todos los cambios, guarde la biblioteca de descripci√≥n del controlador. <br><br><img src="https://habrastorage.org/webt/x0/oe/d7/x0oed7fkffsba-owxcfxvgchyjm.png"><br><br>  Ahora intentemos usar la descripci√≥n del controlador que creamos. <br>  En el programa FLProg, creamos un nuevo proyecto para el controlador. <br><br><img src="https://habrastorage.org/webt/dx/7w/ya/dx7wyao116azs1a2lwrpoa1tt4i.png"><br><br>  Abra la ventana de selecci√≥n del controlador. <br><br><img src="https://habrastorage.org/webt/l4/5f/wt/l45fwtcbztx_s8w9p71skiimmyo.png"><br><br>  Y seleccione la descripci√≥n que creamos. <br><br><img src="https://habrastorage.org/webt/dq/ly/jp/dqlyjprofstw-fkadjd1jiguzl4.png"><br><br>  Al elegir un controlador, puede ver sus im√°genes y, si es necesario, guardar lo necesario en un archivo. <br><br><img src="https://habrastorage.org/webt/ba/ni/gw/banigw8zc9shyyogovawmcvlyxy.png"><br><br><img src="https://habrastorage.org/webt/rh/ra/ss/rhrasshfamvayeljiqnmceepo3g.png"><br><br>  Tambi√©n puedes ver otros par√°metros <br><br><img src="https://habrastorage.org/webt/gf/6p/wd/gf6pwdh-67cn9e8cbm0k4utlbw0.png"><br><br>  Despu√©s de seleccionar el controlador, confirme su selecci√≥n: <br><br><img src="https://habrastorage.org/webt/d0/7x/fy/d07xfyaacufag5wf1zqmcokjjd8.png"><br><br>  Como resultado, se abre la ventana principal de trabajo del proyecto, configurada de acuerdo con el controlador seleccionado. <br><br><img src="https://habrastorage.org/webt/dz/my/qj/dzmyqjeks591vtjfqnqhqnhvty4.png"><br><br>  El prop√≥sito de esta publicaci√≥n no incluye la tarea de capacitaci√≥n para trabajar con el programa FLProg.  Esto est√° bastante bien descrito en mis <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">publicaciones anteriores</a> , en <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el sitio web del proyecto</a> y en el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">foro del proyecto</a> .  Adem√°s, ya hay muchos canales en YouTube donde se publican videos tutoriales sobre c√≥mo trabajar con el programa.  Por ejemplo, un muy buen canal <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">"Clave para Arduino"</a> , justo ahora est√° llevando a cabo una serie de lecciones, con una muy buena presentaci√≥n del material. <br><br>  Por lo tanto, por ejemplo, simplemente creamos un proyecto simple e intentamos compilarlo. <br>  Primero, agregue la entrada del controlador. <br><br><img src="https://habrastorage.org/webt/4c/94/wf/4c94wfvporudssfe-mdvmg6fenm.png"><br><br>  Solo las conclusiones que nos permitieron trabajar en esa capacidad est√°n disponibles para su selecci√≥n como entrada. <br><br><img src="https://habrastorage.org/webt/yy/dk/fi/yydkfixeg0aemh73lrqunx1qq_a.png"><br><br>  Luego cree una salida digital.  Solo las conclusiones permitidas tambi√©n est√°n disponibles aqu√≠. <br><br><img src="https://habrastorage.org/webt/mk/cq/qm/mkcqqm7djcs0klswidh2qkm2bt8.png"><br><br>  Ensamblamos el circuito de modo que cuando se presiona el bot√≥n de la Entrada 1 (Entrada 1), se activa el rel√© K1 (Rel√© 1). <br>  Tambi√©n extraemos la unidad para leer informaci√≥n del sensor DS18B20 en una placa de circuito en una placa separada. <br><br><img src="https://habrastorage.org/webt/xn/wa/2p/xnwa2pfpn7em5w2irs5meayndbc.png"><br><br>  Vaya a la configuraci√≥n de bloque.  Al crear el nuevo bus OneWire, vemos que todas las entradas / salidas digitales est√°n disponibles para su selecci√≥n.  Esta es una falla en la versi√≥n 6.0.  Pero dado que esta versi√≥n todav√≠a tiene estado beta, es excusable.  En la versi√≥n 6.1, ser√° posible prohibir el uso de un pin como sensor, sensor o para chips de expansi√≥n.  Adem√°s, en la pr√≥xima publicaci√≥n te contar√© otra forma de resolver este problema.  Por ahora, seleccione 1WIRE pin. <br><br><img src="https://habrastorage.org/webt/yi/0n/i0/yi0ni02zslfqijbthixnw4yeq_m.png"><br><br>  Configuramos el sensor para establecer la direcci√≥n a trav√©s de la matriz. <br><br><img src="https://habrastorage.org/webt/nu/ft/9h/nuft9hg43uwk_toqi1yanem1miq.png"><br><br>  Insertamos una nueva placa frente a la primera y extraemos el bloque "OneWire Bus Scan". <br><br><img src="https://habrastorage.org/webt/qv/21/r5/qv21r5i9ggwzcovlis6k9kg3f9u.png"><br><br>  Lo configuramos en el mismo bus OneWire y en la misma matriz, en la que est√° configurada la unidad de lectura del sensor DS18B20. <br><br><img src="https://habrastorage.org/webt/vm/cm/ri/vmcmrigupgqdmnxfbb8fcwfuluc.png"><br><br>  Ensamblamos un esquema para un inicio √∫nico de una exploraci√≥n de bus cuando se inicia el controlador, utilizando el bloque R del disparador (selecci√≥n del borde de ataque). <br><br><img src="https://habrastorage.org/webt/vh/xd/2l/vhxd2l7bxk3afyi7obm1kaix9l0.png"><br><br>  En una placa con una unidad de lectura de datos del sensor DS18B20, ensamblamos un circuito de encendido / apagado de rel√© con hist√©resis.  Para esto, utilizamos dos comparadores y un disparador SR.  Gracias a este esquema, el rel√© 2 se encender√° cuando la temperatura baje a menos de 10 grados y se apagar√° cuando la temperatura suba a m√°s de 20 grados. <br><br><img src="https://habrastorage.org/webt/55/nw/3y/55nw3y062rknemyx2c7ouyavwgm.png"><br><br>  Comenzamos el esquema de compilaci√≥n. <br><br><img src="https://habrastorage.org/webt/oh/tr/so/ohtrso3_hk9k13yizhsgy8stp0o.png"><br><br>  Como resultado, el c√≥digo resultante se abrir√° en el IDE de Arduino.  Como placa, seleccionamos NodeMCU, en el que se instala el mismo chip que en ShloTiny.  Verificar el c√≥digo muestra que es correcto y se puede descargar. <br><br><img src="https://habrastorage.org/webt/lv/jy/dc/lvjydc9b531j1inhq5vuumgn0n0.png"><br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo compilado</b> <div class="spoiler_text"><pre><code class="plaintext hljs">#include &lt;OneWire.h&gt; extern "C" { #include "user_interface.h"; } OneWire _ow13(13); byte _FLPArray133289689[9]; unsigned long _d18x2x1Tti = 0UL; float _d18x2x1O = 0.00; bool _trgr1 = 0; bool _bounseInputD2S = 0; bool _bounseInputD2O = 0; unsigned long _bounseInputD2P = 0UL; bool _trgrt1 = 0; bool _trgrt1I = 0; bool _sowb1_needScan = 0; bool _sowb1_ost = 0; bool _sowb1_Out_1 = 0; void setup() { pinMode(2, INPUT); pinMode(12, OUTPUT); pinMode(14, OUTPUT); _bounseInputD2O = digitalRead(2); } void loop() { bool _bounceInputTmpD2 = (digitalRead (2)); if (_bounseInputD2S) { if (millis() &gt;= (_bounseInputD2P + 40)) { _bounseInputD2O = _bounceInputTmpD2; _bounseInputD2S = 0; } } else { if (_bounceInputTmpD2 != _bounseInputD2O ) { _bounseInputD2S = 1; _bounseInputD2P = millis(); } } //:1 if (1) { if (_trgrt1I) { _trgrt1 = 0; } else { _trgrt1 = 1; _trgrt1I = 1; } } else { _trgrt1 = 0; _trgrt1I = 0; }; if (_sowb1_needScan) { if ( _oneWireSeach (_FLPArray133289689, _ow13)) { _sowb1_Out_1 = 1; } _ow13.reset_search(); _sowb1_needScan = 0; } if (_trgrt1) { if (! _sowb1_ost) { _sowb1_ost = 1; _sowb1_needScan = 1; _sowb1_Out_1 = 0; } } else { _sowb1_ost = 0; } //:2 digitalWrite(12, !(_bounseInputD2O)); //:3 if (_isTimer(_d18x2x1Tti, 1000)) { _d18x2x1Tti = millis(); _d18x2x1O = _readDS18_ow13(_FLPArray133289689, _FLPArray133289689[8]); } if (((_d18x2x1O)) &gt; (20)) _trgr1 = 0; if (((_d18x2x1O)) &lt; (10)) _trgr1 = 1; digitalWrite(14, _trgr1); } bool _isTimer(unsigned long startTime, unsigned long period ) { unsigned long currentTime; currentTime = millis(); if (currentTime &gt;= startTime) { return (currentTime &gt;= (startTime + period)); } else { return (currentTime &gt;= (4294967295 - startTime + period)); } } float _convertDS18x2xData(byte type_s, byte data[12]) { int16_t raw = (data[1] &lt;&lt; 8) | data[0]; if (type_s) { raw = raw &lt;&lt; 3; if (data[7] == 0x10) { raw = (raw &amp; 0xFFF0) + 12 - data[6]; } } else { byte cfg = (data[4] &amp; 0x60); if (cfg == 0x00) raw = raw &amp; ~7; else if (cfg == 0x20) raw = raw &amp; ~3; else if (cfg == 0x40) raw = raw &amp; ~1; } return (float)raw / 16.0; } float _readDS18_ow13(byte addr[8], byte type_s) { byte data[12]; byte i; _ow13.reset(); _ow13.select(addr); _ow13.write(0xBE); for ( i = 0; i &lt; 9; i++) { data[i] = _ow13.read(); } _ow13.reset(); _ow13.select(addr); _ow13.write(0x44, 1); return _convertDS18x2xData(type_s, data); } bool _oneWireSeach (byte array[], OneWire ow ) { byte temp[8]; byte i; if ( !ow.search(temp)) { return false; } if (OneWire::crc8(temp, 7) != temp[7]) { return false; } switch (temp[0]) { case 0x10: array[8] = 1; break; case 0x28: array[8] = 0; break; case 0x22: array[8] = 0; break; default: return false; } for ( i = 0; i &lt; 8; i++) { array[i] = temp[i]; } return true; }</code> </pre> <br></div></div><br>  ‚Üí <a href="">Descripci√≥n del controlador ShloTiny para el programa FLProg</a> <br><br>  Terminaremos esta lecci√≥n, en la pr√≥xima publicaci√≥n trataremos de describir algo m√°s serio y m√°s cercano a los controladores industriales "reales". </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/467007/">https://habr.com/ru/post/467007/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../466993/index.html">Configuraci√≥n del complemento Warnings Next Generation para la integraci√≥n con PVS-Studio</a></li>
<li><a href="../466995/index.html">Configuraci√≥n del complemento Warnings Next Generation para la integraci√≥n de PVS-Studio</a></li>
<li><a href="../466999/index.html">Comparaci√≥n de las bibliotecas de CLI populares para Python: click, cement, fire y otras</a></li>
<li><a href="../467003/index.html">Men√∫ r√°pido, conveniente y adaptable para 1075 categor√≠as (36000 productos)</a></li>
<li><a href="../467005/index.html">C√≥mo colorear los polinomios correctamente</a></li>
<li><a href="../467009/index.html">Hacer una biblioteca dom√©stica con Notion y Python</a></li>
<li><a href="../467011/index.html">Qu√© leer y ver para comenzar en Data Science: libros, diccionarios y cursos</a></li>
<li><a href="../467015/index.html">JWT: ataque de firma digital frente a ataque MAC</a></li>
<li><a href="../467017/index.html">¬øQu√© es HED / MRSD y para qu√© sirve?</a></li>
<li><a href="../467019/index.html">Dise√±o de paneles de control para el sitio de comercio electr√≥nico de an√°lisis web. Parte 3: Canal SEO</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>