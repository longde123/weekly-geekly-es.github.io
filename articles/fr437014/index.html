<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘©ğŸ» ğŸ’¼ ğŸ˜ La tÃ¢che de N corps ou comment faire sauter une galaxie sans quitter la cuisine ğŸ˜— âš½ï¸ ğŸš£ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il n'y a pas si longtemps, j'ai lu le roman de science-fiction Â«Le problÃ¨me des trois corpsÂ» de Liu Qixin . Certains extraterrestres y avaient un prob...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>La tÃ¢che de N corps ou comment faire sauter une galaxie sans quitter la cuisine</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437014/"><br><img src="https://habrastorage.org/webt/ke/eo/en/keeoenv3rtuxqu19szhk5hzfb7q.png"><br><br>  Il n'y a pas si longtemps, j'ai lu le roman de science-fiction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Â«Le problÃ¨me des trois corpsÂ» de Liu Qixin</a> .  Certains extraterrestres y avaient un problÃ¨me - ils ne savaient pas comment, avec une prÃ©cision suffisante pour eux, calculer la trajectoire de leur planÃ¨te d'origine.  Contrairement Ã  nous, ils vivaient dans un systÃ¨me Ã  trois Ã©toiles, et le Â«tempsÂ» sur la planÃ¨te dÃ©pendait fortement de leur emplacement relatif - de la chaleur incinÃ©rante au froid glacial.  Et j'ai dÃ©cidÃ© de vÃ©rifier si nous pouvons rÃ©soudre de tels problÃ¨mes. <br><a name="habracut"></a><br><h2>  Physique du phÃ©nomÃ¨ne </h2><br>  Pour comprendre le problÃ¨me, il est nÃ©cessaire de traiter la physique du phÃ©nomÃ¨ne.  Dans le cadre de la thÃ©orie classique, la force d'attraction de deux corps est dÃ©terminÃ©e par <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la</a> loi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">de Newton</a> : <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mrow" id="MJXp-Span-6"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">F</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;">v </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-msubsup" id="MJXp-Span-13"><span class="MJXp-mrow" id="MJXp-Span-14" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;">r</font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-13"><span class="MJXp-mn MJXp-script" id="MJXp-Span-16" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"> 1</font></span></span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"> , </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;">v </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-msubsup" id="MJXp-Span-22"><span class="MJXp-mrow" id="MJXp-Span-23" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;">r</font></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-22"><span class="MJXp-mn MJXp-script" id="MJXp-Span-25" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"> 2</font></span></span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> ) </font></span><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;">= </font></span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">- </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;">G </font></span><span class="MJXp-msubsup" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">m </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-30"><span class="MJXp-mn MJXp-script" id="MJXp-Span-32" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">1 </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">m </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-33"><span class="MJXp-mn MJXp-script" id="MJXp-Span-35" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">2</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"> f </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;">r </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;">a </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;">c </font></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43"><font style="vertical-align: inherit;">v </font></span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;">e </font></span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;">c </font></span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-msubsup" id="MJXp-Span-46"><span class="MJXp-mrow" id="MJXp-Span-47" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;">r</font></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-msubsup" id="MJXp-Span-46"><span class="MJXp-mn MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"> 1</font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"> - </font></span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52"><font style="vertical-align: inherit;">v </font></span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;">e </font></span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;">c </font></span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-msubsup" id="MJXp-Span-55"><span class="MJXp-mrow" id="MJXp-Span-56" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57"><font style="vertical-align: inherit;">r</font></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-msubsup" id="MJXp-Span-55"><span class="MJXp-mn MJXp-script" id="MJXp-Span-58" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"> 2 </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mrow" id="MJXp-Span-60"><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;">| </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63"><font style="vertical-align: inherit;">v </font></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;">e </font></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65"><font style="vertical-align: inherit;">c </font></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mrow" id="MJXp-Span-67" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68"><font style="vertical-align: inherit;">r</font></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mn MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"> 1</font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"> - </font></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72"><font style="vertical-align: inherit;">v </font></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;">e </font></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74"><font style="vertical-align: inherit;">c </font></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-msubsup" id="MJXp-Span-75"><span class="MJXp-mrow" id="MJXp-Span-76" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77"><font style="vertical-align: inherit;">r</font></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-msubsup" id="MJXp-Span-75"><span class="MJXp-mn MJXp-script" id="MJXp-Span-78" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"> 2 </font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mrow" id="MJXp-Span-80" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;">| </font></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mn MJXp-script" id="MJXp-Span-82" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;">3</font></span></span></span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"> ,</font></span></font><span class="MJXp-mtext" id="MJXp-Span-9">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-13"><span class="MJXp-mrow" id="MJXp-Span-14" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-16" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-18">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-22"><span class="MJXp-mrow" id="MJXp-Span-23" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-25" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-27" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-30"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-32" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-35" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-36">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-41"><span class="MJXp-mtext" id="MJXp-Span-42">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-46"><span class="MJXp-mrow" id="MJXp-Span-47" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-49" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-51">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-55"><span class="MJXp-mrow" id="MJXp-Span-56" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-58" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-59"><span class="MJXp-mrow" id="MJXp-Span-60"><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-62">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-66"><span class="MJXp-mrow" id="MJXp-Span-67" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-71">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-75"><span class="MJXp-mrow" id="MJXp-Span-76" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-78" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mrow" id="MJXp-Span-80" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-81" style="margin-left: 0.167em; margin-right: 0.167em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-82" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"></font></span></span></span><span class="MJXp-mo" id="MJXp-Span-83" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="70.534ex" height="3.142ex" viewBox="0 -1039.5 30368.8 1352.7" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="1202" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-46" x="1635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-28" x="2385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="3024" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="3510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="3976" y="0"></use><g transform="translate(4410,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-31" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2C" x="5315" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="6010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="6496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="6962" y="0"></use><g transform="translate(7396,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-32" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-29" x="8301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-3D" x="8968" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2212" x="10025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-47" x="10803" y="0"></use><g transform="translate(11590,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-31" x="1242" y="-213"></use></g><g transform="translate(12922,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-32" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-66" x="14504" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="15055" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-61" x="15506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="16036" y="0"></use><g transform="translate(16469,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-31" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2212" x="2763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="4013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="4499" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="4965" y="0"></use><g transform="translate(5399,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-32" x="638" y="-213"></use></g></g><g transform="translate(22774,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="1014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="1480" y="0"></use><g transform="translate(1914,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-31" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2212" x="3041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="4292" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="4777" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="5244" y="0"></use><g transform="translate(5677,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-32" x="638" y="-213"></use></g><g transform="translate(6583,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-33" x="393" y="675"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2C" x="30090" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> \ vec {F} (\ vec {r} _1, \ vec {r} _2) = - G m_1 m_2 \ frac {\ vec {r} _1 - \ vec {r} _2} {| \ vec {r} _1 - \ vec {r} _2 | ^ 3}, </script></p><br><br>  oÃ¹ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-84"><span class="MJXp-mtext" id="MJXp-Span-85">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">c</span><span class="MJXp-msubsup" id="MJXp-Span-89"><span class="MJXp-mrow" id="MJXp-Span-90" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">r</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-92" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-94">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">c</span><span class="MJXp-msubsup" id="MJXp-Span-98"><span class="MJXp-mrow" id="MJXp-Span-99" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">r</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-101" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.837ex" height="1.817ex" viewBox="0 -520.7 5527 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-31" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2C" x="2540" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="3236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="3721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="4188" y="0"></use><g transform="translate(4621,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-32" x="638" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ vec {r} _1, \ vec {r} _2 </script>  - la position des corps dans l'espace, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-102"><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108" style="margin-right: 0.05em;">m</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-109" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.223ex" height="1.817ex" viewBox="0 -520.7 3110 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-31" x="1242" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2C" x="1332" y="0"></use><g transform="translate(1777,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-32" x="1242" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> m_1, m_2 </script>  - masses de corps, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-110"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-111">G</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-47" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> G </script>  - constante gravitationnelle. <br>  Dans le systÃ¨me de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> N </script>  Les corps sur chacun d'eux seront affectÃ©s par la force d'attraction du reste, qui est exprimÃ©e par l'Ã©quation: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-114"><span class="MJXp-mtext" id="MJXp-Span-115">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">c</span><span class="MJXp-msubsup" id="MJXp-Span-119"><span class="MJXp-mrow" id="MJXp-Span-120" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">F</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-122" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-123" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-124" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">G</span><span class="MJXp-mtext" id="MJXp-Span-126">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">u</span><span class="MJXp-msubsup" id="MJXp-Span-129"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-131" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">k</span><span class="MJXp-mtext" id="MJXp-Span-133">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-140" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-msubsup" id="MJXp-Span-141"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-143" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mtext" id="MJXp-Span-144">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">c</span><span class="MJXp-mrow" id="MJXp-Span-149"><span class="MJXp-mtext" id="MJXp-Span-150">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">c</span><span class="MJXp-msubsup" id="MJXp-Span-154"><span class="MJXp-mrow" id="MJXp-Span-155" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-157" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-159">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">c</span><span class="MJXp-msubsup" id="MJXp-Span-163"><span class="MJXp-mrow" id="MJXp-Span-164" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-165">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-166" style="vertical-align: -0.4em;">k</span></span></span><span class="MJXp-mrow" id="MJXp-Span-167"><span class="MJXp-mrow" id="MJXp-Span-168"><span class="MJXp-mo" id="MJXp-Span-169" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-170">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">c</span><span class="MJXp-msubsup" id="MJXp-Span-174"><span class="MJXp-mrow" id="MJXp-Span-175" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-177" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-179">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-180">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">c</span><span class="MJXp-msubsup" id="MJXp-Span-183"><span class="MJXp-mrow" id="MJXp-Span-184" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-186" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-187"><span class="MJXp-mrow" id="MJXp-Span-188" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-190" style="vertical-align: 0.5em;">3</span></span></span><span class="MJXp-mo" id="MJXp-Span-191" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="67.662ex" height="3.262ex" viewBox="0 -1039.5 29132.1 1404.6" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="910" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-3D" x="3081" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2212" x="4137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-47" x="4916" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-73" x="5952" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-75" x="6422" y="0"></use><g transform="translate(6994,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="875" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="1475" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-71" x="1942" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="2402" y="0"></use></g></g><g transform="translate(10096,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="1242" y="-213"></use></g><g transform="translate(11499,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6B" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-66" x="13097" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="13647" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-61" x="14099" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="14628" y="0"></use><g transform="translate(15062,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2212" x="2833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="4084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="4570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="5036" y="0"></use><g transform="translate(5470,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6B" x="638" y="-213"></use></g></g><g transform="translate(21452,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="1014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="1480" y="0"></use><g transform="translate(1914,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2212" x="3112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="4363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="4848" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="5315" y="0"></use><g transform="translate(5748,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6B" x="638" y="-213"></use></g><g transform="translate(6668,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-33" x="393" y="675"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2E" x="28853" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> \ vec {F} _n = -G \ sum_ {k \ neq n} m_n m_k \ frac {\ vec {r} _n - \ vec {r} _k} {| \ vec {r} _n - \ vec {r } _k | ^ 3}. </script></p><br><br>  En utilisant <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la deuxiÃ¨me loi de Newton,</a> nous Ã©crivons l'accÃ©lÃ©ration pour chaque particule: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-192"><span class="MJXp-mtext" id="MJXp-Span-193">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-196">c</span><span class="MJXp-msubsup" id="MJXp-Span-197"><span class="MJXp-mrow" id="MJXp-Span-198" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">a</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-200" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-201" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-202">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">c</span><span class="MJXp-msubsup" id="MJXp-Span-206"><span class="MJXp-mrow" id="MJXp-Span-207" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">F</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-209" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mrow" id="MJXp-Span-210"><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-214" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-215" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-216" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">G</span><span class="MJXp-mtext" id="MJXp-Span-218">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">u</span><span class="MJXp-msubsup" id="MJXp-Span-221"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-223" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">k</span><span class="MJXp-mtext" id="MJXp-Span-225">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-228">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-232" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mtext" id="MJXp-Span-233">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-236">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">c</span><span class="MJXp-mrow" id="MJXp-Span-238"><span class="MJXp-mtext" id="MJXp-Span-239">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">c</span><span class="MJXp-msubsup" id="MJXp-Span-243"><span class="MJXp-mrow" id="MJXp-Span-244" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-246" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-247" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">c</span><span class="MJXp-msubsup" id="MJXp-Span-252"><span class="MJXp-mrow" id="MJXp-Span-253" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-255" style="vertical-align: -0.4em;">k</span></span></span><span class="MJXp-mrow" id="MJXp-Span-256"><span class="MJXp-mrow" id="MJXp-Span-257"><span class="MJXp-mo" id="MJXp-Span-258" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-259">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-262">c</span><span class="MJXp-msubsup" id="MJXp-Span-263"><span class="MJXp-mrow" id="MJXp-Span-264" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-266" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-267" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-268">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-269">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">c</span><span class="MJXp-msubsup" id="MJXp-Span-272"><span class="MJXp-mrow" id="MJXp-Span-273" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-275" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-276"><span class="MJXp-mrow" id="MJXp-Span-277" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-279" style="vertical-align: 0.5em;">3</span></span></span><span class="MJXp-mo" id="MJXp-Span-280" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="78.17ex" height="3.262ex" viewBox="0 -1039.5 33656.2 1404.6" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="748" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-3D" x="2967" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="4273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="4759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="5225" y="0"></use><g transform="translate(5659,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-46" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="910" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2F" x="6827" y="0"></use><g transform="translate(7327,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-3D" x="9008" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2212" x="10064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-47" x="10843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-73" x="11879" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-75" x="12349" y="0"></use><g transform="translate(12921,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="875" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="1475" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-71" x="1942" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="2402" y="0"></use></g></g><g transform="translate(16023,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6B" x="1242" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-66" x="17621" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="18171" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-61" x="18623" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="19152" y="0"></use><g transform="translate(19586,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="1202" y="0"></use><g transform="translate(1635,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2212" x="2833" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="4084" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="4570" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="5036" y="0"></use><g transform="translate(5470,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6B" x="638" y="-213"></use></g></g><g transform="translate(25976,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="1014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="1480" y="0"></use><g transform="translate(1914,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6E" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2212" x="3112" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-76" x="4363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-65" x="4848" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-63" x="5315" y="0"></use><g transform="translate(5748,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMATHI-6B" x="638" y="-213"></use></g><g transform="translate(6668,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-33" x="393" y="675"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/437014/&amp;usg=ALkJrhio5P5mowT3yxTsOk603u1_LtFnUw#MJMAIN-2E" x="33377" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> \ vec {a} _n = \ vec {F} _n / m_n = -G \ sum_ {k \ neq n} m_k \ frac {\ vec {r} _n - \ vec {r} _k} {| \ vec { r} _n - \ vec {r} _k | ^ 3}. </script></p><br><br>  Rappelant que l'accÃ©lÃ©ration est la dÃ©rivÃ©e seconde du temps de la coordonnÃ©e, nous obtenons une Ã©quation diffÃ©rentielle partielle de second ordre, qui doit Ãªtre rÃ©solue pour obtenir la trajectoire de chaque corps: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-281"><span class="MJXp-mtext" id="MJXp-Span-282">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">c</span><span class="MJXp-mrow" id="MJXp-Span-287"><span class="MJXp-mtext" id="MJXp-Span-288">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">a</span><span class="MJXp-msubsup" id="MJXp-Span-295"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296" style="margin-right: 0.05em;">l</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-297" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mtext" id="MJXp-Span-298">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-300">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">c</span><span class="MJXp-msubsup" id="MJXp-Span-302"><span class="MJXp-mrow" id="MJXp-Span-303" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-305" style="vertical-align: -0.4em;">n</span></span></span><span class="MJXp-mrow" id="MJXp-Span-306"><span class="MJXp-mtext" id="MJXp-Span-307">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-309">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">l</span><span class="MJXp-msubsup" id="MJXp-Span-315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-317" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-318" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-319"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-321" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-323" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">G</span><span class="MJXp-mtext" id="MJXp-Span-325">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">u</span><span class="MJXp-msubsup" id="MJXp-Span-328"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-330" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">k</span><span class="MJXp-mtext" id="MJXp-Span-332">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-333">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-334">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">n</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338" style="margin-right: 0.05em;">m</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-339" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mtext" id="MJXp-Span-340">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-341">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-344">c</span><span class="MJXp-mrow" id="MJXp-Span-345"><span class="MJXp-mtext" id="MJXp-Span-346">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">c</span><span class="MJXp-msubsup" id="MJXp-Span-350"><span class="MJXp-mrow" id="MJXp-Span-351" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-352">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-353" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-355">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-356">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-357">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">c</span><span class="MJXp-msubsup" id="MJXp-Span-359"><span class="MJXp-mrow" id="MJXp-Span-360" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-361">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-362" style="vertical-align: -0.4em;">k</span></span></span><span class="MJXp-mrow" id="MJXp-Span-363"><span class="MJXp-mrow" id="MJXp-Span-364"><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-366">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">c</span><span class="MJXp-msubsup" id="MJXp-Span-370"><span class="MJXp-mrow" id="MJXp-Span-371" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-373" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-374" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mtext" id="MJXp-Span-375">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">c</span><span class="MJXp-msubsup" id="MJXp-Span-379"><span class="MJXp-mrow" id="MJXp-Span-380" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-382" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-msubsup" id="MJXp-Span-383"><span class="MJXp-mrow" id="MJXp-Span-384" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-386" style="vertical-align: 0.5em;">3</span></span></span><span class="MJXp-mo" id="MJXp-Span-387" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-8"> \ frac {\ partial ^ 2 \ vec {r} _n} {\ partial t ^ 2} = f_n = -G \ sum_ {k \ neq n} m_k \ frac {\ vec {r} _n - \ vec {r } _k} {| \ vec {r} _n - \ vec {r} _k | ^ 3}. </script></p><br>  Il est important de noter ici que la complexitÃ© du calcul d'une fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-388"><span class="MJXp-msubsup" id="MJXp-Span-389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-391" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> f_n </script>  est Ã©gal Ã  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-392"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">O</span><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-395"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-397" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-398" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-10"> O (N ^ 2) </script>  et augmente de maniÃ¨re significative avec l'augmentation du nombre de corps en interaction. <br><br><h2>  Math </h2><br>  La premiÃ¨re et la plus simple mÃ©thode pour rÃ©soudre des Ã©quations diffÃ©rentielles est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la mÃ©thode d'Euler</a> , qui est conÃ§ue pour rÃ©soudre des Ã©quations de la forme: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-399"><span class="MJXp-mtext" id="MJXp-Span-400">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">c</span><span class="MJXp-mrow" id="MJXp-Span-405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">y</span></span><span class="MJXp-mrow" id="MJXp-Span-408"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-409">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">x</span></span><span class="MJXp-mo" id="MJXp-Span-411" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">f</span><span class="MJXp-mo" id="MJXp-Span-413" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">x</span><span class="MJXp-mo" id="MJXp-Span-415" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">y</span><span class="MJXp-mo" id="MJXp-Span-417" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-418" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> \ frac {dy} {dx} = f (x, y). </script></p><br>  Lors de la transition vers la rÃ©gion discrÃ¨te, nous obtenons: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-419"><span class="MJXp-msubsup" id="MJXp-Span-420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-422" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-424" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-427" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">i</span><span class="MJXp-mo" id="MJXp-Span-429">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-430">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-432">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">f</span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-437" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">i</span><span class="MJXp-mo" id="MJXp-Span-439">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-440">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-441" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-442"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-444" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-445">i</span><span class="MJXp-mo" id="MJXp-Span-446">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-447">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-448" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-450">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-455">i</span><span class="MJXp-mo" id="MJXp-Span-456" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-457">1</span><span class="MJXp-mo" id="MJXp-Span-458" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-459">2</span><span class="MJXp-mo" id="MJXp-Span-460" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-461">3</span><span class="MJXp-mo" id="MJXp-Span-462" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-463">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-465">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-466">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">s</span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">m</span><span class="MJXp-mo" id="MJXp-Span-470" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-12"> y_ {i} = y_ {i-1} + h f (x_ {i-1}, y_ {i-1}), \ quad i = 1,2,3, \ dots, m, </script></p><br>  oÃ¹ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-471"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-472">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> h </script>  Est l'Ã©tape d'intÃ©gration, et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> m </script>  - le nombre d'Ã©tapes d'intÃ©gration.  Ainsi, si nous devons calculer la position des corps Ã  la fois <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-475"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> T </script>  alors on devrait faire <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">m</span><span class="MJXp-mo" id="MJXp-Span-479" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">T</span><span class="MJXp-mrow" id="MJXp-Span-481"><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> m = T / h </script>  Ã©tapes d'intÃ©gration.  Ici, le premier problÃ¨me est visible - si <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-484"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">T</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> T </script>  grand, alors nous devons prendre un grand nombre d'Ã©tapes d'intÃ©gration. <br><br>  Pour appliquer la mÃ©thode d'Euler Ã  notre problÃ¨me, elle doit Ãªtre rÃ©duite Ã  un systÃ¨me de premier ordre.  Pour ce faire, nous introduisons une variable supplÃ©mentaire - la vitesse des particules: <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-486"><span class="MJXp-mtext" id="MJXp-Span-487">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">c</span><span class="MJXp-mrow" id="MJXp-Span-492"><span class="MJXp-mtext" id="MJXp-Span-493">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-495">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-498">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">l</span><span class="MJXp-mtext" id="MJXp-Span-501">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">c</span><span class="MJXp-msubsup" id="MJXp-Span-505"><span class="MJXp-mrow" id="MJXp-Span-506" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">v</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-508" style="vertical-align: -0.4em;">n</span></span></span><span class="MJXp-mrow" id="MJXp-Span-509"><span class="MJXp-mtext" id="MJXp-Span-510">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">t</span></span><span class="MJXp-mo" id="MJXp-Span-519" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-522" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-523" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-524" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-525">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">c</span><span class="MJXp-mrow" id="MJXp-Span-530"><span class="MJXp-mtext" id="MJXp-Span-531">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">l</span><span class="MJXp-mtext" id="MJXp-Span-539">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">c</span><span class="MJXp-msubsup" id="MJXp-Span-543"><span class="MJXp-mrow" id="MJXp-Span-544" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">r</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-546" style="vertical-align: -0.4em;">n</span></span></span><span class="MJXp-mrow" id="MJXp-Span-547"><span class="MJXp-mtext" id="MJXp-Span-548">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-550">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">t</span></span><span class="MJXp-mo" id="MJXp-Span-557" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-558">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">c</span><span class="MJXp-msubsup" id="MJXp-Span-562"><span class="MJXp-mrow" id="MJXp-Span-563" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">v</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-565" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-18"> \ frac {\ partial \ vec {v} _n} {\ partial t} = f_n, \\ \ frac {\ partial \ vec {r} _n} {\ partial t} = \ vec {v} _n. </script></p><br><br>  Le deuxiÃ¨me problÃ¨me dans la rÃ©solution de systÃ¨mes d'Ã©quations diffÃ©rentielles est la prÃ©cision de la solution et son contrÃ´le.  La prÃ©cision peut Ãªtre amÃ©liorÃ©e de deux maniÃ¨res: en diminuant l'Ã©tape d'intÃ©gration et en choisissant une mÃ©thode avec un ordre de prÃ©cision plus Ã©levÃ©.  Les deux mÃ©thodes conduisent Ã  une complexitÃ© de calcul accrue, mais de diffÃ©rentes maniÃ¨res.  Par exemple, vous pouvez utiliser la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mÃ©thode Runge-Kutta</a> classique du <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">quatriÃ¨me ordre</a> , elle nÃ©cessite quatre calculs de fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-567"><span class="MJXp-msubsup" id="MJXp-Span-568"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-570" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> f_n </script>  Ã  chaque Ã©tape, mais a un ordre de prÃ©cision <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-571"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">O</span><span class="MJXp-mo" id="MJXp-Span-573" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-576" style="vertical-align: 0.5em;">4</span></span><span class="MJXp-mo" id="MJXp-Span-577" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> O (h ^ 4) </script>  (Ã  titre de comparaison, la mÃ©thode Euler a un ordre de prÃ©cision <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-578"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">O</span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">h</span><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> O (h) </script>  et nÃ©cessite un calcul <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-583"><span class="MJXp-msubsup" id="MJXp-Span-584"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-586" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> f_n </script>  )  La prÃ©cision de la solution peut Ã©galement Ãªtre contrÃ´lÃ©e de plusieurs maniÃ¨res: comparer avec la solution analytique, rÃ©soudre en utilisant diffÃ©rentes mÃ©thodes ou avec diffÃ©rentes Ã©tapes et comparer les rÃ©sultats, contrÃ´ler les paramÃ¨tres tiers et les contraintes auxquelles la solution doit se conformer. <br>  De plus, chacune de ces mÃ©thodes a ses inconvÃ©nients.  Les dÃ©cisions analytiques peuvent Ãªtre absentes ou, mÃªme dans la plupart des cas, complÃ¨tement absentes.  Par exemple, pour notre tÃ¢che <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> N </script>  Cette solution analytique est <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">N</span><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-592">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> N = 2 </script>  , mais mÃªme cela suffit pour tester la prÃ©cision des mÃ©thodes.  La rÃ©solution d'un problÃ¨me par deux mÃ©thodes ou avec des Ã©tapes diffÃ©rentes augmente le temps de calcul, mais cette approche peut Ãªtre appliquÃ©e Ã  presque toutes les tÃ¢ches.  Toutes les tÃ¢ches n'ont pas de limites, mais pour la nÃ´tre, elles les ont: Ã  chaque Ã©tape de l'intÃ©gration, nous pouvons contrÃ´ler la mise en Å“uvre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">des lois de conservation</a> .  Cette approche augmente Ã©galement la complexitÃ© du calcul, mais il y a beaucoup de choix; le calcul de la somme des impulsions ou des impulsions angulaires de toutes les particules a une complexitÃ© de l'ordre <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">O</span><span class="MJXp-mo" id="MJXp-Span-595" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">N</span><span class="MJXp-mo" id="MJXp-Span-597" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> O (N) </script>  , tout en calculant l'Ã©nergie totale d'un systÃ¨me a une complexitÃ© d'ordre <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">O</span><span class="MJXp-mo" id="MJXp-Span-600" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-601"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-603" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-604" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> O (N ^ 2) </script><br><br><div class="spoiler">  <b class="spoiler_title">Remarque sur le calcul de l'Ã©nergie totale</b> <div class="spoiler_text">  Dans notre cas, l'Ã©nergie totale du systÃ¨me se compose de deux parties - l'Ã©nergie cinÃ©tique et l'Ã©nergie potentielle.  L'Ã©nergie cinÃ©tique consiste en la somme des Ã©nergies cinÃ©tiques de tous les corps.  Pour calculer l'Ã©nergie potentielle, nous devons ajouter les Ã©nergies potentielles de chaque particule dans le champ gravitationnel des particules restantes, nous devons donc ajouter <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">O</span><span class="MJXp-mo" id="MJXp-Span-607" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-608"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-610" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-27"> O (N ^ 2) </script>  termes.  La difficultÃ© est que tous les termes sont d'un ordre trÃ¨s diffÃ©rent, et mÃªme avec des calculs en double prÃ©cision, il n'est pas possible de calculer cette valeur avec une prÃ©cision suffisante pour la comparaison Ã  diffÃ©rentes Ã©tapes.  Pour surmonter ce problÃ¨me, il a fallu appliquer la sommation selon <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'algorithme de Kahan</a> . <br></div></div><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4d8/270/e1d/4d8270e1d2f39d30e9d2e5beabec6fa0.png" alt="Trajectoire elliptique"></div><br><p>  <b>Fig 1.</b> <i>Un exemple de trajectoire elliptique.</i> </p><br><br><br>  Prenons le cas simple d'un satellite se dÃ©plaÃ§ant sur une orbite elliptique autour de la Terre.  Ã€ mesure que le satellite s'approche de la Terre, sa vitesse augmente et, en s'Ã©loignant de la Terre, il diminue, en consÃ©quence, la possibilitÃ© se prÃ©sente de diminuer le pas d'intÃ©gration dans le temps dans la partie verte de l'orbite et de l'augmenter en rouge et bleu sans changer la prÃ©cision de la solution.  Essayons de comparer plus en dÃ©tail. <br><br>  <b>Tableau 1.</b> <i>MÃ©thodes Ã©tudiÃ©es pour rÃ©soudre les Ã©quations diffÃ©rentielles</i> <br><table><tbody><tr><th>  MarquÃ© </th><th>  Commander </th><th>  La description </th></tr><tr><td>  Adams </td><td>  1-5 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MÃ©thode Adams-Bashfort</a> </td></tr><tr><td>  euler </td><td>  1 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MÃ©thode Euler</a> </td></tr><tr><td>  rk4 </td><td>  4 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MÃ©thode Runge-Kutta classique</a> </td></tr><tr><td>  rkck </td><td>  5 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MÃ©thode Kash-Karp</a> </td></tr><tr><td>  rkdp </td><td>  5 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MÃ©thode Dorman-Prince</a> </td></tr><tr><td>  rkdverk </td><td>  6 </td><td>  MÃ©thode Werner <a href="">1)</a> p.  181 </td></tr><tr><td>  rkf </td><td>  7 </td><td>  MÃ©thode Felberg <a href="">1)</a> p.  180 </td></tr><tr><td>  rkgl </td><td>  6 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MÃ©thode Gauss-Legendre implicite</a> </td></tr><tr><td>  rklc </td><td>  4 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MÃ©thode Lobatto implicite</a> </td></tr><tr><td>  trapÃ¨ze </td><td>  2 </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">MÃ©thode trapÃ©zoÃ¯dale</a> </td></tr></tbody></table><br>  Pour sÃ©lectionner la meilleure mÃ©thode pour notre tÃ¢che, nous comparerons plusieurs mÃ©thodes connues.  Pour ce faire, nous simulons la collision de deux systÃ¨mes de corps <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">N</span><span class="MJXp-mo" id="MJXp-Span-614" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-615">512</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> N = 512 </script>  et mesurer la variation relative de l' <a href="">Ã©nergie totale</a> , de la <a href="">quantitÃ© de mouvement</a> et de son <a href="">moment</a> Ã  la fin de la simulation (temps de simulation maximum <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-616"><span class="MJXp-msubsup" id="MJXp-Span-617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-619" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-624">2</span><span class="MJXp-mo" id="MJXp-Span-625" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-626">5</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> T_ {max} = 2,5 </script>  )  Dans ce cas, nous varierons l'Ã©tape et les paramÃ¨tres des mÃ©thodes d'intÃ©gration et mesurerons le nombre d'appels de fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-627"><span class="MJXp-msubsup" id="MJXp-Span-628"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-630" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> f_n </script>  , respectivement, les mÃ©thodes qui avec un plus petit nombre d'appels conduiront Ã  moins de pertes, nous considÃ©rerons plus acceptables. <br><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/c0c/9de/886/c0c9de886418710c403863bc34021d9a.svg"><br></a> <br></td><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/311/f1b/614/311f1b6146bb4b13a4bd1db313ee1372.svg"><br></a> <br></td></tr><tr><td align="center">  a) </td><td align="center">  b) </td></tr><tr><td colspan="2" align="center">  <b>Figure 2.</b> <i>Variation relative de l'Ã©nergie a), momentum b), Ã  la fin de la simulation du systÃ¨me</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-631"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">N</span><span class="MJXp-mo" id="MJXp-Span-633" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-634">512</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> N = 512 </script></i>   <i>corps par diverses mÃ©thodes en fonction du nombre de calculs de fonction</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-635"><span class="MJXp-msubsup" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-638" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> f_n </script></i>   <i>double prÃ©cision</i> </td></tr></tbody></table><br>  Ã€ partir des graphiques de la figure 2, on peut voir que le meilleur rapport de la quantitÃ© de calcul de la fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-639"><span class="MJXp-msubsup" id="MJXp-Span-640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-642" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> f_n </script>  et le changement relatif de l'Ã©nergie du systÃ¨me des corps dans les mÃ©thodes d'Adams et Dorman-Prince du cinquiÃ¨me ordre.  On voit Ã©galement que pour toutes les mÃ©thodes avec un nombre croissant de calculs <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-643"><span class="MJXp-msubsup" id="MJXp-Span-644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-646" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> f_n </script>  la variation relative de la dynamique du systÃ¨me augmente.  Pour un changement relatif d'Ã©nergie, cela est Ã©galement perceptible, mais seulement pour quelques mÃ©thodes qui pourraient atteindre le seuil <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-647"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-648">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">E</span><span class="MJXp-mrow" id="MJXp-Span-650"><span class="MJXp-mo" id="MJXp-Span-651" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-msubsup" id="MJXp-Span-652"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653" style="margin-right: 0.05em;">E</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-654" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-msubsup" id="MJXp-Span-656"><span class="MJXp-mn" id="MJXp-Span-657" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-658" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-659">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-660">12</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> dE / E_0 <10 ^ {- 12} </script>  .  Cet effet ne peut plus Ãªtre attribuÃ© Ã  l'erreur des mÃ©thodes, mais Ã  l'erreur des calculs, et une nouvelle augmentation de la prÃ©cision n'est possible qu'avec une augmentation de la prÃ©cision des calculs Ã  virgule flottante. <br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/c8e/e99/4ba/c8ee994ba56d3dcbb7c305aad402f0e3.svg"><br></a> <br></td><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/745/6a2/7f4/7456a27f4253ae5ac634dcc2ebf0776d.svg"><br></a> <br></td></tr><tr><td align="center">  a) </td><td align="center">  b) </td></tr><tr><td colspan="2" align="center">  <b>Fig. 3.</b> <i>Variation relative de l'Ã©nergie a), momentum b), Ã  la fin de la simulation du systÃ¨me</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-661"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">N</span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-664">512</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> N = 512 </script></i>   <i>corps par diverses mÃ©thodes en fonction du nombre de calculs de fonction</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-665"><span class="MJXp-msubsup" id="MJXp-Span-666"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-668" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> f_n </script></i>   <i>avec une quadruple prÃ©cision (__float128)</i> </td></tr></tbody></table><br>  Les figures 3a et 3b montrent que l'utilisation de calculs avec une prÃ©cision quadruple peut rÃ©duire les pertes d'Ã©nergie relatives jusqu'Ã  <math></math><img src="https://habrastorage.org/getpro/habr/formulas/ced/373/445/ced373445053cbdd8e8d88195af034e0.svg" alt="10 $ ^ {- 23} $" data-tex="inline">  , mais vous devez comprendre que le temps de calcul est augmentÃ© de deux ordres de grandeur par rapport Ã  la double prÃ©cision.  Comme dans le cas des calculs en double prÃ©cision, le meilleur rapport de prÃ©cision et le nombre de calculs de fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-669"><span class="MJXp-msubsup" id="MJXp-Span-670"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-672" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> f_n </script>  possÃ©der des mÃ©thodes du cinquiÃ¨me ordre Adams et Dorman-Prince. <br><br>  Les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mÃ©thodes</a> Dorman-Prince et Werner appartiennent Ã  la classe des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">mÃ©thodes imbriquÃ©es</a> et peuvent calculer simultanÃ©ment deux solutions avec un ordre de prÃ©cision Ã©levÃ© et faible (pour la mÃ©thode Dorman-Prince, ordres 5 et 4, et pour la mÃ©thode Werner, ordres 6 et 5).  Si ces deux solutions sont trÃ¨s diffÃ©rentes, nous pouvons diviser l'Ã©tape d'intÃ©gration actuelle en plus petites.  Cela nous permet de changer dynamiquement l'Ã©tape d'intÃ©gration et de la rÃ©duire uniquement dans les domaines oÃ¹ cela est nÃ©cessaire. <br><br>  Comparons plus en dÃ©tail les mÃ©thodes Dorman-Prince, Werner et Adams du cinquiÃ¨me ordre sur un intervalle de simulation plus long de notre systÃ¨me ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-673"><span class="MJXp-msubsup" id="MJXp-Span-674"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675" style="margin-right: 0.05em;">T</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-676" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-680" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-681">300</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> T_ {max} = 300 </script>  ) <br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/dcf/431/463/dcf431463350504334895ae590038f54.svg"><br></a> <br></td></tr><tr><td align="center">  <b>a) Le</b> <i>changement relatif d'Ã©nergie, de quantitÃ© de mouvement et son moment dans le processus de modÃ©lisation</i> <br></td></tr><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/a2f/039/e55/a2f039e5575a01df083f913ab5cbb6d7.svg"><br></a> <br></td></tr><tr><td align="center">  <b>b)</b> <i>Nombre de calculs de fonction</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-682"><span class="MJXp-msubsup" id="MJXp-Span-683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-685" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> f_n </script></i>   <i>sur l'intervalle de simulation</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-686"><span class="MJXp-mtext" id="MJXp-Span-687">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-689">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-693">T</span><span class="MJXp-mo" id="MJXp-Span-694" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-695">0</span><span class="MJXp-mo" id="MJXp-Span-696" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-697">3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> \ Delta T = 0,3 </script></i> <br></td></tr><tr><td align="center">  <b>Fig. 4.</b> <i>DÃ©pendances de la variation relative des paramÃ¨tres physiques du systÃ¨me et du nombre de calculs de fonction</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-698"><span class="MJXp-msubsup" id="MJXp-Span-699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-701" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> f_n </script></i>   <i>modÃ©lisation ponctuelle avec la mÃ©thode Ã  pas variable de Dorman-Prince</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-702"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">h</span><span class="MJXp-mo" id="MJXp-Span-704" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-705"><span class="MJXp-mn" id="MJXp-Span-706" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-707" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-708">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-709">5</span></span></span><span class="MJXp-mtext" id="MJXp-Span-710">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">s</span><span class="MJXp-msubsup" id="MJXp-Span-717"><span class="MJXp-mn" id="MJXp-Span-718" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-719" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-720">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-721">9</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> h = 10 ^ {- 5} \ points 10 ^ {- 9} </script></i> <br></td></tr></tbody></table><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/db6/ed7/96b/db6ed796b48734885acac334d62bf74c.svg"><br></a> <br></td></tr><tr><td align="center">  <b>a) Le</b> <i>changement relatif d'Ã©nergie, de quantitÃ© de mouvement et son moment dans le processus de modÃ©lisation</i> <br></td></tr><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/1a8/b05/599/1a8b05599c05680aa8501197f70f8d5c.svg"><br></a> <br></td></tr><tr><td align="center">  <b>b)</b> <i>Nombre de calculs de fonction</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-722"><span class="MJXp-msubsup" id="MJXp-Span-723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-724" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-725" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> f_n </script></i>   <i>sur l'intervalle de simulation</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-726"><span class="MJXp-mtext" id="MJXp-Span-727">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">T</span><span class="MJXp-mo" id="MJXp-Span-734" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-735">0</span><span class="MJXp-mo" id="MJXp-Span-736" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-737">3</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> \ Delta T = 0,3 </script></i> <br></td></tr><tr><td align="center">  <b>Fig. 5.</b> <i>DÃ©pendances de la variation relative des paramÃ¨tres physiques du systÃ¨me et du nombre de calculs de fonction</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-738"><span class="MJXp-msubsup" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-741" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> f_n </script></i>   <i>par rapport Ã  la modÃ©lisation temporelle par la mÃ©thode de Werner avec un pas variable</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">h</span><span class="MJXp-mo" id="MJXp-Span-744" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-745"><span class="MJXp-mn" id="MJXp-Span-746" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-747" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-748">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-749">5</span></span></span><span class="MJXp-mtext" id="MJXp-Span-750">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">s</span><span class="MJXp-msubsup" id="MJXp-Span-757"><span class="MJXp-mn" id="MJXp-Span-758" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-759" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-760">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-761">9</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> h = 10 ^ {- 5} \ points 10 ^ {- 9} </script></i> <br></td></tr></tbody></table><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/f6b/b1e/832/f6bb1e8323381a14ab438133218fdcc8.svg"><br></a> <br></td></tr><tr><td align="center">  <b>Fig. 6.</b> <i>Changement relatif d'Ã©nergie, d'Ã©lan et de son moment dans le processus de modÃ©lisation par la mÃ©thode d'Adams-Bashfort du cinquiÃ¨me ordre avec une Ã©tape</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-763">h</span><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-765"><span class="MJXp-mn" id="MJXp-Span-766" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-767" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-768">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-769">6</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> h = 10 ^ {- 6} </script></i> <br></td></tr></tbody></table><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/fc2/19e/8fa/fc219e8fa8a9bc8dfddc4ebb5a2aeae5.svg"><br></a> <br></td></tr><tr><td align="center">  <b>Fig 7.</b> <i>DÃ©pendances du nombre de calculs de fonction</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-770"><span class="MJXp-msubsup" id="MJXp-Span-771"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-773" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> f_n </script></i>   <i>pour les mÃ©thodes Adams, Dorman-Prince et Werner du cinquiÃ¨me ordre Ã  partir du temps de simulation</i> <br></td></tr></tbody></table><br>  On peut voir qu'au stade initial de l'Ã©volution de notre systÃ¨me ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-774"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">T</span><span class="MJXp-mo" id="MJXp-Span-776" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-777">25</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> T <25 </script>  ), les trois mÃ©thodes prÃ©sentent des caractÃ©ristiques similaires, mais Ã  des stades ultÃ©rieurs, certains Ã©vÃ©nements se produisent dans le systÃ¨me, Ã  la suite desquels les erreurs dans les principaux paramÃ¨tres du systÃ¨me (Ã©nergie totale, quantitÃ© de mouvement et sa quantitÃ© de mouvement) augmentent fortement.  Mais les mÃ©thodes Dorman-Prince et Werner font face Ã  ces changements beaucoup mieux en raison de la capacitÃ© Ã  rÃ©duire l'Ã©tape d'intÃ©gration dans les sections Â«complexesÂ», ce qui augmente le nombre de calculs de fonctions <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-778"><span class="MJXp-msubsup" id="MJXp-Span-779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-781" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> f_n </script>  comme le montrent les figures 4b et 5b, mais le nombre total de calculs <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-782"><span class="MJXp-msubsup" id="MJXp-Span-783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-785" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> f_n </script>  les mÃ©thodes imbriquÃ©es sont plus petites que la mÃ©thode Adams-Bashfort, comme le montre la figure 7. <br><br><div class="spoiler">  <b class="spoiler_title">Je me demande ce qui est arrivÃ© au systÃ¨me Ã  ces moments</b> <div class="spoiler_text"><table><tbody><tr><td align="center"><iframe width="560" height="315" src="https://www.youtube.com/embed/ZPyM6PRXjkY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></td></tr><tr><td align="center">  <b>VidÃ©o 1.</b> <i>ModÃ©lisation d'un systÃ¨me de 512 corps.</i>  <i>MÃ©thode Dorman-Prince.</i>  <i>Ã‰tape dynamique</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">h</span><span class="MJXp-mo" id="MJXp-Span-788" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-789"><span class="MJXp-mn" id="MJXp-Span-790" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-791" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-792">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-793">5</span></span></span><span class="MJXp-mtext" id="MJXp-Span-794">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">s</span><span class="MJXp-msubsup" id="MJXp-Span-801"><span class="MJXp-mn" id="MJXp-Span-802" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-803" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-804">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-805">9</span></span></span></span></span><script type="math/tex" id="MathJax-Element-53"> h = 10 ^ {- 5} \ points 10 ^ {- 9} </script></i> <br></td></tr></tbody></table><br></div></div><br>  La vidÃ©o montre que jusqu'au point dans le temps <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">T</span><span class="MJXp-mo" id="MJXp-Span-808" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-809">25</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> T = 25 </script>  le mouvement est relativement calme, et aprÃ¨s une collision des centres des Â«galaxiesÂ» se produit, ce qui entraÃ®ne un changement brusque des trajectoires et une forte augmentation des vitesses de certaines particules.  De plus, pour maintenir la prÃ©cision de la solution, il est nÃ©cessaire de rÃ©duire l'Ã©tape d'intÃ©gration.  Les mÃ©thodes imbriquÃ©es peuvent le faire automatiquement; les graphiques montrent que dans certaines parties de l'Ã©volution du systÃ¨me, l'Ã©tape d'intÃ©gration a Ã©tÃ© rÃ©duite de prÃ¨s de deux ordres de grandeur avec <math></math><img src="https://habrastorage.org/getpro/habr/formulas/468/877/206/468877206cde0f9f0423da1f155ceb0c.svg" alt="10 $ ^ {- 5} $" data-tex="inline">  avant <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">h</span><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-813"><span class="MJXp-mn" id="MJXp-Span-814" style="margin-right: 0.05em;">10</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-815" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-816">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-817">7</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> h = 10 ^ {- 7} </script>  .  En utilisant la mÃ©thode Adams et une telle Ã©tape sur tout l'intervalle de l'Ã©volution du systÃ¨me, nous n'aurions pas attendu de solution. <br><br><h4>  RÃ©sumÃ© </h4><br>  Pour la solution, il est prÃ©fÃ©rable d'utiliser des mÃ©thodes imbriquÃ©es qui vous permettent de contrÃ´ler dynamiquement l'Ã©tape d'intÃ©gration et de la rÃ©duire uniquement sur des sections "complexes" de la trajectoire. <br><br>  Ne poursuivez pas les mÃ©thodes les plus Ã©levÃ©es.  MÃªme lorsqu'ils utilisent le type de donnÃ©es Â«doubleÂ», ils n'atteignent pas leurs capacitÃ©s potentielles, l'utilisation des types de donnÃ©es avec une plus grande prÃ©cision augmente considÃ©rablement le temps nÃ©cessaire pour rÃ©soudre le problÃ¨me. <br><br><h2>  ImplÃ©mentation CPU </h2><br>  Maintenant que le choix d'une mÃ©thode de rÃ©solution d'Ã©quations est dÃ©fini, essayons de comprendre le calcul de la force d'interaction pour chaque particule.  Nous obtenons un double cycle pour toutes les particules: <br><br><div class="spoiler">  <b class="spoiler_title">Code de mise en Å“uvre Â«simpleÂ»</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> body1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; body1 &lt; count; ++body1) { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbvertex_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rx[ body1 ], ry[ body1 ], rz[ body1 ])</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> total_force; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> body2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; body2 != count; ++body2) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(body1 == body2) { <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbvertex_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">v2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rx[ body2 ], ry[ body2 ], rz[ body2 ])</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbvertex_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">force</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(m_data-&gt;force(v1, v2, mass[body1], mass[body2]))</span></span></span></span>; total_force += force; } frx[body1] = vx[body1]; fry[body1] = vy[body1]; frz[body1] = vz[body1]; fvx[body1] = total_force.x / mass[body1]; fvy[body1] = total_force.y / mass[body1]; fvz[body1] = total_force.z / mass[body1]; }</code> </pre> <br></div></div><br>  Les forces gravitationnelles pour chaque corps sont calculÃ©es indÃ©pendamment, et pour utiliser tous les cÅ“urs de processeur, il suffit d'Ã©crire la directive OpenMP avant le premier cycle: <br><br><div class="spoiler">  <b class="spoiler_title">Un morceau de code de la mise en Å“uvre de Â«openmpÂ»</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> omp parallel for for(size_t body1 = 0; body1 &lt; count; ++body1)</span></span></code> </pre><br></div></div><br>  Parce que  chaque corps interagit avec chacun, puis pour rÃ©duire le nombre d'interactions du processeur avec la RAM et amÃ©liorer l'utilisation du cache, nous avons la possibilitÃ© de charger une partie des donnÃ©es dans le cache et de l'utiliser Ã  plusieurs reprises: <br><br><div class="spoiler">  <b class="spoiler_title">Code d'implÃ©mentation 'openmp + block'</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> omp parallel for for(size_t n1 = 0; n1 </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt; count; n1 += BLOCK_SIZE) { nbcoord_t x1[BLOCK_SIZE]; nbcoord_t y1[BLOCK_SIZE]; nbcoord_t z1[BLOCK_SIZE]; nbcoord_t m1[BLOCK_SIZE]; nbvertex_t total_force[BLOCK_SIZE]; for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { size_t local_n1 = b1 + n1; x1[b1] = rx[local_n1]; y1[b1] = ry[local_n1]; z1[b1] = rz[local_n1]; m1[b1] = mass[local_n1]; } for(size_t n2 = 0; n2 &lt; count; n2 += BLOCK_SIZE) { nbcoord_t x2[BLOCK_SIZE]; nbcoord_t y2[BLOCK_SIZE]; nbcoord_t z2[BLOCK_SIZE]; nbcoord_t m2[BLOCK_SIZE]; for(size_t b2 = 0; b2 != BLOCK_SIZE; ++b2) { size_t local_n2 = b2 + n2; x2[b2] = rx[local_n2]; y2[b2] = ry[local_n2]; z2[b2] = rz[local_n2]; m2[b2] = mass[n2 + b2]; } for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { const nbvertex_t v1(x1[ b1 ], y1[ b1 ], z1[ b1 ]); for(size_t b2 = 0; b2 != BLOCK_SIZE; ++b2) { const nbvertex_t v2(x2[ b2 ], y2[ b2 ], z2[ b2 ]); const nbvertex_t force(m_data-&gt;force(v1, v2, m1[b1], m2[b2])); total_force[b1] += force; } } } for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { size_t local_n1 = b1 + n1; frx[local_n1] = vx[local_n1]; fry[local_n1] = vy[local_n1]; frz[local_n1] = vz[local_n1]; fvx[local_n1] = total_force[b1].x / m1[b1]; fvy[local_n1] = total_force[b1].y / m1[b1]; fvz[local_n1] = total_force[b1].z / m1[b1]; } }</span></span></span></span></code> </pre><br></div></div><br>  Une optimisation supplÃ©mentaire consiste Ã  supprimer le contenu de la fonction de calcul de la force dans le cycle principal et d'Ã©liminer la division et la multiplication par la masse corporelle m1 [b1].  Outre le fait que nous avons un peu rÃ©duit les calculs, le compilateur pourra appliquer des instructions vectorielles des processeurs SSE et AVX sur un cycle aussi Ã©tendu. <br><br><div class="spoiler">  <b class="spoiler_title">Code d'implÃ©mentation 'openmp + bloc + optimisation'</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> omp parallel for for(size_t n1 = 0; n1 &lt; count; n1 += BLOCK_SIZE) { nbcoord_t x1[BLOCK_SIZE]; nbcoord_t y1[BLOCK_SIZE]; nbcoord_t z1[BLOCK_SIZE]; nbcoord_t total_force_x[BLOCK_SIZE]; nbcoord_t total_force_y[BLOCK_SIZE]; nbcoord_t total_force_z[BLOCK_SIZE]; for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { size_t local_n1 = b1 + n1; x1[b1] = rx[local_n1]; y1[b1] = ry[local_n1]; z1[b1] = rz[local_n1]; total_force_x[b1] = 0; total_force_y[b1] = 0; total_force_z[b1] = 0; } for(size_t n2 = 0; n2 &lt; count; n2 += BLOCK_SIZE) { nbcoord_t x2[BLOCK_SIZE]; nbcoord_t y2[BLOCK_SIZE]; nbcoord_t z2[BLOCK_SIZE]; nbcoord_t m2[BLOCK_SIZE]; for(size_t b2 = 0; b2 != BLOCK_SIZE; ++b2) { size_t local_n2 = b2 + n2; x2[b2] = rx[local_n2]; y2[b2] = ry[local_n2]; z2[b2] = rz[local_n2]; m2[b2] = mass[n2 + b2]; } for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { for(size_t b2 = 0; b2 != BLOCK_SIZE; ++b2) { nbcoord_t dx = x1[b1] - x2[b2]; nbcoord_t dy = y1[b1] - y2[b2]; nbcoord_t dz = z1[b1] - z2[b2]; nbcoord_t r2(dx * dx + dy * dy + dz * dz); </span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta">(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } nbcoord_t r = sqrt(r2); nbcoord_t coeff = (m2[b2]) / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; total_force_x[b1] -= dx; total_force_y[b1] -= dy; total_force_z[b1] -= dz; } } } for(size_t b1 = 0; b1 != BLOCK_SIZE; ++b1) { size_t local_n1 = b1 + n1; frx[local_n1] = vx[local_n1]; fry[local_n1] = vy[local_n1]; frz[local_n1] = vz[local_n1]; fvx[local_n1] = total_force_x[b1]; fvy[local_n1] = total_force_y[b1]; fvz[local_n1] = total_force_z[b1]; } }</span></span></code> </pre><br></div></div><br>  <b>Tableau 2.</b> <i>DÃ©pendance du temps de calcul (en secondes) d'une fonction</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-818"><span class="MJXp-msubsup" id="MJXp-Span-819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-821" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> f_n </script></i>   <i>sur le nombre de corps en interaction</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> N </script></i>   <i>pour diverses implÃ©mentations CPU</i> <br><table><tbody><tr><th><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> N </script></th><th>  2048 </th><th>  4096 </th><th>  8192 </th><th>  16384 </th><th>  32768 </th></tr><tr><td>  simple </td><td>  0,0425 </td><td>  0.1651 </td><td>  0,6594 </td><td>  2,65 </td><td>  10,52 </td></tr><tr><td>  openmp </td><td>  0,0078 </td><td>  0,0260 </td><td>  0,1079 </td><td>  0,417 </td><td>  1,655 </td></tr><tr><td>  openmp + bloc + optimisation </td><td>  0,0037 </td><td>  0,0128 </td><td>  0,0495 </td><td>  0,194 </td><td>  0,774 </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">ParamÃ¨tres systÃ¨me:</b> <div class="spoiler_text"><ul><li>  systÃ¨me: <i>Debian 9, Intel Core i7-5820K (6 cÅ“urs)</i> </li><li>  compilateur: <i>gcc 6.3.0</i> </li></ul><br></div></div><br>  On voit clairement que la version avec prise en charge d'OpenMP est accÃ©lÃ©rÃ©e six fois, exactement en termes de nombre de cÅ“urs, et la version optimisÃ©e est plus rapide d'un peu plus de deux fois.  Ainsi, avec l'optimisation, vous ne devez pas vous fier uniquement Ã  la concurrence.  Fait intÃ©ressant, dans les calculs Ã  flux unique, le processeur fonctionnait Ã  une frÃ©quence de 3,6 GHz, dans la version parallÃ¨le (openmp), il a baissÃ© la frÃ©quence Ã  3,4 GHz, et dans le parallÃ¨le et optimisÃ© (openmp + bloc + optimisation), il est tombÃ© Ã  3,3 GHz, mais cela cela ne l'a pas empÃªchÃ©e de travailler 13,6 fois plus vite.  On voit Ã©galement qu'une augmentation du temps de calcul avec une augmentation de la taille du problÃ¨me est quadratique, et une augmentation supplÃ©mentaire <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-826"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> N </script>  rend la tÃ¢che insoluble dans un dÃ©lai raisonnable. <br><br><h2>  ImplÃ©mentation GPU </h2><br>  Mais il y a un dÃ©sir de faire des calculs encore plus rapidement.  Il existe plusieurs directions disponibles pour l'accÃ©lÃ©ration: calcul GPU, approximation des fonctions <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-828"><span class="MJXp-msubsup" id="MJXp-Span-829"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-830" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-831" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> f_n </script>  .  Tout d'abord, pour l'informatique GPU, j'ai choisi la technologie OpenCL.  Pour un travail plus pratique, la bibliothÃ¨que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CLHPP</a> a Ã©tÃ© utilisÃ©e.  Le principal avantage d'OpenCL est que le code peut Ãªtre exÃ©cutÃ© sur le processeur et sur le GPU, ce qui simplifie l'Ã©criture et le dÃ©bogage, ainsi que l'extension de la liste du matÃ©riel Ã  exÃ©cuter.  L'outil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Oclgrind</a> aide au dÃ©bogage qui, lors de l'exÃ©cution, affiche des appels d'API OpenCL incorrects et des problÃ¨mes d'accÃ¨s Ã  la mÃ©moire. <br><br><h4>  Opencl </h4><br>  Pour commencer avec OpenCL, vous devez obtenir une liste des plates-formes disponibles.  Les plates-formes les plus courantes sont AMD, Intel et NVidia. <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;cl::Platform&gt; platforms; cl::Platform::get(&amp;platforms);</code> </pre><br></div></div><br>  Ensuite, aprÃ¨s avoir choisi une plate-forme, vous devez sÃ©lectionner le pÃ©riphÃ©rique informatique que cette plate-forme reprÃ©sente: <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> cl::<span class="hljs-function"><span class="hljs-function">Platform&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">platform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(platforms[platform_n])</span></span></span></span>; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;cl::Device&gt; all_devices; platform.getDevices(CL_DEVICE_TYPE_ALL, &amp;all_devices);</code> </pre><br></div></div><br>  Et Ã  la fin de la phase prÃ©paratoire, il est nÃ©cessaire de crÃ©er un contexte et des files d'attente dans lesquels la mÃ©moire sera allouÃ©e et les calculs seront effectuÃ©s.  Par exemple, un contexte qui combine tous les appareils informatiques d'une plate-forme sÃ©lectionnÃ©e est crÃ©Ã© comme suit: <br><br><div class="spoiler">  <b class="spoiler_title">Code de crÃ©ation de contexte et de file d'attente</b> <div class="spoiler_text"><pre> <code class="cpp hljs">cl::<span class="hljs-function"><span class="hljs-function">Context </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">context</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(all_devices)</span></span></span></span>; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;cl::CommandQueue&gt; queues; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(cl::Device device: all_devices) queues.push_back(cl::CommandQueue(context, device));</code> </pre><br></div></div><br>  Pour tÃ©lÃ©charger le code source sur un appareil informatique, il doit Ãªtre compilÃ©, la classe cl :: Program est destinÃ©e Ã  cela. <br><br><div class="spoiler">  <b class="spoiler_title">Code de compilation du noyau</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> &gt; source_data; cl::Program::Sources sources; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i != files.size(); ++i) { source_data.push_back(load_program(files[i]));<span class="hljs-comment"><span class="hljs-comment">//   sources.push_back(std::make_pair(source_data.back().data(), source_data.back().size())); } cl::Program prog(context, sources); devices.push_back(all_devices); prog.build(devices, options);</span></span></code> </pre><br></div></div><br>  Pour dÃ©crire les paramÃ¨tres d'une fonction (noyau) exÃ©cutÃ©e sur un appareil informatique, il existe un modÃ¨le cl: make_kernel. <br><br><div class="spoiler">  <b class="spoiler_title">Exemple de noyau de calcul de la force d'interaction</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> cl::make_kernel&lt; cl_int, cl_int, <span class="hljs-comment"><span class="hljs-comment">//Block offset cl::Buffer, //mass cl::Buffer, //y cl::Buffer, //f cl_int, cl_int, //yoff,foff cl_int, cl_int //points_count,stride &gt; ComputeBlock;</span></span></code> </pre><br></div></div><br>  De plus, tout est simple: on dÃ©clare une variable avec le type du noyau, on y passe le programme compilÃ© et le nom du noyau de calcul, on peut dÃ©marrer le noyau presque comme une fonction normale. <br><br><div class="spoiler">  <b class="spoiler_title">Code de lancement du noyau</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">ComputeBlock </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fcompute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(prog, </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"ComputeBlockLocal"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; cl::<span class="hljs-function"><span class="hljs-function">NDRange </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">global_range</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(device_data_size)</span></span></span></span>; cl::<span class="hljs-function"><span class="hljs-function">NDRange </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">local_range</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(block_size)</span></span></span></span>; cl::<span class="hljs-function"><span class="hljs-function">EnqueueArgs </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eargs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ctx.m_queue, global_range, local_range)</span></span></span></span>; fcompute(eargs, ...  ); <span class="hljs-comment"><span class="hljs-comment">//,   .</span></span></code> </pre><br></div></div><br>  Le noyau de calcul pour OpenCL lui-mÃªme est trÃ¨s similaire Ã  l'option 'openmp + block + optimisation' pour le CPU, seulement contrairement Ã  la version du CPU, le premier cycle est contrÃ´lÃ© Ã  l'aide d'OpenCL (la plage de cycle est dÃ©terminÃ©e par la variable global_range du code de dÃ©marrage du noyau, et le numÃ©ro d'itÃ©ration actuel est disponible Ã  partir du noyau en utilisant la fonction get_global_id (0)).  Tout d'abord, une partie des donnÃ©es du corps est chargÃ©e Ã  partir de la mÃ©moire locale, puis traitÃ©e.  La mÃ©moire locale Ã©tant commune Ã  tous les threads du groupe, le tÃ©lÃ©chargement a lieu une fois pour le groupe et est traitÃ© par chaque thread du groupe et, depuis  la mÃ©moire locale est beaucoup plus rapide que la mÃ©moire globale, les calculs sont beaucoup plus rapides. <br><br><div class="spoiler">  <b class="spoiler_title">Code du noyau</b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">kernel </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ComputeBlockLocal</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n2, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* mass, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* y, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> yoff, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> foff, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> stride)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = get_global_id(<span class="hljs-number"><span class="hljs-number">0</span></span>) + offset_n1; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rx = y + yoff; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* ry = rx + stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rz = rx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vx = rx + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vy = rx + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vz = rx + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frx = f + foff; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fry = frx + stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frz = frx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvx = frx + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvy = frx + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvz = frx + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = rx[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = ry[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = rz[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; __local <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x2[NBODY_DATA_BLOCK_SIZE]; __local <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y2[NBODY_DATA_BLOCK_SIZE]; __local <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z2[NBODY_DATA_BLOCK_SIZE]; __local <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> m2[NBODY_DATA_BLOCK_SIZE]; <span class="hljs-comment"><span class="hljs-comment">// NB! get_local_size(0) == NBODY_DATA_BLOCK_SIZE for(int b2 = 0; b2 &lt; points_count; b2 += NBODY_DATA_BLOCK_SIZE) { int n2 = b2 + offset_n2 + get_local_id(0); // Copy data block to local memory x2[ get_local_id(0) ] = rx[n2]; y2[ get_local_id(0) ] = ry[n2]; z2[ get_local_id(0) ] = rz[n2]; m2[ get_local_id(0) ] = mass[n2]; // Synchronize local work-items copy operations barrier(CLK_LOCAL_MEM_FENCE); nbcoord_t local_res_x = 0.0; nbcoord_t local_res_y = 0.0; nbcoord_t local_res_z = 0.0; for(int local_n2 = 0; local_n2 != NBODY_DATA_BLOCK_SIZE; ++local_n2) { nbcoord_t dx = x1 - x2[local_n2]; nbcoord_t dy = y1 - y2[local_n2]; nbcoord_t dz = z1 - z2[local_n2]; nbcoord_t r2 = (dx * dx + dy * dy + dz * dz); if(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } nbcoord_t r = sqrt(r2); nbcoord_t coeff = (m2[local_n2]) / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; local_res_x -= dx; local_res_y -= dy; local_res_z -= dz; } // Synchronize local work-items computations barrier(CLK_LOCAL_MEM_FENCE); res_x += local_res_x; res_y += local_res_y; res_z += local_res_z; } frx[n1] = vx[n1]; fry[n1] = vy[n1]; frz[n1] = vz[n1]; fvx[n1] = res_x; fvy[n1] = res_y; fvz[n1] = res_z; }</span></span></code> </pre><br></div></div><br><h4>  Cuda </h4><br>  L'implÃ©mentation de la plate-forme NVidia CUDA est un peu plus simple qu'OpenCL, nous n'avons pas besoin de crÃ©er le contexte de l'appareil et de gÃ©rer la file d'attente d'exÃ©cution nous-mÃªmes (au moins jusqu'Ã  ce que nous voulions effectuer une implÃ©mentation multi-GPU).  Comme dans le cas d'OpenCL, nous devons allouer de la mÃ©moire sur le GPU, y copier nos donnÃ©es, puis nous pouvons dÃ©marrer le cÅ“ur de calcul. <br><br>  Vous pouvez en savoir plus sur le travail avec CUDA <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Code de lancement du noyau CUDA</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">dim3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">grid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(count / block_size)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">dim3 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">block</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(block_size)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> shared_size(<span class="hljs-number"><span class="hljs-number">4</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>) * block_size); kfcompute &lt;&lt;&lt; grid, block, shared_size &gt;&gt;&gt; (... ...);</code> </pre><br></div></div><br>  Contrairement Ã  OpenCL, CUDA ne spÃ©cifie pas la gamme complÃ¨te des itÃ©rations (dans l'implÃ©mentation OpenCL c'est global_range), mais dÃ©finit la taille de la grille et la taille des blocs dans la grille, en consÃ©quence, le calcul du numÃ©ro de corps actuel change lÃ©gÃ¨rement, sinon le noyau est trÃ¨s similaire Ã  OpenCL, Ã  l'exception d'autres noms fonctions de synchronisation et de spÃ©cification pour la mÃ©moire partagÃ©e.  Une autre caractÃ©ristique distinctive utile de CUDA est que nous pouvons spÃ©cifier la taille requise de la mÃ©moire partagÃ©e au dÃ©marrage du noyau.  Comme dans l'implÃ©mentation OpenCL, au dÃ©but de chaque bloc d'itÃ©ration, nous copions une partie des donnÃ©es dans la mÃ©moire partagÃ©e, puis travaillons avec cette mÃ©moire Ã  partir de tous les threads du bloc. <br><br><div class="spoiler">  <b class="spoiler_title">Code du noyau CUDA</b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">global__ </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kfcompute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n2, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* y, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> yoff, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> foff, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* mass, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> stride)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = blockDim.x * blockIdx.x + threadIdx.x; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rx = y + yoff; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* ry = rx + stride; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rz = rx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = rx[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = ry[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = rz[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">extern</span></span> __shared__ <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> shared_xyzm_buf[]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* x2 = shared_xyzm_buf; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* y2 = x2 + blockDim.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* z2 = y2 + blockDim.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* m2 = z2 + blockDim.x; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> b2 = <span class="hljs-number"><span class="hljs-number">0</span></span>; b2 &lt; points_count; b2 += blockDim.x) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n2 = b2 + offset_n2 + threadIdx.x; <span class="hljs-comment"><span class="hljs-comment">// Copy data block to local memory x2[ threadIdx.x ] = rx[n2]; y2[ threadIdx.x ] = ry[n2]; z2[ threadIdx.x ] = rz[n2]; m2[ threadIdx.x ] = mass[n2]; // Synchronize local work-items copy operations __syncthreads(); nbcoord_t local_res_x = 0.0; nbcoord_t local_res_y = 0.0; nbcoord_t local_res_z = 0.0; for(int n2 = 0; n2 != blockDim.x; ++n2) { nbcoord_t dx = x1 - x2[n2]; nbcoord_t dy = y1 - y2[n2]; nbcoord_t dz = z1 - z2[n2]; nbcoord_t r2 = (dx * dx + dy * dy + dz * dz); if(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } nbcoord_t r = sqrt(r2); nbcoord_t coeff = (m2[n2]) / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; local_res_x -= dx; local_res_y -= dy; local_res_z -= dz; } // Synchronize local work-items computations __syncthreads(); res_x += local_res_x; res_y += local_res_y; res_z += local_res_z; } n1 += foff; f[n1 + 3 * stride] = res_x; f[n1 + 4 * stride] = res_y; f[n1 + 5 * stride] = res_z; }</span></span></code> </pre><br></div></div><br>  <b>Tableau 3.</b> <i>La dÃ©pendance de la fonction de temps de calcul (en secondes)</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-832"><span class="MJXp-msubsup" id="MJXp-Span-833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-835" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61"> f_n </script></i>   <i>sur le nombre de corps en interaction</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> N </script></i>   <i>pour diverses implÃ©mentations GPU et de meilleures implÃ©mentations CPU</i> <br><table><tbody><tr><th><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-838"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> N </script></th><th>  4096 </th><th>  8192 </th><th>  16384 </th><th>  32768 </th><th>  65536 </th><th>  131072 </th></tr><tr><td>  openmp + bloc + optimisation </td><td>  0,0128 </td><td>  0,0495 </td><td>  0,194 </td><td>  0,774 </td><td>  --- </td><td>  --- </td></tr><tr><td>  OpenCL + demi NVidia K80 </td><td>  0,004 </td><td>  0,008 </td><td>  0,026 </td><td>  0,134 </td><td>  0,322 </td><td>  1.18 </td></tr><tr><td>  CUDA + demi NVidia K80 </td><td>  0,004 </td><td>  0,008 </td><td>  0,0245 </td><td>  0,115 </td><td>  0,291 </td><td>  1.13 </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">OÃ¹ obtenir NVidia K80</b> <div class="spoiler_text">  Les implÃ©mentations OpenCL et CUDA ont Ã©tÃ© lancÃ©es sur le service gratuit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Colab de</a> Google, qui donne accÃ¨s aux ordinateurs NVidia K80.  Vous pouvez en savoir plus sur l'utilisation de ce service sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">concentrateur</a> <br></div></div><br>  En gÃ©nÃ©ral, le rÃ©sultat est dÃ©cevant, seulement 5-6 fois plus rapide que la mise en Å“uvre du CPU.  MÃªme si nous effectuons des calculs sur l'ensemble du K80, nous obtiendrons une accÃ©lÃ©ration jusqu'Ã  12 fois, mais puisque  Ã‰tant donnÃ© que la complexitÃ© de la tÃ¢che est quadratique, nous pourrons traiter dans un dÃ©lai raisonnable non pas 32768 corps en interaction, mais 131072, ce qui n'est que 4 fois plus. <br><br><h2>  Approximation des fonctions <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-840"><span class="MJXp-msubsup" id="MJXp-Span-841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-843" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> f_n </script></h2><br>  Si vous regardez de prÃ¨s la fonction, qui est dÃ©finie par la force d'attraction de deux corps, il est clair qu'elle diminue de faÃ§on quadratique avec la distance.  Par consÃ©quent, nous pouvons calculer avec prÃ©cision la force d'interaction entre des corps proches et approximativement entre des corps Ã©loignÃ©s.  Une approche cÃ©lÃ¨bre <br>  est un algorithme de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">treecode</a> proposÃ© par D. Barnes et P. Hat.  Un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">arbre d'octree</a> est construit dans l'espace simulÃ©, contenant dans ses feuilles les coordonnÃ©es et les masses des corps simulÃ©s.  Les nÅ“uds parents contiennent le centre de masse, la masse totale des nÅ“uds enfants et le rayon de la sphÃ¨re dÃ©crit autour des corps des nÅ“uds enfants.  La racine de l'arbre contient le centre de masse de tous les corps, leur masse totale et le rayon de la sphÃ¨re dÃ©crite autour d'eux.  Lors du calcul de la force d'interaction, la distance Ã  la racine de l'arbre est d'abord prise en compte si le rapport de la distance au nÅ“ud sur son rayon est supÃ©rieur Ã  une constante <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-844"><span class="MJXp-mtext" id="MJXp-Span-845">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">d</span><span class="MJXp-msubsup" id="MJXp-Span-851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-852" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-853" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> \ lambda_ {crit} </script>  , alors la racine est considÃ©rÃ©e comme un corps avec des coordonnÃ©es Ã©gales aux coordonnÃ©es du centre de masse des corps qui y sont inclus, et une masse Ã©gale Ã  la somme des masses des nÅ“uds filles, si le rapport est infÃ©rieur ou Ã©gal Ã  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-858"><span class="MJXp-mtext" id="MJXp-Span-859">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">d</span><span class="MJXp-msubsup" id="MJXp-Span-865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-867" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> \ lambda_ {crit} </script>  , puis la procÃ©dure est rÃ©pÃ©tÃ©e rÃ©cursivement pour chaque nÅ“ud enfant.  Si une feuille d'un arbre est atteinte, alors la force d'interaction est considÃ©rÃ©e de la maniÃ¨re habituelle.  Ainsi, si un corps est trÃ¨s Ã©loignÃ© du groupe compact d'autres corps, ce groupe lui est prÃ©sentÃ© comme un seul corps, et la force d'interaction est calculÃ©e non pas jusqu'Ã  chaque corps, mais seulement jusqu'Ã  un corps.  Pour cette raison, la complexitÃ© de l'algorithme diminue avec <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">O</span><span class="MJXp-mo" id="MJXp-Span-874" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-875"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-877" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-878" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> O (N ^ 2) </script>  avant <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">O</span><span class="MJXp-mo" id="MJXp-Span-881" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">N</span><span class="MJXp-mtext" id="MJXp-Span-883">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">g</span><span class="MJXp-mo" id="MJXp-Span-887" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">N</span><span class="MJXp-mo" id="MJXp-Span-889" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-890" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> O (N \ log (N)) </script>  au prix d'une perte de prÃ©cision. <br><br>  Dans mon approche, j'ai dÃ©cidÃ© de ne pas utiliser l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">arbre</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">octree</a> , mais l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">arbre kd,</a> car  il est plus facile Ã  utiliser et a une surcharge de stockage infÃ©rieure Ã  l'octree. <br><br>  Revenons Ã  l'implÃ©mentation sur le CPU.  Un nÅ“ud kd-tree peut Ãªtre reprÃ©sentÃ© sous la forme d'une classe contenant des pointeurs vers les descendants gauche et droit et des informations sur les coordonnÃ©es et la masse: <br><br><div class="spoiler">  <b class="spoiler_title">Noeud d'arbre Kd</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">node</span></span></span><span class="hljs-class"> {</span></span> node* m_left; <span class="hljs-comment"><span class="hljs-comment">//!&lt;   node* m_right; //!&lt;   nbvertex_t m_mass_center; //!&lt;     nbcoord_t m_mass; //!&lt;   nbcoord_t m_radius_sqr; //!&lt;    ,   lambda_crit nbvertex_t m_bmin; //!&lt;     nbvertex_t m_bmax; //!&lt;     size_t m_body_n; //!&lt;  ,    };</span></span></code> </pre><br></div></div><br>  Avec cette mÃ©thode de stockage de l'arbre, nous avons deux options possibles pour parcourir l'arbre: soit utiliser la rÃ©cursivitÃ© explicite, soit utiliser la pile nous-mÃªmes.  J'ai optÃ© pour la deuxiÃ¨me option. <br><br><div class="spoiler">  <b class="spoiler_title">Calcul de la force d'interaction en traversant un arbre</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> force_compute(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span>&amp; v1, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> mass1) { <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> total_force; node* stack_data[MAX_STACK_SIZE] = {}; node** <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = stack_data; node** stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; *<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++ = m_root; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { node* curr = *--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbcoord_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">distance_sqr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">((v1 - curr-&gt;m_mass_center).norm())</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(distance_sqr &gt; curr-&gt;m_radius_sqr) {<span class="hljs-comment"><span class="hljs-comment">//  ,       total_force += force(v1, curr-&gt;m_mass_center, mass1, curr-&gt;m_mass); } else {//   ,      if(curr-&gt;m_right != NULL) { *stack++ = curr-&gt;m_right; } if(curr-&gt;m_left != NULL) { *stack++ = curr-&gt;m_left; } } } return total_force; }</span></span></code> </pre><br></div></div><br>  Comme dans le cas de l'implÃ©mentation CPU Â«exacteÂ», la fonction de calcul de force est appelÃ©e pour chaque corps.  Le cycle Ã  travers tous les corps peut Ãªtre facilement parallÃ©lisÃ© en utilisant les directives OpenMP. <br><br>  Mais les itÃ©rations de boucles voisines dans ce cas feront rÃ©fÃ©rence Ã  des parties complÃ¨tement diffÃ©rentes de l'arborescence, ce qui ne permet pas une utilisation efficace du cache du processeur.  Pour surmonter ce problÃ¨me, tous les corps doivent Ãªtre traversÃ©s non pas dans l'ordre d'origine, mais dans l'ordre dans lequel les corps sont situÃ©s dans les feuilles de l'arbre kd, puis des itÃ©rations voisines se produiront pour les corps qui sont proches dans l'espace, et traverseront l'arbre selon presque les mÃªmes chemins. <br><br><div class="spoiler">  <b class="spoiler_title">TraversÃ©e des feuilles des arbres</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Visitor</span></span></span><span class="hljs-class">&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">traverse</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Visitor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">visit</span></span></span><span class="hljs-class">) {</span></span> node* stack_data[MAX_STACK_SIZE] = {}; node** <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = stack_data; node** stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; *<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++ = m_root; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { node* curr = *--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(curr-&gt;m_radius_sqr &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<span class="hljs-comment"><span class="hljs-comment">//  .    . if(curr-&gt;m_left != NULL) { *stack++ = curr-&gt;m_left; } if(curr-&gt;m_right != NULL) { *stack++ = curr-&gt;m_right; } } else {//   .  . visit(curr-&gt;m_body_n, curr-&gt;m_mass_center, curr-&gt;m_mass); } } }</span></span></code> </pre><br></div></div><br>  Cette implÃ©mentation a un autre problÃ¨me - il n'existe aucun moyen universel de parallÃ©liser une telle traversÃ©e d'arbre.  Mais nous pouvons complÃ¨tement changer la faÃ§on dont l'arbre est stockÃ© en mÃ©moire - nous pouvons stocker tous les nÅ“uds dans un tableau linÃ©aire et abandonner complÃ¨tement le stockage des pointeurs vers les descendants, par analogie avec la construction d'un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tas binaire</a> .  Lors du dÃ©marrage de la numÃ©rotation des nÅ“uds avec <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-891"><span class="MJXp-mn" id="MJXp-Span-892">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> 1 </script>  si le nÅ“ud est dans le numÃ©ro de cellule <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-893"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> i </script>  , puis son enfant gauche est dans la cellule <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-895"><span class="MJXp-mn" id="MJXp-Span-896">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71"> 2i </script>  , bon enfant dans la cellule <math></math><img src="https://habrastorage.org/getpro/habr/formulas/401/3d9/909/4013d9909b0167b12e3ffaca538dfa2e.svg" alt="2i + 1 $" data-tex="inline">  et le parent dans la cellule <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-898"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">i</span><span class="MJXp-mrow" id="MJXp-Span-900"><span class="MJXp-mo" id="MJXp-Span-901" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mn" id="MJXp-Span-902">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72"> i / 2 </script>  .  Le nÅ“ud droit correspondant Ã  la gauche avec le numÃ©ro <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-903"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> i </script>  aura un certain nombre <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-905"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">i</span><span class="MJXp-mo" id="MJXp-Span-907" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-908">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-74"> i + 1 </script>  .  Le tableau lui-mÃªme aura une longueur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-909"><span class="MJXp-mn" id="MJXp-Span-910">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75"> 2N </script>  , et tous les nÅ“uds feuilles seront situÃ©s dans le dernier <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76"> N </script>  en outre, des nÅ“uds Ã©troitement espacÃ©s seront situÃ©s dans des cellules proches du rÃ©seau.  La fonction de traversÃ©e de l'arbre changera un peu, mais le cadre reste le mÃªme: <br><br><div class="spoiler">  <b class="spoiler_title">Calcul de la force en traversant un arbre dans un tableau</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> force_compute(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span>&amp; v1, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> mass1) { <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> total_force; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> stack_data[MAX_STACK_SIZE] = {}; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>* <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = stack_data; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span>* stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; *<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++ = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> curr = *--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbcoord_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">distance_sqr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">((v1 - m_mass_center[curr]).norm())</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(distance_sqr &gt; m_radius_sqr[curr]) { total_force += force(v1, m_mass_center[curr], mass1, m_mass[curr]); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> left(left_idx(curr)); <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> rght(rght_idx(curr)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rght &lt; m_body_n.size()) { *<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++ = rght; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(left &lt; m_body_n.size()) { *<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++ = left; } } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> total_force; }</code> </pre><br></div></div><br>  Mais ce ne sont pas toutes les possibilitÃ©s que le stockage des nÅ“uds dans le tableau nous ouvre - nous pouvons refuser la pile lors du dÃ©placement.  Pour ce faire, dans la branche de code dans laquelle nous allons vers les enfants du nÅ“ud, nous ajoutons la fonction pour calculer le nÅ“ud suivant ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-914"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">x</span><span class="MJXp-msubsup" id="MJXp-Span-918"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-920" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">p</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77"> next_ {up} </script>  ), et dans la branche dans laquelle nous calculons la force d'interaction, nous ajoutons le calcul du nÅ“ud suivant avec le sous-arbre actuel ignorÃ© ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-923"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">i</span><span class="MJXp-msubsup" id="MJXp-Span-927"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-929" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">n</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> skip_ {down} </script>  ) <br><br>  Pour ignorer le sous-arbre actuel, nous devons descendre Ã  la racine (direction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-935">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-79"> D </script>  ), alors que nous sommes dans le descendant droit, dÃ¨s que nous atteignons la gauche, nous allons au sous-arbre droit correspondant (direction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-936"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">R</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> R </script>  ), si nous arrivons Ã  la racine, alors la traversÃ©e de l'arbre est terminÃ©e. <br><br><div class="spoiler">  <b class="spoiler_title">Code de fonction de saut de sous-arborescence</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> skip_down(<span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> idx) { <span class="hljs-comment"><span class="hljs-comment">// While index is 'right' -&gt; go down while(is_right(idx)) { index_t parent = parent_idx(idx); // We at root again. Stop traverse. if(parent == NBODY_HEAP_ROOT_INDEX) { return NBODY_HEAP_ROOT_INDEX; } idx = parent; } return left2right(idx); }</span></span></code> </pre><br></div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/f29/d13/fe4/f29d13fe464d49022665ac28be8912cf.svg"><br>  <b>Figure 8.</b> <i>Ignorer un sous-arbre</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">i</span><span class="MJXp-msubsup" id="MJXp-Span-942"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-944" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">n</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81"> skip_ {down} </script></i>   <i>.</i> <br><br>  Pour aller au nÅ“ud suivant, si possible, allez vers l'enfant gauche (direction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-949"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">U</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82"> U </script>  ), et s'il n'y a pas de descendant, passez au nÅ“ud suivant Â«d'en basÂ» en utilisant la fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-951"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">i</span><span class="MJXp-msubsup" id="MJXp-Span-955"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-957" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">n</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-83"> skip_ {down} </script>  . <br><br><div class="spoiler">  <b class="spoiler_title">Aller au code de fonction de nÅ“ud suivant</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> next_up(<span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> idx, <span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> tree_size) { <span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> left = left_idx(idx); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(left &lt; tree_size) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> left; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> skip_down(idx); }</code> </pre><br></div></div><br><img src="https://habrastorage.org/getpro/habr/post_images/26d/909/a33/26d909a33c617b955c256a3f717fa116.svg"><br>  <b>Figure 9.</b> <i>Transitions vers le nÅ“ud suivant</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-962"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">x</span><span class="MJXp-msubsup" id="MJXp-Span-966"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-968" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">p</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> next_ {up} </script></i>   <i>.</i> <br><br>  Il pourrait sembler que nous avons remplacÃ© la rÃ©cursivitÃ© par une boucle <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-971"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">q </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85"> tandis que </script>  en fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-987" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">d </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">w </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86"> skip_ {down} </script>  , et un tel remplacement ne donne rien, mais voyons comment dÃ©terminer si un nÅ“ud avec un nombre <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-992"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-993"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">je</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87"> i </script>  descendant droit.  Cela peut Ãªtre fait simplement en vÃ©rifiant son nombre impair (le bon enfant est dans la cellule <math></math><img src="https://habrastorage.org/getpro/habr/formulas/401/3d9/909/4013d9909b0167b12e3ffaca538dfa2e.svg" alt="2i + 1 $" data-tex="inline">  ), pour cela il suffit de calculer <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-994"><span class="noError" id="MJXp-Span-995" style="display: inline-block;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i \ &amp; 1</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> i \ & 1 </script>  .  C'est-Ã -dire  on divise le nombre <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-996"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89"> i </script>  deux si le bit le moins significatif est mis Ã  un.  Mais cela peut Ãªtre fait sans boucle, dans de nombreux processeurs, il existe une instruction <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">find first set</a> qui renvoie la position du premier bit dÃ©fini, en l'utilisant, nous transformons la boucle en quatre instructions de processeur. <br><br><div class="spoiler">  <b class="spoiler_title">Code de fonction de sous-arborescence optimisÃ©</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> skip_down(<span class="hljs-keyword"><span class="hljs-keyword">index_t</span></span> idx) { idx = idx &gt;&gt; (__builtin_ffs(~idx) - <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> left2right(idx); }</code> </pre><br></div></div><br>  AprÃ¨s cela, nous pouvons exclure la pile de la fonction de traversÃ©e de l'arbre et la remplacer par une paire <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-998"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">k</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">i</span><span class="MJXp-msubsup" id="MJXp-Span-1002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1004" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">n</span></span></span><span class="MJXp-mo" id="MJXp-Span-1009" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">x</span><span class="MJXp-msubsup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">t</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1015" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">p</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90"> skip_ {down} + next_ {up} </script>  , aprÃ¨s cela, la fonction semble encore plus simple: <br><br><div class="spoiler">  <b class="spoiler_title">Calcul de la force en traversant un arbre dans un tableau sans utiliser de pile</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> force_compute(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span>&amp; v1, <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> mass1) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">nbvertex_t</span></span> total_force; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> curr = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> tree_size = m_mass_center.size(); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> nbcoord_t </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">distance_sqr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">((v1 - m_mass_center[curr]).norm())</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(distance_sqr &gt; m_radius_sqr[curr]) { total_force += force(v1, m_mass_center[curr], mass1, m_mass[curr]); curr = skip_down(curr); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { curr = next_up(curr, tree_size); } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(curr != NBODY_HEAP_ROOT_INDEX); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> total_force; }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Au total, nous avons obtenu six combinaisons de traversÃ©e d'arbre et de calcul de force. </font><font style="vertical-align: inherit;">Comparez ces approches en termes de temps et de qualitÃ© de calcul. </font><font style="vertical-align: inherit;">Nous prenons comme mesure de la qualitÃ© la variation relative de l'Ã©nergie totale du systÃ¨me aprÃ¨s 100 itÃ©rations. </font><font style="vertical-align: inherit;">En tant que systÃ¨me modÃ¨le, nous prenons deux Â«galaxiesÂ» en interaction consistant en</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1018"><span class="MJXp-mn" id="MJXp-Span-1019">16384</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91">16384</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">corps chacun. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableau 4. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Combinaisons de la mÃ©thode de traversÃ©e des arbres et du calcul de la force</font></font></i> <br><table><tbody><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TraversÃ©e d'arbre / type de calcul de force </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Arbre avec pile </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â«PileÂ» avec une pile </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Â«TasÂ» sans pile </font></font></th></tr><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ItÃ©rations par numÃ©ro de corps </font></font></th><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cycle + arbre </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cycle + tas </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cycle + tas </font></font></td></tr><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Contournement des feuilles </font></font></th><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> arbre imbriquÃ© + arbre </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nestedtree + heap </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nestedtree + heapstackless </font></font></td></tr></tbody></table><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/dc4/be0/e89/dc4be0e898fd575d0bdf4228a5310884.svg"><br></a> <br></td><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/aa2/ca4/e2d/aa2ca4e2daa0cfa77f59f0e6112a3714.svg"><br></a> <br></td></tr><tr><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a) </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DÃ©pendance temporelle du calcul de fonction</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1020"><span class="MJXp-msubsup" id="MJXp-Span-1021"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1023" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-92-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-92">f_n</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">du rapport de la distance critique au nÅ“ud d'arbre Ã  son rayon (</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1024"><span class="MJXp-msubsup" id="MJXp-Span-1025"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1027" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-93-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-93">\lambda_{crit}</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></i> </td><td> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b) </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La dÃ©pendance du changement relatif d'Ã©nergie dans le systÃ¨me du rapport de la distance critique au nÅ“ud d'arbre Ã  son rayon (</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1032"><span class="MJXp-msubsup" id="MJXp-Span-1033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1035" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-94-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-94">\lambda_{crit}</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></i> </td></tr><tr><td colspan="2" align="center"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 10. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RÃ©sultats du calcul de fonction</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1040"><span class="MJXp-msubsup" id="MJXp-Span-1041"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1043" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-95-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-95">f_n</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de diffÃ©rentes maniÃ¨res sur le CPU (nombre de corps</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">N</span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1047">32768</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-96-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-96">N=32768</script></i>   <i>)</i> </td></tr></tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On peut voir que la mise en Å“uvre de 'nestedtree + tree' est dÃ©sespÃ©rÃ©ment en retard de vitesse, car </font><font style="vertical-align: inherit;">il manque de simultanÃ©itÃ©. </font><font style="vertical-align: inherit;">Les implÃ©mentations avec l'emplacement des nÅ“uds d'arborescence dans le tableau et l'indexation comme dans un segment binaire sont en tÃªte. </font><font style="vertical-align: inherit;">Le changement relatif d'Ã©nergie est nÃ©gligeable pour toutes les variantes avec</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1048"><span class="MJXp-msubsup" id="MJXp-Span-1049"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1050" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1051" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1056" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-1057">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-97-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-97">\lambda_{crit} > 1</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã‰galement sur la fig. </font><font style="vertical-align: inherit;">10a montre que pour (</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1058"><span class="MJXp-msubsup" id="MJXp-Span-1059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1061" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1066" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1067">10</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-98-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-98">\lambda_{crit} < 10</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) toutes les variantes de calcul de fonction </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1068"><span class="MJXp-msubsup" id="MJXp-Span-1069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1071" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-99-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-99">f_n</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dÃ©passer de maniÃ¨re significative en vitesse la version la plus optimisÃ©e du calcul exact (Â«openmp + bloc + optimisationÂ»), avec une augmentation supplÃ©mentaire </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1072"><span class="MJXp-msubsup" id="MJXp-Span-1073"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1075" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-100-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-100">\lambda_{crit}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> les implÃ©mentations avec un arbre perdent la version exacte. </font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TraversÃ©e de l'arbre GPU </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">J'ai essayÃ© de contourner l'arborescence du GPU en utilisant Ã  la fois la technologie OpenCL et CUDA. </font><font style="vertical-align: inherit;">L'option de stockage des nÅ“uds sous la forme d'un arbre a Ã©tÃ© immÃ©diatement rejetÃ©e, et seules les options ont Ã©tÃ© laissÃ©es avec le stockage de l'arbre dans un tableau avec indexation comme dans un tas binaire. </font><font style="vertical-align: inherit;">En gÃ©nÃ©ral, l'implÃ©mentation du cÅ“ur de calcul n'est pas trÃ¨s diffÃ©rente de la version CPU.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noyau OpenCL pour calculer la force en traversant un arbre (traversÃ©e dans l'ordre des corps de numÃ©rotation)</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">kernel </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ComputeTreeBH</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tree_size, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* y, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmx, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmy, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmz, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_mass, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_crit_r2)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = get_global_id(<span class="hljs-number"><span class="hljs-number">0</span></span>) + offset_n1; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stride = points_count; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rx = y; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* ry = rx + stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* rz = rx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vx = rx + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vy = rx + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vz = rx + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frx = f; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fry = frx + stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frz = frx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvx = frx + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvy = frx + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvz = frx + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = rx[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = ry[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = rz[n1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_data[MAX_STACK_SIZE] = {}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> curr = stack_data[--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dx = x1 - tree_cmx[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dy = y1 - tree_cmy[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dz = z1 - tree_cmz[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r2 = (dx * dx + dy * dy + dz * dz); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &gt; tree_crit_r2[curr]) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(r2); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> coeff = tree_mass[curr] / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; res_x -= dx; res_y -= dy; res_z -= dz; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> left = left_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rght = rght_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(left &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = left; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rght &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = rght; } } } frx[n1] = vx[n1]; fry[n1] = vy[n1]; frz[n1] = vz[n1]; fvx[n1] = res_x; fvy[n1] = res_y; fvz[n1] = res_z; }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans la premiÃ¨re version, la traversÃ©e de l'arborescence commenÃ§ait dans l'ordre de numÃ©rotation des corps de la matrice d'origine, de sorte que les threads voisins contournaient des parties complÃ¨tement diffÃ©rentes de l'arborescence, ce qui affectait nÃ©gativement les performances du cache de mÃ©moire GPU. </font><font style="vertical-align: inherit;">Par consÃ©quent, dans le deuxiÃ¨me mode de rÃ©alisation, une traversÃ©e a Ã©tÃ© appliquÃ©e, Ã  partir du haut de l'arborescence, dans ce cas, les threads voisins commencent Ã  traverser l'arbre le long du mÃªme chemin, car </font><font style="vertical-align: inherit;">les cimes des arbres voisins sont Ã  proximitÃ© et dans l'espace. </font><font style="vertical-align: inherit;">Il est Ã©galement important que nous choisissions la numÃ©rotation dans le tableau des nÅ“uds d'arbre non pas Ã  partir de zÃ©ro, mais dans l'un, dans ce cas, les feuilles de l'arbre sont stockÃ©es dans la seconde moitiÃ© du tableau, et avec un nombre de corps Ã©gal Ã  la puissance de deux, nous aurons un accÃ¨s Ã©gal Ã  la mÃ©moire par l'index tn1.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noyau OpenCL pour calculer la force en traversant un arbre (traversant les nÅ“uds de numÃ©rotation d'un arbre)</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">kernel </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ComputeHeapBH</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tree_size, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* y, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmx, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmy, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_cmz, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_mass, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* tree_crit_r2, __global </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">* body_n)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tree_offset = points_count - <span class="hljs-number"><span class="hljs-number">1</span></span> + NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stride = points_count; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tn1 = get_global_id(<span class="hljs-number"><span class="hljs-number">0</span></span>) + offset_n1 + tree_offset; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = body_n[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = tree_cmx[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = tree_cmy[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = tree_cmz[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_data[MAX_STACK_SIZE] = {}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> curr = stack_data[--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dx = x1 - tree_cmx[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dy = y1 - tree_cmy[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dz = z1 - tree_cmz[curr]; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r2 = (dx * dx + dy * dy + dz * dz); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &gt; tree_crit_r2[curr]) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(r2); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> coeff = tree_mass[curr] / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; res_x -= dx; res_y -= dy; res_z -= dz; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> left = left_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rght = rght_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(left &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = left; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rght &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = rght; } } } __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vx = y + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vy = y + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* vz = y + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frx = f; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fry = frx + stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* frz = frx + <span class="hljs-number"><span class="hljs-number">2</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvx = frx + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvy = frx + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride; __global <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>* fvz = frx + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride; frx[n1] = vx[n1]; fry[n1] = vy[n1]; frz[n1] = vz[n1]; fvx[n1] = res_x; fvy[n1] = res_y; fvz[n1] = res_z; }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En parcourant l'ordre de numÃ©rotation des nÅ“uds d'arbre, nous avons obtenu une augmentation des performances. Mais cette option peut Ã©galement Ãªtre amÃ©liorÃ©e. La mÃ©moire globale dans laquelle les nÅ“uds d'arbre sont actuellement situÃ©s est optimisÃ©e pour </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un accÃ¨s partagÃ©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , c'est-Ã -dire les threads d'un groupe doivent lire les mots situÃ©s dans un bloc de mÃ©moire. Dans notre cas, la traversÃ©e de l'arborescence commence le long des mÃªmes chemins, et nous demandons les mÃªmes donnÃ©es avec tous les threads du groupe, mais plus nous allons plus loin dans l'arborescence, les chemins des threads voisins divergent de plus en plus, et nous devons demander des donnÃ©es diffÃ©rentes, ce qui rÃ©duit plusieurs fois les performances du sous-systÃ¨me mÃ©moire. Mais les nÅ“uds de chaque sous-arbre appartenant au mÃªme niveau sont situÃ©s dans des cellules mÃ©moire relativement proches.</font></font> C'est-Ã -dire<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lors de la traversÃ©e du reste de l'arborescence, les threads voisins du cÅ“ur de calcul n'accÃ¨dent pas aux mÃªmes noeuds de l'arborescence, mais proches de la mÃ©moire. </font><font style="vertical-align: inherit;">Pour optimiser cet accÃ¨s mÃ©moire, une mÃ©moire de texture peut Ãªtre utilisÃ©e. </font><font style="vertical-align: inherit;">Mais il y a un hic. </font><font style="vertical-align: inherit;">Pour le moment, les textures ne prennent pas en charge le travail avec des donnÃ©es de double prÃ©cision (nous voulons calculer avec prÃ©cision). </font><font style="vertical-align: inherit;">Mais dans CUDA, il existe une fonction </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">__hiloint2double</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> qui collecte un nombre double prÃ©cision Ã  partir de deux entiers.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code de demande de nombre Ã  double prÃ©cision Ã  partir d'une texture contenant des entiers</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span>&lt;&gt; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nb1Dfetch</span></span></span><span class="hljs-class">&lt;double&gt; {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> double4 vec4; <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> __<span class="hljs-function"><span class="hljs-function">device__ </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">double</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetch</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cudaTextureObject_t tex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-function">int2 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tex1Dfetch&lt;int2&gt;(tex, i))</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> __hiloint2double(py, px); } <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> __<span class="hljs-function"><span class="hljs-function">device__ vec4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fetch4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cudaTextureObject_t tex, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> i)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ii</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-function"><span class="hljs-params"> * i)</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">int4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tex1Dfetch&lt;int4&gt;(tex, ii))</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">int4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">p2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(tex1Dfetch&lt;int4&gt;(tex, ii + </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">))</span></span></span></span>; vec4 d4 = {__hiloint2double(p1.y, p1.x), __hiloint2double(p1.w, p1.z), __hiloint2double(p2.y, p2.x), __hiloint2double(p2.w, p2.z) }; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> d4; } };</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dans ce cas, deux implÃ©mentations ont Ã©tÃ© effectuÃ©es, dans un chaque Ã©lÃ©ment de l'arborescence (x, y, z, tree_crit_r2) a Ã©tÃ© demandÃ© indÃ©pendamment, et dans la deuxiÃ¨me implÃ©mentation, ces demandes ont Ã©tÃ© combinÃ©es. </font><font style="vertical-align: inherit;">La demande de masse du nÅ“ud se produit beaucoup moins frÃ©quemment, uniquement si la condition </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r2&gt; tree_crit_r2 [curr] est remplie</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il est donc inutile de combiner cette demande avec les autres. </font><font style="vertical-align: inherit;">Une autre caractÃ©ristique utile du cadre CUDA est la possibilitÃ© de contrÃ´ler le rapport entre les tailles du cache L1 et la taille de la mÃ©moire partagÃ©e ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cudaFuncSetCacheConfig</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">En cas de traversÃ©e d'arbre, nous n'utilisons pas de mÃ©moire partagÃ©e, nous pouvons donc augmenter le cache L1 au dÃ©triment de celui-ci.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Noyau CUDA pour calculer la force en traversant un arbre (en parcourant l'ordre de numÃ©rotation des nÅ“uds d'arbre)</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">global__ </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kfcompute_heap_bh_tex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tree_size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, cudaTextureObject_t tree_xyzr, cudaTextureObject_t tree_mass, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">* body_n)</span></span></span><span class="hljs-function"> </span></span>{ nb1Dfetch&lt;<span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>&gt; tex; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tree_offset = points_count - <span class="hljs-number"><span class="hljs-number">1</span></span> + NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stride = points_count; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tn1 = blockDim.x * blockIdx.x + threadIdx.x + offset_n1 + tree_offset; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = body_n[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbvec4_t</span></span> xyzr = tex.fetch4(tree_xyzr, tn1); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = xyzr.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = xyzr.y; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = xyzr.z; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_data[MAX_STACK_SIZE] = {}; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stack_head = <span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>; stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span> != stack_head) { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> curr = stack_data[--<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">nbvec4_t</span></span> xyzr2 = tex.fetch4(tree_xyzr, curr); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dx = x1 - xyzr2.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dy = y1 - xyzr2.y; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dz = z1 - xyzr2.z; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r2 = (dx * dx + dy * dy + dz * dz); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &gt; xyzr2.w) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(r2); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> coeff = tex.fetch(tree_mass, curr) / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; res_x -= dx; res_y -= dy; res_z -= dz; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> left = nbody_heap_func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;::left_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> rght = nbody_heap_func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;::rght_idx(curr); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(left &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = left; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(rght &lt; tree_size) { stack_data[<span class="hljs-built_in"><span class="hljs-built_in">stack</span></span>++] = rght; } } } f[n1 + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride] = res_x; f[n1 + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride] = res_y; f[n1 + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride] = res_z; }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une analyse du programme dans le profileur nvprof a montrÃ© que mÃªme lors de l'utilisation de la mÃ©moire de texture pour stocker un arbre, il y a toujours une charge trÃ¨s Ã©levÃ©e sur la mÃ©moire globale. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En effet, dans CUDA, toute la mÃ©moire du noyau qui est adressÃ©e Ã  des adresses `` calculÃ©es '' est stockÃ©e dans la mÃ©moire globale, et en consÃ©quence la pile nÃ©cessaire pour parcourir l'arborescence est situÃ©e dans la mÃ©moire globale et ronge une partie importante de la bande passante de la puce mÃ©moire, car la pile a chaque thread d'exÃ©cution, et il y a beaucoup de threads. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mais, heureusement, nous savons dÃ©jÃ  traverser un arbre sans utiliser de pile. </font><font style="vertical-align: inherit;">En complÃ©ment du noyau de calcul prÃ©cÃ©dent avec les fonctions de calcul du prochain nÅ“ud d'arbre, nous obtenons un nouveau noyau, de plus, plus compact.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CUDA core pour calculer la force en traversant un arbre sans utiliser de pile</font></font></b> <div class="spoiler_text"><pre> <code class="cpp hljs">__<span class="hljs-function"><span class="hljs-function">global__ </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kfcompute_heap_bh_stackless</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> offset_n1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> points_count, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> tree_size, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">nbcoord_t</span></span></span></span><span class="hljs-function"><span class="hljs-params">* f, cudaTextureObject_t tree_xyzr, cudaTextureObject_t tree_mass, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">* body_n)</span></span></span><span class="hljs-function"> </span></span>{ nb1Dfetch&lt;<span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span>&gt; tex; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tree_offset = points_count - <span class="hljs-number"><span class="hljs-number">1</span></span> + NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> stride = points_count; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tn1 = blockDim.x * blockIdx.x + threadIdx.x + offset_n1 + tree_offset; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> n1 = body_n[tn1]; <span class="hljs-keyword"><span class="hljs-keyword">nbvec4_t</span></span> xyzr = tex.fetch4(tree_xyzr, tn1); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> x1 = xyzr.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> y1 = xyzr.y; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> z1 = xyzr.z; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_x = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_y = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> res_z = <span class="hljs-number"><span class="hljs-number">0.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> curr = NBODY_HEAP_ROOT_INDEX; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">nbvec4_t</span></span> xyzr2 = tex.fetch4(tree_xyzr, curr); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dx = x1 - xyzr2.x; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dy = y1 - xyzr2.y; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> dz = z1 - xyzr2.z; <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r2 = (dx * dx + dy * dy + dz * dz); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &gt; xyzr2.w) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(r2 &lt; NBODY_MIN_R) { r2 = NBODY_MIN_R; } <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> r = <span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(r2); <span class="hljs-keyword"><span class="hljs-keyword">nbcoord_t</span></span> coeff = tex.fetch(tree_mass, curr) / (r * r2); dx *= coeff; dy *= coeff; dz *= coeff; res_x -= dx; res_y -= dy; res_z -= dz; curr = nbody_heap_func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;::skip_idx(curr); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { curr = nbody_heap_func&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt;::next_up(curr, tree_size); } } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(curr != NBODY_HEAP_ROOT_INDEX); f[n1 + <span class="hljs-number"><span class="hljs-number">3</span></span> * stride] = res_x; f[n1 + <span class="hljs-number"><span class="hljs-number">4</span></span> * stride] = res_y; f[n1 + <span class="hljs-number"><span class="hljs-number">5</span></span> * stride] = res_z; }</code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Les performances des cÅ“urs exÃ©cutÃ©s sur le GPU dÃ©pendent fortement de la taille des blocs dans lesquels nous divisons la tÃ¢che. DÃ©pend de cette taille le nombre de registres, de mÃ©moire locale et d'autres ressources disponibles pour chaque thread de calcul. Vous devez Ã©galement garder Ã  l'esprit qu'en attendant l'accÃ¨s Ã  la mÃ©moire dans un thread, un autre thread peut effectuer des calculs sur le processeur de shader, ainsi, avec un nombre suffisant de threads s'exÃ©cutant simultanÃ©ment sur un processeur, le temps d'accÃ¨s Ã  la mÃ©moire sera cachÃ© derriÃ¨re les calculs. Par consÃ©quent, avant de comparer les performances de nos cÅ“urs, nous devons calculer la taille de bloc optimale pour chacun d'eux. Faisons une comparaison sur la moitiÃ© disponible de NVidia K80. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tableau 5. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La dÃ©pendance de la fonction de temps de calcul (en secondes)</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-msubsup" id="MJXp-Span-1081"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1083" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-101-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-101">f_n</script></i>  <i>     GPU    </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">N</span><span class="MJXp-mo" id="MJXp-Span-1086" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1087">131072</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-102-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-102">N=131072</script></i>  <i></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1088"><span class="MJXp-msubsup" id="MJXp-Span-1089"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1091" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1096" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1097">10</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-103-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-103">\lambda_{crit}=10</script></i> <br><table><tbody><tr><th>  / </th><th>  8 </th><th>  16 </th><th>  32 </th><th>  64 </th><th>  128 </th><th>  256 </th><th> 512 </th><th>  1024 </th></tr><tr><td> opencl+dense </td><td> 5.77 </td><td> 2.84 </td><td> 1.46 </td><td> <b>1.13</b> </td><td> 1.15 </td><td> 1.14 </td><td> 1.14 </td><td> 1.13 </td></tr><tr><td> cuda+dense </td><td> 5.44 </td><td> 2.55 </td><td> 1.27 </td><td> <b>0.96</b> </td><td> 0.97 </td><td> 0.99 </td><td> 0.99 </td><td>  - </td></tr><tr><td> opencl+heap+cycle </td><td> 5.88 </td><td> 5.65 </td><td> 5.74 </td><td> 5.96 </td><td> 5.37 </td><td> 5.38 </td><td> <b>5.35</b> </td><td> 5.38 </td></tr><tr><td> opencl+heap+nested </td><td> 4.54 </td><td>  <b>3,68</b> </td><td> 3.98 </td><td> 5.25 </td><td> 5.46 </td><td> 5.41 </td><td> 5.48 </td><td> 5.31 </td></tr><tr><td> cuda+heap+nested </td><td>  3,62 </td><td>  2,81 </td><td>  <b>2,68</b> </td><td> 4.26 </td><td> 4.84 </td><td> 4.75 </td><td> 4.8 </td><td> 4.67 </td></tr><tr><td> cuda+heap+nested+tex </td><td> 2.6 </td><td> 1.51 </td><td> 0.912 </td><td> <b>0.7</b> </td><td> 1.85 </td><td> 1.75 </td><td> 1.69 </td><td> 1.61 </td></tr><tr><td> cuda+heap+nested+tex+stackless </td><td> 2.3 </td><td> 1.29 </td><td> 0.773 </td><td> <b>0.5</b> </td><td> 0.51 </td><td> 0.52 </td><td> 0.52 </td><td> 0.52 </td></tr></tbody></table><br><br> <b> 6.</b> <i>   ( ) </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1098"><span class="MJXp-msubsup" id="MJXp-Span-1099"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1101" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-104-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-104">f_n</script></i>  <i>     GPU    </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">N</span><span class="MJXp-mo" id="MJXp-Span-1104" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1105">1</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-105-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-105">N=1M</script></i>  <i></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1107"><span class="MJXp-msubsup" id="MJXp-Span-1108"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1110" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1115" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1116">4</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-106-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-106">\lambda_{crit}=4</script></i> <br><table><tbody><tr><th>  / </th><th>  8 </th><th>  16 </th><th>  32 </th><th>  64 </th><th>  128 </th><th>  256 </th><th> 512 </th><th>  1024 </th></tr><tr><td> opencl+dense </td><td>  366 </td><td>  179 </td><td> 89.9 </td><td> 69.3 </td><td> 70.3 </td><td> 69.1 </td><td> 68.9 </td><td> <b>68.0</b> </td></tr><tr><td> cuda+dense </td><td>  346 </td><td> 162 </td><td> 79.6 </td><td> 60.8 </td><td> 60.8 </td><td> 60.7 </td><td> <b>59.6</b> </td><td>  - </td></tr><tr><td> opencl+heap+cycle </td><td> <b>16.2</b> </td><td> 18.2 </td><td>  20,1 </td><td> 21.2 </td><td> 21.2 </td><td> 21.3 </td><td> 21.2 </td><td> 21.1 </td></tr><tr><td> opencl+heap+nested </td><td> 10.5 </td><td> 7.63 </td><td>  <b>6.38</b> </td><td> 8.23 </td><td> 9.95 </td><td> 9.89 </td><td> 9.65 </td><td> 9.66 </td></tr><tr><td> cuda+heap+nested </td><td> 8.67 </td><td> 6.44 </td><td> <b>5.39</b> </td><td> 5.93 </td><td> 8.65 </td><td> 8.61 </td><td> 8.41 </td><td> 8.27 </td></tr><tr><td> cuda+heap+nested+tex </td><td> 6.38 </td><td>  3,57 </td><td> 2.13 </td><td> <b>1.44</b> </td><td> 3.56 </td><td> 3.46 </td><td> 3.30 </td><td> 3.29 </td></tr><tr><td> cuda+heap+nested+tex+stackless </td><td> 5.78 </td><td> 3.19 </td><td> 1.83 </td><td> 1.21 </td><td> 1.11 </td><td> <b>1.10</b> </td><td> 1.11 </td><td> 1.13 </td></tr></tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une situation difficile, mais, contrairement Ã  la version CPU du parcours de l'arborescence, il est clair que chaque Ã©tape d'optimisation apporte des rÃ©sultats tangibles. La mise en Å“uvre de Â«opencl + heap + cycleÂ» est presque 6 fois plus lente qu'une solution exacte avec calcul de fonction complÃ¨te</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1117"><span class="MJXp-msubsup" id="MJXp-Span-1118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1120" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-107-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-107">f_n</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une implÃ©mentation de 'opencl + heap + nested', dans laquelle une traversÃ©e d'arbre commence Ã  partir de nÅ“uds voisins, 1,4 fois plus rapide que la prÃ©cÃ©dente, car La mÃ©moire cache est mieux utilisÃ©e. Dans l'implÃ©mentation de 'cuda + heap + nested', le cache L1 a Ã©tÃ© augmentÃ© au dÃ©triment de la mÃ©moire partagÃ©e, ce qui a augmentÃ© la vitesse de 1,4 fois, bien qu'il soit possible que dans l'implÃ©mentation de cuda, le noyau de compilation soit compilÃ© de maniÃ¨re plus optimale (dans les versions de 'opencl + dense' et 'cuda + les cÅ“urs denses sont identiques et les performances de la version de cuda sont environ 1,2 fois supÃ©rieures). L'augmentation la plus importante de la vitesse de calcul (3,8 fois) est obtenue lorsque l'arbre est situÃ© dans la mÃ©moire de texture et que les requÃªtes sur les Ã©lÃ©ments du nÅ“ud d'arbre sont combinÃ©es. L'implÃ©mentation avec traversÃ©e d'arbre sans utiliser la pile 'cuda + heap + nested + tex + stackless' est Ã©galement 1,4 fois plus rapide.dans ce document, toute la bande passante du bus mÃ©moire est utilisÃ©e uniquement pour accÃ©der aux donnÃ©es sur les nÅ“uds d'arbre et n'est pas dÃ©pensÃ©e sur la pile. Ainsi, avec</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1121"><span class="MJXp-msubsup" id="MJXp-Span-1122"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1124" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1129" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1130">10</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-108-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-108">\lambda_{crit}=10</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Il a Ã©tÃ© possible d'obtenir une accÃ©lÃ©ration deux fois par rapport au calcul complet de la fonction </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1131"><span class="MJXp-msubsup" id="MJXp-Span-1132"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1134" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-109-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-109">f_n</script>  .  Mais <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1135"><span class="MJXp-msubsup" id="MJXp-Span-1136"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1138" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1140">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1143" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1144">10</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110">\lambda_{crit}=10</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> une valeur excessivement grande du paramÃ¨tre, sur le graphique de la variation relative de l'Ã©nergie dans le systÃ¨me du rapport de la distance critique au nÅ“ud d'arbre Ã  son rayon pour la mise en Å“uvre du CPU, on peut voir que des valeurs infÃ©rieures peuvent Ãªtre utilisÃ©es </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1145"><span class="MJXp-msubsup" id="MJXp-Span-1146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1148" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1152">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111">\lambda_{crit}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sans perte visible de prÃ©cision. </font><font style="vertical-align: inherit;">Essayons de varier</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1153"><span class="MJXp-msubsup" id="MJXp-Span-1154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1156" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-112">\lambda_{crit}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> avec les tailles de blocs optimales que nous avons dÃ©terminÃ©es Ã  l'Ã©tape prÃ©cÃ©dente. </font></font><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/ae8/8b7/344/ae88b7344bf6c884545168e2870edeec.svg"><br></a> <br></td><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/85e/073/df6/85e073df6103f00705376ff7deb32ca1.svg"><br></a> <br></td></tr><tr><td align="center"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a)</font></font></b> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">N</span><span class="MJXp-mo" id="MJXp-Span-1163" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1164">128</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">K</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113">N=128K</script><br></td><td align="center"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b)</font></font></b> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1166"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">N</span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1169">1</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114">N=1M</script><br></td></tr><tr><td colspan="2" align="center"> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fig. 11. </font></font></b> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DÃ©pendance du temps de calcul de la fonction.</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1171"><span class="MJXp-msubsup" id="MJXp-Span-1172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1174" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115">f_n</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">du rapport de la distance critique au nÅ“ud d'arbre Ã  son rayon (</font></font></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1175"><span class="MJXp-msubsup" id="MJXp-Span-1176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1178" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1181">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116">\lambda_{crit}</script></i>  <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) pour diverses implÃ©mentations d'arborescence GPU</font></font></i> <br></td></tr></tbody></table><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> On peut voir que pour les petits </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1183"><span class="MJXp-msubsup" id="MJXp-Span-1184"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1186" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">t</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117">\lambda_{crit}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> toutes les mÃ©thodes de calcul de fonction </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1191"><span class="MJXp-msubsup" id="MJXp-Span-1192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1194" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118">f_n</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aller aux valeurs proches, dÃ©terminÃ©es par le temps de construction de l'arborescence kd et de prÃ©paration des donnÃ©es pour le GPU. </font><font style="vertical-align: inherit;">De plus, le temps de construction d'un arbre contribue de maniÃ¨re significative au temps total</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1195"><span class="MJXp-msubsup" id="MJXp-Span-1196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1198" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0.333em; margin-right: 0.333em;">â‰¤</span><span class="MJXp-mn" id="MJXp-Span-1204">4</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-119-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-119">\lambda_{crit}\leq 4</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, alors cette fois peut Ãªtre nÃ©gligÃ©e. </font><font style="vertical-align: inherit;">Il est intÃ©ressant de noter que lorsque</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">N</span><span class="MJXp-mo" id="MJXp-Span-1207" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1208">128</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">K</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-120-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-120">N=128K</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> les performances s'amÃ©liorent Ã  nouveau en atteignant </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1210"><span class="MJXp-msubsup" id="MJXp-Span-1211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1212" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1213" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1218" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1219">1024</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-121-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-121">\lambda_{crit}=1024</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cela est probablement dÃ» au fait que tous les threads du GPU tournent autour des mÃªmes sommets d'arbre en mÃªme temps, ce qui amÃ©liore l'utilisation du cache L1 et Ã©limine complÃ¨tement la </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">`` divergence de branche ''</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">On voit Ã©galement que la meilleure performance pour une implÃ©mentation sans pile (cuda + heap + nested + tex + stackless), elle surpasse la version avec la pile Ã  environ</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1220"><span class="MJXp-mn" id="MJXp-Span-1221">1.4</span><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0.267em; margin-right: 0.267em;">âˆ’</span><span class="MJXp-mn" id="MJXp-Span-1223">1.5</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-122-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-122">1.4-1.5</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">fois. </font><font style="vertical-align: inherit;">D'autres implÃ©mentations sont plusieurs fois plus lentes. </font><font style="vertical-align: inherit;">Pour consolider le rÃ©sultat, nous allons calculer le temps sur un GPU avec une architecture plus rÃ©cente.</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RÃ©sultats de lancement sur GeForce GTX 1080 Ti (prÃ©cision unique)</font></font></b> <div class="spoiler_text"> <b> 7.</b> <i>   ( ) </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1224"><span class="MJXp-msubsup" id="MJXp-Span-1225"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1227" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-123">f_n</script></i>  <i>     GPU    </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">N</span><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1231">1</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">M</span></span></span><script type="math/tex" id="MathJax-Element-124">N=1M</script></i>  <i></i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1233"><span class="MJXp-msubsup" id="MJXp-Span-1234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1236" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1238">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">t</span></span></span><span class="MJXp-mo" id="MJXp-Span-1241" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1242">4</span></span></span><script type="math/tex" id="MathJax-Element-125">\lambda_{crit}=4</script></i> <br><table><tbody><tr><th>  / </th><th>  8 </th><th>  16 </th><th>  32 </th><th>  64 </th><th>  128 </th><th>  256 </th><th> 512 </th><th>  1024 </th></tr><tr><td> opencl+dense </td><td> 47.8 </td><td> 23.4 </td><td> 11.6 </td><td> <b>11.59</b> </td><td> 12.8 </td><td> 12.8 </td><td> 12.8 </td><td> 12.8 </td></tr><tr><td> cuda+dense </td><td> 49.0 </td><td> 23.8 </td><td> 11.9 </td><td> 11.8 </td><td> <b>11.7</b> </td><td> 11.7 </td><td> 11.7 </td><td> 11.7 </td></tr><tr><td> opencl+heap+cycle </td><td> 7.48 </td><td> 8.26 </td><td> 7.73 </td><td> 7.36 </td><td> 7.33 </td><td> <b>7.27</b> </td><td>  7.25 </td><td> 7.26 </td></tr><tr><td> opencl+heap+nested </td><td> 1.33 </td><td> <b>1.20</b> </td><td> 1.41 </td><td> 2.46 </td><td> 2.53 </td><td> 2.49 </td><td> 2.44 </td><td> 2.47 </td></tr><tr><td> cuda+heap+nested </td><td> 1.23 </td><td> <b>1.10</b> </td><td> 1.31 </td><td> 2.28 </td><td> 2.29 </td><td> 2.28 </td><td> 2.23 </td><td> 2.25 </td></tr><tr><td> cuda+heap+nested+tex </td><td> 0.88 </td><td> 0.68 </td><td> <b>0.654</b> </td><td> 1.6 </td><td> 1.6 </td><td> 1.6 </td><td> 1.6 </td><td> 1.6 </td></tr><tr><td> cuda+heap+nested+tex+stackless </td><td> 0.71 </td><td> 0.47 </td><td> 0.45 </td><td> 0.43 </td><td> 0.43 </td><td> 0.42 </td><td> 0.41 </td><td> <b>0.395</b> </td></tr></tbody></table><br><table><tbody><tr><td align="center"> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/b14/d81/e27/b14d81e271e2edf7b1d70faa815e1710.svg"><br></a> <br></td></tr><tr><td align="center"> <b> 12.</b> <i>   </i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1243"><span class="MJXp-msubsup" id="MJXp-Span-1244"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1246" style="vertical-align: -0.4em;">n</span></span></span></span><script type="math/tex" id="MathJax-Element-126">f_n</script></i>  <i>          (</i> <math> </math><i><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1247"><span class="MJXp-msubsup" id="MJXp-Span-1248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249" style="margin-right: 0.05em;">Î»</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1250" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1253">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">t</span></span></span></span></span><script type="math/tex" id="MathJax-Element-127">\lambda_{crit}</script></i>  <i>)   GPU   </i> <br></td></tr></tbody></table><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Lorsque vous utilisez la GeForce GTX 1080 Ti pour le calcul, la diffÃ©rence entre les marches d'arbre avec une pile et sans pile est jusqu'Ã  deux fois, Ã  condition de nÃ©gliger le temps nÃ©cessaire Ã  la construction de l'arbre. </font><font style="vertical-align: inherit;">Ce fait nous pousse Ã  garantir qu'Ã  l'avenir le portage vers le GPU et la construction d'un arbre. </font><font style="vertical-align: inherit;">Une comparaison des tableaux 5-7 montre qu'il n'y a pas de taille de bloc optimale unique pour un nombre diffÃ©rent de corps, et encore plus pour diffÃ©rentes architectures GPU, de plus, la diffÃ©rence de temps de calcul peut atteindre plusieurs fois, mÃªme si vous ne tenez pas compte des valeurs limites. </font><font style="vertical-align: inherit;">Ainsi, avant de longs calculs, il est logique de dÃ©terminer la taille de bloc optimale pour chaque configuration. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">La principale chose que nous avons obtenue est la capacitÃ© de modÃ©liser l'interaction par paire d'un peu plus d'un million de corps (</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1255"><span class="MJXp-msubsup" id="MJXp-Span-1256"><span class="MJXp-mn" id="MJXp-Span-1257" style="margin-right: 0.05em;">2</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1258" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-1259">20</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-128-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-128">2^{20}</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) pendant un temps raisonnable sur un, pas le dernier GPU. Sur les nouveaux GPU (Tesla V100), apparemment, il sera possible de traiter dÃ©jÃ  environ deux millions de corps en interaction dans un dÃ©lai raisonnable, car leurs performances sont environ quatre fois supÃ©rieures Ã  la moitiÃ© de la Tesla K80. Bien que ce nombre soit Ã©galement incomparable avec le nombre d'Ã©toiles mÃªme dans les galaxies naines, comme le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Petit Nuage de Magellan</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais, Ã  mon avis, est impressionnant.</font></font><br><br><h2>  Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">L'utilisation de mÃ©thodes intÃ©grÃ©es pour rÃ©soudre des Ã©quations diffÃ©rentielles permet de rÃ©soudre des problÃ¨mes similaires avec un haut niveau de prÃ©cision Ã  un coÃ»t relativement faible, et l'application d'algorithmes pour approximer la fonction de calcul des forces d'attraction par paire nous permet de traiter des volumes colossaux de corps en interaction. </font><font style="vertical-align: inherit;">Ainsi, contrairement aux extraterrestres des Â«tÃ¢ches Ã  trois corpsÂ», nous sommes en mesure de rÃ©soudre le problÃ¨me</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-129-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-129">N</script><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> corps, et pour un petit nombre de corps et pour des amas d'Ã©toiles entiers, mais au prix d'une perte de prÃ©cision. </font></font><br><br><h4>  Visualisation </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pour ceux qui ont lu jusqu'Ã  la fin, je donnerai quelques vidÃ©os supplÃ©mentaires avec visualisation de l'Ã©volution des systÃ¨mes de corps. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulation d'une collision de deux galaxies. </font><font style="vertical-align: inherit;">Le nombre total de corps est de 60 mille.</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/AYzgTC0qqV0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ModÃ©lisation de l'Ã©volution d'une galaxie composÃ©e d'un million d'Ã©toiles. </font><font style="vertical-align: inherit;">Au centre se trouve un corps d'une masse de 99% du total. </font><font style="vertical-align: inherit;">Les particules simples sont presque indiscernables. </font><font style="vertical-align: inherit;">DÃ©jÃ  plus comme une vague dans une goutte de liquide. </font><font style="vertical-align: inherit;">ColorisÃ© selon le module de vitesse. </font><font style="vertical-align: inherit;">Basse vitesse - bleu, moyen - vert, haut - rouge. </font><font style="vertical-align: inherit;">On voit qu'au centre la vitesse est plus Ã©levÃ©e, et diminue progressivement jusqu'aux bords, et la plus basse dans le plan Ã©quatorial.</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/0_8nZCrVqWI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Une simulation plus Â«dynamiqueÂ» de l'Ã©volution d'une galaxie d'un million d'Ã©toiles. </font><font style="vertical-align: inherit;">Au centre se trouve un corps d'une masse de 10% du total. </font><font style="vertical-align: inherit;">Le corps central affecte beaucoup moins le reste. </font><font style="vertical-align: inherit;">D'abord, les Â«Ã©toilesÂ» s'envolent, puis se regroupent en plusieurs grappes, et Ã  la fin forment Ã  nouveau une grande grappe. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En cours de modÃ©lisation, environ 5% des Â«Ã©toilesÂ» ont quittÃ© irrÃ©vocablement la rÃ©gion initiale.</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/XLvIPK6m6QI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ã€ la 10e seconde, elle ressemble beaucoup Ã  la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">galaxie de roue de charrette</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> existante </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le code du projet peut Ãªtre trouvÃ© sur le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr437014/">https://habr.com/ru/post/fr437014/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr437002/index.html">ASP.NET Core valide</a></li>
<li><a href="../fr437004/index.html">Les programmeurs YML rÃªvent-ils de tests ansibles?</a></li>
<li><a href="../fr437006/index.html">Test de l'imprimante 3D Wanhao Duplicator 10</a></li>
<li><a href="../fr437008/index.html">PNL. Les bases. Techniques. DÃ©veloppement personnel. Partie 1</a></li>
<li><a href="../fr437010/index.html">Ã‰chos du passÃ©: l'expÃ©rience de Young Ã  la base de la nouvelle mÃ©thode de spectroscopie aux rayons X</a></li>
<li><a href="../fr437018/index.html">Quelques piÃ¨ges de la saisie statique en Python</a></li>
<li><a href="../fr437020/index.html">Quel est le problÃ¨me avec l'apprentissage par renforcement?</a></li>
<li><a href="../fr437022/index.html">Bit de sÃ©curitÃ© contre le bruit 0x22 (attaques par injection de dÃ©fauts, 35C3 et Wallet.fail)</a></li>
<li><a href="../fr437026/index.html">Google en France inflige une amende de 50 millions d'euros au RGPD pour abus de donnÃ©es Ã  caractÃ¨re personnel</a></li>
<li><a href="../fr437030/index.html">Automatisation de l'infrastructure d'un bureau de luxe: Ã  quoi elle ressemble</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>