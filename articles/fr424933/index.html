<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚öõÔ∏è üí∂ ü§ûüèª Comment nous avons transform√© les mauvaises pr√©visions en pr√©visions l√©g√®rement meilleures (suite) üèîÔ∏è üëÇüèæ üå°Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dans un article pr√©c√©dent, j'ai expliqu√© comment, aux fins de la pr√©vision des revenus, les gens ont cr√©√© un fichier Excel volumineux et complexe ( vo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment nous avons transform√© les mauvaises pr√©visions en pr√©visions l√©g√®rement meilleures (suite)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424933/"><p>  Dans un article pr√©c√©dent, j'ai expliqu√© comment, aux fins de la pr√©vision des revenus, les gens ont cr√©√© un fichier Excel volumineux et complexe ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vous pouvez le lire ici</a> ).  Nous avons d√©cid√© d'intervenir dans cette honte et avons propos√© de refaire le mod√®le de pr√©vision afin qu'il y ait moins d'erreurs, un fonctionnement plus facile et une flexibilit√© de r√©glage. </p><br><h3 id="kakie-klyuchevye-problemy-v-opisannoy-modeli">  Quels sont les principaux probl√®mes du mod√®le d√©crit: </h3><br><ol><li>  Les donn√©es, le mod√®le et les vues sont m√©lang√©s en une seule entit√©.  Pour cette raison, un changement dans au moins un √©l√©ment d√©truit tout ce monolithe. </li><li>  Calcul excessif pour le traitement manuel, ce qui provoque des erreurs et des fautes de frappe en grandes quantit√©s. </li></ol><br><h3 id="chto-my-predlozhili">  Ce que nous avons sugg√©r√©: </h3><br><ol><li>  Dans le mod√®le initial, les donn√©es initiales sur lesquelles il a √©t√© construit n'apparaissaient nulle part.  Nous avons propos√© de saisir ces donn√©es au format du 2√®me formulaire normal dans le fichier Excel lui-m√™me sur 2 feuilles distinctes (ventes et nombre de clients).  Heureusement, les donn√©es de ventes dans notre agr√©gation par mois ne sont que des dizaines de milliers de lignes, pas des millions.  Nous avons √©galement configur√© pour recevoir ces donn√©es √† l'aide de Power Query directement √† partir de la base de donn√©es. <a name="habracut"></a></li><li>  Nous avons cr√©√© une feuille de mod√©lisation, qui se compose de 3 blocs: <br><ul><li>  Tableau crois√© dynamique des revenus </li><li>  Tableau r√©capitulatif du nombre de clients </li><li>  Tableau de r√®glement des ch√®ques moyens <br>  Chaque tableau crois√© dynamique est un tableau crois√© dynamique construit sur les donn√©es source dans les d√©tails requis pour la simulation en cours par les d√©partements et divisions, dans les d√©tails requis sur les p√©riodes (mois). <br><img src="https://habrastorage.org/webt/uv/3z/mh/uv3zmh-wl4awfrj6rfexngymb5q.png"></li></ul></li><li>  Dans la feuille de simulation, nous avons construit des mod√®les de pr√©vision simples bas√©s sur des s√©ries chronologiques historiques.  Nous avons augment√© le nombre de clients et la facture moyenne, et le total des revenus pr√©visionnels a √©t√© consid√©r√© comme un produit de ces valeurs.  Apr√®s avoir examin√© les donn√©es, nous avons trouv√© 3 mod√®les de pr√©vision: m√©diane pour les p√©riodes pass√©es, triple lissage exponentiel et r√©duction √† z√©ro (lorsque nous avons besoin de 0 pr√©vision). <br><img src="https://habrastorage.org/webt/xn/-e/x7/xn-ex79q2h2-u1ntngvxiavkr0m.png"></li><li>  Le calcul de la recette moyenne (fait) et du revenu (pr√©vision) se fait non pas en r√©f√©ren√ßant les cellules, mais en utilisant le VLR et le marquage offset, ce qui rend les calculs r√©sistants aux changements des donn√©es initiales. <br><img src="https://habrastorage.org/webt/gn/y7/sw/gny7swii7rerdwbdgdswbbbllps.png"></li><li>  Il est clair que maintenant le mod√®le n'est pas lisible par l'utilisateur, car  il y a trop de significations.  Pour ce faire, nous avons construit des fiches d'unit√©s distinctes.  Chaque feuille poss√®de une cellule qui s√©lectionne les donn√©es √† r√©sumer dans cette feuille.  Sur la base de RECHERCHEV, nous extrayons des donn√©es de la feuille de mod√®le dans la feuille. </li><li>  La cr√©ation de 30 feuilles par unit√©s s'est faite selon une proc√©dure sp√©ciale.  Tout d'abord, la premi√®re feuille est cr√©√©e, l'une des unit√©s, qui contient tous les noms possibles des d√©partements.  S'il n'y a pas de d√©partement dans une subdivision, les formules les ram√®nent √† 0. Pour cr√©er les 30 subdivisions, nous cr√©ons des doublons et modifions les noms dans la cellule de contr√¥le (il est utilis√© pour g√©n√©rer la cl√© RECHERCHEV) et nous avons les donn√©es n√©cessaires sous la forme d'une pr√©sentation.  Le RECHERCHEV peut utiliser plus d'une cellule comme cl√©, si vous utilisez l'astuce: combinez les cellules dont vous avez besoin en une en utilisant la concat√©nation (la fonction CLIP ou le symbole &amp;). </li><li>  Un √©l√©ment a √©t√© ajout√© au formulaire de pr√©sentation qui vous permet de contr√¥ler le mod√®le: un simple multiplicateur aux valeurs pr√©dites de la v√©rification et du nombre moyens.  Cet √©l√©ment est collect√© sur une fiche technique sp√©ciale √† l'aide de la fonction INDIRECTE, qui vous permet d'utiliser le lien g√©n√©r√©.  A partir de cette fiche technique, toutes ces corrections sont transf√©r√©es √† l'aide de la RECHERCHEV sur la fiche mod√®le. <br><img src="https://habrastorage.org/webt/nn/pw/zv/nnpwzvykp3sqghpaimfbouefgkk.png"></li><li>  Les feuilles de g√©n√©ralisation ne sont plus un r√©sum√© des feuilles de pr√©sentation, mais sont construites exactement de la m√™me mani√®re que toutes les autres feuilles - en additionnant les donn√©es sur une feuille avec un mod√®le.  En cons√©quence, les repr√©sentations sont de pures repr√©sentations et n'ont aucune d√©pendance entre elles. </li></ol><br><h3 id="chto-my-poluchili">  Ce que nous avons obtenu: </h3><br><ol><li>  Il est toujours clair √† partir de quels chiffres nous avons obtenu les donn√©es (car la requ√™te Power Query a √©t√© enregistr√©e). </li><li>  Nous pouvons changer les donn√©es sans casser le mod√®le. </li><li>  Les changements dans la structure et la hi√©rarchie n√©cessiteront des modifications mineures (il vous suffit de changer les noms sur 1 feuille de la pr√©sentation et ensuite de les dupliquer). </li><li>  Nous avons consid√©rablement r√©duit le nombre d'erreurs potentielles, car  La plupart des donn√©es sont remplies √† l'aide de formules, de liens et de cl√©s. </li><li>  Le client a re√ßu une pr√©vision interactive, dans laquelle il peut modifier lui-m√™me les valeurs et recevoir imm√©diatement une pr√©vision. </li><li>  Nous avons √©t√© en mesure de r√©pondre simultan√©ment aux exigences dont nous avons besoin de donn√©es √† la fois en termes annuels et mensuels. </li><li>  Peut √™tre utilis√© dans la prochaine p√©riode budg√©taire. </li><li>  Vous pouvez modifier les mod√®les de pr√©vision s'ils nous semblent inappropri√©s. </li></ol><br><h3 id="pochemu-my-reshili-ostatsya-v-eksele-a-ne-peredelali-eto-na-kakie-to-drugie-tehnologii">  Pourquoi avons-nous d√©cid√© de rester dans Excel et ne l'avons pas refait sur d'autres technologies? </h3><br><ol><li>  Nous devions laisser ce dossier dans le fonctionnement des employ√©s actuels.  Dans Excel, il nous est plus facile de montrer comment tout cela fonctionne et ce qu'ils peuvent r√©soudre. </li><li>  Excel fait face √† la t√¢che et √† d'autres solutions - des entit√©s superflues. </li><li>  Le client est habitu√© √† ce formulaire et √† ¬´recycler¬ª certains co√ªts de main-d'≈ìuvre que nous ne pouvions pas nous permettre. </li></ol><br><p>  Combien de temps cela nous a pris: environ 5 jours ouvrables, o√π 1 personne a pass√© 2 √† 4 heures par jour, et √† la fin de la journ√©e, nous avons examin√© les r√©sultats. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr424933/">https://habr.com/ru/post/fr424933/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr424921/index.html">Comment les math√©matiques du r√©seau peuvent vous aider √† vous faire des amis</a></li>
<li><a href="../fr424923/index.html">Rencontrez des anarchistes qui se soignent eux-m√™mes</a></li>
<li><a href="../fr424925/index.html">Le Wi-Fi est plus s√ªr: tout ce que vous devez savoir sur WPA3</a></li>
<li><a href="../fr424927/index.html">Dans l'ombre du Grand Cosmos</a></li>
<li><a href="../fr424929/index.html">Miracle asiatique Shimano: l'histoire du l√©gendaire fabricant d'√©quipement de v√©lo</a></li>
<li><a href="../fr424935/index.html">Food Design Digest, septembre 2018</a></li>
<li><a href="../fr424937/index.html">√âv√©nements num√©riques √† Moscou du 1er au 7 octobre</a></li>
<li><a href="../fr424939/index.html">Polymorphic Quine</a></li>
<li><a href="../fr424941/index.html">Streaming de donn√©es d'un service REST vers une file d'attente MQ</a></li>
<li><a href="../fr424945/index.html">Le smartphone conduit une petite voiture.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>