<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñ§ üâê üõåüèª Rainbow CSV plugin como uma alternativa ao Excel üê≤ üè¢ üîå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ol√° Habr! Este artigo √© sobre o plugin Rainbow CSV que escrevi para 5 editores de texto: 


 C√≥digo VS , Vim , Texto sublime 3 , Atom , Gedit 


 Acho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rainbow CSV plugin como uma alternativa ao Excel</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429548/"><p>  Ol√° Habr!  Este artigo √© sobre o plugin Rainbow CSV que escrevi para 5 editores de texto: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">C√≥digo VS</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Vim</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Texto sublime 3</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Atom</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gedit</a> </p><br><p>  Acho que muitos leitores deste artigo encontram periodicamente arquivos CSV (separados por v√≠rgula), TSV (separados por tabula√ß√£o) e similares.  Se voc√™ tentar abri-los em um editor de texto (e de que outra forma descobrir o que h√° dentro?), Uma imagem completamente simples ser√° exibida como no lado esquerdo da imagem.  Olhando para ele, √© dif√≠cil dizer quantas colunas est√£o na tabela.  No lado direito da imagem est√° o mesmo arquivo com o RainbowCSV ativado, a legibilidade √© significativamente aprimorada devido ao realce da sintaxe. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c66/3f3/956/c663f3956de322003c5b926fd21693a6.png" alt="imagem"></p><a name="habracut"></a><br><p>  Curiosamente, a sintaxe para esse destaque √© definida usando apenas uma (embora longa) linha de express√£o regular: </p><br><pre><code class="hljs powershell">((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?((?:<span class="hljs-string"><span class="hljs-string">"(?:[^"</span></span>]*<span class="hljs-string"><span class="hljs-string">""</span></span>)*[^<span class="hljs-string"><span class="hljs-string">"]*"</span></span>(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>))|(?:[^,]*(?:,|<span class="hljs-variable"><span class="hljs-variable">$</span></span>)))?</code> </pre> <br><p>  A regra de destaque pode ser encontrada inteiramente, por exemplo, <a href="">aqui</a> (vers√£o para VS Code), mas, al√©m da pr√≥pria express√£o regular, n√£o h√° absolutamente nada para se olhar. </p><br><p>  Por compara√ß√£o, os arquivos de sintaxe s√£o para linguagens de uso geral, como Python, JS, C ++, etc.  Geralmente ocupam v√°rias centenas de linhas de um c√≥digo muito esot√©rico. </p><br><p>  Para n√£o carregar o artigo em detalhes, √© poss√≠vel adivinhar quais partes b√°sicas ele consiste e como essa express√£o regular funciona √© oferecida aos leitores. </p><br><p>  Dica: Aqui est√° uma express√£o simples <code>([^,]*,)?([^,]*,)?</code>  - Destaque o arquivo CSV em duas cores alternadas diferentes, mas n√£o funcionar√° corretamente em v√≠rgulas dentro de campos com aspas. </p><br><p>  A prop√≥sito, a seguir, a vers√£o do Rainbow CSV para o Visual Studio Code √© descrita, porque  Esta √© a vers√£o do plug-in atualmente mais avan√ßada e popular tecnicamente (mais de 500.000 downloads). </p><br><p>  Portanto, al√©m do fato de o Rainbow CSV destacar as colunas, ele tamb√©m pode: </p><br><ul><li>  Diga para qual coluna o cursor est√° apontando no momento: n√∫mero da coluna + nome da primeira linha de t√≠tulo.  Se n√£o houver uma linha de cabe√ßalho no in√≠cio do arquivo (os dados s√£o enviados imediatamente), o usu√°rio pode definir seu cabe√ßalho "Virtual". </li><li>  Verifique automaticamente o arquivo para um n√∫mero diferente de entradas por linha ou para o uso incorreto de caracteres de escape - "CSV Lint". </li><li>  Execute uma consulta semelhante a SQL usando o interpretador RBQL interno, que permite aplicar uma classe muito ampla de transforma√ß√µes de texto √† tabela de entrada. <br>  O RBQL suporta quase todas as instru√ß√µes SQL (SELECT, UPDATE, WHERE, ORDER BY, TOP / LIMIT, JOIN, GROUP BY), bem como todas as fun√ß√µes e instru√ß√µes padr√£o do JavaScript e Python. <br>  O RBQL √© uma tecnologia separada, mas se encaixa muito bem com o conceito de Rainbow CSV e, portanto, essa integra√ß√£o oferece muitas vantagens. </li></ul><br><p>  Um dos recursos mais importantes dos plugins Rainbow CSV √© a detec√ß√£o autom√°tica de arquivos CSV pelo seu conte√∫do.  Essa funcionalidade √© essencial porque  Geralmente, os arquivos CSV (ou TSV) t√™m uma extens√£o de arquivo diferente de .csv (.tsv).  Voc√™ tamb√©m pode encontrar arquivos com a extens√£o .csv, na qual um ponto-e-v√≠rgula √© realmente usado como separador <code>;</code>  .  O algoritmo para determinar um arquivo de tabela pelo conte√∫do √© muito simples - basta verificar se o n√∫mero de c√©lulas em cada linha ao dividir este separador √© constante&gt; 1. </p><br><h3 id="sravnenie-rainbow-csv-s-graficheskim-vyravnivaniem">  Compara√ß√£o do Rainbow CSV com alinhamento gr√°fico </h3><br><p>  Em geral, a maneira tradicional de visualizar dados CSV √© import√°-los para um editor gr√°fico como o Excel. <br>  Comparado a esse m√©todo, o Rainbow CSV possui vantagens e desvantagens: </p><br><h4 id="preimuschestva">  Vantagens: </h4><br><ul><li>  O que voc√™ v√™ √© o que obt√©m - voc√™ pode ter certeza de que o que √© vis√≠vel na tela √© o conte√∫do real do arquivo. </li><li>  Ambiente familiar do seu editor de texto favorito </li><li>  Abstra√ß√£o de custo zero: o destaque da sintaxe √© muito "barato" do ponto de vista computacional comparado ao alinhamento gr√°fico. </li><li>  Maior densidade de informa√ß√µes: mais dados se encaixam em uma tela - o alinhamento gr√°fico ‚Äúconsome‚Äù muito espa√ßo devido aos espa√ßos de alinhamento. </li><li>  A capacidade de vincular visualmente uma coluna (destacada na mesma cor) de diferentes janelas </li></ul><br><h4 id="nedostatki">  Desvantagens: </h4><br><ul><li>  A implementa√ß√£o padr√£o usa 10 cores diferentes; portanto, quando o n√∫mero de colunas √© superior a 10, as cores come√ßam a se repetir e a efici√™ncia do c√≥digo de cores das colunas diminui. </li><li>  N√£o h√° suporte para agrupar linhas em c√©lulas com escape entre aspas duplas.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui</a> voc√™ pode ler os detalhes deste problema.  No entanto, acredito que o CSV com quebra de linha dentro das c√©lulas √© um formato extremamente impratic√°vel. </li></ul><br><h3 id="sravnenie-s-tekstovym-vyravnivaniem">  Compara√ß√£o com alinhamento de texto </h3><br><p>  Outra maneira de aumentar a legibilidade dos arquivos CSV √© alinh√°-los com espa√ßos, mas esse m√©todo modifica o conte√∫do do arquivo e, portanto, sua aplicabilidade √© muito limitada. </p><br><p>  Al√©m disso, na minha opini√£o, a legibilidade de um arquivo ap√≥s o destaque sint√°tico do Rainbow √© melhor do que a de um arquivo que foi alinhado com espa√ßos. </p><br><h2 id="nemnogo-o-proekte">  Um pouco sobre o projeto </h2><br><p>  A primeira vers√£o do Rainbow CSV foi escrita h√° 5 anos para o Vim com base no plugin <a href="">rainbow_parentheses.Como</a> voc√™ pode ver, neste projeto, peguei emprestado n√£o apenas parte do c√≥digo, mas tamb√©m metade do nome =) <br>  As vers√µes para VSCode, Atom e Sublime Text 3 apareceram um ano atr√°s. </p><br><p>  Muitos recursos e melhorias cr√≠ticas foram propostos pelos usu√°rios do plugin. </p><br><h2 id="sravnenie-processa-razrabotki-plagina-dlya-raznyh-redaktorov">  Compara√ß√£o do processo de desenvolvimento de plug-in para diferentes editores </h2><br><p>  Em conclus√£o, posso fazer uma pequena compara√ß√£o das APIs de editores de texto populares. <br>  As APIs para os plugins do VSCode, Atom e Sublime Text 3 s√£o bastante semelhantes, a principal diferen√ßa √© que as extens√µes para o VS Code e Atom s√£o gravadas em JavaScript e para o Sublime Text 3 em Python. </p><br><p>  Todos os tr√™s editores usam o mesmo mecanismo de express√£o regular para destacar a sintaxe, portanto, mover o CSV Rainbow entre esses editores exigia apenas uma adapta√ß√£o m√≠nima dos regulares. </p><br><p>  Em geral, posso dizer que o processo de desenvolvimento de plug-in mais agrad√°vel e conveniente √© fornecido pelo VS Code.  Por outro lado, foi por algum motivo que inicialmente faltava algumas das funcionalidades necess√°rias para a opera√ß√£o completa do Rainbow CSV, mas a equipe do VS Code aceitou com prazer e melhorou meu PR, que adicionou o m√©todo que eu precisava. </p><br><p>  Escrever plugins para o Vim √© muito diferente desses tr√™s editores mais recentes.  O Vim usa sua pr√≥pria linguagem VimScript, bem como uma variedade de comandos para manipular o conte√∫do de arquivos abertos.  O modelo de sintaxe que o Vim usa para destacar tamb√©m √© bem diferente do que o VSCode, Atom e Sublime fornecem. </p><br><h3 id="ssylki">  Refer√™ncias: </h3><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rainbow CSV em c√≥digo VS</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rainbow CSV em Vim</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CSV arco-√≠ris em texto sublime 3</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Arco-√≠ris CSV no Atom</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rainbow CSV no Gedit</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rbql.org</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt429548/">https://habr.com/ru/post/pt429548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt429536/index.html">PHP Digest No. 143 (1 a 12 de novembro de 2018)</a></li>
<li><a href="../pt429540/index.html">Restauramos a geometria detalhada dos objetos para valida√ß√£o de sortimento mais precisa</a></li>
<li><a href="../pt429542/index.html">Mensagens privadas de 81.000 contas do Facebook colocadas √† venda</a></li>
<li><a href="../pt429544/index.html">Grande confer√™ncia NIXMultiConf (Kharkov)</a></li>
<li><a href="../pt429546/index.html">‚ÄúOs cursos foram realizados n√£o apenas em prol do conhecimento, muitos tiveram ambi√ß√µes de carreira e tarefas de desenvolvimento profissional‚Äù</a></li>
<li><a href="../pt429550/index.html">Hist√≥ria de 33 extens√µes para o VS Code, sobre seu desenvolvimento e como gerenci√°-las</a></li>
<li><a href="../pt429552/index.html">Guia JavaScript, Parte 1: Primeiro programa, Recursos de idiomas, Padr√µes</a></li>
<li><a href="../pt429554/index.html">Custos de Tesla</a></li>
<li><a href="../pt429556/index.html">Guia JavaScript Parte 2: Estilo do c√≥digo e estrutura do programa</a></li>
<li><a href="../pt429560/index.html">SamsPcbGuide: Lan√ßamento da primeira vers√£o do livro</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>