<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ‚Äçü§ù‚Äçüë®üèº üï¥üèæ ü•ô Erreurs courantes lors de l'√©criture des tests unitaires. Conf√©rence Yandex üõÇ üéÇ ‚õπüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Si vous ma√Ætrisez une petite liste d'erreurs typiques qui se produisent lors de l'√©criture de tests unitaires, vous pouvez m√™me aimer les √©crire. Aujo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erreurs courantes lors de l'√©criture des tests unitaires. Conf√©rence Yandex</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/436850/">  Si vous ma√Ætrisez une petite liste d'erreurs typiques qui se produisent lors de l'√©criture de tests unitaires, vous pouvez m√™me aimer les √©crire.  Aujourd'hui, le chef de l'√©quipe de d√©veloppement Yandex.Browser pour Android Konstantin <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">kzaikin</a> Zaikin partagera son exp√©rience avec les lecteurs Habr. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZyGZjpxF9Fo" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  - J'ai un rapport pratique.  J'esp√®re que cela vous sera b√©n√©fique √† tous - ceux qui sont d√©j√† en train de passer des tests unitaires, ceux qui pensent √† √©crire, ceux qui essaient et qui n'ont pas r√©ussi. <a name="habracut"></a><br><br>  Nous avons un assez gros projet.  L'un des plus grands projets mobiles en Russie.  Nous avons beaucoup de code, beaucoup de tests.  Les tests sont poursuivis √† chaque demande de pool, ils ne tombent pas en m√™me temps. <br><br>  Qui sait quelle couverture de test il a dans le projet?  Z√©ro, d'accord.  Qui a des tests unitaires dans le projet?  Et qui pense que les tests unitaires ne sont pas n√©cessaires?  Je ne vois rien de mal √† cela, il y a des gens qui en sont sinc√®rement convaincus, et mon histoire devrait les aider √† en √™tre convaincus. <br><br>  Heureusement, des milliers de tests √©cologiques - nous ne sommes pas venus tout de suite.  Il n'y a pas de solution miracle, et l'id√©e principale de mon rapport √† l'√©cran: <br><br><img src="https://habrastorage.org/webt/w1/0y/wm/w10ywme1xumvi5asap7gp0a5iee.jpeg"><br><br>  Le dicton chinois est √©crit en hi√©roglyphes selon lequel un voyage d'un millier de personnes commence par un pas.  Il semble qu'il y ait un tel analogue de ce dicton. <br><br>  Il y a longtemps, nous avons d√©cid√© que nous devions am√©liorer notre produit, notre code, et nous nous dirigeons r√©solument vers cela.  Sur ce chemin, nous avons rencontr√© beaucoup de bosses, un r√¢teau sous-marin et rassembl√© avec cela quelques croyances. <br><br><img src="https://habrastorage.org/webt/ks/9z/5w/ks9z5wmzmkghfc-vireaf5rdvvg.jpeg"><br><br>  Pourquoi avons-nous besoin de tests? <br><br>  Pour que les anciennes fonctionnalit√©s ne tombent pas lorsque nous en introduisons de nouvelles.  Pour avoir un badge sur GitHub.  Pour refactoriser les fonctionnalit√©s existantes - une r√©flexion approfondie, elle doit √™tre r√©v√©l√©e √† ceux qui n'√©crivent pas de tests.  Afin que les fonctionnalit√©s existantes ne tombent pas lors du refactoring, nous nous prot√©gerons par des tests.  Pour que le patron envoie une demande de pool, oui. <br><br>  Mon avis - veuillez ne pas l'associer √† l'avis de mon √©quipe - que les tests nous aident.  Ils vous permettent d'ex√©cuter votre code sans le mettre en production, sans l'installer sur des appareils, vous le lancez et l'ex√©cutez tr√®s rapidement.  Vous pouvez fuir tous les cas d'angle que vous n'avez pas dans la vie sur l'appareil et en production, et votre testeur ne les proposera pas.  Mais en tant que d√©veloppeur, vous les inventerez, les v√©rifierez et corrigerez les bogues √† un stade pr√©coce. <br><br>  Tr√®s important: les tests indiquent comment, selon le d√©veloppeur, le code devrait fonctionner et ce que, selon le d√©veloppeur, vos m√©thodes devraient faire.  Ce ne sont pas des commentaires qui √©loignent et apr√®s un certain temps des commentaires utiles deviennent nuisibles.  Il arrive que dans les commentaires, une chose soit √©crite et que le code soit compl√®tement diff√©rent.  Les tests unitaires dans ce sens ne peuvent pas mentir.  Si le test est vert, il documente ce qui s'y passe.  Le test a √©chou√© - vous avez viol√© l'intention principale du d√©veloppeur. <br><br>  Engagez des contrats.  Ce ne sont pas des contrats sign√©s et tamponn√©s, mais des contrats logiciels pour le comportement de classe.  Si vous refactorisez, dans ce cas les contrats seront viol√©s et les tests tomberont si vous les cassez.  Si les contrats sont sauvegard√©s, les tests resteront verts, vous aurez plus confiance que votre refactoring est correct. <br><br><img src="https://habrastorage.org/webt/pr/z0/fc/prz0fclospeod5fnxeum2bi19gw.jpeg"><br><br>  C'est l'id√©e g√©n√©rale de tout mon rapport.  Vous pouvez montrer la premi√®re ligne et partir. <br><br>  Beaucoup de gens pensent que le code de test est un code moyen, il n'est pas destin√© √† la production, vous pouvez donc l'√©crire tel quel.  Je suis fortement en d√©saccord avec cela et je pense que les tests doivent d'abord √™tre abord√©s de mani√®re responsable, ainsi que le code de production.  Si vous les abordez de la m√™me mani√®re, les tests vous seront b√©n√©fiques.  Sinon, ce sera un charbon. <br><br>  Plus pr√©cis√©ment, les deux lignes ci-dessous font r√©f√©rence √† n'importe quel code, semble-t-il. <br><br>  KISS - restez simple, stupide.  Pas besoin de compliquer.  Les tests doivent √™tre simples.  Et le code de production doit √™tre simple, mais les tests le sont surtout.  Si vous avez des tests faciles √† lire, alors ce seront des tests qui sont tr√®s probablement bien √©crits, ils sont bien exprim√©s, ils seront faciles √† tester.  M√™me pendant la demande de pool, une personne qui regarde vos nouveaux tests comprendra ce que vous vouliez dire.  Et si quelque chose se casse, vous pouvez facilement comprendre ce qui s'est pass√©. <br><br>  SEC - ne vous r√©p√©tez pas.  Dans les tests, le d√©veloppeur est souvent enclin √† utiliser la technique interdite que personne ne semble utiliser dans la production - copier-coller.  Dans la production d'un d√©veloppeur qui copiera-collera activement, ils ne comprendront tout simplement pas.  Dans les tests, c'est malheureusement une pratique normale.  Pas besoin de le faire, car - la premi√®re ligne.  Si vous √©crivez les tests honn√™tement, comme du vrai bon code, les tests vous seront utiles. <br><br>  Pendant que nous d√©veloppions nos centaines de milliers de lignes de code, √©crivant des milliers de tests, collectant des r√¢teaux, j'avais accumul√© des commentaires typiques sur les tests.  Je suis assez paresseux, et quand je suis all√© aux demandes de pool et que j'ai observ√© les m√™mes erreurs, bas√© sur le principe DRY, j'ai d√©cid√© d'√©crire ces probl√®mes typiques, et je l'ai d'abord fait sur le Wiki interne puis j'ai post√© des odeurs de test pratiques sur GitHub que vous pouvez suivre lorsque vous √©crivez des tests. <br><br><img src="https://habrastorage.org/webt/oj/k1/u2/ojk1u2fjmy269sioq4vin6yylua.jpeg"><br><br>  Je vais √©num√©rer par points.  Incr√©mentez un compteur dans votre esprit si vous vous souvenez d'une telle odeur de test.  Si vous comptez jusqu'√† cinq, vous pouvez lever la main et crier "Bingo!"  Et au final, je me demande qui a compt√© combien.  Mon compteur sera √©gal au nombre de points, je les ai tous collect√©s moi-m√™me. <br><br><img src="https://habrastorage.org/webt/nm/pw/8n/nmpw8nk89hl6gmggyims0llmn28.jpeg"><br><h5>  <sup><sub><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lien GitHub</a></sub></sup> </h5><br>  La chose la plus difficile en programmation que vous connaissez.  Et dans les tests, c'est vraiment important.  Si vous ne nommez pas bien le test, vous ne pourrez probablement pas formuler ce que le test v√©rifie. <br><br>  Les humains sont des cr√©atures assez simples, ils sont facilement pi√©g√©s dans les noms.  Par cons√©quent, je vous demande de bien appeler les tests.  Formulez un test pour v√©rifier et suivre des r√®gles simples. <br><br><h4>  no_action_or_assertion </h4><br>  Si le nom du test ne contient pas de description de ce que le test v√©rifie, par exemple, vous avez la classe Controller et vous √©crivez le test testController, que v√©rifiez-vous?  Que devrait faire ce test?  Tr√®s probablement, rien ou trop de choses √† v√©rifier.  Ni l'un ni l'autre ne nous conviennent.  Par cons√©quent, il est n√©cessaire d'√©crire au nom du test ce que nous v√©rifions. <br><br><h4>  long_name </h4><br>  Vous ne pouvez pas aller √† l'autre extr√™me.  Le nom du test doit √™tre suffisamment court pour qu'une personne puisse facilement l'analyser.  En ce sens, Kotlin est g√©nial car il vous permet d'√©crire des noms de test entre guillemets avec des espaces en anglais normal.  Ils sont plus faciles √† lire.  Mais quand m√™me, les noms longs sentent bon. <br><br>  Si le nom de votre test est trop long, vous mettez probablement trop de m√©thodes de test dans une classe de test et vous devez clarifier ce que vous v√©rifiez.  Dans ce cas, vous devez diviser votre classe de test en plusieurs.  Pas besoin d'avoir peur de √ßa.  Vous aurez un nom de classe de test qui v√©rifie le nom de votre code de production, et il y aura des noms de test courts. <br><br><h4>  old_prefix </h4><br>  C'est de l'atavisme.  Auparavant, en Java, tout le monde testait en utilisant JUnit, o√π jusqu'√† la quatri√®me version, il y avait un accord pour que les m√©thodes de test commencent par le mot test.  Il en est ainsi, tout le monde l'appelle toujours ainsi.  Mais il y a un probl√®me, en anglais le mot test est le verbe ¬´check¬ª.  Les gens sont facilement pris dans ce pi√®ge et n'√©crivent plus d'autres verbes.  √âcrivez testController.  Il est facile de v√©rifier vous-m√™me: si vous n‚Äôavez pas √©crit un verbe ce que votre classe de test devrait faire, vous n‚Äôavez probablement pas v√©rifi√© quelque chose, vous ne l‚Äôavez pas assez bien √©crit.  Par cons√©quent, je vous demande toujours de supprimer le mot test des noms des m√©thodes de test. <br><br>  Je dis des choses tr√®s simples, mais curieusement, elles aident.  Si les tests sont bien appel√©s, tr√®s probablement sous le capot, ils auront l'air bien.  C'est tr√®s simple. <br><br><img src="https://habrastorage.org/webt/1e/_h/b3/1e_hb3te9onmzprsqcvilm2i_cc.jpeg"><br><br>  J'ai en fait lu les identifiants des odeurs de test comme sur GitHub.  Le lien est ci-dessous, vous pouvez marcher et utiliser. <br><br><h4>  multiple_asserts </h4><br>  Dans la m√©thode d'essai, il existe de nombreuses affirmations.  Alors peut-√™tre ou non?  Peut-√™tre.  Est-ce bon ou mauvais?  Je pense que c'est tr√®s mauvais.  Si vous avez √©crit plusieurs assertions dans une m√©thode de test, vous v√©rifiez plusieurs d√©clarations.  Si vous testez votre test et que la premi√®re assertion tombe, le test atteindra-t-il la deuxi√®me assertion?  N'atteindra pas.  Vous avez d√©j√† apr√®s la chute de votre assemblage quelque part sur le CI que le test est tomb√©, allez r√©parer quelque chose, remplissez-le √† nouveau, il tombera √† l'assertion suivante.  Cela pourrait tr√®s bien l'√™tre. <br><br>  Dans ce cas, ce serait beaucoup plus cool si vous sciez cette m√©thode de test en plusieurs, et toutes les m√©thodes avec plusieurs assertions tombaient en m√™me temps, car elles seraient lanc√©es ind√©pendamment les unes des autres. <br><br>  Quelques assertions suppl√©mentaires peuvent masquer les diff√©rentes actions effectu√©es avec la classe de test.  Je recommande d'√©crire un test - une affirmation.  Dans le m√™me temps, les affirmations peuvent √™tre assez complexes.  Mon coll√®gue, dans le tout premier rapport, a d√©montr√© un morceau de code o√π il a utilis√© l'excellente construction assertThat et le matcher.  J'adore vraiment les rencontres chez JUnit, vous pouvez donc l'utiliser aussi.  Pour le lecteur de test, il ne s‚Äôagit que d‚Äôune courte d√©claration.  GitHub a des exemples de toutes ces odeurs et comment les corriger.  Il y a un exemple de mauvais code et de bon code.  Tout cela se fait sous la forme d'un projet que vous pouvez t√©l√©charger, ouvrir, compiler et ex√©cuter tous les tests. <br><br><h4>  many_tests_in_one </h4><br>  L'odeur suivante est √©troitement li√©e √† la pr√©c√©dente.  Vous faites quelque chose avec le syst√®me - vous faites une affirmation.  Faire autre chose avec le syst√®me, de longues op√©rations - faire une assertion - faire autre chose.  En fait, vous avez simplement vu plusieurs m√©thodes et vous obtenez de bonnes m√©thodes de test solides. <br><br><h4>  repeating_setup </h4><br>  Cela fait r√©f√©rence √† la verbosit√©.  Si vous avez une classe de test et que chaque m√©thode de test ex√©cute les m√™mes m√©thodes au d√©but. <br><br>  Une classe de test dans laquelle les m√™mes m√©thodes sont ex√©cut√©es au d√©but.  Cela semble un peu, mais dans chaque m√©thode de test, ces ordures sont pr√©sentes.  Et si elle est commune √† toutes les m√©thodes de test, pourquoi ne pas la faire glisser dans le constructeur ou le bloc <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Avant</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Avant</a> chaque bloc dans JUnit 5. Si vous faites cela, la lisibilit√© de chaque m√©thode s'am√©liorera, et vous vous d√©barrasserez du p√©ch√© SEC.  Ces tests sont plus faciles √† maintenir et √† lire. <br><br><img src="https://habrastorage.org/webt/jz/e6/pt/jze6ptgcma9s-f62hobgcoj5jbu.jpeg"><br><br>  La fiabilit√© des tests est tr√®s importante.  Il y a des signes par lesquels il peut √™tre d√©termin√© que le test va pleurer, √™tre vert ou rouge.  Lorsque le d√©veloppeur l'√©crit, il est s√ªr qu'il est vert, puis pour une raison quelconque, les tests deviennent verts ou rouges, ce qui nous donne la douleur et l'incertitude en g√©n√©ral que les tests sont utiles.  Nous ne sommes pas s√ªrs des tests, ce qui signifie que nous ne sommes pas s√ªrs qu'ils soient utiles. <br><br><h4>  al√©atoire </h4><br>  J'ai moi-m√™me √©crit une fois des tests contenant Math.random (), fait des nombres al√©atoires, fait quelque chose avec eux.  Pas besoin de faire √ßa.  Nous nous attendons √† ce que le syst√®me de test entre dans le syst√®me de test dans la m√™me configuration, et la sortie de celui-ci doit √©galement √™tre la m√™me.  Par cons√©quent, dans les tests unitaires, par exemple, vous n'avez jamais besoin d'effectuer d'op√©rations avec le r√©seau.  Parce que le serveur peut ne pas r√©pondre, il peut y avoir diff√©rents horaires, autre chose. <br><br>  Si vous avez besoin d'un test qui fonctionne avec le r√©seau, faites un proxy, local, n'importe quoi, mais en aucun cas allez sur un vrai r√©seau.  C'est le m√™me hasard.  Et bien s√ªr, vous ne pouvez pas utiliser de donn√©es al√©atoires.  Si vous devez faire quelque chose, faites quelques exemples avec des conditions aux limites, avec de mauvaises conditions, mais elles devraient √™tre cod√©es en dur. <br><br><h4>  tread_sleep </h4><br>  Un probl√®me classique auquel les d√©veloppeurs sont confront√©s lorsqu'ils essaient de tester une sorte de code asynchrone.  C'est que j'ai fait quelque chose dans le test, puis je dois attendre jusqu'√† ce qu'il soit termin√©.  Comment faire?  Thread.sleep (), bien s√ªr. <br><br>  Il y a un probl√®me.  Lorsque vous avez d√©velopp√© votre test, par exemple, vous l'avez fait sur une partie de votre machine √† √©crire, cela fonctionne √† une certaine vitesse.  Vous ex√©cutez les tests sur une autre machine.  Et que se passera-t-il si votre syst√®me ne parvient pas √† fonctionner pendant le temps Thread.sleep ()?  Le test devient rouge.  C'est inattendu.  Par cons√©quent, la recommandation ici est, si vous effectuez des op√©rations asynchrones, ne les testez pas du tout.  Presque n'importe quelle op√©ration asynchrone peut √™tre d√©ploy√©e de sorte que vous ayez une sorte de m√©canisme conditionnel qui fournit un fonctionnement asynchrone et un bloc de code ex√©cut√© de mani√®re synchrone.  Par exemple, AsyncTask √† l'int√©rieur a un bloc de code ex√©cut√© de mani√®re synchrone.  Vous pouvez facilement le tester de mani√®re synchrone, sans asynchronisme.  Il n'est pas n√©cessaire de tester AsyncTask lui-m√™me, c'est une classe framework, pourquoi la tester?  Accrochez-vous et votre vie sera plus facile. <br><br>  Thread.sleep () est tr√®s douloureux.  En plus du fait qu'elle aggrave la fiabilit√© des tests, car elle leur permet de pleurer en raison de diff√©rents timing sur les appareils, elle ralentit √©galement l'ex√©cution de vos tests.  Qui aimerait que ses tests unitaires, qui devraient √™tre ex√©cut√©s en millisecondes, se d√©roulent pendant cinq secondes, car j'ai d√©fini le sommeil de la bande de roulement? <br><br><h4>  modify_global </h4><br>  L'odeur typique est que nous avons modifi√© une variable statique globale au d√©but du test pour v√©rifier que notre syst√®me fonctionne correctement, mais n'est pas revenu √† la fin.  Ensuite, nous obtenons une situation int√©ressante: sur la machine, le d√©veloppeur a ex√©cut√© les tests dans une s√©quence, a d'abord v√©rifi√© la variable globale avec la valeur par d√©faut, puis l'a modifi√©e dans un autre test, puis a fait autre chose.  Les deux tests sont verts.  Et sur CI, c'est arriv√©, les tests ont commenc√© dans l'ordre inverse.  Et l'un ou les deux tests seront rouges, bien qu'ils soient tous verts. <br><br>  Vous devez nettoyer apr√®s vous.  R√®gles de reconnaissance dans ce sens: modification de la variable globale - retour √† l'√©tat d'origine.  Mieux encore, assurez-vous que les √©tats mondiaux ne sont pas utilis√©s.  Mais c'est une pens√©e plus profonde.  Il s'agit du fait que les tests mettent parfois en √©vidence des d√©fauts d'architecture.  Si nous devons changer les √©tats globaux et les remettre √† leur √©tat d'origine afin d'√©crire des tests, sommes-nous tous bien dans notre architecture?  Avons-nous vraiment besoin de variables globales, par exemple?  En r√®gle g√©n√©rale, vous pouvez vous en passer en injectant certaines classes de contextes ou quelque chose, afin de pouvoir les r√©initialiser, les injecter et les r√©initialiser √† chaque fois dans le test. <br><br><h4>  @VisibleForTesting </h4><br>  Testez l'odeur pour avanc√©.  La n√©cessit√© d'utiliser une telle chose ne se pose pas le premier jour, en r√®gle g√©n√©rale.  Vous avez d√©j√† test√© quelque chose, puis vous avez d√ª traduire la classe dans un √©tat sp√©cifique.  Et vous vous faites une porte d√©rob√©e.  Vous avez une classe de production, et vous cr√©ez une m√©thode sp√©cifique qui ne sera jamais appel√©e en production, et √† travers elle vous injectez quelque chose dans la classe ou changez son √©tat.  Ainsi, brisant malicieusement l'encapsulation.  En production, votre classe fonctionne d'une mani√®re ou d'une autre, mais dans les tests, en fait, c'est une classe diff√©rente, vous communiquez avec elle via d'autres entr√©es et sorties.  Et ici, vous pouvez obtenir une situation o√π vous modifiez la production, mais les tests ne le remarquent pas.  Les tests continuent de passer par la porte d√©rob√©e et n'ont pas remarqu√© que, par exemple, des exceptions ont commenc√© √† tirer dans le constructeur, car elles passent par un autre constructeur. <br><br>  En g√©n√©ral, vous devez tester vos classes via les m√™mes entr√©es et sorties qu'en production.  Il ne devrait y avoir acc√®s √† aucune m√©thode uniquement pour les tests. <br><br><img src="https://habrastorage.org/webt/dy/sf/s0/dysfs0rl9n6ftff4nt3ftwpy988.jpeg"><br><br>  Combien de nos 15 mille tests sont effectu√©s?  Environ 20 minutes, √† chaque demande de pool, sur Team City, les d√©veloppeurs sont oblig√©s d'attendre.  Tout simplement parce que 15 000, c'est beaucoup de tests.  Et dans cette section, j'ai compil√© des odeurs qui ralentissent les tests.  Bien que thread_sleep √©tait d√©j√† l√†. <br><br><h4>  inutile_android_test </h4><br>  Android a des tests d'instrumentation, ils sont beaux, ils fonctionnent sur un appareil ou un √©mulateur.  Cela soul√®vera votre projet compl√®tement, pour de vrai, mais ils sont tr√®s lents.  Et pour eux, vous devez m√™me √©lever un √©mulateur entier.  M√™me si vous imaginez que vous avez un √©mulateur sur√©lev√© sur CI - il co√Øncide tellement que vous en avez un - alors l'ex√©cution du test sur l'√©mulateur prendra beaucoup plus de temps que sur la machine h√¥te, par exemple, en utilisant Robolectric.  Bien qu'il existe d'autres m√©thodes.  C'est un tel framework qui vous permet de travailler avec des classes du framework Android sur la machine h√¥te, en pur Java.  Nous l'utilisons assez activement.  Auparavant, Google √©tait plut√¥t cool √† ce sujet, mais maintenant les googleurs eux-m√™mes en parlent dans divers rapports, il est recommand√© de l'utiliser. <br><br><h4>  inutile_robolectrique </h4><br>  Le framework Android de Robolectric est √©mul√©.  Elle n'est pas compl√®te l√†-bas, bien que la mise en ≈ìuvre soit la plus √©loign√©e, la plus compl√®te.  Il est presque r√©el Android, ne fonctionnant que sur votre bureau, ordinateur portable ou CI.  Mais il n'a pas non plus besoin d'√™tre utilis√© partout.  Robolectric n'est pas gratuit.  Si vous avez un test que vous avez h√©ro√Øquement transf√©r√© de l'instrumentation Android vers Robolectric, vous devez penser - peut-√™tre aller encore plus loin, se d√©barrasser de Robolectric, le transformer en le test JUnit le plus simple?  Les tests robotiques prennent du temps pour s'initialiser, essayer de charger des ressources, initialiser votre activit√©, votre application et tout le reste.  Cela prend du temps.  Ce n'est pas une seconde, c'est des millisecondes, parfois des dizaines et des centaines.  Mais quand il y a beaucoup de tests, m√™me cela compte. <br><br>  Il existe des techniques qui se d√©barrassent de Robolectric.  Vous pouvez isoler votre code via des interfaces en enveloppant la partie plate-forme enti√®re avec des interfaces.  Ensuite, il y aura juste un test d'h√¥te JUnit.  JUnit sur la machine h√¥te est tr√®s rapide, il y a une quantit√© minimale de surcharge, ces tests peuvent √™tre ex√©cut√©s par milliers et dizaines de milliers, ils s'ex√©cuteront en une minute, quelques minutes.  Malheureusement, nos tests prennent beaucoup de temps car nous avons beaucoup de tests d'instrumentation Android, car nous avons une partie native dans le navigateur et nous sommes oblig√©s de les ex√©cuter sur un v√©ritable √©mulateur ou appareil.  Pourquoi si longtemps. <br><br>  Je ne t'ennuierai plus.  Combien d'odeurs avez-vous?  Jusqu'√† pr√©sent, sept au maximum.  Abonnez-vous √† la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cha√Æne</a> , mettez les √©toiles. <br><br><img src="https://habrastorage.org/webt/ph/cs/52/phcs52po2jsf1lbjumu1um2e3ha.jpeg"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr436850/">https://habr.com/ru/post/fr436850/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr436838/index.html">Comprendre les r√©seaux de neurones convolutifs gr√¢ce √† des visualisations dans PyTorch</a></li>
<li><a href="../fr436840/index.html">Le chemin du gloss aux neurosciences: un podcast th√©matique sur les carri√®res dans les m√©dias et le marketing de contenu</a></li>
<li><a href="../fr436842/index.html">Solution Veeam pour la sauvegarde et la restauration de machines virtuelles sur la plateforme Nutanix AHV. 2e partie</a></li>
<li><a href="../fr436846/index.html">Le condens√© de mati√®res fra√Æches du monde du front-end de la derni√®re semaine n ¬∞ 348 (14-20 janvier 2019)</a></li>
<li><a href="../fr436848/index.html">La NSA annonce la sortie d'un outil interne de r√©tro-ing√©nierie</a></li>
<li><a href="../fr436852/index.html">Ralentir pour stimuler le d√©veloppement</a></li>
<li><a href="../fr436854/index.html">Rust 1.32 Release</a></li>
<li><a href="../fr436856/index.html">Plan de d√©veloppement informatique selon le minist√®re des Communications: souverainet√© num√©rique, blockchain dans le logement et les services communaux, logiciel pour ¬´r√©alit√© chang√©e¬ª</a></li>
<li><a href="../fr436858/index.html">Esp√©ranto, elfique et klingon</a></li>
<li><a href="../fr436860/index.html">Dell et Alienware au CES 2019: un guide de toutes les innovations majeures</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>