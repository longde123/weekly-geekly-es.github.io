<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🖕🏽 👰🏼 🥡 React Native: créez une liste glissable et glissable 💇🏾 👍 👩🏽‍🤝‍👨🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, il est difficile de surprendre quiconque avec la possibilité de balayer les éléments de la liste dans les applications mobiles. L'une de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>React Native: créez une liste glissable et glissable</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460567/"> Aujourd'hui, il est difficile de surprendre quiconque avec la possibilité de balayer les éléments de la liste dans les applications mobiles.  L'une de nos applications natives réactives avait également une telle fonctionnalité, mais récemment, il était nécessaire de l'étendre avec la possibilité de glisser-déposer des éléments de liste.  Et comme le processus de recherche d'une solution m'a coûté une certaine quantité de cellules nerveuses, j'ai décidé de déposer un court article afin de gagner un temps précieux pour les générations futures. <br><br><img src="https://habrastorage.org/webt/28/2s/oq/282soqzy-xmsxuup_ufv0imnp08.gif"><br><a name="habracut"></a><br>  Dans notre application, nous avons utilisé le package react <code>react-native-swipe-list-view</code> pour créer la liste swipeable.  La première pensée a été de prendre un paquet avec la fonctionnalité drag'n'drop et de traverser le hérisson avec un serpent. <br><br>  Une recherche sur Internet a donné trois candidats: <code>react-native-draggable-list</code> <code>react-native-draggable-flatlist</code> <code>react-native-sortable-list</code> <code>react-native-draggable-flatlist</code> . <br><br>  En utilisant le premier package, il n'a pas été possible d'exécuter même l'exemple ci-joint (cependant, non seulement pour moi, le problème correspondant est indiqué dans les <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">problèmes</a> ). <br><br>  J'ai dû bricoler avec le deuxième paquet, mais j'ai réussi à créer une liste glissable et glissable.  Cependant, le résultat n'a pas été inspiré - le composant clignotait sans vergogne: clignotement du redessin, chute d'éléments bien au-delà de la liste, ou même leur disparition.  Il est devenu clair que sous cette forme, il ne peut pas être utilisé. <br><br>  Au début, le dernier paquet s'est également comporté comme une dame capricieuse, mais il s'est avéré que je ne savais tout simplement pas comment le cuisiner.  Ayant ramassé une clé au cœur de cette "dame", j'ai réussi à obtenir un résultat acceptable. <br><br>  Dans notre projet, il y avait une liste glissable à laquelle vous devez fixer le glisser-déposer, mais en pratique, il est préférable de partir de l'autre bord: faites d'abord une liste glissable, puis ajoutez la possibilité de glisser. <br><br>  Les lecteurs sont censés savoir comment créer un projet natif réactif, alors concentrons-nous sur la création de la liste dont nous avons besoin.  L'exemple présenté ci-dessous est du code TypeScript. <br><br><h4>  Faire une liste glissable </h4><br>  Commençons donc par installer le package: <br><br><pre> <code class="bash hljs">yarn add react-native-draggable-flatlist</code> </pre> <br>  Nous importons les modules nécessaires: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { View } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> styles <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./styles'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DraggableFlatList, { RenderItemInfo, OnMoveEndInfo } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native-draggable-flatlist'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ListItem <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./components/ListItem'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fakeData <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./fakeData.json'</span></span></code> </pre> <br>  Ici, <code>DraggableFlatList</code> est un composant du package installé qui implémente la fonction glisser-déposer, <code>ListItem</code> est notre composant pour afficher un élément de liste (le code sera présenté ci-dessous), <code>fakeData</code> est un fichier json qui contient de fausses données - dans ce cas, un tableau d'objets de la forme: <br><br><pre> <code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"JavaScript"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"favorite"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>}</code> </pre> <br>  Dans une application réelle, ces données proviendront très probablement de votre composant à partir d'accessoires ou seront téléchargées à partir du réseau, mais dans notre cas, nous gérerons avec peu de sang. <br><br>  Puisque TypeScript est utilisé dans cet exemple, nous décrivons certaines entités: <br><br><pre> <code class="javascript hljs">type Language = { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: number, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: string, <span class="hljs-attr"><span class="hljs-attr">favorite</span></span>: boolean, } interface AppProps {} interface AppState { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>&lt;Language&gt; }</code> </pre> <br>  Le type de <code>Language</code> nous indique quels champs les éléments de liste auront. <br><br>  Dans cet exemple, nous n'obtiendrons rien des accessoires, donc l'interface <code>AppProps</code> est triviale, et dans l'histoire, nous allons stocker un tableau d'objets <code>Language</code> , qui est indiqué dans l'interface <code>AppState</code> . <br><br>  Étant donné que le code du composant n'est pas très volumineux, je vais le donner dans son intégralité: <br><br><div class="spoiler">  <b class="spoiler_title">Code de composant d'application</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppProps</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppState</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props: AppProps) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: fakeData, } } onMoveEnd = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ data }: OnMoveEndInfo&lt;Language&gt;</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: data ? [...data] : [] }) } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;View style={styles.root}&gt; &lt;DraggableFlatList data={</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.state.data} renderItem={</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.renderItem} keyExtractor={(item</span></span></span><span class="hljs-function">) =&gt;</span></span> item.id.toString()} scrollPercent={<span class="hljs-number"><span class="hljs-number">5</span></span>} onMoveEnd={<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onMoveEnd} /&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ) } renderItem = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ item, move, moveEnd, isActive }: RenderItemInfo&lt;Language&gt;</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ListItem</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{item.name}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">move</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{move}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">moveEnd</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{moveEnd}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">isActive</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{isActive}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> ) } }</span></span></code> </pre> <br></div></div><br>  La méthode <code>onMoveEnd</code> appelée lorsque l'élément est déplacé.  Dans ce cas, nous devons mettre la liste avec le nouvel ordre des éléments dans l'état, nous appelons donc la méthode <code>this.setState</code> . <br><br>  La méthode <code>renderItem</code> un élément de liste et accepte un objet de type RenderItemInfo &lt;Language&gt;.  Cet objet comprend les champs suivants: <br><br><ul><li>  <code>item</code> - l'élément suivant du tableau passé en tant que données à la liste, </li><li>  <code>move</code> et <code>moveEnd</code> sont des fonctions qui sont appelées lorsqu'un élément de liste est déplacé, le composant <code>DraggableFlatList</code> fournit ces fonctions, </li><li>  <code>isActive</code> est un champ booléen qui détermine si l'élément est actuellement déplaçable. </li></ul><br>  Le composant pour afficher l'élément de liste est, en fait, <code>TouchableOpacity</code> , qui, lorsqu'il est pressé pendant longtemps, appelle <code>move</code> , et lorsqu'il est relâché, il se <code>moveEnd</code> . <br><br><div class="spoiler">  <b class="spoiler_title">Code composant ListItem</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Text, TouchableOpacity } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> styles <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./styles'</span></span> interface ListItemProps { <span class="hljs-attr"><span class="hljs-attr">name</span></span>: string, <span class="hljs-attr"><span class="hljs-attr">move</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, <span class="hljs-attr"><span class="hljs-attr">moveEnd</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, <span class="hljs-attr"><span class="hljs-attr">isActive</span></span>: boolean, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ListItem = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ name, move, moveEnd, isActive }: ListItemProps</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TouchableOpacity</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{[styles.root,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">isActive</span></span></span></span><span class="xml"><span class="hljs-tag"> &amp;&amp; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">styles.active</span></span></span></span><span class="xml"><span class="hljs-tag">]} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onLongPress</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{move}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onPressOut</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{moveEnd}</span></span></span></span><span class="xml"><span class="hljs-tag"> &gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{styles.text}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{name}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TouchableOpacity</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ) } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> ListItem</code> </pre> <br></div></div><br>  Les styles de tous les composants sont déplacés vers des fichiers séparés et ne sont pas indiqués ici, mais ils peuvent être affichés dans le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">référentiel</a> . <br><br>  Le résultat résultant: <br><br><img src="https://habrastorage.org/webt/yz/2a/lr/yz2alrixtubziyk1vx4cuptrnxo.gif"><br><br><h4>  Ajoutez la possibilité de glisser </h4><br>  Eh bien, nous avons réussi à faire face à la première partie, nous passons à la deuxième partie du ballet Marlezon. <br><br>  Pour ajouter la possibilité de faire glisser les éléments de la liste, nous utilisons le package <code>react-native-swipe-list-view</code> . <br><br>  Pour commencer, installons-le: <br><br><pre> <code class="bash hljs">yarn add react-native-swipe-list-view</code> </pre> <br>  Ce package contient le composant <code>SwipeRow</code> qui, selon la documentation, devrait inclure deux composants: <br><br><pre> <code class="javascript hljs">&lt;SwipeRow&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{hiddenRowStyle}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{visibleRowStyle}</span></span></span></span><span class="xml"><span class="hljs-tag"> /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">SwipeRow</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  Notez que la première vue est dessinée sous la seconde. <br><br>  Modifions le code du composant <code>ListItem</code> . <br><br><div class="spoiler">  <b class="spoiler_title">Code composant ListItem</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Text, TouchableOpacity, View, Image } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { SwipeRow } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native-swipe-list-view'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Language } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../../App'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> styles <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./styles'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> heart = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./icons8-heart-24.png'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> filledHeart = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./icons8-heart-24-filled.png'</span></span>) interface ListItemProps { <span class="hljs-attr"><span class="hljs-attr">item</span></span>: Language, <span class="hljs-attr"><span class="hljs-attr">move</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, <span class="hljs-attr"><span class="hljs-attr">moveEnd</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, <span class="hljs-attr"><span class="hljs-attr">isActive</span></span>: boolean, <span class="hljs-attr"><span class="hljs-attr">onHeartPress</span></span>: <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">void</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ListItem = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ item, move, moveEnd, isActive, onHeartPress }: ListItemProps</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ( <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">SwipeRow</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">rightOpenValue</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{-180}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{styles.hidden}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TouchableOpacity</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onPress</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{onHeartPress}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Image</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">source</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{item.favorite</span></span></span></span><span class="xml"><span class="hljs-tag"> ? </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">filledHeart</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">:</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">heart</span></span></span></span><span class="xml"><span class="hljs-tag">} /&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TouchableOpacity</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TouchableOpacity</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">activeOpacity</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{1}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{[styles.root,</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">isActive</span></span></span></span><span class="xml"><span class="hljs-tag"> &amp;&amp; </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">styles.active</span></span></span></span><span class="xml"><span class="hljs-tag">]} </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onLongPress</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{move}</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">onPressOut</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{moveEnd}</span></span></span></span><span class="xml"><span class="hljs-tag"> &gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">style</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">{styles.text}</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">{item.name}</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Text</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">TouchableOpacity</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">SwipeRow</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> ) } export default ListItem</span></span></code> </pre> <br></div></div><br>  Tout d'abord, nous avons ajouté le composant <code>SwipeRow</code> avec la propriété <code>SwipeRow</code> , qui détermine la distance sur laquelle l'élément peut être glissé. <br><br>  Deuxièmement, nous avons déplacé notre <code>TouchableOpacity</code> intérieur de <code>SwipeRow</code> et ajouté une vue, qui sera dessinée sous ce bouton. <br><br>  Dans cette vue, une image est dessinée pour déterminer si la langue est préférée.  Lorsque vous cliquez dessus, la valeur doit être inversée et, puisque les données se trouvent dans le composant parent, vous devez lancer ici un rappel qui exécute cette action. <br><br>  Apportez les modifications nécessaires au composant parent: <br><br><div class="spoiler">  <b class="spoiler_title">Code de composant d'application</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> React, { Component } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { View } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> styles <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./styles'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DraggableFlatList, { RenderItemInfo, OnMoveEndInfo } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'react-native-draggable-flatlist'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ListItem <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./components/ListItem'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> fakeData <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./fakeData.json'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> type Language = { <span class="hljs-attr"><span class="hljs-attr">id</span></span>: number, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: string, <span class="hljs-attr"><span class="hljs-attr">favorite</span></span>: boolean, } interface AppProps {} interface AppState { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>&lt;Language&gt; } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">App</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Component</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppProps</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppState</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">constructor</span></span>(props: AppProps) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(props) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state = { <span class="hljs-attr"><span class="hljs-attr">data</span></span>: fakeData, } } onMoveEnd = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ data }: OnMoveEndInfo&lt;Language&gt;</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ <span class="hljs-attr"><span class="hljs-attr">data</span></span>: data ? [...data] : [] }) } toggleFavorite = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">value: Language</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> data = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.state.data.map(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">item</span></span></span><span class="hljs-function"> =&gt;</span></span> ( item.id !== value.id ? item : { ...item, <span class="hljs-attr"><span class="hljs-attr">favorite</span></span>: !item.favorite } )) <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.setState({ data }) } render() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;View style={styles.root}&gt; &lt;DraggableFlatList data={</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.state.data} renderItem={</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">this</span></span></span></span><span class="hljs-function"><span class="hljs-params">.renderItem} keyExtractor={(item</span></span></span><span class="hljs-function">) =&gt;</span></span> item.id.toString()} scrollPercent={<span class="hljs-number"><span class="hljs-number">5</span></span>} onMoveEnd={<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onMoveEnd} /&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">View</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> ) } renderItem = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">{ item, move, moveEnd, isActive }: RenderItemInfo&lt;Language&gt;</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> &lt;ListItem item={item} move={move} moveEnd={moveEnd} isActive={isActive} onHeartPress={(</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toggleFavorite(item)} /&gt; ) } } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> App</code> </pre> <br></div></div><br>  Sources du projet sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> . <br><br>  Le résultat est présenté ci-dessous: <br><br><img src="https://habrastorage.org/webt/28/2s/oq/282soqzy-xmsxuup_ufv0imnp08.gif"></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr460567/">https://habr.com/ru/post/fr460567/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr460555/index.html">Rapport de la rencontre PyDaCon au groupe Mail.ru, 22 juin</a></li>
<li><a href="../fr460557/index.html">Une sélection d'exemples pratiques de traitement de données</a></li>
<li><a href="../fr460559/index.html">Les dix commandements des composants React</a></li>
<li><a href="../fr460561/index.html">Comment développer un autre jeu de plateforme en utilisant Unity. Un autre tutoriel, partie 2</a></li>
<li><a href="../fr460565/index.html">Battez-vous pour le compte. Le fondateur du réseau Coffee de Jeffrey poursuit VKontakte</a></li>
<li><a href="../fr460569/index.html">Logiciel d'écriture avec la fonctionnalité des utilitaires client-serveur Windows, partie 01</a></li>
<li><a href="../fr460573/index.html">Google déclare que «reCAPTCHA» n'abuse pas des données utilisateur. Vaut-il la peine de croire?</a></li>
<li><a href="../fr460577/index.html">Vive le roi: monde cruel de la hiérarchie dans une meute de chiens errants</a></li>
<li><a href="../fr460587/index.html">Module sans fil pour capteur capacitif d'humidité du sol sur nRF52832</a></li>
<li><a href="../fr460589/index.html">Écrire un réseau neuronal simple en utilisant les mathématiques et Numpy</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>