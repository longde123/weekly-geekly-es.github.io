<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯСитАНтЬИя╕П ЁЯЫМЁЯП╛ тЪ░я╕П рдЦреВрдВрдЯреА parser рдкреАрдврд╝реА ЁЯУа ЁЯЙР ЁЯСОЁЯП╝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдЕрдм рдЬрдм рдореИрдВрдиреЗ рдПрдХ рдорд╛рд▓рд┐рдХрд╛рдирд╛ рдкрд╛рд░реНрд╕рд░ рдХреА рдореВрд▓ рдмрд╛рддреЗрдВ рдЫреЛрдбрд╝ рджреА рд╣реИрдВ, рддреЛ рдЪрд▓рд┐рдП рд╡реНрдпрд╛рдХрд░рдг рд╕реЗ рдЗрд╕рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рд╡рд╛рджрд╛ рдХрд┐рдпрд╛ рдерд╛ред рдореИрдВ рдпрд╣ рднреА рджрд┐рдЦрд╛рдК...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдЦреВрдВрдЯреА parser рдкреАрдврд╝реА</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471864/"><p> рдЕрдм рдЬрдм рдореИрдВрдиреЗ рдПрдХ рдорд╛рд▓рд┐рдХрд╛рдирд╛ рдкрд╛рд░реНрд╕рд░ рдХреА рдореВрд▓ рдмрд╛рддреЗрдВ рдЫреЛрдбрд╝ рджреА рд╣реИрдВ, рддреЛ рдЪрд▓рд┐рдП рд╡реНрдпрд╛рдХрд░рдг рд╕реЗ рдЗрд╕рдХреА рд╡рд┐рдзрд┐рдпрд╛рдБ рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВ, рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рд╡рд╛рджрд╛ рдХрд┐рдпрд╛ рдерд╛ред  рдореИрдВ рдпрд╣ рднреА рджрд┐рдЦрд╛рдКрдВрдЧрд╛ рдХрд┐ <code>@memoize</code> рдбреЗрдХреЛрд░реЗрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ <code>@memoize</code> рдкрд╛рд░реНрд╕рд░ рдХреЛ рдХреИрд╕реЗ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ <code>@memoize</code> ред </p><br><div class="spoiler">  <b class="spoiler_title">рдкрд╛рдпрдерди рдЦреВрдВрдЯреА рдкрд╛рд░реНрд╕рд░ рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╕рд╛рдордЧреНрд░реА</b> <div class="spoiler_text"><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЦреВрдВрдЯреА рдкрд░рд╕реЗрдВрдЯрд░реНрд╕</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЦреВрдВрдЯреА рдкрд╛рд░реНрд╕рд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЦреВрдВрдЯреА parser рдкреАрдврд╝реА</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЦреВрдВрдЯреА рдкрд╛рд░реНрд╕рд░ рджреГрд╢реНрдп</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡рд╛рдо рдкреБрдирд░рд╛рд╡рд░реНрддреА рдЦреВрдВрдЯреА рд╡реНрдпрд╛рдХрд░рдг</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЦреВрдВрдЯреА рд╡реНрдпрд╛рдХрд░рдг рдореЗрдВ рдХреНрд░рд┐рдпрд╛рдПрдБ рдЬреЛрдбрд╝рдирд╛</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЦреВрдВрдЯреА рдкрд╛рд░реНрд╕рд░ рдХреЗ рд▓рд┐рдП рдореЗрдЯрд╛ рд╡реНрдпрд╛рдХрд░рдг</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЦреВрдВрдЯреА рдХреА рд╢реЗрд╖ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдирд╛</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреЛрд░ рдбреЗрд╡рд▓рдкрд░ рд╕реНрдкреНрд░рд┐рдВрдЯ рдкрд░ рдЦреВрдВрдЯреА</a> </li></ul></div></div><br><p>  рдкрд┐рдЫрд▓реА рдмрд╛рд░, рд╣рдордиреЗ рдХреБрдЫ рдкрд╛рд░реНрд╕рд░ рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЛ рджреЗрдЦрд╛ред  рдХреБрдЫ рдкреНрд░рддрд┐рдмрдВрдзреЛрдВ рдХреЗ рд╕рд╛рде рдЬрд┐рдиреНрд╣реЗрдВ рд╣рдо рдмрд╛рдж рдореЗрдВ рдереЛрдбрд╝рд╛ рд╣рдЯрд╛ рджреЗрдВрдЧреЗ, рд╡реЗ рд╡реНрдпрд╛рдХрд░рдг рд╕реЗ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ рдЙрддреНрдкрдиреНрди рдХрд░рдирд╛ рдЖрд╕рд╛рди рд╣реИред </p><a name="habracut"></a><br><p>  рд╣рдореЗрдВ рджреЛ рдЪреАрдЬреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ: рдРрд╕рд╛ рдХреБрдЫ рдЬреЛ рд╡реНрдпрд╛рдХрд░рдг рдХреЛ рдкрдврд╝рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдЙрдкрдпреБрдХреНрдд рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рдмрдирд╛рддрд╛ рд╣реИ;  рдФрд░ рдРрд╕рд╛ рдХреБрдЫ рдЬреЛ рдЗрд╕ рдбреЗрдЯрд╛ рд╕рдВрд░рдЪрдирд╛ рдХреЛ рд▓реЗрддрд╛ рд╣реИ рдФрд░ рдПрдХ рдкрд╛рд░реНрд╕рд░ рдЙрддреНрдкрдиреНрди рдХрд░рддрд╛ рд╣реИред  рд╣рдореЗрдВ рдЕрдиреНрдп рд╕рд╣рд╛рдпрдХ рддрд░реАрдХреЛрдВ рдХреА рднреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╡реЗ рджрд┐рд▓рдЪрд╕реНрдк рдирд╣реАрдВ рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдЙрдиреНрд╣реЗрдВ рдЫреЛрдбрд╝ рджреВрдВрдЧрд╛ред </p><br><p>  рдЗрд╕рд▓рд┐рдП, рд╣рдо рдПрдХ рд╕рд░рд▓ рд╕рдВрдХрд▓рдХ рд╕рдВрдХрд▓рдХ рдмрдирд╛ рд░рд╣реЗ рд╣реИрдВред  рдореИрдВ рд╡реНрдпрд╛рдХрд░рдгрд┐рдХ рд╕рдВрдХреЗрддрди рдХреЛ рдЗрд╕ рд╣рдж рддрдХ рд╕рд░рд▓ рдХрд░ рджреВрдВрдЧрд╛ рдХрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдХреЗрд╡рд▓ рдирд┐рдпрдо рдФрд░ рд╡рд┐рдХрд▓реНрдк рд╣реЛрдВ;  рдпрд╣ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЦрд┐рд▓реМрдиреЗ рдХреЗ рд╡реНрдпрд╛рдХрд░рдг рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реИ рдЬрд┐рд╕реЗ рдореИрдВрдиреЗ рдкрд┐рдЫрд▓реЗ рднрд╛рдЧреЛрдВ рдореЗрдВ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдерд╛: </p><br><pre> <code class="plaintext hljs">statement: assignment | expr | if_statement expr: expr '+' term | expr '-' term | term term: term '*' atom | term '/' atom | atom atom: NAME | NUMBER | '(' expr ')' assignment: target '=' expr target: NAME if_statement: 'if' expr ':' statement</code> </pre> <br><p>  рдкреВрд░реНрдг рд╕рдВрдХреЗрддрди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реБрдП, рд╣рдо рд╡реНрдпрд╛рдХрд░рдг рдХрд╛ рд╡рд░реНрдгрди рдЗрд╕ рдкреНрд░рдХрд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="plaintext hljs">grammar: rule+ ENDMARKER rule: NAME ':' alternative ('|' alternative)* NEWLINE alternative: item+ item: NAME | STRING</code> </pre> <br><p>  рдпрд╣ рд╣рдорд╛рд░рд╛ рдкрд╣рд▓рд╛ рдореЗрдЯрд╛-рд╡реНрдпрд╛рдХрд░рдг (рд╡реНрдпрд╛рдХрд░рдг рдХреЗ рд▓рд┐рдП рд╡реНрдпрд╛рдХрд░рдг) рд╣реИ, рдФрд░ рд╣рдорд╛рд░рд╛ рдкрд╛рд░реНрд╕рд░ рдЬрдирд░реЗрдЯрд░ рдореЗрдЯрд╛-рдХрдВрдкрд╛рдЗрд▓рд░ рд╣реЛрдЧрд╛ (рдПрдХ рдХрдВрдкрд╛рдЗрд▓рд░ рдПрдХ рдкреНрд░реЛрдЧреНрд░рд╛рдо рд╣реИ рдЬреЛ рдПрдХ рднрд╛рд╖рд╛ рд╕реЗ рджреВрд╕рд░реА рднрд╛рд╖рд╛ рдореЗрдВ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдХрд░рддрд╛ рд╣реИ; рдПрдХ рдореЗрдЯрд╛-рдХрдВрдкрд╛рдЗрд▓рд░ рдПрдХ рдХрдВрдкрд╛рдЗрд▓рд░ рд╣реИ рдЬрд╣рд╛рдВ рдЗрдирдкреБрдЯ рдПрдХ рд╡реНрдпрд╛рдХрд░рдг рд╣реИ, рдФрд░ рдЖрдЙрдЯрдкреБрдЯ рдПрдХ рдкрд╛рд░реНрд╕рд░ рд╣реИ)ред </p><br><p>  рдореЗрдЯрд╛-рд╡реНрдпрд╛рдХрд░рдг рдХрд╛ рд╡рд░реНрдгрди рдХрд░рдиреЗ рдХрд╛ рдПрдХ рдЖрд╕рд╛рди рддрд░реАрдХрд╛ рдХреЗрд╡рд▓ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдбреЗрдЯрд╛ рдкреНрд░рдХрд╛рд░реЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИ: рдирд┐рдпрдо рдХрд╛ рд╕рд╣реА рд╣рд┐рд╕реНрд╕рд╛ рддрддреНрд╡реЛрдВ рдХреА рд╕реВрдЪреА рдХреА рдПрдХ рд╕реВрдЪреА рд╣реИ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рд╕рд┐рд░реНрдл рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╣реЛ рд╕рдХрддрд╛ рд╣реИред  (рд╡реИрд╕реЗ, рдпрджрд┐ рдкрд╣рд▓рд╛ рд╡рд░реНрдг рдПрдХ рдЙрджреНрдзрд░рдг рдЪрд┐рд╣реНрди рд╣реИ, рддреЛ рд╣рдо рдЬрд╛рдБрдЪ рдХрд░рдХреЗ <code>NAME</code> рдФрд░ <code>STRING</code> рдХреЛ рдЕрд▓рдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ) </p><br><p>  рдирд┐рдпрдореЛрдВ рдХреЗ рд▓рд┐рдП, рдореИрдВ рд╕рд░рд▓ <code>Rule</code> рд╡рд░реНрдЧ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реВрдВ, рдФрд░ рд╕рдВрдкреВрд░реНрдг рд╡реНрдпрд╛рдХрд░рдг рдРрд╕реА рд╡рд╕реНрддреБрдУрдВ рдХреА рдПрдХ рд╕реВрдЪреА рд╣реИред  рдпрд╣рд╛рдБ <code>__eq__</code> рдФрд░ <code>__eq__</code> рдХреЛ рдЫреЛрдбрд╝рдХрд░ <code>Rule</code> рд╡рд░реНрдЧ рд╣реИ: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Rule</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, name, alts)</span></span></span><span class="hljs-function">:</span></span> self.name = name self.alts = alts</code> </pre> <br><p>  рдФрд░ рдпрд╣рд╛рдБ <code>GrammarParser</code> рдХреНрд▓рд╛рд╕ рд╣реИ рдЬреЛ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GrammarParser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Parser)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">grammar</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> pos = self.mark() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> rule := self.rule(): rules = [rule] <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> rule := self.rule(): rules.append(rule) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.expect(ENDMARKER): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rules <span class="hljs-comment"><span class="hljs-comment"># &lt;------------- final result self.reset(pos) return None def rule(self): pos = self.mark() if name := self.expect(NAME): if self.expect(":"): if alt := self.alternative(): alts = [alt] apos = self.mark() while (self.expect("|") and (alt := self.alternative())): alts.append(alt) apos = self.mark() self.reset(apos) if self.expect(NEWLINE): return Rule(name.string, alts) self.reset(pos) return None def alternative(self): items = [] while item := self.item(): items.append(item) return items def item(self): if name := self.expect(NAME): return name.string if string := self.expect(STRING): return string.string return None</span></span></code> </pre> <br><p>  <code>ENDMARKER</code> рдХреЗ рдЙрдкрдпреЛрдЧ рдкрд░ рдзреНрдпрд╛рди <code>ENDMARKER</code> ред  рд╡рд╣рд╛рдВ рдореИрдВ рдпрд╣ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рддрд╛ рд╣реВрдВ рдХрд┐ рдЕрдВрддрд┐рдо рдирд┐рдпрдо рдХреЗ рдмрд╛рдж рдХреБрдЫ рднреА рдирд╣реАрдВ рд░рд╣рддрд╛ (рдФрд░ рдЕрдЧрд░ рд╡реНрдпрд╛рдХрд░рдг рдореЗрдВ рдХреЛрдИ рдЯрд╛рдЗрдкреЛ рд╣реИ рддреЛ рдРрд╕рд╛ рд╣реЛ рд╕рдХрддрд╛ рд╣реИ)ред  рдореИрдВрдиреЗ рдЙрд╕ рд╕реНрдерд╛рди рдХреЛ рднреА рдЗрдВрдЧрд┐рдд рдХрд┐рдпрд╛ рдЬрд╣рд╛рдВ <code>grammar()</code> рд╡рд┐рдзрд┐ рдирд┐рдпрдореЛрдВ рдХреА рдПрдХ рд╕реВрдЪреА рджреЗрддрд╛ рд╣реИред  рдмрд╛рдХреА рд╕рдм рдХреБрдЫ рдкрд┐рдЫрд▓реЗ рд▓реЗрдЦ рдХреЗ <code>ToyParser</code> рд╡рд░реНрдЧ рдХреЗ рд╕рдорд╛рди рд╣реИ, рдЗрд╕рд▓рд┐рдП рдореИрдВ рдЙрд╕ рдкрд░ рдзреНрдпрд╛рди рдирд╣реАрдВ рджреВрдВрдЧрд╛ред  рдмрд╕ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ <code>item()</code> рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд▓реМрдЯрд╛рддрд╛ рд╣реИ, <code>alternative()</code> рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреА рдПрдХ рд╕реВрдЪреА рджреЗрддрд╛ рд╣реИ, рдФрд░ <code>rule()</code> рдЕрдВрджрд░ рдЪрд░ <code>alts</code> <code>rule()</code> рд╕реНрдЯреНрд░рд┐рдВрдЧреНрд╕ рдХреА рд╕реВрдЪреА рдХреА рдПрдХ рд╕реВрдЪреА рдПрдХрддреНрд░ рдХрд░рддрд╛ рд╣реИред  рдлрд┐рд░, <code>rule()</code> рд╡рд┐рдзрд┐ рдирд┐рдпрдо (рд╕реНрдЯреНрд░рд┐рдВрдЧ) рдХреЗ рдирд╛рдо рдХреЛ рдЬреЛрдбрд╝рддреА рд╣реИ рдФрд░ рдЗрд╕реЗ <code>Rule</code> рд╡рд╕реНрддреБ рдореЗрдВ рдкрд░рд┐рд╡рд░реНрддрд┐рдд рдХрд░рддреА рд╣реИред </p><br><p>  рдпрджрд┐ рд╣рдо рдЗрд╕ рдПрд▓реНрдЧреЛрд░рд┐рдереНрдо рдХреЛ рдЕрдкрдиреЗ рдЦрд┐рд▓реМрдирд╛ рд╡реНрдпрд╛рдХрд░рдг рдкрд░ рд▓рд╛рдЧреВ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ <code>grammar()</code> рд╡рд┐рдзрд┐ рдирд┐рдпрдореЛрдВ рдХреА рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕реВрдЪреА рд╡рд╛рдкрд╕ рдХрд░ рджреЗрдЧреА: </p><br><pre> <code class="plaintext hljs">[ Rule('statement', [['assignment'], ['expr'], ['if_statement']]), Rule('expr', [['term', "'+'", 'expr'], ['term', "'-'", 'term'], ['term']]), Rule('term', [['atom', "'*'", 'term'], ['atom', "'/'", 'atom'], ['atom']]), Rule('atom', [['NAME'], ['NUMBER'], ["'('", 'expr', "')'"]]), Rule('assignment', [['target', "'='", 'expr']]), Rule('target', [['NAME']]), Rule('if_statement', [["'if'", 'expr', "':'", 'statement']]), ]</code> </pre> <br><p>  рдЕрдм рдЬрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рд╣рдорд╛рд░реЗ рдореЗрдЯрд╛ рд╕рдВрдХрд▓рдХ рдХрд╛ рдкрд╛рд░реНрд╕рд┐рдВрдЧ рд╣рд┐рд╕реНрд╕рд╛ рд╣реИ, рддреЛ рд╣рдо рдПрдХ рдХреЛрдб рдЬрдирд░реЗрдЯрд░ рдмрдирд╛рддреЗ рд╣реИрдВред  рд╕рд╛рде рдореЗрдВ рд╡реЗ рдПрдХ рдкреНрд░рд╛рд░рдВрднрд┐рдХ рдореЗрдЯрд╛ рд╕рдВрдХрд▓рдХ рдмрдирд╛рддреЗ рд╣реИрдВ: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generate_parser_class</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rules)</span></span></span><span class="hljs-function">:</span></span> print(<span class="hljs-string"><span class="hljs-string">f"class ToyParser(Parser):"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> rule <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rules: print() print(<span class="hljs-string"><span class="hljs-string">f" @memoize"</span></span>) print(<span class="hljs-string"><span class="hljs-string">f" def </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{rule.name}</span></span></span><span class="hljs-string">(self):"</span></span>) print(<span class="hljs-string"><span class="hljs-string">f" pos = self.mark()"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> alt <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> rule.alts: items = [] print(<span class="hljs-string"><span class="hljs-string">f" if (True"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> alt: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> item[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> (<span class="hljs-string"><span class="hljs-string">'"'</span></span>, <span class="hljs-string"><span class="hljs-string">"'"</span></span>): print(<span class="hljs-string"><span class="hljs-string">f" and self.expect(</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{item}</span></span></span><span class="hljs-string">)"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: var = item.lower() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> var <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> items: var += str(len(items)) items.append(var) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> item.isupper(): print(<span class="hljs-string"><span class="hljs-string">" "</span></span> + <span class="hljs-string"><span class="hljs-string">f"and (</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{var}</span></span></span><span class="hljs-string"> := self.expect(</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{item}</span></span></span><span class="hljs-string">))"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: print(<span class="hljs-string"><span class="hljs-string">f" "</span></span> + <span class="hljs-string"><span class="hljs-string">f"and (</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{var}</span></span></span><span class="hljs-string"> := self.</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{item}</span></span></span><span class="hljs-string">())"</span></span>) print(<span class="hljs-string"><span class="hljs-string">f" ):"</span></span>) print(<span class="hljs-string"><span class="hljs-string">f" "</span></span> + <span class="hljs-string"><span class="hljs-string">f"return Node(</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{rule.name!r}</span></span></span><span class="hljs-string">, [</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{</span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">', '</span></span></span></span><span class="hljs-string"><span class="hljs-subst">.join(items)}</span></span></span><span class="hljs-string">])"</span></span>) print(<span class="hljs-string"><span class="hljs-string">f" self.reset(pos)"</span></span>) print(<span class="hljs-string"><span class="hljs-string">f" return None"</span></span>)</code> </pre> <br><p>  рдпрд╣ рдХреЛрдб рдмрд╣реБрдд рдмрджрд╕реВрд░рдд рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ (рдкреНрд░рдХрд╛рд░), рдФрд░ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдореИрдВ рдЗрд╕реЗ рдлрд┐рд░ рд╕реЗ рд▓рд┐рдЦреВрдВрдЧрд╛ред </p><br><p>  <code>for alt in rule.alts</code> рдХреЛ рд╕реНрдкрд╖реНрдЯреАрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ: рд╡рд┐рдХрд▓реНрдк рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдХреЗ рд▓рд┐рдП, рд╣рдо 3 рд╡рд┐рдХрд▓реНрдкреЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдЪреБрдирддреЗ рд╣реИрдВ: </p><br><ul><li>  рдпрджрд┐ рддрддреНрд╡ рдПрдХ рд╕реНрдЯреНрд░рд┐рдВрдЧ рд╢рд╛рдмреНрджрд┐рдХ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП <code>'+'</code> , рддреЛ рд╣рдо <code>self.expect('+')</code> рдЙрддреНрдкрдиреНрди рдХрд░рддреЗ рд╣реИрдВред </li><li>  рдпрджрд┐ рддрддреНрд╡ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрдкрд░рдХреЗрд╕ рд╣реИ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП <code>NAME</code> , рддреЛ рд╣рдо рдЬрдирд░реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ <code>(name := self.expect(NAME))</code> </li><li>  рдЕрдиреНрдпрдерд╛, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЕрдЧрд░ рдпрд╣ <code>expr</code> , рддреЛ рд╣рдо рдЬрдирд░реЗрдЯ рдХрд░рддреЗ рд╣реИрдВ <code>(expr := self.expr())</code> </li></ul><br><p>  рдпрджрд┐ рдПрдХ рд╕рдВрд╕реНрдХрд░рдг рдореЗрдВ рдПрдХ рд╣реА рдирд╛рдо рдХреЗ рд╕рд╛рде рдХрдИ рддрддреНрд╡ рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>term '-' term</code> ), рддреЛ рд╣рдо рджреВрд╕рд░реЗ рдореЗрдВ рдПрдХ рдЕрдВрдХ рдЬреЛрдбрд╝рддреЗ рд╣реИрдВред  рдпрд╣рд╛рдВ рдПрдХ рдЫреЛрдЯреА рд╕реА рдЧрд▓рддреА рднреА рд╣реИ рдЬрд┐рд╕реЗ рдореИрдВ рдЕрдЧрд▓реЗ рдПрдкрд┐рд╕реЛрдб рдореЗрдВ рд╕рд╣реА рдХрд░реВрдВрдЧрд╛ред </p><br><p>  рдпрд╣рд╛рдВ рдЙрдирдХреЗ рдХрд╛рдо рдХрд╛ рдереЛрдбрд╝рд╛ рд╕рд╛ рдкрд░рд┐рдгрд╛рдо рд╣реИ (рдкреВрд░реА рдХрдХреНрд╖рд╛ рдмрд╣реБрдд рдЙрдмрд╛рдК рд╣реЛрдЧреА)ред  рдЕрдирд╛рд╡рд╢реНрдпрдХ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЪрд┐рдВрддрд╛ рди рдХрд░реЗрдВ <code>if (True and</code> ... <code>)</code> рдХреЛрдб рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рддрд╛рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдЙрддреНрдкрдиреНрди рд╕реНрдерд┐рддрд┐ рдХреЗ рд╕рд╛рде рд╢реБрд░реВ рд╣реЛ рд╕рдХреЗ <code>and</code> ред  рдкрд╛рдпрдерди рдмрд╛рдЗрдЯ рдХрдВрдкрд╛рдЗрд▓рд░ рдЗрд╕рдХрд╛ рдЕрдиреБрдХреВрд▓рди рдХрд░рддрд╛ рд╣реИред </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ToyParser</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Parser)</span></span></span><span class="hljs-class">:</span></span> @memoize <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">statement</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> pos = self.mark() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (assignment := self.assignment()) ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Node(<span class="hljs-string"><span class="hljs-string">'statement'</span></span>, [assignment]) self.reset(pos) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (expr := self.expr()) ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Node(<span class="hljs-string"><span class="hljs-string">'statement'</span></span>, [expr]) self.reset(pos) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> (if_statement := self.if_statement()) ): <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Node(<span class="hljs-string"><span class="hljs-string">'statement'</span></span>, [if_statement]) self.reset(pos) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> ...</code> </pre> <br><p>  <code>@memoize</code> рдбреЗрдХреЛрд░реЗрдЯрд░ рдкрд░ рдзреНрдпрд╛рди <code>@memoize</code> : рдореИрдВрдиреЗ рдЗрд╕реЗ рдПрдХ рдЕрдиреНрдп рд╡рд┐рд╖рдп рдкрд░ рдЖрдЧреЗ рдмрдврд╝рдиреЗ рдХреЗ рд▓рд┐рдП рдкреЗрд╢ рдХрд┐рдпрд╛: рдЙрддреНрдкрдиреНрди рдкрд╛рд░реНрд╕рд░ рдХреЛ рддреЗрдЬреА рд╕реЗ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП <code>@memoize</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ред </p><br><p>  рдпрд╣рд╛рдБ <code>memoize()</code> рдлрд╝рдВрдХреНрд╢рди рд╣реИ рдЬреЛ рдЗрд╕ рдбреЗрдХреЛрд░реЗрдЯрд░ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рддрд╛ рд╣реИ: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memoize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(func)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memoize_wrapper</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, *args)</span></span></span><span class="hljs-function">:</span></span> pos = self.mark() memo = self.memos.get(pos) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> memo <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: memo = self.memos[pos] = {} key = (func, args) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> memo: res, endpos = memo[key] self.reset(endpos) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: res = func(self, *args) endpos = self.mark() memo[key] = res, endpos <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> res <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> memoize_wrapper</code> </pre> <br><p>  рдЕрдиреНрдп рд╕рдЬреНрдЬрд╛рдХрд╛рд░реЛрдВ рдХреА рддрд░рд╣, рдЗрд╕рдореЗрдВ рдПрдХ рдиреЗрд╕реНрдЯреЗрдб рдлрд╝рдВрдХреНрд╢рди рд╣реЛрддрд╛ рд╣реИ рдЬреЛ рдПрдХ рд╕рдЬрд╛рдпрд╛ рдЧрдпрд╛ рдлрд╝рдВрдХреНрд╢рди (рдпрд╛ рд▓рдкреЗрдЯрддрд╛ рд╣реИ) рдПрдХ рд╕рдЬрд╛рдпрд╛ рдЧрдпрд╛ рдлрд╝рдВрдХреНрд╢рди, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>ToyParser</code> рдХреНрд▓рд╛рд╕ рдХрд╛ <code>statement()</code> рд╡рд┐рдзрд┐ред  рдЪреВрдВрдХрд┐ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рд▓рдкреЗрдЯрд╛ рдЬрд╛ рд░рд╣рд╛ рд╣реИ, рдпрд╣ рдПрдХ рд╡рд┐рдзрд┐ рд╣реИ, рдЖрд╡рд░рдг рднреА рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдПрдХ рд╡рд┐рдзрд┐ рд╣реИ: рдЗрд╕рдХрд╛ рдкрд╣рд▓рд╛ рддрд░реНрдХ <code>self</code> рдХреЛ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ <code>ToyParser</code> рдЗрдВрд╕реНрдЯреЗрдВрд╕ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рд╕рдЬрд╛рдпрд╛ рдЧрдпрд╛ рд╡рд┐рдзрд┐ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИред </p><br><p>  рд░реИрдкрд░ рдкреНрд░рддреНрдпреЗрдХ рдЗрдирдкреБрдЯ рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рд╡рд┐рдзрд┐ рдХреЙрд▓ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдХреИрд╢ рдХрд░рддрд╛ рд╣реИ - рдпрд╣реА рдХрд╛рд░рдг рд╣реИ рдХрд┐ рдЗрд╕реЗ рдкреИрдХрд░реИрдЯ рдкрд╛рд░реНрд╕рд░ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ!  [рд▓рдЧрднрдЧред  рдкреНрд░рддрд┐ред  packrat рдПрдХ "рдЪреЛрд░" рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рд╢рдмреНрдж рд░реВрд╕реА рднрд╛рд╖рд╛ рдХреЗ рд╕реНрд░реЛрддреЛрдВ рдореЗрдВ рдЕрдиреБрд╡рд╛рджрд┐рдд рдирд╣реАрдВ рд╣реИред] рдХреИрд╢реЗ рд╢рдмреНрджрдХреЛрд╢реЛрдВ рдХрд╛ рдПрдХ рд╢рдмреНрджрдХреЛрд╢ рд╣реИ, рдЬреЛ рдПрдХ <code>Parser</code> рдЙрджрд╛рд╣рд░рдг рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рд╣реИред  рдмрд╛рд╣рд░реА рд╢рдмреНрджрдХреЛрд╢ рдХреА рдХреБрдВрдЬреА рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рд╕реНрдерд┐рддрд┐ рд╣реИ;  рдореИрдВрдиреЗ рдЗрд╕реЗ рдкреНрд░рд╛рд░рдВрдн рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП <code>self.memos = {}</code> рдХреЛ <code>Parser .__ init__()</code> рднреА рдЬреЛрдбрд╝рд╛ред  рдЖрдВрддрд░рд┐рдХ рд╢рдмреНрджрдХреЛрд╢реЛрдВ рдХреЛ рдЖрд╡рд╢реНрдпрдХрддрд╛рдиреБрд╕рд╛рд░ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ;  рдЙрдирдХреА рдХреБрдВрдЬрд┐рдпреЛрдВ рдореЗрдВ рдПрдХ рд╡рд┐рдзрд┐ рдФрд░ рдЙрд╕рдХреЗ рддрд░реНрдХ рд╣реЛрддреЗ рд╣реИрдВред  (рд╡рд░реНрддрдорд╛рди рдбрд┐рдЬрд╛рдЗрди рдореЗрдВ рдХреЛрдИ рддрд░реНрдХ рдирд╣реАрдВ рд╣реИрдВ, рд▓реЗрдХрд┐рди рд╣рдо <code>expect()</code> рдХреЛ рдпрд╛рдж рдХрд░ <code>expect()</code> рдлрд╝рдВрдХреНрд╢рди рдЬрд┐рд╕рдореЗрдВ рдПрдХ рд╣реИ, рдЬреЛ рдХрд╛рдлреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ) </p><br><p>  рдкрд╛рд░реНрд╕рд░ рд╡рд┐рдзрд┐ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рдПрдХ рдЯрдкрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдкреНрд░рд╕реНрддреБрдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рджреЛ рдореВрд▓реНрдп рд╣реИрдВ: рдкрд░рд┐рдгрд╛рдо рд╕реНрд╡рдпрдВ (рд╣рдорд╛рд░реА рдЙрддреНрдкрдиреНрди рд╡рд┐рдзрд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдпрд╣ рдорд┐рд▓рд╛рди рдирд┐рдпрдо рдХреЗ рд▓рд┐рдП <code>Node</code> ) рдФрд░ рдЗрдирдкреБрдЯ рд╕реНрдЯреНрд░реАрдо рдореЗрдВ рд╡рд░реНрддрдорд╛рди рд╕реНрдерд┐рддрд┐ рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рдВрдХреЗрддрдХ, рдЬреЛ <code>self.mark()</code> рд╕реЗ рдорд┐рд▓рддрд╛ рд╣реИред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╣рдо рдЬреНрдЮрд╛рдкрди рдореВрд▓реНрдпреЛрдВ рдХреЗ рд╕рд╛рде рдЖрдВрддрд░рд┐рдХ рд╢рдмреНрджрдХреЛрд╢ рдореЗрдВ рд╡рд╛рдкрд╕реА рдореВрд▓реНрдп ( <code>res</code> ) рдФрд░ рдирдИ рд╕реНрдерд┐рддрд┐ ( <code>endpos</code> ) рджреЛрдиреЛрдВ рдХреЛ рдХреИрд╢ рдХрд░рддреЗ рд╣реИрдВред  рдПрдХ рд╣реА рдЗрдирдкреБрдЯ рд╕реНрдерд┐рддрд┐ рдореЗрдВ рд╕рдорд╛рди рддрд░реНрдХреЛрдВ рдХреЗ рд╕рд╛рде рдПрдХ рд╣реА рдкрд╛рд░реНрд╕рд┐рдВрдЧ рдкрджреНрдзрддрд┐ рдХреЗ рдмрд╛рдж рдХреЗ рдХреЙрд▓ рдкрд░, рд╣рдо рдЙрдиреНрд╣реЗрдВ рдХреИрд╢ рд╕реЗ рд▓реЗрдВрдЧреЗред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдмрд╕ рдкреЙрдЗрдВрдЯрд░ рдХреЛ <code>self.reset()</code> рд╕реНрдерд┐рддрд┐ рдореЗрдВ <code>self.reset()</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ <code>self.reset()</code> рдФрд░ рдХреИрд╢ рдореЗрдВ рджреЗрдЦреЗрдВред </p><br><p>  рдирдХрд╛рд░рд╛рддреНрдордХ рдкрд░рд┐рдгрд╛рдореЛрдВ рдХреЛ рдХреИрд╢ рдХрд░рдирд╛ рднреА рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ - рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, рдЕрдзрд┐рдХрд╛рдВрд╢ рдХреЙрд▓ рдирдХрд╛рд░рд╛рддреНрдордХ рд╣реЛрдВрдЧреЗред  рдЗрд╕ рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рд╡рд╛рдкрд╕реА рдорд╛рди <code>None</code> , рдФрд░ рдЗрдирдкреБрдЯ рд╕реНрдерд┐рддрд┐ рдирд╣реАрдВ рдмрджрд▓рддреА рд╣реИред  рдЖрдк рдЗрд╕реЗ рдЬрд╛рдБрдЪрдиреЗ рдХреЗ рд▓рд┐рдП <code>assert</code> рдЬреЛрдбрд╝ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдиреЛрдЯред  рдкрд╛рдпрдерди рдореЗрдВ, <code>memoize()</code> рдлрд╝рдВрдХреНрд╢рди рдореЗрдВ рд╕реНрдерд╛рдиреАрдп рдЪрд░ рдореЗрдВ рдХреИрд╢ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдерд╛рдЧрдд рд╣реИред  рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдпрд╣ рдХрд╛рдо рдирд╣реАрдВ рдХрд░реЗрдЧрд╛: рдЬреИрд╕рд╛ рдХрд┐ рдореИрдВрдиреЗ рдбрд┐рдмрдЧрд┐рдВрдЧ рдХреЗ рдмрд╣реБрдд рдЕрдВрдд рдореЗрдВ рдкрд╛рдпрд╛, рдкреНрд░рддреНрдпреЗрдХ <code>Parser</code> рдЙрджрд╛рд╣рд░рдг рдХрд╛ рдЕрдкрдирд╛ рдХреИрд╢ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЖрдк рдХреБрдВрдЬреА рдХреЗ рд░реВрдк рдореЗрдВ ( <code>pos</code> , <code>func</code> , <code>args</code> ) рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдиреЗрд╕реНрдЯреЗрдб рд╢рдмреНрджрдХреЛрд╢реЛрдВ рд╕реЗ рдЫреБрдЯрдХрд╛рд░рд╛ рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред </p><br><p>  рдЕрдЧрд▓реЗ рд╣рдлреНрддреЗ рдореИрдВ рдХреЛрдб рдФрд░ рдирд┐рд╢рд╛рди рддреИрдпрд╛рд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рджрд┐рдЦрд╛рдКрдВрдЧрд╛ рдХрд┐ рдХреИрд╕реЗ рдпрд╣ рд╕рдм рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЗрдХрдЯреНрдард╛ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ рдФрд░ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХрд╛рд░реНрдпрдХреНрд░рдо рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рддреЗ рд╕рдордп рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдореИрдВ рдЕрднреА рднреА рдЯреЛрдХрди рдмрдлрд░, рдкрд╛рд░реНрд╕рд░ рдФрд░ рдХреИрд╢ рдХреЗ рд╕рд╣рдпреЛрдЧ рдХреА рдХрд▓реНрдкрдирд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдмреЗрд╣рддрд░ рддрд░реАрдХреЗ рдХреА рддрд▓рд╛рд╢ рдореЗрдВ рд╣реВрдВред  рд╢рд╛рдпрдж рдореИрдВ ASCII рдореЗрдВ рдХреЗрд╡рд▓ рдкрд╛рда рдХреЗ рд░реВрдк рдореЗрдВ рдЯреНрд░реЗрд╕ рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдкреНрд░рджрд░реНрд╢рд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрдЬрд╛рдп рдПрдХ рдПрдирд┐рдореЗрдЯреЗрдб gif рдмрдирд╛рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рд╣реЛ рдЬрд╛рдПрдЧрд╛ред </p><br><p>  рдЗрд╕ рд▓реЗрдЦ рдХреЗ рд▓рд┐рдП рд▓рд╛рдЗрд╕реЗрдВрд╕ рдФрд░ рдХреЛрдб рдХрд╛ рд╣рд╡рд╛рд▓рд╛ рджрд┐рдпрд╛: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">CC BY-NC-SA 4.0</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi471864/">https://habr.com/ru/post/hi471864/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi471854/index.html">рд╣реАрдЯ рдбреЗрде 5 рдЬреА</a></li>
<li><a href="../hi471856/index.html">рд╣рдо рд╣реИрд░реА рдкреЙрдЯрд░ рдкреЛрд╢рди рдкрд╣реЗрд▓реА рдХреЗ рд╕рднреА 42 рд╕рдВрд╕реНрдХрд░рдгреЛрдВ рдХреЛ рд╣рд▓ рдХрд░рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi471858/index.html">рд░реИрдмрд┐рдЯрдПрдордХреНрдпреВ рдмрдирд╛рдо рдХрд╛рдлреНрдХрд╛: рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рд╡рд┐рдлрд▓рддрд╛ рдФрд░ рдЙрдЪреНрдЪ рдЙрдкрд▓рдмреНрдзрддрд╛</a></li>
<li><a href="../hi471860/index.html">рдЦреВрдВрдЯреА рдкрд░рд╕реЗрдВрдЯрд░реНрд╕</a></li>
<li><a href="../hi471862/index.html">рдЦреВрдВрдЯреА рдкрд╛рд░реНрд╕рд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди</a></li>
<li><a href="../hi471866/index.html">рдЦреВрдВрдЯреА рдкрд╛рд░реНрд╕рд░ рджреГрд╢реНрдп</a></li>
<li><a href="../hi471868/index.html">рдкреНрд░реЗрдо рдХреА рдЖрдиреБрд╡рд╛рдВрд╢рд┐рдХреА: рдЕрдВрддрд░-рд▓рд┐рдВрдЧ рд╕рдВрдШрд░реНрд╖, рдПрдХрд░рд╕ рдкрдХреНрд╖реА рдХреЗ рдЬреЛрдбрд╝реЗ рдореЗрдВ рд╕рд╣рдпреЛрдЧ рдХрд╛ рдЖрдзрд╛рд░</a></li>
<li><a href="../hi471870/index.html">Libdispatch рдХрд╛ рдкреНрд░рднрд╛рд╡реА рдЙрдкрдпреЛрдЧ</a></li>
<li><a href="../hi471872/index.html">рд╕реА # 8 рдореЗрдВ рдЗрдВрдЯрд░рдлреЗрд╕: рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдореЗрдВ рдЦрддрд░рдирд╛рдХ рдЕрдиреБрдорд╛рди</a></li>
<li><a href="../hi471876/index.html">рдкреАрдбреАрдпреВ рдФрд░ рдСрд▓-рдСрд▓-рдСрд▓: рд░реИрдХ рдмрд┐рдЬрд▓реА рд╡рд┐рддрд░рдг</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>