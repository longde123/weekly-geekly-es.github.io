<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙍🏻 💇🏿 🥉 Erstellen einer Vorlage für Zabbix am Beispiel des DVR Trassir SDK 🙄 ✌🏿 👩‍❤️‍💋‍👩</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Zweck der Erstellung der Vorlage besteht darin, die Überwachung von Videoüberwachungssystem-Servern basierend auf Trassir-Registraren unter der Ko...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erstellen einer Vorlage für Zabbix am Beispiel des DVR Trassir SDK</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/430534/"> Der Zweck der Erstellung der Vorlage besteht darin, die Überwachung von Videoüberwachungssystem-Servern basierend auf Trassir-Registraren unter der Kontrolle der gleichnamigen Linux-basierten Software über den SDK-Webserver zu automatisieren. <br><a name="habracut"></a><br>  Das Trassir SDK ist in den Webserver-Einstellungen enthalten. Dort müssen Sie auch ein Kennwort angeben.  Gemäß der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Herstellers müssen</a> Sie kein separates Konto erstellen, um Messwerte über den Server zu erhalten. <br><br>  Das Trassir SDK bietet auf Anfrage Zugriff auf den Serverstatus <br><br><pre><code class="plaintext hljs">https://{ip   }:{ }/health?password={ SDK}</code> </pre> <br>  Wenn Sie diesen Link über einen Browser öffnen, wird eine Meldung angezeigt, dass das verwendete Zertifikat unsicher ist und Sie den Anweisungen des Browsers folgen müssen, um fortzufahren. <br><br>  Für ein bestimmtes Beispiel erhalten wir im Antworttext Folgendes: <br><br><pre> <code class="plaintext hljs">{ "disks": "1", "database": "1", "channels_total": "13", "channels_online": "13", "uptime": "882232", "cpu_load": "33.96", "network": "1", "automation": "1", "disks_stat_main_days": "16.41", "disks_stat_priv_days": "0.00", "disks_stat_subs_days": "16.41" } /* Meanings of values: -1 - undefined value 0 - bad health (error) 1 - good health (ok) Values for channels are channel counters. Value of cpu_load is given in percents.</code> </pre> <br>  Der erste Teil der Ausgabe vom Zeichen {zum Zeichen} entspricht der Dokumentation und ist eine standardisierte Ausgabe des JSON-Formats, die der Dokumentation entspricht, und dann gibt es eine Beschreibung der Ausgabe, die nicht dem Standard entspricht. <br><br>  Zuvor mussten Sie, um diese Ausgabe im Zabbix-Überwachungssystem zu verwenden, ein eigenes Skript schreiben, das auf dem Agenten verwendet wurde, um die erforderlichen Daten abzurufen.  Bei diesem Ansatz müssen Sie entweder die Antwortdatei speichern und ihre Relevanz überwachen oder jedes Element separat anfordern, d. H.  Verwenden Sie 11 Abfragen anstelle von 1. <br><br>  In der Version von Zabbix 4.0 wurde ein Agent-Agent-Datenelementtyp angezeigt, der es ermöglicht, Daten über http- und https-Protokolle zu empfangen und zu verarbeiten sowie abhängige Elemente, die aus den Hauptprotokollen berechnet werden. <br><br>  Die Idee ist, eine Serverantwort in ein Textdatenelement zu bekommen und dann die erforderlichen Datenelemente daraus auszuwählen. <br><br>  Zunächst definieren wir Makros für die Portnummer und das Passwort für die Vielseitigkeit und Sicherheit unserer Vorlage. <br><br>  Wir erstellen eine Vorlage und fügen ein Datenelement mit dem Typ "HTTP-Agent", einen gewünschten Schlüssel, die URL https: // {HOST.IP}: {$ TRASSIR_SDK_PORT} / health und das Kennwortanforderungsfeld {$ TRASSIR_SDK_PASS} hinzu.  Hier ist {HOST.IP} ein Makro, das beim Hinzufügen einer Vorlage zum Host in die Host-IP-Adresse konvertiert wird. <br><br>  Wie wir bereits zuvor experimentell herausgefunden haben, entspricht diese Anforderung nicht vollständig dem JSON-Format und funktioniert einfach nicht, um Daten daraus zu extrahieren. <br><br>  Wir werden die neue Zabbix-Funktionalität verwenden und den regulären Ausdruck \ {(\ n |.) * \} Auf der Registerkarte "Vorverarbeitung" der Datenelementvorlage mit der Ausgabe \ 0 hinzufügen, die nur Daten im JSON-Format zurückgibt. <br><br><div class="spoiler">  <b class="spoiler_title">Wen interessiert es, warum das so ist?</b> <div class="spoiler_text">  Das Entwickeln solcher Ausdrücke für Anfänger ist im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">visuellen Editor</a> viel einfacher.  In diesem Ausdruck suchen wir nach einem bestimmten Zeichen für die öffnende geschweifte Klammer. Da diese Klammern in regulären Ausdrücken verwendet werden, muss vor dem Zeichen ein Backslash angegeben werden.  Die JSON-Daten können beliebige (in der Tat nein, aber lassen Sie uns diesen Moment weglassen) Zeichen sowie einen Zeilenvorschub enthalten.  Diese Zeichenoptionen, die einen Punkt oder ein Zeilenvorschubsteuerzeichen angeben \ n, sind in Klammern mit einem vertikalen Balken angegeben.  Hinter den Klammern befindet sich ein Sternchen, das angibt, dass das gefundene Zeichen oder der Zeilenvorschub unendlich oft wiederholt werden kann.  Als nächstes kommt die Verschlussklammer.  Die Ausgabe \ 0 bedeutet, dass alle gefundenen Sequenzen angezeigt werden. </div></div><br>  Als nächstes wird ein abhängiges Datenelement erstellt, für das das Hauptdatenelement die zuvor im JSON-Format empfangene Antwort angibt, und die Vorverarbeitung wird mit dem Schritt "JSON-Pfad" angezeigt, mit dem Sie auf jedes Datenelement zugreifen können, indem Sie den JSON-Pfad angeben.  In unserem Beispiel befinden sich alle Daten auf der obersten Ebene, daher geben wir für alle Elemente $ .disks usw. an. <br><br>  Es müssen nur noch Trigger erstellt werden, die nach neuen Daten, deren Eingabe in normale Bereiche sowie optionalen Grafiken suchen. <br><br>  Es stellt sich heraus, dass wir mit regulären Methoden von Zabbix sehr einfach und schnell Daten von einem externen System erhalten haben, dessen Ausgabe nicht vollständig dem Standard entspricht.  Das Fehlen externer Skripte vereinfacht das Verständnis des Überwachungssystems und erhöht die Wartungsfreundlichkeit. <br><br>  Die angegebene Vorlage <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ist auf dem Austauschportal share.zabbix.com verfügbar</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de430534/">https://habr.com/ru/post/de430534/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de430524/index.html">Neuronale Netzwerkarchitektur</a></li>
<li><a href="../de430526/index.html">Spielautomaten: Woher kamen sie in der UdSSR und wie sind sie angeordnet?</a></li>
<li><a href="../de430528/index.html">Programmieren mit PyUSB 1.0</a></li>
<li><a href="../de430530/index.html">Mock-Server für die mobile Testautomatisierung</a></li>
<li><a href="../de430532/index.html">Sicherheit in iOS-Apps</a></li>
<li><a href="../de430536/index.html">Entwerfen von Fensterfunktionen, die zu einer Einheit mit einem bestimmten Überlappungsgrad zusammengefasst werden</a></li>
<li><a href="../de430538/index.html">Lesen Sie Scaladoc für „offensichtliche“ Erfassungsmethoden? Oder warum Faulheit nicht immer gut ist</a></li>
<li><a href="../de430542/index.html">Offenes Webinar „Infrastruktur als Code“</a></li>
<li><a href="../de430546/index.html">"Es wurde angenommen, dass der Code durch UML-Diagramme ersetzt wird, aber es besteht keine Notwendigkeit zum Testen": ein Interview mit Alexei Barantsev</a></li>
<li><a href="../de430548/index.html">Interrupts von externen Geräten in einem x86-System. Teil 1. Die Entwicklung der Interrupt-Controller</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>