<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üîª ü•§ üéØ Intel Edison Nuvem Intel IoT Analytics: enviando SMS e cliente RESTful no ASP.NET ü•Ç üë©üèΩ‚Äç‚öñÔ∏è ‚úñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A parte final do trabalho com a Intel IoT Analytics Cloud . Adicionando o envio de notifica√ß√µes por SMS usando gateways HTTP e criando um cliente REST...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Intel Edison Nuvem Intel IoT Analytics: enviando SMS e cliente RESTful no ASP.NET</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/384929/"><img src="https://habrastorage.org/getpro/geektimes/post_images/bd9/939/ed9/bd9939ed9f98c235c4fcb8f033e8ceba.jpg" alt="An√°lise de IoT da Intel"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A parte final do trabalho com a </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel IoT Analytics</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cloud </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">Adicionando o envio de notifica√ß√µes por SMS usando gateways HTTP e criando um cliente RESTful simples no ASP.NET. </font><font style="vertical-align: inherit;">Resumindo. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Enviar notifica√ß√µes por SMS usando um gateway HTTP</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
Em um trabalho anterior da </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Edison. </font><font style="vertical-align: inherit;">Trabalhando com a nuvem Intel IoT Analytics: criando regras e enviando notifica√ß√µes,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> foram </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">criadas regras</font></a><font style="vertical-align: inherit;"> que permitem enviar: uma notifica√ß√£o por email e gerenciar a energia de retransmiss√£o. </font><font style="vertical-align: inherit;">Ao enviar mensagens SMS, adicione essas duas regras criadas. </font></font><br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regras:</font></font></strong><br>
<ul>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Higth_temp_PowerOnRelay_and_send_to_web@devdotnet.org</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Low_temp_PowerOffRelay_and_send_to_web@devdotnet.org</font></font></li>
</ul><br><font style="vertical-align: inherit;"></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usaremos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
o gateway </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;">smsc.ru</font></a><font style="vertical-align: inherit;"> SMS </font><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">A API est√° dispon√≠vel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para enviar uma mensagem SMS, basta gerar e enviar uma solicita√ß√£o GET do formul√°rio: </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">smsc.ru/sys/send.php?login=&amp;psw=&amp;phones=&amp;mes=</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , em que: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
login - login do cliente </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
psw - senha do cliente ou hash da senha MD5 em min√∫sculas. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
telefones - O n√∫mero no formato internacional sem o sinal "+" </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
mes - O texto da mensagem a ser enviada. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o h√° necessidade de adicionar cabe√ßalhos, tudo √© muito simples. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vamos formar dois pedidos: </font></font></strong><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">smsc.ru/sys/send.php?login=tele</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> **** &amp; psw = d46d70eb6 ****** &amp; phones = 79232 ****** &amp; mes = Relay_power_ON </font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">smsc.ru/sys/send. php? login = tele</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> **** &amp; psw = d46d70eb6 ****** &amp; phones = 79232 ****** &amp; mes = Relay_power_OFF V√° </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
para a se√ß√£o </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Regras,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> abra a regra</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Higth_temp_PowerOnRelay_and_send_to_web@devdotnet.org. </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Adicionar </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tipo de notifica√ß√£o - ponto final HTTP</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> e insira o </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/b4c/5ef/f11/b4c5eff113c1821a8a37c0254724887b.png" alt="An√°lise de IoT da Intel"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al√©m disso, </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">criaremos Low_temp_PowerOffRelay_and_send_to_web@devdotnet.org</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para a segunda regra </font><font style="vertical-align: inherit;">.</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SMS recebidos no telefone</font></font></b><div class="spoiler_text"><img src="https://habrastorage.org/getpro/geektimes/post_images/05f/e2b/b7d/05fe2bb7db543854b31a6d9347efb1b8.png" alt="Intel IoT Analytics"></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do menos da fun√ß√£o de enviar mensagens SMS, √© necess√°rio observar a incapacidade de enviar dados din√¢micos, por exemplo, voc√™ n√£o pode enviar a leitura atual do sensor. </font></font><br>
<br>
<strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cliente RESTful simples no ASP.NET Razor Criaremos</font></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
uma p√°gina exibindo as leituras atuais do sensor: temperatura e press√£o. </font><font style="vertical-align: inherit;">Colocaremos a parte de controle na p√°gina: ligar o rel√© e o LED. </font><font style="vertical-align: inherit;">A API da nuvem est√° dispon√≠vel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Implementa√ß√£o no ASP.NET Razor netf 4.5. </font><font style="vertical-align: inherit;">Para trabalhar com JSON, a biblioteca Newtonsoft.Json √© usada. </font><font style="vertical-align: inherit;">O arquivo Web.config cont√©m o login e a senha para acessar a nuvem. </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O exemplo n√£o √© uma solu√ß√£o completa, mas uma demonstra√ß√£o simples do uso da API. </font></font></strong><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como sempre, obtemos o token, uma se√ß√£o no </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiki Authorization</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O c√≥digo</font></font></b><div class="spoiler_text"><pre><code class="hljs pgsql">string GetNewToken()<font></font>
            {<font></font>
                // <span class="hljs-keyword">login</span>  pass<font></font>
                string strLogin, strPass;<font></font>
                strLogin = <span class="hljs-keyword">System</span>.<span class="hljs-keyword">Configuration</span>.ConfigurationManager.AppSettings["Login"];<font></font>
                strPass = <span class="hljs-keyword">System</span>.<span class="hljs-keyword">Configuration</span>.ConfigurationManager.AppSettings["Pass"];<font></font>
                //,  .<font></font>
                //https://github.com/enableiot/iotkit-api/wiki/<span class="hljs-keyword">Authorization</span>
                // <span class="hljs-type">JSON</span>
                var obj = <span class="hljs-built_in">new</span><font></font>
                {<font></font>
                    username = strLogin,<font></font>
                    <span class="hljs-keyword">password</span> = strPass<font></font>
                };<font></font>
                string postData = JsonConvert.SerializeObject(obj, Formatting.Indented);<font></font>
                //HttpWebRequest<font></font>
                HttpWebRequest httpWebRequest = (HttpWebRequest)HttpWebRequest.<span class="hljs-keyword">Create</span>("https://dashboard.us.enableiot.com/v1/api/auth/token");<font></font>
                httpWebRequest.<span class="hljs-keyword">Method</span> = "POST";<font></font>
                httpWebRequest.ContentType = "application/json";<font></font>
                //<font></font>
                byte[] byte1 = <span class="hljs-keyword">System</span>.Text.<span class="hljs-keyword">Encoding</span>.UTF8.GetBytes(postData);<font></font>
                httpWebRequest.ContentLength = byte1.Length;<font></font>
                httpWebRequest.GetRequestStream().<span class="hljs-keyword">Write</span>(byte1, <span class="hljs-number">0</span>, byte1.Length);<font></font>
                httpWebRequest.GetRequestStream().<span class="hljs-keyword">Close</span>();<font></font>
                //<font></font>
                StreamReader reader = <span class="hljs-built_in">new</span> StreamReader(httpWebRequest.GetResponse().GetResponseStream());<font></font>
                JObject objResponse = JObject.Parse(reader.ReadToEnd());<font></font>
                <span class="hljs-keyword">return</span> (string)objResponse["token"];<font></font>
            }<font></font>
</code></pre><br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Lendo dados, se√ß√£o na </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wiki API de dados</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O c√≥digo</font></font></b><div class="spoiler_text"><pre><code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">GetStateSensors</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> strToken, Dictionary&lt;<span class="hljs-keyword">string</span>, <span class="hljs-keyword">string</span>&gt; dicSensors</span>)</span><font></font>
            {<font></font>
                <span class="hljs-comment">// </span>
                <span class="hljs-comment">//https://github.com/enableiot/iotkit-api/wiki/Data-API</span>
                <span class="hljs-comment">// JSON</span>
                <span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span><font></font>
                {<font></font>
                    <span class="hljs-keyword">from</span> = <span class="hljs-number">-20</span>,<font></font>
                    targetFilter = <span class="hljs-keyword">new</span> { deviceList = <span class="hljs-keyword">new</span>[] { <span class="hljs-string">"9e-8d-22-0c-50-7b"</span> } },<font></font>
                    metrics = <span class="hljs-keyword">new</span>[] { <span class="hljs-keyword">new</span> {<font></font>
						id=<span class="hljs-string">"99fb5b73-a9e2-4ae0-8a0d-45e6a7cc0541"</span>,<font></font>
						op=<span class="hljs-string">"none"</span><font></font>
					},<font></font>
                    <span class="hljs-keyword">new</span> {<font></font>
						id=<span class="hljs-string">"b3731f8a-4f31-414d-a072-b364b1792b5b"</span>,<font></font>
						op=<span class="hljs-string">"none"</span><font></font>
					}<font></font>
				}<font></font>
                };<font></font>
                <span class="hljs-keyword">string</span> postData = JsonConvert.SerializeObject(obj, Formatting.Indented);
                <span class="hljs-comment">//HttpWebRequest</span>
                HttpWebRequest httpWebRequest = (HttpWebRequest)HttpWebRequest.Create(<span class="hljs-string">"https://dashboard.us.enableiot.com/v1/api/accounts/4c8c6b2e-c54f-4df5-8bbb-a5e59df85aaa/data/search"</span>);<font></font>
                httpWebRequest.Method = <span class="hljs-string">"POST"</span>;<font></font>
                httpWebRequest.ContentType = <span class="hljs-string">"application/json"</span>;
                <span class="hljs-comment">//Headers</span>
                httpWebRequest.Headers.Add(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"Bearer "</span> + strToken);<font></font>
                httpWebRequest.Headers.Add(<span class="hljs-string">"accountId"</span>, <span class="hljs-string">"4c8c6b2e-c54f-4df5-8bbb-a5e59df85aaa"</span>);
                <span class="hljs-comment">//</span>
                <span class="hljs-keyword">byte</span>[] byte1 = System.Text.Encoding.UTF8.GetBytes(postData);<font></font>
                httpWebRequest.ContentLength = byte1.Length;<font></font>
                httpWebRequest.GetRequestStream().Write(byte1, <span class="hljs-number">0</span>, byte1.Length);<font></font>
                httpWebRequest.GetRequestStream().Close();<font></font>
                <span class="hljs-comment">//</span>
                StreamReader reader = <span class="hljs-keyword">new</span> StreamReader(httpWebRequest.GetResponse().GetResponseStream());<font></font>
                JObject objResponse = JObject.Parse(reader.ReadToEnd());<font></font>
                <span class="hljs-comment">//add Dic</span>
                <span class="hljs-keyword">string</span> strValueSensor = (<span class="hljs-keyword">string</span>)objResponse[<span class="hljs-string">"series"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"points"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"value"</span>];<font></font>
                dicSensors.Add(<span class="hljs-string">"pressure"</span>, strValueSensor);<font></font>
                strValueSensor = (<span class="hljs-keyword">string</span>)objResponse[<span class="hljs-string">"series"</span>][<span class="hljs-number">1</span>][<span class="hljs-string">"points"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"value"</span>];<font></font>
                strValueSensor = Math.Round(<span class="hljs-keyword">decimal</span>.Parse(strValueSensor, System.Globalization.CultureInfo.CreateSpecificCulture(<span class="hljs-string">"en"</span>)), <span class="hljs-number">2</span>).ToString();<font></font>
                dicSensors.Add(<span class="hljs-string">"temperature"</span>, strValueSensor);<font></font>
            }<font></font>
</code></pre><br>
</div></div><br>
<strong><font style="vertical-align: inherit;"></font></strong><font style="vertical-align: inherit;"><strong><font style="vertical-align: inherit;">Resumo da </font></strong><strong><font style="vertical-align: inherit;">interface</font></strong></font><br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/d46/3f7/a36/d463f7a364e3cf24538e96a8f4f7b771.png" alt="An√°lise de IoT da Intel"><br>
<br>
<strong><font style="vertical-align: inherit;"></font></strong><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A nuvem para coleta de dados liberta voc√™ da constru√ß√£o de sua infraestrutura, o que reduz o custo de compra de hardware e software. A configura√ß√£o de dispositivos, sensores √© muito simples. A API desenvolvida permite n√£o apenas receber dados e gerenciar o dispositivo, mas tamb√©m criar seu pr√≥prio painel de administra√ß√£o. Os dados s√£o transmitidos sem atrasos significativos, as solicita√ß√µes n√£o s√£o perdidas. Duas fun√ß√µes est√£o dispon√≠veis: administrador e usu√°rio. Para adicionar um usu√°rio, o administrador precisa especificar um novo email e uma carta de convite ser√° enviada para esse endere√ßo. No processo de registro de um novo usu√°rio, o usu√°rio ser√° solicitado a aceitar um convite para acessar (convite). Assim, o usu√°rio est√° envolvido no gerenciamento de sua conta, incluindo altera√ß√µes de senha. Das falhas√© imposs√≠vel incluir leituras do sensor na mensagem SMS, apenas um modelo pr√©-preparado. Para e-mail, n√£o h√° modelos, apenas uma visualiza√ß√£o padr√£o com uma placa de leitura do sensor. Outro recurso foi descoberto, consistindo na sequ√™ncia de regras de processamento. √Äs vezes, uma situa√ß√£o era observada com o rel√© desligado imediatamente ap√≥s a liga√ß√£o. Al√©m disso, de acordo com a l√≥gica do rel√©, ele deveria desligar somente ap√≥s a temperatura cair abaixo de 28 C. As condi√ß√µes da l√≥gica das regras e o c√≥digo no dispositivo n√£o continham erros. A situa√ß√£o foi resolvida visualizando o log de alertas, novos alertas s√£o adicionados ao final da lista.√Äs vezes, uma situa√ß√£o era observada com o rel√© desligado imediatamente ap√≥s a liga√ß√£o. Al√©m disso, de acordo com a l√≥gica do rel√©, ele deveria desligar somente ap√≥s a temperatura cair abaixo de 28 C. As condi√ß√µes da l√≥gica das regras e o c√≥digo no dispositivo n√£o continham erros. A situa√ß√£o foi resolvida visualizando o log de alertas, novos alertas s√£o adicionados ao final da lista.√Äs vezes, uma situa√ß√£o era observada com o rel√© desligado imediatamente ap√≥s a liga√ß√£o. Al√©m disso, de acordo com a l√≥gica do rel√©, ele deveria desligar somente ap√≥s a temperatura cair abaixo de 28 C. As condi√ß√µes da l√≥gica das regras e o c√≥digo no dispositivo n√£o continham erros. A situa√ß√£o foi resolvida visualizando o log de alertas, novos alertas s√£o adicionados ao final da lista.</font></font><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/getpro/geektimes/post_images/6dc/b9e/69e/6dcb9e69e68161149a1c8bafe72579c9.png" alt="An√°lise de IoT da Intel"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O evento 39 foi o √∫ltimo a operar, apesar de ter precedido o evento 38. O rel√© ligou por um segundo e desligou, apesar de um aumento adicional na temperatura. </font><font style="vertical-align: inherit;">Talvez isso se deva ao servi√ßo ainda n√£o conclu√≠do. </font><font style="vertical-align: inherit;">Atualmente, a nuvem do Intel IoT Analytics est√° em desenvolvimento (status BETA). </font><font style="vertical-align: inherit;">
Vers√£o de teste de </font></font><br>
<br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aplica√ß√£o</font></font></b><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> do </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">web.devdotnet.org</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O projeto est√° dispon√≠vel </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aqui</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Fonte</font></font><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">web.config</font></font></b><div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">appSettings</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">add</span> <span class="hljs-attr">key</span>=<span class="hljs-string">"Login"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"***"</span>/&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">add</span> <span class="hljs-attr">key</span>=<span class="hljs-string">"Pass"</span> <span class="hljs-attr">value</span>=<span class="hljs-string">"***"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">appSettings</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">system.web</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">compilation</span> <span class="hljs-attr">debug</span>=<span class="hljs-string">"true"</span> <span class="hljs-attr">targetFramework</span>=<span class="hljs-string">"4.5"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">assemblies</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">add</span> <span class="hljs-attr">assembly</span>=<span class="hljs-string">"Microsoft.Web.Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">add</span> <span class="hljs-attr">assembly</span>=<span class="hljs-string">"System.Net.Http, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"</span>/&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">assemblies</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">compilation</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">httpRuntime</span> <span class="hljs-attr">targetFramework</span>=<span class="hljs-string">"4.5"</span>/&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">system.web</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">runtime</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">assemblyBinding</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">"urn:schemas-microsoft-com:asm.v1"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">dependentAssembly</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">assemblyIdentity</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"System.Web.Helpers"</span> <span class="hljs-attr">publicKeyToken</span>=<span class="hljs-string">"31bf3856ad364e35"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">bindingRedirect</span> <span class="hljs-attr">oldVersion</span>=<span class="hljs-string">"1.0.0.0-3.0.0.0"</span> <span class="hljs-attr">newVersion</span>=<span class="hljs-string">"3.0.0.0"</span>/&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">dependentAssembly</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">dependentAssembly</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">assemblyIdentity</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"System.Web.WebPages"</span> <span class="hljs-attr">publicKeyToken</span>=<span class="hljs-string">"31bf3856ad364e35"</span>/&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">bindingRedirect</span> <span class="hljs-attr">oldVersion</span>=<span class="hljs-string">"1.0.0.0-3.0.0.0"</span> <span class="hljs-attr">newVersion</span>=<span class="hljs-string">"3.0.0.0"</span>/&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">dependentAssembly</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">assemblyBinding</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">runtime</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span>
</code></pre><br>
</div></div><br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">index.cshtml</font></font></b><div class="spoiler_text"><pre><code class="hljs cs">@using System.Net.Http<font></font>
@using Newtonsoft.Json<font></font>
@using Newtonsoft.Json.Linq<font></font>
<font></font>
@{<font></font>
    <span class="hljs-comment">//   Session</span>
    <span class="hljs-keyword">string</span> strToken;<font></font>
    strToken = (<span class="hljs-keyword">string</span>)Session[<span class="hljs-string">"Token"</span>];
    <span class="hljs-keyword">if</span> (strToken == <span class="hljs-literal">null</span>)<font></font>
    {<font></font>
        strToken = GetNewToken();<font></font>
        Session[<span class="hljs-string">"Token"</span>] = strToken;<font></font>
    }<font></font>
    <span class="hljs-comment">//Action</span>
    <span class="hljs-keyword">if</span> (Request[<span class="hljs-string">"command"</span>] != <span class="hljs-literal">null</span>)<font></font>
    {<font></font>
        <span class="hljs-keyword">string</span> strCommand = (<span class="hljs-keyword">string</span>)Request[<span class="hljs-string">"command"</span>];<font></font>
        SetSateActuation(strToken,strCommand);<font></font>
    }<font></font>
    <span class="hljs-comment">//  Sensors</span>
    Dictionary&lt;<span class="hljs-keyword">string</span>, <span class="hljs-keyword">string</span>&gt; dicSensors = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">string</span>, <span class="hljs-keyword">string</span>&gt;();<font></font>
    GetStateSensors(strToken, dicSensors);<font></font>
    <span class="hljs-comment">//  Actuation</span>
    <span class="hljs-keyword">bool</span> boolValueLED, boolValueRelay;<font></font>
    GetStateActuations(strToken, <span class="hljs-keyword">out</span> boolValueLED, <span class="hljs-keyword">out</span> boolValueRelay);<font></font>
}<font></font>
        @functions {<font></font>
            <span class="hljs-comment">// Pass a user name to this method.</span>
            <span class="hljs-function"><span class="hljs-keyword">string</span> <span class="hljs-title">GetNewToken</span>(<span class="hljs-params"></span>)</span><font></font>
            {<font></font>
                <span class="hljs-comment">// login  pass</span>
                <span class="hljs-keyword">string</span> strLogin, strPass;<font></font>
                strLogin = System.Configuration.ConfigurationManager.AppSettings[<span class="hljs-string">"Login"</span>];<font></font>
                strPass = System.Configuration.ConfigurationManager.AppSettings[<span class="hljs-string">"Pass"</span>];
                <span class="hljs-comment">//,  .</span>
                <span class="hljs-comment">//https://github.com/enableiot/iotkit-api/wiki/Authorization</span>
                <span class="hljs-comment">// JSON</span>
                <span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span><font></font>
                {<font></font>
                    username = strLogin,<font></font>
                    password = strPass<font></font>
                };<font></font>
                <span class="hljs-keyword">string</span> postData = JsonConvert.SerializeObject(obj, Formatting.Indented);
                <span class="hljs-comment">//HttpWebRequest</span>
                HttpWebRequest httpWebRequest = (HttpWebRequest)HttpWebRequest.Create(<span class="hljs-string">"https://dashboard.us.enableiot.com/v1/api/auth/token"</span>);<font></font>
                httpWebRequest.Method = <span class="hljs-string">"POST"</span>;<font></font>
                httpWebRequest.ContentType = <span class="hljs-string">"application/json"</span>;
                <span class="hljs-comment">//</span>
                <span class="hljs-keyword">byte</span>[] byte1 = System.Text.Encoding.UTF8.GetBytes(postData);<font></font>
                httpWebRequest.ContentLength = byte1.Length;<font></font>
                httpWebRequest.GetRequestStream().Write(byte1, <span class="hljs-number">0</span>, byte1.Length);<font></font>
                httpWebRequest.GetRequestStream().Close();<font></font>
                <span class="hljs-comment">//</span>
                StreamReader reader = <span class="hljs-keyword">new</span> StreamReader(httpWebRequest.GetResponse().GetResponseStream());<font></font>
                JObject objResponse = JObject.Parse(reader.ReadToEnd());<font></font>
                <span class="hljs-keyword">return</span> (<span class="hljs-keyword">string</span>)objResponse[<span class="hljs-string">"token"</span>];<font></font>
            }<font></font>
            <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">GetStateSensors</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> strToken, Dictionary&lt;<span class="hljs-keyword">string</span>, <span class="hljs-keyword">string</span>&gt; dicSensors</span>)</span><font></font>
            {<font></font>
                <span class="hljs-comment">// </span>
                <span class="hljs-comment">//https://github.com/enableiot/iotkit-api/wiki/Data-API</span>
                <span class="hljs-comment">// JSON</span>
                <span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span><font></font>
                {<font></font>
                    <span class="hljs-keyword">from</span> = <span class="hljs-number">-20</span>,<font></font>
                    targetFilter = <span class="hljs-keyword">new</span> { deviceList = <span class="hljs-keyword">new</span>[] { <span class="hljs-string">"9e-8d-22-0c-50-7b"</span> } },<font></font>
                    metrics = <span class="hljs-keyword">new</span>[] { <span class="hljs-keyword">new</span> {<font></font>
						id=<span class="hljs-string">"99fb5b73-a9e2-4ae0-8a0d-45e6a7cc0541"</span>,<font></font>
						op=<span class="hljs-string">"none"</span><font></font>
					},<font></font>
                    <span class="hljs-keyword">new</span> {<font></font>
						id=<span class="hljs-string">"b3731f8a-4f31-414d-a072-b364b1792b5b"</span>,<font></font>
						op=<span class="hljs-string">"none"</span><font></font>
					}<font></font>
				}<font></font>
                };<font></font>
                <span class="hljs-keyword">string</span> postData = JsonConvert.SerializeObject(obj, Formatting.Indented);
                <span class="hljs-comment">//HttpWebRequest</span>
                HttpWebRequest httpWebRequest = (HttpWebRequest)HttpWebRequest.Create(<span class="hljs-string">"https://dashboard.us.enableiot.com/v1/api/accounts/4c8c6b2e-c54f-4df5-8bbb-a5e59df85aaa/data/search"</span>);<font></font>
                httpWebRequest.Method = <span class="hljs-string">"POST"</span>;<font></font>
                httpWebRequest.ContentType = <span class="hljs-string">"application/json"</span>;
                <span class="hljs-comment">//Headers</span>
                httpWebRequest.Headers.Add(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"Bearer "</span> + strToken);<font></font>
                httpWebRequest.Headers.Add(<span class="hljs-string">"accountId"</span>, <span class="hljs-string">"4c8c6b2e-c54f-4df5-8bbb-a5e59df85aaa"</span>);
                <span class="hljs-comment">//</span>
                <span class="hljs-keyword">byte</span>[] byte1 = System.Text.Encoding.UTF8.GetBytes(postData);<font></font>
                httpWebRequest.ContentLength = byte1.Length;<font></font>
                httpWebRequest.GetRequestStream().Write(byte1, <span class="hljs-number">0</span>, byte1.Length);<font></font>
                httpWebRequest.GetRequestStream().Close();<font></font>
                <span class="hljs-comment">//</span>
                StreamReader reader = <span class="hljs-keyword">new</span> StreamReader(httpWebRequest.GetResponse().GetResponseStream());<font></font>
                JObject objResponse = JObject.Parse(reader.ReadToEnd());<font></font>
                <span class="hljs-comment">//add Dic</span>
                <span class="hljs-keyword">string</span> strValueSensor = (<span class="hljs-keyword">string</span>)objResponse[<span class="hljs-string">"series"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"points"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"value"</span>];<font></font>
                dicSensors.Add(<span class="hljs-string">"pressure"</span>, strValueSensor);<font></font>
                strValueSensor = (<span class="hljs-keyword">string</span>)objResponse[<span class="hljs-string">"series"</span>][<span class="hljs-number">1</span>][<span class="hljs-string">"points"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"value"</span>];<font></font>
                strValueSensor = Math.Round(<span class="hljs-keyword">decimal</span>.Parse(strValueSensor, System.Globalization.CultureInfo.CreateSpecificCulture(<span class="hljs-string">"en"</span>)), <span class="hljs-number">2</span>).ToString();<font></font>
                dicSensors.Add(<span class="hljs-string">"temperature"</span>, strValueSensor);<font></font>
            }<font></font>
<font></font>
            <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">GetStateActuations</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> strToken, <span class="hljs-keyword">out</span> <span class="hljs-keyword">bool</span> boolValueLED, <span class="hljs-keyword">out</span> <span class="hljs-keyword">bool</span> boolValueRelay</span>)</span><font></font>
            {<font></font>
                <span class="hljs-comment">//  Actuation</span>
                <span class="hljs-comment">//https://github.com/enableiot/iotkit-api/wiki/Control-Device-API</span>
                <span class="hljs-comment">//HttpWebRequest</span>
                HttpWebRequest httpWebRequest = (HttpWebRequest)HttpWebRequest.Create(<span class="hljs-string">"https://dashboard.us.enableiot.com/v1/api/accounts/4c8c6b2e-c54f-4df5-8bbb-a5e59df85aaa/control/devices/9e-8d-22-0c-50-7b?from=-60000"</span>);<font></font>
                httpWebRequest.Method = <span class="hljs-string">"GET"</span>;
                <span class="hljs-comment">//Headers</span>
                httpWebRequest.Headers.Add(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"Bearer "</span> + strToken);<font></font>
                httpWebRequest.Headers.Add(<span class="hljs-string">"accountId"</span>, <span class="hljs-string">"4c8c6b2e-c54f-4df5-8bbb-a5e59df85aaa"</span>);
                <span class="hljs-comment">//</span>
                StreamReader reader = <span class="hljs-keyword">new</span> StreamReader(httpWebRequest.GetResponse().GetResponseStream());<font></font>
                JArray jArr = (JArray)JsonConvert.DeserializeObject(reader.ReadToEnd());<font></font>
                <span class="hljs-comment">//Parse data</span>
                Dictionary&lt;<span class="hljs-keyword">long</span>, <span class="hljs-keyword">string</span>&gt; dicSensorLED = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">long</span>, <span class="hljs-keyword">string</span>&gt;();<font></font>
                Dictionary&lt;<span class="hljs-keyword">long</span>, <span class="hljs-keyword">string</span>&gt; dicSensorRelay = <span class="hljs-keyword">new</span> Dictionary&lt;<span class="hljs-keyword">long</span>, <span class="hljs-keyword">string</span>&gt;();
                <span class="hljs-keyword">long</span> longTicks;
                <span class="hljs-keyword">foreach</span> (JObject item <span class="hljs-keyword">in</span> jArr)<font></font>
                {<font></font>
                    longTicks = DateTime.Parse((<span class="hljs-keyword">string</span>)item[<span class="hljs-string">"created"</span>]).Ticks;
                    <span class="hljs-keyword">if</span> ((<span class="hljs-keyword">string</span>)item[<span class="hljs-string">"command"</span>] == <span class="hljs-string">"LED.v1.0"</span>)<font></font>
                    {<font></font>
                        <span class="hljs-keyword">if</span> (!dicSensorLED.ContainsKey(longTicks)) dicSensorLED.Add(longTicks, (<span class="hljs-keyword">string</span>)item[<span class="hljs-string">"params"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"value"</span>]);<font></font>
                    }<font></font>
                    <span class="hljs-keyword">else</span><font></font>
                    {<font></font>
                        <span class="hljs-keyword">if</span> (!dicSensorRelay.ContainsKey(longTicks)) dicSensorRelay.Add(longTicks, (<span class="hljs-keyword">string</span>)item[<span class="hljs-string">"params"</span>][<span class="hljs-number">0</span>][<span class="hljs-string">"value"</span>]);<font></font>
                    }<font></font>
                }<font></font>
                <span class="hljs-comment">//find last value</span>
                <span class="hljs-keyword">string</span> strValueLED = dicSensorLED[dicSensorLED.Max(x =&gt; x.Key)];
                <span class="hljs-keyword">string</span> strValueRelay = dicSensorRelay[dicSensorRelay.Max(x =&gt; x.Key)];
                <span class="hljs-comment">//</span>
                <span class="hljs-keyword">if</span> (strValueLED == <span class="hljs-string">"0"</span>) boolValueLED = <span class="hljs-literal">false</span>; <span class="hljs-keyword">else</span> boolValueLED = <span class="hljs-literal">true</span>;
                <span class="hljs-keyword">if</span> (strValueRelay == <span class="hljs-string">"0"</span>) boolValueRelay = <span class="hljs-literal">false</span>; <span class="hljs-keyword">else</span> boolValueRelay = <span class="hljs-literal">true</span>;<font></font>
                }<font></font>
<font></font>
            <span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">SetSateActuation</span>(<span class="hljs-params"><span class="hljs-keyword">string</span> strToken, <span class="hljs-keyword">string</span> strCommand</span>)</span><font></font>
            {<font></font>
                <span class="hljs-comment">//  Actuation</span>
                <span class="hljs-comment">//https://github.com/enableiot/iotkit-api/wiki/Control-Device-API</span>
                <span class="hljs-comment">// </span>
                <span class="hljs-keyword">string</span> strComponentId, strName, strValue, strComplexCommands;
                <span class="hljs-keyword">switch</span> (strCommand)<font></font>
                {<font></font>
                    <span class="hljs-keyword">case</span> <span class="hljs-string">"led_on"</span>:<font></font>
                        {<font></font>
                            strComponentId=<span class="hljs-string">"64dbdbee-e181-403f-8b51-0872e11a289e"</span>;<font></font>
                            strName=<span class="hljs-string">"LED"</span>;<font></font>
                            strValue = <span class="hljs-string">"1"</span>;<font></font>
                            strComplexCommands = <span class="hljs-string">"led1_ON"</span>;
                            <span class="hljs-keyword">break</span>;<font></font>
                        }<font></font>
                    <span class="hljs-keyword">case</span> <span class="hljs-string">"led_off"</span>:<font></font>
                        {<font></font>
                            strComponentId = <span class="hljs-string">"64dbdbee-e181-403f-8b51-0872e11a289e"</span>;<font></font>
                            strName = <span class="hljs-string">"LED"</span>;<font></font>
                            strValue = <span class="hljs-string">"0"</span>;<font></font>
                            strComplexCommands = <span class="hljs-string">"led1_OFF"</span>;
                            <span class="hljs-keyword">break</span>;<font></font>
                        }<font></font>
                    <span class="hljs-keyword">case</span> <span class="hljs-string">"relay_on"</span>:<font></font>
                        {<font></font>
                            strComponentId = <span class="hljs-string">"5f72e39a-463a-4e57-bac7-9b32debfd865"</span>;<font></font>
                            strName = <span class="hljs-string">"RELAY"</span>;<font></font>
                            strValue = <span class="hljs-string">"1"</span>;<font></font>
                            strComplexCommands = <span class="hljs-string">"relay1_ON"</span>;
                            <span class="hljs-keyword">break</span>;<font></font>
                        }<font></font>
                    <span class="hljs-keyword">case</span> <span class="hljs-string">"relay_off"</span>:<font></font>
                        {<font></font>
                            strComponentId = <span class="hljs-string">"5f72e39a-463a-4e57-bac7-9b32debfd865"</span>;<font></font>
                            strName = <span class="hljs-string">"RELAY"</span>;<font></font>
                            strValue = <span class="hljs-string">"0"</span>;<font></font>
                            strComplexCommands = <span class="hljs-string">"relay1_OFF"</span>;
                            <span class="hljs-keyword">break</span>;<font></font>
                        }<font></font>
                    <span class="hljs-keyword">default</span>:
                        <span class="hljs-comment">// You can use the default case.</span>
                        <span class="hljs-keyword">return</span>;<font></font>
                }<font></font>
                <span class="hljs-comment">// JSON</span>
                <span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span><font></font>
                {<font></font>
                    commands = <span class="hljs-keyword">new</span>[] { <span class="hljs-keyword">new</span> {<font></font>
                    componentId = strComponentId,<font></font>
                    parameters= <span class="hljs-keyword">new</span>[] { <span class="hljs-keyword">new</span><font></font>
                                        {<font></font>
                                            name=strName,<font></font>
                                            <span class="hljs-keyword">value</span>=strValue<font></font>
                                        }<font></font>
                    },<font></font>
                    transport=<span class="hljs-string">"ws"</span><font></font>
                }<font></font>
                },<font></font>
                    complexCommands = <span class="hljs-keyword">new</span>[] { strComplexCommands }<font></font>
                };<font></font>
                <span class="hljs-keyword">string</span> postData = JsonConvert.SerializeObject(obj, Formatting.Indented);
                <span class="hljs-comment">//HttpWebRequest</span>
                HttpWebRequest httpWebRequest = (HttpWebRequest)HttpWebRequest.Create(<span class="hljs-string">"https://dashboard.us.enableiot.com/v1/api/accounts/4c8c6b2e-c54f-4df5-8bbb-a5e59df85aaa/control"</span>);<font></font>
                httpWebRequest.Method = <span class="hljs-string">"POST"</span>;<font></font>
                httpWebRequest.ContentType = <span class="hljs-string">"application/json"</span>;
                <span class="hljs-comment">//Headers</span>
                httpWebRequest.Headers.Add(<span class="hljs-string">"Authorization"</span>, <span class="hljs-string">"Bearer "</span> + strToken);<font></font>
                httpWebRequest.Headers.Add(<span class="hljs-string">"accountId"</span>, <span class="hljs-string">"4c8c6b2e-c54f-4df5-8bbb-a5e59df85aaa"</span>);
                <span class="hljs-comment">//</span>
                <span class="hljs-keyword">byte</span>[] byte1 = System.Text.Encoding.UTF8.GetBytes(postData);<font></font>
                httpWebRequest.ContentLength = byte1.Length;<font></font>
                httpWebRequest.GetRequestStream().Write(byte1, <span class="hljs-number">0</span>, byte1.Length);<font></font>
                httpWebRequest.GetRequestStream().Close();<font></font>
                <span class="hljs-comment">//</span><font></font>
                httpWebRequest.GetResponse();<font></font>
                }<font></font>
            }<font></font>
        }<font></font>
<font></font>
        &lt;html&gt;<font></font>
        &lt;head&gt;<font></font>
            &lt;title&gt; RESTful   Intel IoT Analytics  ASP.NET Razor&lt;/title&gt;<font></font>
        &lt;/head&gt;<font></font>
        &lt;body&gt;<font></font>
            &lt;h1&gt; RESTful   Intel IoT Analytics  ASP.NET Razor&lt;/h1&gt;<font></font>
&lt;p&gt;: @DateTime.Now.ToString()&lt;/p&gt;<font></font>
    &lt;p&gt;   &lt;a href=<span class="hljs-string">"https://github.com/enableiot/iotkit-api/wiki/Api-Home"</span>&gt;api  intel iot analytics.&lt;/a&gt;&lt;/p&gt;<font></font>
    &lt;p&gt;  API :&lt;/p&gt;<font></font>
    &lt;ol&gt;<font></font>
        &lt;li&gt;,  &lt;/li&gt;<font></font>
        &lt;li&gt;   (sensor)&lt;/li&gt;<font></font>
        &lt;li&gt;   (Actuation)&lt;/li&gt;<font></font>
    &lt;/ol&gt;<font></font>
    &lt;h3&gt; &lt;/h3&gt;<font></font>
    &lt;p&gt;: @dicSensors[<span class="hljs-string">"temperature"</span>] *&lt;/p&gt;<font></font>
    &lt;p&gt;: @dicSensors[<span class="hljs-string">"pressure"</span>] &lt;/p&gt;<font></font>
     @if (boolValueLED==<span class="hljs-literal">false</span>)<font></font>
        {<font></font>
            &lt;p&gt;LED: OFF&lt;/p&gt;<font></font>
        }<font></font>
     <span class="hljs-keyword">else</span><font></font>
     {<font></font>
        &lt;p&gt;LED: ON&lt;/p&gt;<font></font>
     }<font></font>
<font></font>
    @if (boolValueRelay == <span class="hljs-literal">false</span>)<font></font>
    {<font></font>
        &lt;p&gt;: OFF&lt;/p&gt;<font></font>
    }<font></font>
    <span class="hljs-keyword">else</span><font></font>
    {<font></font>
        &lt;p&gt;: ON&lt;/p&gt;<font></font>
    }<font></font>
    &lt;form name=<span class="hljs-string">"formaction"</span> action=<span class="hljs-string">"~/index.cshtml"</span> method=<span class="hljs-string">"get"</span>&gt;<font></font>
        &lt;h3&gt; Actuation&lt;/h3&gt;<font></font>
        &lt;p&gt; LED: <font></font>
            &lt;button name=<span class="hljs-string">"command"</span> type=<span class="hljs-string">"submit"</span> <span class="hljs-keyword">value</span>=<span class="hljs-string">"led_on"</span>&gt; ON &lt;/button&gt;<font></font>
            &lt;button name=<span class="hljs-string">"command"</span> type=<span class="hljs-string">"submit"</span> <span class="hljs-keyword">value</span>=<span class="hljs-string">"led_off"</span>&gt; OFF &lt;/button&gt;<font></font>
        &lt;/p&gt;<font></font>
        &lt;p&gt; : <font></font>
            &lt;button name=<span class="hljs-string">"command"</span> type=<span class="hljs-string">"submit"</span> <span class="hljs-keyword">value</span>=<span class="hljs-string">"relay_on"</span>&gt; ON &lt;/button&gt;<font></font>
            &lt;button name=<span class="hljs-string">"command"</span> type=<span class="hljs-string">"submit"</span> <span class="hljs-keyword">value</span>=<span class="hljs-string">"relay_off"</span>&gt; OFF &lt;/button&gt;<font></font>
        &lt;/p&gt;<font></font>
        &lt;p&gt;&lt;/p&gt;<font></font>
        &lt;p&gt;<font></font>
            &lt;button name=<span class="hljs-string">"update"</span> type=<span class="hljs-string">"submit"</span>&gt;   &lt;/button&gt;<font></font>
        &lt;/p&gt;<font></font>
    &lt;/form&gt;<font></font>
&lt;/body&gt;<font></font>
&lt;/html&gt;<font></font>
</code></pre><br>
</div></div><br>
<b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√çndice</font></font></b><br>
<ol>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Edison </font><font style="vertical-align: inherit;">Primeiro come√ßo</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Edison </font><font style="vertical-align: inherit;">Trabalhando com a nuvem Intel IoT Analytics: registrando e enviando dados</font></font></a></li>
<li><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Edison </font><font style="vertical-align: inherit;">Trabalhar com a nuvem Intel IoT Analytics: criar regras e enviar notifica√ß√µes</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intel Edison </font><font style="vertical-align: inherit;">Nuvem Intel IoT Analytics: enviando SMS e cliente RESTful no ASP.NET</font></font></li>
</ol></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt384929/">https://habr.com/ru/post/pt384929/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt384915/index.html">Publica√ß√£o e Reda√ß√£o</a></li>
<li><a href="../pt384917/index.html">Emulador de bomba de Turing em Raspberry Pi e Arduino</a></li>
<li><a href="../pt384921/index.html">21 raz√µes pelas quais a Xiaomi n√£o √© apenas uma fabricante de smartphones</a></li>
<li><a href="../pt384923/index.html">Paul Graham: Sociedade de alta tecnologia</a></li>
<li><a href="../pt384925/index.html">Acorde confortavelmente - fa√ßa um alarme luminoso fa√ßa voc√™ mesmo</a></li>
<li><a href="../pt384933/index.html">M√≥dulos de r√°dio para arduino JDY-40</a></li>
<li><a href="../pt384937/index.html">Qual √© o perigo da Internet, e vale a pena criar?</a></li>
<li><a href="../pt384941/index.html">O "Canyon" em Charon, um sat√©lite de Plut√£o, √© uma gigantesca quebra de crosta</a></li>
<li><a href="../pt384949/index.html">Roupa interior inteligente: quem e por que faz uma "eletr√¥nica" √≠ntima e vest√≠vel</a></li>
<li><a href="../pt384951/index.html">¬´–°–ø–∏, –º–æ—è —Ä–∞–¥–æ—Å—Ç—å, —É—Å–Ω–∏...¬ª –∏–ª–∏ —á–µ–º –æ–ø–∞—Å–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–Ω–æ–º</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>