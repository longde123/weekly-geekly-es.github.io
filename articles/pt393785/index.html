<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíü üé• üéá Chaleira WiFi em casa, ou como fazer uma chaleira comum realmente inteligente ü¶ã üì¶ ü§≤üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pref√°cio
 
 Se voc√™ leu meu artigo anterior ( Running line on Arduino ), provavelmente j√° sabe que temos a oportunidade de fazer projetos de cursos de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Chaleira WiFi em casa, ou como fazer uma chaleira comum realmente inteligente</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/393785/"><img src="https://habrastorage.org/files/13e/789/ac5/13e789ac5ab64c99bb2243540c6188bc.jpg" alt="imagem"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Pref√°cio</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Se voc√™ leu meu artigo anterior ( </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Running line on Arduino</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), provavelmente j√° sabe que temos a oportunidade de fazer projetos de cursos de hardware em nossa universidade. </font><font style="vertical-align: inherit;">E eu, inspirado no meu trabalho anterior, decidi tentar novamente fazer algo com minhas pr√≥prias m√£os. </font><font style="vertical-align: inherit;">S√≥ agora o t√≥pico deveria ter sido mais s√©rio. </font><font style="vertical-align: inherit;">A prop√≥sito, comecei a pensar no que fazer durante as f√©rias de inverno, ou seja, antes do semestre. </font><font style="vertical-align: inherit;">Eu queria fazer algo interessante e √∫til ao mesmo tempo.</font></font><br>
<br>
<a name="habracut"></a><br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Procure uma ideia</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Certa vez, em um par sobre os Fundamentos da prote√ß√£o de informa√ß√µes, tivemos um t√≥pico relacionado √† propriedade intelectual e patentes. O professor nos deu a tarefa de emitir uma patente para qualquer dispositivo de acordo com todos os requisitos e citou uma chaleira wifi como exemplo. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ele disse - e esqueceu. E todo mundo esqueceu, mas na minha cabe√ßa esse t√≥pico permaneceu. E quando chegou a hora de pensar no que fazer como curso no pr√≥ximo semestre, lembrei-me desse bule de ch√°. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A primeira coisa que decidi ver √© o que j√° foi feito. E qual foi a minha surpresa quando vi que existem apenas tr√™s modelos de manequins com suporte a controle WiFi √† venda e dois deles pertencem √† mesma empresa. Estes eram o Smarter iKettle 1.0 e 2.0 e o Russian Polaris PWK 1792CGL.</font></font><br>
<br>
<img src="https://psv4.vk.me/c615220/u9412861/docs/0ad68e7b3b82/imgonline-com-ua-twotoonefP6QyHRwpyGH.jpg?extra=DYIN0iLJbtamO0yymkG01568IjGjd-b5TPTlrxOGOg9GKUkRFG9qAbzX7whoNtLphkadbiiUq9AIz1X7jxfJ5trWX89OM_uDNpnwCw7j1tyXwPGFSsnL" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â interessante que quase todas as casas possuam chaleiras el√©tricas comuns, e h√° t√£o poucas que s√£o inteligentes. </font><font style="vertical-align: inherit;">Comparando os recursos oferecidos pelo iKettle e Polaris, fiz uma lista dos mais necess√°rios. </font><font style="vertical-align: inherit;">Aqui est√° o que aconteceu:</font></font><br>
<br>
<ol>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ligar / desligar de um smartphone;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definir qualquer temperatura para aquecer a √°gua;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a capacidade de descobrir a temperatura atual;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rastrear o volume atual de √°gua na chaleira;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aviso e prote√ß√£o contra ligar com um pequeno volume de √°gua;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">definir hora de ativa√ß√£o autom√°tica;</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aviso de prontid√£o;</font></font></li>
</ol><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Parece real, √© hora de come√ßar a trabalhar.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Procure os componentes necess√°rios</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como n√£o era poss√≠vel fazer uma chaleira completamente nova, foi decidido modificar uma chaleira el√©trica comum j√° pronta. Em casa, havia uma chaleira √≥rf√£ com um interruptor quebrado. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o, a funda√ß√£o j√° est√° l√°, pensei. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora eu tive que come√ßar a procurar componentes para o hardware. Como j√° havia pouca experi√™ncia trabalhando com o Arduino, decidi implementar tudo nele. Al√©m disso, o pr√≥prio Arduin e seus m√≥dulos s√£o baratos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Desde que eu tive que inserir toda a parte do controle da chaleira dentro dela, a escolha recaiu sobre o Arduino Nano. √â pequeno e possui uma interface para conectar um cabo, ao contr√°rio do Pro Mini, que deve ser atualizado via UART.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/bd1/d8a/273/bd1d8a273b5189fb42cdd0834246dbc4.jpg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
O principal componente de uma chaleira wifi √©, obviamente, um m√≥dulo wifi. Pesquisando na Internet por algo acess√≠vel e muitos tutoriais, encontramos o ESP8266. Ou seja, na vers√£o 01. Eu parecia barato (cerca de US $ 2) e havia muitas instru√ß√µes para conex√£o. Parou com isso. Quanto ao pr√≥prio m√≥dulo, a frase aqui √© boa: barata e alegre. Mas mais sobre isso mais tarde. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/a39/db0/0e5/a39db00e5e05bc51f4c727c9b75ee18a.jpg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Para controlar a temperatura, precis√°vamos de algum tipo de sensor de temperatura √† prova d'√°gua. Encontrei um termistor NTC √† prova d'√°gua no aliexpress, que pode suportar temperaturas de mais de 100 graus. Tamb√©m encontrei um exemplo de trabalho com ele, ent√£o aqui decidi rapidamente.</font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/205/649/1b9/2056491b9c4e3906446017711d069826.jpg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Era necess√°rio decidir como ligar a chaleira em um determinado momento, √© claro, voc√™ poderia fazer o rel√≥gio do programa no Arduino e ligar a chaleira quando a hora coincidisse, mas isso funcionaria de maneira inst√°vel e, se o programa fosse reiniciado acidentalmente, tudo daria errado. Portanto, um rel√≥gio em tempo real veio em socorro aqui. Ou seja, DS1307. Eles t√™m energia independente (de uma bateria de 3 V) e tamb√©m havia um chip de mem√≥ria EEPROM de 32K bits no m√≥dulo em que eu estava parando, que eu economizava pontualmente. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/f8b/6d4/3e1/f8b6d43e1e1ddcf1ab573ad49bec80f3.jpg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ah, sim, como a chaleira agora deve ligar programaticamente, tamb√©m precisava de um rel√© de 1 canal. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/be1/f74/46d/be1f7446d29e3cdcc3a226860e31d01d.jpg" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quanto ao sensor de n√≠vel de l√≠quido, ele tinha que ser feito manualmente. Detalhes abaixo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do resto, ainda eram necess√°rios v√°rios resistores de diferentes denomina√ß√µes, uma placa de ensaio para testes, uma placa de circuito para a instala√ß√£o real, fia√ß√£o, um ferro de solda com fluxo e solda e a maior parte da paci√™ncia.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In√≠cio do desenvolvimento</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como o projeto √© uma chaleira wifi, a primeira coisa que eu queria e precisava para lidar com o m√≥dulo wifi. </font><font style="vertical-align: inherit;">Assim que o pacote chegou, eu imediatamente o desempacotei e comecei a conectar. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Encontrei v√°rios exemplos na Internet. </font><font style="vertical-align: inherit;">Tudo est√° como deveria, regulador de tens√£o de 3,3 V, divisores de tens√£o para RX e TX. </font><font style="vertical-align: inherit;">Coletei tudo pelo exemplo, conectei - ele n√£o voou! </font><font style="vertical-align: inherit;">Um monte de texto foi exibido no monitor da porta COM, como se viu, o m√≥dulo era constantemente redefinido. </font><font style="vertical-align: inherit;">Ele n√£o responde aos comandos AT enviados. </font><font style="vertical-align: inherit;">O autor do artigo trabalha, eu n√£o.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Qual √© o problema? Tentei procurar outros esquemas de conex√£o, etc., mas o m√≥dulo ainda √© redefinido ou n√£o exibe nada. E em todos os lugares est√° escrito em fonte vermelha: "N√£o se aplica ao m√≥dulo de 5 V, caso contr√°rio, ele falhar√°." Assim, √†s vezes, a busca por solu√ß√µes durava √† noite, eu j√° estava pensando em comprar outro m√≥dulo, mas decidi verificar a tens√£o com um mult√≠metro. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Verificou-se que, quando o m√≥dulo est√° conectado a 3,3 V, a tens√£o cai abaixo de 3,2 V. Parece que, bem, tudo bem, cai e cai. Decidi aliment√°-lo de outra fonte de alimenta√ß√£o e verificou-se que o m√≥dulo est√° funcionando normalmente com uma tens√£o acima de 3,2 V, e abaixo dele n√£o √© suficiente e √© constantemente redefinido. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, por minha pr√≥pria conta e risco, conectei-o a 5 V e tudo funcionou e ainda funciona bem. </font></font><br>
<br>
<img src="https://habrastorage.org/files/d5d/17e/780/d5d17e7804c34c46a595c059100295e1.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
N√£o houve problemas com outros componentes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois que descobri o wifi, tive que decidir o que fazer com o sensor de n√≠vel de l√≠quido. Pesquisando, encontrei um artigo no qual o autor fez um sensor de umidade do solo. Quando o solo seca, a resist√™ncia do sensor aumenta e a tens√£o na porta anal√≥gica do Arduino aumenta. Ao detectar uma mudan√ßa na voltagem, a apar√™ncia de um l√≠quido pode ser detectada. Em vez de dois contatos, 6 foi usado para determinar o n√≠vel de l√≠quido em meu projeto: um deles est√° conectado √† sa√≠da de 5 V e o restante √†s entradas anal√≥gicas e resistores de 10 kŒ© ao GND. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√£o fotos dos testes. </font></font><br>
<br>
<img src="https://habrastorage.org/files/43c/536/5fd/43c5365fd8464326bf5b4eee5bfbe806.jpg"><br>
<img src="https://habrastorage.org/files/c99/d28/fee/c99d28fee740489a9b3893e4f9fdd418.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√° o que sensor de n√≠vel √© o resultado.</font></font><br>
<br>
<img src="https://habrastorage.org/files/b1e/2bb/10d/b1e2bb10db5f4e7ea647a746bc7e039c.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A pr√≥xima coisa que testei √© o rel√≥gio em tempo real. </font><font style="vertical-align: inherit;">Mas trabalhar com eles √© basicamente simples. </font><font style="vertical-align: inherit;">Para definir o tempo e obter informa√ß√µes, usei exclusivamente exemplos que acompanham a biblioteca para trabalhar com o DS1307. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, quando tudo foi montado em uma t√°bua de p√£o, conseguimos um cruzamento entre fios e m√≥dulos. </font><font style="vertical-align: inherit;">A prop√≥sito, nessas fotos h√° outro sensor de temperatura.</font></font><br>
<br>
<img src="https://habrastorage.org/files/2f9/74d/288/2f974d288e8b43b0ab3612641a985f0e.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Introdu√ß√£o</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Agora tudo isso tinha que ser soldado na placa de circuito. </font><font style="vertical-align: inherit;">N√£o h√° nada de especial para comentar, apenas uma foto. </font><font style="vertical-align: inherit;">Como voc√™ pode ver, outro bot√£o foi adicionado para que voc√™ possa ligar a chaleira n√£o apenas a partir de um smartphone, mas tamb√©m da maneira usual. </font></font><br>
<br>
<img src="https://habrastorage.org/files/98a/ad1/920/98aad19203204e46a644e52c9f905af0.jpg"><br>
<img src="https://habrastorage.org/files/995/592/45e/99559245edb048699172208c2584b689.jpg"><br>
<img src="https://habrastorage.org/files/2dd/594/23c/2dd59423cb0a447295593b52da781dd5.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, voc√™ precisa colocar tudo dentro da chaleira. </font></font><br>
<br>
<img src="https://habrastorage.org/files/9cb/50e/bf8/9cb50ebf8d05486babe76682ce68fddf.jpg"><br>
<img src="https://habrastorage.org/files/39d/b11/53b/39db1153b86c4592862b1b2f66531252.jpg"><br>
<img src="https://habrastorage.org/files/605/7db/1e6/6057db1e6ead493c81d399e164b399d4.jpg"><br>
<img src="https://habrastorage.org/files/853/6fc/00e/8536fc00ead6460ab5e581029bbdaf64.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Uma inser√ß√£o de amianto foi adicionada para proteger todo o interior do superaquecimento. </font></font><br>
<br>
<img src="https://habrastorage.org/files/027/99a/f36/02799af362264b6682b3355bae815b9c.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√â verdade que a caixa teve que ser levemente levantada com uma inser√ß√£o pl√°stica adicional.</font></font><br>
<br>
<img src="https://habrastorage.org/files/ec3/06e/ab8/ec306eab83114666a94c62b33f9ce6f2.jpg"><br>
<img src="https://habrastorage.org/files/836/47b/9ac/83647b9ac23a43c7bd39ec57c4b2807c.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Agora v√° para a parte m√≥vel.</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quanto ao aplicativo, como foi desenvolvido no sistema operacional Android, foi originalmente planejado o uso do Android Studio. Mas, para estudar novas tecnologias, decidiu-se usar uma plataforma pronta para o desenvolvimento de programas no campo da Internet das coisas. Como resultado, a escolha recaiu sobre o produto Evothings - Evothings Studio. </font></font><br>
<br>
<img src="https://habrastorage.org/getpro/geektimes/post_images/74f/e14/7b1/74fe147b1a99d6a7fd6dd0b6a01ac2a2.png" alt="imagem"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aqui est√£o suas principais vantagens: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Um grande n√∫mero de exemplos padr√£o no trabalho com v√°rios m√≥dulos (Wifi, Bluetooth); </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - desenvolvimento de aplicativos usando JS, HTML, CSS, que permite escrever um c√≥digo que funcione igualmente no Android e iOS, ou seja, a liga√ß√£o a apenas uma plataforma desaparece;</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - facilidade de teste do aplicativo: um aplicativo √© instalado no smartphone para visualizar seu desenvolvimento e todas as mensagens de teste e mensagens de erro s√£o exibidas no programa no computador; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - Uma grande quantidade de informa√ß√µes na Internet sobre desenvolvimento usando JS, HTML, CSS; </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Neste Evothings Studio, havia um exemplo de ativa√ß√£o do LED transmitindo uma solicita√ß√£o de ativa√ß√£o atrav√©s do ESP8266. Decidi tomar este exemplo como base, porque havia a coisa mais valiosa para mim - a comunica√ß√£o com o m√≥dulo WiFi via soquete TCP. E, de maneira semelhante √† forma como a solicita√ß√£o de ativa√ß√£o do LED foi transmitida, solicitei a atualiza√ß√£o dos sensores da chaleira, para definir o hor√°rio, a temperatura, etc.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ent√£o eu estraguei as notifica√ß√µes de prontid√£o e uma pequena quantidade de √°gua, o benef√≠cio √© que tudo em nosso tempo √© facilmente pesquisado. </font><font style="vertical-align: inherit;">O resultado √© uma aplica√ß√£o desse tipo (uma coisa boa √© fazer a interface do aplicativo usando CSS):</font></font><br>
<br>
<img src="https://habrastorage.org/files/0b9/985/b2d/0b9985b2d0fb4c97bb36d4ebeb772ab6.jpg"><br>
<img src="https://habrastorage.org/files/431/aaa/445/431aaa44557d42de996527f587d8691f.jpg"><br>
<img src="https://habrastorage.org/files/e3a/f8d/fb1/e3af8dfb13764be2b2b9e9acbad28769.jpg"><br>
<img src="https://habrastorage.org/files/9c0/db4/c6e/9c0db4c6e1b44b0f86f725b5e75a265a.jpg"><br>
<img src="https://habrastorage.org/files/80a/7ff/90f/80a7ff90f43b46e197fdfc3594297e1a.jpg"><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uma breve descri√ß√£o da intera√ß√£o do smartphone e da chaleira</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A comunica√ß√£o entre o servidor e o cliente √© realizada usando o m√≥dulo WiFi. Quando voc√™ liga o m√≥dulo de controle da chaleira, o m√≥dulo WiFi come√ßa a distribuir uma rede chamada artKettle. Isso √© feito usando os comandos AT no lado do servidor. Portanto, por exemplo, para colocar o m√≥dulo no modo de ponto de acesso, ele precisa enviar o comando AT + CWMODE = 2. Em seguida, usando esses comandos, voc√™ precisa atribuir par√¢metros de rede, permitir a conex√£o de v√°rios dispositivos e obter o endere√ßo IP do pr√≥prio wifi. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Do lado do cliente, a conex√£o √© feita atrav√©s de uma porta espec√≠fica e pelo endere√ßo IP do m√≥dulo wifi usando chrome.tcp.socket. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois de conectar o cliente ao servidor, voc√™ pode controlar a chaleira do seu smartphone. Considere o exemplo de ligar a chaleira.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Quando voc√™ clica no bot√£o liga / desliga no aplicativo artKettle, a fun√ß√£o correspondente da inclus√£o de app.kettleOn () √© chamada. </font><font style="vertical-align: inherit;">Dentro desta fun√ß√£o, duas linhas s√£o transferidas para o lado do servidor:</font></font><br>
<br>
<pre><code class="cpp hljs">app.sendString(<span class="hljs-string"><span class="hljs-string">'H'</span></span>);<font></font>
app.sendString(<span class="hljs-string"><span class="hljs-string">'U'</span></span>);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A seguir, o trabalho j√° est√° do lado do Arduino. </font><font style="vertical-align: inherit;">Depois que a primeira linha chega com o caractere 'H', o seguinte c√≥digo √© executado:</font></font><br>
<pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(message.indexOf(<span class="hljs-string"><span class="hljs-string">"H"</span></span>) &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; waterDetected())  {<font></font>
      digitalWrite(POWER_PIN, LOW); <font></font>
      IS_ON = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
      Serial.println(<span class="hljs-string"><span class="hljs-string">"ON"</span></span>);<font></font>
      sendCIPData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"ON"</span></span>); <font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primeiro, ele verifica se h√° √°gua na chaleira chamando o m√©todo waterDetected (). </font><font style="vertical-align: inherit;">Considere a op√ß√£o quando houver √°gua na chaleira. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um n√≠vel de baixa tens√£o √© aplicado ao pino de controle do rel√©, que corresponde √† sua inclus√£o, ou seja, </font><font style="vertical-align: inherit;">circuito de energia fecha:</font></font><br>
<pre><code class="cpp hljs">digitalWrite(POWER_PIN, LOW); 
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Em seguida, o sinalizador √© definido para indicar que a chaleira est√° ligada e uma mensagem na sa√≠da para o monitor da porta serial √© exibida. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, √© chamada uma fun√ß√£o que transmite uma mensagem de resposta ao lado do cliente de que toda a inclus√£o foi bem-sucedida:</font></font><br>
<br>
<pre><code class="cpp hljs">sendCIPData(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"ON"</span></span>);
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
No lado do cliente, ap√≥s verificar a mensagem recebida, o bot√£o liga / desliga est√° definido no estado Ativado:</font></font><br>
<pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buf.substr(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) == <span class="hljs-string"><span class="hljs-string">"ON"</span></span>) {<font></font>
	app.setButtonOn();<font></font>
}<font></font>
</code></pre><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Depois disso, a mensagem de texto √© processada com o caractere 'U' enviado do cliente para o servidor. </font><font style="vertical-align: inherit;">Aqui, de maneira semelhante √† inclus√£o, s√£o atualizadas informa√ß√µes sobre a temperatura atual e o volume de l√≠quido na chaleira. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Assim, a comunica√ß√£o bidirecional entre o cliente e o servidor √© organizada, para que um deles saiba sobre o estado do outro a qualquer momento.</font></font><br>
<br>
<h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o</font></font></h2><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado do projeto do curso, foi desenvolvida uma modifica√ß√£o para uma chaleira el√©trica convencional, que permite control√°-la a partir de um smartphone via wifi. Agora, este bule pode ser atribu√≠do aos representantes da Internet das coisas. Conseguimos implementar totalmente todas as fun√ß√µes; agora, esta chaleira possui os seguintes recursos: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - ligar / desligar a partir de um smartphone; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - definir qualquer temperatura para aquecer a √°gua; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - a capacidade de descobrir a temperatura atual; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - rastrear o volume atual de √°gua na chaleira; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - aviso e prote√ß√£o contra ligar com um pequeno volume de √°gua; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - definir a hora de ligar; </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - notifica√ß√£o de prontid√£o;</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
As vantagens do projeto implementado s√£o a acessibilidade da base de elementos, porque tudo o que voc√™ precisa pode ser encontrado nas lojas de componentes eletr√¥nicos, a extensibilidade do projeto. Como a chaleira possui todos os sensores necess√°rios instalados, ela pode ser modificada de forma program√°tica e n√£o piorada do que os an√°logos. Dada a versatilidade do m√≥dulo wifi usado, voc√™ pode conect√°-lo √† Internet e organizar o controle da chaleira, estando em qualquer lugar do mundo e, usando o servi√ßo on-line para o processamento de mensagens SMS, voc√™ pode organizar a inclus√£o por SMS. I.e. o projeto ainda √© muito expans√≠vel, h√° oportunidades para isso, mas eles n√£o foram implementados, pois n√£o faziam parte dos objetivos do projeto em desenvolvimento.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Obviamente, existem desvantagens no projeto. </font><font style="vertical-align: inherit;">O primeiro √© a opera√ß√£o inst√°vel do m√≥dulo Wifi. </font><font style="vertical-align: inherit;">√Äs vezes, um m√≥dulo perde sua rede, come√ßa a redefinir as configura√ß√µes ou simplesmente n√£o processa os sinais recebidos. </font><font style="vertical-align: inherit;">Al√©m disso, esses s√£o problemas populares entre os usu√°rios deste m√≥dulo. </font><font style="vertical-align: inherit;">A segunda desvantagem √© a falta de desligamento mec√¢nico da chaleira. </font><font style="vertical-align: inherit;">O desligamento √© implementado no software; quando o ponto de ebuli√ß√£o √© atingido, o circuito √© interrompido com a ajuda de um rel√©. </font><font style="vertical-align: inherit;">Se o programa travar repentinamente, a chaleira pode n√£o desligar. </font><font style="vertical-align: inherit;">A terceira desvantagem √© o problema de monitorar a temperatura de aquecimento. </font><font style="vertical-align: inherit;">Por exemplo, se voc√™ desligar a chaleira a uma temperatura de 60 graus, o aquecimento dez continuar√° emitindo calor e, depois de um tempo, a temperatura da √°gua j√° estar√° em cerca de 70 graus. </font><font style="vertical-align: inherit;">Mas isso √© corrigido fazendo ajustes no programa.</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt393785/">https://habr.com/ru/post/pt393785/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt393775/index.html">Golfinhos descobriram os rudimentos da comunica√ß√£o lingu√≠stica</a></li>
<li><a href="../pt393777/index.html">Passagem de Merc√∫rio no Sol - foto e v√≠deo</a></li>
<li><a href="../pt393779/index.html">Emirados √Årabes Unidos planeja criar montanhas artificiais para aumentar as chuvas</a></li>
<li><a href="../pt393781/index.html">Cientistas do NUST "MISiS" provaram o fracasso da teoria cl√°ssica da estrutura da Terra</a></li>
<li><a href="../pt393783/index.html">A base dos eclipses solar e lunar de -1999 a +3000 anos</a></li>
<li><a href="../pt393787/index.html">Como reparar reatores nucleares</a></li>
<li><a href="../pt393791/index.html">Cidade su√≠√ßa autorizada a pagar contas de servi√ßos p√∫blicos em bitcoins</a></li>
<li><a href="../pt393795/index.html">Devido ao aquecimento global, partes do Oriente M√©dio e Norte da √Åfrica se tornar√£o inabit√°veis</a></li>
<li><a href="../pt393797/index.html">As encomendas para o console de jogos Pyra come√ßaram</a></li>
<li><a href="../pt393799/index.html">Usando o Amazon Echo, o propriet√°rio da Tesla mostrou como √© f√°cil conseguir um carro para sair da garagem.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>