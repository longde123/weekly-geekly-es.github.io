<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤢 😪 🧗 我们需要一个数据湖吗？ 如何处理数据仓库？ 📘 🚵🏿 🥓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文是我在“媒介-Data Lake入门 ”上的文章的翻译，结果证明它很受欢迎，可能是因为它很简单。 因此，我决定用俄语编写它，并对它进行一些补充，以便不是数据专家的简单人可以理解什么是数据仓库（DW），什么是数据湖以及他们如何相处。 。 

 我为什么要写一个数据湖？ 我从事数据和分析工作已超过1...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>我们需要一个数据湖吗？ 如何处理数据仓库？</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/485180/">本文是我在“媒介<a href="https://medium.com/rock-your-data/getting-started-with-data-lake-4bb13643f9" rel="nofollow">-Data Lake入门</a> ”上的文章的翻译，结果证明它很受欢迎，可能是因为它很简单。 因此，我决定用俄语编写它，并对它进行一些补充，以便不是数据专家的简单人可以理解什么是数据仓库（DW），什么是数据湖以及他们如何相处。 。 <br><br> 我为什么要写一个数据湖？ 我从事数据和分析工作已超过10年，现在，我绝对在位于波士顿的剑桥市的Amazon Alexa AI上处理大数据，尽管我本人住在温哥华岛的维多利亚州，并且经常访问波士顿，西雅图和温哥华，有时甚至在莫斯科，我都在会议上发言。 另外，我不时写作，但我主要用英语写作，并且已经写<a href="https://www.amazon.com/Dmitry-Anoshin/e/B01A5PVT2M" rel="nofollow">了几本书</a> ，而且我还需要分享北美的分析趋势，有时我会用<a href="https://t.me/rockyourdata" rel="nofollow">电报来</a>写作。 <br><br> 我一直与数据仓库合作，自2015年以来，我开始与Amazon Web Services紧密合作，并且通常转而使用云分析（AWS，Azure，GCP）。 我观察了自2007年以来分析解决方案的发展，甚至在Teradat数据仓库供应商中工作，并在Sberbank中实施了该解决方案，然后出现了带有Hadoop的大数据。 每个人都开始说存储时代已经过去，现在一切都在Hadoop上，然后他们又开始谈论Data Lake，现在数据仓库肯定已经过去了。 但是幸运的是（也许对于不幸的是，某人在建立Hadoop上赚了很多钱），数据仓库并没有消失。 <br><a name="habracut"></a><br> 在本文中，我们将考虑什么是数据湖。 本文适用于很少或没有数据仓库经验的人。 <br><br><img src="https://habrastorage.org/getpro/habr/post_images/67a/c23/054/67ac2305443be86573682496b367de13.jpg" alt="图片"><br><br> 在图片中，布莱德湖是我最喜欢的湖泊之一，虽然我只去过一次，但我终生难忘。 但是我们将讨论另一种类型的湖泊-数据湖。 也许你们中的许多人已经不止一次听说过这个词，但是另一个定义不会伤害任何人。 <br><br> 首先，以下是Data Lake的最流行定义： <br><blockquote>  “组织中任何人都可以进行分析的所有类型的原始数据的文件存储”-Martin Fowler。 </blockquote><blockquote>  “如果您认为数据展示柜是一瓶水-经过纯化，包装和包装以方便使用，那么数据湖就是其天然形式的巨大水库。 用户，我可以为自己取水，潜入深处，探索“-詹姆斯·迪克森。 </blockquote> 现在我们可以确定数据湖与分析有关，它可以让我们以原始格式存储大量数据，并且可以对数据进行必要且方便的访问。 <br><br> 我经常喜欢简化事情，如果我能用简单的话说一个复杂的术语，那么对我自己来说，我就会理解它的工作原理和目的。 不知何故，我在照相馆里拿起我的iPhone，它突然出现在我身上，所以这是一个真正的数据湖，我什至为会议制作了一张幻灯片： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d34/77a/b74/d3477ab74e318cfcfc574b01f82cd2f8.png" alt="图片"><br><br> 一切都非常简单。 我们在手机上拍照，照片被保存在手机上，并且可以保存在iCloud（云中的文件存储）中。 手机还收集照片的元数据：显示的内容，地理标记，时间。 结果，我们可以使用便捷的iPhone界面查找照片，同时甚至可以看到指示符，例如，当我查找带有火字的照片时，我会发现3张带有火影的照片。 对我来说，它就像一个可以快速，清晰地运行的商业智能工具。 <br><br> 当然，我们不应该忘记安全性（授权和身份验证），否则我们的数据很容易进入公开访问。 关于大型公司和初创企业的新闻很多，由于开发商的疏忽和不遵守简单规则，数据进入了公共领域。 <br><br> 即使如此简单的图片也可以帮助我们想象什么是数据湖，它与传统数据仓库的区别及其主要元素： <br><br><ol><li>  <b>数据加载</b> （提取）是数据湖的关键组成部分。 数据可以通过两种方式进入数据仓库-批处理（间隔下载）和流式传输（数据流）。 </li><li>  <b>文件</b>存储是数据湖的主要组成部分。 我们需要存储易于扩展，极其可靠且成本低廉。 例如，在AWS中，这是S3。 </li><li>  <b>目录和搜索</b> -为了避免数据沼泽（这是我们将所有数据转储为一堆，然后就无法使用它们的情况），我们需要创建一个元数据层来对数据进行分类，以便用户可以轻松地找到他们需要分析的数据。 此外，您可以使用其他搜索解决方案，例如ElasticSearch。 搜索可帮助用户通过方便的界面搜索所需的数据。 </li><li>  <b>处理</b> （Process）-此步骤负责数据的处理和转换。 我们可以转换数据，更改其结构，清除数据等等。 </li><li>  <b>安全性</b> -花时间设计安全性解决方案很重要。 例如，在存储，处理和加载期间的数据加密。 使用身份验证和授权方法很重要。 总之，需要一个审计工具。 </li></ol><br> 从实际的角度来看，我们可以表征具有三个属性的数据湖： <br><br><ol><li>  <b>收集并存储您想要的任何内容</b> -数据湖包含所有数据，包括任何时间段的原始数据和已处理/已清除的数据。 </li><li>  <b>深度分析</b> -数据湖可让用户浏览和分析数据。 </li><li>  <b>灵活的访问</b> -数据湖为各种数据和各种方案提供灵活的访问。 </li></ol><br> 现在我们可以讨论数据仓库和数据湖之间的区别。 人们通常会问： <br><br><ul><li> 但是数据仓库呢？ </li><li> 我们是用数据湖代替数据仓库还是在扩展它？ </li><li> 没有数据湖是否有可能做？ </li></ul><br> 简而言之，没有明确的答案。 这完全取决于具体情况，团队技能和预算。 例如，将数据仓库迁移到AWS中的Oracle并由亚马逊子公司Woot创建数据湖- <a href="https://aws.amazon.com/blogs/big-data/our-data-lake-story-how-woot-com-built-a-serverless-data-lake-on-aws/" rel="nofollow">我们的数据湖故事：Woot.com如何在AWS上构建无服务器数据湖</a> 。 <br><br> 另一方面，Snowflake供应商指出，您不再需要考虑数据湖，因为他们的数据平台（直到2020年以前都是数据仓库）允许您将数据湖和数据仓库结合在一起。 我与Snowflake的合作不多，这是一款可以做到这一点的真正独特的产品。 问题的价格是另一个问题。 <br><br> 总之，我个人的观点是，我们仍然需要数据仓库作为报告的主要数据源，并且我们存储所有不适合数据湖的内容。 分析的全部作用是为决策提供方便的业务访问。 无论如何，与Amazon的数据湖相比，业务用户使用数据仓库的效率更高。例如，在Amazon-有Redshift（分析数据仓库）和Redshift Spectrum / Athena（基于Hive / Presto的S3中用于数据湖的SQL接口）。 其他现代分析数据仓库也是如此。 <br><br> 让我们看一下典型的数据仓库架构： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7de/e3f/c88/7dee3fc8821213275acac425258fce53.png" alt="图片"><br><br> 这是一个经典的解决方案。 我们有源系统，使用ETL / ELT，我们将数据复制到分析数据仓库中，并将解决方案连接到商业智能（我最喜欢的Tableau，还有您的Tableau？）。 <br><br> 该解决方案具有以下缺点： <br><br><ul><li>  ETL / ELT操作需要时间和资源。 </li><li> 通常，在分析数据仓库中存储数据的内存并不便宜（例如Redshift，BigQuery，Teradata），因为我们需要购买整个集群。 </li><li> 业务用户可以访问已清理且通常是聚合的数据，并且无法获取原始数据。 </li></ul><br> 当然，这完全取决于您的情况。 如果您的数据仓库没有问题，那么您绝对不需要数据湖。 但是，如果由于空间不足，容量不足或问题的价格而产生问题时，则可以考虑选择数据湖。 这就是为什么数据湖非常受欢迎。 这是数据湖架构的示例： <br><img src="https://habrastorage.org/getpro/habr/post_images/d16/5ec/0e7/d165ec0e7480507c85770470b9463807.png" alt="图片"><br> 使用数据湖方法，我们将原始数据加载到数据湖中（批处理或流传输），然后根据需要处理数据。 数据湖使业务用户可以创建自己的数据转换（ETL / ELT）或在Business Intelligence解决方案中分析数据（如果您有合适的驱动程序）。 <br><blockquote> 任何分析解决方案的目标都是为业务用户提供服务。 因此，我们必须始终根据业务需求进行工作。  （在亚马逊，这是原则之一-向后工作）。 </blockquote> 通过使用数据仓库和数据湖，我们可以比较两种解决方案： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/618/4f3/ddf/6184f3ddf7e07b4517b5127f37f282db.png" alt="图片"><br><br> 可以得出的主要结论是，数据仓库不会与数据湖竞争，而是会对其进行补充。 但这取决于您的情况。 自己尝试并得出正确的结论总是很有趣。 <br><br> 我还想谈一谈开始使用数据湖方法的情况之一。 一切都很普通，我尝试使用ELT工具（我们拥有Matillion ETL）和Amazon Redshift，虽然我的解决方案有效，但不符合要求。 <br><br> 我需要获取Web日志，对其进行转换并汇总以提供2种情况的数据： <br><br><ol><li> 营销团队希望分析针对SEO的机器人活动 </li><li>  IT希望关注站点指标 </li></ol><br> 非常简单，非常简单的日志。 这是一个例子： <br><br><pre><code class="plaintext hljs">https 2018-07-02T22:23:00.186641Z app/my-loadbalancer/50dc6c495c0c9188 192.168.131.39:2817 10.0.0.1:80 0.086 0.048 0.037 200 200 0 57 "GET https://www.example.com:443/ HTTP/1.1" "curl/7.46.0" ECDHE-RSA-AES128-GCM-SHA256 TLSv1.2 arn:aws:elasticloadbalancing:us-east-2:123456789012:targetgroup/my-targets/73e2d6bc24d8a067 "Root=1-58337281-1d84f3d73c47ec4e58577259" "www.example.com" "arn:aws:acm:us-east-2:123456789012:certificate/12345678-1234-1234-1234-123456789012" 1 2018-07-02T22:22:48.364000Z "authenticate,forward" "-" "-"</code> </pre> <br> 一个文件重1-4兆字节。 <br><br> 但是有一个困难。 我们在全球拥有7个域，一天之内创建了7,000万个文件。 这不是一个很大的卷，只有50 GB。 但是我们的Redshift集群的规模也很小（4个节点）。 以传统方式下载单个文件大约需要一分钟。 即，该任务没有在额头上解决。 当我决定使用数据湖方法时就是这种情况。 解决方案如下所示： <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c26/d4e/fb1/c26d4efb18f90fc1aaef841fbffb986f.png" alt="图片"><br><br> 这非常简单（我想指出的是，在云中工作的优点是简单）。 我用过： <br><br><ul><li>  AWS Elastic Map Reduce（Hadoop）作为计算能力 </li><li>  AWS S3作为文件存储，具有加密数据和限制访问的能力 </li><li>  Spark作为InMemory计算能力和PySpark用于逻辑和数据转换 </li><li> 由于Spark的实木复合地板 </li><li>  AWS Glue Crawler作为有关新数据和分区的元数据的收集器 </li><li>  Redshift Spectrum作为现有Redshift用户到数据湖的SQL接口 </li></ul><br> 最小的EMR + Spark集群在30分钟内处理了一大堆文件。  AWS还有其他情况，尤其是与Alexa有关的许多情况，其中有大量数据。 <br><br> 最近，我发现数据湖的缺点之一是GDPR。 问题是当客户要求他删除数据并且数据在其中一个文件中时，我们不能像在数据库中那样使用数据操作语言和DELETE操作。 <br><br> 希望本文阐明了数据仓库和数据湖之间的区别。 如果很有趣，我仍然可以翻译我的文章或我读过的专业文章。 并且还讨论我使用的解决方案及其体系结构。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN485180/">https://habr.com/ru/post/zh-CN485180/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN485164/index.html">温哥华的变形金刚和仇恨：反lag窃主义如何影响NeurIPS-2019</a></li>
<li><a href="../zh-CN485172/index.html">大型项目中的架构问题</a></li>
<li><a href="../zh-CN485174/index.html">Haskell依赖类型：为什么软件开发的未来</a></li>
<li><a href="../zh-CN485176/index.html">六种方案可帮助解释产品管理概念</a></li>
<li><a href="../zh-CN485178/index.html">通过照片重建失落建筑物的方法</a></li>
<li><a href="../zh-CN485182/index.html">2020年的森海塞尔-周年纪念期间更新了无线耳机</a></li>
<li><a href="../zh-CN485184/index.html">选项卡式投票结果</a></li>
<li><a href="../zh-CN485186/index.html">万亿美元的初创企业或最成功的Valley公司诞生的方式</a></li>
<li><a href="../zh-CN486006/index.html">将聊天状态存储在堆栈中</a></li>
<li><a href="../zh-CN486174/index.html">我的营业额为零</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>