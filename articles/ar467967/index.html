<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ ๐ ุงูุงูุบูุงุณ ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ: ููู ุงูุชุนูู ๐ ๐ฉ๐ฟโ๐คโ๐จ๐พ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ูููู ุงูุนุซูุฑ ุนูู ุงูุฏูุฑุฉ ุงููุงููุฉ ุจุงููุบุฉ ุงูุฑูุณูุฉ ุนูู ูุฐุง ุงูุฑุงุจุท . 
 ุฏูุฑุฉ ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ุงูุฃุตููุฉ ูุชุงุญุฉ ุนูู ูุฐุง ุงูุฑุงุจุท . 



 ูุญุชูู 


1. ููุงุจูุฉ ูุน ุณูุจุงุณ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุงูุงูุบูุงุณ ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ: ููู ุงูุชุนูู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467967/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  ูููู ุงูุนุซูุฑ ุนูู ุงูุฏูุฑุฉ ุงููุงููุฉ ุจุงููุบุฉ ุงูุฑูุณูุฉ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง ุงูุฑุงุจุท</a> . <br>  ุฏูุฑุฉ ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ ุงูุฃุตููุฉ ูุชุงุญุฉ ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง ุงูุฑุงุจุท</a> . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/wu/ie/7c/wuie7cgpktklm4bytoweu7ki0oq.jpeg"></p><a name="habracut"></a><br><h1 style=";text-align:right;direction:rtl">  ูุญุชูู </h1><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ููุงุจูุฉ ูุน ุณูุจุงุณุชูุงู ุชุฑูู </li><li style=";text-align:right;direction:rtl">  ููุฏูุฉ </li><li style=";text-align:right;direction:rtl">  ููู ูููุฐุฌ ุงูุชุนูู </li><li style=";text-align:right;direction:rtl">  MobileNet </li><li style=";text-align:right;direction:rtl">  CoLab: ุงููุทุท ููุงุจู ุงูููุงุจ ูุน ููู ุงูุชุฏุฑูุจ </li><li style=";text-align:right;direction:rtl">  ุงูุบูุต ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ </li><li style=";text-align:right;direction:rtl">  ุงูุฌุฒุก ุงูุนููู: ุชุญุฏูุฏ ุงูุฃููุงู ูุน ููู ุงูุชุฏุฑูุจ </li><li style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </li></ol><br><h1 style=";text-align:right;direction:rtl">  ููุงุจูุฉ ูุน ุณูุจุงุณุชูุงู ุชุฑูู </h1><br><p style=";text-align:right;direction:rtl">  - ูุฐุง ูู ุงูุฏุฑุณ 6 ููู ูุฎุตุต ุชูุงููุง ูููู ุงูุชุนูู.  ููู ุงูุชุนูู ูู ุนูููุฉ ุงุณุชุฎุฏุงู ูููุฐุฌ ููุฌูุฏ ูุน ุงููููู ูู ุงูุชูููุญ ููููุงู ุงูุฌุฏูุฏุฉ.  ูุณุงุนุฏ ููู ุงูุชุฏุฑูุจ ูู ุชูููู ููุช ุงูุชุฏุฑูุจ ูู ุงููููุฐุฌ ูู ุฎูุงู ุฅุนุทุงุก ุจุนุถ ุงูุฒูุงุฏุฉ ูู ุงูููุงุกุฉ ุนูุฏ ุงูุชุนูู ูู ุงูุจุฏุงูุฉ.  ุณูุจุงุณุชูุงู ุ ูุง ุฑุฃูู ูู ููู ุงูุชุฏุฑูุจุ  ูู ุณุจู ูู ุฃู ุงุณุชุฎุฏูุช ูููุฌูุฉ ููู ุงูุชุฏุฑูุณ ูู ุนููู ูุฃุจุญุงุซูุ <br>  - ุชู ุชูุฑูุณ ุฑุณุงูุชู ุนูู ูุฌู ุงูุชุญุฏูุฏ ูููุถูุน ููู ุงูุชุฏุฑูุจ ููุงู ูุณูู " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงูุชูุณูุฑ ุนูู ุฃุณุงุณ ููู ุงูุชุฏุฑูุจ</a> ".  ุนูุฏูุง ููุง ูุนูู ุนูู ุฃุทุฑูุญุฉ ุ ูุงูุช ุงูููุฑุฉ ุฃูู ูู ุงููููู ุชุนููู ููููุฉ ุงูุชูููุฒ ุจูู ุฌููุน ุงููุงุฆูุงุช ุงูุฃุฎุฑู ูู ูุฐุง ุงูููุน ุนูู ูุงุฆู ูุงุญุฏ (ูุฌููุนุฉ ุงูุจูุงูุงุช ุ ุงูููุงู) ูู ุฃุดูุงู ูุฃุดูุงู ูุฎุชููุฉ.  ูู ุงูุนูู ุ ุงุณุชุฎุฏููุง ุงูุฎูุงุฑุฒููุฉ ุงููุชูุฏูุฉ ุ ูุงูุชู ููุฒุช ุงูุฎุตุงุฆุต ุงูุฑุฆูุณูุฉ (ุงูุณูุงุช) ูููุงุฆู ููููู ููุงุฑูุชูุง ุจูุงุฆู ุขุฎุฑ.  ุงูููุชุจุงุช ูุซู Tensorflow ุชุฃุชู ุจุงููุนู ูุน ููุงุฐุฌ ูุฏุฑุจุฉ ูุณุจูุง. <br>  - ูุนู ุ ูู Tensorflow ูุฏููุง ูุฌููุนุฉ ูุงููุฉ ูู ุงูููุงุฐุฌ ุงููุฏุฑุจุฉ ูุณุจููุง ูุงูุชู ููููู ุงุณุชุฎุฏุงููุง ูุญู ุงููุดููุงุช ุงูุนูููุฉ.  ุณูุชุญุฏุซ ุนู ูุฌููุนุงุช ุฌุงูุฒุฉ ูู ููุช ูุงุญู. <br>  - ูุนู ูุนู!  ุฅุฐุง ููุช ุชููุฑ ูู ุฐูู ุ ูุฅู ุงููุงุณ ูุดุงุฑููู ูู ููู ุงูุชุฏุฑูุจ ุทูุงู ุงูููุช ุทูุงู ุญูุงุชูู. <br>  - ูู ูููููุง ุงูููู ุฃูู ุจูุถู ุทุฑููุฉ ููู ุงูุชุฏุฑูุจ ุ ูู ูุถุทุฑ ุทูุงุจูุง ุงูุฌุฏุฏ ูู ูุฑุญูุฉ ูุง ุฅูู ูุนุฑูุฉ ุดูุก ูุง ุนู ุงูุชุนูู ุงูุขูู ูุฃูู ุณูููู ุชูุตูู ูููุฐุฌ ุชู ุฅุนุฏุงุฏู ุจุงููุนู ูุงุณุชุฎุฏุงููุ <br>  - ุงูุจุฑูุฌุฉ ุชูุชุจ ุณุทุฑุง ุณุทุฑุง ุ ููุญู ูุนุทู ุงูุฃูุงูุฑ ุฅูู ุงูููุจููุชุฑ.  ูุฏููุง ูู ุงูุชุฃูุฏ ูู ุฃู ูู ุดุฎุต ุนูู ูุฐุง ุงููููุจ ูุงุฏุฑ ููุงุฏุฑ ุนูู ุงูุจุฑูุฌุฉ ูู ุฎูุงู ุชุฒููุฏ ุงูููุจููุชุฑ ุจุฃูุซูุฉ ููุท ูู ุจูุงูุงุช ุงูุฅุฏุฎุงู.  ุชูุงูู ุ ุฅุฐุง ููุช ุชุฑุบุจ ูู ุชุนููู ุงูููุจููุชุฑ ูุชูููุฒ ุงููุทุท ุนู ุงูููุงุจ ุ ูุฅู ุงูุนุซูุฑ ุนูู 100 ุฃูู ุตูุฑุฉ ูุฎุชููุฉ ูููุทุท ู 100 ุฃูู ุตูุฑุฉ ูุฎุชููุฉ ููููุงุจ ุฃูุฑ ุตุนุจ ููุบุงูุฉ ุ ูุจูุถู ููู ุงูุชุฏุฑูุจ ููููู ุญู ูุฐู ุงููุดููุฉ ูู ุนุฏุฉ ุฃุณุทุฑ. <br>  - ูุนู ูุนูุง!  ุดูุฑุง ุนูู ุงูุฅุฌุงุจุงุช ูุฏุนููุง ููุชูู ุฃุฎูุฑุง ุฅูู ุงูุชุนูู. </p><br><h1 style=";text-align:right;direction:rtl">  ููุฏูุฉ </h1><br><p style=";text-align:right;direction:rtl">  - ูุฑุญุจุง ููุฑุญุจุง ุจูู ูุฑุฉ ุฃุฎุฑู! <br>  - ุขุฎุฑ ูุฑุฉ ูููุง ุจุชุฏุฑูุจ ุดุจูุฉ ุนุตุจูุฉ ุชูุงููููุฉ ูุชุตููู ุงููุทุท ูุงูููุงุจ ูู ุงูุตูุฑุฉ.  ุชู ุฅุนุงุฏุฉ ุชุฏุฑูุจ ุดุจูุชูุง ุงูุนุตุจูุฉ ุงูุฃููู ุ ูุฐุง ูู ุชูู ูุชูุฌุชูุง ุนุงููุฉ ุฌุฏูุง - ุญูุซ ุจูุบุช ุฏูุฉ ุญูุงูู 70ูช.  ุจุนุฏ ุฐูู ุ ูููุง ุจุชุทุจูู ุชูุฏูุฏ ุงูุจูุงูุงุช ูุงูุชุณุฑุจ (ุงููุตู ุงูุชุนุณูู ููุฎูุงูุง ุงูุนุตุจูุฉ) ุ ููุง ุณูุญ ููุง ุจุฒูุงุฏุฉ ุฏูุฉ ุงูุชูุจุคุงุช ุจูุณุจุฉ ุชุตู ุฅูู 80 ูช. <br>  - ุนูู ุงูุฑุบู ูู ุญูููุฉ ุฃู 80 ูช ูุฏ ูุจุฏู ูุคุดุฑุง ููุชุงุฒุง ุ ูุฅู ุงูุฎุทุฃ 20 ูช ูุง ูุฒุงู ูุจูุฑุง ุฌุฏุง.  ุฃููุณ ูุฐููุ  ูุงุฐุง ูููููุง ุฃู ููุนู ูุฒูุงุฏุฉ ุฏูุฉ ุงูุชุตูููุ  ูู ูุฐุง ุงูุฏุฑุณ ุ ุณูู ูุณุชุฎุฏู ุชูููุฉ ููู ุงููุนุฑูุฉ (ููู ูููุฐุฌ ุงููุนุฑูุฉ) ุ ูุงูุชู ุณูู ุชุชูุญ ููุง ุงุณุชุฎุฏุงู ุงููููุฐุฌ ุงูุฐู ุทูุฑู ุงูุฎุจุฑุงุก ูุงููุฏุฑุจูู ุนูู ุตูุงุฆู ุงูุจูุงูุงุช ุงูุถุฎูุฉ.  ููุง ุณูุฑู ูู ุงูููุงุฑุณุฉ ุงูุนูููุฉ ุ ูู ุฎูุงู ููู ูููุฐุฌ ุงููุนุฑูุฉ ุ ูููููุง ุชุญููู ุฏูุฉ ุชุตููู 95 ูช.  ููุจุฏุฃ! </p><br><h1 style=";text-align:right;direction:rtl">  ููู ูููุฐุฌ ุงูุชุนูู </h1><br><p style=";text-align:right;direction:rtl">  ูู ุนุงู 2012 ุ ุฃุญุฏุซุช ุดุจูุฉ AlexNet ุงูุนุตุจูุฉ ุซูุฑุฉ ูู ุนุงูู ุงูุชุนูู ุงูุขูู ูุดุงุนุช ุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ููุชุตููู ูู ุฎูุงู ุงูููุฒ ุจุชุญุฏู ImageNet Large Scale Visual. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fs/xx/di/fsxxdicwkitfkxibie8kkjcyexu.png"></p><br><p style=";text-align:right;direction:rtl">  ุจุนุฏ ุฐูู ุ ุจุฏุฃ ุงูุตุฑุงุน ูู ุชุทููุฑ ุดุจูุงุช ุนุตุจูุฉ ุฃูุซุฑ ุฏูุฉ ูููุงุกุฉ ูููู ุฃู ุชุชุฌุงูุฒ AlexNet ูู ููุงู ุชุตููู ุงูุตูุฑ ูู ูุฌููุนุฉ ุจูุงูุงุช ImageNet. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/oe/t0/ov/oet0ovye40p1cziih64hpmbhuus.png"></p><br><p style=";text-align:right;direction:rtl">  ูุนุฏุฉ ุณููุงุช ุ ุชู ุชุทููุฑ ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชู ุชุชุนุงูู ูุน ูููุฉ ุงูุชุตููู ุจุดูู ุฃูุถู ูู AlexNet - Inception ู ResNet. <br>  ุชูุงูู ุนูู ุฃูู ุณูููู ูู ุงูุฑุงุฆุน ุฃู ุชููู ูุงุฏุฑูุง ุนูู ุงูุงุณุชูุงุฏุฉ ูู ูุฐู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงููุฏุฑุจุฉ ุจุงููุนู ุนูู ูุฌููุนุงุช ุงูุจูุงูุงุช ุงูุถุฎูุฉ ูู ImageNet ูุงุณุชุฎุฏุงููุง ูู ูุตููู ูููุทุท ูุงูููุงุจุ </p><br><p style=";text-align:right;direction:rtl">  ุงุชุถุญ ุฃููุง ูููู ุฃู ููุนู ุฐูู!  ูุชุณูู ูุฐู ุงูุชูููุฉ ููู ุงูุชุนูู.  ุชุนุชูุฏ ุงูููุฑุฉ ุงูุฃุณุงุณูุฉ ูุทุฑููุฉ ููู ูููุฐุฌ ุงูุชุฏุฑูุจ ุนูู ุญูููุฉ ุฃูู ุจุนุฏ ุชุฏุฑูุจ ุดุจูุฉ ุนุตุจูุฉ ุนูู ูุฌููุนุฉ ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ุ ูููููุง ุชุทุจูู ุงููููุฐุฌ ุงูุฐู ุชู ุงูุญุตูู ุนููู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ูู ูุตุงุฏููุง ูุฐุง ุงููููุฐุฌ ุจุนุฏ.  ูุฐุง ูู ุงูุณุจุจ ูู ุฃู ุงูุชูููุฉ ุชุณูู ููู ุงูุชุนูู - ููู ุนูููุฉ ุงูุชุนูู ูู ูุฌููุนุฉ ุจูุงูุงุช ุฅูู ุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  ูู ุฃุฌู ุชุทุจูู ูููุฌูุฉ ููู ูููุฐุฌ ุงูุชุฏุฑูุจ ุ ูุญุชุงุฌ ุฅูู ุชุบููุฑ ุงูุทุจูุฉ ุงูุฃุฎูุฑุฉ ูู ุดุจูุชูุง ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/3j/-g/g3/3j-gg3yxm9kvrtphiswnho2jgtc.png"></p><br><p style=";text-align:right;direction:rtl">  ูุญู ูููู ุจูุฐู ุงูุนูููุฉ ูุฃู ูู ูุฌููุนุฉ ุจูุงูุงุช ุชุชููู ูู ุนุฏุฏ ูุฎุชูู ูู ูุฆุงุช ุงูุฅุฎุฑุงุฌ.  ุนูู ุณุจูู ุงููุซุงู ุ ุชุญุชูู ูุฌููุนุงุช ุงูุจูุงูุงุช ูู ImageNet ุนูู 1000 ูุฆุฉ ูุฎุฑุฌุงุช ูุฎุชููุฉ.  FashionMNIST ูุญุชูู ุนูู 10 ูุตูู.  ุชุชููู ูุฌููุนุฉ ุจูุงูุงุช ุงูุชุตููู ุงูุฎุงุตุฉ ุจูุง ูู ูุตููู ููุท - ุงููุทุท ูุงูููุงุจ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/5e/pm/ej/5epmejbamklkdfgzzw9v8rzb1ts.png"></p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ูู ุงูุณุจุจ ูู ุฃูู ูู ุงูุถุฑูุฑู ุชุบููุฑ ุงูุทุจูุฉ ุงูุฃุฎูุฑุฉ ูู ุดุจูุชูุง ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุจุญูุซ ุชุญุชูู ุนูู ุนุฏุฏ ุงููุฎุฑุฌุงุช ุงูุชู ุชุชูุงูู ูุน ุนุฏุฏ ุงูุทุจูุงุช ูู ุงููุฌููุนุฉ ุงูุฌุฏูุฏุฉ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/cg/mk/fz/cgmkfzxqmyqbdzsmvfdppjhsl9e.png"></p><br><p style=";text-align:right;direction:rtl">  ูุญุชุงุฌ ุฃูุถูุง ุฅูู ุงูุชุฃูุฏ ูู ุฃููุง ูุง ูุบูุฑ ุงููููุฐุฌ ุงูููุฏุฑููุฌ ูุณุจููุง ุฃุซูุงุก ุนูููุฉ ุงูุชุฏุฑูุจ.  ูุชูุซู ุงูุญู ูู ุฅููุงู ุชุดุบูู ูุชุบูุฑุงุช ุงููููุฐุฌ ุงูุฐู ุชู ุชุฏุฑูุจู ูุณุจููุง - ููุญู ุจุจุณุงุทุฉ ูููุน ุงูุฎูุงุฑุฒููุฉ ูู ุชุญุฏูุซ ุงูููู ุฃุซูุงุก ุงูุงูุชุดุงุฑ ููุฃูุงู ูููุฎูู ูุชุบููุฑูุง. <br>  ูุชุณูู ูุฐู ุงูุนูููุฉ "ุชุฌููุฏ ุงููููุฐุฌ". </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/8z/oz/0n/8zoz0nenaad4-lgezhhia25k_18.png"></p><br><p style=";text-align:right;direction:rtl">  ูู ุฎูุงู "ุชุฌููุฏ" ูุนููุงุช ุงููููุฐุฌ ุงูููุฏุฑููุจ ูุณุจููุง ุ ูุณูุญ ููุง ุจูุนุฑูุฉ ุงูุทุจูุฉ ุงูุฃุฎูุฑุฉ ููุท ูู ุดุจูุฉ ุงูุชุตููู ุ ูุชุจูู ููู ูุชุบูุฑุงุช ุงููููุฐุฌ ุงููุฏุฑูุจ ูุณุจููุง ุนูู ุญุงููุง. </p><br><p style=";text-align:right;direction:rtl">  ููู ุงููุฒุงูุง ุงูุฃุฎุฑู ุงูุชู ูุง ุฌุฏุงู ูููุง ููููุงุฐุฌ ุงูุชู ุชู ุชุฏุฑูุจูุง ูุณุจููุง ุชูููู ููุช ุงูุชุฏุฑูุจ ูู ุฎูุงู ุชุฏุฑูุจ ุงูุทุจูุฉ ุงูุฃุฎูุฑุฉ ููุท ูุน ุนุฏุฏ ุฃูู ุจูุซูุฑ ูู ุงููุชุบูุฑุงุช ุ ูููุณ ุงููููุฐุฌ ุจุฃูููู. </p><br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ูู "ูููู ุจุชุฌููุฏ" ูุชุบูุฑุงุช ุงููููุฐุฌ ุงูููุฏุฑููุจ ูุณุจููุง ุ ูุนูุฏ ุนูููุฉ ุงูุชุฏุฑูุจ ุ ุณุชุชุบูุฑ ููู ุงููุชุบูุฑุงุช ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฌุฏูุฏุฉ.  ูุฐูู ูุฃู ููู ุงููุชุบูุฑุงุช ูู ุงูุทุจูุฉ ุงูุฃุฎูุฑุฉ ูู ุงูุชุตููู ุณูุชู ููุคูุง ุจููู ุนุดูุงุฆูุฉ.  ุจุณุจุจ ุงูููู ุงูุนุดูุงุฆูุฉ ูู ุงูุทุจูุฉ ุงูุฃุฎูุฑุฉ ุ ุณูู ูุฑุชูุจ ูููุฐุฌูุง ุฃุฎุทุงุก ูุจูุฑุฉ ูู ุงูุชุตููู ุ ุงูุฃูุฑ ุงูุฐู ูุณุชูุฒู ุจุฏูุฑู ุชุบููุฑุงุช ูููุฉ ูู ุงูุฃูุฒุงู ุงูุฃูููุฉ ูู ุงููููุฐุฌ ุงูููุฏุฑููุจ ูุณุจููุง ุ ููู ุฃูุฑ ุบูุฑ ูุฑุบูุจ ููู ููุบุงูุฉ ุจุงููุณุจุฉ ููุง. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/wp/uz/km/wpuzkmnan5rahfg3irexdsvrstm.png"></p><br><p style=";text-align:right;direction:rtl">  ููุฐุง ุงูุณุจุจ ูุฌุจ ุฃู ูุชุฐูุฑ ุฏุงุฆููุง ุฃูู ุนูุฏ ุงุณุชุฎุฏุงู ุงูููุงุฐุฌ ุงูุญุงููุฉ ุ ูุฌุจ "ุชุฌููุฏ" ููู ุงููุชุบูุฑุงุช ููุฌุจ ุฅููุงู ุชุดุบูู ุงูุญุงุฌุฉ ุฅูู ุชุฏุฑูุจ ูููุฐุฌ ุชู ุชุฏุฑูุจู ูุณุจููุง. </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุจุนุฏ ุฃู ุนุฑููุง ููู ูุนูู ููู ูููุฐุฌ ุงูุชุฏุฑูุจ ุ ุนูููุง ููุท ุงุฎุชูุงุฑ ุดุจูุฉ ุนุตุจูุฉ ูุฏุฑุจุฉ ูุณุจููุง ูุงุณุชุฎุฏุงููุง ูู ุงููุตูู ุงูุฎุงุต ุจูุง!  ูุฐุง ุณููุนูู ูู ุงูุฌุฒุก ุงูุชุงูู. </p><br><h1 style=";text-align:right;direction:rtl">  MobileNet </h1><br><p style=";text-align:right;direction:rtl">  ููุง ุฐูุฑูุง ุณุงุจููุง ุ ุชู ุชุทููุฑ ุดุจูุงุช ุนุตุจูุฉ ูุนุงูุฉ ููุบุงูุฉ ุฃุธูุฑุช ูุชุงุฆุฌ ุนุงููุฉ ุนูู ูุฌููุนุงุช ุจูุงูุงุช ImageNet - AlexNet ุ Inception ุ Resonant.  ูุฐู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ูู ุดุจูุงุช ุนูููุฉ ููุบุงูุฉ ูุชุญุชูู ุนูู ุขูุงู ูุญุชู ููุงููู ุงููุนููุงุช.  ูุชูุญ ุนุฏุฏ ูุจูุฑ ูู ุงููุนููุงุช ููุดุจูุฉ ูุนุฑูุฉ ุฃููุงุท ุฃูุซุฑ ุชุนููุฏูุง ูุจุงูุชุงูู ุชุญููู ุฏูุฉ ุชุตููู ูุชุฒุงูุฏุฉ.  ูุคุซุฑ ุนุฏุฏ ูุจูุฑ ูู ูุนููุงุช ุงูุชุฏุฑูุจ ูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุนูู ุณุฑุนุฉ ุงูุชุนูู ููููุฉ ุงูุฐุงูุฑุฉ ุงููุทููุจุฉ ูุชุฎุฒูู ุงูุดุจูุฉ ูุชุนููุฏ ุงูุนูููุงุช ุงูุญุณุงุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุฏุฑุณ ุ ุณูู ูุณุชุฎุฏู ุดุจูุฉ ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุงูุญุฏูุซุฉ MobileNet.  MobileNet ูู ุจููุฉ ุดุจูุฉ ุนุตุจูุฉ ุชูุงููููุฉ ูุนุงูุฉ ุชููู ูู ููุฏุงุฑ ุงูุฐุงูุฑุฉ ุงููุณุชุฎุฏูุฉ ููุญูุณุจุฉ ูุน ุงูุญูุงุธ ุนูู ุฏูุฉ ุนุงููุฉ ููุชูุจุคุงุช.  ูุฐุง ูู ุงูุณุจุจ ูู ุฃู MobileNet ูุซุงูู ููุงุณุชุฎุฏุงู ุนูู ุงูุฃุฌูุฒุฉ ุงููุญูููุฉ ูุน ูุฏุฑ ูุญุฏูุฏ ูู ุงูุฐุงูุฑุฉ ูููุงุฑุฏ ุงูุญูุณุจุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุชู ุชุทููุฑ MobileNet ุจูุงุณุทุฉ Google ูุชู ุชุฏุฑูุจู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ImageNet. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุชุฏุฑูุจุงุช MobileNet ุนูู 1000 ูุตู ูู ูุฌููุนุฉ ุจูุงูุงุช ImageNet ุ ูุฅู MobileNet ูุญุชูู ุนูู 1000 ูุฆุฉ ูุฎุฑุฌุงุช ุ ุจุฏูุงู ูู ุงููุตููู ุงููุฐูู ูุญุชุงุฌููุง - ูุทุฉ ูููุจ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/he/2f/ox/he2foxizd_xmt7rijxumteg-94k.png"></p><br><p style=";text-align:right;direction:rtl">  ูุฅููุงู ููู ุงูุชุฏุฑูุจ ุ ูุชู ุชุญููู ูุชุฌู ุงููุนุงูู ูุณุจููุง ุจุฏูู ุทุจูุฉ ุชุตููู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/1b/o2/no/1bo2nop9cpz3ebag_jcyfrgje7w.png"></p><br><p style=";text-align:right;direction:rtl">  ูู Tensorflow ุ ูููู ุงุณุชุฎุฏุงู ูุชุฌู ุงููุนุงูู ุงููุญููุฉ ูุทุจูุฉ Keras ุนุงุฏูุฉ ูุน ุฅุฏุฎุงู ุงูุจูุงูุงุช ุจุญุฌู ูุนูู. </p><br><p style=";text-align:right;direction:rtl">  ูุธุฑูุง ูุชุฏุฑูุจ MobileNet ุนูู ูุฌููุนุฉ ุจูุงูุงุช ImageNet ุ ูุณูู ูุญุชุงุฌ ุฅูู ููู ุญุฌู ุจูุงูุงุช ุงูุฅุฏุฎุงู ุฅูู ุชูู ุงูุชู ุชู ุงุณุชุฎุฏุงููุง ูู ุนูููุฉ ุงูุชุฏุฑูุจ.  ูู ุญุงูุชูุง ุ ุชู ุชุฏุฑูุจ MobileNet ุนูู ุตูุฑ RGB ุซุงุจุชุฉ ุจุญุฌู 224 ร 224 ุจูุณู. </p><br><p style=";text-align:right;direction:rtl">  ูุญุชูู TensorFlow ุนูู ูุณุชูุฏุน ุชู ุชุฏุฑูุจู ูุณุจููุง ูุณูู TensorFlow Hub. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/o5/we/9d/o5we9dvkdtaomahwj4nzomgquca.png"></p><br><p style=";text-align:right;direction:rtl">  ูุญุชูู TensorFlow Hub ุนูู ุจุนุถ ุงูููุงุฐุฌ ุงููุฏุฑุจุฉ ูุณุจููุง ูุงูุชู ุชู ูููุง ุงุณุชุจุนุงุฏ ุทุจูุฉ ุงูุชุตููู ุงูุฃุฎูุฑุฉ ูู ุจููุฉ ุงูุดุจูุฉ ุงูุนุตุจูุฉ ูุฅุนุงุฏุฉ ุงุณุชุฎุฏุงููุง ูุงุญููุง. </p><br><p style=";text-align:right;direction:rtl">  ููููู ุงุณุชุฎุฏุงู TensorFlow Hub ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูู ุนุฏุฉ ุฃุณุทุฑ: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/1h/ai/hg/1haihgg1llinsfv_wyhde4z0egy.png"></p><br><p style=";text-align:right;direction:rtl">  ูููู ุชุญุฏูุฏ ุนููุงู URL ุงูุฎุงุต ุจูุชุฌู ุงูููุฒุฉ ูู ูููุฐุฌ ุงูุชุฏุฑูุจ ุงููุฑุบูุจ ููู ุ ุซู ุชุถููู ุงููููุฐุฌ ูู ูุตูููุง ูุน ุงูุทุจูุฉ ุงูุฃุฎูุฑุฉ ูุน ุงูุนุฏุฏ ุงููุทููุจ ูู ูุฆุงุช ุงููุฎุฑุฌุงุช.  ุฅููุง ุงูุทุจูุฉ ุงูุฃุฎูุฑุฉ ุงูุชู ุณุชุฎุถุน ููุชุฏุฑูุจ ูุชุบููุฑ ููู ุงููุนููุงุช.  ูุชู ุชุฌููุน ูุชุฏุฑูุจ ูููุฐุฌูุง ุงูุฌุฏูุฏ ุจููุณ ุงูุทุฑููุฉ ุงูุชู ุงุชุจุนูุงูุง ูู ูุจู: </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/uh/cr/5e/uhcr5esktfnxtxwxfgutvttxbxk.png"></p><br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูุฑู ููู ุณุชุนูู ูู ุงููุงูุน ููุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุงุณุจุฉ. </p><br><h1 style=";text-align:right;direction:rtl">  CoLab: ุงููุทุท ููุงุจู ุงูููุงุจ ูุน ููู ุงูุชุฏุฑูุจ </h1><br><p style=";text-align:right;direction:rtl">  ุฑุงุจุท <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CoLab ุจุงููุบุฉ ุงูุฑูุณูุฉ</a> ู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">CoLab ุจุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</a> . </p><br><p style=";text-align:right;direction:rtl">  TensorFlow Hub ุนุจุงุฑุฉ ุนู ูุณุชูุฏุน ุจู ููุงุฐุฌ ุชู ุชุฏุฑูุจูุง ูุณุจููุง ูููููุง ุงุณุชุฎุฏุงููุง. </p><br><p style=";text-align:right;direction:rtl">  ููู ุงูุชุนูู ูู ุนูููุฉ ูุฃุฎุฐ ูููุง ูููุฐุฌูุง ุชู ุชุฏุฑูุจู ูุณุจููุง ูููุณุนู ูุฃุฏุงุก ูููุฉ ูุญุฏุฏุฉ.  ูู ุงูููุช ููุณู ุ ูุชุฑู ุฌุฒุก ุงููููุฐุฌ ุงูููุฏุฑููุจ ูุณุจููุง ูุงูุฐู ูุฏูุฌู ูู ุงูุดุจูุฉ ุงูุนุตุจูุฉ ุฏูู ูุณุงุณ ุ ูููู ููุท ูุฏุฑุจ ุทุจูุงุช ุงูุฅุฎุฑุงุฌ ุงูุฃุฎูุฑุฉ ููุญุตูู ุนูู ุงููุชูุฌุฉ ุงููุฑุฌูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุฌุฒุก ุงูุนููู ุ ุณูุฎุชุจุฑ ููุง ุงูุฎูุงุฑูู. </p><br><p style=";text-align:right;direction:rtl">  ูุชูุญ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง ุงูุฑุงุจุท</a> ุงุณุชูุดุงู ุงููุงุฆูุฉ ุงููุงููุฉ ููุทุฑุฒ ุงููุชููุฑุฉ. </p><br><p style=";text-align:right;direction:rtl">  <strong>ูู ูุฐุง ุงูุฌุฒุก ูู ูููุงุจ</strong> </p><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุณูู ูุณุชุฎุฏู ูููุฐุฌ TensorFlow Hub ููุชูุจุคุงุช ุ </li><li style=";text-align:right;direction:rtl">  ุณูู ูุณุชุฎุฏู ูููุฐุฌ TensorFlow Hub ููุฌููุนุฉ ุจูุงูุงุช ุงููุทุท ูุงูููุงุจ ุ </li><li style=";text-align:right;direction:rtl">  ุฏุนูุง ูููู ุงูุชุฏุฑูุจ ุจุงุณุชุฎุฏุงู ุงููููุฐุฌ ูู TensorFlow Hub. </li></ol><br><p style=";text-align:right;direction:rtl"> ูุจู ุงูุดุฑูุน ูู ุชูููุฐ ุงูุฌุฒุก ุงูุนููู ุงูุญุงูู ุ ููุตู ุจุฅุนุงุฏุฉ ุชุนููู <code>Runtime -&gt; Reset all runtimes...</code> </p><br><p style=";text-align:right;direction:rtl">  <strong>ูุงุฑุฏุงุช ุงูููุชุจุฉ</strong> </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุฌุฒุก ุงูุนููู ุ ุณูู ูุณุชุฎุฏู ุนุฏุฏูุง ูู ููุฒุงุช ููุชุจุฉ TensorFlow ุงูุชู ูู ุชุตุฏุฑ ุจุนุฏ ูู ุงูุฅุตุฏุงุฑ ุงูุฑุณูู.  ูุฐุง ูู ุงูุณุจุจ ูู ุฃููุง ุณูููู ุฃููุงู ุจุชุซุจูุช ุฅุตุฏุงุฑ TensorFlow ู TensorFlow Hub ูููุทูุฑูู. </p><br><p style=";text-align:right;direction:rtl">  ูุคุฏู ุชุซุจูุช ุฅุตุฏุงุฑ dev ูู TensorFlow ุฅูู ุชูุดูุท ุฃุญุฏุซ ุฅุตุฏุงุฑ ูุซุจุช ุชููุงุฆููุง.  ุจุนุฏ ุงูุงูุชูุงุก ูู ุงูุชุนุงูู ูุน ูุฐุง ุงูุฌุฒุก ุงูุนููู ุ ููุตู ุจุงุณุชุนุงุฏุฉ ุฅุนุฏุงุฏุงุช TensorFlow ูุงูุนูุฏุฉ ุฅูู ุงูุฅุตุฏุงุฑ ุงูุซุงุจุช ุนุจุฑ ุนูุตุฑ ุงููุงุฆูุฉ <code>Runtime -&gt; Reset all runtimes...</code>  ุณูุคุฏู ุชูููุฐ ูุฐุง ุงูุฃูุฑ ุฅูู ุฅุนุงุฏุฉ ุชุนููู ุฌููุน ุฅุนุฏุงุฏุงุช ุงูุจูุฆุฉ ุฅูู ุงูุฅุนุฏุงุฏุงุช ุงูุฃุตููุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">!pip install tf-nightly-gpu !pip install <span class="hljs-string"><span class="hljs-string">"tensorflow_hub==0.4.0"</span></span> !pip install -U tensorflow_datasets</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Requirement already satisfied: absl-py&gt;=0.7.0 in /usr/local/lib/python3.6/dist-packages (from tf-nightly-gpu) (0.8.0) Requirement already satisfied: protobuf&gt;=3.6.1 in /usr/local/lib/python3.6/dist-packages (from tf-nightly-gpu) (3.7.1) Requirement already satisfied: google-pasta&gt;=0.1.6 in /usr/local/lib/python3.6/dist-packages (from tf-nightly-gpu) (0.1.7) Collecting tf-estimator-nightly (from tf-nightly-gpu) Downloading https://files.pythonhosted.org/packages/ea/72/f092fc631ef2602fd0c296dcc4ef6ef638a6a773cb9fdc6757fecbfffd33/tf_estimator_nightly-1.14.0.dev2019092201-py2.py3-none-any.whl (450kB) |โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ| 450kB 45.9MB/s Requirement already satisfied: numpy&lt;2.0,&gt;=1.16.0 in /usr/local/lib/python3.6/dist-packages (from tf-nightly-gpu) (1.16.5) Requirement already satisfied: wrapt&gt;=1.11.1 in /usr/local/lib/python3.6/dist-packages (from tf-nightly-gpu) (1.11.2) Requirement already satisfied: astor&gt;=0.6.0 in /usr/local/lib/python3.6/dist-packages (from tf-nightly-gpu) (0.8.0) Requirement already satisfied: opt-einsum&gt;=2.3.2 in /usr/local/lib/python3.6/dist-packages (from tf-nightly-gpu) (3.0.1) Requirement already satisfied: wheel&gt;=0.26 in /usr/local/lib/python3.6/dist-packages (from tf-nightly-gpu) (0.33.6) Requirement already satisfied: h5py in /usr/local/lib/python3.6/dist-packages (from keras-applications&gt;=1.0.8-&gt;tf-nightly-gpu) (2.8.0) Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.6/dist-packages (from tb-nightly&lt;1.16.0a0,&gt;=1.15.0a0-&gt;tf-nightly-gpu) (3.1.1) Requirement already satisfied: setuptools&gt;=41.0.0 in /usr/local/lib/python3.6/dist-packages (from tb-nightly&lt;1.16.0a0,&gt;=1.15.0a0-&gt;tf-nightly-gpu) (41.2.0) Requirement already satisfied: werkzeug&gt;=0.11.15 in /usr/local/lib/python3.6/dist-packages (from tb-nightly&lt;1.16.0a0,&gt;=1.15.0a0-&gt;tf-nightly-gpu) (0.15.6) Installing collected packages: tb-nightly, tf-estimator-nightly, tf-nightly-gpu Successfully installed tb-nightly-1.15.0a20190911 tf-estimator-nightly-1.14.0.dev2019092201 tf-nightly-gpu-1.15.0.dev20190821 Collecting tensorflow_hub==0.4.0 Downloading https://files.pythonhosted.org/packages/10/5c/6f3698513cf1cd730a5ea66aec665d213adf9de59b34f362f270e0bd126f/tensorflow_hub-0.4.0-py2.py3-none-any.whl (75kB) |โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ| 81kB 5.0MB/s Requirement already satisfied: protobuf&gt;=3.4.0 in /usr/local/lib/python3.6/dist-packages (from tensorflow_hub==0.4.0) (3.7.1) Requirement already satisfied: numpy&gt;=1.12.0 in /usr/local/lib/python3.6/dist-packages (from tensorflow_hub==0.4.0) (1.16.5) Requirement already satisfied: six&gt;=1.10.0 in /usr/local/lib/python3.6/dist-packages (from tensorflow_hub==0.4.0) (1.12.0) Requirement already satisfied: setuptools in /usr/local/lib/python3.6/dist-packages (from protobuf&gt;=3.4.0-&gt;tensorflow_hub==0.4.0) (41.2.0) Installing collected packages: tensorflow-hub Found existing installation: tensorflow-hub 0.6.0 Uninstalling tensorflow-hub-0.6.0: Successfully uninstalled tensorflow-hub-0.6.0 Successfully installed tensorflow-hub-0.4.0 Collecting tensorflow_datasets Downloading https://files.pythonhosted.org/packages/6c/34/ff424223ed4331006aaa929efc8360b6459d427063dc59fc7b75d7e4bab3/tensorflow_datasets-1.2.0-py3-none-any.whl (2.3MB) |โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ| 2.3MB 4.9MB/s Requirement already satisfied, skipping upgrade: future in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (0.16.0) Requirement already satisfied, skipping upgrade: wrapt in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (1.11.2) Requirement already satisfied, skipping upgrade: dill in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (0.3.0) Requirement already satisfied, skipping upgrade: numpy in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (1.16.5) Requirement already satisfied, skipping upgrade: requests&gt;=2.19.0 in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (2.21.0) Requirement already satisfied, skipping upgrade: tqdm in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (4.28.1) Requirement already satisfied, skipping upgrade: protobuf&gt;=3.6.1 in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (3.7.1) Requirement already satisfied, skipping upgrade: psutil in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (5.4.8) Requirement already satisfied, skipping upgrade: promise in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (2.2.1) Requirement already satisfied, skipping upgrade: absl-py in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (0.8.0) Requirement already satisfied, skipping upgrade: tensorflow-metadata in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (0.14.0) Requirement already satisfied, skipping upgrade: six in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (1.12.0) Requirement already satisfied, skipping upgrade: termcolor in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (1.1.0) Requirement already satisfied, skipping upgrade: attrs in /usr/local/lib/python3.6/dist-packages (from tensorflow_datasets) (19.1.0) Requirement already satisfied, skipping upgrade: idna&lt;2.9,&gt;=2.5 in /usr/local/lib/python3.6/dist-packages (from requests&gt;=2.19.0-&gt;tensorflow_datasets) (2.8) Requirement already satisfied, skipping upgrade: certifi&gt;=2017.4.17 in /usr/local/lib/python3.6/dist-packages (from requests&gt;=2.19.0-&gt;tensorflow_datasets) (2019.6.16) Requirement already satisfied, skipping upgrade: chardet&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests&gt;=2.19.0-&gt;tensorflow_datasets) (3.0.4) Requirement already satisfied, skipping upgrade: urllib3&lt;1.25,&gt;=1.21.1 in /usr/local/lib/python3.6/dist-packages (from requests&gt;=2.19.0-&gt;tensorflow_datasets) (1.24.3) Requirement already satisfied, skipping upgrade: setuptools in /usr/local/lib/python3.6/dist-packages (from protobuf&gt;=3.6.1-&gt;tensorflow_datasets) (41.2.0) Requirement already satisfied, skipping upgrade: googleapis-common-protos in /usr/local/lib/python3.6/dist-packages (from tensorflow-metadata-&gt;tensorflow_datasets) (1.6.0) Installing collected packages: tensorflow-datasets Successfully installed tensorflow-datasets-1.2.0</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุฏ ุฑุฃููุง ุจุงููุนู ูุงุณุชุฎุฏููุง ุจุนุถ ุงููุงุฑุฏุงุช ูู ูุจู.  ูู ุงูุฌุฏูุฏ - ุงุณุชูุฑุงุฏ <code>tensorflow_hub</code> ุ ุงูุฐู ูููุง ุจุชุซุจูุชู ูุงูุฐู <code>tensorflow_hub</code> ูู ูุฐุง ุงูุฌุฒุก ุงูุนููู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import, division, print_function, unicode_literals <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pylab <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf tf.enable_eager_execution() <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow_hub <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> hub <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow_datasets <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tfds <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow.keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> layers</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">WARNING:tensorflow: TensorFlow's `tf-nightly` package will soon be updated to TensorFlow 2.0. Please upgrade your code to TensorFlow 2.0: * https://www.tensorflow.org/beta/guide/migration_guide Or install the latest stable TensorFlow 1.X release: * `pip install -U "tensorflow==1.*"` Otherwise your code may be broken by the change.</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging logger = tf.get_logger() logger.setLevel(logging.ERROR)</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ุงูุฌุฒุก 1: ุงุณุชุฎุฏุงู TensorFlow Hub MobileNet ููุชูุจุคุงุช</strong> </p><br><p style=";text-align:right;direction:rtl">  ูู ูุฐุง ุงูุฌุฒุก ูู CoLab ุ ุณูู ูุฃุฎุฐ ูููุฐุฌูุง ููุฏุฑููุจ ูุณุจููุง ุ ููููู ุจุชุญูููู ุฅูู Keras ูุงุฎุชุจุงุฑู. </p><br><p style=";text-align:right;direction:rtl">  ุงููููุฐุฌ ุงูุฐู ูุณุชุฎุฏูู ูู MobileNet v2 (ุจุฏูุงู ูู MobileNet ุ ูููู ุงุณุชุฎุฏุงู ุฃู ูููุฐุฌ ุชุตููู ุตูุฑ ูุชูุงูู ูุน tf2 ูุน tfhub.dev). </p><br><p style=";text-align:right;direction:rtl">  <strong>ุชุญููู ุงููุตูู</strong> </p><br><p style=";text-align:right;direction:rtl">  ูู ุจุชูุฒูู ูููุฐุฌ MobileNet ูุฅูุดุงุก ูููุฐุฌ Keras ููู.  ุชุชููุน MobileNet ุนูุฏ ุงูุฅุฏุฎุงู ุชููู ุตูุฑุฉ ุจุญุฌู 224 ร 216 ุจูุณู ูุน 3 ูููุงุช ููููุฉ (RGB). </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">CLASSIFIER_URL = <span class="hljs-string"><span class="hljs-string">"https://tfhub.dev/google/tf2-preview/mobilenet_v2/classification/2"</span></span> IMAGE_RES = <span class="hljs-number"><span class="hljs-number">224</span></span> model = tf.keras.Sequential([ hub.KerasLayer(CLASSIFIER_URL, input_shape=(IMAGE_RES, IMAGE_RES, <span class="hljs-number"><span class="hljs-number">3</span></span>)) ])</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ูู ุจุชุดุบูู ุงููุตูู ุนูู ุตูุฑุฉ ูุงุญุฏุฉ</strong> </p><br><p style=";text-align:right;direction:rtl">  ุชู ุชุฏุฑูุจ MobileNet ุนูู ูุฌููุนุฉ ุจูุงูุงุช ImageNet.  ImageNet ูุญุชูู ุนูู 1000 ูุฆุฉ ุงูุฅุฎุฑุงุฌ ูุงุญุฏุฉ ูู ูุฐู ุงููุฆุงุช ูู ุงูุฒู ุงูุนุณูุฑู.  ุฏุนููุง ูุฌุฏ ุงูุตูุฑุฉ ุงูุชู ุณูุชู ูุถุน ุงูุฒู ุงูุนุณูุฑู ุนูููุง ูุงูุชู ูู ุชููู ุฌุฒุกูุง ูู ูุฌููุนุฉ ุฃุฏูุงุช ุชุฏุฑูุจ ImageNet ููุชุญูู ูู ุฏูุฉ ุงูุชุตููู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> PIL.Image <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Image grace_hopper = tf.keras.utils.get_file(<span class="hljs-string"><span class="hljs-string">'image.jpg'</span></span>, <span class="hljs-string"><span class="hljs-string">'https://storage.googleapis.com/download.tensorflow.org/example_images/grace_hopper.jpg'</span></span>) grace_hopper = Image.open(grace_hopper).resize((IMAGE_RES, IMAGE_RES)) grace_hopper</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Downloading data from https://storage.googleapis.com/download.tensorflow.org/example_images/grace_hopper.jpg 65536/61306 [================================] - 0s 0us/step</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/8g/gn/0u/8ggn0ur3pmnr_rxvezfdo4vrwcc.png"></p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">grace_hopper = np.array(grace_hopper)/<span class="hljs-number"><span class="hljs-number">255.0</span></span> grace_hopper.shape</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">(224, 224, 3)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุถุน ูู ุงุนุชุจุงุฑู ุฃู ุงูููุงุฐุฌ ุชุชููู ุฏุงุฆููุง ูุฌููุนุฉ (ูุชูุฉ) ูู ุงูุตูุฑ ูููุนุงูุฌุฉ ุนูุฏ ุงูุฅุฏุฎุงู.  ูู ุงูููุฏ ุฃุฏูุงู ุ ูุถูู ุจุนุฏูุง ุฌุฏูุฏูุง - ุญุฌู ุงููุชูุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">result = model.predict(grace_hopper[np.newaxis, ...]) result.shape</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">(1, 1001)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุงูุช ูุชูุฌุฉ ุงูุชูุจุค ุนุจุงุฑุฉ ุนู ูุชุฌู ุจุญุฌู 1001 ุนูุตุฑูุง ุ ุญูุซ ุชูุซู ูู ูููุฉ ุงุญุชูุงู ุฃู ููุชูู ุงููุงุฆู ูู ุงูุตูุฑุฉ ุฅูู ูุฆุฉ ูุนููุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูููู ุงูุนุซูุฑ ุนูู ููุถุน ุงูุญุฏ ุงูุฃูุตู ููููุฉ ุงูุงุญุชูุงู ุจุงุณุชุฎุฏุงู ุฏุงูุฉ <code>argmax</code> .  ููุน ุฐูู ุ ููุงู ุณุคุงู ูุง ุฒููุง ูู ูุฌูุจ ุนููู ุจุนุฏ - ููู ูููููุง ุชุญุฏูุฏ ุงููุฆุฉ ุงูุชู ููุชูู ุฅูููุง ุงูุนูุตุฑ ูุน ุฃูุตู ุงูุงุญุชูุงูุงุชุ </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">predicted_class = np.argmax(result[<span class="hljs-number"><span class="hljs-number">0</span></span>], axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>) predicted_class</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">653</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ูู ุฑููุฒ ุงูุชููุนุงุช</strong> </p><br><p style=";text-align:right;direction:rtl">  ููู ูุชููู ูู ุชุญุฏูุฏ ุงููุฆุฉ ุงูุชู ุชุชุนูู ุจูุง ุงูุชููุนุงุช ุ ูููู ุจุชุญููู ูุงุฆูุฉ ุนูุงูุงุช ImageNet ููู ุฎูุงู ุงูููุฑุณ ุจุฃูุตู ุฏุฑุฌุงุช ุงูุฏูุฉ ุ ูููู ุจุชุญุฏูุฏ ุงููุฆุฉ ุงูุชู ูุฑุชุจุท ุจูุง ุงูุชููุน. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">labels_path = tf.keras.utils.get_file(<span class="hljs-string"><span class="hljs-string">'ImageNetLabels.txt'</span></span>,<span class="hljs-string"><span class="hljs-string">'https://storage.googleapis.com/download.tensorflow.org/data/ImageNetLabels.txt'</span></span>) imagenet_labels = np.array(open(labels_path).read().splitlines()) plt.imshow(grace_hopper) plt.axis(<span class="hljs-string"><span class="hljs-string">'off'</span></span>) predicted_class_name = imagenet_labels[predicted_class] _ = plt.title(<span class="hljs-string"><span class="hljs-string">"Prediction: "</span></span> + predicted_class_name.title())</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Downloading data from https://storage.googleapis.com/download.tensorflow.org/data/ImageNetLabels.txt 16384/10484 [==============================================] - 0s 0us/step</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ai/1k/rt/ai1krt6mkpcafhb5jx8ozf6mq8s.png"></p><br><p style=";text-align:right;direction:rtl">  ุงูุจูุบู!  ุญุฏุฏ ูููุฐุฌูุง ุงูุฒู ุงูุนุณูุฑู ุจุดูู ุตุญูุญ. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุฌุฒุก 2: ุงุณุชุฎุฏุงู ูููุฐุฌ TensorFlow Hub ููุฌููุนุฉ ุจูุงูุงุช ุงููุท ูุงูููุจ</strong> </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุณูู ูุณุชุฎุฏู ุงููุณุฎุฉ ุงููุงููุฉ ูู ูููุฐุฌ MobileNet ููุฑู ููู ุณูุชุนุงูู ูุน ูุฌููุนุฉ ุจูุงูุงุช ุงููุทุท ูุงูููุงุจ. </p><br><p style=";text-align:right;direction:rtl">  <strong>ูุฌููุนุฉ ุงูุจูุงูุงุช</strong> </p><br><p style=";text-align:right;direction:rtl">  ูููููุง ุงุณุชุฎุฏุงู TensorFlow Datasets ูุชูุฒูู ูุฌููุนุฉ ุจูุงูุงุช ุงููุท ูุงูููุจ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">splits = tfds.Split.ALL.subsplit(weighted=(<span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>)) splits, info = tfds.load(<span class="hljs-string"><span class="hljs-string">'cats_vs_dogs'</span></span>, with_info=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, as_supervised=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, split = splits) (train_examples, validation_examples) = splits num_examples = info.splits[<span class="hljs-string"><span class="hljs-string">'train'</span></span>].num_examples num_classes = info.features[<span class="hljs-string"><span class="hljs-string">'label'</span></span>].num_classes</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Downloading and preparing dataset cats_vs_dogs (786.68 MiB) to /root/tensorflow_datasets/cats_vs_dogs/2.0.1... /usr/local/lib/python3.6/dist-packages/urllib3/connectionpool.py:847: InsecureRequestWarning: Unverified HTTPS request is being made. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/latest/advanced-usage.html#ssl-warnings InsecureRequestWarning) WARNING:absl:1738 images were corrupted and were skipped Dataset cats_vs_dogs downloaded and prepared to /root/tensorflow_datasets/cats_vs_dogs/2.0.1. Subsequent calls will reuse this data.</code> </pre><br><p style=";text-align:right;direction:rtl">  ููุณุช ูู ุงูุตูุฑ ูู ูุฌููุนุฉ ุจูุงูุงุช ุงููุท ูุงูููุจ ุจููุณ ุงูุญุฌู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, example_image <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(train_examples.take(<span class="hljs-number"><span class="hljs-number">3</span></span>)): print(<span class="hljs-string"><span class="hljs-string">"Image {} shape: {}"</span></span>.format(i+<span class="hljs-number"><span class="hljs-number">1</span></span>, example_image[<span class="hljs-number"><span class="hljs-number">0</span></span>].shape))</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Image 1 shape: (500, 343, 3) Image 2 shape: (375, 500, 3) Image 3 shape: (375, 500, 3)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฐูู ุ ุชุชุทูุจ ุงูุตูุฑ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุชู ุชู ุงูุญุตูู ุนูููุง ุชูููู ุงูุญุฌู ุฅูู ุญุฌู ูุงุญุฏ ุ ูุงูุฐู ูุชููุนู ุทุฑุงุฒ MobileNet ุนูุฏ ุงูุฅุฏุฎุงู - 224 ร 224. </p><br><p style=";text-align:right;direction:rtl">  ูุธููุฉ <code>.repeat()</code> ู <code>steps_per_epoch</code> ุบูุฑ ูุทููุจุฉ ููุง ุ ููููุง ุชุชูุญ ูู ุชูููุฑ ุญูุงูู 15 ุซุงููุฉ ููู ุชูุฑุงุฑ ุชุฏุฑูุจ ุ ูุฃู  ูุฌุจ ุชููุฆุฉ ุงููุฎุฒู ุงููุคูุช ุงููุคูุช ูุฑุฉ ูุงุญุฏุฉ ููุท ูู ุจุฏุงูุฉ ุนูููุฉ ุงูุชุนูู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">format_image</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(image, label)</span></span></span><span class="hljs-function">:</span></span> image = tf.image.resize(image, (IMAGE_RES, IMAGE_RES)) / <span class="hljs-number"><span class="hljs-number">255.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> image, label BATCH_SIZE = <span class="hljs-number"><span class="hljs-number">32</span></span> train_batches = train_examples.shuffle(num_examples//<span class="hljs-number"><span class="hljs-number">4</span></span>).map(format_image).batch(BATCH_SIZE).prefetch(<span class="hljs-number"><span class="hljs-number">1</span></span>) validation_batches = validation_examples.map(format_image).batch(BATCH_SIZE).prefetch(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ูู ุจุชุดุบูู ุงููุตูู ุนูู ูุฌููุนุงุช ุงูุตูุฑ</strong> </p><br><p style=";text-align:right;direction:rtl">  ุงุณูุญูุง ูู ุฃู ุฃุฐูุฑู ุจุฃูู ูู ูุฐู ุงููุฑุญูุฉ ุ ูุง ุชุฒุงู ููุงู ูุณุฎุฉ ูุงููุฉ ูู ุดุจูุฉ MobileNet ุงููุฏุฑุจุฉ ูุณุจููุง ุ ูุงูุชู ุชุญุชูู ุนูู 1000 ูุฆุฉ ูุฎุฑุฌุงุช ููููุฉ.  ูุญุชูู ImageNet ุนูู ุนุฏุฏ ูุจูุฑ ูู ุงูุตูุฑ ููููุงุจ ูุงููุทุท ุ ูุฐูู ุฏุนููุง ูุญุงูู ุฅุฏุฎุงู ูุงุญุฏุฉ ูู ุตูุฑ ุงูุงุฎุชุจุงุฑ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง ููุนุฑูุฉ ุงูุชูุจุค ุงูุฐู ุณูู ููุฏูู ููุง ุงููููุฐุฌ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">image_batch, label_batch = next(iter(train_batches.take(<span class="hljs-number"><span class="hljs-number">1</span></span>))) image_batch = image_batch.numpy() label_batch = label_batch.numpy() result_batch = model.predict(image_batch) predicted_class_names = imagenet_labels[np.argmax(result_batch, axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>)] predicted_class_names</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">array(['Persian cat', 'mink', 'Siamese cat', 'tabby', 'Bouvier des Flandres', 'dishwasher', 'Yorkshire terrier', 'tiger cat', 'tabby', 'Egyptian cat', 'Egyptian cat', 'tabby', 'dalmatian', 'Persian cat', 'Border collie', 'Newfoundland', 'tiger cat', 'Siamese cat', 'Persian cat', 'Egyptian cat', 'tabby', 'tiger cat', 'Labrador retriever', 'German shepherd', 'Eskimo dog', 'kelpie', 'mink', 'Norwegian elkhound', 'Labrador retriever', 'Egyptian cat', 'computer keyboard', 'boxer'], dtype='&lt;U30')</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุชุณููุงุช ุชุดุจู ุฃุณูุงุก ุณูุงูุงุช ุงููุทุท ูุงูููุงุจ.  ุฏุนููุง ุงูุขู ูุนุฑุถ ุจุนุถ ุงูุตูุฑ ูู ูุฌููุนุฉ ุจูุงูุงุช ุงููุทุท ูุงูููุงุจ ูุฏููุง ููุถุน ููุตููุง ูุชููุนูุง ุนูู ูู ูููุง. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">30</span></span>): plt.subplot(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, n+<span class="hljs-number"><span class="hljs-number">1</span></span>) plt.subplots_adjust(hspace=<span class="hljs-number"><span class="hljs-number">0.3</span></span>) plt.imshow(image_batch[n]) plt.title(predicted_class_names[n]) plt.axis(<span class="hljs-string"><span class="hljs-string">'off'</span></span>) _ = plt.suptitle(<span class="hljs-string"><span class="hljs-string">"ImageNet predictions"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/fc/af/w-/fcafw-kdtzotffq7k-nihlntuda.png"></p><br><p style=";text-align:right;direction:rtl">  <strong>ุงูุฌุฒุก 3: ุชูููุฐ ููู ุงูุชุนูู ูุน TensorFlow Hub</strong> </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฏุนูุง ูุณุชุฎุฏู TensorFlow Hub ูููู ุงูุชุนูู ูู ูููุฐุฌ ุฅูู ุขุฎุฑ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุนูููุฉ ููู ุงูุชุฏุฑูุจ ุ ูุนูุฏ ุงุณุชุฎุฏุงู ูููุฐุฌ ูุงุญุฏ ููุฏุฑููุจ ูุณุจููุง ุนู ุทุฑูู ุชุบููุฑ ุขุฎุฑ ุทุจูุฉ ุฃู ุนุฏุฉ ุทุจูุงุช ุ ุซู ูุจุฏุฃ ุนูููุฉ ุงูุชุฏุฑูุจ ูุฑุฉ ุฃุฎุฑู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ุฌุฏูุฏุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูู TensorFlow Hub ุ ูุง ููููู ุงูุนุซูุฑ ุนูู ููุงุฐุฌ ูุงููุฉ ููุฏุฑููุจุฉ ูุณุจููุง (ูุน ุงูุทุจูุฉ ุงูุฃุฎูุฑุฉ) ูุญุณุจ ุ ุจู ููููู ุฃูุถูุง ุงูุนุซูุฑ ุนูู ููุงุฐุฌ ุฏูู ุทุจูุฉ ุงูุชุตููู ุงูุฃุฎูุฑุฉ.  ูุฐุง ุงูุฃุฎูุฑ ูููู ุงุณุชุฎุฏุงููุง ุจุณูููุฉ ูููู ุงูุชุฏุฑูุจ.  ุณูุณุชูุฑ ูู ุงุณุชุฎุฏุงู MobileNet v2 ูุณุจุจ ุจุณูุท ูู ุฃููุง ูู ุงูุฃุฌุฒุงุก ุงูุชุงููุฉ ูู ุงูุฏูุฑุฉ ุงูุชุฏุฑูุจูุฉ ุงูุฎุงุตุฉ ุจูุง ุณูููู ุจููู ูุฐุง ุงููููุฐุฌ ูุฅุทูุงูู ุนูู ุฌูุงุฒ ูุญููู ุจุงุณุชุฎุฏุงู TensorFlow Lite. </p><br><p style=";text-align:right;direction:rtl">  ุณูุณุชูุฑ ุฃูุถูุง ูู ุงุณุชุฎุฏุงู ูุฌููุนุฉ ุจูุงูุงุช ุงููุทุท ูุงูููุงุจ ุ ูุจุงูุชุงูู ุณูููู ูุฏููุง ุงููุฑุตุฉ ูููุงุฑูุฉ ุฃุฏุงุก ูุฐุง ุงููููุฐุฌ ูุน ุชูู ุงูุชู ูููุง ุจุชูููุฐูุง ูู ุงูุจุฏุงูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุงุญุธ ุฃููุง ุฃุทูููุง ุนูู ุงููููุฐุฌ ุงูุฌุฒุฆู ุจุงุณุชุฎุฏุงู TensorFlow Hub (ุจุฏูู ุทุจูุฉ ุงูุชุตููู ุงูุฃุฎูุฑุฉ) <code>feature_extractor</code> .  ูุชู ุชูุณูุฑ ูุฐุง ุงูุงุณู ูู ุฎูุงู ุญูููุฉ ุฃู ุงููููุฐุฌ ููุจู ุงูุจูุงูุงุช ููุฏุฎูุงุช ููุญูููุง ุฅูู ูุฌููุนุฉ ูุญุฏูุฏุฉ ูู ุงูุฎุตุงุฆุต ุงููุญุฏุฏุฉ (ุงูุฎุตุงุฆุต).  ูููุฐุง ุ ูุงู ูููุฐุฌูุง ุจูููุฉ ุชุญุฏูุฏ ูุญุชููุงุช ุงูุตูุฑุฉ ุ ูููู ูู ููุชุฌ ุชูุฒูุน ุงูุงุญุชูุงู ุงูููุงุฆู ุนูู ูุฆุงุช ุงูุฅุฎุฑุงุฌ.  ุงุณุชุฎุฑุงุฌ ุงููููุฐุฌ ูุฌููุนุฉ ูู ุงูุฎุตุงุฆุต ูู ุงูุตูุฑุฉ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">URL = <span class="hljs-string"><span class="hljs-string">'https://tfhub.dev/google/tf2-preview/mobilenet_v2/feature_vector/2'</span></span> feature_extractor = hub.KerasLayer(URL, input_shape=(IMAGE_RES, IMAGE_RES, <span class="hljs-number"><span class="hljs-number">3</span></span>))</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู ุจุชุดุบูู ูุฌููุนุฉ ูู ุงูุตูุฑ ูู ุฎูุงู <code>feature_extractor</code> ูุฅููุงุก ูุธุฑุฉ ุนูู ุงููููุฐุฌ ุงููุงุชุฌ (ุชูุณูู ุงูุฅุฎุฑุงุฌ).  32 - ุนุฏุฏ ุงูุตูุฑ ุ 1280 - ุนุฏุฏ ุงูุฎูุงูุง ุงูุนุตุจูุฉ ูู ุงูุทุจูุฉ ุงูุฃุฎูุฑุฉ ูู ุงููููุฐุฌ ุงููุฏุฑูุจ ูุณุจููุง ูุน TensorFlow Hub. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">feature_batch = feature_extractor(image_batch) print(feature_batch.shape)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">(32, 1280)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู "ุจุชุฌููุฏ" ุงููุชุบูุฑุงุช ูู ุทุจูุฉ ุงุณุชุฎุฑุงุฌ ุงูุฎุงุตูุฉ ุญุชู ุชุชุบูุฑ ููุท ููู ูุชุบูุฑุงุช ุทุจูุฉ ุงูุชุตููู ุฃุซูุงุก ุนูููุฉ ุงูุชุฏุฑูุจ. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">feature_extractor.trainable = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ุฅุถุงูุฉ ุทุจูุฉ ุงูุชุตููู</strong> </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูู ุจูู ุงูุทุจูุฉ ูู TensorFlow Hub ูู ูููุฐุฌ <code>tf.keras.Sequential</code> ูุฃุถู ุทุจูุฉ ุชุตููู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = tf.keras.Sequential([ feature_extractor, layers.Dense(<span class="hljs-number"><span class="hljs-number">2</span></span>, activation=<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>) ]) model.summary()</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Model: "sequential_1" _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= keras_layer_1 (KerasLayer) (None, 1280) 2257984 _________________________________________________________________ dense (Dense) (None, 2) 2562 ================================================================= Total params: 2,260,546 Trainable params: 2,562 Non-trainable params: 2,257,984 _________________________________________________________________</code> </pre> <br><p style=";text-align:right;direction:rtl">  <strong>ูููุฐุฌ ุงููุทุงุฑ</strong> </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ูููู ุจุชุฏุฑูุจ ุงููููุฐุฌ ุงููุงุชุฌ ุจุงูุทุฑููุฉ ุงูุชู ูุนููุงูุง ูุจู ุงุณุชุฏุนุงุก <code>compile</code> ูููู ุงูุชุฏุฑูุจ <code>fit</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model.compile( optimizer=<span class="hljs-string"><span class="hljs-string">'adam'</span></span>, loss=<span class="hljs-string"><span class="hljs-string">'sparse_categorical_crossentropy'</span></span>, metrics=[<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>] ) EPOCHS = <span class="hljs-number"><span class="hljs-number">6</span></span> history = model.fit(train_batches, epochs=EPOCHS, validation_data=validation_batches)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Epoch 1/6 582/582 [==============================] - 77s 133ms/step - loss: 0.2381 - acc: 0.9346 - val_loss: 0.0000e+00 - val_acc: 0.0000e+00 Epoch 2/6 582/582 [==============================] - 70s 120ms/step - loss: 0.1827 - acc: 0.9618 - val_loss: 0.1629 - val_acc: 0.9670 Epoch 3/6 582/582 [==============================] - 69s 119ms/step - loss: 0.1733 - acc: 0.9660 - val_loss: 0.1623 - val_acc: 0.9666 Epoch 4/6 582/582 [==============================] - 69s 118ms/step - loss: 0.1677 - acc: 0.9676 - val_loss: 0.1627 - val_acc: 0.9677 Epoch 5/6 582/582 [==============================] - 68s 118ms/step - loss: 0.1636 - acc: 0.9689 - val_loss: 0.1634 - val_acc: 0.9675 Epoch 6/6 582/582 [==============================] - 69s 118ms/step - loss: 0.1604 - acc: 0.9701 - val_loss: 0.1643 - val_acc: 0.9668</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ูุงุญุธุช ุนูู ุงูุฃุฑุฌุญ ุ ุชูููุง ูู ุชุญููู ~ 97 ูช ุฏูุฉ ุงูุชูุจุคุงุช ุนูู ูุฌููุนุฉ ุจูุงูุงุช ุงูุชุญูู ูู ุงูุตุญุฉ.  ุฑุงุฆุน!  ููุฏ ุฃุฏู ุงูููุฌ ุงูุญุงูู ุฅูู ุฒูุงุฏุฉ ุฏูุฉ ุงูุชุตููู ุจุดูู ูุจูุฑ ููุงุฑูุฉู ุจุงููููุฐุฌ ุงูุฃูู ุงูุฐู ูููุง ุจุชุฏุฑูุจ ุฃููุณูุง ุนููู ูุญุตููุง ุนูู ุฏูุฉ ุชุตููู ุชุตู ุฅูู 87ูช ุชูุฑูุจูุง.  ูุงูุณุจุจ ูู ุฃู MobileNet ุตููู ุฎุจุฑุงุก ูุชู ุชุทููุฑู ุจุนูุงูุฉ ุนูู ูุฏุงุฑ ูุชุฑุฉ ุฒูููุฉ ุทูููุฉ ุ ุซู ุชุฏุฑูุจูู ุนูู ูุฌููุนุฉ ุจูุงูุงุช ImageNet ูุจูุฑุฉ ุจุดูู ูุง ูุตุฏู. </p><br><p style=";text-align:right;direction:rtl">  ููููู ูุนุฑูุฉ ููููุฉ ุฅูุดุงุก MobileNet ุงูุฎุงุต ุจู ูู Keras ุนูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฐุง ุงูุฑุงุจุท</a> . </p><br><p style=";text-align:right;direction:rtl">  ูููู ุจุจูุงุก ุฑุณูู ุจูุงููุฉ ููุชุบูุฑุงุช ูู ููู ุงูุฏูุฉ ูุงูุฎุณุงุฑุฉ ูู ูุฌููุนุงุช ุจูุงูุงุช ุงูุชุฏุฑูุจ ูุงูุชุญูู. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">acc = history.history[<span class="hljs-string"><span class="hljs-string">'acc'</span></span>] val_acc = history.history[<span class="hljs-string"><span class="hljs-string">'val_acc'</span></span>] loss = history.history[<span class="hljs-string"><span class="hljs-string">'loss'</span></span>] val_loss = history.history[<span class="hljs-string"><span class="hljs-string">'val_loss'</span></span>] epochs_range = range(EPOCHS) plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)) plt.subplot(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) plt.plot(epochs_range, acc, label=<span class="hljs-string"><span class="hljs-string">'  '</span></span>) plt.plot(epochs_range, val_acc, label=<span class="hljs-string"><span class="hljs-string">'  '</span></span>) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'lower right'</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">'     '</span></span>) plt.subplot(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) plt.plot(epochs_range, loss, label=<span class="hljs-string"><span class="hljs-string">'  '</span></span>) plt.plot(epochs_range, val_loss, label=<span class="hljs-string"><span class="hljs-string">'  '</span></span>) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">'     '</span></span>) plt.show()</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/o7/5c/7a/o75c7aieqvmudmyglkroiddrm90.png"></p><br><p style=";text-align:right;direction:rtl">  ูุง ูุซูุฑ ุงูุงูุชูุงู ููุง ูู ุฃู ุงููุชุงุฆุฌ ูู ูุฌููุนุฉ ุจูุงูุงุช ุงูุชุญูู ูู ุงูุตุญุฉ ุฃูุถู ูู ุงููุชุงุฆุฌ ุงูููุฌูุฏุฉ ูู ูุฌููุนุฉ ุจูุงูุงุช ุงูุชุฏุฑูุจ ูู ุงูุจุฏุงูุฉ ุฅูู ููุงูุฉ ุนูููุฉ ุงูุชุนูู. </p><br><p style=";text-align:right;direction:rtl">  ุฃุญุฏ ุฃุณุจุงุจ ูุฐุง ุงูุณููู ูู ุฃู ุงูุฏูุฉ ูู ูุฌููุนุฉ ุจูุงูุงุช ุงูุชุญูู ูู ุงูุตุญุฉ ูุชู ููุงุณูุง ูู ููุงูุฉ ุงูุชูุฑุงุฑ ุงูุชุฏุฑูุจู ุ ููุง ุฃู ุงูุฏูุฉ ูู ูุฌููุนุฉ ุจูุงูุงุช ุงูุชุฏุฑูุจ ุชุนุชุจุฑ ุงููููุฉ ุงููุชูุณุทุฉ ุจูู ุฌููุน ุงูุชูุฑุงุฑุงุช ุงูุชุฏุฑูุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุงูุณุจุจ ุงูุฃูุจุฑ ููุฐุง ุงูุณููู ูู ุงุณุชุฎุฏุงู ุดุจูุฉ MobileNet ุงููุฑุนูุฉ ุงููุฏุฑุจุฉ ูุณุจููุง ุ ูุงูุชู ุชู ุชุฏุฑูุจูุง ูุณุจููุง ุนูู ูุฌููุนุฉ ูุจูุฑุฉ ูู ุงูุจูุงูุงุช ูู ุงููุทุท ูุงูููุงุจ.  ูู ุนูููุฉ ุงูุชุนูู ุ ุชูุงุตู ุดุจูุชูุง ุชูุณูุน ูุฌููุนุฉ ุจูุงูุงุช ุชุฏุฑูุจ ุงููุฏุฎูุงุช (ููุณ ุงูุชุนุฒูุฒ) ุ ูููู ููุณ ูุฌููุนุฉ ุงูุชุญูู ูู ุงูุตุญุฉ.  ูุฐุง ูุนูู ุฃู ุงูุตูุฑ ุงูุชู ุชู ุฅูุดุงุคูุง ุนูู ูุฌููุนุฉ ุจูุงูุงุช ุงูุชุฏุฑูุจ ุฃูุซุฑ ุตุนูุจุฉ ูู ุงูุชุตููู ูู ุงูุตูุฑ ุงูุนุงุฏูุฉ ูู ูุฌููุนุฉ ุงูุจูุงูุงุช ุงูุชู ุชู ุงูุชุญูู ูููุง. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุชุญูู ูุชุงุฆุฌ ุงูุชูุจุค</strong> </p><br><p style=";text-align:right;direction:rtl">  ูุชูุฑุงุฑ ุงูุฑุณู ุงูุจูุงูู ูู ุงููุณู ุงูุณุงุจู ุ ุชุญุชุงุฌ ุฃููุงู ุฅูู ุงูุญุตูู ุนูู ูุงุฆูุฉ ูุฑุชุจุฉ ุจุฃุณูุงุก ุงููุตูู ุงูุฏุฑุงุณูุฉ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">class_names = np.array(info.features[<span class="hljs-string"><span class="hljs-string">'label'</span></span>].names) class_names</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">array(['cat', 'dog'], dtype='&lt;U3')</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฑุฑ ุงููุชูุฉ ูุน ุงูุตูุฑ ูู ุฎูุงู ุงููููุฐุฌ ููู ุจุชุญููู ุงูููุงุฑุณ ุงููุงุชุฌุฉ ุฅูู ุฃุณูุงุก ุงููุฆุงุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">predicted_batch = model.predict(image_batch) predicted_batch = tf.squeeze(predicted_batch).numpy() predicted_ids = np.argmax(predicted_batch, axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>) predicted_class_names = class_names[predicted_ids] predicted_class_names</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">array(['cat', 'cat', 'cat', 'cat', 'dog', 'cat', 'dog', 'cat', 'cat', 'cat', 'cat', 'cat', 'dog', 'cat', 'cat', 'dog', 'cat', 'cat', 'cat', 'cat', 'cat', 'cat', 'dog', 'dog', 'dog', 'dog', 'cat', 'cat', 'dog', 'cat', 'cat', 'dog'], dtype='&lt;U3')</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฏุนูุง ูููู ูุธุฑุฉ ุนูู ุงูุนูุงูุงุช ุงูุญููููุฉ ูุชููุนูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">": "</span></span>, label_batch) print(<span class="hljs-string"><span class="hljs-string">": "</span></span>, predicted_ids)</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุงูุงุณุชูุชุงุฌ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">: [0 0 0 0 1 0 1 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 1 1 1 1 0 1 1 0 0 1] : [0 0 0 0 1 0 1 0 0 0 0 0 1 0 0 1 0 0 0 0 0 0 1 1 1 1 0 0 1 0 0 1]</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">30</span></span>): plt.subplot(<span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, n+<span class="hljs-number"><span class="hljs-number">1</span></span>) plt.subplots_adjust(hspace=<span class="hljs-number"><span class="hljs-number">0.3</span></span>) plt.imshow(image_batch[n]) color = <span class="hljs-string"><span class="hljs-string">"blue"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> predicted_ids[n] == label_batch[n] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-string"><span class="hljs-string">"red"</span></span> plt.title(predicted_class_names[n].title(), color=color) plt.axis(<span class="hljs-string"><span class="hljs-string">'off'</span></span>) _ = plt.suptitle(<span class="hljs-string"><span class="hljs-string">"  (: , : )"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/dc/ox/4w/dcox4wk3fek_1e2j9ltjmvai1ia.png"></p><br><h1 style=";text-align:right;direction:rtl">  ุงูุบูุต ูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ </h1><br><p style=";text-align:right;direction:rtl">  ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุ ุชูููุง ูู ุงูุชุฃูุฏ ูู ุฃููุง ุชุชุนุงูู ุจุดูู ุฌูุฏ ูุน ูููุฉ ุชุตููู ุงูุตูุฑ.  ููุน ุฐูู ุ ูู ุงูููุช ุงูุญุงูู ุ ูุง ูููููุง ุฃู ูุชุฎูู ุจุงููุงุฏ ููู ุชุนูู ุญููุง.  ุฅุฐุง ุชูููุง ูู ููู ููููุฉ ุญุฏูุซ ุนูููุฉ ุงูุชุนูู ุ ููููููุง ุ ูู ุญูุซ ุงููุจุฏุฃ ุ ุชุญุณูู ุนูู ุงูุชุตููู ุจุฏุฑุฌุฉ ุฃูุจุฑ.  ุชุชูุซู ุฅุญุฏู ุงูุทุฑู ูููู ููููุฉ ุนูู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ูู ุชุตูุฑ ุงูุทุจูุงุช ููุชุงุฆุฌ ุนูููุง.  ููุตู ุจุดุฏุฉ ุฃู ุชุฏุฑุณ ุงูููุงุฏ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ูููู ุฃูุถู ูููููุฉ ุชุตูุฑ ูุชุงุฆุฌ ุงูุทุจูุงุช ุงูุชูุงููููุฉ. </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/50f/d7a/3eb/50fd7a3eb31650740807d84eb8ff1da2.gif" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">  ุดูุฏ ูุฌุงู ุฑุคูุฉ ุงูููุจููุชุฑ ุงูุถูุก ูู ููุงูุฉ ุงูููู ูุญูู ุชูุฏููุง ูุจูุฑูุง ููุฐ ุธููุฑ ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ.  ุฃุนุทุช ุงูุณุฑุนุฉ ุงููุฐููุฉ ุงูุชู ูุชู ุจูุง ุฅุฌุฑุงุก ุงูุจุญูุซ ูู ูุฐุง ุงููุฌุงู ูุงููุตูููุงุช ุงูุถุฎูุฉ ูู ุงูุตูุฑ ุงูููุดูุฑุฉ ุนูู ุงูุฅูุชุฑูุช ูุชุงุฆุฌ ูุฐููุฉ ุฎูุงู ุงูุณููุงุช ุงูููููุฉ ุงููุงุถูุฉ.  ุจุฏุฃ ุธููุฑ ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ูุน AlexNet ูู ุนุงู 2012 ุ ูุงูุฐู ุชู ุฅูุดุงุคู ุจูุงุณุทุฉ Alex Krizhevsky ุ ู Ilya Sutskever ู Jeffrey Hinton ุ ููุงุฒ ุจุชุญุฏู ImageNet ุนูู ูุทุงู ูุงุณุน ููุชูููุฒ ุงููุฑุฆู.  ููุฐ ุฐูู ุงูุญูู ุ ูู ููู ููุงู ุดู ูู ุงููุณุชูุจู ุงููุดุฑู ุจุงุณุชุฎุฏุงู ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุ ููุฌุงู ุฑุคูุฉ ุงูููุจููุชุฑ ููุชุงุฆุฌ ุงูุนูู ููู ุฃูุฏุช ูุฐู ุงูุญูููุฉ ููุท.  ุจุฏุกูุง ูู ุงูุชุนุฑู ุนูู ูุฌูู ุนูู ุงููุงุชู ุงููุญููู ูุงูุชูุงุกู ุจุงูุงุนุชุฑุงู ุจุงูุฃุดูุงุก ุงูููุฌูุฏุฉ ูู ุงูุณูุงุฑุงุช ุงููุณุชููุฉ ุ ุชูููุช ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุจุงููุนู ูู ุฅุธูุงุฑ ูุฅุซุจุงุช ููุชูุง ูุญู ุงูุนุฏูุฏ ูู ุงููุดููุงุช ูู ุงูุนุงูู ุงููุงูุนู. </p><br><p style=";text-align:right;direction:rtl">  ุนูู ุงูุฑุบู ูู ุงูุนุฏุฏ ุงููุงุฆู ูู ูุฌููุนุงุช ุงูุจูุงูุงุช ุงูุถุฎูุฉ ูุงูููุงุฐุฌ ุงููุฏุฑุจุฉ ูุณุจููุง ููุดุจูุงุช ุงูุนุตุจูุฉ ุงูุชูุงููููุฉ ุ ูุตุนุจ ุฃุญูุงููุง ููู ููููุฉ ุนูู ุงูุดุจูุฉ ููุง ูุชู ุชุฏุฑูุจ ูุฐู ุงูุดุจูุฉ ุจุงูุถุจุท ุ ูุฎุงุตุฉ ููุฃุดุฎุงุต ุงูุฐูู ููุณ ูุฏููู ูุนุฑูุฉ ูุงููุฉ ูู ูุฌุงู ุงูุชุนูู ุงูุขูู.                 ,            , ,   Inception,   .                     .            ,    ,         ,         ,         . </p><br><p style=";text-align:right;direction:rtl">       "   Python"  <br> Franรงois Chollet.   ,        .    Keras,     ,   " " TensorFlow, MXNET  Theano.   ,        ,            .           ,       . </p><br><p style=";text-align:right;direction:rtl"> <strong>  </strong> </p><br><p style=";text-align:right;direction:rtl">            ,    ,           . </p><br><p style=";text-align:right;direction:rtl">             (training accuracy)     .         ,          ,        , ,   Inception,                . </p><br><p style=";text-align:right;direction:rtl">           ,       ,      .   Inception v3 (     ImageNet)     ,    Kaggle.         Inception,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">    </a> ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Inception v3</a>      . </p><br><p style=";text-align:right;direction:rtl">     10  ()     32 ,    2292293.           0.3195,     โ 0.6377.     <code>ImageDataGenerator</code>     ,      .       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">GitHub </a> . </p><br><p style=";text-align:right;direction:rtl"> <strong>  </strong> </p><br><p style=";text-align:right;direction:rtl">             ,    ""   ,      .               . </p><br><p style=";text-align:right;direction:rtl"> ,              Inception v3 ,        . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/d4c/ac1/6f5/d4cac16f506f3d14ab4cca070f4d876b.jpg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/222/102/eda/222102eda480f7108db0c9869ab46057.jpg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/ca8/176/7c0/ca81767c0f5cae4748f1db6cee625e01.jpg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">    โ     .             . </p><br><p style=";text-align:right;direction:rtl">         ,              ()   .        (),       , ,  ,      .          ,      ,        ,     ,       . </p><br><p style=";text-align:right;direction:rtl">   ReLU-    .    ,     <code>ReLU(z) = max(0, z)</code>     . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/9e3/b87/e17/9e3b87e175577fe97da51fd1a2b50eac.png" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">          ,   ,   ,        ,      ,           ,   , ,   ..            ,            .     "" ()     ,            ,     ,             . </p><br><p style=";text-align:right;direction:rtl"> <strong>   </strong> </p><br><p style=";text-align:right;direction:rtl">         ""        .               . </p><br><p style=";text-align:right;direction:rtl">   ,     Inveption V3      : </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/00e/a03/d78/00ea03d78e161d7f6fff59ba1a133309.jpg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/247/875/0da/2478750da1a4eb167f8dc1c9c55252d6.jpg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/4a9/635/bd8/4a9635bd81a0d2e46435a05c39d3457a.jpg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">              ,         . ,                   ,      ,           ,   ..          ,       ,                .            ,       ,  ,           "" ( ,      ). </p><br><p style=";text-align:right;direction:rtl"> <strong>    </strong> </p><br><p style=";text-align:right;direction:rtl">       ,         , ,      .      ,                  . </p><br><p style=";text-align:right;direction:rtl">     Class Activation Map (  ).      CAM       .       2D              ,                 . </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/2f8/95e/f8b/2f895ef8b9086c9ea56745ce0f441ef9.jpg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/6ff/392/e60/6ff392e60f007791bee52e439099759f.jpg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/fe9/896/210/fe9896210055693195c21a96b74f3188.jpg" alt="ุตูุฑุฉ"></p><br><p style=";text-align:right;direction:rtl">       ,     .    ,    ,        Mixed-  Inception V3-,        .        () ,           . </p><br><p style=";text-align:right;direction:rtl">     ,          ,        .          <strong></strong> ,            ,        .       ,          .   ,                 ,        ,    ,        . </p><br><p style=";text-align:right;direction:rtl">           ,      ""  -          .               .             . </p><br><p style=";text-align:right;direction:rtl">    ,           ,                   . </p><br><h1 style=";text-align:right;direction:rtl">  :      </h1><br><p style=";text-align:right;direction:rtl"> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Colab  </a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Colab  </a> . </p><br><p style=";text-align:right;direction:rtl"> <strong>TensorFlow Hub</strong> </p><br><p style=";text-align:right;direction:rtl"> TensorFlow Hub      ,      . </p><br><p style=";text-align:right;direction:rtl">                  .     ,      ,   ,          . </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> </a>      . </p><br><p style=";text-align:right;direction:rtl">              <code>Runtime -&gt; Reset all runtimes...</code> </p><br><p style=";text-align:right;direction:rtl"> <strong></strong> </p><br><p style=";text-align:right;direction:rtl">  ,    : </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> absolute_import, division, print_function, unicode_literals <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf tf.enable_eager_execution() <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow_hub <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> hub <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow_datasets <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tfds <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow.keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> layers</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">WARNING:tensorflow: The TensorFlow contrib module will not be included in TensorFlow 2.0. For more information, please see: * https://github.com/tensorflow/community/blob/master/rfcs/20180907-contrib-sunset.md * https://github.com/tensorflow/addons * https://github.com/tensorflow/io (for I/O related ops) If you depend on functionality not listed there, please file an issue.</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> logging logger = tf.get_logger() logger.setLevel(logging.ERROR)</code> </pre> <br><p style=";text-align:right;direction:rtl"> <strong>      TensorFlow Datasets</strong> </p><br><p style=";text-align:right;direction:rtl">            TensorFlow Datasets.   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> </a> ,       โ <code>tf_flowers</code> .        ,       .                <code>tfds.splits</code>   (70%)   (30%).        <code>tfds.load</code> .    <code>tfds.load</code> ,            ,      . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">splits = tfds.Split.TRAIN.subsplit([<span class="hljs-number"><span class="hljs-number">70</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>]) (training_set, validation_set), dataset_info = tfds.load(<span class="hljs-string"><span class="hljs-string">'tf_flowers'</span></span>, with_info=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, as_supervised=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, split=splits)</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Downloading and preparing dataset tf_flowers (218.21 MiB) to /root/tensorflow_datasets/tf_flowers/1.0.0... Dl Completed... 1/|/100% 1/1 [00:07&lt;00:00, 3.67s/ url] Dl Size... 218/|/100% 218/218 [00:07&lt;00:00, 30.69 MiB/s] Extraction completed... 1/|/100% 1/1 [00:07&lt;00:00, 7.05s/ file] Dataset tf_flowers downloaded and prepared to /root/tensorflow_datasets/tf_flowers/1.0.0. Subsequent calls will reuse this data.</code> </pre> <br><p style=";text-align:right;direction:rtl"> <strong>     </strong> </p><br><p style=";text-align:right;direction:rtl"> ,      ,    ()         ,      ,          โ   . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">num_classes = dataset_info.features[<span class="hljs-string"><span class="hljs-string">'label'</span></span>].num_classes num_training_examples = <span class="hljs-number"><span class="hljs-number">0</span></span> num_validation_examples = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> example <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> training_set: num_training_examples += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> example <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> validation_set: num_validation_examples += <span class="hljs-number"><span class="hljs-number">1</span></span> print(<span class="hljs-string"><span class="hljs-string">'Total Number of Classes: {}'</span></span>.format(num_classes)) print(<span class="hljs-string"><span class="hljs-string">'Total Number of Training Images: {}'</span></span>.format(num_training_examples)) print(<span class="hljs-string"><span class="hljs-string">'Total Number of Validation Images: {} \n'</span></span>.format(num_validation_examples))</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Total Number of Classes: 5 Total Number of Training Images: 2590 Total Number of Validation Images: 1080</code> </pre> <br><p style=";text-align:right;direction:rtl">        โ  . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, example <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(training_set.take(<span class="hljs-number"><span class="hljs-number">5</span></span>)): print(<span class="hljs-string"><span class="hljs-string">'Image {} shape: {} label: {}'</span></span>.format(i+<span class="hljs-number"><span class="hljs-number">1</span></span>, example[<span class="hljs-number"><span class="hljs-number">0</span></span>].shape, example[<span class="hljs-number"><span class="hljs-number">1</span></span>]))</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Image 1 shape: (226, 240, 3) label: 0 Image 2 shape: (240, 145, 3) label: 2 Image 3 shape: (331, 500, 3) label: 2 Image 4 shape: (240, 320, 3) label: 0 Image 5 shape: (333, 500, 3) label: 1</code> </pre> <br><p style=";text-align:right;direction:rtl"> <strong>     </strong> </p><br><p style=";text-align:right;direction:rtl">          โ ,   MobilNet v2     โ 224224     (grayscale).     <code>image</code> ()  <code>label</code> ()       . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">IMAGE_RES = <span class="hljs-number"><span class="hljs-number">224</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">format_image</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(image, label)</span></span></span><span class="hljs-function">:</span></span> image = tf.image.resize(image, (IMAGE_RES, IMAGE_RES))/<span class="hljs-number"><span class="hljs-number">255.0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> image, label BATCH_SIZE = <span class="hljs-number"><span class="hljs-number">32</span></span> train_batches = training_set.shuffle(num_training_examples//<span class="hljs-number"><span class="hljs-number">4</span></span>).map(format_image).batch(BATCH_SIZE).prefetch(<span class="hljs-number"><span class="hljs-number">1</span></span>) validation_batches = validation_set.map(format_image).batch(BATCH_SIZE).prefetch(<span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl"> <strong>    TensorFlow Hub</strong> </p><br><p style=";text-align:right;direction:rtl">    TensorFlow Hub   . ,                      ,         . </p><br><p style=";text-align:right;direction:rtl"> <strong>   </strong> </p><br><p style=";text-align:right;direction:rtl">      <code>feature_extractor</code>  MobileNet v2. ,      TensorFlow Hub (   )   .          <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="></a> .   <code>tf2-preview/mobilenet_v2/feature_vector</code> ,     URL       MobileNet v2 .   <code>feature_extractor</code>   <code>hub.KerasLayer</code>      <code>input_shape</code> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">URL = <span class="hljs-string"><span class="hljs-string">"https://tfhub.dev/google/tf2-preview/mobilenet_v2/feature_vector/4"</span></span> feature_extractor = hub.KerasLayer(URL, input_shape=(IMAGE_RES, IMAGE_RES, <span class="hljs-number"><span class="hljs-number">3</span></span>))</code> </pre> <br><p style=";text-align:right;direction:rtl"> <strong>   </strong> </p><br><p style=";text-align:right;direction:rtl">                   ,   : </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">feature_extractor.trainable = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl"> <strong>  </strong> </p><br><p style=";text-align:right;direction:rtl">               ,   .            .          . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model = tf.keras.Sequential([ feature_extractor, layers.Dense(num_classes, activation=<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>) ]) model.summary()</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Model: "sequential" _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= keras_layer (KerasLayer) (None, 1280) 2257984 _________________________________________________________________ dense (Dense) (None, 5) 6405 ================================================================= Total params: 2,264,389 Trainable params: 6,405 Non-trainable params: 2,257,984</code> </pre> <br><p style=";text-align:right;direction:rtl"> <strong> </strong> </p><br><p style=";text-align:right;direction:rtl">            ,           . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model.compile( optimizer=<span class="hljs-string"><span class="hljs-string">'adam'</span></span>, loss=<span class="hljs-string"><span class="hljs-string">'sparse_categorical_crossentropy'</span></span>, metrics=[<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>]) EPOCHS = <span class="hljs-number"><span class="hljs-number">6</span></span> history = model.fit(train_batches, epochs=EPOCHS, validation_data=validation_batches)</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Epoch 1/6 81/81 [==============================] - 17s 216ms/step - loss: 0.7765 - acc: 0.7170 - val_loss: 0.0000e+00 - val_acc: 0.0000e+00 Epoch 2/6 81/81 [==============================] - 12s 147ms/step - loss: 0.3806 - acc: 0.8757 - val_loss: 0.3485 - val_acc: 0.8833 Epoch 3/6 81/81 [==============================] - 12s 146ms/step - loss: 0.3011 - acc: 0.9031 - val_loss: 0.3190 - val_acc: 0.8907 Epoch 4/6 81/81 [==============================] - 12s 147ms/step - loss: 0.2527 - acc: 0.9205 - val_loss: 0.3031 - val_acc: 0.8917 Epoch 5/6 81/81 [==============================] - 12s 148ms/step - loss: 0.2177 - acc: 0.9371 - val_loss: 0.2933 - val_acc: 0.8972 Epoch 6/6 81/81 [==============================] - 12s 146ms/step - loss: 0.1905 - acc: 0.9456 - val_loss: 0.2870 - val_acc: 0.9000</code> </pre> <br><p style=";text-align:right;direction:rtl">         ~90%  6  ,     !   ,    ,           ~76%  80  .        ,  MobilNet v2                . </p><br><p style=";text-align:right;direction:rtl"> <strong>         </strong> </p><br><p style=";text-align:right;direction:rtl">               . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">acc = history.history[<span class="hljs-string"><span class="hljs-string">'acc'</span></span>] val_acc = history.history[<span class="hljs-string"><span class="hljs-string">'val_acc'</span></span>] loss = history.history[<span class="hljs-string"><span class="hljs-string">'loss'</span></span>] val_loss = history.history[<span class="hljs-string"><span class="hljs-string">'val_loss'</span></span>] epochs_range = range(EPOCHS) plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>)) plt.subplot(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) plt.plot(epochs_range, acc, label=<span class="hljs-string"><span class="hljs-string">'Training Accuracy'</span></span>) plt.plot(epochs_range, val_acc, label=<span class="hljs-string"><span class="hljs-string">'Validation Accuracy'</span></span>) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'lower right'</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">'Training and Validation Accuracy'</span></span>) plt.subplot(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) plt.plot(epochs_range, loss, label=<span class="hljs-string"><span class="hljs-string">'Training Loss'</span></span>) plt.plot(epochs_range, val_loss, label=<span class="hljs-string"><span class="hljs-string">'Validation Loss'</span></span>) plt.legend(loc=<span class="hljs-string"><span class="hljs-string">'upper right'</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">'Training and Validation Loss'</span></span>) plt.show()</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ox/nb/hy/oxnbhyqanark0qrt1xmeqg3qv4a.png"></p><br><p style=";text-align:right;direction:rtl">   ,   ,                    . </p><br><p style=";text-align:right;direction:rtl">        ,           ,              . </p><br><p style=";text-align:right;direction:rtl">        - MobileNet,           .              (  augmentation),    .                  . </p><br><p style=";text-align:right;direction:rtl"> <strong> </strong> </p><br><p style=";text-align:right;direction:rtl">              NumPy.     ,      . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">class_names = np.array(dataset_info.features[<span class="hljs-string"><span class="hljs-string">'label'</span></span>].names) print(class_names)</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">['dandelion' 'daisy' 'tulips' 'sunflowers' 'roses']</code> </pre> <br><p style=";text-align:right;direction:rtl"> <strong>        </strong> </p><br><p style=";text-align:right;direction:rtl">   <code>next()</code>   <code>image_batch</code> ( )   <code>label_batch</code> ( ).   <code>image_batch</code>  <code>label_batch</code>  NumPy     <code>.numpy()</code> .    <code>.predict()</code>      .        <code>np.argmax()</code>   .            . </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">image_batch, label_batch = next(iter(train_batches)) image_batch = image_batch.numpy() label_batch = label_batch.numpy() predicted_batch = model.predict(image_batch) predicted_batch = tf.squeeze(predicted_batch).numpy() predicted_ids = np.argmax(predicted_batch, axis=<span class="hljs-number"><span class="hljs-number">-1</span></span>) predicted_class_names = class_names[predicted_ids] print(predicted_class_names)</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">['sunflowers' 'roses' 'tulips' 'tulips' 'daisy' 'dandelion' 'tulips' 'sunflowers' 'daisy' 'daisy' 'tulips' 'daisy' 'daisy' 'tulips' 'tulips' 'tulips' 'dandelion' 'dandelion' 'tulips' 'tulips' 'dandelion' 'roses' 'daisy' 'daisy' 'dandelion' 'roses' 'daisy' 'tulips' 'dandelion' 'dandelion' 'roses' 'dandelion']</code> </pre> <br><p style=";text-align:right;direction:rtl"> <strong>     </strong> </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">"Labels: "</span></span>, label_batch) print(<span class="hljs-string"><span class="hljs-string">"Predicted labels: "</span></span>, predicted_ids)</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Labels: [3 4 2 2 1 0 2 3 1 1 2 1 1 2 2 2 0 0 2 2 0 4 1 1 0 4 1 2 0 0 4 0] Predicted labels: [3 4 2 2 1 0 2 3 1 1 2 1 1 2 2 2 0 0 2 2 0 4 1 1 0 4 1 2 0 0 4 0]</code> </pre> <br><p style=";text-align:right;direction:rtl"> <strong>  </strong> </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">9</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> n <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">30</span></span>): plt.subplot(<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>,n+<span class="hljs-number"><span class="hljs-number">1</span></span>) plt.subplots_adjust(hspace = <span class="hljs-number"><span class="hljs-number">0.3</span></span>) plt.imshow(image_batch[n]) color = <span class="hljs-string"><span class="hljs-string">"blue"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> predicted_ids[n] == label_batch[n] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-string"><span class="hljs-string">"red"</span></span> plt.title(predicted_class_names[n].title(), color=color) plt.axis(<span class="hljs-string"><span class="hljs-string">'off'</span></span>) _ = plt.suptitle(<span class="hljs-string"><span class="hljs-string">"Model predictions (blue: correct, red: incorrect)"</span></span>)</code> </pre> <br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/e1/q-/rg/e1q-rgvnr6qns8-vvrcr8yzbexi.png"></p><br><p style=";text-align:right;direction:rtl"> <strong>     Inception-</strong> </p><br><p style=";text-align:right;direction:rtl">    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="> TensorFlow Hub</a>     <code>tf2-preview/inception_v3/feature_vector</code> .        Inception V3 .      ,      Inception V3     .  ,  Inception V3       299299 .   Inception V3    MobileNet V2. </p><br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">IMAGE_RES = <span class="hljs-number"><span class="hljs-number">299</span></span> (training_set, validation_set), dataset_info = tfds.load(<span class="hljs-string"><span class="hljs-string">'tf_flowers'</span></span>, with_info=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, as_supervised=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, split=splits) train_batches = training_set.shuffle(num_training_examples//<span class="hljs-number"><span class="hljs-number">4</span></span>).map(format_image).batch(BATCH_SIZE).prefetch(<span class="hljs-number"><span class="hljs-number">1</span></span>) validation_batches = validation_set.map(format_image).batch(BATCH_SIZE).prefetch(<span class="hljs-number"><span class="hljs-number">1</span></span>) URL = <span class="hljs-string"><span class="hljs-string">"https://tfhub.dev/google/tf2-preview/inception_v3/feature_vector/4"</span></span> feature_extractor = hub.KerasLayer(URL, input_shape=(IMAGE_RES, IMAGE_RES, <span class="hljs-number"><span class="hljs-number">3</span></span>), trainable=<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) model_inception = tf.keras.Sequential([ feature_extractor, tf.keras.layers.Dense(num_classes, activation=<span class="hljs-string"><span class="hljs-string">'softmax'</span></span>) ]) model_inception.summary()</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Model: "sequential_1" _________________________________________________________________ Layer (type) Output Shape Param # ================================================================= keras_layer_1 (KerasLayer) (None, 2048) 21802784 _________________________________________________________________ dense_1 (Dense) (None, 5) 10245 ================================================================= Total params: 21,813,029 Trainable params: 10,245 Non-trainable params: 21,802,784</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="python hljs">model_inception.compile( optimizer=<span class="hljs-string"><span class="hljs-string">'adam'</span></span>, loss=<span class="hljs-string"><span class="hljs-string">'sparse_categorical_crossentropy'</span></span>, metrics=[<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>]) EPOCHS = <span class="hljs-number"><span class="hljs-number">6</span></span> history = model_inception.fit(train_batches, epochs=EPOCHS, validation_data=validation_batches)</code> </pre> <br><p style=";text-align:right;direction:rtl"> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">Epoch 1/6 81/81 [==============================] - 44s 541ms/step - loss: 0.7594 - acc: 0.7309 - val_loss: 0.0000e+00 - val_acc: 0.0000e+00 Epoch 2/6 81/81 [==============================] - 35s 434ms/step - loss: 0.3927 - acc: 0.8772 - val_loss: 0.3945 - val_acc: 0.8657 Epoch 3/6 81/81 [==============================] - 35s 434ms/step - loss: 0.3074 - acc: 0.9120 - val_loss: 0.3586 - val_acc: 0.8769 Epoch 4/6 81/81 [==============================] - 35s 434ms/step - loss: 0.2588 - acc: 0.9282 - val_loss: 0.3385 - val_acc: 0.8796 Epoch 5/6 81/81 [==============================] - 35s 436ms/step - loss: 0.2252 - acc: 0.9375 - val_loss: 0.3256 - val_acc: 0.8824 Epoch 6/6 81/81 [==============================] - 35s 435ms/step - loss: 0.1996 - acc: 0.9440 - val_loss: 0.3164 - val_acc: 0.8861</code> </pre> <br><h1 style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </h1><br><p style=";text-align:right;direction:rtl">                   .          : </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <strong> :</strong> ,                .              . </li><li style=";text-align:right;direction:rtl"> <strong> :</strong>       . ""     ,       ,      . </li><li style=";text-align:right;direction:rtl"> <strong>MobileNet:</strong>       Google,                  . MobileNet              . </li></ul><br><p style=";text-align:right;direction:rtl">              MobileNet      .                     .                   MobileNet    . </p><br><p style=";text-align:right;direction:rtl"> โฆ   call-to-action โ ,     share :) <br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">YouTube</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุจุฑููุฉ</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููููุชุงูุชู</a> <br>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Ojok</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar467967/">https://habr.com/ru/post/ar467967/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar467951/index.html">Habrastatistics: ุชุญููู ุชุนูููุงุช ุงููุงุฑุฆ. ุงูุฌุฒุก 2 ุ ุฅุฌุงุจุงุช ุนูู ุงูุฃุณุฆูุฉ</a></li>
<li><a href="../ar467953/index.html">ุงุฎุชุจุงุฑ ุฎูุงุฏู ุงูุชุฑุงุถูุฉ ุฑุฎูุตุฉ</a></li>
<li><a href="../ar467957/index.html">ูุง ูููู ูุฑุงุก ุซุงุจุช Feigenbaum</a></li>
<li><a href="../ar467961/index.html">ุงููุดุงูู ูุงููุฑูู ุงูุฏูููุฉ ุนูุฏ ุชุทููุฑ SmartTV ุจุงุณุชุฎุฏุงู React.js</a></li>
<li><a href="../ar467965/index.html">ูููุงูุฏู 2.8 - ุงููุงุฆูุฉ ุ ูู ูุถูู</a></li>
<li><a href="../ar467969/index.html">ุงูุนุฑูุถ ุงูุชูุฏูููุฉ ูุดุฑูุท ุงูุดุงุดุฉ ูู iOS 13</a></li>
<li><a href="../ar467973/index.html">ููุตุฉ ุงูููุงุฏุฉ</a></li>
<li><a href="../ar467977/index.html">ุฅูุดุงุก ุชุทุจูู ุจุงุณุชุฎุฏุงู Styled-Components ูู Vue.js</a></li>
<li><a href="../ar467979/index.html">ุชูุงูู ุงูุฅุนูุงูุงุช: ููู ุชุนููุ</a></li>
<li><a href="../ar467983/index.html">ููุงุฐุง ูุฌุจ ุนููู ุฑูู MVP ูู ูุดุงุฑูุนู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>