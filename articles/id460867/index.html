<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👜 🍪 🕺🏽 Sumber daya untuk secara otomatis dikonversi ke struktur objek Realm ⏯️ ▶️ 🧒🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Di Internet , dan bahkan di Habré , ada banyak artikel tentang cara bekerja dengan Realm. Basis data ini cukup nyaman dan membutuhkan sedikit usaha un...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Sumber daya untuk secara otomatis dikonversi ke struktur objek Realm</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460867/">  Di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Internet</a> , dan bahkan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Habré</a> , ada banyak artikel tentang cara bekerja dengan Realm.  Basis data ini cukup nyaman dan membutuhkan sedikit usaha untuk menulis kode, jika Anda dapat menggunakannya.  Artikel ini akan menjelaskan metode kerja yang saya gunakan. <br><a name="habracut"></a><br><h2>  Masalahnya </h2><br><h4>  Optimasi kode </h4><br>  Jelas, setiap kali menulis kode inisialisasi untuk objek Realm dan memanggil fungsi yang sama untuk membaca dan menulis objek tidak nyaman.  Anda bisa membungkusnya dengan abstraksi. <br><br>  Contoh Objek Akses Data: <br><br><pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DAO</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">O</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Object</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">persist</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with object: O)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> realm = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Realm</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? realm.write { realm.add(object, update: .all) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(by key: String)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">O?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> realm = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Realm</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> [] } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> realm.object(ofType: <span class="hljs-type"><span class="hljs-type">O</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, forPrimaryKey: key) } }</code> </pre> <br>  Penggunaan: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> yourObjectDAO = <span class="hljs-type"><span class="hljs-type">DAO</span></span>&lt;<span class="hljs-type"><span class="hljs-type">YourObject</span></span>&gt;() <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> object = <span class="hljs-type"><span class="hljs-type">YourObject</span></span>(key) yourObjectDAO.persist(with: object) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> allPersisted = yourObjectDAO.read(by: key)</code> </pre><br>  Anda dapat menambahkan banyak metode yang berguna ke DAO, misalnya: untuk menghapus, membaca semua objek dari jenis yang sama, mengurutkan, dan sejenisnya. Semuanya akan bekerja dengan salah satu objek Realm. <br><br><h4>  Diakses dari utas yang salah </h4><br>  Realm adalah basis data aman thread.  Ketidaknyamanan utama yang muncul dari ini adalah ketidakmampuan untuk mentransfer objek bertipe Realm.Object dari satu thread ke yang lain. <br><br>  Kode: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">DispatchQueue</span></span>.global(qos: .background).async { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> objects = yourObjectDAO.read(by: key) <span class="hljs-type"><span class="hljs-type">DispatchQueue</span></span>.main.sync { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(objects) } }</code> </pre><br>  Itu akan memberikan kesalahan: <br><br><pre> <code class="plaintext hljs">Terminating app due to uncaught exception 'RLMException', reason: 'Realm accessed from incorrect thread.'</code> </pre><br>  Tentu saja, Anda dapat bekerja dengan objek sepanjang waktu dalam satu utas, tetapi pada kenyataannya ini menciptakan kesulitan tertentu yang lebih baik untuk dielakkan. <br><br>  Untuk solusinya, "nyaman" untuk mengubah Realm.Object menjadi struktur yang akan ditransfer secara diam-diam di antara berbagai utas. <br><br>  Objek Realm: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BirdObj</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Object</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@objc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id: <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-meta"><span class="hljs-meta">@objc</span></span> <span class="hljs-keyword"><span class="hljs-keyword">dynamic</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">primaryKey</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">String?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"id"</span></span> } }</code> </pre><br>  Struktur: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Bird</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id: <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> name: <span class="hljs-type"><span class="hljs-type">String</span></span> }</code> </pre><br>  Untuk mengonversi objek menjadi struktur, kita akan menggunakan implementasi protokol <br>  Penerjemah: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">protocol</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Translator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toObject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with any: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Object</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toAny</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with object: Object)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Any</span></span> }</code> </pre><br>  Untuk Bird, akan terlihat seperti ini: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BirdTranslator</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Translator</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toObject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with any: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Object</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> any = any <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">Bird</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> object = <span class="hljs-type"><span class="hljs-type">BirdObj</span></span>() object.id = any.id object.name = any.name <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> object } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toAny</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with object: Object)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Any</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> object = object <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! <span class="hljs-type"><span class="hljs-type">BirdObj</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">Bird</span></span>(id: object.id, name: object.name) } }</code> </pre><br>  Sekarang tinggal sedikit mengubah DAO sehingga ia menerima dan mengembalikan struktur, bukan objek Realm. <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DAO</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">O</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Object</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> translator: <span class="hljs-type"><span class="hljs-type">Translator</span></span> <span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(translator: <span class="hljs-type"><span class="hljs-type">Translator</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.translator = translator } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">persist</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with any: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> realm = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Realm</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> object = translator.toObject(with: any) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? realm.write { realm.add(object, update: .all) } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(by key: String)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Any?</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">guard</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> realm = <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>? <span class="hljs-type"><span class="hljs-type">Realm</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> object = realm.object(ofType: <span class="hljs-type"><span class="hljs-type">O</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>, forPrimaryKey: key) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> translator.toAny(with: object) } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">nil</span></span> } } }</code> </pre><br>  Masalahnya tampaknya diselesaikan.  Sekarang DAO akan mengembalikan struktur Burung yang dapat dengan bebas dipindahkan di antara utas. <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> birdDAO = <span class="hljs-type"><span class="hljs-type">DAO</span></span>&lt;<span class="hljs-type"><span class="hljs-type">BirdObj</span></span>&gt;(translator: <span class="hljs-type"><span class="hljs-type">BirdTranslator</span></span>()) <span class="hljs-type"><span class="hljs-type">DispatchQueue</span></span>.global(qos: .background).async { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> bird = birdDAO.read(by: key) <span class="hljs-type"><span class="hljs-type">DispatchQueue</span></span>.main.sync { <span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(bird) } }</code> </pre><br><h4>  Sejumlah besar jenis kode yang sama. </h4><br>  Setelah memecahkan masalah mentransfer objek di antara utas, kami bertemu dengan yang baru.  Bahkan dalam kasus kami yang paling sederhana, dengan kelas dua bidang, kami perlu menulis 18 baris kode tambahan.  Bayangkan jika tidak ada 2 bidang, misalnya 10, dan beberapa di antaranya bukan tipe primitif, tetapi entitas yang juga perlu diubah.  Semua ini menciptakan banyak baris dengan jenis kode yang sama.  Perubahan sepele dalam struktur data dalam database memaksa Anda untuk naik ke tiga tempat. <br><br>  Kode untuk setiap entitas selalu, pada intinya, sama.  Perbedaannya hanya tergantung pada bidang struktur. <br><br>  Anda dapat menulis pembuatan otomatis, yang akan menguraikan struktur kami dengan menerbitkan Realm.Object dan Penerjemah untuk masing-masingnya.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sourcery</a> dapat membantu dengan ini.  Sudah ada artikel tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">habra</a> tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mocking</a> dengan bantuannya. <br><br>  Untuk menguasai alat ini pada tingkat yang cukup, saya memiliki cukup deskripsi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tag templat dan filter</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Stensil</a> (atas dasar pembuatan Sourcery) dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dokumentasi Sourcery itu sendiri</a> . <br><br>  Dalam contoh khusus kami, generasi Realm.Object mungkin terlihat seperti ini: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Foundation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RealmSwift #1 {% for type in types.structs %} #2 final class {{ type.name }}Obj: Object { #3 {% for variable in type.storedVariables %} {% if variable.typeName.name == "String" %} @objc dynamic var {{variable.name}}: String = "" {% endif %} {% endfor %} override static func primaryKey() -&gt; String? { return "id" } } {% endfor %}</code> </pre><br>  # 1 - Kami melewati semua struktur. <br>  # 2 - Untuk masing-masing, kita membuat Objek kelas pewaris kita sendiri. <br>  # 3 - Untuk setiap bidang dengan tipe nama == String, buat variabel dengan nama dan tipe yang sama.  Di sini Anda dapat menambahkan kode untuk primitif seperti Int, Date, dan yang lebih kompleks.  Saya pikir intinya jelas. <br><br>  Kode untuk menghasilkan Penerjemah tampak serupa. <br><br><pre> <code class="swift hljs">{% <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> type <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> types.structs %} <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span></span>{{ type.name }}<span class="hljs-type"><span class="hljs-type">Translator</span></span>: <span class="hljs-type"><span class="hljs-type">Translator</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toObject</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with entity: </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">Any</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Object</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> entity = entity <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! {{ type.name }} <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> object = {{ type.name }}<span class="hljs-type"><span class="hljs-type">Obj</span></span>() {% <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> variable <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> type.storedVariables %} object.{{variable.name}} = entity.{{variable.name}} {% endfor %} <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> object } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toAny</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(with object: Object)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Any</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> object = object <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>! {{ type.name }}<span class="hljs-type"><span class="hljs-type">Obj</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">Bird</span></span>( {% <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> variable <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> type.storedVariables %} {{variable.name}}: object.{{variable.name}}{%<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> not forloop.last%},{%endif%} {% endfor %} ) } } {% endfor %}</code> </pre><br>  Yang terbaik adalah menginstal Sourcery melalui manajer dependensi, menunjukkan versi sehingga apa yang Anda tulis bekerja untuk semua orang dengan cara yang sama dan tidak rusak. <br><br>  Setelah instalasi, tetap bagi kami untuk menulis satu baris kode bash untuk menjalankannya di proyek BuildPhase.  Itu harus dihasilkan sebelum file proyek Anda mulai dikompilasi. <br><br><img src="https://habrastorage.org/webt/im/g6/nu/img6nuoqb607uqn248a4cizjtog.png"><br><br><h2>  Kesimpulan </h2><br>  Contoh yang saya berikan cukup disederhanakan.  Jelas bahwa dalam proyek besar, file seperti .stencil akan jauh lebih besar.  Dalam proyek saya, mereka menempati kurang dari 200 baris, sementara menghasilkan 4000 dan menambahkan, di antaranya, kemungkinan polimorfisme di Alam. <br>  Secara umum, saya tidak mengalami penundaan karena konversi beberapa objek ke yang lain. <br>  Saya akan dengan senang hati menerima umpan balik dan kritik. <br><br><h2>  Referensi </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kerajaan cepat</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sourcery github</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dokumentasi sumber</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Tag dan filter templat bawaan stensil</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Mengejek dengan Sourcery dengan cepat</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Membuat Aplikasi ToDo Menggunakan Realm dan Swift</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id460867/">https://habr.com/ru/post/id460867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id460857/index.html">Bagaimana Namecoin Blockchain Research Memprediksi Serangan Cyber ​​RTM</a></li>
<li><a href="../id460859/index.html">Konferensi IThink # 3 di Kharkov - berdasarkan WWDC 2019</a></li>
<li><a href="../id460861/index.html">Lingkup dan penutupan leksikal JavaScript</a></li>
<li><a href="../id460863/index.html">Rincian kerusakan Cloudflare 2 Juli 2019</a></li>
<li><a href="../id460865/index.html">Orang-orang di bulan. Sumber</a></li>
<li><a href="../id460869/index.html">Pengenalan objek waktu-nyata pada iOS menggunakan YOLOv3</a></li>
<li><a href="../id460873/index.html">Why Turok: Dinosaur Hunter untuk N64 adalah tahun-tahun sebelumnya</a></li>
<li><a href="../id460875/index.html">Bagaimana kami di QIWI sampai pada gaya interaksi yang umum antara View dan ViewModel dalam MVVM</a></li>
<li><a href="../id460877/index.html">Kubernetes-adventure Dailymotion: membangun infrastruktur di awan + di tempat</a></li>
<li><a href="../id460879/index.html">DUMP Kazan 2019 - Tatarstan Developers Conference. Kami menerima aplikasi untuk laporan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>