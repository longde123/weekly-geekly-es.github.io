<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ฃ โ๏ธ ๐ท .NET: ุฃุฏูุงุช ููุนูู ูุน multithreading ู ุงูุชุฒุงูู. ุงูุฌุฒุก 2 ๐ ๐ธ ๐</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุฃูุดุฑ ุงูููุงู ุงูุฃุตูู ุนู ูุจุฑ ุ ูุงูุฐู ูุชู ูุดุฑ ุชุฑุฌูุชู ุนูู ูุฏููุฉ Codingsight . 

 ุฃูุงุตู ุฅูุดุงุก ูุณุฎุฉ ูุตูุฉ ูู ุญุฏูุซู ูู โโุงูุงุฌุชูุงุน ูุชุนุฏุฏ ูุคุดุฑุงุช ุงูุชุฑุงุจุท. ูููู ุงู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>.NET: ุฃุฏูุงุช ููุนูู ูุน multithreading ู ุงูุชุฒุงูู. ุงูุฌุฒุก 2</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/459514/" style=";text-align:right;direction:rtl">  <i>ุฃูุดุฑ ุงูููุงู ุงูุฃุตูู ุนู ูุจุฑ ุ ูุงูุฐู ูุชู ูุดุฑ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฑุฌูุชู ุนูู</a> ูุฏููุฉ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Codingsight</a> .</i> <br><br>  ุฃูุงุตู ุฅูุดุงุก ูุณุฎุฉ ูุตูุฉ ูู ุญุฏูุซู ูู โโุงูุงุฌุชูุงุน ูุชุนุฏุฏ ูุคุดุฑุงุช ุงูุชุฑุงุจุท.  ูููู ุงูุนุซูุฑ ุนูู ุงูุฌุฒุก ุงูุฃูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ุฃู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a> ุ ููุงู ููุงู ุงููุฒูุฏ ุญูู ุงููุฌููุนุฉ ุงูุฃุณุงุณูุฉ ูู ุงูุฃุฏูุงุช ูุจุฏุก ุณูุณูุฉ ุฃู ูููุฉ ุ ูุทุฑู ูุนุฑุถ ุญุงูุชูุง ูุจุนุถ ุงูุฃุดูุงุก ุงูุตุบูุฑุฉ ุงูุญููุฉ ูุซู PLinq.  ูู ูุฐู ุงูููุงูุฉ ุ ุฃูุฏ ุงูุชุฑููุฒ ุจุดูู ุฃูุจุฑ ุนูู ุงููุดููุงุช ุงูุชู ูุฏ ุชูุดุฃ ูู ุจูุฆุฉ ูุชุนุฏุฏุฉ ุงูุฎููุท ูุจุนุถ ุงูุทุฑู ูุญููุง. <br><br><h2 style=";text-align:right;direction:rtl">  ูุญุชูู </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญูู ุงูููุงุฑุฏ ุงููุดุชุฑูุฉ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุดุงูู ุงููุญุชููุฉ ุนูุฏ ุงูุนูู ูู ุจูุฆุฉ ูุชุนุฏุฏุฉ ุงูุฎููุท</a> <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุฃุฒู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุญุงูุฉ ุงูุณุจุงู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุดุบูู-ุงูุงูุชุธุงุฑ</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุชุฌููุน ุงูููุถูุน</a> </li></ul></li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฃุฏูุงุช ุงููุฒุงููุฉ</a> <ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ูุดุงุจู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Monitor.Enter ุ Monitor.Exit ุ ููู</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">SpinLock ุ SpinWait</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Monitor.Wait ุ Monitor.Pulse [ุงููู]</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ReaderWriterLockSlim</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ResetEvent ุงูุฃุณุฑุฉ</a> </li></ul></li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุชุงุฆุฌ</a> </li></ul><br><a name="habracut"></a><br><a name="SharedResources"></a><br><h2 style=";text-align:right;direction:rtl">  ุญูู ุงูููุงุฑุฏ ุงููุดุชุฑูุฉ </h2><br>  ูู ุงููุณุชุญูู ูุชุงุจุฉ ุจุฑูุงูุฌ ูุนูู ูู ุนุฏุฉ ูุคุดุฑุงุช ุชุฑุงุจุท ุ ูููู ูู ููุณ ุงูููุช ูู ูููู ูู ููุฑุฏ ูุดุชุฑู ูุงุญุฏ:  ุญุชู ุฅุฐุง ูุฌุญุช ูู ูุณุชูู ุชุฌุฑูุฏู ุ ูุฅู ุงููุฒูู ุฅูู ูุณุชูู ูุงุญุฏ ุฃู ุฃูุซุฑ ุฃุฏูุงู ููุถุญ ุฃูู ูุง ูุฒุงู ููุงู ููุฑุฏ ูุดุชุฑู.  ุณุฃูุฏู ุจุนุถ ุงูุฃูุซูุฉ: <br><br>  <b>ูุซุงู ุฑูู 1:</b> <br><br>  ุฎูููุง ูู ุญุฏูุซ ูุดููุงุช ูุญุชููุฉ ุ ููุช ุจุนูู ุณูุงุณู ุงูุฑุณุงุฆู ูุน ูููุงุช ูุฎุชููุฉ.  ุญุณุจ ุงูููู ูุชูุงุฑ.  ูุจุฏู ูู ุฃู ุงูุจุฑูุงูุฌ ูุง ูุญุชูู ุนูู ููุฑุฏ ูุดุชุฑู ูุงุญุฏ. <br><br>  ุจุนุฏ ุงูุฎูุงุถ ูุณุชููุงุช ุนุฏุฉ ุฃุฏูุงู ุ ูููู ุฃู ููุงู ูุญุฑู ุฃูุฑุงุต ุซุงุจุช ูุงุญุฏ ููุท ุ ูุณูุชุนูู ุนูู ุจุฑูุงูุฌ ุงูุชุดุบูู ุฃู ูุธุงู ุงูุชุดุบูู ุงูุฎุงุต ุจู ุญู ูุดุงูู ุถูุงู ุงููุตูู ุฅููู. <br><br>  <b>ูุซุงู ุฑูู 2:</b> <br><br>  ุจุนุฏ ูุฑุงุกุฉ <i>ุงููุซุงู ุฑูู</i> 1 ุ ูุฑุฑุช ูุถุน ุงููููุงุช ุนูู ุฌูุงุฒูู ุจุนูุฏูู ูุฎุชูููู ูุน ูุทุนุชูู ูุฎุชููุชูู ูุนูููุง ูู ุงูุญุฏูุฏ ูุฃูุธูุฉ ุงูุชุดุบูู.  ูุจูู 2 ุงุชุตุงูุงุช ูุฎุชููุฉ ุนุจุฑ ุจุฑูุชูููู ููู ุงููููุงุช ุฃู NFS. <br><br>  ุนูุฏ ุงููุฒูู ุฅูู ุนุฏุฉ ูุณุชููุงุช ุฃุฏูุงู ุ ูุฏุฑู ุฃูู ูู ูุชุบูุฑ ุดูุก ุ ูุณูุชุนูู ุนูู ุจุฑูุงูุฌ ุชุดุบูู ุจุทุงูุฉ ุงูุดุจูุฉ ุฃู ูุธุงู ุชุดุบูู ุงูุฌูุงุฒ ุงูุฐู ูุนูู ุนููู ุงูุจุฑูุงูุฌ ุญู ูุดููุฉ ุงููุตูู ุงูุชูุงูุณู. <br><br>  <b>ูุซุงู ุฑูู 3:</b> <br><br>  ุจุนุฏ ุฃู ููุฏุช ุฌุฒุกูุง ูุจูุฑูุง ูู ุดุนุฑู ูู ูุญุงููุงุช ูุฅุซุจุงุช ุฅููุงููุฉ ูุชุงุจุฉ ุจุฑูุงูุฌ ูุชุนุฏุฏ ุงูุฎููุท ุ ูุฅูู ุชุฑูุถ ุงููููุงุช ุชูุงููุง ูุชุชุญูู ูู ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุฅูู ูุงุฆููู ูุฎุชูููู ุ ุชุชููุฑ ุงุฑุชุจุงุทุงุช ููู ูููุง ููุท ูุฏูู ูุงุญุฏ. <br><br>  ุฃุธู ุฃู ุงููุณุงููุฑ ุงูููุงุฆูุฉ ุงูุนุดุฑ ูู ูุนุด ูุฐู ุงูููุฑุฉ ูู: ููุช ุชุดุบูู ูุงุญุฏ ูุฌูุน ุงูููุงูุฉ ุ ูุฌุฏููุฉ ูุคุดุฑ ุงูุชุฑุงุจุท ุ ุฐุงูุฑุฉ ุงููุตูู ุงูุนุดูุงุฆู RAM ูุงุญุฏุฉ ูุงูุฐุงูุฑุฉ ุ ููุนุงูุฌ ูุงุญุฏ ูุง ุชุฒุงู ููุงุฑุฏ ูุดุชุฑูุฉ. <br><br>  ูุฐูู ุ ุงูุชุดููุง ุฃูู ูู ุงููุณุชุญูู ูุชุงุจุฉ ุจุฑูุงูุฌ ูุชุนุฏุฏ ุงูุฎููุท ุจุฏูู ููุฑุฏ ูุดุชุฑู ูุงุญุฏ ุนูู ุฌููุน ูุณุชููุงุช ุงูุชุฌุฑูุฏ ุนุจุฑ ุนุฑุถ ููุฏุณ ุงูุชูููุฉ ุจุงููุงูู.  ูุญุณู ุงูุญุธ ุ ูู ูุณุชูู ูู ูุณุชููุงุช ุงูุชุฌุฑูุฏ ุ ููุงุนุฏุฉ ุนุงูุฉ ุ ูุญู ุฌุฒุฆูุงู ุฃู ูููุงู ูุดุงูู ุงููุตูู ุงูุชูุงูุณู ุฃู ูุญุธุฑู ุจุจุณุงุทุฉ (ุนูู ุณุจูู ุงููุซุงู: ูููุน ุฅุทุงุฑ ุนูู ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุนูู ูุน ุนูุงุตุฑ ูู ูุคุดุฑุงุช ุชุฑุงุจุท ูุฎุชููุฉ) ุ ูุจุงูุชุงูู ุชูุดุฃ ุงููุดุงูู ูู ุงูุบุงูุจ ูุน ุงูููุงุฑุฏ ุงููุดุชุฑูุฉ ุนูู ูุณุชูุงู ูู ุงูุชุฌุฑูุฏ.  ูุญููุง ุฃุนุฑุถ ููููู ุงูุชุฒุงูู. <br><a name="Problems"></a><br><h2 style=";text-align:right;direction:rtl">  ุงููุดุงูู ุงููุญุชููุฉ ุนูุฏ ุงูุนูู ูู ุจูุฆุฉ ูุชุนุฏุฏุฉ ุงูุฎููุท </h2><br>  ูููู ุชูุณูู ุงูุฃุฎุทุงุก ูู ุงูุจุฑูุงูุฌ ุฅูู ุนุฏุฉ ูุฌููุนุงุช: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุงูุจุฑูุงูุฌ ูุง ููุชุฌ ูุชูุฌุฉ.  ุชุนุทู ุฃู ูุชุฌูุฏ. </li><li style=";text-align:right;direction:rtl">  ุงูุจุฑูุงูุฌ ุจุฅุฑุฌุงุน ูุชูุฌุฉ ุบูุฑ ุตุญูุญุฉ. </li><li style=";text-align:right;direction:rtl">  ููุชุฌ ุงูุจุฑูุงูุฌ ุงููุชูุฌุฉ ุงูุตุญูุญุฉ ุ ูููู ูุง ููู ุจูุชุทูุจุงุช ุฃุฎุฑู ุบูุฑ ูุธูููุฉ.  ูุนูู ููุชุฑุฉ ุทูููุฉ ุฃู ูุณุชููู ุงููุซูุฑ ูู ุงูููุงุฑุฏ. </li></ol><br>  ูู ุจูุฆุฉ ูุชุนุฏุฏุฉ ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุ ุฌูุงุฒู ุงููุดุงูู ุงูุฑุฆูุณูุฉ ุชุณุจุจ ุงูุฃุฎุทุงุก 1 ู 2 ุญุงูุฉ <b>ุชููู ุชุงู</b> <b>ูุดุฑุท ุงูุณุจุงู</b> . <br><a name="Deadlock"></a><br><h3 style=";text-align:right;direction:rtl">  ูุฃุฒู </h3><br>  ุญุงูุฉ ุชููู ุชุงู - ุญุงูุฉ ุชููู ุชุงู.  ููุงู ุงูุนุฏูุฏ ูู ุงูุงุฎุชูุงูุงุช ุงููุฎุชููุฉ.  ุงูุงูุซุฑ ุดููุนุง ูู ูุง ููู: <br><br><img src="https://habrastorage.org/webt/fl/ij/aj/flijajjtgsaczutpuk9t1filaig.png"><br><br>  ุฃุซูุงุก ููุงู ูุคุดุฑ <b>ุงูุชุฑุงุจุท ุฑูู 1</b> ุจุนูู ุดูุก ูุง ุ ุชู ุญุธุฑ ุงูููุฑุฏ ูุคุดุฑ <b>ุชุฑุงุจุท ุฑูู 2 ุ ุซู ุชู</b> ุญุธุฑ ููุฑุฏ ูุคุดุฑ <b>ุงูุชุฑุงุจุท ุฑูู 1</b> ูุงุญููุง ููุญุงููุฉ ุชุฃููู ุงูููุฑุฏ <b>B</b> ุ ููุฃุณู ูู ูุญุฏุซ ูุฐุง ุฃุจุฏูุง ุ ูุฃู  <b>ูุคุดุฑ ุชุฑุงุจุท # 2 ุณูุตุฏุฑ</b> ุงูููุฑุฏ <b>B</b> ููุท ุจุนุฏ ุชุฃููู ุงูููุฑุฏ <b>A.</b> <br><a name="RaceCondition"></a><br><h3 style=";text-align:right;direction:rtl">  ุญุงูุฉ ุงูุณุจุงู </h3><br>  ุญุงูุฉ ุณุจุงู - ุญุงูุฉ ุณุจุงู.  ุงููููู ุงูุฐู ููู ุณููู ููุชุงุฆุฌ ุงูุนูููุงุช ุงูุญุณุงุจูุฉ ุงูุชู ุฃุฌุฑุงูุง ุงูุจุฑูุงูุฌ ูุนุชูุฏ ุนูู ุนูู ุฌุฏููุฉ ูุคุดุฑ ุชุฑุงุจุท ููุช ุงูุชุดุบูู. <br>  ูููู ุนุฏู ุงูุงุฑุชูุงุญ ููุฐุง ุงููููู ุนูู ูุฌู ุงูุชุญุฏูุฏ ูู ุญูููุฉ ุฃู ุงูุจุฑูุงูุฌ ุงูุฎุงุต ุจู ูุฏ ูุง ูุนูู ูุฑุฉ ูุงุญุฏุฉ ููุท ูู ุจูู ูุฆุงุช ุฃู ุญุชู ูู ููููู ุดุฎุต. <br><br>  ูุชูุงูู ุงููููู ูู ุฎูุงู ุญูููุฉ ุฃู ุงููุดุงูู ูููู ุฃู ุชุณูุฑ ูุนูุง ุ ุนูู ุณุจูู ุงููุซุงู: ูุน ูุฌูุฏ ุณููู ูุนูู ูุฌุฏููุฉ ูุคุดุฑ ุงูุชุฑุงุจุท ุ ุชุญุฏุซ ุญุงูุฉ ุชููู ุชุงู. <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ูุงุชูู ุงููุดููุชูู ุงููุคุฏูุชูู ุฅูู ุญุฏูุซ ุฃุฎุทุงุก ูุงุถุญุฉ ูู ุงูุจุฑูุงูุฌ ุ ููุงู ุฃูุถูุง ูุดููุงุช ูุฏ ูุง ุชุคุฏู ุฅูู ูุชูุฌุฉ ุญุณุงุจูุฉ ุบูุฑ ุตุญูุญุฉ ุ ูููู ุณูุชู ุฅููุงู ุงููุฒูุฏ ูู ุงูููุช ุฃู ููุฉ ุงููุนุงูุฌุฉ ููุญุตูู ุนูููุง.  ุงุซููู ูู ูุฐู ุงููุดุงูู ูู: <b>ูุดุบูู ุงูุงูุชุธุงุฑ</b> ู <b>Starveation ูุคุดุฑ ุงูุชุฑุงุจุท</b> . <br><a name="BusyWait"></a><br><h3 style=";text-align:right;direction:rtl">  ูุดุบูู-ุงูุงูุชุธุงุฑ </h3><br>  ูุดุบูู-ุงูุงูุชุธุงุฑ ูู ูุดููุฉ ูุณุชููู ูููุง ุงูุจุฑูุงูุฌ ููุงุฑุฏ ุงููุนุงูุฌ ููุณ ููุญุณุงุจุงุช ูููู ููุงูุชุธุงุฑ. <br><br>  ุบุงูุจูุง ูุง ุชุจุฏู ูุฐู ุงููุดููุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ูุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!hasSomethingHappened) ;</code> </pre> <br>  ูุฐุง ูุซุงู ุนูู ุงูููุฏ ุงูุณูุฆ ููุบุงูุฉ ููุฐ ุฐูู ุงูุญูู  ุชุดุบู ูุฐู ุงูุดูุฑุฉ ุชูุงููุง ุฃุญุฏ ุงูููุงุฉ ูู ุงููุนุงูุฌ ุจูููุง ูุง ุชูุนู ุดูุฆูุง ูููุฏูุง ุนูู ุงูุฅุทูุงู.  ูููู ุชุจุฑูุฑู ุฅุฐุง ูุงู ูู ุงูููู ููุบุงูุฉ ูุนุงูุฌุฉ ุชุบููุฑ ูู ูููุฉ ูุง ูู ุณูุณูุฉ ุฑุณุงุฆู ุฃุฎุฑู ุ ูููุท ุฅุฐุง ูุงู ูู ุงูููู ููุบุงูุฉ.  ูุฃุชุญุฏุซ ุจุณุฑุนุฉ ุ ุฃูุง ุฃุชุญุฏุซ ุนู ุงูุญุงูุฉ ุนูุฏูุง ูุง ููููู ุงูุงูุชุธุงุฑ ุญุชู ุจุถุน ุซูุงูู ูู ุงููุงูู.  ูู ุญุงูุงุช ุฃุฎุฑู ุ ุฃู ูู ูู ุดูุก ูููู ุฃู ููุชุฌ ุฏูุงุบูุง ุตุญููุง ุ ูููู ูู ุงููุนููู ุงุณุชุฎุฏุงู ุฃููุงุน ResetEvent ูุฅุตุฏุงุฑุงุชูุง ุงููุญููุฉ.  ุนููู ุฃุฏูุงู. <br><br>  ุฑุจูุง ุณููุชุฑุญ ุฃุญุฏ ุงููุฑุงุก ุญู ูุดููุฉ ุชุญููู ููุงุฉ ูุงุญุฏุฉ ุจุงููุงูู ูุน ุงูุชุธุงุฑ ุนุฏูู ุงููุงุฆุฏุฉ ุนู ุทุฑูู ุฅุถุงูุฉ ุชุตูููุงุช ูุซู Thread.Sleep (1) ุฅูู ุงูุญููุฉ.  ุณูุคุฏู ูุฐุง ุจุงููุนู ุฅูู ุญู ุงููุดููุฉ ุ ููููู ุณูุฎูู ูุดููุฉ ุฃุฎุฑู: ุณูููู ูุชูุณุท โโุงูุงุณุชุฌุงุจุฉ ููุชุบูุฑ ูุตู ูููู ุซุงููุฉ ุ ููู ูุง ูุฏ ูุง ูููู ูุจูุฑูุง ุ ูููู ูุฏ ูููู ูุงุฑุซููุง ุฃูุซุฑ ููุง ููููู ุงุณุชุฎุฏุงู ุจุฏุงุฆู ุงูุชุฒุงูู ูุนุงุฆูุฉ ResetEvent. <br><a name="ThreadStarvation"></a><br><h3 style=";text-align:right;direction:rtl">  ุชุฌููุน ุงูููุถูุน </h3><br>  ูุคุดุฑ ุชุฑุงุจุท Starvation ููุซู ูุดููุฉ ุญูุซ ููุฌุฏ ูู ุงูุจุฑูุงูุฌ ุงูุนุฏูุฏ ูู ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุงูุชู ุชุนูู ูู ููุช ูุงุญุฏ.  ูุงุฐุง ูุนูู ุจุงูุถุจุท ุชูู ุงูุชุฏููุงุช ุงูุชู ุชููู ูุดุบููุฉ ุจุงูุญุณุงุจุงุช ุ ูููุณ ููุท ุงูุชุธุงุฑ ุงุณุชุฌุงุจุฉ ูู ุฃู IO.  ูุน ูุฐู ุงููุดููุฉ ุ ูุชู ููุฏ ูู ููุงุณุจ ุงูุฃุฏุงุก ุงููุญุชููุฉ ูู ุงุณุชุฎุฏุงู ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุ ูุฃู  ููุถู ุงููุนุงูุฌ ุงููุซูุฑ ูู ุงูููุช ูู ุชุจุฏูู ุงูุณูุงูุงุช. <br>  ูู ุงููุฑูุญ ุงูุจุญุซ ุนู ูุซู ูุฐู ุงููุดููุงุช ุจุงุณุชุฎุฏุงู ูููุงุช ุงูุชุนุฑูู ุงููุฎุชููุฉ ุ ูููุง ููู ูุซุงู ุนูู ููุทุฉ ุดุงุดุฉ ูู ููู ุงูุชุนุฑูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">dotTrace ุงูุฐู ุชู</a> ุฅุทูุงูู ูู ูุถุน ุงูุฌุฏูู ุงูุฒููู. <br><br> <a href=""><img src="https://habrastorage.org/webt/qy/n9/nk/qyn9nkwglryzuu60cipo8zdi0ra.png"></a> <br>  <i>(ุงูุตูุฑุฉ ูุงุจูุฉ ููููุฑ)</i> <br><br>  ูู ุงูุจุฑูุงูุฌ ุงูุฐู ูุง ูุนุงูู ูู ุชุฏูู ุงูุฌูุน ุ ูู ูููู ููุงู ููู ูุฑุฏู ุนูู ุงูุฑุณูู ุงูุจูุงููุฉ ุงูุชู ุชุนูุณ ุงูุชุฏููุงุช.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ูุฆุฉ ุงูุฃูุธูุฉ ุงููุฑุนูุฉ ุ ูู ุงููุงุถุญ ุฃู 30.6ูช ูู ุงูุจุฑูุงูุฌ ูุงู ููุชุธุฑ ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ. <br><br>  ุนูุฏ ุชุดุฎูุต ูุซู ูุฐู ุงููุดููุฉ ุ ูุชู ุญููุง ุจุจุณุงุทุฉ ุดุฏูุฏุฉ: ููุฏ ุจุฏุฃุช ุนุฏุฏูุง ูุจูุฑูุง ูู ูุคุดุฑุงุช ุงูุชุฑุงุจุท ูู ููุช ูุงุญุฏ ุ ูุงุจุฏุฃ ุฃูู ุฃู ูู ููู ุฌููุนูุง ุฏูุนุฉ ูุงุญุฏุฉ. <br><a name="SyncPrimitives"></a><br><h2 style=";text-align:right;direction:rtl">  ุฃุฏูุงุช ุงููุฒุงููุฉ </h2><br><a name="Interlocked"></a><br><h3 style=";text-align:right;direction:rtl">  ูุดุงุจู </h3><br>  ุฑุจูุง ูุฐู ูู ุงูุทุฑููุฉ ุงูุฃูุซุฑ ุฎูููุฉ ุงููุฒู ูููุฒุงููุฉ.  ุงููุชุดุงุจูุฉ ูู ุนุจุงุฑุฉ ุนู ูุฌููุนุฉ ูู ุงูุนูููุงุช ุงูุฐุฑูุฉ ุงูุจุณูุทุฉ.  ุงูุนูููุฉ ุงูุฐุฑูุฉ ุชุณูู ุงูุนูููุฉ ุงูุชู ูุง ูููู ุฃู ูุญุฏุซ ูููุง ุดูุก.  ูู .NET ุ ูุชู ุชูุซูู Interlocked ุจูุงุณุทุฉ ูุฆุฉ ุซุงุจุชุฉ ุจููุณ ุงูุงุณู ูุน ุนุฏุฏ ูู ุงูุฃุณุงููุจ ุ ูู ูููุง ูููุฐ ุนูููุฉ ุฐุฑูุฉ ูุงุญุฏุฉ. <br><br>  ูุฅุฏุฑุงู ุฑุนุจ ุงูุนูููุงุช ุบูุฑ ุงูุฐุฑูุฉ ุ ุญุงูู ูุชุงุจุฉ ุจุฑูุงูุฌ ูุจุฏุฃ ุจู 10 ุณูุงุณู ุ ูู ูููุง ููุชุฌ ููููู ุฒูุงุฏุฉ ูู ููุณ ุงููุชุบูุฑ ุ ููู ููุงูุฉ ุนูููู ุ ูู ุจุทุจุงุนุฉ ูููุฉ ูุฐุง ุงููุชุบูุฑ - ูุณูุก ุงูุญุธ ุ ุณูููู ูุฎุชูููุง ุชูุงููุง ุนู 10 ููุงููู ุ ุนูุงูุฉ ุนูู ุฐูู ูู ูู ูุฑุฉ ูุจุฏุฃ ุงูุจุฑูุงูุฌ ุ ุณูููู ูุฎุชูููุง.  ูุญุฏุซ ูุฐุง ูุฃูู ุญุชู ูุซู ูุฐู ุงูุนูููุฉ ุงูุจุณูุทุฉ ูุซู ุงูุฒูุงุฏุฉ ููุณุช ุฐุฑูุฉ ุ ูููููุง ุชุชุถูู ุงุณุชุฎุฑุงุฌ ูููุฉ ูู ุงูุฐุงูุฑุฉ ูุญุณุงุจ ูุงุญุฏุฉ ุฌุฏูุฏุฉ ูุงููุชุงุจุฉ ูุฑุฉ ุฃุฎุฑู.  ูุจุงูุชุงูู ุ ูููู ุฃู ุงุซููู ูู ูุคุดุฑุงุช ุงูุชุฑุงุจุท ูู ููุช ูุงุญุฏ ุงูููุงู ุจูู ูู ูุฐู ุงูุนูููุงุช ุ ููู ูุฐู ุงูุญุงูุฉ ุณูุชู ููุฏุงู ุงูุฒูุงุฏุฉ. <br><br>  ุชููุฑ ุงููุฆุฉ Interlocked ุฃุณุงููุจ ุฒูุงุฏุฉ / ุฅููุงุต ุ ูู ุงูุณูู ุชุฎููู ูุง ุชูุนูู.  ุฃููุง ูุฑูุญุฉ ููุงุณุชุฎุฏุงู ุฅุฐุง ููุช ุชููู ุจูุนุงูุฌุฉ ุงูุจูุงูุงุช ูู ูุคุดุฑุงุช ุชุฑุงุจุท ูุชุนุฏุฏุฉ ูุชููุฑ ูู ุดูุก ูุง.  ูุซู ูุฐุง ุงูุฑูุฒ ุณูู ูุนูู ุจุดูู ุฃุณุฑุน ุจูุซูุฑ ูู ุงูููู ุงูููุงุณููู.  ุฅุฐุง ุชู ุงุณุชุฎุฏุงู Interlocked ููุญุงูุฉ ุงูููุถุญุฉ ูู ุงูููุฑุฉ ุงูุฃุฎูุฑุฉ ุ ูุณูููู ุงูุจุฑูุงูุฌ ุจุฅุนุทุงุก 10 ููุงููู ุดุฎุต ุจุดูู ุซุงุจุช ูู ุฃู ูููู. <br><br>  ุชุคุฏู ุทุฑููุฉ CompareExchange ุ ูููููุฉ ุงูุฃููู ุ ูุธููุฉ ุบูุฑ ูุงุถุญุฉ ุฅูู ุญุฏ ูุง ุ ูููู ูู ูุฌูุฏูุง ูุณูุญ ูู ุจุชูููุฐ ุงูุนุฏูุฏ ูู ุงูุฎูุงุฑุฒููุงุช ุงููุซูุฑุฉ ููุงูุชูุงู ุ ูุฎุงุตุฉ ุงูุฃุณุฑุฉ ุงูุฎุงููุฉ ูู ุงูููู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CompareExchange</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">ref</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> location1, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">value</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> comparand</span></span></span><span class="hljs-function">)</span></span>;</code> </pre><br>  ุชุฃุฎุฐ ุงูุทุฑููุฉ ุซูุงุซ ููู: ุงูุฃููู ูุชู ุชูุฑูุฑูุง ุจุงูุฑุฌูุน ููุฐู ูู ุงููููุฉ ุงูุชู ุณูุชู ุชุบููุฑูุง ุฅูู ุงูุซุงููุฉ ุ ุฅุฐุง ุชุทุงุจู ููุช ุงูููุงุฑูุฉ 1 ูุน ุงูููุงุฑูุฉ ุ ูุณูุชู ุฅุฑุฌุงุน ุงููููุฉ ุงูุฃุตููุฉ ูููููุน 1.  ูุจุฏู ุงูุฃูุฑ ูุฑุจููุง ุฅูู ุญุฏ ูุง ุ ูุฃูู ูู ุงูุฃุณูู ูุชุงุจุฉ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชู ุชููุฐ ููุณ ุงูุนูููุงุช ูุซู CompareExchange: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> original = location1; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (location1 == comparand) location1 = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> original;</code> </pre><br>  ุณูููู ุชูููุฐ ูู ุงููุฆุฉ Interlocked ููุท ุงูุฐุฑูุฉ.  ููุฐุง ูู ุ ุฅุฐุง ูุชุจูุง ูุฐู ุงูุดูุฑุฉ ุจุฃููุณูุง ุ ููุฏ ูุญุฏุซ ูููู ุนูุฏูุง ุชู ุจุงููุนู ุงุณุชููุงุก ุงูุดุฑุท location1 == ุงูููุงุฑูุฉ ุ ูููู ุจุญููู ุงูููุช ุงูุฐู ุชู ููู ุชูููุฐ location1 = ุชุนุจูุฑ ุงููููุฉ ุ ุบููุฑ ูุคุดุฑ ุชุฑุงุจุท ุขุฎุฑ ูููุฉ location1 ูุณููููุฏ. <br><br>  ูููููุง ุงูุนุซูุฑ ุนูู ูุซุงู ุฌูุฏ ูุงุณุชุฎุฏุงู ูุฐู ุงูุทุฑููุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชู ููุดุฆูุง ุงููุชุฑุฌู ูุฃู ุญุฏุซ C #. <br><br>  ุฏุนูุง ููุชุจ ูุฆุฉ ุจุณูุทุฉ ูุน ุญุฏุซ MyEvent ูุงุญุฏ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MyClass</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> EventHandler MyEvent; }</code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฏุนูุง</a> ูุจูู ุงููุดุฑูุน ูู ุชูููู Release ูููุชุญ ุงูุชุฌููุน ุจุงุณุชุฎุฏุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">dotPeek</a> ูุน ุชุดุบูู ุฎูุงุฑ Show Compiler Generated Code: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">CompilerGenerated</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> EventHandler MyEvent; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> EventHandler MyEvent { [CompilerGenerated] <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> { EventHandler eventHandler = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.MyEvent; EventHandler comparand; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { comparand = eventHandler; eventHandler = Interlocked.CompareExchange&lt;EventHandler&gt;(<span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.MyEvent, (EventHandler) Delegate.Combine((Delegate) comparand, (Delegate) <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>), comparand); } <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (eventHandler != comparand); } [CompilerGenerated] <span class="hljs-keyword"><span class="hljs-keyword">remove</span></span> { <span class="hljs-comment"><span class="hljs-comment">// The same algorithm but with Delegate.Remove } }</span></span></code> </pre><br>  ููุง ููููู ุฃู ุชุฑู ุฃูู ุฎูู ุงูููุงููุณ ุ ูุงู ุงููุชุฑุฌู ุจุฅูุดุงุก ุฎูุงุฑุฒููุฉ ูุนูุฏุฉ ุฅูู ุญุฏ ูุง.  ุชุญูู ูุฐู ุงูุฎูุงุฑุฒููุฉ ูู ุญุงูุฉ ููุฏุงู ุงุดุชุฑุงู ุญุฏุซ ุนูุฏูุง ุชุดุชุฑู ุนุฏุฉ ูุคุดุฑุงุช ุชุฑุงุจุท ูู ูุฐุง ุงูุญุฏุซ ูู ููุช ูุงุญุฏ.  ุฏุนูุง ููุชุจ ุทุฑููุฉ ุงูุฅุถุงูุฉ ุจูุฒูุฏ ูู ุงูุชูุตูู ุ ูุน ุชุฐูุฑ ูุง ุชููู ุจู ุทุฑููุฉ CompareExchange ูุฑุงุก ุงูููุงููุณ <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">EventHandler eventHandler = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.MyEvent; EventHandler comparand; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> { comparand = eventHandler; <span class="hljs-comment"><span class="hljs-comment">// Begin Atomic Operation if (MyEvent == comparand) { eventHandler = MyEvent; MyEvent = Delegate.Combine(MyEvent, value); } // End Atomic Operation } while (eventHandler != comparand);</span></span></code> </pre><br>  ูุฐุง ุจุงููุนู ุฃูุซุฑ ูุถูุญูุง ููููุงู ุ ุฑุบู ุฃูู ุฑุจูุง ูุง ูุฒุงู ุจุญุงุฌุฉ ุฅูู ุดุฑุญ.  ูู ุงููููุงุช ุ ุฃูุฏ ุฃู ุฃุตู ูุฐู ุงูุฎูุงุฑุฒููุฉ ุนูู ุงููุญู ุงูุชุงูู: <br><br>  <i>ุฅุฐุง ูุงู MyEvent ูุง ูุฒุงู ููุง ูุงู ูู ุงูููุช ุงูุฐู ุจุฏุฃูุง ููู ุชุดุบูู ุงููููุถ. ูููุจูู ุ ููู ุจุชุฏููู ูุง ูุนูุฏ ุฅููู ุงูููุฏูุจ. ููุนูุฏ ูููุจูู ุ ูุฅุฐุง ูู ููู ุงูุฃูุฑ ูุฐูู ุ ููุง ููู ุ ุฏุนูุง ูุญุงูู ูุฑุฉ ุฃุฎุฑู ูููุฑุฑ ุฐูู ุญุชู ูุฎุฑุฌ.</i> <i><br></i> <br><br>  ูุฐูู ูู ูุชู ููุฏุงู ุงุดุชุฑุงู ุงูุญุฏุซ.  ุณูููู ุนููู ุญู ูุดููุฉ ููุงุซูุฉ ุฅุฐุง ููุช ุชุฑูุฏ ูุฌุฃุฉ ุชุทุจูู ุตููู ุฎุงูู ูู ููู ูุคุดุฑ ุชุฑุงุจุท ุขูู.  ุฅุฐุง ุงูุฏูุนุช ุนุฏุฉ ุชุฏููุงุช ูุฅุถุงูุฉ ุนูุงุตุฑ ุฅูููุง ุ ููู ุงูููู ุฃู ุชุถุงู ุฌููุนูุง ูู ุงูููุงูุฉ. <br><a name="Lock"></a><br><h3 style=";text-align:right;direction:rtl">  Monitor.Enter ุ Monitor.Exit ุ ููู </h3><br>  ูุฐู ูู ุงูุจูู ุงูุฃูุซุฑ ุงุณุชุฎุฏุงููุง ููุฒุงููุฉ ูุคุดุฑ ุงูุชุฑุงุจุท.  ุฅููู ูููููู ุจุชุทุจูู ููุฑุฉ ูุณู ููู: ุจูุนูู ุฃูู ูููู ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูููุชูุจุฉ ุจูู ุงูููุงููุงุช ุฅูู Monitor.Enter ู Monitor.Exit ุนูู ููุฑุฏ ูุงุญุฏ ูู ููุช ูุงุญุฏ ูู ูุคุดุฑ ุชุฑุงุจุท ูุงุญุฏ ููุท.  ุจูุงู ุงูููู ุนุจุงุฑุฉ ุนู ุณูุฑ ูุญูู ุญูู ููุงููุงุช Enter / Exit ูููููุฉ ูู ูุญุงููุฉ ุฃุฎูุฑุฉ.  ุชุชูุซู ุฅุญุฏู ุงูููุฒุงุช ุงูุฌูุฏุฉ ูุชุทุจูู ูุณู ูุงู ูู .NET ูู ุงููุฏุฑุฉ ุนูู ุฅุนุงุฏุฉ ุฅุฏุฎุงูู ูููุณ ุงูุฏูู.  ูุฐุง ูุนูู ุฃู ูุซู ูุฐุง ุงูููุฏ ุณูู ูููุฐ ุฏูู ูุดุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>(a) { <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> (a) { ... } }</code> </pre><br>  ูู ุบูุฑ ุงููุญุชูู ุ ุจุทุจูุนุฉ ุงูุญุงู ุ ุฃู ููุชุจ ุดุฎุต ูุง ุจูุฐู ุงูุทุฑููุฉ ุ ููู ุฅุฐุง ููุช ุจุชุดููุฑ ูุฐู ุงูุดูุฑุฉ ูู ุนุฏุฉ ุทุฑู ุจุนูู ููุฏุณ ุงุณุชุฏุนุงุก ูุฐู ุงูููุฒุฉ ูููู ุฃู ุชููุฑ ูู ุจุนุถ ifs.  ูุฌุนู ูุฐู ุงูุฎุฏุนุฉ ููููุฉ ุ ูุงู ุนูู ูุทูุฑู .NET ุฅุถุงูุฉ ูููุฏ - ูููู ููุท ุงุณุชุฎุฏุงู ูุซูู ูููุน ุงููุฑุฌุน ููุงุฆู ุงูุชุฒุงูู ุ ูุชุชู ุฅุถุงูุฉ ุนุฏุฉ ุจุงูุช ุถููููุง ุฅูู ูู ูุงุฆู ุญูุซ ุณูุชู ูุชุงุจุฉ ูุนุฑู ุงูุฏูู. <br><br>  ุชูุฑุถ ููุฒุฉ ุงููุณู ุงูููู ูู c # ููุฏูุง ูุซูุฑูุง ููุงูุชูุงู ูุงุญุฏ ุนูู ุชุดุบูู ุจูุงู ุงูููู: ูุง ููููู ุงุณุชุฎุฏุงู ุจูุงู ุงูุงูุชุธุงุฑ ุฏุงุฎู ุจูุงู ุงูููู.  ูู ุงูุจุฏุงูุฉ ุ ูุงุฌุฃูู ุฐูู ุ ูุฃู ููุงู ูุฌููุนุฉ ูุชุดุงุจูุฉ ูู ุฅูุดุงุกุงุช Monitor.Enter / Exit ููุงุซูุฉ.  ูุง ูู ุงูููุถูุนุ  ูู ุงูุถุฑูุฑู ููุง ุฅุนุงุฏุฉ ูุฑุงุกุฉ ุงูููุฑุฉ ุงูุฃุฎูุฑุฉ ุจุนูุงูุฉ ูุฑุฉ ุฃุฎุฑู ุ ุซู ุฅุถุงูุฉ ุจุนุถ ุงููุนุฑูุฉ ุญูู ูุจุฏุฃ ุนุฏู ุงูุชุฒุงูู / ุงูุงูุชุธุงุฑ: ูู ูุชู ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุจุนุฏ ุงูุงูุชุธุงุฑ ุจุงูุถุฑูุฑุฉ ุนูู ููุณ ูุคุดุฑ ุงูุชุฑุงุจุท ูุซู ุงูุฑูุฒ ูุจู ุงูุงูุชุธุงุฑ ุ ุจู ูุนุชูุฏ ุนูู ุณูุงู ุงูุชุฒุงูู ูุงูุญุถูุฑ ุฃู ูุง ุชูุฌุฏ ุฏุนูุฉ ุฅูู ConfigureAwait.  ูุชุฑุชุจ ุนูู ุฐูู ุฃูู ูููู ุชูููุฐ Monitor.Exit ุนูู ูุคุดุฑ ุชุฑุงุจุท ุบูุฑ Monitor.Enter ุ ูุงูุฐู ุณูููู <b>SynchronizationLockException</b> .  ุฅุฐุง ููุช ูุง ุชุตุฏู ุฐูู ุ ูููููู ุชูููุฐ ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชุงููุฉ ูู ุชุทุจูู ูุญุฏุฉ ุงูุชุญูู: ุณูุคุฏู ุฐูู ุฅูู ุทุฑุญ SynchronizationLockException. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> syncObject = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Object(); Monitor.Enter(syncObject); Console.WriteLine(Thread.CurrentThread.ManagedThreadId); <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> Task.Delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); Monitor.Exit(syncObject); Console.WriteLine(Thread.CurrentThread.ManagedThreadId);</code> </pre><br>  ูู ุงูุฌุฏูุฑ ุจุงูุฐูุฑ ุฃูู ูู WinForms ุฃู ุฃุญุฏ ุชุทุจููุงุช WPF ุ ุณูุนูู ูุฐุง ุงูุฑูุฒ ุจุดูู ุตุญูุญ ุฅุฐุง ุชู ุงุณุชุฏุนุงุคู ูู ุงูุณูุณูุฉ ุงูุฑุฆูุณูุฉ.  ุณูููู ููุงู ุณูุงู ุงูุชุฒุงูู ุงูุฐู ูููุฐ ุงูุนูุฏุฉ ุฅูู ููุถูุน ูุงุฌูุฉ ุงููุณุชุฎุฏู ุจุนุฏ ุงูุงูุชุธุงุฑ.  ูู ุฃู ุญุงู ุ ูุฌุจ ุฃูุง ุชูุนุจ ูุน ุงููุณู ุงูุญุฑุฌ ูู ุณูุงู ุงูููุฏ ุงูุฐู ูุญุชูู ุนูู ุนุงูู ุงูุชุธุงุฑ.  ูู ูุฐู ุงูุญุงูุงุช ุ ูู ุงูุฃูุถู ุงุณุชุฎุฏุงู ุจุฏุงุฆู ุงูุชุฒุงูู ุ ูุงูุชู ุณุชุชู ููุงูุดุชูุง ูุงุญููุง. <br><br>  ุนูุฏ ุงูุญุฏูุซ ุนู ุนูู ุงููุณู ุงูุญุฑุฌ ูู .NET ุ ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ููุฒุฉ ุฃุฎุฑู ูุชูููุฐู.  ูุนูู ุงููุณู ุงูููู ูู .NET ูู ูุถุนูู: ูุถุน ุงูุงูุชุธุงุฑ ุงูุฏูุฑุงูู ููุถุน kernel.  ูุชู ุชูุซูู ุฎูุงุฑุฒููุฉ ุชุฏูุฑ ุงูุงูุชุธุงุฑ ุจุดูู ููุงุฆู ุนูู ุฃููุง ุงูุฑูุฒ ุงููุงุฐุจ ุงูุชุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!TryEnter(syncObject)) ;</code> </pre><br>  ููุฏู ูุฐุง ุงูุชุญุณูู ุฅูู ุฃุณุฑุน ุนูููุฉ ุงูุชูุงุท ูููุณู ุงูุญุฑุฌ ูู ููุช ูุตูุฑ ุ ุจูุงุกู ุนูู ุงูุชุฑุงุถ ุฃูู ุฅุฐุง ูุงู ุงูููุฑุฏ ูุดุบูููุง ุงูุขู ุ ููู ุนูู ูุดู ุชุญุฑูุฑ ููุณู.  ุฅุฐุง ูู ูุญุฏุซ ูุฐุง ูู ูุชุฑุฉ ุฒูููุฉ ูุตูุฑุฉ ุ ูุณูุฐูุจ ุงูุฎูุท ุฅูู ุงูุงูุชุธุงุฑ ูู ูุถุน kernel ุ ูุงูุฐู ุ ูุซู ุงูุนูุฏุฉ ููู ุ ูุณุชุบุฑู ููุชูุง.  ูุงู ูุทูุฑู .NET ุจุชุญุณูู ุณููุงุฑูู ุงูููู ุงููุตูุฑ ูุฏุฑ ุงูุฅููุงู ุ ูุณูุก ุงูุญุธ ุ ุฅุฐุง ุจุฏุฃุช ุงูุนุฏูุฏ ูู ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุจุชูุฒูู ุงููุณู ุงูุญุฑุฌ ุ ููุฏ ูุคุฏู ุฐูู ุฅูู ุชุญููู ูุญุฏุฉ ุงููุนุงูุฌุฉ ุงููุฑูุฒูุฉ (CPU) ุจุดูู ูุจูุฑ ูููุงุฌุฆ. <br><a name="SpinLock"></a><br><h3 style=";text-align:right;direction:rtl">  SpinLock ุ SpinWait </h3><br>  ููุฐ ุฃู ุฐูุฑุช ุฎูุงุฑุฒููุฉ ุชุฏูุฑ ุงูุงูุชุธุงุฑ ุ ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ููุงูู BCL SpinLock ู SpinWait.  ูุฌุจ ุงุณุชุฎุฏุงููุง ุฅุฐุง ูุงู ููุงู ุณุจุจ ููุงุนุชูุงุฏ ุจุฃูู ุณุชููู ููุงู ุฏุงุฆููุง ูุฑุตุฉ ูุงุชุฎุงุฐ ุงูููู ุจุณุฑุนุฉ.  ูู ูุงุญูุฉ ุฃุฎุฑู ุ ูุง ูุณุชุญู ุชุฐูุฑูุง ูุจู ุฃู ุชุธูุฑ ูุชุงุฆุฌ ุงูุชูุตูู ุฃู ุงุณุชุฎุฏุงู ุจุฏุงุฆู ุงูุชุฒุงูู ุงูุฃุฎุฑู ูู ุนูู ุงูุฒุฌุงุฌุฉ ูุจุฑูุงูุฌู. <br><a name="Pulse"></a><br><h3 style=";text-align:right;direction:rtl">  Monitor.Wait ุ Monitor.Pulse [ุงููู] </h3><br>  ูุฌุจ ุงููุธุฑ ูู ูุฐุง ุงูุฒูุฌ ูู ุงูุฃุณุงููุจ ูุนูุง.  ุจูุณุงุนุฏุชูู ุ ูููู ุชูููุฐ ุงูุนุฏูุฏ ูู ุณููุงุฑูููุงุช ุงูููุชุฌูู ูุงููุณุชููููู. <br><br>  <i>ููุชุฌ - ุงููุณุชููู - ููุท ุชุตููู ูุชุนุฏุฏ ุงูุนูููุงุช / ูุชุนุฏุฏ ุงูุฎููุท ุจุงูุชุฑุงุถ ูุฌูุฏ ูุงุญุฏ ุฃู ุฃูุซุฑ ูู ุณูุงุณู ุงูุนูููุงุช / ุงูุนูููุงุช ุงูุชู ุชูุชุฌ ุงูุจูุงูุงุช ูุนูููุฉ ูุงุญุฏุฉ ุฃู ุฃูุซุฑ ูู ุงูุนูููุงุช / ุณูุงุณู ุงูุนูููุงุช ุงูุชู ุชุนุงูุฌ ูุฐู ุงูุจูุงูุงุช.</i>  <i>ุนุงุฏุฉ ูุง ุชุณุชุฎุฏู ูุฌููุนุฉ ูุดุชุฑูุฉ.</i> <br><br>  ูุง ูููู ุงุณุชุฏุนุงุก ููุชุง ุงูุทุฑููุชูู ุฅูุง ุฅุฐุง ูุงู ูุคุดุฑ ุงูุชุฑุงุจุท ุงูุฐู ูุณุจุจูุง ูู ููู ูู ุงูููุช ุงูุญุงูู.  ุทุฑููุฉ ุงูุงูุชุธุงุฑ ุชุทูู ุงูููู ูุชููู ุญุชู ูุณุชุฌูุจ ูุคุดุฑ ุชุฑุงุจุท ุขุฎุฑ ูููุจุถ. <br><br>  ูุชูุถูุญ ุงูุนูู ุ ูุชุจุช ูุซุงููุง ุตุบูุฑูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">object</span></span> syncObject = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span>(); Thread t1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(T1); t1.Start(); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">100</span></span>); Thread t2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(T2); t2.Start();</code> </pre><img src="https://habrastorage.org/webt/0-/7k/uy/0-7kuyx2b8evi2iwzmt-6-capv0.png"><br>  <i>(ุงุณุชุฎุฏูุช ุงูุตูุฑุฉ ุ ูููุณ ุงููุต ุ ูุฅุธูุงุฑ ุชุฑุชูุจ ุชูููุฐ ุงูุชุนูููุงุช ุจุตุฑููุง)</i> <br><br>  <u>ุชุญููู:</u> ุชุนููู ุชุฃุฎูุฑ 100ms ูู ุจุฏุงูุฉ ุงูุฏูู ุงูุซุงูู ุ ูุชุญุฏูุฏุง ูุถูุงู ุฃู ูุจุฏุฃ ุชูููุฐู ูู ููุช ูุงุญู. <br>  - T1: ุฎุท ุชูุงุฑ # 2 ูุจุฏุฃ <br>  - T1: ูุฏุฎู ุงูุฎุท ุฑูู 3 ุฅูู ุงููุณู ุงูุญุฑุฌ <br>  - T1: ุงูุฎุท ุฑูู 6 ูุณูุท ุงูุชูุงุฑ ูุงุฆูุง <br>  - T2: ูุจุฏุฃ ุงูุฎุท ุฑูู 3 <br>  - T2: ูุชุฌูุฏ ุงูุฎุท ุฑูู 4 ุฃุซูุงุก ุงูุชุธุงุฑ ูุณู ุญุฑุฌ <br>  - T1: ุงูุฎุท ุฑูู 7 ูุทูู ุงููุณู ุงูุญุฑุฌ ููุชุฌูุฏ ุฃุซูุงุก ุงูุชุธุงุฑ ุฎุฑูุฌ ุงููุจุถ <br>  - T2: ูุฏุฎู ุงูุฎุท ุฑูู 8 ูู ุงููุณู ุงูุญุฑุฌ <br>  - T2: ุงูุฎุท ุฑูู 11 ูุฎุทุฑ T1 ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุงููุจุถ <br>  - T2: ุฎุท # 14 ูุฎุฑุฌ ูู ุงููุณู ุงูุญุฑุฌ.  ุญุชู ุฐูู ุงูุญูู ุ ูุง ูููู T1 ูุชุงุจุนุฉ ุงูุชูููุฐ. <br>  - T1: ุงูุฎุท ุฑูู 15 ูุณุชููุธ <br>  - T1: ุงูุณุทุฑ ุฑูู 16 ูุชุฑู ุงููุณู ุงูุญุฑุฌ <br><br>  <i>ูุฏู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">MSDN</a> ููุงุญุธุฉ ูููุฉ ุจุฎุตูุต ุงุณุชุฎุฏุงู ุฃุณุงููุจ Pulse / Wait ุ ููู: ูุฑุงูุจ ูุง ูุฎุฒู ูุนูููุงุช ุงูุญุงูุฉ ุ ููุง ูุนูู ุฃูู ุฅุฐุง ุชู ุงุณุชุฏุนุงุก ุทุฑููุฉ Pulse ูุจู ุงุณุชุฏุนุงุก ุทุฑููุฉ ุงูุงูุชุธุงุฑ ุ ููุฏ ูุคุฏู ุฐูู ุฅูู ุชููู ุชุงู.</i>  <i>ุฅุฐุง ูุงู ูุฐุง ุงููููู ูููููุง ุ ููู ุงูุฃูุถู ุงุณุชุฎุฏุงู ุฃุญุฏ ูุฆุงุช ุนุงุฆูุฉ ResetEvent.</i> <br><br>  ููุถุญ ุงููุซุงู ุงูุณุงุจู ุจูุถูุญ ููููุฉ ุนูู ุฃุณุงููุจ ุงูุงูุชุธุงุฑ / ุงููุจุถ ููุฆุฉ ุงูุดุงุดุฉ ุ ูููู ูุง ูุฒุงู ูุชุฑู ุฃุณุฆูุฉ ุญูู ูุชู ูุฌุจ ุงุณุชุฎุฏุงูู.  ูุซุงู ุฌูุฏ ุนูู ุฐูู ูู ุชุทุจูู BlockingQueue &lt;T&gt; ุ ูู ูุงุญูุฉ ุฃุฎุฑู ุ ุชุทุจูู BlockingCollection &lt;T&gt; ูู System.Collections.Concurrent ูุณุชุฎุฏู SemaphoreSlim ููุชุฒุงูู. <br><a name="ReaderWriterLockSlim"></a><br><h3 style=";text-align:right;direction:rtl">  ReaderWriterLockSlim </h3><br>  ูุฐุง ูู ุจูุฏู ุงูุชุฒุงูู ุงูุญุจูุจ ุงูุจุฏุงุฆูุฉ ุ ูููุซููุง ูุฆุฉ System.Threading ูุณุงุญุฉ ุงูุงุณู ุงูุชู ุชุญูู ุงูุงุณู ููุณู.  ูุจุฏู ูู ุฃู ุงูุนุฏูุฏ ูู ุงูุจุฑุงูุฌ ุณุชุนูู ุจุดูู ุฃูุถู ุฅุฐุง ุงุณุชุฎุฏู ูุทูุฑููุง ูุฐู ุงููุฆุฉ ุจุฏูุงู ูู ุงูููู ุงููุนุชุงุฏ. <br><br>  <i>ุงูููุฑุฉ: ูููู ูุฑุงุกุฉ ุงูุนุฏูุฏ ูู ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุ ูุชุงุจุฉ ูุงุญุฏุฉ ููุท.</i>  <i>ุจูุฌุฑุฏ ุฃู ูุนูู ุงูุจุซ ุนู ุฑุบุจุชู ูู ุงููุชุงุจุฉ ุ ูุง ูููู ุจุฏุก ูุฑุงุกุงุช ุฌุฏูุฏุฉ ุ ูููู ุณููุชุธุฑ ุงูุชูุงู ุงูุชุณุฌูู.</i>  <i>ููุงู ุฃูุถูุง ููููู ููู ุงููุฑุงุกุฉ ุงููุงุจู ููุชุฑููุฉ ุ ูุงูุฐู ูููู ุงุณุชุฎุฏุงูู ุฅุฐุง ูููุช ุฃุซูุงุก ุนูููุฉ ุงููุฑุงุกุฉ ุฃูู ุจุญุงุฌุฉ ุฅูู ูุชุงุจุฉ ุดูุก ูุง ุ ุณูุชู ุชุญููู ูุฐุง ุงูููู ุฅูู ููู ุงููุชุงุจุฉ ูู ุนูููุฉ ุฐุฑูุฉ ูุงุญุฏุฉ.</i> <br><br>  <i>ููุงู ุฃูุถูุง ูุฆุฉ ReadWriteLock ูู ูุณุงุญุฉ ุงูุงุณู System.Threading ุ ููู ููุตู ุจุดุฏุฉ ุจุงูุชุทููุฑ ุงูุฌุฏูุฏ.</i>  <i>ุณูุณูุญ ุงูุฅุตุฏุงุฑ ุงููุญูู ุจุชุฌูุจ ุนุฏุฏ ูู ุงูุญุงูุงุช ุงูุชู ุชุคุฏู ุฅูู ุทุฑูู ูุณุฏูุฏ ุ ุฅูู ุฌุงูุจ ุฃูู ูุชูุญ ูู ุงูุชูุงุท ุงูููู ุจุณุฑุนุฉ ุ ูุฃูู</i>  <i>ูุฏุนู ุงููุฒุงููุฉ ูู ูุถุน ุงูุงูุชุธุงุฑ ุงูุฏูุฑุงูู ูุจู ูุบุงุฏุฑุชู ููุถุน kernel.</i> <br><br>  ุฅุฐุง ูู ุชูู ูุฏ ุนุฑูุช ููุช ูุชุงุจุฉ ูุฐุง ุงูููุงู ุจุนุฏ ุญูู ูุฐู ุงููุฆุฉ ุ ูุฃุนุชูุฏ ุงูุขู ุฃูู ุงุณุชุฐูุฑุช ุฃูุซูุฉ ููููุฉ ูู ุงูููุฏ ุงูููุชูุจ ูุคุฎุฑูุง ุ ุญูุซ ูุชูุญ ูุฐุง ุงูููุฌ ููุชุฃููู ููุจุฑูุงูุฌ ุงูุนูู ุจููุงุกุฉ. <br><br>  ูุงุฌูุฉ ูุฆุฉ ReaderWriterLockSlim ุจุณูุทุฉ ููุจุงุดุฑุฉ ุ ููู ูุง ูููู ูุตู ุงุณุชุฎุฏุงููุง ุจุณูููุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReaderWriterLockSlim(); @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>.EnterReadLock(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-comment"><span class="hljs-comment">// ... } finally { @lock.ExitReadLock(); }</span></span></code> </pre><br>  ุฃุฑุบุจ ูู ุงูุชูุงู ุงุณุชุฎุฏุงูู ูู ุงููุตู ุ ููุง ูุฌุนู ุงุณุชุฎุฏุงูู ุฃูุซุฑ ููุงุกูุฉ. <br>  ุงูููุฑุฉ: ูุฌุนู ุทุฑู ุงููุฑุงุกุฉ / WriteLock ุงูุชู ุชุนูุฏ ูุงุฆููุง ุจุงุณุชุฎุฏุงู ุทุฑููุฉ ุงูุชุฎูุต ุ ูุฅู ุฐูู ุณูุชูุญ ููู ุงุณุชุฎุฏุงููุง ูู ุงุณุชุฎุฏุงู ูุนุฏุฏ ุงูุฎุทูุท ุงูุชู ุจุงููุงุฏ ุชุฎุชูู ุนู ุงูููู ุงููุนุชุงุฏ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">RWLock</span></span> : <span class="hljs-title"><span class="hljs-title">IDisposable</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> WriteLockToken : IDisposable { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReaderWriterLockSlim @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLockToken</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ReaderWriterLockSlim @</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">lock</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.@<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> = @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>; @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>.EnterWriteLock(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>.ExitWriteLock(); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> ReadLockToken : IDisposable { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReaderWriterLockSlim @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadLockToken</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ReaderWriterLockSlim @</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">lock</span></span></span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.@<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> = @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>; @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>.EnterReadLock(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>.ExitReadLock(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReaderWriterLockSlim @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReaderWriterLockSlim(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ReadLockToken </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReadLock</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ReadLockToken(@<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> WriteLockToken </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WriteLock</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WriteLockToken(@<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Dispose</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> =&gt; @<span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>.Dispose(); }</code> </pre><br>  ูุฐู ุงูุฎุฏุนุฉ ุชุณูุญ ูู ุจุงููุชุงุจุฉ ุจุจุณุงุทุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> rwLock = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RWLock(); <span class="hljs-comment"><span class="hljs-comment">// ... using(rwLock.ReadLock()) { // ... }</span></span></code> </pre><br><a name="ResetEvent"></a><br><h3 style=";text-align:right;direction:rtl">  ResetEvent ุงูุฃุณุฑุฉ </h3><br>  ุฃููู ุจุชุถููู ุงููุฆุงุช ManualResetEvent ู ManualResetEventSlim ู AutoResetEvent ููุฐู ุงูุนุงุฆูุฉ. <br>  ูููู ุฃู ุชููู ูุฆุงุช ManualResetEvent ูุฅุตุฏุงุฑูุง ุณููู ููุฆุฉ AutoResetEvent ูู ุญุงูุชูู: <br>  - ูู cock-cocked (ุจุฏูู ุฅุดุงุฑุฉ) ุ ูู ูุฐู ุงูุญุงูุฉ ุ ุชุชุฌูุฏ ุฌููุน ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุงูุชู ุชุณูู WaitOne ุญุชู ููุชูู ุงูุญุฏุซ ุฅูู ุญุงูุฉ ุงูุฅุดุงุฑุฉ. <br>  - ุงูุญุงูุฉ ุงูููุฎูุถุฉ (ุงููุดุงุฑ ุฅูููุง) ุ ูู ูุฐู ุงูุญุงูุฉ ูุชู ุชุญุฑูุฑ ุฌููุน ุงูุชุฏููุงุช ุงููุนููุฉ ุนูู ููุงููุฉ WaitOne.  ุฌููุน ุงูููุงููุงุช WaitOne ุงูุฌุฏูุฏุฉ ุนูู ุญุฏุซ ุงูุฌุฑู ุชูุฑ ุนูู ุงูููุฑ ุจุดูู ูุดุฑูุท. <br><br>  ุชุฎุชูู ูุฆุฉ AutoResetEvent ุนู ูุฆุฉ ManualResetEvent ูู ุญูุซ ุฃููุง ุชุฏุฎู ุชููุงุฆููุง ุญุงูุฉ ููุนุฏูุฉ ุจุนุฏ ุฃู ุชููู ุจุฅุตุฏุงุฑ ูุคุดุฑ ุชุฑุงุจุท ูุงุญุฏ ุชูุงููุง.  ูู ุญุงูุฉ ุชุนููู ุนุฏุฉ ูุคุดุฑุงุช ุชุฑุงุจุท ูู ุงูุชุธุงุฑ AutoResetEvent ุ ูุณุชุตุฏุฑ ุงูููุงููุฉ Set ุชุนุณููุฉ ูุงุญุฏุฉ ููุท ุ ุนูู ุนูุณ ManualResetEvent.  ุณูู ManualResetEvent ุงูุงูุฑุงุฌ ุนู ุฌููุน ุงูููุงุถูุน. <br><br>  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ูุซุงู ุนู ููููุฉ ุนูู AutoResetEvent: <br><pre style=";text-align:right;direction:rtl"> <code class="cs hljs">AutoResetEvent evt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AutoResetEvent(<span class="hljs-literal"><span class="hljs-literal">false</span></span>); Thread t1 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(T1); t1.Start(); Thread.Sleep(<span class="hljs-number"><span class="hljs-number">100</span></span>); Thread t2 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(T2); t2.Start();</code> </pre><img src="https://habrastorage.org/webt/ku/us/k2/kuusk2oupkj4_gftf8fixy_51pu.png"><br><br>  ููุธูุฑ ุงููุซุงู ุฃู ุงูุญุฏุซ ููุชูู ุฅูู ุญุงูุฉ ุชู ุถุจุทูุง (ุจุฏูู ุฅุดุงุฑุฉ) ุชููุงุฆููุง ููุท ุนู ุทุฑูู ุชุฑู ุงูุฎูุท ุงููุนููุฉ ุนูู ุงุณุชุฏุนุงุก WaitOne. <br><br>  ูุฆุฉ ManualResetEvent ุ ุจุฎูุงู ReaderWriterLock ุ ูู ูุชู ุชุนููููุง ุนูู ุฃููุง ููุฌูุฑุฉ ููุง ููุตู ุจุงุณุชุฎุฏุงููุง ุจุนุฏ ุธููุฑ ุฅุตุฏุงุฑ Slim ุงูุฎุงุต ุจูุง.  ูุชู ุงุณุชุฎุฏุงู ูุณุฎุฉ ุถุฆููุฉ ูู ูุฐู ุงููุฆุฉ ุจููุงุกุฉ ูุชููุนุงุช ูุตูุฑุฉ ุ ููุง  ูุญุฏุซ ุฐูู ูู ูุถุน Spin-Wait ุ ุงูุฅุตุฏุงุฑ ุงูุนุงุฏู ููุงุณุจ ููุฅุตุฏุงุฑุงุช ุงูุทูููุฉ. <br><br>  ุจุงูุฅุถุงูุฉ ุฅูู ูุฆุงุช ManualResetEvent ู AutoResetEvent ุ ุชูุฌุฏ ูุฆุฉ CountdownEvent ุฃูุถูุง.  ูุฐุง ุงููุตู ููุงุณุจ ูุชูููุฐ ุงูุฎูุงุฑุฒููุงุช ุ ุญูุซ ูุชุจุน ุงูุฌุฒุก ุงูุฐู ุชููู ูู ุงูููุงุฒุงุฉ ุงูุฌุฒุก ุงูุฐู ูุฌูุน ุงููุชุงุฆุฌ.  ููุนุฑู ูุฐุง ุงูููุฌ ุจุงุณู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุดููุฉ ุงูุตูุฉ</a> .  ุชู ุชุฎุตูุต <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุงู</a> ููุชุงุฒ ูุนูู ูุฐุง ุงููุตู ุ ูุจุงูุชุงูู ูู ุฃููู ุจุชุญูููู ุจุงูุชูุตูู ููุง. <br><a name="Conclusions"></a><br><h2 style=";text-align:right;direction:rtl">  ุงููุชุงุฆุฌ </h2><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุนูุฏ ุงูุนูู ูุน ูุคุดุฑุงุช ุงูุชุฑุงุจุท ุ ุฌูุงุฒู ุงููุดุงูู ุงูุชู ุชุคุฏู ุฅูู ูุชุงุฆุฌ ุบูุฑ ุตุญูุญุฉ ุฃู ููููุฏุฉ ูู ุญุงูุฉ ุงูุณุจุงู ู ุญุงูุฉ ุชููู ุชุงู </li><li style=";text-align:right;direction:rtl">  ุงููุดุงูู ุงูุชู ุชุณุจุจ ุงูุจุฑูุงูุฌ ูู ูุถุงุก ุงููุฒูุฏ ูู ุงูููุช ุฃู ุงูููุงุฑุฏ - ุชุฌููุน ุงูุฎูุท ูุงูุงูุชุธุงุฑ ูุดุบูู </li><li style=";text-align:right;direction:rtl">  .NET ุบูู ูู ุชุฒุงูู ุงูุตูุญุงุช </li><li style=";text-align:right;direction:rtl">  ููุงู 2 ุฃูุถุงุน ุงูุงูุชุธุงุฑ ููู - ุณุจูู ุงูุงูุชุธุงุฑ ุ ููุฑ ุงูุงูุชุธุงุฑ.  ุงุณุชุฎุฏุงู ุจุนุถ ุงูุฃููููุงุช ุงููุฒุงููุฉ ูุคุดุฑ ุชุฑุงุจุท .NET ูููููุง </li><li style=";text-align:right;direction:rtl">  Interlocked ุนุจุงุฑุฉ ุนู ูุฌููุนุฉ ูู ุงูุนูููุงุช ุงูุฐุฑูุฉ ุ ูุชุณุชุฎุฏู ูู ุฎูุงุฑุฒููุงุช ุฎุงููุฉ ูู ุงูููู ุ ููู ุฃุณุฑุน ุจุฏุงุฆูุฉ ุงูุชุฒุงูู </li><li style=";text-align:right;direction:rtl">  ูููู ูู ูู ุงููุดุบู lock ู Monitor.Enter / Exit ุจุชุทุจูู ููุฑุฉ ุงููุณู ุงูููู - ูุทุนุฉ ูู ุงูุชุนูููุงุช ุงูุจุฑูุฌูุฉ ุงูุชู ูููู ุชูููุฐูุง ููุท ุจูุงุณุทุฉ ูุคุดุฑ ุชุฑุงุจุท ูุงุญุฏ ูู ูู ูุฑุฉ </li><li style=";text-align:right;direction:rtl">  ุทุฑู Monitor.Pulse / Wait ููุงุฆูุฉ ูุชูููุฐ ุงูุจุฑุงูุฌ ุงููุตูุฉ ุงูุฎุงุตุฉ ุจุงูููุชุฌูู ูุงููุณุชููููู </li><li style=";text-align:right;direction:rtl">  ูุฏ ูููู ReaderWriterLockSlim ุฃูุซุฑ ููุงุกุฉ ูู ุงูููู ุงูุนุงุฏู ูู ุงูุจุฑุงูุฌ ุงููุตูุฉ ุญูุซ ุชููู ุงููุฑุงุกุฉ ุงููุชูุงุฒูุฉ ููุจููุฉ </li><li style=";text-align:right;direction:rtl">  ูุฏ ุชุฃุชู ุนุงุฆูุฉ ุงููุฆุฉ ResetEvent ูู ูุชูุงูู ุงููุฏ ููุฒุงููุฉ ูุคุดุฑ ุงูุชุฑุงุจุท. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar459514/">https://habr.com/ru/post/ar459514/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar459500/index.html">HTML ูู ุงูููุจ</a></li>
<li><a href="../ar459502/index.html">ููุงุตู ุชุทููุฑ ููุตุฉ ูุบุงูุฑุฉ ููุฑูุณ: ููุฒุงุช ูุงุฌูุฉ ูุชูุถููุงุช ุงูุตูู</a></li>
<li><a href="../ar459504/index.html">ุฏูุฑุฉ ูุตูู ูุนุจุฉ ุงูุดุจุงุจ: ููู ูุญุณุจ ุฑุตูุฏ ุงูุดุฎุตูุงุช ูุงููุนุฏุงุช ุจุฏูู ุฑูุงุถูุงุช</a></li>
<li><a href="../ar459506/index.html">ูุบุงูุฑุงุช ุงููุฑุงูุบ ูุงููุงุฑู ุ ุงูุฌุฒุก ุงูุซุงูุซ: ูุตูุต VBA ุงููุนูุฏุฉ ููุถุญู ูุงูุฑุจุญ</a></li>
<li><a href="../ar459508/index.html">5 ุดุฑุงุฆุญ ูุชุฌุงูููุง ููุฏูู ุงูุนุฑูุถ</a></li>
<li><a href="../ar459518/index.html">ุดุฑุญ ูููุฉ ุจุงูุซูู ูุน ููุงุจูุงุช ุงูุนูู</a></li>
<li><a href="../ar459520/index.html">ูููุฐุฌ ูุณูุณูุฉ ูู ุงูุฃุฑูุงู ุงูุทุจูุนูุฉ ูุนูุงุตุฑูุง. ุงููุงุณ</a></li>
<li><a href="../ar459528/index.html">ููู ูุนูู ุงูุจูุฆุฉ ุงููุฑูุณูุฉ ููุฌูุน ุงูุฒุฌุงุฌุงุชุ</a></li>
<li><a href="../ar459530/index.html">ุงูุฌุฑุงุซูู. ุชุงุฑูุฎ ุงูุฏุฑุงุณุฉ ูุทุฑู ุงูุจุญุซ</a></li>
<li><a href="../ar459532/index.html">ููููุฉ ุงุฎุชูุงุฑ ุฑูู ุนุดูุงุฆู ูู 1 ุฅูู 10</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>