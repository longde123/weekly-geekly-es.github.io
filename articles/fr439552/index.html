<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏾 👏🏽 📌 Extensions Chrome malveillantes 🌲 🔐 🐠</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'audience des camarades de classe est de 71 millions par mois. Outre le public Internet dans son ensemble, nos utilisateurs sont soumis à des menaces...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Extensions Chrome malveillantes</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/odnoklassniki/blog/439552/"><img src="https://habrastorage.org/webt/dz/ry/99/dzry99akp3bcnui_uqky91be_1s.jpeg"><br><br>  L'audience des camarades de classe est de 71 millions par mois.  Outre le public Internet dans son ensemble, nos utilisateurs sont soumis à des menaces de sécurité communes: phishing, virus, réutilisation des mots de passe.  Le moteur économique des attaques contre les utilisateurs des réseaux sociaux est, en règle générale, la propagation du spam.  Et bien que de telles attaques ne soient pas une conséquence directe de la vulnérabilité d'Odnoklassniki, nous souhaitons les contrer et pour cela nous enquêtons sur tous les incidents de spam importants. <br><br>  Une enquête typique sur une nouvelle attaque de spam (réussie) commence après que nous avons remarqué une activité anormale parmi les utilisateurs du portail.  Cela peut s'exprimer par une charge accrue sur les services individuels (par exemple, un service de téléchargement ou de recherche d'images), par la distribution active du même type de contenu (par exemple, des liens vers des sites similaires), ou même par une augmentation du nombre d'appels au service d'assistance. <br><a name="habracut"></a><br>  Au cours de l'enquête, il est important pour nous tout d'abord de déterminer comment le spam est distribué au sein du réseau social.  Le résultat d'une telle enquête est souvent la détection d'un groupe d'appareils infectés par des virus.  Parfois, parmi les spams qu'ils distribuent, nous trouvons des liens vers le virus lui-même.  Nous réussissons donc à restaurer le schéma de distribution et à trouver des utilisateurs impliqués. <br><br>  Un cas particulier intéressant de telles attaques est l'infection par des extensions de navigateur malveillantes.  Les extensions pour Chrome peuvent être installées à la fois dans Chrome lui-même et dans les navigateurs basés sur Chromium, par exemple Opera et Yandex.Browser.  Autrement dit, la part du lion du Web est potentiellement couverte.  Les extensions malveillantes pour d'autres navigateurs (Firefox, Safari) sont beaucoup moins courantes.  Je peux supposer que le développement de virus dans leur cas n'apporte pas d'avantages en raison de l'audience relativement petite de ces navigateurs. <br><br>  Nous pouvons même calculer l'étendue de la propagation des extensions malveillantes parmi nos utilisateurs: <br><br><img src="https://habrastorage.org/webt/mb/7_/pt/mb7_ptag9bex0v2u56uvrkrplrq.png"><br><br>  Chaque jour, nous enregistrons 100 à 200 000 utilisateurs infectés.  Au total, en 2018, 1,2 million d'utilisateurs ont été vus en utilisant un navigateur infecté. <br><br>  Début 2017, lors de l'OWASP Russia Meetup # 6, nous avons déjà <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">parlé</a> de l'expérience d'Odnoklassniki dans la lutte contre la propagation d'extensions malveillantes pour Chrome.  En près de deux ans, beaucoup de choses ont changé.  Mais d'abord, voyons comment fonctionnent les extensions. <br><br>  Ainsi, Chrome permet aux utilisateurs de personnaliser le navigateur en installant des extensions. <br>  Les extensions sont fournies avec une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">API Javascript</a> avec laquelle elles peuvent, notamment: <br><br><ul><li>  intercepter et modifier les requêtes et réponses HTTP; </li><li>  modifier le DOM des pages affichées; </li><li>  gérer l'interface du navigateur (ouvrir et fermer les onglets, ajouter des éléments au menu contextuel); </li><li>  gérer la liste des extensions; </li><li>  Abonnez-vous aux événements système, par exemple, à partir de la souris et du clavier; </li><li>  Lisez l'historique du navigateur et les données du site. </li></ul><br>  Les extensions sont distribuées via le Chrome Web Store sous la forme d'une archive avec le code source et les ressources (images, styles, pages HTML).  Les composants clés de l'extension sont répertoriés ci-dessous: <br><br><ul><li> <b>Le manifeste</b> est JSON avec une configuration d'extension.  Entre autres, le manifeste déclare les autorisations et domaines nécessaires aux données auxquelles l'extension aura accès. </li><li>  <b>Les scripts d'arrière-plan</b> sont exécutés en arrière-plan dans leur propre contexte, isolés du code des pages Web.  Ils sont conçus pour recevoir et traiter une variété d'événements du navigateur et ont un accès complet à son API. </li><li> <b>Les scripts de contenu</b> sont exécutés dans le contexte de la page Web.  Les environnements Javascript de la page elle-même et l'extension sont isolés les uns des autres, l'extension n'a pas accès aux variables et fonctions de la page, et vice versa.  Les scripts peuvent modifier les pages DOM et effectuer des requêtes <code>XMLHttpRequest</code> aide de <code>XMLHttpRequest</code> .  Contrairement aux pages normales, la même stratégie d'origine et les mêmes stratégies de serveur CORS ne s'appliquent pas aux demandes d'extensions, elles ne sont limitées que par l'ensemble des accès demandés dans le manifeste. </li></ul><br>  Supposons que quelqu'un décide d'écrire son propre virus.  Que peut-il réaliser? <br><br>  <b>Accès aux données utilisateur</b> <br>  Comme mentionné ci-dessus, l'extension peut intercepter les demandes et les réponses entre la page et le serveur.  Il est clair que le mécanisme universel de protection des données lors de la transmission - SSL - dans ce cas n'aidera pas à protéger les données de la page, car le navigateur les transmet à l'extension déjà décryptée. <br><br>  <b>Modifier le contenu de la page</b> <br>  L'extension a accès au DOM, peut ajouter et supprimer des éléments, en changeant l'interface de la page.  Un exemple classique est la substitution de bannières publicitaires. <br><br>  <b>Suivi des activités des utilisateurs</b> <br>  L'extension peut s'abonner aux événements du clavier et de la souris, et ainsi suivre les actions des utilisateurs dans le navigateur et collecter les mots de passe, les données personnelles, les numéros de carte bancaire. <br><br>  <b>Exécution d'actions pour l'utilisateur</b> <br>  L'extension peut exécuter des scripts dans le contexte de la page victime en violation de la même politique d'origine.  Cela signifie que toutes les actions que l'utilisateur peut effectuer sur le site peuvent également être lancées par l'extension. <br><br>  <b>Contourner l'authentification à deux facteurs et d'autres protections de compte</b> <br>  L'utilisateur passe lui-même l'authentification et l'autorisation dans le navigateur, par conséquent, l'extension reçoit la même session qu'un utilisateur légitime. <br><br>  <b>Bot parfait</b> <br>  Les systèmes intelligents de captcha et de protection contre les inondations, en règle générale, reposent sur le fait que le trafic provenant des bots peut être distingué du trafic provenant de bons utilisateurs par IP, empreintes digitales et distribution des demandes au fil du temps.  Les demandes d'extensions ne peuvent pas être séparées des demandes d'utilisateurs réels. <br><br>  Cette année, Google a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">annoncé</a> plusieurs innovations conçues pour arrêter la propagation des logiciels malveillants dans l'App Store.  Installation d'extensions à partir de sources tierces, l'installation en ligne a été interdite, les règles de modération ont été resserrées, l'obscurcissement et l'exécution de code arbitraire dans les extensions ont été interdits. <br><br>  Malgré cela, des extensions malveillantes continuent d'être utilisées pour attaquer les utilisateurs.  Les objectifs typiques sont le vol de comptes ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exemple</a> ), les données personnelles ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exemple</a> ), le spam ou la publicité frauduleuse ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">exemple</a> ). <br><br>  Pour une attaque réussie, l'extension doit résoudre plusieurs problèmes: <br><br><ul><li>  se cacher de la modération dans le magasin; </li><li>  trouver et fidéliser un public; </li><li>  faire de l'argent. </li></ul><br>  Une modération plus stricte dans le magasin a incité les auteurs de virus à rechercher de nouvelles façons de publier des extensions.  Ici, nous avons observé une image classique de l'adaptation des spammeurs aux filtres anti-spam: une extension avec des centaines de milliers d'utilisateurs s'est transformée en des dizaines d'extensions différentes de différents auteurs avec un petit nombre d'utilisateurs, et ces extensions ont ensuite commencé à imiter des applications populaires avec une bonne réputation.  Les extensions sont désormais hébergées dans des services cloud populaires avec leur partie serveur et le «centre de contrôle» qui définit le comportement des navigateurs infectés à tout moment. <br><br>  Après la suppression du magasin, les extensions reconnues comme malveillantes peuvent être désactivées dans les navigateurs des utilisateurs qui les ont installées.  Pour conserver une audience infectée et pouvoir installer une nouvelle extension à la place de celle à distance, les auteurs de virus modifient les paramètres du navigateur qui ne sont pas directement liés à l'extension: enregistrez un technicien de service, abonnez l'utilisateur aux notifications, remplacez-le par la page d'accueil ou le service de recherche.  Tout cela vous permet d'envoyer un lien vers le navigateur pour installer une nouvelle version du virus. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/27d/21d/6d7/27d21d6d742a084c44c46c73e52dd9ef.png"><br><br>  Pour les virus que nous observons, le spam est la principale source de revenus.  Parmi les nombreuses façons de distribuer le spam pour les extensions, les suivantes sont probablement les plus pratiques: <br><br><ul><li>  <b>Remplacez et ajoutez des publicités sur les pages visitées</b> .  Comme je l'ai mentionné ci-dessus, les extensions sont autorisées à apporter des modifications arbitraires au contenu des pages consultées, notamment en remplaçant les annonces légitimes sur les sites par les leurs ou en affichant des annonces supplémentaires aux utilisateurs en ouvrant des fenêtres contextuelles, de nouveaux onglets ou en redirigeant certains sites vers la publicité. <br><br>  Une forme notable de substitution de la publicité aux extensions est l'utilisation de notifications HTML5.  Bien que l'extension soit installée et active dans le navigateur, il suffit de piéger la victime sur une page qui enregistrera le technicien de service et signera l'utilisateur pour les notifications.  Et puisque cet employé de service n'est pas directement lié à l'extension, même après la suppression de l'extension du navigateur, les auteurs auront toujours un canal de communication avec les utilisateurs sous la forme de notifications push. <br><br>  Un mécanisme similaire est également utilisé en conjonction avec l'ingénierie sociale pour réinfecter la victime si l'extension est supprimée du magasin: l'utilisateur reçoit une poussée avec un contenu attrayant (par exemple, "ok.ru Nouveau message non lu") et avec un lien pour installer une nouvelle version du virus au lieu de la supprimée. </li><li>  <b>Utilisez le compte de la victime pour diffuser du spam sur les réseaux sociaux</b> .  L'extension installée dans le navigateur peut exécuter des demandes au nom de l'utilisateur actuel, y compris publier du spam sous le couvert d'un contenu normal de l'utilisateur (écrire des messages à des amis, publier des notes et des messages en public, télécharger des photos ou des vidéos). </li></ul><br>  En résumant ce qui précède, nous pouvons conclure que les extensions de navigateur malveillantes constituent toujours une menace importante pour les utilisateurs et les applications Web.  Les extensions fournissent un mécanisme pratique pour diffuser du code malveillant: elles ne nécessitent pas de qualifications élevées pour créer, suscitent moins de suspicion chez les utilisateurs lors de l'installation, sont moins souvent détectées par les antivirus. <br><br>  La situation est aggravée par le fait que les pages Web du navigateur ont évidemment moins de droits que les extensions et ne peuvent rien faire pour protéger leurs utilisateurs.  Nous espérons que la campagne anti-virus annoncée par Google sur Store réussira.  Mais jusqu'à ce que cela se produise, nous travaillons chez OK pour minimiser la propagation des virus au sein du réseau social et rendre l'utilisation du service aussi sûre que possible. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr439552/">https://habr.com/ru/post/fr439552/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr439540/index.html">Etherblade.net - projet opensource pour créer un encapsulateur de trafic Ethernet sur FPGA (première partie)</a></li>
<li><a href="../fr439542/index.html">Nintendo indique clairement que seul le piratage peut sauvegarder l'historique des jeux vidéo</a></li>
<li><a href="../fr439544/index.html">Colonie. Chapitre 24: Départ</a></li>
<li><a href="../fr439546/index.html">Les androïdes rêvent-ils de punk électrique? Comment j'ai appris à un réseau de neurones à écrire de la musique</a></li>
<li><a href="../fr439550/index.html">Hackquest 2018. Résultats et écritures. Jour 1-3</a></li>
<li><a href="../fr439556/index.html">TDMS Fairway. Méthodologies PMBOK et organisations de conception russes</a></li>
<li><a href="../fr439558/index.html">Nouveau vieux téléphone. Réinventez le téléphone PSTN</a></li>
<li><a href="../fr439560/index.html">Adaptateur Ethereum blockchain pour plate-forme de données InterSystems IRIS</a></li>
<li><a href="../fr439562/index.html">Configurez le cluster Kubernetes HA sur du métal nu avec kubeadm. Partie 1/3</a></li>
<li><a href="../fr439564/index.html">Application pratique de la transformation d'arbre AST en utilisant le putout comme exemple</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>