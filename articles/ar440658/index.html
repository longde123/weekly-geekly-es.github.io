<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏯 🧠 🤥 استكشاف عامل الميناء ، الجزء 4: تقليل حجم الصور وتسريع تجميعها ✋ 👨🏽‍🎓 🃏</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="في هذا الجزء من ترجمة سلسلة Docker ، سنتحدث عن كيفية تحسين أحجام الصور وتسريع عملية التجميع. في المواد السابقة ، قارنا صور Docker بالبيتزا ، والمصطلحا...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>استكشاف عامل الميناء ، الجزء 4: تقليل حجم الصور وتسريع تجميعها</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/440658/" style=";text-align:right;direction:rtl">  في هذا الجزء من ترجمة سلسلة Docker ، سنتحدث عن كيفية تحسين أحجام الصور وتسريع عملية التجميع.  في المواد السابقة ، قارنا صور Docker بالبيتزا ، والمصطلحات مع الكعك ، وتعليمات Dockerfile مع الخبز.  اليوم لن يكون هناك الخبز.  حان الوقت للذهاب إلى نظام غذائي. <br><br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 1: الأساسيات</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 2: المصطلحات والمفاهيم</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 3: ملفات Dockerfile</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 4: تقليل حجم الصور وتسريع تجميعها</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 5: الفرق</a> <br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء 6: العمل مع البيانات</a> <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/4d1/a39/97f/4d1a3997f86da202d60bfbfb882efb9e.jpg"></div><br>  من أجل فهم ما الذي سنتحدث عنه هنا ، سيكون من المفيد لك تحديث ذاكرة ما تمت مناقشته في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الجزء الثالث من</a> هذه السلسلة من المواد.  وهي تحدثنا عن تعليمات ملف Dockerfile.  ستساعدك معرفة هذه الإرشادات وميزات Docker التي نناقشها اليوم على تحسين ملفات صور Docker. <br><a name="habracut"></a><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">التخزين المؤقت</font> </h2><br>  إحدى نقاط قوة Docker هي التخزين المؤقت.  بفضل هذه الآلية ، يتم تسريع تجميع الصور. <br><br>  عند تجميع صورة Docker ، تتبع تعليمات Dockerfile ، وتتبعها بالترتيب.  في عملية تحليل الإرشادات ، يقوم Docker بفحص ذاكرة التخزين المؤقت الخاصة به بحثًا عن الصور ، وهي ما حصلنا عليه في المراحل المتوسطة من تجميع الصور الأخرى.  إذا كان من الممكن العثور على هذه الصور ، فيمكن للنظام استخدامها دون إضاعة الوقت في إعادة إنشائها. <br><br>  في حالة إبطال ذاكرة التخزين المؤقت ، يتم تنفيذ التعليمات التي حدثت خلالها ، مما يؤدي إلى إنشاء طبقة جديدة دون استخدام ذاكرة التخزين المؤقت.  يحدث نفس الشيء عند تنفيذ التعليمات التي تتبعه. <br><br>  نتيجة لذلك ، إذا تبين أثناء تنفيذ التعليمات من Dockerfile أن الصورة الأساسية في ذاكرة التخزين المؤقت ، يتم استخدام هذه الصورة من ذاكرة التخزين المؤقت.  وهذا ما يسمى ضرب ذاكرة التخزين المؤقت.  إذا لم تكن الصورة الأساسية في ذاكرة التخزين المؤقت ، فستحدث عملية تجميع الصورة بأكملها دون استخدام ذاكرة التخزين المؤقت. <br><br>  ثم تتم مقارنة التعليمات التالية مع جميع الصور من ذاكرة التخزين المؤقت ، والتي تستند إلى نفس الصورة الأساسية الموجودة بالفعل في ذاكرة التخزين المؤقت.  يتم فحص كل صورة وسيطة مخبأة لمعرفة ما إذا كان يحتوي على ما تم إنشاؤه بواسطة نفس التعليمات.  إذا تعذر العثور على تطابق ، فسيتم تسمية ذلك بـ "ملكة جمال التخزين المؤقت" وتعتبر ذاكرة التخزين المؤقت غير صالحة.  يحدث الشيء نفسه حتى تتم معالجة Dockerfile بأكمله. <br><br>  تتم مقارنة معظم التعليمات الجديدة ببساطة بما هو موجود بالفعل في الصور الوسيطة.  إذا تمكن النظام من العثور على تطابق ، فسيستخدم التجميع ما هو موجود بالفعل في ذاكرة التخزين المؤقت. <br><br>  يمكن أن يؤدي استخدام ذاكرة التخزين المؤقت إلى تسريع عملية تجميع الصور ، ولكن هناك مشكلة واحدة.  على سبيل المثال ، إذا تم العثور على <code>RUN pip install -r requirements.txt</code> في Dockerfile ، فإن Docker يبحث عن نفس التعليمات في ذاكرة التخزين المؤقت المحلية للصور الوسيطة.  ومع ذلك ، لا تتم مقارنة محتويات الإصدارات القديمة والجديدة من ملف <code>requirements.txt</code> . <br><br>  قد يؤدي ذلك إلى حدوث مشكلات إذا تمت إضافة معلومات حول الحزم الجديدة إلى <code>requirements.txt</code> ، وبعد ذلك ، عند إنشاء الصورة المحدثة ، من أجل تثبيت مجموعة جديدة من الحزم ، ستحتاج إلى تشغيل بيان <code>RUN pip install</code> مرة أخرى.  قريبا سوف نتحدث عن كيفية التعامل مع هذه المشكلة. <br><br>  بخلاف إرشادات Docker الأخرى ، عند تنفيذ إرشادات <code>ADD</code> و <code>COPY</code> ، يحتاج Docker إلى التحقق من محتويات الملف أو الملفات لتحديد ما إذا كان يمكن استخدام ذاكرة التخزين المؤقت عند إنشاء الصورة.  وهي ، تتم مقارنة المجموع الاختباري للملفات المذكورة في هذه التعليمات مع المجموع الاختباري للملفات الموجودة في الصور الوسيطة الموجودة بالفعل في ذاكرة التخزين المؤقت.  إذا تم تغيير محتويات الملفات أو بيانات التعريف الخاصة بها ، فسيتم إبطال ذاكرة التخزين المؤقت. <br><br>  فيما يلي بعض النصائح للاستفادة من ذاكرة التخزين المؤقت Docker: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يمكن تعطيل التخزين المؤقت بتمرير <code>--no-cache=True</code> مفتاح <code>--no-cache=True</code> إلى <code>docker build</code> . </li><li style=";text-align:right;direction:rtl">  إذا كنت تنوي إجراء تغييرات على إرشادات Dockerfile ، فستتم إعادة تجميع كل طبقة تم إنشاؤها بواسطة الإرشادات التي تأتي بعد الإرشادات التي تم تغييرها في كثير من الأحيان ، دون استخدام ذاكرة التخزين المؤقت.  للاستفادة من التخزين المؤقت ، ضع التعليمات التي من المحتمل أن تتغير ، في أقرب وقت ممكن من Dockerfile. </li><li style=";text-align:right;direction:rtl">  ادمج أوامر <code>RUN apt-get update</code> و <code>apt-get install</code> في السلاسل للتخلص من المشاكل المرتبطة بالاستخدام غير الصحيح لذاكرة التخزين المؤقت. </li><li style=";text-align:right;direction:rtl">  إذا كنت تستخدم مديري الحزم ، مثل <code>pip</code> ، مع ملف <code>requirements.txt</code> ، فالتزم بالمخطط أدناه لاستبعاد استخدام الصور الوسيطة المتقادمة من ذاكرة التخزين المؤقت التي تحتوي على مجموعة الحزم المدرجة في الإصدار القديم من ملف <code>requirements.txt</code> .  إليك ما يبدو عليه: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">COPY requirements.txt /tmp/ RUN pip install -r /tmp/requirements.txt COPY . /tmp/</code> </pre> </li></ul><br>  إذا كنت تعرف طرقًا أخرى للتعامل مع "problem.txt المشكلة" ، فيمكنك تحديدها في التعليقات. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">تقليل حجم الصور</font> </h2><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">▍ اختيار دقيق للصورة الأساسية</font> </h3><br>  صور عامل الميناء يمكن أن تكون كبيرة جدا.  وهذا يتناقض مع الرغبة المتينة التي يقوم بها الشخص الذي يقوم بإنشائها لجعلها مدمجة قدر الإمكان ، مما يسهل تنزيلها من مستودع بعيد وسيكون له تأثير مفيد على مقدار المساحة الحرة على الكمبيوتر الذي تم تحميله عليه.  دعونا نتحدث عن كيفية تقليل حجمها. <br><br><div style="text-align:center;;text-align:right;direction:rtl"><img src="https://habrastorage.org/getpro/habr/post_images/dbe/87c/ea4/dbe87cea4a1c04e25bd2becd194e34d8.jpg"></div><br>  <i><font color="#999999">بدلا من الخبز والكعك ، سوف نأكل الآن الخضر</font></i> <br><br>  تتمثل إحدى طرق تقليل حجم الصور في تحديد الصور الأساسية وتعديلها اللاحق. <br><br>  على سبيل المثال ، تمثل صورة جبال الألب الأساسية توزيعًا كاملاً لنظام التشغيل الذي يشبه نظام Linux ، والذي يحتوي على حزم إضافية على الأقل.  حجمها حوالي 5 ميغابايت.  ومع ذلك ، فإن بناء صورتك الخاصة على أساس جبال الألب سيتطلب الكثير من الوقت لتزويدها بكل ما يلزم لضمان تشغيل تطبيق معين. <br><br>  هناك أيضا إصدارات متخصصة من صورة جبال الألب الأساسية.  على سبيل المثال ، تزن الصورة المطابقة من مستودع python الذي يوضع فيه نص <code>print("hello world")</code> حوالي 78.5 ميجابايت.  هنا هو Dockerfile لبناء مثل هذه الصورة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">FROM python:3.7.2-alpine3.8 COPY . /app ENTRYPOINT [<span class="hljs-string"><span class="hljs-string">"python"</span></span>, <span class="hljs-string"><span class="hljs-string">"./app/my_script.py"</span></span>, <span class="hljs-string"><span class="hljs-string">"my_var"</span></span>]</code> </pre> <br>  في الوقت نفسه ، تقول Docker Hub أن هذه الصورة الأساسية بحجم 29 ميغابايت.  يزداد حجم الصورة بناءً على هذه الصورة الأساسية عن طريق تنزيل Python وتثبيته. <br><br>  بالإضافة إلى استخدام الصور الأساسية المستندة إلى جبال الألب ، يمكنك تقليل حجم الصور من خلال استخدام تكنولوجيا التجميع متعدد المراحل. <br><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">▍ التجمع متعدد المراحل من الصور</font> </h3><br>  يستخدم Dockerfile ، الذي يصف التجميع متعدد المراحل لصورة ما ، عدة تعليمات <code>FROM</code> .  يمكن لمنشئ مثل هذه الصورة إعداد نسخ انتقائية من الملفات التي تسمى عناصر البناء من مستوى بناء إلى آخر.  في الوقت نفسه ، يصبح من الممكن التخلص من كل ما هو غير ضروري في الصورة النهائية.  بفضل هذه الطريقة ، يمكنك تقليل حجم الصورة النهائية. <br><br>  إليك كيفية عمل كل عبارة <code>FROM</code> : <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  إنها تبدأ خطوة بناء جديدة. </li><li style=";text-align:right;direction:rtl">  لا يعتمد على ما تم إنشاؤه في خطوة الإنشاء السابقة. </li><li style=";text-align:right;direction:rtl">  يمكنها استخدام صورة أساسية مختلفة عن الصورة المستخدمة في الخطوة السابقة. </li></ul><br>  فيما يلي مثال معدّل لـ Dockerfile من <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وثائق</a> Docker <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">التي</a> تصف إنشاء متعدد المراحل. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">FROM golang:1.7.3 AS build WORKDIR /go/src/github.com/alexellis/href-counter/ RUN go get -d -v golang.org/x/net/html COPY app.go . RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o app . FROM alpine:latest RUN apk --no-cache add ca-certificates WORKDIR /root/ COPY --from=build /go/src/github.com/alexellis/href-counter/app . CMD [<span class="hljs-string"><span class="hljs-string">"./app"</span></span>]</code> </pre> <br>  يرجى ملاحظة أننا قدمنا ​​اسم المرحلة الأولى من التجميع ، مع الإشارة إلى ذلك بعد بيان <code>FROM</code> .  نشير إلى مرحلة الإنشاء المسماة في <code>COPY --from=</code> أدناه في Dockerfile. <br><br>  يعد استخدام عملية تجميع الصور متعددة المراحل أمرًا منطقيًا في بعض الحالات عندما يتعين عليك إنشاء العديد من الحاويات لبيئة الإنتاج.  يتيح لك التجميع متعدد المراحل تقليل حجم الصورة النهائية.  لكن في بعض الأحيان هذا النهج يعقد دعم الصور.  لذلك ، ربما لن تستخدم مجموعة متعددة المراحل من الصور في الحالات التي يمكنك الاستغناء عنها.  يمكنك أن تقرأ عن ميزات هذه التكنولوجيا <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">هنا</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وهنا</a> . <br><br>  كما ترون ، تعد التجميع متعدد المراحل تقنية مثيرة للاهتمام ، ولكنها غير مناسبة لجميع الحالات.  بنفس الطريقة لتقليل حجم الصور ، والتي سنناقشها أدناه ، يمكن التوصية بها للجميع تمامًا. <br><br><h3 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ock. dockerignore الملف</font> </h3><br>  بالتأكيد كل من يريد أن يتعلم Docker يحتاج إلى معرفة ملفات. <code>.dockerignore</code> .  تشبه هذه الملفات ملفات <code>.gitignore</code> .  أنها تحتوي على قائمة من الملفات والمجلدات ، في شكل أسماء أو قوالب يجب على Docker تجاهلها أثناء تجميع الصور. <br><br>  يتم وضع هذا الملف حيث يوجد Dockerfile ، وكل شيء مضمن في سياق مجموعة الصور. <br><br>  عندما تقوم بتشغيل <code>docker build</code> ، الذي يبدأ بتجميع الصورة ، يتحقق Docker من وجود المجلد في ملف <code>.dockerignore</code> .  إذا كان يمكن العثور على مثل هذا الملف ، فسيتم تحليل هذا الملف ، ويتم استخدام <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">قواعد</a> <code>Match()</code> من حزمة <code>filepath</code> Go وبعض <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">قواعد</a> Docker الخاصة به لتحديد قائمة الملفات التي سيتم تجاهلها. <br><br>  لذلك ، على سبيل المثال ، إذا تم العثور على قالب للنموذج <code>*.jpg</code> في ملف <code>.dockerignore</code> ، فعند إنشاء صورة ، سيتم تجاهل الملفات التي تحمل أي اسم <code>.dockerignore</code> <code>.jpg</code> .  إذا <code>videos</code> السلسلة في الملف ، فسيتجاهل النظام مجلد <code>videos</code> وجميع محتوياته. <br><br>  عند تجميع ملف <code>.dockerignore</code> ، يمكنك التعليق عليه باستخدام الرمز <code>#</code> . <br><br>  إليك ما <code>.dockerignore</code> ملف <code>.dockerignore</code> لأي شخص يقوم بإنشاء صور Docker: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  يتيح لك هذا الاستبعاد من ملفات الصور التي تحتوي على معلومات حساسة مثل عمليات تسجيل الدخول وكلمات المرور. </li><li style=";text-align:right;direction:rtl">  هذا يسمح لك بتقليل حجم الصورة.  أصغر الملفات في الصورة ، سيكون حجمها أصغر وأسرع سيكون من الممكن العمل معها. </li><li style=";text-align:right;direction:rtl">  هذا يجعل من الممكن تقليل عدد أسباب إبطال ذاكرة التخزين المؤقت عند تجميع صور مماثلة.  على سبيل المثال ، إذا تغيرت بعض ملفات خدمة المشروع أثناء إعادة التجميع ، مثل ملفات السجل ، بسبب إبطال البيانات المخزنة في ذاكرة التخزين المؤقت بشكل جوهري ، فإن هذا يؤدي إلى إبطاء تجميع الصور. </li></ul><br>  <code>.dockerignore</code> قراءة المزيد حول ملف <code>.dockerignore</code> في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">وثائق</a> Docker. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">بحث حجم الصورة</font> </h2><br>  دعنا نتحدث عن كيفية استخدام أدوات سطر الأوامر لمعرفة أحجام صور وحاويات Docker. <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  لمعرفة الحجم التقريبي لحاوية التشغيل ، يمكنك استخدام أمر <code>docker container ls -s</code> . </li><li style=";text-align:right;direction:rtl">  يعرض <code>docker image ls</code> أحجام <code>docker image ls</code> . </li><li style=";text-align:right;direction:rtl">  يمكنك استخدام <code>docker image history my_image:my_tag</code> لمعرفة أحجام الصور الوسيطة التي يتم تجميع صورة معينة منها. </li><li style=";text-align:right;direction:rtl">  يتيح لك <code>docker image inspect my_image:tag</code> معرفة المعلومات التفصيلية حول الصورة ، بما في ذلك حجم كل طبقة من طبقاتها.  تختلف الطبقات قليلاً عن الصور الوسيطة التي تشكل الصورة النهائية ، ولكن في معظم الحالات ، يمكن اعتبارها كيانات متطابقة.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">فيما يلي</a> بعض المواد الجيدة حول تفاصيل الهيكل الداخلي لصور Docker. </li><li style=";text-align:right;direction:rtl">  من أجل فحص محتويات الحاويات ، يمكنك تثبيت حزمة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الغوص</a> . </li></ul><br>  الآن وبعد أن ناقشنا إمكانات تقليل حجم الصور ، أوجه انتباهكم إلى ثماني توصيات تتعلق بتقليل حجم الصور وتسريع عملية تجميعها. <br><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">توصيات لتقليل حجم الصور وتسريع عملية التجميع</font> </h2><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  كلما كان ذلك ممكنًا ، استخدم الصور الرسمية كصور أساسية.  يتم تحديث الصور الرسمية بانتظام ، فهي أكثر أمانًا من الصور غير الرسمية. </li><li style=";text-align:right;direction:rtl">  لجمع الصور المدمجة قدر الإمكان ، استخدم الصور الأساسية المستندة إلى Alpine Linux. </li><li style=";text-align:right;direction:rtl">  إذا كنت تستخدم <code>apt</code> ، <code>apt</code> بدمج أوامر <code>apt-get update</code> <code>apt-get install</code> و <code>apt-get install</code> في بيان <code>RUN</code> واحد.  بالإضافة إلى ذلك ، ادمج أوامر تثبيت الحزمة في تعليمة واحدة.  سرد الحزم أبجديًا على أسطر متعددة ، مع فصل القائمة بـ <code>\</code> .  على سبيل المثال ، قد يبدو كالتالي: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">RUN apt-get update &amp;&amp; apt-get install -y \   package-one \   package-two \   package-three &amp;&amp; rm -rf /var/lib/apt/lists/*</code> </pre> <br>  تعمل هذه الطريقة على تقليل عدد الطبقات التي يجب إضافتها إلى الصورة ، كما تساعد في الحفاظ على رمز الملف في نموذج لائق. </li><li style=";text-align:right;direction:rtl">  قم بتضمين بنية مثل <code>&amp;&amp; rm -rf /var/lib/apt/lists/*</code> في نهاية بيان <code>RUN</code> المستخدم لتثبيت الحزم.  سيؤدي هذا إلى مسح ذاكرة التخزين المؤقت <code>apt</code> وسيؤدي إلى عدم حفظه في الطبقة التي شكلها أمر <code>RUN</code> .  التفاصيل حول هذا يمكن العثور عليها في <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">الوثائق</a> . </li><li style=";text-align:right;direction:rtl">  استخدم قدرات التخزين المؤقت الخاصة بك بحكمة عن طريق وضع أوامر في Dockerfile التي من المحتمل أن تتغير بالقرب من نهاية الملف. </li><li style=";text-align:right;direction:rtl">  استخدم ملف. <code>.dockerignore</code> . </li><li style=";text-align:right;direction:rtl">  ألقِ نظرة على <code>dive</code> ، وهي أداة رائعة لاستكشاف صور Docker التي تساعد في تقليل حجمها. </li><li style=";text-align:right;direction:rtl">  لا تقم بتثبيت الحزم التي يمكن الاستغناء عنها. </li></ol><br><h2 style=";text-align:right;direction:rtl">  <font color="#3AC1EF">ملخص</font> </h2><br>  الآن أنت تعرف كيفية جعل صور Docker يتم تجميعها بسرعة ، وتحميلها بسرعة من المستودعات ولا تشغل مساحة كبيرة من الكمبيوتر.  في المرة القادمة سوف نتحدث عن فرق دوكر. <br><br>  <b>أعزائي القراء!</b>  هل واجهت مشاكل مع آليات التخزين المؤقت عند إنشاء صور Docker؟ <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar440658/">https://habr.com/ru/post/ar440658/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar440648/index.html">نظرة عامة على التشريعات الروسية في مجال الوصول إلى شبكة الإنترنت</a></li>
<li><a href="../ar440650/index.html">كيف يعمل الوعي: استنتاجات من كتاب الكسندر نيفزوروف</a></li>
<li><a href="../ar440652/index.html">فيديو محسوب بدقة 755 ميجابكسل: plenoptics بالأمس واليوم وغداً</a></li>
<li><a href="../ar440654/index.html">تعلم بيثون: وحدة argparse</a></li>
<li><a href="../ar440656/index.html">حاويات المهنية للتطبيقات Node.js باستخدام Docker</a></li>
<li><a href="../ar440660/index.html">تعلم عامل الميناء ، الجزء 5: الأوامر</a></li>
<li><a href="../ar440662/index.html">رد فعل البرنامج التعليمي الجزء 18: المرحلة السادسة من العمل على تطبيق TODO</a></li>
<li><a href="../ar440666/index.html">تصنيف الرسومات المكتوبة بخط اليد. تقرير في ياندكس</a></li>
<li><a href="../ar440670/index.html">نشر البنك المركزي توصيات بشأن حماية التشفير من EBS</a></li>
<li><a href="../ar440672/index.html">طرق العقلانية وسجادة الصلاة المغاربية</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>