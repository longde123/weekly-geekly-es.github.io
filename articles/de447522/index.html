<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìÑ üë®üèø‚Äçü§ù‚Äçüë®üèª ‚åöÔ∏è Welche n√ºtzlichen Dinge k√∂nnen aus den Protokollen einer Windows-basierten Workstation abgerufen werden? üëì üë®‚Äçüë©‚Äçüëß üí®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Benutzerarbeitsstation ist in Bezug auf die Informationssicherheit die am st√§rksten gef√§hrdete Infrastruktur. Benutzer erhalten m√∂glicherweise ein...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Welche n√ºtzlichen Dinge k√∂nnen aus den Protokollen einer Windows-basierten Workstation abgerufen werden?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/galssoftware/blog/447522/"> Die Benutzerarbeitsstation ist in Bezug auf die Informationssicherheit die am st√§rksten gef√§hrdete Infrastruktur.  Benutzer erhalten m√∂glicherweise einen Brief von ihrer Arbeitspost, der anscheinend aus einer sicheren Quelle stammt, jedoch einen Link zur infizierten Site enth√§lt.  Vielleicht l√§dt jemand ein Hilfsprogramm herunter, das f√ºr die Arbeit von einem unbekannten Ort n√ºtzlich ist.  Ja, Sie k√∂nnen sich mehr als ein Dutzend F√§lle ausdenken, in denen Malware durch Benutzer in interne Unternehmensressourcen eindringen kann.  Daher erfordern Workstations eine erh√∂hte Aufmerksamkeit. In diesem Artikel erfahren Sie, wo und welche Ereignisse zur Verfolgung von Angriffen erforderlich sind. <br><br><img src="https://habrastorage.org/webt/n1/5h/lf/n15hlfq8b3n3ka64c-ahfco6ktm.png"><br><a name="habracut"></a><br>  Es gibt drei n√ºtzliche Ereignisquellen, um einen Angriff in Windows fr√ºhzeitig zu erkennen: ein Sicherheitsereignisprotokoll, ein System√ºberwachungsprotokoll und Power Shell-Protokolle. <br><br><h2>  Sicherheitsprotokoll </h2><br>  Dies ist der Hauptspeicherort f√ºr Systemsicherheitsprotokolle.  Dies umfasst Benutzeranmelde- / Abmeldeereignisse, Zugriff auf Objekte, √Ñnderungen an Richtlinien und andere sicherheitsrelevante Aktivit√§ten.  Nat√ºrlich, wenn die entsprechende Richtlinie konfiguriert ist. <br><br><img src="https://habrastorage.org/webt/_9/eg/ys/_9egysaz3btzcitbobp2gofmcu0.png"><br><br>  <b>Aufz√§hlung von Benutzern und Gruppen (Ereignisse 4798 und 4799).</b>  Sch√§dliche Software durchl√§uft zu Beginn eines Angriffs h√§ufig lokale Benutzerkonten und lokale Gruppen auf einer Workstation, um Anmeldeinformationen f√ºr ihre dunklen Angelegenheiten zu finden.  Diese Ereignisse helfen dabei, b√∂sartigen Code zu erkennen, bevor er sich weiter bewegt, und verbreiten sich mithilfe der gesammelten Daten auf andere Systeme. <br><br>  <b>Erstellen eines lokalen Kontos und √Ñndern lokaler Gruppen (Ereignisse 4720, 4722‚Äì4726, 4738, 4740, 4767, 4780, 4781, 4794, 5376 und 5377).</b>  Ein Angriff kann beispielsweise auch durch Hinzuf√ºgen eines neuen Benutzers zu einer Gruppe lokaler Administratoren beginnen. <br><br>  <b>Versuche, sich mit einem lokalen Konto anzumelden (Ereignis 4624).</b>  Gute Benutzer melden sich mit einem Dom√§nenkonto an und die Identifizierung eines Eintrags unter einem lokalen Konto kann den Beginn eines Angriffs anzeigen.  Ereignis 4624 enth√§lt auch Anmeldungen unter einem Dom√§nenkonto. Wenn Sie also Ereignisse verarbeiten, m√ºssen Sie Ereignisse herausfiltern, bei denen sich die Dom√§ne vom Namen der Arbeitsstation unterscheidet. <br><br>  <b>Anmeldeversuch mit einem bestimmten Konto (Ereignis 4648).</b>  Dies geschieht, wenn der Prozess im Modus "Ausf√ºhren als" ausgef√ºhrt wird.  Im normalen Betrieb von Systemen sollte dies nicht der Fall sein, daher sollten solche Ereignisse gesteuert werden. <br><br>  <b>Sperren / Entsperren der Workstation (Ereignisse 4800-4803).</b>  Zu den verd√§chtigen Ereignissen geh√∂ren alle Aktionen, die auf einer gesperrten Workstation ausgef√ºhrt wurden. <br><br>  <b>√Ñnderungen der Firewall-Konfiguration (Ereignisse 4944-4958).</b>  Bei der Installation neuer Software k√∂nnen sich nat√ºrlich die Einstellungen f√ºr die Firewall-Konfiguration √§ndern, was zu Fehlalarmen f√ºhrt.  In den meisten F√§llen ist es nicht erforderlich, solche √Ñnderungen zu kontrollieren, aber es ist nicht √ºberfl√ºssig, √ºber sie Bescheid zu wissen. <br><br>  <b>Anschlie√üen von Plug'n'play-Ger√§ten (Ereignis 6416 und nur f√ºr Windows 10).</b>  Es ist wichtig, dies zu √ºberwachen, wenn Benutzer normalerweise keine neuen Ger√§te an die Workstation anschlie√üen und diese dann pl√∂tzlich angeschlossen haben. <br><br>  Windows enth√§lt 9 √úberwachungskategorien und 50 Unterkategorien zur Feinabstimmung.  Die Mindestmenge an Unterkategorien, die in den Einstellungen enthalten sein sollten: <br><br>  <b>Anmelden / Abmelden</b> <br><br><ul><li>  Anmeldung; </li><li>  Abmelden; </li><li>  Kontosperrung; </li><li>  Andere Anmelde- / Abmeldeereignisse. </li></ul><br>  <b>Kontoverwaltung</b> <br><br><ul><li>  Benutzerkontenverwaltung; </li><li>  Sicherheitsgruppenverwaltung. </li></ul><br>  <b>Richtlinien√§nderung</b> <br><br><ul><li>  √Ñnderung der √úberwachungsrichtlinien </li><li>  √Ñnderung der Authentifizierungsrichtlinie; </li><li>  √Ñnderung der Autorisierungsrichtlinie. </li></ul><br><h2>  Systemmonitor (Sysmon) </h2><br>  Sysmon ist ein in Windows integriertes Dienstprogramm, das Ereignisse in das Systemprotokoll schreiben kann.  Es ist normalerweise erforderlich, es separat zu installieren. <br><br><img src="https://habrastorage.org/webt/zt/e6/jg/zte6jgkrmzj6evy8vyojwcpo_fy.png"><br><br>  Dieselben Ereignisse finden sich im Prinzip im Sicherheitsprotokoll (unter Einbeziehung der gew√ºnschten √úberwachungsrichtlinie), Sysmon bietet jedoch weitere Details.  Welche Ereignisse k√∂nnen von Sysmon √ºbernommen werden? <br><br>  <b>Prozess erstellen (Ereignis-ID 1).</b>  Das Systemereignisprotokoll von Sicherheitsereignissen kann auch erkennen, wann eine * .exe gestartet wurde, und sogar den Namen und den Startpfad anzeigen.  Im Gegensatz zu Sysmon kann der Hash der Anwendung jedoch nicht angezeigt werden.  Sch√§dliche Software kann sogar als harmlose notepad.exe bezeichnet werden, aber es ist der Hash, der sie in klares Wasser bringt. <br><br>  <b>Netzwerkverbindungen (Ereignis-ID 3).</b>  Offensichtlich gibt es viele Netzwerkverbindungen, und Sie k√∂nnen nicht alle im Auge behalten.  Es ist jedoch wichtig zu beachten, dass Sysmon im Gegensatz zum Sicherheitsprotokoll eine Netzwerkverbindung an die Felder ProcessID und ProcessGUID binden kann und die Port- und IP-Adressen der Quelle und des Empf√§ngers anzeigt. <br><br>  <b>√Ñnderungen in der Registrierung (Ereignis-ID 12-14).</b>  Der einfachste Weg, sich zum Start hinzuzuf√ºgen, besteht darin, sich in der Registrierung zu registrieren.  Das Sicherheitsprotokoll kann dies tun, aber Sysmon zeigt an, wer die √Ñnderungen wann, wo, Prozess-ID und vorherigen Schl√ºsselwert vorgenommen hat. <br><br>  <b>Dateierstellung (Ereignis-ID 11).</b>  Im Gegensatz zu Security Log zeigt Sysmon nicht nur den Speicherort der Datei, sondern auch deren Namen an.  Es ist klar, dass Sie nicht alles im Auge behalten k√∂nnen, aber Sie k√∂nnen auch bestimmte Verzeichnisse √ºberwachen. <br><br>  Und jetzt, was Sicherheitsprotokollrichtlinien nicht haben, aber in Sysmon sind: <br><br>  <b>√Ñndern Sie die Erstellungszeit der Datei (Ereignis-ID 2).</b>  Einige Malware ersetzt m√∂glicherweise das Dateierstellungsdatum, um es vor Berichten mit k√ºrzlich erstellten Dateien zu verbergen. <br><br>  <b>Laden Sie Treiber und dynamische Bibliotheken herunter (Ereignis-ID 6-7).</b>  Verfolgung des Ladens von DLL- und Ger√§tetreibern in den Speicher, √úberpr√ºfung der digitalen Signatur und ihrer G√ºltigkeit. <br><br>  <b>Erstellen eines Threads in einem laufenden Prozess (Ereignis-ID 8).</b>  Eine der Angriffsarten, die ebenfalls √ºberwacht werden muss. <br><br>  <b>RawAccessRead-Ereignisse (Ereignis-ID 9).</b>  Lesen Sie Vorg√§nge mit "\\. \" Von der Festplatte.  In den allermeisten F√§llen sollte eine solche Aktivit√§t als abnormal angesehen werden. <br><br>  <b>Erstellen eines benannten Dateistreams (Ereignis-ID 15).</b>  Ein Ereignis wird protokolliert, wenn ein benannter Dateistream generiert wird, der Ereignisse mit einem Hash des Inhalts der Datei generiert. <br><br>  <b>Erstellen einer Named Pipe und einer Verbindung (Ereignis-ID 17-18).</b>  Verfolgung von Schadcode, der √ºber eine Named Pipe mit anderen Komponenten kommuniziert. <br><br>  <b>WMI-Aktivit√§t (Ereignis-ID 19).</b>  Registrierung von Ereignissen, die beim Zugriff auf das System √ºber das WMI-Protokoll generiert werden. <br><br>  Um Sysmon selbst zu sch√ºtzen, m√ºssen Sie Ereignisse mit der ID 4 (Sysmon stoppen und starten) und der ID 16 (Sysmon-Konfiguration √§ndern) verfolgen. <br><br><h2>  Power Shell Magazine </h2><br>  Power Shell ist ein leistungsstarkes Tool zum Verwalten der Windows-Infrastruktur. Daher besteht eine gute Chance, dass der Angreifer es ausw√§hlt.  Sie k√∂nnen zwei Quellen verwenden, um Informationen zu Power Shell-Ereignissen abzurufen: Windows PowerShell-Protokoll und Microsoft-WindowsPowerShell / Betriebsprotokoll. <br><br><h4>  Windows PowerShell-Protokoll </h4><br><img src="https://habrastorage.org/webt/ao/zu/r3/aozur3ankpoqqckwf-x2af-ywza.png"><br><br>  <b>Datenprovider geladen (Ereignis-ID 600).</b>  PowerShell-Anbieter sind Programme, die als Datenquelle f√ºr PowerShell dienen, um sie anzuzeigen und zu verwalten.  Beispielsweise k√∂nnen die integrierten Anbieter Windows-Umgebungsvariablen oder die Registrierung sein.  Das Entstehen neuer Lieferanten muss √ºberwacht werden, um b√∂swillige Aktivit√§ten rechtzeitig zu erkennen.  Wenn beispielsweise WSMan unter Anbietern angezeigt wird, wurde eine Remote-PowerShell-Sitzung gestartet. <br><br><h4>  Microsoft-WindowsPowerShell / Betriebsprotokoll (oder MicrosoftWindows-PowerShellCore / Betrieb in PowerShell 6) </h4><br><img src="https://habrastorage.org/webt/de/ga/ci/degaci8kfzznwue4ywft7w2zwk8.png"><br><br>  <b>Moduljournal (Ereignis-ID 4103).</b>  Die Ereignisse speichern Informationen zu jedem ausgef√ºhrten Befehl und den Parametern, mit denen er aufgerufen wurde. <br><br>  <b>Protokollierung der Skriptsperre (Ereignis-ID 4104).</b>  Die Protokollierung der Skriptsperre zeigt jeden Block des ausgef√ºhrten PowerShell-Codes an.  Selbst wenn ein Angreifer versucht, den Befehl auszublenden, zeigt dieser Ereignistyp den tats√§chlich ausgef√ºhrten PowerShell-Befehl an.  Selbst bei dieser Art von Ereignissen k√∂nnen einige API-Aufrufe auf niedriger Ebene aufgezeichnet werden. Diese Ereignisse werden normalerweise als ausf√ºhrlich geschrieben. Wenn jedoch ein verd√§chtiger Befehl oder ein verd√§chtiges Skript in einem Codeblock verwendet wird, wird es kritisch als Warnung registriert. <br><br>  Bitte beachten Sie, dass nach dem Einrichten des Tools zum Sammeln und Analysieren dieser Ereignisse zus√§tzliche Debugging-Zeit erforderlich ist, um die Anzahl der Fehlalarme zu verringern. <br><br>  Teilen Sie uns in den Kommentaren mit, welche Protokolle Sie f√ºr die Pr√ºfung der Informationssicherheit sammeln und welche Tools Sie daf√ºr verwenden.  Einer unserer Bereiche sind L√∂sungen zur Pr√ºfung von Informationssicherheitsereignissen.  Um das Problem des Sammelns und Analysierens von Protokollen zu l√∂sen, k√∂nnen wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Quest InTrust</a> genauer betrachten, mit dem gespeicherte Daten im Verh√§ltnis 20: 1 komprimiert werden k√∂nnen. Eine installierte Instanz kann bis zu 60.000 Ereignisse pro Sekunde aus 10.000 Quellen verarbeiten. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de447522/">https://habr.com/ru/post/de447522/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de447510/index.html">GeekUniversity er√∂ffnet die Registrierung in der Designabteilung</a></li>
<li><a href="../de447512/index.html">Und wer hat das getan? Automatisieren Sie das Audit der Informationssicherheit</a></li>
<li><a href="../de447514/index.html">7 Interessante Startups im IoT</a></li>
<li><a href="../de447516/index.html">Wie wir CAD COMPASS-3D ‚Üí Teil 2 √ºbertaktet haben</a></li>
<li><a href="../de447520/index.html">Auto Tiering-Funktionen im Qsan XCubeSAN-Speicher</a></li>
<li><a href="../de447526/index.html">Eigenes Fahrrad zum Synchronisieren von MariaDB und Sphinx</a></li>
<li><a href="../de447528/index.html">Wer ist f√ºr die Qualit√§t verantwortlich?</a></li>
<li><a href="../de447530/index.html">OceanLotus: Malvari-Update f√ºr macOS</a></li>
<li><a href="../de447532/index.html">Splunk Universal Forwarder im Docker als Systemprotokollsammler</a></li>
<li><a href="../de447534/index.html">Kosmonaut Aleksandr Laveykin √ºber den besten Weltraumfilm, G-Force von 20 g und sanfte Landung</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>