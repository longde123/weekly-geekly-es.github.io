<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧑🏿‍🤝‍🧑🏼 👩🏾‍🤝‍👨🏽 👨🏽‍💼 Kaggle: Amazon from Space - astuces et hacks pour la formation des réseaux de neurones 👨🏿‍⚕️ 😎 👉🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'été dernier, le concours sur le site de kaggle, dédié à la classification des images satellites des forêts amazoniennes, s'est terminé. Notre équipe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kaggle: Amazon from Space - astuces et hacks pour la formation des réseaux de neurones</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/413667/"><img src="https://habrastorage.org/webt/os/ad/nr/osadnrglchljzop2xeerf65s0n0.png"><br><br>  L'été dernier, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">concours</a> sur le site de kaggle, dédié à la classification des images satellites des forêts amazoniennes, s'est terminé.  Notre équipe a pris la 7e place sur 900+ participants.  Malgré le fait que la compétition soit terminée depuis longtemps, presque toutes les méthodes de notre solution sont toujours applicables, non seulement pour les compétitions, mais aussi pour la formation de réseaux de neurones à vendre.  Pour plus de détails sous cat. <br><a name="habracut"></a><br>  <b>tldr.py</b> <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> kaggle <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ods <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> albu, alno, kostia, n01z3, nizhib, romul, ternaus <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> dataset <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> x_train, y_train, x_test oof_train, oof_test = [], [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> member <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> [albu, alno, kostia, n01z3, nizhib, romul, ternaus]: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> member.models: model.fit_10folds(x_train, y_train, config=member.fit_config) oof_train.append(model.predict_oof_tta(x_train, config=member.tta_config)) oof_test.append(model.predict_oof_tta(x_test, config=member.tta_config)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> albu.second_level: model.fit(oof_train) y_test = model.predict_proba(oof_test) y_test = kostia.bayes_f2_opt(y_test) kaggle.submit(y_test)</code> </pre> <br>  Description de la tâche <br><br>  Planet a préparé un ensemble d'images satellites en deux formats: <br><br><ol><li>  TIF - RVB 16 bits + N, où N - proche infrarouge </li><li>  JPG - RVB 8 bits, qui sont dérivés de TIF et qui ont été fournis pour réduire le seuil d'entrée dans la tâche, ainsi que pour simplifier la visualisation.  Lors du précédent concours à Kaggle, il était nécessaire de travailler avec des images multispectrales.  non visuels, c'est-à-dire infrarouges, ainsi que les canaux avec une longueur d'onde plus longue, ont considérablement amélioré la qualité de la prédiction, à la fois en réseau et en méthodes non supervisées. </li></ol><br>  Géographiquement, les données ont été prises sur le territoire du bassin de l'Amazone, et sur les territoires des pays du Brésil, du Pérou, de l'Uruguay, de la Colombie, du Venezuela, de la Guyane, de la Bolivie et de l'Équateur, dans lesquelles des surfaces intéressantes ont été sélectionnées, dont les images ont été proposées aux participants. <br><br>  Après avoir créé jpg à partir de tif, toutes les scènes ont été coupées en petits morceaux de taille 256x256.  Et selon jpg reçu par les employés de Planet des bureaux de Berlin et de San Francisco, ainsi que via la plateforme Crowd Flower, un marquage a été effectué. <br><br>  Les participants ont été chargés de prédire pour chaque tuile 256x256 l'une des marques météorologiques mutuellement exclusives: <br><br>  Nuageux, Partiellement nuageux, Brume, Clair <br><br>  Et aussi 0 ou plus de mauvais temps: agriculture, primaire, exploitation forestière sélective, habitation, eau, routes, culture itinérante, floraison, exploitation minière conventionnelle <br><br>  Un total de 4 conditions météorologiques et 13 non météorologiques, météo mutuellement exclusive, mais pas de temps, mais si l'image est nuageuse, il ne devrait pas y avoir d'autres balises. <br><br><img src="https://habrastorage.org/webt/me/ng/-t/meng-tzona5dhecl1r56eggbt1u.jpeg"><br><br>  La précision du modèle a été estimée par la métrique F2: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>S</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>+</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msup><mi>a</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>p</mi><mi>r</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msup><mi>a</mi><mn>2</mn></msup><mi>p</mi><mo>+</mo><mi>r</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="40.478ex" height="3.021ex" viewBox="0 -987.6 17427.8 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-53" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-63" x="645" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-6F" x="1079" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-72" x="1564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-65" x="2016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-3D" x="2760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-28" x="3816" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-31" x="4206" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-2B" x="4928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-62" x="6179" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-65" x="6609" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-74" x="7075" y="0"></use><g transform="translate(7437,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-32" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-29" x="8420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-66" x="9059" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-72" x="9610" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-61" x="10061" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-63" x="10591" y="0"></use><g transform="translate(11024,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-72" x="503" y="0"></use></g><g transform="translate(11979,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-62" x="639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-65" x="1069" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-74" x="1535" y="0"></use><g transform="translate(1897,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-32" x="748" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-70" x="2880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-2B" x="3606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-72" x="4606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-29" x="5058" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>S</mi><mi>c</mi><mi>o</mi><mi>r</mi><mi>e</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo>+</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msup><mi>a</mi><mn>2</mn></msup><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>p</mi><mi>r</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><msup><mi>a</mi><mn>2</mn></msup><mi>p</mi><mo>+</mo><mi>r</mi><mo stretchy="false">)</mo></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> Score = (1+ \ beta ^ 2) \ frac {pr} {(\ beta ^ 2p + r)} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>p</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>p</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>p</mi><mo>+</mo><mi>f</mi><mi>p</mi></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.808ex" height="2.419ex" viewBox="-38.5 -780.1 8098 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-3D" x="781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-66" x="2087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-72" x="2638" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-61" x="3089" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-63" x="3619" y="0"></use><g transform="translate(4052,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-70" x="361" y="0"></use></g><g transform="translate(4917,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-70" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-2B" x="1087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-66" x="2087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-70" x="2638" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>p</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>p</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>p</mi><mo>+</mo><mi>f</mi><mi>p</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> p = \ frac {tp} {tp + fp} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>r</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>p</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mi>p</mi><mo>+</mo><mi>f</mi><mi>n</mi></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.823ex" height="2.419ex" viewBox="0 -780.1 8104.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-72" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-3D" x="729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-66" x="2035" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-72" x="2586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-61" x="3037" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-63" x="3567" y="0"></use><g transform="translate(4000,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-70" x="361" y="0"></use></g><g transform="translate(4865,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-70" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-2B" x="1087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-66" x="2087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-6E" x="2638" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>r</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>p</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mi>p</mi><mo>+</mo><mi>f</mi><mi>n</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> r = \ frac {tp} {tp + fn} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>=</mo><mn>2</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.992ex" height="2.057ex" viewBox="0 -780.1 3871.6 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-62" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-65" x="679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-74" x="1146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMATHI-61" x="1507" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-3D" x="2314" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ods/blog/413667/&amp;usg=ALkJrhhRJh-ZNtOGuf6oIRyT3J8T7iJxow#MJMAIN-32" x="3371" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>t</mi><mi>a</mi><mo>=</mo><mn>2</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-4"> \ beta = 2 </script></p><br>  De plus, toutes les étiquettes avaient le même poids et le premier F2 a été calculé pour chaque image, puis il y a eu une moyenne générale.  Habituellement, ils le font un peu différemment, c'est-à-dire qu'une certaine métrique est calculée pour chaque classe, puis moyenne.  La logique est que cette dernière option est plus interprétable, car elle vous permet de répondre à la question de savoir comment le modèle se comporte sur chaque classe particulière.  Dans ce cas, les organisateurs ont opté pour la première option, qui, apparemment, est liée aux spécificités de leur entreprise. <br><br>  Il y a 40 000 échantillons dans le train.  Dans le test 40k.  En raison de la petite taille de l'ensemble de données, mais de la grande taille des images, nous pouvons dire que c'est «MNIST sous stéroïdes» <br><br>  <b>Digression lyrique</b> <br><br>  Comme vous pouvez le voir dans la description, la tâche est tout à fait compréhensible et la solution n'est pas sensée: il vous suffit de classer la grille.  Et en tenant compte des spécificités du cuggle, vous pouvez également empiler un tas de modèles sur le dessus.  Cependant, pour obtenir une médaille d'or, vous devez non seulement former en quelque sorte un tas de modèles.  Il est impératif d'avoir de nombreux modèles de base diversifiés, chacun d'eux-mêmes montrant un résultat exceptionnel.  Et déjà au-dessus de ces modèles, vous pouvez liquider l'empilement et d'autres hacks. <br><table><tbody><tr><th>  membre </th><th>  net </th><th>  1 recadrage </th><th>  Tta </th><th>  diff,% </th></tr><tr><td>  alno </td><td>  densenet121 </td><td>  0,9278 </td><td>  0,9294 </td><td>  0,1736 </td></tr><tr><td>  nizhib </td><td>  densenet169 </td><td>  0,9243 </td><td>  0,9277 </td><td>  0,3733 </td></tr><tr><td>  romul </td><td>  vgg16 </td><td>  0,9266 </td><td>  0,9267 </td><td>  0,0186 </td></tr><tr><td>  ternaus </td><td>  densenet121 </td><td>  0,9232 </td><td>  0,9241 </td><td>  0,0921 </td></tr><tr><td>  albu </td><td>  densenet121 </td><td>  0,9294 </td><td>  0,9312 </td><td>  0,1933 </td></tr><tr><td>  kostia </td><td>  resnet50 </td><td>  0,9262 </td><td>  0,9271 </td><td>  0,0907 </td></tr><tr><td>  n01z3 </td><td>  resnext50 </td><td>  0,9281 </td><td>  0,9298 </td><td>  0,1896 </td></tr></tbody></table><br>  Le tableau montre les modèles de score F2 de tous les participants pour une seule culture et TTA.  Comme vous pouvez le voir, la différence est faible pour une utilisation réelle, mais elle est importante pour le mode compétition. <br><br>  <b>Interaction d'équipe</b> <br><br>  Alexander Buslaev <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">albu</a></i> <br>  Au moment de sa participation au concours, il dirigeait toute la direction ml chez Geoscan.  Mais depuis lors, il a traîné un tas de compétitions, est devenu le père de toutes les SAO dans la segmentation sémantique et est parti pour Minsk, ramant dans Mapbox, sur lequel l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article a</a> été <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">publié.</a> <br><br>  Alexey Noskov <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">alno</a></i> <br>  Chasseur universel ml.  A travaillé chez Evil Martians.  Maintenant retourné à Yandex. <br><br>  Konstantin Lopukhin <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">kostialopuhin</a></i> <br>  A travaillé et continue de travailler chez Scrapinghub.  Depuis lors, Kostya a réussi à obtenir quelques médailles de plus et sans 5 minutes Kaggle Grandmaster <br><br>  Arthur Cousin <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">n01z3</a></i> <br>  Au moment de participer à ce concours, je travaillais chez Avito.  Mais vers la nouvelle année, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">la</a> startup Lead Data Scientist de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dbrain est passée</a> à la blockchain.  J'espère que nous ravirons bientôt la communauté avec nos compétitions avec dockers et marquages ​​de lampes. <br><br>  Evgeny Nizhibitsky <i>@nizhib</i> <br>  Lead Data Scientist chez Rambler &amp; Co.  De cette compétition, Eugene a découvert la capacité secrète de trouver des visages dans les compétitions d'images.  Ce qui l'a aidé à faire glisser quelques compétitions sur la plateforme Topcoder.  J'ai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">parlé</a> de l'un d'eux. <br><br>  Ruslan <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Baykulov romul</a></i> <br>  Engagé dans le suivi des événements sportifs à Constanta. <br><br>  Vladimir Iglovikov <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">ternaus</a></i> <br>  On se souvient de vous pour un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> bourré d'action sur le harcèlement par les services secrets britanniques.  Il a travaillé chez TrueAccord, mais a ensuite rejoint la jeunesse branchée Lyft.  Où fonctionne la vision par ordinateur pour une voiture autonome.  Continue de faire glisser les compétitions et a récemment reçu le Kaggle Grandmaster. <br><br>  Notre association et le format de participation peuvent être qualifiés de typiques.  La décision de s'unir était due au fait que nous avions tous des résultats serrés au classement.  Et chacun de nous a vu son propre pipeline indépendant, qui était une solution complètement autonome du début à la fin.  De plus, après la fusion, plusieurs participants se sont livrés au gerbage. <br><br>  La première chose que nous avons faite a été de partager les plis.  Nous nous sommes assurés que la distribution des classes dans chaque pli était la même que dans l'ensemble de données.  Pour cela, la classe la plus rare a d'abord été sélectionnée, stratifiée par elle, car les images restantes ont été stratifiées par la deuxième classe la plus populaire, et ainsi de suite jusqu'à ce qu'il ne reste plus d'images. <br><br>  Histogramme des classes de pli: <br><br><img src="https://habrastorage.org/webt/bh/wb/so/bhwbsoqk5acztwrsigxg0iwqpau.png"><br><br>  Nous avions également un référentiel commun, où chaque membre de l'équipe avait son propre dossier, dans lequel il organisait le code à sa guise. <br><br>  Et nous nous sommes également mis d'accord sur le format des prédictions, car c'était le seul point d'interaction pour combiner nos modèles. <br><br>  <b>Formation au réseau de neurones</b> <br><br>  Puisque chacun de nous avait un pipeline indépendant, nous étions un échantillon de la grille du processus d'apprentissage optimal parallélisé par les gens. <br><br>  <b>Approche générale</b> <br><br><img src="https://habrastorage.org/webt/fw/jo/bf/fwjobff3h_7__qvkhjmzi3fqhke.png"><br>  Photo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github.com/tornadomeet/ResNet</a> <br><br>  Un processus d'apprentissage typique est présenté sur le calendrier de formation des réseaux de neurones Resnet sur imagenet.  Ils commencent à partir de poids initialisés au hasard avec SGD (lr 0,1 Nesterov Momentum 0,0001 WD 0,9) puis après 30 effacements, abaissent le taux d'apprentissage de 10 fois. <br><br>  Conceptuellement, chacun de nous a utilisé la même approche, cependant, afin de ne pas vieillir tout en apprenant chaque réseau, la diminution de LR s'est produite si la validation n'a pas laissé tomber la perte pendant 3-5 époques consécutives.  Ou, certains participants ont simplement réduit le nombre d'époques sur chaque dégât LR et baissé selon le calendrier. <br><br>  <b>Augmentation</b> <br><br>  Choisir les bonnes augmentations est très important lors de la formation des réseaux de neurones.  Les augmentations devraient refléter la variabilité de la nature des données.  Classiquement, les augmentations peuvent être divisées en deux types: celles qui introduisent un biais dans les données et celles qui ne le font pas.  Par biais, on peut comprendre diverses statistiques de bas niveau, telles que les histogrammes de couleur ou la taille caractéristique.  À cet égard, disons, les augmentations et les échelles du HSV introduisent un décalage, mais pas un recadrage aléatoire. <br><br>  Aux premières étapes de la formation du réseau, vous pouvez aller trop loin avec les augmentations et utiliser un ensemble très dur.  Cependant, vers la fin de la formation, vous devez désactiver les augmentations ou ne laisser que celles qui n'introduisent pas de biais.  Cela permet au réseau de neurones de s'adapter un peu sous le train et d'afficher un résultat légèrement meilleur à la validation. <br><br>  <b>Congélation des couches</b> <br><br>  Dans la grande majorité des tâches, cela n'a aucun sens de former un réseau neuronal à partir de zéro, il est beaucoup plus efficace de jouer avec des réseaux pré-formés, par exemple avec Imagenet.  Cependant, vous pouvez aller plus loin et non seulement changer la couche entièrement connectée sous la couche avec le nombre de classes souhaité, mais d'abord l'entraîner à geler toutes les convolutions.  Si vous ne gelez pas les convolutions et entraînez immédiatement l'ensemble du réseau avec des poids initialisés de manière aléatoire d'une couche entièrement connectée, les poids des convolutions seront corrompus et les performances finales du réseau de neurones seront plus faibles.  Sur cette tâche, cela était particulièrement visible en raison de la petite taille de l'échantillon de formation.  Dans d'autres compétitions avec une grande quantité de données telles que cdiscount, il n'était pas possible de geler l'ensemble du réseau neuronal, mais des groupes de convolutions de la fin.  De cette façon, l'entraînement pourrait être considérablement accéléré, car les gradients n'étaient pas pris en compte pour les couches gelées. <br><br>  <b>Recuit cyclique</b> <br><br>  Ce processus ressemble à ceci.  Après l'achèvement du processus de formation de base du réseau neuronal, les meilleurs poids sont pris et le processus de formation est répété.  Mais cela commence par un taux d'apprentissage inférieur et se produit en peu de temps, disons 3-5 époques.  Cela permet au réseau neuronal de descendre à un minimum local inférieur et de montrer de meilleures performances.  Cette campagne stable améliore le résultat dans un nombre assez important de concours. <br><br>  Plus en détail sur deux réceptions <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> <br><br>  <b>Augmenter le temps de test</b> <br><br>  Comme il s'agit d'un concours et que nous n'avons pas de restriction formelle sur le temps d'inférence, vous pouvez utiliser des augmentations pendant le test.  Il semble que l'image soit déformée de la même manière que lors de l'entraînement.  Disons, il est réfléchi verticalement, horizontalement, tourné d'un angle, etc.  Chaque augmentation donne une nouvelle image à partir de laquelle nous obtenons des prédictions.  Ensuite, les prévisions de telles distorsions d'une image sont moyennées (en règle générale par des moyens géométriques).  Cela donne également un profit.  Dans d'autres compétitions, j'ai également expérimenté des augmentations aléatoires.  Dites, vous pouvez appliquer pas un à la fois, mais simplement réduire de moitié l'amplitude des virages aléatoires, des contrastes et des augmentations de couleur, fixer la graine et faire plusieurs images déformées de manière aléatoire.  Cela a également donné une augmentation. <br><br>  <b>Assemblage d'instantanés (TTA à points de contrôle multiples)</b> <br><br>  L'idée de recuit peut être développée davantage.  À chaque étape du recuit, le réseau neuronal vole dans des minima locaux légèrement différents.  Et cela signifie que ce sont essentiellement des modèles légèrement différents qui peuvent être moyennés.  Ainsi, lors des prédictions du test, vous pouvez prendre les trois meilleurs points de contrôle et faire la moyenne de leurs prédictions.  J'ai également essayé de ne pas prendre les trois meilleurs, mais les trois plus divers des 10 principaux points de contrôle - c'était pire.  Eh bien, pour la production, une telle astuce n'est pas applicable et j'ai essayé de faire la moyenne du poids des modèles.  Cela a donné une augmentation très insignifiante mais régulière. <br><br><img src="https://habrastorage.org/webt/ad/_l/po/ad_lposcfqtrpo67wc3abmzvxq0.png"><br><br>  <b>Approches de chaque membre de l'équipe</b> <br><br>  En conséquence, à un degré ou à un autre, chaque membre de notre équipe a utilisé une combinaison différente des techniques ci-dessus. <br><table><tbody><tr><th>  <nobr>nick</nobr> </th><th>  <nobr>Gel de conv.,</nobr> <br>  époque </th><th>  <nobr>Optimiseur</nobr> </th><th>  <nobr>La stratégie</nobr> </th><th>  <nobr>Août</nobr> </th><th>  <nobr>Tta</nobr> </th></tr><tr><th>  albu </th><td>  3 </td><td>  SGD </td><td>  15 décroissance de l'époque LR, <br>  Cercle 13 époques </td><td>  D4, <br>  Scale, <br>  Décalage <br>  Distorsion <br>  Contraste <br>  Flou </td><td>  D4 </td></tr><tr><th>  alno </th><td>  3 </td><td>  SGD </td><td>  Lr decay </td><td>  D4, <br>  Scale, <br>  Décalage <br>  Distorsion <br>  Contraste <br>  Flou <br>  Cisaillement <br>  Multiplicateur de canaux </td><td>  D4 </td></tr><tr><th>  n01z3 </th><td>  2 </td><td>  SGD </td><td>  Drop LR, patient 10 </td><td>  D4, <br>  Scale, <br>  Distorsion <br>  Contraste <br>  Flou </td><td>  D4, 3 points de contrôle </td></tr><tr><th>  <nobr>ternaus</nobr> </th><td>  - </td><td>  Adam </td><td>  LR cyclique (1e-3: 1e-6) </td><td>  D4, <br>  Scale, <br>  Ajout de chaîne <br>  Contraste </td><td>  D4, <br>  récolte aléatoire </td></tr><tr><th>  nizhib </th><td>  - </td><td>  Adam </td><td>  StepLR, 60 époques, 20 par désintégration </td><td>  D4, <br>  RandomSizedCrop </td><td>  D4, <br>  4 coins, <br>  centre <br>  échelle </td></tr><tr><th>  kostia </th><td>  1 </td><td>  Adam </td><td></td><td>  D4, <br>  Scale, <br>  Distorsion <br>  Contraste <br>  Flou </td><td>  D4 </td></tr><tr><th>  romul </th><td>  - </td><td>  SGD </td><td>  base_lr: 0,01 - 0,02 <br>  lr = base_lr * (0,33 ** (époque / 30)) <br>  Epoque: 50 </td><td>  D4, échelle </td><td>  D4, Recadrage central, <br>  Cultures de coin </td></tr></tbody></table><br>  <b>Empilement et hacks</b> <br><br>  Nous avons formé chaque modèle avec chaque ensemble de paramètres sur 10 plis.  Et puis sur les prédictions hors du pli (OOF), nous avons enseigné des modèles de deuxième niveau: Extra Trees, Linear Regression, Neural Network et simplement des modèles de moyenne. <br><br>  Et déjà chez OOF, les prédictions des modèles de deuxième niveau ont pris des poids pour le mélange.  Vous pouvez en savoir plus sur l'empilement <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br>  Dans la production réelle, curieusement, cette approche a également lieu.  Par exemple, lorsqu'il existe des données multimodales (images, texte, catégories, etc.) et que vous souhaitez combiner les prédictions des modèles.  Vous pouvez simplement faire la moyenne des probabilités, mais la formation d'un modèle de deuxième niveau donne le meilleur résultat. <br><br>  <b>Optimisation Baes F2</b> <br><br>  De plus, les prédictions finales se sont un peu ajustées en utilisant l'optimisation bayésienne.  Supposons que nous ayons des probabilités idéales, alors F2 avec le meilleur tapis d'attente (c'est-à-dire de type optimal) est obtenu par la formule suivante: <br><br><img src="https://habrastorage.org/webt/gx/dh/ff/gxdhff8q1dgrym6n2t7nzna144e.png"><br><br>  Qu'est-ce que cela signifie?  Nous devons trier toutes les combinaisons (c'est-à-dire pour chaque étiquette 0 et 1), calculer la probabilité de chaque combinaison et multiplier par F2 - nous obtenons la F2 attendue.  Pour quelle combinaison est-ce mieux et donnera le F2 optimal.  Les probabilités étaient considérées simplement comme une multiplication des probabilités d'étiquettes individuelles (si l'étiquette est 0, nous prenons 1 - p), et afin de ne pas trier 2 en 17 options, seules les étiquettes avec une probabilité de 0,05 à 0,5 étaient échelonnées - il y en avait 3-7 dans une rangée, donc les options un peu (la soumission a été faite en quelques minutes).  En théorie, il serait intéressant d'obtenir la probabilité d'une combinaison d'étiquettes, non seulement de multiplier les probabilités individuelles (car les étiquettes ne sont pas indépendantes), mais cela n'a pas fonctionné. <br><br>  qu'est-ce que cela a donné?  lorsque les modèles sont devenus bons, la sélection des seuils après que l'ensemble a cessé de fonctionner, et cette chose a donné une augmentation petite mais stable à la fois de la validation et du public / privé. <br><br>  <b>Postface</b> <br><br>  En conséquence, nous avons formé 48 modèles différents, chacun à 10 plis, soit  480 modèles du premier niveau.  Une telle grille humaine m'a permis d'essayer différentes techniques lors de l'entraînement de réseaux neuronaux convolutionnels profonds, que j'utilise toujours dans le travail et les compétitions. <br><br>  Était-il possible de former moins de modèles et d'obtenir le même résultat ou un meilleur résultat?  Oui, tout à fait.  Nos compatriotes de la 3e place, Stanislav <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">stasg7</a> Semenov et Roman <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ZFTurbo</a> Soloviev, ont coûté un plus petit nombre de modèles de premier niveau et compensé plus de 250 modèles de deuxième niveau.  À propos de la solution, vous pouvez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">voir l'</a> analyse et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lire le</a> post. <br><br>  La première place est allée au meilleur ajustement mystérieux.  En général, ce gars est très cool, et maintenant il est devenu le classement Keggle top1, après avoir tiré beaucoup de compétitions d'image.  Il est resté longtemps anonyme, jusqu'à ce que Nvidia brise la couverture en l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">interviewant</a> .  Dans lequel il a admis que 200 subordonnés lui feraient rapport ... Il y a aussi un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article</a> sur la décision. <br><br>  Un autre des plus intéressants: largement connu dans les cercles étroits de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Jeremy Howard</a> , le père <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">fastai a</a> terminé 22m.  Et si vous pensiez qu'il venait d'envoyer quelques soumissions pour son fan, alors vous ne l'avez pas deviné.  Il a participé à l'équipe et envoyé 111 colis. <br><br>  En outre, les étudiants diplômés de Stanford qui suivaient le légendaire cours CS231n à l'époque et qui étaient autorisés à utiliser cette tâche comme projet de cours, ont terminé toute l'équipe au milieu du classement. <br><br>  En prime, j'ai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">parlé</a> à Mail.ru avec le contenu de ce message et voici une autre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">présentation de</a> Vladimir Iglovikov lors d'une réunion dans la vallée. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr413667/">https://habr.com/ru/post/fr413667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr413655/index.html">Quels textes pour les pages de destination vendent-ils vraiment?</a></li>
<li><a href="../fr413657/index.html">Le réseau de neurones Uber reconnaît les utilisateurs dans un état «inhabituel»</a></li>
<li><a href="../fr413661/index.html">Saga des services électroniques et de leurs emplacements. Partie 1. Service électronique</a></li>
<li><a href="../fr413663/index.html">Histoires backend MeetUp</a></li>
<li><a href="../fr413665/index.html">Comment déterminer le volume de vos logs?</a></li>
<li><a href="../fr413669/index.html">Samsung IT School: enseigner aux étudiants comment développer des applications mobiles</a></li>
<li><a href="../fr413673/index.html">Sur la question des performances des anciennes et nouvelles versions d'un nœud</a></li>
<li><a href="../fr413675/index.html">Joker 2018: Club des développeurs Java anonymes</a></li>
<li><a href="../fr413677/index.html">Lancement de ROS sur le robot auto-équilibrant EduMIP</a></li>
<li><a href="../fr413679/index.html">Angulaire 6. PWA. Modules de chargement paresseux. Déploiement automatique dans Firebase</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>