<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍🏭 ☝️ 👩🏿‍💻 Kivy. Xamarin React Native. Trois cadres - une expérience 🚶🏾 🤘🏾 👩🏿‍🤝‍👩🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salutations à tous! Dès que la fumée de la discussion animée dans les commentaires de mon article, Kivy est un cadre d'âne pour le développement multi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kivy. Xamarin React Native. Trois cadres - une expérience</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/420691/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/zs/ph/zy/zsphzyh0mmbmfwzsfmkdi5tff4w.png"></div><br>  Salutations à tous!  Dès que la fumée de la discussion animée dans les commentaires de mon article, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kivy est un cadre d'âne pour le développement multiplateforme n ° 1</a> , et entre autres <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un commentaire digne d'attention l'a fait</a> , nous ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">Mirimon</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">SeOd</a> ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">avons</a> pensé qu'il serait intéressant pour nous et les lecteurs de comparer Kivy, Xamarin.Forms et React Native, en écrivant la même application sur eux, l'accompagnez de l'article correspondant sur Habré, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">tournez sur GitHub</a> et dites honnêtement qui a rencontré quelles difficultés lors de la mise en œuvre.  Après nous être réunis dans le télégramme et avoir discuté des détails, nous nous sommes mis au travail. <a name="habracut"></a><br><br>  Pour cette comparaison, nous avons décidé d'écrire un planificateur de tâches simple avec trois écrans.  Découper l'état de ces trois plateformes aujourd'hui, en utilisant l'exemple de quelque chose de plus volumineux que l'exemple que nous avons choisi, car tout le monde est occupé dans ses projets / au travail / à la maison, prend trop de temps.  Malgré la simplicité de notre application, elle vous permettra de démontrer clairement les principes de développement d'applications dans chaque environnement, de travailler avec des données, l'interface utilisateur, etc. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Trois cadres - une expérience.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>Xamarin.Forms.</b></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>2e partie</b></a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Trois cadres - une expérience.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>React Native.</b></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>3e partie</b></a> <br><br>  Cet article est le premier du cycle, je veux donc commencer par les TdR, que nous avons esquissés pour nous-mêmes, afin que le résultat soit similaire. <br><br><h3>  Option TK: </h3><br><ul><li>  Les notes doivent être structurées par projet. </li><li>  Les notes peuvent être ajoutées par différentes personnes, donc l'auteur de la note doit être indiqué </li><li>  Les notes à l'intérieur du projet doivent être ajoutées / supprimées / modifiées. </li><li>  Les notes doivent être de la taille du contenu, mais pas plus de 150 pixels </li><li>  La suppression des notes doit se faire à la fois via le menu contextuel de la note elle-même et par balayage </li></ul><br><h3>  Un exemple d'interface utilisateur devrait ressembler à ceci: </h3><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9a/59/pe/9a59pegwbpwor9yytkfxwxqd_ue.png"></div><br><div class="spoiler">  <b class="spoiler_title">Avant de commencer, un peu d'aide sur Kivy:</b> <div class="spoiler_text">  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kivy</a> est un cadre graphique multiplateforme écrit dans le langage de programmation Python / Cython, basé sur OpenGL ES 2, visant à créer des interfaces utilisateur modernes, plus axées sur le travail avec des appareils tactiles.</i>  <i>Les applications Kivy s'exécutent sur des plateformes telles que Linux, OS X, Windows, Android, iOS et Rapberry Pi.</i>  <i>En cours de développement, vous avez accès à un large éventail de bibliothèques Python allant des requêtes à NumPy et OpenCV.</i>  <i>Kivy a accès à presque toutes les API mobiles natives (GPS, appareil photo, accéléromètre, API Google pour Android), via PyJNIus (Android) et PyOBJus (iOS), qui enveloppent automatiquement le code Java / Objective-C en Python .</i> <i><br><br></i>  <i>Kivy est rapide.</i>  <i>Cela s'applique à la fois au développement d'applications et à la vitesse d'exécution des applications.</i>  <i>Toutes les fonctions critiques sont implémentées au niveau C.</i>  <i>Kivy utilise également le GPU partout où cela a du sens.</i>  <i>Le GPU fait la plupart du travail, augmentant considérablement les performances.</i> <i><br><br></i>  <i>Kivy est très flexible.</i>  <i>Cela signifie que le développement rapide de Kivy vous permet de vous adapter instantanément aux nouvelles technologies.</i>  <i>Les développeurs de Kivy ont ajouté à plusieurs reprises la prise en charge de nouveaux périphériques externes et protocoles logiciels, parfois même avant leur sortie.</i>  <i>Kivy peut être utilisé conjointement avec de nombreuses solutions tierces différentes.</i>  <i>Par exemple, sous Windows, Kivy prend en charge WM_TOUCH, ce qui signifie que tout appareil doté de pilotes Windows 7 Pen &amp; Touch fonctionnera avec Kivy.</i>  <i>Sous OS X, vous pouvez utiliser des appareils Apple avec prise en charge Multi-Touch, tels que des trackpads et des souris.</i>  <i>Sous Linux, vous pouvez utiliser des événements d'entrée d'entrée HID.</i>  <i>De plus, Kivy prend en charge TUIO (Tangible User Interface Objects) et un certain nombre d'autres sources d'entrée.</i> <i><br><br></i>  <i>Vous pouvez écrire une application simple avec quelques lignes de code.</i>  <i>Les programmes Kivy sont créés en utilisant le langage de programmation Python, qui est incroyablement polyvalent et puissant, mais facile à utiliser.</i>  <i>De plus, les développeurs de Kivy ont créé leur propre langage de balisage graphique pour créer des interfaces graphiques personnalisées sophistiquées.</i>  <i>Cette langue vous permet de configurer, connecter et organiser rapidement les éléments de l'application.</i> <i><br><br></i>  <i>Et, oui, Kivy est totalement gratuit.</i>  <i>Vous pouvez l'utiliser partout!</i>  <i>Dans un produit commercial ou en Open Source.</i> <br></div></div><br>  Je donnerai tout le code de l'application et montrerai suffisamment en détail comment ces ou ces éléments sont implémentés lors du développement pour les plateformes mobiles.  En tant <i>qu'IDE</i> , <i>j'utilise</i> toujours <i>PyCharm</i> , qui prend parfaitement en charge la syntaxe du <b>langage Kv</b> - un langage DSL spécial dans lequel la représentation de l'interface utilisateur de votre application est écrite.  Le squelette de l'application a été créé à l'aide de l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">utilitaire de</a> console <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">CreatorKivyProject</a> , qui fournit des écrans de base à l'aide du modèle MVVM. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/i5/de/m1/i5dem1ryi468aeeeo60_tjnxpke.png"></div><br>  Le dossier <b>baseclass</b> contient la logique des widgets et des contrôles implémentés dans le langage de programmation Python, dans les fichiers de description d'interface <b>kv</b> dans le <i>langage Kv</i> .  Le répertoire <b>applibs est</b> utilisé pour les bibliothèques tierces, dans le dossier de <b>données</b> , il y a du contenu multimédia, des bases de données et d'autres données.  Le fichier <b>main.py</b> est le point d'entrée de l'application.  Il ne fait rien d'autre que lancer l'interface utilisateur <b>TodoList (). Run ()</b> rend, capte une erreur si elle se produit et affiche une fenêtre pour envoyer un rapport de bogue, créé automatiquement par l'utilitaire <i>CreatorKivyProject</i> , n'a rien à voir avec l'écriture de notre application, et n'est donc pas considéré. <br><br>  Le fichier <b>todolist.py</b> avec le code du programme implémente la classe <b>TodoList</b> , qui charge les dispositions d'interface, initialise leurs instances, surveille les événements des touches de fonction de l'appareil et renvoie notre premier écran, qui sont répertoriés dans le gestionnaire d'activité.  Après <b>TodoList (). Run ()</b> , la fonction de <b>génération</b> est appelée et renvoie le widget qui sera affiché à l'écran. <br><br>  Par exemple, le code d'un programme simple qui affiche un seul écran avec une image ressemblera à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1e/dc/wi/1edcwilpi3ejmykf6qiqjvhftcy.png"></div><br>  Et voici le schéma de notre classe d'application: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/sv/9j/8n/sv9j8npirktg3qeglec4vclue4i.png"></div><br><div class="spoiler">  <b class="spoiler_title">todolist.py:</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- import os from kivy.app import App from kivy.lang import Builder from kivy.core.window import Window from kivy.factory import Factory from libs.applibs.kivymd.theming import ThemeManager from libs.dataBase import DataBase class TodoList(App, DataBase): title = 'Todo List' icon = 'icon.png' theme_cls = ThemeManager() theme_cls.primary_palette = 'BlueGrey' def __init__(self, **kvargs): super(TodoList, self).__init__(**kvargs) Window.bind(on_keyboard=self.eventsProgram) Window.softinput_mode = 'below_target' self.Window = Window self.pathToBase = '%s/data/dataProjects.json' % self.directory self.nameAuthor = u' ' def build(self): self.setDataProjects() self.loadAllKvFiles(os.path.join(self.directory, 'libs', 'uix', 'kv')) self.rootScreen = Factory.RootScreen() #    #  Activity. self.activityManager = self.rootScreen.ids.activityManager self.listProjectsActivity = self.rootScreen.ids.listProjectsActivity self.listNotesActivity = self.rootScreen.ids.listNotesActivity self.addNewNoteActivity = self.rootScreen.ids.addNewNoteActivity return self.rootScreen def loadAllKvFiles(self, directory_kv_files): for kv_file in os.listdir(directory_kv_files): kv_file = os.path.join(directory_kv_files, kv_file) if os.path.isfile(kv_file): Builder.load_file(kv_file) def on_start(self): self.listProjectsActivity.setListProjects(self) def eventsProgram(self, instance, keyboard, keycode, text, modifiers): if keyboard in (1001, 27): if self.activityManager.current == 'add new note activity': self.activityManager.backActivity( 'list notes activity', self.addNewNoteActivity.ids.floatingButton) if self.activityManager.current == 'list notes activity': self.activityManager.current = 'list project activity' return True</span></span></code> </pre> <br></div></div><br>  Notre application se compose de seulement trois <i>activités</i> , le gestionnaire d'écran ( <i>ScreenMenager</i> ), que nous avons renvoyé aux fonctions de <b>construction</b> , est responsable de la <b>commutation</b> : <br><br><pre> <code class="hljs scala">#:<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">ListProjectsActivity</span></span> libs.uix.baseclass.<span class="hljs-type"><span class="hljs-type">ListProjectsActivity</span></span>.<span class="hljs-type"><span class="hljs-type">ListProjectsActivity</span></span> #:<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">ListNotesActivity</span></span> libs.uix.baseclass.<span class="hljs-type"><span class="hljs-type">ListNotesActivity</span></span>.<span class="hljs-type"><span class="hljs-type">ListNotesActivity</span></span> #:<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">AddNewNoteActivity</span></span> libs.uix.baseclass.<span class="hljs-type"><span class="hljs-type">AddNewNoteActivity</span></span>.<span class="hljs-type"><span class="hljs-type">AddNewNoteActivity</span></span> #:<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-type"><span class="hljs-type">ActivityManager</span></span> libs.uix.baseclass.<span class="hljs-type"><span class="hljs-type">ActivityManager</span></span>.<span class="hljs-type"><span class="hljs-type">ActivityManager</span></span> &lt;<span class="hljs-type"><span class="hljs-type">RootScreen</span></span><span class="hljs-meta"><span class="hljs-meta">@BoxLayout</span></span>&gt;: orientation: <span class="hljs-symbol"><span class="hljs-symbol">'vertica</span></span>l' spacing: dp(<span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-type"><span class="hljs-type">ActivityManager</span></span>: id: activityManager <span class="hljs-type"><span class="hljs-type">ListProjectsActivity</span></span>: id: listProjectsActivity <span class="hljs-type"><span class="hljs-type">ListNotesActivity</span></span>: id: listNotesActivity <span class="hljs-type"><span class="hljs-type">AddNewNoteActivity</span></span>: id: addNewNoteActivity</code> </pre><br>  Lorsque l'application démarre, l'activité qui est spécifiée dans ActivityManager en premier sera installée.  Dans notre cas, c'est <i>ListProjectsActivity</i> .  Dans l'application pour les listes de projets et de tâches, j'ai utilisé <i>ScrollView</i> .  Bien que ce soit plus correct - <i>RecycleView</i> .  Parce que le premier, s'il y a plus d'une centaine d'articles et de projets, ne peut pas le faire.  Plus précisément, le rendu des listes prendra très longtemps.  <i>RecycleView vous</i> permet d'afficher des listes de n'importe quelle longueur presque instantanément.  Mais comme dans tous les cas, avec de grandes listes, vous devrez utiliser soit le chargement dynamique des données dans une liste, soit la pagination, mais cela n'a pas été discuté dans le TOR, j'ai utilisé <i>ScrollView</i> .  La deuxième raison est que j'étais trop paresseux pour refaire les listes sous <i>RecycleView</i> (et son utilisation est <i>fondamentalement</i> différente de <i>ScrollView</i> ), et il n'y avait pas beaucoup de temps, car toute l'application a été écrite en quatre heures dans des pauses fumeurs et des pauses café. <br><br>  L'écran de démarrage avec une liste de projets (ListProjectsActivity.kv et ListProjectsActivity.py) ressemble à ceci: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4g/lu/i4/4glui4eyzptivo76zrmmqj_amqw.png"></div><br>  Étant donné que la disposition de l'écran ListProjectsActivity est déjà affichée à l'écran, je vais montrer à quoi ressemble sa classe de contrôle: <br><br><pre> <code class="hljs pgsql"># -*- coding: utf<span class="hljs-number"><span class="hljs-number">-8</span></span> -*- <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.screenmanager <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Screen <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Activity <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> libs.uix.baseclass.InputDialog <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> InputDialog <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> . ProjectItem <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ProjectItem <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> ListProjectsActivity(Activity): objApp = App.get_running_app() def setListProjects(self, objApp): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> nameProject <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> objApp.dataProjects.keys(): self.ids.layoutContainer.add_widget(ProjectItem(projectName=nameProject)) def createNewProject(self, projectName): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> projectName <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> projectName.isspace(): self.ids.layoutContainer.add_widget(ProjectItem(projectName=projectName)) self.objApp.addProjectInBase(projectName) def deleteProject(self, instance): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> projectName <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.objApp.dataProjects: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> instance.projectName == projectName: self.objApp.deleteProjectFromBase(projectName) break def showDialogCreateProject(self, *args): InputDialog( title=<span class="hljs-string"><span class="hljs-string">' '</span></span>, hintText=<span class="hljs-string"><span class="hljs-string">' '</span></span>, textButtonCancel=<span class="hljs-string"><span class="hljs-string">''</span></span>, textTuttonOk=<span class="hljs-string"><span class="hljs-string">''</span></span>, eventsCallback=self.createNewProject).<span class="hljs-keyword"><span class="hljs-keyword">show</span></span>()</code> </pre><br>  Appel de la boîte de dialogue: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bt/t1/kj/btt1kjdoddave7eoowlvhxigdpq.png"></div><br>  Dans le travail, appeler la fenêtre et créer un nouveau projet ressemblera à ceci: <br><table><tbody><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/webt/te/gh/hm/teghhm6op9paveubdsjwh0m_d60.gif"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/webt/uz/v7/hl/uzv7hllrtghzrnw-rj0i7e7xnds.gif"></div></td></tr></tbody></table><br>  Je ne m'attarderai pas sur la question des données d'application, car les données sont un dictionnaire régulier du formulaire <br><br><pre> <code class="python hljs">{<span class="hljs-string"><span class="hljs-string">"Name Project"</span></span>: [{<span class="hljs-string"><span class="hljs-string">"pathToAvatar"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"nameDate"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"nameAuthor"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"textNote"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>}]}</code> </pre> <br>  et qui est stocké dans le répertoire de <b>données</b> sous la forme d'un simple fichier json. <br><br>  Voyons ce qu'est l'élément avec le nom du projet et comment utiliser Kivy pour supprimer un élément de la liste par balayage?  Pour ce faire, nous devons hériter du comportement du widget dans la liste de la classe <i>SwipeBehavior</i> de la bibliothèque <i>SwipeToDelete</i> : <br><br>  <b>ProjectItemActivity.py</b> <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.properties <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StringProperty <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.boxlayout <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BoxLayout <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> libs.applibs.swipetodelete <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SwipeBehavior <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ProjectItemActivity</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(SwipeBehavior, BoxLayout)</span></span></span><span class="hljs-class">:</span></span> projectName = StringProperty() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_touch_down</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.collide_point(touch.x, touch.y): self.move_to = self.x, self.y <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super(ProjectItemActivity, self).on_touch_down(touch) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_touch_move</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.collide_point(touch.x, touch.y): self.reduce_opacity() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super(ProjectItemActivity, self).on_touch_move(touch) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">on_touch_up</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, touch)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.collide_point(touch.x, touch.y): self.check_for_left() self.check_for_right() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> super(ProjectItemActivity, self).on_touch_up(touch)</code> </pre><br>  Et la description de l'élément de projet dans le balisage Kv: <br><br>  <b>ProjectItemActivity.kv</b> <br><pre> <code class="hljs css">&lt;<span class="hljs-selector-tag"><span class="hljs-selector-tag">ProjectItemActivity</span></span>&gt;: <span class="hljs-selector-tag"><span class="hljs-selector-tag">swipe_rectangle</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">self</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.x</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">self</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.y</span></span> , <span class="hljs-selector-tag"><span class="hljs-selector-tag">self</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.width</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">self</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.height</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">swipe_timeout</span></span>: 1000000 <span class="hljs-selector-tag"><span class="hljs-selector-tag">swipe_distance</span></span>: 1 <span class="hljs-selector-tag"><span class="hljs-selector-tag">event_after_swipe</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">app</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.listActivity</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.deleteProject</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">OneLineListItem</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">text</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.projectName</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">on_press</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">app</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.listActivity</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.setNotesProject</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">root</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.projectName</span></span>)</code> </pre><br>  En général, chaque widget dans Kivy a une méthode <b><i>on_touch</i></b> avec laquelle vous pouvez capturer tous les événements qui se produisent à l'écran.  Voici une petite partie de la liste des événements disponibles: <br><br><pre> <code class="python hljs">[<span class="hljs-string"><span class="hljs-string">'double_tap_time'</span></span>, <span class="hljs-string"><span class="hljs-string">'grab_state'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_double_tap'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_mouse_scrolling'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_touch'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_triple_tap'</span></span>, <span class="hljs-string"><span class="hljs-string">'move'</span></span>, <span class="hljs-string"><span class="hljs-string">'push'</span></span>, <span class="hljs-string"><span class="hljs-string">'push_attrs'</span></span>, <span class="hljs-string"><span class="hljs-string">'push_attrs_stack'</span></span>, <span class="hljs-string"><span class="hljs-string">'scale_for_screen'</span></span>, <span class="hljs-string"><span class="hljs-string">'time_end'</span></span>, <span class="hljs-string"><span class="hljs-string">'time_start'</span></span>, <span class="hljs-string"><span class="hljs-string">'time_update'</span></span>, <span class="hljs-string"><span class="hljs-string">'triple_tap_time'</span></span>, <span class="hljs-string"><span class="hljs-string">'ungrab'</span></span>, <span class="hljs-string"><span class="hljs-string">'update_time_end'</span></span>]</code> </pre><br><table><tbody><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/webt/zz/bl/rl/zzblrlviduost-tycdnpvs-xyy0.gif"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/webt/bd/dv/ml/bddvmlttyqkolsl5a-cy2r9a6vc.gif"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/webt/nm/i0/fw/nmi0fw493_feuoafuwzbm4xr7hm.gif"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/webt/kj/yr/9a/kjyr9axwzdywc3tdgkm_eyq9tzo.gif"></div></td></tr></tbody></table><br>  Implémentation du menu contextuel pour Android ... <br><br>  Il n'y a eu aucun problème ici non plus, car il s'agit simplement d'un widget DropDown standard.  Grâce au fait que vous pouvez personnaliser tous les widgets et contrôles dans Kivy autant que votre imagination le permet, j'ai facilement obtenu un joli menu.  A gauche se trouve la base DropDown, à droite est la mienne: <br><table><tbody><tr><td><div style="text-align:center;"><img src="https://habrastorage.org/webt/9r/wh/nm/9rwhnm1vtqz-z9sbkosz-69rnrs.gif"></div></td><td><div style="text-align:center;"><img src="https://habrastorage.org/webt/hp/oz/xt/hpozxtujdyich9u4u9oh3wmasdw.gif"></div></td></tr></tbody></table><br>  Présentation de la liste du menu contextuel: <br><br>  <b>ContextMenuAndroidActivity.kv</b> <br><pre> <code class="hljs pgsql">#:<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MDSeparator libs.applibs.kivymd.card.MDSeparator #:<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MenuItem libs.applibs.animdropdown.MenuItem &lt;ContextMenuAndroidActivity&gt;: MenuItem: <span class="hljs-type"><span class="hljs-type">text</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> menu: root on_press: root.tapOnItem(self.text) MDSeparator: MenuItem: <span class="hljs-type"><span class="hljs-type">text</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> menu: root on_press: root.tapOnItem(self.text)</code> </pre><br>  La partie logicielle du menu contextuel: <br><br>  <b>ContextMenuAndroidActivity.kv</b> <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.clock <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Clock <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> libs.applibs.animdropdown <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AnimMenuDropDown <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContextMenuAndroidActivity</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(AnimMenuDropDown)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">tapOnItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, textItem)</span></span></span><span class="hljs-function">:</span></span> objApp = App.get_running_app() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> textItem == <span class="hljs-string"><span class="hljs-string">''</span></span>: objApp.listActivity.deletePost() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: objApp.activityManager.current = <span class="hljs-string"><span class="hljs-string">'add new note activity'</span></span> Clock.schedule_once(objApp.addNewNoteActivity.editNote, <span class="hljs-number"><span class="hljs-number">.5</span></span>)</code> </pre><br>  Ensuite, nous importons le bouton <i>MenuDropDown</i> de la bibliothèque <i>animdropdown</i> , lui passons l'objet de notre menu contextuel en tant que paramètre, puis nous ajoutons ce bouton à l'écran dont nous avons besoin.  Dans notre application, voici le bouton à droite de la fiche: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/27/qr/jt/27qrjtfka-i1bjmtzte93q2iefm.png"></div><br>  Remarques sur la carte d'activité de balisage: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/aq/bt/tx/aqbttxbii2mhh-jo6ispppmo6ks.png"></div><br>  Classe de base <b>NoteActivity</b> : <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.properties <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> StringProperty <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.boxlayout <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> BoxLayout <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> libs.applibs.animdropdown <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MenuButton <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> libs.applibs.swipetodelete <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SwipeBehavior <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> . ContextMenu <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ContextMenu <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NoteActivity</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(SwipeBehavior, BoxLayout)</span></span></span><span class="hljs-class">:</span></span> nameDate = StringProperty() textNote = StringProperty() pathToAvatar = StringProperty() <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super(NoteActivity, self).__init__(**kwargs) self.objApp = App.get_running_app() menuButton = MenuButton( dropdown_cls=ContextMenu, icon=<span class="hljs-string"><span class="hljs-string">'dots-vertical'</span></span>, _on_dropdown_fnc=self.setCurrentPost) self.ids.titleBox.add_widget(menuButton) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setCurrentPost</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, *args)</span></span></span><span class="hljs-function">:</span></span> self.objApp.listNotesActivity.checkCurentPost = self</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ir/y9/vi/iry9vibv89ycgb70uwcb6rensce.png"></div><br>  <b>Implémentation</b> logicielle de <b>ListNotesActivity</b> : <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># -*- coding: utf-8 -*- from kivy.app import App from kivy.uix.screenmanager import Screen as Activity from kivy.properties import ObjectProperty from . NoteActivity import NoteActivity class ListNotesActivity(Activity): checkCurentPost = ObjectProperty() objApp = App.get_running_app() def clearList(self): if self.objApp.activityManager.current == 'list project activity': self.ids.layoutContainer.clear_widgets() def addNewNote(self, objApp): objApp.activityManager.current = 'add new note activity' def setDefaultcheckCurentPost(self): self.checkCurentPost = lambda x: None def setNotesProject(self, nameProject): self.ids.toolBar.title = nameProject for dataProject in self.objApp.dataProjects[nameProject][1]: self.ids.layoutContainer.add_widget(NoteActivity( textNote=dataProject['textNote'], nameDate=dataProject['nameDate'], pathToAvatar=dataProject['pathToAvatar'])) def deletePost(self, instance=None): #  . if not self.checkCurentPost: checkCurentPost = instance else: checkCurentPost = self.checkCurentPost self.ids.layoutContainer.remove_widget(self.checkCurentPost) nameProject = self.ids.toolBar.title self.objApp.deleteNoteFromBase(nameProject, checkCurentPost.textNote) def checkScroll(self): if self.checkCurentPost and type(self.checkCurentPost) is not NoteActivity: self.checkCurentPost(self)</span></span></code> </pre><br>  Comment gérer l'activité de l'application?  Pour passer d'une activité à une autre, nous devons indiquer au gestionnaire d'écran le nom de la nouvelle activité: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ListNotesActivity</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Activity)</span></span></span><span class="hljs-class">:</span></span> ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addNewNote</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, *args)</span></span></span><span class="hljs-function">:</span></span> self.objApp.activityManager.current = <span class="hljs-string"><span class="hljs-string">'add new note activity'</span></span></code> </pre><br>  ... où <i><b>'ajouter une nouvelle activité de note' est le</b></i> nom de l'activité pour ajouter une nouvelle note. <br><br>  Écran et présentation de l' <b>activité AddNewNoteActivity</b> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/6m/wc/pd/6mwcpd7f5dswgcy8vgcehomb7ci.png"></div><br>  Classe de base: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.app <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> App <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.animation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Animation <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.uix.screenmanager <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Screen <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Activity <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> kivy.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dp <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> libs.uix.baseclass.NoteActivity <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> NoteActivity <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddNewNoteActivity</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Activity)</span></span></span><span class="hljs-class">:</span></span> objApp = <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> edit = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> oldTextNote = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">animationButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.objApp = App.get_running_app() self.ids.toolBar.title = self.objApp.listNotesActivity.ids.toolBar.title Animation(size=(dp(<span class="hljs-number"><span class="hljs-number">56</span></span>), dp(<span class="hljs-number"><span class="hljs-number">56</span></span>)), d=<span class="hljs-number"><span class="hljs-number">.5</span></span>, t=<span class="hljs-string"><span class="hljs-string">'in_out_cubic'</span></span>).start(self.ids.floatingButton) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addNewNotes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, textNote)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.edit: nameProject = self.ids.toolBar.title self.objApp.addEditNoteInBase(nameProject, textNote, self.oldTextNote) self.objApp.activityManager.backActivity(<span class="hljs-string"><span class="hljs-string">'list notes activity'</span></span>, self.ids.floatingButton) self.objApp.listNotesActivity.checkCurentPost.textNote = textNote self.edit = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.objApp.listNotesActivity.ids.layoutContainer.add_widget( NoteActivity( textNote=textNote, nameDate=<span class="hljs-string"><span class="hljs-string">'%s\n%s'</span></span> % ( self.objApp.nameAuthor, self.objApp.getDate()), pathToAvatar=<span class="hljs-string"><span class="hljs-string">'data/images/avatar.png'</span></span>)) self.objApp.addNoteInBase(self.ids.toolBar.title, textNote, <span class="hljs-string"><span class="hljs-string">'data/images/avatar.png'</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">editNote</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, interval)</span></span></span><span class="hljs-function">:</span></span> self.edit = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> self.ids.textInput.text = self.objApp.listNotesActivity.checkCurentPost.textNote self.oldTextNote = self.ids.textInput.text</code> </pre><br>  Pour animer le bouton, j'ai utilisé l'événement <b>on_enter</b> , qui est <b>déclenché</b> lorsque l'activité est installée à l'écran: <br><br>  Dans le balisage: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AddNewNoteActivity</span></span></span><span class="hljs-tag">&gt;</span></span> on_enter: root.animationButton()</code> </pre><br>  En code Python: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddNewNoteActivity</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Activity)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">animationButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> Animation(size=(dp(<span class="hljs-number"><span class="hljs-number">56</span></span>), dp(<span class="hljs-number"><span class="hljs-number">56</span></span>)), d=<span class="hljs-number"><span class="hljs-number">.5</span></span>, t=<span class="hljs-string"><span class="hljs-string">'in_out_cubic'</span></span>).start(self.ids.floatingButton)</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/we/fj/lq/wefjlq6o_4ohxersgl96zebkxo4.gif"></div><br>  Contrairement à Xamarin.Forms, l'interface utilisateur de Kivy se ressemblera partout.  Donc, si vous écrivez une application pour deux plates-formes (Android et iOS), vous devez en tenir compte lorsque vous balisez l'interface et spécifiez les propriétés des widgets.  Ou faites deux annotations pour deux plates-formes (la logique reste inchangée).  C'est un plus, puisque le rendu et les événements de l'interface utilisateur sont indépendants des fonctionnalités de la plate-forme, vous n'utilisez pas d'API natives pour contrôler ces actions, ce qui permet à votre application d'être exécutée sans douleur sur presque toutes les plates-formes.  Tous les graphiques sont rendus à l'aide d'appels OpenGL et SDL2 natifs sur le GPU, ce qui vous permet de dessiner rapidement des menus, des boutons et d'autres charmes de l'interface graphique, y compris des graphiques 2D et 3D. <br><br>  Cette application utilise Android UI MaterialDesign.  Par exemple, mon dernier projet avait une interface adaptative: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rm/de/xt/rmdextdb8krmw5ylbk2o7zwailk.png" width="600" height="400"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ev/pv/3_/evpv3_f2ht9oqh3cs7m4htfqdiq.png" width="600" height="400"></div><br>  Voici une démonstration des possibilités dans le style de Material Design: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/https://translate" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  Comme je l'ai dit, Kivy n'utilise pas d'API natives pour le rendu de l'interface utilisateur, il vous permet donc d'émuler différents modèles d'appareils et de plates-formes à l'aide du module d' <b><i>écran</i></b> .  Il suffit d'exécuter votre projet avec les paramètres nécessaires pour que la fenêtre de l'application testée s'ouvre sur l'ordinateur comme si elle s'exécutait sur un appareil réel.  Cela semble étrange, mais puisque Kivy résume la plate-forme lors du rendu de l'interface utilisateur, cela élimine le besoin d'émulateurs lourds et lents pour les tests.  Cela ne s'applique qu'à l'interface utilisateur.  Par exemple, l'application de test décrite dans cet article a été testée avec les paramètres <b><i>-m screen: droid2, portrait, scale = .75</i></b> que one to one correspond à mon appareil réel. <br><br><div class="spoiler">  <b class="spoiler_title">Liste complète des paramètres du module d'écran:</b> <div class="spoiler_text"><pre> <code class="python hljs">devices = { <span class="hljs-comment"><span class="hljs-comment"># device: (name, width, height, dpi, density) 'onex': ('HTC One X', 1280, 720, 312, 2), 'one': ('HTC One', 1920, 1080, 468, 3), 'onesv': ('HTC One SV', 800, 480, 216, 1.5), 's3': ('Galaxy SIII', 1280, 720, 306, 2), 'note2': ('Galaxy Note II', 1280, 720, 267, 2), 'droid2': ('Motorola Droid 2', 854, 480, 240, 1.5), 'xoom': ('Motorola Xoom', 1280, 800, 149, 1), 'ipad': ('iPad (1 and 2)', 1024, 768, 132, 1), 'ipad3': ('iPad 3', 2048, 1536, 264, 2), 'iphone4': ('iPhone 4', 960, 640, 326, 2), 'iphone5': ('iPhone 5', 1136, 640, 326, 2), 'xperiae': ('Xperia E', 480, 320, 166, 1), 'nexus4': ('Nexus 4', 1280, 768, 320, 2), 'nexus7': ('Nexus 7 (2012 version)', 1280, 800, 216, 1.325), 'nexus7.2': ('Nexus 7 (2013 version)', 1920, 1200, 323, 2), # taken from design.google.com/devices # please consider using another data instead of # a dict for autocompletion to work # these are all in landscape 'phone_android_one': ('Android One', 854, 480, 218, 1.5), 'phone_htc_one_m8': ('HTC One M8', 1920, 1080, 432, 3.0), 'phone_htc_one_m9': ('HTC One M9', 1920, 1080, 432, 3.0), 'phone_iphone': ('iPhone', 480, 320, 168, 1.0), 'phone_iphone_4': ('iPhone 4', 960, 640, 320, 2.0), 'phone_iphone_5': ('iPhone 5', 1136, 640, 320, 2.0), 'phone_iphone_6': ('iPhone 6', 1334, 750, 326, 2.0), 'phone_iphone_6_plus': ('iPhone 6 Plus', 1920, 1080, 400, 3.0), 'phone_lg_g2': ('LG G2', 1920, 1080, 432, 3.0), 'phone_lg_g3': ('LG G3', 2560, 1440, 533, 3.0), 'phone_moto_g': ('Moto G', 1280, 720, 327, 2.0), 'phone_moto_x': ('Moto X', 1280, 720, 313, 2.0), 'phone_moto_x_2nd_gen': ('Moto X 2nd Gen', 1920, 1080, 432, 3.0), 'phone_nexus_4': ('Nexus 4', 1280, 768, 240, 2.0), 'phone_nexus_5': ('Nexus 5', 1920, 1080, 450, 3.0), 'phone_nexus_5x': ('Nexus 5X', 1920, 1080, 432, 2.6), 'phone_nexus_6': ('Nexus 6', 2560, 1440, 496, 3.5), 'phone_nexus_6p': ('Nexus 6P', 2560, 1440, 514, 3.5), 'phone_samsung_galaxy_note_4': ('Samsung Galaxy Note 4', 2560, 1440, 514, 3.0), 'phone_samsung_galaxy_s5': ('Samsung Galaxy S5', 1920, 1080, 372, 3.0), 'phone_samsung_galaxy_s6': ('Samsung Galaxy S6', 2560, 1440, 576, 4.0), 'phone_sony_xperia_c4': ('Sony Xperia C4', 1920, 1080, 400, 2.0), 'phone_sony_xperia_z_ultra': ('Sony Xperia Z Ultra', 1920, 1080, 348, 2.0), 'phone_sony_xperia_z1_compact': ('Sony Xperia Z1 Compact', 1280, 720, 342, 2.0), 'phone_sony_xperia_z2z3': ('Sony Xperia Z2/Z3', 1920, 1080, 432, 3.0), 'phone_sony_xperia_z3_compact': ('Sony Xperia Z3 Compact', 1280, 720, 313, 2.0), 'tablet_dell_venue_8': ('Dell Venue 8', 2560, 1600, 355, 2.0), 'tablet_ipad': ('iPad', 1024, 768, 132, 1.0), 'tablet_ipad_mini': ('iPad Mini', 1024, 768, 163, 1.0), 'tablet_ipad_mini_retina': ('iPad Mini Retina', 2048, 1536, 326, 2.0), 'tablet_ipad_pro': ('iPad Pro', 2732, 2048, 265, 2.0), 'tablet_ipad_retina': ('iPad Retina', 2048, 1536, 264, 2.0), 'tablet_nexus_10': ('Nexus 10', 2560, 1600, 297, 2.0), 'tablet_nexus_7_12': ('Nexus 7 12', 1280, 800, 216, 1.3), 'tablet_nexus_7_13': ('Nexus 7 13', 1920, 1200, 324, 2.0), 'tablet_nexus_9': ('Nexus 9', 2048, 1536, 288, 2.0), 'tablet_samsung_galaxy_tab_10': ('Samsung Galaxy Tab 10', 1280, 800, 148, 1.0), 'tablet_sony_xperia_z3_tablet': ('Sony Xperia Z3 Tablet', 1920, 1200, 282, 2.0), 'tablet_sony_xperia_z4_tablet': ('Sony Xperia Z4 Tablet', 2560, 1600, 297, 2.0)TodoList() app.run() }</span></span></code> </pre><br></div></div><br>  Que dire en conclusion?  Est-ce que Kivy est bon?  Sans aucun doute bien!  Si vous connaissez le merveilleux langage de programmation Python, vous pouvez facilement créer des applications pour des plates-formes mobiles (et pas seulement) avec le cadre non moins merveilleux de Kivy. <br><br>  <b>Avantages du développement d'applications à l'aide du framework Kivy:</b> <br><br><ul><li>  Puisque nous avons affaire à Python, la vitesse de développement des applications est plusieurs fois plus rapide que la vitesse de développement dans tout autre langage ou framework de programmation. </li><li>  Mégatonnes de bibliothèques Python prêtes à l'emploi que vous pouvez utiliser dans vos projets: <b>OpenCV, Django, Flask, NumPy, ffmpeg, sqlite3, lxml</b> et des milliers d'autres. </li><li>  Étant donné que Kivy utilise OpenGL et GPU pour le rendu des graphiques, ainsi que ses propres widgets et contrôles, la vitesse de rendu de l'interface utilisateur est très élevée et vous êtes complètement soulagé du mal de tête, qui est présent dans d'autres cadres qui doivent entrer dans la partie native pour implémenter certaines parties de l'interface. </li><li>  Vous n'utilisez le natif que là où vous avez besoin d'accéder à des fonctionnalités de plate-forme spécifiques qui ne peuvent tout simplement pas exister dans un cadre véritablement multiplateforme: par exemple, accès à la géolocalisation, accès à la caméra, technologie BlueTooth ... <br><br>  Implémenter l'accès à l'API Android native pour obtenir IMEI et le modèle d'appareil à l'aide de PyJnius: </li></ul><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_get_model_android</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnius <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> autoclass Build = autoclass(<span class="hljs-string"><span class="hljs-string">'android.os.Build'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str(Build.DEVICE) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_get_imei_android</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> jnius <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> autoclass Service = autoclass(<span class="hljs-string"><span class="hljs-string">'org.renpy.android.PythonActivity'</span></span>).mActivity Context = autoclass(<span class="hljs-string"><span class="hljs-string">'android.content.Context'</span></span>) TelephonyManager = Service.getSystemService(Context.TELEPHONY_SERVICE) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str(TelephonyManager.getDeviceId())</code> </pre><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fw/bi/pm/fwbipmzqlt4iebzxbaap4f_-e0y.gif"></div><br>  Par exemple, une implémentation de périphériques IMEI de réception natifs en Java: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.telephony.TelephonyManager; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GetImeiAndroid</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getImeiAndroid</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ TelephonyManager tm = (TelephonyManager)getSystemService(Context.TELEPHONY_SERVICE); String IMEINumber = tm.getDeviceId(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> IMEINumber; } }</code> </pre><br><ul><li>  Vous pouvez utiliser des bibliothèques de pots tiers dans vos projets en ce qui concerne Android. </li><li>  Vous êtes entièrement propriétaire de tous les événements survenant à l'écran: tactile, multitouch, swipe, punching et autres événements sans passer par le natif, c'est donc une partie intégrante de Kivy. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Fonctionnalités de Kivy dans les appareils tactiles:</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://player.vimeo.com/video/45240986" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://player.vimeo.com/video/40730046" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://player.vimeo.com/video/25680681" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><iframe width="560" height="315" src="https://www.youtube.com/embed/u4NRu7mBXtA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  <b>Malgré tous les avantages, Kivy présente plusieurs inconvénients:</b> <br><br><ul><li>  La vitesse du "démarrage à froid", c'est-à-dire le premier lancement de l'application à partir du moment où toutes les bibliothèques sont déployées, est assez longue.  Les suivants sont ordinaires, mais plus longs que le natif, en fonction de la charge du processeur de l'appareil mobile. </li><li>  Travaillez avec des listes.  Vous pouvez afficher une liste d'une taille de 100 000 éléments en une demi-seconde (par exemple, cartes utilisateur, vitrine, devis), mais à une condition: toutes les cartes doivent avoir la même hauteur.  Si vous affichez une liste de citations, par exemple, avec une quantité de texte inconnue à l'avance, mais dans leur intégralité, alors à la fois plus de dix points ne peuvent pas être affichés, car cela prendra environ 10-15 secondes.  Dans ce cas, vous devrez charger 10 à 15 éléments chacun en faisant défiler la liste. </li><li>  Il est impossible d'afficher du texte qui dépasse 6500 caractères (3,5 pages de texte imprimé) - nous obtenons un écran noir.  Ceci est résolu en cassant le texte puis en le collant ensemble, ce qui semble toujours être une béquille.  Cependant, il n'est pas clair à qui il viendrait à l'esprit de produire une telle quantité de texte à la fois.  Surtout quand il s'agit de plateformes mobiles. </li></ul><br>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Plus d'articles sur Kivy</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Une machine virtuelle</a> (le premier article de ZenCODE) des développeurs Kivy est prête et configurée pour créer des projets pour les deux branches Python. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr420691/">https://habr.com/ru/post/fr420691/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr420679/index.html">Nouveaux cours Python de Mail.Ru Group</a></li>
<li><a href="../fr420681/index.html">AMD ThreadRipper 2: première introduction</a></li>
<li><a href="../fr420685/index.html">Fixer et neutraliser: comment nous avons apprivoisé l'argent. Un mot sur les bactéricides pour l'eau</a></li>
<li><a href="../fr420687/index.html">Utilisation de VS Code pour appeler l'API REST dans Azure IoT Hub [+ documents utiles]</a></li>
<li><a href="../fr420689/index.html">Game designer à partir de zéro: comment commencer à créer des jeux sans expérience</a></li>
<li><a href="../fr420693/index.html">Le cours de développement Java du groupe Mail.Ru sur le canal Technostream</a></li>
<li><a href="../fr420695/index.html">Ray: un système distribué pour utiliser l'IA</a></li>
<li><a href="../fr420697/index.html">Le thème éternel avec PHP et MySQL</a></li>
<li><a href="../fr420701/index.html">HSBI invite à une soirée conférence sur la conception de jeux le 29 août</a></li>
<li><a href="../fr420703/index.html">Synopsis du livre «Négociations sans défaite. Méthode Harvard</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>