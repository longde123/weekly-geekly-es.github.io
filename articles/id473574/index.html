<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üöÑ ‚ô£Ô∏è üë®üèæ‚Äçü§ù‚Äçüë®üèΩ Aplikasi pada TSD dan komunikasi dengan 1C: Enterprise 8.3 melalui HTTP-Service. Bagian 3 (BroadcastReceiver Mendapatkan Barcode) ü§• üëØ üéñÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Pilihan metode pertukaran. Deskripsi API. 

 2. Implementasi API di sisi 1C. 

 3. BroadcastReceiver. Kami menerima data barcode pada contoh ATOL S...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Aplikasi pada TSD dan komunikasi dengan 1C: Enterprise 8.3 melalui HTTP-Service. Bagian 3 (BroadcastReceiver Mendapatkan Barcode)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/473574/">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">1. Pilihan metode pertukaran.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Deskripsi API.</a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">2. Implementasi API di sisi 1C.</a> <br><br><h3>  3. BroadcastReceiver.  Kami menerima data barcode pada contoh ATOL Smart.Lite </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">4. OnKeyUp.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Dapatkan kode batang dari pemindai dengan emulasi keyboard</a> <br><br>  Pada bagian ini, saya ingin fokus pada detail.  Dalam semua tutorial yang saya temui, fungsi-fungsinya dijelaskan dan kira-kira di mana menambahkannya. <br><br><a name="habracut"></a><br>  Mari kita menulis aplikasi kita yang mendengarkan pesan siaran dan menampilkannya di jendela sembulan.  Buat proyek dengan <code>Empty Activity</code> . <br><br>  <code>Package name</code> tentukan " <code>com.domain.barcodeTest</code> " Sekelompok buku teks.  Sekarang dalam proyek kita akan membuat <code>package</code> .  Bagi saya sendiri, saya menyebutnya utils, karena  Saya tidak tahu ke mana lagi harus membawanya.  Itu tidak bekerja dengan jaringan, dengan database juga.  Itu tidak terlihat seperti model. <br>  Karenanya, seperti ini. <br><br><img src="https://habrastorage.org/webt/sl/y4/xj/sly4xj08s3xba3nlmfhwhhrtlrm.png" alt="gambar"><br><br>  Gambar menyoroti di mana membuat paket.  Di dalam <code>utils</code> buat kelas <code>(Kotlin File/Class</code> ).  Kami memilih bahwa itu adalah kelas, dan kami menyebutnya <code>CustomBroadcastReceiver</code> .  Kode file lengkap: <br><br><div class="spoiler">  <b class="spoiler_title">CustomBroadcastReceiver.kt</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.domain.barcodeTest.utils <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.BroadcastReceiver <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Intent <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CustomBroadcastReceiver</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">BroadcastReceiver</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReceive</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(context: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Context</span></span></span></span><span class="hljs-function"><span class="hljs-params">, intent: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Intent</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">//          val type = intent.getStringExtra("EXTRA_BARCODE_DECODING_SYMBOLE") val barcode = intent.getStringExtra("EXTRA_BARCODE_DECODING_DATA") //  .      . val sb = StringBuilder() sb.append("Type: $type, Barcode:$barcode\n") //    .    . Toast.makeText(context, sb.toString(), Toast.LENGTH_SHORT).show() // "data class",         . //      ,    . val bc = Barcode(type, barcode) } } }</span></span></code> </pre> <br></div></div><br>  Kami menciptakan kelas kami untuk menerima pesan siaran, mewarisi segalanya dari BroadcastReceiver.  Di dalamnya, kami mendefinisikan kembali perilaku fungsi untuk menerima pesan ( <code>onReceive</code> ).  Di tingkat atas " <code>com.domain.barcodeTest</code> " kita akan membuat satu lagi <code>models</code> paket, dan di dalamnya kita akan membuat kelas " <code>Barcode</code> ".  Kode file lengkap: <br><br><div class="spoiler">  <b class="spoiler_title">barcode.kt</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> org.innova_it.mws.models <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Barcode</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> type: String?, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> value: String? )</code> </pre> <br></div></div><br>  Jadi, kami membuat kelas Barcode dan membuat konstruktor untuknya.  Semua sama, Kotlin baik.  Sekarang kita dapat dengan bebas menggunakannya di kelas <code>CustomBroadcastReceiver</code> , kesalahan seharusnya hilang.  Sebagai hasilnya, kami memiliki struktur berikut. <br><br><img src="https://habrastorage.org/webt/4q/vl/-1/4qvl-1qxapsfcdf0sjkepwauyqu.png" alt="gambar"><br><br>  Dalam paket kami menyimpan objek serupa.  Jika diterjemahkan ke dalam 1C, maka dalam paket model kami menyimpan deskripsi data 1C.  Direktori, dokumen dengan detail dan objek bawahan.  Kami juga menyimpan deskripsi tabel database dan format untuk menerima data melalui jaringan.  Ke depan.  Berikut adalah contoh khas model dari bagian sebelumnya untuk Nomenklatur.  Itu tidak berlaku untuk proyek kami saat ini.  Tetapi lebih mudah dipahami dengan sebuah contoh. <br><br><div class="spoiler">  <b class="spoiler_title">models / wares.kt</b> <div class="spoiler_text"><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">data</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PayLoadWares</span></span></span></span>( <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> quantity: <span class="hljs-built_in"><span class="hljs-built_in">Int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> wares: List&lt;Ware&gt; ) <span class="hljs-comment"><span class="hljs-comment">//      sqlLite(Room) //@SerializedName -  Retrofit      json @Entity(tableName = "wares_table") data class Ware( @PrimaryKey @NonNull @SerializedName("code") @Expose val code: String, @SerializedName("article") @Expose val article: String, @NonNull @SerializedName("name") @Expose val name: String, @SerializedName("fullName") @Expose val fullName: String, @NonNull @SerializedName("unit") @Expose val unit: String ) data class WareResponse( val result : Result, val payload: PayLoadWares )</span></span></code> </pre> <br></div></div><br>  Jika kita membayangkan proyek sebagai struktur 1C, maka setiap paket akan berisi kelas: WaresModel (Model direktori barang, WaresManager (Manajer direktori barang), WaresObject (Objek direktori), WaresUI (Modul formulir), WaresActivity (Formulir). tidak seperti 1C, kita dapat menggambarkan properti umum, metode untuk semua direktori dalam model, dan kemudian mewarisi darinya. Pada 1C, platform melakukan ini dan kita tidak perlu memikirkannya. <br>  Bagaimana cara menggambarkan antarmuka dalam 1C, saya bahkan tidak tahu.  Ini harus diajarkan sebelum pencerahan penuh.  Lebih jauh tanpa ini tidak mungkin. <br><br>  Mari kita kembali ke aplikasi kita.  Hal berikutnya yang perlu kita lakukan adalah menandatangani aplikasi untuk acara yang kita butuhkan.  Kami akan menandatanganinya secara dinamis, tanpa menggunakan <code>AndroidManifest.xml</code> . <br><br>  Untuk melakukan ini, kita perlu menambahkan variabel dan mengganti dua prosedur di <code>MainActivity</code> . <br><br>  Tambahkan variabel <br><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">AppCompatActivity</span></span></span></span>() { <span class="hljs-comment"><span class="hljs-comment">//   MainActivity   .      "CustomBroadcastReceiver",    "BroadcastReceiver" private val customBroadcastReceiver = CustomBroadcastReceiver() ...</span></span></code> </pre> <br>  Berlangganan acara.  Mendefinisikan kembali perilaku dua metode di <code>MainActivity</code> <br><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onResume</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onResume() registerReceiver( customBroadcastReceiver, IntentFilter (<span class="hljs-string"><span class="hljs-string">"com.xcheng.scanner.action.BARCODE_DECODING_BROADCAST"</span></span>) ) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onStop() unregisterReceiver(customBroadcastReceiver) }</code> </pre><br>  Saya pikir semuanya cukup transparan di sini.  Kami menandatangani aplikasi untuk menerima pesan dengan filter. Dalam bahasa 1C Saat pesan <code>(onReceive)</code> , di mana Sumbernya adalah <code>"com.xcheng.scanner.action.BARCODE_DECODING_BROADCAST"</code> .  Ini adalah bagaimana utilitas internal untuk bekerja dengan pemindai pada ATOL Smart.Lite menyebut dirinya.  Dan data yang kami miliki adalah <br><br><ul><li>  <code>"EXTRA_BARCODE_DECODING_SYMBOLE"</code> - tipe <code>"EXTRA_BARCODE_DECODING_SYMBOLE"</code> </li><li>  <code>"EXTRA_BARCODE_DECODING_DATA"</code> - Data itu sendiri </li></ul><br>  Dan sebenarnya pesan tersebut sedang diproses.  Kami mengkompilasi run.  Kami periksa.  Punya pertanyaan?  Tanyakan di komentar.  Itu saja.  Sekarang kami adalah pengembang untuk Android.  :) <br><br>  Bagian ini cocok untuk mendapatkan hasil yang diinginkan.  Tetapi setelah itu, Anda harus pergi dan mempelajari dasar-dasar java.  Dan hanya itulah dasar-dasar kotlin. <br><br>  PS Di sini saya ingin menghubungi pengembang Android.  Saya memiliki situasi yang aneh.  Saya dulu menandatangani aplikasi di OnCreate (), dan berhenti berlangganan di onStop ().  Tetapi setelah aplikasi pergi ke onPause (), dan ketika melanjutkan onResume (), aplikasi macet ketika menerima pesan dengan kesalahan.  Apa yang bisa menyebabkan perilaku ini? </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id473574/">https://habr.com/ru/post/id473574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id473562/index.html">Preferensi terenkripsi di Android</a></li>
<li><a href="../id473564/index.html">Ada kemampuan, tetapi tidak ada alasan: tugas yang AI tidak bisa atasi</a></li>
<li><a href="../id473568/index.html">Layanan lapangan, aplikasi pada peta, geolokasi. Pilihan layanan kartografi. Tampilan sisi produk</a></li>
<li><a href="../id473570/index.html">Cari 314 km¬≤ dalam 10 jam - pertempuran terakhir para insinyur pencarian melawan hutan</a></li>
<li><a href="../id473572/index.html">"Zakroma Rodina" akan diceritakan: Jerman akan menentukan cadangan strategis dengan metode baru</a></li>
<li><a href="../id473576/index.html">Infrastruktur Eksperimen Pengembang</a></li>
<li><a href="../id473578/index.html">Membangun Modul Dinamis untuk Nginx</a></li>
<li><a href="../id473584/index.html">Penyaringan konten di sekolah berdasarkan Ubuntu 18.04 dan Squid transparan, dengan integrasi ke dalam jaringan di MikroTik dan tidak hanya</a></li>
<li><a href="../id473586/index.html">FortiConverter atau bergerak tanpa repot</a></li>
<li><a href="../id473588/index.html">Kartu As intrusif: kinematika pendaratan "terbalik" dengan lalat biru</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>