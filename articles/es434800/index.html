<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë®‚Äçüíº üë©‚Äçüë©‚Äçüëß üë©‚Äç‚ù§Ô∏è‚Äçüë© (5-2) Formas de migrar una tabla SQL grande üçÑ üë©üèæ‚Äçüåæ üëáüèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduccion 
 Hola a todos! Este es mi primer art√≠culo y lo escribo en nombre de un ingeniero de desarrollo junior en C #. Por lo tanto, no habr√° inf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>(5-2) Formas de migrar una tabla SQL grande</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434800/"><h3>  Introduccion </h3><br>  Hola a todos!  Este es mi primer art√≠culo y lo escribo en nombre de un ingeniero de desarrollo junior en C #.  Por lo tanto, no habr√° informaci√≥n detallada sobre SQL, solo informaci√≥n pr√°ctica y pensamientos para resolver un problema bastante obvio que tuve que enfrentar para los mismos reci√©n llegados que yo. <br><br>  Primero, describir√© la formulaci√≥n de mi problema como un ejemplo, en el que existe una necesidad real de mover una mesa grande. <br><br>  Entonces, suponga que tiene un servicio web y una base de datos SQL (MS-SQL) con una tabla de letras html que su servicio env√≠a a los usuarios.  Las cartas se almacenan durante varios a√±os y no se pueden eliminar, ya que son necesarias para recopilar estad√≠sticas y an√°lisis.  Sin embargo, cada a√±o crece el n√∫mero de letras, la base de datos crece y el espacio en el servidor SQL se hace m√°s peque√±o (en nuestro caso, otro factor fue restaurar la base de datos al sitio de prueba, porque su tiempo aument√≥ proporcionalmente) y hay que hacer algo con esto. para hacer  Afortunadamente, en nuestro caso hay un servidor gratuito con un mont√≥n de espacio libre (en realidad, puede que no lo sea, y por supuesto, esta es una soluci√≥n temporal, pero est√° m√°s all√° del alcance del art√≠culo).  Entonces surgi√≥ el problema de mover una mesa grande (y decir "grande", me refiero a una mesa realmente grande, todo lo que vi mientras buscaba soluciones similares estaba en la regi√≥n de 60-100 GB, en nuestro caso la mesa pesaba m√°s de 300 GB). <br><br>  Consideraremos varias formas de resolver este problema, pero no todas estar√°n relacionadas con la transferencia del tipo servidor-servidor.  A veces puede ser necesario transferir una tabla entre bases de datos dentro del mismo servidor.  Adem√°s, algunos m√©todos son puramente te√≥ricos, no los prob√© todos en la pr√°ctica, pero probablemente deber√≠an funcionar. <br><a name="habracut"></a><br><h3>  M√©todo -1.  Datos </h3><br>  No importa cu√°n obvio suene, pero debe saber qu√© datos va a transferir.  Muy a menudo, los datos no se almacenan de la manera m√°s √≥ptima, y ‚Äã‚Äãtambi√©n se puede almacenar el exceso de informaci√≥n.  Es probable que, en su caso particular, pueda hacerlo sin transferir todos los datos. <br><br>  En primer lugar, eliminar una columna probablemente puede ayudarlo, pero esta es una operaci√≥n de bloqueo y no siempre es posible detener un servicio web.  Y en Habr√© hay un art√≠culo en el que se le dice c√≥mo se puede llevar a cabo. <br><br>  En segundo lugar, no te olvides de la normalizaci√≥n.  Quiz√°s se puedan transferir algunos datos al diccionario (en el caso de las letras, no fue posible almacenar los cuerpos de las letras, sino las plantillas con los datos que se insertaron all√≠), y solo la identificaci√≥n de estos elementos podr√≠a almacenarse en una tabla grande, esto podr√≠a liberarle mucho espacio. <br><br><h3>  M√©todo 0. SELECCIONAR EN </h3><br>  Broma =) Entonces solo puedes ponerte una base.  Sin embargo, si estamos hablando del tama√±o peque√±o de la tabla (entonces, ¬øqu√© est√° haciendo aqu√≠?), Puede intentar transferir la base de datos utilizando esta instrucci√≥n.  Adem√°s, si tiene una base de prueba, puede realizar un experimento para evaluar el tiempo total de transferencia utilizando este m√©todo "en la frente". <br><br><h3>  M√©todo 1. Copia de seguridad </h3><br>  La forma m√°s "can√≥nica", fue esto lo que se convirti√≥ en la soluci√≥n a mi problema.  Hacemos una copia de seguridad de la base de datos que contiene nuestra tabla, la restauramos en otro servidor y la borramos de todo lo innecesario.  Adem√°s, si es posible detener el servicio web, puede volver a implementarlo configurando el registro en la tabla transferida y eliminar el antiguo <b>* *</b> (aqu√≠ es muy probable que sea necesario escribir consultas con uniones, para este google c√≥mo vincular sql- servidores).  Si esto no es posible, arreglamos la identificaci√≥n de la √∫ltima letra (para la sincronizaci√≥n), luego necesitaremos eliminar <b>*</b> todas las letras transferidas (continuaremos escribiendo en la tabla anterior). <br><br>  <b>*</b> Al eliminar un tema separado para la conversaci√≥n, puede parecer que es mucho m√°s r√°pido que la transferencia, pero esto no es as√≠ y, en el caso general, aconsejo eliminarlo en porciones. <br><br><h3>  M√©todo 2: MS-SQL Management Studio </h3><br>  Si tiene este estudio, puede intentar usar la herramienta integrada para exportar e importar datos.  Personalmente, le√≠ en el desbordamiento de pila que esta cosa colgaba de una mesa de 60 conciertos y no corr√≠a ning√∫n riesgo. <br><br><h3>  M√©todo 3. Partici√≥n </h3><br>  M√©todo de frente mejorado.  La idea es transferir datos de la manera habitual con un temporizador entre iteraciones.  Divide todas las l√≠neas en porciones (por ejemplo, 100k cada una), transfiere la porci√≥n (y puede eliminarla de inmediato, pero no est√° seguro de qu√© tan segura es), luego se queda dormido y as√≠ hasta el final.  Es mejor transferir desde el final para que no tenga que sincronizar los datos al final.  Obviamente, el m√©todo es muy lento, pero de esta manera transferir√° todo sin detener el servicio web.  Lo m√°s probable es que sea m√°s conveniente implementarlo no con un script SQL, sino con la ayuda de algunos ORM. <br><br><h3>  Resumen </h3><br>  El proceso de transferir una gran cantidad de datos siempre lleva una cierta cantidad de tiempo, y usted debe estar preparado para esto.  No hay una forma m√°gica de resolver su problema al instante.  En cada caso, debe desarrollar sus vol√∫menes y limitaciones.  Si ninguno de los m√©todos funciona para usted, considere si puede usar alguna combinaci√≥n de ellos. <br><br>  Al final, me gustar√≠a agregar 2 puntos importantes. <br><br>  Cualquier proceso de transferencia / eliminaci√≥n de filas en SQL se registra en el registro de transacciones para poder revertir todo en caso de error (anteriormente supuse que esto se lleva a cabo solo en el marco de una transacci√≥n).  Adem√°s, el tama√±o del registro es incluso un poco m√°s que la cantidad de datos.  Aseg√∫rese de tener la cantidad de espacio necesaria o deshabilite el registro, pero esto no es seguro. <br><br>  Antes de transferir, debe asegurarse de que el archivo de datos y el archivo de registro tengan el tama√±o correcto, porque  las operaciones de expansi√≥n emplean una cantidad considerable de tiempo y las configuran en consecuencia para optimizar la migraci√≥n. <br>  Gracias a todos los que leen!  Estar√© encantado de cualquier cr√≠tica, comentario y aclaraci√≥n.  Comparta sus formas y t√©cnicas para trabajar con big data, como  A menudo, esta es una informaci√≥n muy importante y necesaria que no es tan f√°cil de encontrar. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es434800/">https://habr.com/ru/post/es434800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es434790/index.html">Tantos JDK ... ¬øCu√°l usar y qu√© amenaza?</a></li>
<li><a href="../es434792/index.html">Freelansim 2018: resultados del a√±o</a></li>
<li><a href="../es434794/index.html">Soft-skills de un probador exitoso</a></li>
<li><a href="../es434796/index.html">Codificando el arte: c√≥mo generamos gr√°ficos y animaci√≥n en proyectos de dise√±o</a></li>
<li><a href="../es434798/index.html">Swagger: documentaci√≥n inteligente para su API web RESTful: revisi√≥n del desarrollador back-end junior para novatos</a></li>
<li><a href="../es434802/index.html">"No dar√© una piedra" o c√≥mo se organizan los recursos del juego "Tierras malditas"</a></li>
<li><a href="../es434804/index.html">Fintech-startup Robinhood no pudo lanzar un an√°logo de cuentas bancarias</a></li>
<li><a href="../es434806/index.html">A√±o nuevo desmontaje con canoa</a></li>
<li><a href="../es434810/index.html">Iniciador para trabajar con Spring Cloud</a></li>
<li><a href="../es434812/index.html">Gesti√≥n del tiempo del proyecto</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>