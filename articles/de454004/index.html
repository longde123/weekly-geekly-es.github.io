<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úåÔ∏è üó®Ô∏è üë©üèª‚Äçüíª VMware NSX f√ºr die Kleinsten. Teil 6. VPN-Einrichtung üó£Ô∏è üßïüèø üë¶üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Teil Eins Einf√ºhrung 
 Teil Zwei Konfigurieren Sie Firewall- und NAT-Regeln 
 Teil drei. DHCP-Setup 
 Teil vier Routing-Setup 
 F√ºnfter Teil Konfiguri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>VMware NSX f√ºr die Kleinsten. Teil 6. VPN-Einrichtung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dataline/blog/454004/"><img src="https://habrastorage.org/webt/wq/yu/qy/wqyuqynprr8iaabtcn7nhbkqkje.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil Eins</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Einf√ºhrung</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil Zwei</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Konfigurieren Sie Firewall- und NAT-Regeln</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil drei.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">DHCP-Setup</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil vier</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Routing-Setup</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">F√ºnfter Teil</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Konfigurieren eines Load Balancers</a> <br><br>  Heute schauen wir uns die VPN-Konfigurationsoptionen an, die uns NSX Edge bietet. <br><br>  Im Allgemeinen k√∂nnen wir VPN-Technologien in zwei Schl√ºsseltypen unterteilen: <br><br><ul><li>  <b>Site-to-Site-VPN.</b>  Am h√§ufigsten wird IPSec verwendet, um einen sicheren Tunnel zu erstellen, z. B. zwischen dem Hauptb√ºro-Netzwerk und dem Netzwerk an einem Remotestandort oder in der Cloud. <br></li><li>  <b>RAS-VPN.</b>  Es wird verwendet, um einzelne Benutzer mithilfe einer VPN-Client-Software mit privaten Netzwerken von Organisationen zu verbinden. </li></ul><br>  Mit NSX Edge k√∂nnen wir beide Optionen verwenden. <br>  Wir werden mithilfe eines Pr√ºfstands mit zwei NSX Edge, einem Linux-Server mit installiertem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Racoon-</a> Daemon und einem Windows-Laptop zum Testen des RAS-VPN konfigurieren. <a name="habracut"></a><br><br><h3>  IPsec </h3><br><ol><li>  Wechseln Sie in der vCloud Director-Oberfl√§che zum Abschnitt Administration und w√§hlen Sie vDC aus.  W√§hlen Sie auf der Registerkarte Edge-Gateways den gew√ºnschten Edge aus, klicken Sie mit der rechten Maustaste und w√§hlen Sie Edge-Gateway-Dienste aus. <br><img src="https://habrastorage.org/webt/gx/g_/7s/gxg_7s4odqm4vy8lgxitl79ahtu.png"></li><li>  Wechseln Sie in der NSX Edge-Oberfl√§che zur Registerkarte VPN-IPsec-VPN, dann zum Abschnitt IPsec-VPN-Sites und klicken Sie auf +, um eine neue Site hinzuzuf√ºgen. <br><br><img src="https://habrastorage.org/webt/9w/kw/yz/9wkwyzxy6fwv6mm6tiw30juuemc.png"></li><li>  F√ºllen Sie die erforderlichen Felder aus: <br><ul><li>  Aktiviert - Aktiviert den Remote-Standort. </li><li>  <b>PFS</b> - stellt sicher, dass nicht jeder neue kryptografische Schl√ºssel einem vorherigen Schl√ºssel zugeordnet ist. </li><li>  <b>Lokale ID und lokaler Endpunkt</b> sind die externe Adresse des NSX Edge. </li><li>  <b>Lokale Subnetze</b> - Lokale Netzwerke, die IPSec-VPN verwenden. </li><li>  <b>Peer ID und Peer Endpoint</b> - Adresse des Remote-Standorts. </li><li>  <b>Peer-Subnetze</b> - Netzwerke, die IPsec-VPN auf der Remote-Seite verwenden. </li><li>  <b>Verschl√ºsselungsalgorithmus</b> - Tunnelverschl√ºsselungsalgorithmus. </li></ul><br><img src="https://habrastorage.org/webt/fr/2h/af/fr2haf6yil98f0e9p2tpjpsdlu8.png"><br><br><ul><li>  <b>Authentifizierung</b> - wie wir ein Fest authentifizieren.  Sie k√∂nnen den Pre-Shared Key oder ein Zertifikat verwenden. </li><li>  <b>Pre-Shared Key</b> - Geben Sie den Schl√ºssel an, der f√ºr die Authentifizierung verwendet wird und auf beiden Seiten √ºbereinstimmen muss. </li><li>  <b>Diffie-Hellman Group</b> - Schl√ºsselaustauschalgorithmus. </li></ul><br>  Klicken Sie nach dem Ausf√ºllen der erforderlichen Felder auf Behalten. <br><br><img src="https://habrastorage.org/webt/k9/yd/nk/k9ydnkf0ncd8dqajktdkux1wc58.png"></li><li>  Fertig. <br><br><img src="https://habrastorage.org/webt/z9/ij/ot/z9ijot3wthx7dklptivvra-8pws.png"></li><li>  Wechseln Sie nach dem Hinzuf√ºgen der Site zur Registerkarte Aktivierungsstatus und aktivieren Sie den IPSec-Dienst. <br><br><img src="https://habrastorage.org/webt/p9/oc/la/p9oclawmegzrekhuxslid1cvnzu.png"></li><li>  Wechseln Sie nach dem Anwenden der Einstellungen zur Registerkarte Statistik -&gt; IPSec-VPN und √ºberpr√ºfen Sie den Status des Tunnels.  Wir sehen, dass der Tunnel gestiegen ist. <br><br><img src="https://habrastorage.org/webt/fn/ai/fm/fnaifmaxtxbfs-sumd9t5xyfhn0.png"></li><li>  √úberpr√ºfen Sie den Tunnelstatus √ºber die Edge-Gateway-Konsole: <br><ul><li>  show service ipsec - √úberpr√ºfen Sie den Servicestatus. <br><br><img src="https://habrastorage.org/webt/tu/sv/_y/tusv_yq3-jzm_bavjx_fefpv_d0.png"></li><li>  show service ipsec site - Informationen √ºber den Status der Site und die vereinbarten Parameter. <br><br><img src="https://habrastorage.org/webt/ct/ex/j0/ctexj0sypvimdsgyaogvob0rx1w.png"></li><li>  show service ipsec sa - Statuspr√ºfung der Security Association (SA). <br><br><img src="https://habrastorage.org/webt/m2/of/ng/m2ofnggyimplhfnlvfvnec_yawa.png"></li></ul></li><li>  Remote Site Connectivity Check: <br><br><pre><code class="plaintext hljs">root@racoon:~# ifconfig eth0:1 | grep inet inet 10.255.255.1 netmask 255.255.255.0 broadcast 0.0.0.0 root@racoon:~# ping -c1 -I 10.255.255.1 192.168.0.10 PING 192.168.0.10 (192.168.0.10) from 10.255.255.1 : 56(84) bytes of data. 64 bytes from 192.168.0.10: icmp_seq=1 ttl=63 time=59.9 ms --- 192.168.0.10 ping statistics --- 1 packets transmitted, 1 received, 0% packet loss, time 0ms rtt min/avg/max/mdev = 59.941/59.941/59.941/0.000 ms</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Konfigurationsdateien und zus√§tzliche Diagnosebefehle vom Remote-Linux-Server:</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">root@racoon:~# cat /etc/racoon/racoon.conf log debug; path pre_shared_key "/etc/racoon/psk.txt"; path certificate "/etc/racoon/certs"; listen { isakmp 80.211.43.73 [500]; strict_address; } remote 185.148.83.16 { exchange_mode main,aggressive; proposal { encryption_algorithm aes256; hash_algorithm sha1; authentication_method pre_shared_key; dh_group modp1536; } generate_policy on; } sainfo address 10.255.255.0/24 any address 192.168.0.0/24 any { encryption_algorithm aes256; authentication_algorithm hmac_sha1; compression_algorithm deflate; } === root@racoon:~# cat /etc/racoon/psk.txt 185.148.83.16 testkey === root@racoon:~# cat /etc/ipsec-tools.conf #!/usr/sbin/setkey -f flush; spdflush; spdadd 192.168.0.0/24 10.255.255.0/24 any -P in ipsec esp/tunnel/185.148.83.16-80.211.43.73/require; spdadd 10.255.255.0/24 192.168.0.0/24 any -P out ipsec esp/tunnel/80.211.43.73-185.148.83.16/require; === root@racoon:~# racoonctl show-sa isakmp Destination Cookies Created 185.148.83.16.500 2088977aceb1b512:a4c470cb8f9d57e9 2019-05-22 13:46:13 === root@racoon:~# racoonctl show-sa esp 80.211.43.73 185.148.83.16 esp mode=tunnel spi=1646662778(0x6226147a) reqid=0(0x00000000) E: aes-cbc 00064df4 454d14bc 9444b428 00e2296e c7bb1e03 06937597 1e522ce0 641e704d A: hmac-sha1 aa9e7cd7 51653621 67b3b2e9 64818de5 df848792 seq=0x00000000 replay=4 flags=0x00000000 state=mature created: May 22 13:46:13 2019 current: May 22 14:07:43 2019 diff: 1290(s) hard: 3600(s) soft: 2880(s) last: May 22 13:46:13 2019 hard: 0(s) soft: 0(s) current: 72240(bytes) hard: 0(bytes) soft: 0(bytes) allocated: 860 hard: 0 soft: 0 sadb_seq=1 pid=7739 refcnt=0 185.148.83.16 80.211.43.73 esp mode=tunnel spi=88535449(0x0546f199) reqid=0(0x00000000) E: aes-cbc c812505a 9c30515e 9edc8c4a b3393125 ade4c320 9bde04f0 94e7ba9d 28e61044 A: hmac-sha1 cd9d6f6e 06dbcd6d da4d14f8 6d1a6239 38589878 seq=0x00000000 replay=4 flags=0x00000000 state=mature created: May 22 13:46:13 2019 current: May 22 14:07:43 2019 diff: 1290(s) hard: 3600(s) soft: 2880(s) last: May 22 13:46:13 2019 hard: 0(s) soft: 0(s) current: 72240(bytes) hard: 0(bytes) soft: 0(bytes) allocated: 860 hard: 0 soft: 0 sadb_seq=0 pid=7739 refcnt=0</code> </pre> <br></div></div></li><li>  Alles ist fertig, das IPSec-VPN von Standort zu Standort ist konfiguriert und funktioniert. <br><br>  In diesem Beispiel haben wir das PSK zur Authentifizierung des Peers verwendet, es ist jedoch auch eine Zertifikatauthentifizierungsoption m√∂glich.  Wechseln Sie dazu zur Registerkarte Globale Konfiguration, aktivieren Sie die Zertifikatauthentifizierung und w√§hlen Sie das Zertifikat selbst aus. <br><br>  Dar√ºber hinaus muss in den Site-Einstellungen die Authentifizierungsmethode ge√§ndert werden. <br><br><img src="https://habrastorage.org/webt/gv/x0/e8/gvx0e80ogisdslhrxbvcwci54gq.png"><br><br><img src="https://habrastorage.org/webt/uj/uf/xh/ujufxh2n4da4fcfb1hsrnlppv3w.png"><br><br>  Ich stelle fest, dass die Anzahl der IPSec-Tunnel von der Gr√∂√üe des bereitgestellten Edge-Gateways abh√§ngt (lesen Sie dazu in unserem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ersten Artikel</a> ). <br><br><img src="https://habrastorage.org/webt/bf/sq/rv/bfsqrvatekltpr2xy1wx4b35t-q.png"></li></ol><br><h3>  SSL VPN </h3><br>  SSL VPN-Plus ist eine der Optionen f√ºr RAS-VPN.  Es erm√∂glicht einzelnen Remotebenutzern, eine sichere Verbindung zu privaten Netzwerken hinter dem NSX Edge-Gateway herzustellen.  Zwischen dem Client (Windows, Linux, Mac) und NSX Edge wird ein mit SSL VPN plus verschl√ºsselter Tunnel eingerichtet. <br><br><ol><li>  Lass uns einrichten.  Wechseln Sie in der Systemsteuerung des Edge-Gateway-Dienstes zur Registerkarte SSL VPN-Plus und dann zu Servereinstellungen.  Wir w√§hlen die Adresse und den Port aus, an dem der Server auf eingehende Verbindungen wartet, aktivieren die Protokollierung und w√§hlen die erforderlichen Verschl√ºsselungsalgorithmen aus. <br><br><img src="https://habrastorage.org/webt/o4/nt/hq/o4nthq3cjj_sh1pwpz-5bm0q1oo.png"><br><br>  Hier k√∂nnen Sie das Zertifikat √§ndern, das der Server verwenden wird. <br><br><img src="https://habrastorage.org/webt/ij/ep/eg/ijepegloixlveu3aa9juqhuegzg.png"></li><li>  Wenn alles fertig ist, schalten Sie den Server ein und vergessen Sie nicht, die Einstellungen zu speichern. <br><br><img src="https://habrastorage.org/webt/ml/dz/pj/mldzpjn23fhhyljhr7zlre9tdcm.png"></li><li>  Als N√§chstes m√ºssen wir den Adresspool konfigurieren, den wir an Clients ausgeben, wenn eine Verbindung besteht.  Dieses Netzwerk ist von allen vorhandenen Subnetzen in Ihrer NSX-Umgebung getrennt. Es muss nicht auf anderen Ger√§ten in physischen Netzwerken konfiguriert werden, mit Ausnahme der Routen, die darauf verweisen. <br><br>  Gehen Sie zur Registerkarte IP-Pools und klicken Sie auf +. <br><br><img src="https://habrastorage.org/webt/vb/yx/4x/vbyx4xh7xvbp4aacm0_dsrx4lau.png"></li><li>  W√§hlen Sie Adressen, Subnetzmaske und Gateway.  Hier k√∂nnen Sie die Einstellungen f√ºr DNS- und WINS-Server √§ndern. <br><br><img src="https://habrastorage.org/webt/fy/s4/un/fys4unlo2c_-ees8uduwgw--_oa.png"></li><li>  Der resultierende Pool. <br><br><img src="https://habrastorage.org/webt/2n/7_/lr/2n7_lrsb5jjtgi9o8vgbkrijck4.png"></li><li>  F√ºgen Sie nun die Netzwerke hinzu, auf die Benutzer, die eine Verbindung zum VPN herstellen, Zugriff haben.  Gehen Sie zur Registerkarte Private Netzwerke und klicken Sie auf +. <br><br><img src="https://habrastorage.org/webt/cp/xj/c5/cpxjc55glum1i7qbultrqxeelwq.png"></li><li>  Wir f√ºllen aus: <br><br><ul><li>  Netzwerk - Ein lokales Netzwerk, auf das Remotebenutzer Zugriff haben. </li><li>  Senden Sie Verkehr, es gibt zwei M√∂glichkeiten: <br>  - √ºber Tunnel - Datenverkehr √ºber den Tunnel an das Netzwerk senden, <br>  - Tunnel umgehen - Datenverkehr direkt unter Umgehung des Tunnels an das Netzwerk senden. </li><li>  TCP-Optimierung aktivieren - Markieren Sie diese Option, wenn die Option √úber Tunnel ausgew√§hlt ist.  Wenn die Optimierung aktiviert ist, k√∂nnen Sie die Portnummern angeben, f√ºr die Sie den Datenverkehr optimieren m√∂chten.  Der Datenverkehr f√ºr die verbleibenden Ports dieses bestimmten Netzwerks wird nicht optimiert.  Wenn keine Portnummern angegeben sind, wird der Datenverkehr f√ºr alle Ports optimiert.  Lesen Sie hier mehr √ºber diese Funktion. </li></ul><br><img src="https://habrastorage.org/webt/6z/pm/c7/6zpmc7-cic6jlregwi2ylyt9apu.png"></li><li>  Wechseln Sie als N√§chstes zur Registerkarte Authentifizierung und klicken Sie auf +.  Zur Authentifizierung verwenden wir einen lokalen Server unter NSX Edge. <br><br><img src="https://habrastorage.org/webt/aq/kx/bp/aqkxbp8ux9csyx2bui2o5hxdtjc.png"></li><li>  Hier k√∂nnen wir Richtlinien zum Generieren neuer Kennw√∂rter ausw√§hlen und Optionen zum Blockieren von Benutzerkonten konfigurieren (z. B. die Anzahl der Wiederholungsversuche, wenn das Kennwort falsch eingegeben wurde). <br><br><img src="https://habrastorage.org/webt/oz/gd/mi/ozgdmimubqauqwo6gymipuvv8va.png"><br><br><img src="https://habrastorage.org/webt/cp/6n/fl/cp6nflis843n8edmtjimkmk2gdo.png"></li><li>  Da wir die lokale Authentifizierung verwenden, m√ºssen wir Benutzer erstellen. <br><br><img src="https://habrastorage.org/webt/sb/ui/kt/sbuikttq8ew3bu8rhqt4kpiq7ho.png"></li><li>  Neben grundlegenden Dingen wie Name und Passwort k√∂nnen Sie hier beispielsweise verhindern, dass der Benutzer das Passwort √§ndert, oder ihn umgekehrt zwingen, das Passwort bei der n√§chsten Anmeldung zu √§ndern. <br><br><img src="https://habrastorage.org/webt/ki/am/qw/kiamqwt8jphlg5f0b_b2ifa4-wy.png"></li><li>  Nachdem Sie alle erforderlichen Benutzer hinzugef√ºgt haben, wechseln Sie zur Registerkarte Installationspakete, klicken Sie auf + und erstellen Sie das Installationsprogramm selbst, mit dem der Remote-Mitarbeiter zur Installation heruntergeladen wird. <br><br><img src="https://habrastorage.org/webt/wg/js/4t/wgjs4tj0efxxlrj9mcpu-gql2z4.png"></li><li>  Klicken Sie auf +.  Wir w√§hlen die Adresse und den Port des Servers aus, zu dem der Client eine Verbindung herstellen soll, sowie die Plattformen, f√ºr die Sie das Installationspaket generieren m√∂chten. <br><br><img src="https://habrastorage.org/webt/gd/sx/i4/gdsxi44atfhzs0yh-wcv8gooqp8.png"><br><br>  In diesem Fenster k√∂nnen Sie unten Client-Einstellungen f√ºr Windows festlegen.  W√§hlen Sie: <br><br><ul><li>  Client bei Anmeldung starten - Der VPN-Client wird zum Start auf einem Remotecomputer hinzugef√ºgt. </li><li>  Desktop-Symbol erstellen - Erstellt ein VPN-Client-Symbol auf dem Desktop. </li><li>  √úberpr√ºfung des Serversicherheitszertifikats - √úberpr√ºft das Serverzertifikat bei der Verbindung. <br>  Das Server-Setup ist abgeschlossen. </li></ul><br><img src="https://habrastorage.org/webt/7j/po/ia/7jpoiawbsxmetmvijnvnvtu7mfm.png"></li><li>  Laden Sie nun das Installationspaket herunter, das wir im letzten Schritt auf dem Remote-PC erstellt haben.  Beim Einrichten des Servers haben wir dessen externe Adresse (185.148.83.16) und Port (445) angegeben.  An diese Adresse m√ºssen wir zum Webbrowser gehen.  In meinem Fall ist es <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">185.148.83.16</a> : 445. <br><br>  Im Autorisierungsfenster m√ºssen Sie die Anmeldeinformationen des zuvor erstellten Benutzers eingeben. <br><br><img src="https://habrastorage.org/webt/w6/5t/b3/w65tb3thu0i3yvh2wkp0dq5enc4.png"></li><li>  Nach der Autorisierung wird eine Liste der erstellten Installationspakete angezeigt, die zum Download zur Verf√ºgung stehen.  Wir haben nur eine erstellt - und herunterladen. <br><br><img src="https://habrastorage.org/webt/62/_m/af/62_mafqhlxpqpqa3wrq5g_9gpvo.png"></li><li>  Wir klicken auf den Link, der Download des Clients beginnt. <br><br><img src="https://habrastorage.org/webt/du/1n/th/du1nth1rhphihfhpctp1hmnk1es.png"></li><li>  Entpacken Sie das heruntergeladene Archiv und f√ºhren Sie das Installationsprogramm aus. <br><br><img src="https://habrastorage.org/webt/np/bs/69/npbs69o4arrddkvwqxrvomnn5l0.png"></li><li>  F√ºhren Sie nach der Installation den Client aus, und klicken Sie im Autorisierungsfenster auf Anmelden. <br><br><img src="https://habrastorage.org/webt/og/lq/uc/oglqucpuesvmhe8tj9kphxxeqdk.png"></li><li>  W√§hlen Sie im Fenster zur Zertifikats√ºberpr√ºfung die Option Ja aus. <br><br><img src="https://habrastorage.org/webt/nf/m3/da/nfm3dacakvoreocayzwrmacmjoa.png"></li><li>  Wir geben die Anmeldeinformationen f√ºr den zuvor erstellten Benutzer ein und stellen sicher, dass die Verbindung erfolgreich hergestellt wurde. <br><br><img src="https://habrastorage.org/webt/zz/ot/_r/zzot_riaf24alcpw2cmobskcl0c.png"><br><br><img src="https://habrastorage.org/webt/yq/d5/dz/yqd5dzwb3yarbdaqidoxk-g2l2a.png"></li><li>  √úberpr√ºfen Sie die Statistiken des VPN-Clients auf dem lokalen Computer. <br><br><img src="https://habrastorage.org/webt/mf/qi/yi/mfqiyi-qzvx7_aiyptg-jb7yocy.jpeg"><br><br><img src="https://habrastorage.org/webt/qv/no/fr/qvnofrg8hclsrdjrp1lo-pdkdom.jpeg"></li><li>  In der Windows-Befehlszeile (ipconfig / all) sehen wir, dass ein zus√§tzlicher virtueller Adapter angezeigt wurde und eine Verbindung zum Remote-Netzwerk besteht. Alles funktioniert: <br><br><img src="https://habrastorage.org/webt/01/hf/5t/01hf5tzh6ej5o-6pq8a4wkms2dq.jpeg"><br><br><img src="https://habrastorage.org/webt/qb/km/he/qbkmhe0m1q1hfrhlceovxla3ldw.png"></li><li>  Und schlie√ülich - eine √úberpr√ºfung √ºber die Edge Gateway-Konsole. <br><br><img src="https://habrastorage.org/webt/2e/ot/wr/2eotwriama_etzynpyasqcimg2k.png"></li></ol><br><h3>  L2 VPN </h3><br>  L2VPN wird ben√∂tigt, wenn Sie mehrere geografisch kombinieren m√ºssen <br>  verteilte Netzwerke in einer Broadcast-Dom√§ne. <br><br>  Dies kann beispielsweise bei der Migration einer virtuellen Maschine hilfreich sein: Wenn eine VM an einen anderen geografischen Standort verschoben wird, speichert die Maschine die IP-Adressierungseinstellungen und verliert nicht die Konnektivit√§t mit anderen Maschinen, die sich in derselben L2-Dom√§ne befinden. <br><br>  In unserer Testumgebung verbinden wir zwei Standorte miteinander und nennen sie A bzw. B. Wir haben zwei NSX- und zwei identisch erstellte geroutete Netzwerke, die mit verschiedenen Edge verbunden sind.  Maschine A hat die Adresse 10.10.10.250/24, Maschine B hat die Adresse 10.10.10.2/24. <br><br><ol><li>  Wechseln Sie in vCloud Director zur Registerkarte Administration, gehen Sie zum ben√∂tigten VDC, wechseln Sie zur Registerkarte Org VDC Networks und f√ºgen Sie zwei neue Netzwerke hinzu. <br><br><img src="https://habrastorage.org/webt/jh/8x/oa/jh8xoarvrbmyd0cexp1forwc5fo.png"></li><li>  Wir w√§hlen den gerouteten Netzwerktyp aus und binden dieses Netzwerk an unseren NSX.  Wir setzen das Kontrollk√§stchen Als Subschnittstelle erstellen. <br><br><img src="https://habrastorage.org/webt/ke/fa/gp/kefagptrkwzznjydhktrom9g2ww.png"></li><li>  Als Ergebnis sollten wir zwei Netzwerke bekommen.  In unserem Beispiel hei√üen sie Netzwerk-a und Netzwerk-b mit denselben Gateway-Einstellungen und derselben Maske. <br><br><img src="https://habrastorage.org/webt/s2/fs/m0/s2fsm0dcmiqyrka4acercwf26ww.png"><br><br><img src="https://habrastorage.org/webt/ev/mr/k8/evmrk8fmiyzemartcv_hjakdhus.png"></li><li>  Fahren wir nun mit den Einstellungen des ersten NSX fort.  Dies ist der NSX, an den Netzwerk A angeschlossen ist. Er fungiert als Server. <br><br>  Gehen Sie zur√ºck zur NSx Edge-Schnittstelle / Gehen Sie zur Registerkarte VPN -&gt; L2VPN.  Wir aktivieren L2VPN, w√§hlen den Server-Betriebsmodus aus und geben in den globalen Servereinstellungen die externe IP-Adresse des NSX an, an der der Port f√ºr den Tunnel abgeh√∂rt wird.  Standardm√§√üig wird der Socket an Port 443 ge√∂ffnet, kann jedoch ge√§ndert werden.  Vergessen Sie nicht, die Verschl√ºsselungseinstellungen f√ºr den zuk√ºnftigen Tunnel auszuw√§hlen. <br><br><img src="https://habrastorage.org/webt/5s/cp/yl/5scpylcprxcu_wmgtvgwxqi3bv0.png"></li><li>  Gehen Sie zur Registerkarte Server Sites und f√ºgen Sie ein Fest hinzu. <br><br><img src="https://habrastorage.org/webt/9u/az/bm/9uazbmzmfihywslasekwqmrhm1o.png"></li><li>  Schalten Sie das Fest ein, legen Sie den Namen, die Beschreibung, ggf. den Benutzernamen und das Passwort fest.  Wir werden diese Daten sp√§ter beim Einrichten der Client-Site ben√∂tigen. <br><br>  Legen Sie unter Egress Optimization Gateway Address die Gateway-Adresse fest.  Dies ist erforderlich, damit kein Konflikt zwischen IP-Adressen besteht, da das Gateway in unseren Netzwerken dieselbe Adresse hat.  Dann dr√ºcken wir die Taste SELECT SUB-INTERFACES. <br><br><img src="https://habrastorage.org/webt/lh/y8/t2/lhy8t2pxycomacepgel1vess6jy.png"></li><li>  Hier w√§hlen wir die gew√ºnschte Subschnittstelle aus.  Speichern Sie die Einstellungen. <br><br><img src="https://habrastorage.org/webt/_o/hn/3l/_ohn3lperjba15rifdy6yyzvk0u.png"></li><li>  Wir sehen, dass die neu erstellte Client-Site in den Einstellungen angezeigt wurde. <br><br><img src="https://habrastorage.org/webt/sd/p_/lf/sdp_lf6amh08k9aexlsxl724ioc.png"></li><li>  Fahren wir nun mit der Konfiguration von NSX auf der Clientseite fort. <br><br>  Wir gehen zu NSX Seite B, gehen zu VPN -&gt; L2VPN, schalten L2VPN ein und setzen den L2VPN-Modus auf den Client-Modus.  Legen Sie auf der Registerkarte Client Global die Adresse und den Port von NSX A fest, die wir zuvor auf der Serverseite als Listening IP und Port angegeben haben.  Es ist auch erforderlich, dieselben Verschl√ºsselungseinstellungen festzulegen, damit sie beim Anheben des Tunnels konsistent sind. <br><br><img src="https://habrastorage.org/webt/wn/yx/ug/wnyxug_ioltwju3lcqh-fzqk2sy.png"><br><br>  Scrollen Sie nach unten und w√§hlen Sie die Subschnittstelle aus, √ºber die der Tunnel f√ºr L2VPN erstellt werden soll. <br>  Legen Sie unter Egress Optimization Gateway Address die Gateway-Adresse fest.  Legen Sie die Benutzer-ID und das Kennwort fest.  Wir w√§hlen die Subschnittstelle aus und vergessen nicht, die Einstellungen zu speichern. <br><br><img src="https://habrastorage.org/webt/bi/bf/qj/bibfqjjaw-s5rridzyz_vxtb_ng.png"></li><li>  Das ist eigentlich alles.  Die Client- und Servereinstellungen sind bis auf wenige Nuancen nahezu identisch. </li><li>  Jetzt k√∂nnen wir sehen, was unser Tunnel verdient hat, indem wir auf jedem NSX zu Statistik -&gt; L2VPN gehen. <br><br><img src="https://habrastorage.org/webt/dj/uj/iu/djujiuzlvgswhq1osmpajodl4fe.png"></li><li>  Wenn wir jetzt in die Konsole eines Edge-Gateways gehen, sehen wir die Adressen beider VMs auf jeder von ihnen in der arp-Tabelle. <br><br><img src="https://habrastorage.org/webt/uy/si/r8/uysir84foday_fr6xip0tku5sca.png"></li></ol><br><br>  Hier dreht sich alles um VPN unter NSX Edge.  Fragen Sie, ob etwas unklar ist.  Dies ist auch der letzte Teil einer Reihe von Artikeln zur Arbeit mit NSX Edge.  Wir hoffen sie waren n√ºtzlich :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de454004/">https://habr.com/ru/post/de454004/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de453994/index.html">Badoo Techleads Meetup # 4. Professionelles Burnout und Motivation</a></li>
<li><a href="../de453996/index.html">Uhhhhhh. Wie man im Internet ohne Website verkauft</a></li>
<li><a href="../de453998/index.html">Aeroexpress: Gehe zum Depot</a></li>
<li><a href="../de454000/index.html">L√ÑCHELN IST NICHT LASIK. Informationen zur Lasersichtkorrektur</a></li>
<li><a href="../de454002/index.html">Experiment: Wie man Tor maskiert, indem man Schl√∂sser umgeht</a></li>
<li><a href="../de454006/index.html">√úber IT ohne Bindungen: Werbung, Bindung und Umsatz in Unternehmen aus der GUS und den USA</a></li>
<li><a href="../de454010/index.html">Hochschul- und Weiterbildung in IT: Ergebnisse der My Circle-Studie</a></li>
<li><a href="../de454012/index.html">Das Ende der √Ñra der Reparaturger√§te. Wie Apple und Amazon alte Elektronikh√§ndler ausr√§umen</a></li>
<li><a href="../de454016/index.html">3CX v16 Update 1, 3CX App f√ºr iOS Beta und die neue Version von 3CX Call Flow Designer</a></li>
<li><a href="../de454018/index.html">iOS Digest Nr. 6 (17. - 30. Mai)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>