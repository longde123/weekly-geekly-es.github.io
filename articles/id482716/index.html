<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🛄 🈴 🔡 Pengembangan papan debug untuk K1986BE1QI (air) 😴 🦐 ◾️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Beberapa tahun yang lalu, saya bertemu dengan mikrokontroler Rusia dari Milander. Itu adalah tahun 2013, ketika para insinyur dengan penuh semangat me...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pengembangan papan debug untuk K1986BE1QI (air)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/482716/"><img src="https://habrastorage.org/webt/xa/8d/4m/xa8d4m3m5jgwavt_34l7oj8abfi.jpeg" alt="Papan Debug MDB1986"><br><br>  Beberapa tahun yang lalu, saya bertemu dengan mikrokontroler Rusia dari Milander.  Itu adalah tahun 2013, ketika para insinyur dengan penuh semangat membahas hasil pertama dari Program Target Federal "Pengembangan basis komponen elektronik dan radio elektronik" untuk 2008-2015.  Pada saat itu, pengendali K1986BE9x (inti Cortex-M3) telah dirilis dan pengontrol 1986BE1T (inti Cortex-M1) baru saja muncul.  Dia dalam kasus plastik LQFP-144 memiliki penunjukan K1986BE1QI (penerbangan), dan pada chip itu sendiri penunjukan MDR32F1QI.  Di situs web pabrikan ia memiliki akhiran “avia”, karena memiliki antarmuka khusus untuk industri pesawat terbang (ARINC 429, MIL_STD_1553). <a name="habracut"></a><br><br>  Anehnya, pada saat distribusi pengendali ini, perusahaan Milander menyiapkan alat debugging dan perpustakaan subprogram untuk bekerja dengan periferal, "tetapi tanpa jaminan dan kewajiban tambahan tentang kebenaran perpustakaan."  Perpustakaan mirip dengan Perpustakaan Periferal Standar STMicroelectronics.  Secara umum, semua pengontrol ARM yang dibangun pada inti Cortex-M memiliki banyak kesamaan.  Karena alasan ini, kenalan dengan pengendali Rusia yang baru berjalan dengan cepat.  Dan bagi mereka yang membeli kit debugging bermerek, dukungan teknis diberikan selama penggunaan. <br><br><img src="https://habrastorage.org/webt/36/-5/cu/36-5cuhduqbdylqea5diodzri2o.png"><br>  <i>Debug kit untuk mikrokontroler 1986BE1T, © Milander</i> <br><br>  Namun, seiring berjalannya waktu, "penyakit anak-anak" dari sirkuit mikro dan perpustakaan baru mulai muncul.  Contoh uji firmware berfungsi tanpa masalah yang terlihat, tetapi dengan modifikasi yang signifikan, macet dan kesalahan menghujani.  "Telan" pertama dalam praktik saya adalah kegagalan yang tidak dapat dijelaskan dalam pengoperasian pengontrol CAN.  Setahun kemudian, pada pengontrol audit awal 1986BE1T (air), masalah terdeteksi dengan modul <a href="https://ru.wikipedia.org/wiki/MIL-STD-1553" rel="nofollow">MKIO (saluran pertukaran informasi multipleks)</a> .  Secara umum, semua revisi mikrokontroler ini hingga 2016 adalah penggunaan terbatas.  Butuh banyak waktu dan keberanian untuk mengidentifikasi masalah ini, yang konfirmasinya sekarang dapat ditemukan dalam <a href="https://ic.milandr.ru/upload/iblock/352/352a1573c08c406a94b976ed95fe4506.pdf" rel="nofollow">daftar kesalahan (Errata)</a> . <br><br>  Fitur yang tidak menyenangkan adalah bahwa itu perlu untuk bekerja dan menangani kesalahan bukan pada papan debug, tetapi pada papan prototipe perangkat yang direncanakan untuk produksi serial.  Selain konektor JTAG, biasanya tidak ada apa-apa di sana.  Menghubungkan dengan penganalisa logika itu sulit dan tidak nyaman, dan biasanya tidak ada LED atau layar.  Untuk alasan ini, saya berpikir untuk membuat papan debug saya sendiri. <br><br>  Di satu sisi, ada kit debugging bermerek di pasar, serta papan indah dari LDM-Systems dari Zelenograd.  Di sisi lain, harga untuk produk-produk ini didorong ke keadaan pingsan, dan fungsi dasar tanpa kartu ekspansi tidak memenuhi harapan.  Papan dengan pengontrol yang disolder dan konektor pin tidak menarik bagi saya.  Dan papan yang lebih menarik harganya mahal. <br><br><img src="https://habrastorage.org/webt/6u/ob/ww/6uobww_tvc36dmyyhcmemgkedhg.jpeg"><br>  <i>Papan debug MILANDR LDM-HELPER-K1986BE1QI-FULL, © Sistem LDM</i> <br><br>  Harga dan pemasaran "Milander" khas perusahaan.  Jadi, dimungkinkan untuk mendapatkan sampel gratis dari beberapa sirkuit mikro, tetapi ini hanya tersedia untuk badan hukum dan dikaitkan dengan pencarian birokrasi.  Secara umum, sirkuit mikro dalam wadah logam-keramik adalah emas dalam arti langsung dan figuratif.  Misalnya, biaya pengontrol 1986BE1T dari 14 hingga 24 ribu rubel di Moskow.  Chip memori statis 1645RU6U harganya mulai 15.000 rubel.  Dan urutan harga untuk semua produk.  Akibatnya, bahkan lembaga penelitian khusus dengan pesanan negara menyimpan dan menghindar dari harga seperti itu.  Sirkuit mikro dalam wadah plastik untuk penggunaan sipil secara signifikan lebih murah, tetapi tidak tersedia dari pemasok populer.  Selain itu, kualitas sirkuit mikro dalam kotak plastik, menurut saya, lebih buruk daripada yang "emas".  Sebagai contoh, saya tidak dapat memulai pengontrol K1986BE1QI pada frekuensi 128 MHz tanpa meningkatkan parameter latensi flash.  Pada saat yang sama, suhu pengontrol ini naik menjadi 40-50C.  Tetapi kontroler 1986BE1T ("emas") diluncurkan pada 128 MHz tanpa pengaturan tambahan dan tetap dingin.  Dia sangat bagus. <br><br><img src="https://habrastorage.org/webt/hm/hd/vm/hmhdvmzvhpvw7ujz09cw5ol49ou.png"><br>  <i>Mikrokontroler "Emas" 1986BE1T, (c) Milander</i> <br><br>  Saya beruntung bahwa mikrokontroler dalam wadah plastik masih dapat dibeli secara eceran di Sistem LDM, dan semua papan sirkuit tersedia secara bebas.  Yang buruk adalah bahwa di situs pada foto controller ada tanda yang mengatakan bahwa ini adalah revisi ke-4 tahun 2014, mis.  dengan cacat.  Saya berpikir untuk waktu yang lama - untuk membeli atau tidak membeli.  Beberapa tahun telah berlalu ... <hr><br><br>  Gagasan membuat papan debug belum hilang.  Berangsur-angsur, saya membentuk semua persyaratan dan berpikir bagaimana cara meletakkan semua ini di satu papan, sehingga menjadi padat dan tidak mahal.  Secara paralel, saya memesan komponen yang hilang dari Cina.  Saya tidak terburu-buru - saya melakukan segalanya untuk diri saya sendiri.  Pemasok Cina terkenal karena kecerobohannya - saya harus memesan hal yang sama di tempat yang berbeda untuk mendapatkan semua yang saya butuhkan.  Terlebih lagi, beberapa microcircuits memori ternyata sedang digunakan - jelas diuapkan dari perangkat yang rusak.  Ini kembali kepada saya nanti. <br><br>  Untuk membeli mikrokontroler, Milander K1986BE1QI (avia) bukanlah tugas yang mudah.  Di toko Chip dan Dip yang sama, di bagian "Item Pesanan", saya hanya menemukan K1986BE92QI untuk 740 rubel, tetapi itu tidak cocok untuk saya.  Satu-satunya pilihan adalah membeli di LDM-Systems seharga 2.000 rubel bukan revisi baru.  Karena saya tidak dapat menemukan pengganti di tempat lain, saya memutuskan untuk membeli apa itu.  Yang mengejutkan saya, mereka menjual saya pengendali rilis baru Desember 2018, revisi 6+ (1820).  Dan situs tersebut masih memiliki foto lama, dan pada saat penulisan, controller tidak tersedia ... <br><br><img src="https://habrastorage.org/webt/cr/p3/eu/crp3euoxhtfbkqo_pzet4vjencs.jpeg"><br>  <i>Mikrokontroler K1986BE1QI (avia) dalam kemasan teknologi, (c) - Foto oleh</i> <br><br>  Spesifikasi teknis utama papan debug <b>MDB1986</b> saya <b>adalah</b> sebagai berikut: <br><br><ul><li>  built-in debugger-programmer yang kompatibel dengan J-Link dan CMSIS-DAP; </li><li>  Memori statis 4Mbit (256k x 16, 10 ns); </li><li>  64Mbit chip memori flash, Winbond 25Q64FVSIG; </li><li>  Transceiver antarmuka RS-232 dengan jalur RTS dan CTS; </li><li>  antarmuka dan konektor untuk Ethernet, USB, CAN; </li><li>  MAX7221 pengontrol tampilan 7-segmen </li><li>  konektor pin untuk bekerja dengan MKIO (MIL_STD_1553) dan ARINC429; </li><li>  Everlight PT17-21C Phototransistor; </li><li>  lima warna LED, tombol reset dan dua tombol pengguna; </li><li>  ditenagai oleh port USB 5 volt; </li><li>  Dimensi PCB 100 x 80 mm </li></ul><br>  Saya menyukai papan seri STM-Discovery karena ada programmer debugger bawaan - ST-Link.  ST-Link bermerek hanya berfungsi dengan pengontrol STMicroelectronics, tetapi beberapa tahun yang lalu menjadi mungkin untuk memperbarui firmware di ST-Link dan mendapatkan Debugger J-Link OB (on-board) SEGGER.  Secara hukum ada pembatasan penggunaan debugger seperti itu hanya dengan papan STMicroelectronics, tetapi pada kenyataannya potensi tidak terbatas.  Dengan demikian, memiliki J-Link OB, Anda dapat memiliki debugger bawaan di papan debug.  Saya perhatikan bahwa dalam produk "LDM-Systems" digunakan konverter CP2102 (Usb2Uart), yang hanya dapat berkedip. <br><br><img src="https://habrastorage.org/webt/fq/yd/6z/fqyd6z1yxuwig0mw46du7l0pu8y.jpeg"><br>  <i>Mikrokontroler STM32F103C8T6, nyata dan tidak, (c) Foto oleh</i> <br><br>  Jadi, perlu untuk membeli STM32F103C8T6 asli, karena firmware eksklusif tidak akan berfungsi dengan benar dengan klon.  Saya meragukan tesis ini dan memutuskan untuk mencoba pengontrol CS32F103C8T6 dari perusahaan Cina CKS yang sedang beroperasi.  Saya tidak memiliki keluhan tentang controller itu sendiri, tetapi firmware ST-Link tidak berfungsi di dalamnya.  J-Link berfungsi sebagian - perangkat USB terdeteksi, tetapi programmer tidak menjalankan fungsinya dan terus-menerus mengingatkan bahwa itu "rusak". <br><br><img src="https://habrastorage.org/webt/sh/dp/zs/shdpzs1rrvs4ndpodfxgykmxoqk.png"><br>  <i>Kesalahan saat bekerja dengan debugger pada pengontrol tidak asli</i> <br><br>  Saya tidak tenang tentang ini dan pertama menulis firmware untuk LED berkedip, dan kemudian menyadari permintaan IDCODE menggunakan protokol JTAG.  Programmer ST-Link yang saya miliki di papan Discovery dan program ST-Link Utility menginstal CS32F103C8T6 tanpa masalah, sebagai hasilnya, saya memastikan bahwa board saya berfungsi.  Saya senang sekali, controller target K1986BE1QI (avia) dengan ceria mengeluarkan IDCODE-nya melalui jalur TDO. <br><br><img src="https://habrastorage.org/webt/mg/cd/6b/mgcd6bodfiolhoncf0dqpy_ztyi.png"><br>  <i>Osilogram garis sinyal TDO dengan respons IDCODE yang disandikan, (c) - Foto oleh</i> <br><br><img src="https://habrastorage.org/webt/ls/9b/hk/ls9bhkuow-fz1gir-e48kwyld2i.png"><br>  <i>Jadi port SWD berguna untuk debugging debugger itu sendiri dan memeriksa IDCODE</i> <br><br>  Ada varian dengan debugger <a href="https://arm-software.github.io/CMSIS_5/DAP/html/index.html" rel="nofollow">CMSIS-DAP (Debug Access Port)</a> .  Membangun proyek dari kode sumber dari ARM bukanlah tugas yang mudah, saya mengambil proyek dari <a href="https://habr.com/ru/users/x893/" class="user_link">X893</a> , dan kemudian saya mencoba DAP42.  Sayangnya, Keil uVision menutup telepon dan tidak mau bekerja dengan mereka.  Akibatnya, saya mengganti chip debugger dengan STM32F103C8T6 milik dan tidak kembali ke masalah ini lagi. <br><br><img src="https://habrastorage.org/webt/qd/ry/fs/qdryfsbagp3hggtvmrl0tiym-dg.png"><br>  <i>Debugger J-Link STLink V2 yang berhasil</i> <br><br>  Ketika semua komponen kunci dari papan debug masa depan ada dalam stok, saya naik ke Eagle CAD dan menemukan bahwa mereka tidak ada di perpustakaan elemen.  Tidak ada tempat untuk pergi - mereka harus menggambar diri mereka sendiri.  Pada saat yang sama, saya membuat jejak kaki untuk memori, konektor HanRun untuk Ethernet, dan menambahkan frame untuk resistor dan kapasitor.  File proyek dan pustaka komponen dapat ditemukan <a href="https://github.com/makbit/MDB1986" rel="nofollow">di GitHub saya</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Diagram skematis papan debug MDB1986</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/hx/44/jy/hx44jyp0pkskpjgb1zh-1tf6hfu.png"></div></div><br><br>  Papan ini ditenagai oleh sumber DC 5 volt, yang diperoleh dari port USB.  Ada dua port USB Tipe-B di papan tulis.  Satu untuk programmer, yang kedua untuk controller K1986BE1QI.  Dewan dapat bekerja dari sumber-sumber ini atau dengan keduanya sekaligus.  Kontrol beban yang paling sederhana dan perlindungan saluran listrik diterapkan pada dioda Schottky, pada sirkuit D2 dan D3 (SS24).  Juga pada diagram Anda dapat melihat sekering penyembuhan diri F1 dan F2 pada 500mA.  Garis sinyal port USB dilindungi oleh rakitan dioda USBLC6-2SC6. <br><br>  Sirkuit debugger-programmer ST-Link diketahui banyak orang, dapat ditemukan dalam dokumentasi untuk papan STM32-Discovery dan sumber lainnya.  Untuk firmware awal klon ST-Link / J-Link-OB / DAP (opsional), saya mengeluarkan garis SWDIO (PA13), SWCLK (PA14), GND.  Banyak orang menggunakan UART untuk firmware dan dipaksa untuk menarik jumper BOOT.  Tetapi SWD lebih nyaman bagi saya, apalagi, protokol ini memungkinkan debugging. <br><br>  Hampir semua komponen papan didukung oleh 3,3 volt, yang berasal dari regulator tegangan AMS1117-3.3.  Untuk menekan interferensi elektromagnetik dan arus masuk, filter LC dari kapasitor dan choke dari seri BLM31PG digunakan. <br><br>  Kami juga harus menyebutkan driver untuk tampilan 7-segmen MAX7221.  Menurut spesifikasi, catu daya yang disarankan adalah dari 4 hingga 5,5 volt, dan tingkat sinyal tinggi (unit logis) setidaknya 3,5V (0,7 x VCC), dengan catu daya 5V.  Untuk pengontrol K1986BE1QI (avia), output dari unit logis berhubungan dengan tegangan 2,8 hingga 3,3V.  Jelas ada ketidakcocokan tingkat sinyal yang dapat mengganggu operasi normal.  Saya memutuskan untuk menyalakan MAX7221 dari 4V dan menurunkan level sinyal ke 2.8V (0,7 x 4 = 2,8).  Untuk melakukan ini, dioda D4 (RS1A atau FR103) dipasang secara seri dengan rangkaian daya driver.  Penurunan tegangan total adalah 0.9V (Schottky diode 0.3V dan diode 0.6V), dan semuanya berfungsi. <br><br>  Sebagian besar port mikrokontroler K1986BE1QI (avia) kompatibel dengan sinyal hingga 5V.  Oleh karena itu, penggunaan transceiver CAN MCP2551, yang juga beroperasi pada 5V, tidak menimbulkan masalah.  Chip MAX3232 ditunjukkan pada diagram sebagai transceiver RS-232, tetapi sebenarnya saya menggunakan SN65C3232D dari Texas Instruments, karena  Ini berjalan dari 3.3V dan memberikan kecepatan hingga 1Mbit / s. <br><br>  Ada 4 resonator kuarsa di papan - satu untuk debugger (8 MHz) dan tiga untuk mikrokontroler target K1986BE1QI (avia) dengan nilai 32.768 kHz, 16 MHz, 25 MHz.  Ini adalah komponen yang diperlukan, seperti  Parameter generator RC built-in berkisar dari 6 hingga 10 MHz.  Frekuensi 25 MHz diperlukan untuk pengoperasian pengontrol Ethernet terintegrasi.  Di situs Milander (mungkin karena kesalahan) untuk beberapa alasan diindikasikan bahwa tidak ada Ethernet dalam kasus plastik.  Tapi kami akan mengandalkan spesifikasi dan fakta. <br><br>  Insentif penting untuk membuat papan debug Anda sendiri adalah kemampuan untuk bekerja dengan bus sistem eksternal EBC (pengontrol bus eksternal), yang pada dasarnya adalah port paralel.  Mikrokontroler K1986BE1QI (avia) memungkinkan Anda untuk terhubung dan bekerja dengan chip memori eksternal dan perangkat periferal, misalnya, ADC, FPGA, dll.  Kemampuan bus sistem eksternal cukup besar - Anda dapat bekerja dengan RAM statis 8-bit, 16-bit dan 32-bit, ROM dan NAND Flash.  Untuk membaca / menulis data 32-bit, pengontrol dapat secara otomatis melakukan 2 operasi yang sesuai untuk sirkuit 16-bit, dan untuk operasi 8-bit - 4.  Jelas, operasi I / O 32-bit akan menjadi yang tercepat dengan bus data 32-bit.  Kerugiannya termasuk perlunya program untuk beroperasi dengan data 32-bit, dan 32 trek harus diletakkan di papan tulis. <br><br><img src="https://habrastorage.org/webt/oh/sf/n8/ohsfn8vpr98krnms8rohx6l-bjs.jpeg"><br>  <i>Chip RAM statis yang digunakan (tebak mana yang rusak)</i> <br><br>  Solusi yang seimbang adalah dengan menggunakan chip memori 16-bit.  Saya memiliki Solusi Silikon Terintegrasi Inc.  (ISSI IS61LV25616AL, 16 x 256k, 10 ns, 3.3V).  Tentu saja, perusahaan Milander memiliki <a href="https://ic.milandr.ru/products/mikroskhemy_pamyati/" rel="nofollow">seri 1645RU</a> sendiri <a href="https://ic.milandr.ru/products/mikroskhemy_pamyati/" rel="nofollow">chip</a> memori statis, tetapi mereka terlalu mahal dan tidak dapat diakses.  Atau, ada kompatibilitas pin Samsung K6R4016V1D.  Sebelumnya, saya menyebutkan bahwa rangkaian mikro ternyata sedang digunakan dan contoh yang saya instal pada awalnya memberikan nilai kegagalan dan kacau pada baris data ke-15.  Butuh beberapa hari untuk mencari kesalahan perangkat keras, dan yang lebih besar adalah perasaan puas ketika saya mengganti chip yang rusak dengan yang berfungsi.  Bagaimanapun, kecepatan bekerja dengan memori eksternal meninggalkan banyak yang diinginkan. <br><br><div class="spoiler">  <b class="spoiler_title">Bus eksternal dan mode StandAlone</b> <div class="spoiler_text">  Mikrokontroler K1986BE1QI (penerbangan) memiliki mode StandAlone yang unik, yang dirancang untuk akses eksternal langsung ke pengontrol Ethernet dan MKIO (MIL_STD_1553) melalui bus eksternal, dan intinya berada dalam keadaan reset, mis.  tidak digunakan.  Mode ini sesuai untuk prosesor dan FPGA yang tidak memiliki Ethernet dan / atau MKIO. </div></div><br>  Diagram koneksi adalah sebagai berikut: <br><br><ul><li>  MCU data bus (D0-D15) =&gt; SRAM (I / O0-I / O15), </li><li>  bus alamat MCU (A1-A18) =&gt; SRAM (A0-A17), </li><li>  Kontrol MCU (nWR, nRD, PortC2) =&gt; SRAM (WE, OE, CE), </li><li>  SRAM (UB, LB) terhubung atau ditarik ke tanah melalui resistor. </li></ul><br>  Garis CE ditarik ke atas melalui resistor, pin untuk pemilihan byte MCU (BE0-BE3) tidak digunakan.  Di bawah spoiler, saya mengutip kode inisialisasi port dan pengontrol bus eksternal. <br><br><div class="spoiler">  <b class="spoiler_title">Inisialisasi port dan pengontrol EBC (pengontrol bus eksternal)</b> <div class="spoiler_text"><pre><code class="plaintext hljs">void SRAM_Init (void) { EBC_InitTypeDef EBC_InitStruct = { 0 }; EBC_MemRegionInitTypeDef EBC_MemRegionInitStruct = { 0 }; PORT_InitTypeDef initStruct = { 0 }; RST_CLK_PCLKcmd (RST_CLK_PCLK_EBC, ENABLE); PORT_StructInit (&amp;initStruct); //--------------------------------------------// // DATA PA0..PA15 (D0..D15) // //--------------------------------------------// initStruct.PORT_MODE = PORT_MODE_DIGITAL; initStruct.PORT_PD_SHM = PORT_PD_SHM_ON; initStruct.PORT_SPEED = PORT_SPEED_FAST; initStruct.PORT_FUNC = PORT_FUNC_MAIN; initStruct.PORT_Pin = PORT_Pin_All; PORT_Init (MDR_PORTA, &amp;initStruct); //--------------------------------------------// // Address PF3-PF15 (A0..A12), A0 - not used. // //--------------------------------------------// initStruct.PORT_FUNC = PORT_FUNC_ALTER; initStruct.PORT_Pin = PORT_Pin_4 | PORT_Pin_5 | PORT_Pin_6 | PORT_Pin_7 | PORT_Pin_8 | PORT_Pin_9 | PORT_Pin_10 | PORT_Pin_11 | PORT_Pin_12 | PORT_Pin_13 | PORT_Pin_14 | PORT_Pin_15; PORT_Init (MDR_PORTF, &amp;initStruct); //--------------------------------------------// // Address PD3..PD0 (A13..A16) // //--------------------------------------------// initStruct.PORT_FUNC = PORT_FUNC_OVERRID; initStruct.PORT_Pin = PORT_Pin_0 | PORT_Pin_1 | PORT_Pin_2 | PORT_Pin_3; PORT_Init (MDR_PORTD, &amp;initStruct); //--------------------------------------------// // Address PE3, PE4 (A17, A18) // //--------------------------------------------// initStruct.PORT_FUNC = PORT_FUNC_ALTER; initStruct.PORT_Pin = PORT_Pin_3 | PORT_Pin_4; PORT_Init (MDR_PORTE, &amp;initStruct); //--------------------------------------------// // Control PC0,PC1 (nWE,nOE) // //--------------------------------------------// initStruct.PORT_FUNC = PORT_FUNC_MAIN; initStruct.PORT_Pin = PORT_Pin_0 | PORT_Pin_1; PORT_Init (MDR_PORTC, &amp;initStruct); //--------------------------------------------// // Control PC2 (nCE) // //--------------------------------------------// initStruct.PORT_PD = PORT_PD_DRIVER; initStruct.PORT_OE = PORT_OE_OUT; initStruct.PORT_FUNC = PORT_FUNC_PORT; initStruct.PORT_Pin = MDB_SRAM_CE; PORT_Init (MDR_PORTC, &amp;initStruct); //--------------------------------------------// // Initialize EBC controler // //--------------------------------------------// EBC_DeInit(); EBC_StructInit(&amp;EBC_InitStruct); EBC_InitStruct.EBC_Mode = EBC_MODE_RAM; EBC_InitStruct.EBC_WaitState = EBC_WAIT_STATE_3HCLK; EBC_InitStruct.EBC_DataAlignment = EBC_EBC_DATA_ALIGNMENT_16; EBC_Init(&amp;EBC_InitStruct); EBC_MemRegionStructInit(&amp;EBC_MemRegionInitStruct); EBC_MemRegionInitStruct.WS_Active = 2; EBC_MemRegionInitStruct.WS_Setup = EBC_WS_SETUP_CYCLE_1HCLK; EBC_MemRegionInitStruct.WS_Hold = EBC_WS_HOLD_CYCLE_1HCLK; EBC_MemRegionInitStruct.Enable_Tune = ENABLE; EBC_MemRegionInit (&amp;EBC_MemRegionInitStruct, EBC_MEM_REGION_60000000); EBC_MemRegionCMD(EBC_MEM_REGION_60000000, ENABLE); // Turn ON RAM (nCE) PORT_ResetBits (MDR_PORTC, MDB_SRAM_CE); }</code> </pre> </div></div><br>  Mikrokontroler dalam paket LQFP-144 dan memori dalam paket TSOP-44 memiliki banyak pin yang terhubung dan mengambil banyak ruang pada papan sirkuit cetak.  Memiliki pengalaman dalam memecahkan masalah optimisasi di bidang ekonomi, jelas bagi saya bahwa perlu untuk menempatkan sirkuit mikro ini di papan di tempat pertama.  Dalam berbagai sumber saya telah melihat pujian untuk <a href="https://www.eremex.ru/products/delta-design/topor/" rel="nofollow">TopoR CAD (Topological Router)</a> .  Saya mengunduh versi uji coba dan dapat mengekspor proyek saya di sana dari Eagle CAD hanya ketika saya menghapus hampir semua komponen.  Sayangnya, bahkan 10 elemen program TopoR tidak membantu saya tempat di papan tulis.  Pertama, semua komponen ditempatkan di sudut, dan kemudian ditempatkan di sepanjang tepi.  Opsi ini tidak memuaskan saya, dan untuk waktu yang lama saya menelusuri papan dalam mode manual di lingkungan Eagle CAD yang akrab. <br><br>  Elemen penting dari papan sirkuit tercetak adalah sablon sutra.  Papan debug tidak hanya memiliki tanda tangan untuk komponen elektronik, tetapi semua konektor harus ditandatangani.  Di bagian belakang papan, saya menempatkan tabel memo dengan fungsi port pengontrol (primer, alternatif, diganti, aktual).  Saya memesan pembuatan papan sirkuit tercetak di Cina di kantor PCBWay yang terkenal.  Saya tidak akan memuji, karena kualitasnya bagus.  Mereka dapat melakukan lebih baik, dengan toleransi yang lebih sedikit, tetapi <a href="https://www.pcbway.com/HighQualityOrderOnline.aspx" rel="nofollow">dengan biaya</a> . <br><br><img src="https://habrastorage.org/webt/8q/gh/2w/8qgh2wsaofz5p2lat7gcoqc4km4.jpeg"><br>  <i>Papan sirkuit tercetak yang diproduksi MDB1986, (c) Foto oleh penulis</i> <br><br>  Saya harus menyolder komponen “di atas lutut saya” dengan besi solder 40 watt dan solder POS-61, karena saya jarang menyoldernya, 1-2 kali setahun, dan pasta solder mengering.  Saya harus mengubah kontroler CS32F103 Cina ke STM32F103 asli, dan kemudian juga mengganti memori.  Secara umum, sekarang hasilnya benar-benar cocok untuk saya, meskipun saya belum memverifikasi operasi RS-232 dan CAN. <br><br><img src="https://habrastorage.org/webt/-h/il/8v/-hil8vgd1228zqjk7ig090eurpq.jpeg"><br>  <i>Papan debug MDB1986 di tempat kerja - bersinar dan memanaskan, (c) Foto oleh</i> <br><br>  Anda dapat menemukan <a href="https://edu.milandr.ru/library/" rel="nofollow">materi pelatihan yang</a> cukup <a href="https://edu.milandr.ru/library/" rel="nofollow">di</a> situs web Milander <a href="https://edu.milandr.ru/library/" rel="nofollow">untuk mempelajari</a> pengontrol seri 1986BE9 (inti Cortex-M3), tetapi saya tidak melihat apa pun untuk mikrokontroler K1986BE1QI (avia).  Setelah meninjau materi yang diterbitkan di sana, manual dan pekerjaan laboratorium untuk universitas, saya senang bahwa personel dilatih di seluruh negeri untuk bekerja dengan pengontrol Rusia.  Sebagian besar materi pelatihan disiapkan untuk bekerja dengan port I / O, timer, ADC, DAC, SPI, UART.  Lingkungan pengembangan IDE yang berbeda digunakan (Keil, IAR, CodeMaster).  Di suatu tempat mereka memprogram menggunakan register CMSIS, dan di suatu tempat mereka menggunakan Perpustakaan MDR.  Penting untuk menyebutkan sumber daya <a href="https://startmilandr.ru/" rel="nofollow">Mulai Milandr</a> , yang berisi banyak artikel dari programmer praktis.  Dan, tentu saja, jangan lupa tentang <a href="https://forum.milandr.ru/" rel="nofollow">forum Milander</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Pemikiran Milander</b> <div class="spoiler_text">  Mikroelektronika berkembang di Rusia, dan Milander memainkan peran penting dalam proses ini.  Ada mikrokontroler baru yang menarik, misalnya, 198681 dan "Power" dengan antarmuka SpaceWire dan MKIO (sama seperti pada 1986BE1 dan, mungkin, dengan masalah yang sama), dll.  Tetapi siswa biasa, guru dan insinyur sipil untuk membeli chip seperti itu tidak realistis.  Jadi komunitas insinyur tidak akan dapat dengan cepat mengidentifikasi kesalahan dan masalah chip ini.  Tampak bagi saya bahwa pada mulanya diperlukan untuk memproduksi sirkuit mikro dalam wadah plastik, untuk mendistribusikannya kepada semua pihak yang berkepentingan, dan hanya setelah pengujian (persetujuan Latin - persetujuan, pengakuan), para spesialis dapat menyiapkan audit dalam wadah logam-keramik dengan perlindungan terhadap semua faktor mengerikan.  Saya berharap bahwa dalam waktu dekat, kita semua akan senang dengan proyek baru yang diumumkan di pameran. </div></div><br>  Siapa pun yang dikembangkan oleh saya, papan debug, dapat mengulangi, memodifikasi, dan menggunakan dalam proses pendidikan.  Pertama-tama, saya membuat papan untuk diri saya sendiri, tetapi ternyata sangat baik sehingga <a href="https://github.com/makbit/MDB1986" rel="nofollow">saya memutuskan untuk membagikannya kepada semua orang</a> . <br><br>  K1986BE1QI (avia) adalah pengontrol yang sangat menarik dengan antarmuka unik yang dapat digunakan di universitas untuk mendidik siswa.  Saya pikir setelah memperbaiki kesalahan yang terdeteksi di controller dan lulus tes sertifikasi, controller akan terbang dalam arti kata yang sebenarnya! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id482716/">https://habr.com/ru/post/id482716/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id482702/index.html">Apakah kita benar-benar membutuhkan TypeScript pada tahun 2020?</a></li>
<li><a href="../id482704/index.html">Redis sinkronisasi cache untuk layanan Go</a></li>
<li><a href="../id482706/index.html">Rekomendasi untuk penerapan akuntansi paralel RAS + IFRS pada platform 1C</a></li>
<li><a href="../id482708/index.html">Salah satu fitur budaya perusahaan yang diperlukan untuk kesejahteraan basis kode</a></li>
<li><a href="../id482714/index.html">Kolom radio Internet paling sederhana "Kodi" atau penyelamatan bata "Raspberry"</a></li>
<li><a href="../id482718/index.html">Piramida terbalik sebagai akhir dari proyek Anda</a></li>
<li><a href="../id482722/index.html">Cerita yang fantastis "Project C. Vanity of vanities" (10 mnt)</a></li>
<li><a href="../id482726/index.html">Intisari materi menarik untuk pengembang seluler # 328 (23-29 Desember)</a></li>
<li><a href="../id482728/index.html">Jpeg. Algoritma kompresi</a></li>
<li><a href="../id482730/index.html">Polling liburan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>