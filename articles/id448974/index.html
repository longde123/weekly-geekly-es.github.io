<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>😁 🌅 👩🏻‍🎓 Pendekatan tanpa server untuk pengembangan cepat layanan video yang berfungsi 🍄 🈷️ 🤼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Saya bekerja dalam outsourcing, di mana prinsip utama dapat dijelaskan dengan kalimat "menjual banyak, lakukan dengan cepat." Semakin cepat kita lakuk...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pendekatan tanpa server untuk pengembangan cepat layanan video yang berfungsi</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448974/"><img src="https://habrastorage.org/webt/pj/so/-j/pjso-jhdtkpxng25sduokkoohfw.png" alt="Elemen AWS"><br><br>  Saya bekerja dalam outsourcing, di mana prinsip utama dapat dijelaskan dengan kalimat "menjual banyak, lakukan dengan cepat."  Semakin cepat kita lakukan, semakin banyak yang kita hasilkan.  Dan, sangat diharapkan bahwa semuanya tidak bekerja pada kruk dan ingus, tetapi dengan tingkat kualitas yang dapat diterima.  Saya akan menceritakan tentang pengalaman saya ketika dalam waktu singkat perlu untuk mengembangkan layanan promosi. <br><br>  <b>Diberikan:</b> akun root di AWS, tidak ada batasan pada pilihan tumpukan teknologi, satu back-end, dan satu bulan untuk pengembangan. <br><br>  <b>Tujuan:</b> mengimplementasikan layanan promosi tempat pengguna mengunggah dari satu hingga empat video yang berlangsung dari satu hingga empat detik, yang kemudian disematkan dalam urutan video asli.  Artinya, kami mengganti fragmen dari video asli (screensaver seri) dengan yang khusus.  Fitur pembunuh - kemampuan untuk mengirim nama Anda, yang dalam bentuk teks yang indah menutupi fragmen video yang sesuai.  Selain itu, pengguna dapat mengunggah video dari 4 hingga 30 detik, dan di sisi layanan akan dipangkas menjadi 4 detik. <br><a name="habracut"></a><br><br><h2>  Solusi </h2><br>  Menulis layanan sepeda Anda dalam kerangka waktu yang ketat adalah sebuah ide.  Selain itu, agar layanan dapat mengatasi beban dan semua orang yang ingin menerima video yang didambakan, infrastruktur akan diperlukan.  Dan lebih disukai tidak dengan label harga dari pesawat.  Karena itu, kami segera fokus pada solusi yang sudah jadi dengan kustomisasi minimal. <br><br>  Solusi standar untuk bekerja dengan video adalah FFmpeg, utilitas konsol lintas-platform yang, melalui argumen, memungkinkan Anda untuk mengiris dan melapisi suara.  Hal kecil adalah menulis pembungkus dan mempraktikkannya.  Kami sedang menulis prototipe yang menyatukan dua video, dan ... kesenangan dimulai.  Pustaka pada .NET Core 2 harus berputar pada mesin virtual apa pun, jadi kami mengambil contoh AWS EC2 dan semuanya akan berfungsi <br><br><div class="spoiler">  <b class="spoiler_title">Teks tersembunyi</b> <div class="spoiler_text">  tidak itu tidak akan berhasil <br></div></div><br>  FFmpeg, meskipun menyederhanakan tugas, tetapi untuk solusi yang benar-benar berfungsi Anda perlu membuat instance EC2, merancang infrastruktur jaringan untuk itu, termasuk Load Balancer.  Tugas sederhana penggelaran dari awal “sedikit” rumit, dan infrastruktur mulai menuntut uang segera - jumlah runtime ditarik dari akun klien setiap jam. <br><br>  Layanan kami tidak melibatkan proses Long-Running, tidak memerlukan database relasional yang besar dan berani, dan sangat cocok dengan arsitektur acara dengan rantai panggilan layanan-mikro.  Solusinya menunjukkan sendiri - kita dapat mengabaikan EC2 dan mengimplementasikan aplikasi benar-serverless, seperti Image Resizer standar berdasarkan AWS Lambda. <br><br>  Omong-omong, meskipun jelas tidak disukai pengembang AWS untuk .NET, mereka mendukung .NET Core 2.1 sebagai runtime, yang memberikan berbagai peluang pengembangan. <br><br>  Dan ceri pada kue - AWS menyediakan layanan terpisah untuk bekerja dengan file video - AWS Elemental MediaConvert. <br><br>  Inti dari pekerjaan ini sangat sederhana: kami mengambil tautan S3 ke video keluar, melalui AWS Console, .NET SDK, atau hanya JSON yang menulis apa yang ingin kami lakukan dengan video dan menghubungi layanan.  Dia sendiri mengimplementasikan antrian untuk memproses permintaan yang masuk, dia membongkar hasilnya dalam S3 dan, yang paling penting, menghasilkan Acara CloudWatch untuk setiap perubahan status.  Ini memungkinkan kami untuk mengimplementasikan pemicu lambda untuk menyelesaikan pemrosesan video. <br><br><img src="https://habrastorage.org/webt/er/4k/48/er4k48mrtrw_tjxtytp8aoitpp8.png" alt="gambar"><br>  <i>Versi final dari arsitektur terlihat seperti ini</i> <br><br>  Seluruh backend ditempatkan dalam dua lambda.  Lain untuk memutar video vertikal, karena pekerjaan seperti itu tidak dapat dilakukan dalam sekali jalan. <br><br>  Hamparan teks dilakukan dengan menampilkan gambar transparan dengan cepat sesuai dengan resolusi video.  Pustaka SixLabors.ImageSharp sangat cocok untuk tujuan ini, dan masalah kebocoran memori secara elegan memotong siklus hidup lambda. <br><br>  Bagian depan dalam bentuk aplikasi SPA yang ditulis dalam JS dan dikompilasi melalui pesek akan ditempatkan di keranjang S3 publik.  Untuk mengunduh video sendiri, kami tidak memerlukan kode server apa pun - cukup buka titik akhir REST yang ditawarkan S3 kepada kami.  Satu-satunya hal - jangan lupa untuk mengkonfigurasi kebijakan dan CORS. <br><br><h2>  Perangkap </h2><br><ul><li>  AWS MediaConvert karena alasan yang tidak diketahui memaksakan suara hanya pada setiap klip video secara terpisah, dan kami membutuhkan lagu yang kuat dari seluruh screensaver. </li><li>  video vertikal perlu diproses secara terpisah.  AWS tidak suka garis-garis hitam dan menempatkan rol pada 90 °. </li></ul><br><br><h2>  Gelanggang mudah </h2><br>  Terlepas dari keindahan Stateless, Anda perlu melacak apa yang perlu dilakukan dengan video: lem atau suara overlay pada urutan video yang sudah selesai.  Untungnya, MediaConvert mendukung transfer metadata melalui Ayubnya, dan kami selalu dapat menerapkan flag sederhana seperti "isMasterSoundJob", menguraikan metadata ini di setiap tahap. <br><br>  Tanpa server membuat NoOps berfungsi dengan baik - suatu pendekatan yang mengasumsikan perlunya tim terpisah yang bertanggung jawab atas infrastruktur proyek.  Oleh karena itu, itu adalah masalah kecil - kami menyebarkan solusi pada AWS tanpa partisipasi administrator sistem, yang selalu memiliki sesuatu untuk dilakukan. <br>  Dan untuk mempercepat semuanya, kami mengotomatiskan skrip penerapan ke AWS CloudFormation sebanyak mungkin, memungkinkan Anda untuk menggunakan satu tombol langsung dari VS.  Akibatnya, file dengan 200 baris kode memungkinkan Anda untuk meluncurkan solusi yang sudah jadi, meskipun sintaks CloudFormation dapat mengejutkan karena kebiasaan. <br><br><h2>  Total </h2><br>  Serverless bukan obat mujarab.  Tetapi itu akan sangat memudahkan kehidupan dalam situasi dengan tiga batasan: "sumber daya terbatas - waktu singkat - sedikit uang." <br><br>  <b>Karakteristik aplikasi yang cocok untuk Serverless</b> <br><br><ul><li>  tanpa proses yang berjalan lama.  API batas keras Gateway - 29 detik, batas keras lambda - 15 menit; </li><li>  dijelaskan oleh arsitektur Event-Driven; </li><li>  dipecah menjadi komponen yang digabungkan secara longgar berdasarkan jenis SOA; </li><li>  tidak memerlukan banyak pekerjaan dengan kondisinya; </li><li>  ditulis dalam .NET Core.  Untuk bekerja dengan .NET Framework, Anda masih membutuhkan setidaknya Docker dengan runtime yang sesuai. </li></ul><br>  <b>Manfaat dari Pendekatan Tanpa Server</b> <br><br><ul><li>  mengurangi biaya infrastruktur; </li><li>  mengurangi biaya pengiriman solusi; </li><li>  Skalabilitas otomatis </li><li>  pengembangan di garis depan kemajuan teknologi. </li></ul><br>  <b>Kerugian, pada contoh nyata</b> <br><br><ul><li>  Pelacakan dan pendataan terdistribusi - sebagian diselesaikan melalui AWS X-Ray dan AWS CloudWatch; </li><li>  debugging tidak nyaman; </li><li>  Mulai Dingin tanpa adanya beban; </li><li>  Antarmuka pengguna-permusuhan AWS adalah masalah universal :) </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id448974/">https://habr.com/ru/post/id448974/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id448962/index.html">Efektivitas saluran pemasaran AARRR</a></li>
<li><a href="../id448964/index.html">Pemanggang memberi pengguna lebih banyak hak</a></li>
<li><a href="../id448966/index.html">Aplikasi Android dalam memori. Laporan Pengoptimalan untuk Yandex.Luncher</a></li>
<li><a href="../id448968/index.html">PHP asinkron. Mengapa</a></li>
<li><a href="../id448970/index.html">Otentikasi dua faktor untuk SSH</a></li>
<li><a href="../id448976/index.html">Peristiwa musim semi Gamedev di HSE</a></li>
<li><a href="../id448980/index.html">Makan siang pertama kami bersama: mengapa dan bagaimana kami menghabiskan hari ujian kami</a></li>
<li><a href="../id448982/index.html">CMS tanpa kepala. Kenapa aku menulis milikku</a></li>
<li><a href="../id448986/index.html">Rekayasa balik 3D dengan pemindaian 3D</a></li>
<li><a href="../id448988/index.html">Kingston SSD menjadi lebih luas, mempertahankan biaya yang hampir sama - kami memenuhi seri A400-R</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>