<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🗄️ 🐚 🚣🏾 Deep Learning vs senso comum: desenvolvendo um bot de bate-papo ✋🏾 🧣 💓</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quanto mais usuários do seu serviço, maior a probabilidade de que eles precisem de ajuda. O chat do suporte técnico é uma solução óbvia, mas bastante ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Deep Learning vs senso comum: desenvolvendo um bot de bate-papo</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/455652/">  Quanto mais usuários do seu serviço, maior a probabilidade de que eles precisem de ajuda.  O chat do suporte técnico é uma solução óbvia, mas bastante cara.  Mas se você usar a tecnologia de aprendizado de máquina, poderá economizar algum dinheiro. <br><br>  O bot agora pode responder a perguntas simples.  Além disso, o chatbot pode ser ensinado a determinar as intenções do usuário e capturar o contexto para que ele possa resolver a maioria dos problemas dos usuários sem intervenção humana.  Como fazer isso, Vladislav Blinov e Valery Baranova, desenvolvedores do popular assistente Oleg, ajudarão a descobrir. <br><br><img src="https://habrastorage.org/webt/rr/do/kw/rrdokweqzrtdqiogus2vahosksg.png"><br><br>  Passando de métodos simples para métodos mais complicados na tarefa de desenvolver um bot de bate-papo, analisaremos questões práticas de implementação e veremos qual ganho de qualidade pode ser obtido e quanto custará. <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/eL3dkh-WaSU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <strong>Vladislav Blinov</strong> é desenvolvedor sênior de sistemas de diálogo em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Tinkoff</a> , geralmente lança abreviações: ML, PNL, DL, etc.  Além disso, a escola de pós-graduação examina a modelagem do humor por meio de aprendizado de máquina e redes neurais. <br><br>  <strong>Valeria Baranova</strong> escreve coisas legais no campo da PNL em Python há mais de 5 anos.  Agora, na equipe de sistemas interativos, Tinkoff faz bots de bate-papo e ministra um curso de Machine Learning para os alunos.  Ele também está envolvido em pesquisas no campo do humor computacional, ou seja, ele ensina a IA a entender piadas e a criar novas - Valeria e Vladislav <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">falarão</a> sobre isso na UseData Conf. <br><br>  Os serviços do Tinkoff Bank são utilizados por milhões de pessoas.  Para fornecer suporte 24 horas para um número tão grande de usuários, é necessária uma grande equipe, o que leva a um alto custo de serviço.  Parece lógico que as perguntas populares dos usuários possam ser respondidas automaticamente usando o bot de bate-papo. <br><br><h2>  Intenção ou intenção do usuário </h2><br>  A primeira coisa que um chatbot precisa é entender o <strong>que o usuário deseja</strong> .  Essa tarefa é chamada de classificação de intenções ou intenções.  Além disso, todos os modelos e abordagens serão considerados na estrutura desta tarefa. <br><br>  Vejamos um exemplo de classificação de intenções.  Se você escrever: “Transferir uma centena de Lera”, o bot de bate-papo Oleg entenderá que essa é a intenção de uma transferência de dinheiro, ou seja, a intenção do usuário de transferir dinheiro.  Ou melhor, que Lera precisa transferir a quantidade de 100 rublos. <br><br>  Iremos comparar métodos e testar a qualidade de seu trabalho em uma amostra de teste, que consiste em diálogos reais com os usuários.  Nossa amostra contém mais de 30.000 exemplos marcados e 170 intenções, por exemplo: ir ao cinema, procurar restaurantes, abrir ou fechar um depósito, etc.  Oleg também tem muito a sua opinião e pode apenas conversar com você. <br><br><h2>  Classificação do dicionário </h2><br>  A coisa mais simples que pode ser feita na tarefa de classificar intenções é <strong>usar um dicionário</strong> .  Por exemplo, se a palavra "traduzir" aparecer na frase de um usuário, considere que uma transferência de dinheiro deve ser feita. <br><br>  Vejamos a qualidade de uma abordagem tão simples. <br><div class="scrollable-table"><table><tbody><tr><td></td><td>  precisão </td><td>  recordar </td><td>  pontuação f1 </td></tr><tr><td>  Transferência de dinheiro </td><td>  0,88 </td><td>  0,23 </td><td>  0,36 </td></tr><tr><td>  O resto </td><td>  0,97 </td><td>  0,99 </td><td>  0,98 </td></tr></tbody></table></div>  Se o classificador simplesmente definir a intenção do usuário como "transferência de dinheiro" pela palavra "traduzir", a qualidade já será bastante alta.  Precisão - 88%, enquanto a integridade é baixa, igual a apenas 23%.  Isso é compreensível: a palavra "traduzir" não descreve todas as possibilidades de dizer "transferir dinheiro para alguém". <br><br>  No entanto, essa abordagem tem vantagens: <br><br><ul><li>  Nenhuma amostragem rotulada é necessária (se você não estuda o modelo, a amostragem não é necessária). </li><li>  Você pode obter alta precisão se compilar bem os dicionários (mas isso levará tempo e recursos). </li></ul><br>  No entanto, é provável que a completude de uma solução seja baixa, pois todas as variações de qualquer classe são difíceis de descrever. <br><br>  Considere um contra-exemplo.  Se, além da intenção de transferência de dinheiro, "transferência" também pode incluir a segunda intenção - "transferência para o operador".  Quando adicionamos uma nova intenção de tradução ao operador, obtemos resultados diferentes. <br><div class="scrollable-table"><table><tbody><tr><td></td><td>  precisão </td><td>  recordar </td><td>  pontuação f1 </td></tr><tr><td>  Transferência de dinheiro </td><td>  0,70 </td><td>  0,23 </td><td>  0,34 </td></tr><tr><td>  O resto </td><td>  0,97 </td><td>  0,99 </td><td>  0,98 </td></tr></tbody></table></div>  A precisão cai 18 pontos, enquanto, é claro, a integridade não cresce.  Isso mostra que é necessária uma abordagem mais avançada. <br><br><h2>  Análise de texto </h2><br>  Antes de usar o aprendizado de máquina, você precisa entender como apresentar o texto como um vetor.  Uma das abordagens mais fáceis é <strong>usar um vetor tf-idf</strong> . <br><br>  O vetor tf-idf leva em consideração a ocorrência de cada palavra na frase do usuário e leva em consideração a ocorrência total de palavras na coleção.  Palavras frequentemente encontradas em textos diferentes têm menos peso nessa representação vetorial. <br><br>  Vejamos a qualidade do modelo linear nas representações tf-idf (no nosso caso, regressão logística). <br><div class="scrollable-table"><table><tbody><tr><td></td><td>  precisão </td><td>  recordar </td><td>  pontuação f1 </td></tr><tr><td>  Transferência de dinheiro </td><td>  0,74 </td><td>  0,86 </td><td>  0,80 </td></tr><tr><td>  O resto </td><td>  0,99 </td><td>  0,99 </td><td>  0,99 </td></tr></tbody></table></div>  Como resultado, <strong>a completude aumentou</strong> acentuadamente e a precisão permaneceu proporcional ao uso do dicionário, a medida f1 (a média harmônica ponderada entre precisão e completude) também aumentou.  Ou seja, o próprio modelo já entende quais palavras são importantes para qual intenção - você não precisa inventar nada. <br><br><h3>  Visualização de dados </h3><br>  A visualização de dados ajuda a entender como as intenções parecem, o quão bem elas são agrupadas no espaço.  Porém, como não podemos visualizar diretamente as representações tf-idf devido à grande dimensão, usaremos <strong>o método de compressão de dimensão - t-SNE</strong> . <br><br><img src="https://habrastorage.org/webt/zx/gh/dc/zxghdc_rwrmjjqojzp9b5lao6tq.png"><br><br>  A principal diferença entre esse método e o PCA é que, quando transferida para o espaço bidimensional, a <strong>distância relativa entre os objetos é preservada</strong> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/1p/8w/xr/1p8wxr2sc5guuqktq4u7aqe88jk.png" width="400"></div><br>  <em>t-SNE no tf-idf (10 principais intenções), pontuação F1 0,92</em> <br><br>  As 10 principais intenções por ocorrência em nossa coleção são apresentadas acima.  Existem pontos verdes que não pertencem a nenhuma intenção e 10 clusters marcados com cores diferentes são intenções diferentes.  Pode-se ver que alguns deles estão muito bem agrupados.  A <strong>medida f1</strong> ponderada <strong>é de 0,92</strong> - isso é bastante, você já pode trabalhar com ela. <br><br>  Portanto, com um classificador linear sobre tf-idf: <br><br><ul><li>  completude muito maior do que usar um dicionário, com precisão comparável; </li><li>  não há necessidade de pensar quais palavras correspondem a qual intenção. </li></ul><br>  Mas também há desvantagens: <br><br><ul><li>  vocabulário limitado, você pode obter peso apenas para as palavras presentes na amostra de treinamento; </li><li>  a reformulação não é levada em consideração; </li><li>  a ordem na qual as palavras ocorrem no texto não é levada em consideração. </li></ul><br><h2>  Reformulação </h2><br>  Vamos considerar o problema de reformulação em mais detalhes. <br><br>  Os vetores tf-idf podem ser próximos apenas para textos que se cruzam em palavras.  A proximidade entre os vetores pode ser calculada através do cosseno do ângulo entre eles.  A proximidade do cosseno na representação vetorial tf-idf é calculada para exemplos específicos. <br><br><img src="https://habrastorage.org/webt/gf/7c/eb/gf7ceblapupg3xysxiyxgcjwo3o.jpeg"><br><br>  Essas não são frases muito próximas para a representação vetorial tf-idf, embora para nós seja a mesma intenção e a mesma classe. <br><br>  O que pode ser feito sobre isso?  Por exemplo, em vez de um número, você pode representar uma palavra como um vetor inteiro - isso é chamado de "incorporação de palavras". <br><br><img src="https://habrastorage.org/webt/rl/9n/xm/rl9nxmdp8sr_q7fwo7iokyj8hwy.png"><br><br>  Um dos modelos mais populares para resolver esse problema foi proposto em 2013.  É chamado <strong>word2vec</strong> e tem sido amplamente utilizado desde então. <br><br>  Uma das maneiras de aprender o Word2vec funciona aproximadamente da seguinte maneira: pegamos o texto, pegamos alguma palavra do contexto e a jogamos fora, depois pegamos outra palavra aleatória do contexto e apresentamos as duas palavras como vetores quentes.  Um vetor quente é um vetor de acordo com a dimensão do dicionário, onde apenas a coordenada correspondente ao índice da palavra no dicionário tem o valor 1, o restante 0. <br><br><img src="https://habrastorage.org/webt/ow/ta/vc/owtavcymm3e4a1k28xltaxdguds.png"><br><br>  Em seguida, treinamos uma rede neural simples de camada única sem ativação na camada interna para prever a próxima palavra no contexto, ou seja, para prever a palavra "à noite" usando a palavra "homem-foguete".  Na saída, obtemos a distribuição de probabilidade para todas as palavras do dicionário como segue.  Como sabemos qual era realmente a palavra, podemos calcular o erro, atualizar os pesos etc. <br><br><img src="https://habrastorage.org/webt/x6/m-/_e/x6m-_exb0v8m5mmge-q-mr9ez4a.png"><br><br>  Os pesos atualizados obtidos como resultado do treinamento em nossa amostra são a palavra incorporação. <br><br>  A vantagem de usar incorporação em vez de número é, primeiro, <strong>que o contexto é levado em consideração</strong> .  Um exemplo popular: Trump e Putin estão próximos no word2vec porque ambos são presidentes e geralmente são usados ​​juntos em textos. <br><br>  Para as palavras encontradas na amostra de treinamento, basta pegar a matriz de incorporação, pegar seu vetor pelo índice da palavra e obter incorporação. <br><br>  Parece que está tudo bem, exceto que algumas palavras em sua matriz podem não estar, porque o modelo não as viu durante o treinamento.  Para lidar com o problema de palavras desconhecidas (fora do vocabulário), em 2014, eles apresentaram uma modificação do word2vec - <strong>fasttext</strong> . <br><br>  O texto rápido funciona da seguinte maneira: se a palavra não estiver no dicionário, ela será dividida em n-gramas simbólicos, pois cada incorporação de n-grama é obtida da matriz de incorporações de n-gramas (que são treinadas como word2vec), as médias são incorporadas e um vetor é obtido. <br><br><img src="https://habrastorage.org/webt/sz/ws/mx/szwsmx8vblcqrbumxrjbzz7nzvo.png"><br><br>  No total, obtemos vetores para palavras que não estão no nosso dicionário.  Agora podemos <strong>calcular a semelhança mesmo para palavras desconhecidas</strong> .  E, o que é mais importante, existem modelos treinados para russo, inglês e chinês, por exemplo, o Facebook e o projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DeepPavlov</a> , para que você possa incluí-lo rapidamente em seu pipeline. <br><br>  <strong>Mas as desvantagens permanecem:</strong> <br><br><ul><li>  O modelo não é usado para todo o vetor de texto.  Para obter um vetor de texto comum, é necessário pensar em algo: média ou média com multiplicação por pesos idf, e em tarefas diferentes isso pode funcionar de maneiras diferentes. </li><li>  O vetor para uma palavra ainda é um, independentemente do contexto.  O Word2vec treina um vetor de palavra para qualquer contexto em que a palavra ocorre.  Para palavras com vários valores (como, por exemplo, idioma), haverá um mesmo vetor. </li></ul><br><img src="https://habrastorage.org/webt/ob/i3/ap/obi3apyrva_kjktfpfjh7farkx8.png"><br><br>  De fato, a proximidade do cosseno em nosso exemplo em texto rápido é maior que a proximidade do cosseno em tf-idf, mesmo que essas frases tenham apenas "em" em comum. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2p/lz/hq/2plzhqw0n1-8m4vrc71_zwokjla.png" width="400"></div><br>  <em>t-SNE em texto rápido (10 principais intenções), pontuação F1: 0,86</em> <br><br>  No entanto, ao visualizar resultados de texto rápido na decomposição de t-SNE, os clusters de intenção se destacam muito piores do que para tf-idf.  A medida F1 aqui é 0,86 em vez de 0,92. <br><br>  Realizamos um experimento: combinados vetores tf-idf e fasttext.  A qualidade é absolutamente a mesma que quando se usa apenas tf-idf.  Isso não é verdade para todas as tarefas, há problemas em que o tf-idf e o fasttext combinados funcionam melhor do que apenas o tf-idf, ou onde o fasttext funciona melhor que o tf-idf.  Você precisa experimentar e tentar. <br><br>  Vamos tentar aumentar o número de intenções (lembre-se de que temos 170).  Abaixo estão os clusters para as 30 principais intenções nos vetores tf-idf. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/2k/a3/q9/2ka3q9iuylym9_cqdizf4dbtbfu.png" width="400"></div><br>  <em>t-SNE em tf-idf (30 principais intenções), pontuação F1 0, 85 (em 10 era 0,92)</em> <br><br>  A qualidade cai em 7 pontos e agora não vemos uma estrutura de cluster pronunciada. <br><br>  Vejamos exemplos de textos que começaram a ficar confusos, porque foram adicionadas mais intenções que se cruzam semanticamente e em palavras. <br><br>  Por exemplo: "E se você abrir um depósito, quais são os juros sobre ele?"  e "E eu quero abrir uma contribuição em 7%".  Frases muito semelhantes, mas essas são intenções diferentes.  No primeiro caso, uma pessoa deseja conhecer as condições dos depósitos e, no segundo caso, para abrir um depósito.  Para separar esses textos em diferentes classes, precisamos de algo mais complexo - <strong>aprendizado profundo</strong> . <br><br><h2>  Modelo de linguagem </h2><br>  Queremos obter um vetor de texto e, em particular, um vetor de uma palavra, que dependerá do contexto de uso.  A maneira padrão de obter esse vetor é <strong>usar incorporações do modelo de linguagem</strong> . <br><br>  O modelo de linguagem resolve o problema de modelagem de linguagem.  E qual é essa tarefa?  Que haja uma sequência de palavras, por exemplo: “Eu só falarei na presença de minha própria ...”, e estamos tentando prever a próxima palavra na sequência.  O modelo de linguagem fornece contexto para incorporação.  Tendo obtido incorporações e vetores contextuais para cada palavra, é possível prever a probabilidade da próxima palavra. <br><br>  Há um vetor de dimensão de dicionário e cada palavra recebe a probabilidade de ser a próxima.  Mais uma vez sabemos o que era realmente a palavra, consideramos um erro e treinamos o modelo. <br><br><img src="https://habrastorage.org/webt/1i/yd/f1/1iydf1xm3j97nwwuys6jmrq1ate.jpeg"><br><br>  Existem alguns modelos de linguagem, houve um boom no ano passado?  e muitas arquiteturas diferentes foram propostas.  Um deles é o <strong>ELMo</strong> . <br><br><h3>  ELMo </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A idéia do modelo ELMo é</a> criar primeiro uma palavra simbólica incorporada para cada palavra no texto e, em seguida, aplicar uma <strong>rede LSTM</strong> para elas, de modo que sejam incorporados os incorporamentos que levem em conta o contexto em que a palavra ocorre. <br><br>  Vamos examinar como a incorporação simbólica é obtida: dividimos a palavra em símbolos, aplicamos uma camada de incorporação para cada símbolo e obtemos uma matriz de incorporação.  Quando se trata apenas de símbolos, a dimensão dessa matriz é pequena.  Em seguida, convolução unidimensional é aplicada à matriz de incorporação, como geralmente é feita na PNL, com o agrupamento máximo no final, um vetor é obtido.  Uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rede de rodovias de</a> duas camadas é aplicada a esse vetor, que calcula o <strong>vetor geral de uma palavra</strong> . <br><br><img src="https://habrastorage.org/webt/in/zp/zw/inzpzwr-5-in2jiuszhjrkimczs.png"><br><br>  Além disso, o modelo criará algum tipo de hipótese de incorporação, mesmo para uma palavra que não foi encontrada no conjunto de treinamento. <br><br>  Depois de recebermos combinações simbólicas para cada palavra, aplicamos uma rede BiLSTM de duas camadas a elas. <br><br><img src="https://habrastorage.org/webt/vi/em/mb/viemmbyrjg0lboyuiq8bfbrgewy.png"><br><br>  Depois de aplicar uma rede BiLSTM de duas camadas, geralmente os estados ocultos da última camada são normalmente obtidos, e acredita-se que isso seja incorporação contextual.  Mas o ELMo tem dois recursos: <br><br><ul><li>  <strong>Conexão residual</strong> entre a entrada da primeira camada LSTM e sua saída.  A entrada LSTM é adicionada à saída para evitar o problema de gradientes desbotados. </li><li>  Os autores do ELMo propõem a combinação de incorporação simbólica para cada palavra, a saída da primeira camada LSTM e a saída da segunda camada LSTM com alguns pesos selecionados para cada tarefa.  Isso é necessário para levar em consideração os recursos de baixo nível e os de nível superior que fornecem a primeira e a segunda camadas do LSTM. </li></ul><br>  Em nosso problema, usamos uma média simples dessas três incorporações e, assim, obtivemos incorporação contextual para cada palavra. <br><br><img src="https://habrastorage.org/webt/8y/tl/pa/8ytlpa3lia0oxj461muadegcdyq.png"><br><br>  O modelo de linguagem fornece os seguintes benefícios: <br><br><ul><li>  O vetor de uma palavra depende do contexto em que a palavra é usada.  Isto é, por exemplo, para a palavra "linguagem" no significado da parte do corpo e do termo linguístico, obtemos vetores diferentes. </li><li>  Como no caso do word2vec e fasttext, existem muitos modelos treinados, por exemplo, do projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DeepPavlov</a> .  Você pode pegar o modelo final e tentar aplicar em sua tarefa. </li><li>  Você não precisa mais pensar em como calcular a média dos vetores de palavras.  O modelo ELMo produz imediatamente um vetor de todo o texto. </li><li>  Você pode treinar novamente o modelo de idioma para sua tarefa; existem várias maneiras para isso, por exemplo, ULMFiT. </li></ul><br>  O único sinal de menos permanece - o <strong>modelo de linguagem não garante</strong> que os textos que pertencem à mesma classe, ou seja, com uma intenção, estejam próximos no espaço vetorial. <br><br><img src="https://habrastorage.org/webt/hv/09/qf/hv09qfkirx8mbcfl8rvbsd11aiu.png"><br><br>  No nosso exemplo de restaurante, os valores de cosseno de acordo com o modelo ELMo realmente se tornaram mais altos. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/m8/d0/ax/m8d0axjr1fysz33kaoi7ydg4kga.png" width="400"></div><br>  <em>t-SNE no ELMo (10 principais intenções), pontuação de F1 0,93 (0,92 por tf-idf)</em> <br><br>  Clusters com as 10 principais intenções também são mais pronunciados.  Na figura acima, todos os 10 clusters são claramente visíveis, enquanto a precisão aumentou um pouco. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ux/fx/ws/uxfxws0f9y1bf-zdpjynmle3xqk.png" width="400"></div><br>  <em>t-SNE no ELMo (30 principais intenções) F1 score 0.86 (0.85 by tf-idf)</em> <br><br>  Para as 30 principais intenções, a estrutura do cluster ainda é preservada e também há um aumento na qualidade em um ponto. <br><br>  Mas, nesse modelo, não há garantia de que as propostas "E se você abrir um depósito, quais são os juros sobre elas?"  e "E eu quero abrir uma contribuição a 7%" estará longe um do outro, embora eles se encontrem em classes diferentes.  Com o ELMo, simplesmente aprendemos o modelo de linguagem e, se os textos semanticamente semelhantes, eles estarão próximos.  <strong>O ELMo não sabe nada sobre nossas classes</strong> , mas você pode reunir vetores de texto com a mesma intenção no espaço usando rótulos de classe. <br><br><h3>  Rede siamesa </h3><br>  Leve sua arquitetura de rede neural favorita para vetorização de texto e dois exemplos de intenções.  Para cada um dos exemplos, recebemos casamentos e depois calculamos a distância do cosseno entre eles. <br><br><img src="https://habrastorage.org/webt/ah/sw/ha/ahswhaivfdofbehikcsi7qvhntk.jpeg"><br><br>  A distância do cosseno é igual a um menos a proximidade do cosseno que encontramos anteriormente. <br><br>  Essa abordagem é chamada de <strong>rede siamesa</strong> . <br><br>  Queremos textos da mesma classe, por exemplo, "faça uma transferência" e "jogue dinheiro", próximos do espaço.  Ou seja, a distância do cosseno entre seus vetores deve ser a menor possível, idealmente zero.  E textos relacionados a diferentes intenções devem estar o mais afastados possível. <br><br>  Mas, na prática, esse método de treinamento não funciona tão bem, porque objetos de classes diferentes não ficam suficientemente distantes um do outro.  A função de perda chamada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"perda de trigêmeos"</a> funciona muito melhor.  Ele usa triplos objetos chamados trigêmeos. <br><br>  A ilustração mostra um trio: um objeto âncora em um círculo azul, um objeto positivo em verde e um objeto negativo em um círculo vermelho.  O objeto negativo e a âncora estão em classes diferentes, e o positivo e a âncora estão em uma. <br><br><img src="https://habrastorage.org/webt/qw/38/lz/qw38lz9wpgcphm8w2ic55aqbhea.png"><br><br>  Queremos garantir que, após o treinamento, o objeto positivo esteja mais próximo da âncora do que o negativo.  Para isso, consideramos a distância do cosseno entre os pares de objetos e inserimos o hiperparâmetro - "margem" - a distância que esperamos estar entre os objetos positivos e negativos. <br><br><img src="https://habrastorage.org/webt/lv/ib/b8/lvibb8qcivpp0evrqxgnyezlo0a.png"><br><br>  A função de perda é assim: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>t</mi><mi>r</mi><mi>i</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>t</mi><mi>o</mi><msub><mtext>&amp;#xA0;</mtext><mi>p</mi></msub><mi>e</mi><mi>r</mi><mi>d</mi><mi>a</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>m</mi><mo>+</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mo>,</mo><mi>P</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mo>,</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>.</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="61.356ex" height="2.78ex" viewBox="0 -832 26417 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-72" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-69" x="813" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-70" x="1158" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-6C" x="1662" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-65" x="1960" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-74" x="2427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-6F" x="2788" y="0"></use><g transform="translate(3274,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-70" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-65" x="3980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-72" x="4446" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-64" x="4898" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-61" x="5421" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-3D" x="6228" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-6D" x="7535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-61" x="8413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-78" x="8943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-5B" x="9515" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-30" x="9794" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-2C" x="10294" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-6D" x="10739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-61" x="11618" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-72" x="12147" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-67" x="12599" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-65" x="13079" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-6D" x="13546" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-2B" x="14646" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-64" x="15647" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-69" x="16171" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-73" x="16516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-74" x="16986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-28" x="17347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-41" x="17737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-2C" x="18487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-50" x="18932" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-29" x="19684" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-2212" x="20296" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-64" x="21296" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-69" x="21820" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-73" x="22165" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-74" x="22635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-28" x="22996" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-41" x="23386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-2C" x="24136" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMATHI-4E" x="24581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-29" x="25470" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-5D" x="25859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/oleg-bunin/blog/455652/&amp;usg=ALkJrhjfqqiopDyzLR2ooBzJ8Z3V5PjHFg#MJMAIN-2E" x="26138" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>t</mi><mi>r</mi><mi>i</mi><mi>p</mi><mi>l</mi><mi>e</mi><mi>t</mi><mi>o</mi><msub><mtext>&nbsp;</mtext><mi>p</mi></msub><mi>e</mi><mi>r</mi><mi>d</mi><mi>a</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mi>m</mi><mi>a</mi><mi>r</mi><mi>g</mi><mi>e</mi><mi>m</mi><mo>+</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>A</mi><mo>,</mo><mi>P</mi><mo stretchy="false">)</mo><mo>−</mo><mi>d</mi><mi>i</mi><mi>s</mi><mi>t</mi><mo stretchy="false">(</mo><mi>A</mi><mo>,</mo><mi>N</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>.</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> tripleto \ _perda = \ max [0, margem + dist (A, P) - dist (A, N)]. </script></p><br>  Em outras palavras, durante o treinamento, conseguimos que o objeto positivo esteja mais próximo da âncora do que o negativo, pelo menos margem.  Se a função de perda for zero, ela funcionará e terminaremos o treinamento, caso contrário, continuamos a minimizar a função objetivo. <br><br>  Depois de treinarmos o modelo, ainda não obtivemos um classificador, é apenas um método para obter esses embeddings que objetos que estão em uma intenção provavelmente têm vetores próximos. <br><br>  Quando obtivemos o modelo, podemos usar um método de classificação diferente sobre os casamentos.  <strong>O KNN é um</strong> bom ajuste, pois já conseguimos que os embeddings tenham uma estrutura de cluster distinta. <br><br>  Lembre-se de como o kNN funciona para textos: pegue um elemento do texto, incorpore-o, traduza-o em espaço vetorial e veja quem é seu vizinho.  Entre os vizinhos, consideramos a classe mais frequente e concluímos que o novo objeto pertence a essa classe. <br><br>  A dimensão dos casamentos que usamos é 300 e, na amostra de treinamento, existem cerca de 500.000 objetos.  Os métodos padrão para encontrar os vizinhos mais próximos não nos servem em termos de desempenho.  Utilizamos o método <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">HNSW</a> - <strong>Mundo Pequeno Navegável Hierárquico</strong> . <br><br>  Navegável Small World é um gráfico conectado no qual existem poucas arestas entre vértices que estão a uma grande distância e muitas arestas entre vértices próximos.  No nosso caso, o comprimento da aresta será determinado pela distância do cosseno, ou seja,          ,        ,      . <br><br>      ,    Hierarchical.        ,  ,       ,    .            . <br><br>       , ,         ,     ,      . <br><br>     ,     ,       , ,  ,       .   ,    ,         ,     <strong>  —  0,95-0,99</strong> ,    . <br><br>  ,       ,     ,          , <strong>   </strong> .              . <br><br>  ,      .    ,      .          . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/db/2v/yx/db2vyx8eoubfaytjge3imauvgra.png" width="400"></div><br> <em>t-SNE  siamese (-10 ), F1 score 0,95 (0,93  ELMo)</em> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rz/ib/op/rzibopijmd5mqginmihafxfiivy.png" width="400"></div><br> <em>t-SNE  siamese (-30 ), F1 score 0,87 (0,86  ELMo)</em> <br><br>  10             ELMo,  30 —  ,       . <br><br><h2>  Sumário </h2><br> <b>      ,     </b> , , 2-5,          .    ,     ,        ,     20-30  .      ,   . <br><br> <b>  ,      ,     ,       tf-idf</b> .    ,      ,    ,       . <br><br> <b>   ,    word2vec  fasttext.</b>   ,   ,         .        ,      ,       ,     . <br><br>   ,  ,   ELMo.       , , ,      ,       ,      . <b>   ELMo,        </b> ,           . <br><br>             ,    -  .       .      ,              .  ,   ,           .  ,     ,     ..    ,      . <br><div class="scrollable-table"><table><tbody><tr><td> F1-score </td><td> ~2-5  <br>   </td><td> ~10  <br>   </td><td> ~30  <br>   </td></tr><tr><td> ,  </td><td>  MVP </td><td>    </td><td>    </td></tr><tr><td> ML + tf-idf </td><td>  </td><td> 0,92 </td><td> 0,85 </td></tr><tr><td> ML + fasttext </td><td> ? </td><td> 0,86 </td><td> 0,82 </td></tr><tr><td> ELMo </td><td> ?? </td><td> 0,93 </td><td> 0,86 </td></tr><tr><td> siamese </td><td> ??? </td><td> 0,95 </td><td> 0,87 </td></tr></tbody></table></div> <b> :</b> <br><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">rusvectores.org/ru/models</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">docs.deeppavlov.ai/en/master/intro/pretrained_vectors.html</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">www.mihaileric.com/posts/deep-contextualized-word-representations-elmo</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">omoindrot.github.io/triplet-loss</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">towardsdatascience.com/review-highway-networks-gating-function-to-highway-image-classification-5a33833797b5</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">habr.com/ru/company/mailru/blog/338360</a> </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://jalammar.github.io/illustrated-bert</a> </li></ul><br><blockquote>    — «Deep Learning vs common sense» —       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">UseData Conf</a> .  ,    -   ,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>  18        ,      ,          . <br><br>        ,        ,    ,         ,   16   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">UseData Conf</a> . </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt455652/">https://habr.com/ru/post/pt455652/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt455642/index.html">A arquitetura do serviço de fila de mensagens distribuídas no Yandex.Cloud</a></li>
<li><a href="../pt455644/index.html">Usamos dados na prática</a></li>
<li><a href="../pt455646/index.html">Semana de Segurança 24: backdoors de fábrica em smartphones Android</a></li>
<li><a href="../pt455648/index.html">Ciclo de vida ML</a></li>
<li><a href="../pt455650/index.html">Como treinamos uma rede neural para classificar parafusos</a></li>
<li><a href="../pt455658/index.html">Lendário Intel Core i7-2600K: testando Sandy Bridge em 2019 (parte 3)</a></li>
<li><a href="../pt455662/index.html">Grande display mecânico com mecanismo de came como decodificador</a></li>
<li><a href="../pt455666/index.html">Construindo vendas de saída em uma empresa de serviços de TI</a></li>
<li><a href="../pt455668/index.html">Escrevemos em FPGA sem HDL. Comparação de ferramentas de desenvolvimento de alto nível</a></li>
<li><a href="../pt455670/index.html">Como as impressoras 3D imprimem ossos, vasos sanguíneos e órgãos</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>