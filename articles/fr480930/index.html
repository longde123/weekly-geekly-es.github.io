<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üóùÔ∏è üèæ ‚è∏Ô∏è Tapez tout ‚ôÇÔ∏è ‚õπüèø ü§∑üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour √† tous! 


 Nous avons d√©j√† un article sur le d√©veloppement de la frappe dans Ostrovok.ru . Il explique pourquoi nous passons de pyContracts √†...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tapez tout</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ostrovok/blog/480930/"><p>  Bonjour √† tous! </p><br><p>  Nous avons d√©j√† <a href="https://habr.com/ru/company/ostrovok/blog/443470/">un article</a> sur le d√©veloppement de la frappe dans <a href="https://www.habr.com/%3Futm_source%3Dhabr%26utm_medium%3Dpr%26utm_campaign%3Dbogdanova_dec19%26utm_content%3Darticle">Ostrovok.ru</a> .  Il explique pourquoi nous passons de pyContracts √† typeguard, pourquoi nous passons √† typeguard et ce que nous nous retrouvons.  Et aujourd'hui, je vais vous en dire plus sur la fa√ßon dont cette transition se produit. </p><br><img src="https://habrastorage.org/webt/xk/gm/wn/xkgmwnrl0mygmpduhrg879p-nhe.jpeg"><a name="habracut"></a><br><p>  Une d√©claration de fonction avec pyContracts ressemble g√©n√©ralement √† ceci: </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> contracts <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> new_contract <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime @new_contract <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">User</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> User <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isinstance(x, User) @new_contract <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dt_datetime</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isinstance(x, datetime.datetime) @contract <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(user_list, amount, dt=None)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" :type user_list: list(User) :type amount: int|float :type dt: dt_datetime|None :rtype: bool """</span></span> ‚Ä¶</code> </pre> <br><p>  Ceci est un exemple abstrait, car je n'ai pas trouv√© dans notre projet une d√©finition d'une fonction qui soit courte et significative en termes de nombre de cas pour la v√©rification de type.  En r√®gle g√©n√©rale, les d√©finitions de pyContracts sont stock√©es dans des fichiers qui ne contiennent aucune autre logique.  Notez qu'ici, User est une classe d'utilisateurs sp√©cifique et qu'elle n'est pas import√©e directement. </p><br><p>  Et voici le r√©sultat souhait√© avec typeguard: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> typechecked <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> typechecked <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> typing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> List, Optional, Union <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> models <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> User <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datetime @typechecked <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(user_list: List[User], amount: Union[int, float], dt: Optional[datetime.datetime]=None)</span></span></span><span class="hljs-function"> -&gt; bool:</span></span> ...</code> </pre> <br><p>  En g√©n√©ral, il y a tellement de fonctions et de m√©thodes avec v√©rification de type dans le projet que si vous les empilez dans une pile, vous pouvez atteindre la lune.  Donc, les traduire manuellement de pyContracts en typeguard n'est tout simplement pas possible (j'ai essay√©!).  J'ai donc d√©cid√© d'√©crire un script. </p><br><p>  Le script est divis√© en deux parties: l'une met en cache les importations de nouveaux contrats et la seconde traite du refactoring de code. </p><br><p>  Je veux noter que ni l'un ni l'autre script ne pr√©tend √™tre universel.  Nous n'avions pas pour objectif d'√©crire un outil pour r√©soudre tous les cas requis.  Par cons√©quent, j'ai souvent omis le traitement automatique de certains cas sp√©ciaux, s'ils sont rarement trouv√©s dans le projet, il est plus rapide de le r√©parer √† la main.  Par exemple, le script pour g√©n√©rer la cartographie des contrats et des importations a collect√© 90% des valeurs, les 10% restants √©tant des cartographies artisanales. </p><br><p>  La logique du script pour g√©n√©rer le mappage: </p><br><p>  √âtape 1. Parcourez tous les fichiers du projet, lisez-les.  Pour chaque fichier: </p><br><ul><li>  si la sous-cha√Æne "@new_contract" n'est pas pr√©sente, sautez ce fichier, </li><li>  le cas √©ch√©ant, divisez le fichier par la ligne "@new_contract".  Pour chaque article: <br>  - analyse pour la d√©finition et l'importation, <br>  - en cas de succ√®s, √©crivez dans le fichier de r√©ussite, <br>  - sinon, √©crivez dans le fichier d'erreur. </li></ul><br><p>  √âtape 2. Traiter manuellement les erreurs </p><br><p>  Maintenant que nous avons les noms de tous les types que pyContracts utilise (ils ont √©t√© d√©finis avec le d√©corateur new_contract), et que nous avons toutes les importations n√©cessaires, nous pouvons √©crire du code pour le refactoring.  Pendant que je traduisais manuellement de pyContracts en typeguard, j'ai r√©alis√© ce dont j'avais besoin √† partir du script: </p><br><ol><li>  Il s'agit d'une commande qui prend un nom de module comme argument (plusieurs peuvent √™tre utilis√©s), dans laquelle la syntaxe des annotations de fonction doit √™tre remplac√©e. </li><li>  Parcourez tous les fichiers du module, lisez-les.  Pour chaque fichier: <br><ul><li>  s'il n'y a pas de sous-cha√Æne ¬´@contract¬ª, ignorez ce fichier; </li><li>  si c'est le cas, transformez le code en ast (arbre de syntaxe abstraite); </li><li>  trouver toutes les fonctions qui sont sous le d√©corateur de contrat pour chacun: <br><ul><li>  obtenir un dockstring, analyser, puis supprimer, </li><li>  cr√©er un dictionnaire de la forme {arg_name: arg_type}, l'utiliser pour remplacer l'annotation de fonction, </li><li>  rappelez-vous de nouvelles importations, </li></ul></li><li>  √©crire l'arbre modifi√© dans un fichier via astunparse; </li><li>  ajoutez de nouvelles importations en haut du fichier; </li><li>  remplacez les lignes "@contract" par "@typechecked" car c'est plus facile que via ast. </li></ul></li></ol><br><p>  R√©soudre la question "ce nom est-il d√©j√† import√© dans ce fichier?"  Je n'avais pas l'intention de le faire d√®s le d√©but: avec ce probl√®me, nous allons faire face √† une ex√©cution suppl√©mentaire de la biblioth√®que isort. </p><br><p>  Mais apr√®s avoir ex√©cut√© la premi√®re version du script, des questions se sont pos√©es qui devaient encore √™tre r√©solues.  Il s'est av√©r√© que 1) ast n'est pas omnipotent, 2) astunparse est plus omnipotent que nous le souhaiterions.  Cela s'est manifest√© comme suit: </p><br><ul><li>  au moment de la transition vers l'arbre de syntaxe, tous les commentaires sur une seule ligne disparaissent du code; </li><li>  les lignes vides disparaissent √©galement; </li><li>  ast ne fait pas de distinction entre les fonctions et les m√©thodes de la classe, nous avons d√ª ajouter de la logique; </li><li>  inversement, lors du passage d'une arborescence √† un code, les commentaires sur plusieurs lignes entre guillemets triples sont √©crits dans des commentaires entre guillemets simples et occupent une ligne, et les nouveaux sauts de ligne sont remplac√©s par \ n; </li><li>  des parenth√®ses inutiles apparaissent, par exemple si A et B et C ou D devient if ((A et B et C) ou D). </li></ul><br><p>  Le code pass√© par ast et astunparse continue de fonctionner, mais sa lisibilit√© est r√©duite. </p><br><p>  L'inconv√©nient le plus grave de ce qui pr√©c√®de est la disparition des commentaires sur une seule ligne (dans d'autres cas, nous ne perdons rien, mais seulement des gains - entre parenth√®ses, par exemple).  L'horrible biblioth√®que bas√©e sur ast, astunparse et tokenize promet de le comprendre.  Promet et fait. </p><br><p>  Maintenant, les lignes vides.  Il y avait deux solutions possibles: </p><br><ol><li>  tokenize sait comment d√©terminer la ¬´partie parole¬ª d'un python, et horast en profite lorsqu'il obtient des jetons de type commentaire.  Mais tokenize a √©galement des jetons comme NewLine et NL.  Donc, vous devez voir comment horast restaure les commentaires et les copier, en rempla√ßant le type de jeton. <br>  <em>- Anya sugg√©r√©e, exp√©rience dans le d√©veloppement de 2 mois</em> </li><li>  √âtant donn√© que horast peut restaurer les commentaires, nous rempla√ßons d'abord toutes les lignes vides par un commentaire sp√©cifique, puis ignorons horast et rempla√ßons notre commentaire par une ligne vide. <br>  <em>- est venu avec Eugene, exp√©rience dans le d√©veloppement de 8 ans</em> </li></ol><br><p>  Je dirai un peu plus bas sur les guillemets triples dans les commentaires, et il √©tait assez facile de mettre en place des crochets suppl√©mentaires, d'autant plus que certains d'entre eux sont supprim√©s par mise en forme automatique. </p><br><p>  Dans horast, nous utilisons deux fonctions: analyser et annuler l'analyse, mais les deux ne sont pas id√©ales - l'analyse contient des erreurs internes √©tranges, dans de rares cas, elle ne peut pas analyser le code source, et l'analyse ne peut pas √©crire quelque chose qui a un type type (un tel type qui Il s'av√®re que vous tapez (any_other_type)). </p><br><p>  J'ai d√©cid√© de ne pas traiter l'analyse, car la logique du travail est assez confuse et les exceptions sont rares - le principe de non-universalit√© fonctionne ici. </p><br><p>  Mais l'impr√©visibilit√© fonctionne tr√®s clairement et assez √©l√©gamment.  La fonction unparse cr√©e une instance de la classe Unparser qui, dans <strong>init,</strong> traite l'arborescence puis l'√©crit dans un fichier.  Horast.Unparser est successivement h√©rit√© de nombreux autres Unparsers, o√π la classe la plus basique est astunparse.Unparser.  Toutes les classes descendantes √©tendent simplement les fonctionnalit√©s de la classe de base, mais la logique du travail reste la m√™me, alors pensez √† astunparse.Unparser.  Il a cinq m√©thodes importantes: </p><br><ol><li>  √©crire - √©crit simplement quelque chose dans un fichier. </li><li>  fill - utilise l'√©criture en fonction du nombre de retraits (le nombre de retraits est stock√© en tant que champ de classe). </li><li>  enter - augmente le retrait. </li><li>  cong√© - r√©duit le retrait. </li><li>  dispatch - d√©termine le type du n≈ìud de l'arbre (disons T), appelle la m√©thode correspondante par le nom du type de n≈ìud, mais avec un trait de soulignement (c'est-√†-dire _T).  Il s'agit d'une m√©ta m√©thode. </li></ol><br><p>  Toutes les autres m√©thodes sont des m√©thodes de la forme _T, par exemple, _Module ou _Str.  Dans chacune de ces m√©thodes, il peut: 1) r√©partir de mani√®re r√©cursive pour les n≈ìuds de sous-arbre, ou 2) utiliser l'√©criture pour √©crire le contenu du n≈ìud ou ajouter des caract√®res et des mots cl√©s afin que le r√©sultat soit une expression valide en python. </p><br><p>  Par exemple, nous sommes tomb√©s sur un n≈ìud de type arg, dans lequel ast stocke le nom de l'argument et le n≈ìud d'annotation.  Ensuite, dispatch appellera la m√©thode _arg, qui notera d'abord le nom de l'argument, puis r√©digera les deux points et ex√©cutera dispatch pour le noeud d'annotation, o√π le sous-arbre d'annotation sera analys√©, et dispatch et write seront toujours appel√©s pour ce sous-arbre. </p><br><p>  Revenons √† notre probl√®me d'impossibilit√© de traitement de type type.  Maintenant que vous comprenez comment fonctionne l‚Äôanalyse, il est facile de cr√©er votre type.  Cr√©ons un type: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NewType</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, t)</span></span></span><span class="hljs-function">:</span></span> self.s = ts</code> </pre> <br><p>  Il stocke une cha√Æne en elle-m√™me, et pas seulement comme √ßa: nous devons typifier les arguments de fonction, et nous obtenons les types d'arguments sous forme de cha√Ænes √† partir de l'ancrage.  Par cons√©quent, rempla√ßons les annotations d'arguments non par les types dont nous avons besoin, mais par un objet NewType qui ne stocke que le nom du type souhait√© √† l'int√©rieur. </p><br><p>  Pour ce faire, d√©veloppez horast.Unparser - √©crivez votre UnparserWithType, h√©ritant de horast.Unparser, et ajoutez le traitement de notre nouveau type. </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UnparserWithType</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(horast.Unparser)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_NewType</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, t)</span></span></span><span class="hljs-function">:</span></span> self.write(ts)</code> </pre> <br><p>  Cela se combine avec l'esprit de la biblioth√®que.  Les noms des variables sont faits dans le style de ast, et c'est pourquoi ils se composent d'une seule lettre, et non parce que je ne peux pas penser aux noms.  Je pense que t est court pour tree et s pour string.  Soit dit en passant, NewType n'est pas une cha√Æne.  Si nous voulions qu'il soit interpr√©t√© comme un type de cha√Æne, nous devions alors √©crire des guillemets avant et apr√®s l'appel en √©criture. </p><br><p>  Et maintenant <del>  la magie </del>  patch singe: remplacez horast.Unparser par notre UnparserWithType. </p><br><p>  Comment √ßa marche maintenant: nous avons un arbre de syntaxe, il a une fonction, les fonctions ont des arguments, les arguments ont des annotations de type, une aiguille est cach√©e dans l'annotation de type, et la mort de Koshcheev y est cach√©e.  Auparavant, il n'y avait aucun n≈ìud d'annotation, nous les avons cr√©√©s et un tel n≈ìud est une instance de NewType.  Nous appelons la fonction non analys√©e pour notre arbre, et pour chaque n≈ìud, elle appelle dispatch, qui classe ce n≈ìud et appelle sa fonction correspondante.  D√®s que la fonction de r√©partition re√ßoit le n≈ìud de l'argument, elle √©crit le nom de l'argument, puis cherche s'il y a une annotation (auparavant, mais nous y mettons NewType), si c'est le cas, elle √©crit deux points et appelle la r√©partition pour l'annotation, qui appelle notre _NewType, qui √©crit simplement la cha√Æne qu'il stocke - c'est le nom du type.  En cons√©quence, nous obtenons l'argument √©crit: type. </p><br><p>  En fait, ce n'est pas enti√®rement l√©gal.  Du point de vue du compilateur, nous avons not√© les annotations des arguments avec des mots qui ne sont d√©finis nulle part, donc quand unparse termine son travail, nous obtenons le mauvais code: nous avons besoin d'importations.  Je forme simplement une ligne du format correct et je l'ajoute au d√©but du fichier, puis j'ajoute le r√©sultat √† l'analyse, bien que je puisse ajouter des importations en tant que n≈ìuds √† l'arbre de syntaxe, car ast prend en charge les n≈ìuds Import et ImportFrom. </p><br><p>  R√©soudre le probl√®me du guillemet triple n'est pas plus difficile que d'ajouter un nouveau type.  Nous allons cr√©er la classe StrType et la m√©thode _StrType.  La m√©thode n'est pas diff√©rente de la m√©thode _NewType utilis√©e pour annoter les types, mais la d√©finition de la classe a chang√©: nous allons stocker non seulement la cha√Æne elle-m√™me, mais aussi le niveau de tabulation auquel elle doit √™tre √©crite.  Le nombre d'indentation est d√©fini comme suit: si cette ligne est rencontr√©e dans une fonction, alors une, si dans une m√©thode, puis deux, et il n'y a pas de cas o√π la fonction est d√©finie dans le corps d'une autre fonction et d√©cor√©e, dans notre projet. </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StrType</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(object)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, s, indent)</span></span></span><span class="hljs-function">:</span></span> self.s = s self.indent = indent <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__repr__</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'"""\n'</span></span> + self.s + <span class="hljs-string"><span class="hljs-string">'\n'</span></span> + <span class="hljs-string"><span class="hljs-string">' '</span></span> * <span class="hljs-number"><span class="hljs-number">4</span></span> * self.indent + <span class="hljs-string"><span class="hljs-string">'"""\n'</span></span></code> </pre> <br><p>  En <strong>repr,</strong> nous d√©finissons √† quoi devrait ressembler notre gamme.  Je pense que c'est loin d'√™tre la seule solution, mais √ßa marche.  On pourrait exp√©rimenter avec astunparse.fill et astunparse.Unparser.indent, alors ce serait plus universel, mais cette id√©e m'est venue √† l'esprit au moment de la r√©daction de cet article. </p><br><p>  Cette difficult√© r√©solue prend fin.  Apr√®s avoir ex√©cut√© mon script, le probl√®me des importations cycliques se pose parfois, mais c'est une question d'architecture.  Je n'ai pas trouv√© de solution tierce pr√™te √† l'emploi, et g√©rer de tels cas dans le cadre de mon script semble √™tre une complication s√©rieuse de la t√¢che.  Probablement, avec l'aide de ast, il est possible de d√©tecter et de r√©soudre les importations cycliques, mais cette id√©e doit √™tre examin√©e s√©par√©ment.  En g√©n√©ral, le nombre n√©gligeable de tels incidents dans notre projet m'a compl√®tement permis de ne pas les traiter automatiquement. </p><br><p>  Une autre difficult√© que j'ai rencontr√©e √©tait le manque de traitement d'expression dans ast √† partir de l'importation astro car un lecteur attentif sait d√©j√† que le patch de singe est le rem√®de pour toutes les maladies.  Que ce soit ses devoirs pour lui, mais j'ai d√©cid√© de le faire: ajoutez simplement ces importations au fichier de mappage, car cette construction est g√©n√©ralement utilis√©e pour contourner le conflit de noms, et nous en avons peu. </p><br><p>  Malgr√© les imperfections trouv√©es, le script fait ce qu'il √©tait cens√© faire.  Quel est le r√©sultat: </p><br><ol><li>  Le temps de lancement du projet est pass√© de 10 √† 3 secondes; </li><li>  Le nombre de fichiers a diminu√© en raison de la suppression des d√©finitions de new_contract.  Les fichiers eux-m√™mes ont √©t√© r√©duits: je n'ai pas mesur√©, mais en moyenne le git totalisait n lignes ajout√©es et 2n supprim√©es; </li><li>  Les IDE intelligents ont commenc√© √† faire des indices diff√©rents, car maintenant ce ne sont plus des commentaires, mais des importations honn√™tes; </li><li>  La lisibilit√© s'est am√©lior√©e; </li><li>  Quelque part, des parenth√®ses sont apparues. </li></ol><br><p>  Je vous remercie! </p><br><p>  Liens utiles: </p><br><ol><li>  <a href="https://docs.python.org/3/library/ast.html">Ast</a> </li><li>  <a href="https://pypi.org/project/horast/">Horast</a> </li><li>  <a href="https://greentreesnakes.readthedocs.io/en/latest/nodes.html">Tous les types de n≈ìuds ast et ce qui y est stock√©</a> </li><li>  <a href="https://python-ast-explorer.com/">Affiche magnifiquement l'arbre de syntaxe</a> </li><li>  <a href="https://pypi.org/project/isort/">Isort</a> </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr480930/">https://habr.com/ru/post/fr480930/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr480920/index.html">Test des commutateurs TP-Link avec PoE longue port√©e. Et un peu sur les mises √† niveau des anciens mod√®les</a></li>
<li><a href="../fr480922/index.html">Evgeny Usvitsky: ¬´Tout le monde dans le monde sait o√π obtenir les g√©odonn√©es librement - uniquement dans OSM¬ª</a></li>
<li><a href="../fr480924/index.html">Comment et pourquoi les cr√©ateurs du remake de MediEvil ont repens√© le boss culte du jeu</a></li>
<li><a href="../fr480926/index.html">Th√©orie des probabilit√©s pour un rendu physiquement pr√©cis</a></li>
<li><a href="../fr480928/index.html">Apache Hadoop Code Quality: production VS test</a></li>
<li><a href="../fr480936/index.html">IntelliJ IDEA conversion rapide UPPER_CASE en camelCase</a></li>
<li><a href="../fr480938/index.html">La crypto-monnaie √† travers les yeux des juges russes</a></li>
<li><a href="../fr480940/index.html">Ex√©cutez un test d'interface utilisateur multi-navigateur avec Cucumber et Selenoid dans Gitlab CI avec rapport Allure</a></li>
<li><a href="../fr480944/index.html">Top 5 des tendances du marketing par e-mail en 2020</a></li>
<li><a href="../fr480946/index.html">Journaux dans Kubernetes (et pas seulement) aujourd'hui: attentes et r√©alit√©</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>