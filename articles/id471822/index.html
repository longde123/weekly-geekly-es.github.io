<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎤 👋🏽 ♓️ Kenalan pertama dengan Asisten Rumah 👗 🤢 👋🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Home Assistant adalah aplikasi open source yang populer untuk mengatur rumah pintar. Pengalaman pertama penulis dengan Home Assistant didasarkan pada ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kenalan pertama dengan Asisten Rumah</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471822/"><img width="25%" align="right" src="https://habrastorage.org/webt/sj/wt/mu/sjwtmujve5xdbroiyxjiebxbc5o.png"><br>  Home Assistant adalah aplikasi open source yang populer untuk mengatur rumah pintar.  Pengalaman pertama penulis dengan Home Assistant didasarkan pada upaya untuk mengintegrasikan penanak nasi pintar ke dalamnya.  Penulis akan mencoba menggambarkan komponen utama dan fitur dari aplikasi ini, yang ia punya kesempatan untuk mengenal selangkah demi selangkah.  Artikel ini dalam beberapa hal merupakan ulasan, dalam beberapa hal panduan bagi mereka yang ingin memulai berkenalan dengan Home Assistant. <br><a name="habracut"></a><br>  Bagi mereka yang memiliki sedikit waktu luang, saya sarankan Anda untuk melewatkan pepatah - bab pertama - dan langsung ke bab kedua.  Anda hanya perlu tahu bahwa kami akan bekerja dengan penanak nasi Cina pintar dari Xiaomi. <br><br><h3>  Penanak nasi pintar </h3> Penanak nasi jelas merupakan penanak nasi.  Wiki menunjukkan kepada kita kapal uap beras keramik dari British Museum yang berasal dari tahun 1250 SM  Pada tahun 1945, Mitsubishi menjadi perusahaan penanak nasi listrik buatan rumah pertama di Jepang.  Model kami - Penanak Nasi dari Xiaomi - tidak hanya bisa memasak nasi.  “Ini adalah alat yang hebat untuk membuat tidak hanya nasi, tetapi juga jenis hidangan lainnya.  Itu bisa memasak sup, kue kering, dan banyak lagi, ”kata iklan itu.  Tetapi yang paling penting adalah kehadiran modul wi-fi, perangkat lunak dengan kemampuan otomasi dan 200+ resep yang dipasang oleh perangkat lunak.  "Jalan menuju rumah pintar melalui perut benar," pikir penulis, dan memutuskan. <br><br>  Xiaomi Rice Cooker, sebagaimana layaknya perangkat digital, secara eksternal sangat menarik, menyenangkan dengan bentuk bulat dan minimalis umum.  Untuk mengkonfigurasi dan menggunakannya, pabrikan menawarkan aplikasi Mi Home.  Setelah mendaftarkan akun Mi, program ini dengan mudah menemukan perangkat baru, dan Anda mendaftarkannya di jaringan lokal Anda.  Antarmuka aplikasi bukan yang terburuk, menyediakan alat otomatisasi dasar, dan dapat menerima pemberitahuan dari perangkat.  Namun, ada kelemahan signifikan.  Tidak semua orang bisa bahagia dengan mengirimkan informasi kepada pengembang tentang setiap klik pengguna.  Dan ekspresi yang tidak menyenangkan sering ditemukan hari ini warna nasional.  Alih-alih 200+ resep, hanya empat yang diterjemahkan dan tersedia dalam bahasa asing.  Sisanya khusus untuk orang-orang Cina.  Ketika penanak nasi "pintar" Anda tidak mampu memenuhi semua tugas kuliner yang dijanjikan, maka, Anda tahu, itu menjadi sedih.  Setelah berkeliaran selama beberapa waktu di Internet, seorang penulis sedih menemukan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">proyek</a> menarik berikutnya (manfaat abadi bagi penulis).  Yang ternyata didedikasikan untuk pengembangan modul untuk Home Assistant tertentu. <br><br><h3>  Asisten rumah </h3>  Pertama, beberapa informasi umum.  Seperti yang diberitahukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">beranda HA</a> , ”Ini adalah perangkat lunak open source untuk otomatisasi rumah pintar yang berfokus pada manajemen dan privasi lokal.  Dikembangkan oleh komunitas penggemar yang terbuka, ini bagus untuk bekerja pada Raspberry Pi atau server lokal. "  Proyek ini lebih dari lima tahun, menggunakan python dan lisensi Apache 2.0.  Versi rilis pada saat menulis baris ini adalah 0.99.3. <br><br>  HA menggunakan modul terpisah (integrasi, atau komponen) untuk mengelola perangkat.  Membuatnya cukup sederhana.  Di situs ini Anda dapat menemukan katalog modul <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">utama</a> (disetujui dan didukung oleh komunitas).  Di antara jumlah total mereka (1485 buah), ada yang benar-benar beragam, nama-nama amazon, google, xiaomi, dan bahkan sekali yandex tercantum dalam katalog. <br>  Mari kita coba untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menginstal</a> HA di lingkungan virtual di desktop Linux.  Kami membutuhkan python3 dan manajer paket pip. <br><pre><code class="bash hljs">python3 -m venv homeassistant <span class="hljs-comment"><span class="hljs-comment">#    cd homeassistant source bin/activate #    python3 -m pip install homeassistant #  Home Assistant hass --open-ui #  Home Assistant</span></span></code> </pre> <br>  Setelah itu, HA <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GUI</a> akan tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http: // localhost: 8123</a> .  Saat pertama kali masuk, Anda harus membuat akun pengguna.  Antarmuka web HA cukup banyak.  Beberapa elemen penting yang layak disebutkan di awal adalah Configuration → General tab, di mana Anda dapat dengan mudah memuat ulang file konfigurasi atau server itu sendiri.  Serta halaman Info dalam daftar alat Pengembang, di mana Anda dapat melihat log kesalahan. <br><br>  HA menyimpan semua data pengguna yang diperlukan, dalam kasus Linux, dalam folder pengaturan “~ / .homeassistant”.  File konfigurasi ditulis dalam format <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">YAML</a> , dan yang utama adalah "configuration.yaml".  Ini menggabungkan data modul, otomatisasi, dll.  Fitur impor memungkinkan Anda untuk membagi pengaturan menjadi file-file terpisah yang diatur secara logis.  Modul disimpan dalam subfolder "komponen" (built-in) dan "custom_components". <br><br>  Pengetahuan ini seharusnya cukup bagi kita untuk menginstal modul baru.  Salin folder "xiaomi_cooker" dari repositori kami ke "~ / .homeassistant / custom_components" kami.  Menurut deskripsi, tambahkan pengaturan modul ke file "configuration.yaml": <br><div class="spoiler">  <b class="spoiler_title">configuration.yaml</b> <div class="spoiler_text"><pre> <code class="bash hljs">xiaomi_cooker: <span class="hljs-comment"><span class="hljs-comment">#   name: 'Akari' #   host: 192.168.1.10 # IP   token: '4921def609273302248d040a24243a25' #   Xiaomi model: chunmi.cooker.normal2 #  </span></span></code> </pre> <br></div></div><br>  Selesai  Setelah HA reboot, entri modul baru akan muncul di bagian Umum → Integrasi pada antarmuka web. <br><br>  Modul apa pun adalah sekumpulan objek (entitas) dan layanan tertentu (layanan, pada dasarnya - fungsi).  Objek menyimpan berbagai data yang diterima dari perangkat.  Misalnya, sensor.xiaomi_cooker_temperature adalah suhu penanak nasi, sun.sun adalah posisi matahari.  Data suatu objek diekspresikan oleh satu nilai dasar - status (keadaan), dan sekumpulan atribut tambahan (atribut) yang berubah-ubah.  Layanan digunakan untuk mentransfer perintah dan nilai ke perangkat.  Misalnya, xiaomi_cooker.start - perintah untuk memulai pengoperasian penanak nasi, atau homeassistant.check_config - inisialisasi pencarian kesalahan dalam file pengaturan HA.  Daftar Alat Pengembang antarmuka web berisi bagian Layanan, di mana Anda dapat melihat daftar layanan yang tersedia untuk Anda dan bermain dengan panggilan mereka.  Terdekat adalah bagian Amerika, di mana, karenanya, Anda dapat melihat dan mengubah nilai objek.  Perlu dicatat bahwa perubahan dalam nilai-nilai objek di bagian Amerika adalah satu sisi.  Yaitu  jika, misalnya, Anda mengubah status objek lights.state dari mati menjadi aktif, ini tidak akan memengaruhi status sebenarnya dari perangkat, dan saat berikutnya data dari perangkat diperbarui, nilai objek akan ditimpa secara nyata. <br><br><h3>  Otomasi </h3>  Alat manajemen utama untuk rumah pintar adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">otomatisasi</a> .  Anda dapat menambahkan dan mengeditnya menggunakan antarmuka grafis di bagian Umum → Otomasi atau langsung di file “automations.yaml”.  Fungsi utama otomatisasi adalah untuk memanggil layanan ketika kondisi tertentu terpenuhi.  Alat dasar untuk mengatur kondisi untuk memanggil nilai objek, termasuk.  data waktu.  Ada solusi yang sedikit lebih spesifik, seperti acara.  Sebagai contoh otomatisasi sederhana, kami akan memberikan kode yang memperbarui data plus penulis dengan jangka waktu 15 menit: <br><div class="spoiler">  <b class="spoiler_title">automations.yaml</b> <div class="spoiler_text"><pre> <code class="bash hljs"> - id: <span class="hljs-string"><span class="hljs-string">'1565889970818'</span></span> <span class="hljs-comment"><span class="hljs-comment"># ID  alias: Umpiro decharging #  trigger: #   - platform: time_pattern #   -  minutes: /15 #   (   –    15 ) condition: [] #    action: #    - data: # ,     entity_id: sensor.umpiro_charge #  (: ) service: homeassistant.update_entity #   </span></span></code> </pre> <br></div></div><br>  Perlu dicatat bahwa sejauh ini tidak semua otomatisasi yang tersedia (misalnya, di atas) dapat dikonfigurasi tanpa mengedit kode yaml melalui antarmuka grafis, tetapi pengembang mengatakan mereka secara aktif bekerja untuk menghilangkan kekurangan ini. <br><br><h3>  Templating </h3>  Setelah otomatisasi, saatnya berbicara tentang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">template</a> (templating).  Berbagai elemen pengaturan dalam file yaml memungkinkan Anda untuk menggunakan sisipan dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bahasa scripting jinja2</a> .  Banyak dari elemen ini disatukan oleh nama umum 'Templat', seperti service_template atau trigger_template.  Menggunakan templat, kami mendapatkan akses ke nilai-nilai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">objek dalam HA</a> dan kemampuan untuk menggunakan data ini dalam ekspresi matematika dan logis yang kompleks, yang sangat memperluas potensi kami.  Sebagai contoh, mari kita ambil kode sensor.umpiro_charge yang sedikit lebih rumit yang dituliskan di "configuration.yaml".  Ini adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">template_sensor</a> , yaitu "sensor yang membentuk data berdasarkan nilai-nilai objek lain".  Sensor kami akan berupa analog dari baterai yang secara bertahap kosong: <br><div class="spoiler">  <b class="spoiler_title">configuration.yaml</b> <div class="spoiler_text"><pre> <code class="bash hljs">sensor: <span class="hljs-comment"><span class="hljs-comment">#   platform: template #   -  sensors: #   #   – sensor.umpiro_charge umpiro_charge: #      UI () unit_of_measurement: '%' # ,    value_template: &gt;- #    –   'int' # +     {% if states('sensor.umpiro_charge')|int('unknown') is number %} #       #         {% set value = (states('sensor.umpiro_charge')|int - (as_timestamp(now()) - as_timestamp(states.sensor.umpiro_charge.last_updated))/60/15)|round %} #       {{ [[0, value]|max, 100]|min }} {% else %} # ,  HA   #      {{ 'unknown' }} {% endif %} # ID  ,     #      entity_id: [] friendly_name: 'Charge' #   #      UI () device_class: battery</span></span></code> </pre><br></div></div><br>  Kami membiarkan entitas_id kosong karena kami telah menambahkan otomatisasi yang secara independen akan menyebabkan pembaruan data objek. <br><br><h3>  Skrip Python </h3>  Pada gilirannya, skrip python adalah alat sederhana untuk membuat layanan baru.  Setelah menambahkan baris: "skrip python:" ke "configuration.yaml", semua file dengan ekstensi ".py" yang kita masukkan ke folder "~ / .homeassistant / python_scripts" akan tersedia sebagai layanan dengan nama "python_scripts. &lt; file_name&gt; ”.  Kode mereka dieksekusi di lingkungan yang telah ditentukan, di mana data dan variabel memiliki memberi kita akses ke argumen ke panggilan layanan, serta objek dan layanan HA.  Sebagai contoh, kami memberikan kode file "charge_set.py" untuk layanan "python_scripts.charge_set".  Fungsinya untuk mengatur pengisian baterai kita: <br><div class="spoiler">  <b class="spoiler_title">python_scripts / charge_set.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     name = data.get('name', 'sensor.umpiro_charge') #     new_state = data.get('charge', '100') #    attributes = hass.states.get(name).attributes #    hass.states.set(name, new_state, attributes)</span></span></code> </pre> <br></div></div><br><br><h3>  Menciptakan integrasi </h3>  Semua yang kami lakukan dengan bantuan templat dan skrip Python, mungkin akan lebih mudah melakukan ini dengan menulis modul terpisah.  Seperti yang telah disebutkan, modul tidak resmi disimpan di folder "custom_components".  Di masa depan, kita akan membutuhkan objek yang menyimpan informasi tentang resep saat ini untuk penanak nasi kami, dan layanan yang memungkinkan Anda untuk mengubah data ini.  Berdasarkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">contoh dari dokumentasi,</a> kami akan membuat modul baru untuk ini, "overmind".  Langkah pertama adalah file custom_components / overmind / __ init__.py: <br><div class="spoiler">  <b class="spoiler_title">custom_components / overmind / __ init__.py</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     DOMAIN = 'overmind' #       () DEFAULT_RECIPE = { "title": "Habr post", "description": "Post an article on habr.com", "profile": "471822" } #    def setup(hass, config): #    hass.states.set('overmind.current_recipe', 'on', DEFAULT_RECIPE) #       def handle_set(call): #    recipe = call.data.get('recipe', DEFAULT_RECIPE) #   -    hass.states.set('overmind.current_recipe', 'set', recipe) #   hass.services.register(DOMAIN, 'recipe_set', handle_set) return True</span></span></code> </pre> <br></div></div><br>  Setelah itu, kami akan melaporkan modul baru ke file konfigurasi "configuration.yaml", menambahkan baris dengan nama modul: "overmind:" ke sana.  Masalahnya terpecahkan. <br><br><h3>  Lovelace ui </h3>  Ini adalah nama HA <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">front end yang</a> digunakan.  Antarmuka grafis ini, di mana pengguna biasa diundang untuk mengontrol rumah pintar, adalah halaman depan antarmuka web HA.  Antarmuka LUI dibentuk dari kartu dari berbagai jenis, yang dapat mencerminkan nilai-nilai objek, berfungsi untuk memanggil fungsi dan tugas lainnya.  Kartu dapat didistribusikan pada halaman (tampilan), dengan analogi dengan bookmark browser.  Pengaturan mudah diatur melalui antarmuka grafis yang sama, tetapi juga dapat diakses melalui kode yaml, di mana ada juga editor teks bawaan.  Saya sarankan Anda melihat halaman <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">https://demo.home-assistant.io/</a> , di mana ada beberapa contoh pengaturan LUI yang berbeda, dan di mana Anda dapat dengan mudah melihat, mengklik dan memodifikasinya. <br><br><img src="https://habrastorage.org/webt/64/bd/zf/64bdzfwclc_3sqnoek13735wgqq.png"><br>  <i><font color="grey">Contoh setup GUI</font></i> <br><br>  Berbicara tentang kekurangan antarmuka, sayangnya, para pengembang sendiri mengakui bahwa proyek ini mencoba untuk duduk bersamaan di kursi-kursi desktop dan smartphone.  LUI, secara default, suka menentukan secara independen lokasi dan ukuran kartu, yang kadang-kadang dapat mengubah halaman yang tampak normal pada monitor menjadi berantakan di layar ponsel cerdas, dan sebaliknya.  Ada beberapa alat sederhana untuk merampingkan antarmuka, tetapi mereka, menurut pengalaman saya, tidak selalu efektif. <br><br>  Saya pikir itu tidak masuk akal untuk menggambarkan pembuatan antarmuka menggunakan alat grafis, jadi saya akan memberikan beberapa contoh dalam bentuk kode yaml yang saya gunakan.  Setelah membuat halaman terpisah (tampilan) untuk penanak nasi kami, kami akan mencoba mengisinya dengan elemen yang paling penting sehingga tidak menyebabkan penolakan saat menggunakan layar smartphone. <br><br>  Di sini kita akan mencoba alat-alat pemesanan antarmuka yang sangat sederhana, ini adalah tumpukan horisontal dan vertikal.  Pertama, buat tumpukan vertikal dari kartu jenis entitas-tombol dan sensor.  Yang pertama akan berfungsi untuk meluncurkan penanak nasi kami, yang kedua - untuk menampilkan suhu: <br><div class="spoiler">  <b class="spoiler_title">tumpukan vertikal</b> <div class="spoiler_text"><pre> <code class="bash hljs">cards: <span class="hljs-comment"><span class="hljs-comment">#    - type: entity-button #      entity: sensor.xiaomi_cooker_state # ,     icon: 'mdi:selection' #     icon_height: 100px #   name: Offline #    show_icon: true # show_name: true # tap_action: #    action: call-service #  –   service: script.turn_on #  –   service_data: #    entity_id: script.order_cooker_start #  –   hold_action: #    action: none # - type: sensor #      entity: sensor.xiaomi_cooker_temperature # ,     name: Temper #   type: vertical-stack #   –  </span></span></code> </pre> <br></div></div><br>  Home Assistant menyertakan arsip <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ikon Desain Bahan</a> , yang, melalui nama yang sesuai (misalnya, mdi: selection), dapat digunakan dalam item pengaturan.  Script (dalam hal ini, bukan python-, tapi yaml-), yang biasa kami sebut layanan, adalah alat HA yang mudah digunakan. <br><br>  Sekarang gabungkan tumpukan vertikal di atas dengan kartu potret kita di tumpukan horizontal sekarang.  Semuanya akan sesederhana itu: <br><div class="spoiler">  <b class="spoiler_title">tumpukan horisontal</b> <div class="spoiler_text"><pre> <code class="bash hljs">ards: <span class="hljs-comment"><span class="hljs-comment">#    - type: picture #   image: /local/akari_r.jpg #    - #         type: horizontal-stack #   –  </span></span></code> </pre> <br></div></div><br>  Di sini Anda perlu menandai baris 'gambar:'.  Semua file yang kita masukkan ke folder '~ / .homeassistant / www' tersedia di tautan <a href="">http: // localhost / local / filename</a> . <br><br>  Langkah selanjutnya adalah bekerja sedikit pada tombol panggilan layanan yang kami buat.  Akan lebih mudah bagi kami jika itu berfungsi sebagai toggle switch, mis.  on / off, dan bukan cara itu dilakukan sekarang.  Ini dapat dicapai melalui penggunaan kartu jenis bersyarat, tampilan yang di layar dapat disesuaikan dengan mengatur kondisi tertentu.  Di bawah ini adalah kode untuk kartu, yang merupakan tombol untuk mematikan penanak nasi dan hanya terlihat jika penanak nasi sedang dalam proses menyiapkan hidangan: <br><div class="spoiler">  <b class="spoiler_title">bersyarat</b> <div class="spoiler_text"><pre> <code class="bash hljs">card: <span class="hljs-comment"><span class="hljs-comment">#    entity: sensor.xiaomi_cooker_state # icon: 'mdi:star-box-outline' # icon_height: 100px # name: Running # tap_action: # action: call-service # service: xiaomi_cooker.stop # type: entity-button # conditions: #   # ,    entity: sensor.xiaomi_cooker_mode #  ,     state: Running type: conditional #  </span></span></code> </pre> <br></div></div><br>  Menulis ulang kode tombol daya yang dibuat sebelumnya dengan cara yang sama, dan menggabungkannya dengan ini, kita mendapatkan satu tombol yang berfungsi baik hidup dan mati. <br><br>  Kami melengkapi minat kami dengan kartu lain - dengan waktu hingga akhir memasak (mirip dengan kartu suhu), dan satu lagi dengan rincian resep (khusus: kartu resep) ditampilkan.  Akibatnya, kami mendapatkan sesuatu seperti ini: <br><div style="text-align:center;"><img width="50%" src="https://habrastorage.org/webt/k6/kv/zq/k6kvzqqugn8sizjtsemxyufquo8.jpeg"></div><br><h3>  Kartu khusus </h3>  Home Assistant, selain kekayaan jenis kartu bawaan, tentu saja, memberikan kemampuan untuk membuat kartu Anda sendiri.  Kartu semacam itu disebut kartu khusus, dan javascript digunakan untuk membuatnya.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Berikut</a> adalah dua contoh kode sederhana.  Sangat mudah untuk menemukan kartu yang sudah jadi yang dibuat oleh berbagai <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">penggemar di</a> jaringan, dan jika Anda ingin bereksperimen sendiri, akan berguna untuk mengetahui bahwa ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">modul js-</a> khusus yang dibuat untuk menyederhanakan pekerjaan menulis yang baru.  Pengalaman saya dengan javascript terus ingin lebih sedikit, jadi, sebagai contoh, saya hanya akan memberikan sebagian kecil dari kode kartu yang digunakan untuk memilih dan menampilkan resep saat ini. <br><div class="spoiler">  <b class="spoiler_title">www / resep-card.js</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     lit-element LitElement, html, css } from "https://unpkg.com/lit-element@latest/lit-element.js?module"; //      class RecipeCard extends LitElement { //     HA static get properties() { return { hass: {}, config: {} }; } //    callServiceEx() { this.hass.callService('persistent_notification', 'create', {message: 'example'}); } //  html-  render() { //    ,     const entityId = this.config.entity; //    const state = this.hass.states[entityId]; //    const titleStr = state ? state.attributes.title : 'unavailable'; const descrStr = state ? state.attributes.description : 'unavailable'; //    return html` &lt;ha-card&gt; &lt;div class="flex" style="margin-top:16px;"&gt; &lt;div class="icon"&gt; &lt;ha-icon icon="mdi:bowl"&gt;&lt;/ha-icon&gt; &lt;/div&gt; &lt;div class="header"&gt; &lt;span class="name"&gt;Recipe&lt;/span&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class="flex info" style="margin-bottom:16px;"&gt; &lt;span class="recipe-title"&gt;${titleStr}&lt;/span&gt; &lt;span class="recipe-descr"&gt;${descrStr}&lt;/span&gt; &lt;/div&gt; &lt;/ha-card&gt; `; } //     customElements.define('recipe-card', RecipeCard);</span></span></code> </pre> <br></div></div><br><br>  Untuk menggunakan kartu baru, Anda perlu menambahkan kode berikut di awal file pengaturan LUI: <br><div class="spoiler">  <b class="spoiler_title">kartu resep</b> <div class="spoiler_text"><pre> <code class="bash hljs">resources: <span class="hljs-comment"><span class="hljs-comment">#    - type: module #   –  url: /local/recipe-card.js #  </span></span></code> </pre><br>  dan di antara daftar kartu: <br><pre> <code class="bash hljs"> - <span class="hljs-built_in"><span class="hljs-built_in">type</span></span>: <span class="hljs-string"><span class="hljs-string">'custom:recipe-card'</span></span> <span class="hljs-comment"><span class="hljs-comment">#   entity: overmind.current_recipe # ,    </span></span></code> </pre><br><br></div></div><br><h3>  Notifikasi </h3>  Bagian penting dari rumah pintar adalah mengirim pesan kepada pengguna.  Dalam HA, pesan-pesan ini disebut pemberitahuan dan ada dua jenis dasar pemberitahuan.  Yang pertama adalah notifikasi persisten.  Untuk mengirimnya, layanan bawaan "persistent_notification.create" digunakan.  Daftar pesan tersebut tersedia melalui ikon bel di antarmuka grafis, mereka menggunakan markdown markup dan pada dasarnya cukup sederhana. <br><br>  Alat lain yang lebih menarik adalah modul notifikasi bawaan, yang melalui pemasangan modul tambahan memungkinkan Anda mengirim pesan menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">platform pihak ketiga</a> .  Sebagai contoh, pertimbangkan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">modul untuk telegram</a> . <br><br>  Untuk menggunakan modul, pertama-tama, kita perlu membuat bot di telegram itu sendiri.  Saat menyiapkan, kami membutuhkan chat_id pengguna kami dan API token bot.  Cara mendapatkan data ini - dijelaskan secara rinci di tautan di atas, kami menganggap bahwa kami siap.  Pindah langsung ke menginstal modul, pertama, seperti yang sudah kita lakukan, salin kode sumbernya ke folder komponen, dan kemudian tambahkan pengaturannya ke file "configuration.yaml": <br><div class="spoiler">  <b class="spoiler_title">configuration.yaml</b> <div class="spoiler_text"><pre> <code class="bash hljs">telegram_bot: <span class="hljs-comment"><span class="hljs-comment">#   telegram platform: polling #   api_key: XXXXXXXXXXXXX # API Token   allowed_chat_ids: XXXXXXX # chat_id   proxy_url: socks5://XXXXXXXXXXXXX #     proxy_params: username: umpiro password: umpiro_password</span></span></code> </pre> <br>  pengaturan plus untuk modul notifikasi: <br><pre> <code class="bash hljs">notify: <span class="hljs-comment"><span class="hljs-comment">#   notify name: notify_send #   (   –  notify.notify_send) platform: telegram #   chat_id: XXXXXXX # chat_id  </span></span></code> </pre> <br></div></div><br><br>  Modul telegram memungkinkan kita mengirim pesan, gambar, atau video.  Sebagai contoh, kami akan membuat otomatisasi untuk mengirim pesan dengan gambar, memberi tahu kami tentang akhir dari memasak. <br><div class="spoiler">  <b class="spoiler_title">automations.yaml</b> <div class="spoiler_text"><pre> <code class="bash hljs"> - id: <span class="hljs-string"><span class="hljs-string">'1571074941908'</span></span> <span class="hljs-comment"><span class="hljs-comment"># ID  alias: EOC #   trigger: #    # ,   - entity_id: sensor.xiaomi_cooker_mode from: Running #    #   –    platform: state to: Waiting #    condition: [] #   action: #    - service: notify.notify_send #  –   data: # ,     title: End of Cooking #  message: "EOC" #  data: #    photo: #   -  #   - file: /home/umpiro/.homeassistant/www/cat.jpg #   caption: “EOC”</span></span></code> </pre> <br></div></div><br><br><h3>  Kata penutup </h3>  Asisten Rumah mungkin menarik bagi mereka yang ingin mencoba mengatur manajemen rumah pintar setempat.  Ini adalah proyek yang luas, menarik, terbuka dan aktif karena upaya masyarakat.  Variasi alat Asisten Rumah tidak bisa tidak bersukacita (saya tidak punya waktu untuk menyebutkan beberapa yang penting).  Sebagai minus, orang dapat menyebutkan kompleksitas relatif dan ketidaklengkapan dokumentasi. <br>  PS <br>  Baru-baru ini, pada 10 Oktober, ada, saya tidak tahu apakah ini bisa disebut rilis, transisi proyek dari versi 0,99 ke versi 0,100. <br>  Kutipan dari Catatan Rilis: <br><blockquote>  Selamat datang di catatan rilis dari rilis luar biasa lainnya!  Tidak, kami tidak akan untuk 1,0, kami melakukan 0,100!  Kami merasa belum siap dengan sasaran untuk 1,0, tetapi kami membuat kemajuan setiap hari.  Untuk mengetahui apa yang sedang kami pikirkan, periksa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">mode Simple</a> blog kami <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di Home Assistant 1.0.</a> </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id471822/">https://habr.com/ru/post/id471822/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id471810/index.html">Bandingkan alat untuk mengaudit perubahan di Active Directory: Quest Change Auditor dan Netwrix Auditor</a></li>
<li><a href="../id471812/index.html">Perpustakaan Mesin Wolfram Gratis untuk Pengembang Perangkat Lunak</a></li>
<li><a href="../id471814/index.html">WolframClientForPython | Perpustakaan Klien Bahasa Wolfram Baru untuk Python</a></li>
<li><a href="../id471816/index.html">Cara menandatangani aplikasi untuk macOS Catalina 10.15</a></li>
<li><a href="../id471820/index.html">Penipu telepon. Langkah Tiga, di mana saya mendapatkan dokumentasi bahwa sel bank saya telah dibuat</a></li>
<li><a href="../id471824/index.html">Kamera disket: 8 fakta menarik tentang Sony Mavica MVC-FD85 (banyak gambar)</a></li>
<li><a href="../id471836/index.html">Visualisasi kode python otomatis. Bagian Empat: Dukungan Dokumentasi</a></li>
<li><a href="../id471838/index.html">Cinta matematika</a></li>
<li><a href="../id471840/index.html">Mengapa pergi ke wawancara</a></li>
<li><a href="../id471844/index.html">5 alasan untuk mengunjungi EPAM INSIDER di Kazakhstan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>