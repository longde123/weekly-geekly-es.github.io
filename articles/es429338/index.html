<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê† üõë üë©üèº‚Äçü§ù‚Äçüë®üèæ Almacenamiento de Android: interno, externo, extra√≠ble. Parte 1/3 üëèüèø üè¥ üèõÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A todos los que, a pesar de todo, lograron tomar la decisi√≥n correcta. 

 Esta es una traducci√≥n de una serie de art√≠culos de Mark Murphy de CommonsWa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Almacenamiento de Android: interno, externo, extra√≠ble. Parte 1/3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/429338/"><blockquote>  A todos los que, a pesar de todo, lograron tomar la decisi√≥n correcta. </blockquote><p>  Esta es una traducci√≥n de una serie de art√≠culos de Mark Murphy de CommonsWare, ampliamente conocido en stackoverflow, as√≠ como el autor de los libros "La gu√≠a del codificador ocupado para el desarrollo de Android", "Componentes de arquitectura de Android".  Algunos t√©rminos no est√°n traducidos espec√≠ficamente. </p><br><h1 id="internal-storage">  Almacenamiento interno </h1><br><p>  Hay mucha confusi√≥n con respecto al modelo de almacenamiento de Android.  La confusi√≥n ha aumentado significativamente con los cambios en Android 4.4 en el modelo de almacenamiento, y desde entonces la situaci√≥n no ha mejorado.  Hay innumerables preguntas sobre Stack Overflow y recursos similares, donde las personas claramente no est√°n completamente versados ‚Äã‚Äãen los diversos modelos de almacenamiento de Android. </p><a name="habracut"></a><br><h1 id="to-chto-polzovateli-schitayut-internal-storage">  Lo que los usuarios consideran almacenamiento interno </h1><br><p>  Dependiendo del modelo de su dispositivo, los usuarios eventualmente llegar√°n a Configuraci√≥n -&gt; Almacenamiento en su dispositivo o una ubicaci√≥n equivalente, y pueden ver una pantalla que describe "Almacenamiento interno" . </p><br><p>  El usuario piensa que toda la unidad flash incorporada es "Almacenamiento interno".  Afortunadamente, Google comenz√≥ a cambiar este t√©rmino con Android 8.0, pasando a "almacenamiento general" en lugar de "almacenamiento interno". </p><br><p> Sin embargo, los usuarios a√∫n pueden ver el "almacenamiento interno" en lugares como la ventana del Explorador de Windows cuando su dispositivo est√° conectado a trav√©s de USB. </p><br><h1 id="chto-google-schitaet-internal-storage">  Lo que Google considera almacenamiento interno </h1><br><p>  Por desgracia, lo que ven los usuarios no es lo mismo que el SDK de Android considera "almacenamiento interno", lo que genera cierta confusi√≥n.  Si <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lee la documentaci√≥n de Android en el repositorio interno</a> , entonces esta descripci√≥n ... es al menos confusa (el texto ha cambiado desde el momento de la escritura): </p><br><blockquote>  Puede guardar archivos directamente en la memoria interna del dispositivo.  De manera predeterminada, los archivos almacenados en el almacenamiento interno son privados para su aplicaci√≥n, y otras aplicaciones no pueden acceder a ellos (al igual que el usuario).  Cuando el usuario desinstala la aplicaci√≥n, estos archivos se eliminan. </blockquote><p>  En verdad, el SDK de Android define el "almacenamiento interno" como un directorio especial exclusivo de su aplicaci√≥n, donde su aplicaci√≥n puede alojar archivos.  Como se sugiere en la documentaci√≥n, estos archivos est√°n destinados a leer y escribir en su aplicaci√≥n de manera predeterminada y est√°n prohibidos para cualquier otra aplicaci√≥n (excepci√≥n: los usuarios que trabajan con administradores de archivos con privilegios de superusuario en dispositivos rooteados pueden acceder a todo). </p><br><p>  El contexto tiene algunos m√©todos b√°sicos que le dan acceso al almacenamiento interno, que incluyen: </p><br><ul><li><code>getCacheDir()</code> </li> <li> <code>getDir()</code> </li> <li> <code>getDatabasePath()</code> </li> <li> <code>getFilesDir()</code> </li> <li> <code>openFileInput()</code> </li> <li> <code>openFileOutput()</code> </li> </ul><br><p>  Otros m√©todos depender√°n de ellos, como <code>openOrCreateDatabase()</code> .  Otras clases tambi√©n depender√°n de ellos, como <code>SQLiteOpenHelper</code> y <code>SharedPreferences</code> . </p><br><h1 id="gde-hranitsya-internal-storage--inogda">  ¬øD√≥nde se almacena el almacenamiento interno ... a veces </h1><br><p>  Si mira varias publicaciones de blog, respuestas de StackOverflow y libros publicados en 2012 o antes, se le informa que el "almacenamiento interno" de su aplicaci√≥n se encuentra en <code>/data/data/your.application.package.name</code> . </p><br><p>  En el interior habr√° algunos directorios creados autom√°ticamente por Android, ya que utiliza algunos de los m√©todos de contexto.  Por ejemplo, <code>getFilesDir()</code> devuelve un objeto <code>File</code> que apunta al directorio <code>files/</code> en el almacenamiento interno de su aplicaci√≥n. </p><br><h1 id="gde-hranitsya-internal-storage--ostalnoe-vremya">  D√≥nde se almacena el almacenamiento interno ... El resto del tiempo </h1><br><p>  Sin embargo, el almacenamiento interno de su aplicaci√≥n no siempre se encuentra en la ubicaci√≥n especificada.  Para los desarrolladores, hay una regla que debes aprender de esta serie de publicaciones de blog: </p><br><p>  <strong>NUNCA CAMINOS DUROS</strong> . </p><br><p>  De vez en cuando, veo desarrolladores haciendo algo como esto: </p><br><p> <code>File f=new File("/data/data/their.app.package.name/files/foo.txt");</code> </p> <br><p>  Esto no es un delito, es peor, es un error. </p><br><p>  El movimiento correcto, y escribe menos: </p><br><p> <code>File f=new File(getFilesDir(), "foo.txt");</code> </p> <br><p>  M√°s importante a√∫n, <em>el almacenamiento interno no siempre est√° en el mismo lugar</em> .  Es de destacar que tenemos el concepto de perfiles de usuario separados (perfiles de usuario separados), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">comenzando con Android 4.2</a> para tabletas y Android 5.0 para tel√©fonos.  Cada usuario obtiene su propio "almacenamiento interno".  Aunque el directorio anterior todav√≠a se usa para el usuario principal, no se garantiza que se usar√° para cuentas secundarias. </p><br><h1 id="issleduem-internal-storage">  Explorando el almacenamiento interno </h1><br><p>  La herramienta Device File Explorer en Android Studio 3.0+ puede ver todo el almacenamiento interno en el emulador, as√≠ como el almacenamiento interno de aplicaciones depuradas en dispositivos de producci√≥n. </p><br><p>  En la l√≠nea de comando, puede usar <code>adb</code> con la opci√≥n de <code>run-as</code> . </p><br><p>  Por ejemplo, para cargar una base de datos desde el almacenamiento interno del usuario principal a su m√°quina de desarrollo, puede usar: </p><br><p> <code>adb shell 'run-as your.application.package.name cp /data/data/your.application.package.name/databases/dbname.db /sdcard'</code> </p> <br><p>  Tenga en cuenta que: </p><br><ul><li>  Deber√° cambiar el destino donde est√° montado el almacenamiento externo en su dispositivo (se muestra aqu√≠ como <code>/sdcard/</code> , que no ser√° el mismo en todos los dispositivos) </li><li>  Es posible que necesite usar <code>cat</code> lugar de <code>cp</code> en dispositivos m√°s antiguos </li><li>  Una vez que el archivo se encuentra en el almacenamiento externo, puede usar <code>adb pull</code> para descargarlo en su computadora o acceder a √©l de otras maneras habituales (por ejemplo, montando el dispositivo como un disco). </li></ul><br><h1 id="ogranicheniya-vnutrennego-hranilischa">  Limitaciones de almacenamiento interno </h1><br><p>  En dispositivos Android 1.xy 2.x anteriores, el almacenamiento interno generalmente se ubicaba en una secci√≥n dedicada del sistema de archivos, y esta secci√≥n generalmente era bastante peque√±a.  HTC Dream (tambi√©n conocido como T-Mobile G1), el dispositivo Android original, ten√≠a una enorme memoria interna de 70 MB para ser utilizada por todas las aplicaciones (esto no es un error tipogr√°fico, en ese momento medimos la memoria en megabytes). </p><br><p>  Para cuando salieron 2.3 dispositivos, el almacenamiento interno podr√≠a tener un tama√±o de 1 GB. </p><br><p>  Android 3.0 ha cambiado el modelo de almacenamiento, ya que el almacenamiento interno se ha vuelto m√°s volumen.  Para dispositivos que se anuncian con 4 GB, 8 GB, 16 GB, etc.  espacio de almacenamiento, generalmente hab√≠a todo esto (menos el contenido existente) disponible para almacenamiento interno.  Veremos qu√© ha cambiado en Android 3.0 y su impacto en el modelo de almacenamiento en las siguientes publicaciones sobre almacenamiento externo. </p><br><p>  Para Android 1.xy 2.x, el almacenamiento interno solo era v√°lido para archivos peque√±os, y ten√≠a que usar almacenamiento externo para todo lo dem√°s.  Android 3.0+ significa que para la mayor√≠a de los dispositivos y la mayor√≠a de los usuarios, el almacenamiento interno es ideal para archivos que no est√°n destinados para el uso normal de otras aplicaciones o que son accesibles para el usuario independientemente de su aplicaci√≥n.  Sin embargo, algunos usuarios experimentados encuentran que incluso un flash incorporado no es suficiente para lo que desean almacenar, por lo que cambian al almacenamiento extra√≠ble ... que es una <em>lata de gusanos (nota ŒªŒºŒπŒΩœÇ)</em> , una fuente de muchos problemas impredecibles y complejos. </p><br><h1 id="faq-po-internal-storage">  Preguntas frecuentes sobre almacenamiento interno </h1><br><h2 id="dolzhen-li-ya-delat-fayly-vo-vnutrennem-hranilische-world-readable-ili-world-writeable">  ¬øDebo hacer archivos en el almacenamiento interno World-Readable o World-Writeable? </h2><br><p>  Oh, $ DIOSES, no.  Use <code>FileProvider</code> y sirva este contenido con la implementaci√≥n de <code>ContentProvider</code> .  Despu√©s de eso, al menos, tiene la oportunidad de usar el sistema de permisos de Android para controlar el acceso a estos archivos, a diferencia de su versi√≥n, cuando cualquier aplicaci√≥n en el sistema puede arruinar estos archivos. </p><br><h2 id="nu-a-kak-naschet-androidshareduserid-">  Bueno, ¬øqu√© pasa con <code>android:sharedUserId</code> ? </h2><br><p>  No te aconsejo. </p><br><p>  <code>android: sharedUserId</code> es un atributo que puede poner en un manifiesto que indica el identificador l√≥gico del usuario que se utilizar√° para su aplicaci√≥n.  Cualquier otra aplicaci√≥n que est√© instalada que firme con la misma clave de firma y solicite el mismo <code>android:sharedUserId</code> usar√° el mismo usuario de Linux desde un punto de vista de seguridad.  El efecto es que estas dos aplicaciones pueden trabajar con los archivos del otro con impunidad, ya que estos archivos pertenecen al mismo usuario de Linux. </p><br><p>  Este atributo realmente est√° destinado a aplicaciones preinstaladas, como el paquete de software precargado por el fabricante del dispositivo, el operador m√≥vil o el desarrollador de un firmware ROM modificado.  En particular, tan pronto como instale su aplicaci√≥n una vez, no podr√° cambiar sin problemas su valor de <code>android:sharedUserId</code> sin bloquear el acceso del usuario a los archivos existentes ... ya que Android no cambia la propiedad de los archivos existentes al cambiar la cuenta de usuario de Linux, que ejecuta la aplicaci√≥n </p><br><p>  Existen varios riesgos cuando m√∫ltiples procesos acceden a los archivos.  Algunos subsistemas, como SQLite, tienen l√≥gica incorporada para resolver este problema.  Pero si usted mismo organiza su propio acceso al archivo (por ejemplo, a trav√©s de <code>File</code> y Java I / O), debe hacer algo con acceso simult√°neo, y esto es dif√≠cil. </p><br><p>  Tambi√©n debe manejar una situaci√≥n en la que una aplicaci√≥n se desinstala eliminando archivos que otra aplicaci√≥n us√≥.  En un modelo de concentrador y radio, por ejemplo, con una aplicaci√≥n y un conjunto de complementos, quiz√°s esto no sea tan arriesgado.  En otros modelos, donde las aplicaciones son m√°s equitativas, no puede permitirse perder los datos de su aplicaci√≥n solo porque el usuario decidi√≥ eliminar alguna aplicaci√≥n por separado. </p><br><p>  Finalmente, no sabes lo que puede traer el futuro.  En este momento, puede ver su conjunto de aplicaciones como un conjunto estrechamente acoplado.  Alguien que compre estas aplicaciones o adquiera su compa√±√≠a puede desear ir a otro lado.  El uso de capacidades de intercambio de datos que est√°n menos conectadas, como <code>ContentProvider</code> , le brinda m√°s flexibilidad.  En un mundo ideal, su aplicaci√≥n debe tratar a otras aplicaciones como un recurso bastante confiable, pero no siempre accesible, como su propio servicio web. </p><br><h2 id="kak-zapretit-polzovatelyam-rooted-ustroystv-dostup-k-moim-faylam-vo-vnutrennem-hranilische">  ¬øC√≥mo evitar que los usuarios de dispositivos rooteados accedan a mis archivos en el almacenamiento interno? </h2><br><p>  Simplemente no coloque archivos en el almacenamiento interno.  Los usuarios de dispositivos rooteados pueden acceder a lo que necesitan en el dispositivo, por lo que la √∫nica forma de evitar que accedan a sus datos es no tenerlos en el dispositivo. </p><br><p>  Algunos desarrolladores intentar√°n cifrar sus archivos con una contrase√±a codificada para que los usuarios de dispositivos rooteados no puedan usar estos archivos.  Esto crear√° el efecto de un golpe de velocidad por un corto tiempo.  Todo lo que se requiere es una persona interesada en la ingenier√≠a inversa de su aplicaci√≥n, que ha determinado c√≥mo descifrar estos archivos y luego escribi√≥ un mensaje en un blog o foro sobre c√≥mo hacerlo. </p><br><p>  En general, relativamente pocas personas con dispositivos rooteados, los califico con menos del 1%.  En mi humilde opini√≥n, tendr√° m√°s √©xito si enfoca su trabajo de ingenier√≠a en escribir una mejor aplicaci√≥n, en lugar de perder tiempo protegiendo de dispositivos rooteados. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es429338/">https://habr.com/ru/post/es429338/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es429326/index.html">App Store no llamar√°. O c√≥mo hice mi solicitud, pero no llegar√° a los usuarios</a></li>
<li><a href="../es429328/index.html">M√≥dulo de software para digitalizar documentos da√±ados</a></li>
<li><a href="../es429330/index.html">Mitos y leyendas de Agile: desde los faraones hasta nuestros d√≠as</a></li>
<li><a href="../es429332/index.html">Sable de luz l√°ser casero: como estaba, parte 1</a></li>
<li><a href="../es429336/index.html">Comunicaci√≥n entre el controlador y el dispositivo mediante el m√©todo _HID ACPI utilizando el GPIO del controlador Lynxpoint como ejemplo</a></li>
<li><a href="../es429340/index.html">Pi√©nselo dos veces antes de usar Helm.</a></li>
<li><a href="../es429342/index.html">Angular 6+ es una gu√≠a completa de inyecci√≥n de dependencia. provideIn vs proveedores: []</a></li>
<li><a href="../es429344/index.html">Lectura de fin de semana: sintonizaci√≥n de audio y recursos de dise√±o de altavoces</a></li>
<li><a href="../es429346/index.html">Para el programa de maestr√≠a sin ex√°menes: una nueva direcci√≥n "Big Data" en los Juegos Ol√≠mpicos "Soy un profesional"</a></li>
<li><a href="../es429348/index.html">¬øPor qu√© en el futuro Agile no ser√° necesario?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>