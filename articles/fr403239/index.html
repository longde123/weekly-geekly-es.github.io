<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚èèÔ∏è ü§∞üèª üîï Radio WiFi WOLNA. Comment une petite startup a √©t√© cr√©√©e üßñüèΩ üë®üèø‚Äçüé® üï°</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il n'y a pas si longtemps, j'ai mis sur un terrain public un appareil de ma propre conception, qui a √©t√© d√©velopp√© l'ann√©e derni√®re. Il s'agit d'une r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Radio WiFi WOLNA. Comment une petite startup a √©t√© cr√©√©e</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/403239/"> Il n'y a pas si longtemps, j'ai mis sur un terrain public un appareil de ma propre conception, qui a √©t√© d√©velopp√© l'ann√©e derni√®re.  Il s'agit d'une radio Internet utilisant le wifi. <br><br><img src="https://habrastorage.org/files/f54/afe/69e/f54afe69e5d844a494f9a0dfec8604c4.png" alt="image"><br><br>  Il est propos√© de voter pour ou contre les personnes en roubles sur l'un des sites de financement participatif.  L'appareil n'a pas fait grand bruit, bien qu'il existe d√©j√† des sponsors.  Mais depuis lors, il y a eu de nombreuses questions techniques et demandes pour disposer des circuits et du firmware.  Tous ceux qui s'int√©ressent √† la naissance de l'appareil et √† sa composition sont les bienvenus sous cat. <br>  <i>Spoiler:</i> il n'y aura pas de firmware. <br><a name="habracut"></a><br>  Donc, tout a commenc√© avec la n√©cessit√© d'avoir une radio √† la maison dans la cuisine.  Bien s√ªr, en tant que d√©veloppeur d'√©lectronique, j'ai imm√©diatement rejet√© l'option d'aller au magasin et d'acheter.  Soit dit en passant, pour cette raison, je n'ai toujours pas de sonnette normale. <br><br>  La radio FM a √©t√© abandonn√©e en raison de la mise en ≈ìuvre ennuyeuse.  Et il a √©t√© d√©cid√© de faire une radio Internet.  Pour l'avenir, je veux montrer qu'un tel r√©cepteur s'est av√©r√© ici. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/wiW4ZcnPw18" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  <b>S√©lection de fer</b> <br><br>  Tout d'abord, il a fallu choisir une plateforme sur laquelle construire une radio Internet.  Il existe de nombreuses options, mais j'ai choisi parmi ce qui √©tait √† port√©e de main: <br><br>  1. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Odroid W</a> + LCD <br>  2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">STM32F4DISCOVERY</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ESP8266</a> + <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">VS1053B</a> <br><br>  Sur un odroid, le processus de d√©veloppement prendrait moins de temps, mais les inconv√©nients, dans mon cas particulier (beaucoup ne sont pas d'accord avec moi), ont pr√©valu: <br><br>  - le processus de chargement de l'OS prend un certain temps <br>  - Une tendance croissante √† infecter les appareils IoT avec des virus <br>  - J'ai une mauvaise connaissance du d√©veloppement Linux <br>  - prix <br><br>  N√©anmoins, j'ai demand√© √† un de mes bons amis d'√©crire un softink pour Odroid W, qui commencerait au d√©but du syst√®me et jouerait √† la radio Internet.  Mais l'impossibilit√© d'√©diter correctement le projet sans secouer un camarade a enterr√© cette option et m'a pouss√© √† la seconde. <br><br>  Et j'ai rassembl√© le sch√©ma suivant sur une planche √† pain: <br><br><img src="https://habrastorage.org/files/c09/207/c4d/c09207c4d0bb40d589c165e8493d4d7e.png" alt="image"><br><br>  <b>Comment travailler avec la radio Internet</b> <br><br>  Apr√®s cela, j'ai commenc√© √† regarder le fonctionnement de la radio Internet.  Il s'est av√©r√© que la grande majorit√© des stations utilisent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">icecast</a> pour la diffusion.  Il tourne quelque part sur un serveur avec une IP fixe et attend une connexion.  En r√®gle g√©n√©rale, au port 8000 ou 8080.  Bien qu'il existe de nombreuses exceptions.  Apr√®s la connexion, vous devez envoyer une demande de ce type, en y substituant le nom du flux et du serveur: <br><br><pre><code class="hljs powershell">GET /stream HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span> Icy<span class="hljs-literal"><span class="hljs-literal">-MetaData</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> User<span class="hljs-literal"><span class="hljs-literal">-Agent</span></span>: Mozilla/<span class="hljs-number"><span class="hljs-number">5.0</span></span> (X11; U; Linux i686; en<span class="hljs-literal"><span class="hljs-literal">-US</span></span>; rv:<span class="hljs-number"><span class="hljs-number">1.6</span></span>) Gecko/<span class="hljs-number"><span class="hljs-number">20040413</span></span> Epiphany/<span class="hljs-number"><span class="hljs-number">1.2</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> Host: internetradioserver.ru Cache<span class="hljs-literal"><span class="hljs-literal">-Control</span></span>: no<span class="hljs-literal"><span class="hljs-literal">-cache</span></span></code> </pre> <br>  En r√©ponse, un flux mp3 <s>sans fin</s> commence √† tomber, qui peut d√©j√† √™tre d√©cod√© et lu. <br><br>  L'ouverture d'une connexion TCP et d'autres joies de travailler avec l'ESP8266 se font √† l'aide des commandes AT.  Je ne m'attarderai pas sur eux, les informations sont compl√®tes sur Internet.  Tout est tr√®s bien peint dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">communaut√© russophone esp8266</a> .  La proc√©dure pour travailler avec elle est simple: <br><br>  1. Nous attendons une connexion WiFi, si elle n'est pas l√†, s√©lectionnez un r√©seau, entrez le mot de passe. <br>  2. Nous ouvrons la connexion TCP avec le serveur de la station de radio.  Les adresses de serveur, les ports et les noms de flux sont stock√©s directement dans la m√©moire flash du microcontr√¥leur, mais plus √† ce sujet plus tard. <br>  3. Envoyez la demande GET ci-dessus. <br>  4. Nous recevons en r√©ponse un flux mp3 continu. <br>  5. Si vous devez changer de station, fermez la connexion TCP et r√©p√©tez √† partir de l'√©tape 2. <br><br>  Je vais vous expliquer comment les stations p√©n√®trent dans la m√©moire flash du microcontr√¥leur.  Au d√©but, au stade de la v√©rification, j'ai simplement not√© les adresses, les num√©ros de port et les noms de flux dans l'une des pages de m√©moire du programme.  Mais au fil du temps, lorsque les appareils se sont dispers√©s entre parents et amis, j'ai d√ª ajouter la possibilit√© de mettre √† jour la liste de mani√®re centralis√©e.  Il a √©t√© d√©cid√© de cr√©er un serveur avec une IP fixe, sur lequel un fichier avec une liste de stations serait stock√©.  Lorsqu'il est connect√© via TCP, le serveur attend un mot de passe et √©met un fichier, et le microcontr√¥leur l'√©crit dans sa m√©moire flash.  Depuis que j'ai rencontr√© pour la premi√®re fois la cr√©ation de ¬´quelque chose sur Internet¬ª, j'ai √©t√© agr√©ablement surpris qu'il s'av√®re que louer une machine virtuelle avec une IP fixe ne co√ªte que 100 roubles par mois.  Miracles :) <br><br>  <b>Circuits</b> <br><br>  Ayant suffisamment jou√© avec STM32F4Discovery, j'ai d√©cid√© de faire ma propre carte, sur laquelle tous les √©l√©ments du r√©cepteur seront situ√©s, et je n'aurai pas besoin de tirer les fils vers l'√©cran ou les connecteurs.  Cela am√©liore consid√©rablement la fiabilit√© et la fabricabilit√© <s>et tout le monde en r√™ve</s> . <br><br>  Le sch√©ma peut √™tre t√©l√©charg√© ici.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">[DIAGRAMME]</a> .  Je ne l'ai pas d√©cor√©e ni peign√©e sp√©cialement pour la publication.  Il s'agit d'une option de travail, et cela devrait √™tre suffisant pour ceux qui sont vraiment int√©ress√©s. <br><br>  Le sch√©ma se compose des principales parties: <br><br>  1. MK STM32F415 avec un harnais - deux quartz et une batterie pour une horloge en temps r√©el. <br>  2. ESP8266 <br>  3. VS1053 avec cerclage strictement sur fiche technique.  Commenc√© sur MK via SPI. <br>  4. Puissance - deux r√©gulateurs lin√©aires LM1117 √† 3,3 et 1,8 volts. <br>  5. Affichage, connecteurs, boutons, potentiom√®tre.  Tout cela est institu√© sur le microcontr√¥leur GPIO. <br><br>  De plus, l'amplificateur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PAM8403</a> classe D n'est pas affich√© sur le sch√©ma, car il co√ªte un module achet√© s√©par√©ment. <br><br>  <b>Frais</b> <br><br>  Pour de bon, avant de fabriquer la carte, vous devez d√©terminer l'emplacement des √©l√©ments qui d√©passent du corps - boutons, connecteurs, affichage.  Alors je l'ai fait, mais √† propos de l'affaire plus tard. <br><br>  Le tableau s'est av√©r√© comme √ßa.  Attention fraise geek! <br><br><img src="https://habrastorage.org/files/2b5/487/9d8/2b54879d8f6d4bf98a54004cccaf298b.JPG" alt="image"><br><br><img src="https://habrastorage.org/files/c9b/e26/4f7/c9be264f79f147428eed3b0bab40d95b.JPG" alt="image"><br><br><img src="https://habrastorage.org/files/819/d14/f09/819d14f09d91481785ce9787f32160a2.JPG" alt="image"><br><br>  La planche est √† deux couches, d'une √©paisseur de 1,5 mm.  Tous les composants smd sont situ√©s sur un c√¥t√©, ce qui facilite l'installation automatique.  Cependant, cela ne lui est pas encore venu. <br><br>  J'ai d√©j√† √©t√© grond√© sur pikabu par plusieurs experts pour de petits d√©fauts dans le c√¢blage.  Cependant, le conseil fonctionne, et il fonctionne comme il se doit.  Je ne vois pas la valeur dans les dessins du tableau, donc je ne la poste pas.  S'il y a des demandes, je les posterai.  Quoi qu'il en soit, je vais le refaire.  Et bien s√ªr, une critique bien fond√©e est la bienvenue! <br><br>  <b>Logement</b> <br><br>  L'affaire est une douleur pour tous les ing√©nieurs en √©lectronique amateurs.  Et m√™me si vous n'√™tes pas un amateur, vous pouvez en faire un argumentaire pour votre argent. <br><br>  En petits lots, l'option la plus abordable est le fraisage ou la d√©coupe laser.  Avec des options en m√©tal, il peut toujours √™tre pli√© de la t√¥le, mais ce n'est pas mon cas.  J'ai donc choisi le fraisage de pi√®ces en bois + la d√©coupe laser de panneaux.  En termes de son, un bo√Ætier en bois est √©galement un √©norme avantage. <br><br>  Le r√©sultat a √©t√© cet ensemble de pi√®ces: <br><br><img src="https://habrastorage.org/files/0a9/510/970/0a9510970e2d4339982a28f32bdf729a.JPG" alt="image"><br><br>  Une attention particuli√®re m√©rite l'inscription.  Apr√®s m√ªre r√©flexion, comment les appliquer, il a √©t√© d√©cid√© de les r√©aliser par jointoiement.  Autrement dit, avec un moulin mince, l'inscription est s√©lectionn√©e sur le panneau, puis la peinture y est coul√©e.  Une fois la peinture s√®che, son exc√®s est √©limin√©.  Une op√©ration tr√®s co√ªteuse, mais je ne m'arr√™tais plus.  En outre, l'un des moyens les plus durables.  Si quelqu'un a de l'exp√©rience avec d'autres fa√ßons d'appliquer des √©tiquettes, veuillez partager. <br><br>  Voici √† quoi ressemblent les inscriptions r√©sultantes. <br><br><img src="https://habrastorage.org/files/05b/6e7/48c/05b6e748cb9e43aa9df7d02b72686eb8.JPG" alt="image"><br><br>  Et voici la radio assembl√©e de l'int√©rieur: <br><br><img src="https://habrastorage.org/files/02e/abe/567/02eabe56732143659518590266241998.JPG" alt="image"><br><br>  Et une autre photo √† l'ext√©rieur: <br><br><img src="https://habrastorage.org/files/e3c/f6b/ab8/e3cf6bab85ca4789ae85310c6257eee8.JPG" alt="image"><br><br>  Conclusion  Cet article d√©crit les d√©tails du d√©veloppement de l'appareil √† grands traits.  Il est assez difficile d'√©crire sur les d√©tails, d'une part par le fait que leur mer, d'autre part, chacun d'eux individuellement semble √©vidente.  Je pourrais √©crire sur un article s√©par√© sur les circuits, la carte de circuits imprim√©s, le firmware, en travaillant avec esp8266 et vs1053b, si j'obtiens suffisamment d'int√©r√™t, j'√©crirai.  Car je veux vraiment que la radio Internet devienne populaire. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr403239/">https://habr.com/ru/post/fr403239/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr403229/index.html">Jeux de cartes informatiques: Streamers √† regarder</a></li>
<li><a href="../fr403231/index.html">Backspace Invaders ou comment connecter un √©cran LED 64x64 √† Arduino</a></li>
<li><a href="../fr403233/index.html">NASA: Encelade a toutes les conditions pour l'origine et le maintien de la vie</a></li>
<li><a href="../fr403235/index.html">Pourquoi le second est-il plus int√©ressant que le premier: une note sur les nouvelles √©chelles Xiaomi</a></li>
<li><a href="../fr403237/index.html">Ajout d'un compteur SDM-220 √† OpenHab</a></li>
<li><a href="../fr403241/index.html">Demandez √† Ethan: Comment la mati√®re noire interagit-elle avec les trous noirs?</a></li>
<li><a href="../fr403245/index.html">Comment commencer √† assembler un quadricopt√®re ZMR250 / QAV250 avec Aliexpress (1 partie)</a></li>
<li><a href="../fr403247/index.html">Microsoft a corrig√© les vuln√©rabilit√©s zero-day dans ses logiciels bien avant qu'elles ne soient r√©v√©l√©es par Shadow Brokers</a></li>
<li><a href="../fr403249/index.html">Les plans de la NASA changent: les lancements de fus√©es lourdes de la NASA devraient souffrir</a></li>
<li><a href="../fr403253/index.html">La question est-elle raisonnable: pourquoi le principal probl√®me de la neurobiologie se refl√®te-t-il en physique?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>