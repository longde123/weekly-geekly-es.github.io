<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏿‍🚀 👶🏽 🔭 Compteur de CO2 🏬 👨🏼‍🚀 🙆🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une fois, assis au travail et mal à l'aise pour respirer, j'ai décidé d'assembler un compteur de CO2. 
 Après avoir étudié plusieurs articles sur ce s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Compteur de CO2</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/422001/">  Une fois, assis au travail et mal à l'aise pour respirer, j'ai décidé d'assembler un compteur de CO2. <br>  Après avoir étudié plusieurs articles sur ce sujet, il a formulé les exigences de l'appareil. <br><br><ol><li>  L'appareil doit être équipé d'un écran, car il doit s'agir d'un appareil portable. </li><li>  L'appareil ne doit pas dépendre d'Internet pour la même raison. </li><li>  L'appareil doit être capable d'enregistrer des valeurs dans le temps, qui sont pratiques à tout moment pour les visualiser.  Et cela signifie qu'il doit avoir son propre serveur Web et son propre point Wi-Fi. </li></ol><br>  Le dernier élément a conduit de manière ambiguë à l'entrée que l'appareil sera sur l'ESP.  Comme je n'ai pas besoin de hautes performances, je choisis l'option la moins chère - qui ESP8266, 07.  À la maison, une copie avec 1 Mo de mémoire traînait. <br><br>  J'ai commandé les pièces de rechange manquantes pour aliexpress, et elles étaient: <br><br><ol><li>  Écran Oled 96x64 SSD1331. </li><li>  Capteur de CO2 MH-Z19B. </li><li>  Module RTC DS1307. </li></ol><a name="habracut"></a><br>  Dès réception des détails, il a commencé à développer le circuit à l'aide de KiCad. <br><br>  Je dois dire tout de suite - toutes les sources seront à la fin de l'article et, après s'être assemblées selon les schémas, en téléchargeant le firmware, elles devraient obtenir un appareil pleinement fonctionnel. <br><br>  Le schéma est sorti comme ceci: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/586/54e/9f2/58654e9f2abb832f1884fdf9930289d4.png" alt="image"><br><br>  J'ai décidé de rendre les modules amovibles, donc il n'y a pas de modules sur le circuit, mais seulement des connecteurs pour eux. <br>  J'écarte la planche: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ecd/642/39d/ecd64239d067adf6cad3f5d93df58db7.png" alt="image"><br><br>  Après la fabrication de la carte de circuit imprimé et la soudure, les éléments suivants sont sortis: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/675/f89/3e5/675f893e5969c4d8a54754420949497b.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/725/db9/9d3/725db99d3353086b9b26c26471880f95.png" alt="image"><br><br>  En assemblage et au travail, cela ressemble à ceci: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/be2/7eb/fae/be27ebfae5e1f3a020ebdfd315f6a477.png" alt="image"><br><cut></cut><br>  Maintenant sur la partie logicielle. <br><br>  Le code a été écrit dans l'IDE Arduine, car je ne suis pas programmeur, et je ne voulais pas comprendre les bibliothèques dans le studio visuel ou ailleurs. <br><br>  En principe, j'ai utilisé le code des modules de l'appareil à partir d'exemples de bibliothèque et d'Internet, donc je ne m'y attarderai pas.  Qui veut - comprendre facilement le croquis. <br>  Mais il s'est avéré pas si simple de mettre en œuvre la visualisation et l'affichage des statistiques à temps. <br><br>  Je le voulais comme ça: depuis un téléphone portable ou un ordinateur portable, il est aussi facile que possible de se connecter à l'appareil, via le navigateur HTML, accédez à la page de données et affichez-le sous la forme d'un chronogramme. <br><br>  Tout d'abord, chez ESP, a créé un point d'accès sans mots de passe et authentifications. <br><br>  Le deuxième - a créé un tableau de données dans lequel j'écris des données de CO2 et l'heure de l'acquisition des données (pour cela, en fait, je règle l'horloge dans l'appareil. <br><br>  Troisièmement, j'ai installé un serveur HTTP et plusieurs pages HTML, sur l'une desquelles je produis des données. <br><br>  Quatrièmement - le script Java pour dessiner le graphique sur la page a été écrit dans le système de fichiers ESP. <br><br>  Étant donné que la sortie du graphique n'a été possible qu'avec l'aide de Java Script, après de longues expériences, le quatrième élément a été implémenté comme suit: le script Chart.js le plus simple a été écrit sous forme de fichier dans le système de fichiers SPIFFS ESP, qui demande une page affichant le résultat. <br><br>  En général, lors de la mise sous tension de l'appareil, sur l'affichage toutes les 10 à 15 secondes, les nouvelles lectures du capteur sont affichées et toutes les 8 minutes, les lectures actuelles du capteur sont enregistrées dans le tableau de données. <br><br>  Après un certain temps, voulant analyser les lectures dans le temps, vous vous connectez via votre téléphone ou ordinateur portable au point Wi-Fi «CO2», après la connexion démarrez le navigateur Internet et entrez l'adresse IP «10.10.10.1» dans la barre de recherche.  Vous accédez à la page: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bc3/9c1/a54/bc39c1a54ff54c02447343b017839d6c.png" alt="image"><br><br>  Il y a un bouton pour aller à la page d'affichage des données et un bouton pour aller à la page de réglage de l'heure (car le temps se perd parfois, et il se perd juste lorsque la batterie est remplacée). <br><br>  La page de sortie des données ressemble à ceci: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a8c/968/366/a8c9683666d6a32276df41c4da153c84.png" alt="image"><br><br>  <b>Archive avec la source <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici.</a></b> <br><br>  L'archive contient un croquis, Java Script, un projet Kicad, une impression au format Photoshop dans la résolution de 600 dpi, au cas où vous ne voudriez pas jouer avec Kicad. <br><br>  Comment configurer Adruino ide pour le firmware ESP et comment télécharger des fichiers sur SPIFS peut être facilement trouvé sur Internet. <br><br>  Pour le firmware ESP, vous devrez déconnecter le capteur de CO2, car il se bloque sur TX0 et RX0, qui sont nécessaires pour le firmware.  De plus, j'ai signé l'opposé sur la carte de ligne de données, de sorte que je connecte TX du clignotant à TX sur la carte, etc. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr422001/">https://habr.com/ru/post/fr422001/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr421983/index.html">L'apprentissage automatique aidera à réduire la population de glossines afin de réduire l'incidence de la maladie du sommeil</a></li>
<li><a href="../fr421985/index.html">GraphQL est l'avenir des microservices?</a></li>
<li><a href="../fr421991/index.html">Hébergez une application Web sur Amazon Web Services. Bon marché. Est-ce possible?</a></li>
<li><a href="../fr421993/index.html">Python intéressant et utile</a></li>
<li><a href="../fr421995/index.html">Différences entre la compilation d'un site Web et une application Web</a></li>
<li><a href="../fr422003/index.html">Coûts fixes et variables dans le développement de logiciels</a></li>
<li><a href="../fr422005/index.html">Cartouche Raspberry Pi NES</a></li>
<li><a href="../fr422007/index.html">Comment j'ai fait un onduleur interactif en ligne (partie 1)</a></li>
<li><a href="../fr422009/index.html">Algorithme hongrois, ou comment les mathématiques aident à assigner des devoirs</a></li>
<li><a href="../fr422011/index.html">Tournoi des jeunes physiciens</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>