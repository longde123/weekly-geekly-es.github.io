<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêØ üßìüèΩ üôèüèº Swift.assert - Leben nach der Ver√∂ffentlichung üîà üôÖüèª üï∫üèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wie oft verwenden Sie Swift.assert() in Ihrem Code? Ich benutze es ehrlich gesagt ziemlich oft (Wenn dies eine schlechte Praxis ist, dann schreibe bit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Swift.assert - Leben nach der Ver√∂ffentlichung</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476792/"> Wie oft verwenden Sie <code>Swift.assert()</code> in Ihrem Code?  Ich benutze es ehrlich gesagt ziemlich oft (Wenn dies eine schlechte Praxis ist, dann schreibe bitte in die Kommentare - warum ist es schlecht?).  In meinem Code sieht man zum Beispiel oft einen solchen Aufruf: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Swift</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">assert</span></span>(<span class="hljs-type"><span class="hljs-type">Thread</span></span>.isMainThread)</code> </pre> <br>  Vor nicht allzu langer Zeit habe ich beschlossen, dass es sch√∂n w√§re, die Ergebnisse dieser Aufrufe weiterhin zu beobachten, nicht nur als Teil des Starts der Anwendung im Simulator / Ger√§t, sondern auch aufgrund der Aktionen realer Benutzer.  √úbrigens k√∂nnen wir hier √ºber <code>Swift.precondition()</code> , <code>Swift.fatalError()</code> usw. sprechen, obwohl ich versuche, sie zu vermeiden.  Ich habe <a href="https://habr.com/ru/post/440884/">in dieser Ver√∂ffentlichung</a> mehr √ºber nicht <i>behebbare Fehler in Swift</i> gelesen und es hat sich als sehr informativ herausgestellt. <br><br>  N√§her am Punkt: <a name="habracut"></a>  im code habe ich ca. 300 solche anrufe gefunden.  Keiner von ihnen arbeitete w√§hrend der √ºblichen lokalen Tests, und es hat mir gefallen.  Ich schlug jedoch vor, dass Benutzeraktionen dennoch einige der Aufrufe ausl√∂sen k√∂nnten. <br><br>  Aus Sicht des Benutzers sollten Abst√ºrze nicht auftreten (meiner Meinung nach auch hier).  In extremen F√§llen muss der Benutzer verstehen, dass ein Szenario fehlgeschlagen ist und das Entwicklungsteam bereits daran arbeitet, es zu beheben.  √Ñhnliche Ausnahmen wurden von mir immer behandelt, und f√ºr den Benutzer k√∂nnte es in der harmlosesten Form beeinflussen.  Beispielsweise war eine von Hunderten von Tabellenzellen einfach unsichtbar. <br><br>  Mit dem Benutzer ist mehr oder weniger alles klar.  Es bleibt die Zustellung der Protokolle an den Entwickler zu erledigen.  Erstens war es mit minimalem Aufwand erforderlich, aktuelle Anrufe im Code durch Anrufe zu ersetzen, die Protokolle irgendwo au√üerhalb der Anwendung senden.  Zweitens musste der Ort des Vorfalls genau lokalisiert werden, da es sonst praktisch unm√∂glich w√§re, die Ausnahme mit dem tats√§chlichen Code zu korrelieren.  Drittens sollte beachtet werden, dass ge√§nderte Aufrufe w√§hrend des Unit-Tests funktionieren k√∂nnen, wobei <code>Thread.isMainThread</code> bereits ignoriert werden sollte.  Ich verwende das <b>RxTest-</b> Framework f√ºr bestimmte Testarten (hier bin ich auch bereit, Ratschl√§ge und Kritik zu h√∂ren).  Der Hauptpunkt blieb, dass lokal alle Ausnahmen wie zuvor ausgel√∂st werden sollten, d.h.  <code>Loggin.assert()</code> sollte zur gleichen Zeit <code>Swift.assert()</code> wie <code>Swift.assert()</code> <br><br>  <b>Fabric</b> ( <b>Crashlytics</b> ) bietet eine hervorragende M√∂glichkeit, Ereignisse zu senden.  Es sieht so aus: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Crashlytics</span></span>.sharedInstance().recordCustomExceptionName(<span class="hljs-string"><span class="hljs-string">""</span></span>, reason: <span class="hljs-string"><span class="hljs-string">""</span></span>...</code> </pre> <br>  Es bleibt <b>Crashlytics</b> in ein Framework zu packen, das <b>vollst√§ndig</b> in die Anwendung und in abgeschnittener Form (ohne <b>Crashlytics-</b> Abh√§ngigkeit) in Testzielen geladen werden kann. <br><br>  Ich entschied mich f√ºr das ‚Äû <a href="https://cocoapods.org/">Verpacken</a> ‚Äú mit <a href="https://cocoapods.org/">CocoaPods</a> : <br><br><pre> <code class="ruby hljs">Pod::Spec.new <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|s|</span></span> s.name = <span class="hljs-string"><span class="hljs-string">'Logging'</span></span> ... s.subspec <span class="hljs-string"><span class="hljs-string">'Base'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|ss|</span></span> ss.source_files = <span class="hljs-string"><span class="hljs-string">'Source/Logging+Base.swift'</span></span> ss.dependency <span class="hljs-string"><span class="hljs-string">'Crashlytics'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> s.subspec <span class="hljs-string"><span class="hljs-string">'Test'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-params"><span class="hljs-params">|ss|</span></span> ss.source_files = <span class="hljs-string"><span class="hljs-string">'Source/Logging+Test.swift'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  Der Code f√ºr das "Kampfziel" lautet wie folgt: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Crashlytics public enum Logging { public static func send(_ reason: String? = nil, __file: String = #file, __line: Int = #line) { let file = __file.components(separatedBy: "/").last ?? __file let line = "\(__line)" let name = [line, file].joined(separator: "_") Crashlytics.sharedInstance().recordCustomExceptionName(name, reason: reason ?? "no reason", frameArray: []) } public static func assert(_ assertion: @escaping @autoclosure () -&gt; Bool, reason: String? = nil, __file: String = #file, __line: Int = #line) { if assertion() == false { self.assertionFailure(reason, __file: __file, __line: __line) } } public static func assert(_ assertion: @escaping () -&gt; Bool, reason: String? = nil, __file: String = #file, __line: Int = #line) { if assertion() == false { self.assertionFailure(reason, __file: __file, __line: __line) } } public static func assertionFailure(_ reason: String? = nil, __file: String = #file, __line: Int = #line) { Swift.assertionFailure(reason ?? "") self.send(reason, __file: __file, __line: __line) } }</code> </pre> <br>  F√ºr das "Testziel" dh  ohne <b>Crashlytics-</b> Abh√§ngigkeit: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Foundation public enum Logging { public static func send(_ reason: String? = nil, __file: String = #file, __line: Int = #line) { <span class="hljs-comment"><span class="hljs-comment">// } public static func assert(_ assertion: @escaping @autoclosure () -&gt; Bool, reason: String? = nil, __file: String = #file, __line: Int = #line) { // } public static func assert(_ assertion: @escaping () -&gt; Bool, reason: String? = nil, __file: String = #file, __line: Int = #line) { // } public static func assertionFailure(_ reason: String? = nil, __file: String = #file, __line: Int = #line) { // } }</span></span></code> </pre> <br><h2>  Ergebnisse: </h2><br>  Ausnahmen begannen wirklich zu wirken.  Die meisten von ihnen meldeten ein falsches Format f√ºr die empfangenen Daten: <code>Decodable</code> manchmal empfangene Daten mit dem <code>Decodable</code> Typ.  Manchmal <code>Thread.isMainThread</code> die Protokolle f√ºr <code>Thread.isMainThread</code> , die in den n√§chsten Releases sehr schnell behoben wurden.  Die interessantesten Fehler wurden auf wundersame Weise von <b>NSException abgefangen</b> . <br><br>  Vielen Dank f√ºr Ihre Aufmerksamkeit. <br><br>  <b>PS</b> Wenn Sie solche Protokolle zu oft an <b>Crashlytics</b> senden, <b>erkennt</b> der Dienst Ihre Aktionen m√∂glicherweise als Spam.  Und Sie werden die folgende Meldung sehen: <br><blockquote>  Aufgrund nicht bestimmungsgem√§√üer Verwendung wurde die nicht schwerwiegende Berichterstellung f√ºr mehrere Builds deaktiviert.  Weitere Informationen zum erneuten Aktivieren der Berichterstellung finden Sie in unserer Dokumentation. </blockquote>  Daher ist es empfehlenswert, die H√§ufigkeit des Versendens von Protokollen im Voraus zu ber√ºcksichtigen.  Andernfalls besteht die Gefahr, dass alle Build-Protokolle von <b>Crashlytics</b> ignoriert werden <b>.</b> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de476792/">https://habr.com/ru/post/de476792/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de476772/index.html">DeepPavlov f√ºr Entwickler: # 2 Setup und Bereitstellung</a></li>
<li><a href="../de476774/index.html">Playme TAU DVR Bewertung: Magnethalterung, billig</a></li>
<li><a href="../de476778/index.html">Gorp.NET - eine neue Bibliothek zum Erstellen von Reverse-Vorlagen zum Extrahieren von Daten aus strukturiertem Text</a></li>
<li><a href="../de476786/index.html">Zertifizierung von Foto- / Videoaufzeichnungssystemen von Straftaten und Systemen des Segments Transportsicherheit</a></li>
<li><a href="../de476788/index.html">Warum wird 3D-Druck die Welt ver√§ndern?</a></li>
<li><a href="../de476796/index.html">√úberlegungen zum perfekten K√∂rper</a></li>
<li><a href="../de476798/index.html">Wir untersuchen den Aufbau des RAM-Chips am Beispiel des Hynix GDDR3 SDRAM</a></li>
<li><a href="../de476806/index.html">MPS 2019.2: Aufz√§hlung von Datentypen, Anpassung von Fehlermeldungen, √úbergang zu JDK 11 und vieles mehr</a></li>
<li><a href="../de476812/index.html">Notizen √ºber alles. Einfache und gef√§hrliche Netzteile</a></li>
<li><a href="../de476816/index.html">Dubai Mall in einem Smartphone oder wie Sie Ihrer Anwendung einen Grundriss eines Geb√§udes hinzuf√ºgen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>