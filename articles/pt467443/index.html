<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üèùÔ∏è üë∂üèæ üë©‚Äçüë©‚Äçüë¶‚Äçüë¶ Centro Multim√≠dia "Kodi" e Projeto Yocto ü§ù üèª ‚úã</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introdu√ß√£o ao Projeto Yocto 
 O Yocto Project √© um projeto colaborativo de c√≥digo aberto para simplificar o desenvolvimento de distribui√ß√µes para sist...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Centro Multim√≠dia "Kodi" e Projeto Yocto</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/467443/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/q_/p2/ue/q_p2uexsi7n5tjnthirivhuwq2o.png"></div><br><h2>  Introdu√ß√£o ao Projeto Yocto </h2><br>  O Yocto Project √© um projeto colaborativo de c√≥digo aberto para simplificar o desenvolvimento de distribui√ß√µes para sistemas embarcados.  O Yocto cont√©m um grande n√∫mero de modelos, metadados e ferramentas de constru√ß√£o.  No Yocto Project, voc√™ pode conectar um grande n√∫mero de camadas BSP (pacote de suporte de plataforma) para todos os tipos de plataformas de hardware. <br><br>  O principal objetivo do artigo √© uma tentativa de mostrar a montagem de um pacote de distribui√ß√£o t√≠pico no Projeto Yocto usando o exemplo do conhecido centro multim√≠dia Kodi, vers√£o 17.6, para o computador de placa √∫nica Raspberry Pi 3B. <br><br>  Se em algum lugar no fundo da sua alma voc√™ sente que √© colecionador, mas ainda n√£o decidiu o que gostaria de colecionar, ent√£o este artigo √© para voc√™.  Se voc√™ j√° usa o Projeto Yocto em seu trabalho di√°rio, pode rolar este artigo.  V√° direto para o √∫ltimo cap√≠tulo e prepare-se. <br><br>  O artigo √© puramente pr√°tico e demonstra a possibilidade de usar as realiza√ß√µes do Projeto Yocto e do OpenEmbedded para construir o centro multim√≠dia "Kodi".  As camadas Yocto s√£o gerenciadas usando o utilit√°rio Repo do Google.  Um artigo no documento desta s√©rie. <br><br>  Ent√£o: vamos l√°. <br><a name="habracut"></a><br><h2>  Conte√∫do: </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Instale o</a> Projeto Yocto no Ubuntu <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Mecanismo de</a> constru√ß√£o de distribui√ß√£o no Projeto Yocto <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Usando o</a> OpenEmbedded com o projeto Yocto <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pacote de</a> suporte de plataforma (BSP) <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Gerenciar</a> camadas Yocto com Repo <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Instalar</a> reposit√≥rio <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Manifesto de</a> Constru√ß√£o de Distribui√ß√£o <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Conte√∫do do</a> manifesto <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Descri√ß√£o do</a> manifesto <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Estrutura do</a> manifesto Bs <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Inicializando</a> Vari√°veis ‚Äã‚ÄãPoky <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Inicializa√ß√£o de</a> reposit√≥rio <br>  Repo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Sync</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Criando</a> uma configura√ß√£o de projeto Yocto <br>  Arquivo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">configura√ß√£o</a> build / conf / local.conf <br>  Arquivo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">configura√ß√£o</a> build / conf / bblayers.conf <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Camada</a> para montagem de um centro multim√≠dia <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Estrutura de</a> camada <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Configura√ß√£o de</a> camada <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Composi√ß√£o de</a> receitas-berserk <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Composi√ß√£o de</a> receitas-core <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Composi√ß√£o de</a> receitas-kernel <br>  Receitas de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">composi√ß√£o</a> -mediacentre <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Composi√ß√£o de</a> receitas-multim√≠dia <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Suplemento de receita de</a> compila√ß√£o Kodi <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Adicionando um novo</a> item ao menu de configura√ß√µes do Kodi <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Configura√ß√µes m√°ximas de</a> buffer para v√≠deo <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Assistindo TV</a> por IPTV <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Assistindo ao Youtube</a> com o plug-in Kodi <br>  Extens√£o de configura√ß√£o de rede do shell do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">console</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Receita de</a> Constru√ß√£o de Distribui√ß√£o <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Um breve</a> guia para criar uma imagem de distribui√ß√£o <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Postscript</a> <br><br><a name="install_yocto_koditv"></a><h2>  Instale o Projeto Yocto no Ubuntu </h2><br>  Para construir a distribui√ß√£o usando o Projeto Yocto no Ubuntu, voc√™ precisa instalar os seguintes pacotes: <br><br><pre><code class="bash hljs">sudo apt-get install -y --no-install-suggests --no-install-recommends \ gawk wget git-core diffstat unzip texinfo gcc-multilib \ build-essential chrpath socat cpio python python3 python3-pip python3-pexpect \ xz-utils debianutils iputils-ping python3-git python3-jinja2 libegl1-mesa libsdl1.2-dev \ xterm</code> </pre> <br>  Os pacotes s√£o instalados usando o comando <strong>apt-get install</strong> e o <strong>comando sudo, da</strong> escala√ß√£o de privil√©gios.  No sistema Ubuntu, essa √© uma pr√°tica generalizada quando o comando sudo √© usado para executar a√ß√µes administrativas (ao criar o usu√°rio principal do sistema, ele √© automaticamente registrado no grupo ‚Äúsudo‚Äù). <br><br>  Voc√™ pode ver instru√ß√µes de instala√ß√£o mais detalhadas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui:</a> <br><br><a name="mechanism_build_koditv"></a><h2>  Mecanismo de constru√ß√£o de distribui√ß√£o no Projeto Yocto </h2><br>  No Projeto Yocto, cada unidade de programa √© descrita usando uma receita de montagem.  A linguagem de descri√ß√£o da receita se assemelha a "bash", com a capacidade de inserir partes de c√≥digo na linguagem python.  Voc√™ pode obter informa√ß√µes b√°sicas de sintaxe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">no manual do Yocto Project</a> .  Um conjunto de receitas de montagem, dependendo da finalidade, pode ser combinado em camadas de montagem separadas. <br><br>  As camadas s√£o divididas em dependentes de hardware - camadas BSP, camadas da interface do usu√°rio (interface do usu√°rio), camadas Yocto espec√≠ficas e camadas que implementam determinadas funcionalidades: <br>  por exemplo, camadas do OpenEmbedded =&gt; multim√≠dia, python, perl, ruby, rede, systemd, servidor da web etc. <br><br><a name="openembedded_koditv"></a><h2>  Usando o OpenEmbedded com o projeto Yocto </h2><br>  E, no entanto, se voc√™ usar o Projeto Yocto, com certeza precisar√° de camadas com funcionalidade adicional, ou seja,  Um grande conjunto de receitas para todas as ocasi√µes.  E existe esse conjunto - estas s√£o receitas do OpenEmbedded.  O OpenEmbedded √© uma infraestrutura para a constru√ß√£o de pacotes para Linux embarcado. <br><br>  O OpenEmbedded √© totalmente compat√≠vel com o Projeto Yocto, pois esse projeto foi tomado como base para o Projeto Yocto.  Talvez seja por isso que o Yocto Project tenha estabilidade um pouco melhor, melhor documenta√ß√£o e suporte um pouco melhor (mas basicamente ainda √© o mesmo OpenEmbedded). <br><br><a name="package_bsp_koditv"></a><h2>  Pacote de suporte de plataforma (BSP) </h2><br>  O Pacote de suporte da placa √© uma camada especializada separada para uma placa espec√≠fica que define os recursos de hardware da plataforma, ou seja,  implementa itens espec√≠ficos que distinguem uma placa da outra: recursos do processador, interrup√ß√µes, endere√ßamento, recursos do carregador de inicializa√ß√£o, recursos do adaptador de v√≠deo (GPU) etc. <br><br>  Este artigo usa a camada BSP - <strong>meta-raspberrypi</strong> <br>  O reposit√≥rio de camadas est√° localizado em: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">git.yoctoproject.org/git/meta-raspberrypi</a> <br><br><a name="repo_koditv"></a><h2>  Gerenciar camadas Yocto com Repo </h2><br>  O Yocto Project pode usar um grande n√∫mero de camadas de diferentes fornecedores - desenvolvedores de equipamentos, e tudo isso precisa ser gerenciado de alguma forma.  Imagine que voc√™ tem uma d√∫zia de placas diferentes e cada placa vem com um reposit√≥rio BSP git separado, e isso n√£o conta a infraestrutura do projeto Yocto, al√©m de uma poss√≠vel funcionalidade adicional do OpenEmbedded. <br><br>  Em tal situa√ß√£o, voc√™ n√£o precisar√° usar um script de instala√ß√£o simples separado.  √Ä vontade, precisa procurar ferramentas que possam fazer isso bem.  Ainda mais que bom.  Uma das melhores ferramentas desse tipo √© o utilit√°rio Google - Repo. <br><br>  <strong>O Repo</strong> √© a principal ferramenta para gerenciar reposit√≥rios GIT ao criar o sistema operacional Android com sua grande base de c√≥digos.  O Repo permite gerenciar uma d√∫zia, se n√£o uma centena de reposit√≥rios git separados em um projeto, cujas vers√µes voc√™ pode especificar com cuidado em um arquivo xml do <strong>Manifesto</strong> <br><br>  e para a sincroniza√ß√£o correta de todas as vers√µes de todos os reposit√≥rios, basta executar um comando <br><br>  <strong>sincroniza√ß√£o de reposit√≥rio</strong> <br><br><a name="install_repo_koditv"></a><h3>  Instalar reposit√≥rio </h3><br>  Usando o seguinte conjunto de comandos, voc√™ pode instalar o Repo no diret√≥rio inicial <strong>~ / bin</strong> <br>  (o comando curl pode ser instalado separadamente: sudo apt-get install curl) <br><br><pre> <code class="bash hljs">PATH=<span class="hljs-variable"><span class="hljs-variable">${PATH}</span></span>:~/bin mkdir ~/bin curl http://commondatastorage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo chmod a+x ~/bin/repo</code> </pre><br><br>  e no futuro voc√™ s√≥ precisa usar o comando no console: <strong>repo</strong> <br><br><blockquote>  mais ou menos <br>  se o diret√≥rio HOME / bin n√£o for adicionado automaticamente ao caminho de inicializa√ß√£o padr√£o <br>  veja o arquivo HOME / .profile <br><br>  $ <br>  $ PATH = $ {PATH}: ~ / bin <br>  $ repo <br>  $ <br></blockquote><br><a name="manifest_repo_koditv"></a><h3>  Manifesto de Constru√ß√£o de Distribui√ß√£o </h3><br>  A distribui√ß√£o coletada na estrutura do artigo, preciso chamar de algo.  Que seja o nome <strong>Torvin</strong> .  Com o nome de c√≥digo Torvin, ele conter√° uma distribui√ß√£o Linux minimalista com a montagem de um √∫nico programa.  Isso se refere a um programa de usu√°rio de aplicativo - Kodi e nada mais (tudo o resto √© no n√≠vel do sistema).  Para um centro multim√≠dia, na minha opini√£o, isso √© suficiente. <br><br><a name="context_repo_koditv"></a><h3>  Conte√∫do do manifesto </h3><br>  O arquivo <strong>torvin-0.2.5.xml</strong> √© usado para gerenciar as camadas de distribui√ß√£o <strong>.</strong> <br><br><pre> <code class="xml hljs"> <span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">default</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sync-j</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"4"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">revision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rocko"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">remote</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fetch</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://git.yoctoproject.org/git"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yocto"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">remote</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fetch</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://github.com/openembedded"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oe"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">remote</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fetch</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://github.com/berserktv"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bs"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">remote</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">revision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"master"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bs-manifest"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sources/bs-manifest"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">linkfile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dest</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"setup-environment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"setup-environment"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">linkfile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dest</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shell.sh"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"raspberry/shell.sh"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">linkfile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dest</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sources/base"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"raspberry/rocko"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">remote</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yocto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">revision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rocko"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"poky"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sources/poky"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">remote</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"oe"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">revision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rocko"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"meta-openembedded"</span></span></span><span class="hljs-tag"> \ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sources/meta-openembedded"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">remote</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"yocto"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">revision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rocko"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"meta-raspberrypi"</span></span></span><span class="hljs-tag"> \ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sources/meta-raspberrypi"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">remote</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">revision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rocko"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"berserk"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sources/berserk"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><a name="desc_repo_koditv"></a><h3>  Descri√ß√£o do manifesto </h3><br>  No in√≠cio do manifesto, <strong>as</strong> tags <strong>remotas</strong> denotam dois reposit√≥rios GIT principais e um auxiliar: <br><br>  <strong>https: ‚ÅÑ‚ÅÑgit.yoctoproject.org / git</strong> - reposit√≥rio Yocto nomeado como <strong>yocto</strong> <br>  <strong>https: ‚ÅÑ‚ÅÑgithub.com / openembedded</strong> - reposit√≥rio OpenEmbedded nomeado como <strong>oe</strong> <br>  https: ‚ÅÑ‚ÅÑgithub.com / berserktv - reposit√≥rio GIT auxiliar nomeado como <strong>bs</strong> <br><br>  Na pr√≥xima parte do manifesto, usando nomes abreviados, trabalhamos com projetos localizados nesses reposit√≥rios, a tag do <strong>projeto</strong> cont√©m os seguintes atributos: <br><br>  <strong>remote</strong> - o nome do reposit√≥rio nomeado remoto <br>  <strong>revis√£o</strong> - o nome da ramifica√ß√£o ou vers√£o do hash <br>  <strong>nome</strong> - nome do projeto no reposit√≥rio especificado <br>  <strong>path</strong> - o caminho do projeto local em seu sistema de arquivos <br><br><pre> <code class="html hljs xml">   <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">remote</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">revision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"master"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bs-manifest"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sources/bs-manifest"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span>  xml      : git clone https://github.com/berserktv/bs-manifest -b master sources/bs-manifest</code> </pre><br>  No corpo da tag do <strong>projeto</strong> , indiquei comandos para criar links simb√≥licos para a infraestrutura de scripts auxiliares de inicializa√ß√£o inicial e in√≠cio regular do sistema de constru√ß√£o <strong>Poky de</strong> que <strong>preciso</strong> <br><br><pre> <code class="html hljs xml">   linkfile <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">remote</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bs"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">revision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"master"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bs-manifest"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sources/bs-manifest"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">linkfile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dest</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"setup-environment"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"setup-environment"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">linkfile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dest</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"shell.sh"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"raspberry/shell.sh"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">linkfile</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">dest</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"sources/base"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"raspberry/rocko"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span>        : ln -s src dest .. #      ln -s sources/bs-manifest/setup-environment setup-environment ln -s sources/bs-manifest/raspberry/shell.sh shell.sh #    ,  #      cd sources ln -s bs-manifest/raspberry/rocko base</code> </pre><br><a name="struct_repo_koditv"></a><h3>  Estrutura do manifesto Bs </h3><br><pre> COP‚îÄ‚îÄ COPYING.MIT
 ‚îú‚îÄ‚îÄ framboesa
 ‚îÇ ‚îú‚îÄ‚îÄ rocko
 ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ conf
 B ‚îÇ ‚îÇ ‚îÄ‚îÄ‚îÄ bblayers.conf
 Local ‚îÇ ‚îÇ‚îÄ‚îÄ local.conf
 Tor ‚îÇ ‚îî‚îÄ‚îÄ torvin-0.2.5.xml
 Shell ‚îî‚îÄ‚îÄ shell.sh
 ‚îú‚îÄ‚îÄ README.md
 Setup‚îÄ‚îÄ ambiente de instala√ß√£o
</pre><br><br>  O projeto <strong>bs-manifest</strong> √© usado para gerenciamento flex√≠vel de configura√ß√£o, levando em considera√ß√£o os assemblies de diferentes vers√µes da distribui√ß√£o.  Eu tenho esta vers√£o - 0.2.5 <br><br><a name="env_repo_koditv"></a><h3>  Inicializando Vari√°veis ‚Äã‚ÄãPoky </h3><br>  O <strong>ambiente de configura√ß√£o do</strong> script de inicializa√ß√£o foi retirado do projeto Freescale Community (no ambiente yocto, essa √© uma solu√ß√£o comum).  O script √© respons√°vel pela inicializa√ß√£o das vari√°veis ‚Äã‚Äãdo sistema de constru√ß√£o Poky, o script cria uma estrutura de diret√≥rios na qual est√° muito bem dividido: <br><br><ul><li>  <strong>build</strong> - diret√≥rio de <strong>build</strong> </li><li>  <strong>source</strong> - c√≥digo fonte de receitas de montagem </li><li>  <strong>download</strong> - diret√≥rio para baixar o c√≥digo do programa (bancos de dados git, arquivos tar.gz) </li></ul><br>  O conte√∫do do script setup-environment pode ser visto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui:</a> <br><br><div class="spoiler">  <b class="spoiler_title">Conte√∫do do script Shell.sh</b> <div class="spoiler_text"><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment">#!/bin/bash MACHINE='raspberrypi3' source ./setup-environment build echo "you may try 'bitbake core-image-minimal'" bash</span></span></code> </pre><br></div></div><br>  Esse script raiz serve para inicializar as vari√°veis ‚Äã‚Äãde configura√ß√£o do ambiente de constru√ß√£o e geralmente √© chamado no in√≠cio de uma sess√£o. <br><br><a name="init_repo_koditv"></a><h3>  Inicializa√ß√£o de reposit√≥rio </h3><br>  Para inicializar o repo, voc√™ deve executar o comando: <br><br><pre> <code class="bash hljs">mkdir torvin <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> torvin repo init -u https:‚ÅÑ‚ÅÑgithub.com/berserktv/bs-manifest -m raspberry/rocko/torvin-0.2.5.xml</code> </pre><br>  where <strong>-u https: ‚ÅÑ‚ÅÑgithub.com / berserktv / bs-manifest</strong> informa ao GIT o caminho para o projeto manifest <br><br>  nota: voc√™ tamb√©m pode especificar <strong>-b tree_name</strong> <br>  (se voc√™ n√£o especificar a op√ß√£o -b, a ramifica√ß√£o principal ser√° assumida (por padr√£o)) <br><br>  em que o caminho <strong>-m raspberry / rocko / torvin-0.2.5.xml</strong> para o arquivo de configura√ß√£o indica o seguinte: <br><br><ol><li>  O nome da plataforma de hardware para a qual a montagem est√° sendo executada - <strong>raspberry</strong> </li><li>  O nome da principal ramifica√ß√£o do trabalho Yocto / OpenEmbedded √© <strong>rocko</strong> </li><li>  O nome de c√≥digo da vers√£o √© <strong>torvin</strong> (todas as vers√µes da s√©rie 0.2.x) </li><li>  O n√∫mero da vers√£o digital que est√° sendo montada √© <strong>0.2.5</strong> </li></ol><br><a name="sync_repo_koditv"></a><h3>  Repo Sync </h3><br>  para iniciar ou sincronizar subsequentemente, basta executar o comando: <br><br><pre> <code class="bash hljs">repo sync</code> </pre><br>  que selecionar√° todas as vers√µes mais recentes dos projetos GIT especificadas no arquivo de manifesto (as ramifica√ß√µes geralmente s√£o indicadas), se voc√™ tiver um nome de hash ou tag no atributo de revis√£o, a vers√£o desse reposit√≥rio git n√£o ser√° alterada.  O nome da tag pode ser especificado assim: revision = "refs / tags / v0.2.5" <br><br><a name="config_koditv"></a><h3>  Criando uma configura√ß√£o de projeto Yocto </h3><br>  Ap√≥s a execu√ß√£o do comando repo sync, voc√™ pode come√ßar a criar a configura√ß√£o principal do Projeto Yocto: <br><br><pre> <code class="bash hljs">./shell.sh</code> </pre><br>  ap√≥s a conclus√£o do script, o diret√≥rio <strong>build / conf</strong> ser√° criado: <br>  com dois arquivos principais: <br><br><ul><li>  <strong>local.conf</strong> - vari√°veis ‚Äã‚Äãde controle de montagem: <br>  nome da plataforma, tipo de distribui√ß√£o e pacotes de compila√ß√£o, etc. </li><li>  <strong>bblayers.conf</strong> - configura√ß√£o das camadas conectadas do projeto Yocto </li></ul><br>  Por padr√£o, o script setup-environment procura <strong>fontes / base / conf</strong> <br>  configura√ß√£o inicial e se os <strong>arquivos local.conf</strong> e <strong>bblayers.conf</strong> <br>  existir, eles s√£o copiados para <strong>criar / conf</strong> <br>  (consulte a vari√°vel TEMPLATES no ambiente de configura√ß√£o) <br><br>  isto √©  arquivos s√£o obtidos de fontes / bs-manifest / raspberry / rocko / conf <br>  veja a cria√ß√£o de um link simb√≥lico para basear <br><br><a name="local_conf_config_koditv"></a><h3>  Arquivo de configura√ß√£o build / conf / local.conf </h3><br><div class="spoiler">  <b class="spoiler_title">Mostrar / Ocultar</b> <div class="spoiler_text"><pre> <code class="bash hljs"> MACHINE ??= <span class="hljs-string"><span class="hljs-string">'raspberrypi3'</span></span> DISTRO ?= <span class="hljs-string"><span class="hljs-string">'poky'</span></span> PACKAGE_CLASSES ?= <span class="hljs-string"><span class="hljs-string">"package_deb"</span></span> EXTRA_IMAGE_FEATURES ?= <span class="hljs-string"><span class="hljs-string">"debug-tweaks"</span></span> USER_CLASSES ?= <span class="hljs-string"><span class="hljs-string">"buildstats image-mklibs image-prelink"</span></span> PATCHRESOLVE = <span class="hljs-string"><span class="hljs-string">"noop"</span></span> BB_DISKMON_DIRS = <span class="hljs-string"><span class="hljs-string">"\ STOPTASKS,</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${TMPDIR}</span></span></span><span class="hljs-string">,1G,100K \ STOPTASKS,</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DL_DIR}</span></span></span><span class="hljs-string">,1G,100K \ STOPTASKS,</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${SSTATE_DIR}</span></span></span><span class="hljs-string">,1G,100K \ STOPTASKS,/tmp,100M,100K \ ABORT,</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${TMPDIR}</span></span></span><span class="hljs-string">,100M,1K \ ABORT,</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${DL_DIR}</span></span></span><span class="hljs-string">,100M,1K \ ABORT,</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${SSTATE_DIR}</span></span></span><span class="hljs-string">,100M,1K \ ABORT,/tmp,10M,1K"</span></span> PACKAGECONFIG_append_pn-qemu-native = <span class="hljs-string"><span class="hljs-string">" sdl"</span></span> PACKAGECONFIG_append_pn-nativesdk-qemu = <span class="hljs-string"><span class="hljs-string">" sdl"</span></span> CONF_VERSION = <span class="hljs-string"><span class="hljs-string">"1"</span></span> DL_DIR ?= <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${BSPDIR}</span></span></span><span class="hljs-string">/downloads/"</span></span> <span class="hljs-comment"><span class="hljs-comment"># size memory GPU for Raspberry Pi GPU_MEM = "128" GPU_MEM_256 = "112" GPU_MEM_512 = "160" GPU_MEM_1024 = "320" # for libs: "mpeg2dec libmad ffmpeg x264" LICENSE_FLAGS_WHITELIST += "commercial"</span></span></code> </pre><br></div></div><br><a name="bblayers_conf_config_koditv"></a><h3>  Arquivo de configura√ß√£o build / conf / bblayers.conf </h3><br><div class="spoiler">  <b class="spoiler_title">Mostrar / Ocultar</b> <div class="spoiler_text"><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment"># POKY_BBLAYERS_CONF_VERSION is increased each time build/conf/bblayers.conf # changes incompatibly LCONF_VERSION = "6" POKY_BBLAYERS_CONF_VERSION = "2" BBPATH = "${TOPDIR}" BSPDIR := \ "${@os.path.abspath(os.path.dirname(d.getVar('FILE', True)) + '/../..')}" BBFILES ?= "" BBLAYERS ?= " \ ${BSPDIR}/sources/poky/meta \ ${BSPDIR}/sources/poky/meta-poky \ ${BSPDIR}/sources/poky/meta-yocto-bsp \ ${BSPDIR}/sources/meta-openembedded/meta-oe \ ${BSPDIR}/sources/meta-openembedded/meta-python \ ${BSPDIR}/sources/meta-openembedded/meta-networking \ ${BSPDIR}/sources/meta-openembedded/meta-multimedia \ ${BSPDIR}/sources/meta-openembedded/meta-filesystems \ ${BSPDIR}/sources/meta-raspberrypi \ ${BSPDIR}/sources/berserk/meta-berserk \ "</span></span></code> </pre><br></div></div><br><br>  as principais vari√°veis ‚Äã‚Äãdo arquivo local.conf - √†s quais voc√™ precisa prestar aten√ß√£o: <br><br><ul><li>  M√ÅQUINA - o nome da plataforma sob a qual a montagem √© realizada </li><li>  DISTRO - nome da categoria de distribui√ß√£o </li><li>  PACKAGE_CLASSES - formato do pacote para instala√ß√£o do software </li><li>  LICENSE_FLAGS_WHITELIST - uso de licen√ßas adicionais </li></ul><br>  configura√ß√µes espec√≠ficas para a fam√≠lia de placas Raspberry Pi <br><br><ul><li>  GPU_MEM = "128" - a quantidade de mem√≥ria de v√≠deo para o adaptador de v√≠deo GPU (alocado da RAM) </li><li>  GPU_MEM_256 = "112" - o mesmo apenas para placas com um tamanho total de RAM = 256MB </li><li>  GPU_MEM_512 = "160" - o mesmo apenas para placas com um tamanho total de RAM = 512MB </li><li>  GPU_MEM_1024 = "320" - o mesmo √© apenas para placas com um tamanho total de RAM = 1024MB </li></ul><br><blockquote>  nota: <br>  por exemplo, se voc√™ deixar apenas a vari√°vel GPU_MEM = "128", <br>  depois, para todas as placas RPI, RPI2, RPI3 <br>  independentemente da quantidade de RAM real <br>  no quadro ser√° sempre alocado para a GPU - 128Mb <br>  (e o tamanho total da RAM diminui nesse valor) <br></blockquote><br>  se todas as vari√°veis ‚Äã‚Äãforem especificadas, as diretivas GPU_MEM_256, GPU_MEM_512, GPU_MEM_1024 ter√£o mais prioridade. <br><br>  Para a montagem do Multimedia Center, al√©m das camadas regulares do Yocto, consulte o arquivo bblayers.conf <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">${BSPDIR}</span></span>/sources/poky/meta \ <span class="hljs-variable"><span class="hljs-variable">${BSPDIR}</span></span>/sources/poky/meta-poky \ <span class="hljs-variable"><span class="hljs-variable">${BSPDIR}</span></span>/sources/poky/meta-yocto-bsp \</code> </pre><br>  Conectei quatro camadas com funcionalidade adicional do OpenEmbedded. <br><br>  Kodi Multimedia Center - √© um programa complexo que usa um grande n√∫mero de bibliotecas externas e voc√™ precisa criar cada biblioteca usando uma receita de compila√ß√£o; portanto, se poss√≠vel, usarei todas as receitas do OpenEmbedded na categoria <strong>Multim√≠dia</strong> <br><br>  Ent√£o, eu tenho uma camada de multim√≠dia conectada e as camadas das quais depende <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">${BSPDIR}</span></span>/sources/meta-openembedded/meta-oe \ <span class="hljs-variable"><span class="hljs-variable">${BSPDIR}</span></span>/sources/meta-openembedded/meta-python \ <span class="hljs-variable"><span class="hljs-variable">${BSPDIR}</span></span>/sources/meta-openembedded/meta-networking \ <span class="hljs-variable"><span class="hljs-variable">${BSPDIR}</span></span>/sources/meta-openembedded/meta-multimedia \</code> </pre><br>  ent√£o outra camada OpenEmbedded √© conectada para trabalhar com sistemas de arquivos <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">${BSPDIR}</span></span>/sources/meta-openembedded/meta-filesystems \</code> </pre><br>  conectou ainda mais a camada principal do BSP para a plataforma Raspberry Pi <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">${BSPDIR}</span></span>/sources/meta-raspberrypi \</code> </pre><br>  Bem, no final, est√° conectada uma camada adicional, respons√°vel pela montagem da imagem de distribui√ß√£o com a funcionalidade do "Multimedia Center" <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">${BSPDIR}</span></span>/sources/berserk/meta-berserk \</code> </pre><br><a name="layer_koditv"></a><h2>  Camada para montagem de um centro multim√≠dia </h2><br>  Na minha opini√£o, o Projeto Yocto √© uma combina√ß√£o industrial para criar distribui√ß√µes incorporadas.  Mas se voc√™ j√° trabalhou com o sistema de constru√ß√£o Buildroot, o Yocto pode parecer complicado para voc√™.  Ele usa uma enorme quantidade de espa√ßo livre no disco r√≠gido.  Para opera√ß√£o normal, o Yocto requer cerca de 80 a 100 GB de espa√ßo livre, e isso geralmente leva em considera√ß√£o o conjunto apenas para uma plataforma. <br><br>  O Yocto lida com seu objetivo principal - suportar o maior n√∫mero poss√≠vel de plataformas de hardware, e isso requer o mecanismo mais flex√≠vel para alternar os conjuntos.  E esse mecanismo precisa de tempo e lugar.  Construir uma distribui√ß√£o no Yocto n√£o √© um processo r√°pido. <br><br>  Ent√£o, toda a funcionalidade para montar o "Multimedia Center" que eu tenho com uma camada separada: <br><br><pre> <code class="bash hljs">https://github/berserktv/berserk</code> </pre><br>  (T√≠tulo retirado do meu livro favorito, The Hammer and the Cross, de Harry Harrison.) <br>  (Torvin tamb√©m √© um personagem deste livro.) <br><br>  Para criar a funcionalidade necess√°ria, usarei os chamados complementos para receitas, localizados em arquivos com a extens√£o .bbappend <br>  no arquivo .bbappend, voc√™ pode adicionar suas pr√≥prias chamadas de comando para o m√©todo de receita de constru√ß√£o regular, por exemplo, ao m√©todo do_configure, do_compile, do_install, etc. <br><br><a name="struct_top_layer_koditv"></a><h3>  Estrutura de camada </h3><br><pre> COP‚îÄ‚îÄ COPYING.MIT
 Meta‚îÄ‚îÄ meta-berserk
 ‚îÇ ‚îú‚îÄ‚îÄ conf
 Layer ‚îÇ ‚îÄ‚îÄ‚îÄ layer.conf
 ‚îÇ ‚îú‚îÄ‚îÄ receitas-berserk
 ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ bs-net
 ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ primeira execu√ß√£o
 Imagens de ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ
 ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ tv
 ‚îÇ ‚îú‚îÄ‚îÄ receitas-core
 Init ‚îÇ ‚îú‚îÄ‚îÄ init-ifupdown
 ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ psplash
 Recipes ‚îú‚îÄ‚îÄ receitas-kernel
 Lin ‚îÇ ‚îî‚îÄ‚îÄ linux
 ‚îÇ ‚îú‚îÄ‚îÄ receitas-mediacentre
 ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ kodi
 K ‚îÇ ‚îî‚îÄ‚îÄ kodi-plugins
 ‚îÇ ‚îî‚îÄ‚îÄ receitas-multim√≠dia
 ‚îÇ ‚îî‚îÄ‚îÄ ffmpeg
 ‚îú‚îÄ‚îÄ README.md
 ‚îî‚îÄ‚îÄ changelog.txt
</pre><br><br>  Composi√ß√£o da camada: <br><br><ul><li>  configura√ß√£o de camada <strong>conf</strong> </li><li>  <strong>recipes-berserk</strong> - distribui√ß√£o de <strong>receitas de</strong> distribui√ß√£o, tv, rede e receitas de primeiro lan√ßamento </li><li>  <strong>recipes-core</strong> - receitas b√°sicas, em particular uma modifica√ß√£o na receita inicial </li><li>  <strong>recipes-kernel</strong> - Receitas de compila√ß√£o do kernel Linux </li><li>  <strong>recipes-mediacentre</strong> - receitas para construir o Kodi e seus plugins </li><li>  <strong>recipes-multimedia</strong> - receitas multim√≠dia, montagem ffmpeg </li></ul><br><a name="config_layer_koditv"></a><h3>  configura√ß√£o da camada </h3><br><div class="spoiler">  <b class="spoiler_title">inclui o arquivo layer.conf</b> <div class="spoiler_text"><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment"># We have a conf and classes directory, add to BBPATH BBPATH .= ":${LAYERDIR}" # We have a packages directory, add to BBFILES BBFILES += "${LAYERDIR}/recipes-*/*/*.bb \ ${LAYERDIR}/recipes-*/*/*.bbappend" BBFILE_COLLECTIONS += "bs" BBFILE_PATTERN_bs := "^${LAYERDIR}/" BBFILE_PRIORITY_bs = "5" DISTRO_FEATURES_append += " wifi x11" PREFERRED_VERSION_ffmpeg = "3.1.11" SYSVINIT_ENABLED_GETTYS = "1" PREFERRED_VERSION_linux-raspberrypi ?= "4.9%"</span></span></code> </pre><br></div></div><br>  O arquivo cont√©m uma indica√ß√£o da vers√£o da biblioteca ffmpeg, o n√∫mero da vers√£o do kernel do linux, bem como o n√∫mero de consoles virtuais (tty), e inclui os recursos do kit de distribui√ß√£o - wifi x11 <br><blockquote>  DISTRO_FEATURES_append + = "wifi x11" <br><br>  PREFERRED_VERSION_ffmpeg = "3.1.11" <br>  SYSVINIT_ENABLED_GETTYS = "1" <br><br>  PREFERRED_VERSION_linux-raspberrypi? = "4.9%" <br></blockquote><br><a name="berserk_layer_koditv"></a><h3>  composi√ß√£o de receitas-berserk </h3><br><pre> B‚îÄ‚îÄ bs-net
 ‚îÇ ‚îî‚îÄ‚îÄ bs-net_0.1.3.bb
 ‚îú‚îÄ‚îÄ primeira execu√ß√£o
 ‚îÇ ‚îú‚îÄ‚îÄ arquivos
 ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ first-run.sh
 ‚îÇ ‚îî‚îÄ‚îÄ first-run.bb
 ‚îú‚îÄ‚îÄ imagens
 ‚îÇ ‚îî‚îÄ‚îÄ berserk-image.bb
 ‚îî‚îÄ‚îÄ tv
     ‚îú‚îÄ‚îÄ arquivos
     ‚îÇ ‚îî‚îÄ‚îÄ berserk.m3u8
     ‚îú‚îÄ‚îÄ tv-config.bb
     ‚îî‚îÄ‚îÄ tv-dir.inc
</pre><br><br>  onde: <br><br><ul><li>  bs-net_0.1.3.bb - receita para criar extens√µes de shell para interfaces WLAN / Ethernet </li><li>  first-run.bb - receita para a primeira execu√ß√£o, particionamento de disco adicional </li><li>  first-run.sh - script de shell da primeira execu√ß√£o (executada no n√≠vel S) </li><li>  berserk-image.bb - receita para construir a imagem de distribui√ß√£o </li><li>  tv-config.bb - receita para configurar canais de TV usando IPTV </li><li>  berserk.m3u8 - configura√ß√£o de canais p√∫blicos de televis√£o (formato m3u8) </li></ul><br><a name="core_layer_koditv"></a><h3>  composi√ß√£o do n√∫cleo de receitas </h3><br><pre> Init‚îÄ‚îÄ init-ifupdown
 ‚îÇ ‚îú‚îÄ‚îÄ arquivos
 Interfaces ‚îÇ ‚îî‚îÄ‚îÄ interfaces
 Init ‚îî‚îÄ‚îÄ init-ifupdown_1.0.bbappend
 Ps‚îÄ‚îÄ psplash
     ‚îú‚îÄ‚îÄ arquivos
     ‚îÇ ‚îî‚îÄ‚îÄ psplash-berserk-img.h
     Ps‚îÄ‚îÄ psplash_git.bbappend
</pre><br><br>  onde: <br><br><ul><li>  interfaces - arquivo com a configura√ß√£o de rede atual </li><li>  init-ifupdown_1.0.bbappend - extens√£o para receita de configura√ß√£o de rede </li><li>  psplash-berserk-img.h - imagem do protetor de tela de inicializa√ß√£o <br>  arquivo de cabe√ßalho obtido usando o utilit√°rio gdk-pixbuf-csource </li><li>  psplash_git.bbappend - extens√£o da receita para iniciar o protetor de tela de inicializa√ß√£o </li></ul><br>  A configura√ß√£o de rede no dispositivo de destino est√° no arquivo: <br><br><pre> <code class="bash hljs">/etc/network/interfaces</code> </pre><br>  Ap√≥s adicionar a extens√£o da receita init-ifupdown, substituo o arquivo de configura√ß√£o regular pelo meu e altero a ordem (prioridade) do script executado para os n√≠veis de execu√ß√£o <br><br><pre> <code class="bash hljs">INITSCRIPT_PARAMS = <span class="hljs-string"><span class="hljs-string">"start 98 2 3 4 5 . stop 10 0 6 1 ."</span></span></code> </pre><br>  No momento, quase todas as distribui√ß√µes modernas do Linux incluem uma tela de inicializa√ß√£o.  Normalmente, o protetor de tela de inicializa√ß√£o mostra o estado atual do carregamento  indicador do tempo decorrido desde o in√≠cio do sistema.  A esse respeito, o Yocto n√£o √© exce√ß√£o e voc√™ pode alterar a imagem do protetor de tela de inicializa√ß√£o padr√£o para uma imagem arbitr√°ria. <br><br>  Para fazer isso, voc√™ deve: <br><br><ol><li>  FILESEXTRAPATHS_prepend - adicione diret√≥rio para recursos </li><li>  SRC_URI - adicione um arquivo de cabe√ßalho com uma imagem arbitr√°ria </li><li>  SPLASH_IMAGES - alterar vari√°vel de controle de pacote </li></ol><br>  e ainda mais na receita da imagem ‚Äúberserk-image.bb‚Äù, √© necess√°rio adicionar a imagem inicial do splash, pois as caracter√≠sticas da imagem <br><br><pre> <code class="bash hljs">IMAGE_FEATURES += <span class="hljs-string"><span class="hljs-string">"splash"</span></span> <span class="hljs-comment"><span class="hljs-comment">#          SPLASH = "psplash-berserk"</span></span></code> </pre><br><a name="kernel_layer_koditv"></a><h2>  composi√ß√£o de receitas-kernel </h2><br><pre> Lin‚îÄ‚îÄ linux
     ‚îú‚îÄ‚îÄ arquivos
     D ‚îú‚îÄ‚îÄ db.txt.patch
     ‚îÇ ‚îî‚îÄ‚îÄ rbpi.cfg
     Lin‚îÄ‚îÄ linux-raspberrypi_4.9.bbappend
</pre><br><br>  onde: <br><br><ul><li>  db.txt.patch - patch com a base do dom√≠nio de regulamenta√ß√£o (usado para WiFi) </li><li>  rbpi.cfg - Fragmento de configura√ß√£o do kernel do Linux </li><li>  linux-raspberrypi_4.9.bbappend - extens√£o da receita de compila√ß√£o do kernel 4.9 para Raspberry Pi </li></ul><br>  Os dispositivos Wi-Fi operam em determinadas frequ√™ncias e, para eles, existe um dom√≠nio regulat√≥rio - este √© o par√¢metro que indica o pa√≠s em que esse dispositivo deve funcionar. <br><br>  O kernel do Linux possui um banco de dados complementar no qual as frequ√™ncias permitidas e a pot√™ncia permitida para elas s√£o registradas para cada pa√≠s. <br><br>  No caso mais simples, esse banco de dados pode ser inclu√≠do diretamente no kernel estaticamente, especificando um par√¢metro: <br>  <strong>CONFIG_CFG80211_INTERNAL_REGDB = y</strong> <br>  que foi <strong>exatamente</strong> o que fiz ao conectar um patch a este banco de dados <strong>db.txt.patch</strong> <br><br>  E outra coisa: no Yocto, existem fragmentos de configura√ß√µes do kernel.  Geralmente, um fragmento de configura√ß√£o, um arquivo com a extens√£o cfg, cont√©m apenas os par√¢metros do kernel que voc√™ claramente precisa para determinados fins.  E essa parte da configura√ß√£o √© adicionada aos par√¢metros padr√£o que j√° est√£o presentes na receita ao criar o kernel. <br><br>  Al√©m da receita bbappend, voc√™ tamb√©m pode alterar os par√¢metros que s√£o passados ‚Äã‚Äãpara o kernel durante a inicializa√ß√£o: <br><br>  isto √©  substituir vari√°vel <br>  <strong>CMDLINE,</strong> consulte o arquivo linux-raspberrypi_4.9.bbappend <br><br><div class="spoiler">  <b class="spoiler_title">conte√∫do de rbpi.cfg</b> <div class="spoiler_text"><pre> <code class="html hljs xml"> # use statically compiled regulatory rules database CONFIG_CFG80211_INTERNAL_REGDB=y #  Wifi  Asus USB-N53 chipset Ralink RT3572 CONFIG_RT2800USB=m #  wifi    Atheros D-Link DWA-126 802.11n (AR9271), # NetGear WNDA3200, NetGear WNA1100, TP-Link TL-WN722N (AR9271), # TL-WN322G v3, TL-WN422G  .. . cateee.net CONFIG_ATH9K_HW=m CONFIG_ATH9K_HTC=m #  Wifi    wpa_supplicant CONFIG_WIRELESS=y CONFIG_WEXT_CORE=y CONFIG_WEXT_PROC=y CONFIG_CRYPTO_AES=y #    IPSec,    Wifi  #   wpa_supplicant   CONFIG_CRYPTO_CCM=m CONFIG_CRYPTO_CTR=m CONFIG_CRYPTO_ARC4=m ######################### #   CONFIG_HAVE_PERF_EVENTS=y CONFIG_PERF_EVENTS=y CONFIG_HAVE_LATENCYTOP_SUPPORT=y CONFIG_LATENCYTOP=y # This option adds support for ASIX AX88xxx # based USB 2.0 10/100 Ethernet adapters. CONFIG_USB_NET_AX8817X=m</code> </pre><br></div></div><br><div class="spoiler"> <b class="spoiler_title"> linux-raspberrypi_4.9.bbappend</b> <div class="spoiler_text"><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment">#      rpbi.cfg FILESEXTRAPATHS_prepend := "${THISDIR}/files:" SRC_URI += "file://db.txt.patch;patch=1 \ file://rbpi.cfg \ " #  BSP  meta-raspberrypi     # https://github.com/agherzan/meta-raspberrypi/issues/14 #    #   do_kernel_configme   #     arch/    do_kernel_configme_append() { cat ${WORKDIR}/rbpi.cfg &gt;&gt; ${WORKDIR}/defconfig } # CMDLINE for raspberrypi # default CMDLINE = "dwc_otg.lpm_enable=0 console=serial0,115200 # root=/dev/mmcblk0p2 rootfstype=ext4 rootwait" CMDLINE = "quiet dwc_otg.lpm_enable=0 console=serial0,115200 \ root=/dev/mmcblk0p2 rootfstype=ext4 rootwait"</span></span></code> </pre><br></div></div><br><a name="mediacentre_layer_koditv"></a><h3>  recipes-mediacentre </h3><br><pre> <code class="bash hljs">‚îú‚îÄ‚îÄ kodi ‚îÇ  ‚îú‚îÄ‚îÄ kodi ‚îÇ  ‚îú‚îÄ‚îÄ kodi_17.bbappend ‚îÇ  ‚îú‚îÄ‚îÄ kodi-dir.inc ‚îÇ  ‚îú‚îÄ‚îÄ kodi-runner.bb ‚îÇ  ‚îú‚îÄ‚îÄ kodi-settings.bb ‚îÇ  ‚îî‚îÄ‚îÄ kodi-version.inc ‚îî‚îÄ‚îÄ kodi-plugins ‚îú‚îÄ‚îÄ files ‚îú‚îÄ‚îÄ kodi-language-ru_3.0.10.bb ‚îú‚îÄ‚îÄ kodi-pvr-iptvsimple.bb ‚îú‚îÄ‚îÄ plugin-video-youtube_5.5.1.bb ‚îú‚îÄ‚îÄ screensaver-kodi-universe_0.1.2.bb ‚îú‚îÄ‚îÄ script-berserk-network_0.2.5.bb ‚îî‚îÄ‚îÄ script-module-requests_2.12.4.bb</code> </pre><br>  onde: <br><br><ol><li> kodi/ <br><ul><li> kodi ‚Äî    <strong>icon,run,settings</strong> <br>           </li><li> kodi_17.bbappend ‚Äî       Kodi </li><li> kodi-dir.inc ‚Äî    Kodi    </li><li> kodi-runner.bb ‚Äî   Kodi     </li><li> kodi-settings.bb ‚Äî     Kodi </li><li> kodi-version.inc ‚Äî        Kodi </li></ul><br></li><li> kodi-plugins/ <br><br><ul><li> files ‚Äî   tar.gz      </li><li> kodi-language-ru_3.0.10.bb ‚Äî     (  Kodi) </li><li> kodi-pvr-iptvsimple.bb ‚Äî   Kodi  pvr-iptvsimple </li><li> plugin-video-youtube_5.5.1.bb ‚Äî   Kodi    ¬´Youtube¬ª </li><li> screensaver-kodi-universe_0.1.2.bb ‚Äî    screensaver-kodi-universe </li><li> script-berserk-network_0.2.5.bb ‚Äî      </li><li> script-module-requests_2.12.4.bb ‚Äî      Youtube </li></ul><br></li></ol><br><a name="multimedia_layer_koditv"></a><h3>  recipes-multimedia </h3><br><pre>‚îî‚îÄ‚îÄ ffmpeg<font></font>
    ‚îú‚îÄ‚îÄ ffmpeg<font></font>
    ‚îÇ  ‚îú‚îÄ‚îÄ 0001-ffmpeg-Call-get_format-to-fix-an-issue-with-MMAL-ren.patch<font></font>
    ‚îÇ  ‚îú‚îÄ‚îÄ h264_parser.patch<font></font>
    ‚îÇ  ‚îî‚îÄ‚îÄ pfcd_hevc_optimisations.patch<font></font>
    ‚îî‚îÄ‚îÄ ffmpeg_3.1.11.bb<font></font>
</pre><br><br>  onde: <br><br><ul><li> 0001-ffmpeg-Call-get_format-to-fix-an-issue-with-MMAL-ren.patch ‚Äî   ffmpeg </li><li> h264_parser.patch ‚Äî     h264 </li><li> pfcd_hevc_optimisations.patch ‚Äî      Raspberry Pi </li><li> ffmpeg_3.1.11.bb ‚Äî    ffmpeg (,  ) </li></ul><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FFmpeg</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - biblioteca OpenSource para codifica√ß√£o / decodifica√ß√£o de um grande n√∫mero de formatos de v√≠deo e √°udio. </font><font style="vertical-align: inherit;">O FFmpeg suporta quase 400 codecs (ffmpeg -codecs) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e mais de 300 formatos (ffmpeg -formats).</font></font><br><br><a name="build_kodi_koditv"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Adi√ß√£o de receita de compila√ß√£o Kodi </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A camada OpenEmbedded cont√©m uma receita regular para a cria√ß√£o do Kodi, mas √© bastante geral, e eu gostaria de obter uma vers√£o um pouco mais est√°vel e testada para a plataforma Raspberry Pi. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os desenvolvedores de software t√™m um patch de porta reversa. O software √© atualizado constantemente e cada nova vers√£o inclui novos recursos e a corre√ß√£o de erros conhecidos. O patch de portabilidade reversa permite transferir algumas das altera√ß√µes na nova vers√£o do programa para uma mais antiga, tornando-o mais est√°vel. Mas este √© um trabalho muito √°rduo e meticuloso, sempre realizado por um grande n√∫mero de desenvolvedores.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No mundo da comunidade OpenSource, existem v√°rios projetos conhecidos usando o Kodi, o melhor dos quais (na minha opini√£o) √© o LibreElec (OpenElec). </font><font style="vertical-align: inherit;">O LibreElec possui uma boa compila√ß√£o para a plataforma Raspberry Pi. </font><font style="vertical-align: inherit;">Aqui est√£o eles e √© melhor usar o patch de porta reversa para o Kodi. </font><font style="vertical-align: inherit;">Assim, voc√™ pode se livrar de um grande n√∫mero de problemas sem sequer aprender sobre isso. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O centro multim√≠dia Kodi est√° focado em reproduzir o contexto "M√≠dia" e, na minha opini√£o, o componente mais cr√≠tico √© a combina√ß√£o de Kodi e FFmpeg, ou seja, </font><font style="vertical-align: inherit;">Na intera√ß√£o de determinadas vers√µes desses programas, outras bibliotecas podem ser deixadas nas camadas Yocto e OpenEmbedded. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para montagem, peguei a vers√£o est√°vel do Kodi 17.6 e a vers√£o FFmpeg 3.1.11</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota:</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs">  ,       ,      systemD.         (   (  )).  ,     LibreElec       : <span class="hljs-comment"><span class="hljs-comment">#!/bin/bash HASH_VER="934507d922fb011ce46c76566206f2f1f603360b" git clone https://github.com/LibreELEC/LibreELEC.tv.git libreelec cd libreelec git checkout ${HASH_VER}   Kodi,   : projects/RPi2/patches/kodi (. : kodi-001-backport.patch)    FFmpeg,   : packages/multimedia/ffmpeg/patches</span></span></code> </pre><br></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O arquivo de descri√ß√£o da vers√£o inclu√≠do ser√° t√£o </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kodi-version.inc</font></font></strong> <br><br><pre> <code class="bash hljs">FILESEXTRAPATHS_prepend := <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${THISDIR}</span></span></span><span class="hljs-string">/kodi:"</span></span> <span class="hljs-comment"><span class="hljs-comment">#  Krypton SRCREV = "a9a7a20071bfd759e72e7053cee92e6f5cfb5e48" PV = "17.6+gitr${SRCPV}"</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O ramo Yocto e OpenEmbedded que estou considerando - </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">rocko</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cont√©m o Kodi vers√£o 17.3 e, para atualizar para a vers√£o 17.6, basta adicionar uma pequena adi√ß√£o √† receita - </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kodi_17.bbappend</font></font></strong> <br><br><pre> <code class="bash hljs">require kodi-version.inc <span class="hljs-comment"><span class="hljs-comment">#     (   17.3) SRC_URI_remove = "file://0013-FTPParse.cpp-use-std-string.patch" #  ,   systemd   SRC_URI_remove = "file://0004-handle-SIGTERM.patch" #      RPI   libreelec SRC_URI_append += "file://kodi-krypton-rpb-backports.patch" #  error adding symbols: DSO missing from command line SRC_URI_append += "file://vchostif.patch" MENU_ICON = "addons/skin.estuary/media/icons/settings" #       ( ) SRC_URI_append += "file://bs-menu.patch file://icon/bs-network.png" do_configure_prepend() { install -m 0644 ${WORKDIR}/icon/bs-network.png ${S}/${MENU_ICON} } #    kodi plugins RRECOMMENDS_${PN}_append = "\ python-xml python-misc python-db \ python-crypt python-threading python-math python-email \ python-io python-netserver python-urllib3 python-datetime" #     Raspberry Pi #  OPENGL    --enable-gles #  kodi     docs/README.linux =&gt; libxmu libxinerama # libxtst xdpyinfo #      DISTRO_FEATURES   "x11" #   kodi  RPI1  RPI2,3    --disable-x11 BS_RPI = " --disable-gl --enable-openmax --enable-player=omxplayer \ --with-platform=raspberry-pi --disable-x11" BS_RPI3 = " --disable-gl --enable-openmax --enable-player=omxplayer \ --with-platform=raspberry-pi2 --disable-x11" EXTRA_OECONF_append = "${@bb.utils.contains('MACHINE', 'raspberrypi', \ '${BS_RPI}', '', d)}" EXTRA_OECONF_append = "${@bb.utils.contains('MACHINE', 'raspberrypi2', \ '${BS_RPI3}', '', d)}" EXTRA_OECONF_append = "${@bb.utils.contains('MACHINE', 'raspberrypi3', \ '${BS_RPI3}', '', d)}" #       Kodi   #  ,  USB  microSDHC  ( ) EXTRA_OECONF_append = " --enable-optical-drive"</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A op√ß√£o de compila√ß√£o "--enable-optical-drive" permite conectar o mecanismo de notifica√ß√£o conveniente que o Kodi usa ao conectar um disco √≥ptico. </font><font style="vertical-align: inherit;">Nesse caso, o m√≥dulo MediaManager (a) (xbmc / storage / MediaManager.cpp) monitora a conex√£o / desconex√£o de novas parti√ß√µes de disco e exibe uma mensagem pop-up sobre isso. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Exemplo de conex√£o / desconex√£o de unidades do udev:</font></font><br><br><pre> <code class="bash hljs">ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span> SUBSYSTEM==<span class="hljs-string"><span class="hljs-string">"block"</span></span> ENV{ID_FS_TYPE}==<span class="hljs-string"><span class="hljs-string">"vfat"</span></span> \ KERNEL==<span class="hljs-string"><span class="hljs-string">"sd[az][0-9]"</span></span> \ RUN+=<span class="hljs-string"><span class="hljs-string">"/bin/mkdir -p /media/%k"</span></span>, \ RUN+=<span class="hljs-string"><span class="hljs-string">"/bin/mount -o iocharset=utf8,noatime /dev/%k /media/%k"</span></span> ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span> SUBSYSTEM==<span class="hljs-string"><span class="hljs-string">"block"</span></span> ENV{ID_FS_TYPE}==<span class="hljs-string"><span class="hljs-string">"ntfs"</span></span> \ KERNEL==<span class="hljs-string"><span class="hljs-string">"sd[az][0-9]"</span></span> \ RUN+=<span class="hljs-string"><span class="hljs-string">"/bin/mkdir -p /media/%k"</span></span>, \ RUN+=<span class="hljs-string"><span class="hljs-string">"/usr/bin/ntfs-3g -o \ iocharset=utf8,noatime,windows_names /dev/%k /media/%k"</span></span> ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span> SUBSYSTEM==<span class="hljs-string"><span class="hljs-string">"block"</span></span> ENV{ID_FS_TYPE}==<span class="hljs-string"><span class="hljs-string">"ext2|ext3|ext4"</span></span> \ KERNEL==<span class="hljs-string"><span class="hljs-string">"sd[az][0-9]"</span></span> \ RUN+=<span class="hljs-string"><span class="hljs-string">"/bin/mkdir -p /media/%k"</span></span>, \ RUN+=<span class="hljs-string"><span class="hljs-string">"/bin/mount -o noatime /dev/%k /media/%k"</span></span> ACTION==<span class="hljs-string"><span class="hljs-string">"remove"</span></span> SUBSYSTEM==<span class="hljs-string"><span class="hljs-string">"block"</span></span> KERNEL==<span class="hljs-string"><span class="hljs-string">"sd[az][0-9]"</span></span> \ RUN+=<span class="hljs-string"><span class="hljs-string">"/bin/umount /media/%k"</span></span>, RUN+=<span class="hljs-string"><span class="hljs-string">"/bin/rmdir /media/%k"</span></span></code> </pre><br><pre> <code class="html hljs xml">:  rmdir     ,       ( Linux    -  )       .</code> </pre><br><a name="add_menu_koditv"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Adicionando um novo item ao menu de configura√ß√µes do Kodi </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">No Kodi 17.6, os arquivos de configura√ß√£o xml s√£o respons√°veis ‚Äã‚Äãpela exibi√ß√£o dos itens de menu. </font><font style="vertical-align: inherit;">Para adicionar mais um item no menu "Configura√ß√µes", basta ajustar o arquivo: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kodi / addons / skin.estuary / xml / Settings.xml em </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">que skin.estuary √© o tema de design do menu padr√£o, a </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">descri√ß√£o </font><font style="vertical-align: inherit;">do item </font><font style="vertical-align: inherit;">fica assim:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;item&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    &lt;label&gt; $ LOCALIZE [13279] &lt;/label&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    &lt;onclick&gt; RunAddon (script.berserk.network, butnetwork) &lt;/onclick&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    &lt;icon&gt; √≠cones / configura√ß√µes / bs-network.png &lt;/icon&gt;</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
&lt;/item&gt;</font></font><font></font>
</pre><br><br>  onde: <br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">label</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - nome do item de menu </font></font><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onclick</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - manipula√ß√£o do evento de pressionar o bot√£o menu </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(iniciando o plug-in, com o primeiro argumento passando a string ‚Äúbutnetwork‚Äù) </font></font><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√≠cone</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - √≠cone do item de menu (caminho para a imagem png) </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A funcionalidade acima, al√©m de conectar v√°rios plug-ins Kodi adicionais, est√° integrada ao usando o arquivo bs-menu.patch</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mostrar / Ocultar</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"> diff -Naur a/addons/skin.estuary/xml/Settings.xml b/addons/skin.estuary/xml/Settings.xml --- a/addons/skin.estuary/xml/Settings.xml 2018-02-01 18:17:45.000000000 +0300 +++ b/addons/skin.estuary/xml/Settings.xml 2018-03-08 12:06:50.000000000 +0300 @@ -134,6 +134,11 @@ &lt;icon&gt;icons/settings/interface.png&lt;/icon&gt; &lt;/item&gt; &lt;item&gt; + &lt;label&gt;<span class="hljs-variable"><span class="hljs-variable">$LOCALIZE</span></span>[13279]&lt;/label&gt; + &lt;onclick&gt;RunAddon(script.berserk.network,butnetwork)&lt;/onclick&gt; + &lt;icon&gt;icons/settings/bs-network.png&lt;/icon&gt; + &lt;/item&gt; + &lt;item&gt; &lt;label&gt;<span class="hljs-variable"><span class="hljs-variable">$LOCALIZE</span></span>[20077]&lt;/label&gt; &lt;onclick&gt;ActivateWindow(SkinSettings)&lt;/onclick&gt; &lt;icon&gt;icons/settings/skin.png&lt;/icon&gt; diff -Naur a/system/addon-manifest.xml b/system/addon-manifest.xml --- a/system/addon-manifest.xml 2018-03-07 15:58:24.000000000 +0300 +++ b/system/addon-manifest.xml 2018-05-14 14:06:58.000000000 +0300 @@ -27,6 +27,7 @@ &lt;addon&gt;resource.uisounds.kodi&lt;/addon&gt; &lt;addon&gt;screensaver.xbmc.builtin.black&lt;/addon&gt; &lt;addon&gt;screensaver.xbmc.builtin.dim&lt;/addon&gt; + &lt;addon&gt;screensaver.kodi.universe&lt;/addon&gt; &lt;addon&gt;script.module.pil&lt;/addon&gt; &lt;addon&gt;service.xbmc.versioncheck&lt;/addon&gt; &lt;addon&gt;skin.estuary&lt;/addon&gt; @@ -43,4 +44,8 @@ &lt;addon&gt;xbmc.python&lt;/addon&gt; &lt;addon&gt;xbmc.webinterface&lt;/addon&gt; &lt;addon optional=<span class="hljs-string"><span class="hljs-string">"true"</span></span>&gt;peripheral.joystick&lt;/addon&gt; + &lt;addon&gt;script.berserk.network&lt;/addon&gt; + &lt;addon&gt;resource.language.ru_ru&lt;/addon&gt; + &lt;addon&gt;script.module.requests&lt;/addon&gt; + &lt;addon&gt;plugin.video.youtube&lt;/addon&gt; &lt;/addons&gt;</code> </pre><br></div></div><br><a name="max_set_video_koditv"></a><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Configura√ß√µes m√°ximas de buffer para v√≠deo </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> No Kodi Multimedia Center, para maximizar o desempenho, voc√™ pode especificar as configura√ß√µes m√°ximas de buffer: </font></font><br><br><pre> <code class="bash hljs">&lt;advancedsettings&gt; &lt;cache&gt; &lt;buffermode&gt;1&lt;/buffermode&gt; &lt;memorysize&gt;139460608&lt;/memorysize&gt; &lt;readfactor&gt;20&lt;/readfactor&gt; &lt;/cache&gt; &lt;/advancedsettings&gt;</code> </pre><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">buffermode = 1</font></font></strong> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - solicita√ß√µes de buffer para todos os sistemas de arquivos (incluindo local) </font></font><br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">readfactor</font></font></strong> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - ajusta a velocidade do download com base na taxa de bits m√©dia do v√≠deo. </font><font style="vertical-align: inherit;">Portanto, por exemplo, se voc√™ reproduzir um v√≠deo com uma taxa m√©dia de transfer√™ncia de dados de 5 Mbit / se definir a taxa de leitura do buffer para 2,0, isso limitar√° a velocidade de download (e, portanto, a taxa de preenchimento do cache) para cerca de 10 Mbit / s, assim: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">readfactor = 20 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remove a restri√ß√£o na velocidade de download </font></font><br><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MemorySize</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 139 460 608 </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- buffer de tamanho √© de 133 MB, utilizando a RAM 133 * 3 i </font><font style="vertical-align: inherit;">cerca de 400 MB de RAM</font></font><br><br><a name="iptv_koditv"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Assistindo TV por IPTV </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Kodi Media Center √© uma ferramenta muito poderosa para visualizar conte√∫do digital. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A principal fun√ß√£o para a qual coletei o "Media Center" √© a fun√ß√£o de assistir televis√£o digital usando IPTV (Internet Protocol Television), ou seja, televis√£o atrav√©s do protocolo da internet. Com esta fun√ß√£o, voc√™ pode assistir televis√£o digital do seu provedor de Internet. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Essa √© a op√ß√£o mais moderna e ideal, tanto em termos de qualidade de imagem quanto em recursos adicionais, ou seja, servi√ßos prestados. Por exemplo, os canais de televis√£o podem ser fornecidos no arquivo, no qual a grava√ß√£o de v√≠deo desejada fica dispon√≠vel por algum tempo ap√≥s a transmiss√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para dar suporte ao IPTV no Kodi, existem v√°rias op√ß√µes de plug-ins, das quais eu decidi no plug-in</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pvr.iptvsimple</font></font></strong> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para criar o plugin, use a receita:</font></font><br><br><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">    K‚îÄ‚îÄ kodi-plugins</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ‚îî‚îÄ‚îÄ kodi-pvr-iptvsimple.bb</font></font><font></font>
</pre><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O plug-in √© conectado / configurado por meio de: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Menu principal do Kodi =&gt; ‚ÄúComplementos‚Äù =&gt; ‚ÄúMeus complementos‚Äù =&gt; ‚ÄúClientes PVR‚Äù =&gt; ‚ÄúPVR IPTV Simple Client‚Äù </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para verificar o funcionamento da televis√£o IPTV como parte do Kodi, tomei v√°rios canais p√∫blicos de not√≠cias e os adicionou √† lista no formato m3u8, al√©m de ativar o lan√ßamento autom√°tico do plug-in ‚Äúpvr.iptvsimple‚Äù no in√≠cio do media center.</font></font><br><br><a name="youtube_koditv"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Assistindo ao Youtube com o plug-in Kodi </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os programadores que desenvolveram o Kodi forneceram flexibilidade para expandir suas fun√ß√µes. </font><font style="vertical-align: inherit;">Isso √© feito para que qualquer entusiasta, se desejado, possa adicionar a Kodi o que ele realmente precisa. </font><font style="vertical-align: inherit;">E esses plugins para Kodi s√£o trevas.</font></font> Bem, voc√™ entendeu.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Existem tantos que merece uma descri√ß√£o em um artigo separado. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os plugins s√£o instalados de maneira simples, basta conectar o Kodi √† Internet e pressionar alguns bot√µes no menu. Voc√™ pode ler sobre isso em qualquer um dos f√≥runs dedicados ao Kodi. Mas a montagem, existe a montagem, e incluirei outro plug-in na distribui√ß√£o como exemplo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O plugin mais interessante e mais abrangente (ohm) para o Kodi, na minha opini√£o, √© o plugin de visualiza√ß√£o do YouTube. O Kodi √© um centro de multim√≠dia, e o YouTube √© o maior reposit√≥rio desse conte√∫do, portanto o plug-in do YouTube para o Kodi √© quase obrigat√≥rio. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O plug-in √© escrito em python, e este √© um mecanismo de plug-in comum, voc√™ n√£o precisa compilar nada, basta copiar o plug-in finalizado para o diret√≥rio raiz com os plug-ins e especificar o nome do plug-in no arquivo de manifesto xml:</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"System / addon-manifest.xml" </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O plug-in √© retirado do reposit√≥rio oficial e seu c√≥digo-fonte est√° inclu√≠do no arquivo: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recipes-mediacentre / kodi-plugins / files / plugin.video.youtube.tar.gz Para obter a </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localiza√ß√£o da receita de cria√ß√£o do plug-in, veja acima cap√≠tulo "composi√ß√£o receitas-mediacentre"</font></font><br><br><a name="bsnet_layer_koditv"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Extens√£o de configura√ß√£o de rede do shell do console </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como o kit de distribui√ß√£o montado na estrutura deste artigo √© uma demonstra√ß√£o, os requisitos para a configura√ß√£o de ‚ÄúInterfaces de Rede‚Äù s√£o m√≠nimos. </font><font style="vertical-align: inherit;">Eu n√£o queria arrastar nenhum gerenciador de rede pesado para isso, o que era muito incompreens√≠vel para mim e muito volumoso, e, portanto, escrevi dois scripts de shell que complementam a configura√ß√£o do mecanismo de configura√ß√£o regular:</font></font><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">############################################################## #     /etc/network/interfaces: ############################################################## auto eth0 iface eth0 inet manual up /etc/network/eth-manual $IFACE up down /etc/network/eth-manual $IFACE down auto wlan0 iface wlan0 inet manual up /etc/network/wlan $IFACE up down /etc/network/wlan $IFACE down</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para configurar convenientemente as interfaces de rede Ethernet / WLAN por meio da GUI, eu uso outro pequeno plug-in Kodi ‚Äúscript.berserk.network‚Äù. </font><font style="vertical-align: inherit;">Este √© quase o √∫nico plugin Kodi que eu descobri, mas para isso eu tive que escrev√™-lo. </font><font style="vertical-align: inherit;">√â extremamente compacto e minimalista e est√° escrito na linguagem python. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ambos os componentes s√£o coletados usando receitas:</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> receitas-berserk / bs-net / bs-net_0.1.3.bb </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> recipes-mediacentre / kodi-plugins / script-berserk-network_0.2.5.bb </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Neste ponto, gostaria de me debru√ßar sobre os detalhes. </font><font style="vertical-align: inherit;">Portanto, toda a flexibilidade de usar o Yocto est√° em diferentes conjuntos de receitas, ou seja, </font><font style="vertical-align: inherit;">conectou um conjunto de receitas - o gerenciador de rede mais simples foi adicionado ao kit de distribui√ß√£o, conectou outro conjunto - adicionou seu gerenciador de rede favorito usando, por exemplo, systemD, etc. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Para conectar-se automaticamente a um ponto de acesso WiFi quando o sistema √© iniciado, eu uso a regra do udev: /etc/udev/rules.d/80-wifi-start.rules</font></font><br><br><pre> <code class="bash hljs">SUBSYSTEM==<span class="hljs-string"><span class="hljs-string">"net"</span></span>, ACTION==<span class="hljs-string"><span class="hljs-string">"add"</span></span>, DRIVERS==<span class="hljs-string"><span class="hljs-string">"?*"</span></span>, KERNEL==<span class="hljs-string"><span class="hljs-string">"wlan*"</span></span>, \ RUN+=<span class="hljs-string"><span class="hljs-string">"/etc/network/wlan-runner </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$env</span></span></span><span class="hljs-string">{INTERFACE} up"</span></span> SUBSYSTEM==<span class="hljs-string"><span class="hljs-string">"net"</span></span>, ACTION==<span class="hljs-string"><span class="hljs-string">"remove"</span></span>, DRIVERS==<span class="hljs-string"><span class="hljs-string">"?*"</span></span>, KERNEL==<span class="hljs-string"><span class="hljs-string">"wlan*"</span></span>, \ RUN+=<span class="hljs-string"><span class="hljs-string">"/etc/network/wlan-runner </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$env</span></span></span><span class="hljs-string">{INTERFACE} down"</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O script wlan-runner simplesmente executa os comandos: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ etc / network / wlan $ IFACE up</font></font><br>  ou <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / etc / network / wlan $ IFACE desativado </font></font><br><br><a name="distrib_recipe_koditv"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Receita de Constru√ß√£o de Distribui√ß√£o </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O Projeto Yocto possui um mecanismo de reutiliza√ß√£o. Existem classes das quais voc√™ pode herdar (diretiva "herdar") e h√° receitas b√°sicas que voc√™ pode conectar (diretiva "incluir"). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mostrarei heran√ßa usando o exemplo da classe: </font></font><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">poky / meta / clasess / core-image.bbclass</font></font></strong> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> A classe √© respons√°vel por descrever os grupos de pacotes que voc√™ pode incluir em uma receita espec√≠fica. Para fazer isso, basta indicar a constru√ß√£o no in√≠cio da receita: </font></font><br> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">herdar imagem principal</font></font></strong> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Mesmo no texto desta classe, voc√™ pode ver os recursos da imagem, cada recurso √© respons√°vel por um grupo de fun√ß√µes inclu√≠das na imagem e cada grupo finalmente descreve um conjunto de programas ou bibliotecas instalados. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os recursos da imagem s√£o indicados da seguinte forma:</font></font><br><br><pre> <code class="bash hljs">IMAGE_FEATURES += <span class="hljs-string"><span class="hljs-string">"ssh-server-dropbear splash"</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamb√©m h√° DISTRO_FEATURES - recursos de distribui√ß√£o que podem ser especificados no arquivo de configura√ß√£o da camada. </font><font style="vertical-align: inherit;">Essas s√£o fun√ß√µes de n√≠vel de distribui√ß√£o e, se, por exemplo, voc√™ alterar algum recurso (por exemplo, x11), o assembly subsequente come√ßar√° a remontar todos os pacotes que dependem dessa op√ß√£o (isso pode levar bastante tempo). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A receita b√°sica b√°sica que eu uso: </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">poky / meta / recipes-core / images / core-image-minimal.bb</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">receita de constru√ß√£o de imagem</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"> <span class="hljs-comment"><span class="hljs-comment"># Project: "Berserk" - build Kodi for the Raspberry Pi platform # license - The MIT License (MIT) DESCRIPTION = "Berserk - the image for the Raspberry PI" LICENSE = "MIT" MD5_SUM = "md5=0835ade698e0bcf8506ecda2f7b4f302" LIC_FILES_CHKSUM = "file://${COMMON_LICENSE_DIR}/MIT;${MD5_SUM}" IMAGE_FEATURES += "ssh-server-dropbear splash" #    rootfs    (250000kB=~250Mb) IMAGE_ROOTFS_EXTRA_SPACE_append += "+ 250000" # Base this image on core-image-minimal include recipes-core/images/core-image-minimal.bb # Set default password for 'root' user inherit extrausers ROOTUSERNAME = "root" ROOTPASSWORD = "berserk" EXTRA_USERS_PARAMS = "usermod -P ${ROOTPASSWORD} ${ROOTUSERNAME};" #  ,      SPLASH = "psplash-berserk" BS_DEBUG_TOOLS = "ldd strace ltrace" BS_GLIBC = "glibc-thread-db \ glibc-gconv-utf-16 \ glibc-gconv-utf-32 \ glibc-binary-localedata-en-us \ glibc-binary-localedata-ru-ru \ glibc-charmap-utf-8 \ " BS_BASE = "kernel-modules \ lsb \ pciutils \ parted \ tzdata \ dosfstools \ ntp \ ntpdate \ e2fsprogs-resize2fs \ ntfs-3g \ ntfsprogs \ " BS_WLAN = "kernel-module-rt2800usb \ kernel-module-rt2800lib \ kernel-module-rt2x00lib \ kernel-module-rt2x00usb \ kernel-module-cfg80211 \ kernel-module-nls-utf8 \ kernel-module-ath9k-common \ kernel-module-ath9k-hw \ kernel-module-ath9k-htc \ kernel-module-ctr \ kernel-module-ccm \ kernel-module-arc4 \ " BS_WIFI_SUPPORT = " \ iw \ dhcp-client \ wireless-tools \ wpa-supplicant \ linux-firmware \ " BS_SOFT = "mc \ kodi \ kodi-runner \ kodi-settings \ kodi-language-ru \ kodi-pvr-iptvsimple \ bs-net \ tv-config \ first-run \ script-berserk-network \ screensaver-kodi-universe \ plugin-video-youtube \ script-module-requests \ " # Include modules in rootfs IMAGE_INSTALL += " \ ${BS_BASE} \ ${BS_WLAN} \ ${BS_WIFI_SUPPORT} \ ${BS_GLIBC} \ ${BS_SOFT} \ ${BS_DEBUG_TOOLS} \ "</span></span></code> </pre><br></div></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gostaria de esclarecer que, por exemplo </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, o</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pacote </font><strong><font style="vertical-align: inherit;">kernel-modules</font></strong><font style="vertical-align: inherit;"> instalar√° </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">todos os m√≥dulos do kernel especificados no arquivo defconfig na imagem de distribui√ß√£o. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas se voc√™ personaliza fortemente alguma coisa, √© claro que talvez nem precise de todos os m√≥dulos do kernel; nesse caso, √© conveniente adicionar cada m√≥dulo pelo nome, conforme indicado na vari√°vel </font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BS_WLAN</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , √© como uma folha de dicas, especifique apenas o que voc√™ precisa e ap√≥s verificar o pacote "Kernel-modules" remove, verifica, etc.</font></font><br><br><a name="instruction_koditv"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Um breve guia para criar uma imagem de distribui√ß√£o </font></font></h2><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1) Instale as depend√™ncias do Yocto Project no Ubuntu:</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"> sudo apt-get install -y --no-install-suggests --no-install-recommends \ gawk wget git-core diffstat unzip texinfo gcc-multilib build-essential \ chrpath socat cpio python python3 python3-pip python3-pexpect \ xz-utils debianutils iputils-ping python3-git python3-jinja2 \ libegl1-mesa libsdl1.2-dev xterm</code> </pre><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2) Baixe e instale o Repo:</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"> mkdir ~/bin curl http://commondatastorage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo chmod a+x ~/bin/repo</code> </pre><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3) Fa√ßa o download do projeto no github:</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"> PATH=<span class="hljs-variable"><span class="hljs-variable">${PATH}</span></span>:~/bin mkdir torvin <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> torvin repo init -u https://github.com/berserktv/bs-manifest \ -m raspberry/rocko/torvin-0.2.5.xml repo sync</code> </pre><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4) Construa o projeto:</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs"> ./shell.sh bitbake berserk-image</code> </pre><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5) Escreva a imagem de distribui√ß√£o no cart√£o de mem√≥ria:</font></font></b> <div class="spoiler_text"><blockquote>         <br> torvin/build/tmp/deploy/images/raspberrypi3 <br><br>      <br>     : <br> berserk-image-raspberrypi3.rpi-sdimg <br><br> c       <br> c      UTC <br><br>        dd <br><br> : <br>       ¬´microSDHC¬ª <br>      . <br><br> $ sudo bash <br> $ cd torvin/build/tmp/deploy/images/raspberrypi3 <br> $ dd if=berserk-image-raspberrypi3.rpi-sdimg of=/dev/sdX bs=1M <br> $ sync <br><br>  /dev/sdX: <br> X   a,b,c  .. <br>        <br><br>         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">:</a> <br>     Windows,    <br>  Win32 Disk Imager  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">:</a> <br>      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">:</a> <br></blockquote><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nota:</font></font></b> <div class="spoiler_text"><pre> <code class="bash hljs">             N      ,      <span class="hljs-string"><span class="hljs-string">""</span></span>          ,    git  (..         <span class="hljs-string"><span class="hljs-string">""</span></span>)   :  - Intel(R) Core(TM) i5-3570 CPU @ 3.40GHz  - 8    -  USB-3.0 1T   - 4  05    - 1     - 274.8 M   torvin/build    (cache ,   ,   ,  ,   ,    ..) -   42    torvin/downloads -  9.1  (git    tar.gz )  rootfs   - 550     /lib/firmware - 212  /lib/modules - 53  :        firmware (   )       ,   200 </code> </pre><br></div></div><br><a name="postscriptum_koditv"></a><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Postscript </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os recursos do OpenSource nos √∫ltimos anos est√£o apenas aumentando. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas essas oportunidades n√£o s√£o pequenas, por exemplo, voc√™ nem precisa ir longe. √â improv√°vel que a mesma "Microsoft" esperasse que a tecnologia OpenSource a jogasse no mercado de sistemas operacionais m√≥veis. Quero dizer o sistema operacional do Google - "Android", que durante a noite jogou o "Pioneer" dos sistemas m√≥veis √† margem. E n√£o est√° claro se a Microsoft poder√° retornar a ele novamente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Claro, "Google", uma grande corpora√ß√£o com finan√ßas quase ilimitadas e excelentes desenvolvedores, mas ainda assim, como se costuma dizer "sem o Core e n√£o aqui e ali". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Os melhores projetos de c√≥digo aberto ao longo do tempo se tornam uma obra de arte (por exemplo, Kodi, Openelec / libre etc.)</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E hoje, qualquer pessoa pode aderir √†s melhores pr√°ticas no OpenSource, por assim dizer, sem sair do Github (a). </font><font style="vertical-align: inherit;">Este artigo √© sobre isso. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tenha muitas assembl√©ias boas e diferentes para voc√™ e lembre-se "o mundo da Internet das coisas est√° chegando".</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt467443/">https://habr.com/ru/post/pt467443/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt467427/index.html">BudgetTracker - outra ferramenta de c√≥digo aberto para contabilidade de finan√ßas pessoais</a></li>
<li><a href="../pt467429/index.html">Habrastatistics: explorando as se√ß√µes mais e menos visitadas do site</a></li>
<li><a href="../pt467435/index.html">Enviamos relat√≥rios do agente Veeam Linux para o correio ou no Telegram</a></li>
<li><a href="../pt467437/index.html">MVCC no PostgreSQL-1. Isolamento</a></li>
<li><a href="../pt467439/index.html">Por que o vinil voltou e como os servi√ßos de streaming est√£o relacionados a isso?</a></li>
<li><a href="../pt467445/index.html">Lista indescrit√≠vel de atualiza√ß√µes instaladas do Windows</a></li>
<li><a href="../pt467449/index.html">Detec√ß√£o de vulnerabilidades e avalia√ß√£o da resist√™ncia a ataques de hackers de cart√µes inteligentes e processadores de criptografia com prote√ß√£o integrada</a></li>
<li><a href="../pt467453/index.html">Resolvendo o problema do n√∫mero 42 usando um supercomputador planet√°rio</a></li>
<li><a href="../pt467455/index.html">Modelo QBS para programa√ß√£o de microcontroladores no QtCreator usando o exemplo de controladores Milander</a></li>
<li><a href="../pt467457/index.html">O caminho da cirurgia para o desenvolvimento de jogos ou a primeira experi√™ncia de desenvolvimento m√≥vel no Unity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>