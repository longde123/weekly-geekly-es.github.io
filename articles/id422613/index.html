<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎭 🎌 🧜🏽 Cybergroup PowerPool menguasai kerentanan nol hari di Panggilan Prosedur Lokal Lanjutan 🖥️ 🚚 👸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada tanggal 27 Agustus 2018, informasi tentang kerentanan zero-day diterbitkan di Twitter oleh seorang spesialis keamanan informasi dengan julukan Sa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Cybergroup PowerPool menguasai kerentanan nol hari di Panggilan Prosedur Lokal Lanjutan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/eset/blog/422613/"> Pada tanggal 27 Agustus 2018, informasi tentang kerentanan zero-day diterbitkan di Twitter oleh seorang spesialis keamanan informasi dengan julukan SandboxEscaper.  Kerentanan mempengaruhi versi Microsoft Windows dari 7 hingga 10, lebih tepatnya, antarmuka Panggilan Prosedur Tingkat Lanjut (ALPC) di Penjadwal Tugas Windows.  Ini memberikan Eskalasi Privilege Lokal, yang memungkinkan penyerang untuk meningkatkan hak kode berbahaya dari tingkat Pengguna ke SISTEM.  Kami tidak berbicara tentang pengungkapan kerentanan yang terkoordinasi - akun SandboxEscaper segera dihapus, tidak ada patch penutupan. <br><br>  Tautan dari tweet tersebut mengarah ke <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">repositori GitHub</a> dengan kode exploit Bukti Konsep - tidak hanya versi kompilasi, tetapi juga kode sumber.  Karena itu, siapa pun dapat memodifikasi dan mengkompilasi ulang eksploit untuk meningkatkannya, menghindari deteksi, atau memasukkannya ke dalam kode mereka sendiri. <br><br>  Secara umum, tidak mengherankan bahwa hanya dua hari kemudian, eksploitasi muncul di alam liar dalam kampanye cybergroup PowerPool.  Menurut telemetri ESET, negara-negara sasaran para penyerang adalah Rusia, Ukraina, Polandia, Jerman, Inggris, Amerika Serikat, India, Filipina, Chili.  Ada sedikit korban, yang mungkin mengindikasikan kampanye yang sangat bertarget. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/mv/j9/jp/mvj9jpgpgqtisu48y3jazkb72ms.jpeg"></div><br><a name="habracut"></a><br><h3>  Toolkit PowerPool </h3><br>  ESET mencatat grup baru yang relatif baru, namun, di peretas PowerPool berbagai alat yang cukup luas.  Selanjutnya, kami secara singkat mempertimbangkan beberapa dari mereka. <br><br><h4>  Eksploitasi hak istimewa lokal dieksploitasi di ALPC </h4> <br>  Pengembang PowerPool tidak menggunakan file biner yang diterbitkan oleh SandboxEscaper - mereka sedikit mengubah kode sumber dan mengkompilasinya.  Eksploitasi juga telah dicatat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">oleh peneliti keamanan</a> dan tim <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CERT</a> . <br><br><img src="https://habrastorage.org/webt/0q/a5/8a/0qa58aieslsijwatki-cc9wbvae.png"><br>  <i>Gambar 1. Deskripsi eksploitasi hak cipta</i> <br><br>  Pelanggaran ada di <code>SchRpcSetSecurity</code> API <code>SchRpcSetSecurity</code> , yang tidak memvalidasi hak pengguna dengan benar.  Dengan demikian, pengguna dapat menulis file apa pun ke <code>C:\Windows\Task</code> , terlepas dari izin yang sebenarnya - jika ada izin baca, dimungkinkan untuk mengganti konten file yang dilindungi tulis. <br><br>  Setiap pengguna dapat menulis file ke <code>C:\Windows\Task</code> , jadi di folder ini Anda dapat membuat file yang merupakan tautan keras ke file <i>target</i> apa pun.  Kemudian, dengan memanggil fungsi <code>SchRpcSetSecurity</code> , Anda dapat mengakses akses tulis ke file target ini.  Untuk memberikan eskalasi hak istimewa lokal, penyerang perlu memilih file target yang akan ditimpa - penting bahwa file ini dijalankan secara otomatis dengan hak administrator.  Atau, dapat berupa file sistem atau utilitas untuk memperbarui perangkat lunak yang diinstal sebelumnya, yang berjalan secara teratur.  Langkah terakhir adalah mengganti konten file target dengan kode berbahaya.  Dengan demikian, dalam eksekusi otomatis berikutnya, malware akan memiliki hak administrator, terlepas dari hak aslinya. <br><br>  Pengembang PowerPool memutuskan untuk mengubah konten file <code>C:\Program Files (x86)\Google\Update\GoogleUpdate.exe</code> .  Ini adalah pembaru yang sah untuk aplikasi Google, ini dijalankan secara teratur dengan hak administrator melalui tugas Microsoft Windows. <br><br><img src="https://habrastorage.org/webt/qe/ef/as/qeefastmi_y_som113u2cmyutwa.png"><br>  <i>Gambar 2. Membuat tautan keras ke Google Updater</i> <br><br><img src="https://habrastorage.org/webt/7d/th/ua/7dthua4tv-1sglb8uq6udcwb6na.png"><br>  <i>Gambar 3. Menggunakan SchRpcCreateFolder untuk mengubah izin untuk Google Updater yang dapat dieksekusi</i> <br><br>  Urutan operasi pada gambar di atas memungkinkan operator PowerPool untuk mendapatkan izin menulis untuk file yang dapat dieksekusi <code>GoogleUpdate.exe</code> .  Kemudian mereka menimpanya, menggantinya dengan salinan malware tahap kedua (kami akan jelaskan di bawah) untuk mendapatkan hak administrator saat kali berikutnya pembaru dipanggil. <br><br><h3>  Kompromi awal </h3><br>  Tim PowerPool menggunakan metode yang berbeda untuk pertama kali berkompromi dengan korban.  Salah satunya adalah pengiriman spam dengan malware dari tahap pertama dalam lampiran.  Ini masih dini untuk menarik kesimpulan, tetapi sejauh ini kami telah mengamati sangat sedikit sampel dalam data telemetri, jadi kami menganggap bahwa penerima dipilih dengan cermat dan kami tidak berbicara tentang pengiriman massal. <br><br>  Di sisi lain, kita tahu bahwa di PowerPool sebelumnya sudah mempraktikkan pengiriman spam.  Menurut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">posting blog SANS yang</a> diterbitkan pada Mei 2018, mereka menggunakan skema dengan file Symbolic Link (.slk) untuk menyebarkan malware.  Microsoft Excel dapat memuat file-file ini yang memperbarui sel dan menyebabkan Excel mengeksekusi kode PowerShell.  Tampaknya file .slk ini juga didistribusikan dalam pesan spam.  Berdasarkan file pertama yang disebutkan dalam posting SANS (SHA-1: b2dc703d3af1d015f4d53b6dbbeb624f5ade5553), Anda dapat menemukan sampel spam yang sesuai pada VirusTotal (SHA-1: e0882e234cba94b5cf3df2c05949e2e22822e22e <br><br><img src="https://habrastorage.org/webt/vb/go/yc/vbgoycqhjfhtfptqv-24ob43i-8.png"><br>  <i>Gambar 4. Spam PowerPool</i> <br><br><h3>  Jendela belakang </h3><br>  Kelompok PowerPool biasanya bekerja dengan dua pintu belakang: pintu belakang dari tahap pertama digunakan setelah kompromi awal, pintu belakang dari tahap kedua hanya diterapkan pada mesin yang menarik. <br><br><h4>  Backdoor tahap pertama </h4><br>  Ini adalah malware dasar yang digunakan untuk intelijen.  Terdiri dari dua executable Windows. <br><br>  Yang pertama adalah backdoor utama, yang menyediakan ketekunan melalui layanan.  Itu juga menciptakan sebuah mutex yang disebut <code>MyDemonMutex%d</code> , di mana <code>%d</code> berada dalam kisaran dari 0 hingga 10. Backdoor mengumpulkan informasi proxy, alamat server C&amp;C hardcoded dalam file biner.  Malware dapat menjalankan perintah dan melakukan intelijen dasar dalam sistem, mentransfer data ke server C&amp;C. <br><br><img src="https://habrastorage.org/webt/ps/km/ca/pskmcackoqhfcx_19gge_ryfvoa.png"><br>  <i>Gambar 5. Mengumpulkan informasi proxy</i> <br><br>  Yang kedua dari file yang dapat dieksekusi memiliki satu tujuan.  Dia mengambil tangkapan layar dan menulisnya ke file <code>MyScreen.jpg</code> , yang kemudian dapat disaring oleh pintu belakang utama. <br><br><h4>  Backdoor tahap kedua </h4><br>  Malvar dimuat selama tahap pertama, mungkin jika alat berat itu tampak menarik bagi para operator.  Namun, program ini tidak seperti backdoor ART modern. <br><br>  Alamat server C&amp;C adalah kode-keras dalam format biner, tidak ada mekanisme untuk memperbarui item konfigurasi yang penting ini.  Backdoor mencari perintah dari <code>http://[C&amp;C domain]/cmdpool</code> dan mengunduh file tambahan dari <code>http://[C&amp;C domain]/upload</code> .  File tambahan terutama alat untuk gerakan horisontal, yang disebutkan di bawah ini. <br><br>  Perintah yang didukung: <br>  - jalankan perintah <br>  - selesaikan prosesnya <br>  - kirim file <br>  - unduh file <br>  - melihat isi folder <br><br>  Perintah dikirim dalam format JSON.  Contoh di bawah ini adalah permintaan untuk mengeksekusi perintah dan folder daftar: <br><br><img src="https://habrastorage.org/webt/au/r1/nc/aur1ncfuer-g6aqayj0n7cjmkhy.png"><br>  <i>Gambar 6. Contoh perintah backdoor</i> <br><br><h3>  Alat untuk gerakan horisontal </h3><br>  Dengan memberikan akses konstan ke sistem menggunakan backdoor tahap kedua, operator PowerPool menggunakan beberapa alat sumber terbuka, yang ditulis terutama di PowerShell, untuk gerakan horizontal pada jaringan. <br><br>  - <a href="">PowerDump</a> : Modul Metasploit yang dapat mengambil nama pengguna dan hash dari Manajer Akun Keamanan. <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PowerSploit</a> : koleksi modul PowerShell, ala Metasploit. <br>  - <a href="">SMBExec</a> : alat PowerShell untuk mengeksekusi serangan pass-the-hash menggunakan protokol SMB. <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Quark PwDump</a> : Sebuah Windows yang dapat dieksekusi yang dapat mengekstrak kredensial. <br>  - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">FireMaster</a> : Windows executable yang dapat mengekstrak kata sandi yang disimpan dari Outlook, browser web, dll. <br><br><h3>  Kesimpulan </h3><br>  Pengungkapan kerentanan sebelum rilis pembaruan menempatkan pengguna pada risiko.  Dalam hal ini, bahkan versi Windows terbaru dapat dikompromikan.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">CERT-CC menawarkan</a> solusi untuk masalah ini, yang, bagaimanapun, belum disetujui secara resmi oleh Microsoft. <br><br>  Serangan PowerPool menargetkan jumlah pengguna yang terbatas.  Namun, insiden tersebut menunjukkan bahwa penyerang selalu terkini dan cepat menerapkan eksploitasi baru. <br><br>  Spesialis ESET terus memantau eksploitasi kerentanan baru.  Indikator kompromi juga tersedia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">di GitHub</a> . <br><br><h3>  Indikator kompromi </h3><br><h4>  Hash </h4><br>  Pintu Belakang Stage One (Win32 / Agent.SZS) 038f75dcf1e5277565c68d57fa1f4f7b3005f3f3 <br>  Backdoor Tahap Satu (Win32 / Agent.TCH) 247b542af23ad9c63697428c7b77348681aadc9a <br>  Pintu Belakang Tahap Kedua (Win32 / Agent.TIA) 0423672fe9201c325e33f296595fb70dcd81bcd9 <br>  Backdoor tahap kedua (Win32 / Agent.TIA) b4ec4837d07ff64e34947296e73732171d1c1586 <br>  LPPC mengeksploitasi ALPC (Win64 / Exploit.Agent.H) 9dc173d4d4f74765b5fc1e1c9a2d188d5387beea <br><br><h4>  Deteksi ESET </h4><br>  - Win32 / Agent.SZS <br>  - Win32 / Agent.TCH <br>  - Win32 / Agent.TEL <br>  - Win32 / Agent.THT <br>  - Win32 / Agent.TDK <br>  - Win32 / Agent.TIA <br>  - Win32 / Agent.TID <br><br><h4>  Server C&amp;C </h4><br>  - newsrental [.] Net <br>  - rosbusiness [.] Eu <br>  - afishaonline [.] Eu <br>  - kolektor olahraga [.] Com <br>  - 27.102.106 [.] 149 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id422613/">https://habr.com/ru/post/id422613/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id422601/index.html">Chrome 69 keluar dengan generator kata sandi acak</a></li>
<li><a href="../id422603/index.html">Sedikit lebih dekat ke kesempurnaan</a></li>
<li><a href="../id422605/index.html">Tumbuh aman sejak usia muda - program pendidikan Rostelecom dan MIPT</a></li>
<li><a href="../id422609/index.html">Penghalang Bahasa dan NLP. Mengapa chatbot tidak mengerti kami?</a></li>
<li><a href="../id422611/index.html">Handler Kesalahan Standar di RxJava2 atau mengapa RxJava menyebabkan crash aplikasi bahkan jika onError diimplementasikan</a></li>
<li><a href="../id422615/index.html">Seluruh kebenaran tentang RTOS. Artikel # 9. Penjadwal: implementasi</a></li>
<li><a href="../id422617/index.html">Seluruh kebenaran tentang RTOS. Artikel # 8. Nucleus SE: Desain dan Penyebaran Internal</a></li>
<li><a href="../id422623/index.html">Bagaimana cara mengamankan C</a></li>
<li><a href="../id422625/index.html">Kami berbicara dengan Troy Miles - programmer "Neuromancer"</a></li>
<li><a href="../id422627/index.html">MongoDB dan riset pasar kerja TI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>