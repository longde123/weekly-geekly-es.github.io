<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔩 🙉 🕺🏻 解析2或自己标记的音译的艺术 👼🏽 ⛺️ 👨‍❤️‍👨</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="+奖金：C ++中彼此相互包含类 
 哈Ha！ 本文是我们亲手进行“解析的艺术”或DOM的文章的直接延续，在该文章中，我们解析了HTML文档，并在其基础上构建了抽象语法树（AST），该树仅通过使用标准C ++库进行索引即可访问任何元素，换句话说，我们学会了自行解析类似XML的东西。 让我提醒您，解析...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>解析2或自己标记的音译的艺术</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/444876/"><h4>  +奖金：C ++中彼此相互包含类 </h4><br> 哈Ha！ 本文是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">我们亲手进行“解析</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">艺术”或DOM</a>的文章的直接延续，在该文章中，我们解析了HTML文档，并在其基础上构建了抽象语法树（AST），该树仅通过使用标准C ++库进行索引即可访问任何元素，换句话说，我们学会<i>了</i>自行<i>解析</i>类似XML的东西。 让我提醒您，解析或<i>解析/分析</i>的过程包括两个阶段： <i>词法分析</i> （将文本分析成标记）和AST的构建。 如果我们通过示例和源代码对第一个进行了详细的研究，那么对第二个的描述就好像是一个空的蝴蝶娃娃，只有一个外壳，作者在出版之前就提取了出色的内容。 有一个原因，对于HTML来说，树的构建非常容易，您只需要4个类：空标记，块，文本节点和从块继承的文档根。 今天，我们将留下这样的简单性，并建立一棵树，其中元素的属性（空元素和块元素）将不包含在标签的属性中，而是直接包含在类中，为此，您将必须创建许多类。 真的很多 我们将不使用简单的众所周知的标记语言进行构建，而是使用剪切下图像中显示的规则创建自己的标记语言。 另外，最后，我们将翻译或更正确地<i>翻译</i>上一篇文章，并用我们的语言，HTML进行标记，此外，我将向C ++初学者回答一个琐碎但难以发现的问题：如何将类彼此合并？ <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/gp/bv/er/gpbverq2xlourlzxmmmhghayhem.png"><br><br><h2> 语法笔记 </h2><br> 在直接开始构建树之前，让我们刷新一下记忆并阐明初步工作的一些细节。 您是否还记得该语言的整个语法需要以一种无上下文形式语法（例如BNF）的形式编写？ 只是对于初学者来说，很难立即掌握它们，而且，不能描述这些语法的所有可能规则。 在这种情况下，如果您陷入困境，并且没有以正确的形式制定特定的规则，则可以将其记为自然人类语言的注释，例如，如下所示： <br><br><pre><code class="html hljs xml">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ordered_list_item</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number_marker</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number_marker</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> "." {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> "."} " " <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span>} !! link ending "&gt;" and image/span ending "]" can't follow "\n" or document start</code> </pre> <br> 翻译： <i>“&gt;”链接</i>的<i>末尾和image / inline元素“]”不能立即跟在行或文档的开头</i> 。 <br><br> 也就是说，如果词法分析器在该行的开头遇到“]”或“&gt;”，我们必须指示它忽略这些字符的特殊含义，并像处理纯文本一样使用它们。 这种向语法添加注释的方法并不是唯一的方法；您可以按照自己的方式来做。 最后，带有语法描述的文件不是术语纸，没有人强迫您遵守所有规则，并且重要的是要方便使用它。 最主要的是不要忘记所做的注释，并将其反映在代码的正确部分中。 <br><br> 让我们看一下这种语言的完整描述： <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">article</span></span></span><span class="hljs-tag">&gt;</span></span> = {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">article_item</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">article_item</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">underline</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag">&gt;</span></span> (* ARTICLE ITEMS *) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">underline</span></span></span><span class="hljs-tag">&gt;</span></span> = "___" {"_"} "\n" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">section</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">paragraphs</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">quote</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cite</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unordered_list</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ordered_list</span></span></span><span class="hljs-tag">&gt;</span></span> (* SECTION ITEMS *) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">paragraphs</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">paragraph</span></span></span><span class="hljs-tag">&gt;</span></span> {"\n" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">paragraph</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">paragraph</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} ("\n" | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">END</span></span></span><span class="hljs-tag">&gt;</span></span>) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bold</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">italic</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">underlined</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">overlined</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">throwlined</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">subscript</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">superscript</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">marked</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">monospace</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">notification</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">signs</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">left_angle_bracket</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">right_angle_bracket</span></span></span><span class="hljs-tag">&gt;</span></span> ("\n" | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">END</span></span></span><span class="hljs-tag">&gt;</span></span>) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">signs</span></span></span><span class="hljs-tag">&gt;</span></span> "######" | "#####" | "####" | "###" | "##" | "#" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">quote</span></span></span><span class="hljs-tag">&gt;</span></span> = "&gt; " {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} ("\n" | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">END</span></span></span><span class="hljs-tag">&gt;</span></span>) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cite</span></span></span><span class="hljs-tag">&gt;</span></span> = "&gt;&gt;" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> ("\n" | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">END</span></span></span><span class="hljs-tag">&gt;</span></span>) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span>} (* PARAGRAPH ITEMS *) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bold</span></span></span><span class="hljs-tag">&gt;</span></span> = "*[" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} "]" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">italic</span></span></span><span class="hljs-tag">&gt;</span></span> = "%[" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} "]" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">underlined</span></span></span><span class="hljs-tag">&gt;</span></span> = "_[" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} "]" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">overlined</span></span></span><span class="hljs-tag">&gt;</span></span> = "^[" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} "]" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">throwlined</span></span></span><span class="hljs-tag">&gt;</span></span> = "~[" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} "]" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">subscript</span></span></span><span class="hljs-tag">&gt;</span></span> = "&amp;[" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} "]" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">superscript</span></span></span><span class="hljs-tag">&gt;</span></span> = "+[" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} "]" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">marked</span></span></span><span class="hljs-tag">&gt;</span></span> = "=[" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} "]" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">monospace</span></span></span><span class="hljs-tag">&gt;</span></span> = "`[" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} "]" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textline</span></span></span><span class="hljs-tag">&gt;</span></span> "\n" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textline</span></span></span><span class="hljs-tag">&gt;</span></span> "\n"} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">textline</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">symbol</span></span></span><span class="hljs-tag">&gt;</span></span> = /^[\n]/ <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">link</span></span></span><span class="hljs-tag">&gt;</span></span> = "<span class="hljs-tag"><span class="hljs-tag">&lt;&lt;" &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">text</span></span></span><span class="hljs-tag">&gt;</span></span> "&gt;" {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span>} "&gt;" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image</span></span></span><span class="hljs-tag">&gt;</span></span> = "[<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">"</span></span></span><span class="hljs-tag"> &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">text</span></span></span><span class="hljs-tag">&gt;</span></span> "&gt;" [<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span>] "]" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">notification</span></span></span><span class="hljs-tag">&gt;</span></span> = (" " | "\n") "@" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">word</span></span></span><span class="hljs-tag">&gt;</span></span> (" " | "\n" | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">END</span></span></span><span class="hljs-tag">&gt;</span></span>) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">word</span></span></span><span class="hljs-tag">&gt;</span></span> = (<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">letter</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span>) {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">letter</span></span></span><span class="hljs-tag">&gt;</span></span> | <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">letter</span></span></span><span class="hljs-tag">&gt;</span></span> = "a" | "b" | "c" | "d" | ... | "_" | "-" <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span> = "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9" (* LISTS *) <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unordered_list</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unordered_list_item</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unordered_list_item</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ordered_list</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ordered_list_item</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ordered_list_item</span></span></span><span class="hljs-tag">&gt;</span></span>} <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">unordered_list_item</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">marker</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">marker</span></span></span><span class="hljs-tag">&gt;</span></span> = ("*" {"*"}) | ("+" {"+"}) " " <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ordered_list_item</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number_marker</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number_marker</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> "." {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> "."} " " <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">number</span></span></span><span class="hljs-tag">&gt;</span></span> = <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span> {<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">digit</span></span></span><span class="hljs-tag">&gt;</span></span>} !! link ending "&gt;" and image/span ending "]" can't follow "\n" or document start</code> </pre><br> 上一次，有必要写出终端并检查每个输入字符是否符合其中之一。 但是那时终端是单个字符！ 现在，除了突出显示终端外，还需要将它们本身划分为<i>按键</i> -即字符。 为什么是“钥匙”？ 它们是词法分析器的关键。 作为所有操作的结果，以下行将显示在语法文件中： <br><br><pre> <code class="html hljs xml">(* TERMINALS *) "___...", "\n", "\n\n", "&gt; ", "&gt;&gt;...", "###...[", "*[", "%[", "_[", "^[", "~[", "&amp;[", "+[", "=[", "`[", "]", "<span class="hljs-tag"><span class="hljs-tag">&lt;&lt;", "[&lt;", "&gt;</span></span>", " @... ", "\n@...\n", " @...\n", "\n@... ", "***... ", "+++... ", "123.56. " (* KEYS *) "_", "\n" "&gt;", "#", "*", "%", "^", "~", "&amp;", "+", "=", "`", "<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">",</span></span></span><span class="hljs-tag"> "[", "]", " ", "@", "</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1..9</span></span></span><span class="hljs-tag">", "</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">.</span></span></span><span class="hljs-tag">", &lt;</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">END</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h2> 预期类型的​​代币堆栈 </h2><br> 上一次，一切都变得更加简单，我们只有10种类型的代币，还不包括结局，而且在这个代币动物园中迷失的机会更少。 现在显然有更多类型。 让我提醒您，词法分析器的任务是让解析器尽可能少地工作，理想情况下，仅构建一棵树。 因此，令牌类型集应尽可能准确地反映其本质。 在第一篇文章中，我给出了一个很好的例子，在此我将给出一个“反例”。 看到终端以内联文本元素开始（粗体-粗体，斜体-斜体等）吗？ 我们可以将它们解析为一对标记：主标记（“ *”，“％”等）和从标记（“ [”），并将其以格式传递给解析器。 容易猜测，最好在词法分析器级别对文本元素进行精确定义，即 将“ * [”定义为“ bold_start”，将“％[”定义为“ italic_start”，依此类推。 类型越多，它们反映自己的准确度就越高。 而且，第二个比第一个更重要。 例如，我们可以解析“ @”符号和用户名的通知，但是显然，最好将它们组合在一个令牌中。 <br> 好吧，我们决定了类型。 从哪里开始将文本解析为令牌的过程？ 然后，从头开始。 紧随已解析文档的开头之后会发生什么？ 不要急于弯曲手指。 与HTML不同，这里所有22种类型都可以开始。 没关系，有了一点点的统一，我们这样写： <br><br><pre> <code class="cpp hljs">curr_token_type = TEXT | UNDERLINE | TITLE_START | QUOTE_START | CITE | BOLD_START | ...</code> </pre> <br> 并在符号处理功能中： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> TEXT | UNDERLINE | TITLE_START | QUOTE_START | CITE | ...</code> </pre> <br> 如果您不了解要解决的问题，请阅读<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">第一篇文章</a> 。 <br><br> 不要担心期望令牌的长泛型类型。 字符串的第一个字符立即将其长度减少到2-4种。 由于我们的终端是多字符，因此定义基于键。 <br><br> 很简单，自己看看： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c == <span class="hljs-string"><span class="hljs-string">'_'</span></span>) { buffer.push_back(<span class="hljs-string"><span class="hljs-string">'_'</span></span>); curr_token_type = TEXT | UNDERLINE | UNDERLINED_START;</code> </pre><br> 下划线立即将正在构造的令牌确定为以下三种类型之一：纯文本，水平线或带下划线的文本的开头（“ _ [”）。 <br><br> 回到问题，如何跟踪所有泛型并记住对它们进行处理？ 在笔记本上叠一叠！ 没错，在列表中写下出现在“ curr_token_type = ...”之后的所有泛型类型，处理完其中一种后，从末尾取下另一种。 您可以使用列表和队列来组织工作，这无关紧要。 最主要的是，您不会忘记哪些类型已经被处理，哪些类型仍需要处理。 <br><br><h2> 类树 </h2><br> 最后，我们开始解析。 在这里，您需要以与确定令牌类型相同的方式来确定未来树的节点（节点）的类。 为此，请再次打开笔记本并输入以下内容： <br><br><pre> <code class="cpp hljs">Node { Node * parent, Node_type type } #- Root { Root_item[] children, ulong children_count }</code> </pre><br> 因此，我们定义了所有节点的将来基类及其派生类-树的根，即文档本身。 文档（请参见上面的BPF）由两种类型的节点组成：节和水平线（下划线）。 我们为它们定义基类Root_item，并以与描述根相同的方式描述它们。 另外，在这里，我们在记事本中立即指示类的所有其他字段（如果有）。 从根本上讲，这是“孩子”的数量，即 内部部分和水平线。 本节由一些元素组成，我们将为其定义基类Div，依此类推，在语法中递归移动，我们将确定所需的所有类。 在编写代码之前，我们在这里定义所有标头。 这很简单：基本广义类的所有直接后代必须包含在包含它们的类中。 <br><br> 在晶格之后以列表的形式表示这些依赖关系，我们得到以下文档： <br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">Node</span></span> { Node * parent, Node_type type } <span class="hljs-selector-id"><span class="hljs-selector-id">#-</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Root</span></span> { Root_item[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Underline</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Section</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Root_item</span></span> {} <span class="hljs-selector-id"><span class="hljs-selector-id">#-</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Underline</span></span> {} <span class="hljs-selector-tag"><span class="hljs-selector-tag">Section</span></span> { Div[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Paragraph</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Title</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Quote</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Cite</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Unordered_list</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Ordered_list</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Div</span></span> {} <span class="hljs-selector-id"><span class="hljs-selector-id">#-</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Paragraph</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Title</span></span> { char level, Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Quote</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Cite</span></span> { ulong number } <span class="hljs-selector-id"><span class="hljs-selector-id">#-</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Unordered_list</span></span> { Div } <span class="hljs-selector-id"><span class="hljs-selector-id">#Paragraph</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Title</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Quote</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Cite</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Ordered_list</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Ordered_list</span></span> { Div } <span class="hljs-selector-id"><span class="hljs-selector-id">#Paragraph</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Title</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Quote</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Cite</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">Unordered</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">list</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Span</span></span> {} <span class="hljs-selector-id"><span class="hljs-selector-id">#-</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Bold</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Italic</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Underlined</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Overlined</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Throwlined</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Subscript</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Superscript</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Marked</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Monospace</span></span> { Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Link</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Text</span></span> { string text } <span class="hljs-selector-id"><span class="hljs-selector-id">#-</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Image</span></span> { string src, string alt } <span class="hljs-selector-id"><span class="hljs-selector-id">#-</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Link</span></span> { string URL, Span[] children, ulong children_count } <span class="hljs-selector-id"><span class="hljs-selector-id">#Bold</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Italic</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Underlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Overlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Throwlined</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Subscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Superscript</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Marked</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Monospace</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Text</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Image</span></span>, <span class="hljs-selector-id"><span class="hljs-selector-id">#Notification</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Notification</span></span> { string user } <span class="hljs-selector-id"><span class="hljs-selector-id">#-</span></span></code> </pre><br> 在这里，我将“＃-”标记为不依赖，并删除了类本身。 <br> 我们注意到，所有内置的格式设置类（粗体，斜体，...）都相互依赖，此外，Link类也相互依赖！ 处于类似位置的是Unordered_list和Ordered_list。 相互之间包含标头不仅会导致忽略其中的一个，正如预期的那样，而且也不会通过预处理器的验证，并且单面包含将不允许我们在包含的类中声明打开类元素并返回指向它的链接的功能。 如何成为 有两种方法。 <br><br><h2> 相互包含类 </h2><br> 首先，查看Monospace的类Bold，Italic等。 他们是一样的。 如此之多，以至于可以将它们组合为一个“内联”类。 也许这个决定会引起怀疑。 这也引起了我的注意，但实际上，它们之间的差异仅影响终端中的树状结构和HTML中的标记形式的表示形式。 如果您看到某些类包含相同的字段，具有相同的依存关系并且在形式语法中通常具有相似的描述，请随意组合它们。 因此，您可以使自己和处理器变得更容易。 <br><br> 但是，这种技巧不适用于Link类，因为它包含一个附加字段-URL字符串。 我们将使用第二种方法。 <br><br> 大家都知道在C ++编程中将类分为声明和定义是一种好方法吗？ 在扩展名为.h或.hpp的标头中，在扩展名为.cpp的源代码中，对吗？ 现在，我转向编程的新手：坐下来并系好安全带，因为这会令人不快。 毕竟，我们在扩展名为.h的文件中所指定的仅<b>是</b>类的<b>定义</b> 。 在.cpp文件中，已经有此类<b>的方法</b>的<b>实现</b> 。 不明白吗？ 我们在学校被骗了。 如果一个类不包含模板，则在一行中将其声明为一个函数。 <br><br> 它比函数更简单，因为它没有参数。 这是一个典型的类<i>声明</i> ： <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyClass</span></span></span><span class="hljs-class">;</span></span></code> </pre> <br> 就是这样！ 字段和方法的声明已经是其<i>定义</i> 。 <br><br> 我们将利用这一点。 我们将Inline类的标题包含在Link类的标题中，并在<i>定义</i> Inline类之前先声明Link类本身。  inline.h文件应如下所示： <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">ifndef</span></span></span><span class="hljs-meta"> INLINE_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> INLINE_H #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"AST/span.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"AST/text.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"AST/image.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"AST/notification.h"</span></span></span><span class="hljs-meta"> class Link; class Inline : public Span { public: static const unsigned long MAX_CHILDREN_COUNT = 0xFFFFFF; private: Span ** children; unsigned long children_count; unsigned long extended; void extend(); public: Inline(const Node * parent, const Node_type &amp;type); Inline(const Span * span); ~Inline(); Inline * add_text(const string &amp;text); Inline * add_image(const string &amp;src, const string &amp;alt); Inline * add_notification(const string &amp;user); Link * open_link(const string &amp;URL); ...</span></span></code> </pre><br>  Inline类仍然对Link类，其字段和方法一无所知，但可以肯定地知道其存在。 因此，我们可以声明返回<u>指向</u> Link类对象的<u>指针</u>或将其作为参数接受的方法。 单词<i>指针</i>不是随机选择的，Inline类尚不知道如何构建Link类型的对象，因为它没有访问其构造函数的权限，但可以使用所有指针，因为 它们都有相同的界面。 但是我们在这里不需要对象。 但是在open_link方法的实现中，将创建Link类型的对象并返回指向它的指针，这意味着在预处理器进入该方法时，应声明open_link方法可能需要的构造函数和其他Link方法。 在这里，我们利用将源代码分为带有标头和实现的单独文件的优势。  inline.h文件包含在inline.cpp文件（“ undercloud”）中，但link.h文件不包含在inline.h中。 因此，将其包含在inline.cpp中将成为预处理器的第一个包含项。 然后inline.cpp文件将像这样开始： <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"inline.h"</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"link.h"</span></span></span><span class="hljs-meta"> ...</span></span></code> </pre><br> 我重复以上所有内容。 类Ah的标题照常包含在类Bh的标题中，并且类B在类A之前声明，我们将其标题包含在源A.cpp中。 我认为，这种方法不是唯一的，而是最简单的。 <br><br> 我注意到，如果我们在类A的<i>定义</i>之前写下它的<i>声明</i> ，则类的这种相互包含并不能阻止类B从类A继承。这正是我所做的，是从Unordered_list继承Ordered_list。 <br><br><h2> 建树 </h2><br> 因此，我们开始构建抽象语法树。 在上一篇文章中，该函数适合50行。 剧透：这次增加到了1400个左右。操作原理是相同的：我们检查每个令牌的类型，并根据它执行特定的代码段，将一个开放树节点存储在内存中。 但是，如果要解析HTML，几乎所有节段都只包含三个命令中的一个，那就是：在打开的命令中添加一个空节点，在打开的命令中打开一个新节点并关闭该打开的节点，返回其父节点，那么此处所需的操作也取决于打开的节点的类型。 例如，如果正在处理“水平线”令牌，并且打开节点是文档根目录，那么只需使用浇铸和条件名称为add_line（）的函数向该打开节点添加一行，如下所示： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == Node::ROOT) static_case&lt;Root*&gt;(open_node)-&gt;add_line();</code> </pre><br> 但是，如果打开节点是一个段落（段落），则首先需要关闭它和所有可能的祖先（项目列表和编号列表），直到打开节点变为“节”类型，然后将其关闭： <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == Node::PARAGRAPH) { open_node = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;Paragraph*&gt;(open_node)-&gt;close(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (open_node-&gt;get_type() != Node::SECTION) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (open_node-&gt;get_type() == Node::UNORDERED_LIST) open_node = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;Unordered_list*&gt;(open_node)-&gt;close(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (open_node-&gt;get_type() == Node::UNORDERED_LIST) open_node = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;Unordered_list*&gt;(open_node)-&gt;close(); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (open_node-&gt;get_type() == Node::PARAGRAPH) open_node = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;Paragraph*&gt;(open_node)-&gt;close(); } open_node = <span class="hljs-keyword"><span class="hljs-keyword">static_cast</span></span>&lt;Section*&gt;(open_node)-&gt;close(); open_node = tree-&gt;add_line(); }</code> </pre><br> 如果开放节点是图像的标题，则水平线将完全破坏语法，并且必须引发异常，并且如果开放节点不是链接，并且传入令牌“&gt;”类型为“ LINK_FINISH”，则不应将其作为链接的结尾进行处理，而是如何处理文字等 <br><br> 因此，检查传入令牌类型的交换机/案例树必须包含另一个交换机/案例树，后者检查开放节点的类型。 起初很难解决这样的问题，但是没有必要从头开始，从第一个条件开始。 您可以创建用您的语言标记的标准文档/包含使用您的语言编写的脚本，并在文档过程中实现条件，并通过向终端输出伪树来检查结果。 我将上一篇文章作为这样的文档，收到的第一个令牌是标题的开头。 因此，我们以TITLE_START类型处理令牌。 以下是标题文本和右方括号，我们处理TEXT和SPAN_OR_IMAGE_FINISH类型的令牌。 <br><br> 在那之后，我们将已经有一个这样的迷你树： <br><br><pre> <code class="plaintext hljs">&lt;article&gt; | +-&lt;section&gt; | +-&lt;h1&gt; | +-"   DOM  "</code> </pre><br> 在此过程中，您会注意到某些类包含具有相同算法的相同方法。 例如，段落段落类和引号引号以相同的方式打开链接并向其中添加文本。 在这种情况下，重构时最好的解决方案是使用这些方法创建一个类并从中继承必要的节点。 我尝试实现这一点，但是我的技能还不够，在转换时我对模棱两可感到困惑，因此我只给出词法分析器和解析器的结果： <br><br><div class="spoiler">  <b class="spoiler_title">文章本身</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">@2che &gt;&gt;442964 #[   DOM  ] , !          markdown,       ,   —           « »,     .   ,    ,    , ,  LibreOffice Writer,  %[ ],   — %[].     ,        «parser example», «html to DOM», «how to parse html»  .   ,              ,    ,   flex, bison, llvm  yacc. ,      ,    (gumbo, jsoup, rapidjson,  Qt  .)  ,              C++     ,              .  ,        AST (  ),    ,      ,       .  , —    —       ,       .           .           ,      .    ,    ,     .    HTML,      .  , ,  %[ ] —         .      : 1. *[ ]    —    ,    . 2. *[ ] —        %[  ] (AST — abstract syntax tree),  %[  ] (DOM — document object model).    .  ,     IDE   ,     .   -    — %[ - ()]  %[  -].    ,     .        : &gt; `[&lt;&gt; = &lt;_1&gt; &lt;_&gt; &lt;_2&gt;]       ,    . ,   ,     «»   ..   ?            : %[]  %[]. *[] — ,  : &gt; `[&lt;_1&gt; = &lt;&gt; (&lt;_&gt; | &lt;_&gt;) &lt;&gt;] *[] ,    .      : &gt; `[&lt;&gt; = &lt;_1&gt; "+" &lt;_2&gt; &lt;_1&gt; = &lt;&gt; ("*" | "/") &lt;&gt;]  "+", "*", "/" — .      ,          , —   .       &lt;&lt;https://ru.wikipedia.org/wiki/%D0%A4%D0%BE%D1%80%D0%BC%D0%B0_%D0%91%D1%8D%D0%BA%D1%83%D1%81%D0%B0_%E2%80%94_%D0%9D%D0%B0%D1%83%D1%80%D0%B0&gt;&gt;  &lt;&lt;https://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0_%D0%91%D1%8D%D0%BA%D1%83%D1%81%D0%B0_%E2%80%94_%D0%9D%D0%B0%D1%83%D1%80%D0%B0&gt;&gt;.    —    ,   .          ,     . ,     , ,        .     ,             ,        ,   . ,    .     HTML5   : &gt; `[stub]   ,      (   , ..  ,      ).     :  ,                , ? ,       ,  .  .  ,  disassemble(ifsteam &amp;file)   ,             process(const char &amp;c),    . ,   process   switch,              .     :    switch    ,     .  ,       ,   . ,      : , ,  ,      HTML    ( PHP,   "&lt;?… ?&gt;".        case.   ?    .       (  —  ,      —      ).         (1, 2, 4, 8  .).        : 0001, 0010, 0100  ..,           .      ,  .   : &gt; `[enum Token_type { END = 1, TEXT = 2, OPENING_BLOCK_TAG_NAME = 4, CLOSING_BLOCK_TAG_NAME = 8, EMPTY_TAG_NAME = 16, COMMENT = 32, MACRO_TAG = 64, ATTRIBUTE_NAME = 128, UNQUOTED_ATTRIBUTE_VALUE = 256, SINGLE_QUOTED_ATTRIBUTE_VALUE = 512, DOUBLE_QUOTED_ATTRIBUTE_VALUE = 1024 };]   process: &gt; `[stub]    switch    ( ),    case       .    ,    :     ,      ,      (),   .               .       ()    ,      «»  ..         gedit: [&lt;https://hsto.org/webt/72/fw/tw/72fwtwt_waeie4ulzftkxua356w.png&gt;]     ,           .     disassemble: &gt; `[stub]        TEXT,       END    ( ,  ).         HTML-  ,    - PHP,         "[ "&lt;_&gt;": &lt;_&gt; ]".   : &gt; =[ `[stub]] =[ `[stub]]        —   .     ,             -.         DOM,    .        HTML-?   —      ,         ,     —   «Node»,     «Block» (,     )       «Root».      ,    , ,  &lt;p&gt;, &lt;li&gt;, &lt;strong&gt;  ,      .    .      ,    —            :     ,     ,    .   ,   ,    Node,   ,    .    %[  ].  : &gt; `[stub]   !     ,      : `[| +--&lt;ROOT&gt; | +--&lt;!DOCTYPE&gt; | +--&lt;html&gt; | +--&lt;head&gt; | | | +--&lt;meta&gt; | | | +--&lt;meta&gt; | | | +--&lt;meta&gt; | | | +--&lt;meta&gt; | | | +--&lt;meta&gt; | | | +--&lt;meta&gt; | | | +--&lt;meta&gt; | | | +--&lt;meta&gt; | | | +--&lt;meta&gt; | | | +--&lt;title&gt; | | | +--&lt;link&gt; | | | +--&lt;link&gt; | | | +--&lt;COMMENT&gt; | +--&lt;body&gt; | +--&lt;header&gt; | | | +--&lt;div&gt; | +--&lt;nav&gt; | | | +--&lt;ul&gt; | | | +--&lt;li&gt; | | | | | +--&lt;a&gt; | | | +--&lt;li&gt; | | | | | +--&lt;a&gt; | | | +--&lt;li&gt; | | | +--&lt;a&gt; | +--&lt;main&gt; | | | +--&lt;MACRO&gt; | +--&lt;footer&gt; | +--&lt;hr&gt; | +--&lt;small&gt;] ,       DOM,   jQuery, Jsoup, beautifulsoup  Gumbo   ,   ,       ,     &lt;style&gt;  &lt;script&gt;,      .   ,     . . PS     &lt;&lt;https://gitlab.com/2che/nyHTML&gt;&gt;. , ,      .</code> </pre></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">来自词法分析器的令牌</font></font></b> <div class="spoiler_text"><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0：[“ 2che”：通知]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1：[“</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
“：NEWLINE]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2：[“ 442964”：CITE]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
3：[“＃[”：TITLE_START]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4：[“解析或自己动手做DOM的艺术”：TEXT]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5：[“]”：SPAN_OR_IMAGE_FINISH]</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6：[“</font></font><font></font>
<font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
”：DOUBLE_NEWLINE]</font></font><font></font>
7: [ ", !          markdown,       ,   —           « »,     .   ,    ,    , ,  LibreOffice Writer,  " : TEXT ]<font></font>
8: [ "%[" : ITALIC_START ]<font></font>
9: [ " " : TEXT ]<font></font>
10: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
11: [ ",   — " : TEXT ]<font></font>
12: [ "%[" : ITALIC_START ]<font></font>
13: [ "" : TEXT ]<font></font>
14: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
15: [ ".     ,        «parser example», «html to DOM», «how to parse html»  .   ,              ,    ,   flex, bison, llvm  yacc. ,      ,    (gumbo, jsoup, rapidjson,  Qt  .)  ,              C++     ,              .  ,        AST (  ),    ,      ,       ." : TEXT ]<font></font>
16: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
17: [ " , —    —       ,       .           .           ,      .    ,    ,     .    HTML,      ." : TEXT ]<font></font>
18: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
19: [ " , ,  " : TEXT ]<font></font>
20: [ "%[" : ITALIC_START ]<font></font>
21: [ " " : TEXT ]<font></font>
22: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
23: [ " —         .      :" : TEXT ]<font></font>
24: [ "<font></font>
" : NEWLINE ]<font></font>
25: [ "1. " : ORDERED_LIST_ITEM_MARKER ]<font></font>
26: [ "*[" : BOLD_START ]<font></font>
27: [ " " : TEXT ]<font></font>
28: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
29: [ "    —    ,    ." : TEXT ]<font></font>
30: [ "<font></font>
" : NEWLINE ]<font></font>
31: [ "2. " : ORDERED_LIST_ITEM_MARKER ]<font></font>
32: [ "*[" : BOLD_START ]<font></font>
33: [ " " : TEXT ]<font></font>
34: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
35: [ " —        " : TEXT ]<font></font>
36: [ "%[" : ITALIC_START ]<font></font>
37: [ "  " : TEXT ]<font></font>
38: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
39: [ " (AST — abstract syntax tree),  " : TEXT ]<font></font>
40: [ "%[" : ITALIC_START ]<font></font>
41: [ "  " : TEXT ]<font></font>
42: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
43: [ " (DOM — document object model)." : TEXT ]<font></font>
44: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
45: [ "   .  ,     IDE   ,     .   -    — " : TEXT ]<font></font>
46: [ "%[" : ITALIC_START ]<font></font>
47: [ " - ()" : TEXT ]<font></font>
48: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
49: [ "  " : TEXT ]<font></font>
50: [ "%[" : ITALIC_START ]<font></font>
51: [ "  -" : TEXT ]<font></font>
52: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
53: [ ".    ,     .        :" : TEXT ]<font></font>
54: [ "<font></font>
" : NEWLINE ]<font></font>
55: [ "&gt; " : QUOTE_START ]<font></font>
56: [ "`[" : MONOSPACE_START ]<font></font>
57: [ "&lt;" : TEXT ]<font></font>
58: [ "&gt;" : LINK_FINISH ]<font></font>
59: [ " = &lt;_1" : TEXT ]<font></font>
60: [ "&gt;" : LINK_FINISH ]<font></font>
61: [ " &lt;_" : TEXT ]<font></font>
62: [ "&gt;" : LINK_FINISH ]<font></font>
63: [ " &lt;_2" : TEXT ]<font></font>
64: [ "&gt;" : LINK_FINISH ]<font></font>
65: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
66: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
67: [ "      ,    . ,   ,     «»   .." : TEXT ]<font></font>
68: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
69: [ "  ?" : TEXT ]<font></font>
70: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
71: [ "           : " : TEXT ]<font></font>
72: [ "%[" : ITALIC_START ]<font></font>
73: [ "" : TEXT ]<font></font>
74: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
75: [ "  " : TEXT ]<font></font>
76: [ "%[" : ITALIC_START ]<font></font>
77: [ "" : TEXT ]<font></font>
78: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
79: [ ". " : TEXT ]<font></font>
80: [ "*[" : BOLD_START ]<font></font>
81: [ "" : TEXT ]<font></font>
82: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
83: [ " — ,  :" : TEXT ]<font></font>
84: [ "<font></font>
" : NEWLINE ]<font></font>
85: [ "&gt; " : QUOTE_START ]<font></font>
86: [ "`[" : MONOSPACE_START ]<font></font>
87: [ "&lt;_1" : TEXT ]<font></font>
88: [ "&gt;" : LINK_FINISH ]<font></font>
89: [ " = &lt;" : TEXT ]<font></font>
90: [ "&gt;" : LINK_FINISH ]<font></font>
91: [ " (&lt;_" : TEXT ]<font></font>
92: [ "&gt;" : LINK_FINISH ]<font></font>
93: [ " | &lt;_" : TEXT ]<font></font>
94: [ "&gt;" : LINK_FINISH ]<font></font>
95: [ ") &lt;" : TEXT ]<font></font>
96: [ "&gt;" : LINK_FINISH ]<font></font>
97: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
98: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
99: [ "*[" : BOLD_START ]<font></font>
100: [ "" : TEXT ]<font></font>
101: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
102: [ " ,    .      :" : TEXT ]<font></font>
103: [ "<font></font>
" : NEWLINE ]<font></font>
104: [ "&gt; " : QUOTE_START ]<font></font>
105: [ "`[" : MONOSPACE_START ]<font></font>
106: [ "&lt;" : TEXT ]<font></font>
107: [ "&gt;" : LINK_FINISH ]<font></font>
108: [ " = &lt;_1" : TEXT ]<font></font>
109: [ "&gt;" : LINK_FINISH ]<font></font>
110: [ " "+" &lt;_2" : TEXT ]<font></font>
111: [ "&gt;" : LINK_FINISH ]<font></font>
112: [ "<font></font>
" : NEWLINE ]<font></font>
113: [ "&lt;_1" : TEXT ]<font></font>
114: [ "&gt;" : LINK_FINISH ]<font></font>
115: [ " = &lt;" : TEXT ]<font></font>
116: [ "&gt;" : LINK_FINISH ]<font></font>
117: [ " ("*" | "/") &lt;" : TEXT ]<font></font>
118: [ "&gt;" : LINK_FINISH ]<font></font>
119: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
120: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
121: [ " "+", "*", "/" — ." : TEXT ]<font></font>
122: [ "<font></font>
" : NEWLINE ]<font></font>
123: [ "     ,          , —   ." : TEXT ]<font></font>
124: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
125: [ "      " : TEXT ]<font></font>
126: [ "&lt;&lt;" : LINK_START ]<font></font>
127: [ "https://ru.wikipedia.org/wiki/%D0%A4%D0%BE%D1%80%D0%BC%D0%B0_%D0%91%D1%8D%D0%BA%D1%83%D1%81%D0%B0_%E2%80%94_%D0%9D%D0%B0%D1%83%D1%80%D0%B0" : TEXT ]<font></font>
128: [ "&gt;" : LINK_FINISH ]<font></font>
129: [ "" : TEXT ]<font></font>
130: [ "&gt;" : LINK_FINISH ]<font></font>
131: [ "  " : TEXT ]<font></font>
132: [ "&lt;&lt;" : LINK_START ]<font></font>
133: [ "https://ru.wikipedia.org/wiki/%D0%A0%D0%B0%D1%81%D1%88%D0%B8%D1%80%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F_%D1%84%D0%BE%D1%80%D0%BC%D0%B0_%D0%91%D1%8D%D0%BA%D1%83%D1%81%D0%B0_%E2%80%94_%D0%9D%D0%B0%D1%83%D1%80%D0%B0" : TEXT ]<font></font>
134: [ "&gt;" : LINK_FINISH ]<font></font>
135: [ "" : TEXT ]<font></font>
136: [ "&gt;" : LINK_FINISH ]<font></font>
137: [ ".    —    ,   .          ,     . ,     , ,        .     ,             ,        ,   . ,    .     HTML5   :" : TEXT ]<font></font>
138: [ "<font></font>
" : NEWLINE ]<font></font>
139: [ "&gt; " : QUOTE_START ]<font></font>
140: [ "`[" : MONOSPACE_START ]<font></font>
141: [ "stub" : TEXT ]<font></font>
142: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
143: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
144: [ "  ,      (   , ..  ,      ).     :  ,                , ? ,       ,  .  .  ,  disassemble(ifsteam &amp;file)   ,             process(const char &amp;c),    . ,   process   switch,              .     :    switch    ,     .  ,       ,   . ,      : , ,  ,      HTML    ( PHP,   "&lt;?… ?" : TEXT ]<font></font>
145: [ "&gt;" : LINK_FINISH ]<font></font>
146: [ "".        case.   ?    .       (  —  ,      —      ).         (1, 2, 4, 8  .).        : 0001, 0010, 0100  ..,           .      ,  .   :" : TEXT ]<font></font>
147: [ "<font></font>
" : NEWLINE ]<font></font>
148: [ "&gt; " : QUOTE_START ]<font></font>
149: [ "`[" : MONOSPACE_START ]<font></font>
150: [ "enum Token_type {" : TEXT ]<font></font>
151: [ "<font></font>
" : NEWLINE ]<font></font>
152: [ " END = 1, TEXT = 2," : TEXT ]<font></font>
153: [ "<font></font>
" : NEWLINE ]<font></font>
154: [ " OPENING_BLOCK_TAG_NAME = 4, CLOSING_BLOCK_TAG_NAME = 8, EMPTY_TAG_NAME = 16, COMMENT = 32, MACRO_TAG = 64," : TEXT ]<font></font>
155: [ "<font></font>
" : NEWLINE ]<font></font>
156: [ " ATTRIBUTE_NAME = 128, UNQUOTED_ATTRIBUTE_VALUE = 256, SINGLE_QUOTED_ATTRIBUTE_VALUE = 512, DOUBLE_QUOTED_ATTRIBUTE_VALUE = 1024" : TEXT ]<font></font>
157: [ "<font></font>
" : NEWLINE ]<font></font>
158: [ "};" : TEXT ]<font></font>
159: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
160: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
161: [ "  process:" : TEXT ]<font></font>
162: [ "<font></font>
" : NEWLINE ]<font></font>
163: [ "&gt; " : QUOTE_START ]<font></font>
164: [ "`[" : MONOSPACE_START ]<font></font>
165: [ "stub" : TEXT ]<font></font>
166: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
167: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
168: [ "   switch    ( ),    case       .    ,    :     ,      ,      (),   .               .       ()    ,      «»  ..         gedit:" : TEXT ]<font></font>
169: [ "<font></font>
" : NEWLINE ]<font></font>
170: [ "[&lt;" : IMAGE_START ]<font></font>
171: [ "https://hsto.org/webt/72/fw/tw/72fwtwt_waeie4ulzftkxua356w.png" : TEXT ]<font></font>
172: [ "&gt;" : LINK_FINISH ]<font></font>
173: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
174: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
175: [ "    ,           .     disassemble:" : TEXT ]<font></font>
176: [ "<font></font>
" : NEWLINE ]<font></font>
177: [ "&gt; " : QUOTE_START ]<font></font>
178: [ "`[" : MONOSPACE_START ]<font></font>
179: [ "stub" : TEXT ]<font></font>
180: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
181: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
182: [ "       TEXT,       END    ( ,  )." : TEXT ]<font></font>
183: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
184: [ "        HTML-  ,    - PHP,         "[ "&lt;_" : TEXT ]<font></font>
185: [ "&gt;" : LINK_FINISH ]<font></font>
186: [ "": &lt;_" : TEXT ]<font></font>
187: [ "&gt;" : LINK_FINISH ]<font></font>
188: [ " " : TEXT ]<font></font>
189: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
190: [ "".   :" : TEXT ]<font></font>
191: [ "<font></font>
" : NEWLINE ]<font></font>
192: [ "&gt; " : QUOTE_START ]<font></font>
193: [ "=[" : MARKED_START ]<font></font>
194: [ " " : TEXT ]<font></font>
195: [ "`[" : MONOSPACE_START ]<font></font>
196: [ "stub" : TEXT ]<font></font>
197: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
198: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
199: [ "<font></font>
" : NEWLINE ]<font></font>
200: [ "=[" : MARKED_START ]<font></font>
201: [ " " : TEXT ]<font></font>
202: [ "`[" : MONOSPACE_START ]<font></font>
203: [ "stub" : TEXT ]<font></font>
204: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
205: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
206: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
207: [ "       —   .     ,             -.         DOM,    ." : TEXT ]<font></font>
208: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
209: [ "       HTML-?" : TEXT ]<font></font>
210: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
211: [ "  —      ,         ,     —   «Node»,     «Block» (,     )       «Root».      ,    , ,  &lt;p" : TEXT ]<font></font>
212: [ "&gt;" : LINK_FINISH ]<font></font>
213: [ ", &lt;li" : TEXT ]<font></font>
214: [ "&gt;" : LINK_FINISH ]<font></font>
215: [ ", &lt;strong" : TEXT ]<font></font>
216: [ "&gt;" : LINK_FINISH ]<font></font>
217: [ "  ,      .    .      ,    —            :     ,     ,    .   ,   ,    Node,   ,    .    " : TEXT ]<font></font>
218: [ "%[" : ITALIC_START ]<font></font>
219: [ "  " : TEXT ]<font></font>
220: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
221: [ "." : TEXT ]<font></font>
222: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
223: [ " :" : TEXT ]https://gitlab.com/2che/markedit<font></font>
224: [ "<font></font>
" : NEWLINE ]<font></font>
225: [ "&gt; " : QUOTE_START ]<font></font>
226: [ "`[" : MONOSPACE_START ]<font></font>
227: [ "stub" : TEXT ]<font></font>
228: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
229: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
230: [ "  !     ,      :" : TEXT ]<font></font>
231: [ "<font></font>
" : NEWLINE ]<font></font>
232: [ "`[" : MONOSPACE_START ]<font></font>
233: [ "| " : TEXT ]<font></font>
234: [ "<font></font>
" : NEWLINE ]<font></font>
235: [ "+--&lt;ROOT" : TEXT ]<font></font>
236: [ "&gt;" : LINK_FINISH ]<font></font>
237: [ "<font></font>
" : NEWLINE ]<font></font>
238: [ " | " : TEXT ]<font></font>
239: [ "<font></font>
" : NEWLINE ]<font></font>
240: [ " +--&lt;!DOCTYPE" : TEXT ]<font></font>
241: [ "&gt;" : LINK_FINISH ]<font></font>
242: [ "<font></font>
" : NEWLINE ]<font></font>
243: [ " | " : TEXT ]<font></font>
244: [ "<font></font>
" : NEWLINE ]<font></font>
245: [ " +--&lt;html" : TEXT ]<font></font>
246: [ "&gt;" : LINK_FINISH ]<font></font>
247: [ "<font></font>
" : NEWLINE ]<font></font>
248: [ " | " : TEXT ]<font></font>
249: [ "<font></font>
" : NEWLINE ]<font></font>
250: [ " +--&lt;head" : TEXT ]<font></font>
251: [ "&gt;" : LINK_FINISH ]<font></font>
252: [ "<font></font>
" : NEWLINE ]<font></font>
253: [ " | | " : TEXT ]<font></font>
254: [ "<font></font>
" : NEWLINE ]<font></font>
255: [ " | +--&lt;meta" : TEXT ]<font></font>
256: [ "&gt;" : LINK_FINISH ]<font></font>
257: [ "<font></font>
" : NEWLINE ]<font></font>
258: [ " | | " : TEXT ]<font></font>
259: [ "<font></font>
" : NEWLINE ]<font></font>
260: [ " | +--&lt;meta" : TEXT ]<font></font>
261: [ "&gt;" : LINK_FINISH ]<font></font>
262: [ "<font></font>
" : NEWLINE ]<font></font>
263: [ " | | " : TEXT ]<font></font>
264: [ "<font></font>
" : NEWLINE ]<font></font>
265: [ " | +--&lt;meta" : TEXT ]<font></font>
266: [ "&gt;" : LINK_FINISH ]<font></font>
267: [ "<font></font>
" : NEWLINE ]<font></font>
268: [ " | | " : TEXT ]<font></font>
269: [ "<font></font>
" : NEWLINE ]<font></font>
270: [ " | +--&lt;meta" : TEXT ]<font></font>
271: [ "&gt;" : LINK_FINISH ]<font></font>
272: [ "<font></font>
" : NEWLINE ]<font></font>
273: [ " | | " : TEXT ]<font></font>
274: [ "<font></font>
" : NEWLINE ]<font></font>
275: [ " | +--&lt;meta" : TEXT ]<font></font>
276: [ "&gt;" : LINK_FINISH ]<font></font>
277: [ "<font></font>
" : NEWLINE ]<font></font>
278: [ " | | " : TEXT ]<font></font>
279: [ "<font></font>
" : NEWLINE ]<font></font>
280: [ " | +--&lt;meta" : TEXT ]<font></font>
281: [ "&gt;" : LINK_FINISH ]<font></font>
282: [ "<font></font>
" : NEWLINE ]<font></font>
283: [ " | | " : TEXT ]<font></font>
284: [ "<font></font>
" : NEWLINE ]<font></font>
285: [ " | +--&lt;meta" : TEXT ]<font></font>
286: [ "&gt;" : LINK_FINISH ]<font></font>
287: [ "<font></font>
" : NEWLINE ]<font></font>
288: [ " | | " : TEXT ]<font></font>
289: [ "<font></font>
" : NEWLINE ]<font></font>
290: [ " | +--&lt;meta" : TEXT ]<font></font>
291: [ "&gt;" : LINK_FINISH ]<font></font>
292: [ "<font></font>
" : NEWLINE ]<font></font>
293: [ " | | " : TEXT ]<font></font>
294: [ "<font></font>
" : NEWLINE ]<font></font>
295: [ " | +--&lt;meta" : TEXT ]<font></font>
296: [ "&gt;" : LINK_FINISH ]<font></font>
297: [ "<font></font>
" : NEWLINE ]<font></font>
298: [ " | | " : TEXT ]<font></font>
299: [ "<font></font>
" : NEWLINE ]<font></font>
300: [ " | +--&lt;title" : TEXT ]<font></font>
301: [ "&gt;" : LINK_FINISH ]<font></font>
302: [ "<font></font>
" : NEWLINE ]<font></font>
303: [ " | | " : TEXT ]<font></font>
304: [ "<font></font>
" : NEWLINE ]<font></font>
305: [ " | +--&lt;link" : TEXT ]<font></font>
306: [ "&gt;" : LINK_FINISH ]<font></font>
307: [ "<font></font>
" : NEWLINE ]<font></font>
308: [ " | | " : TEXT ]<font></font>
309: [ "<font></font>
" : NEWLINE ]<font></font>
310: [ " | +--&lt;link" : TEXT ]<font></font>
311: [ "&gt;" : LINK_FINISH ]<font></font>
312: [ "<font></font>
" : NEWLINE ]<font></font>
313: [ " | | " : TEXT ]<font></font>
314: [ "<font></font>
" : NEWLINE ]<font></font>
315: [ " | +--&lt;COMMENT" : TEXT ]<font></font>
316: [ "&gt;" : LINK_FINISH ]<font></font>
317: [ "<font></font>
" : NEWLINE ]<font></font>
318: [ " | " : TEXT ]<font></font>
319: [ "<font></font>
" : NEWLINE ]<font></font>
320: [ " +--&lt;body" : TEXT ]<font></font>
321: [ "&gt;" : LINK_FINISH ]<font></font>
322: [ "<font></font>
" : NEWLINE ]<font></font>
323: [ " | " : TEXT ]<font></font>
324: [ "<font></font>
" : NEWLINE ]<font></font>
325: [ " +--&lt;header" : TEXT ]<font></font>
326: [ "&gt;" : LINK_FINISH ]<font></font>
327: [ "<font></font>
" : NEWLINE ]<font></font>
328: [ " | | " : TEXT ]<font></font>
329: [ "<font></font>
" : NEWLINE ]<font></font>
330: [ " | +--&lt;div" : TEXT ]<font></font>
331: [ "&gt;" : LINK_FINISH ]<font></font>
332: [ "<font></font>
" : NEWLINE ]<font></font>
333: [ " | " : TEXT ]<font></font>
334: [ "<font></font>
" : NEWLINE ]<font></font>
335: [ " +--&lt;nav" : TEXT ]<font></font>
336: [ "&gt;" : LINK_FINISH ]<font></font>
337: [ "<font></font>
" : NEWLINE ]<font></font>
338: [ " | | " : TEXT ]<font></font>
339: [ "<font></font>
" : NEWLINE ]<font></font>
340: [ " | +--&lt;ul" : TEXT ]<font></font>
341: [ "&gt;" : LINK_FINISH ]<font></font>
342: [ "<font></font>
" : NEWLINE ]<font></font>
343: [ " | | " : TEXT ]<font></font>
344: [ "<font></font>
" : NEWLINE ]<font></font>
345: [ " | +--&lt;li" : TEXT ]<font></font>
346: [ "&gt;" : LINK_FINISH ]<font></font>
347: [ "<font></font>
" : NEWLINE ]<font></font>
348: [ " | | | " : TEXT ]<font></font>
349: [ "<font></font>
" : NEWLINE ]<font></font>
350: [ " | | +--&lt;a" : TEXT ]<font></font>
351: [ "&gt;" : LINK_FINISH ]<font></font>
352: [ "<font></font>
" : NEWLINE ]<font></font>
353: [ " | | " : TEXT ]<font></font>
354: [ "<font></font>
" : NEWLINE ]<font></font>
355: [ " | +--&lt;li" : TEXT ]<font></font>
356: [ "&gt;" : LINK_FINISH ]<font></font>
357: [ "<font></font>
" : NEWLINE ]<font></font>
358: [ " | | | " : TEXT ]<font></font>
359: [ "<font></font>
" : NEWLINE ]<font></font>
360: [ " | | +--&lt;a" : TEXT ]<font></font>
361: [ "&gt;" : LINK_FINISH ]<font></font>
362: [ "<font></font>
" : NEWLINE ]<font></font>
363: [ " | | " : TEXT ]<font></font>
364: [ "<font></font>
" : NEWLINE ]<font></font>
365: [ " | +--&lt;li" : TEXT ]<font></font>
366: [ "&gt;" : LINK_FINISH ]<font></font>
367: [ "<font></font>
" : NEWLINE ]<font></font>
368: [ " | | " : TEXT ]<font></font>
369: [ "<font></font>
" : NEWLINE ]<font></font>
370: [ " | +--&lt;a" : TEXT ]<font></font>
371: [ "&gt;" : LINK_FINISH ]<font></font>
372: [ "<font></font>
" : NEWLINE ]<font></font>
373: [ " | " : TEXT ]<font></font>
374: [ "<font></font>
" : NEWLINE ]<font></font>
375: [ " +--&lt;main" : TEXT ]<font></font>
376: [ "&gt;" : LINK_FINISH ]<font></font>
377: [ "<font></font>
" : NEWLINE ]<font></font>
378: [ " | | " : TEXT ]<font></font>
379: [ "<font></font>
" : NEWLINE ]<font></font>
380: [ " | +--&lt;MACRO" : TEXT ]<font></font>
381: [ "&gt;" : LINK_FINISH ]<font></font>
382: [ "<font></font>
" : NEWLINE ]<font></font>
383: [ " | " : TEXT ]<font></font>
384: [ "<font></font>
" : NEWLINE ]<font></font>
385: [ " +--&lt;footer" : TEXT ]<font></font>
386: [ "&gt;" : LINK_FINISH ]<font></font>
387: [ "<font></font>
" : NEWLINE ]<font></font>
388: [ " | " : TEXT ]<font></font>
389: [ "<font></font>
" : NEWLINE ]<font></font>
390: [ " +--&lt;hr" : TEXT ]<font></font>
391: [ "&gt;" : LINK_FINISH ]<font></font>
392: [ "<font></font>
" : NEWLINE ]<font></font>
393: [ " | " : TEXT ]<font></font>
394: [ "<font></font>
" : NEWLINE ]<font></font>
395: [ " +--&lt;small" : TEXT ]<font></font>
396: [ "&gt;" : LINK_FINISH ]<font></font>
397: [ "]" : SPAN_OR_IMAGE_FINISH ]<font></font>
398: [ "<font></font>
" : NEWLINE ]<font></font>
399: [ " " : TEXT ]<font></font>
400: [ "<font></font>
" : NEWLINE ]<font></font>
401: [ ",       DOM,   jQuery, Jsoup, beautifulsoup  Gumbo   ,   ,       ,     &lt;style" : TEXT ]<font></font>
402: [ "&gt;" : LINK_FINISH ]<font></font>
403: [ "  &lt;script" : TEXT ]<font></font>
404: [ "&gt;" : LINK_FINISH ]<font></font>
405: [ ",      .   ,     . ." : TEXT ]<font></font>
406: [ "<font></font>
<font></font>
" : DOUBLE_NEWLINE ]<font></font>
407: [ "PS     " : TEXT ]<font></font>
408: [ "&lt;&lt;" : LINK_START ]<font></font>
409: [ "https://gitlab.com/2che/nyHTML" : TEXT ]<font></font>
410: [ "&gt;" : LINK_FINISH ]<font></font>
411: [ "" : TEXT ]<font></font>
412: [ "&gt;" : LINK_FINISH ]<font></font>
413: [ ". , ,      ." : TEXT ]<font></font>
414: [ "<font></font>
" : NEWLINE ]<font></font>
415: [ "" : END ]<font></font>
</pre><br></div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">语法树</font></font></b> <div class="spoiler_text"><pre> <code class="plaintext hljs">&lt;pre&gt;&lt;article&gt; | +-&lt;section&gt; | +-&lt;p&gt; | | | +-@2che | | | +-"\n" | +-&gt;&gt;442964 | +-&lt;h1&gt; | | | +-"   DOM  " | +-&lt;p&gt; | | | +-", !       ..." | | | +-&lt;i&gt; | | | | | +-" " | | | +-",   — " | | | +-&lt;i&gt; | | | | | +-"" | | | +-".     ,   ..." | +-&lt;p&gt; | | | +-" , —    —   ..." | +-&lt;p&gt; | | | +-" , ,  " | | | +-&lt;i&gt; | | | | | +-" " | | | +-" —        ..." | | | +-"\n" | | | +-&lt;b&gt; | | | | | +-" " | | | +-"    —    ,  ..." | | | +-"\n" | | | +-&lt;b&gt; | | | | | +-" " | | | +-" —        " | | | +-&lt;i&gt; | | | | | +-"  " | | | +-" (AST — abstract syntax tree),  " | | | +-&lt;i&gt; | | | | | +-"  " | | | +-" (DOM — document object model)." | +-&lt;p&gt; | | | +-"   .  ,     ..." | | | +-&lt;i&gt; | | | | | +-" - ()" | | | +-"  " | | | +-&lt;i&gt; | | | | | +-"  -" | | | +-".    ,     .  ..." | | | +-"\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"&lt;" | | | +-"&gt;" | | | +-" = &lt;_1" | | | +-"&gt;" | | | +-" &lt;_" | | | +-"&gt;" | | | +-" &lt;_2" | | | +-"&gt;" | +-&lt;p&gt; | | | +-"      , ..." | +-&lt;p&gt; | | | +-"  ?" | +-&lt;p&gt; | | | +-"      ..." | | | +-&lt;i&gt; | | | | | +-"" | | | +-"  " | | | +-&lt;i&gt; | | | | | +-"" | | | +-". " | | | +-&lt;b&gt; | | | | | +-"" | | | +-" — ,  :" | | | +-"\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"&lt;_1" | | | +-"&gt;" | | | +-" = &lt;" | | | +-"&gt;" | | | +-" (&lt;_" | | | +-"&gt;" | | | +-" | &lt;_" | | | +-"&gt;" | | | +-") &lt;" | | | +-"&gt;" | +-&lt;p&gt; | | | +-&lt;b&gt; | | | | | +-"" | | | +-" ,    .   ..." | | | +-"\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"&lt;" | | | +-"&gt;" | | | +-" = &lt;_1" | | | +-"&gt;" | | | +-" "+" &lt;_2" | | | +-"&gt;" | | | +-"\n" | | | +-"&lt;_1" | | | +-"&gt;" | | | +-" = &lt;" | | | +-"&gt;" | | | +-" ("*" | "/") &lt;" | | | +-"&gt;" | +-&lt;p&gt; | | | +-" "+", "*", "/" — ." | | | +-"\n" | | | +-"     ,  ..." | +-&lt;p&gt; | | | +-"      " | | | +-&lt;a&gt; | | | | | +-"" | | | +-"  " | | | +-&lt;a&gt; | | | | | +-"" | | | +-".    —    ..." | | | +-"\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"stub" | +-&lt;p&gt; | | | +-"  ,     ..." | | | +-"&gt;" | | | +-"".        case.   ..." | | | +-"\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"enum Token_type {" | | | +-"\n" | | | +-" END = 1, TEXT = 2," | | | +-"\n" | | | +-" OPENING_BLOCK_TAG_NAME = 4, CLOSING_BLOCK_TAG_NAME = 8, EMPTY_TAG_NAME = 16, COMMENT = 32, MACRO..." | | | +-"\n" | | | +-" ATTRIBUTE_NAME = 128, UNQUOTED_ATTRIBUTE_VALUE = 256, SINGLE_QUOTED_ATTRIBUTE_VALUE = 512, DOUBL..." | | | +-"\n" | | | +-"};" | +-&lt;p&gt; | | | +-"  process:" | | | +-"\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"stub" | +-&lt;p&gt; | | | +-"   switch    (  ..." | | | +-"\n" | +-&lt;p&gt; | | | +-&lt;img /&gt; | +-&lt;p&gt; | | | +-"    ,   ..." | | | +-"\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"stub" | +-&lt;p&gt; | | | +-"      ..." | +-&lt;p&gt; | | | +-"        HTML- ..." | | | +-"&gt;" | | | +-"": &lt;_" | | | +-"&gt;" | | | +-" " | | | +-"]" | | | +-"".   :" | | | +-"\n" | +-&lt;blockquote&gt; | | | +-&lt;mark&gt; | | | | | +-" " | | | | | +-&lt;pre&gt; | | | | | +-"stub" | | | +-"\n" | | | +-&lt;mark&gt; | | | +-" " | | | +-&lt;pre&gt; | | | +-"stub" | +-&lt;p&gt; | | | +-"       —  ..." | +-&lt;p&gt; | | | +-"       HTML-..." | +-&lt;p&gt; | | | +-"  —      ,  ..." | | | +-"&gt;" | | | +-", &lt;li" | | | +-"&gt;" | | | +-", &lt;strong" | | | +-"&gt;" | | | +-"  ,      .  ..." | | | +-&lt;i&gt; | | | | | +-"  " | | | +-"." | +-&lt;p&gt; | | | +-" :" | | | +-"\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"stub" | +-&lt;p&gt; | | | +-"  !     ,   ..." | | | +-"\n" | | | +-&lt;pre&gt; | | | | | +-"| " | | | | | +-"\n" | | | | | +-"+--&lt;ROOT" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | " | | | | | +-"\n" | | | | | +-" +--&lt;!DOCTYPE" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | " | | | | | +-"\n" | | | | | +-" +--&lt;html" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | " | | | | | +-"\n" | | | | | +-" +--&lt;head" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;meta" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;meta" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;meta" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;meta" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;meta" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;meta" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;meta" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;meta" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;meta" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;title" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;link" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;link" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;COMMENT" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | " | | | | | +-"\n" | | | | | +-" +--&lt;body" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | " | | | | | +-"\n" | | | | | +-" +--&lt;header" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;div" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | " | | | | | +-"\n" | | | | | +-" +--&lt;nav" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;ul" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;li" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | | " | | | | | +-"\n" | | | | | +-" | | +--&lt;a" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;li" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | | " | | | | | +-"\n" | | | | | +-" | | +--&lt;a" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;li" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;a" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | " | | | | | +-"\n" | | | | | +-" +--&lt;main" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | | " | | | | | +-"\n" | | | | | +-" | +--&lt;MACRO" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | " | | | | | +-"\n" | | | | | +-" +--&lt;footer" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | " | | | | | +-"\n" | | | | | +-" +--&lt;hr" | | | | | +-"&gt;" | | | | | +-"\n" | | | | | +-" | " | | | | | +-"\n" | | | | | +-" +--&lt;small" | | | | | +-"&gt;" | | | +-"\n" | | | +-" " | | | +-"\n" | | | +-",       ..." | | | +-"&gt;" | | | +-"  &lt;script" | | | +-"&gt;" | | | +-",      .    ..." | +-&lt;p&gt; | +-"PS     " | +-&lt;a&gt; | | | +-"" | +-". , ,     ..." | +-"\n" &lt;/pre&gt;</code> </pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一切都很棒，但是有太多的文本节点一个接一个地链接。</font><font style="vertical-align: inherit;">另外，我希望将行中的引号合并为一个。</font><font style="vertical-align: inherit;">为此，我们需要再次遍历该树并执行</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串联操作</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，即，将同质元素相互粘合。</font><font style="vertical-align: inherit;">我不会解释此过程的详细信息，我将附上源代码，但现在就看看我们</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">串联后的树：</font></font></b> <div class="spoiler_text"><pre> <code class="plaintext hljs">&lt;pre&gt;&lt;article&gt; | +-&lt;section&gt; | +-&lt;p&gt; | | | +-@2che | | | +-"\n" | +-&gt;&gt;442964 | +-&lt;h1&gt; | | | +-"   DOM  " | +-&lt;p&gt; | | | +-", !       ..." | | | +-&lt;i&gt; | | | | | +-" " | | | +-",   — " | | | +-&lt;i&gt; | | | | | +-"" | | | +-".     ,   ..." | +-&lt;p&gt; | | | +-" , —    —   ..." | +-&lt;p&gt; | | | +-" , ,  " | | | +-&lt;i&gt; | | | | | +-" " | | | +-" —        ..." | | | +-&lt;b&gt; | | | | | +-" " | | | +-"    —    ,  ..." | | | +-&lt;b&gt; | | | | | +-" " | | | +-" —        " | | | +-&lt;i&gt; | | | | | +-"  " | | | +-" (AST — abstract syntax tree),  " | | | +-&lt;i&gt; | | | | | +-"  " | | | +-" (DOM — document object model)." | +-&lt;p&gt; | | | +-"   .  ,     ..." | | | +-&lt;i&gt; | | | | | +-" - ()" | | | +-"  " | | | +-&lt;i&gt; | | | | | +-"  -" | | | +-".    ,     .  ..." | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"&lt;&gt; = &lt;_1&gt; &lt;_&gt; &lt;_2&gt;" | +-&lt;p&gt; | | | +-"      , ..." | +-&lt;p&gt; | | | +-"  ?" | +-&lt;p&gt; | | | +-"      ..." | | | +-&lt;i&gt; | | | | | +-"" | | | +-"  " | | | +-&lt;i&gt; | | | | | +-"" | | | +-". " | | | +-&lt;b&gt; | | | | | +-"" | | | +-" — ,  :\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"&lt;_1&gt; = &lt;&gt; (&lt;_&gt; | &lt;_&gt;) &lt; ..." | +-&lt;p&gt; | | | +-&lt;b&gt; | | | | | +-"" | | | +-" ,    .   ..." | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"&lt;&gt; = &lt;_1&gt; "+" &lt;_2&gt;\n&lt;_1&gt; = &lt;..." | +-&lt;p&gt; | | | +-" "+", "*", "/" — .\n    ..." | +-&lt;p&gt; | | | +-"      " | | | +-&lt;a&gt; | | | | | +-"" | | | +-"  " | | | +-&lt;a&gt; | | | | | +-"" | | | +-".    —    ..." | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"stub" | +-&lt;p&gt; | | | +-"  ,     ..." | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"enum Token_type {\n END = 1, TEXT = 2,\n OPENING_BLOCK_TAG_NAME = 4, CLOSING_BLOCK_TAG_NAME = ..." | +-&lt;p&gt; | | | +-"  process:\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"stub" | +-&lt;p&gt; | | | +-"   switch    (  ..." | +-&lt;p&gt; | | | +-&lt;img /&gt; | +-&lt;p&gt; | | | +-"    ,   ..." | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"stub" | +-&lt;p&gt; | | | +-"      ..." | +-&lt;p&gt; | | | +-"        HTML- ..." | +-&lt;blockquote&gt; | | | +-&lt;mark&gt; | | | | | +-" " | | | | | +-&lt;pre&gt; | | | | | +-"stub" | | | +-"\n" | | | +-&lt;mark&gt; | | | +-" " | | | +-&lt;pre&gt; | | | +-"stub" | +-&lt;p&gt; | | | +-"       —  ..." | +-&lt;p&gt; | | | +-"       HTML-..." | +-&lt;p&gt; | | | +-"  —      ,  ..." | | | +-&lt;i&gt; | | | | | +-"  " | | | +-"." | +-&lt;p&gt; | | | +-" :\n" | +-&lt;blockquote&gt; | | | +-&lt;pre&gt; | | | +-"stub" | +-&lt;p&gt; | | | +-"  !     ,   ..." | | | +-&lt;pre&gt; | | | | | +-"| \n+--&lt;ROOT&gt;\n | \n +--&lt;!DOCTYPE&gt;\n | \n +--&lt;html&gt;\n | \n +--&lt;head&gt;\n | | \n | +--&lt;..." | | | +-"\n \n,     ..." | +-&lt;p&gt; | +-"PS     " | +-&lt;a&gt; | | | +-"" | +-". , ,     ..." &lt;/pre&gt;</code> </pre></div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">剩下的最后一步是以HTML形式表示此树。一切都很简单：我们在root方法中以主要标记的开头（打开html和body元素，一个head块）创建一行，并开始附加从相似子元素返回的行。在这里，我们再次处理递归关系：每个类在调用to_HTML（）虚拟方法时创建一行，将其主要标记放入其中，然后在其每个后代中调用相同的方法，将各行连接起来，完成主要标记并将其返回给调用的父代。例如，这里的Inline类看起来像下面的方法（结合格式化的inline元素）：</font></font><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">string</span></span> Inline::to_HTML (<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> &amp;level) { <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> HTML; <span class="hljs-comment"><span class="hljs-comment">// ******    -   ****** switch (type) { case BOLD: { HTML.append("&lt;b&gt;"); break; } case ITALIC: { HTML.append("&lt;i&gt;"); break; } case UNDERLINED: { HTML.append("&lt;ins&gt;"); break; } case OVERLINED: { HTML.append("&lt;span class=\"overlined\"&gt;"); break; } case THROWLINED: { HTML.append("&lt;del&gt;"); break; } case SUBSCRIPT: { HTML.append("&lt;sub&gt;"); break; } case SUPERSCRIPT: { HTML.append("&lt;sup&gt;"); break; } case MARKED: { HTML.append("&lt;mark&gt;"); break; } case MONOSPACE: { HTML.append("&lt;pre&gt;"); break; } default: throw string("invalid inline type: " + type_str() + "!"); } // *** *** *** *** // ******   -    ****** for (unsigned long i(0); i &lt; children_count; i++) HTML.append(children[i]-&gt;to_HTML(level+1)); // *** *** *** *** // ******    -   ****** switch (type) { case BOLD: { HTML.append("&lt;/b&gt;"); break; } case ITALIC: { HTML.append("&lt;/i&gt;"); break; } case UNDERLINED: { HTML.append("&lt;/ins&gt;"); break; } case OVERLINED: { HTML.append("&lt;/span&gt;"); break; } case THROWLINED: { HTML.append("&lt;/del&gt;"); break; } case SUBSCRIPT: { HTML.append("&lt;/sub&gt;"); break; } case SUPERSCRIPT: { HTML.append("&lt;/sup&gt;"); break; } case MARKED: { HTML.append("&lt;/mark&gt;"); break; } case MONOSPACE: { HTML.append("&lt;/pre&gt;"); break; } default: throw string("invalid inline type: " + type_str() + "!"); } // *** *** *** *** return HTML; }</span></span></code> </pre><br> 仅此而已。<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我希望现在阅读了这两篇文章后，您可以轻松实现标记或编程语言的翻译器。</font><font style="vertical-align: inherit;">如有任何疑问，请在评论中提问。</font><font style="vertical-align: inherit;">这是</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">资源</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">成功。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS我忘了提到</font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">屏蔽</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">它的实现很简单：如果词法分析过程中的下一个字符是反斜杠（“ \”），则将其忽略并处理下一个字符，但除此之外，还将布尔值true发送给字符处理函数，从而使命令转义。</font><font style="vertical-align: inherit;">然后，例如，如果该符号为“ [”，则其特殊含义将被忽略，并且仅将正在构造的标记作为文本加入。</font><font style="vertical-align: inherit;">否则，该函数将返回false并照常处理字符。</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN444876/">https://habr.com/ru/post/zh-CN444876/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN444866/index.html">从Python到Go的我的方式-共享技巧和资源</a></li>
<li><a href="../zh-CN444868/index.html">如何创建适合所有人的调色板</a></li>
<li><a href="../zh-CN444870/index.html">公司业务结构2019</a></li>
<li><a href="../zh-CN444872/index.html">Zabbix在俄罗斯的开业情况如何？</a></li>
<li><a href="../zh-CN444874/index.html">超级傻瓜织物</a></li>
<li><a href="../zh-CN444878/index.html">SpaceX宣布对Starlink卫星进行重新设计，以使其坠落时完全在大气中燃烧</a></li>
<li><a href="../zh-CN444880/index.html">量子力学的多世界解释</a></li>
<li><a href="../zh-CN444882/index.html">银行开始封锁自由账户</a></li>
<li><a href="../zh-CN444884/index.html">Groovy离开CédricChampeau</a></li>
<li><a href="../zh-CN444886/index.html">混淆后的逆向工程应用</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>