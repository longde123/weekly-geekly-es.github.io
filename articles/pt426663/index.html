<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçî ü§öüèΩ ‚õ™Ô∏è Livro de receitas do desenvolvedor Ruby: Receitas de design orientadas a dom√≠nio (parte 1, escopo) üé´ ü§òüèΩ üì©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Introdu√ß√£o 


 Gostaria de falar sobre a experi√™ncia de aplicar pr√°ticas DDD a um projeto existente do Ruby on Rails. Inicialmente, tivemos um mon√≥...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Livro de receitas do desenvolvedor Ruby: Receitas de design orientadas a dom√≠nio (parte 1, escopo)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/426663/"><h1 id="vvedenie">  1. Introdu√ß√£o </h1><br><p> Gostaria de falar sobre a experi√™ncia de aplicar pr√°ticas DDD a um projeto existente do Ruby on Rails.  Inicialmente, tivemos um mon√≥lito que foi escrito por 10 anos.  A principal dificuldade do projeto estava em processos bastante complexos e com alta conectividade.  Conseguimos n√£o apenas decompor o aplicativo em servi√ßos separados, mas tamb√©m aumentar significativamente a legibilidade do c√≥digo, tornar transparentes os processos descritos. </p><br><p>  A solu√ß√£o de problemas dentro do sistema tornou-se previs√≠vel, paramos de trabalhar com a caixa preta e, no final, o pr√≥prio sistema come√ßou a nos fornecer solu√ß√µes. </p><br><p>  Para facilitar a percep√ß√£o e a escrita, uma hist√≥ria sobre as abordagens utilizadas ser√° apresentada na forma de uma s√©rie de artigos.  Essa abordagem n√£o √© uma "bala de prata", portanto, gostaria de destacar antes de tudo o segmento de projetos em que essa solu√ß√£o pode se encaixar.  Al√©m disso, falarei com mais detalhes sobre a metodologia DDD e a implementa√ß√£o de microsservi√ßos desse padr√£o, descreverei as combina√ß√µes poss√≠veis dos padr√µes aplicados, levando em considera√ß√£o sua implementa√ß√£o e, por fim, darei um exemplo de uma implementa√ß√£o espec√≠fica de um pequeno servi√ßo. </p><a name="habracut"></a><br><h2 id="tezaurus">  Thesaurus </h2><br><blockquote>  Thesaurus √© um gloss√°rio de termos usados ‚Äã‚Äãpara descrever uma √°rea de assunto espec√≠fica. </blockquote><p>  Todas as defini√ß√µes que ser√£o introduzidas abaixo est√£o corretas na estrutura deste artigo.  Voc√™ pode aplic√°-las √† sua √°rea de assunto se a descreverem bem o suficiente. </p><br><h2 id="zadacha-reshaemaya-v-ramkah-dannogo-podhoda">  O problema resolvido no √¢mbito desta abordagem </h2><br><p>  A abordagem descrita abaixo possui uma especializa√ß√£o bastante estreita e, acima de tudo, visa solucionar um problema espec√≠fico.  No entanto, isso n√£o exclui o poss√≠vel interesse de especialistas em √°reas afins.  Ent√£o, temos a tarefa: </p><br><p>  <strong>Voc√™ precisa reescrever e manter um projeto com l√≥gica de neg√≥cios complexa escrita em Ruby on Rails, com recursos suficientes.</strong> </p><br><p>  Vamos escrever esta tarefa com mais detalhes. </p><br><h2 id="pochemu-voznikaet-neobhodimost-perepisyvat-proekt">  Por que √© necess√°rio reescrever o projeto? </h2><br><p>  Eu acho que todo desenvolvedor pode responder a essa pergunta.  √â mais dif√≠cil responder, para que essa resposta satisfa√ßa as necessidades da sua empresa. </p><br><p>  Usamos a defini√ß√£o de <em>Neg√≥cio</em> , como geralmente √© aceita, embora invistamos neste termo um conceito mais amplo - uma empresa (algo empreendido por um grupo de pessoas), ocupa√ß√£o (ocupada). </p><br><blockquote>  <em>Os neg√≥cios</em> s√£o o esfor√ßo de uma empresa de pessoas, expressa por meio de a√ß√µes que visam obter benef√≠cios para uma ampla gama de indiv√≠duos. </blockquote><p>  Por exemplo: </p><br><ul><li>  A empresa fabrica um produto para os consumidores ou presta um servi√ßo. </li><li>  O laborat√≥rio est√° desenvolvendo um novo medicamento. </li><li>  A escola est√° envolvida em treinamento. </li><li>  O arquivo da cidade fornece informa√ß√µes aos cidad√£os. </li><li>  Lera agrada seus f√£s com uma excelente figura na rede social. </li></ul><br><p>  No caso em massa, um neg√≥cio √© constru√≠do em torno da id√©ia de obter lucro satisfazendo as necessidades de seus clientes.  Para que o lucro seja aumentado, √© necess√°rio satisfazer as <em>necessidades</em> reais <em>do</em> cliente com um grande n√∫mero de solu√ß√µes de alta qualidade.  Essa ideia √© descrita como o primeiro princ√≠pio do manifesto Agile, embora n√£o seja nova.  O fato de que as necessidades subjacentes √† nossa sociedade tem sido discutido por muitos fil√≥sofos.  Por exemplo, Plat√£o tentou simplificar as necessidades, criar sua classifica√ß√£o.  √â ele quem nomeia as principais formas de necessidades econ√¥micas: comida, roupas, moradia.  "O desafio dos neg√≥cios" √© satisfazer as necessidades.  E as solu√ß√µes aplicadas devem aumentar a competitividade dos neg√≥cios. </p><br><blockquote>  <em>Competitividade</em> - A vantagem de um neg√≥cio em detrimento de outro. </blockquote><p>  O manifesto Agile tamb√©m nos d√° uma dica de que a flexibilidade do projeto √© aprimorada por meio de sua excel√™ncia t√©cnica e qualidade do design. </p><br><p><img src="https://habrastorage.org/webt/gy/_r/gu/gy_rguosbft-sbjnedvtczrnfyi.png" alt="Gafik 1: projeto t√≠pico"></p><br><p>  Considere a cadeia de valores dos fornecedores no exemplo de um "projeto web t√≠pico" </p><br><ul><li>  t <sub>0</sub> - tivemos uma ideia. </li><li>  t <sub>1</sub> n√≥s implementamos o <em>MVP</em> .  Aqui discutimos um pouco: <br><blockquote>  Produto m√≠nimo vi√°vel do MVP - um produto que possui as fun√ß√µes m√≠nimas, mas suficientes para satisfazer os primeiros consumidores.  A principal tarefa √© obter feedback para a forma√ß√£o de hip√≥teses para o desenvolvimento posterior do produto. <br></blockquote></li></ul><br><p>  O termo foi popularizado por Steve Blank e Eric Rees.  O MVP √© uma ferramenta eficaz para testar sua ideia de neg√≥cio e responder √† pergunta principal "Decole - n√£o decole?" </p><br><div class="spoiler">  <b class="spoiler_title">Resposta correta</b> <div class="spoiler_text"><p>  <em>42.</em> </p></div></div><br><ul><li>  t <sub>2</sub> - Voltar para a programa√ß√£o.  A ideia foi bem-sucedida, recebemos feedback positivo e fomos capazes de satisfazer um grande n√∫mero de necessidades dos clientes no hor√°rio indicado. </li><li>  t <sub>3</sub> - Desta vez, a satisfa√ß√£o chegou em menor grau.  Aumentamos a equipe. </li><li>  t <sub>4</sub> - Entregamos ainda menos valores. </li><li>  t <sub>5</sub> - Se n√£o iniciamos a refatora√ß√£o, nesse momento o neg√≥cio deixa de ser competitivo. </li></ul><br><p>  Por que isso est√° acontecendo?  Com o tempo, nosso projeto acumula um alto n√≠vel de entropia devido √† sua alta conectividade.  Suponha que tenhamos uma "Empresa T√≠pica" que consiste em um departamento de marketing, an√°lise, log√≠stica, vendas e gerenciamento.  No momento, o projeto √© o seguinte: </p><br><p><img src="https://habrastorage.org/webt/ol/wo/zd/olwozdacs-c-x9c2o7wbxudwxmq.jpeg" alt="Quadro 2 - Projeto Altamente Vinculado"></p><br><p>  Gostaria de fazer uma reserva imediata de que a conectividade nem sempre √© a causa da entropia, mas surge se um sistema com um grande n√∫mero de processos de neg√≥cios complexos for implementado. </p><br><p>  A entropia no c√≥digo sempre ocorrer√° se os processos de neg√≥cios na empresa n√£o forem formados corretamente.  O que pode ser caracter√≠stico das duas empresas jovens, que est√£o no in√≠cio de seu caminho, tamb√©m √© caracter√≠stico das grandes empresas, onde √© imposs√≠vel sistematizar tudo de uma s√≥ vez.  Este √© um processo natural e n√£o devemos ficar no caminho dele, mas aceit√°-lo e us√°-lo.  Vamos voltar ao primeiro gr√°fico e olhar para ele do outro lado: </p><br><p><img src="https://habrastorage.org/webt/zx/3g/p_/zx3gp_win5krdl9kwcczp-s9g0e.png" alt="Gr√°fico 3 - Dinheiro"></p><br><p>  A integral (a √°rea abaixo da linha) ser√° o dinheiro ganho.  O aplicativo real (aplicativo Real) ganhar√° mais do que o "ideal" (aplicativo Academin), pelo menos at√© o in√≠cio da entropia - t <sub>4</sub> .  Parece bom, e √© isso que voc√™ precisa fazer. </p><br><p>  Mas o que fazer no futuro?  Repetir a refatora√ß√£o para o infinito √© imposs√≠vel.  Em algum momento, o volume da base de c√≥digo atingir√° um n√≠vel tal que ser√° dif√≠cil reescrever ‚Äútudo de uma vez‚Äù.  E mais cedo ou mais tarde ser√° necess√°rio dividir o projeto em componentes separados: </p><br><p><img src="https://habrastorage.org/webt/ru/ie/8l/ruie8llglblqgebbdxyvmfjbokk.jpeg" alt="Gr√°fico 4 - Projeto com Liga√ß√£o Fraca"></p><br><p>  Uma abordagem para implementar sistemas complexos √© o DDD: </p><br><blockquote>  O DDD (Domain-driven Design) √© uma abordagem para o desenvolvimento de software para a satisfa√ß√£o complexa de necessidades, vinculando fortemente a implementa√ß√£o aos principais modelos de neg√≥cios que est√£o em processo de desenvolvimento constante. </blockquote><p>  DDD √© uma s√©rie de pr√°ticas e defini√ß√µes que ser√£o descritas em mais detalhes no pr√≥ximo artigo.  O padr√£o central dessa abordagem √© o <em>contexto limitado</em> , cuja ess√™ncia √© que cada √°rea de assunto consiste em v√°rios conjuntos de modelos que n√£o devem se comunicar com o mundo exterior, bem como modelos usados ‚Äã‚Äãno mundo exterior em conjunto com outros contextos limitados.  Cada contexto limitado possui uma interface claramente definida, onde decide quais modelos usar em conjunto com outros contextos. </p><br><p>  Esse padr√£o pode ser implementado por meio de um espa√ßo para nome (espa√ßo para nome) e por microsservi√ßos.  Usaremos essas duas implementa√ß√µes, dependendo do n√≠vel de conectividade do contexto.  O que acaba levando √† cria√ß√£o de um aplicativo segmentado e decomposto. </p><br><p><img src="https://habrastorage.org/webt/xk/ai/xh/xkaixhv_dsgkt4nztswdqovwply.png" alt="Gr√°fico 5 - Projeto Segmentado"></p><br><p>  √â improv√°vel que os gr√°ficos acima reflitam a imagem real, mas permitem comparar diferentes abordagens entre si. </p><br><h2 id="podderzhka-proekta">  Apoio ao projeto </h2><br><p>  Como parte do suporte ao projeto, v√°rias coisas precisam ser fornecidas. </p><br><ul><li>  <strong>Entrega de valor</strong> : Scrum, Agile, atendimento ao cliente, Entrega cont√≠nua. </li><li>  <strong>Redu√ß√£o de entropia</strong> : DDD, Micro-servi√ßo como uma das maneiras de separar contextos, documenta√ß√£o. </li><li>  <strong>Qualidade do c√≥digo</strong> : Design no n√≠vel do dom√≠nio, TDD, BDD. </li><li>  <strong>Qualidade do produto</strong> : Teste manual e automatizado, rastreamento de bugs, registro em log. </li><li>  <strong>Disponibilidade do produto</strong> : Sistemas de duplica√ß√£o. </li><li>  <strong>Velocidade do produto</strong> : escala horizontal. </li><li>  <strong>Reten√ß√£o da equipe de desenvolvimento</strong> : sistema de motiva√ß√£o, abertura, honestidade. </li></ul><br><p>  Como voc√™ pode ver, a manuten√ß√£o de um sistema complexo requer uma grande quantidade de recursos.  Primeiro de tudo, pessoal altamente qualificado.  Antes de usar essa ou aquela tecnologia, pense se voc√™ tem a oportunidade de fornecer seu suporte no n√≠vel certo. </p><br><p>  Deve-se lembrar que o limite para a entrada em um sistema complexo √© bastante alto, por isso √© importante fornecer treinamento para o pessoal.  Al√©m disso, se queremos trabalhar sem falhas, n√£o devemos ter especialistas "insubstitu√≠veis" e, portanto, √© necess√°rio garantir a total permutabilidade de todas as fun√ß√µes.  Se voc√™ tiver um 'especialista em entrega cont√≠nua' voando para fora da equipe, precisar√° substitu√≠-lo.  Se a substitui√ß√£o n√£o puder ser fornecida, n√£o vale a pena introduzir a pilha de tecnologia na "produ√ß√£o" sem fornecer suporte suficiente. </p><br><p>  N√£o se trata de especialistas no mesmo n√≠vel.  Voc√™ deve ter um DevOps l√≠der e um certo desenvolvedor para quem este t√≥pico √© interessante (o chamado "multiclasse").  Para ele, como para o "segundo violino", √© importante fornecer um entendimento de onde e como encontrar ferramentas para resolver o problema.  Para isso, pelo menos um quarto do volume total de tarefas recebidas relacionadas √† nova especialidade deve ser distribu√≠do a ela.  Essas tarefas ser√£o realizadas lentamente, os custos aumentar√£o, mas no futuro isso evitar√° o risco de interrup√ß√£o no fornecimento de valores devido √† falta de pessoal. </p><br><p>  Tais coisas est√£o descritas nos requisitos do Scrum, eu n√£o gostaria de me debru√ßar sobre elas.  A √∫nica coisa que gostaria de chamar sua aten√ß√£o, para o que voc√™ precisa estar preparado, s√£o os grandes custos que ser√£o gastos no suporte ao seu projeto.  Se sua empresa n√£o est√° pronta para isso e voc√™ come√ßou a usar muitas ferramentas caras, voc√™ estragar√° a empresa. </p><br><h3 id="kratko">  Brevemente </h3><br><ul><li>  Se voc√™ precisar implementar o <em>MVP</em> , comece com Ruby On Rails. </li><li>  Se o <em>MVP</em> decolou e a id√©ia se tornou realidade, fa√ßa a primeira refatora√ß√£o, ‚Äúalivie‚Äù seus modelos com a ajuda de servi√ßos, decoradores, remova a camada de valida√ß√£o e banco de dados dos modelos em preocupa√ß√µes separadas.  Escreva testes, documenta√ß√£o. </li><li>  Se voc√™ n√£o possui um projeto t√£o complexo e pode remover a entropia otimizando modelos - fa√ßa-o. </li><li>  Se voc√™ tem um projeto l√≥gico e leg√≠vel e precisa aumentar sua produtividade, enquanto ele pode ser dividido, digamos, pelos usu√°rios, use o dimensionamento.  Mas n√£o tente dividir o projeto em servi√ßos por dom√≠nio. </li><li>  Se voc√™ tem um neg√≥cio "complexo" e est√° procurando uma ferramenta para entrar on-line (por que ainda n√£o o fez ?!) - considere tamb√©m "Solu√ß√µes empresariais" prontas, por exemplo, em java ou .NET.  As pr√°ticas descritas se originaram em tais solu√ß√µes e eles t√™m um rico conjunto de ferramentas prontas para uso, que economizar√£o seu dinheiro. </li><li>  Se o seu projeto estiver em ruby, voc√™ tem uma equipe de programadores em ruby, o projeto cont√©m l√≥gica de neg√≥cios complexa, est√° se preparando para o carregamento ou j√° est√° carregado e a entropia cresceu tanto que √© muito, muito dif√≠cil reescrever, ent√£o voc√™ deve considerar usar a abordagem DDD e Microservices. </li></ul><br><hr><br><p>  Na pr√≥xima vez, gostaria de considerar com mais detalhes a ess√™ncia da abordagem DDD e sua implementa√ß√£o em microsservi√ßos. </p><br><hr><br><p>  Fontes de inspira√ß√£o: </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://habr.com/post/351242/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://www.startuplessonslearned.com/2009/08/minimum-viable-product-guide.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://agilemanifesto.org/iso/en/principles.html</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://dddcommunity.org/learning-ddd/what_is_ddd/</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://martinfowler.com/bliki/BoundedContext.html</a> </li><li>  Criando microsservi√ßos por Sam Newman </li><li>  Guia do Mochileiro das Gal√°xias, Douglas Adams </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt426663/">https://habr.com/ru/post/pt426663/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt426649/index.html">Brainfuck de baixo n√≠vel. Continua ...</a></li>
<li><a href="../pt426651/index.html">MongoDB altera sua licen√ßa de c√≥digo aberto</a></li>
<li><a href="../pt426657/index.html">Minera√ß√£o de dados e Twitter</a></li>
<li><a href="../pt426659/index.html">DJI Phantom 4 RTK - cartografia de pr√≥xima gera√ß√£o</a></li>
<li><a href="../pt426661/index.html">Como ingressar em uma magistratura ou p√≥s-gradua√ß√£o sem exames: uma nova faixa - "Rob√≥tica" nas Olimp√≠adas "Eu sou um profissional"</a></li>
<li><a href="../pt426665/index.html">Debriefing de Paul Graham: Viaweb, junho de 1998</a></li>
<li><a href="../pt426667/index.html">Seymour Papert: ‚ÄúComputador como preservativo‚Äù</a></li>
<li><a href="../pt426671/index.html">O chefe do Google comentou sobre o lan√ßamento de um mecanismo de pesquisa com censura na China</a></li>
<li><a href="../pt426675/index.html">Linha baseada em OpenCV seguindo</a></li>
<li><a href="../pt426677/index.html">Houve uma falha de quase duas horas no trabalho dos servi√ßos do YouTube, agora o servi√ßo se tornou operacional</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>