<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌜 🎧 🤹🏾 ExtremeXOS交换机配置功能 🤦🏿 👨🏽‍🚒 🕔</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="本文旨在减少理解ExtremeXOS（XOS）工作原理所需的时间。 当我开始接触XOS时，我真的缺少有关Habré的文章。 


 下面，我将讨论Extremes的配置以及遇到的问题。 我希望它能帮助刚刚开始使用XOS的网络工程师。 不论交换机型号如何，CLI语法都是完全相同的。 





 极限...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ExtremeXOS交换机配置功能</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/419965/"><p> 本文旨在减少理解<strong>ExtremeXOS（XOS）</strong>工作原理所需的时间。 当我开始接触XOS时，我真的缺少有关Habré的文章。 </p><br><p> 下面，我将讨论Extremes的配置以及遇到的问题。 我希望它能帮助刚刚开始使用XOS的网络工程师。 不论交换机型号如何，CLI语法都是完全相同的。 <br><br></p><br><p><img src="https://habrastorage.org/webt/jy/kh/yn/jykhynsiykae3nk7qvyy-3chk-w.jpeg" alt="KDPV"><br>  <em>极限开关架</em> </p><a name="habracut"></a><br><h2> 对企业 </h2><br><p> 对于硬件虚拟化，我使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Eve-Ng</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Virtual ExtremeOS（ <u>XOS</u> ）</a>映像。 您也可以使用GNS3。 </p><br><p>切换配置是什么样的<abbr title="极限操作系统">？</abbr>在<abbr title="极限操作系统">XOS中</abbr> ，无需切换操作模式，所有命令都是从普通模式输入的，对于admin帐户，则标记为<strong>＃</strong> ； 和<strong>&gt;</strong> （对于用户）。 <br> 首先，我要概述EOS团队的“基本”原则。 一切都基于三个命令及其反义词： <strong>create</strong> ， <strong>configure</strong> ， <strong>enable</strong> （分别为<strong>delete</strong> ， <strong>unconfigure</strong> ， <strong>disable</strong> ）。 即：我们创建，配置，激活。 看起来很合逻辑。 </p><br><pre><code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">create</span></span> vlan <span class="hljs-number"><span class="hljs-number">10</span></span> configure vlan <span class="hljs-number"><span class="hljs-number">10</span></span> ipaddress <span class="hljs-number"><span class="hljs-number">192.168.1.1</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span></code> </pre> <br><p> 还应该理解，大多数配置是在<strong>VLAN</strong>上配置的。 也就是说，在XOS中，几乎所有东西都与VLAN相关。 即使将VLAN分配给端口，也会在VLAN配置中发生，即端口挂在VLAN上。 <br> 我想特别注意虚拟路由器（ <em>VR</em> ），它是交换机中的默认设置。 有拥有所有端口的VR-Default和拥有mgmt的VR-mgmt。 港口 在XOS中，对于将流量发送到某个地方（ping，ssh，telnet，下载等）的所有命令，必须指定VR。 </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">ping</span></span> vr <span class="hljs-string"><span class="hljs-string">"VR-Default"</span></span> <span class="hljs-number"><span class="hljs-number">192.168.1.1</span></span></code> </pre> <br><h2>  XOS交换机更新 </h2><br><p>  XOS在操作系统下有两个分区：主分区和次分区。 从功能上讲，它们在名称上没有什么不同。 您只能在当前非活动部分中安装更新。 您可以为此使用inactive参数。 更新之后，需要重新启动，并且交换机从另一个（刚刚更新的）分区引导。 这样就可以在出现问题时快速回滚，只需在启动时选择其他分区（保留旧OS的分区）即可。 我还注意到，所有带有补丁的图像都代表一个完整的图像，也就是说，您不需要先放置主要版本，然后再放置一些次要版本。 下载时，使用tftp： </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">download</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">image</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">summitX-21</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4-patch1-3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xos</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vr</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">VR-Default</span></span>" <span class="hljs-selector-tag"><span class="hljs-selector-tag">inactive</span></span></code> </pre> <br><p> 要找出当前正在使用的部分，请使用： </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">show</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">system</span></span> … <span class="hljs-selector-tag"><span class="hljs-selector-tag">Image</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Selected</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">primary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Image</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Booted</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">secondary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Primary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ver</span></span>: 22<span class="hljs-selector-class"><span class="hljs-selector-class">.3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Secondary</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ver</span></span>: 21<span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.4</span></span></code> </pre> <br><h2> 交换机堆叠 </h2><br><p> 要堆叠XOS交换机，您需要启用堆叠支持并重新启动交换机： </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> stacking-support reboot</code> </pre> <br><p> 可以将不同型号的交换机组合成一个堆栈非常方便，而性能最高的交换机将是主交换机。 例如，对于具有16个用于服务器的端口的10G交换机的堆栈，这可能是必需的，在其中添加了一个48端口1G交换机，其中包括mgmt.interfaces。 <br> 要堆叠，交换机必须具有相同的操作系统版本。 堆叠是通过某些以太网端口完成的，对于每种型号，它们可以在文档中找到。 如果按照1合2、2合1端口方案组装交换机，则可以根据简化的简易堆叠程序堆叠Extreme交换机，该过程本身会将mac地址绑定到插槽号和其他设置。 在这种情况下，第一个将是启用启用堆叠的开关，​​其余的将在链上分配编号。 这是一种节省大量时间的便捷方法。 堆叠后，端口将看起来像SLOT：PORT（1：1：2：35）。 </p><br><pre> <code class="hljs pgsql">X440G2<span class="hljs-number"><span class="hljs-number">-48</span></span>p<span class="hljs-number"><span class="hljs-number">-10</span></span>G4<span class="hljs-number"><span class="hljs-number">.1</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> stacking Stack Topology <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> a Ring This node <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> an Active Topology Node MAC Address Slot Stack State <span class="hljs-keyword"><span class="hljs-keyword">Role</span></span> Flags <span class="hljs-comment"><span class="hljs-comment">------------------ ---- ----------- ------- --- *00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- 00:04:96:xx:xx:xx - Disabled Master --- * - Indicates this node Flags: (C) Candidate for this active topology, (A) Active Node (O) node may be in Other active topology X440G2-48p-10G4.2 # enable stacking You have not yet configured all required stacking parameters. Would you like to perform an easy setup for stacking operation? (y/N) Yes Executing "configure stacking easy-setup" command... For every node in the 5-node stack, this command will: - enable stacking - configure a stack MAC address - choose and configure a slot number (this node will be assigned to slot 1) - configure redundancy to minimal (slot 1 will be the master node) - configure the stacking protocol to enhanced Upon completion, the stack will automatically be rebooted into the new configuration. Warning: If stacking is already configured, this command will alter that configuration. Do you wish to proceed? (y/N) Yes Stacking configuration is complete. Rebooting...</span></span></code> </pre> <br><p> 更新堆栈是指更新主服务器，然后由他本人将新版本倒入剩余的插槽中。  <strong>需要重新启动</strong> 。 </p><br><h2> 发牌 </h2><br><p> 每个交换机都附带一个预安装的许可证（边缘，高级边缘，核心等）。 每个许可证都有自己的一组功能，可以在交换机上激活这些功能，例如，可以在OSPF中使用的端口数。 也有单个功能的许可证。 更多细节可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这里</a>阅读。 <br> 该功能是最常见的许可证之一： <em>Dual-10GB-Uplink</em>许可证。 边缘交换机1G的此许可证允许使用2个10GbE端口。 例如，在X440-G2-48p上。 <br> 许可证可在Extreme网站上的个人帐户中找到，然后激活（无需重新启动）并由团队检查。 </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> license XXXX-XXXX <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> licenses</code> </pre> <br><p> 如果在交换机堆栈中使用了不同的许可证，则将使用<u>最小的</u>许可证。 </p><br><h2> 客制化 </h2><br><p> 一个小的题外话：要查看命令的结果以及所有其他信息，在大多数情况下，您可以使用show来代替create和configure。 例如，显示vlan。 <br> 提示：使用显示端口时-XOS将建立一个每隔几秒钟更新一次的表，该表允许实时监视接口状态。 为了获得输出而不进行更新，您必须使用“不刷新显示端口”。 <br> 首先想到的是配置此<em>主机名</em> 。 似乎是这样的： </p><br><p><del> 配置主机名Ex_sw_1 </del></p><br><p> 但是并不是所有的事情都那么简单，实际上是这样完成的： </p><br><pre> <code class="hljs powershell">configure snmp sysName Ex<span class="hljs-literal"><span class="hljs-literal">-sw</span></span><span class="hljs-literal"><span class="hljs-literal">-1</span></span></code> </pre> <br><p> 创建一个VLAN： </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vlan My_Vlan_Five tag <span class="hljs-number"><span class="hljs-number">5</span></span></code> </pre> <br><p> 如此，这就是它在配置中的显示方式： </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vlan My_Vlan10 configure vlan My_Vlan10 tag <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br><p> 考虑到命令输出和XOS设置的实际经验和现实情况，我为自己创建了一条规则：在vlan名称中，在其末尾添加其标记，这使它更易于理解和配置： </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vlan <span class="hljs-keyword"><span class="hljs-keyword">users</span></span><span class="hljs-number"><span class="hljs-number">-10</span></span> tag <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br><p>  XOS本身没有中继端口和访问端口。 而是使用概念：VLAN绑定的接口上的已标记和未标记的流量。 可能有一个未标记的VLAN和许多标记的VLAN。 端口用数字编号（或插槽：堆栈上的端口），一切都很简单。 </p><br><pre> <code class="hljs cs">configure vlan My_Vlan<span class="hljs-number"><span class="hljs-number">-5</span></span> <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> ports <span class="hljs-number"><span class="hljs-number">1</span></span> tagged configure vlan My_Vlan1 <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> ports <span class="hljs-number"><span class="hljs-number">1</span></span> untagged</code> </pre> <br><p> 因此，所有没有标签到达接口的流量都将被标记为“ <em>My_Vlan1</em> ”。 <br> 同时，可以通过&lt; <em>Name</em> &gt;和&lt; <em>tag</em> &gt;以及任意组合（使用<em>vlan_list</em> ，即按标签数字）来指定vlan。 最后没有属性，使用&lt; <em>untagged</em> &gt;： </p><br><pre> <code class="hljs powershell">onfigure vlan <span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span><span class="hljs-literal"><span class="hljs-literal">-10</span></span>,<span class="hljs-number"><span class="hljs-number">15</span></span><span class="hljs-literal"><span class="hljs-literal">-20</span></span> add ports <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-literal"><span class="hljs-literal">-8</span></span>, <span class="hljs-number"><span class="hljs-number">48</span></span> tagged configure vlan web<span class="hljs-literal"><span class="hljs-literal">-110</span></span> add ports <span class="hljs-number"><span class="hljs-number">5</span></span> onfigure vlan <span class="hljs-number"><span class="hljs-number">20</span></span> add ports <span class="hljs-number"><span class="hljs-number">30</span></span><span class="hljs-literal"><span class="hljs-literal">-40</span></span>,<span class="hljs-number"><span class="hljs-number">45</span></span> untagged</code> </pre> <br><p> 由于大多数SummitX系列交换机是<strong>L3</strong>交换机，因此SVI的配置方式如下： </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">configure</span></span> vlan <span class="hljs-number"><span class="hljs-number">125</span></span> ipaddress <span class="hljs-number"><span class="hljs-number">192.168.125.1</span></span>/<span class="hljs-number"><span class="hljs-number">24</span></span></code> </pre> <br><p> 在那之后，您需要应用此命令，否则vlan将保持不可路由： </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ipforwarding vlan <span class="hljs-number"><span class="hljs-number">125</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ipforwarding vlan <span class="hljs-number"><span class="hljs-number">10</span></span><span class="hljs-number"><span class="hljs-number">-50</span></span>,<span class="hljs-number"><span class="hljs-number">60</span></span></code> </pre> <br><p> 要查看接口上的VLAN，可以使用以下命令： </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">show</span></span> ports <span class="hljs-number"><span class="hljs-number">2</span></span> vlan</code> </pre> <br><p> 要查看和保存配置，请使用以下命令，并且有主要和辅助配置文件： </p><br><pre> <code class="hljs pgsql">save save secondary <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> <span class="hljs-keyword"><span class="hljs-keyword">configuration</span></span></code> </pre> <br><h2> 链接聚合 </h2><br><p> 我遇到的<u>不愉快的</u>时刻之一是渠道的聚合。  （端口通道）。 总体要点是：您为一个主端口分配了最多七个辅助接口。 此外，所有设置仅在特定的主端口上进行，不存在形式为<em>po1的</em>逻辑接口。 缺点是，如果要更改主端口，则必须手动将所有设置转移到另一个端口，因为删除聚合通道时，该通道上的整个配置都会<u>生效</u> 。 本文为解决这种不便提供了解决方案，但仍无法完美解决。 在XOS中，聚合称为<strong>共享</strong> 。 <br> 要启用这样的端口，您需要使用以下格式的命令： </p><br><pre> <code class="hljs powershell">enable sharing [<span class="hljs-type"><span class="hljs-type">MASTER_PORT</span></span>] grouping [<span class="hljs-type"><span class="hljs-type">PORT_LIST</span></span>] [<span class="hljs-type"><span class="hljs-type">lacp</span></span>] enable sharing <span class="hljs-number"><span class="hljs-number">1</span></span> grouping <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-literal"><span class="hljs-literal">-2</span></span> lacp</code> </pre> <br><p> 在低于22.X的版本上，有必要添加“平衡”算法： </p><br><pre> <code class="hljs powershell">enable sharing <span class="hljs-number"><span class="hljs-number">1</span></span> grouping <span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-literal"><span class="hljs-literal">-2</span></span> algorithm address<span class="hljs-literal"><span class="hljs-literal">-based</span></span> L2 lacp</code> </pre> <br><h2>  OSI第2层环路保护 </h2><br><p> 在C主要版本22.2中的Summit-X交换机上，默认情况下<strong><u>禁用</u></strong>第二级环路保护协议。  （STP等）。 在撰写本文时，供应商推荐的软件是21.1.5.2。 </p><br><h3 id="elrp"> 埃尔普 </h3><br><p> 在我的一个项目中，我使用了专有的<abbr title="极限循环恢复协议">ELRP</abbr>协议，该协议旨在检测和防止环路。 在测试过程中，他显示出良好的结果（带有环路的端口关闭速度等）。 该协议发送多播<abbr title="协议数据单元">PDU</abbr> ，如果发送方再次接收到它，则存在循环。 <br> 该间隔负责PDU分配的频率，在这种情况下为2秒。 在环路的情况下，端口将被阻塞180秒，此后将再次发送PDU。 警报选项：日志，陷阱，日志和陷阱。 对于陷阱，将相应发送snmp陷阱。 <br> 已配置此每个VLAN协议以及XOS中的大多数配置。 </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> elrp-client configure elrp-client periodic Buh<span class="hljs-number"><span class="hljs-number">-123</span></span> ports <span class="hljs-keyword"><span class="hljs-keyword">all</span></span> <span class="hljs-type"><span class="hljs-type">interval</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">log</span></span> <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-port ingress duration <span class="hljs-number"><span class="hljs-number">180</span></span></code> </pre> <br><p> 为了防止ELRP协议阻塞访问交换机或关键连接的上行链路，使用了从阻塞中删除端口的命令。 </p><br><pre> <code class="hljs pgsql">configure elrp-client <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-port <span class="hljs-keyword"><span class="hljs-keyword">exclude</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span> configure elrp-client <span class="hljs-keyword"><span class="hljs-keyword">disable</span></span>-port <span class="hljs-keyword"><span class="hljs-keyword">exclude</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><h3 id="stp">  STP </h3><br><p>  STP的配置有些棘手，但通常没有特殊问题。 在XOS中，此协议称为“ stpd”，在所有用于配置STP的命令中均使用该协议。 您可以使用不同的STP域按VLAN进行操作。  “域ID”和“ VLAN ID”必须匹配。  STP中的端口可以手动添加，也可以使用VLAN自动绑定添加。 一旦将端口添加到VLAN，该端口就会自动添加到STP。 这是逻辑。 模式设置： <abbr title="802.1d标准">dot1d</abbr> STP， <abbr title="802.1w标准">dot1w</abbr> -RSTP： </p><br><pre> <code class="hljs pgsql">configure stpd "s0" priority <span class="hljs-number"><span class="hljs-number">4096</span></span> configure stpd s0 mode dot1w <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> stpd s0 <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> stpd "s0" auto-bind "VLAN_0005"</code> </pre> <br><h2>  VRRP </h2><br><p>  VRRP是<abbr title="第一跳冗余协议">FHRP的</abbr>一种，类似于Cisco的HSRP。 对于每个网络（vlan），都必须使用一个vrid，其范围可以从1到255。我很高兴能够使用结构路由选项路由来自backup-vrrp-L3交换机的流量。 默认情况下，优先级为100。哪个交换机具有更高的优先级，它将成为“主”。 </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span> configure vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span> <span class="hljs-keyword"><span class="hljs-keyword">priority</span></span> <span class="hljs-number"><span class="hljs-number">50</span></span> configure vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span> fabric-routing <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> vrrp vlan test1 vrid <span class="hljs-number"><span class="hljs-number">125</span></span></code> </pre> <br><h2>  MLAG </h2><br><p> 关于它是什么以及为什么， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在这里</a>对其进行了很好的描述：实际上，它是Cisco VPC的类似物。  <abbr title="交换机间连接"><strong>ISC-</strong></abbr>标记对交换机之间的连接。 </p><br><p> 就我而言，通常使用以下方案： <br><img src="https://habrastorage.org/webt/zc/bu/qf/zcbuqf-hljcoauy1g6tmdlgb0vq.jpeg"></p><br><p> 由于Extreme支持使用多个邻居的功能，因此必须创建一个邻居（对等方），以便能够将带有mlag的特定端口分配给特定的邻居。 对于ISC，您需要一个仅用于ISC并具有IP地址的VLAN。 因此，对于X670-1，我们将拥有X670-2，而标记端口将为x440。 为了正常运行，有必要创建一个聚合通道，并在x670上创建一个通向x440的端口，并在一个通向X670-2的聚合通道上创建，其中将有<strong>ALL</strong> Vlan参与其中。 <br> 在x670上： </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Enable</span></span> sharing <span class="hljs-number"><span class="hljs-number">1</span></span> grouping <span class="hljs-number"><span class="hljs-number">1</span></span> lacp <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> mlag peer "mlag1" configure mlag peer "mlag1" ipaddress <span class="hljs-number"><span class="hljs-number">10.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span> vr VR-<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> mlag port <span class="hljs-number"><span class="hljs-number">1</span></span> peer "mlag1" id <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p> 在x440堆栈上： </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">enable</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">sharing</span></span> 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:51</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">grouping</span></span> 1<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:51</span></span>,2<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:51</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">lacp</span></span></code> </pre> <br><h2>  MLAG + VRRP </h2><br><p> 在对展台的交换机进行测试期间，发现一个问题，即VRRP在所有其他接口（首先是ISC）和协议都上升之前就取消了Master角色，这导致网络停机时间约为一分钟。 <br> 此问题已通过以下命令解决，但是仅在“ EXOS 21.1.3.7-patch1-4”和“ EXOS 22.3”中可用： </p><br><pre> <code class="hljs powershell">configure mlag ports reload<span class="hljs-literal"><span class="hljs-literal">-delay</span></span> <span class="hljs-number"><span class="hljs-number">60</span></span> enable mlag port reload<span class="hljs-literal"><span class="hljs-literal">-delay</span></span></code> </pre> <br><h2> 路由选择 </h2><br><p> 静态路由定义如下，应该没有问题。 您可以在任何版本中设置遮罩。 </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">configure</span></span> iproute add <span class="hljs-number"><span class="hljs-number">10.0.66.0</span></span> <span class="hljs-number"><span class="hljs-number">255.255.255.0</span></span> <span class="hljs-number"><span class="hljs-number">172.16.1.1</span></span> configure iproute add <span class="hljs-number"><span class="hljs-number">10.0.0.1</span></span>/<span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-number"><span class="hljs-number">10.255.255.255</span></span> configure iproute add default <span class="hljs-number"><span class="hljs-number">172.16.0.1</span></span></code> </pre> <br><h3 id="ospf">  OSPF协议 </h3><br><p> 对于路由，在我的实践中，使用了具有单个区域的OSPF。 为了确保可操作性，有必要设置一个路由器ID，并添加需要宣布的每个VLAN（类似于Cisco：网络）。 </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">configure</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">routerid</span></span> 192<span class="hljs-selector-class"><span class="hljs-selector-class">.168</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">enable</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">configure</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vlan</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">routing-5</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">area</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">configure</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">ospf</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">add</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">vlan</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Voip-32</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">area</span></span> 0<span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.0</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">passive</span></span></code> </pre> <br><h2> 其他小事 </h2><br><h3 id="dhcp-relay">  DHCP中继 </h3><br><p> 配置如下： </p><br><pre> <code class="hljs pgsql">configure bootprelay <span class="hljs-keyword"><span class="hljs-keyword">add</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.12</span></span><span class="hljs-number"><span class="hljs-number">.5</span></span> vr VR-<span class="hljs-keyword"><span class="hljs-keyword">Default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> bootprelay ipv4 vlan servers<span class="hljs-number"><span class="hljs-number">-500</span></span></code> </pre> <br><p> 创建新的VLAN时，必须使用DHCP中继将其手动添加到VLAN列表中。 </p><br><h3 id="ssh--acl-dlya-ssh">  SSH + SSH的ACL </h3><br><p> 启用S​​sh的方法如下： </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ssh2</code> </pre> <br><p> 要限制对ssh的访问，您需要创建一个单独的格式为NAME.pol的策略文件，并将其挂在SSH上。 </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">vi</span></span> ssh.pol</code> </pre> <br><p> 政策： </p><br><pre> <code class="hljs mel">Entry AllowTheseSubnets { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">match</span></span> any { <span class="hljs-keyword"><span class="hljs-keyword">source</span></span>-address <span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> /<span class="hljs-number"><span class="hljs-number">16</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">source</span></span>-address <span class="hljs-number"><span class="hljs-number">10.255</span></span><span class="hljs-number"><span class="hljs-number">.255</span></span><span class="hljs-number"><span class="hljs-number">.34</span></span> /<span class="hljs-number"><span class="hljs-number">32</span></span>; } Then { permit; } }</code> </pre> <br><p> 应用策略的命令： </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">enable</span></span> ssh2 <span class="hljs-keyword"><span class="hljs-keyword">access</span></span>-profile ssh.pol</code> </pre> <br><h3 id="description--display-string"> 说明+显示字符串 </h3><br><p> 为了便于设置和后续操作，您可以设置界面的“名称”和“描述”。 </p><br><pre> <code class="hljs kotlin">onfigure port <span class="hljs-number"><span class="hljs-number">1</span></span> description “<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> port number one”</code> </pre> <br><p> 该接口的描述将仅以以下形式的命令显示： </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">show</span></span> ports description</code> </pre> <br><p> 接口名称将在命令输出中几乎替换其编号的所有位置。 该名称不能包含空格，并且长度不能超过20个字符。 </p><br><pre> <code class="hljs vhdl">onfigure <span class="hljs-keyword"><span class="hljs-keyword">port</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> display-<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> UserPort EXOS-VM.<span class="hljs-number"><span class="hljs-number">8</span></span> # sh <span class="hljs-keyword"><span class="hljs-keyword">port</span></span> vlan Untagged <span class="hljs-keyword"><span class="hljs-keyword">Port</span></span> /Tagged VLAN Name(s) <span class="hljs-comment"><span class="hljs-comment">-------- -------- ------------------------------------------------------------ UserPort Untagged Default 2 Untagged Default 3 Untagged Default</span></span></code> </pre> <br><h2 id="zaklyuchenie"> 结论 </h2><br><p>  <strong>XOS</strong>还原生支持Python和使用<em>CLI脚本</em>命令创建和运行脚本的内置机制，因此可以使许多操作自动化并使系统适应您的需求。 </p><br><p> 我愿意提出改进文章和纠正错误/错误以及问题的建议。 </p><br><p>  <strong>UPD</strong> ：使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此注释中</a>的命令配置IP电话的LLDP。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN419965/">https://habr.com/ru/post/zh-CN419965/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN419951/index.html">有使用WebRTC的经验。 Yandex讲座</a></li>
<li><a href="../zh-CN419953/index.html">我正在写关于征服世界的第一个“我们的”创业公司的书：帮助</a></li>
<li><a href="../zh-CN419955/index.html">ESP32中F​​IFO UART缓冲区的功能</a></li>
<li><a href="../zh-CN419961/index.html">265号移动开发人员的有趣材料摘要（8月6日至8月12日）</a></li>
<li><a href="../zh-CN419963/index.html">我们在ESP8266上为空调制作了一个“智能”控制器</a></li>
<li><a href="../zh-CN419969/index.html">隐藏在Ruby中。 同时从顶级隐藏类</a></li>
<li><a href="../zh-CN419971/index.html">火箭实验室修补，扩展和加速</a></li>
<li><a href="../zh-CN419973/index.html">8月13日至19日在莫斯科举行的数字活动</a></li>
<li><a href="../zh-CN419975/index.html">我们如何摆脱Windows Corporate</a></li>
<li><a href="../zh-CN419977/index.html">研究人员：并非所有的2级自动驾驶仪都能同样出色地工作，但进步显而易见</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>