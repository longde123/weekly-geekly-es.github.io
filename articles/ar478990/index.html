<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘ŒğŸ» ğŸŒ ğŸŒ¡ï¸ ØªØ«Ø¨ÙŠØª LeoFS Ù…Ø±ÙÙ‚ ØªØ®Ø²ÙŠÙ† Ø¢Ù…Ù†Ø© Ù…Ù† Ø§Ù„ÙØ´Ù„ Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø°ÙŠÙ† ÙŠØ³ØªØ®Ø¯Ù…ÙˆÙ† S3 ØŒ NFS ğŸ‘µğŸ¿ ğŸ‘¼ğŸ» ğŸ‘¨ğŸ»â€ğŸ­</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ø£Ù†Ø§ Ù…Ù† Ù„ÙˆÙƒØ³ÙˆÙØª. 
 ÙˆÙÙ‚Ù‹Ø§ Ù„Ù€ Opennet : LeoFS Ù‡ÙŠ Ù…Ù†Ø´Ø£Ø© ØªØ®Ø²ÙŠÙ† Ù…ØªØ³Ø§Ù…Ø­Ø© Ù…Ø¹ Ø§Ù„Ø£Ø¹Ø·Ø§Ù„ Ù„ÙƒØ§Ø¦Ù†Ø§Øª LeoFS ØŒ ÙˆÙ…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø°ÙŠÙ† ÙŠØ³ØªØ®Ø¯Ù…ÙˆÙ† Amazon S3 API Ùˆ REST-A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ØªØ«Ø¨ÙŠØª LeoFS Ù…Ø±ÙÙ‚ ØªØ®Ø²ÙŠÙ† Ø¢Ù…Ù†Ø© Ù…Ù† Ø§Ù„ÙØ´Ù„ Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø°ÙŠÙ† ÙŠØ³ØªØ®Ø¯Ù…ÙˆÙ† S3 ØŒ NFS</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/478990/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl">  Ø£Ù†Ø§ Ù…Ù† Ù„ÙˆÙƒØ³ÙˆÙØª. <br>  ÙˆÙÙ‚Ù‹Ø§ Ù„Ù€ <a href="http://leo-project.net/leofs/index.html" rel="nofollow">Opennet</a> : <a href="http://leo-project.net/leofs/index.html" rel="nofollow">LeoFS</a> Ù‡ÙŠ Ù…Ù†Ø´Ø£Ø© ØªØ®Ø²ÙŠÙ† Ù…ØªØ³Ø§Ù…Ø­Ø© Ù…Ø¹ <a href="http://leo-project.net/leofs/index.html" rel="nofollow">Ø§Ù„Ø£Ø¹Ø·Ø§Ù„</a> Ù„ÙƒØ§Ø¦Ù†Ø§Øª <a href="http://leo-project.net/leofs/index.html" rel="nofollow">LeoFS</a> ØŒ ÙˆÙ…ØªÙˆØ§ÙÙ‚Ø© Ù…Ø¹ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø§Ù„Ø°ÙŠÙ† ÙŠØ³ØªØ®Ø¯Ù…ÙˆÙ† Amazon S3 API Ùˆ REST-API ØŒ ÙˆØ£ÙŠØ¶Ù‹Ø§ ØªØ¯Ø¹Ù… ÙˆØ¶Ø¹ Ø§Ù„ØªØ´ØºÙŠÙ„ ÙƒØ®Ø§Ø¯Ù… NFS.  Ù‡Ù†Ø§Ùƒ ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª Ø§Ù„ØµØºÙŠØ±Ø© ÙˆØ§Ù„ÙƒØ¨ÙŠØ±Ø© Ø¬Ø¯Ù‹Ø§ Ø¹Ù„Ù‰ Ø­Ø¯ Ø³ÙˆØ§Ø¡ ØŒ ÙˆÙ‡Ù†Ø§Ùƒ Ø¢Ù„ÙŠØ© Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª Ø§Ù„Ù…Ø¶Ù…Ù†Ø© ØŒ ÙˆØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø®Ø§Ø²Ù† Ø¨ÙŠÙ† Ù…Ø±Ø§ÙƒØ² Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù…ÙƒÙ†.  Ù…Ù† Ø¨ÙŠÙ† Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ØªØ­Ù‚ÙŠÙ‚ Ù…ÙˆØ«ÙˆÙ‚ÙŠØ© 99.9999999 Ùª Ø¨Ø³Ø¨Ø¨ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…ÙØ±Ø· Ù„Ù„ØªÙƒØ±Ø§Ø±Ø§Øª ÙˆØ§Ù„Ù‚Ø¶Ø§Ø¡ Ø¹Ù„Ù‰ Ù†Ù‚Ø·Ø© ÙˆØ§Ø­Ø¯Ø© Ù…Ù† Ø§Ù„ÙØ´Ù„.  Ø±Ù…Ø² Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù…ÙƒØªÙˆØ¨ Ø¨Ù„ØºØ© Ø¥Ø±Ù„Ø§Ù†Ø¬. </p><br><p style=";text-align:right;direction:rtl">  ÙŠØªÙƒÙˆÙ† LeoFS Ù…Ù† Ø«Ù„Ø§Ø«Ø© Ù…ÙƒÙˆÙ†Ø§Øª: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <a href="https://leo-project.net/leofs/docs/architecture/leo_storage/" rel="nofollow">Ø§Ù„ØªØ®Ø²ÙŠÙ† LeoFS</a> - Ø®Ø¯Ù…Ø§Øª Ø¹Ù…Ù„ÙŠØ§Øª Ø¥Ø¶Ø§ÙØ© ÙˆØ§Ø³ØªØ±Ø¯Ø§Ø¯ ÙˆØ­Ø°Ù Ø§Ù„ÙƒØ§Ø¦Ù†Ø§Øª ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠØ© ØŒ Ù‡ÙŠ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ù…ØªÙ…Ø§Ø«Ù„ ÙˆØ§Ø³ØªØ¹Ø§Ø¯Ø© Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±. </li><li style=";text-align:right;direction:rtl">  <a href="https://leo-project.net/leofs/docs/architecture/leo_gateway/" rel="nofollow">LeoFS Gateway</a> - ÙŠØ®Ø¯Ù… Ø·Ù„Ø¨Ø§Øª HTTP ÙˆÙŠØ¹ÙŠØ¯ ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø§Øª Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… REST-API Ø£Ùˆ S3-API ØŒ ÙˆÙŠÙˆÙØ± Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø¤Ù‚Øª Ù„Ø£ÙƒØ«Ø± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© ÙˆØ¹Ù„Ù‰ Ø§Ù„Ù‚Ø±Øµ. </li><li style=";text-align:right;direction:rtl">  <a href="https://leo-project.net/leofs/docs/architecture/leo_manager/" rel="nofollow">Ø¨Ø±Ù†Ø§Ù…Ø¬ LeoFS Manager</a> - ÙŠØ±Ø§Ù‚Ø¨ ØªØ´ØºÙŠÙ„ Ø¹Ù‚Ø¯ØªÙŠ LeoFS Gateway Ùˆ LeoFS Storage ØŒ ÙˆÙŠØ±Ø§Ù‚Ø¨ Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù‚Ø¯ ÙˆÙŠØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±ÙŠ.  ÙŠØ¶Ù…Ù† Ø³Ù„Ø§Ù…Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙˆØªÙˆØ§ÙØ± ØªØ®Ø²ÙŠÙ† Ø¹Ø§Ù„ÙŠØ©. </li></ul><br><p style=";text-align:right;direction:rtl">  ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø´ÙˆØ± ØŒ Ù‚Ù… Ø¨ØªØ«Ø¨ÙŠØª Leofs Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… ansible-playbook ØŒ ÙˆØ§Ø®ØªØ¨Ø§Ø± S3 ØŒ NFS. </p><a name="habracut"></a><br><p style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ Ø­Ø§ÙˆÙ„Øª ØªØ«Ø¨ÙŠØª LeoFS Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨ Ø§Ù„Ø±Ø³Ù…ÙŠØ© ØŒ ÙØ«Ù…Ø© Ø£Ø®Ø·Ø§Ø¡ Ù…Ø®ØªÙ„ÙØ© ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø±Ùƒ: <a href="https://github.com/leo-project/leofs_ansible/issues/5" rel="nofollow">1</a> ØŒ <a href="https://github.com/leo-project/leofs_ansible/issues/4" rel="nofollow">2</a> .  ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†Ø´ÙˆØ± Ø³Ø£ÙƒØªØ¨ Ù…Ø§ ÙŠØ¬Ø¨ Ø§Ù„Ù‚ÙŠØ§Ù… Ø¨Ù‡ Ù„ØªØ¬Ù†Ø¨ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡. </p><br><p style=";text-align:right;direction:rtl">  Ø­ÙŠØ« Ø³ØªÙ‚ÙˆÙ… Ø¨ØªØ´ØºÙŠÙ„ ansible-playbook ØŒ Ø³ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØ«Ø¨ÙŠØª netcat. </p><br><h4 id="primer-inventory" style=";text-align:right;direction:rtl">  Ù…Ø«Ø§Ù„ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† </h4><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Ù…Ø«Ø§Ù„ Ø§Ù„Ù…Ø®Ø²ÙˆÙ† (ÙÙŠ Ù…Ø³ØªÙˆØ¯Ø¹ hosts.sample):</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"><code class="plaintext hljs"># Please check roles/common/vars/leofs_releases for available versions [all:vars] leofs_version=1.4.3 build_temp_path="/tmp/leofs_builder" build_install_path="/tmp/" build_branch="master" source="package" #[builder] #172.26.9.177 # nodename of leo_manager_0 and leo_manager_1 are set at group_vars/all [leo_manager_0] 172.26.9.176 # nodename of leo_manager_0 and leo_manager_1 are set at group_vars/all [leo_manager_1] 172.26.9.178 [leo_storage] 172.26.9.179 leofs_module_nodename=S0@172.26.9.179 172.26.9.181 leofs_module_nodename=S0@172.26.9.181 172.26.9.182 leofs_module_nodename=S0@172.26.9.182 172.26.9.183 leofs_module_nodename=S0@172.26.9.183 [leo_gateway] 172.26.9.180 leofs_module_nodename=G0@172.26.9.180 172.26.9.184 leofs_module_nodename=G0@172.26.9.184 [leofs_nodes:children] leo_manager_0 leo_manager_1 leo_gateway leo_storage</code> </pre> </div></div><br><h4 id="podgotovka-serverov" style=";text-align:right;direction:rtl">  Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø®Ø§Ø¯Ù… </h4><br><p style=";text-align:right;direction:rtl">  ØªØ¹Ø·ÙŠÙ„ Ø³ÙŠÙ„ÙŠÙ†Ùˆ.  Ø¢Ù…Ù„ Ø£Ù† ÙŠÙ†Ø´Ø¦ Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø³ÙŠØ§Ø³Ø§Øª Selinux Ù„Ù€ LeoFS. </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> - name: Install libselinux as prerequisite for SELinux Ansible module yum: name: "{{item}}" state: latest with_items: - libselinux-python - libsemanage-python - name: Disable SELinux at next reboot selinux: state: disabled - name: Set SELinux in permissive mode until the machine is rebooted command: setenforce 0 ignore_errors: true changed_when: false</code> </pre><br><p style=";text-align:right;direction:rtl">  ØªØ«Ø¨ÙŠØª <code>netcat</code> Ùˆ <code>redhat-lsb-core</code> .  Ù‡Ù†Ø§Ùƒ Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ <code>netcat</code> Ù„Ù€ <code>leofs-adm</code> ØŒ <code>redhat-lsb-core</code> Ø­Ø§Ø¬Ø© Ø¥Ù„Ù‰ <code>redhat-lsb-core</code> Ù„ØªØ­Ø¯ÙŠØ¯ Ø¥ØµØ¯Ø§Ø± Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ØºÙŠÙ„ <a href="" rel="nofollow">Ù‡Ù†Ø§</a> . </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> - name: Install Packages yum: name={{ item }} state=present with_items: - nmap-ncat - redhat-lsb-core</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙƒØ§ÙØ¦ ÙˆØ¥Ø¶Ø§ÙØªÙ‡ Ø¥Ù„Ù‰ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø¹Ø¬Ù„Ø§Øª </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> - name: Create user leofs group: name: leofs state: present - name: Allow 'wheel' group to have passwordless sudo lineinfile: dest: /etc/sudoers state: present regexp: '^%wheel' line: '%wheel ALL=(ALL) NOPASSWD: ALL' validate: 'visudo -cf %s' - name: Add the user 'leofs' to group 'wheel' user: name: leofs groups: wheel append: yes</code> </pre> <br><p style=";text-align:right;direction:rtl">  ØªØ«Ø¨ÙŠØª Erlang </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> - name: Remote erlang-20.3.8.23-1.el7.x86_64.rpm install with yum yum: name=https://github.com/rabbitmq/erlang-rpm/releases/download/v20.3.8.23/erlang-20.3.8.23-1.el7.x86_64.rpm</code> </pre><br><p style=";text-align:right;direction:rtl">  ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© Ù…Ù† Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ù„Ø¹Ø¨Ø© Ø§Ù„ØªÙŠ ØªÙ… ØªØµØ­ÙŠØ­Ù‡Ø§ Ù…Ù† Ù‡Ù†Ø§: <a href="https://github.com/patsevanton/leofs_ansible" rel="nofollow">https://github.com/patsevanton/leofs_ansible</a> </p><br><h4 id="ustanovka-konfigurirovanie-zapusk" style=";text-align:right;direction:rtl">  Ø§Ù„ØªØ«Ø¨ÙŠØª ØŒ Ø§Ù„ØªÙƒÙˆÙŠÙ† ØŒ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© </h4><br><p style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ Ø°Ù„Ùƒ ØŒ Ù†ÙØ° ÙƒÙ…Ø§ Ù‡Ùˆ Ù…ÙƒØªÙˆØ¨ ÙÙŠ <a href="https://github.com/leo-project/leofs_ansible" rel="nofollow">https://github.com/leo-project/leofs_ansible</a> Ø¯ÙˆÙ† build_leofs.yml </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">## Install LeoFS $ ansible-playbook -i hosts install_leofs.yml ## Config LeoFS $ ansible-playbook -i hosts config_leofs.yml ## Start LeoFS $ ansible-playbook -i hosts start_leofs.yml</span></span></code> </pre> <br><h4 id="proveryaem-status-klastera-na-primary-leomanager" style=";text-align:right;direction:rtl">  Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„ÙƒØªÙ„Ø© Ø¹Ù„Ù‰ LeoManager Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ </h4><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm status</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠ ÙˆØ§Ù„Ø«Ø§Ù†ÙˆÙŠ ÙŠÙ…ÙƒÙ† Ø£Ù† ÙŠÙ†Ø¸Ø± Ø¥Ù„ÙŠÙ‡ ÙÙŠ Ø³Ø¬Ù„Ø§Øª ansible- playbook </p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/do/kp/oj/dokpoj8lmzwh3bmakpxx9anc-4i.png"></p><br><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/ku/0o/bt/ku0obtn6ezvfghyfai01zldeaws.png"></p><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Ø§Ù„Ø§Ø³ØªÙ†ØªØ§Ø¬ Ø³ÙŠÙƒÙˆÙ† Ø´ÙŠØ¡ Ù…Ø«Ù„ Ù‡Ø°Ø§</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> [System Confiuration] -----------------------------------+---------- Item | Value -----------------------------------+---------- Basic/Consistency level -----------------------------------+---------- system version | 1.4.3 cluster Id | leofs_1 DC Id | dc_1 Total replicas | 2 number of successes of R | 1 number of successes of W | 1 number of successes of D | 1 number of rack-awareness replicas | 0 ring size | 2^128 -----------------------------------+---------- Multi DC replication settings -----------------------------------+---------- [mdcr] max number of joinable DCs | 2 [mdcr] total replicas per a DC | 1 [mdcr] number of successes of R | 1 [mdcr] number of successes of W | 1 [mdcr] number of successes of D | 1 -----------------------------------+---------- Manager RING <span class="hljs-built_in"><span class="hljs-built_in">hash</span></span> -----------------------------------+---------- current ring-hash | a0314afb previous ring-hash | a0314afb -----------------------------------+---------- [State of Node(s)] -------+----------------------+--------------+---------+----------------+----------------+---------------------------- <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> | node | state | rack id | current ring | prev ring | updated at -------+----------------------+--------------+---------+----------------+----------------+---------------------------- S | S0@172.26.9.179 | running | | a0314afb | a0314afb | 2019-12-05 10:33:47 +0000 S | S0@172.26.9.181 | running | | a0314afb | a0314afb | 2019-12-05 10:33:47 +0000 S | S0@172.26.9.182 | running | | a0314afb | a0314afb | 2019-12-05 10:33:47 +0000 S | S0@172.26.9.183 | attached | | | | 2019-12-05 10:33:58 +0000 G | G0@172.26.9.180 | running | | a0314afb | a0314afb | 2019-12-05 10:33:49 +0000 G | G0@172.26.9.184 | running | | a0314afb | a0314afb | 2019-12-05 10:33:49 +0000 -------+----------------------+--------------+---------+----------------+----------------+----------------------------</code> </pre> </div></div><br><h4 id="sozdaem-yuzera" style=";text-align:right;direction:rtl">  Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø³ØªØ®Ø¯Ù… </h4><br><p style=";text-align:right;direction:rtl">  Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙƒØ§ÙØ¢Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm create-user leofs leofs access-key-id: 9c2615f32e81e6a1caf5 secret-access-key: 8aaaa35c1ad78a2cbfa1a6cd49ba8aaeb3ba39eb</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm get-users user_id | role_id | access_key_id | created_at ------------+---------+------------------------+--------------------------- _test_leofs | 9 | 05236 | 2019-12-02 06:56:49 +0000 leofs | 1 | 9c2615f32e81e6a1caf5 | 2019-12-02 10:43:29 +0000</code> </pre> <br><h4 id="sozdaem-bucket" style=";text-align:right;direction:rtl">  Ø¥Ù†Ø´Ø§Ø¡ Ø¯Ù„Ùˆ </h4><br><p style=";text-align:right;direction:rtl">  ØµÙ†Ø¹ Ø¯Ù„Ùˆ </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm add-bucket leofs 9c2615f32e81e6a1caf5 OK</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù‚Ø§Ø¦Ù…Ø© Ø¯Ù„Ùˆ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> leofs-adm get-buckets cluster id | bucket | owner | permissions | created at -------------+----------+--------+------------------+--------------------------- leofs_1 | leofs | leofs | Me(full_control) | 2019-12-02 10:44:02 +0000</code> </pre> <br><h4 id="konfigurirovanie-s3cmd" style=";text-align:right;direction:rtl">  ØªÙƒÙˆÙŠÙ† s3cmd </h4><br><p style=";text-align:right;direction:rtl">  ÙÙŠ Ø­Ù‚Ù„ <code>HTTP Proxy server name</code> ØŒ Ø­Ø¯Ø¯ Ø¹Ù†ÙˆØ§Ù† IP Ù„Ø®Ø§Ø¯Ù… Gateway </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">s3cmd --configure Enter new values or accept defaults <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> brackets with Enter. Refer to user manual <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> detailed description of all options. Access key and Secret key are your identifiers <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Amazon S3. Leave them empty <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> using the env variables. Access Key [9c2615f32e81e6a1caf5]: Secret Key [8aaaa35c1ad78a2cbfa1a6cd49ba8aaeb3ba39eb]: Default Region [US]: Use <span class="hljs-string"><span class="hljs-string">"s3.amazonaws.com"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> S3 Endpoint and not modify it to the target Amazon S3. S3 Endpoint [s3.amazonaws.com]: Use <span class="hljs-string"><span class="hljs-string">"%(bucket)s.s3.amazonaws.com"</span></span> to the target Amazon S3. <span class="hljs-string"><span class="hljs-string">"%(bucket)s"</span></span> and <span class="hljs-string"><span class="hljs-string">"%(location)s"</span></span> vars can be used <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> the target S3 system supports dns based buckets. DNS-style bucket+hostname:port template <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> accessing a bucket [%(bucket)s.s3.amazonaws.com]: leofs Encryption password is used to protect your files from reading by unauthorized persons <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> transfer to S3 Encryption password: Path to GPG program [/usr/bin/gpg]: When using secure HTTPS protocol all communication with Amazon S3 servers is protected from 3rd party eavesdropping. This method is slower than plain HTTP, and can only be proxied with Python 2.7 or newer Use HTTPS protocol [No]: On some networks all internet access must go through a HTTP proxy. Try setting it here <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> you can<span class="hljs-string"><span class="hljs-string">'t connect to S3 directly HTTP Proxy server name [172.26.9.180]: HTTP Proxy server port [8080]: New settings: Access Key: 9c2615f32e81e6a1caf5 Secret Key: 8aaaa35c1ad78a2cbfa1a6cd49ba8aaeb3ba39eb Default Region: US S3 Endpoint: s3.amazonaws.com DNS-style bucket+hostname:port template for accessing a bucket: leofs Encryption password: Path to GPG program: /usr/bin/gpg Use HTTPS protocol: False HTTP Proxy server name: 172.26.9.180 HTTP Proxy server port: 8080 Test access with supplied credentials? [Y/n] Y Please wait, attempting to list all buckets... Success. Your access key and secret key worked fine :-) Now verifying that encryption works... Not configured. Never mind. Save settings? [y/N] y Configuration saved to '</span></span>/home/user/.s3cfg<span class="hljs-string"><span class="hljs-string">'</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ ØªÙ„Ù‚ÙŠØª Ø®Ø·Ø£ ØŒ Ø®Ø·Ø£ S3: 403 (AccessDenied): ØªÙ… Ø±ÙØ¶ Ø§Ù„ÙˆØµÙˆÙ„: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">s3cmd put test.py s3://leofs/ upload: <span class="hljs-string"><span class="hljs-string">'test.py'</span></span> -&gt; <span class="hljs-string"><span class="hljs-string">'s3://leofs/test.py'</span></span> [1 of 1] 382 of 382 100% <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> 0s 3.40 kB/s <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> ERROR: S3 error: 403 (AccessDenied): Access Denied</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø«Ù… ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ ØªØµØ­ÙŠØ­ signature_v2 ÙÙŠ True s3cmd config.  Ø§Ù„ØªÙØ§ØµÙŠÙ„ ÙÙŠ Ù‡Ø°Ù‡ <a href="https://github.com/leo-project/leofs/issues/487" rel="nofollow">Ø§Ù„Ù…Ø³Ø£Ù„Ø©</a> . </p><br><p style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ ÙƒØ§Ù† signature_v2 False ØŒ ÙØ³ÙŠØ­Ø¯Ø« Ø®Ø·Ø£ ÙƒÙ‡Ø°Ø§: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">WARNING: Retrying failed request: /?delimiter=%2F (getaddrinfo() argument 2 must be <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> or string) WARNING: Waiting 3 sec... WARNING: Retrying failed request: /?delimiter=%2F (getaddrinfo() argument 2 must be <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> or string) WARNING: Waiting 6 sec... ERROR: Test failed: Request failed <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>: /?delimiter=%2F</code> </pre> <br><h4 id="testirovanie-zagruzki" style=";text-align:right;direction:rtl">  Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙ…Ù‡ÙŠØ¯ </h4><br><p style=";text-align:right;direction:rtl">  Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù 1GB </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">fallocate -l 1GB 1gb</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù‚Ù… Ø¨ØªØ­Ù…ÙŠÙ„Ù‡ Ø¥Ù„Ù‰ Leofs </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">time s3cmd put 1gb s3://leofs/ real 0m19.099s user 0m7.855s sys 0m1.620s</code> </pre> <br><h4 id="statistika" style=";text-align:right;direction:rtl">  Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª </h4><br><p style=";text-align:right;direction:rtl">  leofs-adm du Ù„Ù€ 1 Ø¹Ù‚Ø¯Ø©: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm du S0@172.26.9.179 active number of objects: 156 total number of objects: 156 active size of objects: 602954495 total size of objects: 602954495 ratio of active size: 100.0% last compaction start: ____-__-__ __:__:__ last compaction end: ____-__-__ __:__:__</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù†Ø±Ù‰ Ø£Ù† Ø§Ù„Ø§Ø³ØªÙ†ØªØ§Ø¬ Ù„ÙŠØ³ ØºÙ†ÙŠ Ø¨Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª. </p><br><p style=";text-align:right;direction:rtl">  Ø¯Ø¹ÙˆÙ†Ø§ Ù†Ø±Ù‰ Ø£ÙŠÙ† ÙŠÙ‚Ø¹ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù. <br>  leofs-adm Ø­ÙŠØ« Ù‡Ùˆ leofs / 1GB </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm whereis leofs/1gb -------+----------------------+--------------------------------------+------------+--------------+----------------+----------------+----------------+---------------------------- del? | node | ring address | size | checksum | has children | total chunks | clock | when -------+----------------------+--------------------------------------+------------+--------------+----------------+----------------+----------------+---------------------------- | S0@172.26.9.181 | 657a9f3a3db822a7f1f5050925b26270 | 976563K | a4634eea55 | <span class="hljs-literal"><span class="hljs-literal">true</span></span> | 64 | 598f2aa976a4f | 2019-12-05 10:48:15 +0000 | S0@172.26.9.182 | 657a9f3a3db822a7f1f5050925b26270 | 976563K | a4634eea55 | <span class="hljs-literal"><span class="hljs-literal">true</span></span> | 64 | 598f2aa976a4f | 2019-12-05 10:48:15 +0000</code> </pre> <br><h4 id="aktiviruem-nfs" style=";text-align:right;direction:rtl">  ØªÙØ¹ÙŠÙ„ NFS </h4><br><p style=";text-align:right;direction:rtl">  Ù†Ù‚ÙˆÙ… Ø¨ØªÙ†Ø´ÙŠØ· NFS Ø¹Ù„Ù‰ Ø®Ø§Ø¯Ù… Leo Gateway 172.26.9.184. </p><br><p style=";text-align:right;direction:rtl">  Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… ÙˆØ§Ù„Ø¹Ù…ÙŠÙ„ ØŒ Ù‚Ù… Ø¨ØªØ«Ø¨ÙŠØª nfs-utils </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo yum install nfs-utils</code> </pre> <br><p style=";text-align:right;direction:rtl">  ÙˆÙÙ‚Ù‹Ø§ Ù„Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª ØŒ Ø³Ù†ØµÙ„Ø­ Ù…Ù„Ù Ø§Ù„ØªÙƒÙˆÙŠÙ† / <code>/usr/local/leofs/current/leo_gateway/etc/leo_gateway.conf</code> </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">protocol = nfs</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… 172.26.9.184 ØŒ Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„ rpcbind Ùˆ leofs-gateway </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo service rpcbind start sudo service leofs-gateway restart</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø§Ø¯Ù… Ø­ÙŠØ« ÙŠØªÙ… ØªØ´ØºÙŠÙ„ leo_manager ØŒ Ù‚Ù… Ø¨Ø¥Ù†Ø´Ø§Ø¡ Ø¯Ù„Ùˆ Ù„Ù€ NFS ÙˆØ¥Ù†Ø´Ø§Ø¡ Ù…ÙØªØ§Ø­ Ù„Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ NFS </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm add-bucket <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> 05236 leofs-adm gen-nfs-mnt-key <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> 05236 ip--nfs-</code> </pre> <br><h4 id="podklyuchenie-k-nfs" style=";text-align:right;direction:rtl">  Ø§Ù„Ø§ØªØµØ§Ù„ NFS </h4><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo mkdir /mnt/leofs <span class="hljs-comment"><span class="hljs-comment">## for Linux - "sudo mount -t nfs -o nolock &lt;host&gt;:/&lt;bucket&gt;/&lt;token&gt; &lt;dir&gt;" sudo mount -t nfs -o nolock ip--nfs-------gateway:/bucket/access_key_id/---gen-nfs-mnt-key /mnt/leofs sudo mount -t nfs -o nolock 172.26.9.184:/test/05236/bb5034f0c740148a346ed663ca0cf5157efb439f /mnt/leofs</span></span></code> </pre> <br><h4 id="prosmotr-diskovogo-prostanstva-cherez-nfs-klient" style=";text-align:right;direction:rtl">  Ø¹Ø±Ø¶ Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù‚Ø±Øµ Ù…Ù† Ø®Ù„Ø§Ù„ Ø¹Ù…ÙŠÙ„ NFS </h4><br><p style=";text-align:right;direction:rtl">  Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù‚Ø±Øµ Ù…Ø¹ Ø§Ù„Ø£Ø®Ø° ÙÙŠ Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø± Ø£Ù† ÙƒÙ„ Ø¹Ù‚Ø¯Ø© ØªØ®Ø²ÙŠÙ† Ø¨Ù‡Ø§ Ù‚Ø±Øµ Ø³Ø¹Ø© 40 Ø¬ÙŠØ¬Ø§Ø¨Ø§ÙŠØª (3 Ø¹Ù‚Ø¯ ØªØ´ØºÙŠÙ„ ØŒ Ø¹Ù‚Ø¯Ø© ÙˆØ§Ø­Ø¯Ø© Ù…ØªØµÙ„Ø©): </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">df -hP Filesystem Size Used Avail Use% Mounted on 172.26.9.184:/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>/05236/e7298032e78749149dd83a1e366afb328811c95b 60G 3.6G 57G 6% /mnt/leofs</code> </pre> <br><h4 id="ustanovka-leofs-s-6-storage-nodami" style=";text-align:right;direction:rtl">  ØªØ«Ø¨ÙŠØª LeoFS Ù…Ø¹ 6 Ø¹Ù‚Ø¯ Ø§Ù„ØªØ®Ø²ÙŠÙ†. </h4><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Ø¬Ø±Ø¯ (Ø¨Ø¯ÙˆÙ† Ø¨Ø§Ù†ÙŠ):</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># Please check roles/common/vars/leofs_releases for available versions [all:vars] leofs_version=1.4.3 build_temp_path="/tmp/leofs_builder" build_install_path="/tmp/" build_branch="master" source="package" # nodename of leo_manager_0 and leo_manager_1 are set at group_vars/all [leo_manager_0] 172.26.9.177 # nodename of leo_manager_0 and leo_manager_1 are set at group_vars/all [leo_manager_1] 172.26.9.176 [leo_storage] 172.26.9.178 leofs_module_nodename=S0@172.26.9.178 172.26.9.179 leofs_module_nodename=S0@172.26.9.179 172.26.9.181 leofs_module_nodename=S0@172.26.9.181 172.26.9.182 leofs_module_nodename=S0@172.26.9.182 172.26.9.183 leofs_module_nodename=S0@172.26.9.183 172.26.9.185 leofs_module_nodename=S0@172.26.9.185 [leo_gateway] 172.26.9.180 leofs_module_nodename=G0@172.26.9.180 172.26.9.184 leofs_module_nodename=G0@172.26.9.184 [leofs_nodes:children] leo_manager_0 leo_manager_1 leo_gateway leo_storage</span></span></code> </pre> </div></div><br><h4 id="vyvod-leofs-adm-status" style=";text-align:right;direction:rtl">  Ø¥Ø®Ø±Ø§Ø¬ Ø­Ø§Ù„Ø© Leofs-adm </h4><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">Ø¥Ø®Ø±Ø§Ø¬ Ø­Ø§Ù„Ø© Leofs-adm</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"> [System Confiuration] -----------------------------------+---------- Item | Value -----------------------------------+---------- Basic/Consistency level -----------------------------------+---------- system version | 1.4.3 cluster Id | leofs_1 DC Id | dc_1 Total replicas | 2 number of successes of R | 1 number of successes of W | 1 number of successes of D | 1 number of rack-awareness replicas | 0 ring size | 2^128 -----------------------------------+---------- Multi DC replication settings -----------------------------------+---------- [mdcr] max number of joinable DCs | 2 [mdcr] total replicas per a DC | 1 [mdcr] number of successes of R | 1 [mdcr] number of successes of W | 1 [mdcr] number of successes of D | 1 -----------------------------------+---------- Manager RING <span class="hljs-built_in"><span class="hljs-built_in">hash</span></span> -----------------------------------+---------- current ring-hash | d8ff465e previous ring-hash | d8ff465e -----------------------------------+---------- [State of Node(s)] -------+----------------------+--------------+---------+----------------+----------------+---------------------------- <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> | node | state | rack id | current ring | prev ring | updated at -------+----------------------+--------------+---------+----------------+----------------+---------------------------- S | S0@172.26.9.178 | running | | d8ff465e | d8ff465e | 2019-12-06 05:18:29 +0000 S | S0@172.26.9.179 | running | | d8ff465e | d8ff465e | 2019-12-06 05:18:29 +0000 S | S0@172.26.9.181 | running | | d8ff465e | d8ff465e | 2019-12-06 05:18:30 +0000 S | S0@172.26.9.182 | running | | d8ff465e | d8ff465e | 2019-12-06 05:18:29 +0000 S | S0@172.26.9.183 | running | | d8ff465e | d8ff465e | 2019-12-06 05:18:29 +0000 S | S0@172.26.9.185 | running | | d8ff465e | d8ff465e | 2019-12-06 05:18:29 +0000 G | G0@172.26.9.180 | running | | d8ff465e | d8ff465e | 2019-12-06 05:18:31 +0000 G | G0@172.26.9.184 | running | | d8ff465e | d8ff465e | 2019-12-06 05:18:31 +0000 -------+----------------------+--------------+---------+----------------+----------------+----------------------------</code> </pre> </div></div><br><p style=";text-align:right;direction:rtl">  Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù‚Ø±Øµ ØŒ Ù…Ø¹ Ø§Ù„Ø£Ø®Ø° ÙÙŠ Ø§Ù„Ø§Ø¹ØªØ¨Ø§Ø± Ø£Ù† ÙƒÙ„ Ø¹Ù‚Ø¯Ø© ØªØ®Ø²ÙŠÙ† Ø¨Ù‡Ø§ Ù‚Ø±Øµ Ø³Ø¹Ø© 40 Ø¬ÙŠØ¬Ø§Ø¨Ø§ÙŠØª (6 Ø¹Ù‚Ø¯ ØªØ´ØºÙŠÙ„): </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">df -hP Filesystem Size Used Avail Use% Mounted on 172.26.9.184:/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>/05236/e7298032e78749149dd83a1e366afb328811c95b 120G 3.6G 117G 3% /mnt/leofs</code> </pre> <br><h4 id="esli-ispolzuetsya-5-nod-storage" style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… 5 Ø¹Ù‚Ø¯ Ø§Ù„ØªØ®Ø²ÙŠÙ† </h4><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">[leo_storage] 172.26.9.178 leofs_module_nodename=S0@172.26.9.178 172.26.9.179 leofs_module_nodename=S1@172.26.9.179 172.26.9.181 leofs_module_nodename=S2@172.26.9.181 172.26.9.182 leofs_module_nodename=S3@172.26.9.182 172.26.9.183 leofs_module_nodename=S4@172.26.9.183</code> </pre> <br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">df -hP 172.26.9.184:/<span class="hljs-built_in"><span class="hljs-built_in">test</span></span>/05236/e7298032e78749149dd83a1e366afb328811c95b 100G 3.0G 97G 3% /mnt/leofs</code> </pre> <br><h4 id="logi" style=";text-align:right;direction:rtl">  Ø§Ù„Ø³Ø¬Ù„Ø§Øª </h4><br><p style=";text-align:right;direction:rtl">  ØªÙˆØ¬Ø¯ Ø³Ø¬Ù„Ø§Øª ÙÙŠ Ø§Ù„Ø¯Ù„Ø§Ø¦Ù„ <code>/usr/local/leofs/current/*/log</code> </p><br><h4 id="esli-vy-budete-ustanavlivatnastraivat-leofs-vruchnuyu-to-vozmozhno-stolknetes-so-sleduyuschimi-oshibkami" style=";text-align:right;direction:rtl">  Ø¥Ø°Ø§ Ù‚Ù…Øª Ø¨ØªØ«Ø¨ÙŠØª / ØªÙ‡ÙŠØ¦Ø© Leofs ÙŠØ¯ÙˆÙŠÙ‹Ø§ ØŒ ÙÙ‚Ø¯ ØªÙˆØ§Ø¬Ù‡ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØªØ§Ù„ÙŠØ©. </h4><br><h5 id="error-mnesia-is-not-available" style=";text-align:right;direction:rtl">  [Ø®Ø·Ø£] Mnesia ØºÙŠØ± Ù…ØªÙˆÙØ± </h5><br><p style=";text-align:right;direction:rtl">  Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø®Ø¯Ù…Ø© systemctl Ø¨Ø¯Ø¡ leofs-manager-master </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm status [ERROR] Mnesia is not available</code> </pre> <br><p style=";text-align:right;direction:rtl">  ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¨Ø¯Ø¡ systemctl Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ leofs-manager-slave Ø¹Ù„Ù‰ leo_manager_1 </p><br><h5 id="ne-startuet-leofs-storage" style=";text-align:right;direction:rtl">  Leofs Ø§Ù„ØªØ®Ø²ÙŠÙ† Ù„Ø§ ÙŠØ¨Ø¯Ø£. </h5><br><p style=";text-align:right;direction:rtl">  Ù…Ù† Ø§Ù„Ø¶Ø±ÙˆØ±ÙŠ Ø£Ù† ØªØ¹Ù…Ù„ Ø­Ø§Ù„Ø© leofs-manager-master Ùˆ leofs-manager-slave Ùˆ leofs-adm Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø­Ø§Ù„Ø©. </p><br><h5 id="attached-nodes-less-than--of-replicas" style=";text-align:right;direction:rtl">  Ø§Ù„Ø¹Ù‚Ø¯ Ø§Ù„Ù…Ø±ÙÙ‚Ø© Ø£Ù‚Ù„ Ù…Ù† # Ù…Ù† Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ù…ØªÙ…Ø§Ø«Ù„Ø© </h5><br><p style=";text-align:right;direction:rtl">  Ø¹Ù†Ø¯ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ leofs-adm ØŒ ØªØ­ØµÙ„ Ø¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„Ø®Ø·Ø£: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm start [ERROR] Attached nodes less than <span class="hljs-comment"><span class="hljs-comment"># of replicas</span></span></code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù„Ø§ ÙŠÙƒÙÙŠ Ø¹Ù‚Ø¯ Ø§Ù„ØªØ®Ø²ÙŠÙ†.  Ø³ØªØ¸Ù‡Ø± Ù„Ùƒ Ø­Ø§Ù„Ø© leofs-adm Ø£Ù‚Ù„ Ù…Ù† Ø¹Ù‚Ø¯ØªÙŠ ØªØ®Ø²ÙŠÙ†.  Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù„Ø¹Ø¯Ø¯ Ø¹Ù‚Ø¯ Ø§Ù„ØªØ®Ø²ÙŠÙ† 2. </p><br><h5 id="leofs-adm-status-pokazyvaet-attached-ostalnye-running" style=";text-align:right;direction:rtl">  ØªØ¸Ù‡Ø± Ø­Ø§Ù„Ø© leofs-adm Ø§Ù„Ù…Ø±ÙÙ‚Ø© ØŒ ÙˆØ§Ù„Ø¨Ø§Ù‚ÙŠ Ù‚ÙŠØ¯ Ø§Ù„ØªØ´ØºÙŠÙ„. </h5><br><p style=";text-align:right;direction:rtl">  ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ§Ø²Ù† Ø§Ù„Ø¹Ù‚Ø¯ </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm rebalance</code> </pre> <br><h5 id="posle-starta-leofs-gateway-vy-ne-vidite-nodu-gateway-v-leofs-adm-status" style=";text-align:right;direction:rtl">  Ø¨Ø¹Ø¯ Ø¨Ø¯Ø¡ ØªØ´ØºÙŠÙ„ Ø¨ÙˆØ§Ø¨Ø© leofs ØŒ Ù„Ø§ ØªØ±Ù‰ Ø¹Ù‚Ø¯Ø© Gateway ÙÙŠ Ø­Ø§Ù„Ø© leofs-adm </h5><br><p style=";text-align:right;direction:rtl">  ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø¨Ø¯Ø¡ Ù„ÙˆÙØ³- adm </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">leofs-adm start</code> </pre> <br><h5 id="couldnt-connect-to-leofs-manager-na-slave-uzle" style=";text-align:right;direction:rtl">  Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ LeoFS Manager Ø¹Ù„Ù‰ Ø¹Ù‚Ø¯Ø© Slave </h5><br><p style=";text-align:right;direction:rtl">  (Ø¨Ø´ÙƒÙ„ Ø§ÙØªØ±Ø§Ø¶ÙŠ ØŒ Ù„Ø§ ÙŠØ¹Ù…Ù„ leofs-adm Ø¹Ù„Ù‰ Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø±Ù‚ÙŠÙ‚!) ( <a href="https://leo-project.net/leofs/docs/issues/documentation-issues/" rel="nofollow">Https://leo-project.net/leofs/docs/issues/documentation-issues/</a> ) </p><br><h3 id="nagruzochnoe-testirovanie" style=";text-align:right;direction:rtl">  Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø­Ù…Ù„ </h3><br><p style=";text-align:right;direction:rtl">  ÙŠØªÙ… Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙÙŠ Ø§Ù„Ø¹Ù‚Ø¯ØªÙŠÙ† Ù…Ø¹ Ø§Ù„ØªÙƒÙˆÙŠÙ†: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">CPU: Single Core Intel Core (Broadwell) (-MCP-) speed: 2295 MHz Kernel: 3.10.0-862.3.2.el7.x86_64 x86_64 Up: 1h 08m Mem: 1023.8/1999.6 MiB (51.2%) Storage: 10.00 GiB (43.5% used) Procs: 98 Shell: bash 4.2.46 inxi: 3.0.37</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± ØŒ Ø®Ø° Ù‚Ø±ØµÙ‹Ø§ ØµØºÙŠØ±Ù‹Ø§ <br>  Ø¹Ù„Ù‰ ÙƒÙ„Ø§ Ø§Ù„Ø¹Ù‚Ø¯ØªÙŠÙ† Ù†Ø±Ù‰ 9.4G Ùˆ 5.9 G Ù‚Ø±Øµ Ù…Ø³Ø§Ø­Ø© Ø­Ø±Ø©. </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">df -hP Filesystem Size Used Avail Use% Mounted on /dev/vda1 9.4G 5.9G 3.1G 66% /</code> </pre> <br><p style=";text-align:right;direction:rtl">  Ù‚Ù†Ø§Ø© Telegram: <a href="https://t.me/sds_ru" rel="nofollow">SDS Ùˆ Cluster FS</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar478990/">https://habr.com/ru/post/ar478990/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar478978/index.html">Azure SDK for .NET: Ù‚ØµØ© Ø¨Ø­Ø« Ø¹Ù† Ø®Ø·Ø£ ØµØ¹Ø¨</a></li>
<li><a href="../ar478980/index.html">Azure SDK for .NET: Ù‚ØµØ© Ø§Ù„Ø¨Ø§Ø­Ø« Ø¹Ù† Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØµØ¹Ø¨Ø©</a></li>
<li><a href="../ar478984/index.html">TimTam - Ù…Ø¯Ù„Ùƒ Ø§Ù„Ø¥ÙŠÙ‚Ø§Ø¹ Ù…Ù† Ø§Ù„Ø¬ÙŠÙ„ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù…Ø¹ ÙˆØ¸ÙŠÙØ© ØªØ³Ø®ÙŠÙ† Ø·Ø±Ù ÙØ±ÙŠØ¯Ø©</a></li>
<li><a href="../ar478986/index.html">Ø£Ø·Ù„Ù‚Øª ÙŠØ§Ù†Ø¯ÙƒØ³ ØªØµÙˆÙŠØª Ø´Ø¹Ø¨ÙŠ Ù„Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø±Ø¬Ø¹ÙŠØ©. Ø§Ù„Ù…ØªØ£Ù‡Ù„ÙˆÙ† Ø¥Ù„Ù‰ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ§Øª ÙÙŠ Ù…Ø¹Ø±ÙƒØ© Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ø±Ø¬Ø¹ÙŠØ© 2019</a></li>
<li><a href="../ar478988/index.html">Ø§Ù„Ø¨Ù†Ø¯Ù‚ÙŠØ©: Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø¨Ø±ÙŠ Ø¹Ù„Ù‰ Ø²ÙˆØ¬ Ù…Ù† Ø§Ù„ØµØ®ÙˆØ± Ø§Ù„Ø¹Ø§Ø±ÙŠØ©</a></li>
<li><a href="../ar478992/index.html">Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø®ÙˆÙ ÙˆÙØ±Ø­ Ø§Ù„Ø­ÙŠØ§Ø© ÙÙŠ ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</a></li>
<li><a href="../ar478994/index.html">ØªØ¹ØªØ²Ù… German Post Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ø£Ø¨Ø·Ø£ ÙˆØ§Ù„Ø±Ø§Ø­Ø© ÙŠÙˆÙ… Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</a></li>
<li><a href="../ar478996/index.html">Ø§Ù„Ø¹Ù…Ù„ Ù„ÙŠØ³ Ø°Ø¦Ø¨Ù‹Ø§ ØŒ Ø§Ù„Ø¬Ø²Ø¡ 4. Ø§Ù„Ù…ÙˆØ¸Ù Ø§Ù„Ù…ØªÙ…Ø±Ø³: ÙƒÙŠÙ Ù„Ø§ ÙŠØ­ØªØ±Ù‚ ÙˆÙ„Ø§ ÙŠØ³ØªØ³Ù„Ù…</a></li>
<li><a href="../ar478998/index.html">Ù„Ù…Ø§Ø°Ø§ Ù†Ø±ÙŠØ¯ Ø¯Ø§Ø¦Ù…Ø§ Ø£Ù† Ù†Ø±Ù‰ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©ØŸ ØªÙ…Øª Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªØ·ÙˆØ±ÙŠ (ØºÙŠØ± Ø§Ù„Ù†Ø§Ø¬Ø­) Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø´Ø¨ÙƒØ§Øª C ++ Ø§Ù„Ø¹ØµØ¨ÙŠØ©</a></li>
<li><a href="../ar479000/index.html">Ø§Ù„ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù…ØªÙˆØ§Ø²ÙŠ Ø¹Ù†Ø¯Ù…Ø§ ØªØ¨Ù„Øº Ù…Ù† Ø§Ù„Ø¹Ù…Ø± 14 Ø¹Ø§Ù…Ù‹Ø§</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>