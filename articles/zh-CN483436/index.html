<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ½â€âœˆï¸ ğŸ‘¸ğŸ» ğŸ™ğŸ¾ æ’­æ”¾â€œ osuï¼â€ï¼Œä½†è¯·æ³¨æ„é”™è¯¯ ğŸ§ğŸ» ğŸ“ª ğŸ‘©â€âš–ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å—¨ï¼Œå¤§å®¶éƒ½å¾ˆå–œæ¬¢å¼‚å›½å’Œæ™®é€šbugçš„æ”¶è—å®¶ï¼ ä»Šå¤©ï¼Œæˆ‘ä»¬çš„PVS-Studioæµ‹è¯•å°ä¸Šæœ‰ä¸€ä¸ªç½•è§çš„æ ‡æœ¬-ç”¨Cï¼ƒç¼–å†™çš„åä¸ºâ€œ osuï¼â€çš„æ¸¸æˆã€‚ åƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä»¬å°†å¯»æ‰¾é”™è¯¯ï¼Œå¯¹å…¶è¿›è¡Œåˆ†æå’Œæ’­æ”¾ã€‚ 

 æ¸¸æˆ 
 å¤§é¡»ï¼ æ˜¯ä¸€æ¬¾å¼€æºèŠ‚å¥æ¸¸æˆã€‚ æ ¹æ®è¯¥æ¸¸æˆçš„ç½‘ç«™ ï¼Œå®ƒéå¸¸å—æ¬¢è¿ï¼Œæ‹¥æœ‰è¶…è¿‡1500ä¸‡ç©å®¶å¸æˆ·ã€‚...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æ’­æ”¾â€œ osuï¼â€ï¼Œä½†è¯·æ³¨æ„é”™è¯¯</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/pvs-studio/blog/483436/"><p><img src="https://habrastorage.org/getpro/habr/post_images/3ac/9da/a12/3ac9daa12b519fc14e45f7f65abdd204.png" alt="å›¾ç‰‡1" align="left"></p><br> å—¨ï¼Œå¤§å®¶éƒ½å¾ˆå–œæ¬¢å¼‚å›½å’Œæ™®é€šbugçš„æ”¶è—å®¶ï¼ ä»Šå¤©ï¼Œæˆ‘ä»¬çš„PVS-Studioæµ‹è¯•å°ä¸Šæœ‰ä¸€ä¸ªç½•è§çš„æ ‡æœ¬-ç”¨Cï¼ƒç¼–å†™çš„åä¸ºâ€œ osuï¼â€çš„æ¸¸æˆã€‚ åƒå¾€å¸¸ä¸€æ ·ï¼Œæˆ‘ä»¬å°†å¯»æ‰¾é”™è¯¯ï¼Œå¯¹å…¶è¿›è¡Œåˆ†æå’Œæ’­æ”¾ã€‚ <br><a name="habracut"></a><br><h2> æ¸¸æˆ </h2><br> å¤§é¡»ï¼ æ˜¯ä¸€æ¬¾å¼€æºèŠ‚å¥æ¸¸æˆã€‚ æ ¹æ®è¯¥æ¸¸æˆçš„<a href="https://osu.ppy.sh/home">ç½‘ç«™</a> ï¼Œå®ƒéå¸¸å—æ¬¢è¿ï¼Œæ‹¥æœ‰è¶…è¿‡1500ä¸‡ç©å®¶å¸æˆ·ã€‚ è¯¥é¡¹ç›®å…·æœ‰å…è´¹çš„æ¸¸æˆç©æ³•ï¼Œè‰²å½©ç¼¤çº·çš„è®¾è®¡ï¼Œåœ°å›¾å®šåˆ¶ï¼Œå…ˆè¿›çš„åœ¨çº¿ç©å®¶æ’åç³»ç»Ÿï¼Œå¤šäººæ¸¸æˆæ¨¡å¼ä»¥åŠä¸°å¯Œçš„éŸ³ä¹ä½œå“ã€‚ æ²¡æœ‰å¿…è¦è¿›ä¸€æ­¥é˜è¿°æ¸¸æˆäº†ã€‚ æ‚¨å¯ä»¥åœ¨Internetä¸Šé˜…è¯»æœ‰å…³å®ƒçš„æ‰€æœ‰ä¿¡æ¯ã€‚  <a href="https://en.wikipedia.org/wiki/Osu!">ä»æ­¤é¡µé¢</a>å¼€å§‹ã€‚ <br><br> æˆ‘å¯¹é¡¹ç›®çš„æºä»£ç æ›´æ„Ÿå…´è¶£ï¼Œè¯¥æºä»£ç å¯åœ¨<a href="https://github.com/ppy/osu">GitHub</a>ä¸Š<a href="https://github.com/ppy/osu">æ‰¾åˆ°</a> ã€‚ ç«‹å³å¼•èµ·æ‚¨æ³¨æ„çš„ä¸€ä»¶äº‹æ˜¯ï¼Œå¤§é‡çš„å­˜å‚¨åº“æäº¤ï¼ˆè¶…è¿‡2ä¸‡4åƒæ¬¡ï¼‰ï¼Œè¿™è¡¨æ˜æ­£åœ¨æŒç»­è¿›è¡Œç´§å¼ çš„å¼€å‘ï¼ˆè¯¥æ¸¸æˆäº2007å¹´é¦–æ¬¡å‘å¸ƒï¼Œä½†å·¥ä½œå¿…é¡»æ›´æ—©å¼€å§‹ï¼‰ã€‚ ä½†æ˜¯ï¼Œè¯¥é¡¹ç›®å¹¶ä¸å¤§ï¼šåªæœ‰1813ä¸ª.csæ–‡ä»¶ï¼Œæ€»å…±æœ‰13.5ä¸‡ä¸ªéç©ºLOCã€‚ è¯¥æ•°å­—è¿˜åŒ…æ‹¬æµ‹è¯•ï¼Œè¿è¡Œæ£€æŸ¥æ—¶é€šå¸¸ä¸ä¼šè€ƒè™‘è¿™äº›æµ‹è¯•ã€‚ æµ‹è¯•ç»„æˆäº†306ä¸ª.csæ–‡ä»¶ï¼Œå…·æœ‰2.5ä¸‡ä¸ªLOCã€‚ è¯¥é¡¹ç›®ç¡®å®å¾ˆå°ï¼šä¾‹å¦‚ï¼ŒPVS-Studioçš„Cï¼ƒå†…æ ¸å¤§çº¦æœ‰30ä¸‡ä¸ªLOCã€‚ <br><br> é™¤å»æµ‹è¯•æ–‡ä»¶ï¼Œæˆ‘æ£€æŸ¥äº†1105ä¸ªLOCé•¿çš„1507ä¸ªæ–‡ä»¶ã€‚ æ£€æŸ¥ç¡®å®å‘ç°äº†ä¸€äº›æœ‰è¶£çš„é”™è¯¯ï¼Œæˆ‘æ„¿æ„å‘æ‚¨å±•ç¤ºã€‚ <br><br><h2> è™«å­ </h2><br>  <a href="https://www.viva64.com/en/w/v3001/">V3001</a>åœ¨'||'çš„å·¦ä¾§å’Œå³ä¾§æœ‰ç›¸åŒçš„å­è¡¨è¾¾å¼'result == HitResult.Perfect' æ“ä½œå‘˜ã€‚  DrawableHoldNote.cs 266 <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CheckForResult</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... ApplyResult(r =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (holdNote.hasBroken &amp;&amp; (result == HitResult.Perfect || result == HitResult.Perfect)) result = HitResult.Good; .... }); }</code> </pre> <br> è¿™æ˜¯é¢å‘å¤åˆ¶ç²˜è´´ç¼–ç¨‹çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œè¿™æ˜¯æˆ‘çš„åŒäº‹Valâ€‹â€‹eriy Komarovæœ€è¿‘åœ¨ä»–çš„æ–‡ç« â€œ <a href="https://www.viva64.com/en/b/0699/">2019å¹´åœ¨Javaé¡¹ç›®ä¸­å‘ç°çš„åå¤§é”™è¯¯</a> â€ä¸­ä½¿ç”¨çš„ä¸€ä¸ªå¹½é»˜æœ¯è¯­ã€‚ <br><br> æ— è®ºå¦‚ä½•ï¼Œè¿ç»­æ‰§è¡Œä¸¤ä¸ªç›¸åŒçš„æ£€æŸ¥ã€‚ å…¶ä¸­ä¹‹ä¸€å¯èƒ½æ˜¯è¦æ£€æŸ¥<i>HitResult</i>æšä¸¾çš„å…¶ä»–å¸¸é‡ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> HitResult { None, Miss, Meh, Ok, Good, Great, Perfect, }</code> </pre> <br> åº”è¯¥æ£€æŸ¥å“ªä¸ªå¸¸æ•°ï¼Ÿ ä¹Ÿè®¸ç¬¬äºŒå¼ æ”¯ç¥¨æ ¹æœ¬ä¸å­˜åœ¨ï¼Ÿ è¿™äº›æ˜¯åªæœ‰ä½œè€…æ‰èƒ½å›ç­”çš„é—®é¢˜ã€‚ æ— è®ºå¦‚ä½•ï¼Œè¿™æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œä¼šæ‰­æ›²ç¨‹åºçš„æ‰§è¡Œé€»è¾‘ã€‚ <br><br>  <a href="https://www.viva64.com/en/w/v3001/">V3001</a>åœ¨'&amp;&amp;'è¿ç®—ç¬¦çš„å·¦ä¾§å’Œå³ä¾§æœ‰ç›¸åŒçš„å­è¡¨è¾¾å¼'familyï¼= GetFamilyStringï¼ˆTournamentTypeface.Aquaticoï¼‰'ã€‚  TournamentFont.cs 64 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetWeightString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> family, FontWeight weight</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (weight == FontWeight.Regular &amp;&amp; family != GetFamilyString(TournamentTypeface.Aquatico) &amp;&amp; family != GetFamilyString(TournamentTypeface.Aquatico)) weightString = <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>.Empty; .... }</code> </pre> <br> å†æ¬¡å¤åˆ¶ç²˜è´´ã€‚ æˆ‘é‡æ„äº†ä»£ç ï¼Œå› æ­¤ç°åœ¨å¾ˆå®¹æ˜“æ³¨æ„åˆ°è¯¥é”™è¯¯ï¼Œä½†æœ€åˆå®ƒæ˜¯ç”¨ä¸€è¡Œç¼–å†™çš„ã€‚ å°±åƒåœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ä¸€æ ·ï¼Œæˆ‘æ— æ³•ç¡®å®šåº”è¯¥å¦‚ä½•ç²¾ç¡®åœ°è§£å†³æ­¤é—®é¢˜ã€‚  <i>TournamentTypeface</i>æšä¸¾ä»…åŒ…å«ä¸€ä¸ªå¸¸æ•°ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> TournamentTypeface { Aquatico }</code> </pre> <br> ä¹Ÿè®¸é”™è¯¯æ˜¯å…³äºä¸¤æ¬¡æ£€æŸ¥<i>å®¶åº­</i>å˜é‡çš„ï¼Œä½†æˆ‘å¯èƒ½æ˜¯é”™çš„ã€‚ <br><br>  <a href="https://www.viva64.com/en/w/v3009/">V3009</a> [CWE-393]å¥‡æ€ªçš„æ˜¯ï¼Œæ­¤æ–¹æ³•å§‹ç»ˆè¿”å›ä¸€ä¸ªç›¸åŒçš„'false'å€¼ã€‚  KeyCounterAction.cs 19 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnPressed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">T action, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> forwards</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!EqualityComparer&lt;T&gt;.Default.Equals(action, Action)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; IsLit = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (forwards) Increment(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; }</code> </pre> <br> æ¯æ¬¡æ­¤æ–¹æ³•è¿”å›<i>false</i> ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘é€šå¸¸ä¼šæ£€æŸ¥å‡½æ•°è°ƒç”¨ï¼Œå› ä¸ºæ‚¨å¯èƒ½ç»å¸¸å‘ç°è°ƒç”¨è€…æœªä½¿ç”¨è¿”å›å€¼ï¼Œè¿™æ„å‘³ç€æ²¡æœ‰é—®é¢˜ï¼ˆé™¤äº†ä¸è‰¯æ ·å¼ï¼‰ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‘¼å«å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnPressed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">T action</span></span></span><span class="hljs-function">)</span></span> =&gt; Target.Children .OfType&lt;KeyCounterAction&lt;T&gt;&gt;() .Any(c =&gt; c.OnPressed(action, Clock.Rate &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>));</code> </pre> <br> å¦‚æ‚¨æ‰€è§ï¼Œè°ƒç”¨è€…ç¡®å®ä½¿ç”¨äº†<i>OnPressed</i>æ–¹æ³•è¿”å›çš„å€¼ã€‚ ç”±äºè¯¥å€¼å§‹ç»ˆä¸º<i>false</i> ï¼Œå› æ­¤è°ƒç”¨è€…æœ¬èº«ä¹Ÿæ€»æ˜¯è¿”å›<i>false</i> ã€‚ æ­¤ä»£ç å¾ˆå¯èƒ½åŒ…å«é”™è¯¯ï¼Œåº”è¿›è¡Œä¿®è®¢ã€‚ <br><br> å¦ä¸€ä¸ªç±»ä¼¼çš„é”™è¯¯ï¼š <br><br><ul><li>  V3009 [CWE-393]å¥‡æ€ªçš„æ˜¯ï¼Œæ­¤æ–¹æ³•å§‹ç»ˆè¿”å›ä¸€ä¸ªç›¸åŒçš„'false'å€¼ã€‚  KeyCounterAction.cs 30 </li></ul><br>  <a href="https://www.viva64.com/en/w/v3042/">V3042</a> [CWE-476]å¯èƒ½ä¸ºNullReferenceExceptionã€‚  'ï¼Ÿã€‚' å’Œâ€œã€‚â€ è¿ç®—ç¬¦ç”¨äºè®¿é—®â€œ val.NewValueâ€å¯¹è±¡TournamentTeam.csçš„æˆå‘˜41 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TournamentTeam</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { Acronym.ValueChanged += val =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (....) FlagName.Value = val.NewValue.Length &gt;= <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-comment"><span class="hljs-comment">// &lt;= ? val.NewValue?.Substring(0, 2).ToUpper() : string.Empty; }; .... }</span></span></code> </pre> <br> åœ¨<i>ï¼Ÿï¼š</i>è¿ç®—ç¬¦çš„æƒ…å†µä¸‹ï¼Œä»¥å±é™©çš„æ–¹å¼å¤„ç†<i>val.NewValue</i>å˜é‡ã€‚ ä½¿åˆ†æå™¨å¦‚æ­¤è®¤ä¸ºçš„äº‹å®æ˜¯ï¼Œåœ¨<i>éšåçš„then</i>åˆ†æ”¯ä¸­ï¼Œä½¿ç”¨æ¡ä»¶è®¿é—®è¿ç®—ç¬¦<i>val.NewValueï¼Ÿ.Substringï¼ˆ....ï¼‰</i>ä»¥å®‰å…¨çš„æ–¹å¼å¤„ç†äº†ç›¸åŒçš„å˜é‡ã€‚ <br><br> å¦ä¸€ä¸ªç±»ä¼¼çš„é”™è¯¯ï¼š <br><br><ul><li>  V3042 [CWE-476]å¯èƒ½ä¸ºNullReferenceExceptionã€‚  'ï¼Ÿã€‚' å’Œâ€œã€‚â€ è¿ç®—ç¬¦ç”¨äºè®¿é—®â€œ val.NewValueâ€å¯¹è±¡TournamentTeam.csçš„æˆå‘˜48 </li></ul><br>  <a href="https://www.viva64.com/en/w/v3042/">V3042</a> [CWE-476]å¯èƒ½ä¸ºNullReferenceExceptionã€‚  'ï¼Ÿã€‚' å’Œâ€œã€‚â€ è¿ç®—ç¬¦ç”¨äºè®¿é—®â€œ apiâ€å¯¹è±¡SetupScreen.csçš„æˆå‘˜77 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reload</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActionableInfo { Label = <span class="hljs-string"><span class="hljs-string">"Current User"</span></span>, ButtonText = <span class="hljs-string"><span class="hljs-string">"Change Login"</span></span>, Action = () =&gt; { api.Logout(); <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }, Value = api?.LocalUser.Value.Username, .... }, .... } private class ActionableInfo : LabelledDrawable&lt;Drawable&gt; { .... public Action Action; .... }</span></span></code> </pre> <br> è¿™ä¸ªæ¯”è¾ƒä¸æ˜ç¡®ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡è¿™ä¹Ÿæ˜¯ä¸€ä¸ªé”™è¯¯ã€‚ ç¨‹åºå‘˜åˆ›å»ºä¸€ä¸ª<i>ActionableInfo</i>ç±»å‹çš„å¯¹è±¡ã€‚ ä½¿ç”¨lambdaå‡½æ•°åˆå§‹åŒ–<i>Action</i>å­—æ®µï¼Œè¯¥å‡½æ•°ä»¥å±é™©çš„æ–¹å¼å¤„ç†å¯èƒ½ä¸ºç©ºçš„å¼•ç”¨<i>api</i> ã€‚ åˆ†æå™¨è®¤ä¸ºæ­¤æ¨¡å¼æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºåœ¨åˆå§‹åŒ–<i>Value</i>å‚æ•°æ—¶ï¼Œä»¥åä¼šä»¥å®‰å…¨çš„æ–¹å¼å¤„ç†<i>api</i>å˜é‡ã€‚ æˆ‘ä¹‹æ‰€ä»¥ç§°è¿™ç§æƒ…å†µä¸ºæ¨¡æ£±ä¸¤å¯ï¼Œæ˜¯å› ä¸ºlambdaå‡½æ•°ä¸­çš„ä»£ç æš—å«äº†æ‰§è¡Œå»¶è¿Ÿï¼Œæ­¤æ—¶å¼€å‘äººå‘˜å¯èƒ½ä¼šä»¥æŸç§æ–¹å¼ä¿è¯<i>api</i>å¼•ç”¨ä¸ºénullã€‚ ä½†æ˜¯æˆ‘ä¸ç¡®å®šï¼Œå› ä¸ºlambdaå‡½æ•°çš„ä¸»ä½“ä¼¼ä¹æœªä½¿ç”¨ä»»ä½•å®‰å…¨çš„å¼•ç”¨å¤„ç†ï¼Œä¾‹å¦‚å…ˆå‰çš„æ£€æŸ¥ã€‚ <br><br>  <a href="https://www.viva64.com/en/w/v3066/">V3066</a> [CWE-683]ä¼ é€’ç»™â€œ Atan2â€æ–¹æ³•çš„å‚æ•°çš„å¯èƒ½é”™è¯¯é¡ºåºï¼šâ€œ diff.Xâ€å’Œâ€œ diff.Yâ€ã€‚  SliderBall.cs 182 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateProgress</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">double</span></span></span></span><span class="hljs-function"><span class="hljs-params"> completionProgress</span></span></span><span class="hljs-function">)</span></span> { .... Rotation = <span class="hljs-number"><span class="hljs-number">-90</span></span> + (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)(-Math.Atan2(diff.X, diff.Y) * <span class="hljs-number"><span class="hljs-number">180</span></span> / Math.PI); .... }</code> </pre> <br> åˆ†æå™¨æ€€ç–‘<i>Atan2</i>æ–¹æ³•çš„å‚æ•°ä»¥é”™è¯¯çš„é¡ºåºä¼ é€’ã€‚ è¿™æ˜¯æ–¹æ³•çš„å£°æ˜ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// Parameters: // y: // The y coordinate of a point. // // x: // The x coordinate of a point. public static double Atan2(double y, double x);</span></span></code> </pre> <br> å€¼ä»¥ç›¸åçš„é¡ºåºä¼ é€’ã€‚ æˆ‘ä¸ç¡®å®šè¿™æ˜¯å¦æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œå› ä¸º<i>UpdateProgress</i>æ–¹æ³•åŒ…å«å¾ˆå¤šéå¹³å‡¡çš„è®¡ç®—ï¼› æˆ‘åªæ˜¯å°†å…¶æåŠä¸ºå¯èƒ½çš„é”™è¯¯ã€‚ <br><br>  <a href="https://www.viva64.com/en/w/v3080/">V3080</a> [CWE-476]å¯èƒ½çš„ç©ºè§£é™¤å¼•ç”¨ã€‚ è€ƒè™‘æ£€æŸ¥â€œ Beatmapâ€ã€‚  WorkingBeatmap.cs 57 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> Track </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetVirtualTrack</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastObject = Beatmap.HitObjects.LastOrDefault(); .... }</code> </pre> <br> åˆ†æå™¨æŒ‡å‡º<i>Beatmap</i>å¯èƒ½ä¼šå–æ¶ˆå¼•ç”¨ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> IBeatmap Beatmap { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> LoadBeatmapAsync().Result; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (TaskCanceledException) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span>; } } }</code> </pre> <br> å¥½å§ï¼Œåˆ†æä»ªæ˜¯æ­£ç¡®çš„ã€‚ <br><br> è¦äº†è§£æœ‰å…³PVS-Studioå¦‚ä½•æ£€æµ‹åˆ°æ­¤ç±»é”™è¯¯çš„æ›´å¤šä¿¡æ¯ï¼Œä»¥åŠæœ‰å…³Cï¼ƒ8.0ä¸­æ·»åŠ çš„ä¸å¤„ç†å¯èƒ½ä¸ºç©ºçš„å¼•ç”¨æœ‰å…³çš„æ–°åŠŸèƒ½çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æ–‡ç« â€œ <a href="https://www.viva64.com/en/b/0631/">Cï¼ƒ8.0ä¸­çš„å¯ç©ºå¼•ç”¨ç±»å‹å’Œé™æ€åˆ†æ</a> â€ã€‚ <br><br>  <a href="https://www.viva64.com/en/w/v3083/">V3083</a> [CWE-367]äº‹ä»¶'ObjectConverted'çš„ä¸å®‰å…¨è°ƒç”¨ï¼Œå¯èƒ½ä¼šå‘ç”ŸNullReferenceExceptionã€‚ è¯·è€ƒè™‘åœ¨è°ƒç”¨äº‹ä»¶ä¹‹å‰å°†äº‹ä»¶åˆ†é…ç»™å±€éƒ¨å˜é‡ã€‚  BeatmapConverter.cs 82 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> List&lt;T&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convertHitObjects</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ObjectConverted != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { converted = converted.ToList(); ObjectConverted.Invoke(obj, converted); } .... }</code> </pre> <br> è¿™æ˜¯æ¬¡è¦ä¸”ç›¸å½“å¸¸è§çš„é”™è¯¯ã€‚ è®¢æˆ·å¯èƒ½ä¼šå–æ¶ˆè®¢é˜…åœ¨ç©ºæ£€æŸ¥å’Œäº‹ä»¶è°ƒç”¨ä¹‹é—´çš„äº‹ä»¶ï¼Œä»è€Œå¯¼è‡´å´©æºƒã€‚ è¿™æ˜¯ä¿®å¤è¯¥é”™è¯¯çš„ä¸€ç§æ–¹æ³•ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> List&lt;T&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convertHitObjects</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... converted = converted.ToList(); ObjectConverted?.Invoke(obj, converted); .... }</code> </pre> <br>  <a href="https://www.viva64.com/en/w/v3095/">V3095</a> [CWE-476]åœ¨éªŒè¯æ˜¯å¦ä¸ºnullä¹‹å‰ï¼Œå·²ä½¿ç”¨â€œåˆ—â€å¯¹è±¡ã€‚ æ£€æŸ¥çº¿ï¼š141ï¼Œ142ã€‚SquareGraph.cs 141 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">redrawProgress</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; ColumnCount; i++) columns[i].State = i &lt;= progress ? ColumnState.Lit : ColumnState.Dimmed; columns?.ForceRedraw(); }</code> </pre> <br>  <i>åˆ—</i>é›†åˆä¸Šçš„è¿­ä»£ä»¥å±é™©çš„æ–¹å¼è¿›è¡Œã€‚ å¼€å‘äººå‘˜å‡å®š<i>åˆ—</i>å¼•ç”¨å¯ä»¥ä¸ºç©ºï¼Œè¿™é€šè¿‡ä½¿ç”¨æ¡ä»¶è®¿é—®è¿ç®—ç¬¦æ¥è¿›ä¸€æ­¥è®¿é—®ä»£ç ä¸­çš„é›†åˆæ¥æŒ‡ç¤ºã€‚ <br><br>  <a href="https://www.viva64.com/en/w/v3119/">V3119</a>è°ƒç”¨é‡å†™çš„äº‹ä»¶'OnNewResult'å¯èƒ½å¯¼è‡´ä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚ è€ƒè™‘æ˜¾å¼å®ç°äº‹ä»¶è®¿é—®å™¨æˆ–ä½¿ç”¨â€œ sealedâ€å…³é”®å­—ã€‚  DrawableRuleset.cs 256 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addHitObject</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">TObject hitObject</span></span></span><span class="hljs-function">)</span></span> { .... drawableObject.OnNewResult += (_, r) =&gt; OnNewResult?.Invoke(r); .... } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">event</span></span> Action&lt;JudgementResult&gt; OnNewResult;</code> </pre> <br> åˆ†æä»ªè¯´ä½¿ç”¨è¦†ç›–äº‹ä»¶æˆ–è™šæ‹Ÿäº‹ä»¶å¾ˆå±é™©ã€‚ è¯·å‚é˜…è¯Šæ–­<a href="https://www.viva64.com/en/w/v3119/">è¯´æ˜</a>ä»¥è·å–è§£é‡Šã€‚ æˆ‘è¿˜å†™äº†ä¸€ç¯‡æœ‰å…³è¯¥ä¸»é¢˜çš„æ–‡ç« ï¼šâ€œ <a href="https://www.viva64.com/en/b/0453/">Cï¼ƒä¸­çš„è™šæ‹Ÿäº‹ä»¶ï¼šå‡ºäº†ç‚¹é—®é¢˜</a> â€ã€‚ <br><br> è¿™æ˜¯å¦ä¸€ä¸ªç±»ä¼¼çš„ä¸å®‰å…¨æ„é€ ï¼š <br><br><ul><li>  V3119è°ƒç”¨é‡å†™çš„äº‹ä»¶å¯èƒ½å¯¼è‡´ä¸å¯é¢„æµ‹çš„è¡Œä¸ºã€‚ è€ƒè™‘æ˜¾å¼å®ç°äº‹ä»¶è®¿é—®å™¨æˆ–ä½¿ç”¨â€œ sealedâ€å…³é”®å­—ã€‚  DrawableRuleset.cs 257 </li></ul><br>  <a href="https://www.viva64.com/en/w/v3123/">V3123</a> [CWE-783]ä¹Ÿè®¸æ˜¯â€œ ??â€ æ“ä½œå‘˜çš„å·¥ä½œæ–¹å¼ä¸é¢„æœŸä¸åŒã€‚ å®ƒçš„ä¼˜å…ˆçº§ä½äºå…¶å·¦ä¾§çš„å…¶ä»–è¿è¥å•†çš„ä¼˜å…ˆçº§ã€‚  OsuScreenStack.cs 45 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onScreenChange</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IScreen prev, IScreen next</span></span></span><span class="hljs-function">)</span></span> { parallaxContainer.ParallaxAmount = ParallaxContainer.DEFAULT_PARALLAX_AMOUNT * ((IOsuScreen)next)?.BackgroundParallaxAmount ?? <span class="hljs-number"><span class="hljs-number">1.0f</span></span>; }</code> </pre> <br> ä¸ºäº†æ›´å¥½åœ°ç†è§£ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç»¼åˆç¤ºä¾‹ï¼Œæ¼”ç¤ºäº†æ­¤ä»£ç çš„åŸå§‹é€»è¾‘ï¼š <br><br><pre> <code class="cs hljs">x = (c * a) ?? b;</code> </pre> <br> è¯¥é”™è¯¯æºäºä»¥ä¸‹äº‹å®ï¼šâ€œ *â€è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§é«˜äºâ€œ ??â€çš„ä¼˜å…ˆçº§ æ“ä½œå‘˜ã€‚ å›ºå®šä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼ˆæ·»åŠ äº†æ‹¬å·ï¼‰ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onScreenChange</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IScreen prev, IScreen next</span></span></span><span class="hljs-function">)</span></span> { parallaxContainer.ParallaxAmount = ParallaxContainer.DEFAULT_PARALLAX_AMOUNT * (((IOsuScreen)next)?.BackgroundParallaxAmount ?? <span class="hljs-number"><span class="hljs-number">1.0f</span></span>); }</code> </pre> <br> å¦ä¸€ä¸ªç±»ä¼¼çš„é”™è¯¯ï¼š <br><br>  <a href="https://www.viva64.com/en/w/v3123/">V3123</a> [CWE-783]ä¹Ÿè®¸æ˜¯â€œ ??â€ æ“ä½œå‘˜çš„å·¥ä½œæ–¹å¼ä¸é¢„æœŸä¸åŒã€‚ å®ƒçš„ä¼˜å…ˆçº§ä½äºå…¶å·¦ä¾§çš„å…¶ä»–è¿è¥å•†çš„ä¼˜å…ˆçº§ã€‚  FramedReplayInputHandler.cs 103 <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> inImportantSection { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> IsImportant(frame) &amp;&amp; Math.Abs(CurrentTime - NextFrame?.Time ?? <span class="hljs-number"><span class="hljs-number">0</span></span>) &lt;= AllowedImportantTimeSpan; } }</code> </pre> <br> ä¸å‰é¢çš„æƒ…å†µä¸€æ ·ï¼Œç¨‹åºå‘˜å¯¹è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§æœ‰é”™è¯¯çš„å‡è®¾ã€‚ ä¼ é€’ç»™<i>Math.Abs</i>æ–¹æ³•çš„åŸå§‹è¡¨è¾¾å¼çš„è¯„ä¼°å¦‚ä¸‹ï¼š <br><br><pre> <code class="cs hljs">(a â€“ b) ?? <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br> å›ºå®šæ–¹æ³•å¦‚ä¸‹ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> inImportantSection { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> IsImportant(frame) &amp;&amp; Math.Abs(CurrentTime â€“ (NextFrame?.Time ?? <span class="hljs-number"><span class="hljs-number">0</span></span>)) &lt;= AllowedImportantTimeSpan; } }</code> </pre> <br>  <a href="https://www.viva64.com/en/w/v3142/">V3142</a> [CWE-561]æœªæ£€æµ‹åˆ°ä»£ç ã€‚ å¯èƒ½å­˜åœ¨é”™è¯¯ã€‚  DrawableHoldNote.cs 214 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnPressed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ManiaAction action</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">base</span></span>.OnPressed(action)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Result.Type == HitResult.Miss) <span class="hljs-comment"><span class="hljs-comment">// &lt;= holdNote.hasBroken = true; .... }</span></span></code> </pre> <br> åˆ†æå™¨è®¤ä¸ºï¼Œä»ç¬¬äºŒä¸ª<i>if</i>è¯­å¥å¼€å§‹ï¼Œ <i>OnPressed</i>å¤„ç†ç¨‹åºçš„ä»£ç ä¸å¯è®¿é—®ã€‚ è¿™æ˜¯å› ä¸ºç¬¬ä¸€ä¸ªæ¡ä»¶å§‹ç»ˆä¸ºtrueï¼Œå³<i>base.OnPressed</i>æ–¹æ³•å°†å§‹ç»ˆè¿”å›<i>false</i> ã€‚ è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹<i>base.OnPressed</i>æ–¹æ³•ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnPressed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">ManiaAction action</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (action != Action.Value) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> UpdateResult(<span class="hljs-literal"><span class="hljs-literal">true</span></span>); }</code> </pre> <br> ç°åœ¨åœ¨<i>UpdateResult</i>æ–¹æ³•ä¸­ï¼š <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateResult</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">bool</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userTriggered</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Time.Elapsed &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Judged) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Judged; }</code> </pre> <br> è¯·æ³¨æ„ï¼Œæ­¤å¤„çš„<i>Judged</i>å±æ€§çš„å®ç°æ— å…³ç´§è¦ï¼Œå› ä¸º<i>UpdateResult</i>æ–¹æ³•çš„é€»è¾‘æ„å‘³ç€æœ€åçš„<i>return</i>è¯­å¥ç­‰æ•ˆäºä»¥ä¸‹å†…å®¹ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>;</code> </pre> <br> è¿™æ„å‘³ç€<i>UpdateResult</i>æ–¹æ³•å°†ä¸€ç›´è¿”å›<i>false</i> ï¼Œä»è€Œå¯¼è‡´å †æ ˆä¸­è¾ƒæ—©çš„ä»£ç æ— æ³•åˆ°è¾¾ã€‚ <br><br>  <a href="https://www.viva64.com/en/w/v3146/">V3146</a> [CWE-476]å¯èƒ½å¯¹'è§„åˆ™é›†'è¿›è¡Œç©ºå¼•ç”¨ã€‚  â€œ FirstOrDefaultâ€å¯ä»¥è¿”å›é»˜è®¤çš„ç©ºå€¼ã€‚  APILegacyScoreInfo.cs 24 <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> ScoreInfo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateScoreInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">RulesetStore rulesets</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ruleset = rulesets.GetRuleset(OnlineRulesetID); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> mods = Mods != <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? ruleset.CreateInstance() <span class="hljs-comment"><span class="hljs-comment">// &lt;= .GetAllMods().Where(....) .ToArray() : Array.Empty&lt;Mod&gt;(); .... }</span></span></code> </pre> <br> åˆ†æå™¨è®¤ä¸º<i>ruleset.CreateInstanceï¼ˆï¼‰</i>è°ƒç”¨ä¸å®‰å…¨ã€‚ åœ¨æ­¤è°ƒç”¨ä¹‹å‰ï¼Œç”±äºè°ƒç”¨<i>GetRuleset</i>æ–¹æ³•è€Œä¸º<i>è§„åˆ™é›†</i>å˜é‡åˆ†é…äº†ä¸€ä¸ªå€¼ï¼š <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> RulesetInfo </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetRuleset</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> id</span></span></span><span class="hljs-function">)</span></span> =&gt; AvailableRulesets.FirstOrDefault(....);</code> </pre> <br> å¦‚æ‚¨æ‰€è§ï¼Œè­¦å‘Šæ˜¯æœ‰æ•ˆçš„ï¼Œå› ä¸ºè°ƒç”¨åºåˆ—åŒ…æ‹¬<i>FirstOrDefault</i>æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥è¿”å›<i>null</i> ã€‚ <br><br><h2> ç»“è®º </h2><br>  â€œ osuï¼â€ä»£ç ä¸­æ²¡æœ‰å¾ˆå¤šé”™è¯¯ï¼Œè¿™å¾ˆå¥½ã€‚ ä½†æ˜¯æˆ‘ä»ç„¶å»ºè®®ä½œè€…æ£€æŸ¥åˆ†æä»ªæŠ¥å‘Šçš„é—®é¢˜ã€‚ æˆ‘å¸Œæœ›è¿™å°†æœ‰åŠ©äºä¿æŒé«˜è´¨é‡ï¼Œå¹¶ä¸”æ¸¸æˆå°†ç»§ç»­ä¸ºç©å®¶å¸¦æ¥æ¬¢ä¹ã€‚ <br><br> æé†’ä¸€ä¸‹ï¼Œå¦‚æœæ‚¨å–œæ¬¢ä¿®æ”¹æºä»£ç ï¼ŒPVS-Studioæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ è¯¥åˆ†æä»ªå¯åœ¨å®˜æ–¹ç½‘ç«™ä¸Š<a href="https://www.viva64.com/en/pvs-studio-download/">ä¸‹è½½</a> ã€‚ æˆ‘è¿˜è¦è®°ä½çš„å¦ä¸€ä»¶äº‹æ˜¯ï¼Œåƒè¿™æ ·çš„ä¸€æ¬¡æ€§æ£€æŸ¥ä¸å®é™…å¼€å‘è¿‡ç¨‹ä¸­é™æ€åˆ†æçš„æ­£å¸¸ä½¿ç”¨æ— å…³ã€‚ åªæœ‰åœ¨æ„å»ºæœåŠ¡å™¨å’Œå¼€å‘äººå‘˜çš„è®¡ç®—æœºä¸Šå®šæœŸä½¿ç”¨æ­¤æ–¹æ³•æ—¶æ‰æœ€æœ‰æ•ˆï¼ˆè¿™ç§°ä¸ºå¢é‡åˆ†æï¼‰ã€‚ æ‚¨çš„æœ€ç»ˆç›®æ ‡æ˜¯åœ¨ç¼–ç é˜¶æ®µæ•è·é”™è¯¯ï¼Œä»¥é˜²æ­¢é”™è¯¯è¿›å…¥ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿã€‚ <br><br> ç¥ä½ å¥½è¿ï¼Œå¹¶ä¿æŒåˆ›é€ åŠ›ï¼ <br><br><h2> å‚è€ƒæ–‡çŒ® </h2><br> è¿™æ˜¯æˆ‘ä»¬åœ¨2020å¹´å‘è¡¨çš„ç¬¬ä¸€ç¯‡æ–‡ç« ã€‚åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼Œè¿™æ˜¯è¿‡å»ä¸€å¹´ä¸­å¯¹Cï¼ƒé¡¹ç›®è¿›è¡Œæ£€æŸ¥çš„é“¾æ¥ï¼š <br><br><ul><li>  <a href="https://www.viva64.com/en/b/0605/">åœ¨.NETçš„Amazon Web Services SDKæºä»£ç ä¸­æœç´¢é”™è¯¯</a> </li><li>  <a href="https://www.viva64.com/en/b/0622/">æ£€æŸ¥Roslynæºä»£ç </a> </li><li>  <a href="https://www.viva64.com/en/b/0631/">Cï¼ƒ8.0ä¸­çš„å¯ç©ºå¼•ç”¨ç±»å‹å’Œé™æ€åˆ†æ</a> </li><li>  <a href="https://www.viva64.com/en/b/0653/">WinFormsï¼šé”™è¯¯ï¼Œç¦å°”æ‘©æ–¯</a> </li><li>  <a href="https://www.viva64.com/en/b/0654/">æœ‰å…³PVS-Studioå¦‚ä½•åœ¨... PVS-Studioä¸­ä½¿ç”¨çš„åº“ä¸­å‘ç°é”™è¯¯çš„æ•…äº‹</a> </li><li>  <a href="https://www.viva64.com/en/b/0656/">é€šè¿‡PVS-Studioé™æ€åˆ†æå™¨æ£€æŸ¥.NET Coreåº“æºä»£ç </a> </li><li>  <a href="https://www.viva64.com/en/b/0664/">ç½—æ–¯æ—åˆ†æä»ªæ£€æŸ¥</a> </li><li>  <a href="https://www.viva64.com/en/b/0677/">æ£€æŸ¥Telerik UIä»¥ä½¿ç”¨UWPä½œä¸ºPVS-Studioçš„å…¥é—¨æ–¹æ³•</a> </li><li>  <a href="https://www.viva64.com/en/b/0678/">Azure PowerShellï¼šå¤§éƒ¨åˆ†æ— å®³</a> </li><li>  <a href="https://www.viva64.com/en/b/0681/">æ‰«æOrchard CMSçš„ä»£ç ä»¥æŸ¥æ‰¾é”™è¯¯</a> </li><li>  <a href="https://www.viva64.com/en/b/0683/">ä½¿ç”¨PVS-Studioæ£€æŸ¥OpenCvçš„OpenCvSharpåŒ…è£…</a> </li><li>  <a href="https://www.viva64.com/en/b/0692/">.NETçš„Azure SDKï¼šå…³äºå›°éš¾é”™è¯¯æœç´¢çš„æ•…äº‹</a> </li><li>  <a href="https://www.viva64.com/en/b/0694/">SARIF SDKåŠå…¶é”™è¯¯</a> </li><li>  <a href="https://www.viva64.com/en/b/0698/">2019å¹´Cï¼ƒé¡¹ç›®ä¸­å‘ç°çš„åå¤§bug</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN483436/">https://habr.com/ru/post/zh-CN483436/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN483416/index.html">å°è¯•ä½¿ç”¨Powershellè‡ªåŠ¨åŒ–æµç¨‹</a></li>
<li><a href="../zh-CN483418/index.html">ç¥¨åŠ¡ç³»ç»Ÿï¼šæ‚¨å¦‚ä½•è·å¾—ä¸‰ç¬”å…è´¹çš„OTRSä»˜æ¬¾ï¼Ÿ</a></li>
<li><a href="../zh-CN483424/index.html">DBAï¼šåœ¨PostgreSQLæ•°æ®åº“ä¹‹é—´ä¼ è¾“SEQUENCEå€¼</a></li>
<li><a href="../zh-CN483426/index.html">æ˜ŸæœŸäº”æ ‡ç­¾è°ƒæŸ¥</a></li>
<li><a href="../zh-CN483428/index.html">ç”µå­ç­¾åæ³•ä¿®æ­£æ¡ˆç”Ÿæ•ˆåï¼Œç”µå­æ–‡æ¡£ç®¡ç†å°†å¦‚ä½•ï¼Ÿ</a></li>
<li><a href="../zh-CN483438/index.html">æ’­æ”¾â€œ osuï¼â€ï¼Œä¸è¦å¿˜è®°é”™è¯¯</a></li>
<li><a href="../zh-CN483440/index.html">æœ€æ–°çš„Dç¼–è¯‘å™¨</a></li>
<li><a href="../zh-CN483444/index.html">DORAæŠ¥å‘Š2019ï¼šå¦‚ä½•æé«˜DevOpsæ€§èƒ½</a></li>
<li><a href="../zh-CN483446/index.html">ç§‘å­¦å®¶å‘ç°äº†ä¸€ç§é™ä½é¥®ç”¨æ°´ä¸­é“å«é‡çš„æ–°æ–¹æ³•</a></li>
<li><a href="../zh-CN483448/index.html">è¿ªå£«å°¼-äººç±»å†å²ä¸Šæœ€ä¼Ÿå¤§çš„åŒå‘</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>