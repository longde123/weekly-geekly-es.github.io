<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõéÔ∏è üö≠ ü§±üèΩ Mettez √† jour vos versions üë©üèø‚Äçü§ù‚Äçüë®üèª üï∏Ô∏è üòµ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Henry Ford a dit un jour: "La meilleure voiture est une nouvelle voiture." Ainsi, nous, au sein du groupe d'entreprises Tinkoff, pensons aux versions ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mettez √† jour vos versions</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/tinkoff/blog/472434/"><p><img src="https://habrastorage.org/webt/gk/69/t-/gk69t-xi2-9rxwwn8xmp_gz1lo0.png"></p><br><p>  Henry Ford a dit un jour: "La meilleure voiture est une nouvelle voiture."  Ainsi, nous, au sein du groupe d'entreprises Tinkoff, pensons aux versions logicielles.  L'inertie dans le processus de livraison des fonctionnalit√©s et des correctifs urgents entra√Æne t√¥t ou tard une lourde dette technique pour le client et se termine le plus souvent par une stagnation du projet dans son ensemble. </p><br><p>  Garantir un indicateur de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">d√©lai de commercialisation</a> √©lev√© tout en maintenant la qualit√© n'est pas une t√¢che facile.  De mon point de vue, vous ne pouvez pas construire imm√©diatement des rails sur lesquels il sera possible d'apporter rapidement et facilement des modifications plusieurs mois apr√®s le d√©but.  La croissance d'un projet s'accompagne g√©n√©ralement d'une augmentation du nombre de personnes qui y travaillent, ce qui signifie qu'il cr√©e une source potentielle de chaos dans vos versions. </p><br><p>  Notre exp√©rience ne vaut gu√®re la peine d'√™tre consid√©r√©e comme des instructions pour r√©ussir, mais un certain nombre d'id√©es m'ont paru suffisamment int√©ressantes pour √™tre partag√©es avec vous.  Commen√ßons. </p><a name="habracut"></a><br><p>  Le point de d√©part de notre histoire est techniquement le suivant.  Le syst√®me se compose de plusieurs services, dont la base de code est fouill√©e par une trentaine de personnes - plusieurs √©quipes r√©parties par domaine d'activit√©, par exemple, au service des particuliers et des personnes morales.  J'essaierai d'ignorer les d√©tails techniques et architecturaux du projet afin de me concentrer sur le processus de sortie lui-m√™me. </p><br><p>  Nous travaillons sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Gitflow</a> , donc l'article sera principalement int√©ressant pour ceux qui ont choisi ce mode de livraison particulier. </p><br><h3 id="problemy">  Les probl√®mes </h3><br><p>  Le premier probl√®me rencontr√© est li√© √† l' <strong>automatisation insuffisante des processus</strong> .  La mise en ≈ìuvre de toutes les activit√©s de publication dans notre √©quipe est li√©e au r√¥le de responsable de publication (RM). </p><br><p>  En voici quelques uns: </p><br><ol><li>  Quitter les branches de publication et cr√©er des balises. </li><li>  Fusionner avec le ma√Ætre et d√©velopper des branches. </li><li>  G√©n√©rez et d√©ployez des artefacts inclus dans la version. </li><li>  Communication avec des sp√©cialistes impliqu√©s dans le processus - par exemple, avec l'AQ ou les administrateurs. </li></ol><br><p>  Ces t√¢ches de routine n√©cessitent de plus en plus de ressources √† mesure que le projet se d√©veloppe (dans notre cas, une augmentation du nombre de services), donc la premi√®re √©tape consiste √† automatiser tout ce qui peut √™tre automatis√©.  Nous nous int√©grons √† l'outil CI / CD afin d'allouer et de fusionner les branches de publication, de lancer des builds de test et de d√©ployer des artefacts;  avec l'outil de suivi des t√¢ches et le messager d'entreprise pour une notification en temps opportun du participant responsable de l'√©tape suivante - par exemple, changez le statut de la t√¢che et configurez le hook pour envoyer une notification. </p><br><div class="spoiler">  <b class="spoiler_title">Emplois Gitflow Automation</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/5j/d9/jj/5jd9jjsprv33w-m1my1mahamqam.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Un exemple de notification dans un messager</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ui/cs/0v/uics0vc4rqqacwoi3ax1nq029oi.png"></p></div></div><br><p>  Le gestionnaire de versions devra toujours r√©soudre manuellement les conflits potentiels r√©sultant de la fusion des branches, mais les versions rapides et fr√©quentes devraient r√©duire leur nombre √† n√©ant. </p><br><p>  Le prochain probl√®me est le <strong>test</strong> . </p><br><p>  L'un des crit√®res de construction pour nous est la r√©ussite des tests.  Il est habituel de diviser les tests en au moins deux types: unit√© et int√©gration. </p><br><p>  <strong>Les tests unitaires</strong> permettent de v√©rifier l'exactitude des modules individuels du code source du programme, ce qui revient le plus souvent √† tester une ou plusieurs m√©thodes ayant une connexion logique √©vidente. </p><br><p>  <strong>Les tests d'int√©gration v√©rifient</strong> g√©n√©ralement l'op√©rabilit√© de toute une cascade de tels modules, c'est-√†-dire le fonctionnement d'une fonctionnalit√© enti√®re c√¥t√© client.  Par exemple, si une interface de repos a √©t√© impl√©ment√©e dans une t√¢che, nous v√©rifierons l'op√©rabilit√© de l'autorisation, la d√©s√©rialisation de la demande elle-m√™me, la validit√© des champs transf√©r√©s, l'int√©gration avec d'autres services et bases de donn√©es, ainsi que la logique m√©tier elle-m√™me.  √Ä premi√®re vue, il peut sembler que de tels tests sont tr√®s autosuffisants et peuvent couvrir tous les probl√®mes potentiels.  Il n'est pas n√©cessaire de comprendre le fonctionnement de chaque brique individuelle, et l'interface appel√©e encapsule toute la logique afin d'obtenir une r√©ponse simple sur la sortie: si elle fonctionne ou non. </p><br><p>  En fait, ils cr√©ent un certain nombre de probl√®mes diff√©r√©s, en voici quelques-uns: </p><br><ol><li>  La participation d'un grand nombre de composants test√©s affecte proportionnellement le temps d'assemblage et l'ex√©cution de ces tests. </li><li>  L'encapsulation de la logique du test conduit souvent au fait qu'il est difficile de garantir l'exactitude du r√©sultat du test.  Souvent, nous personnalisons le test pour le r√©sultat, et encore plus souvent, le r√©sultat correspond √† l'attente en raison d'effets secondaires al√©atoires. </li><li>  La pertinence des donn√©es de test est perdue. </li><li>  Les int√©grations avec des syst√®mes tiers, en particulier dans des environnements de test, tombent souvent.  Cela annule le temps pass√© √† courir, car ce n'est pas toujours √©vident: il s'agit d'une baisse ou d'une panne temporaire caus√©e par nos modifications. </li></ol><br><p>  Car la plupart des probl√®mes ont d√©j√† trouv√© une solution.  Mais, comme d'habitude, les solutions ne viennent pas sans restrictions suppl√©mentaires ni nouveaux probl√®mes. </p><br><p>  Choisir les bons tests pour vous et les impl√©menter correctement est une t√¢che tr√®s difficile.  De plus, il est important de trouver un √©quilibre entre la qualit√© de la couverture et la vitesse de construction afin d'optimiser vos versions. </p><br><p>  Dans notre cas, nous avons opt√© pour un hybride.  Nous continuons √† lever tous les composants n√©cessaires pour un test complet des fonctionnalit√©s, en lavant simultan√©ment toutes les int√©grations possibles.  Pour sauvegarder les contrats API, nous utilisons <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Pact</a> et pour v√©rifier l'int√©gration avec la base de donn√©es - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Testcontainers</a> . </p><br><p>  Une telle approche de l'√©criture des tests a abouti √† une solution au troisi√®me probl√®me - un <strong>temps long pour le test manuel d'une t√¢che</strong> .  La stabilit√© des tests hybrides a conduit √† l'id√©e d'attirer un ing√©nieur QA au stade de la sp√©cification de la t√¢che de compilation des cas de test - cela leur permettra d'√™tre saut√© au stade des tests manuels.  L'int√©gration avec des produits utiles tels que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">TestRail</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Allure</a> est devenue une sorte de pont entre le d√©veloppeur et le testeur.  Un contrat est cr√©√©, dont l'ex√©cution est √©tape par √©tape refl√©t√©e dans le rapport g√©n√©r√© lors de l'assemblage de test. </p><br><div class="spoiler">  <b class="spoiler_title">TestRail.</b>  <b class="spoiler_title">D√©tails de la version de test</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/nk/wv/kc/nkwvkcxtmk1j_sxutjmni2rganu.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">TestRail.</b>  <b class="spoiler_title">Cas de test mis en ≈ìuvre par le d√©veloppeur</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/ha/oh/5r/haoh5rijpl5xjg6arorfgwdnkzi.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Allure</b>  <b class="spoiler_title">Rapport de construction de test automatique</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/1f/w2/cy/1fw2cyotmhbopjohdm47y7spkaq.png"></p></div></div><br><div class="spoiler">  <b class="spoiler_title">Allure</b>  <b class="spoiler_title">Informations pour chaque test en cours d'ex√©cution et d√©tails d√©taill√©s de l'ex√©cution</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/g_/q-/os/g_q-osvljwhuecjhtkta1avthwk.png"></p></div></div><br><p>  Il reste √† connecter les rapports √† votre outil de suivi des t√¢ches pour un suivi transparent des t√¢ches.  Une histoire claire r√©duira √©galement le temps n√©cessaire pour compiler et impl√©menter des tests pour les futures t√¢ches connexes. </p><br><div class="spoiler">  <b class="spoiler_title">Jira.</b>  <b class="spoiler_title">Cas de test automatiquement associ√©s √† la t√¢che</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/fr/66/dv/fr66dvaumtfhdc56iw5tnezg4vk.png"></p></div></div><br><p>  De cette fa√ßon, les ing√©nieurs QA gagnent suffisamment de temps pour se concentrer sur le test de cas exceptionnels et l'int√©gration avec d'autres syst√®mes. </p><br><p>  Le dernier probl√®me est li√© √† cela.  Pour les tests manuels, toutes les t√¢ches fusionnent √† partir des branches de fonctionnalit√©s lors du d√©veloppement et du lancement d'un d√©ploiement vers le banc de test. </p><br><p>  Tout d'abord, avec cette approche, vous ne pouvez pas parler de tests purs de la fonctionnalit√©, car en parall√®le, les changements connexes d'autres d√©veloppeurs peuvent tomber dans le d√©veloppement. </p><br><p>  Deuxi√®mement, lors de la publication de la branche de publication, il se peut que le contr√¥le qualit√© n'ait pas eu le temps de tester certaines t√¢ches.  Vous avez le choix: annuler les modifications affect√©es par ces t√¢ches ou ralentir la publication jusqu'√† la fin des tests. </p><br><p>  Vous devrez faire un tel choix tout le temps, sauf si vous <strong>isolez votre environnement de test</strong> .  Il est important qu'il n'y ait aucun changement dans le composant sous test autre que ceux apport√©s par la t√¢che.  Dans notre cas, nous devons √™tre en mesure de r√©cup√©rer un ou plusieurs services dont les succursales ont √©t√© modifi√©es et g√©rer le routage √† l'int√©rieur du cluster en envoyant uniquement les demandes dont nous avons besoin du QA √† ces instances.  La t√¢che est compliqu√©e si des m√©canismes d'√©quilibrage sont d√©j√† utilis√©s sur le cluster, qui doivent √©galement √™tre pris en compte. </p><br><p>  Ayant saisi cette opportunit√©, nous avons commenc√© √† effectuer des tests manuels directement sur des branches de fonctionnalit√©s distinctes: d√©ployer le service souhait√© pendant la dur√©e du test, en s'int√©grant dans l'environnement global de mani√®re isol√©e.  En fusionnant uniquement les t√¢ches pr√©d√©finies dans la branche de d√©veloppement et en supprimant les verrous, nous avons nous-m√™mes commenc√© √† d√©terminer quelles modifications devaient √™tre incluses dans la version et lesquelles ne devaient pas l'√™tre. </p><br><p>  Il convient de noter qu'une telle solution ne devrait pas devenir une solution miracle pour les √©quipes qui apportent des modifications √† presque les m√™mes fichiers.  Dans ce cas, le stockage des fonctionnalit√©s est inversement proportionnel au nombre de conflits qui surviennent lors de la fusion.  En pratique, avec des versions assez fr√©quentes, cela se produit extr√™mement rarement dans une √©quipe de cinquante d√©veloppeurs. </p><br><h3 id="vmesto-vyvoda">  Au lieu de la sortie </h3><br><p>  En r√©sum√©, nous pouvons identifier les principales approches qui peuvent aider √† acc√©l√©rer les versions: </p><br><ol><li>  Automatisation des op√©rations de routine. </li><li>  Transparence des processus pour toutes les parties concern√©es. </li><li>  L'√©quilibre n√©cessaire entre rapidit√© et qualit√© dans l'√©criture de tests automatis√©s. </li><li>  Temps r√©duit pour les tests manuels. </li><li>  Isolement de l'environnement pour les tests. </li></ol><br><p>  Il est important de comprendre que dans le choix des diff√©rentes approches, principes et strat√©gies, il vaut toujours la peine de partir du contexte de votre probl√®me.  Il existe de nombreuses fa√ßons tout aussi fiables et plus sophistiqu√©es d'acc√©l√©rer la livraison de votre logiciel au client.  Une tentative de r√©pondre aux difficult√©s √©mergentes a conduit aux conclusions d√©crites ci-dessus.  Pour nous, ils ont √©t√© la premi√®re √©tape vers <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">une approche plus audacieuse des versions</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr472434/">https://habr.com/ru/post/fr472434/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr472422/index.html">Sber X RamblerFront & Meet Up</a></li>
<li><a href="../fr472426/index.html">Semaine de la s√©curit√© 43: La vie secr√®te des Hanipots IoT</a></li>
<li><a href="../fr472428/index.html">Op√©rateur Tarantool Kubernetes</a></li>
<li><a href="../fr472430/index.html">Comment nous avons choisi la base de composants pour une maison intelligente: √† propos des capteurs et d'un contr√¥leur</a></li>
<li><a href="../fr472432/index.html">Python 3.8: Quoi de neuf et comment l'utiliser?</a></li>
<li><a href="../fr472438/index.html">Comment les procurations sont utilis√©es dans la s√©curit√© de l'information: 6 cas d'utilisation pratiques</a></li>
<li><a href="../fr472440/index.html">Un jour au Joker 2019</a></li>
<li><a href="../fr472442/index.html">La situation: tout le monde parle du retour des formats audio oubli√©s - pourquoi ils sont destin√©s √† rester des niches</a></li>
<li><a href="../fr472444/index.html">Les meilleurs produits partent de vrais probl√®mes: Intercom sur les t√¢ches √† faire. Partie 3 finale</a></li>
<li><a href="../fr472446/index.html">Comment faire la bonne coloration du code sur "Habr√©" et pourquoi c'est si difficile</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>