<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©ğŸ¿â€ğŸ¨ ğŸšµ â†˜ï¸ Menggabungkan beberapa paket menjadi satu namespace Python ğŸŒ ğŸ  ğŸ’ªğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Terkadang menjadi perlu untuk memisahkan beberapa paket yang terletak di namespace yang sama di sepanjang jalur fisik yang berbeda. Misalnya, jika And...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Menggabungkan beberapa paket menjadi satu namespace Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458432/">  Terkadang menjadi perlu untuk memisahkan beberapa paket yang terletak di namespace yang sama di sepanjang jalur fisik yang berbeda.  Misalnya, jika Anda ingin dapat mentransfer tata letak plugin yang berbeda, memiliki kemampuan untuk kemudian menambahkannya tanpa mengendalikan lokasi mereka, dan pada saat yang sama, mengaksesnya melalui satu namespace. <br><br>  Lembar cheat ini, yang lebih cocok untuk pemula, didedikasikan untuk ruang nama Python. <br><br>  Mari kita lihat bagaimana hal ini dapat dilakukan dalam berbagai versi Python, karena walaupun Python2 tidak lagi didukung segera, banyak dari kita sekarang di antara dua kebakaran, dan ini hanyalah salah satu nuansa penting dalam transisi. <br><br><img src="https://habrastorage.org/webt/q4/bw/uz/q4bwuz7njfxhpsdaaignisff3ew.png" alt="gambar"><br><a name="habracut"></a><br>  Pertimbangkan contoh ini: <br><br>  Kami ingin mendapatkan struktur paket: <br><br><pre><code class="markdown hljs">namespace1 package1 module1 package2 module2</code> </pre> <br>  Isi file Module1 <br><br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">'package 1'</span></span>) var1 = <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  Isi file Module2 <br><br><pre> <code class="python hljs">print(<span class="hljs-string"><span class="hljs-string">'package 2'</span></span>) var2 = <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre><br>  Pada saat yang sama, paket didistribusikan dalam struktur folder berikut: <br><br><pre> <code class="markdown hljs"> path1 namespace1 package1 module1 path2 namespace1 package2 module2</code> </pre><br>  Misalkan path1 dan path2 telah ditambahkan ke sys.path.  Kita perlu mengakses module1 dan module2: <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> namespace1.package1 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> module1 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> namespace1.package2 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> module2</code> </pre><br>  Apa yang terjadi di <b>Python 3.7</b> ketika kode ini dieksekusi?  Semuanya bekerja sangat baik: <br><br><pre> <code class="markdown hljs">package 1 package 2</code> </pre><br>  Dengan PEP-420 di Python 3.3, dukungan untuk ruang nama implisit telah muncul.  Selain itu, saat mengimpor paket dari py33, Anda tidak perlu membuat file __init__.py.  Dan ketika mengimpor namespace, itu hanya _ dilarang_.  Jika file __init__.py ada di satu atau kedua direktori dengan nama name1, kesalahan akan terjadi pada impor paket kedua. <br><br><pre> <code class="python hljs">ModuleNotFoundError: No module named <span class="hljs-string"><span class="hljs-string">'namespace1.package2'</span></span></code> </pre><br>  Dengan demikian, keberadaan orang dalam secara eksplisit menentukan paket, dan paket tidak dapat digabungkan, itu adalah entitas tunggal.  Jika Anda memulai proyek baru, terlepas dari pengembangan lama, dan paket-paket akan diinstal menggunakan pip, maka Anda harus tetap menggunakan metode ini.  Namun, terkadang kami mewarisi kode lama, yang juga perlu dipertahankan, setidaknya untuk sementara waktu, atau porting ke versi baru. <br><br>  Mari kita beralih ke <b>Python 2.7</b> .  Dengan versi ini sudah lebih menarik, Anda harus terlebih dahulu menambahkan __init__.py ke setiap direktori untuk membuat paket, jika tidak, penerjemah tidak akan mengenali paket dalam kumpulan file ini.  Dan kemudian menulis deklarasi namespace eksplisit dalam file __init__ yang terkait dengan namespace1, jika tidak, hanya paket pertama yang akan diimpor. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pkgutil <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> extend_path __path__ = extend_path(__path__, __name__)</code> </pre><br>  Apa yang terjadi dengan ini?  Ketika penerjemah mencapai impor pertama, sebuah paket dengan nama yang sama dicari di sys.path, itu di path1 / namespace1 dan penerjemah mengeksekusi path1 / namespace1 / __ init__.py.  Pencarian lebih lanjut tidak dilakukan.  Namun, fungsi extended_path sendiri melakukan pencarian di seluruh sys.path, menemukan semua paket dengan namespace1 dan nama internal dan menambahkannya ke variabel __path__ dari paket namespace1, yang digunakan untuk mencari paket anak di namespace ini. <br><br>  Dalam panduan resmi, direkomendasikan bahwa inisialnya sama setiap kali namespace1 ditempatkan.  Bahkan, mereka bisa kosong semua kecuali yang pertama, yang ditemukan selama pencarian di sys.path, di mana pkgutil.extend_path harus dipanggil, karena sisanya tidak dieksekusi.  Namun, tentu saja, lebih baik panggilan itu benar-benar ada di setiap tim, agar tidak mengikat logika Anda "dalam kasus" dan tidak menebak tim mana yang pertama kali dieksekusi, karena urutan pencarian dapat berubah.  Untuk alasan yang sama, Anda tidak boleh menempatkan file __init__ logika lain di area variabel. <br><br>  Ini akan berfungsi di versi mendatang dan kode ini dapat digunakan untuk menulis <b>kode yang kompatibel</b> , tetapi perlu diingat bahwa Anda harus mematuhi metode yang dipilih dalam setiap paket yang didistribusikan.  Jika pada versi 3 Anda memasukkan in-box di beberapa paket dalam panggilan ke pkgutil.extend_path, dan meninggalkan beberapa tanpa in-box, ini tidak akan berfungsi. <br>  Selain itu, opsi ini juga cocok untuk kasus ketika Anda berencana untuk menginstal menggunakan instalasi python setup.py. <br><br>  Cara lain, yang sekarang dianggap agak ketinggalan zaman, tetapi masih bisa ditemukan banyak di mana: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#namespace1/__init__.py __import__('pkg_resources').declare_namespace(__name__)</span></span></code> </pre><br>  Modul pkg_resources dilengkapi dengan paket setuptools.  Di sini artinya sama dengan di pkgutil - perlu setiap file __init__ di setiap lokasi namespace1 berisi deklarasi namespace yang sama dan tidak ada kode lain.  Pada saat yang sama, perlu mendaftarkan namespace namespace_packages = ['namespace1'] di setup.py.  Deskripsi lebih rinci tentang pembuatan paket berada di luar cakupan artikel ini. <br><br>  Selain itu, Anda sering dapat menemukan kode seperti itu <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: __import__(<span class="hljs-string"><span class="hljs-string">'pkg_resources'</span></span>).declare_namespace(__name__) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> pkgutil <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> extend_path __path__ = extend_path(__path__, __name__)</code> </pre><br>  Di sini logikanya sederhana - jika setuptools tidak diinstal, maka kami menggunakan pkgutil, yang termasuk dalam pustaka standar. <br><br>  Jika Anda mengkonfigurasi namespace dengan salah satu cara ini, Anda dapat memanggil yang lain dari satu modul.  Misalnya, ubah namespace1 / package2 / module2 <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> namespace1.package1.module1 print(var1)</code> </pre><br>  Dan kemudian kita akan melihat apa yang terjadi jika kita salah menamai paket baru serta yang sudah ada dan membungkusnya dengan namespace yang sama.  Misalnya, akan ada dua paket di tempat yang berbeda dengan nama package1. <br><br><pre> <code class="markdown hljs">namespace1 package1 module1 package1 module2</code> </pre><br>  Dalam hal ini, hanya yang pertama yang akan diimpor dan tidak akan ada akses ke module2.  Paket tidak dapat digabungkan. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> namespace1.package1 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> module1 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> namespace1.package1 <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> module2 <span class="hljs-comment"><span class="hljs-comment">#&gt;&gt;ImportError: cannot import name module2</span></span></code> </pre> <br>  <b>Ringkasan:</b> <br><br><ol><li>  Untuk Python yang lebih tua dari 3,3 dan menginstal dengan pip, disarankan agar Anda menggunakan deklarasi namespace implisit. </li><li>  Dalam hal dukungan untuk versi 2 dan 3, serta instalasi dengan pemasangan pip dan python setup.py, opsi dengan pkgutil direkomendasikan. </li><li>  Opsi pkg_resources direkomendasikan jika Anda perlu mendukung paket yang lebih lama menggunakan metode ini, atau Anda perlu paket yang aman zip. </li></ol><br>  Sumber: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">packaging.python.org/guides/packaging-namespace-packages</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">www.python.org/dev/peps/pep-0420</a> </li><li>  Belajar Python, Edisi ke-5 oleh Mark Lutz </li></ul><br>  Contohnya dapat ditemukan di <a href="">sini</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id458432/">https://habr.com/ru/post/id458432/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id458420/index.html">Pertemuan AWS_Ru di Raiffeisenbank</a></li>
<li><a href="../id458422/index.html">Tinjauan umum program hibah untuk pengembang blockchain</a></li>
<li><a href="../id458424/index.html">Drone Show: Tampilan Dalam</a></li>
<li><a href="../id458426/index.html">Proyeksi peta: apa yang sebenarnya bercanda xkcd</a></li>
<li><a href="../id458428/index.html">Google membuka kode sumber pengurai robots.txt</a></li>
<li><a href="../id458434/index.html">Pelatihan Cisco 200-125 CCNA v3.0. Hari 11. Dasar-Dasar VLAN</a></li>
<li><a href="../id458436/index.html">Kesalahan logging umum</a></li>
<li><a href="../id458440/index.html">Dukungan teknis di hari kerja: cerita tentang apa yang terjadi ketika Anda tidak dapat menjangkau pengguna</a></li>
<li><a href="../id458442/index.html">Mengapa LLVM dapat memanggil fungsi yang tidak pernah dipanggil?</a></li>
<li><a href="../id458444/index.html">Internet untuk penduduk musim panas. Bagian 4. Satu kartu SIM sudah cukup</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>