<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üè≥Ô∏è‚Äçüåà üõéÔ∏è üë©üèæ‚ÄçüöÄ PNL. O b√°sico. T√©cnicas. Autodesenvolvimento. Parte 2: NER ü•û üî£ üÜò</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A primeira parte do artigo sobre o b√°sico da PNL pode ser lida aqui . Hoje, falaremos sobre uma das tarefas mais populares da PNL - NER (Entidade de E...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PNL. O b√°sico. T√©cnicas. Autodesenvolvimento. Parte 2: NER</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/abbyy/blog/449514/">  A primeira parte do artigo sobre o b√°sico da PNL pode ser lida <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> .  Hoje, falaremos sobre uma das tarefas mais populares da PNL - NER (Entidade de Entidade Nomeada) - e analisaremos em detalhes a arquitetura das solu√ß√µes para esse problema. <br><br><img src="https://habrastorage.org/webt/fu/n9/-j/fun9-jbc0m4wmnvzwfwb7m4duui.png" alt="imagem"><br><a name="habracut"></a><br>  A tarefa do NER √© destacar extens√µes de entidades no texto (span √© um fragmento cont√≠nuo de texto).  Suponha que exista um texto de not√≠cias e queremos destacar as entidades nele (alguns conjuntos pr√©-fixados - por exemplo, pessoas, locais, organiza√ß√µes, datas e assim por diante).  A tarefa do NER √© entender que a parte do texto " <i>1¬∫ de janeiro de 1997</i> " √© a data, " <i>Kofi Annan</i> " √© a pessoa e " <i>ONU</i> " √© a organiza√ß√£o. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gk/ow/au/gkowauf-i0k8yz2y7m81y4yamiu.png"></div><br>  O que s√£o entidades nomeadas?  No primeiro cen√°rio cl√°ssico, que foi formulado na confer√™ncia do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">MUC-6</a> em 1995, s√£o pessoas, locais e organiza√ß√µes.  Desde ent√£o, v√°rios pacotes dispon√≠veis apareceram, cada um com seu pr√≥prio conjunto de entidades nomeadas.  Normalmente, novos tipos de entidade s√£o adicionados a pessoas, locais e organiza√ß√µes.  Os mais comuns s√£o num√©ricos (datas, valores monet√°rios) e entidades diversas (de diversas - outras entidades nomeadas; um exemplo √© o iPhone 6). <br><br><h2>  Por que voc√™ precisa resolver o problema do NER </h2><br>  √â f√°cil entender que, mesmo que possamos identificar pessoas, locais e organiza√ß√µes no texto, √© improv√°vel que isso cause grande interesse entre os clientes.  Embora alguma aplica√ß√£o pr√°tica, √© claro, tenha o problema no cen√°rio cl√°ssico. <br><br>  Um dos cen√°rios em que uma solu√ß√£o para o problema na formula√ß√£o cl√°ssica ainda pode ser necess√°ria √© a estrutura√ß√£o de dados n√£o estruturados.  Suponha que voc√™ tenha algum tipo de texto (ou um conjunto de textos) e os dados dele devem ser inseridos em um banco de dados (tabela).  As entidades nomeadas cl√°ssicas podem corresponder √†s linhas de uma tabela ou servir como conte√∫do de algumas c√©lulas.  Portanto, para preencher corretamente a tabela, voc√™ deve primeiro selecionar no texto os dados que inserir√° nela (geralmente depois disso h√° outra etapa - identificar as entidades no texto, quando entendermos que a <i>ONU</i> e <i>as Na√ß√µes Unidas</i> abrangem ‚ÄùConsulte a mesma organiza√ß√£o; no entanto, a tarefa de identifica√ß√£o ou vincula√ß√£o de entidades √© outra tarefa, e n√£o falaremos sobre isso em detalhes neste post). <br><br>  No entanto, existem v√°rias raz√µes pelas quais o NER √© uma das tarefas mais populares da PNL. <br><br>  Primeiro, extrair entidades nomeadas √© um passo em dire√ß√£o √† "compreens√£o" do texto.  Isso pode ter valor independente e ajudar a resolver melhor outras tarefas da PNL. <br><br>  Portanto, se soubermos onde as entidades est√£o destacadas no texto, podemos encontrar fragmentos do texto que s√£o importantes para alguma tarefa.  Por exemplo, podemos selecionar apenas os par√°grafos em que s√£o encontradas entidades de um determinado tipo e, em seguida, trabalhar apenas com elas. <br><br>  Suponha que voc√™ receba uma carta, e seria bom fazer um trecho apenas daquela parte em que houver algo √∫til, e n√£o apenas " <i>Ol√°, Ivan Petrovich</i> ".  Se voc√™ pode distinguir entidades nomeadas, pode tornar o snippet inteligente, mostrando a parte da carta onde est√£o as entidades de nosso interesse (e n√£o apenas mostrando a primeira frase da carta, como costuma ser feito).  Ou voc√™ pode simplesmente destacar no texto as partes necess√°rias da carta (ou, diretamente, as entidades que s√£o importantes para n√≥s) para a conveni√™ncia dos analistas. <br><br>  Al√©m disso, as entidades s√£o coloca√ß√µes r√≠gidas e confi√°veis; sua sele√ß√£o pode ser importante para muitas tarefas.  Suponha que voc√™ tenha um nome para uma entidade nomeada e, seja o que for, provavelmente √© cont√≠nuo, e todas as a√ß√µes com ela precisam ser executadas como em um √∫nico bloco.  Por exemplo, traduza o nome de uma entidade para o nome de uma entidade.  Voc√™ deseja traduzir <i>"Pyaterochka Shop"</i> para o franc√™s em uma √∫nica pe√ßa e n√£o dividir em v√°rios fragmentos que n√£o s√£o relacionados um ao outro.  A capacidade de detectar coloca√ß√µes tamb√©m √© √∫til para muitas outras tarefas - por exemplo, para an√°lise sint√°tica. <br><br>  Sem resolver o problema do NER, √© dif√≠cil imaginar a solu√ß√£o para muitos problemas da PNL, por exemplo, resolver o pronome an√°fora ou criar sistemas de resposta a perguntas.  O pronome an√°fora nos permite entender a qual elemento do texto o pronome se refere.  Por exemplo, vamos analisar o texto ‚Äú <i>Galopante charmoso em um cavalo branco.</i>  <i>A princesa correu para encontr√°-lo e o beijou</i> . "  Se destacarmos a ess√™ncia de Persona na palavra "Encantador", a m√°quina ser√° muito mais f√°cil de entender que a princesa provavelmente n√£o beijou o cavalo, mas o pr√≠ncipe de Encanto. <br><br>  Agora, damos um exemplo de como a aloca√ß√£o de entidades nomeadas pode ajudar na constru√ß√£o de sistemas de perguntas e respostas.  Se voc√™ fizer a pergunta " <i>Quem desempenhou o papel de Darth Vader no filme" O Imp√©rio Contra-Ataca "</i> " em seu mecanismo de busca favorito "", com uma alta probabilidade de obter a resposta certa.  Isso √© feito apenas isolando as entidades nomeadas: selecionamos as entidades (filme, papel etc.), entendemos o que nos √© pedido e, em seguida, procuramos a resposta no banco de dados. <br><br>  Provavelmente a considera√ß√£o mais importante devido √† qual a tarefa NER √© t√£o popular: a declara√ß√£o do problema √© muito flex√≠vel.  Em outras palavras, ningu√©m nos obriga a destacar locais, pessoas e organiza√ß√µes.  Podemos selecionar qualquer parte cont√≠nua do texto que precisarmos que seja um pouco diferente do restante do texto.  Como resultado, voc√™ pode escolher seu pr√≥prio conjunto de entidades para uma tarefa pr√°tica espec√≠fica vinda do cliente, marcar o corpo dos textos com esse conjunto e treinar o modelo.  Esse cen√°rio √© onipresente e isso faz do NER uma das tarefas de PNL mais frequentemente executadas no setor. <br><br>  Vou dar alguns exemplos de casos de clientes espec√≠ficos, cuja solu√ß√£o eu participei. <br><br>  Aqui est√° o primeiro: permita que voc√™ tenha um conjunto de faturas (transfer√™ncias de dinheiro).  Cada fatura possui uma descri√ß√£o em texto, que cont√©m as informa√ß√µes necess√°rias sobre a transfer√™ncia (quem, quem, quando, o que e por que motivo foi enviado).  Por exemplo, a empresa X transferiu US $ 10 para a empresa Y nessa e naquela data para tal e tal.  O texto √© bastante formal, mas escrito em linguagem viva.  Os bancos treinaram pessoas especialmente treinadas que leem este texto e, em seguida, inserem as informa√ß√µes nele contidas em um banco de dados. <br><br>  Podemos selecionar um conjunto de entidades que correspondem √†s colunas da tabela no banco de dados (nomes da empresa, quantidade de transfer√™ncia, data, tipo de transfer√™ncia etc.) e aprender como selecion√°-las automaticamente.  Depois disso, resta apenas inserir as entidades selecionadas na tabela, e as pessoas que leram anteriormente os textos e inseriram as informa√ß√µes no banco de dados poder√£o executar tarefas mais importantes e √∫teis. <br><br>  O segundo caso de usu√°rio √© este: voc√™ precisa analisar cartas com pedidos de lojas on-line.  Para fazer isso, voc√™ precisa saber o n√∫mero do pedido (para que todas as letras relacionadas a esse pedido possam ser marcadas ou colocadas em uma pasta separada), al√©m de outras informa√ß√µes √∫teis - o nome da loja, a lista de mercadorias encomendadas, o valor do cheque, etc. Tudo isso - n√∫meros de pedidos, nomes de lojas etc. - podem ser considerados entidades nomeadas e tamb√©m √© f√°cil aprender a diferenci√°-las usando os m√©todos que iremos analisar agora. <br><br><h2>  Se o NER √© t√£o √∫til, por que n√£o √© usado em todos os lugares? </h2><br>  Por que a tarefa do NER nem sempre √© resolvida e os clientes comerciais ainda est√£o dispostos a n√£o pagar o menor dinheiro pela sua solu√ß√£o?  Parece que tudo √© simples: entender qual peda√ßo de texto destacar e destac√°-lo. <br><br>  Mas na vida tudo n√£o √© t√£o f√°cil, surgem v√°rias dificuldades. <br><br>  A complexidade cl√°ssica que nos impede de resolver uma variedade de problemas de PNL √© todo tipo de ambiguidade na linguagem.  Por exemplo, palavras polissem√¢nticas e hom√¥nimos (veja exemplos na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">parte 1</a> ).  Existe um tipo separado de homon√≠mia que est√° diretamente relacionado √† tarefa NER - entidades completamente diferentes podem ser chamadas da mesma palavra.  Por exemplo, vamos ter a palavra " <i>Washington</i> ".  O que √© isso  Pessoa, cidade, estado, nome da loja, nome do cachorro, objeto, alguma outra coisa?  Para destacar esta se√ß√£o do texto como uma entidade espec√≠fica, √© preciso levar muito em conta - o contexto local (sobre o que era o texto anterior), o contexto global (conhecimento sobre o mundo).  Uma pessoa leva tudo isso em considera√ß√£o, mas n√£o √© f√°cil ensinar uma m√°quina a fazer isso. <br><br>  A segunda dificuldade √© t√©cnica, mas n√£o a subestime.  N√£o importa como voc√™ defina a ess√™ncia, provavelmente haver√° alguns casos limitados e dif√≠ceis - quando voc√™ precisar real√ßar a ess√™ncia, quando n√£o precisar o que incluir no per√≠odo da entidade e o que n√£o, etc. (√© claro, se a nossa ess√™ncia for n√£o algo levemente vari√°vel, como um e-mail; no entanto, voc√™ geralmente pode distinguir essas entidades triviais por m√©todos triviais - escreva uma express√£o regular e n√£o pense em nenhum tipo de aprendizado de m√°quina). <br><br>  Suponha, por exemplo, que desejemos destacar os nomes das lojas. <br><br>  No texto ‚ÄúA <i>loja de detectores de metais profissionais d√° as boas-vindas a voc√™</i> ‚Äù, quase certamente queremos incluir a palavra ‚Äúloja‚Äù em nossa ess√™ncia - isso √© claramente parte do nome. <br><br>  Outro exemplo √© " <i>Voc√™ √© recebido pela Volkhonka Prestige, sua loja de marca favorita a pre√ßos acess√≠veis</i> ".  Provavelmente, a palavra "loja" n√£o deve ser inclu√≠da na anota√ß√£o - isso claramente n√£o faz parte do nome, mas simplesmente sua descri√ß√£o.  Al√©m disso, se voc√™ incluir essa palavra no nome, tamb√©m dever√° incluir as palavras ‚Äú- sua favorita‚Äù e isso talvez eu n√£o queira fazer. <br><br>  O terceiro exemplo: <i>"A loja de animais de estima√ß√£o de Nemo escreve para voc√™</i> " <i>.</i>  N√£o est√° claro se a "loja de animais" faz parte do nome ou n√£o.  Neste exemplo, parece que qualquer escolha ser√° adequada.  No entanto, √© importante que precisamos fazer essa escolha e corrigi-la nas instru√ß√µes dos marcadores, para que em todos os textos esses exemplos sejam marcados igualmente (se isso n√£o for feito, o aprendizado de m√°quina inevitavelmente come√ßar√° a cometer erros devido a contradi√ß√µes na marca√ß√£o). <br><br>  Existem muitos exemplos lim√≠trofes e, se queremos que a marca√ß√£o seja consistente, todos eles precisam ser inclu√≠dos nas instru√ß√µes dos marcadores.  Mesmo que os exemplos sejam simples, eles precisam ser levados em considera√ß√£o e calculados, e isso tornar√° a instru√ß√£o maior e mais complicada. <br><br>  Bem, quanto mais complicadas forem as instru√ß√µes, voc√™ precisar√° de marcadores mais qualificados.  Uma coisa √© quando o escriba precisa determinar se a letra √© o texto da ordem ou n√£o (embora haja sutilezas e casos de fronteira aqui), e outra coisa quando o escriba precisa ler as instru√ß√µes de 50 p√°ginas, encontrar entidades espec√≠ficas, entender o que incluir em anota√ß√£o e o que n√£o. <br><br>  Os marcadores qualificados s√£o caros e geralmente n√£o funcionam muito rapidamente.  Voc√™ gastar√° o dinheiro com certeza, mas n√£o √© um fato que voc√™ obtenha a marca√ß√£o perfeita, porque se as instru√ß√µes forem complexas, mesmo uma pessoa qualificada pode cometer um erro e entender algo errado.  Para combater isso, v√°rias marca√ß√µes do mesmo texto por pessoas diferentes s√£o usadas, o que aumenta ainda mais o pre√ßo da marca√ß√£o e o tempo para o qual √© preparado.  Evitar esse processo ou at√© mesmo reduzi-lo seriamente n√£o funcionar√°: para aprender, voc√™ precisa ter um conjunto de treinamento de alta qualidade e tamanhos razo√°veis. <br><br>  Essas s√£o as duas principais raz√µes pelas quais o NER ainda n√£o conquistou o mundo e por que as macieiras ainda n√£o crescem em Marte. <br><br><h2>  Como entender se o problema do NER foi resolvido de maneira qualitativa </h2><br>  Vou falar um pouco sobre as m√©tricas que as pessoas usam para avaliar a qualidade de sua solu√ß√£o para o problema de NER e sobre casos padr√£o. <br><br>  A principal m√©trica para a nossa tarefa √© uma f-medida rigorosa.  Explique o que √© isso. <br><br>  Vamos fazer uma marca√ß√£o de teste (o resultado do trabalho do nosso sistema) e um padr√£o (marca√ß√£o correta dos mesmos textos).  Ent√£o, podemos contar duas m√©tricas - precis√£o e integridade.  Precis√£o √© a fra√ß√£o de verdadeiras entidades positivas (ou seja, entidades selecionadas por n√≥s no texto, que tamb√©m est√£o presentes no padr√£o), em rela√ß√£o a todas as entidades selecionadas pelo nosso sistema.  E integridade √© a fra√ß√£o de verdadeiras entidades positivas em rela√ß√£o a todas as entidades presentes no padr√£o.  Um exemplo de um classificador muito preciso, mas incompleto, √© um classificador que seleciona um objeto correto no texto e nada mais.  Um exemplo de um classificador muito completo, mas geralmente impreciso, √© um classificador que seleciona uma entidade em qualquer segmento do texto (assim, al√©m de todas as entidades padr√£o, nosso classificador aloca uma quantidade enorme de lixo). <br><br>  A medida F √© a m√©dia harm√¥nica de precis√£o e integridade, uma m√©trica padr√£o. <br><br>  Conforme descrito na se√ß√£o anterior, a cria√ß√£o de marca√ß√£o √© cara.  Portanto, n√£o h√° muitos edif√≠cios acess√≠veis com uma marca√ß√£o. <br><br>  Existe alguma variedade para o idioma ingl√™s - h√° confer√™ncias populares nas quais as pessoas competem na solu√ß√£o do problema NER (e a marca√ß√£o √© criada para as competi√ß√µes).  Exemplos de tais confer√™ncias nas quais seus corpos com entidades nomeadas foram criadas s√£o MUC, TAC, CoNLL.  Todos esses casos consistem quase exclusivamente em textos de not√≠cias. <br><br>  O corpo principal no qual a qualidade da solu√ß√£o do problema NER √© avaliada √© o caso CoNLL 2003 (aqui est√° um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">link para o caso em si</a> , aqui est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um artigo sobre ele</a> ).  Existem aproximadamente 300 mil tokens e at√© 10 mil entidades.  Agora, os sistemas SOTA (estado da arte - ou seja, os melhores resultados no momento) mostram neste caso uma f-medida da ordem de 0,93. <br><br>  Para o idioma russo, tudo √© muito pior.  Existe um √≥rg√£o p√∫blico ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">FactRuEval 2016</a> , aqui est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um artigo</a> , aqui est√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um artigo sobre Habr√©</a> ), e √© muito pequeno - existem apenas 50 mil fichas.  Nesse caso, o caso √© bastante espec√≠fico.  Em particular, a ess√™ncia bastante controversa do LocOrg (localiza√ß√£o em um contexto organizacional) destaca-se no caso, que √© confundido com organiza√ß√µes e locais, como resultado do qual a qualidade da sele√ß√£o deste √∫ltimo √© mais baixa do que poderia ser. <br><br><h2>  Como resolver o problema do NER </h2><br><h3>  Redu√ß√£o do problema NER ao problema de classifica√ß√£o </h3><br>  Apesar do fato de as entidades serem geralmente detalhadas, a tarefa NER geralmente se resume ao problema de classifica√ß√£o no n√≠vel do token, ou seja, cada token pertence a uma das v√°rias classes poss√≠veis.  Existem v√°rias maneiras padr√£o de fazer isso, mas a mais comum √© chamada de esquema BIOES.  O esquema √© adicionar algum prefixo ao r√≥tulo da entidade (por exemplo, PER para pessoas ou ORG para organiza√ß√µes), o que indica a posi√ß√£o do token no per√≠odo da entidade.  Mais detalhes: <br><br>  B - desde o in√≠cio da palavra - o primeiro token no per√≠odo da entidade, que consiste em mais de 1 palavra. <br>  Eu - pelas palavras de dentro - √© isso que est√° no meio. <br>  E - a partir da palavra que termina, este √© o √∫ltimo token da entidade, que consiste em mais de 1 elemento. <br>  S √© solteiro.  N√≥s adicionamos esse prefixo se a entidade consistir em uma palavra. <br><br>  Assim, adicionamos um dos quatro prefixos poss√≠veis a cada tipo de entidade.  Se o token n√£o pertencer a nenhuma entidade, ser√° marcado com um r√≥tulo especial, geralmente rotulado como OUT ou O. <br><br>  N√≥s damos um exemplo.  Vamos ter o texto " <i>Karl Friedrich Jerome von Munchausen nasceu em Bodenwerder</i> ".  Aqui existe uma entidade detalhada - a pessoa "Karl Friedrich Jerome von M√ºnhausen" e uma de uma palavra - a localiza√ß√£o "Bodenwerder". <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ia/gp/2f/iagp2fausaarttfscowpqo8xpic.png"></div><br><br>  Assim, BIOES √© uma maneira de mapear proje√ß√µes de intervalos ou anota√ß√µes para o n√≠vel do token. <br><br>  √â claro que, com essa marca√ß√£o, podemos estabelecer de forma inequ√≠voca os limites de todas as anota√ß√µes de entidade.  De fato, sobre cada token, sabemos se √© verdade que uma entidade come√ßa com esse token ou termina nele, o que significa se deve terminar a anota√ß√£o da entidade em um determinado token ou expandi-lo para os pr√≥ximos tokens. <br><br>  A grande maioria dos pesquisadores usa esse m√©todo (ou suas varia√ß√µes com menos r√≥tulos - BIOE ou BIO), mas possui v√°rias desvantagens significativas.  A principal √© que o esquema n√£o permite trabalhar com entidades aninhadas ou cruzadas.  Por exemplo, a ess√™ncia da " <i>Universidade Estadual de Moscou com o nome de M.V.</i>  <i>Lomonosov</i> ‚Äù√© uma organiza√ß√£o.  Mas o pr√≥prio Lomonosov √© uma pessoa, e tamb√©m seria bom perguntar na marca√ß√£o.  Usando o m√©todo de marca√ß√£o descrito acima, nunca podemos transmitir esses dois fatos ao mesmo tempo (porque s√≥ podemos fazer uma marca em um token).  Consequentemente, o token ‚ÄúLomonosov‚Äù pode ser parte da anota√ß√£o da organiza√ß√£o ou parte da anota√ß√£o da pessoa, mas nunca as duas ao mesmo tempo. <br><br>  Outro exemplo de entidades incorporadas: " <i>Departamento de L√≥gica Matem√°tica e Teoria dos Algoritmos da Faculdade de Mec√¢nica e Matem√°tica da Universidade Estadual de Moscou</i> ".  Aqui, idealmente, eu gostaria de distinguir tr√™s organiza√ß√µes aninhadas, mas o m√©todo de marca√ß√£o acima permite selecionar 3 entidades separadas ou uma entidade que anote todo o fragmento. <br><br>  Al√©m da maneira padr√£o de reduzir a tarefa √† classifica√ß√£o no n√≠vel do token, tamb√©m h√° um formato de dados padr√£o no qual √© conveniente armazenar a marca√ß√£o para a tarefa NER (assim como para muitas outras tarefas da PNL).  Este formato √© chamado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CoNLL-U</a> . <br><br>  A id√©ia principal do formato √© a seguinte: armazenamos os dados na forma de uma tabela, em que uma linha corresponde a um token e as colunas correspondem a um tipo espec√≠fico de atributos de token (incluindo a pr√≥pria palavra, a forma da palavra).  Em um sentido restrito, o formato CoNLL-U define quais tipos de recursos (ou seja, colunas) s√£o inclu√≠dos na tabela - um total de 10 tipos de recursos para cada token.  Mas os pesquisadores geralmente consideram o formato de forma mais ampla e incluem os tipos de recursos necess√°rios para uma tarefa e m√©todo espec√≠ficos para resolv√™-lo. <br><br>  Abaixo est√° um exemplo de dados em um formato semelhante ao CoNLL-U, onde s√£o considerados 6 tipos de atributos: n√∫mero da senten√ßa atual no texto, forma da palavra (ou seja, a palavra em si), lema (forma da palavra inicial), lema (forma da palavra inicial), tag POS (parte do discurso), morfol√≥gica caracter√≠sticas da palavra e, finalmente, o r√≥tulo da entidade alocada nesse token. <br><br><img src="https://habrastorage.org/webt/yb/ue/th/ybuethtundoox6j79pt_yofveuq.png" alt="imagem"><br><br><h3>  Como voc√™ resolveu o problema do NER antes? </h3><br>  A rigor, o problema pode ser resolvido sem o aprendizado de m√°quina - com a ajuda de sistemas baseados em regras (na vers√£o mais simples - com a ajuda de express√µes regulares).  Isso parece desatualizado e ineficaz, no entanto, voc√™ precisa entender se sua √°rea de assunto √© limitada e claramente definida e se a entidade, por si s√≥, n√£o possui muita variabilidade, o problema do NER √© resolvido usando m√©todos baseados em regras com bastante rapidez e efici√™ncia. <br><br> ,         (,     ),        ,        . <br><br> ,          (      ),      .                   . <br><br>    ,      2000-  SOTA        .   ,   . <br><br><h3>  </h3><br>   ,       ‚Äî . .    .  ,          ( ),         1,      0. <br><br>  ,         (POS-),   (     ‚Äî , ,      ),  (. .    ),  (,    ),        . <br><br>   ,        , : <br><br><ul><li> ‚Äú  ,  ‚Äù, </li><li> ‚Äú  ‚Äù, </li><li> ‚Äú  ‚Äù, </li><li>   ‚Äú ‚Äù ( ,  ,   ‚ÄúiPhone‚Äù). </li></ul><br>     ,        ,    - ,     ‚Äî     . <br><br>   ,    ‚Äì  .  ,  , ,  ‚Äì  , , ,   ‚Äì ,  , ,   ‚Äì .  ,          (‚Äú‚Äù     ,  ‚Äú‚Äù ‚Äî  ),     . , ,   ,       ‚Äî       ( ,      NER   2  ‚Äî      ). <br><br>   ,     NER,    ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Nadeau and Sekine (2007), A survey of Named Entity Recognition and Classification</a> . ,   , ,  (       -  , , ,    HMM,    , , ,  ),        . <br><br>        (summarized pattern   ).           NLP. ,  2018   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>    (word shape)     . <br><br><h2>    NER   ? </h2><br><h3> NLP almost from scratch </h3><br>      NER     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">  2011 </a> . <br><br>        SOTA-   CoNLL 2003.   ,                .         ML  ,    . <br><br>        NER   ,      ,       NLP   . ,      ,   , ,     .        ,     NER ( ,    NLP). <br><br>     ,   . <br><br>     ,       : <br><br><ul><li>   ¬´¬ª   (window based approach), </li><li>      (sentence based approach). </li></ul><br>      ‚Äì   ,      ‚Äì ,    ..    ,   . <br><br>        : , ‚Äú <i>The cat sat on the mat</i> ‚Äù. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pb/n1/mo/pbn1mo7pfdzlc8aay2xm9lz3tse.png"></div><br><br>    K      (,     ,  , ,           . .).        (,       ,  1         ).  Vamos <img src="https://habrastorage.org/webt/kq/0v/p-/kq0vp-1f7hnnnwfkk3ak6xk4lno.png" alt="imagem"> ‚Äî  ,   i-  j-   . <br><br>  ,   sentence based approach   ,   ,   ‚Äî   ,     .       i  i-core,  core ‚Äî  ,         (    ,        ,    ). <br><br>      ‚Äî   <img src="https://habrastorage.org/webt/kq/0v/p-/kq0vp-1f7hnnnwfkk3ak6xk4lno.png" alt="imagem">   <img src="https://habrastorage.org/webt/wb/nv/h8/wbnvh8l37-5zigiw-vcap7nfmju.png" alt="imagem"> ,   Lookup Table (    ‚Äú‚Äù  ). ,    <img src="https://habrastorage.org/webt/kq/0v/p-/kq0vp-1f7hnnnwfkk3ak6xk4lno.png" alt="imagem"> ‚Äî  ,       1,     ‚Äì 0.     <img src="https://habrastorage.org/webt/wb/nv/h8/wbnvh8l37-5zigiw-vcap7nfmju.png" alt="imagem">  em <img src="https://habrastorage.org/webt/kq/0v/p-/kq0vp-1f7hnnnwfkk3ak6xk4lno.png" alt="imagem"> ,        .        .  <img src="https://habrastorage.org/webt/wb/nv/h8/wbnvh8l37-5zigiw-vcap7nfmju.png" alt="imagem"> ( i     1  K) ‚Äì    ,        . <br><br>              word2vec (   ,     word2vec,     )  ,      ,   word2vec            (   ). <br><br>  ,       ,      <img src="https://habrastorage.org/webt/kq/0v/p-/kq0vp-1f7hnnnwfkk3ak6xk4lno.png" alt="imagem">  em <img src="https://habrastorage.org/webt/wb/nv/h8/wbnvh8l37-5zigiw-vcap7nfmju.png" alt="imagem">  . <br><br>    ,      sentence based approach (window based  ). ,            (. .   ‚ÄúThe cat sat on the mat‚Äù     6 ).      ,   ,    ,      ‚Äî  core. <br><br>                  : 3-5.     ,    ,         (    ).       m  f,  m ‚Äî  ,        (. .       ),  f ‚Äî   . <br><br>        ,      ‚Äî    max pooling (. .          ),      f.  ,  ,   ,         core,     (max pooling   ,         ,        ).  ‚Äú ‚Äù             ,  ,      core. <br><br>        -   (  ‚Äî HardTanh),         softmax  d,  d ‚Äî    . <br><br>        ,     ,  ‚Äî       (    ),    softmax ‚Äî  ,       core. <br><br><h3> CharCNN-BLSTM-CRF </h3><br>     CharCNN-BLSTM-CRF,    ,   SOTA   2016-2018 ( 2018        ,    NLP     ;      ).     NER       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Lample et al (2016)</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ma &amp; Hovy (2016)</a> . <br><br>     ,    NLP,   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   </a> . <br><br>   -     .      .  ‚Äì   ,  ‚Äì  ,  ‚Äî  :   ,    . .       -  . <br><br>         .    ,    ,      .   ‚Äî              .    Lookup-   ,       ,   . <br><br>  ,    . <br><br>    ,   .   ‚Äî          ,     ,     (        ,    ). <br><br>      CharCNN ( ,     CharRNN).   ,    - .        -     (, 20) ‚Äî  .    ,        ‚Äî        ,      . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/29/n7/t3/29n7t3o1ebdon6m7hfnmgqec3gu.png"></div><br><br> ,       ,    ,    , ‚Äî  (    ).          -  ,           . <br><br>  2  . <br><br>      ‚Äì    (     CharCNN).      ,        sentence based approach   . <br><br> ,             (, 3),     .     max pooling,  1    .                  . <br><br>         ‚Äì       (BLSTM  BiGRU;   ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">   </a> ).             RNN. <br><br> ,    -   .      - . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nm/og/oi/nmogoisze82tw_mm6r-dvs52jh0.png"></div><br><br>     BLSTM  BiGRU.  i-     ,        RNN.             (    RNN),     (    RNN).     -  . <br><br>         NLP,       NLP. <br><br> , ,   NER.  -   ,          .     . <br><br>      ‚Äì        softmax  d,  d ‚Äî    .            (      ). <br><br>   ,     ‚Äî        .        BiRNN,         ,     . ,      I-PER    B-PER  I-PER. <br><br>        ‚Äî  CRF (conditional random fields).     ,    ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>   ),  ,  CRF     ,       . <br><br> ,    CharCNN-BLSTM-CRF,   SOTA   NER        2018 . <br><br>         .    CharCNN   f-   1%, CRF ‚Äî  1-1.5%,          (       multi-task learning,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wu et al (2018)</a> ). BiRNN ‚Äî  , , ,    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a> . <br><br><hr><br> ,          NER.    ,   ,           . <br><br> <i> , <br>  NLP Advanced Research Group</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt449514/">https://habr.com/ru/post/pt449514/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt449500/index.html">Como n√£o entrar em p√¢nico se muitos programadores vieram nos visitar?</a></li>
<li><a href="../pt449502/index.html">Antiguidades: cassete de v√≠deo incr√≠vel</a></li>
<li><a href="../pt449506/index.html">Vis√£o geral: seis maneiras de usar proxies residentes para resolver problemas corporativos</a></li>
<li><a href="../pt449508/index.html">10 recursos √∫teis do R que voc√™ talvez n√£o conhe√ßa</a></li>
<li><a href="../pt449510/index.html">.NET: as boas partes - do CLR √† comunidade</a></li>
<li><a href="../pt449516/index.html">Preparando-se para o hackathon: como se espremer em um m√°ximo de 48 horas</a></li>
<li><a href="../pt449518/index.html">Sele√ß√£o: 5 servi√ßos √∫teis para escrever artigos em ingl√™s</a></li>
<li><a href="../pt449520/index.html">Como eu ensinei um neur√¥nio em um "dinossauro" a tocar</a></li>
<li><a href="../pt449522/index.html">Pensamentos sobre o Elixir: pr√≥s e contras da ferramenta mais popular para desenvolvedores de alta carga</a></li>
<li><a href="../pt449524/index.html">Distinguir caracteres do lixo: como criar modelos de rede neural robustos em tarefas de OCR</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>