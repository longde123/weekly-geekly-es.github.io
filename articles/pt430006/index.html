<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëßüèø üê§ üë®‚Äçüë¶‚Äçüë¶ Projeto Data Science, da pesquisa √† implementa√ß√£o, usando o Talking Hat como exemplo ‚òÉÔ∏è üòΩ üö∂üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="H√° um m√™s, a Lenta lan√ßou um concurso no qual o mesmo chap√©u falante de Harry Potter identifica os participantes que t√™m acesso √† rede social a uma da...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Projeto Data Science, da pesquisa √† implementa√ß√£o, usando o Talking Hat como exemplo</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/430006/"><p><img src="https://habrastorage.org/webt/4h/il/lk/4hillkjrgatenqqix3nypmyn8vm.png"></p><br><p>  H√° um m√™s, a Lenta lan√ßou um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">concurso</a> no qual o mesmo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">chap√©u falante</a> de Harry Potter identifica os participantes que t√™m acesso √† rede social a uma das quatro faculdades.  A competi√ß√£o n√£o √© ruim, os nomes que soam diferentemente s√£o determinados por diferentes faculdades, e nomes e sobrenomes semelhantes em ingl√™s e russo s√£o distribu√≠dos de maneira semelhante.  N√£o sei se a distribui√ß√£o depende apenas dos nomes e sobrenomes, e se o n√∫mero de amigos ou outros fatores s√£o levados em considera√ß√£o, mas essa competi√ß√£o sugeriu a ideia deste artigo: tente treinar um classificador do zero, o que permitir√° que os usu√°rios sejam distribu√≠dos para diferentes faculdades. </p><a name="habracut"></a><br><p>  Neste artigo, criaremos um modelo ML simples que distribui as pessoas para os departamentos de Harry Potter, dependendo do nome e sobrenome, depois de passar por um pequeno processo de pesquisa seguindo a metodologia <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">CRISP</a> .  Ou seja, n√≥s: </p><br><ul><li>  N√≥s formulamos o problema; </li><li>  Investigamos poss√≠veis abordagens para sua solu√ß√£o e formulamos requisitos de dados (m√©todos e dados da solu√ß√£o); </li><li>  Coletaremos os dados necess√°rios (m√©todos e dados da solu√ß√£o); </li><li>  Estudaremos o conjunto de dados coletados (Pesquisa Explorat√≥ria); </li><li>  Extrair recursos de dados brutos (Feature Engineering); </li><li>  Vamos ensinar um modelo de aprendizado de m√°quina (avalia√ß√£o de modelo); </li><li>  Compare os resultados obtidos, avalie a qualidade das solu√ß√µes e, se necess√°rio, repita os par√°grafos 2-6; </li><li>  Empacotamos a solu√ß√£o em um servi√ßo que pode ser usado (Produ√ß√£o). </li></ul><br><p><img src="https://habrastorage.org/webt/6l/pf/oa/6lpfoa17u8pxjkf7wke7pm19-h0.png"></p><br><p>  Essa tarefa pode parecer trivial; portanto, imporemos uma restri√ß√£o adicional a todo o processo (para que leve menos de 2 horas) e a este artigo (para que o tempo de leitura seja menor que 15 minutos). </p><br><p>  Se voc√™ j√° est√° imerso no mundo maravilhoso e maravilhoso da Data Science e n√£o v√™ Kagglite constantemente ou (se Deus n√£o permitir) gosta de medir a dura√ß√£o do seu Hadup durante reuni√µes com colegas, provavelmente o artigo parecer√° simples e desinteressante para voc√™.  Al√©m disso: a qualidade dos modelos finais n√£o √© o principal valor deste artigo.  N√≥s avisamos voc√™.  Vamos l√° </p><br><p>  Um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">reposit√≥rio do github</a> com o c√≥digo usado no artigo tamb√©m est√° dispon√≠vel para leitores curiosos.  Em caso de erros, abra o PR. </p><br><h2 id="formuliruem-zadachu">  N√≥s formulamos o problema </h2><br><p>  √â poss√≠vel resolver um problema que n√£o possui crit√©rios de decis√£o claros por um tempo infinitamente longo, por isso decidimos imediatamente que queremos obter uma solu√ß√£o que nos permita obter a resposta "Grifin√≥ria", "Corvinal", "Lufa-Lufa" ou "Sonserina" em resposta √† linha inserida. </p><br><p>  De fato, queremos obter uma caixa preta: </p><br><pre><code class="plaintext hljs">" " =&gt; [?] =&gt; Griffindor</code> </pre> <br><p>  O chap√©u preto original distribu√≠a jovens magos aos departamentos, dependendo de sua natureza e qualidades pessoais.  Como os dados sobre o car√°ter e a personalidade de acordo com as condi√ß√µes do problema n√£o est√£o dispon√≠veis, usaremos o nome e o sobrenome do participante, lembrando que, neste caso, devemos distribuir os caracteres do livro para os departamentos que correspondem aos departamentos nativos do livro.  E os potteromanos definitivamente ficariam chateados se nossa decis√£o distribu√≠sse Harry para Lufa-Lufa ou Corvinal (mas deveria envi√°-lo √† Grifin√≥ria e √† Sonserina com a mesma probabilidade de transmitir o esp√≠rito do livro). </p><br><p>  Como estamos falando de probabilidades, formalizamos o problema em termos matem√°ticos mais rigorosos.  Do ponto de vista da ci√™ncia de dados, resolvemos o problema de classifica√ß√£o, designando a um objeto (linha, na forma de nome e sobrenome) uma determinada classe (na verdade, √© apenas um r√≥tulo ou r√≥tulo, que pode ser um n√∫mero ou 4 vari√°veis ‚Äã‚Äãcom valor sim / n√£o )  Entendemos que, pelo menos no caso de Harry, ser√° correto dar duas respostas: Grifin√≥ria e Sonserina, portanto, seria melhor n√£o prever a faculdade espec√≠fica que o chap√©u define, mas a probabilidade de que uma pessoa seja alocada para essa faculdade, para que nossa decis√£o seja tomada. tipo de alguma fun√ß√£o </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;lt;</mo><mi>N</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo>&amp;gt;&amp;lt;</mo><mi>S</mi><mi>o</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo>&amp;gt;</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>g</mi><mi>r</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>r</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>w</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>h</mi><mi>u</mi><mi>f</mi><mi>f</mi><mi>l</mi><mi>p</mi><mi>u</mi><mi>f</mi><mi>f</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="74.986ex" height="2.78ex" viewBox="0 -832 32285.4 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3C" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-4E" x="1996" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="2884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="3370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="4248" y="0"></use><g transform="translate(4993,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3E"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3C" x="778" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-53" x="6827" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="7473" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-62" x="7958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="8388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="8839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="9306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="9906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="10392" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="11270" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3E" x="12015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-29" x="12793" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3D" x="13460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-28" x="14517" y="0"></use><g transform="translate(14906,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-67" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="480" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-69" x="932" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-66" x="1277" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-66" x="1827" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-69" x="2378" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="2724" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-64" x="3324" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="3848" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="4333" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3B" x="19032" y="0"></use><g transform="translate(19477,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-61" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-76" x="981" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="1466" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="1932" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-63" x="2533" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6C" x="2967" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-61" x="3265" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-77" x="3795" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3B" x="23410" y="0"></use><g transform="translate(23855,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-68" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-75" x="576" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-66" x="1149" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-66" x="1699" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6C" x="2250" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-70" x="2548" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-75" x="3052" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-66" x="3624" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-66" x="4175" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3B" x="27939" y="0"></use><g transform="translate(28384,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-50" x="0" y="0"></use><g transform="translate(642,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6C" x="469" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-69" x="768" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-74" x="1113" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-68" x="1475" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="2051" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="2518" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-69" x="2969" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="3315" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-29" x="31895" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mo>&lt;</mo><mi>N</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo>&gt;&lt;</mo><mi>S</mi><mi>o</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo>&gt;</mo><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>g</mi><mi>r</mi><mi>i</mi><mi>f</mi><mi>f</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>o</mi><mi>r</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>r</mi><mi>a</mi><mi>v</mi><mi>e</mi><mi>n</mi><mi>c</mi><mi>l</mi><mi>a</mi><mi>w</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>h</mi><mi>u</mi><mi>f</mi><mi>f</mi><mi>l</mi><mi>p</mi><mi>u</mi><mi>f</mi><mi>f</mi></mrow></msub><mo>;</mo><msub><mi>P</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>l</mi><mi>i</mi><mi>t</mi><mi>h</mi><mi>e</mi><mi>r</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> f (<Nome> <Sobrenome>) = (P_ {griffindor}; P_ {ravenclaw}; P_ {hufflpuff}; P_ {slitherin}) </script></p><br><h3 id="metriki-i-ocenka-kachestva">  M√©tricas e avalia√ß√£o da qualidade </h3><br><p>  A tarefa e o objetivo s√£o formulados, <del>  Agora vamos pensar em como resolv√™-lo </del>  mas isso n√£o √© tudo.  Para iniciar o estudo, voc√™ precisa inserir m√©tricas de qualidade.  Em outras palavras, para determinar como vamos comparar duas solu√ß√µes diferentes entre si. </p><br><p>  Tudo na vida √© bom e simples - entendemos intuitivamente que um detector de spam deve passar o m√≠nimo de spam para as mensagens recebidas, al√©m de passar o m√°ximo de letras necess√°rias e certamente n√£o deve enviar as letras necess√°rias para o spam. </p><br><p>  Na realidade, tudo √© mais complicado e a confirma√ß√£o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">disso √© um</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">grande</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">n√∫mero de</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigos</a> que explicam como e quais m√©tricas s√£o usadas.  A pr√°tica ajuda a entender melhor isso, mas esse √© um t√≥pico t√£o volumoso que prometemos escrever um post separado sobre ele e criar uma mesa aberta para que todos possam brincar e entender na pr√°tica como isso difere. </p><br><p>  O agregado familiar ‚Äúmas vamos escolher o melhor‚Äù para n√≥s ser√° o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ROC AUC</a> .  √â exatamente isso que queremos da m√©trica nesse caso: quanto menos falsos positivos e mais precisa a previs√£o real, maior a AUC do ROC. </p><br><p>  Para um modelo ROC ideal, AUC √© 1, para um modelo aleat√≥rio ideal que define classes <em>absolutamente aleatoriamente</em> - 0,5. </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>R</mi><mi>O</mi><mi>C</mi><mtext>&amp;#xA0;</mtext><mi>A</mi><mi>U</mi><mi>C</mi><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>m</mi><mo stretchy=&quot;false&quot;>[</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.73ex" height="2.66ex" viewBox="0 -832 9355.8 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-4F" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-43" x="1523" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-41" x="2533" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-55" x="3284" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-43" x="4051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="5062" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="5528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-5B" x="6407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-30" x="6685" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-2C" x="7186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-35" x="7631" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3B" x="8131" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-31" x="8576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-5D" x="9077" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>R</mi><mi>O</mi><mi>C</mi><mtext>&nbsp;</mtext><mi>A</mi><mi>U</mi><mi>C</mi><mtext>&nbsp;</mtext><mi>e</mi><mi>m</mi><mo stretchy="false">[</mo><mn>0</mn><mo>,</mo><mn>5</mn><mo>;</mo><mn>1</mn><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> ROC \ AUC \ em [0,5; 1] </script></p><br><h2 id="algoritmy">  Algoritmos </h2><br><p>  Nossa caixa preta deve levar em conta a distribui√ß√£o dos her√≥is dos livros, usar um nome e sobrenome diferentes como entrada e fornecer o resultado.  Para resolver o problema de classifica√ß√£o, voc√™ pode usar diferentes algoritmos de aprendizado de m√°quina: </p><br><p>  redes neurais, m√°quinas de fatora√ß√£o, regress√£o linear ou, por exemplo, SVM. </p><br><p>  Ao contr√°rio da cren√ßa popular, a Ci√™ncia de Dados n√£o se limita apenas √†s redes neurais e, para popularizar essa id√©ia, neste artigo as redes neurais s√£o deixadas <em>como um exerc√≠cio para um leitor curioso</em> .  Aqueles que n√£o fizeram um √∫nico curso de an√°lise de dados (especialmente o subjetivamente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">melhor</a> do ODS), ou simplesmente leram <em>n</em> not√≠cias sobre aprendizado de m√°quina ou IA, que agora s√£o publicadas mesmo nas revistas de pescadores amadores, devem ter encontrado os nomes de grupos gerais de algoritmos : ensacamento, refor√ßo, m√©todo de vetor de suporte (SVM), regress√£o linear.  S√£o eles que usaremos para resolver nosso problema. </p><br><p>  E para ser mais preciso, comparamos: </p><br><ul><li>  Regress√£o linear </li><li>  Refor√ßo (XGboost, LightGBM) </li><li>  Decidir √°rvores (estritamente falando, esse √© o mesmo impulso, mas o removeremos separadamente: √Årvores Extra) </li><li>  Ensacamento (floresta aleat√≥ria) </li><li>  SVM </li></ul><br><p>  Podemos resolver o problema de distribuir cada aluno de Hogwarts a uma das faculdades definindo a faculdade correspondente a ele, mas, estritamente falando, essa tarefa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">se resume</a> a resolver o problema de determinar se cada classe pertence individualmente.  Portanto, no quadro deste artigo, estabelecemos o objetivo de obter 4 modelos, um para cada faculdade. </p><br><h2 id="dannye">  Dados </h2><br><p>  Encontrar o conjunto de dados correto para treinamento e, mais importante, legal para us√°-lo para a finalidade correta, √© uma das tarefas mais complexas e demoradas da Data Science.  Para nossa tarefa, levaremos os dados da <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">wikia</a> ao redor do mundo de Harry Potter.  Por exemplo, neste link voc√™ encontra todos os personagens que estudaram na faculdade da Grifin√≥ria.  √â importante que neste caso usemos os dados para fins n√£o comerciais, portanto, n√£o violamos a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">licen√ßa</a> deste site. </p><br><p><img src="https://habrastorage.org/webt/ff/f8/4e/fff84efaafg_yqwbhuhbfyz17k0.jpeg"></p><br><p>  Para aqueles que pensam que os cientistas de dados s√£o pessoas t√£o legais, eu vou at√© os cientistas de dados e deixo-me ensinar, lembramos que existe uma etapa como limpar e preparar dados.  Os dados baixados devem ser moderados manualmente para excluir, por exemplo, ‚ÄúO S√©timo Prefeito da Grifin√≥ria‚Äù e excluir a ‚ÄúGarota Desconhecida da Grifin√≥ria‚Äù semi-automaticamente.  No trabalho real, uma parte proporcionalmente grande da tarefa est√° sempre associada √† prepara√ß√£o, limpeza e restaura√ß√£o de valores ausentes no conjunto de dados. </p><br><p>  Um pouco de ctrl + c &amp; ctrl + ve na sa√≠da temos 4 arquivos de texto, que cont√™m os nomes dos caracteres em 2 idiomas: ingl√™s e russo. </p><br><h2 id="izuchaem-sobrannye-dannye--eda-exploratory-data-analysis">  Estudamos os dados coletados (EDA, An√°lise Explorat√≥ria de Dados) </h2><br><p>  Para esta etapa, temos 4 arquivos contendo os nomes dos alunos das faculdades, veremos com mais detalhes: </p><br><pre> <code class="bash hljs">$ ls ../input griffindor.txt hufflpuff.txt ravenclaw.txt slitherin.txt</code> </pre> <br><p>  Cada arquivo cont√©m 1 nome e sobrenome (se houver) do aluno por linha: </p><br><pre> <code class="bash hljs">$ wc -l ../input/*.txt 250 ../input/griffindor.txt 167 ../input/hufflpuff.txt 180 ../input/ravenclaw.txt 254 ../input/slitherin.txt 851 total</code> </pre> <br><p>  Os dados coletados t√™m o formato: </p><br><pre> <code class="bash hljs">$ cat ../input/griffindor.txt | head -3 &amp;&amp; cat ../input/griffindor.txt | tail -3      Charlie Stainforth Melanie Stanmore Stewart</code> </pre> <br><p>  Toda a nossa id√©ia baseia-se no pressuposto de que h√° algo semelhante nos nomes e sobrenomes que nossa caixa preta (ou chap√©u preto) pode aprender a distinguir. </p><br><p>  O algoritmo pode alimentar as linhas como est√£o, mas o resultado n√£o ser√° bom, porque os modelos b√°sicos n√£o ser√£o capazes de entender independentemente como "Draco" difere de "Harry"; portanto, precisaremos extrair sinais de nossos nomes e sobrenomes. </p><br><h3 id="podgotovka-dannyh-feature-engineering">  Prepara√ß√£o de Dados (Engenharia de Recursos) </h3><br><p>  <strong>Sinais</strong> (ou recursos, do <strong>recurso</strong> <em>ingl√™s</em> - propriedade) s√£o as propriedades distintivas de um objeto.  O n√∫mero de vezes que uma pessoa mudou de emprego no ano passado, o n√∫mero de dedos na m√£o esquerda, a capacidade do motor, se a quilometragem do carro excede 100.000 km ou n√£o.  Todos os tipos de classifica√ß√µes de sinais foram inventados por um n√∫mero muito grande; n√£o existe e n√£o pode haver um sistema √∫nico nesse sentido; portanto, daremos exemplos de quais sinais podem ser: </p><br><ol><li>  N√∫mero racional </li><li>  Categoria (at√© 12, 12-18 ou 18+) </li><li>  Valor bin√°rio (retornou o primeiro empr√©stimo ou n√£o) </li><li>  Data, cor, compartilhamentos etc. </li></ol><br><p>  <strong>A pesquisa</strong> (ou forma√ß√£o) de <strong>recursos</strong> (em <em>ingl√™s,</em> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Feature Engineering</a> ) muitas vezes se destaca como um est√°gio separado da pesquisa ou o trabalho de um especialista em an√°lise de dados.  De fato, o senso comum, a experi√™ncia e o teste de hip√≥teses ajudam no pr√≥prio processo.  Adivinhar os sinais certos imediatamente √© uma quest√£o de uma combina√ß√£o de m√£o cheia, conhecimento fundamental e sorte.  √Äs vezes, existe xamanismo, mas a abordagem geral √© muito simples: voc√™ precisa fazer o que vem √† mente e depois verificar se era poss√≠vel melhorar a solu√ß√£o adicionando um novo atributo.  Por exemplo, como um sinal para nossa tarefa, podemos pegar o n√∫mero de chiados no nome. </p><br><p>  Na primeira vers√£o (porque o verdadeiro estudo de Ci√™ncia de Dados - como uma obra-prima, nunca pode ser conclu√≠do) do nosso modelo, usaremos os seguintes recursos para o nome e o sobrenome: </p><br><ol><li>  1 e a √∫ltima letra da palavra - vogal ou consoante </li><li>  Vogais e consoantes duplas </li><li>  N√∫mero de vogais, consoantes, surdas, sonoras </li><li>  Comprimento do nome, comprimento do sobrenome </li><li>  ... </li></ol><br><p>  Para fazer isso, tomaremos <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">esse</a> reposit√≥rio como base e adicionaremos uma classe para que possa ser usado para letras latinas.  Isso nos dar√° a oportunidade de determinar como cada letra soa. </p><br><pre> <code class="python hljs">&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> Phonetic <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RussianLetter, EnglishLetter &gt;&gt; RussianLetter(<span class="hljs-string"><span class="hljs-string">''</span></span>).classify() {<span class="hljs-string"><span class="hljs-string">'consonant'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'deaf'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'hard'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'mark'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'paired'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'shock'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'soft'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'sonorus'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>} &gt;&gt; EnglishLetter(<span class="hljs-string"><span class="hljs-string">'d'</span></span>).classify() {<span class="hljs-string"><span class="hljs-string">'consonant'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'deaf'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'hard'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'mark'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'paired'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'shock'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'soft'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>, <span class="hljs-string"><span class="hljs-string">'sonorus'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>}</code> </pre> <br><p>  Agora podemos definir fun√ß√µes simples para calcular estat√≠sticas, por exemplo: </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">starts_with_letter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(word, letter_type=</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'vowel'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""   ,    . :param word:  :param letter_type: 'vowel'  'consonant'.   . :return: Boolean """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(word) == <span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Letter(word[<span class="hljs-number"><span class="hljs-number">0</span></span>]).classify()[letter_type] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count_letter_type</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(word)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""       . :param word:  :param debug:    :return: :obj:`dict` of :obj:`str` =&gt; :int:count """</span></span> count = { <span class="hljs-string"><span class="hljs-string">'consonant'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'deaf'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'hard'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'mark'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'paired'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'shock'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'soft'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'sonorus'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> letter <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> word: classes = Letter(letter).classify() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> count.keys(): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> classes[key]: count[key] += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> count</code> </pre> <br><p>  Usando essas fun√ß√µes, j√° podemos obter os primeiros sinais: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> feature_engineering <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * &gt;&gt; print(<span class="hljs-string"><span class="hljs-string">"  (¬´¬ª): "</span></span>, len(<span class="hljs-string"><span class="hljs-string">""</span></span>))   (¬´¬ª): <span class="hljs-number"><span class="hljs-number">5</span></span> &gt;&gt; print(<span class="hljs-string"><span class="hljs-string">" (¬´¬ª)   : "</span></span>, starts_with_letter(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'vowel'</span></span>))  (¬´¬ª)   : <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> &gt;&gt; print(<span class="hljs-string"><span class="hljs-string">" (¬´¬ª)   : "</span></span>, starts_with_letter(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'consonant'</span></span>))  (¬´¬ª)   : <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> &gt;&gt; count_Harry = count_letter_type(<span class="hljs-string"><span class="hljs-string">""</span></span>) &gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"     (¬´¬ª): "</span></span>, count_Harry[<span class="hljs-string"><span class="hljs-string">'paired'</span></span>])      (¬´¬ª): <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p>  A rigor, com a ajuda dessas fun√ß√µes, podemos obter uma representa√ß√£o vetorial da string, ou seja, obtemos o mapeamento: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mo>&amp;lt;</mo><mi>N</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo>&amp;gt;&amp;lt;</mo><mi>S</mi><mi>o</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo>&amp;gt;</mo><mo stretchy=&quot;false&quot;>)</mo><mo>=&amp;gt;</mo><mo stretchy=&quot;false&quot;>(</mo><mi>c</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi><mi>o</mi><mi>m</mi><mi>e</mi></mrow></msub><mo>,</mo><mi>c</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><msub><mi>o</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>o</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>o</mi><mi>m</mi><mi>e</mi><mi>s</mi></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFA;</mo></mrow><mi>m</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>d</mi><mi>e</mi><msub><mtext>&amp;#xA0;</mtext><mi>v</mi></msub><mi>o</mi><mi>g</mi><mi>a</mi><mi>i</mi><msub><mi>s</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>s</mi><mi>o</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>o</mi><mi>m</mi><mi>e</mi><mi>s</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="109.615ex" height="2.66ex" viewBox="0 -832 47195.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3C" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-4E" x="1996" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="2884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="3370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="4248" y="0"></use><g transform="translate(4993,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3E"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3C" x="778" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-53" x="6827" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="7473" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-62" x="7958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="8388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="8839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="9306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="9906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="10392" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="11270" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3E" x="12015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-29" x="12793" y="0"></use><g transform="translate(13460,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3D"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-3E" x="778" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-28" x="15295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-63" x="15685" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="16118" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="16604" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-70" x="17482" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="17986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-69" x="18437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="18783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="19661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="20128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-74" x="20728" y="0"></use><g transform="translate(21090,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="0" y="0"></use><g transform="translate(485,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="600" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="1086" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="1964" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-2C" x="23394" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-63" x="23839" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="24273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="24758" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-70" x="25637" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="26140" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-69" x="26592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="26937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="27816" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="28282" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-74" x="28883" y="0"></use><g transform="translate(29244,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="0" y="0"></use><g transform="translate(485,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="469" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-62" x="955" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="1384" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="1836" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="2302" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="2903" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="3388" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="4267" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-73" x="4733" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-2C" x="33509" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-2E" x="33954" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-2E" x="34399" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-2E" x="34844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-2C" x="35290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="35735" y="0"></use><g transform="translate(36335,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">√∫</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="36750" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="37629" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="38095" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="38547" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-64" x="39032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="39556" y="0"></use><g transform="translate(40022,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-76" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="40716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-67" x="41201" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-61" x="41682" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-69" x="42211" y="0"></use><g transform="translate(42557,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="469" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-62" x="955" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-72" x="1384" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="1836" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6E" x="2302" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6F" x="2903" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-6D" x="3388" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-65" x="4267" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMATHI-73" x="4733" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://habr.com/ru/company/ods/blog/430006/&amp;usg=ALkJrhjpiczH6yLSWLp2rcZNYrwKOLzCbg#MJMAIN-29" x="46805" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mo>&lt;</mo><mi>N</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo>&gt;&lt;</mo><mi>S</mi><mi>o</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>o</mi><mi>m</mi><mi>e</mi><mo>&gt;</mo><mo stretchy="false">)</mo><mo>=&gt;</mo><mo stretchy="false">(</mo><mi>c</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>n</mi><mi>o</mi><mi>m</mi><mi>e</mi></mrow></msub><mo>,</mo><mi>c</mi><mi>o</mi><mi>m</mi><mi>p</mi><mi>r</mi><mi>i</mi><mi>m</mi><mi>e</mi><mi>n</mi><mi>t</mi><msub><mi>o</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>o</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>o</mi><mi>m</mi><mi>e</mi><mi>s</mi></mrow></msub><mo>,</mo><mo>.</mo><mo>.</mo><mo>.</mo><mo>,</mo><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo>√∫</mo></mrow><mi>m</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>d</mi><mi>e</mi><msub><mtext>&nbsp;</mtext><mi>v</mi></msub><mi>o</mi><mi>g</mi><mi>a</mi><mi>i</mi><msub><mi>s</mi><mrow class="MJX-TeXAtom-ORD"><mi>s</mi><mi>o</mi><mi>b</mi><mi>r</mi><mi>e</mi><mi>n</mi><mi>o</mi><mi>m</mi><mi>e</mi><mi>s</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> f (<Nome> <Sobrenome>) => (comprimento_ {nome}, comprimento_ {sobrenomes}, ..., n√∫mero de \ _vogais_ {sobrenomes}) </script></p><br><p>  Agora, podemos apresentar nossos dados na forma de um conjunto de dados que pode ser inserido no algoritmo de aprendizado de m√°quina: </p><br><pre> <code class="python hljs">&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> data_loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_processed_data &gt;&gt; hogwarts_df = load_processed_data() &gt;&gt; hogwarts_df.head()</code> </pre> <br><p><img src="https://habrastorage.org/webt/5-/-e/4g/5--e4gvhmdhe00fxjhwqnxzdajk.png"></p><br><p>  Al√©m disso, como resultado, temos os seguintes sintomas para cada aluno: </p><br><pre> <code class="python hljs">&gt;&gt; hogwarts_df[hogwarts_df.columns].dtypes</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Sinais Recebidos</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">name object surname object is_english bool name_starts_with_vowel bool name_starts_with_consonant bool name_ends_with_vowel bool name_ends_with_consonant bool name_length int64 name_vowels_count int64 name_double_vowels_count int64 name_consonant_count int64 name_double_consonant_count int64 name_paired_count int64 name_deaf_count int64 name_sonorus_count int64 surname_starts_with_vowel bool surname_starts_with_consonant bool surname_ends_with_vowel bool surname_ends_with_consonant bool surname_length int64 surname_vowels_count int64 surname_double_vowels_count int64 surname_consonant_count int64 surname_double_consonant_count int64 surname_paired_count int64 surname_deaf_count int64 surname_sonorus_count int64 is_griffindor int64 is_hufflpuff int64 is_ravenclaw int64 is_slitherin int64 dtype: object</code> </pre> </div></div><br><p>  As √∫ltimas 4 colunas s√£o direcionadas - elas cont√™m informa√ß√µes em que faculdade um aluno est√° matriculado. </p><br><h2 id="obuchenie-algoritmov">  Treinamento de algoritmo </h2><br><p>  Em suma, os algoritmos s√£o treinados como as pessoas: eles cometem erros e aprendem com eles.  Para entender o quanto eles cometeram um erro, os algoritmos usam fun√ß√µes de <strong>erro</strong> (fun√ß√µes de perda, fun√ß√£o de <strong>perda em</strong> <em>ingl√™s</em> ). </p><br><p>  Como regra, o processo de aprendizado √© muito simples e consiste em v√°rias etapas: </p><br><ol><li>  Fa√ßa uma previs√£o. </li><li>  Classifique o erro. </li><li>  Corrija os par√¢metros do modelo. </li><li>  Repita 1-3 at√© o objetivo ser alcan√ßado, o processo parar ou os dados terminarem. </li><li><p>  Classifique a qualidade do modelo resultante. </p><br><p>  Na pr√°tica, √© claro, tudo √© um pouco mais complicado.  Por exemplo, existe o fen√¥meno da <strong>super adapta√ß√£o</strong> - o algoritmo pode literalmente lembrar quais recursos correspondem √† resposta e, assim, piorar o resultado para objetos que n√£o s√£o semelhantes aos sobre os quais ele foi treinado.  Para evitar isso, existem v√°rias t√©cnicas e hacks. </p><br></li></ol><br><p>  Como mencionado acima, resolveremos 4 problemas: um para cada faculdade.  Portanto, prepararemos dados para a Sonserina: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  ,     - : &gt;&gt; data_full = hogwarts_df.drop( [ 'name', 'surname', 'is_griffindor', 'is_hufflpuff', 'is_ravenclaw' ], axis=1).copy() #    ,   : &gt;&gt; X_data = data_full.drop('is_slitherin', axis=1) #     ,   1    &gt;&gt; y = data_full.is_slitherin</span></span></code> </pre> <br><p>  Enquanto aprende, o algoritmo constantemente compara seus resultados com dados reais, pois essa parte do conjunto de dados √© alocada para valida√ß√£o.  A regra do bom tom tamb√©m √© considerada para avaliar o resultado do algoritmo em dados individuais que o algoritmo n√£o viu.  Portanto, agora dividimos a amostra na propor√ß√£o de 70/30 e treinamos o primeiro algoritmo: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.cross_validation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestClassifier <span class="hljs-comment"><span class="hljs-comment">#      &gt;&gt; seed = 7 #    &gt;&gt; test_size = 0.3 &gt;&gt; X_train, X_test, y_train, y_test = train_test_split(X_data, y, test_size=test_size, random_state=seed) &gt;&gt; rfc = RandomForestClassifier() &gt;&gt; rfc_model = rfc.fit(X_train, y_train)</span></span></code> </pre> <br><p>  Feito.  Agora, se voc√™ enviar dados para a entrada desse modelo, ele produzir√° um resultado.  Isso √© divertido, ent√£o primeiro vamos verificar se o modelo em Harry reconhece o sonserino.  Para fazer isso, primeiro prepare as fun√ß√µes para obter a previs√£o do algoritmo: </p><br><div class="spoiler">  <b class="spoiler_title">Ver c√≥digo</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> data_loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> parse_line_to_hogwarts_df <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_single_student_features</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(name)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""      :param name: string     :return: pd.DataFrame     """</span></span> featurized_person_df = parse_line_to_hogwarts_df(name) person_df = pd.DataFrame(featurized_person_df, columns=[ <span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname'</span></span>, <span class="hljs-string"><span class="hljs-string">'is_english'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_starts_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_starts_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_ends_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_ends_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_length'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_double_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_double_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_paired_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_deaf_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'name_sonorus_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_starts_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_starts_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_ends_with_vowel'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_ends_with_consonant'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_length'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_double_vowels_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_double_consonant_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_paired_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_deaf_count'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname_sonorus_count'</span></span>, ], index=[<span class="hljs-number"><span class="hljs-number">0</span></span>] ) featurized_person = person_df.drop( [<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname'</span></span>], axis = <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> featurized_person <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_predictions_vector</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(model, person)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    :param model:   :param person: string   :return: list    """</span></span> encoded_person = get_single_student_features(person) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model.predict_proba(encoded_person)[<span class="hljs-number"><span class="hljs-number">0</span></span>]</code> </pre> </div></div><br><p>  Agora vamos definir um pequeno conjunto de dados de teste para considerar os resultados do algoritmo. </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">score_testing_dataset</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(model)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""      . :param model:   """</span></span> testing_dataset = [ <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Kirill Malev"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Harry Potter"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-string"><span class="hljs-string">"Severus Snape"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Tom Riddle"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Salazar Slytherin"</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> testing_dataset: <span class="hljs-keyword"><span class="hljs-keyword">print</span></span> (<span class="hljs-string"><span class="hljs-string">"{} ‚Äî {}"</span></span>.format(name, get_predictions_vector(model, name)[<span class="hljs-number"><span class="hljs-number">1</span></span>])) score_testing_dataset(rfc_model)</code> </pre> <br><pre> <code class="plaintext hljs">  ‚Äî 0.5 Kirill Malev ‚Äî 0.5   ‚Äî 0.0 Harry Potter ‚Äî 0.0   ‚Äî 0.75   ‚Äî 0.9 Severus Snape ‚Äî 0.5   ‚Äî 0.2 Tom Riddle ‚Äî 0.5   ‚Äî 0.2 Salazar Slytherin ‚Äî 0.3</code> </pre> <br><p>  Os resultados foram duvidosos.  Mesmo o fundador da faculdade n√£o estaria em sua faculdade, de acordo com esse modelo.  Portanto, voc√™ precisa avaliar a qualidade estrita: observe as m√©tricas solicitadas no in√≠cio: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> accuracy_score, roc_auc_score, classification_report predictions = rfc_model.predict(X_test) print(<span class="hljs-string"><span class="hljs-string">"Classification report: "</span></span>) print(classification_report(y_test, predictions)) print(<span class="hljs-string"><span class="hljs-string">"Accuracy for Random Forest Model: %.2f"</span></span> % (accuracy_score(y_test, predictions) * <span class="hljs-number"><span class="hljs-number">100</span></span>)) print(<span class="hljs-string"><span class="hljs-string">"ROC AUC from first Random Forest Model: %.2f"</span></span> % (roc_auc_score(y_test, predictions)))</code> </pre> <br><pre> <code class="plaintext hljs">Classification report: precision recall f1-score support 0 0.66 0.88 0.75 168 1 0.38 0.15 0.21 89 avg / total 0.56 0.62 0.56 257 Accuracy for Random Forest Model: 62.26 ROC AUC from first Random Forest Model: 0.51</code> </pre> <br><p>  N√£o √© de surpreender que os resultados tenham sido t√£o duvidosos - a AUC do ROC de cerca de 0,51 sugere que o modelo prev√™ um pouco melhor do que um sorteio. </p><br><h2 id="testirovanie-poluchennyh-rezultatov-metriki-kachestva">  Testando os resultados.  M√©tricas de qualidade </h2><br><p>  Usando um exemplo acima, vimos como um algoritmo √© treinado que suporta interfaces sklearn.  O restante √© treinado exatamente da mesma maneira, para que possamos treinar apenas todos os algoritmos e escolher o melhor em cada caso. </p><br><p><img src="https://habrastorage.org/webt/ff/i0/fq/ffi0fqqs7gbi3aczbucvusrw2qi.jpeg"></p><br><p>  Isso n√£o √© complicado, pois para cada algoritmo treinamos 1 com configura√ß√µes padr√£o e tamb√©m treinamos um conjunto inteiro, classificando v√°rias op√ß√µes que afetam a qualidade do algoritmo.  Esse est√°gio √© chamado de Model Tuning ou Hyperparameter Optimization e sua ess√™ncia √© muito simples: o conjunto de configura√ß√µes que fornece o melhor resultado √© selecionado. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> model_training <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_classifiers <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> data_loaders <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> load_processed_data <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> warnings warnings.filterwarnings(<span class="hljs-string"><span class="hljs-string">'ignore'</span></span>) <span class="hljs-comment"><span class="hljs-comment">#   hogwarts_df = load_processed_data() #     data_full = hogwarts_df.drop( [ 'name', 'surname', 'is_griffindor', 'is_hufflpuff', 'is_ravenclaw' ], axis=1).copy() X_data = data_full.drop('is_slitherin', axis=1) y = data_full.is_slitherin #    slitherin_models = train_classifiers(data_full, X_data, y) score_testing_dataset(slitherin_models[5])</span></span></code> </pre> <br><pre> <code class="plaintext hljs">  ‚Äî 0.09437856871661066 Kirill Malev ‚Äî 0.20820536334902712   ‚Äî 0.07550095601699099 Harry Potter ‚Äî 0.07683794773639624   ‚Äî 0.9414529336862744   ‚Äî 0.9293671807790949 Severus Snape ‚Äî 0.6576783576162999   ‚Äî 0.18577792617672767 Tom Riddle ‚Äî 0.8351835484058869   ‚Äî 0.25930925139546795 Salazar Slytherin ‚Äî 0.24008788903854789</code> </pre> <br><p>  Os n√∫meros nesta vers√£o parecem subjetivamente melhores do que no passado, mas ainda n√£o s√£o bons o suficiente para um perfeccionista interno.  Portanto, desceremos um n√≠vel mais profundo e retornaremos ao sentido do produto de nossa tarefa: precisamos prever a faculdade mais prov√°vel, √† qual o her√≥i ser√° determinado pelo chap√©u de distribui√ß√£o.  Isso significa que voc√™ precisa treinar modelos para cada uma das faculdades. </p><br><p><img src="https://habrastorage.org/webt/hc/ag/ci/hcagciojsjdzpglovd1xabohtym.jpeg"></p><br><pre> <code class="python hljs">&gt;&gt; <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> model_training <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_all_models <span class="hljs-comment"><span class="hljs-comment">#      &gt;&gt; slitherin_models, griffindor_models, ravenclaw_models, hufflpuff_models = \ train_all_models()</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Conclus√£o longa de resultados e resultados de regress√£o multinomial</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">SVM Default Report Accuracy for SVM Default: 73.93 ROC AUC for SVM Default: 0.53 Tuned SVM Report Accuracy for Tuned SVM: 72.37 ROC AUC for Tuned SVM: 0.50 KNN Default Report Accuracy for KNN Default: 70.04 ROC AUC for KNN Default: 0.58 Tuned KNN Report Accuracy for Tuned KNN: 69.65 ROC AUC for Tuned KNN: 0.58 XGBoost Default Report Accuracy for XGBoost Default: 70.43 ROC AUC for XGBoost Default: 0.54 Tuned XGBoost Report Accuracy for Tuned XGBoost: 68.09 ROC AUC for Tuned XGBoost: 0.56 Random Forest Default Report Accuracy for Random Forest Default: 73.93 ROC AUC for Random Forest Default: 0.62 Tuned Random Forest Report Accuracy for Tuned Random Forest: 74.32 ROC AUC for Tuned Random Forest: 0.54 Extra Trees Default Report Accuracy for Extra Trees Default: 69.26 ROC AUC for Extra Trees Default: 0.57 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 73.54 ROC AUC for Tuned Extra Trees: 0.55 LGBM Default Report Accuracy for LGBM Default: 70.82 ROC AUC for LGBM Default: 0.62 Tuned LGBM Report Accuracy for Tuned LGBM: 74.71 ROC AUC for Tuned LGBM: 0.53 RGF Default Report Accuracy for RGF Default: 70.43 ROC AUC for RGF Default: 0.58 Tuned RGF Report Accuracy for Tuned RGF: 71.60 ROC AUC for Tuned RGF: 0.60 FRGF Default Report Accuracy for FRGF Default: 68.87 ROC AUC for FRGF Default: 0.59 Tuned FRGF Report Accuracy for Tuned FRGF: 69.26 ROC AUC for Tuned FRGF: 0.59 SVM Default Report Accuracy for SVM Default: 70.43 ROC AUC for SVM Default: 0.50 Tuned SVM Report Accuracy for Tuned SVM: 71.60 ROC AUC for Tuned SVM: 0.50 KNN Default Report Accuracy for KNN Default: 63.04 ROC AUC for KNN Default: 0.49 Tuned KNN Report Accuracy for Tuned KNN: 65.76 ROC AUC for Tuned KNN: 0.50 XGBoost Default Report Accuracy for XGBoost Default: 69.65 ROC AUC for XGBoost Default: 0.54 Tuned XGBoost Report Accuracy for Tuned XGBoost: 68.09 ROC AUC for Tuned XGBoost: 0.50 Random Forest Default Report Accuracy for Random Forest Default: 66.15 ROC AUC for Random Forest Default: 0.51 Tuned Random Forest Report Accuracy for Tuned Random Forest: 70.43 ROC AUC for Tuned Random Forest: 0.50 Extra Trees Default Report Accuracy for Extra Trees Default: 64.20 ROC AUC for Extra Trees Default: 0.49 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 70.82 ROC AUC for Tuned Extra Trees: 0.51 LGBM Default Report Accuracy for LGBM Default: 67.70 ROC AUC for LGBM Default: 0.56 Tuned LGBM Report Accuracy for Tuned LGBM: 70.82 ROC AUC for Tuned LGBM: 0.50 RGF Default Report Accuracy for RGF Default: 66.54 ROC AUC for RGF Default: 0.52 Tuned RGF Report Accuracy for Tuned RGF: 65.76 ROC AUC for Tuned RGF: 0.53 FRGF Default Report Accuracy for FRGF Default: 65.76 ROC AUC for FRGF Default: 0.53 Tuned FRGF Report Accuracy for Tuned FRGF: 69.65 ROC AUC for Tuned FRGF: 0.52 SVM Default Report Accuracy for SVM Default: 74.32 ROC AUC for SVM Default: 0.50 Tuned SVM Report Accuracy for Tuned SVM: 74.71 ROC AUC for Tuned SVM: 0.51 KNN Default Report Accuracy for KNN Default: 69.26 ROC AUC for KNN Default: 0.48 Tuned KNN Report Accuracy for Tuned KNN: 73.15 ROC AUC for Tuned KNN: 0.49 XGBoost Default Report Accuracy for XGBoost Default: 72.76 ROC AUC for XGBoost Default: 0.49 Tuned XGBoost Report Accuracy for Tuned XGBoost: 74.32 ROC AUC for Tuned XGBoost: 0.50 Random Forest Default Report Accuracy for Random Forest Default: 73.93 ROC AUC for Random Forest Default: 0.52 Tuned Random Forest Report Accuracy for Tuned Random Forest: 74.32 ROC AUC for Tuned Random Forest: 0.50 Extra Trees Default Report Accuracy for Extra Trees Default: 73.93 ROC AUC for Extra Trees Default: 0.52 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 73.93 ROC AUC for Tuned Extra Trees: 0.50 LGBM Default Report Accuracy for LGBM Default: 73.54 ROC AUC for LGBM Default: 0.52 Tuned LGBM Report Accuracy for Tuned LGBM: 74.32 ROC AUC for Tuned LGBM: 0.50 RGF Default Report Accuracy for RGF Default: 73.54 ROC AUC for RGF Default: 0.51 Tuned RGF Report Accuracy for Tuned RGF: 73.93 ROC AUC for Tuned RGF: 0.50 FRGF Default Report Accuracy for FRGF Default: 73.93 ROC AUC for FRGF Default: 0.53 Tuned FRGF Report Accuracy for Tuned FRGF: 73.93 ROC AUC for Tuned FRGF: 0.50 SVM Default Report Accuracy for SVM Default: 80.54 ROC AUC for SVM Default: 0.50 Tuned SVM Report Accuracy for Tuned SVM: 80.93 ROC AUC for Tuned SVM: 0.52 KNN Default Report Accuracy for KNN Default: 78.60 ROC AUC for KNN Default: 0.50 Tuned KNN Report Accuracy for Tuned KNN: 80.16 ROC AUC for Tuned KNN: 0.51 XGBoost Default Report Accuracy for XGBoost Default: 80.54 ROC AUC for XGBoost Default: 0.50 Tuned XGBoost Report Accuracy for Tuned XGBoost: 77.04 ROC AUC for Tuned XGBoost: 0.52 Random Forest Default Report Accuracy for Random Forest Default: 77.43 ROC AUC for Random Forest Default: 0.49 Tuned Random Forest Report Accuracy for Tuned Random Forest: 80.54 ROC AUC for Tuned Random Forest: 0.50 Extra Trees Default Report Accuracy for Extra Trees Default: 76.26 ROC AUC for Extra Trees Default: 0.48 Tuned Extra Trees Report Accuracy for Tuned Extra Trees: 78.60 ROC AUC for Tuned Extra Trees: 0.50 LGBM Default Report Accuracy for LGBM Default: 75.49 ROC AUC for LGBM Default: 0.51 Tuned LGBM Report Accuracy for Tuned LGBM: 80.54 ROC AUC for Tuned LGBM: 0.50 RGF Default Report Accuracy for RGF Default: 78.99 ROC AUC for RGF Default: 0.52 Tuned RGF Report Accuracy for Tuned RGF: 75.88 ROC AUC for Tuned RGF: 0.55 FRGF Default Report Accuracy for FRGF Default: 76.65 ROC AUC for FRGF Default: 0.50 #   ,       </code> </pre> <br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.linear_model <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> LogisticRegression clf = LogisticRegression(random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>, solver=<span class="hljs-string"><span class="hljs-string">'lbfgs'</span></span>, multi_class=<span class="hljs-string"><span class="hljs-string">'multinomial'</span></span>) hogwarts_df = load_processed_data_multi() <span class="hljs-comment"><span class="hljs-comment">#     data_full = hogwarts_df.drop( [ 'name', 'surname', ], axis=1).copy() X_data = data_full.drop('faculty', axis=1) y = data_full.faculty clf.fit(X_data, y) score_testing_dataset(clf)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">  ‚Äî [0.3602361 0.16166944 0.16771712 0.31037733] Kirill Malev ‚Äî [0.47473072 0.16051924 0.13511385 0.22963619]   ‚Äî [0.38697926 0.19330242 0.17451052 0.2452078 ] Harry Potter ‚Äî [0.40245098 0.16410043 0.16023278 0.27321581]   ‚Äî [0.13197025 0.16438855 0.17739254 0.52624866]   ‚Äî [0.17170203 0.1205678 0.14341742 0.56431275] Severus Snape ‚Äî [0.15558044 0.21589378 0.17370406 0.45482172]   ‚Äî [0.39301231 0.07397324 0.1212741 0.41174035] Tom Riddle ‚Äî [0.26623969 0.14194379 0.1728505 0.41896601]   ‚Äî [0.24843037 0.21632736 0.21532696 0.3199153 ] Salazar Slytherin ‚Äî [0.09359144 0.26735897 0.2742305 0.36481909]</code> </pre> <br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> E confusion_matrix: </font></font></p><br><pre> <code class="python hljs">confusion_matrix(clf.predict(X_data), y)</code> </pre> <br><pre> <code class="plaintext hljs">array([[144, 68, 64, 78], [ 8, 9, 8, 6], [ 22, 18, 31, 20], [ 77, 73, 78, 151]])</code> </pre> </div></div><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_predctions_vector</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(models, person)</span></span></span><span class="hljs-function">:</span></span> predictions = [get_predictions_vector (model, person)[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> model <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> models] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">'slitherin'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-string"><span class="hljs-string">'griffindor'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">1</span></span>], <span class="hljs-string"><span class="hljs-string">'ravenclaw'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">2</span></span>], <span class="hljs-string"><span class="hljs-string">'hufflpuff'</span></span>: predictions[<span class="hljs-number"><span class="hljs-number">3</span></span>] } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">score_testing_dataset</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(models)</span></span></span><span class="hljs-function">:</span></span> testing_dataset = [ <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Kirill Malev"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Harry Potter"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>,<span class="hljs-string"><span class="hljs-string">"Severus Snape"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Tom Riddle"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"Salazar Slytherin"</span></span>] data = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> name <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> testing_dataset: predictions = get_predctions_vector(models, name) predictions[<span class="hljs-string"><span class="hljs-string">'name'</span></span>] = name data.append(predictions) scoring_df = pd.DataFrame(data, columns=[<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'slitherin'</span></span>, <span class="hljs-string"><span class="hljs-string">'griffindor'</span></span>, <span class="hljs-string"><span class="hljs-string">'hufflpuff'</span></span>, <span class="hljs-string"><span class="hljs-string">'ravenclaw'</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> scoring_df <span class="hljs-comment"><span class="hljs-comment"># Data Science ‚Äî    ,       top_models = [ slitherin_models[3], griffindor_models[3], ravenclaw_models[3], hufflpuff_models[3] ] score_testing_dataset(top_models)</span></span></code> </pre> <br><pre> <code class="plaintext hljs"> name slitherin griffindor hufflpuff ravenclaw 0   0.349084 0.266909 0.110311 0.091045 1 Kirill Malev 0.289914 0.376122 0.384986 0.103056 2   0.338258 0.400841 0.016668 0.124825 3 Harry Potter 0.245377 0.357934 0.026287 0.154592 4   0.917423 0.126997 0.176640 0.096570 5   0.969693 0.106384 0.150146 0.082195 6 Severus Snape 0.663732 0.259189 0.290252 0.074148 7   0.268466 0.579401 0.007900 0.083195 8 Tom Riddle 0.639731 0.541184 0.084395 0.156245 9   0.653595 0.147506 0.172940 0.137134 10 Salazar Slytherin 0.647399 0.169964 0.095450 0.26126</code> </pre> <br><p><img src="https://habrastorage.org/webt/kc/pq/r7/kcpqr7dw_t-yudtoda54qj1su3o.jpeg"></p><br><p>     , <del>     </del>   .    ROC AUC  ,  0.5.    ,   : </p><br><ul><li>   ; </li><li>    ; </li><li>    ,        ; </li><li>      ,     ; </li><li>  ,            ,   . </li></ul><br><p>            ,    ,   ,   ,          XGBoost      CV ,       . </p><br><p> ! ,       70% .     ,    4          . </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> model_training <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_production_models <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> xgboost <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> XGBClassifier best_models = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range (<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>): best_models.append(XGBClassifier(base_score=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, booster=<span class="hljs-string"><span class="hljs-string">'gbtree'</span></span>, colsample_bylevel=<span class="hljs-number"><span class="hljs-number">1</span></span>, colsample_bytree=<span class="hljs-number"><span class="hljs-number">0.7</span></span>, gamma=<span class="hljs-number"><span class="hljs-number">0</span></span>, learning_rate=<span class="hljs-number"><span class="hljs-number">0.05</span></span>, max_delta_step=<span class="hljs-number"><span class="hljs-number">0</span></span>, max_depth=<span class="hljs-number"><span class="hljs-number">6</span></span>, min_child_weight=<span class="hljs-number"><span class="hljs-number">11</span></span>, missing=<span class="hljs-number"><span class="hljs-number">-999</span></span>, n_estimators=<span class="hljs-number"><span class="hljs-number">1000</span></span>, n_jobs=<span class="hljs-number"><span class="hljs-number">1</span></span>, nthread=<span class="hljs-number"><span class="hljs-number">4</span></span>, objective=<span class="hljs-string"><span class="hljs-string">'binary:logistic'</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">0</span></span>, reg_alpha=<span class="hljs-number"><span class="hljs-number">0</span></span>, reg_lambda=<span class="hljs-number"><span class="hljs-number">1</span></span>, scale_pos_weight=<span class="hljs-number"><span class="hljs-number">1</span></span>, seed=<span class="hljs-number"><span class="hljs-number">1337</span></span>, silent=<span class="hljs-number"><span class="hljs-number">1</span></span>, subsample=<span class="hljs-number"><span class="hljs-number">0.8</span></span>)) slitherin_model, griffindor_model, ravenclaw_model, hufflpuff_model = \ train_production_models(best_models) top_models = slitherin_model, griffindor_model, ravenclaw_model, hufflpuff_model score_testing_dataset(top_models)</code> </pre> <br><pre> <code class="plaintext hljs">name slitherin griffindor hufflpuff ravenclaw 0   0.273713 0.372337 0.065923 0.279577 1 Kirill Malev 0.401603 0.761467 0.111068 0.023902 2   0.031540 0.616535 0.196342 0.217829 3 Harry Potter 0.183760 0.422733 0.119393 0.173184 4   0.945895 0.021788 0.209820 0.019449 5   0.950932 0.088979 0.084131 0.012575 6 Severus Snape 0.634035 0.088230 0.249871 0.036682 7   0.426440 0.431351 0.028444 0.083636 8 Tom Riddle 0.816804 0.136530 0.069564 0.035500 9   0.409634 0.213925 0.028631 0.252723 10 Salazar Slytherin 0.824590 0.067910 0.111147 0.085710</code> </pre> <br><p>      ,  ,   . </p><br><p>    ,           ,     .   . </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pickle pickle.dump(slitherin_model, open(<span class="hljs-string"><span class="hljs-string">"../output/slitherin.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>)) pickle.dump(griffindor_model, open(<span class="hljs-string"><span class="hljs-string">"../output/griffindor.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>)) pickle.dump(ravenclaw_model, open(<span class="hljs-string"><span class="hljs-string">"../output/ravenclaw.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>)) pickle.dump(hufflpuff_model, open(<span class="hljs-string"><span class="hljs-string">"../output/hufflpuff.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"wb"</span></span>))</code> </pre> <br><h2 id="prodakshn">  </h2><br><p>           ,     .   ,     , ,       . </p><br><p>           ,  ,      .        ,       .  ,   Data Scientist ‚Äî       -. </p><br><p>     : </p><br><ul><li>     ; </li><li>     json-       json; </li><li>            . </li></ul><br><p> ,     docker-,           python-.  ,           flask. </p><br><div class="spoiler"> <b class="spoiler_title"> </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> print_function <span class="hljs-comment"><span class="hljs-comment"># In python 2.7 import os import subprocess import json import re from flask import Flask, request, jsonify from inspect import getmembers, ismethod import numpy as npb import pandas as pd import math import os import pickle import xgboost as xgb import sys from letter import Letter from talking_hat import * from sklearn.ensemble import RandomForestClassifier import warnings def prod_predict_classes_for_name (full_name): featurized_person = parse_line_to_hogwarts_df(full_name) person_df = pd.DataFrame(featurized_person, columns=[ 'name', 'surname', 'is_english', 'name_starts_with_vowel', 'name_starts_with_consonant', 'name_ends_with_vowel', 'name_ends_with_consonant', 'name_length', 'name_vowels_count', 'name_double_vowels_count', 'name_consonant_count', 'name_double_consonant_count', 'name_paired_count', 'name_deaf_count', 'name_sonorus_count', 'surname_starts_with_vowel', 'surname_starts_with_consonant', 'surname_ends_with_vowel', 'surname_ends_with_consonant', 'surname_length', 'surname_vowels_count', 'surname_double_vowels_count', 'surname_consonant_count', 'surname_double_consonant_count', 'surname_paired_count', 'surname_deaf_count', 'surname_sonorus_count', ], index=[0] ) slitherin_model = pickle.load(open("models/slitherin.xgbm", "rb")) griffindor_model = pickle.load(open("models/griffindor.xgbm", "rb")) ravenclaw_model = pickle.load(open("models/ravenclaw.xgbm", "rb")) hufflpuff_model = pickle.load(open("models/hufflpuff.xgbm", "rb")) predictions = get_predctions_vector([ slitherin_model, griffindor_model, ravenclaw_model, hufflpuff_model ], person_df.drop(['name', 'surname'], axis=1)) return { 'slitherin': float(predictions[0][1]), 'griffindor': float(predictions[1][1]), 'ravenclaw': float(predictions[2][1]), 'hufflpuff': float(predictions[3][1]) } def predict(params): fullname = params['fullname'] print(params) return prod_predict_classes_for_name(fullname) def create_app(): app = Flask(__name__) functions_list = [predict] @app.route('/&lt;func_name&gt;', methods=['POST']) def api_root(func_name): for function in functions_list: if function.__name__ == func_name: try: json_req_data = request.get_json() if json_req_data: res = function(json_req_data) else: return jsonify({"error": "error in receiving the json input"}) except Exception as e: data = { "error": "error while running the function" } if hasattr(e, 'message'): data['message'] = e.message elif len(e.args) &gt;= 1: data['message'] = e.args[0] return jsonify(data) return jsonify({"success": True, "result": res}) output_string = 'function: %s not found' % func_name return jsonify({"error": output_string}) return app if __name__ == '__main__': app = create_app() app.run(host='0.0.0.0')</span></span></code> </pre> </div></div><br><p> Dockerfile: </p><br><pre> <code class="bash hljs">FROM datmo/python-base:cpu-py35 <span class="hljs-comment"><span class="hljs-comment">#  python3-wheel,        RUN apt-get update; apt-get install -y python3-pip python3-numpy python3-scipy python3-wheel ADD requirements.txt / RUN pip3 install -r /requirements.txt RUN mkdir /code;mkdir /code/models COPY ./python_api.py ./talking_hat.py ./letter.py ./request.py /code/ COPY ./models/* /code/models/ WORKDIR /code CMD python3 /code/python_api.py</span></span></code> </pre> <br><p>    : </p><br><pre> <code class="bash hljs">docker build -t talking_hat . &amp;&amp; docker rm talking_hat &amp;&amp; docker run --name talking_hat -p 5000:5000 talking_hat</code> </pre> <br><h2 id="testirovanie-prodakshn-modeli">    </h2><br><p>     ‚Äî            .  ,         <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=https://">Apache Benchmark</a> .      ,      .  ‚Äî  . </p><br><pre> <code class="bash hljs">$ ab -p data.json -T application/json -c 50 -n 10000 http://0.0.0.0:5000/predict</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ab</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">This is ApacheBench, Version 2.3 &lt;$Revision: 1807734 $&gt; Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed to The Apache Software Foundation, http://www.apache.org/ Benchmarking 0.0.0.0 (be patient) Completed 1000 requests Completed 2000 requests Completed 3000 requests Completed 4000 requests Completed 5000 requests Completed 6000 requests Completed 7000 requests Completed 8000 requests Completed 9000 requests Completed 10000 requests Finished 10000 requests Server Software: Werkzeug/0.14.1 Server Hostname: 0.0.0.0 Server Port: 5000 Document Path: /predict Document Length: 141 bytes Concurrency Level: 50 Time taken for tests: 238.552 seconds Complete requests: 10000 Failed requests: 0 Total transferred: 2880000 bytes Total body sent: 1800000 HTML transferred: 1410000 bytes Requests per second: 41.92 [#/sec] (mean) Time per request: 1192.758 [ms] (mean) Time per request: 23.855 [ms] (mean, across all concurrent requests) Transfer rate: 11.79 [Kbytes/sec] received 7.37 kb/s sent 19.16 kb/s total Connection Times (ms) min mean[+/-sd] median max Connect: 0 0 0.1 0 3 Processing: 199 1191 352.5 1128 3352 Waiting: 198 1190 352.5 1127 3351 Total: 202 1191 352.5 1128 3352 Percentage of the requests served within a certain time (ms) 50% 1128 66% 1277 75% 1378 80% 1451 90% 1668 95% 1860 98% 2096 99% 2260 100% 3352 (longest request)</code> </pre> </div></div><br><p>     ,      : </p><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">prod_predict_classes_for_name</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(full_name)</span></span></span><span class="hljs-function">:</span></span> &lt;...&gt; predictions = get_predctions_vector([ app.slitherin_model, app.griffindor_model, app.ravenclaw_model, app.hufflpuff_model ], person_df.drop([<span class="hljs-string"><span class="hljs-string">'name'</span></span>, <span class="hljs-string"><span class="hljs-string">'surname'</span></span>], axis=<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-string"><span class="hljs-string">'slitherin'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">'griffindor'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">'ravenclaw'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">2</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]), <span class="hljs-string"><span class="hljs-string">'hufflpuff'</span></span>: float(predictions[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">1</span></span>]) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_app</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> &lt;...&gt; <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> app.app_context(): app.slitherin_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/slitherin.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) app.griffindor_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/griffindor.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) app.ravenclaw_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/ravenclaw.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) app.hufflpuff_model = pickle.load(open(<span class="hljs-string"><span class="hljs-string">"models/hufflpuff.xgbm"</span></span>, <span class="hljs-string"><span class="hljs-string">"rb"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> app</code> </pre> <br><p>    : </p><br><pre> <code class="bash hljs">$ docker build -t talking_hat . &amp;&amp; docker rm talking_hat &amp;&amp; docker run --name talking_hat -p 5000:5000 talking_hat $ ab -p data.json -T application/json -c 50 -n 10000 http://0.0.0.0:5000/predict</code> </pre> <br><div class="spoiler"> <b class="spoiler_title"> ab</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">This is ApacheBench, Version 2.3 &lt;$Revision: 1807734 $&gt; Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/ Licensed to The Apache Software Foundation, http://www.apache.org/ Benchmarking 0.0.0.0 (be patient) Completed 1000 requests Completed 2000 requests Completed 3000 requests Completed 4000 requests Completed 5000 requests Completed 6000 requests Completed 7000 requests Completed 8000 requests Completed 9000 requests Completed 10000 requests Finished 10000 requests Server Software: Werkzeug/0.14.1 Server Hostname: 0.0.0.0 Server Port: 5000 Document Path: /predict Document Length: 141 bytes Concurrency Level: 50 Time taken for tests: 219.812 seconds Complete requests: 10000 Failed requests: 3 (Connect: 0, Receive: 0, Length: 3, Exceptions: 0) Total transferred: 2879997 bytes Total body sent: 1800000 HTML transferred: 1409997 bytes Requests per second: 45.49 [#/sec] (mean) Time per request: 1099.062 [ms] (mean) Time per request: 21.981 [ms] (mean, across all concurrent requests) Transfer rate: 12.79 [Kbytes/sec] received 8.00 kb/s sent 20.79 kb/s total Connection Times (ms) min mean[+/-sd] median max Connect: 0 0 0.1 0 2 Processing: 235 1098 335.2 1035 3464 Waiting: 235 1097 335.2 1034 3462 Total: 238 1098 335.2 1035 3464 Percentage of the requests served within a certain time (ms) 50% 1035 66% 1176 75% 1278 80% 1349 90% 1541 95% 1736 98% 1967 99% 2141 100% 3464 (longest request)</code> </pre> </div></div><br><p> .   .         ,          . </p><br><h2 id="zaklyuchenie">  Conclus√£o </h2><br><p>            ,             .       -     . </p><br><p> ,     : </p><br><ul><li>    feature engineering-     ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="> </a>  ),  , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Soundex</a>     . </li><li>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="></a>   PyTorch        .       ,        ,         . </li><li>     flask   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Quart</a> ,        ,          . </li><li>    -  -,     . </li></ul><br><p>      ,           ,     .   ,  ! </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Este artigo n√£o teria sido publicado sem a comunidade Open Data Science, que re√∫ne um grande n√∫mero de especialistas em l√≠ngua russa no campo da an√°lise de dados. </font></font></p><cut></cut></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt430006/">https://habr.com/ru/post/pt430006/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt429996/index.html">Administrador de rede na nuvem</a></li>
<li><a href="../pt429998/index.html">Maneiras cient√≠ficas de melhorar a aten√ß√£o: Nootr√≥picos, interfaces neuro e estimula√ß√£o el√©trica</a></li>
<li><a href="../pt430000/index.html">O √∫ltimo dos moicanos. O CEO mais antigo da Fortune 500 coloca tudo na queda dos smartphones</a></li>
<li><a href="../pt430002/index.html">Red Hat Enterprise Linux 8 Beta - Ao mesmo tempo com o mundo</a></li>
<li><a href="../pt430004/index.html">Rastreador GPS n√£o certificado da China. Isso √© legal na R√∫ssia?</a></li>
<li><a href="../pt430008/index.html">Ugears: cavalos, vela e outros entretenimentos reais</a></li>
<li><a href="../pt430010/index.html">Li√ß√£o aberta "Como n√£o: anti-exemplos na an√°lise de processos de neg√≥cios"</a></li>
<li><a href="../pt430014/index.html">Classes seladas. Sem√¢ntica vs desempenho</a></li>
<li><a href="../pt430016/index.html">Os cientistas admitem confusos que ainda n√£o sabem a magnitude exata da intera√ß√£o gravitacional.</a></li>
<li><a href="../pt430024/index.html">Como uma queda de avi√£o pode melhorar a an√°lise de TI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>