<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚òπÔ∏è üíâ üôÖüèæ So bringen Sie Zabbix bei, Problembenachrichtigungen direkt an den Desktop zu senden üéí ü§üüèº üç∑</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bild: Quelle 

 Hallo Habr! Mein Name ist Ilya Ableev, ich arbeite in der √úberwachungsabteilung von Badoo. 

 Sie k√∂nnen lange festhalten, welches √úbe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So bringen Sie Zabbix bei, Problembenachrichtigungen direkt an den Desktop zu senden</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/badoo/blog/418907/"><img src="https://habrastorage.org/webt/98/ev/mt/98evmtwknc1eykixoq9zx5yrcke.gif"><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><i>Bild: Quelle</i></a> <br><br>  Hallo Habr!  Mein Name ist Ilya Ableev, ich arbeite in der √úberwachungsabteilung von Badoo. <br><br>  Sie k√∂nnen lange festhalten, welches √úberwachungssystem k√ºhler ist.  Das Hauptwerkzeug f√ºr die Reaktion auf Probleme in Badoo ist Zabbix, und wir haben wiederholt <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die Erfahrung des</a> Anpassens geteilt. <br><br>  Nach dem Auspacken k√∂nnen Sie neue Probleme entweder √ºber die Weboberfl√§che oder per E-Mail / SMS erfahren.  Dies funktioniert gut und bis zu einem gewissen Punkt waren wir mit diesen Methoden vertraut. <br><br>  Heutzutage verf√ºgt unser System √ºber mehrere Serverinstanzen, Tausende von Hosts, Hunderttausende von √úberpr√ºfungen und ungef√§hr die gleiche Anzahl von Triggern, auf die Sie so schnell wie m√∂glich reagieren m√ºssen.  Nach einer Reihe von Vorf√§llen, bei denen wir nur bis zu zehn Minuten damit verbracht haben, ein Problem zu erkennen (was v√∂llig inakzeptabel ist), haben wir festgestellt, dass wir andere M√∂glichkeiten zur Meldung von Problemen ben√∂tigen.  Dann w√§re unsere Reaktion vielleicht schneller. <br><br>  Die optimale L√∂sung w√§re unserer Meinung nach, wichtige Benachrichtigungen √ºber allen Fenstern (Browser, Chats, Konsolen) anzuzeigen.  In diesem Artikel werden wir dar√ºber sprechen, wie wir Zabbix fertiggestellt haben, und lernen, wie man sie direkt an den Desktop sendet. <br><br>  F√ºr wen diese L√∂sung geeignet ist: <br><br><ul><li>  Dienstadministratoren, die nicht nur rund um die Uhr auf den Monitor schauen, sondern sich auch um andere Aufgaben k√ºmmern; </li><li>  Alle anderen Administratoren, die die PROBLEM- und OK-Bl√§tter nicht gerne per E-Mail oder SMS anzeigen, sich aber rechtzeitig √ºber kritische Probleme informieren m√∂chten. </li></ul><br>  Sie m√ºssen Zeit f√ºr die Installation aufwenden, aber ich denke, wenn Sie Zabbix verwenden und bereits benutzerdefinierte Skripte verwendet haben, wird es f√ºr Sie nicht schwierig sein. <br><a name="habracut"></a><br>  Achtung!  Das Empfangen von Benachrichtigungen auf diese Weise macht s√ºchtig. Durch die langfristige Verwendung entsteht der Eindruck, dass es ein wesentlicher Bestandteil von Zabbix ist. <br><br>  Ich werde Ihnen schrittweise sagen, was und wie wir getan haben.  Die technische Umsetzung ist recht einfach: <br><br><ol><li>  Zabbix sendet eine Warnung an ein Ereignis. </li><li>  Das Sendeskript auf dem Server sendet Daten √ºber UDP an den Client auf dem Desktop. </li><li>  Das Empf√§ngerskript empf√§ngt die Benachrichtigung und l√∂st das Erscheinen einer Popup-Nachricht √ºber eine zus√§tzliche Anwendung aus. </li></ol><br>  Das dritte Element kann je nach verwendetem Betriebssystem und der Anwendung, die Ihnen am besten gef√§llt, unterschiedlich sein. <br><br><h2>  Erster Schritt: Konfigurieren Sie Zabbix </h2><br>  In der offiziellen Dokumentation erfahren Sie, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wie Sie Ihre Benachrichtigungen erstellen</a> . <br><br>  Der Projektcode ist auf GitHub verf√ºgbar: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/ableev/ZbxDsktp</a> . <br><br><ol><li>  F√ºgen Sie zbxpush.py vorab in AlertScriptsPath auf dem Zabbix-Server ein. <br></li><li>  Weiter in der Weboberfl√§che: <i>Administration</i> ‚Üí <i>Medientypen</i> ‚Üí <i>Anlegen</i> . <br></li></ol><br><br><img src="https://habrastorage.org/webt/n5/n6/55/n5n655i9syco1oxqdbhuxsqokja.png"><br><br>  3. Wir werden den IP / FQDN, an den wir Benachrichtigungen senden, im Voraus registrieren. <br><br><div class="spoiler">  <b class="spoiler_title">Dieser Artikel kann aktualisiert werden</b> <div class="spoiler_text">  Zum Beispiel haben wir dies getan: Es gibt einen Haupt√ºberwachungsserver mit einer SSH-Anmeldung, das Skript merkt sich die IP des Anrufers und beginnt, Warnungen an ihn zu senden.  Um den Empfang von Daten zu Hause zu aktivieren, m√ºssen Sie die Aktion nicht jedes Mal √§ndern. <br></div></div><br>  In der Weboberfl√§che: <i>Administration</i> ‚Üí <i>Benutzer</i> ‚Üí <i>% Benutzername%</i> ‚Üí <i>Medien</i> . <br><br><img src="https://habrastorage.org/webt/ht/mb/pi/htmbpi7wht4kh1erwsepplynyto.png"><br><br>  4. Erstellen Sie eine Aktion f√ºr die Trigger. <br><br>  In der Weboberfl√§che: <i>Konfiguration</i> ‚Üí <i>Aktionen</i> . <br><br><img src="https://habrastorage.org/webt/nt/nb/um/ntnbumq93_itlvuuhwjquf1wgza.png"><br><br><h3>  Sendeformat </h3><br> <b><code>{TRIGGER.NSEVERITY}@@@{HOST.NAME}@@@{TRIGGER.NAME}</code> <br></b> <br>  Das erste ist das Zahlenformat des Ausl√∂sers (4 oder 5 wirken sich auf das angezeigte Symbol aus: Hoch oder Katastrophe), das zweite ist der Benachrichtigungsheader, das dritte ist der Nachrichtentext. <br><br>  @@@ - um das Aufteilen in Spalten zu vereinfachen, da die Namen der Trigger alles aussagen k√∂nnen (zumindest bei uns :)), aber sicherlich nicht diese Kombination. <br><br><img src="https://habrastorage.org/webt/sh/sx/7t/shsx7tx8a-0nfqyene9cbdehnqe.png"><br><br><img src="https://habrastorage.org/webt/id/4i/tl/id4itli-nikquvuvg1m3umml4bm.png"><br><br><h2>  Schritt zwei: Der Server sendet Daten an den Client </h2><br>  Die Logik ist einfach: Wir erhalten ein Ereignis, wir leiten es an den Kunden weiter. <br><br> <b><code>zbxpush.py</code></b> <br> <br>  Hier k√∂nnen Sie UDP in TCP √§ndern.  Wir haben uns aus einem einfachen Grund f√ºr UDP entschieden: Zabbix sendet alle Benachrichtigungen nacheinander. Wenn Ihr Computer nicht verf√ºgbar ist und TCP verwendet wird, werden Benachrichtigungen mit einer langen Verz√∂gerung gesendet. <br><br><div class="spoiler">  <b class="spoiler_title">Aber UDP ist nicht zuverl√§ssig</b> <div class="spoiler_text">  <i>Der Leser, der zum Witz √ºber UDP kommt, wird feststellen, dass beim Senden von Warnungen √ºber UDP die M√∂glichkeit besteht, dass sie irgendwo zwischen dem Server und dem Desktop verloren gehen.</i>  <i>Und er wird recht haben.</i>  <i>Es geht aber nicht darum, eine garantierte Nachricht zu √ºbermitteln, sondern einfach und schnell mit Problemen auf das Dashboard aufmerksam zu machen: "Hey, da ist etwas passiert, gehen Sie und sehen Sie."</i> <br></div></div><br>  Denken Sie daran, das Skript ausf√ºhrbar zu machen! <br><br><h2>  Schritt drei: Empfangen Sie das Ereignis und zeigen Sie Benachrichtigungen an </h2><br>  <b><code>zbxlistenerd.py</code></b> - ein Skript, das sich im Hintergrund dreht und Benachrichtigungen ausl√∂st <br><br>  <b><code>settings.cfg</code></b> - Datei mit Clienteinstellungen <br><br>  <b><code>icons/5.png</code></b> , <b><code>icons/4.png</code></b> - Symbole f√ºr verschiedene Kritikalit√§ten von Triggern <br>  Weiter gehen unsere Wege auseinander.  Der ‚ÄûClient‚Äú -Teil beinhaltet ein wenig Kreativit√§t, da jeder eine Umgebung f√ºr sich selbst schafft. <br><br>  Was ist notwendig: <br><br><ul><li>  Symbole, die der Kritikalit√§t von Triggern entsprechen; </li><li>  Sound-Popup-Benachrichtigungen; </li><li>  Ausf√ºhren einer Aktion durch Klicken auf eine Benachrichtigung (SSH-Login, √ñffnen eines Links, Starten eines Tickets f√ºr ein Problem usw.). </li></ul><br>  Unser Unternehmen verwendet haupts√§chlich Linux und Mac OS als Desktop-Betriebssystem. Schauen wir uns einige Beispiele daf√ºr an.  Wenn Sie dasselbe f√ºr Windows implementieren, k√∂nnen Sie dies gerne kommentieren!  Gerne erg√§nzen wir den Beitrag. <br><br><h3>  Linux </h3><br><img src="https://habrastorage.org/webt/zv/b6/zo/zvb6zo6amctuxok6gka-f7j7sws.png"><br><br>  Lassen Sie mich Ihnen ein Beispiel geben, das zuf√§llig verwendet wurde: Benachrichtigen-Senden in Xfce (im obigen Screenshot).  Warum notify-send und nicht dasselbe Python mit libnotify?  Ja, da es in allen g√§ngigen Desktop-Distributionen (Ubuntu, Fedora, SUSE) enthalten ist und mit allen (zumindest beliebten) DEs (Gnome, KDE, Xfce) funktioniert. <br><br>  Tipp: Wenn in Zeiten, in denen etwas massenhaft nicht verf√ºgbar ist (z. B. ein Switch heruntergefallen ist und Sie mit einer Vielzahl von Ausl√∂sern √ºber die Nichtverf√ºgbarkeit von Servern √ºberschwemmt sind), konfigurieren Sie den Hotkey sofort, um den Benachrichtigungs-Sende-Prozess zu beenden. <br><br><h3>  Mac OS </h3><br>  Da die L√∂sung zun√§chst auf Basis einer kostenlosen Anwendung implementiert wurde und wir dann die kostenpflichtige Anwendung ausprobiert haben, gibt es zwei Beispiele. <br><br><h3>  Terminal-Notifier </h3><br><img src="https://habrastorage.org/webt/4k/5l/zo/4k5lzo4vfc5xo4vwbfekifltsj0.png"><br><br>  Nach einer kurzen Suche wurde ein freier <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Terminal-Notifier</a> ausgew√§hlt. <br><br>  Vorteile: <br><br><ul><li>  Sie k√∂nnen verschiedene Symbole f√ºr unterschiedliche Kritikalit√§ten festlegen. </li><li>  Sie k√∂nnen in Zabbix Links zu Diagrammen erstellen und diese √∂ffnen, indem Sie auf eine Benachrichtigung klicken. </li><li>  Sie k√∂nnen das √ñffnen von SSH-Links implementieren: Sie haben eine Benachrichtigung gesehen -&gt; geklickt -&gt; sind sofort zum Host gegangen. </li></ul><br>  Nachteile: keine (insbesondere nachdem Symbolunterst√ºtzung hinzugef√ºgt wurde). <br><br><h3>  Knurren </h3><br><img src="https://habrastorage.org/webt/er/yd/cv/erydcvz1e6xp60fun_guorprhuo.png"><br>  <i>Zum Aktivieren setzen Sie growl_enabled = True in settings.cfg.</i> <br><br>  Zu einer Zeit, als Terminal-Notifier nicht wusste, wie man benutzerdefinierte Symbole verwendet, kam Growl damit recht gut zurecht.  Daher hat sich unsere Neugier gegen√ºber unserer Neugier durchgesetzt - und wir haben diese recht beliebte Anwendung ausprobiert (die, wie ich sagen muss, nicht nur Symbole √§ndern kann - es ist ein ganzes Benachrichtigungszentrum). <br><br>  Vorteile: <br><br><ul><li>  M√∂glicherweise ist die Anwendung bereits installiert. </li><li>  Sie k√∂nnen verschiedene Symbole f√ºr unterschiedliche Kritikalit√§t ausw√§hlen. </li><li>  Genau wie in Terminal-Notifier k√∂nnen Sie Aktionen konfigurieren, indem Sie auf Benachrichtigungen klicken. </li></ul><br>  Minus: bezahlt. <br><br>  Wenn Sie kein Knurren haben, empfehle ich dennoch die Verwendung von Terminal-Notifier. <br><br><h2>  Fazit </h2><br>  <s>Also mit Hilfe einfacher Ger√§te ...</s> <br><br>  Was wir als Ergebnis bekommen haben: <br><br><ul><li>  schnelle Zustellung von Benachrichtigungen an Administratoren; <br></li><li>  Verk√ºrzung der Reaktionszeit auf Ereignisse (vom Moment des ‚ÄûHerausfindens‚Äú bis zum ‚ÄûReparieren‚Äú oder ‚ÄûWeitergeben‚Äú); <br></li><li>  die F√§higkeit, einfache halbautomatische Aktionen auszuf√ºhren: <br></li></ul><br>  Au√üerdem h√§ngt alles von Ihrer Kreativit√§t ab. <br><br>  Es war einmal, als ich bei einem Anbieter arbeitete, als der Internetkanal von allen Lautsprechern und Kopfh√∂rern am Arbeitsplatz fiel, war der Klang einer Sirene zu h√∂ren.  Dies f√ºhrte den Begleiter (mich) in eine Bet√§ubung, gab keinen angemessenen Bericht √ºber das Problem per Telefon, aber er (ich) versuchte, dieses Problem so schnell wie m√∂glich zu l√∂sen. <br><br>  Pers√∂nlich kenne ich bereits F√§lle, in denen der Klang eines Schweins von einem beliebten Antivirenprogramm und von Sprechern eines beliebten √úbersetzers an das Skript geschraubt wurde.  :) :) <br><br><div class="spoiler">  <b class="spoiler_title">Wenn Sie Freizeit, Lust und moderne Technologie haben, k√∂nnen Sie dies tun</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://www.youtube.com/embed/0wjiA-KAuzE" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br></div></div><br>  Schnelle Reaktionen auf Zwischenf√§lle! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de418907/">https://habr.com/ru/post/de418907/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de418895/index.html">Lerne k√ºnstliche Intelligenz, um ein Spiel zu spielen</a></li>
<li><a href="../de418897/index.html">CRDT: Konfliktfreie replizierte Datentypen</a></li>
<li><a href="../de418899/index.html">Erste Eindr√ºcke und Aktionen nach dem Upgrade von MySQL von Version 5.7 auf 8.0.11</a></li>
<li><a href="../de418901/index.html">Die Russen gewannen die Mehrheit der Goldmedaillen bei der Europ√§ischen Informatikolympiade eJOI 2018</a></li>
<li><a href="../de418903/index.html">Wissenschaftler: Es gibt nicht genug CO‚ÇÇ auf dem Mars, um die Atmosph√§re zu erw√§rmen. Polexplosion wird nicht helfen</a></li>
<li><a href="../de418909/index.html">Python f√ºhrt: Wer und warum verwendet es</a></li>
<li><a href="../de418911/index.html">[DotNetBook] Span: Neuer .NET-Datentyp</a></li>
<li><a href="../de418913/index.html">UE4 | Inventar f√ºr Multiplayer # 1 | Data Warehouse auf DataAsset</a></li>
<li><a href="../de418915/index.html">Ausgleich des Datenverkehrs zwischen Webservern mithilfe von IP CEF auf Netzwerkger√§ten</a></li>
<li><a href="../de418917/index.html">Sicherheit beginnt mit einem Heimrouter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>