<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯРБ ЁЯШЛ ЁЯСйЁЯП┐тАНЁЯдЭтАНЁЯСиЁЯП╝ рдПрдирд░реЙрди рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВред рднрд╛рдЧ 1, рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рдХрд░рдирд╛ рдФрд░ рдкреНрд░рд╡реЗрд╢ рдХрд╛ рдЪрдпрди ЁЯСиЁЯП┐тАНЁЯОУ ЁЯЩОЁЯП┐ тЪ╜я╕П</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдПрдирд░реЙрди рдХреЙрд░реНрдкреЛрд░реЗрд╢рди 2000 рдХреЗ рджрд╢рдХ рдореЗрдВ рдЕрдореЗрд░рд┐рдХреА рд╡реНрдпрд╛рдкрд╛рд░ рдореЗрдВ рд╕рдмрд╕реЗ рдкреНрд░рд╕рд┐рджреНрдз рдЖрдВрдХрдбрд╝реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред рдпрд╣ рдЙрдирдХреА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЗ рдХреНрд╖реЗрддреНрд░ (рдмрд┐рдЬрд▓реА рдФрд░ рдЗрд╕рдХреА рдЖрдкреВрд░реНрддрд┐ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдм...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдПрдирд░реЙрди рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХреА рдкрд╣рдЪрд╛рди рдХрд░реЗрдВред рднрд╛рдЧ 1, рдбреЗрдЯрд╛ рддреИрдпрд╛рд░ рдХрд░рдирд╛ рдФрд░ рдкреНрд░рд╡реЗрд╢ рдХрд╛ рдЪрдпрди</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/424891/"><p> рдПрдирд░реЙрди рдХреЙрд░реНрдкреЛрд░реЗрд╢рди 2000 рдХреЗ рджрд╢рдХ рдореЗрдВ рдЕрдореЗрд░рд┐рдХреА рд╡реНрдпрд╛рдкрд╛рд░ рдореЗрдВ рд╕рдмрд╕реЗ рдкреНрд░рд╕рд┐рджреНрдз рдЖрдВрдХрдбрд╝реЛрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╣реИред  рдпрд╣ рдЙрдирдХреА рдЧрддрд┐рд╡рд┐рдзрд┐ рдХреЗ рдХреНрд╖реЗрддреНрд░ (рдмрд┐рдЬрд▓реА рдФрд░ рдЗрд╕рдХреА рдЖрдкреВрд░реНрддрд┐ рдХреЗ рд▓рд┐рдП рдЕрдиреБрдмрдВрдз) рджреНрд╡рд╛рд░рд╛ рдирд╣реАрдВ, рдмрд▓реНрдХрд┐ рдЗрд╕рдореЗрдВ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХреЗ рдХрд╛рд░рдг рдкреНрд░рддрд┐рдзреНрд╡рдирд┐ рджреНрд╡рд╛рд░рд╛ рд╕реБрдЧрдо рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред  15 рд╡рд░реНрд╖реЛрдВ рдХреЗ рд▓рд┐рдП, рдХреЙрд░реНрдкреЛрд░реЗрдЯ рдЖрдп рддреЗрдЬреА рд╕реЗ рдмрдврд╝реА рд╣реИ, рдФрд░ рдЗрд╕рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рд╕реЗ рдЕрдЪреНрдЫреЗ рд╡реЗрддрди рдХрд╛ рд╡рд╛рджрд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  рд▓реЗрдХрд┐рди рдпрд╣ рд╕рдм рд╕рд┐рд░реНрдл рдмреЗрдбрд╝реЗ рдХреЗ рд░реВрдк рдореЗрдВ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЧрдпрд╛: 2000-2001 рдХреА рдЕрд╡рдзрд┐ рдореЗрдВред  рдШреЛрд╖рд┐рдд рдЖрдп рдХреЗ рд╕рд╛рде рдзреЛрдЦрд╛рдзрдбрд╝реА рдХреЗ рдХрд╛рд░рдг рд╢реЗрдпрд░ рдХреА рдХреАрдордд $ 90 / рдпреВрдирд┐рдЯ рд╕реЗ рдЧрд┐рд░рдХрд░ рд▓рдЧрднрдЧ рд╢реВрдиреНрдп рд╣реЛ рдЧрдИред  рддрдм рд╕реЗ, "рдПрдирд░реЙрди" рд╢рдмреНрдж рдПрдХ рдШрд░реЗрд▓реВ рд╢рдмреНрдж рдмрди рдЧрдпрд╛ рд╣реИ рдФрд░ рдПрдХ рд╕рдорд╛рди рдкреИрдЯрд░реНрди рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реА рдХрдВрдкрдирд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рдПрдХ рд▓реЗрдмрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИред </p><br><p>  рдореБрдХрджрдореЗ рдХреЗ рджреМрд░рд╛рди 18 рд▓реЛрдЧреЛрдВ (рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рд╕рдмрд╕реЗ рдмрдбрд╝реЗ рдкреНрд░рддрд┐рд╡рд╛рджреА: рдПрдВрдбреНрд░рдпреВ рдлрд╛рд╕реНрдЯреЛрд╡, рдЬреЗрдл рд╕реНрдХрд┐рд▓рд┐рдВрдЧ рдФрд░ рдХреЗрдиреЗрде рд▓реЗ) рдХреЛ рджреЛрд╖реА рдард╣рд░рд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред </p><br><p><img src="https://habrastorage.org/webt/te/rh/1l/terh1lsenbtg26n8nhjbhv3opfi.jpeg" alt="рдЫрд╡рд┐! [рдЫрд╡рд┐] (http: // https: //habrastorage.org/webt/te/rh/1l/terh1lsenbtg26n8nhjbhv3opfi.jpeg)"></p><br><p>  рдЗрд╕реА рд╕рдордп, рдХрдВрдкрдиреА рдХреЗ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреЗ рдмреАрдЪ рдЗрд▓реЗрдХреНрдЯреНрд░реЙрдирд┐рдХ рдкрддреНрд░рд╛рдЪрд╛рд░ рдХрд╛ рдПрдХ рд╕рдВрдЧреНрд░рд╣, рдЬрд┐рд╕реЗ рдПрдирд░реЙрди рдИрдореЗрд▓ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рд░реВрдк рдореЗрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИ, рдФрд░ рдЗрд╕ рдХрдВрдкрдиреА рдХреЗ рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреА рдЖрдп рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЕрдВрджрд░реВрдиреА рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рдХрд╛рд╢рд┐рдд рдХреА рдЧрдИ рдереАред </p><br><p>  рд▓реЗрдЦ рдЗрд╕ рдбреЗрдЯрд╛ рдХреЗ рд╕реНрд░реЛрддреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдЧрд╛ рдФрд░ рдпрд╣ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдореЙрдбрд▓ рдХрд╛ рдирд┐рд░реНрдорд╛рдг рдХрд░реЗрдЧрд╛ рдХрд┐ рдХреНрдпрд╛ рдХрд┐рд╕реА рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХрд╛ рд╕рдВрджреЗрд╣ рд╣реИред  рджрд┐рд▓рдЪрд╕реНрдк рд▓рдЧрддрд╛ рд╣реИ?  рдлрд┐рд░, рд╣реИрдмреНрд░рдХрдЯ рдореЗрдВ рдЖрдкрдХрд╛ рд╕реНрд╡рд╛рдЧрдд рд╣реИред <a name="habracut"></a></p><br><h1 id="opisanie-dataseta">  рдбреЗрдЯрд╛рд╕реЗрдЯ рдХрд╛ рд╡рд┐рд╡рд░рдг </h1><br><p>  рдПрдирд░реЙрди рдбреЗрдЯрд╛рд╕реЗрдЯ (рдбреЗрдЯрд╛рд╕реЗрдЯ) рдЦреБрд▓реЗ рдбреЗрдЯрд╛ рдХрд╛ рдПрдХ рд╕рдордЧреНрд░ рд╕рдореВрд╣ рд╣реЛрддрд╛ рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕рдВрдмрдВрдзрд┐рдд рдирд╛рдо рдХреЗ рд╕рд╛рде рдПрдХ рдпрд╛рджрдЧрд╛рд░ рдирд┐рдЧрдо рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рд▓реЛрдЧреЛрдВ рдХреЗ рд░рд┐рдХреЙрд░реНрдб рд╣реЛрддреЗ рд╣реИрдВред <br>  рдпрд╣ 3 рднрд╛рдЧреЛрдВ рдХреЛ рдЕрд▓рдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ: </p><br><ul><li>  payment_features - рдПрдХ рд╕рдореВрд╣ рдЬреЛ рд╡рд┐рддреНрддреАрдп рдЖрдВрджреЛрд▓рдиреЛрдВ рдХреА рд╡рд┐рд╢реЗрд╖рддрд╛ рд╣реИ; </li><li>  stock_features - рдПрдХ рд╕рдореВрд╣ рдЬреЛ рд╕реНрдЯреЙрдХ рд╕реЗ рдЬреБрдбрд╝реЗ рд╕рдВрдХреЗрддреЛрдВ рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИ; </li><li>  email_features - рдПрдХ рд╕рдореВрд╣ рдЬреЛ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╡реНрдпрдХреНрддрд┐ рдХреЗ рдИрдореЗрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рджрд░реНрд╢рд╛рддрд╛ рд╣реИред </li></ul><br><p>  рдмреЗрд╢рдХ, рдПрдХ рд▓рдХреНрд╖реНрдп рдЪрд░ рднреА рд╣реИ рдЬреЛ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдХреНрдпрд╛ рд╡реНрдпрдХреНрддрд┐ рдХреЛ рдзреЛрдЦрд╛рдзрдбрд╝реА ( <abbr title="рд░реБрдЪрд┐ рдХрд╛ рд╡реНрдпрдХреНрддрд┐">'рдкреЛрдИ'</abbr> рдХрд╛ рд╕рдВрдХреЗрдд <abbr title="рд░реБрдЪрд┐ рдХрд╛ рд╡реНрдпрдХреНрддрд┐"><abbr>) рдкрд░</abbr></abbr> рд╕рдВрджреЗрд╣ рд╣реИ <abbr title="рд░реБрдЪрд┐ рдХрд╛ рд╡реНрдпрдХреНрддрд┐"><abbr>ред</abbr></abbr> <abbr title="рд░реБрдЪрд┐ рдХрд╛ рд╡реНрдпрдХреНрддрд┐"><br></abbr> </p><p>  рд╣рдорд╛рд░рд╛ рдбреЗрдЯрд╛ рдбрд╛рдЙрдирд▓реЛрдб рдХрд░реЗрдВ рдФрд░ рдЙрдирдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░реЗрдВ: </p><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pickle <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>("final_project/enron_dataset.pkl", "rb") <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> data_file: data_dict = pickle.<span class="hljs-keyword"><span class="hljs-keyword">load</span></span>(data_file)</code> </pre> <br><p>  рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдо рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдЕрдзрд┐рдХ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдХрд╛рд░реНрдп рдХреЗ рд▓рд┐рдП рдбреЗрдЯрд╛ <strong>рдкрдВрдбрд┐рдд рдбреЗрдЯрд╛рдлрд╝рдВрдб</strong> рдореЗрдВ <strong>рдкрдВрдбрд┐рдд</strong> рд╕реЗрдЯ рдХрд░реЗрдВред </p><br><pre> <code class="hljs haskell"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> warnings warnings.filterwarnings('<span class="hljs-title"><span class="hljs-title">ignore'</span></span>) source_df = pd.DataFrame.from_dict(<span class="hljs-title"><span class="hljs-title">data_dict</span></span>, <span class="hljs-title"><span class="hljs-title">orient</span></span> = '<span class="hljs-title"><span class="hljs-title">index'</span></span>) source_df.drop('<span class="hljs-type"><span class="hljs-type">TOTAL</span></span>',<span class="hljs-title"><span class="hljs-title">inplace</span></span>=<span class="hljs-type"><span class="hljs-type">True</span></span>)</code> </pre> <br><p>  рд╣рдо рдкрд╣рд▓реЗ рд╕рдВрдХреЗрддрд┐рдд рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рдЕрдиреБрд╕рд╛рд░ рд╕рдВрдХреЗрддреЛрдВ рдХреЛ рд╕рдореВрд╣рд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдпрд╣ рдмрд╛рдж рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХреЛ рд╕реБрд╡рд┐рдзрд╛рдЬрдирдХ рдмрдирд╛рдирд╛ рдЪрд╛рд╣рд┐рдП: </p><br><pre> <code class="hljs powershell">payments_features = [<span class="hljs-string"><span class="hljs-string">'salary'</span></span>, <span class="hljs-string"><span class="hljs-string">'bonus'</span></span>, <span class="hljs-string"><span class="hljs-string">'long_term_incentive'</span></span>, <span class="hljs-string"><span class="hljs-string">'deferred_income'</span></span>, <span class="hljs-string"><span class="hljs-string">'deferral_payments'</span></span>, <span class="hljs-string"><span class="hljs-string">'loan_advances'</span></span>, <span class="hljs-string"><span class="hljs-string">'other'</span></span>, <span class="hljs-string"><span class="hljs-string">'expenses'</span></span>, <span class="hljs-string"><span class="hljs-string">'director_fees'</span></span>, <span class="hljs-string"><span class="hljs-string">'total_payments'</span></span>] stock_features = [<span class="hljs-string"><span class="hljs-string">'exercised_stock_options'</span></span>, <span class="hljs-string"><span class="hljs-string">'restricted_stock'</span></span>, <span class="hljs-string"><span class="hljs-string">'restricted_stock_deferred'</span></span>,<span class="hljs-string"><span class="hljs-string">'total_stock_value'</span></span>] email_features = [<span class="hljs-string"><span class="hljs-string">'to_messages'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_poi_to_this_person'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_messages'</span></span>, <span class="hljs-string"><span class="hljs-string">'from_this_person_to_poi'</span></span>, <span class="hljs-string"><span class="hljs-string">'shared_receipt_with_poi'</span></span>] target_field = <span class="hljs-string"><span class="hljs-string">'poi'</span></span></code> </pre> <br><h2 id="finansovye-dannye">  рд╡рд┐рддреНрддреАрдп рдбреЗрдЯрд╛ </h2><br><p>  рдЗрд╕ рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдПрдХ NaN рдЬреНрдЮрд╛рдд рд╣реИ, рдФрд░ рдпрд╣ рдбреЗрдЯрд╛ рдореЗрдВ рд╕рд╛рдорд╛рдиреНрдп рдЕрдВрддрд░ рдХреЛ рд╡реНрдпрдХреНрдд рдХрд░рддрд╛ рд╣реИред  рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдбреЗрдЯрд╛ рдлреНрд░реЗрдо рдореЗрдВ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд▓рд╛рдЗрди рд╕реЗ рдЬреБрдбрд╝реЗ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рд╡рд┐рд╢реЗрд╖рддрд╛ рдкрд░ рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рд▓реЗрдЦрдХ рдХреЛ рдХреЛрдИ рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рдорд┐рд▓ рд╕рдХрддреА рд╣реИред  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдо рдорд╛рди рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ NaN 0 рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдХрд┐рд╕реА рд╡рд┐рд╢реЗрд╖ рдЧреБрдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреЛрдИ рдЬрд╛рдирдХрд╛рд░реА рдирд╣реАрдВ рд╣реИред </p><br><pre> <code class="hljs powershell">payments = source_df[<span class="hljs-type"><span class="hljs-type">payments_features</span></span>] payments = payments.replace(<span class="hljs-string"><span class="hljs-string">'NaN'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><h3 id="proverka-dannyh">  рдбреЗрдЯрд╛ рд╕рддреНрдпрд╛рдкрди </h3><br><p>  рдбреЗрдЯрд╛рд╕реЗрдЯ рдореЗрдВ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореВрд▓ рдкреАрдбреАрдПрдл рдХреЗ</a> рд╕рд╛рде рддреБрд▓рдирд╛ рдХрд░рдиреЗ рдкрд░, рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ рдбреЗрдЯрд╛ рдереЛрдбрд╝рд╛ рд╡рд┐рдХреГрдд рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ <strong>рднреБрдЧрддрд╛рди</strong> <em>рдбреЗрдЯрд╛ рдлрд╝реНрд░реЗрдо</em> рдореЗрдВ рд╕рднреА рд▓рд╛рдЗрдиреЛрдВ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ <em>, рдХреБрд▓_</em> <strong>рднреБрдЧрддрд╛рди</strong> рдлрд╝реАрд▓реНрдб рдЗрд╕ рд╡реНрдпрдХреНрддрд┐ рдХреЗ рд╕рднреА рд╡рд┐рддреНрддреАрдп рд▓реЗрдирджреЗрди рдХрд╛ рдпреЛрдЧ рд╣реИред  рдЖрдк рдЗрд╕реЗ рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╕рддреНрдпрд╛рдкрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="hljs powershell">errors = payments[<span class="hljs-type"><span class="hljs-type">payments</span></span>[<span class="hljs-type"><span class="hljs-type">payments_features</span></span>[:-<span class="hljs-number"><span class="hljs-number">1</span></span>]]<span class="hljs-type"><span class="hljs-type">.sum</span></span>(<span class="hljs-type"><span class="hljs-type">axis</span></span>=<span class="hljs-string"><span class="hljs-string">'columns'</span></span>) != <span class="hljs-type"><span class="hljs-type">payments</span></span>[<span class="hljs-string"><span class="hljs-string">'total_payments'</span></span>]] errors.head()</code> </pre> <br><p><img src="https://habrastorage.org/webt/eo/79/ye/eo79ye27iirsiwcuickrxz4on30.png" alt="2 рдЕрдорд╛рдиреНрдп рд▓рд╛рдЗрдиреЗрдВ"><br>  рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ BELFER ROBERT рдФрд░ BHATNAGAR SANJAY рдХреЗ рдкрд╛рд╕ рдЧрд▓рдд рднреБрдЧрддрд╛рди рд░рд╛рд╢рд┐ рд╣реИред </p><br><p>  рдЖрдк рдЗрд╕ рддреНрд░реБрдЯрд┐ рдХреЛ рдбреЗрдЯрд╛ рд▓рд╛рдЗрдиреЛрдВ рдореЗрдВ рдмрд╛рдИрдВ рдпрд╛ рджрд╛рдИрдВ рдУрд░ рд▓реЗ рдЬрд╛рдХрд░ рдФрд░ рдлрд┐рд░ рд╕реЗ рд╕рднреА рднреБрдЧрддрд╛рдиреЛрдВ рдХрд╛ рдпреЛрдЧ рдЧрд┐рдирдХрд░ рдареАрдХ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="hljs powershell">import numpy as np shifted_values = payments.loc[<span class="hljs-string"><span class="hljs-string">'BELFER ROBERT'</span></span>, <span class="hljs-type"><span class="hljs-type">payments_features</span></span>[<span class="hljs-number"><span class="hljs-number">1</span></span>:]].values expected_payments = shifted_values.sum() shifted_values = np.append(shifted_values, expected_payments) payments.loc[<span class="hljs-string"><span class="hljs-string">'BELFER ROBERT'</span></span>, <span class="hljs-type"><span class="hljs-type">payments_features</span></span>] = shifted_values shifted_values = payments.loc[<span class="hljs-string"><span class="hljs-string">'BHATNAGAR SANJAY'</span></span>, <span class="hljs-type"><span class="hljs-type">payments_features</span></span>[:-<span class="hljs-number"><span class="hljs-number">1</span></span>]].values payments.loc[<span class="hljs-string"><span class="hljs-string">'BHATNAGAR SANJAY'</span></span>, <span class="hljs-type"><span class="hljs-type">payments_features</span></span>] = np.insert(shifted_values, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><h2 id="dannye-po-akciyam">  рд╕реНрдЯреЙрдХ рдбреЗрдЯрд╛ </h2><br><pre> <code class="hljs powershell">stocks = source_df[<span class="hljs-type"><span class="hljs-type">stock_features</span></span>] stocks = stocks.replace(<span class="hljs-string"><span class="hljs-string">'NaN'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre> <br><p>  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ рдПрдХ рд╕рддреНрдпрд╛рдкрди рдЬрд╛рдБрдЪ рднреА рдХрд░реЗрдВ: </p><br><pre> <code class="hljs powershell">errors = stocks[<span class="hljs-type"><span class="hljs-type">stocks</span></span>[<span class="hljs-type"><span class="hljs-type">stock_features</span></span>[:-<span class="hljs-number"><span class="hljs-number">1</span></span>]]<span class="hljs-type"><span class="hljs-type">.sum</span></span>(<span class="hljs-type"><span class="hljs-type">axis</span></span>=<span class="hljs-string"><span class="hljs-string">'columns'</span></span>) != <span class="hljs-type"><span class="hljs-type">stocks</span></span>[<span class="hljs-string"><span class="hljs-string">'total_stock_value'</span></span>]] errors.head()</code> </pre> <br><p><img src="https://habrastorage.org/webt/sd/28/mz/sd28mzikmhurh_b0mqwibnje8fa.png" alt="рдЫрд╡рд┐"></p><br><p>  рд╣рдо рдЗрд╕реА рддрд░рд╣ рд╢реЗрдпрд░реЛрдВ рдореЗрдВ рддреНрд░реБрдЯрд┐ рдХреЛ рдареАрдХ рдХрд░реЗрдВрдЧреЗ: </p><br><pre> <code class="hljs powershell">shifted_values = stocks.loc[<span class="hljs-string"><span class="hljs-string">'BELFER ROBERT'</span></span>, <span class="hljs-type"><span class="hljs-type">stock_features</span></span>[<span class="hljs-number"><span class="hljs-number">1</span></span>:]].values expected_payments = shifted_values.sum() shifted_values = np.append(shifted_values, expected_payments) stocks.loc[<span class="hljs-string"><span class="hljs-string">'BELFER ROBERT'</span></span>, <span class="hljs-type"><span class="hljs-type">stock_features</span></span>] = shifted_values shifted_values = stocks.loc[<span class="hljs-string"><span class="hljs-string">'BHATNAGAR SANJAY'</span></span>, <span class="hljs-type"><span class="hljs-type">stock_features</span></span>[:-<span class="hljs-number"><span class="hljs-number">1</span></span>]].values stocks.loc[<span class="hljs-string"><span class="hljs-string">'BHATNAGAR SANJAY'</span></span>, <span class="hljs-type"><span class="hljs-type">stock_features</span></span>] = np.insert(shifted_values, <span class="hljs-number"><span class="hljs-number">0</span></span>, shifted_values[-<span class="hljs-number"><span class="hljs-number">1</span></span>])</code> </pre> <br><h2 id="svodnye-dannye-po-elektronnoy-perepiske">  рдИрдореЗрд▓ рдкрддреНрд░рд╛рдЪрд╛рд░ </h2><br><p>  рдЕрдЧрд░ рдЗрди рд╡рд┐рддреНрдд рдпрд╛ рд╕реНрдЯреЙрдХ рдХреЗ рд▓рд┐рдП NaN 0 рдХреЗ рдмрд░рд╛рдмрд░ рдерд╛, рдФрд░ рдпрд╣ рдЗрди рд╕рдореВрд╣реЛрдВ рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдХреЗ рд▓рд┐рдП рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдо рдореЗрдВ рдлрд┐рдЯ рд╣реЛрддрд╛ рд╣реИ, рддреЛ рдИрдореЗрд▓ рдХреЗ рдорд╛рдорд▓реЗ рдореЗрдВ NaN рдХреБрдЫ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдХреЗ рд╕рд╛рде рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рдЙрдЪрд┐рдд рд╣реИред  рдРрд╕рд╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк Imputer рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: </p><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">from</span></span> sklearn.impute <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SimpleImputer imp = SimpleImputer()</code> </pre> <br><p>  рдЙрд╕реА рд╕рдордп, рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рд╢реНрд░реЗрдгреА рдХреЗ рд▓рд┐рдП рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди рдкрд░ рд╡рд┐рдЪрд╛рд░ рдХрд░реЗрдВрдЧреЗ (рдЪрд╛рд╣реЗ рд╣рдо рдзреЛрдЦрд╛рдзрдбрд╝реА рдХреЗ рдХрд┐рд╕реА рд╡реНрдпрдХреНрддрд┐ рдкрд░ рд╕рдВрджреЗрд╣ рдХрд░реЗрдВ): </p><br><pre> <code class="hljs markdown">target = source<span class="hljs-emphasis"><span class="hljs-emphasis">_df[target_</span></span>field] email<span class="hljs-emphasis"><span class="hljs-emphasis">_data = source_</span></span>df[<span class="hljs-string"><span class="hljs-string">email_features</span></span>] email<span class="hljs-emphasis"><span class="hljs-emphasis">_data = pd.concat([email_</span></span>data, target], axis=1) email<span class="hljs-emphasis"><span class="hljs-emphasis">_data_</span></span>poi = email<span class="hljs-emphasis"><span class="hljs-emphasis">_data[email_</span></span>data[<span class="hljs-string"><span class="hljs-string">target_field</span></span>]][<span class="hljs-string"><span class="hljs-string">email_features</span></span>] email<span class="hljs-emphasis"><span class="hljs-emphasis">_data_</span></span>nonpoi = email<span class="hljs-emphasis"><span class="hljs-emphasis">_data[email_</span></span>data[<span class="hljs-string"><span class="hljs-string">target_field</span></span>] == False][email<span class="hljs-emphasis"><span class="hljs-emphasis">_features] email_</span></span>data<span class="hljs-emphasis"><span class="hljs-emphasis">_poi[email_</span></span>features] = imp.fit<span class="hljs-emphasis"><span class="hljs-emphasis">_transform(email_</span></span>data<span class="hljs-emphasis"><span class="hljs-emphasis">_poi) email_</span></span>data<span class="hljs-emphasis"><span class="hljs-emphasis">_nonpoi[email_</span></span>features] = imp.fit<span class="hljs-emphasis"><span class="hljs-emphasis">_transform(email_</span></span>data<span class="hljs-emphasis"><span class="hljs-emphasis">_nonpoi) email_</span></span>data = email<span class="hljs-emphasis"><span class="hljs-emphasis">_data_</span></span>poi.append(email<span class="hljs-emphasis"><span class="hljs-emphasis">_data_</span></span>nonpoi)</code> </pre> <br><p>  рд╕реБрдзрд╛рд░ рдХреЗ рдмрд╛рдж рдЕрдВрддрд┐рдо рдбреЗрдЯрд╛рд╕реЗрдЯ: </p><br><pre> <code class="hljs cs">df = payments.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(stocks) df = df.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(email_data) df = df.astype(<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>)</code> </pre> <br><h2 id="vybrosy">  рдЙрддреНрд╕рд░реНрдЬрди </h2><br><p>  рдЗрд╕ рдЪрд░рдг рдХреЗ рдЕрдВрддрд┐рдо рдЪрд░рдг рдореЗрдВ, рд╣рдо рд╕рднреА рдЖрдЙрдЯрд▓реЗрд░реНрд╕ рдХреЛ рд╣рдЯрд╛ рджреЗрдВрдЧреЗ, рдЬреЛ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЛ рд╡рд┐рдХреГрдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕реА рд╕рдордп, рд╕рд╡рд╛рд▓ рд╣рдореЗрд╢рд╛ рдЙрдарддрд╛ рд╣реИ: рд╣рдо рдирдореВрдирд╛ рд╕реЗ рдХрд┐рддрдирд╛ рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЕрднреА рднреА рдПрдХ рдкреНрд░рд╢рд┐рдХреНрд╖рд┐рдд рдореЙрдбрд▓ рдХреЗ рд░реВрдк рдореЗрдВ рдирд╣реАрдВ рдЦреЛ рд╕рдХрддреЗ рд╣реИрдВ?  рдореИрдВрдиреЗ рдпреВрдбреАрд╕рд┐рдЯреА рдкрд░ рдПрдордПрд▓ (рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ) рдкрд╛рдареНрдпрдХреНрд░рдо рдореЗрдВ рд╡реНрдпрд╛рдЦреНрдпрд╛рддрд╛рдУрдВ рдореЗрдВ рд╕реЗ рдПрдХ рдХреА рд╕рд▓рд╛рд╣ рдХрд╛ рдкрд╛рд▓рди рдХрд┐рдпрд╛ - "10 рдирд┐рдХрд╛рд▓реЗрдВ рдФрд░ рдлрд┐рд░ рд╕реЗ рдЙрддреНрд╕рд░реНрдЬрди рдХреА рдЬрд╛рдВрдЪ рдХрд░реЗрдВред" </p><br><pre> <code class="hljs powershell">first_quartile = df.quantile(q=<span class="hljs-number"><span class="hljs-number">0.25</span></span>) third_quartile = df.quantile(q=<span class="hljs-number"><span class="hljs-number">0.75</span></span>) IQR = third_quartile - first_quartile outliers = df[(<span class="hljs-type"><span class="hljs-type">df</span></span> &gt; (<span class="hljs-type"><span class="hljs-type">third_quartile</span></span> + <span class="hljs-number"><span class="hljs-number">1.5</span></span> * <span class="hljs-type"><span class="hljs-type">IQR</span></span>)) | (<span class="hljs-type"><span class="hljs-type">df</span></span> &lt; (<span class="hljs-type"><span class="hljs-type">first_quartile</span></span> - <span class="hljs-number"><span class="hljs-number">1.5</span></span> * <span class="hljs-type"><span class="hljs-type">IQR</span></span>))].count(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) outliers.sort_values(axis=<span class="hljs-number"><span class="hljs-number">0</span></span>, ascending=False, inplace=True) outliers = outliers.head(<span class="hljs-number"><span class="hljs-number">10</span></span>) outliers</code> </pre> <br><p>  рдЙрд╕реА рд╕рдордп, рд╣рдо рдЙрди рд░рд┐рдХреЙрд░реНрдбреНрд╕ рдХреЛ рдирд╣реАрдВ рд╣рдЯрд╛рдПрдВрдЧреЗ рдЬреЛ рдЖрдЙрдЯрд▓реЗрд░ рд╣реИрдВ рдФрд░ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХрд╛ рд╕рдВрджреЗрд╣ рд╣реИред  рдХрд╛рд░рдг рдпрд╣ рд╣реИ рдХрд┐ рдЗрд╕ рддрд░рд╣ рдХреЗ рдбреЗрдЯрд╛ рдХреЗ рд╕рд╛рде рдХреЗрд╡рд▓ 18 рдкрдВрдХреНрддрд┐рдпрд╛рдБ рд╣реИрдВ, рдФрд░ рд╣рдо рдЙрдиреНрд╣реЗрдВ рдмрд▓рд┐рджрд╛рди рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рд╕реЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рдЙрджрд╛рд╣рд░рдгреЛрдВ рдХреА рдХрдореА рд╣реЛ рд╕рдХрддреА рд╣реИред  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рд╣рдо рдХреЗрд╡рд▓ рдЙрди рд▓реЛрдЧреЛрдВ рдХреЛ рд╣рдЯрд╛ рджреЗрддреЗ рд╣реИрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдзреЛрдЦрд╛рдзрдбрд╝реА рдХрд╛ рд╕рдВрджреЗрд╣ рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдПрдХ рд╣реА рд╕рдордп рдореЗрдВ рдмрдбрд╝реА рд╕рдВрдЦреНрдпрд╛ рдореЗрдВ рд╕рдВрдХреЗрдд рд╣реИрдВ рдЬрд┐рдирдХреЗ рджреНрд╡рд╛рд░рд╛ рдЙрддреНрд╕рд░реНрдЬрди рджреЗрдЦрд╛ рдЧрдпрд╛ рд╣реИ: </p><br><pre> <code class="hljs powershell">target_for_outliers = target.loc[<span class="hljs-type"><span class="hljs-type">outliers.index</span></span>] outliers = pd.concat([<span class="hljs-type"><span class="hljs-type">outliers</span></span>, <span class="hljs-type"><span class="hljs-type">target_for_outliers</span></span>], axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) non_poi_outliers = outliers[<span class="hljs-type"><span class="hljs-type">np.logical_not</span></span>(<span class="hljs-type"><span class="hljs-type">outliers.poi</span></span>)] df.drop(non_poi_outliers.index, inplace=True)</code> </pre> <br><h2 id="privedenie-k-itogovom-vidu">  рдЕрдВрддрд┐рдо рдорди рдореЗрдВ рд▓рд╛рдирд╛ </h2><br><p>  рд╣рдо рдЕрдкрдирд╛ рдбреЗрдЯрд╛ рд╕рд╛рдорд╛рдиреНрдп рдХрд░рддреЗ рд╣реИрдВ: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.preprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> scale df[df.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>] = scale(df)</code> </pre> <br><p>  рд▓рдХреНрд╖реНрдп рдЪрд░ рдХреЛ рд╕рдВрдЧрдд рджреГрд╢реНрдп рдкрд░ рд▓рдХреНрд╖рд┐рдд рдХрд░реЗрдВ: </p><br><pre> <code class="hljs cmake"><span class="hljs-keyword"><span class="hljs-keyword">target</span></span>.drop(non_poi_outliers.index, inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">target</span></span>.map({<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">target</span></span>.value_counts()</code> </pre> <br><p><img src="https://habrastorage.org/webt/nr/mn/fi/nrmnfi0bdldw36fg9uy-tcxinsa.png" alt="рдЫрд╡рд┐"><br>  рдирддреАрдЬрддрди, 18 рд╕рдВрджрд┐рдЧреНрдз рдФрд░ 121 рдЬреЛ рд╕рдВрджреЗрд╣ рдХреЗ рджрд╛рдпрд░реЗ рдореЗрдВ рдирд╣реАрдВ рдЖрдПред </p><br><h1 id="otbor-priznakov">  рдлрд╝реАрдЪрд░ рдЪрдпрди </h1><br><p>  рдХрд┐рд╕реА рднреА рдореЙрдбрд▓ рдХреЛ рд╕реАрдЦрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рд╢рд╛рдпрдж рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдмрд┐рдВрджреБрдУрдВ рдореЗрдВ рд╕реЗ рдПрдХ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рдЪрдпрди рд╣реИред </p><br><h2 id="proverka-na-multikollinearnost">  рдорд▓реНрдЯреАрдХреЛрд▓рд┐рдирд░рд┐рдЯреА рдЯреЗрд╕реНрдЯ </h2><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns %matplotlib <span class="hljs-keyword"><span class="hljs-keyword">inline</span></span> sns.<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>(style="whitegrid") corr = df.corr() * <span class="hljs-number"><span class="hljs-number">100</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">Select</span></span> upper triangle <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> correlation matrix mask = np.zeros_like(corr, dtype=np.bool) mask[np.triu_indices_from(mask)] = <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> # <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> up the matplotlib figure f, ax = plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">11</span></span>)) # Generate a custom diverging colormap cmap = sns.diverging_palette(<span class="hljs-number"><span class="hljs-number">220</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>) # Draw the heatmap <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> the mask <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> correct aspect ratio sns.heatmap(corr, mask=mask, cmap=cmap, center=<span class="hljs-number"><span class="hljs-number">0</span></span>, linewidths=<span class="hljs-number"><span class="hljs-number">1</span></span>, cbar_kws={"shrink": <span class="hljs-number"><span class="hljs-number">.7</span></span>}, annot=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, fmt=".2f")</code> </pre> <br><p><img src="https://habrastorage.org/webt/kw/66/ta/kw66tahpopi7zjc6tvaj1uzq9qe.png" alt="рдЫрд╡рд┐"><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рдЫрд╡рд┐ рд╕реЗ рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, рд╣рдорд╛рд░рд╛ 'рд▓реЛрди_рдПрдбрд╡рд╛рдВрд╕' рдФрд░ 'рдЯреЛрдЯрд▓_рдкреЗрдореЗрдВрдЯреНрд╕' рдХреЗ рд╕рд╛рде-рд╕рд╛рде 'рдЯреЛрдЯрд▓_рд╕реНрдЯреЙрдХ_рд╡рд▓реНрдпреВ' рдФрд░ 'рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд_рд╕реНрдЯреЙрдХ' рдХреЗ рдмреАрдЪ рдПрдХ рд╕реНрдкрд╖реНрдЯ рд╕рдВрдмрдВрдз рд╣реИред  рдЬреИрд╕рд╛ рдХрд┐ рдкрд╣рд▓реЗ рдЙрд▓реНрд▓реЗрдЦ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, 'Total_payments' рдФрд░ 'total_stock_value' рдХреЗрд╡рд▓ рдПрдХ рд╡рд┐рд╢реЗрд╖ рд╕рдореВрд╣ рдХреЗ рд╕рднреА рд╕рдВрдХреЗрддрдХреЛрдВ рдХреЛ рдЬреЛрдбрд╝рдиреЗ рдХрд╛ рдкрд░рд┐рдгрд╛рдо рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдЙрдиреНрд╣реЗрдВ рд╣рдЯрд╛рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: </p><br><pre> <code class="hljs pgsql">df.<span class="hljs-keyword"><span class="hljs-keyword">drop</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>=[<span class="hljs-string"><span class="hljs-string">'total_payments'</span></span>, <span class="hljs-string"><span class="hljs-string">'total_stock_value'</span></span>], inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>)</code> </pre> <br><h2 id="sozdanie-novyh-priznakov">  рдирдИ рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рдирд┐рд░реНрдорд╛рдг </h2><br><p>  рдпрд╣ рднреА рдзрд╛рд░рдгрд╛ рд╣реИ рдХрд┐ рд╕рдВрджрд┐рдЧреНрдзреЛрдВ рдиреЗ рдЙрди рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреА рддреБрд▓рдирд╛ рдореЗрдВ рдЕрдзрд┐рдХ рдмрд╛рд░ рдЕрдкрдиреЗ рд╕рд╛рдерд┐рдпреЛрдВ рдХреЛ рд▓рд┐рдЦрд╛ рдерд╛ рдЬреЛ рдЗрд╕рдореЗрдВ рд╢рд╛рдорд┐рд▓ рдирд╣реАрдВ рдереЗред  рдФрд░ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдРрд╕реЗ рд╕рдВрджреЗрд╢реЛрдВ рдХрд╛ рдЕрдиреБрдкрд╛рдд рдЖрдо рдХрд░реНрдордЪрд╛рд░рд┐рдпреЛрдВ рдХреЗ рд▓рд┐рдП рд╕рдВрджреЗрд╢реЛрдВ рдХреЗ рдЕрдиреБрдкрд╛рдд рд╕реЗ рдЕрдзрд┐рдХ рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдПред  рдЗрд╕ рдХрдерди рдХреЗ рдЖрдзрд╛рд░ рдкрд░, рдЖрдк рдирдП рд╕рдВрдХреЗрдд рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╕рдВрджрд┐рдЧреНрдзреЛрдВ рд╕реЗ рд╕рдВрдмрдВрдзрд┐рдд рдЖрд╡рдХ / рдЬрд╛рд╡рдХ рдХреЗ рдкреНрд░рддрд┐рд╢рдд рдХреЛ рджрд░реНрд╢рд╛рддреЗ рд╣реИрдВ: </p><br><pre> <code class="hljs powershell">df[<span class="hljs-string"><span class="hljs-string">'ratio_of_poi_mail'</span></span>] = df[<span class="hljs-string"><span class="hljs-string">'from_poi_to_this_person'</span></span>]/df[<span class="hljs-string"><span class="hljs-string">'to_messages'</span></span>] df[<span class="hljs-string"><span class="hljs-string">'ratio_of_mail_to_poi'</span></span>] = df[<span class="hljs-string"><span class="hljs-string">'from_this_person_to_poi'</span></span>]/df[<span class="hljs-string"><span class="hljs-string">'from_messages'</span></span>]</code> </pre> <br><h2 id="otsev-lishnih-priznakov">  рдЕрдирд╛рд╡рд╢реНрдпрдХ рд╕рдВрдХреЗрддреЛрдВ рдХреА рдЬрд╛рдВрдЪ рдХрд░рдирд╛ </h2><br><p>  рдПрдордПрд▓ рд╕реЗ рдЬреБрдбрд╝реЗ рд▓реЛрдЧреЛрдВ рдХреЗ рдЯреВрд▓рдХрд┐рдЯ рдореЗрдВ, рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ (SelectKBest, SelectPercentile, VarianceThreshold, рдЖрджрд┐) рдХреЗ рдЪрдпрди рдХреЗ рд▓рд┐рдП рдХрдИ рдЙрддреНрдХреГрд╖реНрдЯ рдЙрдкрдХрд░рдг рд╣реИрдВред  рдЗрд╕ рдорд╛рдорд▓реЗ рдореЗрдВ, RFECV рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдореЗрдВ рдХреНрд░реЙрд╕-рд╕рддреНрдпрд╛рдкрди рд╢рд╛рдорд┐рд▓ рд╣реИ, рдЬреЛ рдЖрдкрдХреЛ рд╕рдмрд╕реЗ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХреА рдЧрдгрдирд╛ рдХрд░рдиреЗ рдФрд░ рдирдореВрдиреЗ рдХреЗ рд╕рднреА рд╕рдмрд╕реЗрдЯ рдкрд░ рдЙрдиреНрд╣реЗрдВ рдЬрд╛рдВрдЪрдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ: </p><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split X_train, X_test, y_train, y_test = train_test_split(<span class="hljs-title"><span class="hljs-title">df</span></span>, <span class="hljs-title"><span class="hljs-title">target</span></span>, <span class="hljs-title"><span class="hljs-title">test_size</span></span>=0.2, <span class="hljs-title"><span class="hljs-title">random_state</span></span>=42)</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.feature_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RFECV <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestClassifier forest = RandomForestClassifier(random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>) rfecv = RFECV(estimator=forest, cv=<span class="hljs-number"><span class="hljs-number">5</span></span>, scoring=<span class="hljs-string"><span class="hljs-string">'accuracy'</span></span>) rfecv = rfecv.fit(X_train, y_train) plt.figure() plt.xlabel("Number of features selected") plt.ylabel("Cross validation score of number of selected features") plt.plot(range(<span class="hljs-number"><span class="hljs-number">1</span></span>, len(rfecv.grid_scores_) + <span class="hljs-number"><span class="hljs-number">1</span></span>), rfecv.grid_scores_, <span class="hljs-string"><span class="hljs-string">'--o'</span></span>) indices = rfecv.get_support() <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> = X_train.<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>[indices] print(<span class="hljs-string"><span class="hljs-string">'The most important columns are {}'</span></span>.format(<span class="hljs-string"><span class="hljs-string">','</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">columns</span></span>)))</code> </pre> <br><p><img src="https://habrastorage.org/webt/fm/-7/oo/fm-7oo9gnbxhmpiw_vwldkgpwpi.png" alt="рдЫрд╡рд┐"><br>  рдЬреИрд╕рд╛ рдХрд┐ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ, RandomForestClassifier рдиреЗ рдЧрдгрдирд╛ рдХреА рдХрд┐ 18 рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдореЗрдВ рд╕реЗ рдХреЗрд╡рд▓ 7 рд╣реА рдорд╛рдпрдиреЗ рд░рдЦрддреА рд╣реИред  рдмрд╛рдХреА рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдореЙрдбрд▓ рдХреА рд╕рдЯреАрдХрддрд╛ рдХрдо рд╣реЛ рдЬрд╛рддреА рд╣реИред </p><br><pre> <code class="hljs pgsql">The most important <span class="hljs-keyword"><span class="hljs-keyword">columns</span></span> are bonus, deferred_income, other, exercised_stock_options, shared_receipt_with_poi, ratio_of_poi_mail, ratio_of_mail_to_poi</code> </pre> <br><p>  рдЗрди 7 рд╡рд┐рд╢реЗрд╖рддрд╛рдУрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рднрд╡рд┐рд╖реНрдп рдореЗрдВ рдореЙрдбрд▓ рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдиреЗ рдФрд░ рдкреБрдирдГ рдзрд╛рд░рдг рдХрд░рдиреЗ рдХреЗ рдЬреЛрдЦрд┐рдо рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: </p><br><ul><li>  рдмреЛрдирд╕ </li><li>  deferred_income </li><li>  рдЕрдиреНрдп </li><li>  exercised_stock_options </li><li>  shared_receipt_with_poi </li><li>  ratio_of_poi_mail </li><li>  ratio_of_mail_to_poi </li></ul><br><p>  рднрд╡рд┐рд╖реНрдп рдХреЗ рдореЙрдбрд▓ рдХреЗ рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдкреНрд░рд╢рд┐рдХреНрд╖рдг рдФрд░ рдкрд░реАрдХреНрд╖рдг рдХреЗ рдирдореВрдиреЛрдВ рдХреА рд╕рдВрд░рдЪрдирд╛ рдмрджрд▓реЗрдВ: </p><br><pre> <code class="hljs powershell">X_train = X_train[<span class="hljs-type"><span class="hljs-type">columns</span></span>] X_test = X_test[<span class="hljs-type"><span class="hljs-type">columns</span></span>]</code> </pre> <br><p>  рдпрд╣ рдПрдирд░реЙрди рдбреЗрдЯрд╛рд╕реЗрдЯ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЛ рдПрдордПрд▓ рдореЗрдВ рдПрдХ рд╡рд░реНрдЧреАрдХрд░рдг рдХрд╛рд░реНрдп рдХреЗ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ рд╡рд░реНрдгрд┐рдд рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдкрд╣рд▓реЗ рднрд╛рдЧ рдХрд╛ рдЕрдВрдд рд╣реИред  рдЙрдбрдиреЗрд╕ рдкрд░ рдЗрдВрдЯреНрд░реЛрдбрдХреНрд╢рди рдЯреВ рдорд╢реАрди рд▓рд░реНрдирд┐рдВрдЧ рдХреЛрд░реНрд╕ рдХреА рд╕рд╛рдордЧреНрд░рд┐рдпреЛрдВ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ред  рдПрдХ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдЕрдЬрдЧрд░ рдиреЛрдЯрдмреБрдХ</a> рднреА рд╣реИ рдЬреЛ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЗ рдкреВрд░реЗ рдЕрдиреБрдХреНрд░рдо рдХреЛ рджрд░реНрд╢рд╛рддреА рд╣реИред </p><br><blockquote>  рджреВрд╕рд░рд╛ рднрд╛рдЧ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдБ рд╣реИ</a> <br></blockquote><p></p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi424891/">https://habr.com/ru/post/hi424891/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi424877/index.html">рджреНрд░рд╡ рдмреНрд░реЗрдХ рд╢реАрддрд▓рди рдкреНрд░рдгрд╛рд▓реА</a></li>
<li><a href="../hi424879/index.html">рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдЙрдкрд▓рдмреНрдзрддрд╛ рдпрд╛рдВрдбреЗрдХреНрд╕ рд╡реНрдпрд╛рдЦреНрдпрд╛рди</a></li>
<li><a href="../hi424881/index.html">Newtoo - 2018 рдореЗрдВ рдЦрд░реЛрдВрдЪ рд╕реЗ рдкреВрд░реНрдг рд╡рд┐рдХрд╕рд┐рдд рдмреНрд░рд╛рдЙрдЬрд╝рд░ рдЗрдВрдЬрди рд╡рд┐рдХрд╕рд┐рдд рдХрд░рдирд╛?</a></li>
<li><a href="../hi424887/index.html">рд▓рд┐рдбрд╛ рдХрд┐рд╕ рдмрд╛рд░реЗ рдореЗрдВ рдЪреБрдк рд╣реИ: рдПрдХ рдбреЗрд╡рд▓рдкрд░ рдХреЗ рдХрд░рд┐рдпрд░ рдХреА рд╢реБрд░реБрдЖрддред рд╕рд┐рджреНрдзрд╛рдВрдд рдпрд╛ рдХреИрд╕реЗ рдПрдХ Middl рдмрдирдиреЗ рдХреЗ рд▓рд┐рдП</a></li>
<li><a href="../hi424889/index.html">рдЗрдВрдЯреЗрд▓ 8087 рдХреЛрдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЗ рдЕрдВрджрд░ рджреЗрдЦрдирд╛</a></li>
<li><a href="../hi424893/index.html">рд╢рд┐рд▓реНрдкрдХрд╛рд░ рдиреЗ 1989 рдХреЗ рдореЙрдбрд▓ Macintosh SE / 30 рдХреЗ рд▓рд┐рдП рдПрдХ рд╡рд╛рдИрдлрд╛рдИ рдореЙрдбреНрдпреВрд▓ рдмрдирд╛рдпрд╛</a></li>
<li><a href="../hi424895/index.html">рдЯрд╛рдЗрдкрд┐рдВрдЧ: рдЕрдорд╛рдиреНрдп рд░рд╛рдЬреНрдпреЛрдВ рдХреЛ рдирд┐рд╖реНрдХреНрд░рд┐рдп рдмрдирд╛рдирд╛</a></li>
<li><a href="../hi424897/index.html">рдПрдХ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рдмреИрдардХред рдЕрдзреНрдпрд╛рдп 18</a></li>
<li><a href="../hi424899/index.html">рдСрдбрд┐рдпреЛ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛ рд╕реБрдирдирд╛ рд╣реИ: 15 рдкреЙрдбрдХрд╛рд╕реНрдЯ</a></li>
<li><a href="../hi424901/index.html">рдореЛрдмрд╛рдЗрд▓ рдбреЗрд╡рд▓рдкрд░ рдХреЗ рд▓рд┐рдП рджрд┐рд▓рдЪрд╕реНрдк рд╕рд╛рдордЧреНрд░реА рдХрд╛ рдкрд╛рдЪрди # 272 (24 рд╕рд┐рддрдВрдмрд░ - 30 рд╕рд┐рддрдВрдмрд░)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>