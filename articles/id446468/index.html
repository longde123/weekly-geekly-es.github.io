<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📟 👌🏾 🕗 Panduan Praktis untuk Variabel Lingkungan dalam Go 🕴️ 👰🏿 👩🏿‍💼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Halo, Habr! Saya sajikan kepada Anda terjemahan artikel Panduan yang tidak masuk akal untuk variabel lingkungan di Go by Enda Phelan. 

 Variabel ling...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Panduan Praktis untuk Variabel Lingkungan dalam Go</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/446468/">  Halo, Habr!  Saya sajikan kepada Anda terjemahan artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Panduan yang tidak masuk akal untuk variabel lingkungan di Go</a> by Enda Phelan. <br><br>  Variabel lingkungan adalah cara terbaik untuk menyimpan konfigurasi aplikasi, karena mereka dapat diatur pada tingkat sistem.  Ini adalah salah satu prinsip dari metodologi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">App Dua Belas-Faktor</a> , memungkinkan Anda untuk memisahkan aplikasi dari sistem di mana mereka berjalan (konfigurasi dapat bervariasi secara signifikan antara penyebaran, kode tidak boleh berbeda). <br><a name="habracut"></a><br><h3>  Menggunakan variabel lingkungan </h3><br>  Semua yang diperlukan untuk berinteraksi dengan variabel lingkungan ada di pustaka standar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">os</a> .  Ini adalah cara mendapatkan nilai dari variabel lingkungan PATH: <br><br><pre><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// Store the PATH environment variable in a variable path, exists := os.LookupEnv("PATH") if exists { // Print the value of the environment variable fmt.Print(path) } }</span></span></code> </pre> <br>  Dan - atur nilai variabel: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-comment"><span class="hljs-comment">// Set the USERNAME environment variable to "MattDaemon" os.Setenv("USERNAME", "MattDaemon") // Get the USERNAME environment variable username := os.Getenv("USERNAME") // Prints out username environment variable fmt.Print(username) }</span></span></code> </pre><br><h3>  Memuat variabel lingkungan dari file .env </h3><br>  Pada mesin pengembangan, di mana banyak proyek diluncurkan segera, menyimpan parameter di lingkungan variabel tidak selalu nyaman;  akan lebih logis untuk membaginya antara proyek menggunakan file env.  Anda dapat melakukan ini, misalnya, menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">godotenv</a> - ini adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">dotenv</a> porting ke perpustakaan Go Ruby.  Ini memungkinkan Anda untuk mengatur variabel lingkungan yang diperlukan untuk aplikasi dari file .env. <br><br>  Untuk menginstal paket, jalankan: <br><br><pre> <code class="bash hljs">go get github.com/joho/godotenv</code> </pre> <br>  Tambahkan pengaturan ke file .env di root proyek: <br><br><pre> <code class="bash hljs">GITHUB_USERNAME=craicoverflow GITHUB_API_KEY=TCtQrZizM1xeo1v92lsVfLOHDsF7TfT5lMvwSno</code> </pre><br>  Sekarang Anda dapat menggunakan nilai-nilai ini dalam aplikasi: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/joho/godotenv"</span></span> <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"os"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">// init is invoked before main() func init() { // loads values from .env into the system if err := godotenv.Load(); err != nil { log.Print("No .env file found") } } func main() { // Get the GITHUB_USERNAME environment variable githubUsername, exists := os.LookupEnv("GITHUB_USERNAME") if exists { fmt.Println(githubUsername) } // Get the GITHUB_API_KEY environment variable githubAPIKey, exists := os.LookupEnv("GITHUB_API_KEY") if exists { fmt.Println(githubAPIKey) } }</span></span></code> </pre><br>  Penting untuk diingat bahwa jika nilai variabel lingkungan diatur pada tingkat sistem, Go akan menggunakan nilai ini alih-alih yang ditentukan dalam file env. <br><br><h3>  Bungkus variabel lingkungan dalam modul konfigurasi </h3><br>  Memang menyenangkan, tentu saja, memiliki akses ke variabel lingkungan secara langsung, seperti yang ditunjukkan di atas, tetapi mempertahankan solusi seperti itu tampaknya agak bermasalah.  Nama variabel adalah string, dan jika itu berubah, maka bayangkan sakit kepala yang akan mengakibatkan proses memperbarui referensi variabel di seluruh aplikasi. <br><br>  Untuk mengatasi masalah ini, kami akan membuat modul konfigurasi untuk bekerja dengan variabel lingkungan dengan cara yang lebih terpusat dan didukung. <br><br>  Berikut ini adalah modul <b>konfigurasi</b> sederhana yang mengembalikan parameter konfigurasi dalam struktur <b>Konfigurasi</b> (kami juga menetapkan nilai parameter default jika tidak ada variabel lingkungan dalam sistem): <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"os"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> GitHubConfig <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Username <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> APIKey <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Config <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { GitHub GitHubConfig } <span class="hljs-comment"><span class="hljs-comment">// New returns a new Config struct func New() *Config { return &amp;Config{ GitHub: GitHubConfig{ Username: getEnv("GITHUB_USERNAME", ""), APIKey: getEnv("GITHUB_API_KEY", ""), }, } } // Simple helper function to read an environment or return a default value func getEnv(key string, defaultVal string) string { if value, exists := os.LookupEnv(key); exists { return value } return defaultVal }</span></span></code> </pre><br>  Selanjutnya, tambahkan tipe ke struktur <b>Config</b> , karena solusi yang ada hanya mendukung tipe string, yang tidak terlalu masuk akal untuk aplikasi besar. <br><br>  Buat penangan untuk tipe bool, slice dan integer: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> config <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"os"</span></span> <span class="hljs-string"><span class="hljs-string">"strconv"</span></span> <span class="hljs-string"><span class="hljs-string">"strings"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> GitHubConfig <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Username <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> APIKey <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Config <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { GitHub GitHubConfig DebugMode <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> UserRoles []<span class="hljs-keyword"><span class="hljs-keyword">string</span></span> MaxUsers <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> } <span class="hljs-comment"><span class="hljs-comment">// New returns a new Config struct func New() *Config { return &amp;Config{ GitHub: GitHubConfig{ Username: getEnv("GITHUB_USERNAME", ""), APIKey: getEnv("GITHUB_API_KEY", ""), }, DebugMode: getEnvAsBool("DEBUG_MODE", true), UserRoles: getEnvAsSlice("USER_ROLES", []string{"admin"}, ","), MaxUsers: getEnvAsInt("MAX_USERS", 1), } } // Simple helper function to read an environment or return a default value func getEnv(key string, defaultVal string) string { if value, exists := os.LookupEnv(key); exists { return value } return defaultVal } // Simple helper function to read an environment variable into integer or return a default value func getEnvAsInt(name string, defaultVal int) int { valueStr := getEnv(name, "") if value, err := strconv.Atoi(valueStr); err == nil { return value } return defaultVal } // Helper to read an environment variable into a bool or return default value func getEnvAsBool(name string, defaultVal bool) bool { valStr := getEnv(name, "") if val, err := strconv.ParseBool(valStr); err == nil { return val } return defaultVal } // Helper to read an environment variable into a string slice or return default value func getEnvAsSlice(name string, defaultVal []string, sep string) []string { valStr := getEnv(name, "") if valStr == "" { return defaultVal } val := strings.Split(valStr, sep) return val }</span></span></code> </pre><br>  Tambahkan variabel lingkungan baru ke file env kami: <br><br><pre> <code class="bash hljs">GITHUB_USERNAME=craicoverflow GITHUB_API_KEY=TCtQrZizM1xeo1v92lsVfLOHDsF7TfT5lMvwSno MAX_USERS=10 USER_ROLES=admin,super_admin,guest DEBUG_MODE=<span class="hljs-literal"><span class="hljs-literal">false</span></span></code> </pre><br>  Sekarang Anda dapat menggunakannya di mana saja di aplikasi: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"log"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/craicoverflow/go-environment-variables-example/config"</span></span> <span class="hljs-string"><span class="hljs-string">"github.com/joho/godotenv"</span></span> ) <span class="hljs-comment"><span class="hljs-comment">// init is invoked before main() func init() { // loads values from .env into the system if err := godotenv.Load(); err != nil { log.Print("No .env file found") } } func main() { conf := config.New() // Print out environment variables fmt.Println(conf.GitHub.Username) fmt.Println(conf.GitHub.APIKey) fmt.Println(conf.DebugMode) fmt.Println(conf.MaxUsers) // Print out each role for _, role := range conf.UserRoles { fmt.Println(role) } }</span></span></code> </pre><br><h3>  Selesai! </h3><br>  Ya, ada paket yang menawarkan solusi turnkey untuk mengkonfigurasi aplikasi Anda, tetapi berapa banyak yang dibutuhkan jika sangat mudah melakukannya sendiri? <br><br>  Dan bagaimana Anda mengelola konfigurasi di aplikasi Anda? </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id446468/">https://habr.com/ru/post/id446468/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id446458/index.html">DRO universal berdasarkan Arduino Nano - shDRO. Bagian 2</a></li>
<li><a href="../id446460/index.html">Intisari Desain Makanan Maret 2019</a></li>
<li><a href="../id446462/index.html">Perendaman dalam driver: prinsip umum pembalikan menggunakan contoh tugas NeoQUEST-2019</a></li>
<li><a href="../id446464/index.html">15 parrot: pilih penyedia hosting untuk server VPS / VDS</a></li>
<li><a href="../id446466/index.html">Pemasaran Konten untuk Bisnis: Habraseminar # 6 dan poin utamanya</a></li>
<li><a href="../id446470/index.html">Baling-baling 3D pertama di dunia dirilis</a></li>
<li><a href="../id446472/index.html">Pembaruan global untuk menampilkan hasil Lamptest.ru</a></li>
<li><a href="../id446476/index.html">Paket untuk Angular 8.0 dan Ivy</a></li>
<li><a href="../id446478/index.html">Saya tidak menghargai enkapsulasi, atau cara menggunakan tabel metode jenis lain untuk panggilan cepat metode pribadi</a></li>
<li><a href="../id446480/index.html">Ketidakamanan perusahaan</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>