<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ôüèº üöø üà≤ Dispositivos de bloque QEMU üèº üì≥ üë®‚Äçüîß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="QEMU tiene varias formas de conectar un dispositivo de bloque a una m√°quina virtual. Inicialmente, esto se implement√≥ de la siguiente manera: 


-hda ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Dispositivos de bloque QEMU</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/412825/"><p><img src="https://habrastorage.org/getpro/habr/post_images/65a/367/b43/65a367b437b3a4242250ff30063f4455.png" alt="imagen"></p><br><p>  QEMU tiene varias formas de conectar un dispositivo de bloque a una m√°quina virtual.  Inicialmente, esto se implement√≥ de la siguiente manera: </p><br><pre><code class="plaintext hljs">-hda /dev/sda1</code> </pre> <br><p>  Por lo tanto, discos virtuales conectados en los viejos tiempos de la virtualizaci√≥n.  Se puede usar hoy si solo queremos probar algunos liveCDs.  Desafortunadamente, tiene sus inconvenientes. <a name="habracut"></a>  : </p><br><ul><li>  Al conectar discos virtuales, es posible usar solo la interfaz que se considera como <code>/dev/hda</code> (hda, hdb, hdc, ..) en la m√°quina virtual;  Para CD, se <code>-cdrom</code> opci√≥n <code>-cdrom</code> </li><li>  Cuando un archivo (o dispositivo) est√° conectado a una m√°quina virtual, QEMU usa solo la configuraci√≥n predeterminada. </li></ul><br><h2 id="drive">  conducir </h2><br><p>  Para establecer otros par√°metros (tipo de bus, uso de cach√©, etc.), se agreg√≥ la opci√≥n <code>-drive</code> a <code>-drive</code> .  Aunque originalmente se us√≥ para establecer par√°metros tanto para el <em>backend</em> como para el <em>frontend</em> , en la actualidad solo se usa para establecer los par√°metros del <em>backend</em> , es decir, los par√°metros que afectan la conexi√≥n del dispositivo virtual dentro de la m√°quina virtual </p><br><pre> <code class="plaintext hljs">-drive file=/dev/sda1,if=ide,cache=writeback,aio=threads</code> </pre> <br><h2 id="device">  dispositivo </h2><br><p>  Establecer todos los par√°metros de un dispositivo de bloque con una opci√≥n a lo largo del tiempo result√≥ ser irrazonable.  Por lo tanto, las opciones se dividieron en dos.  Par√°metros de fondo, es decir, aquellos que se utilizan para configurar el entorno de virtualizaci√≥n.  Y <em>frontend</em> , que afectan c√≥mo se conecta el dispositivo en la m√°quina virtual.  Para este conjunto de par√°metros, se introdujo una nueva opci√≥n <code>-device</code> , que contiene la <em>identificaci√≥n de la identificaci√≥n de la</em> unidad especificada por el par√°metro <code>-drive</code> . </p><br><p>  El siguiente ejemplo de configuraci√≥n conectar√° la unidad con el <strong>identificador ide0-hd0</strong> , y el resultado es el mismo que conectar una unidad virtual, como se muestra en la introducci√≥n. </p><br><pre> <code class="plaintext hljs">-drive file=/dev/sda1,id=ide0-hd0,if=none,cache=writeback,aio=threads \ -device ide-drive,bus=ide.0,drive=ide0-hd0</code> </pre> <br><h1 id="lokalnye-blochnye-ustroystva-v-virtualnoy-mashine">  Dispositivos de bloque local en una m√°quina virtual. </h1><br><p> <a href=""><img src="https://habrastorage.org/webt/iu/bk/t0/iubkt0a0zeavkt_ntiqdcmg45bw.png"></a> </p><br><p>  El uso de dispositivos de bloque f√≠sico para m√°quinas virtuales no est√° muy extendido en la actualidad debido al uso generalizado de discos virtuales.  T√©cnicamente, podemos ejecutar una m√°quina virtual con alg√∫n sistema patentado desde un disco duro antiguo.  Sin embargo, en este caso, es mejor hacer primero una imagen de disco (imagen) usando <strong>dd</strong> e iniciar el sistema desde all√≠. </p><br><p>  Al igual que un dispositivo de bloque local, se puede conectar a una m√°quina virtual. </p><br><ul><li>  Matriz RAID local: dispositivo de tipo <em>md</em> </li><li>  Master DRBD (red RAID1) - <em>dispositivo de</em> tipo <em>drbd</em> </li><li>  Partici√≥n de disco creada en el grupo LVM - dispositivo de tipo <em>dm</em> </li><li>  Un archivo normal conectado a trav√©s de un bucle es un dispositivo de bucle </li><li><p>  Bloquear dispositivo desde otra computadora exportada a trav√©s del servidor NBD - <em>dispositivo de</em> tipo <em>nbd</em> </p><br><p>  <em>(Aqu√≠ tambi√©n vale la pena mencionar sobre el tipo de dispositivo Ceph rbd y el tipo de dispositivo ZFS zvol - aprox. Por)</em> <br><br></p><br><h2 id="nbd">  NBD </h2><br><p>  Considere el concepto de conectar un dispositivo de bloque desde una computadora remota a trav√©s de una red.  Vea el <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">manual separado para NBD</a> . </p><br></li></ul><br><p> <a href=""><img src="https://habrastorage.org/webt/on/dy/nf/ondynfow2qyce6r0j65pjmqwnqo.png" align="right"></a> <a href=""><img src="https://habrastorage.org/webt/tq/uv/am/tquvamsriwa3hlj4sh3972xbvyq.png" align="left"></a>  QEMU tiene una API NBD integrada, por lo que un dispositivo de bloque remoto expandido con un servidor NBD se puede conectar directamente a la m√°quina virtual a trav√©s de QEMU; vea la figura a la izquierda. </p><br><p>  Sin embargo, NBD es un protocolo bastante simple que no utiliza autenticaci√≥n en un servidor remoto y no controla el estado de la conexi√≥n.  El protocolo NBD supone que el cliente puede reconectarse si se interrumpe la conexi√≥n al servidor, pero desafortunadamente QEMU no. </p><br><p>  En parte, la situaci√≥n se puede resolver conectando varios dispositivos NBD y creando una matriz RAID virtual dentro de ellos.  Este enfoque tiene varias ventajas y un defecto fatal.  Si uno de los dispositivos se apaga, no pasar√° nada malo.  Pero si vuelan de una vez = ser√° malo.  Las operaciones de E / S en un entorno virtual ser√°n mucho m√°s r√°pidas, ya que las solicitudes se ejecutar√°n en paralelo a varias m√°quinas f√≠sicas (servidores NBD) a la vez.  Pero, por otro lado, requerir√° m√°s recursos del procesador virtual y la memoria virtual. </p><br><p>  El principal inconveniente de construir una matriz RAID a partir de dispositivos NBD en una m√°quina virtual es el dispositivo QEMU, si el dispositivo NBD se bloquea, se volver√° a conectar solo despu√©s de un <strong>reinicio completo de la</strong> m√°quina, mientras que un reinicio interno del sistema operativo dentro de la m√°quina virtual no ser√° suficiente.  Pero puede crear una m√°quina virtual sin discos que acceder√° de forma independiente al servidor NBD y conectar√° los dispositivos NBD necesarios.  Adem√°s, los dispositivos fallidos se deben volver a agregar a la matriz y volver a sincronizar, esto se puede hacer manualmente o mediante secuencias de comandos dentro de la m√°quina virtual. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/2z/hj/h8/2zhjh8517alwckyyggummg1-wj8.png" align="left"></a>  Es mejor acceder al servidor NBD utilizando el dispositivo de m√°quina virtual NBD.  Especialmente bueno, en t√©rminos de rendimiento de E / S, es construir una matriz RAID a partir de dispositivos NBD. </p><br><p>  Esta soluci√≥n result√≥ ser absolutamente la m√°s productiva de todas las probadas.  Y la m√°quina virtual pudo continuar la operaci√≥n ininterrumpida incluso en el caso de una desconexi√≥n del servidor NBD (o falla) con el tiempo. </p><br><p>  Por lo tanto, fue posible organizar un entorno de virtualizaci√≥n relativamente estable y al mismo tiempo productivo en equipos inestables. </p><br><blockquote>  El principal problema con las matrices RAID en la parte superior de los dispositivos NBD es que debe tener mucho cuidado al conectar un dispositivo que forma parte de una matriz RAID desde el servidor NBD.  Este es un proceso bastante delicado con una alta probabilidad de un error fatal, que puede conducir a la p√©rdida de datos.  Un peque√±o error tipogr√°fico es suficiente.  Vea la descripci√≥n del accidente automovil√≠stico fatal del 21 de julio de 2012 en la p√°gina <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Peanuts</a> . </blockquote><p>  La desventaja es que un dispositivo de bloque con el que una m√°quina virtual ya est√° funcionando no se puede conectar en otro lugar si su sistema de archivos no lo permite; esto es similar a <strong>iSCSI</strong> (interfaz de Internet del centro comercial del centro de Internet, versi√≥n de red de SCSI) o <strong>AoE</strong> ( <strong>Una</strong> tecnolog√≠a TA <strong>o</strong> ver <strong>E</strong> thernet). </p><br><h1 id="virtualnye-diski">  Discos virtuales </h1><br><p> <a href=""><img src="https://habrastorage.org/webt/id/fl/lr/idfllr5zwpo6jniv5emsyqhir2m.png"></a> </p><br><p>  QEMU puede conectar no solo dispositivos de bloque a la m√°quina virtual, sino tambi√©n, utilizando varias API, tambi√©n se puede conectar un archivo normal, que se ver√° como un dispositivo de bloque dentro de la m√°quina. </p><br><h2 id="formaty-virtualnyh-diskov">  Formatos de disco virtual </h2><br><blockquote>  Qemu puede trabajar con discos virtuales de varios formatos.  Para aquellos discos virtuales que se presentan en forma de archivos ordinarios, existe una <strong>utilidad qemu-img</strong> est√°ndar que se puede usar tanto para la conversi√≥n como para determinar el formato utilizado y sus par√°metros. <br><br>  Recuperando informaci√≥n del disco virtual guardada como un archivo normal.  Del mismo modo, puede obtener informaci√≥n sobre un disco virtual almacenado en GlusterFS: <br><pre> <code class="plaintext hljs">root@stroj~# qemu-img info /path_to_file/soubor.img</code> </pre> <br><br>  Sin embargo, para obtener informaci√≥n sobre un disco virtual utilizando la API de GlusterFS, debe usar los mismos par√°metros que se utilizan para conectar el disco virtual a la m√°quina virtual.  Para que pueda identificar el disco interno en la m√°quina donde est√° instalado y utilizado el cliente GlusterFS: <br><pre> <code class="plaintext hljs">root@stroj~# qemu-img info gluster+tcp://192.168.0.2/volume_name/soubor.img</code> </pre> <br><br>  El disco virtual VDI solo se puede identificar a trav√©s de la API Sheepdog: <br><pre> <code class="plaintext hljs">root@stroj~# qemu-img info sheepdog:192.168.0.2:8000:vdi_name</code> </pre> <br><br>  Para un disco virtual exportado desde el servidor NBD, es necesario asegurarse de que se especifique el servidor correcto y el puerto correcto, porque NBD no usa ning√∫n otro mecanismo de identificaci√≥n o autenticaci√≥n que elimine la confusi√≥n con otros discos virtuales <em>(la nueva versi√≥n de nbd-server usa solo un puerto e identifica el dispositivo por nombre - aprox. por)</em> : <br><pre> <code class="plaintext hljs">root@stroj~# qemu-img info nbd:192.168.0.2:8000</code> </pre> <br><br>  <strong>192.168.0.2</strong> <br>  La direcci√≥n IP del host desde el cual se conecta el dispositivo virtual.  Si este es el mismo host <strong>en el que se</strong> est√° ejecutando la <strong>informaci√≥n qemu-img</strong> , se puede usar <em>localhost en</em> lugar de la direcci√≥n IP <br><br>  <strong>8000</strong> <br>  El n√∫mero de puerto en el que escucha el daemon o el servidor.  De forma predeterminada, Sheepdog usa el puerto 7000, pero tambi√©n se puede ejecutar en un puerto diferente para evitar conflictos con otra aplicaci√≥n.  Un servidor NBD puede escuchar en diferentes puertos si se exporta m√°s de un dispositivo. </blockquote><p>  <strong>crudo</strong> <br>  en general, es simplemente un conjunto de datos grabados en el mismo formato que en un dispositivo de bloque convencional.  Un archivo 5G ocupar√° todo este lugar, independientemente de si contiene datos √∫tiles o solo espacio vac√≠o.  <em>(que no se aplica a archivos dispersos - aprox. por)</em> </p><br><p>  <strong>qcow</strong> <br>  Se diferencia del formato sin formato en que puede ser incremental, porque crece gradualmente; esto es conveniente para aquellos sistemas de archivos que no admiten archivos dispersos, por ejemplo FAT32.  Este formato tambi√©n le permite crear copias incrementales separadas desde un solo disco base.  El uso de dicha "plantilla" ahorra tiempo y espacio en disco.  Adem√°s, admite cifrado AES y compresi√≥n zlib.  La desventaja es que, a diferencia de los discos en bruto, dicho archivo no se puede montar en la m√°quina directamente en la que se encuentra.  Afortunadamente, hay una utilidad <strong>qemu-nbd</strong> que puede exportar este archivo como un dispositivo de bloqueo de red y luego conectarlo a un dispositivo NBD. </p><br><p>  <strong>qcow2</strong> <br>  es una versi√≥n actualizada del formato qcow.  La principal diferencia es que admite instant√°neas.  De lo contrario, no son fundamentalmente diferentes.  Tambi√©n es posible cumplir con qcow2, que se define internamente como QCOW versi√≥n 3, una vez que se incluy√≥ en el formato qcow2 hace mucho tiempo.  De hecho, este es un qcow2 modificado con el par√°metro lazy_refcounts, que se usa para instant√°neas.  Como la diferencia es de solo un bit, <strong>qemu-img</strong> de la versi√≥n 1.7 tiene la opci√≥n "modificar" para cambiarla.  Las versiones anteriores de <strong>qemu-img</strong> no lo hacen.  Si quer√≠a cambiar la versi√≥n del formato, era necesario convertir el disco virtual a un nuevo archivo, durante la conversi√≥n, el par√°metro compat se instal√≥ con el par√°metro compat, para lo cual fue necesario reducir el "1.1" a 0.10 ".  La presencia de la opci√≥n "enmendar" es conveniente porque no es necesario sobrescribir los datos debido a cambios menores. </p><br><pre> <code class="plaintext hljs">qemu-img create -f qcow2 -o compat=1.1 test.qcow2 8G</code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://blog.wikichoon.com/2014/12/virt-manager-10-creates-qcow2-images.html</a> </p><br><p>  <strong>qed</strong> <br>  Este es un formato COW incremental de un disco virtual que crea la menor carga en el host.  No admite ninguna compresi√≥n y utiliza dos tablas paralelas para direccionar bloques de datos (cl√∫steres).  Desafortunadamente, ning√∫n desarrollador estuvo interesado en su desarrollo durante mucho tiempo, por lo que su uso trae algunos problemas que se mencionar√°n. </p><br><p>  <strong>vdi</strong> <br>  formato de disco virtual utilizado por el sistema de virtualizaci√≥n Oracle Virtualbox. </p><br><p>  <strong>vmdk</strong> <br>  formato de disco virtual utilizado por los productos VMware.  Este tambi√©n es un formato que permite que un archivo crezca gradualmente.  Sin embargo, tiene una gran ventaja sobre los formatos qcow2 y qed, que tambi√©n se pueden usar con soluciones sin disco o con sistemas de archivos de red.  Le permite tener un archivo de disco virtual dividido en varios archivos peque√±os con tama√±os de 2 GB.  Esto permanece desde el momento en que los sistemas de archivos no pod√≠an crear archivos de m√°s de 2 GB.  La ventaja es que si dicho disco virtual se replica a trav√©s de la red, se transfieren menos datos y la sincronizaci√≥n es mucho m√°s r√°pida (por ejemplo, en el caso de GlusterFS).  En el caso de una soluci√≥n sin disco, tambi√©n se usa para almacenar solo archivos peque√±os con diferencias para cada instant√°nea </p><br><p>  <strong>vhdx</strong> <br>  formato de disco virtual utilizado por el sistema de virtualizaci√≥n Microsoft Hyper-V </p><br><p>  <strong>vpc</strong> <br>  formato de disco virtual utilizado por el sistema de virtualizaci√≥n Microsoft VirtualPC. </p><br><table><thead><tr><th></th><th>  <sup>Incre</sup> <sup><br></sup>  <sup>menti</sup> <sup><br></sup>  <sup>arraigado</sup> <sup><br></sup>  <sup>Es decir</sup> <br></th><th>  <sup>Cifrado</sup> <sup><br></sup>  <sup>novaci√≥n</sup> <br></th><th>  <sup>Com</sup> <sup><br></sup>  <sup>pres</sup> <sup><br></sup>  <sup>esto</sup> <br></th><th>  <sup>Preal</sup> <sup><br></sup>  <sup>ubicaci√≥n</sup> <br></th><th>  <sup>Shabl</sup> <sup><br></sup>  <sup>oniz</sup> <sup><br></sup>  <sup>naci√≥n</sup> <br></th><th>  <sup>Prop</sup> <sup><br></sup>  <sup>comadrejas</sup> <br></th><th>  <sup>Seccion</sup> <sup><br></sup>  <sup>imagen</sup> <br></th><th>  <sup>Dentro</sup> <sup><br></sup>  <sup>instant√°neas</sup> <sup><br></sup>  <sup>tu</sup> <br></th><th>  <sup>Verificaci√≥n acordada</sup> <sup><br></sup>  <sup>nosti</sup> <br></th><th>  <sup>Nota</sup> <br></th></tr></thead><tbody><tr><td>  <sup><b>crudo</b></sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>Se puede montar mediante <i>bucle</i></sup> <br></td></tr><tr><td>  <sup><b>archivo</b></sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>opci√≥n</sup> <sup><br></sup>  <sup>personalmente</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>Para Btrfs, debe deshabilitar la copia en escritura</sup> <br></td></tr><tr><td>  <sup><b>qcow</b></sup> </td><td>  <sup>si</sup> </td><td>  <sup>si</sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>si</sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td></td></tr><tr><td>  <sup><b>qcow2</b></sup> </td><td>  <sup>si</sup> </td><td>  <sup>si</sup> </td><td>  <sup>si</sup> </td><td>  <sup>opci√≥n</sup> <sup><br></sup>  <sup>personalmente</sup> </td><td>  <sup>si</sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>si</sup> </td><td>  <sup>si</sup> </td><td></td></tr><tr><td>  <sup><b>qed</b></sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td></td></tr><tr><td>  <sup><b>vmdk</b></sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>opci√≥n</sup> <sup><br></sup>  <sup>personalmente</sup> </td><td>  <sup>si</sup> </td><td>  <sup>eh</sup> <sup>?</sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td></td></tr><tr><td>  <sup><b>vdi</b></sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>opci√≥n</sup> <sup><br></sup>  <sup>est√°tica (est√°tica)</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>si</sup> </td><td></td></tr><tr><td>  <sup><b>vhdx</b></sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>opci√≥n</sup> <sup><br></sup>  <sup>fijo (fijo)</sup> </td><td>  <sup>no</sup> </td><td>  <sup>si</sup> <sup><a name="cite_ref-1"></a></sup>  <sup><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">1</a></sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td></td></tr><tr><td>  <sup><b>vpc</b></sup> </td><td>  <sup>si</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>opci√≥n</sup> <sup><br></sup>  <sup>fijo (fijo)</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td>  <sup>no</sup> </td><td></td></tr></tbody></table><br><ol><li><a name="cite_note-1"></a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">‚Üë</a> Es posible usar solo en im√°genes preinstaladas (fijo) <br></li></ol><br><h2 id="ispolzuemye-api">  API utilizadas </h2><br><p>  Adem√°s de los formatos de archivo, <strong>qemu-img</strong> tambi√©n funciona con "formatos" que se proporcionan utilizando la API a trav√©s de la cual se puede acceder a estos dispositivos de bloque de forma remota. </p><br><p>  <strong>nfs</strong> <br>  archivo de disco virtual conectado a QEMU a trav√©s del protocolo NFS </p><br><p>  <strong>iscsi</strong> <br>  La comunicaci√≥n con el dispositivo de bloqueo se realiza a trav√©s de iSCSI.  No se puede usar un dispositivo simult√°neamente en m√°s de un cliente. </p><br><p>  <strong>nbd</strong> <br>  El acceso a trav√©s de NBD puede ser muy r√°pido.  Esto se debe a que el protocolo es muy simple.  Esto es una ventaja, pero al mismo tiempo una desventaja.  Esto puede ser conveniente cuando varios clientes pueden conectarse al mismo servidor NBD si usan una conexi√≥n local a trav√©s del servidor xnbd.  Sin embargo, dado que nbd no tiene mecanismos de seguridad o autenticaci√≥n, una situaci√≥n puede surgir f√°cilmente cuando un cliente se conecta accidentalmente al dispositivo incorrecto, que en el momento dado ya puede usarse y da√±arlo. </p><br><p>  <strong>ssh</strong> <br>  la conexi√≥n al servidor remoto se realiza a trav√©s de sshfs </p><br><p>  <strong>brillo</strong> <br>  utiliza la API del sistema de archivos GlusterFS para acceder al archivo del disco virtual.  Si el archivo es parte de un volumen replicado o distribuido, distribuir√° los datos almacenados entre otros nodos.  Esto le permite, en caso de falla, estar disponible en otros nodos. </p><br><p>  <strong>perro pastor</strong> <br>  tambi√©n es un sistema de archivos distribuido habilitado para replicaci√≥n.  A diferencia de GlusterFS, un disco virtual a trav√©s de la API no est√° disponible como un archivo, sino como un dispositivo de bloque.  Esto es beneficioso en t√©rminos de rendimiento, pero es desventajoso si necesitamos ir m√°s all√° del entorno de Sheepdog. </p><br><p>  <strong>paralles</strong> </p><br><h1 id="virtualnye-diski-na-setevom-hranilische">  Unidades virtuales en almacenamiento conectado a la red </h1><br><p>  La ventaja de los dispositivos de bloque ubicados fuera del sistema de virtualizaci√≥n es que son inmunes a fallas de m√°quinas virtuales. </p><br><p>  En este caso, tambi√©n se proporciona alta disponibilidad y volumen suficiente para el almacenamiento remoto. </p><br><p>  <strong>Usando NFS</strong> <br> <a href=""><img src="https://habrastorage.org/webt/ws/ce/6f/wsce6f0lvdglrpbl1g_v4lif9py.png"></a> </p><br><p>  <strong>Perro pastor</strong> <br> <a href=""><img src="https://habrastorage.org/webt/lv/ko/k4/lvkok49hqjv-kp1uiis-8sg3ejw.png"></a> </p><br><p>  <strong>GlusterFS</strong> <br> <a href=""><img src="https://habrastorage.org/webt/n9/jz/0z/n9jz0zjuprv_mj-tmq9lhjtqfjy.png"></a> </p><br><h1 id="virtualnye-mashiny-bez-blochnyh-ustroystv">  M√°quinas virtuales sin bloques </h1><br><p>  Sin dispositivos de bloque, los sistemas operativos que pueden arrancar a trav√©s de NFS o con un sistema de archivos host lanzado con Plan9 pueden funcionar. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es412825/">https://habr.com/ru/post/es412825/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es412813/index.html">Encabezados HTTP innecesarios</a></li>
<li><a href="../es412815/index.html">Administrador web Llaves de cliente OpenVPN VPNFace Lite</a></li>
<li><a href="../es412819/index.html">Viernes de calentamiento para la mente: Karma perfecto para Habrahabr</a></li>
<li><a href="../es412821/index.html">Mira, mira, mira: ¬øcu√°l es la diferencia?</a></li>
<li><a href="../es412823/index.html">Entrevista en ingl√©s: c√≥mo hacerlo no es peor que el amigo del hijo de la madre</a></li>
<li><a href="../es412827/index.html">Pavel Durov: despu√©s de la apelaci√≥n de ILV, Apple bloque√≥ las actualizaciones de Telegram en todo el mundo</a></li>
<li><a href="../es412829/index.html">Centros de datos distribuidos del proveedor: qu√© y por qu√©</a></li>
<li><a href="../es412831/index.html">Lanzamiento de YouTrack 2018.2: nueva p√°gina de proyecto, imagen de DoTrack Docker y mucho m√°s</a></li>
<li><a href="../es412833/index.html">M√°s que Ford</a></li>
<li><a href="../es412835/index.html">NanoIntroducci√≥n a Internet de Nano-Things. Parte 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>