<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨â€ğŸŒ¾ ğŸ‘¨ğŸ¾â€ğŸš€ ğŸ’…ğŸ» Pemantauan SMS dari berat tiga sarang untuk $ 35 ğŸ‘¨ğŸ¿â€ğŸ¤â€ğŸ‘¨ğŸ¼ ğŸ¤°ğŸ» ğŸ‘©ğŸ¿â€ğŸ¤â€ğŸ‘©ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sudah cukup lama sejak publikasi sebelumnya tentang sistem sebesar $ 30 . 


 Apa yang telah berubah selama bulan bulan terakhir? 


1. Baterai surya ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pemantauan SMS dari berat tiga sarang untuk $ 35</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/448274/"><p><img src="https://habrastorage.org/getpro/habr/post_images/77d/797/12a/77d79712a55957a17ca74a0995a7844d.jpg" alt="Pemula"></p><br><p>  Sudah cukup lama sejak publikasi sebelumnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">tentang sistem sebesar $ 30</a> . </p><br><p>  Apa yang telah berubah selama bulan bulan terakhir? </p><br><ol><li>  Baterai surya telah ditambahkan - waktu pengoperasian hampir tidak terbatas. </li><li>  Ditambahkan mengirim informasi pada panggilan. </li><li>  Kemampuan untuk bekerja dengan semua jenis modul komunikasi yang muncul dalam pandangan saya - AiThinker, Goouu tech, SIM800 / 900, Neoway M590 * </li></ol><br><p>  Tetapi yang paling penting adalah bahwa modul komunikasi dan mikrokontroler sekarang terpisah secara fisik, yang menghilangkan gangguan dalam operasinya dengan HX711. </p><br><p>  Dan semua ini berkat kritik konstruktif terhadap penghuni dan peternak lebah Habrovsk yang bergabung dalam diskusi sistem. </p><br><p>  Sisa karakteristik kinerja tetap sama - berat maksimum sarang adalah 200 kg, setelah matahari terbenam, pengukuran dilakukan, dan indikator dikirim. </p><br><p>  Mengantisipasi kritik mengenai tidak digunakannya mode tidur dan jalur sinyal tambahan modul GSM saya akan mengatakan sebagai berikut: </p><br><p>  Setiap modul komunikasi memiliki spesifikasi masing-masing - beberapa tertidur pada level sinyal rendah, beberapa pada level tinggi, beberapa dengan ketukan ganda. </p><br><p>  Spesifikasi "lakukan sendiri" menyiratkan bagian kreatif tertentu, dan ada baiknya untuk menunjukkannya di sini. </p><br><p>  Saya juga membuat sistem dengan mata pada pengembangan lebih lanjut pemantauan parameter lain dari sarang, di mana tidur tidak terlalu diperlukan. </p><br><p>  Secara umum, dalam bagan judul - <del>  android murni </del>  sistem dasar dari mana Anda dapat menari di mana saja dengan desain dan jumlah / set sensor, modul, dll. </p><br><p>  Artikel ini adalah tentang skala, dan di bawah potongan, visi pribadi saya dan implementasi sistem. </p><br><p>  Dalam satu kata - SELAMAT DATANG!  Ayo pergi! </p><a name="habracut"></a><br><p>  Pertama-tama, sistem ini tidak tidur sama sekali, karena baterai surya dua sel 6 volt menghasilkan 5 volt dan hingga seratus miliamp bahkan dalam cuaca mendung. </p><br><p>  Dan konsumsi seluruh sistem adalah 17mA, dalam mode siaga (dalam standar GSM1800) dan sekitar tiga puluh pada GSM900. </p><br><p>  Selain itu, sebagaimana telah disebutkan, ini dilakukan dengan tujuan menerapkan fungsi pemantauan tambahan secara real time (misalnya, segerombolan dapat keluar dalam 5 menit) - tidak ada waktu untuk tidur ;-) </p><br><p>  Anda ingin penghematan energi absolut, sehingga akan ada di publikasi berikutnya, tetapi akan sangat berbeda <del>  ceritanya </del>  sistem. </p><br><h4 id="da-esche-po-povodu-snoski-o-modulyah-svyazi---ne-to-chtoby-ya-stal-adeptom-aithinker-prosto-neoway-nuzhno-esche-samomu-sobirat-a-moduli-sim800l-trebuyut-otdelnoy-stati-s-likbezom-po-rabote-s-nimi">  * Ya, sejauh catatan kaki tentang modul komunikasi yang bersangkutan, bukan karena saya menjadi ahli AiThinker, saya hanya perlu merakit sendiri Neoway, dan modul SIM800L memerlukan artikel terpisah dengan program pendidikan untuk bekerja dengannya. </h4><br><p>  Singkatnya, GSM yang dipilih adalah IMHO, satu-satunya yang dapat bekerja pada 4 kabel, termasuk daya, tanpa tarian tambahan dengan rebana. </p><br><p>  Kita membutuhkan seperangkat peralatan / bahan berikut: </p><br><ol><li>  Arduino Pro Mini 3V <br>  Anda harus memperhatikan microchip konverter linier - itu harus tepat 3.3V - pada chip marking KB 33 / LB 33 / DE A10 - orang Cina telah mencampuradukkan sesuatu dengan saya, dan seluruh batch <br>  papan sirkuit di toko ternyata dengan regulator 5-volt dan kuarsa 16MHz. </li><li>  USB-Ttl pada chip CH340 - Anda bahkan dapat 5 volt, tetapi kemudian selama firmware mikrokontroler, Arduino harus diputuskan dari modul GSM, agar tidak membakar yang terakhir. <br>  Papan pada chip PL2303 tidak berfungsi di bawah Windows 10. </li><li>  Modul komunikasi GSM Goouu Tech IOT GA-6-B atau AI-THINKER A-6 Mini. </li><li>  Antena GSM GPRS "YG-01" <br><img src="https://habrastorage.org/getpro/habr/post_images/ff7/aa9/69e/ff7aa969e86e53e60122bcdb2ca47c04.jpg"><br>  Bagaimana mereka mencapai peningkatan seperti itu - sebuah teka-teki - mungkin ini relatif terhadap ketiadaan sepenuhnya ;-). </li><li>  Paket pemula untuk operator yang memiliki jangkauan yang baik di lokasi pemeliharaan lebah Anda. <br>  Ya, paket pertama-tama harus diaktifkan di telepon biasa, Nonaktifkan PIN PERMINTAAN di pintu masuk, dan isi kembali akun. </li><li>  kawat dupont ibu 20cm ibu - 4 pcs.  (untuk menghubungkan Arduino ke USB-TTL) </li><li>  3 pcs  HX711 - ADC untuk skala </li><li>  6 memuat sel dengan berat hingga 50 kg </li><li>  Kabel telepon 4-inti 15 meter - untuk menghubungkan modul berat dan GSM dengan ARDUINO. </li><li>  Photoresistor GL5528 (ini penting, dengan resistansi gelap 1MOhm dan resistansi cahaya 10-20kOhm). </li><li>  dua pasang colokan dan soket 6P6C - telepon, soket - dengan "ekor" </li><li>  Pita sisi ganda 50cm lebar 10mm - untuk memasang panel surya ke rumahan modul GSM. </li><li>  Papan charger berbasis TP4056 untuk baterai LiIon </li><li>  Tempat baterai 18650 dan, pada kenyataannya, baterai itu sendiri. </li><li>  Sedikit lilin atau parafin (lilin lilin lampu aroma) - untuk perlindungan kelembaban HX711 </li><li>  Sepotong balok kayu 25x50x300mm untuk dasar sel beban. </li><li>  Selusin sekrup self-tapping dengan mesin cuci tekan 4,2x19 mm untuk memasang sensor ke pangkalan. </li><li>  Baterai surya 5-6V 2W (tidak ada di penyihir radio berikutnya - saya mengambil dua watt tunggal dan sepasang dioda 1N4148) <br><img src="https://habrastorage.org/getpro/habr/post_images/397/805/59c/39780559cbbd169641e5371eba3ec8e3.jpg" alt="Tampak belakang panel"><br>  Tidak ada arus balik melalui pengisi daya, tetapi modul surya paralel harus dihidupkan dengan benar melalui dioda </li><li>  Sebuah kotak untuk modul komunikasi dan baterai matahari (ukuran 60x100mm) - Anda dapat mengambil distribusi barang-barang listrik yang cocok, yang plastik dari kartu nama 30x60x100 sangat cocok. </li></ol><br><p>  Selain itu, akan membutuhkan tangan yang bengkok, solder besi EPSN-25, rosin dan solder POS-60. </p><br><p>  Untuk pertukangan, cukup gergaji kayu / logam, pahat dan bor dengan bor 3mm sudah cukup. </p><br><p>  Tata letak sistem adalah sebagai berikut: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d34/875/ffc/d34875ffca19e80ac4658a8e439f749e.jpg" alt="Tata letak"></p><br><p>  Bagaimanapun, Anda tidak boleh menempatkan modul GSM lebih dekat dari satu meter dari Arduino - dengan kekuatan sinyal yang tinggi dalam standar GSM900 ini dapat menyebabkan mikrokontroler untuk reboot! </p><br><p>  Nah, modul komunikasi dengan baterai surya - harus dipasang di tiang - dan penerimaan akan lebih baik, dan lebih jauh dari lebah. </p><br><p>  Sekarang mari kita mulai perakitan: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/eba/218/027/eba21802786557630e811458e9a07eaa.jpg" alt="GSM A6"></p><br><p>  Sebagai permulaan, dua LED disolder dari modul GSM (tempat mereka dilingkari dalam oval oranye). </p><br><p>  Kami memasukkan kartu SIM dengan bantalan ke papan sirkuit tercetak, sudut miring pada foto ditunjukkan oleh panah. </p><br><p>  Plus, dari baterai dan kabel menuju ke pengontrol, ia disolder langsung ke kapasitor (4). </p><br><p>  Faktanya adalah bahwa modul komunikasi itu sendiri membutuhkan 3.4-4.2V untuk catu dayanya, dan kontak PWR-nya terhubung ke konverter step-down step-down, sehingga untuk operasi dari tegangan li-ion harus diterapkan melewati bagian sirkuit ini. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b89/f94/1c2/b89f941c27d96e91f2d7ec3c970e453d.jpg" alt="Arduino Pro Mini 3v"></p><br><p>  Kemudian kami melakukan prosedur serupa dengan LED di papan Arduino (oval di sebelah kanan chip persegi). </p><br><p>  Kami menyolder sisir menjadi empat kontak (1), selalu secara horizontal - di sepanjang papan. </p><br><p>  Kami memperpendek kaki fotoresistor hingga 10 mm dan menyoldernya dengan konduktor 20 cm ke terminal GND dan D2 board (2). </p><br><p>  Kami menyediakan daya melalui konverter linier - pada arus rendah, drop-out voltage drop adalah 0.1V. </p><br><p>  Tetapi dengan memasok tegangan yang stabil ke modul HX711, kami menghilangkan kebutuhan untuk memperbaikinya pada tegangan yang lebih rendah (dan pada saat yang sama meningkatkan kebisingan sebagai hasil dari operasi ini). </p><br><p>  Sekarang Anda perlu mengambil 5 meter dari kabel telepon empat kawat, dan menyoldernya antara mikrokontroler dan modul komunikasi sesuai dengan diagram di awal artikel (warna kabel sesuai dengan kenyataan). </p><br><p>  Kami juga menyolder tempat baterai, kami akan melakukan sisanya nanti. </p><br><p>  Dan sekarang untuk beberapa waktu kita ngelantur dari besi solder, dan beralih ke bagian perangkat lunak. <br>  Saya akan menjelaskan urutan tindakan untuk Windows: <br>  Pertama, Anda perlu mengunduh dan menginstal / unzip program <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Arduino IDE</a> - versi saat ini adalah 1.8.9, tetapi saya menggunakan 1.6.4 </p><br><p>  Untuk mempermudah, kami membongkar arsip ke folder C: \ arduino- "your_version_number", di dalamnya kita akan memiliki folder / dist, driver, contoh, perangkat keras, java, lib, perpustakaan, referensi, alat, serta file yang dapat dieksekusi arduino (antara lain). </p><br><p>  Sekarang kita membutuhkan perpustakaan untuk bekerja dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">HX711</a> ADC - tombol "clone or download" berwarna hijau - unduh ZIP. </p><br><p>  Konten (folder HX711-master) ditempatkan di direktori C: \ arduino- "your_version_number" \ libraries </p><br><p>  Dan tentu saja, driver untuk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">USB-TTL berasal</a> dari github yang sama - dari arsip yang tidak dibongkar, file SETUP pemasang diluncurkan. </p><br><p>  Bagi mereka yang enggan repot dengan perpustakaan, saya mengemas perakitan program <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Arduino IDE saya</a> - cukup unduh dan buka paketnya. </p><br><p>  Kami memulai dan mengonfigurasi program C: \ arduino- "your_version_number" \ arduino </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/2fd/429/2d5/2fd4292d54f67c31052b54ca853be5b3.jpg" alt="Antarmuka program"></p><br><p>  Kita pergi ke item "Tools" - pilih papan "Arduino Pro atau Pro Mini", prosesor Atmega 328 3.3V 8 MHz, port adalah nomor selain sistem COM1 (muncul setelah menginstal driver CH340 dengan adaptor USB-TTL terhubung). </p><br><p>  Oke, salin sketsa (program) berikut dan tempel ke jendela IDE Arduino </p><br><pre><code class="plaintext hljs">char phone_no[]="+123456789012"; // Your phone number that receive SMS with counry code // NeverSleep #include &lt;SoftwareSerial.h&gt; // Sofrware serial library #include "HX711.h" // HX711 lib. https://github.com/bogde/HX711 #include &lt;EEPROM.h&gt; // EEPROM lib. HX711 scale0(10, 14); HX711 scale1(11, 14); HX711 scale2(12, 14); #define SENSORCNT 3 HX711 *scale[SENSORCNT]; SoftwareSerial mySerial(5, 4); // Set I/O-port TXD, RXD of GSM-shield float delta00; // delta weight from start float delta10; float delta20; float delta01; // delta weight from yesterday float delta11; float delta21; float raw00; //raw data from sensors on first start float raw10; float raw20; float raw01; //raw data from sensors on yesterday float raw11; float raw21; float raw02; //actual raw data from sensors float raw12; float raw22; word calibrate0=20880; //calibration factor for each sensor word calibrate1=20880; word calibrate2=20880; word daynum=0; //numbers of day after start int notsunset=0; boolean setZero=false; boolean forceSend=false; char ch = 0; char ch1 = 0; char ch2 = 0; char ch3 = 0; char ch4 = 0; void readVcc() // read battery capacity { ch = mySerial.read(); while (mySerial.available() &gt; 0) { ch = mySerial.read(); } // empty input buffer from modem mySerial.println("AT+CBC?"); //ask gprs for battery status (for sim800 and neoway command must be "AT+CBC" ) delay(200); while (mySerial.available() &gt; 0) { //read input string between coma and CR ch = mySerial.read(); if (ch ==','){ ch1 = mySerial.read(); ch2 = mySerial.read(); ch3 = mySerial.read(); ch4 = mySerial.read(); } } } // ********************************************************************** void SendStat() { detachInterrupt(digitalPinToInterrupt(0)); // turn off external interrupt digitalWrite(13, HIGH); if (!forceSend){ notsunset=0; for (int i=0; i &lt;= 250; i++){ if ( !digitalRead(2) ){ notsunset++; } //is a really sunset now? you shure? delay(360); } } if ( notsunset==0 || forceSend ) { raw01=raw02; raw11=raw12; raw21=raw22; raw02=scale0.get_units(16); //read data from scales raw12=scale1.get_units(16); raw22=scale2.get_units(16); daynum++; delta00=(raw02-raw00)/calibrate0; // calculate weight changes delta01=(raw02-raw01)/calibrate0; delta10=(raw12-raw10)/calibrate1; delta11=(raw12-raw11)/calibrate1; delta20=(raw22-raw20)/calibrate2; delta21=(raw22-raw21)/calibrate2; readVcc(); delay(200); mySerial.println("AT+CMGF=1"); // Part of SMS sending delay(2000); mySerial.print("AT+CMGS=\""); mySerial.print(phone_no); mySerial.write(0x22); mySerial.write(0x0D); // hex equivalent of Carraige return mySerial.write(0x0A); // hex equivalent of newline delay(2000); mySerial.print("Turn "); mySerial.println(daynum); mySerial.print("Hive1 "); mySerial.print(delta01); mySerial.print(" "); mySerial.println(delta00); mySerial.print("Hive2 "); mySerial.print(delta11); mySerial.print(" "); mySerial.println(delta10); mySerial.print("Hive3 "); mySerial.print(delta21); mySerial.print(" "); mySerial.println(delta20); mySerial.print("Battery capacity is "); mySerial.print(ch1); mySerial.print(ch2); mySerial.print(ch3); mySerial.print(ch4); mySerial.println(" %"); if (forceSend) {mySerial.print("Forced SMS");} mySerial.println (char(26));//the ASCII code of the ctrl+z is 26 delay(3000); } forceSend=false; digitalWrite(13, LOW); attachInterrupt(0, SendStat , RISING); // Interrupt by HIGH level } // ************************************************************************************************* void switchto9600() { mySerial.begin(115200); // Open software serial port delay(16000); // wait for boot mySerial.println("AT"); delay(200); mySerial.println("AT"); delay(200); mySerial.println("AT+IPR=9600"); // Change Serial Speed delay(200); mySerial.begin(9600); mySerial.println("AT&amp;W0"); delay(200); mySerial.println("AT&amp;W"); } void setup() { // Setup part run once, at start pinMode(13, OUTPUT); // Led pin init pinMode(2, INPUT_PULLUP); // Set pullup voltage Serial.begin(9600); // ------------------------------------------------------------------------------- switchto9600(); // switch module port speed // ------------------------------------------------------------------------------- mySerial.begin(9600); delay(200); scale[0] = &amp;scale0; //init scale scale[1] = &amp;scale1; scale[2] = &amp;scale2; scale0.set_scale(); scale1.set_scale(); scale2.set_scale(); delay(200); setZero=digitalRead(2); //if (EEPROM.read(500)==EEPROM.read(501) || setZero) // first boot/reset with hiding photoresistor if (setZero) { raw00=scale0.get_units(16); //read data from scales raw10=scale1.get_units(16); raw20=scale2.get_units(16); EEPROM.put(500, raw00); //write data to eeprom EEPROM.put(504, raw10); EEPROM.put(508, raw20); for (int i = 0; i &lt;= 24; i++) { //blinking LED13 on reset/first boot digitalWrite(13, HIGH); delay(500); digitalWrite(13, LOW); delay(500); } } else { EEPROM.get(500, raw00); // read data from eeprom after battery change EEPROM.get(504, raw10); EEPROM.get(508, raw20); digitalWrite(13, HIGH); // turn on LED 13 on 12sec. delay(12000); digitalWrite(13, LOW); } delay(200); // Test SMS at initial boot readVcc(); delay(200); mySerial.println("AT+CMGF=1"); delay(2000); mySerial.print("AT+CMGS=\""); mySerial.print(phone_no); mySerial.write(0x22); mySerial.write(0x0D); // hex equivalent of Carraige return mySerial.write(0x0A); // hex equivalent of newline delay(2000); mySerial.println("INITIAL BOOT OK"); mySerial.print("Battery capacity is "); mySerial.print(ch1); mySerial.print(ch2); mySerial.print(ch3); mySerial.print(ch4); mySerial.println(" %"); mySerial.println (char(26));//the ASCII code of the ctrl+z is 26 delay(3000); raw02=raw00; raw12=raw10; raw22=raw20; attachInterrupt(0, SendStat , RISING); // Interrupt by HIGH level } void loop() { digitalWrite(13, LOW); ch=mySerial.read(); if ( ch=='R' ) { //wait first lerrer from "RING" string forceSend=true; mySerial.println("ATH"); SendStat(); ch=' '; } }</code> </pre> <br><p>  Di baris pertama, dalam tanda kutip char phone_no [] = "+ 123456789012";  - alih-alih 123456789012 kami memasukkan nomor telepon kami dengan kode negara ke mana SMS akan dikirim. </p><br><p>  Klik tombol centang (di atas nomor satu di tangkapan layar di atas) - jika kompilasi di bawah (di bawah triple di tangkapan layar), maka kita dapat mem-flash mikrokontroler. </p><br><p>  Jadi, USB-TTL terhubung ke ARDUINO dan komputer (seperti pada foto di atas), kami meletakkan baterai yang terisi daya di dalam dudukannya (biasanya pada arduino baru, LED mulai berkedip sekali per detik). </p><br><p>  Sekarang firmware - kami sedang berlatih untuk menekan tombol merah (perak) mikrokontroler - ini perlu dilakukan secara ketat pada saat tertentu !!! </p><br><p>  Apakah disana  Klik tombol "Unggah" (di atas dua di tangkapan layar), dan hati-hati melihat garis di bagian bawah antarmuka (di bawah tiga layar). </p><br><p>  Segera setelah tulisan "kompilasi" diganti dengan "unduh" - tekan tombol merah (reset) - jika semuanya beres - adaptor USB-TTL berkedip dengan gembira, dan tulisan "Diunduh" di bagian bawah antarmuka </p><br><p>  Sementara kami menunggu SMS tes untuk tiba di telepon, saya akan memberi tahu Anda bagaimana program ini bekerja: </p><br><p>  Pertama kali sistem dihidupkan, ia memeriksa byte 500 dan 501 dari EEPROM, jika mereka sama, maka data kalibrasi belum direkam, dan algoritma melanjutkan ke bagian pengaturan. </p><br><p>  Hal yang sama terjadi jika, ketika dihidupkan, photoresistor diarsir (dengan tutup dari pena) - mode reset parameter diaktifkan. </p><br><p>  Pengukur regangan harus sudah dipasang di bawah sarang, karena kami hanya memperbaiki tingkat awal nol dan kemudian mengukur perubahan berat (sekarang nol akan datang, karena kami belum menghubungkan apa pun). </p><br><p>  Pada Arduino, LED bawaan dari pin 13 akan berkedip. <br>  Jika reset tidak terjadi, LED menyala selama 12 detik. <br>  Setelah itu, SMS pengujian dikirim dengan pesan "INITIAL BOOT OK" dan persentase pengisian daya baterai. </p><br><p>  Selanjutnya, kami memiliki interupsi pada fotosensor atau bekerja pada pin kedua (ditambah mengangkat diaktifkan oleh fungsi pullup). <br>  Dalam hal ini, setelah tersandung selama 3 menit, keadaan photoresistor diperiksa untuk mengecualikan positif berulang atau salah. <br>  Untuk mencegah sistem melakukan reset setiap kali dihidupkan, setidaknya modul HX711 pertama harus terhubung (pin DT-D10, SCK-A0) </p><br><p>  Kemudian pembacaan load cell diambil, perubahan berat dari operasi sebelumnya (angka pertama dalam baris setelah Hive) dihitung dan dari awal pertama, tegangan baterai diperiksa dan informasi ini dikirim dalam bentuk SMS: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c63/a89/992/c63a89992a1311d828e3d9380ba45036.jpg" alt="Sistem sampel"></p><br><p>  Omong-omong, apakah Anda menerima SMS?  Selamat!  Kami setengah jalan!  Meskipun baterai dapat dilepas dari dudukannya, kita tidak perlu komputer lebih jauh. </p><br><p>  Kami melanjutkan ke pembuatan sensor, sebagai permulaan, mari kita sentuh tata letak sensor: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/182/43b/cec/18243bcecc904c4018d7b2217cc72d9b.jpg" alt="Lokasi Sensor"></p><br><p>  Ini adalah paket dari hive-top view. </p><br><p>  Secara klasik, 4 sensor dipasang di sudut-sudut (1,2,3,4) </p><br><p>  Kami akan mengukur secara berbeda.  Atau lebih tepatnya, bahkan di yang ketiga.  Seperti yang dilakukan orang-orang dari BroodMinder secara berbeda: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b49/fbe/1f3/b49fbe1f378d3e5b4b7320bf6ac83520.jpg" alt="Induk"></p><br><p>  Dalam desain ini, sensor dipasang pada posisi 1 dan 2, poin 3.4 didasarkan pada balok. <br>  Maka hanya setengah dari berat jatuh pada sensor. <br>  Ya, metode semacam itu kurang akurat, tetapi sulit untuk membayangkan bahwa lebah membangun semua bingkai dengan â€œlidahâ€ dari sarang madu di sepanjang satu dinding sarang. </p><br><p>  Jadi, saya mengusulkan untuk mengurangi sensor ke titik 5 sama sekali - maka tidak perlu melindungi sistem, dan ketika menggunakan sarang cahaya, itu benar-benar perlu dilakukan dengan satu sensor. </p><br><p>  Jadi, pada satu sarang, kita akan menginstal dua sel beban dan satu modul HX711, diagram pengkabelan adalah sebagai berikut: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6d2/39b/bef/6d239bbef099b427b0f6127a323a7e69.jpg"></p><br><p>  Dari papan ADC ke Arduino ada 5 meter dari kabel telepon 4-inti (dalam kasus modul berat 2 dan 3), sensor pertama terhubung dengan "ekor" 10-cm, tetapi lebih pada itu nanti. </p><br><p>  Secara umum, pada sensor kami meninggalkan "ekor" 8 cm, kami membersihkan pasangan bengkok dan kami membuka semua seperti pada foto di atas. </p><br><p>  Sebelum memulai bengkel tukang kayu, letakkan lilin / parafin dalam wadah yang cocok untuk melebur dalam bak air. </p><br><p>  Sekarang kita ambil balok kita dan membaginya menjadi tiga segmen 100 mm </p><br><p>  Selanjutnya, tandai alur longitudinal selebar 25 mm, dalam 7-8 mm, menggunakan gergaji besi dan pahat untuk menghilangkan kelebihannya - profil berbentuk u harus keluar. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/509/226/d98/509226d98d5b52f993b21c9e6679fc1a.jpg" alt="Dasar-dasarnya"></p><br><p>  Faktanya, kita membutuhkan satu bagian 1 dan dua berbentuk H - P-shki, semuanya panjang 10 cm. </p><br><p>  Mengapa N-ka - jangan percaya, sembunyikan Arduino di dalamnya: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/096/e6b/89d/096e6b89d4442e3bf898be19dae38566.jpg" alt="keajaiban teknologi yang bermusuhan"></p><br><p>  Selain itu, soket 6P6C untuk menghubungkan sensor 2 dan 3 juga terpasang di sini. </p><br><p>  Wax menghangat?  - Kami mencelupkan papan ADC kami di sana - ini akan melindungi mereka dari kelembaban / kabut: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a57/672/7f1/a576727f1b4385933b640b0dd1ef2a01.jpg" alt="Perlindungan ADC terhadap kelembaban"></p><br><p>  Kami memiliki semuanya di atas dasar kayu (perlu untuk mengobatinya dengan antiseptik dari pembusukan): </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a57/a6b/347/a57a6b34743c1f8b8add453e729fadea.jpg" alt="Majelis"></p><br><p>  Dan akhirnya, kami memperbaiki sensor dengan sekrup: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/94d/e43/541/94de435418f3d001e47b181935612e5f.jpg" alt="Sensor siap"></p><br><p>  Selanjutnya, kami menyolder semua komponen yang tersisa sesuai dengan skema di header dan akal sehat. </p><br><h4 id="v-plane-raspolozheniya-komponentov-zhelatelno-proyavit-fantaziyu-stoit-uchityvat-odno---rasstoyanie-mezhdu-mikrokontrollerom-i-gsm-modulem-dolzhno-sostavlyat-ne-menee-odnogo-metra">  Dalam hal lokasi komponen, disarankan untuk menunjukkan imajinasi, satu hal yang perlu dipertimbangkan - jarak antara mikrokontroler dan modul GSM harus setidaknya satu meter! </h4><br><p>  Saya mendapat desain berikut: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/828/60b/f5a/82860bf5acb8465591e4fa82f0d284da.jpg" alt="Terakhir"></p><br><p>  Ya, saya mengambil sudut pemasangan panel 45 derajat - karena kesederhanaan pembuatan, tetapi dekat dengan empat puluh derajat optimal untuk musim panas di garis lintang Kiev. </p><br><p>  Itu saja, sekarang untuk pemeriksaan terakhir, letakkan sensor di sektor lingkaran, di atas - sepotong kayu lapis, nol controller (nyalakan sistem dengan tutup di fotodioda dari pulpen). </p><br><p>  Dalam hal ini, LED pada Arduino akan berkedip dan SMS tes akan datang. </p><br><p>  Lalu kami melepas tutup dari fotosel, dan kami mengambil air dalam botol plastik 6 liter. <br>  Kami meletakkan botol di atas kayu lapis dan jika beberapa menit telah berlalu dari menyalakannya, pasang kembali tutup photoresistor (mensimulasikan matahari terbenam). </p><br><p>  Pada saat yang sama, LED pada arduino akan menyala, dan Anda akan menerima SMS dengan nilai berat sekitar 4 kg di semua posisi. </p><br><p>  Selamat!  Sistem berhasil dirakit! </p><br><p>  Jika sekarang kita membuat sistem bekerja kembali, maka pada kolom pertama dari bobot kita mendapatkan nol. </p><br><p>  Ya, dalam kondisi nyata diinginkan untuk mengarahkan fotoresistor secara vertikal ke atas. </p><br><p>  Sekarang saya akan memberikan panduan singkat tentang penggunaan: </p><br><ol><li>  Pasang pengukur regangan di bawah dinding belakang sarang (di bawah balok / papan pengganti ~ tebal 30 mm) </li><li>  Pasang modul komunikasi dengan panel surya pada ketinggian, beberapa meter dari sarang. <br>  Orientasi panel surya - ke selatan - dapat dikompas (kita tidak akan menangkap yang benar). </li><li>  Naungan photoresistor dan masukkan baterai - LED harus berkedip dan SMS tes dengan teks "BOOT AWAL OK" harus datang <br>  Setiap malam, setelah matahari terbenam, SMS akan tiba dengan perubahan berat per hari dan sejak saat peluncuran. <br>  Saat melakukan panggilan ke nomor kartu SIM dari modul GSM, pengontrol tidak terhubung (kami mendengar "Pelanggan tidak dapat menerima panggilan") dan SMS datang dengan pengukuran luar biasa. <br>  Dalam pesan seperti itu akan ada baris tambahan - "SMS Paksa"; </li></ol><br><p>  Hanya ada sedikit yang tersisa untuk keindahan lengkap dari sistem: </p><br><ol><li>  Tambahkan sistem otomatis perangkat pada sensor foto. </li><li>  Periksa jenis modul komunikasi lainnya. </li><li>  Untuk melakukan segala sesuatu di bawah ESP-8266 - pertama, ini mendukung pembaruan firmware "over the air" - itu nyaman. </li></ol><br><p>  Kedua - dapat memberikan statistik dalam bentuk halaman web sederhana. <br>  Dan akhirnya, jika Anda memiliki Wi-Fi, Anda dapat sepenuhnya menolak GSM-ki. </p><br><p>  Oh ya, saya bosan dengan sesuatu yang bermain-main dengan kabel, dan saya berjanji pada sistem dengan penghematan energi "absolut". </p><br><p>  Singkatnya, saya memutuskan untuk bermain sedikit "bodoh" dan melakukan semuanya. <br>  Seberapa sukses - baca publikasi dalam sebulan! </p><br><p>  Sampai jumpa di halaman Habr-a, <br>  Peternak lebah listrik Andrey </p><br><p>  PS Untuk publikasi baru tentang topik ini, lihat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">beefree.xyz</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id448274/">https://habr.com/ru/post/id448274/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id448264/index.html">Lipid cold nothing: mencegah kristalisasi air pada -263 Â° C</a></li>
<li><a href="../id448266/index.html">Ditelepon! Cara merakit Web-dialer Anda dalam satu jam</a></li>
<li><a href="../id448268/index.html">Sistem Telepon Kotak</a></li>
<li><a href="../id448270/index.html">Ubah pengaturan program sambil mempertahankan pengaturan pribadi</a></li>
<li><a href="../id448272/index.html">Mengapa secara khusus menyiram pesawat sebelum keberangkatan, dan apa yang akan terjadi jika ini tidak dilakukan?</a></li>
<li><a href="../id448276/index.html">Bagaimana Alfa Bank hidup dalam periode perubahan dan apa yang kami berhasil lakukan ketika menggabungkan pengembangan TI dan Alfa Lab</a></li>
<li><a href="../id448278/index.html">Hipotek teknis: apa dan kepada siapa tim berutang</a></li>
<li><a href="../id448280/index.html">Test drive nanoCAD SPDS Metalwork 1.2. Bagian 2</a></li>
<li><a href="../id448286/index.html">Berita dari dunia OpenStreetMap No. 455 (04/02/2019 - 04/04/2019)</a></li>
<li><a href="../id448288/index.html">Menggunakan C ++ dan templat dengan sejumlah variabel argumen saat memprogram mikrokontroler</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>