<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🉑 📍 🤘🏼 Bus Blaster - interface bit-bang rapide et universelle pour les patients passionnés 🚗 🥢 👩🏿‍💼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je voulais depuis longtemps avoir une sorte d'interface matérielle simple et universelle avec plusieurs signaux d'entrée et de sortie, dont la fonctio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bus Blaster - interface bit-bang rapide et universelle pour les patients passionnés</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/380531/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/b33/9c7/eb4/b339c7eb476640b9b5b17baa63513427.jpg" width="500"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je voulais depuis longtemps avoir une sorte d'interface matérielle simple et universelle avec plusieurs signaux d'entrée et de sortie, dont la fonctionnalité est déterminée exclusivement par un logiciel, comme le mémorable programmeur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PonyProg</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Et pour qu'il puisse être utilisé non seulement comme firmware de lecture / écriture, mais aussi pour le débogage de programmes via JTAG. </font><font style="vertical-align: inherit;">En même temps, acheter quelque chose d'industriel, avec mes petits soins occasionnels avec l'électronique, est redondant et non rentable - cela nécessitait quelque chose d'une série de "produits semi-finis" basés sur le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bit-bang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce que le bit bang et pourquoi est-il nécessaire</font></font></b><div class="spoiler_text">-  ,     Windows 9x            (COM)   (LPT) .         ,               ,   .      ,             ,     .      bit-bang,    — «», «»  ..<br>
<br>
   2k/XP        /,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>giveio</b></a>.          NT, -        . <br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous le savez, les ordinateurs modernes, en particulier les ordinateurs portables, dotés de ports matériels ne sont pas encombrés, car la plupart des utilisateurs n'en ont pas besoin. Les adaptateurs USB pour connecter des périphériques avec des interfaces RS232 et Centronics (familièrement - COM / LPT) ne fonctionnent bien que dans le cadre de l'objectif principal, et il est problématique de les «secouer» pour un certain nombre de raisons. Premièrement, la plupart de ces adaptateurs ne peuvent traiter que les signaux de données (le même Tx / Rx) avec une bonne vitesse, et ils traitent les signaux de commande avec des retards importants. Deuxièmement, les adaptateurs de différents fabricants sont incompatibles avec le matériel et les possibilités de contrôle non standard via le pilote du fabricant sont très limitées. Troisièmement, presque tous les pilotes utilisent des paquets USB distincts pour envoyer des commandes à l'adaptateur, ce qui limite la fréquence des changements d'état à seulement mille fois par seconde,ce qui pour de nombreuses applications est catastrophiquement petit.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heureusement, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FTDI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> propose depuis longtemps une gamme de solutions USB qui se concentrent spécifiquement sur l'échange à haute vitesse de signaux arbitraires. </font><font style="vertical-align: inherit;">Une étude rapide du problème a montré que les plus populaires à cet égard sont les interfaces des </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">microcircuits </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FT232H</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FT2232H</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solutions simples</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initialement, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FTDI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> implémentait dans ses interfaces USB FT232BM, FT232R et similaires deux modes supplémentaires - bit-bang asynchrone et synchrone. Pour cela, huit lignes de signal supplémentaires ou plus sont ajoutées, chacune pouvant être configurée pour l'entrée ou la sortie. Les données tamponnées transmises à l'interface par l'ordinateur sont définies sur les lignes de sortie par les signaux d'horloge, les données d'entrée sont lues sur les lignes, mises en mémoire tampon et envoyées à l'ordinateur. La liaison des E / S à l'horloge offre une bonne précision des intervalles - l'application n'a plus besoin de prendre soin de les maintenir par programmation.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, au lieu du cycle traditionnel du type «réglez le niveau actif sur la ligne de sortie; </font><font style="vertical-align: inherit;">pause; </font><font style="vertical-align: inherit;">lire l'état de la ligne d'entrée; </font><font style="vertical-align: inherit;">définir le niveau passif sur la ligne de sortie », l'application génère une séquence d'octets, chacun définissant l'état des lignes de sortie pour une période d'horloge. </font><font style="vertical-align: inherit;">La séquence est envoyée à l'interface et de là, la même séquence est lue, reflétant l'état des lignes d'entrée. </font><font style="vertical-align: inherit;">En mode asynchrone, l'entrée et la sortie se produisent indépendamment l'une de l'autre. </font><font style="vertical-align: inherit;">En lecture synchrone des entrées est effectuée immédiatement avant le réglage des signaux aux sorties, ce qui permet un travail plus fiable avec des signaux changeant rapidement.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contrôleur MPSSE</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le contrôleur série synchrone </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">multiprotocole</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">MPSSE</font></a><font style="vertical-align: inherit;"> ) a été </font><font style="vertical-align: inherit;">ajouté à la version H des microcircuits FTDI </font><font style="vertical-align: inherit;">, qui implémente divers modes d'échange d'horloge et de données dans le matériel. La formation des signaux du protocole souhaité est effectuée en transmettant au contrôleur une série de ses commandes internes qui spécifient les méthodes de synchronisation, la synchronisation des signaux de réglage / lecture (à l'avant ou au bas de l'impulsion d'horloge), l'ordre de transmission des bits (LSB / MSB). Le contrôleur renvoie une séquence de «clichés» des lignes d'entrée. Le taux de transfert de données peut atteindre 30 Mbps. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grâce au MPSSE, les protocoles </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JTAG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I2C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font><b><font style="vertical-align: inherit;">SPI</font></b><font style="vertical-align: inherit;"> sont le plus naturellement implémentés.</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, presque toute «secousse» peut être facilement implémentée dans les capacités matérielles du contrôleur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FTDI offre une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> complète </font><font style="vertical-align: inherit;">sur la connexion et la programmation de ses interfaces, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bibliothèques et exemples de programmes pour travailler via les pilotes MPSSE pour Windows, Linux et MacOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D2XX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour une interaction directe avec l'interface. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les interfaces FTDI sont prises en charge par les programmes populaires </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenOCD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UrJTAG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flashrom</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avrdude</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HappyJTAG2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zJTAG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problèmes de connectivité</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir découvert tout ce qui précède en détail l'année dernière, j'ai été inspiré, mais j'ai immédiatement constaté que le FT232H / FT2232H, avec toute sa polyvalence, ne pouvait pas toujours être connecté directement au dispositif final. Premièrement, les lignes externes des microcircuits sont conçues pour le niveau de 3,3 V, et dans de nombreux appareils modernes, les niveaux de 2,5 / 1,8 / 1,5 V. sont utilisés. réglage des lignes en sélectionnant le mode «entrée» ou «sortie». Autrement dit, pour connecter une puce avec MPSSE au périphérique cible, un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">circuit tampon est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> nécessaire </font><font style="vertical-align: inherit;">qui correspond aux niveaux de signal et fournit un arrêt opérationnel de certaines lignes de sortie (par exemple, avec un niveau de signal </font><b><font style="vertical-align: inherit;">TMS</font></b><font style="vertical-align: inherit;"> passif</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Googler sur les options pour les circuits tampons, j'ai trouvé qu'un nombre incroyable d'adaptateurs ont été fabriqués dans le monde, ne différant que par ce tampon. </font><font style="vertical-align: inherit;">Certains programmes (mais pas tous) permettent l'utilisation de différents types de tampons. </font><font style="vertical-align: inherit;">Ainsi, en choisissant un modèle d'adaptateur spécifique, vous limitez en même temps la gamme de programmes qui fonctionneront avec lui. </font><font style="vertical-align: inherit;">Et pour décider à l'avance du type, il fallait à nouveau réfléchir sur Google et lire les discussions sur les forums, ce que je ne voulais pas faire du tout. </font><font style="vertical-align: inherit;">Certains adaptateurs permettaient de définir la configuration du tampon avec des cavaliers, mais cela est semé d'erreurs et ils ne sont pas bon marché.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bus Blaster - revendiquer la polyvalence</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'idée masculine de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dangerous Prototypes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> était originale à deux reprises: la première - en tant que tampon connecté à la puce FT2232H </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PLD (CPLD) </font></font></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xilinx XC2C32A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui peut être reprogrammée rapidement dans n'importe quelle configuration, et la seconde - à son utilisation, la reprogrammation du deuxième canal FT2232H. En plus d'implémenter la logique du tampon, le FPGA effectue une correspondance de niveau - ses lignes externes fonctionnent dans la plage de 1,5 à 3,3 V. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par conséquent, la carte </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Bus Blaster</font></a><font style="vertical-align: inherit;"> s'est avérée</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Depuis l'avènement du projet, quatre versions de la carte ont été remplacées. La version 3 est considérée comme la plus stable et la plus répandue. La version 4 contient un grand FPGA qui n'est pas entièrement développé et est utilisé beaucoup moins fréquemment. Les prochaines versions, apparemment, ne le seront plus, puisque le développement du projet a été arrêté il y a quelques années. J'ai eu l'impression que peu de gens ont vraiment essayé la carte - avec son potentiel élevé, elle n'est pas trop facile à utiliser. Une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">section du forum a été</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> créée pour le conseil d'administration </font><font style="vertical-align: inherit;">, mais depuis l'année dernière, presque rien n'y a été écrit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après réflexion, j'ai commandé sur la </font><font style="vertical-align: inherit;">version </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AliExpress </font></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3c</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la plus développée, pour 34 $. Ensuite, ils y ont été vendus par un magasin du fabricant - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seeed</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et maintenant seuls les concessionnaires à partir de 52 $ le vendent.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Directement chez Seeed</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (avec l'expédition), il en coûtera quelque part en 37 $.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Premières impressions</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La planche est exactement la même que sur la photo - belle, soignée, faite de haute qualité. Lors du forum, quelqu'un s'est plaint du manque de sortie du microcircuit, j'ai donc soigneusement examiné mon sous une loupe - je n'ai trouvé aucun défaut. </font><font style="vertical-align: inherit;">J'avais déjà installé les </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pilotes D2XX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plus tôt, donc la carte a été reconnue lors de vos déplacements. La première étape a été de traiter la logique de la mémoire tampon de programmation dans les FPGA. Cela se fait à l'aide du programme </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UrJTAG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais spécialement ajusté pour Bus Blaster pour un accès approprié au deuxième canal FT2232H. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez d'abord télécharger et installer la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">version de base d'UrJTAG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ensuite, vous devez ajouter un fichier EXE modifié et une description du FPGA (BSDL) de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce package</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pour programmer le FPGA intégré, vous devez exécuter un EXE modifié, pour travailler avec des périphériques externes - le principal. La procédure de programmation FPGA est décrite </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pour plus de commodité, vous pouvez créer des scripts pour UrJTAG pour chaque version du tampon et des fichiers CMD avec des lignes de commande pour les exécuter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une collection de micrologiciels FPGA décrivant les tampons compatibles avec les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adaptateurs JTAGkey</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KT-Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PicoTap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est disponible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais pour BBv3, il n'y a qu'un seul fichier pour JTAGkey avec prise en charge de l'autotest (BBV3-JTAGkey-selftest-v1.1.svf). La plupart est suffisant, mais cela n'a pas fonctionné pour moi avec </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flashrom</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui sera discuté ci-dessous.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après avoir écrit ce firmware dans le FPGA, j'ai mis des cavaliers dans le connecteur pour l'auto-test, comme décrit dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , fermé la ligne P28 (IO09) au sol - la LED sur la carte s'est allumée. </font><font style="vertical-align: inherit;">J'ai téléchargé et lancé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le programme de test</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - il a montré que tout était en ordre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est étrange, en passant, que le programme d'auto-test s'appelle "BusPiratev2Test", car </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bus Pirate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un projet complètement différent, non compatible avec </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, je pensais généralement que ce firmware était destiné </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniquement</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> à l'auto-test, et pour les applications «militaires», un autre type était nécessaire, car la description dit quelque chose d'inaudible. </font><font style="vertical-align: inherit;">Ensuite, j'ai découvert que le firmware est universel, seul le mode de test est activé en court-circuitant </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P28</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au sol.</font></font><br>
<br>
<h4>  </h4><br>
 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> ( , ,  404) <b>flashrom</b> v0.9.6.1-r1704/Win32,    -     <b>MX25L8005</b> (SPI),   ,     "<b>-p ft2232_spi:type=busblaster</b>".  flashrom ,    FT2232.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">libusb</a> —   ,    Linux,     Windows. <br>
<br>
 libusb   ,   ,    .       -  SPI- —   .   — <b>TMS</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remue, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><b><font style="vertical-align: inherit;">activé</font></b><font style="vertical-align: inherit;"> et </font><font style="vertical-align: inherit;">silence </font><font style="vertical-align: inherit;">sur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En général, pas une seule poussée. J'ai connecté les canaux de l'oscilloscope simultanément à </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - les signaux changent de manière synchrone, clairement. Il n'y avait encore aucune idée de ce qui pouvait être vérifié. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abandonner temporairement les expériences avec flashrom, connecté à l'interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ATTiny13</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Téléchargement </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quelques versions différentes </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avrdude</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , avec la version </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.11-Patch7610 / Win32</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le type de programmation </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2232HIO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enfin obtenu une identification claire, la lecture et l'écriture du contrôleur. Après s'être réjoui, il a reconnecté les puces SPI, mais flashrom a obstinément refusé de les reconnaître. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soupçonnant que les deux microcircuits sont morts, il a retiré </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USBASP</font></font></b></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui a été </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">échangé</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;">AsProg</font></b></a><font style="vertical-align: inherit;"> - il les a </font><font style="vertical-align: inherit;">lus </font><font style="vertical-align: inherit;">sans problème (quoique </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">très</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lentement). Soit dit en passant, j'ai acheté trois USBASP en général pour le rôle de cartes de prototypage pratiques sur ATMega8, mais l'appareil s'est avéré être multifonctionnel de manière inattendue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai à nouveau connecté les microcircuits à BB et j'ai commencé à essayer le flashrom dans différents modes (Bus Blaster et JTAGKey), avec différentes valeurs de diviseur ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-p ft2232_spi: type = busblaster, divisor = n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Soudain, dans l'une des combinaisons, le microcircuit a été reconnu, mais a déjà refusé de lire. </font><font style="vertical-align: inherit;">Après quelques tentatives supplémentaires, l'identification a également disparu. </font><font style="vertical-align: inherit;">Ensuite, plusieurs fois, il a été possible d'obtenir plusieurs identifications réussies d'affilée, mais la lecture n'a jamais été réalisée. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Publié dans le forum, mais n'a reçu rien de sensé en réponse. </font><font style="vertical-align: inherit;">Après avoir fouillé dans la recherche, j'ai trouvé les plaintes de plusieurs personnes concernant le firmware FPGA universel (avec auto-test), j'ai trouvé trois autres versions de firmware là-bas, les ai essayées dans différentes combinaisons avec d'autres paramètres, mais je n'ai pas réussi. </font><font style="vertical-align: inherit;">Après avoir épuisé toutes les options, il a abandonné les expériences jusqu'à l'arrivée de l'analyseur logique commandé un peu plus tard BB.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test avec un analyseur</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ayant reçu un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clone du</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> populaire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analyseur logique Saleae Logic 16</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il l'a connecté aux quatre lignes </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le programme, disponible gratuitement sur le site Web de Saleae</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , peut déchiffrer I2C, SPI et plusieurs autres, il a donc immédiatement montré le déchiffrement de tous les paquets - envoyés et reçus. Il est immédiatement devenu clair que les paquets «flottent» - la même séquence de bits est regroupée par le programme en paquets à différentes frontières, encore et encore. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En comparant les diagrammes de signaux sur les fiches techniques des microcircuits avec ceux enregistrés, j'ai remarqué à un moment donné que le signal </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (connecté à la broche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) au début de chaque session d'échange, il passe à un niveau bas (niveau actif), dans lequel il reste, bien que selon le protocole il devrait revenir à un niveau haut (passif) à la fin de chaque opération. J'ai changé le firmware «officiel» du FPGA en l'un des alternatives - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS a</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> commencé à bouger plus activement, les bordures des paquets alignés dessus, et après avoir sélectionné le diviseur de fréquence d'horloge dans la ligne de commande flashrom (arrêté à 8), le microcircuit a finalement commencé à répondre clairement à chaque requête, lu et écrasé . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Surpris de ne pas avoir immédiatement prêté attention au comportement de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , je me suis rendu compte que j'étais confus du travail réussi avec </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AVR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur le même firmware FPGA. En regardant la fiche technique ATTiny13, j'ai trouvé que le signal </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RESET</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que </font><b><font style="vertical-align: inherit;">TMS</font></b><font style="vertical-align: inherit;"> démarre</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut être faible pendant tout le temps d'échange, sa montée pour la synchronisation n'est pas nécessaire. </font><font style="vertical-align: inherit;">Et les puces SPI ont besoin de son ascension pour la synchronisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
À la suite de tests, j'ai rassemblé des informations sur trois micrologiciels FPGA bien connus dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un message sur le forum</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limite de réécriture FPGA</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'une des discussions, je suis tombé sur un avertissement que le nombre garanti de cycles de réécriture du firmware de ce FPGA n'est que d'environ mille. </font><font style="vertical-align: inherit;">Au début, j'étais bouleversé, car pendant les expériences, j'ai réussi à changer une centaine de fois le firmware, et j'imaginais déjà la mort imminente de la puce. </font><font style="vertical-align: inherit;">Cela ne coûte rien, mais je ne veux pas jouer avec la soudure. </font><font style="vertical-align: inherit;">Il a ensuite réalisé qu'avec une approche adéquate, les neuf cents cycles restants seraient suffisants pour encore de nombreuses années.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clignotement en circuit de la ROM dans le routeur</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Après un certain temps, j'ai formé un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mini-routeur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fraîchement cuit </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">sur le RT5350F</font></a><font style="vertical-align: inherit;"> sous le nom de code "ZLMNet H-G5 / P8201" (désignations tirées de l'interface Web). Vers la même époque, le clip pour SOIC8 / SOP8 est arrivé aussi - j'ai décidé d'essayer de travailler en circuit avec la ROM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au début, le flashrom ne voyait pas du tout l'EPROM via BB. L'oscilloscope a montré que le processeur a </font><font style="vertical-align: inherit;">invariablement vaincu la </font><font style="vertical-align: inherit;">lutte entre le FPGA et le processeur du routeur pour les niveaux de signal de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CLK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ce qui n'est pas surprenant - dans BB entre les bornes FPGA et le connecteur, il y a des résistances de limitation de courant qui sauvent les clés FPGA à faible courant de l'épuisement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai connecté USBASP avec AsProg - celui-ci lit / écrit normalement, mais encore une fois lentement (9 minutes pour lire, 25 minutes pour le cycle d'effacement-écriture-vérification). Pour une seule revitalisation d'une brique, c'est toujours acceptable, mais pour des expériences avec un firmware instable ce n'est plus là. De plus, AsProg ne sait pas travailler avec des pages individuelles - seulement avec le microcircuit entier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai soudé entre les sorties </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS / TCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans BB et les entrées </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS / CLK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de l' </font><font style="vertical-align: inherit;">EPROM pour l'émetteur suiveur - les signaux immédiatement réduits à presque les niveaux corrects, la puce flashrom a reconnu, a commencé à lire / écrire en toute confiance. Avec un diviseur de 8, une lecture complète prend moins d'une minute, la réécriture prend environ deux minutes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'est avéré que la communication du programmeur avec l'EPROM n'interfère pas du tout avec le processeur - le routeur fonctionne parfaitement. </font><font style="vertical-align: inherit;">De toute évidence, les lignes CS / CLK sont allouées uniquement à l'EPROM, qui est lue une fois au démarrage, après quoi le processeur n'y accède pas si vous ne commencez pas à la flasher avec des moyens réguliers.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inconvénients des programmes BB</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les programmes testés (zJTAG, flashrom, avrdude, UrJtag, OpenOCD) qui peuvent fonctionner avec MPSSE ont fait une très triste impression. Premièrement, dans la plupart de ces programmes, avec toute la variété d'adaptateurs FTDI, il n'y a aucune indication explicite de VID / PID - les identificateurs d'adaptateurs connus sont codés en dur dans le code. Mais pour JTAGkey, qui émule BB, PID est défini sur CFF8 et pour FT2232H «propre», il est défini sur 6010. Bien sûr, vous pouvez modifier les identificateurs dans BB à l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aide de FT_Prog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou patcher la table dans le programme, mais les deux options sont également tordues. Eh bien, j'ai réussi à trouver une version de flashrom avec le support BB compilé pour Windows (sinon je devrais installer CygWin), et avrdude fonctionne très bien lors de la spécification du type de programmeur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2232HIO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deuxièmement, certains programmes fonctionnent avec l'adaptateur uniquement via </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la bibliothèque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libusb</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui, à son tour, fonctionne via son propre pilote, ce qui est incompatible avec les pilotes FTDI. </font><font style="vertical-align: inherit;">C'est bien que dans Windows, pour basculer entre les pilotes, vous n'avez pas besoin de supprimer complètement l'un et d'installer l'autre - il vous suffit de le «mettre à jour» en choisissant de force le bon pilote pour le périphérique donné (canal A ou B).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">résultats</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, rappelant la quantité cumulée de temps et de nerfs consacrés à toutes les expériences décrites, je comprends que le prix de l'élégance extérieure et l'universalité apparente de la solution se sont avérés prohibitifs. Je passe ce temps en plus sur le travail principal - je gagnerais de sérieux programmeurs industriels et débogueurs. Mais le plus indubitable est que de tels exercices vous permettent au moins d'une manière ou d'une autre de s'abstenir de la diapositive finale dans la consommation nette de modules personnalisés prêts à l'emploi, que les Chinois proposent en abondance. En ce sens, il est possible d'envier les ingénieurs anciens et médiévaux - pendant des décennies, ils pourraient résoudre avec enthousiasme des problèmes résolus il y a longtemps sur quelques milliers de kilomètres dans le quartier, tout simplement sans le savoir.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devrions essayer OpenOCD et JTAG sur certains des routeurs disponibles, mais tout le monde n'y met pas la main. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dangerous Prototypes a également un ancien projet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bus Pirate</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il y a une carte PIC et une interface simple FT232BL en mode série traditionnel. </font><font style="vertical-align: inherit;">Pour communiquer avec le contrôleur, un terminal standard et des commandes de texte sont utilisés, les réponses sont également affichées sous forme de texte. </font><font style="vertical-align: inherit;">avrdude, flashrom et un certain nombre d'autres programmes peuvent également fonctionner via BP, cependant, pour des raisons évidentes, la vitesse est plusieurs fois inférieure. </font><font style="vertical-align: inherit;">La faible vitesse est compensée par l'étendue de l'application - il existe de nombreuses options pour utiliser BP pour émuler divers protocoles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pensant que dans cette vie, vous devez tout essayer, j'ai commandé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BP v3.6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec câble. </font><font style="vertical-align: inherit;">Oui, oui, je me souviens des souris sur le cactus et de "demain j'y retournerai".</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr380531/">https://habr.com/ru/post/fr380531/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr380521/index.html">Navigateur pour personnes à mobilité réduite (avec source)</a></li>
<li><a href="../fr380523/index.html">Vingt fausses stations de base cellulaires trouvées à Londres</a></li>
<li><a href="../fr380525/index.html">Le commodore Amiga gère le système climatique de l'école publique du Michigan depuis 30 ans</a></li>
<li><a href="../fr380527/index.html">Conférence de footballeur de mathématiques au personnel de la NSA</a></li>
<li><a href="../fr380529/index.html">Мобильный браузер Safari научился блокировать рекламу</a></li>
<li><a href="../fr380533/index.html">Epson invite tout le monde à un pique-nique pour les geeks</a></li>
<li><a href="../fr380535/index.html">L'atterrissage en douceur de la capsule de l'Union ressemble plus à une explosion, mais ce n'est pas un problème</a></li>
<li><a href="../fr380537/index.html">Unreal Engine 4.8 est sorti</a></li>
<li><a href="../fr380541/index.html">Vendredi "Colis": cas inhabituels et curiosités dans la livraison</a></li>
<li><a href="../fr380543/index.html">Carte à puce. Partie 4. JavaCard</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>