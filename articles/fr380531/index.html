<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üâë üìç ü§òüèº Bus Blaster - interface bit-bang rapide et universelle pour les patients passionn√©s üöó ü•¢ üë©üèø‚Äçüíº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Je voulais depuis longtemps avoir une sorte d'interface mat√©rielle simple et universelle avec plusieurs signaux d'entr√©e et de sortie, dont la fonctio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bus Blaster - interface bit-bang rapide et universelle pour les patients passionn√©s</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/380531/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><img src="https://habrastorage.org/files/b33/9c7/eb4/b339c7eb476640b9b5b17baa63513427.jpg" width="500"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Je voulais depuis longtemps avoir une sorte d'interface mat√©rielle simple et universelle avec plusieurs signaux d'entr√©e et de sortie, dont la fonctionnalit√© est d√©termin√©e exclusivement par un logiciel, comme le m√©morable programmeur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PonyProg</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Et pour qu'il puisse √™tre utilis√© non seulement comme firmware de lecture / √©criture, mais aussi pour le d√©bogage de programmes via JTAG. </font><font style="vertical-align: inherit;">En m√™me temps, acheter quelque chose d'industriel, avec mes petits soins occasionnels avec l'√©lectronique, est redondant et non rentable - cela n√©cessitait quelque chose d'une s√©rie de "produits semi-finis" bas√©s sur le </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bit-bang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Qu'est-ce que le bit bang et pourquoi est-il n√©cessaire</font></font></b><div class="spoiler_text">-  ,     Windows 9x            (COM)   (LPT) .         ,               ,   .      ,             ,     .      bit-bang,    ‚Äî ¬´¬ª, ¬´¬ª  ..<br>
<br>
   2k/XP        /,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b>giveio</b></a>.          NT, -        . <br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Comme vous le savez, les ordinateurs modernes, en particulier les ordinateurs portables, dot√©s de ports mat√©riels ne sont pas encombr√©s, car la plupart des utilisateurs n'en ont pas besoin. Les adaptateurs USB pour connecter des p√©riph√©riques avec des interfaces RS232 et Centronics (famili√®rement - COM / LPT) ne fonctionnent bien que dans le cadre de l'objectif principal, et il est probl√©matique de les ¬´secouer¬ª pour un certain nombre de raisons. Premi√®rement, la plupart de ces adaptateurs ne peuvent traiter que les signaux de donn√©es (le m√™me Tx / Rx) avec une bonne vitesse, et ils traitent les signaux de commande avec des retards importants. Deuxi√®mement, les adaptateurs de diff√©rents fabricants sont incompatibles avec le mat√©riel et les possibilit√©s de contr√¥le non standard via le pilote du fabricant sont tr√®s limit√©es. Troisi√®mement, presque tous les pilotes utilisent des paquets USB distincts pour envoyer des commandes √† l'adaptateur, ce qui limite la fr√©quence des changements d'√©tat √† seulement mille fois par seconde,ce qui pour de nombreuses applications est catastrophiquement petit.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Heureusement, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FTDI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> propose depuis longtemps une gamme de solutions USB qui se concentrent sp√©cifiquement sur l'√©change √† haute vitesse de signaux arbitraires. </font><font style="vertical-align: inherit;">Une √©tude rapide du probl√®me a montr√© que les plus populaires √† cet √©gard sont les interfaces des </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">microcircuits </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FT232H</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FT2232H</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Solutions simples</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Initialement, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FTDI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> impl√©mentait dans ses interfaces USB FT232BM, FT232R et similaires deux modes suppl√©mentaires - bit-bang asynchrone et synchrone. Pour cela, huit lignes de signal suppl√©mentaires ou plus sont ajout√©es, chacune pouvant √™tre configur√©e pour l'entr√©e ou la sortie. Les donn√©es tamponn√©es transmises √† l'interface par l'ordinateur sont d√©finies sur les lignes de sortie par les signaux d'horloge, les donn√©es d'entr√©e sont lues sur les lignes, mises en m√©moire tampon et envoy√©es √† l'ordinateur. La liaison des E / S √† l'horloge offre une bonne pr√©cision des intervalles - l'application n'a plus besoin de prendre soin de les maintenir par programmation.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ainsi, au lieu du cycle traditionnel du type ¬´r√©glez le niveau actif sur la ligne de sortie; </font><font style="vertical-align: inherit;">pause; </font><font style="vertical-align: inherit;">lire l'√©tat de la ligne d'entr√©e; </font><font style="vertical-align: inherit;">d√©finir le niveau passif sur la ligne de sortie ¬ª, l'application g√©n√®re une s√©quence d'octets, chacun d√©finissant l'√©tat des lignes de sortie pour une p√©riode d'horloge. </font><font style="vertical-align: inherit;">La s√©quence est envoy√©e √† l'interface et de l√†, la m√™me s√©quence est lue, refl√©tant l'√©tat des lignes d'entr√©e. </font><font style="vertical-align: inherit;">En mode asynchrone, l'entr√©e et la sortie se produisent ind√©pendamment l'une de l'autre. </font><font style="vertical-align: inherit;">En lecture synchrone des entr√©es est effectu√©e imm√©diatement avant le r√©glage des signaux aux sorties, ce qui permet un travail plus fiable avec des signaux changeant rapidement.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Contr√¥leur MPSSE</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Le contr√¥leur s√©rie synchrone </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">multiprotocole</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">MPSSE</font></a><font style="vertical-align: inherit;"> ) a √©t√© </font><font style="vertical-align: inherit;">ajout√© √† la version H des microcircuits FTDI </font><font style="vertical-align: inherit;">, qui impl√©mente divers modes d'√©change d'horloge et de donn√©es dans le mat√©riel. La formation des signaux du protocole souhait√© est effectu√©e en transmettant au contr√¥leur une s√©rie de ses commandes internes qui sp√©cifient les m√©thodes de synchronisation, la synchronisation des signaux de r√©glage / lecture (√† l'avant ou au bas de l'impulsion d'horloge), l'ordre de transmission des bits (LSB / MSB). Le contr√¥leur renvoie une s√©quence de ¬´clich√©s¬ª des lignes d'entr√©e. Le taux de transfert de donn√©es peut atteindre 30 Mbps. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Gr√¢ce au MPSSE, les protocoles </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JTAG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I2C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font><b><font style="vertical-align: inherit;">SPI</font></b><font style="vertical-align: inherit;"> sont le plus naturellement impl√©ment√©s.</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cependant, presque toute ¬´secousse¬ª peut √™tre facilement impl√©ment√©e dans les capacit√©s mat√©rielles du contr√¥leur. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FTDI offre une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> compl√®te </font><font style="vertical-align: inherit;">sur la connexion et la programmation de ses interfaces, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">biblioth√®ques et exemples de programmes pour travailler via les pilotes MPSSE pour Windows, Linux et MacOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">D2XX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour une interaction directe avec l'interface. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les interfaces FTDI sont prises en charge par les programmes populaires </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenOCD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UrJTAG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flashrom</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avrdude</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HappyJTAG2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zJTAG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Probl√®mes de connectivit√©</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir d√©couvert tout ce qui pr√©c√®de en d√©tail l'ann√©e derni√®re, j'ai √©t√© inspir√©, mais j'ai imm√©diatement constat√© que le FT232H / FT2232H, avec toute sa polyvalence, ne pouvait pas toujours √™tre connect√© directement au dispositif final. Premi√®rement, les lignes externes des microcircuits sont con√ßues pour le niveau de 3,3 V, et dans de nombreux appareils modernes, les niveaux de 2,5 / 1,8 / 1,5 V. sont utilis√©s. r√©glage des lignes en s√©lectionnant le mode ¬´entr√©e¬ª ou ¬´sortie¬ª. Autrement dit, pour connecter une puce avec MPSSE au p√©riph√©rique cible, un </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">circuit tampon est</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> n√©cessaire </font><font style="vertical-align: inherit;">qui correspond aux niveaux de signal et fournit un arr√™t op√©rationnel de certaines lignes de sortie (par exemple, avec un niveau de signal </font><b><font style="vertical-align: inherit;">TMS</font></b><font style="vertical-align: inherit;"> passif</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Googler sur les options pour les circuits tampons, j'ai trouv√© qu'un nombre incroyable d'adaptateurs ont √©t√© fabriqu√©s dans le monde, ne diff√©rant que par ce tampon. </font><font style="vertical-align: inherit;">Certains programmes (mais pas tous) permettent l'utilisation de diff√©rents types de tampons. </font><font style="vertical-align: inherit;">Ainsi, en choisissant un mod√®le d'adaptateur sp√©cifique, vous limitez en m√™me temps la gamme de programmes qui fonctionneront avec lui. </font><font style="vertical-align: inherit;">Et pour d√©cider √† l'avance du type, il fallait √† nouveau r√©fl√©chir sur Google et lire les discussions sur les forums, ce que je ne voulais pas faire du tout. </font><font style="vertical-align: inherit;">Certains adaptateurs permettaient de d√©finir la configuration du tampon avec des cavaliers, mais cela est sem√© d'erreurs et ils ne sont pas bon march√©.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bus Blaster - revendiquer la polyvalence</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
L'id√©e masculine de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Dangerous Prototypes</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √©tait originale √† deux reprises: la premi√®re - en tant que tampon connect√© √† la puce FT2232H </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PLD (CPLD) </font></font></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xilinx XC2C32A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui peut √™tre reprogramm√©e rapidement dans n'importe quelle configuration, et la seconde - √† son utilisation, la reprogrammation du deuxi√®me canal FT2232H. En plus d'impl√©menter la logique du tampon, le FPGA effectue une correspondance de niveau - ses lignes externes fonctionnent dans la plage de 1,5 √† 3,3 V. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Par cons√©quent, la carte </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">Bus Blaster</font></a><font style="vertical-align: inherit;"> s'est av√©r√©e</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Depuis l'av√®nement du projet, quatre versions de la carte ont √©t√© remplac√©es. La version 3 est consid√©r√©e comme la plus stable et la plus r√©pandue. La version 4 contient un grand FPGA qui n'est pas enti√®rement d√©velopp√© et est utilis√© beaucoup moins fr√©quemment. Les prochaines versions, apparemment, ne le seront plus, puisque le d√©veloppement du projet a √©t√© arr√™t√© il y a quelques ann√©es. J'ai eu l'impression que peu de gens ont vraiment essay√© la carte - avec son potentiel √©lev√©, elle n'est pas trop facile √† utiliser. Une </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">section du forum a √©t√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cr√©√©e pour le conseil d'administration </font><font style="vertical-align: inherit;">, mais depuis l'ann√©e derni√®re, presque rien n'y a √©t√© √©crit. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s r√©flexion, j'ai command√© sur la </font><font style="vertical-align: inherit;">version </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AliExpress </font></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3c</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , la plus d√©velopp√©e, pour 34 $. Ensuite, ils y ont √©t√© vendus par un magasin du fabricant - </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seeed</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , et maintenant seuls les concessionnaires √† partir de 52 $ le vendent.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Directement chez Seeed</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (avec l'exp√©dition), il en co√ªtera quelque part en 37 $.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Premi√®res impressions</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La planche est exactement la m√™me que sur la photo - belle, soign√©e, faite de haute qualit√©. Lors du forum, quelqu'un s'est plaint du manque de sortie du microcircuit, j'ai donc soigneusement examin√© mon sous une loupe - je n'ai trouv√© aucun d√©faut. </font><font style="vertical-align: inherit;">J'avais d√©j√† install√© les </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pilotes D2XX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> plus t√¥t, donc la carte a √©t√© reconnue lors de vos d√©placements. La premi√®re √©tape a √©t√© de traiter la logique de la m√©moire tampon de programmation dans les FPGA. Cela se fait √† l'aide du programme </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UrJTAG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais sp√©cialement ajust√© pour Bus Blaster pour un acc√®s appropri√© au deuxi√®me canal FT2232H. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vous devez d'abord t√©l√©charger et installer la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">version de base d'UrJTAG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ensuite, vous devez ajouter un fichier EXE modifi√© et une description du FPGA (BSDL) de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ce package</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Pour programmer le FPGA int√©gr√©, vous devez ex√©cuter un EXE modifi√©, pour travailler avec des p√©riph√©riques externes - le principal. La proc√©dure de programmation FPGA est d√©crite </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Pour plus de commodit√©, vous pouvez cr√©er des scripts pour UrJTAG pour chaque version du tampon et des fichiers CMD avec des lignes de commande pour les ex√©cuter. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Une collection de micrologiciels FPGA d√©crivant les tampons compatibles avec les </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adaptateurs JTAGkey</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KT-Link</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PicoTap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est disponible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , mais pour BBv3, il n'y a qu'un seul fichier pour JTAGkey avec prise en charge de l'autotest (BBV3-JTAGkey-selftest-v1.1.svf). La plupart est suffisant, mais cela n'a pas fonctionn√© pour moi avec </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flashrom</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui sera discut√© ci-dessous.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s avoir √©crit ce firmware dans le FPGA, j'ai mis des cavaliers dans le connecteur pour l'auto-test, comme d√©crit dans la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentation</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ferm√© la ligne P28 (IO09) au sol - la LED sur la carte s'est allum√©e. </font><font style="vertical-align: inherit;">J'ai t√©l√©charg√© et lanc√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le programme de test</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - il a montr√© que tout √©tait en ordre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il est √©trange, en passant, que le programme d'auto-test s'appelle "BusPiratev2Test", car </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bus Pirate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est un projet compl√®tement diff√©rent, non compatible avec </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au d√©but, je pensais g√©n√©ralement que ce firmware √©tait destin√© </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">uniquement</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> √† l'auto-test, et pour les applications ¬´militaires¬ª, un autre type √©tait n√©cessaire, car la description dit quelque chose d'inaudible. </font><font style="vertical-align: inherit;">Ensuite, j'ai d√©couvert que le firmware est universel, seul le mode de test est activ√© en court-circuitant </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P28</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> au sol.</font></font><br>
<br>
<h4>  </h4><br>
 <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> ( , ,  404) <b>flashrom</b> v0.9.6.1-r1704/Win32,    -     <b>MX25L8005</b> (SPI),   ,     "<b>-p ft2232_spi:type=busblaster</b>".  flashrom ,    FT2232.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a> ,      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">libusb</a> ‚Äî   ,    Linux,     Windows. <br>
<br>
 libusb   ,   ,    .       -  SPI- ‚Äî   .   ‚Äî <b>TMS</b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">remue, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> est </font><b><font style="vertical-align: inherit;">activ√©</font></b><font style="vertical-align: inherit;"> et </font><font style="vertical-align: inherit;">silence </font><font style="vertical-align: inherit;">sur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En g√©n√©ral, pas une seule pouss√©e. J'ai connect√© les canaux de l'oscilloscope simultan√©ment √† </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - les signaux changent de mani√®re synchrone, clairement. Il n'y avait encore aucune id√©e de ce qui pouvait √™tre v√©rifi√©. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Abandonner temporairement les exp√©riences avec flashrom, connect√© √† l'interface </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ATTiny13</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . T√©l√©chargement </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ici de</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> quelques versions diff√©rentes </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avrdude</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , avec la version </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.11-Patch7610 / Win32</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et le type de programmation </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2232HIO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">enfin obtenu une identification claire, la lecture et l'√©criture du contr√¥leur. Apr√®s s'√™tre r√©joui, il a reconnect√© les puces SPI, mais flashrom a obstin√©ment refus√© de les reconna√Ætre. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Soup√ßonnant que les deux microcircuits sont morts, il a retir√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USBASP</font></font></b></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui a √©t√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">√©chang√©</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> pour </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;">AsProg</font></b></a><font style="vertical-align: inherit;"> - il les a </font><font style="vertical-align: inherit;">lus </font><font style="vertical-align: inherit;">sans probl√®me (quoique </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tr√®s</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lentement). Soit dit en passant, j'ai achet√© trois USBASP en g√©n√©ral pour le r√¥le de cartes de prototypage pratiques sur ATMega8, mais l'appareil s'est av√©r√© √™tre multifonctionnel de mani√®re inattendue. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai √† nouveau connect√© les microcircuits √† BB et j'ai commenc√© √† essayer le flashrom dans diff√©rents modes (Bus Blaster et JTAGKey), avec diff√©rentes valeurs de diviseur ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-p ft2232_spi: type = busblaster, divisor = n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">Soudain, dans l'une des combinaisons, le microcircuit a √©t√© reconnu, mais a d√©j√† refus√© de lire. </font><font style="vertical-align: inherit;">Apr√®s quelques tentatives suppl√©mentaires, l'identification a √©galement disparu. </font><font style="vertical-align: inherit;">Ensuite, plusieurs fois, il a √©t√© possible d'obtenir plusieurs identifications r√©ussies d'affil√©e, mais la lecture n'a jamais √©t√© r√©alis√©e. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Publi√© dans le forum, mais n'a re√ßu rien de sens√© en r√©ponse. </font><font style="vertical-align: inherit;">Apr√®s avoir fouill√© dans la recherche, j'ai trouv√© les plaintes de plusieurs personnes concernant le firmware FPGA universel (avec auto-test), j'ai trouv√© trois autres versions de firmware l√†-bas, les ai essay√©es dans diff√©rentes combinaisons avec d'autres param√®tres, mais je n'ai pas r√©ussi. </font><font style="vertical-align: inherit;">Apr√®s avoir √©puis√© toutes les options, il a abandonn√© les exp√©riences jusqu'√† l'arriv√©e de l'analyseur logique command√© un peu plus tard BB.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Test avec un analyseur</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ayant re√ßu un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clone du</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> populaire </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analyseur logique Saleae Logic 16</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , il l'a connect√© aux quatre lignes </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le programme, disponible gratuitement sur le site Web de Saleae</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , peut d√©chiffrer I2C, SPI et plusieurs autres, il a donc imm√©diatement montr√© le d√©chiffrement de tous les paquets - envoy√©s et re√ßus. Il est imm√©diatement devenu clair que les paquets ¬´flottent¬ª - la m√™me s√©quence de bits est regroup√©e par le programme en paquets √† diff√©rentes fronti√®res, encore et encore. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En comparant les diagrammes de signaux sur les fiches techniques des microcircuits avec ceux enregistr√©s, j'ai remarqu√© √† un moment donn√© que le signal </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (connect√© √† la broche </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) au d√©but de chaque session d'√©change, il passe √† un niveau bas (niveau actif), dans lequel il reste, bien que selon le protocole il devrait revenir √† un niveau haut (passif) √† la fin de chaque op√©ration. J'ai chang√© le firmware ¬´officiel¬ª du FPGA en l'un des alternatives - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS a</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> commenc√© √† bouger plus activement, les bordures des paquets align√©s dessus, et apr√®s avoir s√©lectionn√© le diviseur de fr√©quence d'horloge dans la ligne de commande flashrom (arr√™t√© √† 8), le microcircuit a finalement commenc√© √† r√©pondre clairement √† chaque requ√™te, lu et √©cras√© . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Surpris de ne pas avoir imm√©diatement pr√™t√© attention au comportement de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , je me suis rendu compte que j'√©tais confus du travail r√©ussi avec </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AVR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sur le m√™me firmware FPGA. En regardant la fiche technique ATTiny13, j'ai trouv√© que le signal </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RESET</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que </font><b><font style="vertical-align: inherit;">TMS</font></b><font style="vertical-align: inherit;"> d√©marre</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">peut √™tre faible pendant tout le temps d'√©change, sa mont√©e pour la synchronisation n'est pas n√©cessaire. </font><font style="vertical-align: inherit;">Et les puces SPI ont besoin de son ascension pour la synchronisation. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√Ä la suite de tests, j'ai rassembl√© des informations sur trois micrologiciels FPGA bien connus dans </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">un message sur le forum</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Limite de r√©√©criture FPGA</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dans l'une des discussions, je suis tomb√© sur un avertissement que le nombre garanti de cycles de r√©√©criture du firmware de ce FPGA n'est que d'environ mille. </font><font style="vertical-align: inherit;">Au d√©but, j'√©tais boulevers√©, car pendant les exp√©riences, j'ai r√©ussi √† changer une centaine de fois le firmware, et j'imaginais d√©j√† la mort imminente de la puce. </font><font style="vertical-align: inherit;">Cela ne co√ªte rien, mais je ne veux pas jouer avec la soudure. </font><font style="vertical-align: inherit;">Il a ensuite r√©alis√© qu'avec une approche ad√©quate, les neuf cents cycles restants seraient suffisants pour encore de nombreuses ann√©es.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Clignotement en circuit de la ROM dans le routeur</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Apr√®s un certain temps, j'ai form√© un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mini-routeur</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fra√Æchement cuit </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;">sur le RT5350F</font></a><font style="vertical-align: inherit;"> sous le nom de code "ZLMNet H-G5 / P8201" (d√©signations tir√©es de l'interface Web). Vers la m√™me √©poque, le clip pour SOIC8 / SOP8 est arriv√© aussi - j'ai d√©cid√© d'essayer de travailler en circuit avec la ROM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au d√©but, le flashrom ne voyait pas du tout l'EPROM via BB. L'oscilloscope a montr√© que le processeur a </font><font style="vertical-align: inherit;">invariablement vaincu la </font><font style="vertical-align: inherit;">lutte entre le FPGA et le processeur du routeur pour les niveaux de signal de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> et </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CLK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Ce qui n'est pas surprenant - dans BB entre les bornes FPGA et le connecteur, il y a des r√©sistances de limitation de courant qui sauvent les cl√©s FPGA √† faible courant de l'√©puisement.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai connect√© USBASP avec AsProg - celui-ci lit / √©crit normalement, mais encore une fois lentement (9 minutes pour lire, 25 minutes pour le cycle d'effacement-√©criture-v√©rification). Pour une seule revitalisation d'une brique, c'est toujours acceptable, mais pour des exp√©riences avec un firmware instable ce n'est plus l√†. De plus, AsProg ne sait pas travailler avec des pages individuelles - seulement avec le microcircuit entier. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
J'ai soud√© entre les sorties </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS / TCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dans BB et les entr√©es </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS / CLK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de l' </font><font style="vertical-align: inherit;">EPROM pour l'√©metteur suiveur - les signaux imm√©diatement r√©duits √† presque les niveaux corrects, la puce flashrom a reconnu, a commenc√© √† lire / √©crire en toute confiance. Avec un diviseur de 8, une lecture compl√®te prend moins d'une minute, la r√©√©criture prend environ deux minutes.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Il s'est av√©r√© que la communication du programmeur avec l'EPROM n'interf√®re pas du tout avec le processeur - le routeur fonctionne parfaitement. </font><font style="vertical-align: inherit;">De toute √©vidence, les lignes CS / CLK sont allou√©es uniquement √† l'EPROM, qui est lue une fois au d√©marrage, apr√®s quoi le processeur n'y acc√®de pas si vous ne commencez pas √† la flasher avec des moyens r√©guliers.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inconv√©nients des programmes BB</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Les programmes test√©s (zJTAG, flashrom, avrdude, UrJtag, OpenOCD) qui peuvent fonctionner avec MPSSE ont fait une tr√®s triste impression. Premi√®rement, dans la plupart de ces programmes, avec toute la vari√©t√© d'adaptateurs FTDI, il n'y a aucune indication explicite de VID / PID - les identificateurs d'adaptateurs connus sont cod√©s en dur dans le code. Mais pour JTAGkey, qui √©mule BB, PID est d√©fini sur CFF8 et pour FT2232H ¬´propre¬ª, il est d√©fini sur 6010. Bien s√ªr, vous pouvez modifier les identificateurs dans BB √† l' </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aide de FT_Prog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ou patcher la table dans le programme, mais les deux options sont √©galement tordues. Eh bien, j'ai r√©ussi √† trouver une version de flashrom avec le support BB compil√© pour Windows (sinon je devrais installer CygWin), et avrdude fonctionne tr√®s bien lors de la sp√©cification du type de programmeur </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2232HIO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deuxi√®mement, certains programmes fonctionnent avec l'adaptateur uniquement via </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la biblioth√®que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libusb</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , qui, √† son tour, fonctionne via son propre pilote, ce qui est incompatible avec les pilotes FTDI. </font><font style="vertical-align: inherit;">C'est bien que dans Windows, pour basculer entre les pilotes, vous n'avez pas besoin de supprimer compl√®tement l'un et d'installer l'autre - il vous suffit de le ¬´mettre √† jour¬ª en choisissant de force le bon pilote pour le p√©riph√©rique donn√© (canal A ou B).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r√©sultats</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Maintenant, rappelant la quantit√© cumul√©e de temps et de nerfs consacr√©s √† toutes les exp√©riences d√©crites, je comprends que le prix de l'√©l√©gance ext√©rieure et l'universalit√© apparente de la solution se sont av√©r√©s prohibitifs. Je passe ce temps en plus sur le travail principal - je gagnerais de s√©rieux programmeurs industriels et d√©bogueurs. Mais le plus indubitable est que de tels exercices vous permettent au moins d'une mani√®re ou d'une autre de s'abstenir de la diapositive finale dans la consommation nette de modules personnalis√©s pr√™ts √† l'emploi, que les Chinois proposent en abondance. En ce sens, il est possible d'envier les ing√©nieurs anciens et m√©di√©vaux - pendant des d√©cennies, ils pourraient r√©soudre avec enthousiasme des probl√®mes r√©solus il y a longtemps sur quelques milliers de kilom√®tres dans le quartier, tout simplement sans le savoir.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nous devrions essayer OpenOCD et JTAG sur certains des routeurs disponibles, mais tout le monde n'y met pas la main. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dangerous Prototypes a √©galement un ancien projet </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bus Pirate</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Il y a une carte PIC et une interface simple FT232BL en mode s√©rie traditionnel. </font><font style="vertical-align: inherit;">Pour communiquer avec le contr√¥leur, un terminal standard et des commandes de texte sont utilis√©s, les r√©ponses sont √©galement affich√©es sous forme de texte. </font><font style="vertical-align: inherit;">avrdude, flashrom et un certain nombre d'autres programmes peuvent √©galement fonctionner via BP, cependant, pour des raisons √©videntes, la vitesse est plusieurs fois inf√©rieure. </font><font style="vertical-align: inherit;">La faible vitesse est compens√©e par l'√©tendue de l'application - il existe de nombreuses options pour utiliser BP pour √©muler divers protocoles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pensant que dans cette vie, vous devez tout essayer, j'ai command√© </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BP v3.6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avec c√¢ble. </font><font style="vertical-align: inherit;">Oui, oui, je me souviens des souris sur le cactus et de "demain j'y retournerai".</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr380531/">https://habr.com/ru/post/fr380531/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr380521/index.html">Navigateur pour personnes √† mobilit√© r√©duite (avec source)</a></li>
<li><a href="../fr380523/index.html">Vingt fausses stations de base cellulaires trouv√©es √† Londres</a></li>
<li><a href="../fr380525/index.html">Le commodore Amiga g√®re le syst√®me climatique de l'√©cole publique du Michigan depuis 30 ans</a></li>
<li><a href="../fr380527/index.html">Conf√©rence de footballeur de math√©matiques au personnel de la NSA</a></li>
<li><a href="../fr380529/index.html">–ú–æ–±–∏–ª—å–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä Safari –Ω–∞—É—á–∏–ª—Å—è –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–ª–∞–º—É</a></li>
<li><a href="../fr380533/index.html">Epson invite tout le monde √† un pique-nique pour les geeks</a></li>
<li><a href="../fr380535/index.html">L'atterrissage en douceur de la capsule de l'Union ressemble plus √† une explosion, mais ce n'est pas un probl√®me</a></li>
<li><a href="../fr380537/index.html">Unreal Engine 4.8 est sorti</a></li>
<li><a href="../fr380541/index.html">Vendredi "Colis": cas inhabituels et curiosit√©s dans la livraison</a></li>
<li><a href="../fr380543/index.html">Carte √† puce. Partie 4. JavaCard</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>