<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎵 🛕 👎🏼 深度学习-不仅是手机上的封条或我们如何诊断机车手推车 🌂 👨🏻‍🌾 🏮</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="就在几天前，Aurorai将试运行移交给了Ermak机车的缺陷识别和电车监控系统。 这项任务并不简单，而且非常有趣，第一步是评估制动衬块的状况和支架的宽度。 我们设法以高达30 km / h的机车速度以1 mm的精度解决了这个问题！ 我想指出的是，由于具体情况，可以使用“ TTA（测试时间增强）” ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>深度学习-不仅是手机上的封条或我们如何诊断机车手推车</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ods/blog/443016/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/hp/k8/5k/hpk85kft0_bi1euqgqvftfm2vic.jpeg"></div><br> 就在几天前，Aurorai将试运行移交给了Ermak机车的缺陷识别和电车监控系统。 这项任务并不简单，而且非常有趣，第一步是评估制动衬块的状况和支架的宽度。 我们设法以高达30 km / h的机车速度以1 mm的精度解决了这个问题！ 我想指出的是，由于具体情况，可以使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">“ TTA（测试时间增强）”</a> -这是kaggle风格竞争黑客的生动示例，它不适合基于<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">se_resnext50</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">编码器的</a>产品和语义细分，这在掩码预测中提供了惊人的准确结果。 <br><a name="habracut"></a><br>  <b>任务说明</b> <br><br> 有必要创建一种硬件软件复合体，以检测制动衬块的缺陷以及将数据输出到换挡工头。 <br><br>  <b>任务的先决条件</b> <br><br> 事实证明，PTOL（机车的技术检查要点）中有大量的垫板（约80％）发生了变化，每台机车每72小时就会发生一次这种情况。  PTOL中的大部分检查工作是由机车手推车外部的主人进行的目视检查。 <br><br><img src="https://habrastorage.org/webt/xp/lz/ew/xplzewvz4vitxelucz2te4liocq.gif"><br><br>  <b>解决问题的计划：</b> <br><br><ol><li> 设备选型 </li><li> 资料收集 </li><li> 模型训练 </li><li> 使用REST API进行服务器开发 </li><li>  Android平板电脑客户端开发 </li><li> 设计和组装用于放置摄像机和照明灯的机架 </li><li> 试运行 </li></ol><br>  <b>设备选型</b> <br><br> 也许最困难的任务之一，就是即使不是最困难的任务，也是在有限的预算和时间内选择摄像机，镜头和灯光：MVP必须在一个半月内完成。 几天后，Google使我成为了机器视觉硬件的专家。 选择是在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Basler</a>相机和与相机同步的6k流明脉冲背光中进行的。 支持Basler（70帧/秒，分辨率高达1920x1024）的python API辐条，极大地促进了所有系统组件的集成，唯一的缺点是相机价格约为100tr。 <br><br> 由于缺乏对必要的焦距和视角的理解，使相机镜头的选择变得很复杂，我不得不冒险，但是我掏出了镜头计算器，却碰巧了运气。 <br><br> 背光：通过实验确定LED发光所需的时间，其类型和透镜参数。 我尝试对LED进行3种不同的镜头修改，其角度分别为30、45、60，最终选择了角度为45的磨砂镜头。 <br><br><img src="https://habrastorage.org/webt/lq/vc/4a/lqvc4a2w5fv7uqqdtveh3a-le3c.jpeg"><br><br><img src="https://habrastorage.org/webt/ap/to/nn/aptonnrgp3kjkpyyz67jo3g4wnc.jpeg"><br><br> 组装并测试相机的脉冲控制信号 <br><br><img src="https://habrastorage.org/webt/n7/s_/n3/n7s_n3chgt_6nfjwv541dluhzn0.jpeg"><br><br> 对于服务器硬件，我采用了Intel Core i7-7740X Kaby Lake，46gb RAM，1 TB SSD和3x1080Ti-这足以在不超过2分钟的时间内预测出两个三节式机车。 <br><br> 来自视频卡的三明治的农场总体降温10度。 <br><br><img src="https://habrastorage.org/webt/f_/fb/v4/f_fbv44tdrie9mdta1djurpv6kw.jpeg"><br><br>  <b>资料收集</b> <br><br> 创建数据集是一首单独的歌，没有人可以委托此活动，因此我被送往我们广阔家园深处一个遥远的鲜为人知的小镇。 我在<b>手机</b>上拍了约400个垫子<b>（!!!）</b> 。 展望未来，我要说的是，勇敢的仓库员工显然受到来自莫斯科的审计员的惊吓，将机车上的所有护垫都换成了全新的护垫，并给它们涂上了一层新鲜的油漆，这看上去真是有趣而且令人恐惧。 我期待着最坏的情况，尽管我仍然在莫斯科仓库中拍摄了约400张完全不同的街区照片。 <br><br> 只是相信一个奇迹，大量增加，提出启发式方法来删除错误的段，其中有很多，因为我没有考虑过反例。 <br><br> 等待中： <br><br><img src="https://habrastorage.org/webt/bu/ju/04/buju04qal7c3euollekewwem6ma.jpeg"><br><br> 现实情况： <br><br><img src="https://habrastorage.org/webt/wj/lo/xc/wjloxc_zlslgjsyag4tubgzg0ms.png"><br><br><img src="https://habrastorage.org/webt/gy/xl/jd/gyxljdwzpmhoxuvbfqie6ixzvpc.jpeg"><br><br> 在这里必须说，没有一个严重磨损的砖块的例子。 <br><br>  <b>模型训练</b> <br><br> 该存储库中带有se_resnext50编码器和带<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">scse</a>块的解码器的模型表现得最好，但由于要加快预测过程，因此必须删除<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">scse（pytorch的实现）</a> ，因为 必须在一分钟内预测到。 为了进行模型训练，使用了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Pytorch 1.0.1</a>框架，其中包括大量来自<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">白化</a>的增强和自写的水平翻转增强，以在显示时更改类。 <br><br><pre><code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">train_transform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(p=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Compose([ OneOf([ CLAHE(clip_limit=<span class="hljs-number"><span class="hljs-number">2</span></span>), IAASharpen(), IAAEmboss(), RandomBrightnessContrast(brightness_limit=<span class="hljs-number"><span class="hljs-number">0.8</span></span>, contrast_limit=<span class="hljs-number"><span class="hljs-number">0.8</span></span>), HueSaturationValue(hue_shift_limit=<span class="hljs-number"><span class="hljs-number">50</span></span>, sat_shift_limit=<span class="hljs-number"><span class="hljs-number">50</span></span>, val_shift_limit=<span class="hljs-number"><span class="hljs-number">50</span></span>), RGBShift(r_shift_limit=<span class="hljs-number"><span class="hljs-number">50</span></span>, g_shift_limit=<span class="hljs-number"><span class="hljs-number">50</span></span>, b_shift_limit=<span class="hljs-number"><span class="hljs-number">50</span></span>), JpegCompression(quality_lower=<span class="hljs-number"><span class="hljs-number">30</span></span>), RandomGamma(), GaussNoise() ], p=<span class="hljs-number"><span class="hljs-number">0.3</span></span>), OneOf([ Blur(), MotionBlur(), MedianBlur(), ], p=<span class="hljs-number"><span class="hljs-number">0.3</span></span>), ShiftScaleRotate(shift_limit=<span class="hljs-number"><span class="hljs-number">0.2</span></span>, scale_limit=<span class="hljs-number"><span class="hljs-number">0.4</span></span>, rotate_limit=<span class="hljs-number"><span class="hljs-number">5</span></span>, p=<span class="hljs-number"><span class="hljs-number">0.5</span></span>), Normalize(p=<span class="hljs-number"><span class="hljs-number">1</span></span>) ], p=p)</code> </pre> <br> 作为损失函数，我选择了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TheLovász-Softmaxloss</a> ，其行为几乎与bce + jaccard相同，但比<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BCE</a>更好，后者在标记中过于合适。 选择算法来确定一对齿轮和轮对的序列号也是一个挑战， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">公制学习</a>有很多选择，但是我需要快速显示结果，然后才想到在第1类和第2类中标记这些块，其中1是向右的方向，而2是在左边 网络不仅开始预测遮罩，还开始预测方向。 使用简单的试探法，可以可靠地确定块和轮对的序列号，然后对预测取平均，实际上，即使在320x320的分辨率下，使用TTA在运动过程中物体略有移动以及不同的照明角度也可以很好地实现蒙版精度。 <br><br> 另外，任务是确定块的楔形缺陷，从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">霍夫变换</a> （ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Huff Transformation</a> ）到用不同类的点/线标记块的角/边界，有很多想法。 最后，选择权胜过了工人的工作方式：您需要从窄边向后退5厘米并测量宽度（如果它在正常范围内），然后跳过该块。 <br><br> 培训管道是从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">MICCAI 2017机器人仪器细分中获得的</a> 。 培训过程包括三个阶段：使用冻结编码器进行培训，对整个网络进行培训以及使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">CosineAnnealingLR进行</a>培训。 前两个阶段使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ReduceLROnPlateau</a> 。 <br><br>  <b>在Android上编程REST服务器和客户端</b> <br><br> 对于REST服务器，我选择了flask-2分钟之内不要启动就更容易了。 我决定自己动手制作一个数据库，以简单的文件夹结构和当前状态文件的形式存储。  Android Studio上平板电脑的应用程序，最新版本的好处对开发人员来说只是天堂。 <br><br>  <b>设计和组装用于放置摄像机和照明灯的机架</b> <br><br> 我回想起了我为电动汽车制造充电站的年代，这种经历非常方便-我们决定使用3D打印机上打印的铝制结构机架来制造它。 <br><br><img src="https://habrastorage.org/webt/sy/ai/sd/syaisdlo96ld_0u_zzrckpnq_ng.jpeg"><br><br><img src="https://habrastorage.org/webt/ch/pd/7s/chpd7sjyqr-x8u99flu2gf_dfy8.jpeg"><br><br>  <b>进行测试！</b> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/sIzn-ix6axQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br> 结果超出了所有预期。 对于计算机视觉专家而言，该任务似乎非常简单明了。 但是，由于两件事，我有些怀疑：首先，训练集很小，并且没有边界案例，例如很薄的积木。 其次，测试是在非常不同的拍摄和照明条件下进行的。 <br><br><img src="https://habrastorage.org/webt/dk/cr/t7/dkcrt7rtuca4tlosawaygpvw9bw.jpeg"><br><br><img src="https://habrastorage.org/webt/rn/zt/5a/rnzt5amj8om5hiz_w57qxgtxozm.jpeg"><br><br> 验证中的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Jaccard</a>达到0.96，在视觉上将焊盘进行了非常清晰的分割，对几张照片进行了平均，并且在估计焊盘的宽度时具有非常好的准确性。 在测试期间，事实证明您可以使用其他机车的手推车，但要使用更快的相机： <br><br><img src="https://habrastorage.org/webt/vq/zg/ap/vqzgap76zvv1qlpz9-hqxr8_0s0.jpeg"><br><br><img src="https://habrastorage.org/webt/fu/h5/ci/fuh5cikxtwssvrfy333eyrl8itw.jpeg"><br><br> 总而言之，我想说的是，该技术已经很好地展示了自己，并且在消除人为因素，减少机车的停机时间和进行预测方面具有巨大的潜力。 <br><br>  <b>致谢</b> <br><br> 感谢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ods.ai</a>社区，如果没有您的帮助，我将无法在这么短的时间内完成所有这些工作！ 非常感谢DL，希望我能接受DL <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" class="user_link">n01z3</a>的宝贵建议和非凡的敬业精神！ 非常感谢意识形态策划者Vasily Manko（Aurorai公司首席执行官），最佳设计师Tatyana Brusova。 <br><br>  <i>故事的下一集见！</i> <br><br><img src="https://habrastorage.org/webt/xv/x3/yv/xvx3yvszd_twqjbrtk3rjaxrxpk.png">  Aurorai，llc </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN443016/">https://habr.com/ru/post/zh-CN443016/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN443004/index.html">我的女朋友和第一个电子游戏。 统一开发。 第一部分</a></li>
<li><a href="../zh-CN443006/index.html">Grafana v6发布-开放式可视化工具的新功能</a></li>
<li><a href="../zh-CN443008/index.html">颂扬一个程序员的一天</a></li>
<li><a href="../zh-CN443012/index.html">俄罗斯公司开始批量生产神经处理器-Nvidia的竞争对手</a></li>
<li><a href="../zh-CN443014/index.html">分享交通新闻：电动踏板车不会持续很长时间； Lyft和Uber即将上市</a></li>
<li><a href="../zh-CN443020/index.html">我和我女朋友的第一个电子游戏。 用Unity开发。 第一部分</a></li>
<li><a href="../zh-CN443022/index.html">Rosserial和STM32</a></li>
<li><a href="../zh-CN443024/index.html">ITMO大学文摘：面向IT学生的12场主题会议，黑客马拉松和MOOC课程</a></li>
<li><a href="../zh-CN443026/index.html">访问控制及其吃法</a></li>
<li><a href="../zh-CN443028/index.html">3月11日至17日在莫斯科举行的数字活动</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>