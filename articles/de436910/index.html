<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëçüèæ üññüèΩ üîï Tipps zum Erstellen benutzerdefinierter Workflows in GitLab CI üë®üèæ‚Äç‚öñÔ∏è üòê ‚è±Ô∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hinweis perev. : Der Originalartikel wurde von Mi≈Çosz Sm√≥≈Çka verfasst, einem der Gr√ºnder des kleinen polnischen Unternehmens Three Dots Labs , das sic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Tipps zum Erstellen benutzerdefinierter Workflows in GitLab CI</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/436910/">  <i><b>Hinweis</b></i>  <i><b>perev.</b></i>  <i>: Der Originalartikel wurde von Mi≈Çosz Sm√≥≈Çka verfasst, einem der Gr√ºnder des kleinen polnischen Unternehmens <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Three Dots Labs</a> , das sich auf ‚Äûfortschrittliche Backend-L√∂sungen‚Äú spezialisiert hat.</i>  <i>Der Autor st√ºtzt sich auf seine Erfahrungen mit der aktiven Nutzung von GitLab CI und teilt die gesammelten Tipps f√ºr andere Benutzer dieses Open Source-Produkts.</i>  <i>Nachdem wir sie gelesen hatten, stellten wir fest, wie nahe die von ihm beschriebenen Probleme an uns liegen, und beschlossen, die vorgeschlagenen L√∂sungen einem breiteren Publikum zug√§nglich zu machen.</i> <br><br><img src="https://habrastorage.org/web/168/262/b4e/168262b4e3af4467978ffc20dd8bba99.png"><br><br>  Dieses Mal werde ich fortgeschrittenere Themen in GitLab CI behandeln.  Eine h√§ufige Aufgabe besteht darin, nicht standardm√§√üige Funktionen in der Pipeline zu implementieren.  Die meisten Tipps sind spezifisch f√ºr GitLab, obwohl einige von ihnen auf andere CI-Systeme angewendet werden k√∂nnen. <a name="habracut"></a><br><br><h2>  F√ºhren Sie Integrationstests aus </h2><br>  In der Regel l√§sst sich die Code√ºberpr√ºfung mithilfe von <b>Komponententests</b> problemlos mit jedem CI-System verbinden.  Normalerweise ist dies nicht komplizierter als das Ausf√ºhren eines der Befehle, die in den Standarddienstprogrammen in einer Programmiersprache integriert sind.  In solchen Tests verwenden Sie wahrscheinlich verschiedene Moki und Stubs, um Implementierungsdetails auszublenden und sich auf das Testen spezifischer Logik zu konzentrieren.  Beispielsweise k√∂nnen Sie die In-Memory-Datenbank als Speicher- oder Schreibstubs f√ºr HTTP-Clients verwenden, die immer bereits vorbereitete Antworten zur√ºckgeben. <br><br>  Fr√ºher oder sp√§ter ben√∂tigen Sie jedoch <b>Integrationstests</b> , um ungew√∂hnlichere Situationen mit Tests abzudecken.  Ich werde nicht auf alle m√∂glichen Arten von Tests eingehen und nur sagen, dass ich unter <i>Integration</i> Tests verstehe, die externe Ressourcen verwenden.  Dies kann ein echter Datenbankserver, ein HTTP-Dienst, ein verbundener Speicher usw. sein. <br><br>  In GitLab ist es einfach, steckbare Ressourcen als Docker-Container auszuf√ºhren, die dem Container zugeordnet sind, in dem die Skripte ausgef√ºhrt werden.  Diese Abh√§ngigkeiten k√∂nnen mithilfe von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><code>services</code></a> definiert werden.  Sie sind unter dem Namen des Bildes oder nach dem Namen Ihrer Wahl verf√ºgbar, wenn Sie ihn im <code>alias</code> angeben. <br><br>  Hier ist ein einfaches Beispiel f√ºr die Verwendung eines steckbaren Containers mit MySQL: <br><br><pre> <code class="plaintext hljs">integration_tests: stage: tests services: - name: mysql:8 alias: db script: - ./run_tests.sh db:3306</code> </pre><br>  In diesem Fall m√ºssen Sie in Testskripten eine Verbindung zum <code>db</code> .  Die Verwendung eines Alias ‚Äã‚Äãist normalerweise eine gute Idee, da Sie damit Bilder ersetzen k√∂nnen, ohne den Testcode √§ndern zu m√ºssen.  Sie k√∂nnen beispielsweise das <code>mysql</code> Image durch <code>mariadb</code> ersetzen, und das Skript funktioniert weiterhin ordnungsgem√§√ü. <br><br><h4>  Warten auf Container </h4><br>  Da das Laden von Plug-In-Containern einige Zeit in Anspruch nimmt, m√ºssen Sie m√∂glicherweise warten, bevor Sie Anforderungen senden.  Eine einfache M√∂glichkeit besteht darin, auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ein</a> Skript mit einem definierten Zeitlimit zu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">warten</a> . <br><br><h3>  Verwenden von Docker Compose </h3><br>  In den meisten F√§llen sollten die <code>services</code> ausreichend sein.  Manchmal kann jedoch eine Interaktion mit externen Diensten erforderlich sein.  Zum Beispiel beim Starten von Kafka und ZooKeeper in zwei separaten Containern (auf diese Weise werden offizielle Bilder gesammelt).  Ein weiteres Beispiel ist das Ausf√ºhren von Tests mit einer dynamischen Anzahl von Knoten, z. B. Selen.  Die beste L√∂sung zum Ausf√ºhren dieser Dienste w√§re <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker Compose</a> : <br><br><pre> <code class="plaintext hljs">version: '3' services: zookeeper: image: confluentinc/cp-zookeeper environment: ZOOKEEPER_CLIENT_PORT: 2181 kafka: image: confluentinc/cp-kafka environment: KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181 KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092 ports: - 9092:9092</code> </pre><br>  Wenn Sie Ihre Installation mit GitLab-L√§ufern auf vertrauensw√ºrdigen Servern verwenden, k√∂nnen Sie Docker Composer √ºber den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Shell-Executor ausf√ºhren</a> .  Eine weitere m√∂gliche Option ist der <code>dind</code> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Docker in Docker</a> ( <code>dind</code> ).  Lesen Sie in diesem Fall zuerst <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesen Artikel</a> . <br><br>  Eine M√∂glichkeit, Compose zu verwenden, besteht darin, Ihre Umgebung einzurichten, Tests auszuf√ºhren und dann alles zu zerst√∂ren.  Ein einfaches Bash-Skript w√ºrde folgenderma√üen aussehen: <br><br><pre> <code class="plaintext hljs">docker-compose up -d ./run_tests.sh localhost:9092 docker-compose down</code> </pre> <br>  Solange Sie Tests in einer minimalen Umgebung ausf√ºhren, ist alles in Ordnung.  Obwohl eine Situation auftreten kann, in der Sie einige Abh√§ngigkeiten installieren m√ºssen ... Es gibt eine andere M√∂glichkeit, Tests in Docker Compose auszuf√ºhren: Sie k√∂nnen Ihr eigenes Docker-Image mit einer Testumgebung erstellen.  In einem der Container f√ºhren Sie Tests aus und beenden das Programm mit dem entsprechenden R√ºckkehrcode: <br><br><pre> <code class="plaintext hljs">version: '3' services: zookeeper: image: confluentinc/cp-zookeeper environment: ZOOKEEPER_CLIENT_PORT: 2181 kafka: image: confluentinc/cp-kafka environment: KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181 KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://kafka:9092 tests: image: registry.example.com/some-image command: ./run_tests.sh kafka:9092</code> </pre><br>  Beachten Sie, dass wir keine Ports mehr zuordnen m√ºssen.  In diesem Beispiel k√∂nnen Tests direkt mit allen Diensten interagieren. <br><br>  Und ihr Start wird von einem Befehl ausgef√ºhrt: <br><br><pre> <code class="plaintext hljs">docker-compose up --exit-code-from tests</code> </pre> <br>  Die <code>--abort-on-container-exit</code> <code>--exit-code-from</code> impliziert <code>--abort-on-container-exit</code> , was bedeutet: Die gesamte von <code>docker-compose up</code> initiierte Umgebung wird gestoppt, nachdem einer der Container abgeschlossen ist.  Der Abschlusscode f√ºr diesen Befehl entspricht dem Beendigungscode des ausgew√§hlten Dienstes (d. H. Dies sind <code>tests</code> im obigen Beispiel).  Wenn der Befehl, mit dem die Tests gestartet werden, mit einem Code ungleich Null abgeschlossen wird, wird der gesamte <code>docker-compose up</code> damit beendet. <br><br><h2>  Verwenden von Labels als CI-Tags </h2><br>  <b>Achtung</b> : Dies ist eine eher ungew√∂hnliche Idee, die mir jedoch sehr n√ºtzlich und flexibel erschien. <br><br>  Wie Sie vielleicht wissen, verf√ºgt GitLab √ºber eine Etikettenfunktion auf Projekt- und Gruppenebene.  Auf Tickets und Zusammenf√ºhrungsanforderungen k√∂nnen Beschriftungen festgelegt werden.  Sie haben jedoch keine Beziehung zu Pipelines. <br><br><img src="https://habrastorage.org/webt/xt/pn/79/xtpn79pe46ztibrzwyeroay952k.png"><br><br>  Mit einer kleinen Verfeinerung k√∂nnen Sie in Jobskripten auf die Beschriftungen der Zusammenf√ºhrungsanforderung zugreifen.  In GitLab 11.6 ist alles noch einfacher geworden, weil  Die Umgebungsvariable <code>CI_MERGE_REQUEST_IID</code> (ja, es handelt sich um die <code>IID</code> , nicht um die <code>ID</code> ), wenn die Pipeline <code>only: merge_requests</code> verwendet <code>only: merge_requests</code> . <br><br>  Wenn <code>only: merge_requests</code> nicht verwendet wird oder Sie mit einer √§lteren Version von GitLab arbeiten, kann MR weiterhin abgerufen werden - mithilfe des API-Aufrufs: <br><br><pre> <code class="bash hljs">curl <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CI_API_V4_URL</span></span></span><span class="hljs-string">/projects/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CI_PROJECT_ID</span></span></span><span class="hljs-string">/repository/commits/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CI_COMMIT_SHA</span></span></span><span class="hljs-string">/merge_requests?private_token=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$GITLAB_TOKEN</span></span></span><span class="hljs-string">"</span></span></code> </pre> <br>  Das Feld, das wir brauchen, ist <code>iid</code> .  Denken Sie jedoch daran, dass viele MRs f√ºr ein bestimmtes Commit zur√ºckkehren k√∂nnen. <br><br>  Wenn die MR IID empfangen wird, m√ºssen Sie sich nur noch an die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Merge Requests API</a> wenden und das Feld <code>labels</code> aus der Antwort verwenden: <br><br><pre> <code class="bash hljs">curl <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CI_API_V4_URL</span></span></span><span class="hljs-string">/projects/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CI_PROJECT_ID</span></span></span><span class="hljs-string">/merge_requests/</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$CI_MERGE_REQUEST_IID</span></span></span><span class="hljs-string">?private_token=</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$GITLAB_TOKEN</span></span></span><span class="hljs-string">"</span></span></code> </pre> <br><h3>  Login </h3><br>  Leider ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">es</a> derzeit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">nicht m√∂glich</a> , mit <code>$CI_JOB_TOKEN</code> auf die Projekt-API zuzugreifen (zumindest wenn das Projekt nicht √∂ffentlich ist).  Wenn das Projekt nur eingeschr√§nkten Zugriff hat (intern oder privat), m√ºssen Sie f√ºr die Autorisierung in der GitLab-API ein pers√∂nliches API-Token generieren. <br><br><img src="https://habrastorage.org/webt/jo/c_/jn/joc_jntn1lbz5eb6tif6cfo41xs.png"><br><br>  Dies ist jedoch nicht die sicherste L√∂sung. Seien Sie also vorsichtig.  Wenn das Token in schlechte H√§nde ger√§t, wird m√∂glicherweise der Schreibzugriff auf alle Ihre Projekte angezeigt.  Eine M√∂glichkeit, Risiken zu reduzieren, besteht darin, ein separates Konto mit dem Recht zu erstellen, das Repository zu lesen und ein pers√∂nliches Token f√ºr dieses Konto zu erstellen. <br><br><h4>  Wie sicher sind Ihre Variablen? </h4><br>  Vor einigen Versionen wurde der Abschnitt " <i>Variablen</i> " als " <i>Geheime Variablen"</i> bezeichnet. <i>Dies scheint so zu sein</i> , als ob sie zum zuverl√§ssigen Speichern von Anmeldeinformationen und anderen wichtigen Informationen erstellt wurden.  Tats√§chlich werden die Variablen einfach vor Benutzern ausgeblendet, die keine Maintainer-Berechtigungen haben.  Sie sind nicht auf der Festplatte verschl√ºsselt, und ihr Leck kann leicht durch Umgebungsvariablen in Skripten auftreten. <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beachten</a> Sie dies, wenn Sie Variablen hinzuf√ºgen, und ziehen Sie in Betracht, Geheimnisse in sichereren L√∂sungen (z. B. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vault von HashiCorp</a> ) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">aufzubewahren</a> . <br><br><h3>  Anwendungsf√§lle </h3><br>  Was mit den Etikettenlisten zu tun ist, liegt bei Ihnen.  Hier sind einige Ideen: <br><br><ul><li>  Verwenden Sie sie zum Segmentieren von Tests. </li><li>  Verwenden Sie die Schl√ºsselwertsemantik mit einem Doppelpunkt als Trennzeichen (z. B. Bezeichnungen wie <code>tests:auth</code> , <code>tests:user</code> ). </li><li>  F√ºgen Sie bestimmte Funktionen f√ºr Jobs hinzu. </li><li>  Erm√∂glichen Sie das Debuggen bestimmter Jobs, wenn das Label vorhanden ist. </li></ul><br><h2>  Externe APIs aufrufen </h2><br>  Obwohl GitLab bereits mit einer Reihe von Funktionen ausgestattet ist, ist es sehr wahrscheinlich, dass Sie andere Dienstprogramme verwenden m√∂chten, die in Pipelines integriert werden k√∂nnen.  Der einfachste Weg, dies zu implementieren, ist nat√ºrlich das Aufrufen der guten alten <code>curl</code> . <br><br>  Wenn Sie Ihre eigenen Tools erstellen, k√∂nnen Sie ihnen das Anh√∂ren von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitLab-Webhooks beibringen</a> (siehe Registerkarte <b>Integrationen</b> in den Projekteinstellungen).  Wenn Sie sie jedoch mit kritischen Systemen verwenden m√∂chten, stellen Sie sicher, dass sie den Anforderungen an hohe Verf√ºgbarkeit entsprechen. <br><br><h3>  Beispiel: Grafana-Anmerkungen </h3><br>  Wenn Sie mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Grafana arbeiten</a> , sind <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anmerkungen</a> eine hervorragende M√∂glichkeit, Ereignisse, die im Laufe der Zeit aufgetreten sind, in Diagrammen zu markieren.  Sie k√∂nnen nicht nur manuell durch Klicken in die GUI hinzugef√ºgt werden, sondern auch durch Aufrufen der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=http://docs.grafana.org/">Grafana REST-API</a> : <br><br><img src="https://habrastorage.org/webt/9e/rr/0z/9err0z9dowhzj9jr1q_asbxsxs0.png"><br><br>  Um auf die API zugreifen zu k√∂nnen, m√ºssen Sie einen API-Schl√ºssel generieren.  Ziehen Sie in Betracht, einen separaten Benutzer mit eingeschr√§nktem Zugriff zu erstellen: <br><br><img src="https://habrastorage.org/webt/qv/ab/ax/qvabaxtz1ivbshbiw1eeyx10vme.png"><br><br>  Definieren Sie zwei Variablen in den Projekteinstellungen: <br><br><ul><li>  <code>GRAFANA_URL</code> - URL zur Grafana-Installation (z. B. <code>https://grafana.example.com</code> ); </li><li>  <code>GRAFANA_APIKEY</code> - generierter Schl√ºssel zur API. </li></ul><br>  Um es wiederverwenden zu k√∂nnen, legen Sie das Skript <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mit allgemeinen Skripten</a> im <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Repository ab</a> : <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash set -e if [ $# -lt 2 ]; then echo "Usage: $0 &lt;text&gt; &lt;tag&gt;" exit 1 fi readonly text="$1" readonly tag="$2" readonly time="$(date +%s)000" cat &gt;./payload.json &lt;&lt;EOF { "text": "$text", "tags": ["$tag"], "time": $time, "timeEnd": $time } EOF curl -X POST "$GRAFANA_URL/api/annotations" \ -H "Authorization: Bearer $GRAFANA_APIKEY" \ -H "content-type: application/json" \ -d @./payload.json</span></span></code> </pre> <br>  Jetzt k√∂nnen Sie der CI-Konfiguration den Aufruf mit den erforderlichen Parametern hinzuf√ºgen: <br><br><pre> <code class="plaintext hljs">deploy: stage: deploy script: - $SCRIPTS_DIR/deploy.sh production - $SCRIPTS_DIR/grafana-annotation.sh "$VERSION deployed to production" deploy-production</code> </pre> <br>  Diese Aufrufe k√∂nnen im Skript <code>deploy.sh</code> platziert werden, um die CI-Konfiguration zu vereinfachen. <br><br><h2>  Bonus: schnelle Tipps </h2><br>  GitLab verf√ºgt √ºber eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hervorragende Dokumentation</a> zu allen m√∂glichen Schl√ºsselw√∂rtern, die zum Konfigurieren von CI verwendet werden k√∂nnen.  Ich m√∂chte den Inhalt hier nicht duplizieren, werde aber auf einige n√ºtzliche F√§lle hinweisen.  Klicken Sie auf die √úberschriften, um die zugeh√∂rige Dokumentation anzuzeigen. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erweiterte Verwendung von nur / au√üer</a> </h3><br>  Durch Definieren von Mustern f√ºr CI-Variablen k√∂nnen Sie benutzerdefinierte Assemblys f√ºr einige Zweige definieren.  Dies kann zum Beispiel helfen, Push-Fixes f√ºr dringende Fixes zu identifizieren, aber missbrauchen Sie es nicht: <br><br><pre> <code class="plaintext hljs">only: refs: - branches variables: - $CI_COMMIT_REF_NAME =~ /^hotfix/</code> </pre> <br>  GitLab hat viele <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">vordefinierte Variablen</a> in jedem CI-Job - verwenden Sie sie. <br><br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yaml Anker</a> </h3><br>  Verwenden Sie sie, um Doppelarbeit zu vermeiden. <br><br>  Ab Version 11.3 k√∂nnen Sie auch das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Schl√ºsselwort extenses verwenden</a> : <br><br><pre> <code class="plaintext hljs">.common_before_script: &amp;common_before_script before_script: - ... - ... deploy: &lt;&lt;: *common_before_script</code> </pre> <br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ausschluss von Artefakten</a> </h3><br>  Standardm√§√üig werden alle in der Pipeline gesammelten Artefakte auf alle nachfolgenden Jobs √ºbertragen.  Wenn Sie die Artefakte, von denen Jobs abh√§ngen, explizit auflisten, k√∂nnen Sie Zeit und Speicherplatz sparen: <br><br><pre> <code class="plaintext hljs">dependencies: - build</code> </pre> <br>  Oder - im Gegenteil - alles komplett √ºberspringen, wenn keiner von ihnen ben√∂tigt wird: <br><br><pre> <code class="plaintext hljs">dependencies: []</code> </pre> <br><h3>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Git-Strategie</a> </h3><br>  √úberspringen Sie das Klonen des Repositorys, wenn der Job diese Dateien nicht verwendet: <br><br><pre> <code class="plaintext hljs">variables: GIT_STRATEGY: none</code> </pre> <br>  Das ist alles! <br><br>  Danke f√ºrs Lesen!  F√ºr Feedback und Fragen kontaktieren Sie mich auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Twitter</a> oder <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reddit</a> . <br><br>  Weitere GitLab-Tipps finden Sie in fr√ºheren Beitr√§gen: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beibehalten allgemeiner Skripte in GitLab CI</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Automatische semantische Versionierung in GitLab CI</a> . </li></ul><br><h2>  PS vom √úbersetzer </h2><br>  Lesen Sie auch in unserem Blog: <br><br><ul><li>  ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitLab CI f√ºr die kontinuierliche Integration und Bereitstellung in der Produktion.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1: Unsere Pipeline</a> ‚Äú; </li><li>  ‚Äû <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitLab CI f√ºr die kontinuierliche Integration und Bereitstellung in der Produktion.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2: Schwierigkeiten √ºberwinden</a> ‚Äú; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erstellen Sie Projekte mit GitLab CI: eine .gitlab-ci.yml f√ºr Hunderte von Anwendungen</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erstellen und Installieren von Anwendungen in Kubernetes mit dapp und GitLab CI</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Best Practices f√ºr CI / CD mit Kubernetes und GitLab (Rezension und Videobericht)</a> ." </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de436910/">https://habr.com/ru/post/de436910/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de436894/index.html">Kriechende IT-Apokalypse. Neue Cloud-Dienste werden einige Ingenieure arbeitslos machen</a></li>
<li><a href="../de436896/index.html">Docker-Pretty-Ps - endlich ein lesbarer Docker-PS</a></li>
<li><a href="../de436900/index.html">FunTech ML-Treffen</a></li>
<li><a href="../de436904/index.html">32K-Schwellenwert f√ºr Daten im AVR-Mikrocontroller-ROM</a></li>
<li><a href="../de436908/index.html">6 M√∂glichkeiten, Daten in einer Android-Anwendung auszublenden</a></li>
<li><a href="../de436912/index.html">2019 CRM-Trends: Spa√ü beim Lesen, gef√§hrlich zu glauben</a></li>
<li><a href="../de436914/index.html">Probleme mit dem Startwachstum - √úberwachung</a></li>
<li><a href="../de436916/index.html">VShard - horizontale Skalierung in Tarantool</a></li>
<li><a href="../de436918/index.html">Erstellen eines Spiels f√ºr Game Boy, Teil 2</a></li>
<li><a href="../de436920/index.html">PAS2JS-Transpiler von Pascal nach JavaScript: Inkompatibel mit Delphi und Problemumgehungen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>