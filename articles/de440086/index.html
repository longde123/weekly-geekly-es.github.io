<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚úäüèª üëàüèæ üî† MS-DOS Virus World ü§üüèº ‚úäüèΩ üéöÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Beitrag ist eine Textversion meines Vortrags auf dem 35. Chaos Computer Congress Ende 2018. 

 Und so muss ich zugeben, dass MS-DOS ein wenig e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MS-DOS Virus World</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/edison/blog/440086/"><img src="https://habrastorage.org/getpro/habr/post_images/b72/62e/c62/b7262ec62c4ef1c84e30a166db2801ed.gif" alt="Bild"><br><br>  Dieser Beitrag ist eine Textversion meines <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vortrags</a> auf dem 35. Chaos Computer Congress Ende 2018. <br><br>  Und so muss ich zugeben, dass MS-DOS ein wenig emp√∂rt ist, obwohl mich MS-DOS-Malware immer in gewissem Ma√üe fasziniert hat, aber zuerst m√ºssen wir fragen: "Was ist DOS?" <br><br><ul><li>  DOS ist eine Version von CP / M, einem anderen sehr alten Betriebssystem. </li><li>  Die DOS-Familie umfasst eine Vielzahl von Anbietern. Nur weil es sich um DOS handelt, bedeutet dies nicht, dass es auf einer 8086-CPU oder besser ausgef√ºhrt wird </li><li>  Einige dieser DOS-Anbieter sind API-kompatibel, was bedeutet, dass einige von ihnen Malware verwenden! </li></ul><br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/xr/et/uz/xretuzunpjloadbgzif-gsekqo4.jpeg" alt="Bild"><br><br>  <b>Leistungsvideo:</b> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xgS1M4e_9_E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=" title="EDISON Software - Webentwicklung"><img align="left" width="153" height="75" src="https://habrastorage.org/webt/w0/zl/to/w0zltoxvysbr0yeinstkfvw1wbg.png" alt="EDISON Software - Webentwicklung"></a> <br clear="right">  Der Beitrag wurde mit Unterst√ºtzung von EDISON Software verfasst, die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">eine Anwendung f√ºr einen virtuellen Mobilfunkbetreiber entwickelt</a> und sich mit der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Entwicklung und Wartung von Websites in Python befasst</a> . </blockquote><br><img src="https://habrastorage.org/getpro/habr/post_images/328/83d/c0d/32883dc0d675c3b77af3bfe1f550ebcc.png" alt="Bild"><br><br>  Tats√§chlich sind die meisten unserer Erinnerungen an die DOS-√Ñra die √Ñsthetik, wie Computer dieser Zeit aussahen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbf/8c9/ebd/fbf8c9ebdbfe3b6061d80745c60dc7e5.jpg" alt="Bild"><br><br>  Dies ist die √Ñra des ‚ÄûBeige Computing‚Äú und der Model M-Tastatur, die ber√ºhmt oder ber√ºchtigt sein kann, je nachdem, ob Sie die laute Tastatur m√∂gen oder nicht. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ef/c07/8a6/9efc078a6a2e5848807a3d2b3611096a.png" alt="Bild"><br><br>  Einige von uns haben m√∂glicherweise Erinnerungen an die Verwendung von DOS, andere verwenden m√∂glicherweise noch DOS! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a36/117/004/a36117004fac6d309590fe6cd6a81be0.png" alt="Bild"><br><br>  Zum Beispiel soll George R. Martin, der The Game of Thrones geschrieben hat, Wordstar in DOS verwendet haben, um ein Buch zu schreiben! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/796/730/bf8/796730bf815f1e8d6b47f7f464648017.png" alt="Bild"><br><br>  Wir k√∂nnen auch QBASIC nicht verpassen, f√ºr viele w√§re dies ihre erste Kenntnis der Programmierung! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca5/6cc/58a/ca56cc58aa88ca31d21e23e4e9d7e4e0.gif" alt="Bild"><br><br>  Aber manchmal war das Leben mit DOS nicht so gut, manchmal haben Sie DOS verwendet, und solche Dinge passierten pl√∂tzlich.  In diesem Beispiel wird w√§hrend des Druckvorgangs eine kleine Melodie abgespielt. Dies kann in einer B√ºroumgebung eine sehr unangenehme Situation sein. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf3/d02/d61/bf3d02d61b4ee6dd7a6d9bd3598e0942.gif" alt="Bild"><br><br>  Einige von ihnen sind ‚Äûs√º√üer‚Äú, in diesem Fall f√§hrt beispielsweise ein mit ASCII-Symbolen gezeichneter Krankenwagen vorbei, und dann startet das Programm, das Sie √∂ffnen m√∂chten, im schlimmsten Fall mit geringf√ºgigen Unannehmlichkeiten. <br><br>  Dank einer Reihe von Malware-Archivaren, die unter dem Namen VX Heavens laufen, haben wir ein gutes historisches DOS-Malware-Archiv, oder zumindest bis die ukrainische Polizei die Website √ºberf√§llt: <br><blockquote>  Am Freitag, dem 23. M√§rz, wurde der Server von der Polizei im Zusammenhang mit einer strafrechtlichen Untersuchung (Artikel 361-1 des Strafgesetzbuchs der Ukraine - Erstellung von Schadprogrammen zum Zweck des Verkaufs oder der Verbreitung von Schadprogrammen) auf Aufforderung einer Person beschlagnahmt.  √ºber "Platzieren von sch√§dlicher Software mit freiem Zugriff f√ºr unbefugtes Hacken von Computern, automatisierten Systemen und Computernetzwerken". </blockquote><br>  Gl√ºcklicherweise verf√ºgen beliebte Torrent-Sites immer noch √ºber Kopien der Site-Datenbank, die uns einen hervorragenden Datensatz liefern k√∂nnen: <br><br><pre><code class="plaintext hljs">$ tar -tvf viruses-20070914.tar | wc -l 66714 $ ls -alh viruses-20070914.tar 6.6G viruses-20070914.tar</code> </pre> <br>  Um diese Stichproben zu untersuchen, m√ºssen wir jedoch zun√§chst den typischen Verteilungsfluss dieser Stichproben verstehen, da diese Programme in der Zeit vor dem Internet funktionierten: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b9/968/2ad/8b99682ad85c8c3b236952ae835869aa.png" alt="Bild"><br><br>  Nachdem Sie die infizierte Datei auf Ihrem System erhalten und ausgef√ºhrt haben, sucht oder installiert das Schadprogramm aktiv nach Systemaufruf-Interceptors f√ºr die von Ihnen ausgef√ºhrten Programme.  Er tut dies oft auf subtile und unsichtbare Weise, um einer Entdeckung zu entgehen.  Die Wichtigkeit der Subtilit√§t ist wichtig, da Sie dieses Schadprogramm entweder mit einem Medium (Diskette) auf ein anderes System √ºbertragen oder auf einen anderen Verteilungspunkt wie BBS herunterladen m√ºssen, um dieses Schadprogramm zu verbreiten. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a8/bf9/57d/7a8bf957dcced5f67116861d7aa87460.png" alt="Bild"><br><br>  Zur Laufzeit hat die Malware zwei Optionen.  Es kann entweder verborgen bleiben und neue Dateien infizieren oder eine Nutzlast anzeigen. <br><br>  Einige Nutzlasten sind ziemlich h√ºbsch!  Im folgenden Beispiel werden ungew√∂hnliche Funktionen verwendet, z. B. 256 Farben: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f60/ca9/f79/f60ca9f7987b2e5204fb08a0fbf8c32e.gif" alt="Bild"><br><br>  Oder dieses, das mit Ihrem Bildschirmpuffer spielt: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b72/62e/c62/b7262ec62c4ef1c84e30a166db2801ed.gif" alt="Bild"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/898/f25/b51/898f25b5140151ecebe8494e39c6797d.png" alt="Bild"><br><br>  Zum gr√∂√üten Teil bleibt die Malware jedoch stumm und versucht, Dateien f√ºr eine Infektion zu finden.  Die Infektion der meisten Dateien ist sehr einfach, wenn Sie beispielsweise die COM-Datei als langes Band mit Maschinencode anzeigen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4eb/b47/cde/4ebb47cde9f6329fdaf04dd6c648056d.png" alt="Bild"><br><br>  Dann m√ºssen Sie nur noch JMP am Anfang des Programms einf√ºgen und am Ende des Programms Daten hinzuf√ºgen.  Es wird ungef√§hr so ‚Äã‚Äãaussehen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c6a/eee/16b/c6aeee16b8813e731be734b0c81bdb5d.png" alt="Bild"><br><br>  Einige Codes waren intelligenter und fanden ‚Äûleeren Speicherplatz‚Äú in der Bin√§rdatei und schrieben sich dort selbst, wodurch verhindert wurde, dass die Bin√§rdatei gr√∂√üer wurde, was m√∂glicherweise bedeutete, dass das Antivirenprogramm die rote Fahne verwenden konnte. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/898/f25/b51/898f25b5140151ecebe8494e39c6797d.png" alt="Bild"><br><br>  Zuvor erw√§hnte ich jedoch auch das Abfangen von Systemaufrufen.  Trotz der Tatsache, dass die MS-DOS-Laufzeit sehr einfach und praktisch ungesch√ºtzt ist (Sie k√∂nnen Linux trivial aus einer COM-Datei laden).  Es enth√§lt weiterhin die vollst√§ndige API, sodass Anwendungen keine eigene Dateisystemimplementierung ben√∂tigen.  Hier sind einige Syscalls-Funktionen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/503/b94/031/503b94031afdf70ab966327bb6a83ef5.png" alt="Bild"><br><br>  Sie verursachen einen Software-Interrupt, bei dem das Programm den Prozessor auffordert, in einen anderen Abschnitt des Systemspeichers zu wechseln, um etwas zu verarbeiten: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db8/424/17c/db842417cb90c6059bfeb0e92cf7bdf9.png" alt="Bild"><br><br>  MS-DOS bietet jedoch auch die M√∂glichkeit, diese Aufrufe hinzuzuf√ºgen / zu √§ndern (mithilfe eines anderen Aufrufs), sodass Sie das System erweitern k√∂nnen, damit neue Treiber zur Laufzeit geladen werden k√∂nnen.  Es ist jedoch auch ein idealer Ort, um Malware-Abschnitte hinzuzuf√ºgen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7e5/051/5f4/7e50515f49434bd39a96c29be41aa253.png" alt="Bild"><br><br>  Es war ein weit verbreiteter Trick, da Sie den Aufruf "Datei √∂ffnen" abfangen und ihn dann verwenden konnten, um neue ausf√ºhrbare Dateien im System zu erkennen ... und sie zu infizieren. <br><br>  Schauen wir uns als kurzes Beispiel f√ºr ihre Verwendung ein einfaches Hello World-Programm an: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/07e/ee5/abb/07eee5abbb7f150ad322aca95a1491b0.png" alt="Bild"><br><br>  Wie wir sehen k√∂nnen, gibt es zwei Aufrufe vom Typ <code>int</code> .  Wir verwenden <code>21h</code> (h = hex) als Rufnummer des Hauptsystems und k√∂nnen basierend auf dem Wert von <code>Ah</code> angeben, welche Aktion MS-DOS ausf√ºhren soll <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b3/e30/ea8/2b3e30ea8878b81233d5387df02d3cf5.png" alt="Bild"><br><br>  In diesem Fall ruft das Programm zum Drucken der Zeile auf und beendet das Programm mit dem R√ºckkehrcode 0 (undefiniert). <br><br>  Wie bereits erw√§hnt.  Wenn Sie int 21h aufrufen, sucht der Zentralprozessor in der IVT-Tabelle, wohin er gehen soll. In diesem Handler befindet sich h√§ufig ein Segment wie ein Router, der verschiedene Hauptaufrufe weiterleitet. Im Fall von Int 21h leitet er verschiedene Funktionen basierend auf dem Wert ah an.  Sobald wir an dem Ort angekommen sind, wird der eigentliche Anrufbearbeiter die Aufgabe erledigen, dann wird er iret ausf√ºhren, um zum Hauptprogramm zur√ºckzukehren, und h√§ufig Register der Ergebnisse des Anrufs hinterlassen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b22/a7c/b66/b22a7cb66a3449cb811537c121b96db2.gif" alt="Bild"><br><br>  Also  Wenn wir alle Systemaufrufe sehen m√∂chten, die das Programm gestartet hat, k√∂nnen wir am Anfang des Interrupt-Handlers einen Haltepunkt setzen und √ºberpr√ºfen, was ah ist: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/437/8a0/dab/4378a0dabeddb413b66d3985f7a07ae4.png" alt="Bild"><br><br>  Wir tun dies, weil sich der Interrupt-Handler in MS-DOS immer an einem festen Ort befindet (dies ist viel fr√ºher als in der ASLR- und Kernel-ASLR-√Ñra) und der Programmspeicherort nicht. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c56/630/3df/c566303dfe33c0822630fdd2a7e6e4e5.png" alt="Bild"><br><br>  Sobald wir es starten, k√∂nnen wir die Herausforderungen sehen, die dieses Muster mit sich bringt.  W√§hrend wir auf dem Bildschirm sehen k√∂nnen, dass er gerade eine Benachrichtigung √ºber die Ziegen-Datei gedruckt hat (Ziege ist eine Datei, die wie eine Opferziege infiziert werden soll).  Wir sehen auch, dass dieses Programm mehr als nur eine Zeile druckt.  Es √ºberpr√ºft die DOS-Version (wahrscheinlich um die Kompatibilit√§t zu √ºberpr√ºfen) und √∂ffnet, liest und schreibt Daten! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fc8/e68/30d/fc8e6830de63466825df85f1e98be417.png" alt="Bild"><br><br>  Das ist interessant!  Wir m√∂chten jedoch mehr √ºber die rot hervorgehobenen Systemaufrufe erfahren, da diese Eingaben enthalten m√ºssen, damit Dateinamen und Daten in Dateien geschrieben / auf den Bildschirm ausgegeben werden k√∂nnen. <br><br>  Dazu m√ºssen wir uns w√§hrend des Systemaufrufs andere Register ansehen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f55/e53/9a4/f55e539a4af8d544409dadf05f181005.png" alt="Bild"><br><br>  Am Beispiel von ‚ÄûPrint String‚Äú k√∂nnen wir sehen, wie die Verwendung aussieht: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/223/3cf/9f5/2233cf9f5a0fe096b71c9f7e38d81602.png" alt="Bild"><br><br>  Was ist DS: DX?  Warum gibt es hier zwei Register und wie erhalten wir Daten von ihnen? <br><br>  Dazu m√ºssen wir etwas mehr √ºber den 8086-Prozessor verstehen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e61/fc6/160/e61fc6160d49dcee4568635340b860dd.png" alt="Bild"><br><br>  Der 8086-Prozessor ist eine 16-Bit-CPU, jedoch mit 20-Bit-Speicheradressierung.  Dies bedeutet, dass der Prozessor nur Werte speichern kann, die 64 KB anzeigen. Dies ist ein Problem, wenn die Speicherkapazit√§t bis zu 1 MB betr√§gt. <br><br>  Um dies zu umgehen, m√ºssen wir die Segmentierungsregister verstehen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0d5/6e0/263/0d56e02639206a885d4899036a1bbf6e.png" alt="Bild"><br><br>  Der 8086-Prozessor verf√ºgt √ºber 4 Segmentierungsregister, um die wir uns k√ºmmern m√ºssen: <br><br><ul><li>  CS - Codesegment </li><li>  DS - Datensegment </li><li>  SS - Stapelsegment </li><li>  ES - ein zus√§tzliches Segment (falls Sie noch eines ben√∂tigen, um verschiedene Situationen zu umgehen) </li></ul><br>  Es gibt eine Reihe anderer Universalregister, die Sie vor √ºberm√§√üiger Speichernutzung bewahren und es Ihnen erm√∂glichen, Parameter an andere Funktionen zu √ºbergeben. <br>  Die Segmentierung registriert die Arbeit durch √Ñndern des Blocks im RAM: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5cd/ff2/bca/5cdff2bca72f3d038fb3830bb38ff6c2.gif" alt="Bild"><br><br>  Dadurch kann die 16-Bit-CPU alle 20 RAM-Bits sehen und sicherstellen, dass der Block f√ºr jeden DS-Wert um 16 Byte versetzt ist. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/84a/9d8/7be/84a9d87be1242165bd3aa45cd06c6039.png" alt="Bild"><br><br>  In diesem Fall wird der DS-Aufruf als Zeiger innerhalb des 16-Bit-Fensters verwendet, um festzustellen, wo sich der Zeilenanfang befindet.  Dann scannt der Zeilendrucker, bis er das Zeichen $ findet, und stoppt dann.  Dies √§hnelt anderen Systemen, die Null-Bytes anstelle von $ verwenden. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4e2/5a9/f0b/4e25a9f0b1b0d7cfaab1d6795eaaf6ed.gif" alt="Bild"><br><br>  Mit dem Alter von ISA x86 hat sich wenig ge√§ndert. Statt der Tatsache, dass die Prozessorbitgr√∂√üe zugenommen hat, sind dieselben Register breiter geworden. <br><br>  Mit diesem Wissen k√∂nnen wir eine Liste von ‚ÄûAufgaben‚Äú erstellen, um diese Programme zu verfolgen: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/832/a32/910/832a329105d030ee51a56a372d671302.png" alt="Bild"><br><br>  Mit dieser Einstellung k√∂nnen wir mehrere gro√üe Computer f√ºr mehrere Stunden auf das Problem werfen und die Ergebnisse sammeln! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ddd/6c3/5c2/ddd6c35c2e4bab73fd088dde763ee470.png" alt="Bild"><br><br>  Und wir bekommen ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f4/3b4/0f9/1f43b40f9e7f8b1bffff55bc8fc6ab70.png" alt="Bild"><br><br>  Nichts dergleichen. <br><br>  Das ist entt√§uschend. <br><br>  Wir haben mindestens einen Hamster mit Kraft verbrannt und fast keine coolen Aktivierungen bekommen!  <i>(Xs wie man das √ºbersetzt)</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d69/69d/be2/d6969dbe2ff5f0c7629b1f9e594e6c3a.png" alt="Bild"><br><br>  Wenn wir uns einige Beispiele ansehen, sehen wir hier eine rauchende Waffe.  Ein anst√§ndiges St√ºck pr√ºft Datum und Uhrzeit. <br><br>  Wenn wir uns die Dokumentation f√ºr diese Aufrufe ansehen, werden wir sehen, dass der Systemaufruf Werte in Form von Registern f√ºr das Programm zur√ºckgibt: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/265/186/a75/265186a7562b336b45e194bf82e3b02a.png" alt="Bild"><br><br>  Also k√∂nnen wir sie brutal zwingen!  Alles was wir tun m√ºssen ist so etwas: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0aa/556/5fe/0aa5565fe29e9008f8607305f53bf28b.png" alt="Bild"><br><br>  Bei dieser Methode gibt es jedoch ein Problem. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce5/bf3/7b6/ce5bf37b6d1c0aaccbed58e064c4ece5.png" alt="Bild"><br><br>  Der Testschritt des Beispiels dauert ungef√§hr 15 Sekunden, da der vollst√§ndige QEMU-Emulationsprozess verwendet wird, und es kann bis zu 15 Sekunden dauern, bis das Programm vollst√§ndig in der virtuellen Maschine ausgef√ºhrt wird.  Da DOS keine Energiesparfunktionen hat, bedeutet dies, dass sich DOS im Standby-Modus in einem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Besetztzyklus befindet</a> <br><br>  Wir k√∂nnten dieses Problem also anders betrachten, indem wir uns ansehen, welcher Code nach der Datums- / Zeitanforderung ausgef√ºhrt wird. <br><br>  Da sich unser Tracer im Interrupt-Handler befindet, wissen wir aus der Box nicht, wo sich das Programm befindet: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/435/1eb/4cf/4351eb4cfd0effcf312e0f8154e5a29b.png" alt="Bild"><br><br>  Dazu m√ºssen wir uns den Stapel ansehen, in dem die CS- und IP-Register auf uns warten! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0f8/a73/a94/0f8a73a9432e23d64675fefd7f504e5e.png" alt="Bild"><br><br>  Sobald wir diese beiden Register vom Stapel genommen haben, k√∂nnen wir sie verwenden, um den R√ºckkehrcode abzurufen, sodass unsere Checkliste folgenderma√üen aussieht: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/837/d44/cdf/837d44cdf7fbb940b4428cd2e2871f54.png" alt="Bild"><br><br>  Nachdem wir dies getan und den Datensatz wiederholt getestet haben, werden wir sehen, wie ein Teil des R√ºckkehrcodes aussieht! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/45a/ee0/71e/45aee071eb023929029044227939d0d7.png" alt="Bild"><br><br>  Hier ist ein Beispiel von einem.  Hier sehen wir, dass ein Vergleich f√ºr DL und 0x1e durchgef√ºhrt wird. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/265/186/a75/265186a7562b336b45e194bf82e3b02a.png" alt="Bild"><br><br>  Wenn wir uns unsere Dokumentation ansehen, werden wir sehen, dass DL der Tag des Monats ist, dh wir k√∂nnen die drei wichtigsten Operationscodes wie folgt analysieren: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4fc/12f/220/4fc12f220ff2d17566087e726398e728.png" alt="Bild"><br><br>  Wir k√∂nnten das alles manuell durchsehen, aber es gibt viele dieser Beispiele, die die Zeit √ºberpr√ºfen, etwa 4700: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b1/25f/720/1b125f720508620f525c3d3535ca8cbb.png" alt="Bild"><br><br>  Also m√ºssen wir stattdessen etwas anderes tun.  Wir m√ºssen etwas schreiben ... Wir m√ºssen schreiben ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/22c/383/5a1/22c3835a1387f950080cee18fb0da8ef.png" alt="Bild"><br><br>  Der schlechteste x86-Emulator der Welt, BenX86, ist ein Emulator, der speziell f√ºr unsere Anforderungen entwickelt wurde, und nicht mehr: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/561/58b/66c/56158b66ca09d37e7dc64194df98d623.png" alt="Bild"><br><br>  Aber er hat einige Vorteile in seiner Geschwindigkeit. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d05/4e9/540/d054e954038188ec32e684b3a6ccad95.png" alt="Bild"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/77c/1e8/dd6/77c1e8dd6527f6105236b2e5b6d61fa0.png" alt="Bild"><br><br>  Wir haben 10.000 verschiedene Ausf√ºhrungstests hinzugef√ºgt, basierend auf den Pfaden, die wir mit Brute Force mit BenX86 gefunden haben.  Also werde ich mit einigen meiner Lieblingsentdeckungen enden, die zeitaktiviert sind: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b9/308/b5d/1b9308b5d968a59433bff7c9448e1ed2.gif" alt="Bild"><br><br>  Dieses Muster wird am Neujahrstag aktiviert und legt Ihr System auf, nachdem eine Begr√º√üung angezeigt wurde.  Es kann gut sein, wenn Sie f√ºr das neue Jahr im B√ºro festsitzen, oder es kann schlecht sein, wenn Sie am Neujahrstag wirklich etwas tun m√ºssen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/40d/b3a/0be/40db3a0be86fb2dd6891c9836001343b.png" alt="Bild"><br><br>  Dieses Beispiel hat mich sehr √ºberrascht.  Es wird Anfang 1995 aktiviert und informiert den Benutzer √ºber alle infizierten Dateien, die es infiziert hat, entfernt dann den Virus (l√∂scht den √úbergang zu Beginn) und unternimmt dann nichts anderes.  Obwohl aus irgendeinem Grund angegeben wird, dass Sie McAfee kaufen sollten, ist diese Nachricht offensichtlich nicht veraltet. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/201/094/384/20109438477e51765809aa938551d027.png" alt="Bild"><br><br>  Das verwirrt mich ehrlich gesagt wirklich, am 8. November eines jeden Jahres werden alle Nullen im System in winzige Glyphen des ‚ÄûHasses‚Äú verwandelt.  Es st√∂rt mich wirklich, wenn Sie wissen, warum Sie es brauchen, lassen Sie es mich wissen ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/802/2ba/081/8022ba0819bf2177c6a856a626fb4976.gif" alt="Bild"><br><br>  Dies ist wahrscheinlich mein Albtraum, wenn nach dem Starten eines Programms die Meldung angezeigt wird, dass sie Ihr Hauptlaufwerk nicht essen konnte.  Es w√§re unglaublich beunruhigend, aus heiterem Himmel zu sehen. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/381/f69/768/381f697681914f2412955bb3c73d46a0.png" alt="Bild"><br><br>  Zusammenfassend haben wir die Navy Seal Copypasta-Version von DOS-Malware.  Ich bin mir nicht sicher, ob dieser Autor Aladdin nicht mag, aber was auch immer Sie tun, Sie sind eine Person. <br><br>  Wenn Sie an dem Code interessiert sind, der in diesem Artikel ausgef√ºhrt wurde, habe ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mein Toolkit auf github</a> ohne Garantie ver√∂ffentlicht.  Wenn Sie diesen Code selbst erstellen m√∂chten, m√ºssen Sie sicherstellen, dass er mit Ihrer MS-DOS-Installation funktioniert (Behebung eines Handler-Haltepunkts). <br><br>  Wenn Sie jedoch nur sehen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">m√∂chten,</a> was ich beim Betrachten dieses Projekts gesehen habe, habe ich die Weboberfl√§che hier archiviert: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">dosv.benjojo.co.uk</a> <br><br>  Bis bald! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de440086/">https://habr.com/ru/post/de440086/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de440072/index.html">AresDB-Demo: Uber GPU-basiertes Open Source-Echtzeitanalysetool</a></li>
<li><a href="../de440074/index.html">Roskomos h√§lt es f√ºr falsch, die Raptor-Motoren Ilona Mask und RD-180 zu vergleichen</a></li>
<li><a href="../de440076/index.html">√úbersetzung und Interpretation von Werbung aus dem Englischen ins Russische</a></li>
<li><a href="../de440078/index.html">Schnelles Compiler-Ger√§t. Teil 4</a></li>
<li><a href="../de440084/index.html">10 Milliarden Softwareexporte sind vernachl√§ssigbar</a></li>
<li><a href="../de440088/index.html">bobaflu - Programmierzubeh√∂r auf Flattern</a></li>
<li><a href="../de440090/index.html">Wie funktionieren technische Indikatoren an der B√∂rse tats√§chlich?</a></li>
<li><a href="../de440092/index.html">Eine mathematische Untersuchung dar√ºber, wie gef√§lschte Gouverneurwahlen in Primorje am 16. September 2018 vorget√§uscht wurden</a></li>
<li><a href="../de440094/index.html">Bl√ºhende G√§rten auf dem Mars bleiben ein Traum: Das Mars One-Projekt ging bankrott</a></li>
<li><a href="../de440096/index.html">RunC-Sicherheitsl√ºcke, die Kubernetes, Docker und Containerd betrifft</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>