<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍴 💪🏾 🔒 AI à Hase und Igel: minimax pour trois 🐟 🧣 🏴‍☠️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Après le véritable boom des jeux de société de la fin des années 2000, la famille a laissé plusieurs boîtes avec des jeux. L'un d'eux est le jeu "Hare...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>AI à Hase und Igel: minimax pour trois</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/432382/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/in/z2/ng/inz2ngydxteyo76jh1r9du9oxx8.jpeg"></div><br>  Après le véritable boom des jeux de société de la fin des années 2000, la famille a laissé plusieurs boîtes avec des jeux.  L'un d'eux est le jeu "Hare and Hedgehog" dans la version allemande originale.  Un jeu pour plusieurs joueurs, dans lequel l’élément aléatoire est minimisé, et le calcul sobre et la capacité du joueur à «regarder en avant» en plusieurs étapes l'emportent. <br><br>  Mes fréquentes défaites dans le jeu m'ont amené à écrire «intelligence» informatique pour choisir le meilleur coup.  Intelligence, idéalement capable de combattre le grand maître du lièvre et du hérisson (et quoi, le thé, pas les échecs, le jeu sera plus facile).  Le reste de l'article décrit le processus de développement, la logique de l'IA et un lien vers la source. <br><a name="habracut"></a><br><h1>  Règles du jeu Hare and Hedgehog </h1><br>  Sur le terrain de jeu de 65 cellules, il y a plusieurs jetons de joueur, de 2 à 6 participants (mon dessin, non canonique, regarde, bien sûr, moyen): <br><br><img src="https://habrastorage.org/webt/rf/8w/8x/rf8w8xapxkminuwc_r78qrwlr_c.png"><br><br>  Hormis les cellules d'indices 0 (début) et 64 (arrivée), un seul joueur peut être placé dans chacune des cellules.  Le but de chaque joueur est d'avancer vers la cellule d'arrivée, devant ses rivaux. <br><br>  Le «carburant» pour aller de l'avant est la carotte - la « <b>monnaie</b> » du jeu.  Au début, chaque joueur reçoit 68 carottes, qu'il donne (et reçoit parfois) à mesure qu'il se déplace. <br><br>  En plus des carottes, au début, le joueur reçoit 3 cartes à salade.  La salade est un «artefact» spécial dont un joueur doit <b>se débarrasser</b> avant l'arrivée.  Se débarrasser de la laitue (et cela ne peut être fait que sur une cage à laitue spéciale, comme ceci: <br><img src="https://habrastorage.org/webt/yk/ie/c9/ykiec9ojz0bdaawaedp8yo2lsy4.png" align="left"><br>  ), le joueur, notamment, reçoit des carottes supplémentaires.  Avant cela, sautez votre mouvement.  Plus il y a de joueurs devant la salade quittant la carte, plus ce joueur recevra de carottes: 10 x (la position du joueur sur le terrain par rapport aux autres joueurs).  Autrement dit, le joueur debout sur le terrain en deuxième recevra 20 carottes, quittant la cage de la salade. <br><br>  Les cellules avec les numéros 1 à 4 peuvent apporter plusieurs dizaines de carottes si la position du joueur correspond au numéro sur la cellule (1 à 4, la cellule avec le numéro 1 convient également pour les 4e et 6e positions sur le terrain), par analogie avec la cellule de laitue. <br><br>  Le joueur peut sauter le mouvement, en restant sur la cage avec l'image des carottes et recevoir ou donner 10 carottes pour cette action.  Pourquoi un joueur devrait-il donner du «carburant»?  Le fait est qu'un joueur ne peut finir que 10 carottes après son dernier coup (20 si vous finissez deuxième, 30 si vous terminez troisième, etc.). <br><br>  Enfin, le joueur peut obtenir 10 x N carottes en faisant N pas sur le hérisson <b>libre</b> le <b>plus proche</b> (si le hérisson le plus proche est occupé, un tel mouvement est impossible). <br><br>  Le coût pour aller de l'avant est calculé non proportionnellement au nombre de mouvements, selon la formule (avec arrondi): <br><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6">c</span><span class="MJXp-mrow" id="MJXp-Span-7"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8">N</span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-10"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11" style="margin-right: 0.05em;">N</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-12" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-13"><span class="MJXp-mn" id="MJXp-Span-14">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.388ex" height="2.78ex" viewBox="0 -935.7 6194.9 1197.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-63" x="1781" y="0"></use><g transform="translate(2215,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-4E" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2B" x="1110" y="0"></use><g transform="translate(2111,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-32" x="1292" y="513"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-32" x="5694" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ frac {N + N ^ 2} {2} </script>  , <br>  où N est le nombre de pas en avant. <br><br>  Ainsi, pour avancer d'une cellule, le joueur donne 1 carotte, 3 carottes pour 2 cellules, 6 carottes pour 3 cellules, 10 pour 4, ..., 210 carottes pour faire avancer 20 cellules. <br><br>  La dernière cellule - la cellule avec l'image d'un lièvre - introduit un élément de hasard dans le jeu.  Après s'être tenu sur une cage avec un lièvre, le joueur pioche une carte spéciale de la pile, après quoi une action est effectuée.  Selon la carte et la situation du jeu, le joueur peut perdre des carottes, obtenir des carottes supplémentaires ou sauter un tour.  Il convient de noter que parmi les cartes avec des «effets», il existe plusieurs autres scénarios négatifs pour le joueur, ce qui encourage le jeu à être prudent et calculé. <br><br><h2>  <font color="#3050ff">Mise en œuvre sans IA</font> </h2><br>  Dans la toute première implémentation, qui deviendra ensuite la base du développement du jeu «intellect», je me suis limité à l'option dans laquelle chaque joueur fait un pas - une personne. <br><br>  J'ai décidé d'implémenter le jeu en tant que client - un site Web statique d'une page, dont toute la «logique» est implémentée sur le JS et le serveur - l'application API WEB.  Le serveur est écrit en .NET Core 2.1 et produit un artefact d'assemblage - un fichier dll, qui peut être exécuté sous Windows / Linux / Mac OS. <br><br>  La «logique» de la partie client est minimisée (ainsi que l'UX, puisque l'interface graphique est purement utilitaire).  Par exemple, le client Web n'effectue pas lui-même la vérification pour voir si les règles demandées par le joueur sont acceptables.  Cette vérification est effectuée sur le serveur.  Le serveur indique au client les mouvements que le joueur peut effectuer à partir de la position de jeu actuelle. <br><br>  Le serveur est une <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">machine Moore</a> classique.  La logique du serveur manque de concepts tels que «client connecté», «session de jeu», etc. <br><br>  Le serveur ne fait que traiter la commande reçue (HTTP POST).  Le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">modèle de «commande» est</a> implémenté sur le serveur.  Le client peut demander l'exécution de l'une des commandes suivantes: <br><br><ul><li>  commencer un nouveau jeu, c'est-à-dire  "Placer" les jetons du nombre spécifié de joueurs sur un plateau "propre" </li><li>  effectuer le mouvement indiqué dans la commande </li></ul><br>  Pour la deuxième équipe, le client envoie au serveur la position de jeu actuelle (objet de la classe Disposition), c'est-à-dire une description du formulaire suivant: <br><br><ul><li>  position, nombre de carottes et de laitue pour chaque lièvre, plus un champ booléen supplémentaire indiquant que le lièvre manque son tour </li><li>  indice du lièvre en mouvement. </li></ul><br>  Le serveur n'a pas besoin d'envoyer d'informations supplémentaires - par exemple, des informations sur le terrain de jeu.  Tout comme pour l'enregistrement d'un croquis d'échecs, il n'est pas nécessaire de peindre la disposition des cellules noires et blanches sur le tableau - cette information est considérée comme une constante. <br><br>  En réponse, le serveur indique si la commande s'est terminée avec succès.  Techniquement, un client peut, par exemple, demander un déplacement invalide.  Ou essayez de créer un nouveau jeu pour un seul participant, ce qui n'a évidemment aucun sens. <br><br>  Si l'équipe réussit, la réponse contiendra une nouvelle <b>position de</b> jeu, ainsi qu'une liste de mouvements pouvant être effectués par le joueur suivant dans la ligne (en cours pour la nouvelle position). <br><br>  En plus de cela, la réponse du serveur contient certains champs de service.  Par exemple, le texte d'une carte de lièvre «retiré» par un joueur à un pas sur la cellule correspondante. <br><br><h4>  Tour du joueur </h4><br>  Le tour du joueur est codé comme un entier: <br><br><ol><li>  0, si le joueur est obligé de rester dans la cellule actuelle, <br>  1, 2, ... N pour 1, ... N avance, </li><li>  -1, -2, ... -M pour déplacer 1 ... M cellules vers le hérisson libre le plus proche, </li><li>  1001, 1002 - codes spéciaux pour un joueur qui décide de rester sur la cellule de carotte et de recevoir (1001) ou de donner (1002) 10 carottes pour cela. </li></ol><br><h3>  Implémentation logicielle </h3><br>  Le serveur reçoit le JSON de la commande demandée, l’analyse dans l’une des classes de demande correspondantes et exécute l’action demandée. <br><br>  Si le client (joueur) a demandé de se déplacer avec le code CMD de la position (POS) transférée à l'équipe, le serveur effectue les actions suivantes: <br><br><ul><li>  vérifie si un tel mouvement est possible </li><li>  crée une nouvelle position à partir de la position actuelle, en y appliquant les modifications correspondantes, <br>  obtient de nombreux mouvements possibles pour une nouvelle position.  Permettez-moi de vous rappeler que l'index du joueur effectuant le mouvement est déjà inclus dans l'objet qui décrit la <abbr title="État spécifique, alignement des forces, «instantané» du jeu">position</abbr> , </li><li>  renvoie au client une réponse avec une nouvelle position, des mouvements possibles ou le drapeau de réussite égal à faux, et une description de l'erreur. </li></ul><br>  La logique de vérification de l'admissibilité du déménagement demandé (CMD) et de construction d'une nouvelle position s'est avérée un peu plus proche que nous le souhaiterions.  Avec cette logique, la méthode pour trouver des mouvements acceptables a quelque chose en commun.  Toutes ces fonctionnalités sont implémentées par la classe TurnChecker. <br><br>  A l'entrée des méthodes check / execute, TurnChecker reçoit un objet de la classe de la position de jeu (Disposition).  L'objet Disposition contient un tableau de données de joueur (Haze [] Hazes), l'index du joueur effectuant le mouvement + quelques informations de service qui sont remplies pendant le fonctionnement de l'objet TurnChecker. <br><br>  Le terrain de jeu décrit la classe FieldMap, qui est implémentée en tant que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">singleton</a> .  La classe contient un tableau de cellules + quelques informations supplémentaires utilisées pour simplifier / accélérer les calculs ultérieurs. <br><br><div class="spoiler">  <b class="spoiler_title">Considérations sur les performances</b> <div class="spoiler_text">  Dans l'implémentation de la classe TurnChecker, j'ai essayé d'éviter autant que possible les boucles.  Le fait est que les méthodes d'obtention de l'ensemble des mouvements / exécution autorisés d'un mouvement seront par la suite appelées des milliers (dizaines de milliers) fois au cours de la procédure de recherche d'un mouvement quasi optimal. <br><br>  Ainsi, par exemple, je calcule le nombre de cellules qu'un joueur peut utiliser avec N carottes, en utilisant la formule: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)Math.Pow(<span class="hljs-number"><span class="hljs-number">8</span></span> * N + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0.5</span></span>) - <span class="hljs-number"><span class="hljs-number">1</span></span>) / <span class="hljs-number"><span class="hljs-number">2</span></span>;</code> </pre> <br>  En vérifiant si la cellule i est occupée par l'un des joueurs, je ne passe pas par la liste des joueurs (car cette action devra probablement être effectuée plusieurs fois), mais je me tourne vers le dictionnaire du formulaire <i>[cell_index, busy_cell_ flag]</i> rempli à l'avance. <br><br>  Lorsque je vérifie si la cellule hérisson spécifiée est la plus proche (derrière) de la cellule actuelle occupée par le joueur, je compare également la position demandée avec une valeur d'un dictionnaire de la forme <i>[index_cellulaire, index_herisson le plus proche]</i> - informations statiques. <br></div></div><br><h2>  <font color="#3050ff">Implémentation avec l'IA</font> </h2><br>  Une commande est ajoutée à la liste des commandes traitées par le serveur: exécuter un déplacement quasi optimal sélectionné par le programme.  Cette équipe est une petite modification de la commande «Déplacement du joueur», dont, en fait, le champ de déplacement ( <abbr title="Le code numérique de la commande, par exemple, 4 pour avancer de 4 cellules, 0 pour attendre, 1002 - donner 10 carottes ...">CMD</abbr> ) a été supprimé. <br><br>  La première décision qui vient à l'esprit est d'utiliser l'heuristique pour sélectionner le «meilleur coup» possible.  Par analogie avec les échecs, nous pouvons évaluer chacune des positions de jeu obtenues avec notre coup en fixant une sorte de note pour cette position. <br><br><h3>  Évaluation de position heuristique </h3><br>  Par exemple, aux échecs, faire une évaluation (sans ramper dans la nature des ouvertures) est assez simple: au minimum, vous pouvez calculer le «coût» total des pièces en prenant la valeur de chevalier / évêque pour 3 pions, la valeur d'une tour à 5 pions, la reine à 9 et le roi à <i>int Pions MaxValue</i> .  Il est facile d'améliorer l'estimation, par exemple en y ajoutant (avec un facteur de correction - facteur / exposant ou autre fonction): <br><br><ul><li>  le nombre de mouvements possibles depuis la position actuelle, </li><li>  rapport des menaces aux figures ennemies / menaces de l'ennemi. </li></ul><br>  Une évaluation spéciale est donnée à la position du tapis: <i>int.MaxValue</i> , si le mat est placé sur l'ordinateur, <i>int.MinValue</i> si le mat a mis la personne. <br><br>  Si vous ordonnez au processeur d'échecs de choisir le coup suivant, guidé uniquement par une telle évaluation, le processeur ne choisira probablement pas les pires coups.  En particulier: <br><br><ul><li>  Ne manquez pas l'occasion de prendre un plus gros morceau ou un échec et mat, </li><li>  très probablement, il ne conduira pas les chiffres dans les coins, </li><li>  Cela ne remet pas le chiffre en cause (compte tenu du nombre de menaces dans l'évaluation). </li></ul><br>  Bien sûr, de tels mouvements de l'ordinateur ne lui laisseront aucune chance de succès avec un adversaire qui fait ses mouvements dans le moindre sens.  L'ordinateur ignorera toutes les fiches.  De plus, il n'hésite sans doute même pas à échanger la reine contre un pion. <br><br>  Néanmoins, l'algorithme d'évaluation heuristique de la position de jeu actuelle aux échecs (sans revendiquer les lauriers du programme champion) est assez transparent.  Vous ne pouvez pas dire sur le jeu Hare and Hedgehog. <br><br>  Dans le cas général, dans le jeu le Lièvre et le Hérisson, une maxime plutôt floue fonctionne: « <b><i>il vaut mieux aller plus loin avec plus de carottes et moins de laitue</i></b> ».  Cependant, tout n'est pas si simple.  Disons que si un joueur a 1 carte à salade au milieu de la partie, cette option peut être assez bonne.  Mais le joueur debout sur la ligne d'arrivée avec une carte à salade sera évidemment en situation de perte.  En plus de l'algorithme d'évaluation, je voudrais également avoir la possibilité de «jeter un œil» un peu plus loin, tout comme les menaces pesant sur les pièces peuvent être comptées dans une évaluation heuristique d'une position d'échecs.  Par exemple, il convient de considérer le bonus de carottes reçues par un joueur quittant la cellule de laitue / cellule de position (1 ... 4), en tenant compte du nombre de joueurs devant. <br><br>  J'ai déduit la note finale en fonction: <br><br>  <abbr title="E (stimulation), note finale">E</abbr> = Ks * S + Kc * C + Kp * P, <br><br>  où S, C, P sont des notes calculées en utilisant des cartes à salade (S) et des carottes © dans les mains du joueur, P est les notes données au joueur pour la distance parcourue. <br><br>  Ks, Kc, Kp sont les facteurs de correction correspondants (ils seront discutés plus loin). <br><br>  Le moyen le plus simple est de déterminer la marque <b>du chemin parcouru</b> : <br>  P = i * 3, où i est l'indice de la cellule sur laquelle se trouve le joueur. <br><br>  Le classement C (carottes) est déjà plus difficile. <br><br>  Pour obtenir une valeur C spécifique, je choisis l'une des 3 fonctions <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-15"><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-18" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-19" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-20"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-22" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-23" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-24"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25" style="margin-right: 0.05em;">C</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-26" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.216ex" height="2.419ex" viewBox="0 -780.1 4398.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-30" x="1011" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2C" x="1169" y="0"></use><g transform="translate(1614,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-31" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2C" x="2783" y="0"></use><g transform="translate(3229,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-32" x="1011" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-2"> C_0, C_1, C_2 </script>  à partir d'un argument (le nombre de carottes sur les mains).  L'indice de la fonction C ([0, 1, 2]) est déterminé par la position relative du joueur sur le terrain de jeu: <br><br><ul><li>  [0] si le joueur a terminé moins de la moitié du terrain de jeu, </li><li>  [2] si un joueur a assez de carottes (mb, voire abondantes) pour finir, </li><li>  [1] dans les autres cas. </li></ul><br><img src="https://habrastorage.org/webt/fo/cv/hr/focvhrlzpl_xuxxd8dmuw9atok8.png"><br><br>  Les fonctions 0 et 1 sont similaires: la «valeur» de chaque carotte dans les mains du joueur diminue progressivement avec l'augmentation du nombre de carottes dans les mains.  Le jeu encourage rarement les Plyushkins.  Dans le cas 1 (la moitié du champ est passée), la valeur des carottes diminue un peu plus vite. <br><br>  La fonction 2 (le joueur peut terminer), au contraire, impose une grande amende (valeur de coefficient négative) à chaque carotte dans les mains du joueur - plus il y a de carottes, plus le coefficient de pénalité est élevé.  Puisqu'avec un excès de carottes la finition est interdite par les règles du jeu. <br><br>  Avant de calculer la quantité de carottes sur les mains du joueur est spécifié en tenant compte des carottes par coup de la cellule de laitue / cellule numéro 1 ... 4. <br><br>  Une catégorie « <b>laitue</b> » S est déduite de la même manière.  En fonction de la quantité de salade sur les mains du joueur (0 ... 3), une fonction est sélectionnée <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-msubsup" id="MJXp-Span-28"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-30" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-31" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-34" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-36"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-38" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.505ex" height="2.419ex" viewBox="0 -780.1 4092.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-30" x="867" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2C" x="1067" y="0"></use><g transform="translate(1512,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-31" x="867" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2C" x="2579" y="0"></use><g transform="translate(3025,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-32" x="867" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-3"> S_0, S_1, S_2 </script>  ou <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-39"><span class="MJXp-msubsup" id="MJXp-Span-40"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-42" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.479ex" height="2.419ex" viewBox="0 -780.1 1067.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-33" x="867" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> S_3 </script>  .  Argument de fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-43"><span class="MJXp-msubsup" id="MJXp-Span-44"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-46" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-47" style="margin-left: 0.267em; margin-right: 0.267em;">−</span><span class="MJXp-msubsup" id="MJXp-Span-48"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-50" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.799ex" height="2.419ex" viewBox="0 -780.1 3357.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-30" x="867" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2212" x="1289" y="0"></use><g transform="translate(2290,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-33" x="867" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-5"> S_0 - S_3 </script>  .  - encore une fois, le chemin «relatif» parcouru par le joueur.  A savoir, le nombre de cellules avec salade restant devant (par rapport à la cellule occupée par le joueur): <br><br><img src="https://habrastorage.org/webt/91/as/ra/91asraqadihe0n0dgtruyw1efuc.png"><br><br>  La courbe <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-51"><span class="MJXp-msubsup" id="MJXp-Span-52"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-54" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.479ex" height="2.419ex" viewBox="0 -780.1 1067.4 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-30" x="867" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> S_0 </script>  - fonction d'évaluation (S) sur le nombre de cellules de laitue devant le joueur (0 ... 5), pour un joueur avec 0 carte de laitue en main, <br>  la courbe <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-55"><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;">S</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-58" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.479ex" height="2.298ex" viewBox="0 -780.1 1067.4 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-31" x="867" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> S_1 </script>  - la même fonction pour un joueur avec une carte de salade en main, etc. <br><br>  La note finale (E = Ks * S + Kc * C + Kp * P) prend ainsi en compte: <br><br><ul><li>  la quantité supplémentaire de carottes que le joueur recevra immédiatement avant son propre mouvement, </li><li>  le chemin du joueur </li><li>  la quantité de carottes et de laitue sur les mains qui affectent de façon non linéaire le score. </li></ul><br>  Et voici comment un ordinateur joue, en choisissant le prochain coup avec le score heuristique maximum: <br><br><img src="https://habrastorage.org/webt/nz/ze/4g/nzze4g5o3vbfug20cspijmdmnlg.gif"><br><br>  En principe, les débuts ne sont pas si mauvais.  Cependant, il ne faut pas s'attendre à un bon jeu d'une telle IA: au milieu du jeu, le «robot» vert commence à faire des mouvements répétés, et à la fin il fait plusieurs itérations de mouvements en avant - en arrière vers le hérisson, jusqu'à ce qu'il finisse finalement.  En partie à cause du hasard, il finira derrière le joueur - une personne par une douzaine de coups. <br><br><div class="spoiler">  <b class="spoiler_title">Notes de mise en œuvre</b> <div class="spoiler_text">  Le calcul de l'évaluation est géré par une classe spéciale - EstimationCalculator.  Les fonctions d'évaluation de la position par rapport aux cartes carotte-salade sont chargées dans des tableaux dans le constructeur <b>statique</b> de la classe de calculatrice.  En entrée, la méthode d'estimation de position reçoit l'objet de position lui-même et l'index du joueur, du «point de vue» dont la position est évaluée par l'algorithme.  Autrement dit, la même position de jeu peut recevoir plusieurs notes différentes, selon le joueur pour lequel les points virtuels sont pris en compte. <br></div></div><br><h2>  <font color="#3050ff">Arbre de décision et algorithme Minimax</font> </h2><br>  Nous utilisons l'algorithme de prise de décision dans le jeu antagoniste Minimax.  Très bien, à mon avis, l'algorithme est décrit dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ce post (traduction)</a> . <br><br>  Nous enseignons au programme à «regarder» quelques pas en avant.  Supposons que, à partir de la position actuelle (et l'arrière-plan n'est pas important pour l'algorithme - comme nous nous en souvenons, le programme fonctionne comme <abbr title="L'algorithme n'a pas «d'état interne»">une machine Moore</abbr> ), numéroté par le numéro 1, le programme peut effectuer deux mouvements.  Nous obtenons deux positions possibles, 2 et 3. Vient ensuite le tour du joueur - la personne (dans le cas général - l'ennemi).  À partir de la 2e position, l'adversaire a 3 coups, de la troisième - seulement deux coups.  Ensuite, le tour de recommencer revient au programme qui, au total, peut effectuer 10 mouvements à partir de 5 positions possibles: <br><br><img src="https://habrastorage.org/webt/j8/1p/yf/j81pyfcci31ot27y3xgfafiuqc4.gif"><br><br>  Supposons que, après le deuxième mouvement de l'ordinateur, le jeu se termine et chacune des positions reçues est évaluée du point de vue des premier et deuxième joueurs.  Et nous avons déjà implémenté l'algorithme d'évaluation.  Évaluons chacune des positions finales (feuilles de l'arbre 9 ... 18) sous la forme d'un vecteur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">v</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-64" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66" style="margin-right: 0.05em;">v</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-68" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.691ex" height="2.66ex" viewBox="0 -832 2881 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-30" x="686" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2C" x="1217" y="0"></use><g transform="translate(1663,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-31" x="686" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-5D" x="2602" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> [v_0, v_1] </script>  , <br>  où <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-69"><span class="MJXp-msubsup" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71" style="margin-right: 0.05em;">v</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-72" style="vertical-align: -0.4em;">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.182ex" height="1.817ex" viewBox="0 -520.7 939.4 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-30" x="686" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> v_0 </script>  - score calculé pour le premier joueur, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-73"><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;">v</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-76" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.182ex" height="1.696ex" viewBox="0 -520.7 939.4 730.2" role="img" focusable="false" style="vertical-align: -0.487ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-31" x="686" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> v_1 </script>  - score du deuxième joueur: <br><br><img src="https://habrastorage.org/webt/xk/g5/yw/xkg5ywgzotdosiz4e4soubsrava.png"><br><br>  Puisque l'ordinateur fait le dernier pas, il choisira évidemment les options dans chacun des sous-arbres ([9, 10], [11], [12, 13], [14, 15, 16], [17, 18]) ce qui lui donne une meilleure note.  La question se pose immédiatement: selon quel principe choisir la «meilleure» position? <br><br>  Par exemple, il y a deux mouvements, après quoi nous avons des positions avec des notes [5;  5] et [2;  1].  Évalue le premier joueur.  Deux alternatives sont évidentes: <br><br><ul><li>  sélection de la position avec la valeur <b>absolue</b> maximale du i-ème score pour le i-ème joueur.  En d'autres termes, le noble coureur Leslie, avide de victoire, sans égard aux concurrents.  Dans ce cas, une position avec une estimation de [5;  5]. </li><li>  le choix d'un poste avec la note maximale par <b>rapport aux estimations des concurrents</b> est le rusé professeur Faith, qui ne manque pas l'occasion d'infliger de sales tours à l'ennemi.  Par exemple, prendre intentionnellement du retard sur un joueur qui prévoit de partir de la deuxième position.  Un élément avec une note [2;  1]. </li></ul><br>  Dans mon implémentation logicielle, j'ai fait de l'algorithme de sélection de grade (une fonction qui mappe le vecteur de grade à une valeur scalaire pour le ième joueur) un paramètre personnalisé.  D'autres tests ont montré, à ma grande surprise, la supériorité de la première stratégie - le choix de la position par la valeur absolue maximale <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-77"><span class="MJXp-msubsup" id="MJXp-Span-78"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-79" style="margin-right: 0.05em;">v</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-80" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.927ex" height="1.817ex" viewBox="0 -520.7 829.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-76" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-69" x="686" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> v_i </script>  . <br><br><div class="spoiler">  <b class="spoiler_title">Caractéristiques de l'implémentation logicielle</b> <div class="spoiler_text">  Si la première option pour choisir la meilleure note est spécifiée dans les paramètres de l'IA (classe TurnMaker), le code de la méthode correspondante prendra la forme: <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ContractEstimateByAbsMax</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] estimationVector, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> playerIndex</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> estimationVector[playerIndex]; }</code> </pre><br>  La deuxième méthode - le maximum par rapport aux positions des concurrents - est mise en œuvre un peu plus compliquée: <br><br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ContractEstimateByRelativeNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params">[]eVector, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> player</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>? min = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pVal = eVector[player]; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; eVector.Length; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (i == player) <span class="hljs-keyword"><span class="hljs-keyword">continue</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> val = pVal - eVector[i]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!min.HasValue || min.Value &gt; val) min = val; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> min.Value; }</code> </pre><br></div></div><br>  Certaines estimations (soulignées dans la figure) sont transférées au niveau supérieur.  L'ennemi doit maintenant choisir une position, sachant quelle position ultérieure l'algorithme choisira: <br><br><img src="https://habrastorage.org/webt/hf/pr/ox/hfproxjzdo7-_7ll2f90na7p5ky.png"><br><br>  L'adversaire, évidemment, choisira pour lui la position la mieux notée (celle où la <b>deuxième coordonnée du</b> vecteur prend la plus grande valeur).  Ces estimations sont à nouveau soulignées dans le graphique. <br><br>  Enfin, nous revenons au tout premier mouvement.  L'ordinateur sélectionne, et il préfère le mouvement avec la première coordonnée la plus grande du vecteur: <br><br><img src="https://habrastorage.org/webt/dr/f1/y-/drf1y-8s_h-orz173pj8fx2tam0.png"><br><br>  Ainsi, le problème est résolu - un mouvement quasi optimal est trouvé.  Supposons qu'un score heuristique de 100% en position foliaire sur un arbre indique un futur gagnant.  Ensuite, notre algorithme choisira sans équivoque le meilleur coup possible. <br><br>  Cependant, le score heuristique n'est précis à 100% que lorsque la position <b>finale</b> du jeu est évaluée - un (ou plusieurs) joueurs ont terminé, le gagnant est déterminé.  Par conséquent, ayant la possibilité d'anticiper N mouvements - autant qu'il en faut pour gagner des rivaux de force égale, vous pouvez choisir le mouvement optimal. <br><br>  Mais un jeu typique pour 2 joueurs dure en moyenne environ 30 à 40 coups (pour trois joueurs - environ 60 coups, etc.).  De chaque position, un joueur peut généralement faire environ 8 mouvements.  Par conséquent, un arbre complet de positions possibles pour 30 mouvements comprendra environ <br><math></math><img src="https://habrastorage.org/getpro/habr/formulas/4b3/e74/c97/4b3e74c9706ade7f8bd0fd17d6ec74c9.svg" alt="8 $ ^ {30} $" data-tex="inline">  = 1237940039285380274899124224 crêtes! <br><br>  Dans la pratique, la création et l'analyse d'une arborescence de ~ 100 000 positions sur mon PC prennent environ 300 millisecondes.  Ce qui nous donne une limite sur la profondeur de l'arbre en 7 à 8 niveaux (mouvements), si nous voulons nous attendre à une réponse informatique d'au plus une seconde. <br><br><div class="spoiler">  <b class="spoiler_title">Caractéristiques de l'implémentation logicielle</b> <div class="spoiler_text">  De toute évidence, une méthode récursive est nécessaire pour construire un arbre de positions et trouver le meilleur mouvement.  À l'entrée de la méthode - la position actuelle (dans laquelle, comme nous le rappelons, le joueur fait déjà un mouvement) et le niveau d'arbre actuel (numéro de mouvement).  Dès que nous descendons au niveau maximum autorisé par les paramètres de l'algorithme, la fonction renvoie un vecteur d'estimation de position heuristique du «point de vue» de chacun des joueurs. <br><br>  <b><font color="#ff0000">Un ajout important</font></b> : la descente sous l'arbre doit également être arrêtée lorsque le joueur actuel a terminé.  Sinon (si l'algorithme de sélection de la meilleure position par rapport aux positions des autres joueurs est sélectionné), le programme peut «piétiner» à l'arrivée pendant longtemps, «se moquer» de l'adversaire.  De plus, de cette façon, nous réduirons légèrement la taille de l'arbre en fin de partie. <br><br>  Si nous ne sommes pas encore au niveau ultime de récursivité, alors nous sélectionnons les mouvements possibles, créons une nouvelle position pour chaque mouvement et la passons à l'appel récursif de la méthode actuelle. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">Pourquoi Minimax?</b> <div class="spoiler_text">  Dans l'interprétation originale des joueurs sont toujours deux.  Le programme calcule le score exclusivement à partir de la position du premier joueur.  Par conséquent, lors du choix de la «meilleure» position, le joueur avec l'index 0 recherche une position avec une note maximale, le joueur avec l'index 1 recherche une minimum. <br><br>  Dans notre cas, la note doit être un vecteur afin que chacun des N joueurs puisse l'évaluer de son «point de vue», à mesure que la note monte dans l'arbre. <br></div></div><br><h2>  <font color="#3050ff">Tuning AI</font> </h2><br>  Ma pratique de jouer contre l'ordinateur a montré que l'algorithme n'est pas si mauvais, mais toujours inférieur aux humains.  J'ai décidé d'améliorer l'IA de deux manières: <br><br><ul><li>  optimiser la construction / traversée de l'arbre de décision, </li><li>  améliorer l'heuristique. </li></ul><br><h3>  Optimisation de l'algorithme Minimax </h3><br>  Dans l'exemple ci-dessus, nous pourrions refuser de considérer la position 8 et de «sauvegarder» 2 à 3 sommets de l'arbre: <br><br><img src="https://habrastorage.org/webt/-h/ce/hb/-hcehbcs1t-bcynqfe7j_cmnjp4.png"><br><br>  On marche autour de l'arbre de haut en bas, de gauche à droite.  En contournant le sous-arbre à partir de la position 2, nous avons déduit la meilleure estimation pour le mouvement 1 -&gt; 2: [3, 2].  En contournant le sous-arbre avec la racine en position 7, nous avons déterminé la note actuelle (meilleure pour le mouvement 3 -&gt; 7): [2, 4].  Du point de vue de l'ordinateur (premier joueur), le score [2, 4] est pire que le score [3, 2].  Et puisque l'adversaire de l'ordinateur choisit le coup de la position 3, quel que soit le score pour la position 8, le score final pour la position 3 sera a priori pire que le score obtenu pour la troisième position.  Par conséquent, le sous-arbre avec la racine en position 8 ne peut pas être construit et non évalué. <br><br>  La version optimisée de l'algorithme Minimax, qui vous permet de couper les sous-arbres en excès, est appelée <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'algorithme d'écrêtage alpha-bêta</a> .  L'implémentation de cet algorithme nécessitera des modifications mineures du code source. <br><br><div class="spoiler">  <b class="spoiler_title">Caractéristiques de l'implémentation logicielle</b> <div class="spoiler_text">  Deux paramètres entiers sont également transmis à la méthode CalcEstimate de la classe TurnMaker - alpha, qui est initialement égale à int.MinValue et beta, qui est égale à int.MaxValue.  De plus, après avoir reçu une estimation du mouvement actuel considéré, un pseudocode du formulaire est exécuté: <br><br><pre> <code class="1c hljs"> e = _[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-comment"><span class="hljs-comment">//        (  )  (e &gt; alpha) alpha = e   (e &lt; beta) beta = e  (beta &lt;= alpha)    </span></span></code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Une caractéristique importante de l'implémentation logicielle</b> <div class="spoiler_text">  la méthode d'écrêtage alpha-bêta, par définition, conduit à la même solution que l'algorithme Minimax «propre».  Pour vérifier si la logique de la prise de décision a changé (ou plutôt, les résultats sont des mouvements), j'ai écrit un test unitaire dans lequel le robot a effectué 8 mouvements pour chacun des 2 adversaires (16 mouvements au total) et enregistré la série de mouvements résultante - avec option d'écrêtage <b>désactivée</b> . <br><br>  Ensuite, dans le même test, la procédure a été répétée avec <b>l'</b> option d'écrêtage <b>activée</b> .  Après cela, la séquence de mouvements a été comparée.  L'écart dans les mouvements indique une erreur dans la mise en œuvre de l'algorithme d'écrêtage alpha-bêta (échec du test). <br></div></div><br><h3>  Optimisation d'écrêtage alpha-bêta mineure </h3><br>  Avec l'option d'écrêtage activée dans les paramètres de l'IA, le nombre de sommets dans l'arbre de position a été réduit en moyenne de 3 fois.  Ce résultat peut être quelque peu amélioré. <br><br>  Dans l'exemple ci-dessus: <br><br><img src="https://habrastorage.org/webt/-h/ce/hb/-hcehbcs1t-bcynqfe7j_cmnjp4.png"><br><br>  «coïncidait» si bien que, avant le sous-arbre avec le sommet en position 3, nous avons examiné le sous-arbre avec le sommet en position 2. Si la séquence était différente, nous pourrions commencer par le «pire» sous-arbre et ne pas arriver à la conclusion qu'il est inutile de considérer la position suivante . <br><br>  En règle générale, l'écrêtage sur un arbre se révèle plus «économique», ses sommets descendants au même niveau (c'est-à-dire tous les mouvements possibles depuis la position i) sont déjà triés par l'estimation de position actuelle (sans regarder en profondeur).  En d'autres termes, nous supposons que le meilleur mouvement (du point de vue heuristique) est plus susceptible d'obtenir une meilleure note finale.  Ainsi, avec une certaine probabilité, nous trions l'arbre afin que le «meilleur» sous-arbre soit considéré avant le «pire», ce qui nous permettra de couper plus d'options. <br><br>  L'évaluation de la position actuelle est une procédure coûteuse.  Si auparavant il nous suffisait d'évaluer uniquement les positions terminales (feuilles), alors maintenant l'évaluation est faite pour tous les sommets de l'arbre.  Cependant, comme l'ont montré les tests, le nombre total d'estimations faites était encore légèrement inférieur à celui de la variante sans le tri initial des mouvements possibles. <br><br><div class="spoiler">  <b class="spoiler_title">Caractéristiques de l'implémentation logicielle</b> <div class="spoiler_text">  L'algorithme de découpage alpha-bêta renvoie le même mouvement que l'algorithme Minimax d'origine.  Cela vérifie le test unitaire que nous avons écrit, en comparant deux séquences de mouvements (pour un algorithme avec écrêtage et sans).  L'écrêtage alpha-bêta <b>avec tri</b> , dans le cas général, peut indiquer un <b>mouvement différent</b> comme un <b>mouvement</b> quasi optimal. <br><br>  Pour tester le bon fonctionnement de l'algorithme modifié, vous avez besoin d'un nouveau test.  Malgré la modification, l'algorithme trié doit produire exactement le même <b>vecteur d'estimation final</b> ([3, 2] dans l'exemple de la figure) que l'algorithme non trié comme l'algorithme Minimax d'origine. <br><br>  Dans le test, j'ai créé une série de positions de test et sélectionné de chacune selon le «meilleur» mouvement, en activant et désactivant l'option de tri.  Il a ensuite comparé le vecteur d'évaluation obtenu de deux manières. <br></div></div><br>  De plus, étant donné que les positions pour chacun des mouvements possibles dans le sommet actuel de l'arbre sont triées par évaluation heuristique, l'idée suggère de rejeter immédiatement certaines des pires options.  Par exemple, un joueur d'échecs peut envisager un coup dans lequel il substitue sa tour à un coup de pion.  Cependant, en "déroulant" la situation en profondeur de 3, 4 ... pas en avant, il remarquera immédiatement les options lorsque, par exemple, l'adversaire met l'attaque de l'évêque de sa reine. <br><br>  Dans les paramètres de l'IA, j'ai défini le vecteur «découpage des pires options».  Par exemple, un vecteur de la forme [0, 0, 8, 8, 4] signifie que: <br><br><ul><li>  en regardant un [0] et deux [0] pas en avant, le programme considérera tous les mouvements possibles, car 0   , </li><li>    [8]   [8]  ,    8 “” ,    , , </li><li>        [4],     4 “” . </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Le tri étant activé pour l'algorithme d'écrêtage alpha-bêta et un vecteur similaire dans les paramètres d'écrêtage, le programme a commencé à dépenser environ 300 millisecondes pour sélectionner un mouvement quasi optimal, «allant plus loin» 8 pas en avant. </font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Optimisation heuristique </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Malgré la quantité décente de positions de sommets itérées dans l'arbre et «profondes» en regardant vers l'avant à la recherche d'un mouvement quasi optimal, l'IA avait plusieurs faiblesses. </font><font style="vertical-align: inherit;">J'ai défini l'un d'eux comme un « </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">piège à lapin</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ».</font></font><br><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Piège à lièvre</font></font></b> <div class="spoiler_text">       .   ( 8 — 10   15),     .     “”          (   !): <br><br><ul><li>           7, </li><li>    ,    ,  .   ,  ,    ,      . </li></ul><br>        .  : <br><br><img src="https://habrastorage.org/webt/qn/y-/wr/qny-wrq0dgtlr16wwj1ibekhk5g.png"><br><br>     54   (43),      —   10     55 .  AI,   ,      (61),  28 .       ,   6          9 (      10 ). <br><br>   ,       ( ),         ,        4 — 6 .   , ,          , AI     ? <br><br>   ,     <b> </b> ,   . AI      .            ,      ,    .      “ ”  : <br><br>                  65 —    “”  , ,      .         ,            ,  ,    ()    . <br></div></div><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Facteurs de correction </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Plus tôt, en donnant une formule d'estimation heuristique de la position actuelle </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E = Ks * S + Kc * C + Kp * P, </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j'ai mentionné, mais je n'ai pas décrit, les facteurs de correction. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le fait est que la formule elle-même et les ensembles de fonctions</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-81"><span class="MJXp-msubsup" id="MJXp-Span-82"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-84" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-85" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font></span><span class="MJXp-mo" id="MJXp-Span-86" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-87"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-89" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-91"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-93" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">0</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font></span><span class="MJXp-mo" id="MJXp-Span-95" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-96"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">S </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-98" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ont été déduits par moi intuitivement, sur la base de la soi-disant </font><font style="vertical-align: inherit;">"Le bon sens." </font><font style="vertical-align: inherit;">Au minimum, je voudrais sélectionner ces coefficients Ks, Kc et Kp afin que l'estimation soit aussi adéquate que possible. </font><font style="vertical-align: inherit;">Comment évaluer la «pertinence» de l'évaluation? </font><font style="vertical-align: inherit;">L'évaluation est une quantité sans dimension et ne peut être comparée qu'à une autre estimation. </font><font style="vertical-align: inherit;">J'ai pu trouver la seule façon d'affiner les coefficients de correction: j'ai</font><font style="vertical-align: inherit;">mis dans le programme une série «d'études» stockées dans un fichier CSV avec des données de la forme</font></font><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.56ex" height="2.419ex" viewBox="0 -780.1 6699.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-30" x="1011" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2E" x="1169" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2E" x="1614" y="0"></use><g transform="translate(2059,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-32" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2C" x="3229" y="0"></use><g transform="translate(3674,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-30" x="867" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2E" x="4741" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-2E" x="5186" y="0"></use><g transform="translate(5632,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/432382/&amp;usg=ALkJrhjeLCdWKiA7ejHxonCXtrxp1zaw8A#MJMAIN-35" x="867" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-12">C_0 .. C_2, S_0 .. S_5</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><pre> <code class="cs hljs"> <span class="hljs-number"><span class="hljs-number">45</span></span>;<span class="hljs-number"><span class="hljs-number">26</span></span>;<span class="hljs-number"><span class="hljs-number">2</span></span>;f;<span class="hljs-number"><span class="hljs-number">29</span></span>;<span class="hljs-number"><span class="hljs-number">19</span></span>;<span class="hljs-number"><span class="hljs-number">0</span></span>;f;<span class="hljs-number"><span class="hljs-number">2</span></span> ...</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Cette ligne signifie littéralement ce qui suit: </font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">le premier joueur est sur la case 45, il a 26 cartes de carottes et 2 cartes salade en main, le joueur ne manque pas un coup (f = faux). </font><font style="vertical-align: inherit;">Le droit de bouger est toujours le premier joueur.</font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le deuxième joueur sur la cellule 29 avec 19 cartes de carottes et sans cartes de salade, ne manque pas un coup. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> le chiffre deux signifie que, «décidant» l'étude, j'ai supposé que le deuxième joueur est dans une situation gagnante. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Après avoir mis 20 croquis dans le programme, je les ai «téléchargés» dans le client Web du jeu, puis triés chaque croquis. </font><font style="vertical-align: inherit;">En analysant le croquis, j'ai alternativement fait des mouvements pour chacun des joueurs, jusqu'à ce que je décide du «gagnant». </font><font style="vertical-align: inherit;">Ayant terminé l'évaluation, je l'ai envoyée dans une équipe spéciale au serveur. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Après avoir évalué 20 études (bien sûr, il vaudrait la peine d'en analyser davantage), j'ai évalué chacune des études du programme. </font><font style="vertical-align: inherit;">Dans l'évaluation, les valeurs de chacun des facteurs de correction, de 0,5 à 2 par incréments de 0,1 - total</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-99"><span class="MJXp-msubsup" id="MJXp-Span-100"><span class="MJXp-mn" id="MJXp-Span-101" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">16 </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-102" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 4096 variantes de triplets de coefficients. </font><font style="vertical-align: inherit;">Si le score du premier joueur s'avérait supérieur au score du deuxième joueur et qu'une instruction similaire était stockée dans la ligne du dossier d'étude (la dernière valeur de la ligne est 1), le «hit» était compté. </font><font style="vertical-align: inherit;">De même pour une situation miroir. </font><font style="vertical-align: inherit;">Sinon, un glissement a été compté. </font><font style="vertical-align: inherit;">En conséquence, j'ai choisi les triplets pour lesquels le pourcentage de «hits» était maximum (16 sur 20). </font><font style="vertical-align: inherit;">Environ 250 des 4096 vecteurs sont sortis, dont j'ai sélectionné le «meilleur», encore une fois, «à l'œil», et l'ai installé dans les paramètres de l'IA.</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13">16^3</script><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Résumé </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En conséquence, j'ai obtenu un programme de travail, qui, en règle générale, me bat dans la version individuelle contre l'ordinateur. Les statistiques sérieuses de victoires et de défaites pour la version actuelle du programme ne se sont pas encore accumulées. Peut-être que le réglage ultérieur facile de l'IA rendra mes victoires impossibles. Ou presque impossible, car le facteur des cellules de lièvre demeure. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Par exemple, dans la logique du choix des notes (maximum absolu ou maximum par rapport aux autres joueurs), j'essaierais certainement une option intermédiaire. Au minimum, si la valeur absolue du score du ième joueur est égale, il est raisonnable de choisir le mouvement menant à la position avec une valeur relative plus grande du score (un hybride du noble Leslie et du perfide Feith).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Le programme est entièrement fonctionnel pour la version à 3 joueurs. </font><font style="vertical-align: inherit;">Cependant, on soupçonne que la «qualité» des mouvements de l'IA pour jouer avec 3 joueurs est plus faible que pour jouer avec deux joueurs. </font><font style="vertical-align: inherit;">Cependant, lors du dernier test, j'ai perdu contre l'ordinateur - peut-être par négligence, évaluant avec désinvolture la quantité de carottes dans mes mains et arrivant à la ligne d'arrivée avec un excès de «carburant». </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jusqu'à présent, le développement de l'IA est entravé par le manque d'une personne - un «testeur», c'est-à-dire un adversaire vivant d'un «génie» informatique. </font><font style="vertical-align: inherit;">J'ai moi-même joué assez de Hare et Hedgehog à la nausée et forcé d'interrompre au stade actuel. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">→ Lien vers le </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">référentiel avec la source</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr432382/">https://habr.com/ru/post/fr432382/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr432370/index.html">AlphaZero a vaincu Stockfish dans un match de 1000 matchs</a></li>
<li><a href="../fr432372/index.html">Microsoft a officiellement confirmé qu'Edge passe au moteur Chromium</a></li>
<li><a href="../fr432374/index.html">Elasticsearch hautement accessible et évolutif dans Kubernetes</a></li>
<li><a href="../fr432378/index.html">Un élève de 10e de Sibérie veut devenir concepteur de processeurs. Pourquoi ne pas fabriquer un accélérateur neuronal FPGA?</a></li>
<li><a href="../fr432380/index.html">Six ans de vie avec un iPhone qui ne me distrait pas</a></li>
<li><a href="../fr432384/index.html">Étude: 22% des utilisateurs de Tumblr vont sur un site porno, en particulier les jeunes filles</a></li>
<li><a href="../fr432386/index.html">Table ronde «Architecte du projet informatique», septembre 2018</a></li>
<li><a href="../fr432392/index.html">Nous avons eu des jeux à l'ancienne et des champignons: mission terminée</a></li>
<li><a href="../fr432394/index.html">9 tours d'automatisation d'entrepôt Lamoda</a></li>
<li><a href="../fr432398/index.html">Mode DFU du chargeur de démarrage STM32 utilisant CubeMX. Instructions étape par étape</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>