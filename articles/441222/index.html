<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßïüèº üë®üèæ‚Äçüé§ üíÉüèΩ ¬øPor qu√© Kubernetes es tan complicado con los repositorios? üßë üßê ‚öóÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cuando llegaron los orquestadores de contenedores como Kubernetes, el enfoque para desarrollar e implementar aplicaciones cambi√≥ dr√°sticamente. Han ap...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>¬øPor qu√© Kubernetes es tan complicado con los repositorios?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/441222/"><p><img src="https://habrastorage.org/webt/3w/v4/sh/3wv4sha9sfamx7elh4imtocvesm.jpeg"></p><br><p>  Cuando llegaron los orquestadores de contenedores como Kubernetes, el enfoque para desarrollar e implementar aplicaciones cambi√≥ dr√°sticamente.  Han aparecido microservicios, y para el desarrollador, la l√≥gica de la aplicaci√≥n ya no est√° conectada con la infraestructura: cree aplicaciones para usted y ofrezca nuevas funciones. </p><br><p>  Kubernetes extrae de las computadoras f√≠sicas que controla.  Solo d√≠gale cu√°nta memoria y potencia de procesamiento necesita, y obtendr√° todo.  Infraestructura?  No, no escuchado. </p><br><p>  Administrar im√°genes de Docker, Kubernetes y aplicaciones lo hace port√°til.  Despu√©s de haber desarrollado aplicaciones de contenedor con Kubernetes, puede implementarlas en cualquier lugar: en una nube abierta, localmente o en un entorno h√≠brido, sin cambiar el c√≥digo. </p><br><p>  Nos encanta Kubernetes por su escalabilidad, portabilidad y capacidad de administraci√≥n, pero no almacena estados.  Pero tenemos casi todas las aplicaciones con estado, es decir, necesitan almacenamiento externo. </p><a name="habracut"></a><br><p>  Kubernetes tiene una arquitectura muy din√°mica.  Los contenedores se crean y destruyen seg√∫n la carga y las instrucciones de los desarrolladores.  Las vainas y los contenedores se autocuran y se replican.  Son esencialmente ef√≠meros. </p><br><p>  <strong>El almacenamiento externo es demasiado resistente para tal variabilidad.</strong>  <strong>No obedece las reglas de creaci√≥n y destrucci√≥n din√°micas.</strong> </p><br><p> Solo necesito implementar una aplicaci√≥n con estado en otra infraestructura: en otra nube all√≠, localmente o en un modelo h√≠brido, c√≥mo tiene problemas de portabilidad.  El almacenamiento externo se puede vincular a una nube espec√≠fica. </p><br><p>  Pero solo en estos almacenes para aplicaciones en la nube, el mismo diablo se romper√° la pierna.  Y ve a entender los significados ficticios y los significados de <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la terminolog√≠a</a></strong> de <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">almacenamiento en Kubernetes</a></strong> .  Y hay repositorios propios de Kubernetes, plataformas de c√≥digo abierto, servicios administrados o pagos ... </p><br><p>  Estos son algunos ejemplos <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de almacenamiento en la nube CNCF</a></strong> : </p><br><p><img src="https://habrastorage.org/webt/cm/wl/ov/cmwlovlr6qt3qcicg0sm5acufvw.png"></p><br><p>  Parece que implementa la base de datos en Kubernetes: solo necesita seleccionar la soluci√≥n adecuada, empacarla en un contenedor para trabajar en el disco local e implementarla en el cl√∫ster como la pr√≥xima carga de trabajo.  Pero la base de datos tiene sus propias peculiaridades, por lo que pensar no es un hielo. </p><br><p>  Contenedores: est√°n tan empedrados que no conservan su estado.  Es por eso que son tan f√°ciles de iniciar y detener.  Y como no hay nada que guardar y transferir, el cl√∫ster no se molesta con las operaciones de lectura y copia. </p><br><p>  Deber√° almacenar el estado con la base de datos.  Si la base de datos implementada en el cl√∫ster en el contenedor no migra a ning√∫n lado y no se inicia con demasiada frecuencia, la f√≠sica del almacenamiento de datos entra en juego.  Idealmente, los contenedores que usan datos deben estar en el mismo hogar que la base de datos. </p><br><p>  En algunos casos, la base de datos, por supuesto, se puede implementar en un contenedor.  En un entorno de prueba o en tareas donde hay poca informaci√≥n, las bases de datos viven c√≥modamente en grupos. </p><br><p>  <strong>La producci√≥n generalmente requiere almacenamiento externo.</strong> </p><br><p>  Kubernetes se comunica con el repositorio a trav√©s de interfaces de plano de control.  Vinculan Kubernetes al almacenamiento externo.  El almacenamiento externo conectado a Kubernetes se denomina complementos de volumen.  Con ellos, puede abstraer el almacenamiento y transferir el almacenamiento. </p><br><p>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Los complementos de volumen sol√≠an crearse</a></strong> , vincularse, compilarse y entregarse utilizando la base de c√≥digo de Kubernetes.  Esto limit√≥ enormemente a los desarrolladores y requiri√≥ mantenimiento adicional: si desea agregar nuevos repositorios, cambie la base de c√≥digo de Kubernetes. </p><br><p>  Ahora implemente complementos de volumen en el cl√∫ster; no quiero hacerlo.  Y no necesita profundizar en la base del c√≥digo.  Gracias a CSI y Flexvolume. </p><br><p><img src="https://habrastorage.org/webt/ug/r7/m4/ugr7m4uco1skczyasqf7xf3op3y.png"></p><br><h3 id="sobstvennoe-hranilische-kubernetes">  Kubernetes Native Storage </h3><br><p>  ¬øC√≥mo resuelve Kubernetes los problemas de almacenamiento?  Hay varias soluciones: opciones ef√≠meras, almacenamiento persistente en vol√∫menes persistentes, consultas de reclamo de volumen persistente, clases de almacenamiento o StatefulSets.  Ve a resolverlo, en general. </p><br><p>  Los vol√∫menes persistentes (PV) son unidades de almacenamiento preparadas por el administrador.  No dependen de hogares y sus vidas fugaces. </p><br><p>  El reclamo de volumen persistente (PVC) son solicitudes de almacenamiento, es decir, PV.  Con PVC, puede vincular el almacenamiento a un nodo, y este nodo lo usar√°. </p><br><p>  Puede trabajar con almacenamiento de forma est√°tica o din√°mica. </p><br><p>  Con un enfoque est√°tico, el administrador prepara los PV que se supone que deben servirse de antemano, antes de las solicitudes, y estos PV se vinculan manualmente a m√≥dulos espec√≠ficos mediante PVC expl√≠citos. </p><br><p>  En la pr√°ctica, los PV especialmente definidos no son compatibles con la estructura port√°til de Kubernetes: el almacenamiento depende del entorno, como AWS EBS o un disco GCE permanente.  Para enlazar manualmente, debe apuntar a un repositorio espec√≠fico en el archivo YAML. </p><br><p>  El enfoque est√°tico generalmente contradice la filosof√≠a de Kubernetes: las CPU y la memoria no se asignan de antemano y no est√°n conectadas a pods o contenedores.  Se emiten din√°micamente. </p><br><p>  Para el aprovisionamiento din√°mico, utilizamos clases de almacenamiento.  El administrador del cl√∫ster no necesita crear el PV por adelantado.  Crea varios perfiles de almacenamiento, como plantillas.  Cuando un desarrollador realiza una solicitud de PVC, en el momento de la solicitud, se crea uno de estos patrones y se adjunta a la chimenea. </p><br><p><img src="https://habrastorage.org/webt/id/9q/mj/id9qmjxqf7tqnki0xc_1a710seg.png"></p><br><p>  Entonces, en los t√©rminos m√°s generales, Kubernetes trabaja con almacenamiento externo.  Hay muchas otras opciones. </p><br><h3 id="csi--container-storage-interface">  CSI - Interfaz de almacenamiento de contenedores </h3><br><p>  Existe tal cosa - <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Interfaz de almacenamiento de contenedores</a></strong> .  CSI fue creado por el grupo de trabajo de b√≥veda CNCF, que decidi√≥ definir una interfaz de almacenamiento de contenedor est√°ndar para que los controladores de b√≥veda funcionen con cualquier orquesta. </p><br><p>  Las especificaciones CSI ya est√°n adaptadas para Kubernetes, y hay <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">toneladas de complementos de controladores</a></strong> para implementaciones en el cl√∫ster de Kubernetes.  Debe acceder al repositorio a trav√©s de un controlador de volumen compatible con CSI; use el <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">tipo de</a></strong> volumen <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">csi</a></strong> en Kubernetes. </p><br><p>  Con CSI, el almacenamiento puede considerarse otra carga de trabajo para la contenedorizaci√≥n y la implementaci√≥n en el cl√∫ster de Kubernetes. </p><br><p>  Para m√°s detalles, escuche a <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Jie Yu hablar sobre CSI en nuestro podcast</a></strong> . </p><br><h3 id="opensors-proekty">  Proyectos de c√≥digo abierto </h3><br><p>  Las herramientas y proyectos para tecnolog√≠as en la nube se multiplican r√°pidamente, y una parte justa de los proyectos de c√≥digo abierto, lo cual es l√≥gico, resuelve uno de los principales problemas de producci√≥n: trabajar con el almacenamiento en la arquitectura de la nube. </p><br><p>  Los m√°s populares son Ceph y Rook. </p><br><p>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Ceph</a></strong> es un cl√∫ster de almacenamiento distribuido y administrado din√°micamente con escala horizontal.  Ceph proporciona una abstracci√≥n l√≥gica para los recursos de almacenamiento.  No tiene un solo punto de falla, se maneja solo y funciona sobre la base del software.  Ceph proporciona interfaces para almacenar bloques, objetos y archivos simult√°neamente para un solo cl√∫ster de almacenamiento. </p><br><p>  Ceph tiene una arquitectura muy compleja con algoritmos RADOS, librados, RADOSGW, RDB, CRUSH y varios componentes (monitores, OSD, MDS).  No profundizaremos en la arquitectura, es suficiente entender que Ceph es un cl√∫ster de almacenamiento distribuido que simplifica la escalabilidad, elimina un solo punto de falla sin sacrificar el rendimiento y proporciona un almacenamiento √∫nico con acceso a objetos, bloques y archivos. </p><br><p>  Naturalmente, Ceph est√° adaptado para la nube.  Puede implementar un cl√∫ster Ceph de diferentes maneras, por ejemplo, usando Ansible o en un cl√∫ster de Kubernetes a trav√©s de CSI y PVC. </p><br><p><img src="https://habrastorage.org/webt/g9/kn/ft/g9knft3jj1y3hw8u2v-4jzoa26k.png"><br>  <em>Arquitectura Ceph</em> </p><br><p>  Rook es otro proyecto interesante y popular.  Combina Kubernetes con su computaci√≥n y Ceph con sus repositorios en un cl√∫ster. </p><br><p>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Rook</a></strong> es un orquestador de almacenamiento en la nube que complementa a Kubernetes.  Empacan Ceph en contenedores con √©l y usan la l√≥gica de administraci√≥n de cl√∫ster para un funcionamiento confiable de Ceph en Kubernetes.  Rook automatiza la implementaci√≥n, el arranque, el ajuste, el escalado, el reequilibrio, en general, todo lo que hace el administrador del cl√∫ster. </p><br><p>  Con Rook, se puede implementar un cl√∫ster Ceph desde yaml, como Kubernetes.  En este archivo, el administrador describe lo que necesita en el cl√∫ster.  Rook lanza un cl√∫ster y comienza a monitorear activamente.  Esto es algo as√≠ como un operador o controlador: garantiza que se cumplan todos los requisitos de yaml.  Rook funciona con ciclos de sincronizaci√≥n: ve el estado y toma medidas si hay desviaciones. </p><br><p>  √âl no tiene su estado permanente y no necesita ser controlado.  Est√° en el esp√≠ritu de Kubernetes. </p><br><p><img src="https://habrastorage.org/webt/ep/qx/qk/epqxqk5iecbwcekk88ac8tjxih4.png"></p><br><p>  Rook, que combina Ceph y Kubernetes, es una de las soluciones de almacenamiento en la nube m√°s populares: 4.000 estrellas en Github, 16,3 millones de descargas y m√°s de cien colaboradores. <br>  El proyecto Rook ya ha sido aceptado en CNCF, <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">y recientemente termin√≥ en una incubadora</a></strong> . </p><br><p>  <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Bassam Tabara</a></strong> le contar√° m√°s sobre Rook <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">en nuestro episodio de repositorio de Kubernetes</a></strong> . <br>  Si la aplicaci√≥n tiene un problema, debe conocer los requisitos y crear un sistema o tomar las herramientas necesarias.  Esto tambi√©n se aplica al almacenamiento en la nube.  Y aunque el problema no es simple, las herramientas y los enfoques se han quedado cortos.  La tecnolog√≠a en la nube contin√∫a evolucionando y seguramente nos esperan nuevas soluciones. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/441222/">https://habr.com/ru/post/441222/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../441212/index.html">Trabaje con protecci√≥n de informaci√≥n criptogr√°fica y portadores de claves de hardware en Linux</a></li>
<li><a href="../441214/index.html">Gu√≠a del usuario de Kibana. Visualizaci√≥n. Parte 1</a></li>
<li><a href="../441216/index.html">¬øEspejo negro o anuncio Picooc?</a></li>
<li><a href="../441218/index.html">OpenAI Gym + ROS + Gazebo: entrenando un robot independiente en casa. Parte 1</a></li>
<li><a href="../441220/index.html">An√°lisis de ataques masivos recientes con captura de DNS</a></li>
<li><a href="../441224/index.html">Cree un ejemplo ARCore de caras aumentadas en Unity</a></li>
<li><a href="../441226/index.html">Forbes public√≥ una lista de las compa√±√≠as de Internet rusas m√°s caras en 2019</a></li>
<li><a href="../441234/index.html">Efectos de filtrado SVG. Parte 6. Creando texturas con feTurbulence</a></li>
<li><a href="../441236/index.html">Habraiting 2018: los mejores materiales para 2018</a></li>
<li><a href="../441238/index.html">Ingl√©s de programaci√≥n</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>