<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⚗️ 👩🏾‍🤝‍👨🏿 ✌🏻 Eine praktische Einführung in den Paketmanager für Kubernetes - Helm 💎 😎 👩‍🚀</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Artikel ist eine logische Fortsetzung unserer jüngsten Veröffentlichung zur Geschichte des Paketmanagers für Kubernetes - Helm . Dieses Mal werden...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Eine praktische Einführung in den Paketmanager für Kubernetes - Helm</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/420437/"><img src="https://habrastorage.org/webt/ff/1x/js/ff1xjsnvdlnfinirlwb-0p42tlo.png"><br><br>  Der Artikel ist eine logische Fortsetzung unserer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">jüngsten Veröffentlichung</a> zur Geschichte des Paketmanagers für Kubernetes - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><b>Helm</b></a> .  Dieses Mal werden wir uns erneut mit den Problemen des Geräts und der Funktionsweise des aktuellen Helms ( <b>Version 2.x</b> ) sowie den von ihm verwalteten Diagrammen und Repositorys befassen. Anschließend werden wir mit der Installation von Helm im Kubernetes-Cluster und der Verwendung der Diagramme fortfahren. <a name="habracut"></a><br><br><h2>  Eintrag </h2><br>  <b>Helm ist ein Diagrammverwaltungswerkzeug.</b> <br><br>  <b>Das Diagramm</b> beschreibt den erforderlichen Datensatz, um die Anwendung im Kubernetes-Cluster zu instanziieren.  Es kann eingebettete Diagramme haben und sowohl zur Beschreibung vollwertiger Dienste, die aus vielen abhängigen Ressourcen bestehen, als auch zur Beschreibung einzelner unabhängiger Komponenten verwendet werden.  Zum Beispiel beschreibt das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stable / Gitlab-Ce-</a> Diagramm eine vollständige Lösung unter <a href="">Verwendung der</a> unabhängigen Redis- und Postgresql-Diagramme. <br><br>  Ein Diagramm kann unbegrenzt oft im selben Cluster festgelegt werden.  Daher kann und sollte die Beschreibung der Rollout-Logik der Anwendung in verschiedenen Umgebungen in demselben Diagramm gespeichert werden. <br><br>  Die Client-Seite von Helm ist dafür verantwortlich, das Diagramm zu erstellen und die <b>Tiller-</b> Komponente zusammen mit den Benutzerparametern in den Kubernetes-Cluster zu übertragen.  Tiller ist wiederum für den Lebenszyklus der Instanz des gestarteten Diagramms Release verantwortlich.  <i>(Nur für den Fall, ich möchte Sie daran erinnern, dass das nächste große Update von Helm - Version 3 - Tiller nicht mehr enthalten wird.)</i> <br><br>  Und jetzt - das Wichtigste zuerst. <br><br><h2>  Installation und Upgrade </h2><br>  Helm benötigt Kubernetes, um zu arbeiten.  Sie können einen lokal installierten <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Minikube</a> <i>(siehe auch „ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erste Schritte in Kubernetes mit Minikube</a> “)</i> oder einen anderen verfügbaren Cluster verwenden. <br><br>  Beginnen wir mit der Installation des Clients: Wählen Sie die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Version aus</a> , laden Sie das Archiv für Ihr System herunter und entpacken Sie es, übertragen Sie die ausführbare Datei ... <br><br><pre><code class="bash hljs">$ curl https://storage.googleapis.com/kubernetes-helm/helm-v2.10.0-linux-amd64.tar.gz | tar -zxv $ sudo mv linux-amd64/helm /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin/helm</code> </pre> <br>  Installieren Sie als Nächstes Tiller im Cluster.  Standardmäßig wird Tiller im <b><code>kubectl</code></b> ( <code>kubectl config current-context</code> ) im <b><code>kube-system</code> Namespace <code>kube-system</code></b> Dies kann jedoch mithilfe der entsprechenden Optionen und Umgebungsvariablen geändert werden. Diese werden in der Hilfe beschrieben ( <code>helm init --help</code> ).  Lassen Sie uns die Installation abschließen und die erstellten Ressourcen im Cluster betrachten: <br><br><pre> <code class="bash hljs">$ helm init <span class="hljs-variable"><span class="hljs-variable">$HELM_HOME</span></span> has been configured at /home/habr/.helm. (Use --client-only to suppress this message, or --upgrade to upgrade Tiller to the current version.) Happy Helming! $ kubectl get all --selector=name=tiller --namespace kube-system NAME READY STATUS RESTARTS AGE po/tiller-deploy-df4fdf55d-h5mvh 0/1 Running 0 5s NAME CLUSTER-IP EXTERNAL-IP PORT(S) AGE svc/tiller-deploy 10.107.191.68 &lt;none&gt; 44134/TCP 5s NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE deploy/tiller-deploy 1 1 1 0 5s NAME DESIRED CURRENT READY AGE rs/tiller-deploy-df4fdf55d 1 1 0 5s</code> </pre><br>  Jetzt ist Tiller im Cluster installiert und bereit für das Release-Management und die Interaktion mit der Kubernetes-API. <br><br>  <i><b>Hinweis</b> : Während der Installation und des Upgrades (Option <code>--upgrade</code> ) von Tiller können Sie <b>ein bestimmtes Image angeben,</b> anstatt standardmäßig die neueste stabile Version zu verwenden.</i>  <i>Der Name eines beliebigen Bildes wird durch die Option <code>--tiller-image</code> Option <code>--tiller-image</code> wird beim <code>--canary-image</code> Tiller ein <code>--canary-image</code> verwendet.</i>  <i>Auf dem Kanarienvogelbild können Sie Tiller verwenden, dessen Codeversion dem Hauptzweig entspricht.</i> <br><br>  Die Servicedaten werden in einem Cluster in speziellen Ressourcen, <code>ConfigMaps</code> , <code>ConfigMaps</code> , sodass die Deinstallation und Neuinstallation von Tiller nicht zum Verlust von Daten aus zuvor installierten Releases führt. <br><br><h2>  Diagramm-Repositorys </h2><br>  Diagramm-Repository - Ein HTTP-Server zum Speichern und Verteilen von Diagrammen.  Informationen zu Diagrammen im Repository werden in der Datei <code>index.yaml</code> gespeichert.  Es zeigt auch an, von wo jedes Diagramm geladen werden kann.  Meistens werden die Diagramme mit der Datei <code>index.yaml</code> gespeichert, aber nichts hindert sie daran, auf einem anderen Server abgelegt zu werden.  Normalerweise hat die Dateistruktur eine flache Form: <br><br><pre> <code class="bash hljs">. ├── index.yaml ├── artifactory-7.3.0.tgz ├── docker-registry-1.5.2.tgz ... └── wordpress-2.1.10.tgz</code> </pre><br>  Standardmäßig verwendet Helm das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offizielle Kubernetes-Diagramm-Repository</a> .  Es enthält sorgfältig gestaltete aktuelle Diagramme zur Lösung vieler angewandter Probleme.  Dieses Repository heißt <b>stabil</b> : <br><br><pre> <code class="bash hljs">$ helm repo list NAME URL stable https://kubernetes-charts.storage.googleapis.com</code> </pre><br>  Bei Bedarf ist das <b>Erstellen eines</b> eigenen Repositorys kein Problem.  Die Serveranforderungen sind minimal, sodass sie wie die meisten öffentlichen Diagramm-Repositorys auf GitHub-Seiten gehostet werden können.  Weitere Informationen zu den Tools und den dazu erforderlichen Schritten finden Sie in der <a href="">Dokumentation</a> . <br><br>  Bei Verwendung von Diagramm-Repositorys können diese hinzugefügt und entfernt werden.  Damit die Diagrammversionen auf dem neuesten Stand sind, müssen Sie den Index regelmäßig aktualisieren.  Ich werde ein Beispiel für das öffentliche <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bitnami-</a> Repository geben, von dem die meisten Diagramme im offiziellen Helm-Repository verwendet werden: <br><br><pre> <code class="bash hljs">$ helm repo add bitnami https://charts.bitnami.com/bitnami <span class="hljs-string"><span class="hljs-string">"bitnami"</span></span> has been added to your repositories $ helm repo update Hang tight <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> we grab the latest from your chart repositories... ...Successfully got an update from the <span class="hljs-string"><span class="hljs-string">"bitnami"</span></span> chart repository ...Successfully got an update from the <span class="hljs-string"><span class="hljs-string">"stable"</span></span> chart repository Update Complete. Happy Helming! $ helm repo remove bitnami <span class="hljs-string"><span class="hljs-string">"bitnami"</span></span> has been removed from your repositories</code> </pre><br>  Weiter - <b>Durchsuchen Sie die</b> Repositorys.  Ein <code>helm search</code> ohne Argumente zeigt alle verfügbaren Diagramme an: <br><br><pre> <code class="bash hljs">$ helm search NAME CHART VERSION APP VERSION DESCRIPTION stable/acs-engine-autoscaler 2.2.0 2.1.1 Scales worker nodes within agent pools stable/aerospike 0.1.7 v3.14.1.2 A Helm chart <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Aerospike <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Kubernetes stable/anchore-engine 0.2.1 0.2.4 Anchore container analysis and policy evaluation engine s... stable/apm-server 0.1.0 6.2.4 The server receives data from the Elastic APM agents and ... stable/ark 1.2.1 0.9.1 A Helm chart <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ark stable/artifactory 7.3.0 6.1.0 Universal Repository Manager supporting all major packagi... ... stable/weave-cloud 0.2.2 0.2.0 Weave Cloud is a add-on to Kubernetes <span class="hljs-built_in"><span class="hljs-built_in">which</span></span> provides Cont... stable/weave-scope 0.9.3 1.6.5 A Helm chart <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the Weave Scope cluster visualizer. stable/wordpress 2.1.10 4.9.8 Web publishing platform <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> building blogs and websites. stable/xray 0.4.1 2.3.0 Universal component scan <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> security and license invento... stable/zeppelin 1.0.1 0.7.2 Web-based notebook that enables data-driven, interactive ... stable/zetcd 0.1.9 0.0.3 CoreOS zetcd Helm chart <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Kubernetes</code> </pre><br>  Im Feld für optionale <code>keywords</code> in <code>Chart.yaml</code> Entwickler Tags an, mit denen die Suche in den Diagramm-Repositorys vereinfacht wird: <br><br><pre> <code class="bash hljs">$ helm search web NAME CHART VERSION APP VERSION DESCRIPTION stable/cerebro 0.3.1 0.8.1 A Helm chart <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Cerebro - a web admin tool that replaces... stable/chronograf 0.4.5 1.3 Open-source web application written <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Go and React.js th... stable/jasperreports 2.0.4 7.1.0 The JasperReports server can be used as a stand-alone or ... stable/joomla 2.0.9 3.8.12 PHP content management system (CMS) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> publishing web co... stable/kubernetes-dashboard 0.7.2 1.8.3 General-purpose web UI <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Kubernetes clusters stable/odoo 2.0.7 11.0.20180815 A suite of web based open <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> business apps. stable/phabricator 2.1.9 2018.34.0 Collection of open <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> web applications that <span class="hljs-built_in"><span class="hljs-built_in">help</span></span> soft... stable/redmine 4.1.0 3.4.6 A flexible project management web application. stable/rethinkdb 0.1.4 0.1.0 The open-source database <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the realtime web stable/schema-registry-ui 0.1.0 v0.9.4 This is a web tool <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the confluentinc/schema-registry i... stable/superset 0.1.2 0.24.0 Apache Superset (incubating) is a modern, enterprise-read... stable/testlink 2.0.3 1.9.17 Web-based <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> management system that facilitates softwar... stable/tomcat 0.1.0 7 Deploy a basic tomcat application server with sidecar as ... stable/wordpress 2.1.10 4.9.8 Web publishing platform <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> building blogs and websites. ... $ helm search cms blog NAME CHART VERSION APP VERSION DESCRIPTION stable/drupal 1.1.3 8.5.6 One of the most versatile open <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> content management ... stable/joomla 2.0.9 3.8.12 PHP content management system (CMS) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> publishing web co... stable/wordpress 2.1.10 4.9.8 Web publishing platform <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> building blogs and websites</code> </pre> <br>  <i><b>Hinweis:</b> Bei Verwendung des Befehls <code>helm search</code> kann es zu einem instabilen Betrieb mehrerer Filter kommen: Die Verfügbarkeit des Ergebnisses hängt von der Reihenfolge der Anzeige und der Anzahl der Filter ab.</i> <br><br>  Nachdem sich der Suchkreis auf mehrere Optionen beschränkt hat, können Sie mit dem Befehl <code>helm inspect</code> eine detailliertere Analyse der Diagramme durchführen.  Es zeigt den Inhalt der Diagrammdateien <code>Chart.yaml</code> , <code>values.yaml</code> und <code>README.md</code> .  Jeder Abschnitt kann einzeln mit den entsprechenden Argumenten angezeigt werden: <code>chart</code> , <code>values</code> und <code>readme</code> . <br><br>  Im offiziellen Repository sind Diagramme wunderschön dokumentiert und enthalten Verwendungsbeispiele. Einige Diagramme verfügen sogar über vorgefertigte Konfigurationen für die <b>Produktion</b> .  Eine gute <code>readme</code> wird beispielsweise von <a href="">Stable / WordPress</a> bereitgestellt <i>(für die Ausgabe in der Konsole siehe <code>helm inspect readme stable/wordpress</code> )</i> . <br><br>  Suchen ist ein guter Weg, um erschwingliche Pakete zu finden.  Nachdem das Paket gefunden wurde, können Sie es verwenden, um die Anwendung im Cluster zu installieren. <br><br><h2>  Erste Bewerbung </h2><br>  Beispielsweise wird das bereits erwähnte <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Stable / WordPress-</a> Diagramm ausgewählt. <br><br>  Es verwendet die in der Datei <code>values.yaml</code> beschriebenen Parameter.  Sie können die Parameter in einer YAML-Datei überschreiben und diese Datei dann während der Installation übertragen (Optionen <code>-f</code> , <code>--values</code> ).  Außerdem können sie direkt in der Befehlszeile überschrieben werden (Optionen <code>--set</code> , <code>--set-string</code> und <code>--set-file</code> ).  Alle Optionen können beliebig oft verwendet werden.  Gleichzeitig hat das Überschreiben in der Befehlszeile Vorrang vor Dateien mit Parametern. <br><br>  Beim Festlegen des Diagramms können Sie den <code>--name</code> mit der Option <code>--name</code> oder den von Helm generierten Zufallsnamen verwenden. <br><br>  Legen Sie das <a href="">Konfigurationsdiagramm für die Produktion fest</a> , ändern Sie den Namen des Blogs und deaktivieren Sie das Speichern von WordPress-Daten in <code>PersistentVolumeClaim</code> <i>(weitere Informationen zum persistenten Speicher finden Sie in der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kubernetes-Dokumentation</a> )</i> : <br><br><pre> <code class="bash hljs">$ curl https://raw.githubusercontent.com/helm/charts/master/stable/wordpress/values-production.yaml --output values-production.yaml $ helm install --name habr --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"wordpressBlogName=Flant's Blog!"</span></span> --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"persistence.enabled=false"</span></span> -f values-production.yaml stable/wordpress NAME: habr LAST DEPLOYED: Fri Aug 31 15:17:57 2018 NAMESPACE: default STATUS: DEPLOYED RESOURCES: ==&gt; v1/Secret NAME TYPE DATA AGE habr-mariadb Opaque 2 0s habr-wordpress Opaque 2 0s ==&gt; v1/ConfigMap NAME DATA AGE habr-mariadb-init-scripts 1 0s habr-mariadb 1 0s habr-mariadb-tests 1 0s ==&gt; v1/Service NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE habr-mariadb ClusterIP 10.111.7.232 &lt;none&gt; 3306/TCP 0s habr-wordpress ClusterIP 10.106.129.88 &lt;none&gt; 80/TCP,443/TCP 0s ==&gt; v1beta1/Deployment NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE habr-wordpress 3 3 3 0 0s ==&gt; v1beta1/StatefulSet NAME DESIRED CURRENT AGE habr-mariadb 1 1 0s ==&gt; v1beta1/Ingress NAME HOSTS ADDRESS PORTS AGE wordpress.local-habr wordpress.local 80, 443 0s ==&gt; v1/Pod(related) NAME READY STATUS RESTARTS AGE habr-wordpress-7955b95fd-hh7b9 0/1 ContainerCreating 0 0s habr-wordpress-7955b95fd-tgsxk 0/1 ContainerCreating 0 0s habr-wordpress-7955b95fd-xjz74 0/1 ContainerCreating 0 0s habr-mariadb-0 0/1 ContainerCreating 0 0s NOTES: 1. Get the WordPress URL: You should be able to access your new WordPress installation through https://wordpress.local/admin 2. Login with the following credentials to see your blog <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Username: user <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Password: $(kubectl get secret --namespace default habr-wordpress -o jsonpath=<span class="hljs-string"><span class="hljs-string">"{.data.wordpress-password}"</span></span> | base64 --decode)</code> </pre><br>  Wenn Sie mit einem vollwertigen Cluster arbeiten, können Sie den Empfehlungen aus dem obigen <i>NOTES-</i> Block folgen.  Wenn Sie Minikube haben, öffnen Sie die Site in einem Browser wie folgt: <br><br><pre> <code class="bash hljs">$ minikube service habr-wordpress Waiting, endpoint <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> service is not ready yet... Opening kubernetes service default/habr-wordpress <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> default browser...</code> </pre> <br>  Herzlichen Glückwunsch, die Anwendung befindet sich in einem Cluster! <br><br><img src="https://habrastorage.org/webt/on/bg/ub/onbgubke7d2hntrso3asemt5teq.png"><br><br>  Ein detailliertes Diagramm mit WordPress wurde in der Liste aller Helm-Versionen angezeigt: <br><br><pre> <code class="bash hljs">$ helm list NAME REVISION UPDATED STATUS CHART APP VERSION NAMESPACE habr 1 Fri Aug 31 15:17:57 2018 DEPLOYED wordpress-2.1.10 4.9.8 default</code> </pre><br>  Der nächste Schritt besteht darin, unsere Version zu aktualisieren und das Bild mit dem Blog zu ändern.  Beispielsweise wird ein anderes Tag aus demselben Docker-Repository ( <code>4.9.8-ol-7</code> ) verwendet: <br><br><pre> <code class="bash hljs">$ helm upgrade habr --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"image.tag=4.9.8-ol-7"</span></span> --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"wordpressBlogName=Flant's Blog!"</span></span> --<span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-string"><span class="hljs-string">"persistence.enabled=false"</span></span> -f values-production.yaml stable/wordpress Release <span class="hljs-string"><span class="hljs-string">"habr"</span></span> has been upgraded. Happy Helming! LAST DEPLOYED: Fri Aug 31 15:21:08 2018 NAMESPACE: default STATUS: DEPLOYED RESOURCES: ==&gt; v1/Service NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE habr-mariadb ClusterIP 10.111.7.232 &lt;none&gt; 3306/TCP 3m habr-wordpress ClusterIP 10.106.129.88 &lt;none&gt; 80/TCP,443/TCP 3m ==&gt; v1beta1/Deployment NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE habr-wordpress 3 4 2 0 3m ==&gt; v1beta1/StatefulSet NAME DESIRED CURRENT AGE habr-mariadb 1 1 3m ==&gt; v1beta1/Ingress NAME HOSTS ADDRESS PORTS AGE wordpress.local-habr wordpress.local 80, 443 3m ==&gt; v1/Pod(related) NAME READY STATUS RESTARTS AGE habr-wordpress-66f4fd6b74-gqwhh 0/1 Pending 0 0s habr-wordpress-66f4fd6b74-mf6vj 0/1 Pending 0 0s habr-wordpress-7955b95fd-hh7b9 1/1 Running 2 3m habr-wordpress-7955b95fd-tgsxk 1/1 Running 2 3m habr-wordpress-7955b95fd-xjz74 0/1 Terminating 2 3m habr-mariadb-0 1/1 Running 0 3m ==&gt; v1/Secret NAME TYPE DATA AGE habr-mariadb Opaque 2 3m habr-wordpress Opaque 2 3m ==&gt; v1/ConfigMap NAME DATA AGE habr-mariadb-init-scripts 1 3m habr-mariadb 1 3m habr-mariadb-tests 1 3m NOTES: 1. Get the WordPress URL: You should be able to access your new WordPress installation through https://wordpress.local/admin 2. Login with the following credentials to see your blog <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Username: user <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Password: $(kubectl get secret --namespace default habr-wordpress -o jsonpath=<span class="hljs-string"><span class="hljs-string">"{.data.wordpress-password}"</span></span> | base64 --decode)</code> </pre><br>  Bitte beachten Sie, dass Tiller <b>beim Aktualisieren</b> das empfangene Diagramm mit den Parametern mit dem zuletzt gespeicherten vergleicht und die entsprechenden Anforderungen in der Kubernetes-API ausführt und der <b>aktuelle Status der Release-Ressourcen nicht berücksichtigt wird</b> .  Es ist wichtig, diese Funktion zu verstehen und keine Fehler zu machen: <br><br><ul><li>  Das Update unterscheidet sich nicht von der Installation: Der Helm-Client sendet das Pinnen-Diagramm zusammen mit den Parametern. Sie müssen also vorsichtig sein und die Parameter und Dateien mit den Parametern angeben, die während der Installation (oder während des vorherigen Updates) festgelegt wurden und die nicht ignoriert werden sollten.  Im obigen Beispiel ist dies <code>--set "wordpressBlogName=Flant's Blog!" --set "persistence.enabled=false" -f values-production.yaml</code>  <code>--set "wordpressBlogName=Flant's Blog!" --set "persistence.enabled=false" -f values-production.yaml</code> . </li><li>  Anwendungen, die mit Helm eingeführt werden, sollten nur mit Helm bedient werden: Manuelle Änderungen, die mit <code>kubectl</code> werden, werden von Helm nicht berücksichtigt und können zu irreversiblen Konsequenzen führen. </li></ul><br>  Daher die logische Schlussfolgerung: Der <b>Prozess sollte automatisiert werden</b> , und Änderungen sollten nur durch Festschreiben an das Git-Repository, Ändern der Diagrammdateien und der CI-Konfigurationsdatei durchgeführt werden. <br><br>  Der Status von Anwendungsfreigabekomponenten in einem Cluster kann immer wie folgt überprüft werden: <br><br><pre> <code class="bash hljs">$ helm status habr LAST DEPLOYED: Fri Aug 31 15:21:08 2018 NAMESPACE: default STATUS: DEPLOYED RESOURCES: ==&gt; v1/Secret NAME TYPE DATA AGE habr-mariadb Opaque 2 4m habr-wordpress Opaque 2 4m ==&gt; v1/ConfigMap NAME DATA AGE habr-mariadb-init-scripts 1 4m habr-mariadb 1 4m habr-mariadb-tests 1 4m ==&gt; v1/Service NAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGE habr-mariadb ClusterIP 10.111.7.232 &lt;none&gt; 3306/TCP 4m habr-wordpress ClusterIP 10.106.129.88 &lt;none&gt; 80/TCP,443/TCP 4m ==&gt; v1beta1/Deployment NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE habr-wordpress 3 4 2 3 4m ==&gt; v1beta1/StatefulSet NAME DESIRED CURRENT AGE habr-mariadb 1 1 4m ==&gt; v1beta1/Ingress NAME HOSTS ADDRESS PORTS AGE wordpress.local-habr wordpress.local 80, 443 4m ==&gt; v1/Pod(related) NAME READY STATUS RESTARTS AGE habr-wordpress-66f4fd6b74-gqwhh 0/1 Pending 0 1m habr-wordpress-66f4fd6b74-mf6vj 1/1 Running 0 1m habr-wordpress-7955b95fd-hh7b9 1/1 Running 3 4m habr-wordpress-7955b95fd-tgsxk 1/1 Running 3 4m habr-mariadb-0 1/1 Running 1 4m NOTES: 1. Get the WordPress URL: You should be able to access your new WordPress installation through https://wordpress.local/admin 2. Login with the following credentials to see your blog <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Username: user <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> Password: $(kubectl get secret --namespace default habr-wordpress -o jsonpath=<span class="hljs-string"><span class="hljs-string">"{.data.wordpress-password}"</span></span> | base64 --decode)</code> </pre><br>  Mit Helm können Sie zu <b>einer bestimmten Release-Version zurückkehren</b> .  Derzeit gibt es zwei Revisionen: <br><br><pre> <code class="bash hljs">$ helm <span class="hljs-built_in"><span class="hljs-built_in">history</span></span> habr REVISION UPDATED STATUS CHART DESCRIPTION 1 Fri Aug 31 15:17:57 2018 SUPERSEDED wordpress-2.1.10 Install complete 2 Fri Aug 31 15:21:08 2018 DEPLOYED wordpress-2.1.10 Upgrade complete</code> </pre><br>  Setzen Sie die Anwendung auf den ursprünglichen Zustand zurück: <br><br><pre> <code class="bash hljs">$ helm rollback habr 1 Rollback was a success! Happy Helming!</code> </pre><br>  Jetzt wurde der Revisionsverlauf mit einem Datensatz ergänzt: <br><br><pre> <code class="plaintext hljs">$ helm history habr REVISION UPDATED STATUS CHART DESCRIPTION 1 Fri Aug 31 15:17:57 2018 SUPERSEDED wordpress-2.1.10 Install complete 2 Fri Aug 31 15:21:08 2018 SUPERSEDED wordpress-2.1.10 Upgrade complete 3 Fri Aug 31 15:25:06 2018 DEPLOYED wordpress-2.1.10 Rollback to 1</code> </pre><br>  Der Artikel neigt sich dem Ende zu und wird nicht mehr benötigt? <br><br><pre> <code class="bash hljs">$ helm delete habr release <span class="hljs-string"><span class="hljs-string">"habr"</span></span> deleted</code> </pre><br>  Wird es wirklich gelöscht? <br><br>  <b>Der Befehl entfernt die mit der Version verbundenen Kubernetes-Ressourcen, nicht jedoch die Version selbst</b> .  Alle Informationen zur Veröffentlichung bleiben verfügbar, einschließlich des Verlaufs: <br><br><pre> <code class="bash hljs">$ helm list --all NAME REVISION UPDATED STATUS CHART APP VERSION NAMESPACE habr 3 Fri Aug 31 15:25:06 2018 DELETED wordpress-2.1.10 4.9.8 default</code> </pre><br><pre> <code class="bash hljs">$ helm <span class="hljs-built_in"><span class="hljs-built_in">history</span></span> habr REVISION UPDATED STATUS CHART DESCRIPTION 1 Fri Aug 31 15:17:57 2018 SUPERSEDED wordpress-2.1.10 Install complete 2 Fri Aug 31 15:21:08 2018 SUPERSEDED wordpress-2.1.10 Upgrade complete 3 Fri Aug 31 15:25:06 2018 DELETED wordpress-2.1.10 Deletion complete</code> </pre><br>  <i><b>Hinweis</b> : Wie geplant kann die Remote-Version auf frühere Versionen zurückgesetzt werden. In neueren Versionen funktioniert diese Funktion jedoch nicht. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Weitere</a> Informationen finden Sie in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ausgabe 3722</a> .</i> <br><br>  Verwenden Sie die Option <code>--purge</code> um die Version vollständig zu entfernen: <br><br><pre> <code class="bash hljs">$ helm delete --purge habr release <span class="hljs-string"><span class="hljs-string">"habr"</span></span> deleted</code> </pre><br><h2>  Zusammenfassen </h2><br>  Dieser Artikel befasst sich mit der grundlegenden Architektur von Helm 2, seinen Komponenten und ihren Funktionen sowie den grundlegenden Grundelementen, Diagrammen, Releases und Diagrammrepositorys.  Wir haben Helm im Kubernetes-Cluster installiert und uns ein Bild über den Release-Lebenszyklus und die grundlegenden Befehle für die Arbeit damit gemacht. <br><br>  Das folgende Material aus dieser Reihe widmet sich dem Thema des <b>Erstellens eines eigenen Diagramms.</b> Darin werde ich auf die Struktur des Diagramms, die Standardisierungs- und Debugging-Tools eingehen.  <b>AKTUALISIERT</b> : Ein neuer Artikel ist unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">diesem Link</a> verfügbar. <br><br><h2>  PS </h2><br><ul><li>  „ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erstellen von Paketen für Kubernetes mit Helm: Diagrammstruktur und Vorlagen</a> “; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Paketmanager für Kubernetes - Helm: Vergangenheit, Gegenwart, Zukunft</a> "; </li><li>  „ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Übe mit dapp.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2. Bereitstellung von Docker-Images in Kubernetes mit Helm</a> "; </li><li>  " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Erstellen und Installieren von Anwendungen in Kubernetes mit dapp und GitLab CI</a> "; </li><li>  „ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Beste CI / CD-Praktiken mit Kubernetes und GitLab</a> “ <i>(Rezension und Videobericht)</i> . </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de420437/">https://habr.com/ru/post/de420437/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de420425/index.html">Theorie und Praxis der Verwendung von HBase</a></li>
<li><a href="../de420429/index.html">USE, RED, PgBouncer, seine Einstellungen und Überwachung</a></li>
<li><a href="../de420431/index.html">Mars Praktischer Leitfaden zum Terraforming für Hausfrauen</a></li>
<li><a href="../de420433/index.html">„Freitag-Format“: Musikalische Straßen - was ist das und warum sind sie nicht in Russland?</a></li>
<li><a href="../de420435/index.html">Schnellstart mit ARM Mbed: Entwicklung moderner Mikrocontroller für Anfänger</a></li>
<li><a href="../de420439/index.html">Fintech-Digest: Die Investitionen in Fintech beliefen sich auf 57 Milliarden US-Dollar, die Transaktionsgeschwindigkeit steigt und die Kosten sinken</a></li>
<li><a href="../de420441/index.html">Die 10 häufigsten Sicherheitsfehler in Python und wie man sie vermeidet</a></li>
<li><a href="../de420443/index.html">Cybersicherheitsexperten haben einen Skimmer-Detektor entwickelt - SkimReaper</a></li>
<li><a href="../de420447/index.html">Computer History Museum - der Ort, an dem die IT protokolliert wird</a></li>
<li><a href="../de420451/index.html">Server in den Clouds: Vorbereitung zum Start</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>