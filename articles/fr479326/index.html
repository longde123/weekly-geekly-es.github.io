<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçà ü¶Ü ü•ö Environnement Docker modulaire et r√©utilisable avec Carnotzet üíß ü§Æ üâê</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nous avons cr√©√© un outil qui int√®gre Docker et Maven pour aider des centaines de nos d√©veloppeurs √† g√©rer des environnements de d√©veloppement complexe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Environnement Docker modulaire et r√©utilisable avec Carnotzet</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479326/"><img src="https://habrastorage.org/webt/65/yv/ag/65yvagstopvbk7lwipkyr_ybrxs.jpeg" alt="image"><br><br>  Nous avons cr√©√© un outil qui int√®gre Docker et Maven pour aider des centaines de nos d√©veloppeurs √† g√©rer des environnements de d√©veloppement complexes avec des centaines de services, avec un minimum d'effort.  C'est une histoire sur la fa√ßon dont une id√©e folle est devenue r√©alit√©.  C'est l'histoire de <a href="https://github.com/swissquote/carnotzet" rel="nofollow">Carnotzet</a> . <br><a name="habracut"></a><br>  Tout a commenc√© il y a environ cinq ans (date de publication approximative le 3 ao√ªt 2017), Swissquote s'est rapidement d√©velopp√©e et d√©velopp√©e.  √Ä l'√©poque, nous comptions environ 70 d√©veloppeurs travaillant sur de grands projets Java (environ monolithiques), n√©cessitant chacun de passer 1 √† 2 jours pour configurer le lancement du projet localement.  Nous d√©testons perdre du temps sur des t√¢ches r√©p√©titives!  Il a donc √©t√© d√©cid√© d'am√©liorer ce processus en utilisant Vagrant et Chef pour automatiser le d√©ploiement de notre environnement de d√©veloppement local.  Cela a marqu√© le d√©but de notre premier projet Sandbox (Sandbox, approx.) <br><blockquote>  Nous souhaitons partager des environnements de d√©veloppement et de test l√©gers, reproductibles, isol√©s et portables. <br></blockquote>  Pendant un moment, tout s'est bien pass√©.  Les d√©veloppeurs pouvaient simplement t√©l√©charger le projet, ex√©cuter ¬´vagabond¬ª et se mettre au travail.  Nous avons utilis√© cette approche pendant environ deux ans et nous en avons √©t√© tr√®s satisfaits. <br><br>  Par la suite, travailler sur ces grandes applications est devenu plus difficile du fait que la logique m√©tier est devenue plus complexe (marque blanche de notre plateforme de trading).  Et nous avons d√©cid√© de faire ce que la plupart des organisations ont fait en 2014: briser la logique en microservices. <br><br>  Tout s'est bien pass√©, et en 2016, nous avions environ 150 (micro, environ) Services de production.  Mais les scripts Chef utilis√©s pour configurer les machines virtuelles ont augment√© et sont hors de contr√¥le.  Les environnements de d√©veloppement sont devenus beaucoup plus compliqu√©s pour certaines applications avec environ 30 d√©pendances.  Nous avons √©galement d√©couvert que la connaissance de Chef ne faisait pas partie de l'ensemble de comp√©tences standard de nos d√©veloppeurs.  Pour cette raison, de nombreuses personnes ont simplement fait fonctionner le script, parfois, en copiant de mauvais exemples.  En essayant de ne pas casser la configuration pour les autres √©quipes, ils ont cr√©√© des brunchs de longue dur√©e pour les besoins de leur propre √©quipe et, par cons√©quent, le code de configuration de l'environnement de d√©veloppement n'√©tait plus public. <br><br><img src="https://habrastorage.org/webt/v1/av/xf/v1avxfdqpntzolgiwldjlug-3xg.jpeg" alt="image"><br><br>  Nous avons d√ª le r√©parer. <br><br>  Les faiblesses suivantes de notre bac √† sable ont √©t√© identifi√©es: <br><br><ul><li>  Besoin de conna√Ætre le chef.  Et pour les d√©veloppeurs existants, et pour les d√©butants, apprendre ce framework √©tait un plaisir assez cher. <br>  En outre, cela n'√©tait redondant que pour l'environnement de d√©veloppement / test. </li><li>  Il n'y avait aucun moyen d'abstraction / composition facile ou de r√©utilisation d'une partie de la configuration de l'environnement.  Cela a conduit au fait que les gens devaient se plonger dans tous les d√©tails et les nuances de la configuration de d√©pendance de leurs projets, qui √©taient g√©n√©ralement pris en charge par d'autres √©quipes.  Cela a conduit √† un d√©saccord et √† une interaction inutile entre les √©quipes. </li></ul><br>  Afin de corriger le premier point, il a √©t√© d√©cid√© de passer √† l'utilisation de Docker.  Il a un seuil d'entr√©e inf√©rieur et offre √©galement d'autres avantages, tels que la normalisation, la prise en charge PaaS et un d√©ploiement plus facile dans plusieurs environnements. <br><br>  Nous avons √©galement envisag√© d'utiliser uniquement docker-compose.  Il avait l'air tr√®s prometteur, mais malgr√© son nom, il lui manquait des choses comme la possibilit√© de composition et, en m√™me temps, l'abstraction et la r√©utilisation.  Ce sont ces aspects dont nous avions besoin.  Nous r√™vions de pouvoir prendre l'environnement de d√©veloppement / test existant, y ajouter un service et √©ventuellement red√©finir une partie de sa configuration.  Nous voulions y parvenir sans avoir √† copier la configuration du service ajout√© ou √† plonger dans les d√©tails des d√©pendances transitives et leur configuration. <br><br>  C'est alors que nous avons eu cette id√©e: ¬´Et si nous prenions Maven, le syst√®me de gestion des d√©pendances que nous utilisons pour construire nos applications java, et commen√ßons √† l'utiliser pour construire nos environnements?¬ª  Cela nous permettrait d'abstraire nos d√©pendances transitives, les configurations de packages, d'en cr√©er des versions et de les r√©utiliser.  Il ne sera pas non plus n√©cessaire d'apprendre un nouveau syst√®me de gestion des d√©pendances. <br><br>  Apr√®s plusieurs tentatives, nous sommes parvenus √† la solution suivante: <br><br><ul><li>  Chaque artefact Maven repr√©sente un environnement enti√®rement fonctionnel qui peut √™tre utilis√© comme d√©pendance dans d'autres environnements.  (un environnement minimal peut √™tre repr√©sent√© par un service, par exemple, une base de donn√©es) </li><li>  Les fichiers JAR contiennent la configuration.  Variables d'environnement, fichiers de configuration d'application, nom Docker d'image, etc. </li><li>  Cette configuration peut √™tre remplac√©e dans les modules situ√©s plus haut dans la hi√©rarchie des d√©pendances, si n√©cessaire. </li><li>  La biblioth√®que Java peut soulever l'environnement complet (en utilisant docker-compose sous le capot) √† partir d'un module Maven (GAV ou pom.xml) </li></ul><br>  Maven permet de distribuer et de versionner ces artefacts (¬´artefacts d'environnement¬ª) et nous pouvons facilement partager le code source entre les √©quipes.  Le processus est devenu plus simple et les d√©veloppeurs ont commenc√© √† utiliser des modules d'autres √©quipes.  Et cr√©ez et entretenez √©galement le v√¥tre. <br><br>  En prime, tous les outils facilitant le travail avec Maven peuvent √™tre utilis√©s ici.  √Ä titre d'exemple, le graphe de d√©pendances g√©n√©r√© √† l'aide d'IntelliJ IDEA nous montre maintenant un sch√©ma de l'architecture pour l'interaction de nos d√©pendances :) <br><br><img src="https://habrastorage.org/webt/sq/b2/vm/sqb2vmxpahz9-zouvjdcd0ocfza.png" alt="image"><br>  Architecture d'un exemple d' <a href="https://github.com/dockersamples/example-voting-app" rel="nofollow">application de vote √† partir de docker-compose</a> <br><br>  Dans le m√™me temps, il y a eu quelques difficult√©s de mise en ≈ìuvre, telles que forcer toutes les √©quipes √† emballer des applications √† l'aide de Docker (dockerize) et √† regrouper des configurations dans des modules Maven distincts.  Par tous les comptes, il est devenu plus facile d'importer des applications √† partir d'autres √©quipes et de prendre en charge des environnements de d√©veloppement complexes. <br><br>  Nous avons commenc√© √† travailler dans ce sens il y a environ un an, et maintenant nous avons environ 200 de ces modules utilis√©s pour le d√©veloppement et les tests.  Nous sommes arriv√©s √† la conclusion que cette biblioth√®que est √©galement id√©ale pour g√©rer l'environnement temporaire pour les tests de bout en bout sur notre plate-forme CI. <br><br>  Nous √©tudions actuellement comment r√©utiliser cette technologie pour g√©rer nos environnements UAT / d'int√©gration en lan√ßant des conteneurs dans Kubernetes au lieu de docker-composer, et ainsi assurer des mises √† jour continues et une √©lasticit√© informatique sur des environnements beaucoup plus grands. <br><br>  J'esp√®re que vous serez heureux de savoir que notre projet a √©t√© ouvert sous la licence Apache 2.0 et est disponible sur Github: <a href="https://github.com/swissquote/carnotzet" rel="nofollow">github.com/swissquote/carnotzet</a> <br><br>  Utilisez :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr479326/">https://habr.com/ru/post/fr479326/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr479316/index.html">Bus d'int√©gration pour Bank SOYUZ (AO): conception et auto-test</a></li>
<li><a href="../fr479318/index.html">CLion 2019.3 est arriv√©! Am√©lioration de la vitesse de l'√©diteur et des nouvelles fonctionnalit√©s les plus attendues</a></li>
<li><a href="../fr479320/index.html">Num√©ro 28: Formation informatique - probl√®mes et d√©fis actuels des grandes entreprises</a></li>
<li><a href="../fr479322/index.html">Android, Google et licences de contenu gratuites. Qui est √† bl√¢mer et que faire</a></li>
<li><a href="../fr479324/index.html">Comment concevoir un syst√®me de notification. Instructions √©tape par √©tape avec des exemples</a></li>
<li><a href="../fr479328/index.html">3 raisons d'arr√™ter d'apprendre l'anglais au niveau interm√©diaire</a></li>
<li><a href="../fr479330/index.html">Une nouvelle solution √† l'ancien probl√®me d'Internet</a></li>
<li><a href="../fr479332/index.html">Ce que Uber et Vision Fund nous apprennent</a></li>
<li><a href="../fr479336/index.html">Android, Google et licences de contenu gratuites. Qui est √† bl√¢mer et que peut-on faire?</a></li>
<li><a href="../fr479340/index.html">"M√©fiez-vous, FAS!": Une tentative sur le P√®re No√´l, toute la v√©rit√© sur les ventes, les conflits de ski et un concours du Nouvel An avec des cadeaux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>