<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèª‚Äçüé® ‚è∞ üë©üèæ‚Äçüç≥ Qu√© (no) necesitas saber para crear juegos en Unity üôåüèæ üö∂üèª üññüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Unity es un motor de juego con un umbral de entrada lejos de cero (en comparaci√≥n con el mismo Game Maker Studio), y en este art√≠culo te dir√© qu√© prob...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Qu√© (no) necesitas saber para crear juegos en Unity</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/458914/"><img width="100%" src="https://habrastorage.org/webt/tf/uv/8n/tfuv8nnybrkzyxholyzuoaasafo.png"><br><br>  Unity es un motor de juego con un umbral de entrada lejos de cero (en comparaci√≥n con el mismo Game Maker Studio), y en este art√≠culo te dir√© qu√© problemas encontr√© al comenzar a estudiarlo y qu√© soluciones encontr√©.  Describir√© tales momentos con el ejemplo de mi juego de rompecabezas 2D para Android (que espero sea lanzado pronto en Play Market). <a name="habracut"></a><br><br>  No pretendo ser cierto, y no te insto a que repitas despu√©s de ti mismo, si conoces la mejor manera, solo te muestro c√≥mo hacerlo t√∫ mismo, y tal vez alguien que est√° comenzando a conocer a Unity crear√° su obra maestra independiente de gamedev con menos trabajo. <br><br>  Soy ingeniero de dise√±o de plantas de energ√≠a, pero siempre me ha interesado la codificaci√≥n y estoy familiarizado con algunos lenguajes de programaci√≥n.  Por lo tanto, acordamos que para crear juegos en Unity: <br><ul><li>  Necesita saber un poco de C # o JavaScript (al menos la sintaxis en forma de C). <br></li></ul><br>  Todo lo que se escribir√° a continuaci√≥n no es un tutorial de Unity, del cual ya se ha criado lo suficiente en la red sin m√≠.  A continuaci√≥n se recopilar√°n los momentos dif√≠ciles que pueden ocurrir al crear su primer proyecto en Unity. <br><br>  Vale la pena advertir que los scripts proporcionados omiten la mayor parte de la l√≥gica del juego (que representa "secretos comerciales"), pero su rendimiento como ejemplos ha sido verificado. <br><br><h3>  Problema uno - Orientaci√≥n </h3><br><img align="left" width="40%" src="https://habrastorage.org/webt/-f/za/hw/-fzahwdptbht2vwe1qm4xswgqkm.png"><br>  <b>Bloqueo de orientaci√≥n</b> <br>  La primera dificultad que surgi√≥ en m√≠ fue que no prest√© la debida atenci√≥n a la optimizaci√≥n de la interfaz visual para la orientaci√≥n de la pantalla.  La soluci√≥n es la m√°s simple: si no necesita un cambio en la orientaci√≥n de la pantalla para el juego, es mejor bloquearlo.  No hay necesidad de una flexibilidad excesiva, est√°s escribiendo un juego independiente, no un proyecto al otro lado de un mill√≥n de d√≥lares.  ¬øPor qu√© toneladas de transiciones condicionales y cambio de anclajes si el juego se ve mejor en Retrato (por ejemplo)?  Puede bloquear la orientaci√≥n de la pantalla aqu√≠: <br>  <b>Edici√≥n&gt; Configuraci√≥n del proyecto&gt; Reproductor</b> <br clear="all"><br clear="all"><img align="right" width="40%" src="https://habrastorage.org/webt/jb/3u/ot/jb3uotkehyw_t2pa2e__yw0n2ng.png"><br>  <b>Diferentes permisos</b> <br>  Tambi√©n es importante probar la interfaz visual con diferentes resoluciones en la orientaci√≥n seleccionada, y al realizar la prueba, no se olvide de la existencia de dispositivos con proporciones de 4: 3 (bueno, o 3: 4), para que podamos agregar de manera segura 768x1024 (o 1024x768). <br><br>  <b>Mejor posicionamiento</b> <br>  Para ajustar el posicionamiento y la escala de los objetos del juego, es mejor usar Rect Transform. <img align="left" width="40%" src="https://habrastorage.org/webt/rm/gk/ao/rmgkao3ttyvdkj3dbs8zmtxrm2o.png"><br><br clear="all"><br clear="all"><h3>  Problema dos - COMUNICACI√ìN </h3><br>  Tuve un problema similar debido al hecho de que conoc√≠ al desarrollador del juego a trav√©s de Game Maker Studio, donde el script es una parte completa del objeto del juego, e inmediatamente tiene acceso completo a todos los componentes del objeto.  Unity tiene scripts comunes, y solo se agregan instancias de ellos al objeto.  Hablando de manera simplista-figurativa, el script no sabe directamente en qu√© objeto se est√° ejecutando actualmente.  Por lo tanto, al escribir scripts, debe tener en cuenta la inicializaci√≥n de las interfaces para trabajar con los componentes de un objeto o con los componentes de otros objetos. <br><br>  <b>Nosotros entrenamos en gatos</b> <br>  En mi juego hay un objeto GameField, en el escenario solo hay una instancia del mismo, tambi√©n hay un script con el mismo nombre.  El objeto es responsable de mostrar la puntuaci√≥n del juego y de reproducir todo el sonido del juego, por lo que, en mi opini√≥n, es m√°s econ√≥mico para la memoria (en general, el juego tiene solo tres fuentes de audio: una m√∫sica de fondo y otros dos efectos de sonido).  El script resuelve los problemas de almacenamiento de una cuenta de juego, eligiendo AudioClip para reproducir sonido y para cierta l√≥gica del juego. <br><br>  Deteng√°monos en el sonido con m√°s detalle, ya que este ejemplo muestra f√°cilmente la interacci√≥n del gui√≥n con los componentes del objeto. <br><br><img width="40%" align="left" src="https://habrastorage.org/webt/2y/ll/ab/2yllabokihsyqwabiwnod3tiqyc.png">  Naturalmente, el objeto debe tener el script GameField.cs en s√≠ y el componente AudioSource, en mi caso dos completos (m√°s adelante quedar√° claro por qu√©). <br clear="all"><br clear="all">  Como se mencion√≥ anteriormente, el script "no sabe" que el objeto tiene un componente AudioSource, por lo tanto, declaramos e inicializamos la interfaz (por ahora, consideramos que solo hay un AudioSource): <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioSource Sound; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ Sound = GetComponent&lt;AudioSource&gt; (); }</code> </pre> <br>  El m√©todo GetComponent &lt;component_type&gt; () devolver√° el primer componente del tipo especificado del objeto. <br><br>  Adem√°s de AudioSource, necesitar√° varios AudioClip: <br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Header (</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Audio clips"</span></span></span><span class="hljs-meta">)</span></span>] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnStart; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnEfScore; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnHighScore; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnMainTimer; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnBubbMarker; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioClip OnScoreUp;</code> </pre><br>  En lo sucesivo, los comandos entre corchetes son necesarios para el Inspector`a, m√°s detalles <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . <br><br><img width="40%" align="left" src="https://habrastorage.org/webt/wk/t-/k7/wkt-k7spezw5hanfme5xchxexzk.png"><br><br>  Ahora el script en Inspector tiene nuevos campos en los que arrastramos los sonidos necesarios. <br><br clear="all"><br clear="all">  A continuaci√≥n, cree un m√©todo SoundPlay en el script que tome AudioClip: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ Sound.clip = Clip; Sound.Play (); }</code> </pre><br>  Para reproducir sonido en el juego, llamamos en el momento adecuado a este m√©todo con el clip. <br><br>  Hay un inconveniente significativo de este enfoque, solo se puede reproducir un sonido a la vez, pero durante el juego puede ser necesario reproducir dos o m√°s sonidos, con la excepci√≥n de la m√∫sica de fondo que se reproduce constantemente. <br><br>  Para evitar la cacofon√≠a, recomiendo evitar la posibilidad de reproducci√≥n simult√°nea de m√°s de 4-5 sonidos (preferiblemente un m√°ximo de 2-3), me refiero a los sonidos cortos de primer orden del juego (salto, moneda, disparo del jugador ...), para el ruido de fondo es mejor crear su propia fuente sonido en el objeto que hace este ruido (si necesita sonido 2d-3d) o un objeto responsable de todo el ruido de fondo (si no se necesita "volumen"). <br><br>  En mi juego, no hay necesidad de reproducir simult√°neamente m√°s de dos AudioClips.  Para garantizar la reproducci√≥n de ambos sonidos hipot√©ticos, agregu√© dos AudioSource al objeto GameField.  Para determinar los componentes en el script, usamos el m√©todo <br><pre> <code class="cs hljs">GetComponents&lt;_&gt;()</code> </pre><br>  que devuelve una matriz de todos los componentes del tipo especificado del objeto. <br><br>  El c√≥digo se ver√° as√≠: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> AudioSource[] Sound; <span class="hljs-comment"><span class="hljs-comment">//    void Start(){ Sound = GetComponents&lt;AudioSource&gt; (); //  GetComponents }</span></span></code> </pre><br>  La mayor√≠a de los cambios afectar√°n el m√©todo PlaySound.  Veo dos versiones de este m√©todo: "universal" (para cualquier n√∫mero de AudioSource en un objeto) y "torpe" (para 2-3 AudioSource, no el m√°s elegante pero requiere menos recursos). <br><br>  La opci√≥n "torpe" para dos AudioSource (lo us√©) <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Sound [<span class="hljs-number"><span class="hljs-number">0</span></span>].isPlaying) { Sound [<span class="hljs-number"><span class="hljs-number">0</span></span>].clip = Clip; Sound [<span class="hljs-number"><span class="hljs-number">0</span></span>].Play (); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Sound [<span class="hljs-number"><span class="hljs-number">1</span></span>].clip = Clip; Sound [<span class="hljs-number"><span class="hljs-number">1</span></span>].Play (); } }</code> </pre><br>  Puede ampliar hasta tres o m√°s AudioSource, pero la cantidad de condiciones devorar√° todos los ahorros de rendimiento. <br><br>  Opci√≥n "universal" <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (AudioSource _Sound <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Sound) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!_Sound.isPlaying) { _Sound.clip = Clip; _Sound.Play (); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } } }</code> </pre><br><br>  <b>Acceso a un componente extra√±o.</b> <br>  En el campo de juego hay varias instancias del prefabricado Fishka, como una ficha de juego.  Est√° construido as√≠: <br><ul><li>  Objeto padre con su SpriteRenderer; <ul><li>  El ni√±o se opone con su SpriteRenderer. </li></ul></li></ul><br>  Los objetos secundarios son responsables de dibujar el cuerpo del chip, su color, elementos mutables adicionales.  El padre dibuja un borde marcador alrededor del chip (el chip activo debe resaltarse en el juego).  El script solo est√° en el objeto padre.  Por lo tanto, para administrar sprites secundarios, el script primario necesita especificar estos sprites.  Lo organic√© as√≠: en el script cre√© interfaces para acceder a los hijos de SpriteRenderer: <br><pre> <code class="cs hljs">[<span class="hljs-meta"><span class="hljs-meta">Header (</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">"Graphic objects"</span></span></span><span class="hljs-meta">)</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> SpriteRenderer Marker; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Base; [Space] [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Center_Red; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Center_Green; [SerializeField] <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SpriteRenderer Center_Blue;</code> </pre><br>  Ahora el script en Inspector tiene campos adicionales: <br><img src="https://habrastorage.org/webt/mq/w9/kp/mqw9kpst-fen-bkdtgp_8jycpck.png"><br><br clear="all">  Arrastrar y soltar hijos en los campos correspondientes nos da acceso a ellos en el script. <br><br clear="all">  Ejemplo de uso: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//        Marker.enabled = !Marker.enabled; }</span></span></code> </pre><br><br clear="all">  <b>Llamar el gui√≥n de otra persona</b> <br>  Adem√°s de manipular componentes extra√±os, tambi√©n puede acceder al script de un objeto de terceros, trabajar con sus variables p√∫blicas, m√©todos, subclases. <br><br>  Dar√© un ejemplo sobre el objeto GameField ya conocido. <br><br>  El script GameField tiene un m√©todo p√∫blico FishkiMarkerDisabled (), que es necesario para "eliminar" un marcador de todas las fichas en el campo y se utiliza en el proceso de establecer un marcador al hacer clic en una ficha, ya que solo puede haber uno activo. <br><br>  En el script Fishka.cs, ‚Äã‚ÄãSpriteRenderer Marker es p√∫blico, es decir, se puede acceder desde otro script.  Para hacer esto, agregue la declaraci√≥n e inicializaci√≥n de las interfaces para todas las instancias de la clase Fishka en la secuencia de comandos GameField.cs (cuando se crea una secuencia de comandos, se crea la clase del mismo nombre) de forma similar a como se hace para varios AudioSource: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Fishka[] Fishki; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ Fishki = GameObject.FindObjectsOfType (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Fishka)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Fishka[]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">FishkiMarkerDisabled</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (Fishka _Fishka <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Fishki) { _Fishka .Marker.enabled = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } }</code> </pre><br>  En el script Fishka.cs, ‚Äã‚Äãagregue la declaraci√≥n e inicializaci√≥n de la interfaz de la instancia de la clase GameField, y cuando hagamos clic en el objeto, llamaremos al m√©todo FishkiMarkerDisabled () de esta clase: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GameField gf; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ gf = GameObject.FindObjectOfType (<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(GameField)) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> GameField; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ gf.FishkiMarkerDisabled(); Marker.enabled = !Marker.enabled; }</code> </pre><br>  Por lo tanto, puede interactuar entre scripts (o m√°s bien clases) de diferentes objetos. <br><br clear="all"><br clear="all"><h3>  Problema Tres - MANTENER </h3><br>  <b>Encargado de la cuenta</b> <br>  Tan pronto como aparece una cuenta en el juego, el problema inmediato es su almacenamiento, tanto durante el juego como fuera de √©l, tambi√©n quiero mantener un registro para alentar al jugador a superarlo. <br><br>  No considerar√© las opciones cuando todo el juego (men√∫, juego, retiro de cuenta) se construya en una escena, porque, en primer lugar, esta no es la mejor manera de construir el primer proyecto y, en mi opini√≥n, la escena de carga inicial deber√≠a ser .  Por lo tanto, estamos de acuerdo en que hay cuatro escenas en el proyecto: <br><ol><li>  cargador: una escena en la que se inicializa el objeto de m√∫sica de fondo (m√°s ser√° m√°s adelante) y carga la configuraci√≥n desde el guardado; <br></li><li>  men√∫: una escena con un men√∫; <br></li><li>  juego - escena del juego; <br></li><li>  puntaje: la escena del puntaje, registro, tabla de clasificaci√≥n. <br></li></ol><br><img width="40%" align="right" src="https://habrastorage.org/webt/dy/yl/4t/dyyl4tkmtx6a0ijbnjiy1jgkr9q.png"><br>  <i>Nota: El orden de carga de la escena se establece en Archivo&gt; Configuraci√≥n de compilaci√≥n.</i> <br clear="all"><br clear="all">  Los puntos acumulados durante el juego se almacenan en la variable Puntuaci√≥n de la clase GameField.  Para tener acceso a los datos cuando vaya a la escena de puntajes, cree una clase est√°tica p√∫blica ScoreHolder, en la que declaremos una variable para almacenar el valor y una propiedad para obtener y establecer el valor de esta variable (el m√©todo fue <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">espiado</a> por <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">apocatastas</a> ): <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ScoreHolder</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> _Score = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Score { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _Score; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>{ _Score = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } }</code> </pre><br>  No es necesario agregar una clase est√°tica p√∫blica a ning√∫n objeto, est√° disponible de inmediato en cualquier escena desde cualquier secuencia de comandos. <br><br>  Ejemplo de uso en la clase GameField en las puntuaciones del m√©todo de transici√≥n de escena: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine.SceneManagement; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">GameField</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> Score = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     ,         Scores void GotoScores(){ ScoreHolder.Score = Score; //   ScoreHolder.Score   SceneManager.LoadScene (‚Äúscores‚Äù); } }</span></span></code> </pre><br>  Del mismo modo, puede agregar una cuenta de registro al ScoreHolder durante el juego, pero no se guardar√° al salir. <br><br clear="all">  <b>Guardi√°n de configuraciones</b> <br>  Considere el ejemplo de guardar el valor de la variable booleana SoundEffectsMute, dependiendo del estado en el que el juego tenga o no efectos de sonido. <br><br>  La variable en s√≠ se almacena en la clase est√°tica p√∫blica SettingsHolder: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SettingsHolder</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _SoundEffectsMute = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> SoundEffectsMute{ <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _SoundEffectsMute; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>{ _SoundEffectsMute = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; } } }</code> </pre><br>  La clase es similar a ScoreHolder, incluso podr√≠a combinarlos en uno, pero en mi opini√≥n, esto es de mala educaci√≥n. <br><br>  Como puede ver en el script, por defecto _SoundEffectsMute se declara falso, por lo que cada vez que se inicia el juego, SettingsHolder.SoundEffectsMute devolver√° falso independientemente de si el usuario lo ha cambiado antes o no (se cambia usando el bot√≥n en la escena del men√∫). <br><br clear="all">  <b>Guardar variables</b> <br>  Lo m√°s √≥ptimo para una aplicaci√≥n de Android ser√° utilizar el m√©todo PlayerPrefs.SetInt para guardar (para obtener m√°s detalles, consulte la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">documentaci√≥n oficial</a> ).  Hay dos opciones para mantener el valor de SettingsHolder.SoundEffectsMute en PlayerPrefs, llam√©moslas "simple" y "elegante". <br><br clear="all">  La forma "simple" (para m√≠ as√≠) est√° en el m√©todo OnMouseDown () de la clase del bot√≥n mencionado anteriormente.  El valor almacenado se carga en la misma clase pero en el m√©todo Start (): <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ButtonSoundMute</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    ,  PlayerPrefs    bool switch (PlayerPrefs.GetInt ("SoundEffectsMute")) { case 0: SettingsHolder.SoundEffectsMute = false; break; case 1: SettingsHolder.SoundEffectsMute = true; break; default: //    default SettingsHolder.SoundEffectsMute = true; break; } } void OnMouseDown(){ SettingsHolder.SoundEffectsMute = !SettingsHolder.SoundEffectsMute; //    ,  PlayerPrefs    bool if (SettingsHolder.SoundEffectsMute) PlayerPrefs.SetInt ("SoundEffectsMute", 1); else PlayerPrefs.SetInt ("SoundEffectsMute", 0); } }</span></span></code> </pre><br><br clear="all">  El m√©todo "elegante", en mi opini√≥n, no es el m√°s correcto, porque  complica el mantenimiento del c√≥digo, pero hay algo en √©l, y no puedo evitar compartirlo.  Una caracter√≠stica de este m√©todo es que se llama al configurador de la propiedad SettingsHolder.SoundEffectsMute en un momento que no requiere un alto rendimiento, y se puede cargar (oh, horror) usando PlayerPrefs (lectura - escritura en un archivo).  Cambie la clase est√°tica p√∫blica SettingsHolder: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">SettingsHolder</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _SoundEffectsMute = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> SoundEffectsMute{ <span class="hljs-keyword"><span class="hljs-keyword">get</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _SoundEffectsMute; } <span class="hljs-keyword"><span class="hljs-keyword">set</span></span>{ _SoundEffectsMute = <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_SoundEffectsMute) PlayerPrefs.SetInt (<span class="hljs-string"><span class="hljs-string">"SoundEffectsMute"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> PlayerPrefs.SetInt (<span class="hljs-string"><span class="hljs-string">"SoundEffectsMute"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); } } }</code> </pre><br>  El m√©todo OnMouseDown de la clase ButtonSoundMute se simplificar√° a: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseDown</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ SettingsHolder.SoundEffectsMute = !SettingsHolder.SoundEffectsMute; }</code> </pre><br><br clear="all">  No vale la pena cargar el captador con la lectura de un archivo, ya que est√° involucrado en un proceso cr√≠tico para el rendimiento, en el m√©todo PlaySound () de la clase GameField: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PlaySound</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">AudioClip Clip = </span></span><span class="hljs-literal"><span class="hljs-function"><span class="hljs-params"><span class="hljs-literal">null</span></span></span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!SettingsHolder.SoundEffectsMute) { <span class="hljs-comment"><span class="hljs-comment">//      ‚Äú‚Äù  (. ) if (!Sound [0].isPlaying) { Sound [0].clip = Clip; Sound [0].Play (); } else { Sound [1].clip = Clip; Sound [1].Play (); } } }</span></span></code> </pre><br><br clear="all">  De la manera anterior, puede organizar el almacenamiento en el juego de cualquier variable. <br><br clear="all"><br clear="all"><h3>  Quinto problema: UNO PARA TODOS </h3><br>  <b>Esta musica sera eterna</b> <br>  Tarde o temprano, todos se enfrentan a ese problema, y ‚Äã‚Äãyo no fui la excepci√≥n.  Seg√∫n lo planeado, la m√∫sica de fondo comienza a reproducirse incluso en la escena del men√∫, y si no est√° apagada, reproduce el men√∫, el juego y los puntajes en las escenas sin interrupci√≥n.  Pero si el objeto que "reproduce" la m√∫sica de fondo se instala en la escena del men√∫, cuando va a la escena del juego, se destruye y el sonido desaparece, y si coloca el mismo objeto en la escena del juego, luego de la transici√≥n, la m√∫sica se reproduce primero.  La soluci√≥n result√≥ ser el uso del m√©todo DontDestroyOnLoad (Object target) ubicado en el m√©todo Start () de la clase cuya instancia de script tiene el objeto "music".  Para hacer esto, cree el script DontDestroyThis.cs: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DontDestroyThis</span></span>: <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Start</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ DontDestroyOnLoad(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.gameObject); } }</code> </pre><br><img width="40%" align="left" src="https://habrastorage.org/webt/ee/cj/hn/eecjhn5uyzoclq7ywnqztl1untu.png">  Para que todo funcione, el objeto "musical" debe ser root (en el mismo nivel jer√°rquico que la c√°mara principal). <br clear="all"><br clear="all">  <b>¬øPor qu√© m√∫sica de fondo en el cargador?</b> <br>  La captura de pantalla muestra que el objeto "musical" no se encuentra en la escena del men√∫ sino en la escena del cargador.  Esta es una medida causada por el hecho de que la escena del men√∫ se puede cargar m√°s de una vez (despu√©s de la escena de partituras, la transici√≥n a la escena del men√∫), y cada vez que se carga, se crear√° otro objeto "musical" y el antiguo no se eliminar√°.  Se puede hacer como en el ejemplo de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">la documentaci√≥n oficial</a> , pero decid√≠ aprovechar el hecho de que la escena del cargador solo se carga una vez. <br><br>  En esto, los problemas clave que encontr√© al desarrollar mi primer juego en Unity, antes de subirlos a Play Market (a√∫n no he registrado una cuenta de desarrollador), terminaron con √©xito. <br><br>  <b>PS</b> <br>  <i>Si la informaci√≥n fue √∫til, puede apoyar al autor, y finalmente registrar√° una cuenta de desarrollador de Android.</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/458914/">https://habr.com/ru/post/458914/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../458904/index.html">Visualizaci√≥n del n√∫mero de victorias para los equipos de la NBA utilizando gr√°ficos de barras animados en R</a></li>
<li><a href="../458906/index.html">[Ekaterimburgo, anuncio] Flutteron - un taller sobre desarrollo en Flutter</a></li>
<li><a href="../458908/index.html">Escaneo de documentos a trav√©s de la red</a></li>
<li><a href="../458910/index.html">Benchmarking PostgreSQL con grandes p√°ginas de Linux</a></li>
<li><a href="../458912/index.html">Migrar a Zimbra con imapsync</a></li>
<li><a href="../458916/index.html">Debajo del cap√≥ de React. Escribimos nuestra implementaci√≥n desde cero</a></li>
<li><a href="../458918/index.html">Lo que puedes aprender del dise√±o de juegos hiper-casuales</a></li>
<li><a href="../458920/index.html">Conferencia para fan√°ticos de DevOps</a></li>
<li><a href="../458922/index.html">C√≥mo pasar de ESXi a KVM / LXD y no perder la cabeza</a></li>
<li><a href="../458924/index.html">Los accidentes te ayudan a aprender</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>