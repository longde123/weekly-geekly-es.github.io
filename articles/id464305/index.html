<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>☕️ 🌅 ⛺️ Kecil ya. Membuka kotak microvirtual Firecracker 🙏🏻 👨🏻‍🍳 👇🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Rekam mikrovirtual Petasan. Kami mengambil dua metode populer untuk mengisolasi beban kerja multi-pengguna - mesin dan wadah virtual. Kami memeras yan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kecil ya. Membuka kotak microvirtual Firecracker</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/oleg-bunin/blog/464305/">  Rekam mikrovirtual Petasan.  Kami mengambil dua metode populer untuk mengisolasi beban kerja multi-pengguna - mesin dan wadah virtual.  Kami memeras yang terbaik dari kedua pendekatan, menyederhanakan sebanyak mungkin, menguji pada beban nyata.  Akibatnya, kami mendapatkan isolasi komputer virtual yang tidak dapat ditembus yang dapat diluncurkan dalam ratusan milidetik.  Solusi ini bekerja di bawah naungan AWS Lambda dan Fargate, menjalankan jutaan fungsi dan wadah tanpa server setiap detik di cloud.  Ini disebut Petasan. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rm/ps/oo/rmpsoo1w1jptnyp2qwsaestydsq.png" width="400"></div><br><br>  Alat mikrovirtualisasi ini tersedia di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">OpenSource</a> .  Jika tugas Anda memerlukan isolasi multi-penyewa, (misalnya, Anda memutuskan untuk membuat cloud sendiri), Firecracker adalah yang Anda butuhkan. <br><br>  <strong>Vasily Pantyukhin</strong> , arsitek Amazon Web Services, berbicara tentang arsitektur Firecracker, bagaimana itu digunakan oleh AWS Lambda, membandingkannya dengan solusi alternatif dan memberikan contoh integrasi. <br><br>  <em>Penafian: Segala sesuatu di bawah ini adalah pendapat pribadi Vasily, dan itu mungkin tidak sesuai dengan posisi Amazon Web Services.</em> <br><a name="habracut"></a><br><iframe width="560" height="315" src="https://www.youtube.com/embed/cfsICOzt6Do" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2>  Fitur alami dari awan publik </h2><br><blockquote>  Salah satu sifat mendasar dari cloud publik adalah multi-tenancy. </blockquote><br>  Seseorang menerjemahkan istilah ini sebagai "multi-tenancy" atau "multi-user environment."  Tetapi dari sudut pandang saya, ini tidak mencerminkan esensi.  Multi-tenancy adalah ketika pengguna yang berbeda dan muatannya hidup di infrastruktur fisik yang sama, berbagi di antara mereka sendiri, tetapi tidak tahu apa-apa tentang satu sama lain.  Dari beban kerja multi-pengguna, multi-tenancy dibedakan oleh persyaratan yang lebih ketat secara fundamental untuk isolasi sumber daya dan akses ke sana. <br><br><blockquote>  Properti lain yang melekat dalam cloud publik adalah highload. </blockquote><br>  Percayalah, dalam kasus AWS, ini adalah beban yang sangat besar!  Tangkapan layar adalah contoh data nyata.  Saya tidak akan mengatakan berapa lama dan di wilayah mana jutaan "kakatua" ini diukur, tetapi ini bukan semacam darurat, tetapi mode operasi yang biasa bagi kami. <br><br><img src="https://habrastorage.org/webt/up/dt/qs/updtqsp7dmtqk1czi5f2zuscbkq.png"><br><br>  Ternyata kontradiksi tertentu.  Di satu sisi, kita perlu membuat pengguna terisolasi mungkin.  Di sisi lain, kita harus memastikan tingkat produktivitas dan pemanfaatan sumber daya yang sangat tinggi.  Memperbaiki satu sering menyebabkan keterbatasan yang lain.  Bagaimana menemukan kompromi, dan bahkan lebih baik, untuk mendapatkan hasil maksimal di semua lini? <br><br><h2>  Mesin atau wadah virtual? </h2><br>  Ada dua pendekatan dasar yang berpotensi membantu.  Ini adalah mesin dan wadah virtual.  Masing-masing memiliki pro dan kontra. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dj/hl/ba/djhlbailazcjnfxycokcrv38a64.png" width="400"></div><br><br>  Kerugian utama dari mesin virtual adalah bahwa mereka membutuhkan waktu <strong>lama untuk memuat</strong> .  Biasanya diperlukan puluhan detik, atau bahkan beberapa menit, untuk menghidupkan mesin.  Tetapi virtualoks memiliki sifat baik - mereka <strong>melindungi</strong> muatan <strong>beton</strong> dari satu sama lain.  Dan dari kedua sudut pandang: <br><br><ul><li>  <strong>keamanan</strong> ketika satu mesin virtual tidak dapat mengakses data di komputer lain; </li><li>  <strong>sumber daya</strong> , ketika saya memesan memori 8 GB, saya berharap bahwa RAM ini akan menjadi milik saya dan tidak ada yang bisa mengklaim sumber daya yang saya bayar. </li></ul><br>  Sebaliknya dengan wadah: mereka ringan dan karena itu <strong>memuat sangat cepat.</strong>  Mereka dapat dengan mudah diskalakan secara horizontal.  Tetapi ada satu fitur yang dengannya kita, sebagai penyedia cloud publik, tidak dapat hidup.  Mereka menggunakan <strong>kernel yang dibagikan - kernel OS dibagikan di antara semua kontainer</strong> . <br><br><img src="https://habrastorage.org/webt/pa/pz/hm/papzhmvppqzce7pxbezk8bp9owg.png"><br><br>  Bisakah wadah dikatakan tidak aman?  Tidak, meskipun ada kerentanan serius. <br><br><blockquote>  Saya percaya bahwa hari ini wadah yang "dilas" dengan benar memberikan tingkat keamanan yang memadai. </blockquote><br>  Masalahnya berbeda - kernel yang dibagikan tidak secara fundamental menjamin bahwa suatu saat di masa depan, kerentanan tidak akan muncul yang memecah isolasi penyewa.  Cloud publik tidak mampu membelinya bahkan dalam teori. <br><br>  Ada kontradiksi lain, dan solusi harus dicari.  Cara termudah adalah mengambil semua yang terbaik dari ibu - mesin virtual, dan dari ayah - wadah, silangkan dan dapatkan sesuatu yang <strong>konvergen</strong> .  Sebenarnya, kita berhasil.  Ternyata Petasan. <br><br>  Petasan sudah dalam produksi.  Dalam layanan kritis yang sama, misalnya, AWS Lambda (fungsi serverless) dan AWS Fargate (serverless-container). <br><br><h3>  Masalah AWS Lambda lama </h3><br>  AWS Lambda adalah layanan fitur tanpa server.  Kami mengambil fungsi dalam Java, Go, Python atau bahasa lain, kami membuangnya di Lambda, dan dijalankan secara ajaib.  Tidak perlu mengalokasikan dan mengelola sumber daya.  Bagaimana ini diterapkan sebelumnya? <br><br><img src="https://habrastorage.org/webt/ou/ck/-s/ouck-sm6pjv4ul6t13dwlefxtry.png"><br><br>  Untuk setiap akun AWS, satu atau lebih mesin virtual EC2 terpisah dialokasikan untuk mengisolasi fungsi yang dimiliki oleh penyewa yang berbeda.  Mesin virtual semacam itu menghabiskan sumber daya, bahkan ketika ia tidak melakukan apa pun.  Misalkan kita menjalankan fungsi sekali setiap 10 menit, dan dijalankan dalam 200 ms seperti Lambda biasa.  Ternyata dalam satu jam mesin EC2 hanya digunakan beberapa detik.  Selain itu, bahkan saat runtime, ia tidak mengkonsumsi semua sumber daya yang tersedia - pembuangan di bawah alas tiang.  Ini sangat tidak menguntungkan. <br><br><img src="https://habrastorage.org/webt/jy/lo/0q/jylo0qlzudppsa5042qv858mfya.png"><br><br><h3>  Bagaimana Anda memecahkan masalah daur ulang? </h3><br>  Dikembangkan dari awal, solusi Firecracker mereka sendiri.  Ini jelas dari judul laporan :) <br><br>  Untuk mulai mengembangkan produk baru, Anda memerlukan tugas teknis.  Ini memiliki banyak teks, tetapi jika Anda hanya memilih artinya, Anda mendapatkan yang berikut. <br><br><ul><li>  <strong>Didukung oleh KVM</strong> sebagai hypervisor.  Siapa pun yang bekerja dengan AWS tahu bahwa kami memiliki dua hypervisor favorit.  VM lawas berjalan di Xen.  Sejak akhir 2017, KVM telah hidup di bawah kap semua mobil. </li><li>  <strong>Itu dimulai secepat mungkin.</strong>  Pada perangkat keras referensi, persyaratannya adalah beban penuh mikrovirtual dalam 125 ms. </li><li>  <strong>Overhead virtualisasi minimum</strong> .  Dalam arsitektur referensi, satu mesin mikro-virtual Firecracker juga hanya mengkonsumsi memori 5 MB. </li><li>  <strong>Kemungkinan awal paling padat</strong> .  Parameter desain - beban penuh 5 mikrovirtual per inti per detik.  Persyaratan ini sangat mendasar untuk layanan seperti AWS Lambda.  Fungsi harus cepat lepas landas, berolahraga dan mati, membebaskan sumber daya untuk selanjutnya. </li><li>  <strong>Kemungkinan berlangganan kembali</strong> .  Ini adalah kesempatan - tidak perlu menggunakannya.  Bahkan, ini adalah alokasi sumber daya virtual ke tingkat yang lebih besar daripada yang tersedia secara fisik.  Ini berarti bahwa server memiliki 16 GB RAM, dan Anda secara bersamaan menjalankan 4 mesin virtual di atasnya, yang masing-masing yakin bahwa ia memiliki 8 GB memori. </li></ul><br><h3>  AWS Lambda dengan Petasan di bawah kap </h3><br>  Apa yang berubah di AWS Lambda versi baru?  Dari sudut pandang pengguna akhir, tidak ada yang berubah.  Migrasi ke arsitektur yang diperbarui dalam produksi benar-benar transparan dan tidak terlihat oleh konsumen.  Fitur Lambda berumur pendek - itu mudah dilakukan. <br><br>  Seperti apa arsitektur modern? <br><br><blockquote>  Pada level terendah sekarang bukan mesin virtual, tetapi fisik logam kosong. </blockquote><br>  Server semacam itu memungkinkan penggunaan penuh semua fungsi CPU, misalnya, Intel VT.  Ini memberikan manfaat tambahan saat menggunakan virtualisasi di tingkat yang lebih tinggi. <br><br><img src="https://habrastorage.org/webt/rg/i6/s3/rgi6s36v7vgfuc2onnb-cuahbui.png"><br><br>  Di atas potongan besi adalah <strong>OS host</strong> dengan modul KVM di kernel.  Mikro petualang dengan <strong>OS tamu</strong> mereka sendiri diluncurkan di atas.  Ya, mereka sudah mengimplementasikan komponen layanan AWS Lambda itu sendiri. <br><br>  Sebelumnya, untuk setiap pelanggan yang menggunakan fitur Lambda, kami mengalokasikan mesin virtual EC2 terpisah dengan pemanfaatan rendah.  Pendekatan baru memungkinkan Anda untuk menjalankan microvirtual ringan hanya ketika Anda benar-benar membutuhkannya.  Mengisolasi sumber daya Petasan satu sama lain memungkinkan kami melakukan ini pada perangkat keras umum dengan kepadatan maksimum.  Pemanfaatan sumber daya telah meningkat secara mendasar. <br><br><h2>  Apa yang ada di dalam kotak? </h2><br>  Saya berjanji anboxing, jadi mari kita lihat komponen utama Firecracker, pertimbangkan masing-masing secara terpisah, dan kemudian kumpulkan semuanya. <br><br><img src="https://habrastorage.org/webt/o_/by/mq/o_bymqjtw5d6aomlwpmfa7grqgk.jpeg"><br><br><h3>  Prinsip desain </h3><br>  Ketika kami pertama kali mulai membahas pengembangan Petasan, kami sepakat untuk mematuhi dua prinsip. <br><br>  <strong>Singkirkan semua yang tidak perlu.</strong>  Mengapa mesin virtual klasik dimuat dengan lambat?  Khususnya, karena kode kelebihan beban.  Mereka harus mendukung sejumlah besar perangkat warisan.  Tapi mengapa meniru perangkat yang tidak digunakan orang lain 10 tahun yang lalu?  Tidak perlu, oleh karena itu, kami menyingkirkan semua yang tidak perlu.  Kami menyelesaikan tugas sempit tertentu dan fungsi apa pun yang tidak membantu menyelesaikan masalah ini dianggap tidak perlu. <br><br><blockquote>  Singkirkan semua yang tidak perlu dan fokus pada satu tugas. </blockquote><br>  <strong>Sederhanakan apa yang tersisa.</strong>  Bahkan apa yang tersisa harus sesederhana mungkin. <br><br><h3>  Apa yang mereka tulis? </h3><br>  Petasan ditulis dalam Rust yang trendi karena: <br><br><ul><li>  ini memungkinkan Anda untuk menulis <strong>kode yang</strong> lebih <strong>aman</strong> , khususnya, dalam hal memori; </li><li>  <strong>Kinerja</strong> dan overhead sebanding dengan C ++ modern; </li><li>  Rust <strong>telah digunakan sejak lama,</strong> sejak 2015 telah menulis banyak solusi keren yang keren. </li></ul><br><h3>  Besi </h3><br>  Saya ulangi - Petasan membutuhkan instalasi pada perangkat keras nyata.  Sebagai konfigurasi referensi, mesin bare-metal i3.metal dipilih. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/rg/to/nh/rgtonh5b1jbhgpzizky2wc6bsfk.png" width="400"></div><br>  <em>Catatan: laporan itu pada awal April 2019. Saat itu, hanya platform Intel yang didukung.</em>  <em>Pada bulan Mei, mereka menambahkan dukungan alpha untuk AMD, dan pada bulan Juni ARM.</em>  <em>AMD mungkin sedikit lebih murah daripada Intel, dan dukungan ARM menawarkan peluang menarik untuk bekerja dengan IoT multi-tenant.</em> <br><br>  Jika Anda memesan mesin i3.metal atau bare-metal lainnya di AWS, maka untuk eksperimen itu akan terlalu kuat dan konfigurasi mahal.  Karena itu, jika Anda memutuskan untuk menginstal Firecracker pada mereka, maka jangan lupa untuk melunasi mesin-mesin ini setelah percobaan.  Kalau tidak, skor yang layak akan datang pada akhir bulan. <br><br>  Apakah ada opsi yang lebih murah?  Ya, Anda dapat mem-boot Petasan di lingkungan virtual.  Tetapi tidak di AWS lagi - pada dasarnya kami tidak mendukung virtualisasi bersarang di EC2.  Tetapi Anda bisa melakukannya di GCP, Azure, DigitalOcean atau menggunakan Proxmox, Parallels, VMware Fusion.  Semuanya akan berfungsi jika Anda mematuhi persyaratan, khususnya, sesuai dengan versi kernel dari OS tamu. <br><br><h3>  Intinya </h3><br><blockquote>  Elemen mendasar dari solusinya adalah modul kernel KVM. </blockquote><br>  Untuk jaga-jaga, saya akan menggambarkan sebagai penyimpangan apa KVM itu.  Ini bukan seluruh hypervisor, tetapi hanya sebagian saja.  Tugas utamanya adalah <strong>menyiapkan prosesor virtual</strong> (vCPU) dan <strong>memulai mesin virtual</strong> . <br><br><img src="https://habrastorage.org/webt/gp/3l/ee/gp3leep27-zq3yzx9fiiho15pkm.png"><br><br>  Tetapi ini tidak cukup untuk pekerjaan penuh.  Selain prosesor, beberapa perangkat lain dibutuhkan.  Persaingan mereka terjadi di ruang pengguna. <br><br><h3>  VMM </h3><br>  Untuk setidaknya perangkat dasar muncul, Anda memerlukan komponen lain - Virtual Machine Manager (VMM).  Sebelum Firecracker, opsi VMM utama adalah QEMU. <br><br><img src="https://habrastorage.org/webt/kg/s8/kr/kgs8krmluije10ql6x6vtch7f9g.png"><br><br>  Kami serius mempertimbangkan kemungkinan menggunakan QEMU, tetapi memutuskan untuk mengembangkan "sepeda" kami sendiri.  Ada beberapa alasan untuk ini. <br><br>  <strong>Manajemen pengembangan</strong> .  QEMU adalah produk besar dan matang dengan lebih dari sejuta baris kode.  Untuk melakukan perubahan, Anda perlu melihat terlalu banyak kode sumber.  Banyak orang berpartisipasi dalam pengembangan dan pengambilan keputusan tentang pembangunan. <br><br>  <strong>Keamanan</strong>  QEMU dapat meniru banyak perangkat.  Itu sebabnya ia memiliki permukaan serangan yang cukup besar.  Tugas kita adalah membuat mikrovirtual.  Dari sudut pandang keamanan, kita harus meminimalkan permukaan serangan. <br><br>  <strong>Kebutuhan untuk mengimplementasikan fitur-fitur baru.</strong>  QEMU memiliki kode yang baik.  Ini adalah produk matang di mana semua bug yang jelas sudah tertangkap.  Tetapi dalam bentuk saat ini, fungsionalitas QEMU masih tidak sesuai dengan kita - kita harus menambahkan banyak.  Dari sudut pandang ini, kode baru dalam QEMU dan produk baru akan memiliki kualitas yang sama.  Karena itu, kemenangan khusus tidak akan berhasil. <br><br><h3>  Perangkat </h3><br>  Petasan mengimplementasikan VMM, yang digunakan untuk meniru perangkat.  Kami meniru perangkat berikut: <br><br><ul><li>  <strong>Konsol</strong>  Suatu hal yang bermanfaat dan perlu, meskipun bisa dimatikan. </li><li>  <strong>Keyboard</strong>  Kami membuat keyboard yang rumit - hanya dengan satu tombol "Reset".  Kami tidak mempercayai "Reset" perangkat lunak dari sistem operasi yang berpotensi berjalan di Firecracker.  Karena itu, mereka membuat besi. </li><li>  <strong>Driver Virtio untuk disk dan jaringan</strong> .  Virtio adalah perangkat yang sangat primitif.  Intinya, ini adalah "ring buffer".  Sistem tamu menulis sesuatu ke buffer, mengklik panggilan, dan sistem host membaca data dari buffer ini melalui file. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pv/av/hw/pvavhwc_g42zvrjrg7ftiqmcfda.png" width="500"></div><br><br>  Dalam beberapa kasus, misalnya, untuk integrasi dengan wadah, kita masih memerlukan perangkat jaringan yang akan mewakili fungsionalitas dasar kartu jaringan biasa.  Virtio tidak cocok di sini, terlalu sederhana.  Karena itu, untuk jaringan kami menggunakan perangkat lain - <strong>Vsock</strong> . <br><br>  Kita juga perlu kemampuan untuk mengendalikan konsumsi sumber daya.  <strong>Pembatas laju</strong> bertanggung jawab untuk ini. <br><br>  Ada beberapa perangkat.  Tetapi bagaimana cara mengatur dan mengkonfigurasi mikrovirtual?  API manajemen akan membantu kami di sini. <br><br><h3>  Manajemen </h3><br>  Amazon memiliki beberapa prinsip dasar yang tidak dapat dipecahkan.  Salah satunya adalah bahwa setiap layanan berkomunikasi satu sama lain hanya melalui API.  Tidak masalah apakah ini adalah layanan eksternal yang Anda gunakan sebagai pengguna, atau layanan internal kami.  Itu tidak terjadi bahwa satu layanan langsung ke database layanan lain - itu dilarang dan dihukum.  Thread Firecracker API hanya digunakan untuk mengakses pengaturan dan fungsionalitas microvirtuals melalui REST API. <br><br><img src="https://habrastorage.org/webt/1s/qj/bt/1sqjbtijgutp6qfwscgu_vnq1va.png"><br><br>  Kami mematuhi spesifikasi Open API, sehingga Anda dapat menggunakan Swagger. <br><br><h3>  Metadata </h3><br>  Ada pengkodean yang sangat buruk.  Inilah saat beberapa data dijahit langsung ke dalam kode, misalnya, login dan kata sandi akses ke sumber daya lain.  Ini, tentu saja, tidak diizinkan.  Secara berkala, kita perlu mentransfer beberapa data di dalam microvirtual.  Ini dilakukan melalui <strong>layanan metadata</strong> . <br><br><img src="https://habrastorage.org/webt/q_/ll/0m/q_ll0msnhoarxu6k5aag0ie2fug.png"><br><br>  Kami meneruskan informasi yang diperlukan melalui soket ke perdagangan metadata IMDS.  Untuk mendapatkan informasi ini di dalam microvirtual, Anda perlu meminta <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">http://169.254.169.254/latest/meta-data</a> menggunakan REST API.  Pengguna AWS sudah mengetahui IP ajaib ini.  Dengan cara yang sama, mikrovirtual dapat memperoleh informasi terperinci tentang konfigurasi mereka sendiri. <br><br><h3>  Log </h3><br>  Sangat penting untuk dapat membuang log microvirtuals ke dunia luar sebelum dia meninggal.  Ini dilakukan melalui <strong>FIFO</strong> Unix biasa. <br><br><img src="https://habrastorage.org/webt/vr/p6/ib/vrp6ibzybyivbp68mi7wt1awobc.png"><br><br><h3>  Isolasi tambahan </h3><br>  Plus utama dari mesin virtual secara terpisah.  Tampaknya ini sudah cukup, tetapi kami melangkah lebih jauh.  Untuk berjaga-jaga, untuk menjalankan produksi disarankan untuk meletakkan lapisan isolasi tambahan yang disebut <strong>Jailer</strong> . <br><br><img src="https://habrastorage.org/webt/1o/_2/j6/1o_2j6t6y7_ae7h1cmzk36xqliq.png"><br><br>  Ini adalah tindakan pencegahan standar: <br><br><ul><li>  <strong>cgroups</strong> untuk membatasi sumber daya; </li></ul><br><ul><li>  <strong>namespace</strong> untuk mengisolasi proses; </li><li>  <strong>seccomp</strong> - analog dari firewall untuk panggilan sistem; </li><li>  dan, tentu saja, <strong>chroot</strong> favorit semua orang <strong>.</strong> </li></ul><br><h2>  Integrasi dengan layanan lain </h2><br>  Apakah ada solusi yang sudah jadi berdasarkan Firecracker?  Tentu saja ya <br><br><h3>  OSV </h3><br>  Sistem operasi ini dirancang untuk menjalankan hanya satu aplikasi.  Karena ini, ia memiliki pekerjaan yang sangat sederhana dengan memori dan penjadwal.  OS yang kuat dan mudah dikelola sekarang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bekerja di atas Firecracker</a> . <br><br><h3>  Containerd </h3><br>  Kami juga membuat integrasi dengan contenterd.  Jika Anda sudah bekerja dengannya, maka Anda perlu sedikit upaya untuk meluncurkan wadah yang dibungkus dengan Petasan untuk isolasi. <br><br><img src="https://habrastorage.org/webt/xm/l3/1n/xml31nghhesczi3x2ul1vagz5xw.png"><br><br>  Alih-alih shim biasa, containerd merujuk ke shim Petasan.  Ini sudah mengelola runc, melalui agen yang dipasang di dalam microvirtual.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Sudah diperiksa, berfungsi</a> . <br><br><h3>  Wadah kata </h3><br>  Ketika kami pertama kali mengumumkan Petasan, salah satu pertanyaan pelanggan paling populer adalah: <br><br>  <em>- Mekanisme untuk mengisolasi wadah sudah ditemukan - ini adalah Kata Containers.</em>  <em>Mengapa Anda tidak menggunakannya?</em>  <em>Mengapa mengembangkan milik Anda sendiri?</em> <br>  <em>- Kata bekerja dengan QEMU, tetapi kami tidak ingin bekerja dengan QEMU.</em>  <em>Karena itu, kami memutuskan untuk memasak sendiri.</em> <br><br>  Tapi ternyata menarik.  Pengembang Kata bertemu dengan pengembang Firecracker dan setuju untuk berintegrasi.  Karena semua orang melihat ini sebagai nilai tambah yang besar.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Kata Containers v1.5</a> sudah mendukung QEMU dan Firecracker. <br><br>  Ternyata kami tidak bersaing, tetapi saling melengkapi secara harmonis.  Di Kubernetes dengan v1.12, Anda dapat mendefinisikan runtimeClassName sebagai Kata FC atau Kata QEMU, dan menjalankan kontainer Anda dalam isolasi yang tepat. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yt/1-/bn/yt1-bnzwtgnbvhvkkr48gmhsj5o.png" width="500"></div><br><br>  Bagaimana memilih isolasi yang sesuai dengan aplikasi Anda - Petasan atau QEMU?  Pendapat pribadi saya adalah yang <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">penting adalah apakah</a> aplikasi Anda adalah <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">hewan peliharaan atau sapi</a> ? <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/vs/le/yj/vsleyjeqq1hypjljyr3jcjcpsvc.png" width="300"></div><br><br>  Kata with QEMU adalah solusi untuk hewan peliharaan.  QEMU adalah sistem multi fungsi yang besar.  Secara potensial, ia menawarkan lebih banyak dukungan dan opsi perawatan untuk hewan peliharaan favorit Anda. <br><br>  Petasan sangat cocok saat memuat adalah ternak.  Jika aplikasi stateless Anda pada awalnya dirancang untuk penskalaan horizontal yang fleksibel dan kegagalan satu atau lebih kontainer tidak penting.  Menyediakan isolasi yang andal, memungkinkan Anda untuk dengan cepat memuat jumlah kontainer baru yang diperlukan untuk menggantikan yang gagal. <br><br><h2>  Apa hasilnya? </h2><br>  Kami mulai dengan kontradiksi.  Tampaknya menyelesaikan kontradiksi adalah pendekatan "milik kita dan milikmu", sesuatu di antaranya yang akan memuaskan semua orang.  Tetapi pengalaman mengatakan bahwa kompromi tidak perlu. <br><br>  Kami menetapkan tujuan pengembangan solusi baru di mana tidak akan ada yang berlebihan yang tidak diperlukan untuk menyelesaikan tugas yang sempit.  Penting juga untuk menyederhanakan segala yang kami gunakan sebanyak mungkin.  Saya ingin percaya bahwa kami tidak mendapatkan kompromi, tetapi solusi yang solid, yang memungkinkan Anda untuk meluncurkan ribuan mikrovirtual dengan cepat dan tanpa mengorbankan isolasi mereka. <br><br>  Kami sudah menggunakan Petasan untuk memproduksi beberapa layanan kami.  Kelebihan utama yang kami dapatkan adalah peningkatan pemanfaatan layanan.  Ini memungkinkan untuk menyimpan secara signifikan.  Bagian dari penghematan ini kami bagi dengan pelanggan.  Misalnya, setelah pengenalan Petasan, harga untuk wadah tanpa server AWS Fargate pada Januari 2019 turun 35-50%.  Manfaatnya terlihat dengan mata telanjang, jadi tidak ada keraguan bahwa kami akan terus mengembangkan produk ini dan berbagi praktik terbaik kami dengan Open Source.  Fakta bahwa Firecracker sudah mulai berintegrasi dengan solusi lain menunjukkan minat yang semakin besar di pihak masyarakat. <br><br>  Jika Anda memiliki ide atau produk jadi dalam uraian yang terdapat kata "isolasi multi-penyewa" - ini adalah indikator yang jelas tentang apa yang harus Anda coba dengan microvirtuals Petasan. <br><br><blockquote>  Laporan ini menggambarkan dengan sempurna prinsip yang kami coba patuhi di konferensi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ontiko</a> - untuk menerima pengalaman dunia dari para pakar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">berbahasa</a> Rusia.  Dan intinya tidak hanya dalam hambatan bahasa yang mungkin, tetapi dalam budaya kita terbiasa berbagi rincian teknis.  Pada bulan November, Vasily <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">akan tampil</a> di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">HighLoad ++</a> lagi, dan ia akan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">bergabung dengan</a> , misalnya, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Artemy Kolesnikov</a> dari Facebook, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Vittorio Cioe</a> dari Oracle dan, tentu saja, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Petr Zaitsev</a> dari Percona.  Kami juga akan memiliki laporan dalam bahasa Inggris, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">berlangganan</a> buletin - kami akan memberi tahu Anda ketika yang baru akan ditambahkan ke laporan empat puluh yang diterima. </blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id464305/">https://habr.com/ru/post/id464305/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id464291/index.html">10 bahasa pemrograman paling berpengaruh dalam 50 tahun terakhir dan penciptanya</a></li>
<li><a href="../id464293/index.html">Apakah kait diganti dalam React Redux?</a></li>
<li><a href="../id464295/index.html">Contoh menggunakan beberapa fitur JavaScript baru</a></li>
<li><a href="../id464299/index.html">0, 0, 1, 0, 2, 0, 2, 2, 1, 6, 0, 5, 0, 2, 6, 5, 4, 0, 5, 3, 0, 3, 2, 9, 0, 4, 9, 3, 6, 14, 0, 6, 3, 5, 15, 0, 5, 3, 5 ...</a></li>
<li><a href="../id464303/index.html">Data deret waktu dalam DBMS relasional. Ekstensi TimescaleDB dan PipelineDB untuk PostgreSQL</a></li>
<li><a href="../id464307/index.html">Pengujian integrasi layanan microser di Scala</a></li>
<li><a href="../id464309/index.html">Tombol panggilan DIY. Raspberry Pi, MajorDoMo, Freeswitch dan Linphonec</a></li>
<li><a href="../id464315/index.html">Film di mana ada tanah. Penelitian Yandex dan sejarah singkat pencarian berdasarkan makna</a></li>
<li><a href="../id464317/index.html">Proyek Konbanwa</a></li>
<li><a href="../id464325/index.html">Bagaimana Scrumban Menyatukan yang Terbaik dari Metodologi Kanban dan Scrum</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>