<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üìΩÔ∏è üôèüèº ü•Ñ Starten Sie Predator - Precompiled Data Repositories üë©üèª‚ÄçüöÄ üñï ü§±üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Heute hat das Micronaut- Team von Object Computing Inc (OCI) Predator vorgestellt , ein neues Open-Source-Projekt, dessen Ziel es ist, die Laufzeit un...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Starten Sie Predator - Precompiled Data Repositories</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460839/"><p><img src="https://habrastorage.org/webt/zy/lo/n1/zylon1nrzso3rt7yshzjaia3krg.jpeg"></p><br><p>  Heute hat das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Micronaut-</a> Team von Object Computing Inc (OCI) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Predator vorgestellt</a> , ein neues Open-Source-Projekt, dessen Ziel es ist, die Laufzeit und Leistung (aus dem Speicher) des Datenzugriffs f√ºr Microservices und serverlose Anwendungen erheblich zu verbessern, ohne die Produktivit√§t zu beeintr√§chtigen im Vergleich zu Tools wie GORM und Spring Data. </p><a name="habracut"></a><br>
<h2 id="istoriya-instrumentov-dostupa-k-dannym">  Verlauf der Datenzugriffstools </h2><br><p>  Wir k√∂nnen den Verlauf der Datenrepository-Vorlage seit 2004 verfolgen, als Ruby on Rails das ActiveRecord-Subsystem herausbrachte, eine API, die unser Verst√§ndnis des Datenzugriffs im Hinblick auf die Entwicklerproduktivit√§t revolutionierte. </p><br><p>  2007 f√ºhrte das Grails-Team erstmals eine ActiveRecord-√§hnliche API f√ºr die JVM - GORM (Teil von Grails) ein.  GORM verlie√ü sich bei der Implementierung von Suchmethoden zus√§tzlich zu Hibernate auf die Dynamik von Groovy und bot JVM-Benutzern dieselben Produktivit√§tsvorteile. </p><br><p> Da GORM von der Sprache Groovy abh√§ngt, wurde 2011 ein Spring Data-Projekt erstellt, mit dem Java-Entwickler Suchmethoden wie <code>findByTitle</code> in der Benutzeroberfl√§che definieren und zur Laufzeit automatisch die Abfragelogik implementieren konnten. </p><br><h2 id="kak-rabotayut-instrumenty-dostupa-k-dannym">  Funktionsweise von Datenzugriffstools </h2><br><p>  Alle genannten Implementierungen verwenden dieselbe Vorlage, mit der zur Laufzeit ein Metamodell von Projektentit√§ten erstellt wird, das die Beziehungen zwischen Ihren Entit√§tsklassen modelliert.  In Spring Data ist es ein MappingContext und in GORM wird es auch als MappingContext bezeichnet.  Sie werden durch Scannen von Klassen unter Verwendung von Reflexion konstruiert.  (Die √Ñhnlichkeit bei der Benennung ist hier nicht zuf√§llig. 2010 habe ich mit dem Spring Data-Team zusammengearbeitet, um zu versuchen, GORM f√ºr Java neu zu erstellen, an einem Projekt, das sich heute schlie√ülich in Spring Data verwandelte.) </p><br><p>  Dieses Metamodell wird dann verwendet, um einen <code>bookRepository.findByTitle("The Stand")</code> wie <code>bookRepository.findByTitle("The Stand")</code> zur Laufzeit mithilfe einer Kombination aus Parsing regul√§rer Ausdr√ºcke und Framework-Logik in ein abstraktes Abfragemodell <code>bookRepository.findByTitle("The Stand")</code> .  Wir ben√∂tigen ein abstraktes Abfragemodell, da der Zieldialekt der Abfrage f√ºr jede Datenbank unterschiedlich ist (SQL, JPA-QL, Cypher, Bson usw.). </p><br><h2 id="podderzhka-repozitoriev-v-micronaut">  Unterst√ºtzung f√ºr Micronaut Repository </h2><br><p>  Seit dem Start von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Micronaut vor</a> etwas mehr als einem Jahr wurde haupts√§chlich nach "GORM f√ºr Java" oder Spring Data-Unterst√ºtzung gefragt.  So viele Entwickler sind von der Produktivit√§t dieser Tools sowie von der einfachen Definition der vom Framework implementierten Schnittstellen begeistert.  Ich w√ºrde sagen, dass der gr√∂√üte Teil des Erfolgs von Grails und Spring Boot auf GORM bzw. Spring Data zur√ºckzuf√ºhren ist. </p><br><p>  F√ºr Micronaut-Benutzer, die Groovy verwenden, hatten wir vom ersten Tag an GORM-Unterst√ºtzung, und Java- und Kotlin-Benutzer hatten nichts mehr zu tun, da sie Repositorys selbst implementieren mussten. </p><br><p>  Es w√§re technisch m√∂glich und ehrlich gesagt einfacher, einfach ein Modul f√ºr Micronaut hinzuzuf√ºgen, mit dem Spring Data konfiguriert werden kann.  Auf diesem Weg w√ºrden wir jedoch ein Subsystem bereitstellen, das mit allen Methoden implementiert wurde, die Micronaut zu vermeiden versuchte: weit verbreitete Verwendung von Proxys, Reflexion und hoher Speicherverbrauch. </p><br><h2 id="predstavlyaem-predator">  Wir stellen Predator vor! </h2><br><p>  Predator, kurz f√ºr Precomputed Data Repositories, verwendet die Micronaut-API zum Kompilieren vor der Ausf√ºhrung (AoT, vorzeitig), um ein Metamodell von Entit√§ten zu √ºbertragen und <code>findByTitle</code> (wie <code>findByTitle</code> ) in das entsprechende SQL oder JPA-QL in Ihrem Compiler zu konvertieren .  Infolgedessen f√ºhrt die Abfrage eine sehr d√ºnne Programmlaufzeitschicht ohne Reflexion aus, und es bleibt nur, dass sie die Abfrage ausf√ºhrt und die Ergebnisse zur√ºckgibt. </p><br><p>  Das Ergebnis ist √ºberw√§ltigend ... der Kaltstart wird deutlich reduziert, wir erhalten einen erstaunlich niedrigen Speicherverbrauch und eine deutliche Leistungsverbesserung. </p><br><p>  Heute √∂ffnen wir den Quellcode f√ºr Predator unter der Apache 2-Lizenz. Er wird mit zwei ersten Implementierungen (weitere Funktionen f√ºr die Zukunft geplant) f√ºr JPA (basierend auf Hibernate) und f√ºr SQL mit JDBC geliefert. </p><br><p>  Die JDBC-Implementierung gef√§llt mir am besten, da sie v√∂llig unabh√§ngig von der Reflexion ist und keine Proxys und kein dynamisches Laden von Klassen f√ºr Ihren Datenzugriff verwendet, was zu einer verbesserten Leistung f√ºhrt.  Die Laufzeitschicht ist so leicht, dass selbst der von Hand geschriebene √§quivalente Repository-Code nicht schneller ausgef√ºhrt wird. </p><br><h2 id="proizvoditelnost-predator">  Performance Predator </h2><br><p>  Da Predator zur Laufzeit keine Abfragetransformationen ausf√ºhren muss, ist der Leistungsgewinn erheblich.  In der Welt der Cloud-Computing-Nutzung, in der Sie f√ºr die Ausf√ºhrungszeit Ihrer Anwendung oder f√ºr die Ausf√ºhrung einer einzelnen Funktion bezahlen, verlieren Entwickler h√§ufig die Leistung ihrer Datenzugriffsmechanismen aus den Augen. </p><br><p>  In der folgenden Tabelle sind die Leistungsunterschiede zusammengefasst, die f√ºr einen einfachen <code>findByTitle</code> wie <code>findByTitle</code> im Vergleich zu anderen Implementierungen zu erwarten sind.  Alle Tests wurden mit einem Pr√ºfstand auf dem 8-Kern-Xeon iMac Pro unter den gleichen Bedingungen durchgef√ºhrt. Die Tests sind offen und befinden sich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im Repository</a> : </p><br><div class="scrollable-table"><table><thead><tr><th>  Implementierung </th><th>  Operationen pro Sekunde </th></tr></thead><tbody><tr><td>  Predator JDBC </td><td>  225 K Ops / Sek </td></tr><tr><td>  Predator jpa </td><td>  130 K Ops / Sek </td></tr><tr><td>  Federdaten jpa </td><td>  90 K Ops / Sek </td></tr><tr><td>  GORM JPA </td><td>  50 K Ops / Sek </td></tr><tr><td>  Federdaten JDBC </td><td>  Finder werden nicht unterst√ºtzt </td></tr></tbody></table></div><br><p>  Ja, du hast es richtig gelesen.  Mit Predator JDBC k√∂nnen Sie eine fast 4-fache Leistungssteigerung gegen√ºber GORM und eine 2,5-fache Steigerung gegen√ºber Spring Data erwarten. </p><br><p>  Und selbst wenn Sie Predator JPA verwenden, k√∂nnen Sie mit mehr als der zweifachen Leistungsverbesserung im Vergleich zu GORM und einer Steigerung von bis zu 40% im Vergleich zu Spring Data JPA rechnen. </p><br><p>  Sehen Sie sich den Unterschied in der Gr√∂√üe des Ausf√ºhrungsstapels bei Verwendung von Predator im Vergleich zu Alternativen an: </p><br><p>  <strong>Predator:</strong> </p><br><p><img src="https://habrastorage.org/webt/6_/5l/ns/6_5lnsvtlyng0zisy5updpoii30.png"></p><br><p>  <strong>Predator JPA:</strong> </p><br><p><img src="https://habrastorage.org/webt/dw/us/bc/dwusbcyeubxeu8l-glmhgq0r7me.png"></p><br><p>  <strong>Federdaten:</strong> </p><br><p><img src="https://habrastorage.org/webt/di/m2/uv/dim2uvimrgxvs4ksszq0gsxujkq.png"></p><br><p>  <strong>GORM:</strong> </p><br><p><img src="https://habrastorage.org/webt/ad/7z/rs/ad7zrsyjfc1-fpr-cm3vqp9cmle.png"></p><br><p>  Predator JDBC verwendet bis zur Ausf√ºhrung Ihrer Anforderung nur 15 Frames, w√§hrend Predator JPA 30 (haupts√§chlich aufgrund von Hibernate) verwendet, verglichen mit mehr als 50 Stack-Frames in Spring Data oder GORM.  Und das alles dank der AOP-Mechanismen von Micronaut, die keine Reflexion verwenden. </p><br><p>  K√ºrzere Stackraces vereinfachen auch das Debuggen von Anwendungen.  Einer der Vorteile der meisten Arbeiten w√§hrend der Kompilierung besteht darin, dass Fehler vor dem Start der Anwendung erkannt werden k√∂nnen, was die Erfahrung des Entwicklers erheblich verbessert.  Wir erhalten sofort Kompilierungsfehler anstelle von Laufzeitfehlern f√ºr die h√§ufigsten Fehler. </p><br><h2 id="proverki-vremeni-kompilyacii">  Zeitpr√ºfungen kompilieren </h2><br><p>  Die meisten Implementierungen der Repository-Vorlage basieren ausschlie√ülich auf der Ausf√ºhrung aller Vorg√§nge zur Laufzeit.  Dies bedeutet, dass, wenn der Entwickler beim Definieren der Schnittstelle des Repositorys einen Fehler macht, Fehler erst sichtbar werden, wenn die Anwendung tats√§chlich gestartet wird. </p><br><p>  Dies raubt uns einige der Vorteile von Java f√ºr die Typpr√ºfung und wir haben schlechte Datenerfahrung.  Dies ist bei Predator nicht der Fall.  Betrachten Sie das folgende Beispiel: </p><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@JdbcRepository</span></span>(dialect = Dialect.H2) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BookRepository</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">CrudRepository</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Book</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Long</span></span></span><span class="hljs-class">&gt; </span></span>{ <span class="hljs-function"><span class="hljs-function">Book </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findByTile</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String t)</span></span></span></span>; }</code> </pre> <br><p>  Hier <code>BookRepository</code> wir eine Anfrage an ein Objekt namens <code>Book</code> deklariert, das eine <code>title</code> Eigenschaft hat.  Leider gibt es einen Fehler in dieser Deklaration: Wir haben die <code>findByTile</code> Methode anstelle von <code>findByTitle</code> .  Anstatt diesen Code auszuf√ºhren, l√§sst Predator Ihren Code nicht mit einer informativen Fehlermeldung kompilieren: </p><br><pre> <code class="plaintext hljs">Error:(9, 10) java: Unable to implement Repository method: BookRepository.findByTile(String title). Cannot use [Equals] criterion on non-existent property path: tile</code> </pre> <br><p>  Viele Aspekte von Predator werden nach M√∂glichkeit zur Kompilierungszeit √ºberpr√ºft, um sicherzustellen, dass ein Laufzeitfehler nicht durch eine falsche Repository-Deklaration verursacht wird. </p><br><h2 id="predator-jdbc-i-graalvm-substrate">  Predator JDBC und GraalVM Substrat </h2><br><p>  Ein weiterer Grund, warum Predator sich freuen sollte, ist, dass es sofort mit nativen GraalVM-Substratbildern kompatibel ist und im Gegensatz zu Halnate auf GraalVM keine komplexen Bytecode-Konvertierungen w√§hrend der Erstellung erfordert. </p><br><p>  Durch die vollst√§ndige Eliminierung von Reflexionen und dynamischen Proxys aus der Datenzugriffsschicht vereinfacht Predator die Erstellung von Anwendungen, die mit Daten arbeiten, die auf GraalVM ausgef√ºhrt werden, erheblich. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Die Predator JDBC-Beispielanwendung kann</a> problemlos auf Substrate ausgef√ºhrt werden und erm√∂glicht es Ihnen, dank einer viel d√ºnneren Laufzeitschicht ein viel kleineres natives Image (25 MB weniger!) Zu erstellen, als der Ruhezustand funktionieren muss. </p><br><p>  Wir haben das gleiche Ergebnis gesehen, als wir die Zusammenstellung der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Bean-Validierungsregeln</a> f√ºr Micronaut 1.2 implementiert haben.  Die native Bildgr√∂√üe verringerte sich um 10 MB, sobald wir die Abh√§ngigkeit vom Hibernate Validator und die JAR-Gr√∂√üe um 2 MB entfernt hatten. </p><br><p>  Der Vorteil liegt auf der Hand: Wenn Sie w√§hrend der Kompilierung mehr Arbeit leisten und kompaktere Laufzeiten erstellen, erhalten Sie ein kleineres natives Image und eine JAR-Datei, was zu kleineren und einfacher zu implementierenden Microservices bei der Bereitstellung √ºber Docker f√ºhrt.  Die Zukunft von Java-Frameworks sind leistungsf√§higere Compiler und kleinere, leichtere Laufzeiten. </p><br><h2 id="predator-i-buduschee">  Raubtier und die Zukunft </h2><br><p>  Wir fangen gerade erst an, mit Predator zusammenzuarbeiten, und sind √§u√üerst zufrieden mit den M√∂glichkeiten, die sich daraus ergeben. </p><br><p>  Zun√§chst beginnen wir mit der Unterst√ºtzung von JPA und SQL, aber in Zukunft k√∂nnen Sie Unterst√ºtzung f√ºr MongoDB, Neo4J, Reactive SQL und andere Datenbanken erwarten.  Gl√ºcklicherweise ist dieser Job viel einfacher, da der gr√∂√üte Teil von Predator tats√§chlich auf dem GORM-Quellcode basiert und wir die GORM-Logik f√ºr Neo4J und die GORM-Logik f√ºr MongoDB wiederverwenden k√∂nnen, um diese Implementierungen schneller als erwartet freizugeben. </p><br><p>  Predator ist der H√∂hepunkt der Kombination der verschiedenen Bausteine ‚Äã‚Äãin Micronaut Core, die die Implementierung erm√∂glichten, von den AoT-APIs, die auch zum Generieren der Swagger-Dokumentation verwendet werden, bis zur relativ neuen Bean Introspection-Unterst√ºtzung, mit der Sie Objekte zur Laufzeit ohne Reflexion analysieren k√∂nnen. </p><br><p>  Micronaut bietet Bausteine ‚Äã‚Äãf√ºr erstaunliche Dinge.  Predator ist eine solche Sache, und wir fangen gerade erst an, an einigen der vielversprechenden Funktionen von Micronaut 1.0 zu arbeiten. </p><br><p>  UPDATE: Nach der schockierenden Ank√ºndigung wurde der Spring Data-Killer in Micronaut Data umbenannt: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://micronaut-projects.github.io/micronaut-data/1.0.x/guide/</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de460839/">https://habr.com/ru/post/de460839/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de460825/index.html">Einf√ºhrung in die Screen Capture API - Scannen Sie QR-Codes in einem Browser</a></li>
<li><a href="../de460827/index.html">PGP-Problem</a></li>
<li><a href="../de460831/index.html">Die Gefahren von Designern</a></li>
<li><a href="../de460833/index.html">Physik und Wirtschaft. Gnoseologischer Unterschied und seine Manifestation in der IT</a></li>
<li><a href="../de460837/index.html">Podcast-Handbuch f√ºr Anf√§nger</a></li>
<li><a href="../de460841/index.html">TOP-23 Sprachlern-Apps</a></li>
<li><a href="../de460843/index.html">Einf√ºhrung in den neuen 3CX Call Flow Designer und den 3CX CRM Template Generator</a></li>
<li><a href="../de460845/index.html">Fernando Corbato, der Vater Ihres Computers (und Passworts), starb im Alter von 93 Jahren</a></li>
<li><a href="../de460847/index.html">12,3 Millionen gleichzeitige WebSockets</a></li>
<li><a href="../de460849/index.html">Teil 4. Ein Diagrammmodell zur Berechnung logischer Funktionen f√ºr asynchrone parallele Prozesse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>