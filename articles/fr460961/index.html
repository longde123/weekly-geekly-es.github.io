<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👉🏻 👌🏼 👩🏾‍⚖️ Configuration de tests unitaires dans des projets mixtes Swift + Objective-C 🕡 👨‍✈️ 💅🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cet article sera petit, je vais vous dire quels problèmes sont survenus lors de la création d'une cible à tester dans un projet ObjectiveC + Swift mix...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Configuration de tests unitaires dans des projets mixtes Swift + Objective-C</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460961/"> Cet article sera petit, je vais vous dire quels problèmes sont survenus lors de la création d'une cible à tester dans un projet ObjectiveC + Swift mixte et plutôt ancien, et comment j'ai réussi à les résoudre. <br><a name="habracut"></a><br>  La première chose qui prête à confusion: une erreur dans une cible de test peut affecter le lancement d'un autotest à partir d'une autre cible de test.  Vous pouvez ajouter un nombre illimité de cibles à tester dans le projet, elles sont généralement basées sur la cible principale du projet et sont automatiquement ajoutées à son schéma de lancement.  Ainsi, lors de l'exécution de tout autotest sur ce schéma, le reste sera compilé et une erreur sur l'une des cibles de test interférera avec le lancement des autres.  Pour isoler cet effet, vous pouvez créer différents schémas pour différentes cibles de test. <br><br>  Je vais joindre une capture d'écran très triviale, uniquement pour plus de clarté: <br><br><img src="https://habrastorage.org/webt/7-/u2/s3/7-u2s3ujfixxgvfywsmcwc-hm0a.png"><br><br><img src="https://habrastorage.org/webt/hs/v_/s1/hsv_s18i78rk5j_cctn4cwm_g2y.png"><br><br>  Le problème suivant concerne les dépendances entre Objecive-C et Swift. <br>  Dans votre projet est créé: <br><br>  <b>MyProject-Bridging-Header.h</b> : ce fichier contient les noms des fichiers d'en-tête ObjectiveC utilisés dans swift. <br>  <b>MyProject-swift.h</b> : il crée implicitement le code des classes swift utilisées dans les classes ObjectiveC. <br>  <b>MyProject-Prefix.pch</b> : le fichier de précompilation peut également contenir des dépendances de différentes manières, y compris des constructions comme: <br><br><pre><code class="swift hljs">#ifdef __OBJC__ #<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> "MyProject-Swift.h" #endif</code> </pre> <br>  Vos autotests peuvent également créer de telles dépendances.  Lors de l'ajout du premier fichier swift, Xcode propose de créer un fichier d'en-tête de pont pour cette cible de test.  Tout fonctionne comme un charme.  En théorie, le contenu de l'autotest de l'en-tête de pont devrait compléter le pont principal, mais en fait, un remplacement se produit.  Par conséquent, afin d'avoir accès à toutes les classes du projet dans l'autotest, dans cette option, je spécifie l'en-tête de pont de la cible principale (image ci-dessus). <br><br>  Accédez à Xcode <b>Target -&gt; BuildSetting</b> et vérifiez les paramètres suivants: <br>  <b>En-tête de pontage Objective-C</b> <br>  <b>Nom d'en-tête d'interface généré par Objective-C</b> <br>  Spécifiez les principaux fichiers cibles. <br><br>  Cependant, si vous tirez l'en-tête de pont principal, toutes les dépendances commencent à s'étirer.  Par conséquent, vous devez également remplir les paramètres suivants avec les données du projet principal: <br>  <b>Chemins de recherche du framework</b> <br>  <b>Chemins de recherche d'en-tête</b> <br>  <b>Chemin de recherche de la bibliothèque</b> <br>  <b>Autres drapeaux de l'éditeur de liens</b> <br>  <b>Les chemins de recherche de parcours ne</b> doivent <b>PAS</b> être modifiés. <br><br>  Puis un autre problème étrange a été découvert: <br>  Pour une raison quelconque, dans les projets plus anciens, la cible de test se voit attribuer le même <b>nom de module de produit</b> que le principal.  Cela n'a pas arrêté le seul ObjectiveC, mais lors de l'ajout rapide au projet, deux problèmes se posent. <br><br>  Le premier problème est que dans ce cas <br><br><pre> <code class="swift hljs"><span class="hljs-meta"><span class="hljs-meta">@testable</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MyProject</code> </pre> <br>  le fichier d'autotest est ignoré et vous ne pouvez pas accéder aux classes Swift. <br><br>  Le deuxième problème est qu'une telle cible à la compilation écrase le MyProject-swift de la cible principale et empêche la compilation d'autres cibles.  Ce paramètre doit être renommé. <br><br>  Sur ce point, mon autotest a commencé et a pu utiliser les fichiers du projet, que je vous souhaite également! <br>  Je ne travaille pas souvent à la mise en place d'un projet, donc tous les commentaires et conseils pratiques sur ce sujet sont les bienvenus. <br><br>  Merci à tous ceux qui l'ont lu. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr460961/">https://habr.com/ru/post/fr460961/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr460949/index.html">«Et l'impossible est possible»: nous transformons une boîte noire en blanc grâce à l'analyse binaire</a></li>
<li><a href="../fr460951/index.html">Créer des fonds d'écran Android Live</a></li>
<li><a href="../fr460953/index.html">Les pointeurs sont complexes, ou qu'est-ce qui est stocké dans un octet?</a></li>
<li><a href="../fr460955/index.html">Programme éducatif pour transmettre des paramètres par valeur aux constructeurs et aux setters (C ++ moderne, exemples)</a></li>
<li><a href="../fr460959/index.html">La nouvelle technologie de Microsoft permet aux copies 3D d'une personne réelle de parler n'importe quelle langue</a></li>
<li><a href="../fr460965/index.html">Split Controller sans ces storyboards</a></li>
<li><a href="../fr460967/index.html">Troy Hunt: 10 leçons financières personnelles pour les professionnels des technologies de l'information</a></li>
<li><a href="../fr460969/index.html">Margaret Hamilton: «Ils craignaient que les hommes ne se rebellent; mais ce n'est pas arrivé "</a></li>
<li><a href="../fr460971/index.html">NVIDIA Jetson Nano: tests et premières impressions - Partie 2, tests d'intelligence artificielle</a></li>
<li><a href="../fr460973/index.html">Soudage par contact pour les batteries 18650</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>