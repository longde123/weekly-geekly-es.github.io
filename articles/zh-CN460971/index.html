<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>âœŒğŸ» âš–ï¸ ğŸ¤›ğŸ¾ NVIDIA Jetson Nanoï¼šæµ‹è¯•å’Œç¬¬ä¸€å°è±¡-ç¬¬2éƒ¨åˆ†ï¼ŒAIæµ‹è¯• âš›ï¸ â˜ğŸ¼ ğŸŒ¼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å“ˆHa 

 åœ¨ç¬¬ä¸€éƒ¨åˆ†ä¸­ ï¼Œè€ƒè™‘äº†NVIDIA Jetson Nano-Raspberry Piå°ºå¯¸çš„ä¸»æ¿ï¼Œä¸“æ³¨äºä½¿ç”¨GPUè¿›è¡Œæ€§èƒ½è®¡ç®—ã€‚ ç°åœ¨è¯¥æµ‹è¯•æ¿çš„åˆ›å»ºç›®çš„äº†-é¢å‘AIçš„è®¡ç®—ã€‚ 



 è€ƒè™‘ä¸€ä¸‹æ¿ä¸Šçš„ä¸åŒä»»åŠ¡ï¼Œä¾‹å¦‚å¯¹å›¾åƒè¿›è¡Œåˆ†ç±»æˆ–è¯†åˆ«è¡Œäººæˆ–å°ç« ï¼ˆæ²¡æœ‰å›¾åƒçš„åœ°æ–¹ï¼‰ã€‚ å¯¹äºæ‰€æœ‰æµ‹è¯•ï¼Œæºä»£ç éƒ½å¯...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>NVIDIA Jetson Nanoï¼šæµ‹è¯•å’Œç¬¬ä¸€å°è±¡-ç¬¬2éƒ¨åˆ†ï¼ŒAIæµ‹è¯•</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460971/"> å“ˆHa <br><br> åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¬¬ä¸€éƒ¨åˆ†ä¸­</a> ï¼Œè€ƒè™‘äº†NVIDIA Jetson Nano-Raspberry Piå°ºå¯¸çš„ä¸»æ¿ï¼Œä¸“æ³¨äºä½¿ç”¨GPUè¿›è¡Œæ€§èƒ½è®¡ç®—ã€‚ ç°åœ¨è¯¥æµ‹è¯•æ¿çš„åˆ›å»ºç›®çš„äº†-é¢å‘AIçš„è®¡ç®—ã€‚ <br><br><img src="https://habrastorage.org/webt/91/1a/7i/911a7i0fv9k20_edm9oftroelpq.png"><br><br> è€ƒè™‘ä¸€ä¸‹æ¿ä¸Šçš„ä¸åŒä»»åŠ¡ï¼Œä¾‹å¦‚å¯¹å›¾åƒè¿›è¡Œåˆ†ç±»æˆ–è¯†åˆ«è¡Œäººæˆ–å°ç« ï¼ˆæ²¡æœ‰å›¾åƒçš„åœ°æ–¹ï¼‰ã€‚ å¯¹äºæ‰€æœ‰æµ‹è¯•ï¼Œæºä»£ç éƒ½å¯ä»¥åœ¨å°å¼æœºï¼ŒJetson Nanoæˆ–Raspberry Piä¸Šè¿è¡Œã€‚ å¯¹äºé‚£äº›æ„Ÿå…´è¶£çš„äººï¼Œç»§ç»­å‡äº§ã€‚ <br><a name="habracut"></a><br> æœ‰ä¸¤ç§ä½¿ç”¨è¯¥æ¿çš„æ–¹æ³•ã€‚ é¦–å…ˆæ˜¯è¿è¡ŒKeraså’ŒTensorflowç­‰æ ‡å‡†æ¡†æ¶ã€‚ å®ƒåœ¨åŸç†ä¸Šå¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯ä»ç¬¬ä¸€éƒ¨åˆ†å·²ç»å¯ä»¥çœ‹å‡ºï¼ŒJetson Nanoå½“ç„¶ä¸å¦‚æˆç†Ÿçš„å°å¼æœºæˆ–ç¬”è®°æœ¬è§†é¢‘å¡ã€‚ ç”¨æˆ·å°†ä¸å¾—ä¸æ‰¿æ‹…ä¼˜åŒ–æ¨¡å‹çš„ä»»åŠ¡ã€‚ ç¬¬äºŒç§æ–¹æ³•æ˜¯å‚åŠ ç”µè·¯æ¿é™„å¸¦çš„ç°æˆçš„è¯¾ç¨‹ã€‚ å®ƒæ›´ç®€å•å¹¶ä¸”å¯ä»¥â€œå³å¼€å³ç”¨â€åœ°å·¥ä½œï¼Œå…¶ç¼ºç‚¹æ˜¯æ‰€æœ‰å®ç°ç»†èŠ‚éƒ½è¢«æ›´å¤§ç¨‹åº¦åœ°éšè—äº†ï¼Œæ­¤å¤–ï¼Œæ‚¨è¿˜å¿…é¡»å­¦ä¹ å’Œä½¿ç”¨custom-sdkï¼Œé™¤äº†è¿™äº›æ¿ä¹‹å¤–ï¼Œcustom-sdkåœ¨å…¶ä»–ä»»ä½•åœ°æ–¹éƒ½å°†æ— ç”¨ã€‚ ä½†æ˜¯ï¼Œæˆ‘ä»¬å°†ä»ç¬¬ä¸€ç§å¼€å§‹ç€çœ¼äºä¸¤ç§æ–¹å¼ã€‚ <br><br><h2> å›¾ç‰‡åˆ†ç±» </h2><br> è€ƒè™‘å›¾åƒè¯†åˆ«é—®é¢˜ã€‚ ä¸ºæ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨Keraséšé™„çš„ResNet50æ¨¡å‹ï¼ˆè¯¥æ¨¡å‹æ˜¯2015å¹´ImageNetæŒ‘æˆ˜èµ›çš„è·èƒœè€…ï¼‰ã€‚ è¦ä½¿ç”¨å®ƒï¼Œåªéœ€å‡ è¡Œä»£ç å°±è¶³å¤Ÿäº†ã€‚ <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time IMAGE_SIZE = <span class="hljs-number"><span class="hljs-number">224</span></span> IMG_SHAPE = (IMAGE_SIZE, IMAGE_SIZE, <span class="hljs-number"><span class="hljs-number">3</span></span>) resnet = tf.keras.applications.ResNet50(input_shape=IMG_SHAPE) img = tf.contrib.keras.preprocessing.image.load_img(<span class="hljs-string"><span class="hljs-string">'cat.png'</span></span>, target_size=(IMAGE_SIZE, IMAGE_SIZE)) t_start = time.time() img_data = tf.contrib.keras.preprocessing.image.img_to_array(img) x = tf.contrib.keras.applications.resnet50.preprocess_input(np.expand_dims(img_data, axis=<span class="hljs-number"><span class="hljs-number">0</span></span>)) probabilities = resnet.predict(x) print(tf.contrib.keras.applications.resnet50.decode_predictions(probabilities, top=<span class="hljs-number"><span class="hljs-number">5</span></span>)) print(<span class="hljs-string"><span class="hljs-string">"dT"</span></span>, time.time() - t_start)</code> </pre> <br> æˆ‘ä»€è‡³æ²¡æœ‰å¼€å§‹åˆ é™¤ç ´åè€…ä¸‹çš„ä»£ç ï¼Œå› ä¸º ä»–å¾ˆå°ã€‚ å¦‚æ‚¨æ‰€è§ï¼Œé¦–å…ˆå°†å›¾åƒè°ƒæ•´ä¸º224x224ï¼ˆè¿™æ˜¯è¾“å…¥ç½‘ç»œæ ¼å¼ï¼‰ï¼Œæœ€åï¼Œé¢„æµ‹åŠŸèƒ½å®Œæˆæ‰€æœ‰å·¥ä½œã€‚ <br><br> æˆ‘ä»¬ç»™çŒ«æ‹ç…§ï¼Œç„¶åè¿è¡Œç¨‹åºã€‚ <br><br><img src="https://habrastorage.org/webt/_q/e8/ln/_qe8ln2w3hsmbw4dqcy7kdnuft0.png"><br><br> ç»“æœï¼š <br><br><pre> <code class="python hljs">[[(<span class="hljs-string"><span class="hljs-string">'n02123045'</span></span>, <span class="hljs-string"><span class="hljs-string">'tabby'</span></span>, <span class="hljs-number"><span class="hljs-number">0.765179</span></span>), (<span class="hljs-string"><span class="hljs-string">'n02123159'</span></span>, <span class="hljs-string"><span class="hljs-string">'tiger_cat'</span></span>, <span class="hljs-number"><span class="hljs-number">0.19059166</span></span>), (<span class="hljs-string"><span class="hljs-string">'n02124075'</span></span>, <span class="hljs-string"><span class="hljs-string">'Egyptian_cat'</span></span>, <span class="hljs-number"><span class="hljs-number">0.013605555</span></span>), (<span class="hljs-string"><span class="hljs-string">'n04493381'</span></span>, <span class="hljs-string"><span class="hljs-string">'tub'</span></span>, <span class="hljs-number"><span class="hljs-number">0.0025916891</span></span>), (<span class="hljs-string"><span class="hljs-string">'n04553703'</span></span>, <span class="hljs-string"><span class="hljs-string">'washbasin'</span></span>, <span class="hljs-number"><span class="hljs-number">0.0021566998</span></span>)]]</code> </pre> <br> å†ä¸€æ¬¡ï¼Œç”±äºä»–å¯¹è‹±è¯­çš„äº†è§£è€Œæ„Ÿåˆ°ä¸å®‰ï¼ˆæˆ‘æƒ³çŸ¥é“æœ‰å¤šå°‘éæœ¬åœ°äººçŸ¥é“ä»€ä¹ˆæ˜¯â€œå¹³å¤´â€ï¼Ÿï¼‰ï¼Œæˆ‘ç”¨å­—å…¸æ£€æŸ¥äº†è¾“å‡ºï¼Œæ˜¯çš„ï¼Œä¸€åˆ‡æ­£å¸¸ã€‚ <br><br> åœ¨CPUä¸Šè®¡ç®—çš„PCä»£ç æ‰§è¡Œæ—¶é—´ä¸º<b>0.5 s</b> ï¼Œåœ¨GPUä¸Šè®¡ç®—çš„PCä»£ç æ‰§è¡Œæ—¶é—´ä¸º2 sï¼ˆï¼ï¼‰ã€‚ æ ¹æ®æ—¥å¿—åˆ¤æ–­ï¼Œé—®é¢˜å‡ºåœ¨æ¨¡å‹ä¸­è¿˜æ˜¯åœ¨Tensorflowä¸­ï¼Œä½†æ˜¯åœ¨å¯åŠ¨æ—¶ï¼Œä»£ç å°è¯•åˆ†é…å¤§é‡å†…å­˜ï¼Œå¹¶ä»¥â€œåˆ†é…å™¨ï¼ˆGPU_0_bfcï¼‰å†…å­˜ä¸è¶³ï¼Œå°è¯•åˆ†é…freed_by_count = 0çš„2.13GiBâ€çš„å½¢å¼å‘å‡ºè­¦å‘Šã€‚ ã€‚ è¿™æ˜¯ä¸€ä¸ªè­¦å‘Šï¼Œè€Œä¸æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œè¯¥ä»£ç å¯ä»¥æ­£å¸¸å·¥ä½œï¼Œä½†æ˜¯æ¯”å®ƒåº”è¯¥æ…¢å¾—å¤šã€‚ <br><br> åœ¨Jetson Nanoä¸Šï¼Œé€Ÿåº¦ä»ç„¶è¾ƒæ…¢ï¼šCPUä¸Šä¸º<b>2.8c</b> ï¼ŒGPUä¸Šä¸º<b>18.8c</b> ï¼Œè¾“å‡ºå¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><img src="https://habrastorage.org/webt/t6/ok/ja/t6okja2fzqx_tjvmd6evens5dn8.png"><br><br> é€šå¸¸ï¼Œå³ä½¿æ¯ä¸ªå›¾åƒ3sï¼Œè¿™ä¹Ÿä¸æ˜¯å®æ—¶çš„ã€‚ è®¾ç½®å»ºè®®åœ¨å †æ ˆæº¢å‡ºæ—¶ä½¿ç”¨çš„gpu_options.allow_growthé€‰é¡¹æ— æµäºäº‹ï¼Œå¦‚æœæœ‰äººçŸ¥é“å¦ä¸€ç§æ–¹æ³•ï¼Œè¯·åœ¨æ³¨é‡Šä¸­ç¼–å†™ã€‚ <br><br>  <b>ç¼–è¾‘</b> ï¼šæŒ‰ç…§è¯„è®ºä¸­çš„æç¤ºï¼Œtensorflowçš„é¦–æ¬¡å¯åŠ¨é€šå¸¸ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´ï¼Œå¹¶ä¸”ä½¿ç”¨å®ƒæ¥è¡¡é‡æ—¶é—´æ˜¯ä¸æ­£ç¡®çš„ã€‚ ç¡®å®ï¼Œå½“å¤„ç†ç¬¬äºŒä¸ªåŠåç»­æ–‡ä»¶æ—¶ï¼Œç»“æœè¦å¥½å¾—å¤š-ä¸å¸¦GPUæ—¶ä¸º0.6ç§’ï¼Œå¸¦GPUæ—¶ä¸º0.2ç§’ã€‚ ä½†æ˜¯ï¼Œåœ¨å°å¼æœºä¸Šï¼Œé€Ÿåº¦åˆ†åˆ«ä¸º2.0ç§’å’Œ0.05ç§’ã€‚ <br><br>  ResNet50çš„ä¸€ä¸ªæ–¹ä¾¿åŠŸèƒ½æ˜¯ï¼Œåœ¨ç¬¬ä¸€æ¬¡å¯åŠ¨æ—¶ï¼Œå®ƒå°†æ•´ä¸ªæ¨¡å‹æ³µå‡ºåˆ°ç£ç›˜ï¼ˆå¤§çº¦100 MBï¼‰ä¸­ï¼Œç„¶åä»£ç å®Œå…¨è‡ªä¸»è¿è¡Œï¼Œæ— éœ€æ³¨å†Œå’ŒSMSã€‚ è€ƒè™‘åˆ°å¤§å¤šæ•°ç°ä»£AIæœåŠ¡åªèƒ½åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼Œè€Œæ²¡æœ‰Internetï¼Œè®¾å¤‡ä¼šå˜æˆâ€œå—ç“œâ€ï¼Œè¿™ç‰¹åˆ«å¥½ã€‚ <br><br><h2> çŒ«ä¸ç‹— </h2><br> è€ƒè™‘ä»¥ä¸‹é—®é¢˜ã€‚ ä½¿ç”¨Kerasï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå¯ä»¥åŒºåˆ†çŒ«å’Œç‹—çš„ç¥ç»ç½‘ç»œã€‚ è¿™å°†æ˜¯ä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNN-å·ç§¯ç¥ç»ç½‘ç»œï¼‰ï¼Œæˆ‘ä»¬å°†ä»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æœ¬</a>å‡ºç‰ˆç‰©ä¸­å€Ÿé‰´ç½‘ç»œè®¾è®¡ã€‚  tensorflow_datasetsåŒ…ä¸­å·²åŒ…å«ä¸€ç»„è®­ç»ƒçš„çŒ«å’Œç‹—çš„å›¾åƒï¼Œå› æ­¤æ‚¨ä¸å¿…è‡ªå·±æ‹æ‘„å®ƒä»¬ã€‚ <br><br> æˆ‘ä»¬åŠ è½½ä¸€ç»„å›¾åƒå¹¶å°†å…¶åˆ†ä¸ºä¸‰ä¸ªå—-è®­ç»ƒï¼ŒéªŒè¯å’Œæµ‹è¯•ã€‚ æˆ‘ä»¬å¯¹æ¯å¼ å›¾ç‰‡è¿›è¡Œâ€œå½’ä¸€åŒ–â€ï¼Œä½¿é¢œè‰²è¾¾åˆ°0.1.1çš„èŒƒå›´ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow.keras <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> layers <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow_datasets <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tfds <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> keras.preprocessing <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> image <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time IMAGE_SIZE = <span class="hljs-number"><span class="hljs-number">64</span></span> IMG_SHAPE = (IMAGE_SIZE, IMAGE_SIZE, <span class="hljs-number"><span class="hljs-number">3</span></span>) splits = tfds.Split.TRAIN.subsplit(weighted=(<span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) (cat_train, cat_valid, cat_test), info = tfds.load(<span class="hljs-string"><span class="hljs-string">'cats_vs_dogs'</span></span>, split=list(splits), with_info=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, as_supervised=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) label_names = info.features[<span class="hljs-string"><span class="hljs-string">'label'</span></span>].int2str <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pre_process_image</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(image, label)</span></span></span><span class="hljs-function">:</span></span> image = tf.cast(image, tf.float32) image = image / <span class="hljs-number"><span class="hljs-number">255.0</span></span> <span class="hljs-comment"><span class="hljs-comment"># Normalize image: 0..255 -&gt; 0..1 image = tf.image.resize(image, (IMAGE_SIZE, IMAGE_SIZE)) return image, label BATCH_SIZE = 32 SHUFFLE_BUFFER_SIZE = 1000 train_batch = cat_train.map(pre_process_image).shuffle(SHUFFLE_BUFFER_SIZE).repeat().batch(BATCH_SIZE) validation_batch = cat_valid.map(pre_process_image).repeat().batch(BATCH_SIZE)</span></span></code> </pre><br> æˆ‘ä»¬ç¼–å†™äº†ç”Ÿæˆå·ç§¯ç¥ç»ç½‘ç»œçš„åŠŸèƒ½ã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">custom_model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment"># Source: https://medium.com/@ferhat00/deep-learning-with-keras-classifying-cats-and-dogs-part-1-982067594856 classifier = tf.keras.Sequential() # Step 1 â€” Convolution classifier.add(layers.Conv2D(32, (3, 3), input_shape=IMG_SHAPE, activation='relu')) # Step 2 â€” Pooling classifier.add(layers.MaxPooling2D(pool_size=(2, 2))) # Adding a second convolutional layer classifier.add(layers.Conv2D(32, (3, 3), activation='relu')) classifier.add(layers.MaxPooling2D(pool_size=(2, 2))) # Step 3 â€” Flattening classifier.add(layers.Flatten()) # Step 4 â€” Full connection classifier.add(layers.Dense(units=128, activation='relu')) classifier.add(layers.Dense(units=1, activation='sigmoid')) # Compiling the CNN we shall use the Adam stochastic optimisation method, binary cross entropy loss function classifier.compile(optimizer=tf.keras.optimizers.Adam(), loss='binary_crossentropy', metrics=['accuracy']) return classifier</span></span></code> </pre><br> ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨â€œçŒ«ç‹—â€å·¥å…·åŒ…ä¸Šè¿›è¡Œç½‘ç»œåŸ¹è®­ã€‚ åŸ¹è®­éœ€è¦å¾ˆé•¿æ—¶é—´ï¼ˆåœ¨GPUä¸Šéœ€è¦20åˆ†é’Ÿï¼Œåœ¨CPUä¸Šéœ€è¦1-2å°æ—¶ï¼‰ï¼Œå› æ­¤æœ€åæˆ‘ä»¬å°†æ¨¡å‹ä¿å­˜åˆ°æ–‡ä»¶ä¸­ã€‚ <br><br><pre> <code class="python hljs">tl_model = custom_model() t_start = time.time() tl_model.fit(train_batch, steps_per_epoch=<span class="hljs-number"><span class="hljs-number">8000</span></span>, epochs=<span class="hljs-number"><span class="hljs-number">2</span></span>, validation_data=validation_batch, validation_steps=<span class="hljs-number"><span class="hljs-number">10</span></span>, callbacks=<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) print(<span class="hljs-string"><span class="hljs-string">"Training done, dT:"</span></span>, time.time() - t_start) print(tl_model.summary()) validation_steps = <span class="hljs-number"><span class="hljs-number">20</span></span> loss0, accuracy0 = tl_model.evaluate(validation_batch, steps=validation_steps) print(<span class="hljs-string"><span class="hljs-string">"Loss: {:.2f}"</span></span>.format(loss0)) print(<span class="hljs-string"><span class="hljs-string">"Accuracy: {:.2f}"</span></span>.format(accuracy0)) tl_model.save(<span class="hljs-string"><span class="hljs-string">"dog_cat_model.h5"</span></span>)</code> </pre><br> é¡ºä¾¿è¯´ä¸€å¥ï¼Œç›´æ¥åœ¨Jetson Nanoä¸Šè¿›è¡ŒåŸ¹è®­çš„å°è¯•å¤±è´¥äº†-5åˆ†é’Ÿåï¼Œä¸»æ¿è¿‡çƒ­å¹¶æŒ‚äº†ã€‚ å¯¹äºèµ„æºå¯†é›†å‹è®¡ç®—ï¼Œç”µè·¯æ¿éœ€è¦ä¸€ä¸ªå†·å´å™¨ï¼Œå°½ç®¡æ€»çš„æ¥è¯´ï¼Œç›´æ¥åœ¨Jetson Nanoä¸Šæ‰§è¡Œæ­¤ç±»ä»»åŠ¡æ²¡æœ‰ä»»ä½•æ„ä¹‰-æ‚¨å¯ä»¥åœ¨PCä¸Šè®­ç»ƒæ¨¡å‹å¹¶åœ¨Nanoä¸Šä½¿ç”¨å®Œæˆçš„ä¿å­˜æ–‡ä»¶ã€‚ <br><br> ç„¶ååˆå‡ºç°äº†ä¸€ä¸ªé™·é˜±-åœ¨PCä¸Šå®‰è£…äº†tensowflowç‰ˆæœ¬14åº“ï¼Œåˆ°ç›®å‰ä¸ºæ­¢ï¼ŒJetson Nanoçš„æœ€æ–°ç‰ˆæœ¬æ˜¯13ã€‚è€Œä¸”åœ¨ç¬¬13ç‰ˆä¸­æ²¡æœ‰è¯»å–ä¿å­˜åœ¨ç¬¬14ç‰ˆä¸­çš„æ¨¡å‹ï¼Œæˆ‘ä¸å¾—ä¸ä½¿ç”¨pipå®‰è£…ç›¸åŒçš„ç‰ˆæœ¬ã€‚ <br><br> æœ€åï¼Œæˆ‘ä»¬å¯ä»¥ä»æ–‡ä»¶ä¸­åŠ è½½æ¨¡å‹å¹¶ä½¿ç”¨å®ƒæ¥è¯†åˆ«å›¾åƒã€‚ <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">predict_model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(model, image_file)</span></span></span><span class="hljs-function">:</span></span> img = image.load_img(image_file, target_size=(IMAGE_SIZE, IMAGE_SIZE)) t_start = time.time() img_arr = np.expand_dims(img, axis=<span class="hljs-number"><span class="hljs-number">0</span></span>) result = model.predict_classes(img_arr) print(<span class="hljs-string"><span class="hljs-string">"Result: {}, dT: {}"</span></span>.format(label_names(result[<span class="hljs-number"><span class="hljs-number">0</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>]), time.time() - t_start)) model = tf.keras.models.load_model(<span class="hljs-string"><span class="hljs-string">'dog_cat_model.h5'</span></span>) predict_model(model, <span class="hljs-string"><span class="hljs-string">"cat.png"</span></span>) predict_model(model, <span class="hljs-string"><span class="hljs-string">"dog1.png"</span></span>) predict_model(model, <span class="hljs-string"><span class="hljs-string">"dog2.png"</span></span>)</code> </pre><br> çŒ«çš„ç…§ç‰‡ä½¿ç”¨äº†ç›¸åŒçš„ç…§ç‰‡ï¼Œä½†â€œç‹—â€æµ‹è¯•ä½¿ç”¨äº†2å¼ ç…§ç‰‡ï¼š <br><br><img src="https://habrastorage.org/webt/2m/0m/6f/2m0m6fvejlzvcdfuewdq2m9b5ug.png"><br><br> ç¬¬ä¸€ä¸ªçŒœå¯¹äº†ï¼Œç¬¬äºŒä¸ªå¼€å§‹æœ‰é”™è¯¯ï¼Œç¥ç»ç½‘ç»œè®¤ä¸ºé‚£æ˜¯ä¸€åªçŒ«ï¼Œæˆ‘ä¸å¾—ä¸å¢åŠ è®­ç»ƒçš„è¿­ä»£æ¬¡æ•°ã€‚ ä½†æ˜¯ï¼Œæˆ‘å¯èƒ½ç¬¬ä¸€æ¬¡ä¼šçŠ¯ä¸€ä¸ªé”™è¯¯ï¼› <br><br> äº‹å®è¯æ˜ï¼Œåœ¨Jetson Nanoä¸Šçš„æ‰§è¡Œæ—¶é—´éå¸¸çŸ­-ç¬¬ä¸€å¼ ç…§ç‰‡çš„å¤„ç†æ—¶é—´ä¸º0.3ç§’ï¼Œä½†éšåçš„æ‰€æœ‰ç…§ç‰‡éƒ½å¿«å¾—å¤šï¼Œæ˜¾ç„¶æ•°æ®å·²ç¼“å­˜åœ¨å†…å­˜ä¸­ã€‚ <br><br><img src="https://habrastorage.org/webt/hx/w1/vg/hxw1vgfb217p1usxaftimpmkybo.png"><br><br> é€šå¸¸ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾åœ¨è¿™æ ·ç®€å•çš„ç¥ç»ç½‘ç»œä¸Šï¼Œå³ä½¿ä¸è¿›è¡Œä»»ä½•ä¼˜åŒ–ï¼Œç”µè·¯æ¿é€Ÿåº¦ä¹Ÿè¶³å¤Ÿäº†ï¼Œå³ä½¿å¯¹äºå®æ—¶è§†é¢‘ï¼Œ100fpsä¹Ÿè¶³å¤Ÿäº†ã€‚ <br><br><h2> ç»“è®º </h2><br> å¦‚æ‚¨æ‰€è§ï¼Œå³ä½¿æˆåŠŸçš„ç¨‹åº¦ä¸å°½ç›¸åŒï¼Œå³ä½¿Keraså’ŒTensorflowçš„æ ‡å‡†æ¨¡å‹ä¹Ÿå¯ä»¥ç”¨äºNanoã€‚ ä½†æ˜¯ï¼Œç»“æœå¯ä»¥å¾—åˆ°æ”¹å–„ï¼Œæœ‰å…³ä¼˜åŒ–æ¨¡å‹å’Œå‡å°å†…å­˜å¤§å°çš„è¯´æ˜å¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a>é˜…è¯»ã€‚ <br><br> ä½†æ˜¯å¹¸è¿çš„æ˜¯ï¼Œåˆ¶é€ å•†å·²ç»ä¸ºæˆ‘ä»¬åšåˆ°äº†ã€‚ å¦‚æœè¯»è€…ä»ç„¶æœ‰å…´è¶£ï¼Œé‚£ä¹ˆæœ€åä¸€éƒ¨åˆ†å°†ä¸“é—¨ä»‹ç»é’ˆå¯¹Jetson Nanoè¿›è¡Œäº†ä¼˜åŒ–çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç°æˆåº“</a> ã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN460971/">https://habr.com/ru/post/zh-CN460971/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN460959/index.html">å¾®è½¯çš„æ–°æŠ€æœ¯å…è®¸çœŸå®äººç‰©çš„3Då‰¯æœ¬ä½¿ç”¨ä»»ä½•è¯­è¨€</a></li>
<li><a href="../zh-CN460961/index.html">åœ¨æ··åˆçš„Swift + Objective-Cé¡¹ç›®ä¸­è®¾ç½®å•å…ƒæµ‹è¯•</a></li>
<li><a href="../zh-CN460965/index.html">æ²¡æœ‰è¿™äº›æ•…äº‹æ¿çš„åˆ†å‰²æ§åˆ¶å™¨</a></li>
<li><a href="../zh-CN460967/index.html">ç‰¹æ´›ä¼ŠÂ·äº¨ç‰¹ï¼ˆTroy Huntï¼‰ï¼šé’ˆå¯¹ä¿¡æ¯æŠ€æœ¯ä¸“ä¸šäººå‘˜çš„10é¡¹ä¸ªäººç†è´¢è¯¾ç¨‹</a></li>
<li><a href="../zh-CN460969/index.html">ç›æ ¼ä¸½ç‰¹Â·æ±‰å¯†å°”é¡¿ï¼šâ€œä»–ä»¬æ‹…å¿ƒç”·äººä¼šåæŠ—ï¼› å´æ²¡æœ‰å‘ç”Ÿâ€</a></li>
<li><a href="../zh-CN460973/index.html">18650ç”µæ± çš„æ¥è§¦ç„Šæ¥</a></li>
<li><a href="../zh-CN460979/index.html">å¤å…´ç”Ÿç‰©æŠ€æœ¯æ˜¯çœŸå®ä¸”ä¸å¯é¿å…çš„</a></li>
<li><a href="../zh-CN460981/index.html">åŸºäºCatelæ¡†æ¶æ„å»ºçš„WPFåº”ç”¨ç¨‹åºé…ç½®çš„MVVMå®ç°</a></li>
<li><a href="../zh-CN460983/index.html">æˆ‘ä¸æ˜¯çœŸçš„</a></li>
<li><a href="../zh-CN460985/index.html">2019å¹´14ç§æœ€ä½³çœ‹æ¿å·¥å…·</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>