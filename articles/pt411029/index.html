<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨🏻‍⚕️ 🎡 🀄️ Como usar interfaces no Go 📙 🔆 🧗🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em seu tempo livre da obra principal, o autor do material consulta o Go e analisa o código. Naturalmente, durante uma atividade desse tipo, ele lê mui...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Como usar interfaces no Go</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/wirex/blog/411029/"><img src="https://habrastorage.org/webt/3r/a6/gf/3ra6gfzzmia3bmlydkdkqbmpl6a.jpeg"><br><br>  <i>Em seu tempo livre da obra principal, o autor do material consulta o Go e analisa o código.</i>  <i>Naturalmente, durante uma atividade desse tipo, ele lê muitos códigos escritos por outras pessoas.</i>  <i>Recentemente, o autor deste artigo tem a impressão (sim, impressão, sem estatística) de que os programadores têm mais probabilidade de trabalhar com interfaces no "estilo Java".</i> <i><br><br></i>  <i>Este post contém recomendações do autor sobre o uso ideal de interfaces no Go, com base em sua experiência na criação de código.</i> <br><br>  Nos exemplos deste post, usaremos dois pacotes <code>animal</code> e <code>circus</code> .  Muitas coisas neste post descrevem o trabalho com código que limita o uso regular de pacotes. <br><br><h3>  Como não fazer </h3><br>  Um fenômeno muito comum que observo: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> animals <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Animal <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Speaks() <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-comment"><span class="hljs-comment">//  Animal type Dog struct{} func (a Dog) Speaks() string { return "woof" }</span></span></code> </pre> <a name="habracut"></a><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> circus <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"animals"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Perform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a animal.Animal)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a.Speaks() }</code> </pre> <br>  Esse é o chamado uso de interfaces no estilo Java.  Pode ser caracterizado pelas seguintes etapas: <br><br><ol><li>  Defina uma interface. </li><li>  Defina um tipo que satisfaça o comportamento da interface. </li><li>  Defina métodos que satisfazem a implementação da interface. </li></ol><br>  Em resumo, estamos lidando com "tipos de escrita que satisfazem interfaces".  Este código tem seu próprio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">cheiro</a> distinto, sugerindo os seguintes pensamentos: <br><br><ul><li>  Apenas um tipo satisfaz a interface, sem nenhuma intenção de expandi-la ainda mais. </li><li>  As funções geralmente usam tipos concretos em vez de tipos de interface. </li></ul><br><h3>  Como fazer </h3><br>  As interfaces no Go incentivam uma abordagem preguiçosa, o que é bom.  Em vez de escrever tipos que satisfaçam interfaces, você deve escrever interfaces que atendam aos requisitos práticos reais. <br><br>  O que significa: em vez de definir <code>Animal</code> no pacote <code>animals</code> , defina-o no ponto de uso, ou seja, o pacote <code>circus</code> <abbr title="Você poderia, é claro, defini-lo em uma assinatura de função, mas essa é uma abordagem muito superficial">*</abbr> . <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> animals <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Dog <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span>{} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a Dog)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Speaks</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"woof"</span></span> }</code> </pre> <br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> circus <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Speaker <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Speaks() <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Perform</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a Speaker)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">string</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a.Speaks() }</code> </pre> <br>  Uma maneira mais natural de fazer isso é assim: <br><br><ol><li>  Definir tipos </li><li>  Defina a interface no ponto de uso. </li></ol><br>  Essa abordagem reduz a dependência dos componentes do pacote de <code>animals</code> .  Reduzir dependências é o caminho certo para criar software tolerante a falhas. <br><br><h3>  Lei da cama </h3><br>  Há um bom princípio para escrever um bom software.  Essa é a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">lei de Postel</a> , que geralmente é formulada da seguinte maneira: <br><blockquote>  "Seja conservador sobre o que você refere e liberal sobre o que você aceita" </blockquote>  Em termos de Go, a lei é: <br><br><blockquote>  "Aceitar interfaces, retornar estruturas" </blockquote><br>  Em suma, esta é uma regra muito boa para projetar coisas estáveis ​​e tolerantes a falhas <abbr title="Claro, existem nuances que eu omito. Por exemplo, em casos com código sensível ao contexto, será muito útil aceitar e fornecer interfaces)">*</abbr> .  A principal unidade de código no Go é uma função.  Ao projetar funções e métodos, é útil aderir ao seguinte padrão: <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">funcName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a INTERFACETYPE)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CONCRETETYPE</span></span></span></span></code> </pre> <br>  Aqui aceitamos tudo o que implementa uma interface que pode ser qualquer coisa, incluindo uma interface vazia.  Um valor de um tipo específico é sugerido.  Obviamente, limitar o que pode ser faz sentido.  Como diz um provérbio Go: <br><br><blockquote>  "A interface vazia não diz nada", <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Rob Pike</a> </blockquote><br>  Portanto, é altamente recomendável impedir que funções aceitem a <code>interface{}</code> . <br><br><h3>  Exemplo de Aplicação: Imitação </h3><br>  Um exemplo impressionante dos benefícios da aplicação da lei Postel são os casos de teste.  Digamos que você tenha uma função parecida com esta: <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Takes</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(db Database)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">error</span></span></span></span></code> </pre> <br>  Se o <code>Database</code> for uma interface, no código de teste você poderá simplesmente fornecer uma imitação da implementação do <code>Database</code> de <code>Database</code> sem a necessidade de passar um objeto de banco de dados real. <br><br><h3>  Quando a definição de uma interface com antecedência é aceitável </h3><br>  Para dizer a verdade, a programação é uma maneira bastante gratuita de expressar idéias.  Não há regras inabaláveis.  Obviamente, você sempre pode definir interfaces com antecedência, sem medo de ser preso pela polícia de códigos.  No contexto de muitos pacotes, se você conhece suas funções e pretende aceitar uma interface específica dentro do pacote, faça-o. <br><br>  Definir uma interface geralmente cheira a excesso de engenharia, mas há situações em que você obviamente deve fazer exatamente isso.  Em particular, os seguintes exemplos vêm à mente: <br><br><ul><li>  Interfaces seladas </li><li>  Tipos de dados abstratos </li><li>  Interfaces Recursivas </li></ul><br>  A seguir, consideramos brevemente cada um deles. <br><br><h3>  Interfaces seladas </h3><br>  Interfaces seladas só podem ser discutidas no contexto de vários pacotes.  Uma interface selada é uma interface com métodos não exportados.  Isso significa que usuários fora deste pacote não podem criar tipos que satisfazem essa interface.  Isso é útil para emular um tipo de variante para procurar exaustivamente os tipos que satisfazem a interface. <br><br>  Se você definiu algo como isto: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Fooer <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Foo() sealed() }</code> </pre> <br>  Somente o pacote definido pela <code>Fooer</code> pode usá-lo e criar algo de valor a partir dele.  Isso permite criar operadores de chave de força bruta para tipos. <br><br>  A interface selada também permite que as ferramentas de análise captem facilmente qualquer correspondência de padrão sem colisão.  O pacote sumtypes do BurntSushi tem como objetivo resolver este problema. <br><br><h3>  Tipos de dados abstratos </h3><br>  Outro caso de definição antecipada de uma interface envolve a criação de tipos de dados abstratos.  Eles podem ser selados ou não. <br><br>  Um bom exemplo disso é o pacote de <code>sort</code> , que faz parte da biblioteca padrão.  Ele define uma coleção classificável da seguinte maneira <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Interface <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { <span class="hljs-comment"><span class="hljs-comment">// Len —    . Len() int // Less      //   i     j. Less(i, j int) bool // Swap     i  j. Swap(i, j int) }</span></span></code> </pre> <br>  Esse trecho de código incomoda muitas pessoas, porque se você quiser usar o pacote de <code>sort</code> , precisará implementar métodos para a interface.  Muitos não gostam da necessidade de adicionar três linhas de código adicionais. <br><br>  No entanto, acho que essa é uma forma muito elegante de genéricos no Go.  Seu uso deve ser mais frequentemente incentivado. <br><br>  Opções de design alternativas e ao mesmo tempo elegantes exigirão tipos de pedidos mais altos.  Neste post, não os consideraremos. <br><br><h3>  Interfaces Recursivas </h3><br>  Este é provavelmente outro exemplo de código com um estoque, mas há momentos em que é simplesmente impossível evitar usá-lo.  Manipulações simples permitem obter algo como <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Fooer <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { Foo() Fooer }</code> </pre> <br>  Um padrão de interface recursiva obviamente exigirá sua definição com antecedência.  A recomendação de definição de interface de ponto de uso não é aplicável aqui. <br><br>  Esse padrão é útil para criar contextos com trabalho subsequente neles.  O código carregado pelo contexto geralmente se fecha dentro do pacote exportando apenas os contextos (ala o pacote <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tensor</a> ); portanto, na prática, não vejo esse caso com tanta frequência.  Posso dizer-lhe algo mais sobre padrões contextuais, mas deixe para outro post. <br><br><h3>  Conclusão </h3><br>  Apesar do fato de um dos títulos da postagem exibir "Como não fazer", não estou tentando proibir nada.  Em vez disso, quero fazer com que os leitores pensem com mais frequência sobre as condições das fronteiras, pois é nesses casos que surgem várias situações de emergência. <br><br>  Acho o princípio da declaração no ponto de uso extremamente útil.  Como resultado de sua aplicação na prática, não encontro problemas que ocorram se eu o negligenciar. <br><br>  No entanto, também ocasionalmente escrevo interfaces no estilo Java.  Normalmente, isso acontece se, pouco antes, eu escrevi muito código em Java ou Python.  O desejo de complicar demais e "apresentar tudo na forma de classes" às vezes se manifesta muito fortemente, especialmente se você escrever o código Go depois de escrever muito código orientado a objetos. <br><br>  Assim, este post também serve como um lembrete para si mesmo sobre como é o caminho para escrever código, que não causará dor de cabeça posteriormente.  Aguardando seus comentários! <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/files/4bd/bf6/597/4bdbf659775744b1bdbb4d8a00a0a980.png" alt="imagem"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt411029/">https://habr.com/ru/post/pt411029/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt411017/index.html">A solidão dos nascidos. Desenvolvimento por voo. Caminho difícil para si mesmo</a></li>
<li><a href="../pt411019/index.html">Para deixar a Rússia e encontrar trabalho no exterior: estamos nos preparando para uma entrevista em inglês</a></li>
<li><a href="../pt411021/index.html">Sunlike - a nova geração de luz LED</a></li>
<li><a href="../pt411023/index.html">Antropoceno africano</a></li>
<li><a href="../pt411027/index.html">Jogos Olímpicos: Jedi Sword, Jetpack e Teleport to 2035</a></li>
<li><a href="../pt411031/index.html">O primeiro scanner MEG portátil do mundo</a></li>
<li><a href="../pt411033/index.html">"Do", "Understand", "agree": sinônimos em inglês</a></li>
<li><a href="../pt411035/index.html">Ou talvez você esteja dormindo agora?</a></li>
<li><a href="../pt411037/index.html">Sochi.Camera: como um provedor regional criou um site de transmissão de vídeo com uma visita de 500.000 pessoas por mês</a></li>
<li><a href="../pt411039/index.html">O segundo contato, ou em vez do epílogo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>