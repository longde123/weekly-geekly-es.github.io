<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐คถ ๐ฉ๐ผโ๐ผ ๐ต ูุณุชูุฏุน LINSTOR ูุชูุงููู ูุน OpenNebula โท๏ธ ๐ โ๐ฟ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ููุฐ ููุช ููุณ ุจุจุนูุฏ ุ ูุฏู ุดุจุงุจ LINBIT ุญู SDS ุงูุฌุฏูุฏ - Linstor. ูุฐุง ุชุฎุฒูู ูุฌุงูู ุชูุงููุง ูุนุชูุฏ ุนูู ุชูููุงุช ูุฌุฑุจุฉ: DRBD ุ LVM ุ ZFS. ูุฌูุน Linstor ุจูู ุงูุจุณุงุทุฉ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ูุณุชูุฏุน LINSTOR ูุชูุงููู ูุน OpenNebula</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451186/" style=";text-align:right;direction:rtl"><p style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/e-/3z/h-/e-3zh-bbwjnljyazm68edln7muw.png"></p><br><p style=";text-align:right;direction:rtl">  ููุฐ ููุช ููุณ ุจุจุนูุฏ ุ ูุฏู ุดุจุงุจ LINBIT ุญู SDS ุงูุฌุฏูุฏ - Linstor.  ูุฐุง ุชุฎุฒูู ูุฌุงูู ุชูุงููุง ูุนุชูุฏ ุนูู ุชูููุงุช ูุฌุฑุจุฉ: DRBD ุ LVM ุ ZFS.  ูุฌูุน Linstor ุจูู ุงูุจุณุงุทุฉ ูุงูููุฏุณุฉ ุงููุนูุงุฑูุฉ ุงููุตููุฉ ุจุดูู ุฌูุฏ ุ ูุงูุชู ุชุชูุญ ุงูุงุณุชูุฑุงุฑ ูุงููุชุงุฆุฌ ุงูุฑุงุฆุนุฉ. </p><br><p style=";text-align:right;direction:rtl">  ุฃูุฏ ุงูููู ุฃู ุฃุฎุจุฑูู ููููุงู ุนู ุฐูู ูุฃุธูุฑ ูุฏู ุณูููุฉ ุฏูุฌู ูุน OpenNebula ุจุงุณุชุฎุฏุงู linstor_un ุ ููู ุจุฑูุงูุฌ ุชุดุบูู ุฌุฏูุฏ ููุช ุจุชุทููุฑู ุฎุตูุตูุง ููุฐุง ุงูุบุฑุถ. </p><br><p style=";text-align:right;direction:rtl">  ูุชูุญ ูู Linstor ุจุงูุงุดุชุฑุงู ูุน OpenNebula ุจูุงุก ุณุญุงุจุฉ ุณุฑูุนุฉ ูููุซููุฉ ูููู ูุดุฑูุง ุจุณูููุฉ ุนูู ุงูุจููุฉ ุงูุฃุณุงุณูุฉ ุงูุฎุงุตุฉ ุจู. </p><a name="habracut"></a><br><h2 id="arhitektura-linstor" style=";text-align:right;direction:rtl">  ูููุณุชูุฑ ุงูุนูุงุฑุฉ </h2><br><p style=";text-align:right;direction:rtl"> Linstor ููุณ ูุธุงู ูููุงุช ููุง ูุณุชูุฏุน ูุชูุฉ ูู ุญุฏ ุฐุงุชู ุ Linstor ูู ุฃูุฑูุณุชุฑุง ูููุฑ ุทุจูุฉ ุชุฌุฑูุฏูุฉ ุชููู ุจุฃุชูุชุฉ ุฅูุดุงุก ูุญุฏุฉ ุงูุชุฎุฒูู ูู LVM ุฃู ZFS ูุชูุฑุงุฑูุง ุจุงุณุชุฎุฏุงู DRBD9. </p><br><h5 id="lomaem-stereotipy" style=";text-align:right;direction:rtl">  ูุณุฑ ุงูุตูุฑ ุงูููุทูุฉ </h5><br><p style=";text-align:right;direction:rtl">  ููู ูููุง ุ DRBDุ  "ููุงุฐุง ุฃุชูุชุฉ ุ ูููู ูููู ุฃู ุชุนูู ุญุชูุ" </p><br><p style=";text-align:right;direction:rtl">  ุฃุฐูุฑ ุงููุงุถู ุนูุฏูุง ูุงู DRBD8 ุดุงุฆุนูุง ุทูุงู ุงูููุช.  ูุชุถูู ุงุณุชุฎุฏุงูู ุงูููุงุณู ุฅูุดุงุก ุฌูุงุฒ ูุชูุฉ ูุจูุฑ ูุชูุทูุนู ุฅูู ุนุฏุฉ ูุทุน ุตุบูุฑุฉ ุ ุจุงุณุชุฎุฏุงู ููุณ LVM.  ููุน ูู mdadm RAID-1 ูููู ูุน ุงููุณุฎ ุงููุชูุงุซู ุนุจุฑ ุงูุดุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  ูุฐุง ุงูููุฌ ูุง ูุฎูู ูู ุงูุนููุจ ุ ูุจุงูุชุงูู ุ ูุน ุธููุฑ DRBD9 ุ ุชุบูุฑุช ูุจุงุฏุฆ ุฅูุดุงุก ุงูุชุฎุฒูู ุ ูุงูุขู ูุชู ุฅูุดุงุก ุฌูุงุฒ DRBD ูููุตู ููู ุฌูุงุฒ ุงูุชุฑุงุถู. </p><br><p style=";text-align:right;direction:rtl">  ูุชูุญ ูู ุงูููุฌ ูุน ุฃุฌูุฒุฉ ุงููุชู ุงููุณุชููุฉ ุงูุงุณุชูุงุฏุฉ ุจุดูู ุฃูุถู ูู ุงููุณุงุญุฉ ุงูููุฌูุฏุฉ ูู ุงููุชูุฉ ุ ููุง ูุถูู ุนุฏุฏูุง ูู ุงูููุฒุงุช ุงูุฅุถุงููุฉ.  ุนูู ุณุจูู ุงููุซุงู ุ ููู ุฌูุงุฒ ุ ููููู ุชุญุฏูุฏ ุนุฏุฏ ุงููุณุฎ ุงููุชูุงุซูุฉ ููููุนูุง ูุงูุฅุนุฏุงุฏุงุช ุงููุฑุฏูุฉ.  ููู ุณููุฉ ุงูุฅูุดุงุก / ุงูุญุฐู ุ ูุฌุนู ููุทุงุช ุ ุชุบููุฑ ุญุฌู ุ ุชูููู ุงูุชุดููุฑ ูุฃูุซุฑ ูู ุฐูู ุจูุซูุฑ.  ุชุฌุฏุฑ ุงูุฅุดุงุฑุฉ ุฅูู ุฃู DRBD9 ูุฏุนู ุงููุตุงุจ ุ ูุงูุฐู ูุชุฌูุจ ุงูููุงูู ุงููููุตูุฉ. </p><br><h5 id="resursy-i-bekendy" style=";text-align:right;direction:rtl">  ุงูููุงุฑุฏ ูุงูุฎูููุงุช </h5><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุฅูุดุงุก ุฌูุงุฒ ูุชูุฉ ุฌุฏูุฏ ุ ูุถุน Linstor ุงูุนุฏุฏ ุงููุทููุจ ูู ุงููุณุฎ ุงููุชูุงุซูุฉ ุนูู ุนูุฏ ูุฎุชููุฉ ูู ุงููุชูุฉ.  ุณูู ูุฏุนู ูู ูุณุฎุฉ ุทุจู ุงูุฃุตู ุฅูู ูุฐุง ุงูููุฑุฏ DRBD. </p><br><p style=";text-align:right;direction:rtl">  ุงูููุงุฑุฏ ูู ููุนูู: </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>ููุฑุฏ ุงูุจูุงูุงุช</strong> - ุนุจุงุฑุฉ ุนู ุฌูุงุฒ DRBD ููุฌูุฏ ุนูู ุนูุฏุฉ ูู ุชุฌูุน LVM ุฃู ZFS. <br>  ูู ุงูููุช ุงูุญุงูู ุ ููุฌุฏ ุฏุนู ููุนุฏูุฏ ูู ุงูุฎูููุฉ ููููู ุนุฏุฏูู ุจุงุณุชูุฑุงุฑ.  ููุงู ุฏุนู ู LVM ุ ThinLVM ู ZFS.  ูุณูุญ ูู ุงูุฃุฎูุฑุงู ุจุฅูุดุงุก ููุทุงุช ูุงุณุชุฎุฏุงููุง. </li><li style=";text-align:right;direction:rtl">  <strong>ููุฑุฏ ุจุฏูู ูุฑุต</strong> - ูู ุฌูุงุฒ DRBD ููุน ุนูู ุนูุฏุฉ ุจุฏูู ุฎูููุฉ ุ ูููู ูุณูุญ ุจูุนุงููุชู ูุฌูุงุฒ ูุชูุฉ ุนุงุฏู ุ ูุณูุชู ุฅุนุงุฏุฉ ุชูุฌูู ุฌููุน ุนูููุงุช ุงููุฑุงุกุฉ / ุงููุชุงุจุฉ ุฅูู ููุงุฑุฏ ุงูุจูุงูุงุช.  ุฃูุฑุจ ููุงูุฆ ููููุงุฑุฏ ุงูุฎุงููุฉ ูู ุงูุฃูุฑุงุต ูู iSCSI LUN. </li></ul><br><p style=";text-align:right;direction:rtl">  ูููู ุฃู ูุญุชูู ูู ููุฑุฏ ูู ููุงุฑุฏ DRBD ุนูู ูุง ูุตู ุฅูู 8 ูุณุฎ ูุชูุงุซูุฉ ุ ููููู ุฃู ูููู ูุงุญุฏูุง ูููุง ูุดุทูุง ุจุดูู ุงูุชุฑุงุถู - <strong>ุฃุณุงุณู</strong> ุ ููู ูุง ุชุจูู ุณูููู <strong>ุซุงููููุง</strong> ูุณูููู ุงุณุชุฎุฏุงููู ูุณุชุญูููุง ุฅูู ุฃู ูููู ููุงู ูุงุญุฏ ุฃุณุงุณู ุนูู ุงูุฃูู ุ ุฃู ุฃูู ุณูุชู ูุณุฎ ูุชูุงุซู ุจุจุณุงุทุฉ ุงูุจูุงูุงุช ุจููููุง. </p><br><p style=";text-align:right;direction:rtl">  ุนูุฏ ุชุฑููุจ ุฌูุงุฒ DRBD ูู ุงููุธุงู ุ ูุตุจุญ ุชููุงุฆููุง <strong>ุฃุณุงุณู</strong> ุ ูุฐูู ูููู ุฃู ูููู ููุฑุฏูุง ุจูุง Diskless ุ ูู ูุตุทูุญุงุช DRBD ุ ุฃุณุงุณููุง. </p><br><h5 id="tak-zachem-nuzhen-linstor" style=";text-align:right;direction:rtl">  ูููุงุฐุง ูุญุชุงุฌ Linstorุ </h5><br><p style=";text-align:right;direction:rtl">  ูุนุฏ Linstor ุ ุงูุฐู ูุนุฏ ูู ุงูููุงู ุงูุฃุณุงุณูุฉ ุงูููุซูุฉ ุฅูู kernel ุ ุชุทุจูููุง ุฃุณุงุณููุง ูุฌุงูุง ูุฌุนู ูู ุงูุณูู ุฃุชูุชุฉ ุฅูุดุงุก ููุงุฑุฏ DRBD. <br>  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ุณูููู ูู ููุฑุฏ ุชู ุฅูุดุงุคู ุจูุงุณุทุชู ุนุจุงุฑุฉ ุนู ูุฌููุนุฉ DRBD ูุณุชููุฉ ุชุนูู ุจุดูู ูุณุชูู ุ ุจุบุถ ุงููุธุฑ ุนู ุญุงูุฉ ูุณุชูู ุงูุชุญูู ูููุงุฑุฏ DRBD ุงูุฃุฎุฑู. </p><br><p style=";text-align:right;direction:rtl">  <strong>ูุชููู Linstor ูู ูููููู ููุท:</strong> </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>Linstor-controller</strong> - <strong>ูุญุฏุฉ ุงูุชุญูู</strong> ุงูุฑุฆูุณูุฉ ุงูุชู ุชููุฑ ูุงุฌูุฉ ุจุฑูุฌุฉ ุงูุชุทุจููุงุช ูุฅูุดุงุก ูุฅุฏุงุฑุฉ ุงูููุงุฑุฏ.  ูุชูุงุตู ุฃูุถูุง ูุน ุงูุฃููุงุฑ ุงูุตูุงุนูุฉ ุ ููุชุญูู ูู ุงููุณุงุญุฉ ุงูุฎุงููุฉ ุนูููุง ุ ููุฑุณู ุงูููุงู ูุฅูุดุงุก ูุญุฐู ููุงุฑุฏ ุฌุฏูุฏุฉ.  ูุชู ุชุดุบููู ูู ูุซูู ูุงุญุฏ ููุณุชุฎุฏู ูุงุนุฏุฉ ุจูุงูุงุช ุ ูุงูุชู ูููู ุฃู ุชููู ุฅูุง ุฏุงุฎููุฉ (H2) ุฃู ุฎุงุฑุฌูุฉ (PostgreSQL ุ MySQL ุ MariaDB) </li><li style=";text-align:right;direction:rtl">  <strong>Linstor-satellite</strong> - ูุซุจุช ุนูู ุฌููุน ุนูุฏ ุงูุชุฎุฒูู ููุฒูุฏ ุฌูุงุฒ ุงูุชุญูู ุจูุนูููุงุช ุญูู ุงููุณุงุญุฉ ุงูุฎุงููุฉ ุ ููุง ูุคุฏู ุงูููุงู ุงููุชููุงุฉ ูู ูุญุฏุฉ ุงูุชุญูู ูุฅูุดุงุก ูุญุฐู ูุญุฏุงุช ุชุฎุฒูู ุฌุฏูุฏุฉ ูุฃุฌูุฒุฉ DRBD ุฃุนูููุง. </li></ul><br><p style=";text-align:right;direction:rtl">  <strong>ุชุนูู Linstor ูุน ุงูููุงููู ุงูุฃุณุงุณูุฉ ุงูุชุงููุฉ:</strong> </p><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <strong>ุงูุนูุฏุฉ</strong> ูู ุฎุงุฏู ูุนูู ูุชู ูู ุฎูุงูู ุฅูุดุงุก ููุงุฑุฏ DRBD ูุงุณุชุฎุฏุงููุง. </li><li style=";text-align:right;direction:rtl">  <strong>ุชุฌูุน ุงูุชุฎุฒูู</strong> - <strong>ุชุฌูุน</strong> LVM ุฃู ZFS ุงูุฐู ุชู ุฅูุดุงุคู ุนูู ุนูุฏุฉ ุญูุซ ุณูุชู ูุถุน ููุงุฑุฏ DRBD.  ูู ุงููููู ุฃูุถูุง ุงุณุชุฎุฏุงู ุชุฌูุน ุจุฏูู ูุฑุต - ูุฐุง ูู ุงูุชุฌูุน ุงูุฐู ุณูุชู ููู ุงุณุชุถุงูุฉ ุงูููุงุฑุฏ ุงูุฎุงููุฉ ูู ุงูุฃูุฑุงุต ููุท. </li><li style=";text-align:right;direction:rtl">  <strong>ุชุนุฑูู ุงูููุฑุฏ</strong> - <strong>ุชุนุฑูู</strong> ุงูููุฑุฏ ูู ูู ุงูุฃุณุงุณ ูููุฐุฌ ุฃููู ูุตู ุงูุงุณู ูุฌููุน ุฎุตุงุฆุตู. </li><li style=";text-align:right;direction:rtl">  <strong>ุชุนุฑูู ุญุฌู</strong> - <strong>ุชุนุฑูู ุญุฌู</strong> .  ูููู ุฃู ูุชููู ูู ููุฑุฏ ูู ุนุฏุฉ ูุฌูุฏุงุช ุ ููุฌุจ ุฃู ูููู ููู ูุญุฏุฉ ุชุฎุฒูู ุญุฌู. </li><li style=";text-align:right;direction:rtl">  <strong>ููุฑุฏ</strong> - ูุซูู ุชู ุฅูุดุงุคู ูุฌูุงุฒ ูุชูุฉ ุ ูุฌุจ ุฃู ูููู ูู ููุฑุฏ ููุฌูุฏูุง ุนูู ุนูุฏุฉ ูุญุฏุฏุฉ ููู ุจุนุถ ูุญุฏุงุช ุงูุชุฎุฒูู. </li></ul><br><h2 id="ustanovka-linstor" style=";text-align:right;direction:rtl">  ุชุซุจูุช Linstor </h2><br><p style=";text-align:right;direction:rtl">  ุฃูุตู ุจุงุณุชุฎุฏุงู ุฃูุจููุชู ููุธุงู ุ ููุง  ููุงู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">PPA ุงูุฌุงูุฒุฉ</a> ูุฐูู: </p><br><pre style=";text-align:right;direction:rtl"><code class="bash hljs">add-apt-repository ppa:linbit/linbit-drbd9-stack apt-get update</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฃู ุฏุจูุงู ุ ุญูุซ ูููู ุชุซุจูุช Linstor ูู ุงููุณุชูุฏุน ุงูุฑุณูู ูู Proxmox: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">wget -O- https://packages.linbit.com/package-signing-pubkey.asc | apt-key add - PVERS=5 &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"deb http://packages.linbit.com/proxmox/ proxmox-</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$PVERS</span></span></span><span class="hljs-string"> drbd-9.0"</span></span> &gt; \ /etc/apt/sources.list.d/linbit.list apt-get update</code> </pre> <br><h5 id="controller" style=";text-align:right;direction:rtl">  ูุฑุงูุจ </h5><br><p style=";text-align:right;direction:rtl">  ูู ุดูุก ุจุณูุท ููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">apt-get install linstor-controller linstor-client systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> linstor-controller systemctl start linstor-controller</code> </pre> <br><h5 id="storage-nody" style=";text-align:right;direction:rtl">  ุนูุฏ ุงูุชุฎุฒูู </h5><br><p style=";text-align:right;direction:rtl">  ุญุงูููุง ุ ูุชู ุชูููุฑ ูุญุฏุฉ kernel <strong>DRBD8</strong> ุงูููุฌูุฏุฉ ุฏุงุฎู ุงูุดุฌุฑุฉ ูู ููุงุฉ Linux ุ ูุณูุก ุงูุญุธ ุฃููุง ูุง <strong>ุชูุงุณุจูุง</strong> ููุญู ุจุญุงุฌุฉ ุฅูู ุชุซุจูุช <strong>DRBD9</strong> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">apt-get install drbd-dkms</code> </pre> <br><p style=";text-align:right;direction:rtl">  ููุง ุชูุถุญ ุงูููุงุฑุณุฉ ุ ุชูุดุฃ ูุนุธู ุงูุตุนูุจุงุช ุนูู ูุฌู ุงูุชุญุฏูุฏ ูุฃู ูุญุฏุฉ DRBD8 ูุชู ุชุญููููุง ูู ุงููุธุงู ูููุณ DRBD9.  ูุญุณู ุงูุญุธ ุ ูู ุงูุณูู ุงูุชุญูู ูู ุฐูู ุนู ุทุฑูู ุงูููุงู ุจูุง ููู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">modprobe drbd cat /proc/drbd</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุฑุฃูุช <strong>ุงูุฅุตุฏุงุฑ: 9</strong> - ูู ุดูุก ุนูู ูุง ูุฑุงู ุ ุฅุฐุง ูุงู <strong>ุงูุฅุตุฏุงุฑ: 8</strong> - ุซู ุญุฏุซ ุฎุทุฃ ูุง ูุชุญุชุงุฌ ุฅูู ุงุชุฎุงุฐ ุฎุทูุงุช ุฅุถุงููุฉ ููุนุฑูุฉ ุงูุฃุณุจุงุจ. </p><br><p style=";text-align:right;direction:rtl">  ูู ุงูุขู ุจุชุซุจูุช <strong>linstor-satellite</strong> ู <strong>drbd-utils</strong> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">apt-get install linstor-satellite drbd-utils systemctl <span class="hljs-built_in"><span class="hljs-built_in">enable</span></span> linstor-satellite systemctl start linstor-satellite</code> </pre> <br><h2 id="sozdanie-klastera" style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุงููุชูุฉ </h2><br><p style=";text-align:right;direction:rtl">  <strong>ุญูุงูุงุช ุงูุชุฎุฒูู ูุงูุนูุฏ</strong> </p><br><p style=";text-align:right;direction:rtl">  ุณูุชุฎุฐ <strong>ThinLVM</strong> ูุฎูููุฉ ุ ููุง  ูุฐุง ูู ุฃุจุณุท ููุฏุนู ููุทุงุช. <br>  ูู ุจุชุซุจูุช <strong>lvm2</strong> ุฅุฐุง ูู ุชูู ูุฏ ููุช ุจุฐูู ุจุงููุนู ูุฏุนููุง ููุดุฆ ุชุฌูุน ThinLVM ุนูู ุฌููุน ูุญุฏุงุช ุงูุชุฎุฒูู ูุฏููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudo vgcreate drbdpool /dev/sdb sudo lvcreate -L 800G -T drbdpool/thinpool</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูููู ุชูููุฐ ุฌููุน ุงูุฅุฌุฑุงุกุงุช ุงูุฃุฎุฑู ูุจุงุดุฑุฉ ุนูู ูุญุฏุฉ ุงูุชุญูู: </p><br><p style=";text-align:right;direction:rtl">  ุฅุถุงูุฉ ุงูุนูุฏ ูุฏููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">linstor node create node1 127.0.0.11 linstor node create node2 127.0.0.12 linstor node create node3 127.0.0.13</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅูุดุงุก ุญูุงูุงุช ุชุฎุฒูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">linstor storage-pool create lvmthin node1 data drbdpool/thinpool linstor storage-pool create lvmthin node2 data drbdpool/thinpool linstor storage-pool create lvmthin node3 data drbdpool/thinpool</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุชุญูู ุงูุขู ูู ุงูุชุฌูุนุงุช ุงูุชู ุชู ุฅูุดุงุคูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">linstor storage-pool list</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฅุฐุง ุชู ูู ุดูุก ุจุดูู ุตุญูุญ ุ ูุนูุฏุฆุฐ ูุฌุจ ุฃู ูุฑู ุดูุฆูุง ูุซู: </p><br><pre style=";text-align:right;direction:rtl">  + ------------------------------------------------- -------------------------------------------------- ---- +
 |  StoragePool |  ุงูุนูุฏุฉ |  ุณุงุฆู |  ุงุณู ุญูุงู ุงูุณุจุงุญุฉ |  FreeCapacity |  TotalCapacity |  SupportsSnapshots |
 | ------------------------------------------------- -------------------------------------------------- ---- |
 |  ุงูุจูุงูุงุช |  ุงูุนูุฏุฉ 1 |  LVM_THIN |  drbdpool / ุซููุจูู |  64 ุบูุบุงุจุงูุช |  64 ุบูุบุงุจุงูุช |  ุตุญูุญ |
 |  ุงูุจูุงูุงุช |  node2 |  LVM_THIN |  drbdpool / ุซููุจูู |  64 ุบูุบุงุจุงูุช |  64 ุบูุบุงุจุงูุช |  ุตุญูุญ |
 |  ุงูุจูุงูุงุช |  node3 |  LVM_THIN |  drbdpool / ุซููุจูู |  64 ุบูุบุงุจุงูุช |  64 ุบูุบุงุจุงูุช |  ุตุญูุญ |
 + ------------------------------------------------- -------------------------------------------------- ---- + </pre><br><p style=";text-align:right;direction:rtl">  <strong>ููุงุฑุฏ DRBD</strong> </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุฏุนููุง ูุญุงูู ุฅูุดุงุก ููุฑุฏ DRBD ุงูุฌุฏูุฏ ูุฏููุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">linstor resource-definition create myres linstor volume-definition create myres 1G linstor resource create myres --auto-place 2</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุฏุนููุง ูุชุญูู ูู ุงูููุงุฑุฏ ุงูุชู ุชู ุฅูุดุงุคูุง: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">linstor volume list</code> </pre> <br><pre style=";text-align:right;direction:rtl">  + ------------------------------------------------- -------------------------------------------------- --- +
 |  ุงูุนูุฏุฉ |  ุงูููุงุฑุฏ |  StoragePool |  VolumeNr |  ููููุฑ |  ุงุณู ุงูุฌูุงุฒ |  ูุฎุตุต |  ุงุณุชุฎุฏุงู |  ุงูุฏููุฉ |
 | ------------------------------------------------- -------------------------------------------------- --- |
 |  ุงูุนูุฏุฉ 1 |  ูุงูุฑุฒ |  ุงูุจูุงูุงุช |  0 |  1084 |  / dev / drbd1084 |  52 ููููุจุงูุช |  ุบูุฑ ูุณุชุฎุฏูุฉ |  UpToDate |
 |  node2 |  ูุงูุฑุฒ |  ุงูุจูุงูุงุช |  0 |  1084 |  / dev / drbd1084 |  52 ููููุจุงูุช |  ุบูุฑ ูุณุชุฎุฏูุฉ |  UpToDate |
 + ------------------------------------------------- -------------------------------------------------- --- + </pre><br><p style=";text-align:right;direction:rtl">  ! ููุชุงุฒ  - ูุฑู ุฃู ุงูููุฑุฏ ุชู ุฅูุดุงุคู ูู ุงูุนูุฏุชูู ุงูุฃููููู ุ ููููููุง ุฃูุถูุง ูุญุงููุฉ ุฅูุดุงุก ููุฑุฏ ุจุฏูู ุฃูุฑุงุต ูู ุงูุซุงูุซ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">linstor resource create --diskless node3 myres</code> </pre> <br><p style=";text-align:right;direction:rtl">  ุนูู ุงูุนูุฏ ุ ุณุชุฌุฏ ูุฐุง ุงูุฌูุงุฒ ุฏุงุฆููุง ุจุงุณู <code>/dev/drbd1084</code> ุฃู <code>/dev/drbd/by-res/myres/0</code> </p><br><p style=";text-align:right;direction:rtl">  ูุฐู ูู ุงูุทุฑููุฉ ุงูุชู ูุนูู ุจูุง Linstor ุ ููููู ุงูุญุตูู ุนูู ูุฒูุฏ ูู ุงููุนูููุงุช ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุงูุฑุณููุฉ</a> . </p><br><p style=";text-align:right;direction:rtl">  ุงูุขู ุณุฃุชุญุฏุซ ุนู ููููุฉ ุฏูุฌูุง ูุน OpenNebula </p><br><h2 id="nastroyka-opennebula" style=";text-align:right;direction:rtl">  ุชูููู OpenNebula </h2><br><p style=";text-align:right;direction:rtl">  ูู ุฃุชุนูู ูู ุนูููุฉ ุฅูุดุงุก OpenNebula ุ ูุซู  ูุชู ุดุฑุญ ุฌููุน ุงูุฎุทูุงุช ุจุงูุชูุตูู ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุงููุซุงุฆู ุงูุฑุณููุฉ</a> ุ ุงูุชู ุฃูุตูู ุจุงูุงูุชูุงู ุฅูููุง ุ ูุณุฃุฎุจุฑู ููุท ุนู ุชูุงูู OpenNebula ูุน Linstor. </p><br><h5 id="linstor_un" style=";text-align:right;direction:rtl">  linstor_un </h5><br><p style=";text-align:right;direction:rtl">  ูุญู ูุฐู ุงููุดููุฉ ุ ูุชุจุช ุจุฑูุงูุฌ ุงูุชุดุบูู ุงูุฎุงุต ุจู - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">linstor_un</a> ุ ูู ุงูููุช ุงูุญุงูู ููู ูุชุงุญ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููููู</a> ุฅุถุงูู ููุฌุจ ุชุซุจูุชู ุจุดูู ูููุตู. </p><br><p style=";text-align:right;direction:rtl">  ูุชู ุฅุฌุฑุงุก ุฌููุน ุนูููุงุช ุงูุชุซุจูุช ุนูู ุงูุนูุฏ OpenNebula ุงูุฃูุงููุฉ ููุง ุชุชุทูุจ ุฅุฌุฑุงุกุงุช ุฅุถุงููุฉ ุนูู ุงูุนูุฏ ุงูุญุณุงุจูุฉ. </p><br><p style=";text-align:right;direction:rtl">  <strong>ุจุงุฏุฆ ุฐู ุจุฏุก</strong> ุ ูุญู ุจุญุงุฌุฉ ุฅูู ุงูุชุฃูุฏ ูู ุฃู ูุฏููุง <strong>jq</strong> ู <strong>linstor-client</strong> : </p><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">apt-get install jq linstor-client</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฌุจ ุฃู <code>linstor node list</code> ุฃูุฑ <code>linstor node list</code> ุงูุนูุฏ.  ูุฌุจ ุฅุถุงูุฉ ูุงูุฉ ุงูุนูุฏ ุญุณุงุจ OpenNebula ุฅูู ูุชูุฉ Linstor. </p><br><p style=";text-align:right;direction:rtl">  ูู ุจุชูุฒูู ูุชุซุจูุช ุงููููู ุงูุฅุถุงูู: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">curl -L https://github.com/OpenNebula/addon-linstor_un/archive/master.tar.gz | tar -xzvf - -C /tmp mv /tmp/addon-linstor_un-master/vmm/kvm/* /var/lib/one/remotes/vmm/kvm/ mkdir -p /var/lib/one/remotes/etc/datastore/linstor_un mv /tmp/addon-linstor_un-master/datastore/linstor_un/linstor_un.conf /var/lib/one/remotes/etc/datastore/linstor_un/linstor_un.conf mv /tmp/addon-linstor_un-master/datastore/linstor_un /var/lib/one/remotes/datastore/linstor_un mv /tmp/addon-linstor_un-master/tm/linstor_un /var/lib/one/remotes/tm/linstor_un rm -rf /tmp/addon-linstor_un-master</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุญุชุงุฌ ุงูุขู ุฅูู ุฅุถุงูุชู ุฅูู ุชููุฆุฉ OpenNebula ุ ูุฐูู ูููู ุจุชูููุฐ ุงูุฎุทูุงุช ุงูุจุณูุทุฉ ุงูููุถุญุฉ <strong><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ููุง</a></strong> . </p><br><p style=";text-align:right;direction:rtl">  ุซู ุฃุนุฏ ุชุดุบูู OpenNebula: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">systemctl restart opennebula</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุฃุถู ูุธุงููุง ููุฑุงูุฒ ุงูุจูุงูุงุช: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cat &gt; system-ds.conf &lt;&lt;EOT NAME=<span class="hljs-string"><span class="hljs-string">"linstor-system"</span></span> TYPE=<span class="hljs-string"><span class="hljs-string">"SYSTEM_DS"</span></span> STORAGE_POOL=<span class="hljs-string"><span class="hljs-string">"data"</span></span> AUTO_PLACE=<span class="hljs-string"><span class="hljs-string">"2"</span></span> CLONE_MODE=<span class="hljs-string"><span class="hljs-string">"snapshot"</span></span> CHECKPOINT_AUTO_PLACE=<span class="hljs-string"><span class="hljs-string">"1"</span></span> BRIDGE_LIST=<span class="hljs-string"><span class="hljs-string">"node1 node2 node3"</span></span> TM_MAD=<span class="hljs-string"><span class="hljs-string">"linstor_un"</span></span> EOT onedatastore create system-ds.conf</code> </pre> <br><p style=";text-align:right;direction:rtl">  ูุชุฎุฒูู ุงูุตูุฑ: </p><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cat &gt; images-ds.conf &lt;&lt;EOT NAME=<span class="hljs-string"><span class="hljs-string">"linstor-images"</span></span> TYPE=<span class="hljs-string"><span class="hljs-string">"IMAGE_DS"</span></span> STORAGE_POOL=<span class="hljs-string"><span class="hljs-string">"data"</span></span> AUTO_PLACE=<span class="hljs-string"><span class="hljs-string">"2"</span></span> BRIDGE_LIST=<span class="hljs-string"><span class="hljs-string">"node1 node2 node3"</span></span> DISK_TYPE=<span class="hljs-string"><span class="hljs-string">"BLOCK"</span></span> DS_MAD=<span class="hljs-string"><span class="hljs-string">"linstor_un"</span></span> TM_MAD=<span class="hljs-string"><span class="hljs-string">"linstor_un"</span></span> EOT onedatastore create images-ds.conf</code> </pre> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชุนุฑุถ ุงููุนููุฉ <code>AUTO_PLACE</code> ุนุฏุฏ ุงููุณุฎ ุงููุชูุงุซูุฉ ููุจูุงูุงุช ุงูุชู ุณูุชู ุฅูุดุงุคูุง ููู ุตูุฑุฉ ุฌุฏูุฏุฉ ูู OpenNebula. </li><li style=";text-align:right;direction:rtl">  ุชุดูุฑ ุงููุนููุฉ <code>CLONE_MODE</code> ุฅูู ููููุฉ ุงุณุชูุณุงุฎ ุงูุตูุฑ ุนูุฏ ุฅูุดุงุก ุฃุฌูุฒุฉ ุงูุชุฑุงุถูุฉ ุฌุฏูุฏุฉ ุ <code>snapshot</code> - ุณุชููู ุจุฅูุดุงุก ููุทุฉ ููุตูุฑุฉ ููุดุฑ ุฌูุงุฒ ุงูุชุฑุงุถู ูู ููุทุฉ ุ <code>copy</code> - ุณุชููู ุจุนูู ูุณุฎุฉ ูุงููุฉ ูู ุงูุตูุฑุฉ ููู ุฌูุงุฒ ุธุงูุฑู. </li><li style=";text-align:right;direction:rtl">  ููุตู <code>BRIDGE_LIST</code> ุจุชุญุฏูุฏ ุฌููุน ุงูุนูุฏ ุงูุชู ุณูุชู ุงุณุชุฎุฏุงููุง ูุชูููุฐ ุนูููุงุช ุงุณุชูุณุงุฎ ุงูุตูุฑ. </li></ul><br><p style=";text-align:right;direction:rtl">  ูุชู ุชูุฏูู ูุงุฆูุฉ ูุงููุฉ ุจุงููุนููุงุช ุงููุฏุนููุฉ ูู ูุดุฑูุน <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">README</a> . </p><br><p style=";text-align:right;direction:rtl">  ุงูุชูู ูุฐุง ุงูุฅุนุฏุงุฏ ุ ุงูุขู ููููู ุชูุฒูู ุจุนุถ ุงูุฃุฌูุฒุฉ ูู <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">OpenNebula Marketplace</a> ุงูุฑุณูู ูุฅูุดุงุก ุฃุฌูุฒุฉ ุงูุชุฑุงุถูุฉ ููู. </p><br><p style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุฑุงุจุท ูููุดุฑูุน</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar451186/">https://habr.com/ru/post/ar451186/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar451176/index.html">ุฃุฎุจุงุฑ ูู ุฎุฑูุทุฉ ุงูุดุงุฑุน ุงูููุชูุญ ุฑูู 458 (04/23/2019 - 04/09/2019)</a></li>
<li><a href="../ar451178/index.html">ุทุงูู ุงูุชููู ูุจูุท ุงููุธูุฉ ูุจูุท ุงุฎุชุจุงุฑ</a></li>
<li><a href="../ar451180/index.html">PCB ูุญู ูุญู ุงุซููู ูู ุงููุญุฑูุงุช ุงูุฎุทูุฉ</a></li>
<li><a href="../ar451182/index.html">ููู ุฃุตุจุญุช ุฃุญุฌุงู ุงููุตูููุงุช C ุฌุฒุกูุง ูู ุงููุงุฌูุฉ ุงูุซูุงุฆูุฉ ููููุชุจุฉ</a></li>
<li><a href="../ar451184/index.html">ูุดุฑูุน Blue Origin Blue Moon: ุฃูุงุณ ุนูู ุงูููุฑ ุจุญููู ุนุงู 2024</a></li>
<li><a href="../ar451188/index.html">ุณุจูุฑุจูู ุฃู ููุงู ูุงูุนูุฏุฉ</a></li>
<li><a href="../ar451196/index.html">ูุตู ูููุงุช ุชุนุฑูู ุงูุนููุงุก ูุงููุณุชูููู</a></li>
<li><a href="../ar451198/index.html">ุฏูุฑ ุงููุงูุน ุงููุนุฒุฒ ูุงููุงูุน ุงูุงูุชุฑุงุถู ูู ุงูุฏูุฑู ุงูุงููุฑูู ูููุญุชุฑููู</a></li>
<li><a href="../ar451200/index.html">ุงูุญุตูู ุนูู ุดูุงุฏุงุช ุทุจูุฉ ุงูููุงุจุณ ุงูุขููุฉ ุชููุงุฆููุง ูู ุฎูุงู Let's Encrypt ุจุงุณุชุฎุฏุงู ุชุญุฏู DNS-01 ู AWS</a></li>
<li><a href="../ar451204/index.html">ุงููุญุฑุฑูู ุงููุต ุงูุญุฑ ููุชุนุงูู</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>