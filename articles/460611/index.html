<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üõåüèº ‚òùüèæ üë®üèæ‚Äçüíª Conmutaci√≥n por error: el perfeccionismo nos arruina y ... la pereza ‚úãüèø ‚ò£Ô∏è üë©‚Äçüë©‚Äçüëß‚Äçüëß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="En el verano, tanto la actividad de compra como la intensidad de los cambios en la infraestructura de los proyectos web disminuyen tradicionalmente, n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Conmutaci√≥n por error: el perfeccionismo nos arruina y ... la pereza</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/itsumma/blog/460611/"> <i>En el verano, tanto la actividad de compra como la intensidad de los cambios en la infraestructura de los proyectos web disminuyen tradicionalmente, nos dice el Capit√°n Evidence.</i>  <i>Solo porque incluso la gente de TI se va de vacaciones.</i>  <i>Y CTO tambi√©n.</i>  <i>Es mucho m√°s dif√≠cil para aquellos que permanecen en el puesto, pero no se trata de eso ahora: tal vez es por eso que el verano es el mejor momento para apresurar el esquema de reserva existente y hacer un plan para su mejora.</i>  <i>Y en esto se beneficiar√° de la experiencia de Yegor Andreev de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">AdminDivision</a> , de la que habl√≥ en la conferencia del <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">d√≠a de actividad</a> .</i> <br><br>  Durante la construcci√≥n de sitios de reserva, durante la reserva hay varias trampas en las que puede caer.  Y caer en ellos es absolutamente imposible.  Y arruin√°ndonos en todo esto, as√≠ como en muchas otras cosas, perfeccionismo y ... pereza.  Estamos tratando de hacer todo, todo, todo es perfecto, ¬°pero no tienes que hacerlo a la perfecci√≥n!  Solo es necesario hacer ciertas cosas, pero hacerlas correctamente, llevarlas hasta el final, para que funcionen normalmente. <br><br>  La conmutaci√≥n por error no es una especie de cosa divertida "divertida de tener";  es algo que deber√≠a hacer exactamente una cosa: reducir el tiempo de inactividad para que el servicio, la empresa, pierda menos dinero.  Y en todos los m√©todos de reserva, sugiero pensar en el siguiente contexto: ¬ød√≥nde est√° el dinero? <br><br><img src="https://habrastorage.org/webt/jz/ia/-7/jzia-79mf2emmdcqetbiatuuqfo.jpeg"><br><a name="habracut"></a><br>  <b>La primera trampa</b> : cuando construimos grandes sistemas confiables y hacemos copias de seguridad, reducimos la cantidad de accidentes.  Esta es una falacia terrible.  Cuando hacemos copias de seguridad, lo m√°s probable es que aumentemos la cantidad de accidentes.  Y si hacemos todo bien, juntos reduciremos el tiempo de inactividad.  Habr√° m√°s accidentes, pero ocurrir√°n a un costo menor.  Despu√©s de todo, ¬øqu√© es la redundancia?  Es una complicaci√≥n del sistema.  Cualquier complicaci√≥n es mala: obtenemos m√°s engranajes, m√°s engranajes, en una palabra, m√°s elementos y, por lo tanto, una mayor probabilidad de aver√≠a.  Y realmente se rompen.  Y se romper√°n m√°s a menudo.  Un ejemplo simple: digamos que tenemos un sitio web con PHP, MySQL.  Y necesita urgentemente ser reservado. <br><br>  Shtosh (c) Tomamos el segundo sitio, construimos un sistema id√©ntico ... La complejidad se vuelve el doble: tenemos dos entidades.  Y tambi√©n desarrollamos cierta l√≥gica de transferencia de datos de una plataforma a otra desde arriba, es decir, replicaci√≥n de datos, copia de estad√≠sticas, etc.  Por lo tanto, la l√≥gica de la replicaci√≥n suele ser muy compleja y, por lo tanto, la complejidad total del sistema puede no ser 2, sino 3, 5, 10 veces m√°s. <br><br>  <b>La segunda trampa</b> : cuando construimos sistemas complejos verdaderamente grandes, fantaseamos con lo que queremos obtener al final.  Voila: queremos obtener un sistema s√∫per confiable que funcione sin ning√∫n tiempo de inactividad, cambie en medio segundo (o mejor en general al instante) y comience a convertir los sue√±os en realidad.  Pero tambi√©n hay un matiz: cuanto m√°s corto es el tiempo de conmutaci√≥n deseado, m√°s compleja resulta la l√≥gica del sistema.  Cuanto m√°s dif√≠cil sea hacer esta l√≥gica, m√°s a menudo el sistema se romper√°.  Y puede entrar en una situaci√≥n muy desagradable: estamos haciendo todo lo posible para reducir el tiempo de inactividad, pero de hecho complicamos las cosas, y cuando algo sale mal, el tiempo de inactividad ser√° m√°s largo.  Aqu√≠ a menudo te encuentras pensando: aqu√≠ ... ser√≠a mejor si no hubieran sido reservados.  Ser√≠a mejor si funcionara solo con un tiempo de inactividad comprensible. <br><br>  ¬øC√≥mo lidiar con esto?  Debemos dejar de mentirnos a nosotros mismos, dejar de halagarnos de que vamos a construir una nave espacial aqu√≠, pero para comprender adecuadamente cu√°nto puede tumbarse el proyecto.  Y para este tiempo m√°ximo, elegiremos con qu√© m√©todos, de hecho, aumentaremos la confiabilidad de nuestro sistema. <br><br><img src="https://habrastorage.org/webt/iv/s3/fl/ivs3flng1tmpqnfqym23_-dhjms.jpeg"><br><br>  Es hora de "historias de w" ... de la vida, por supuesto. <br><br><h4>  Ejemplo n√∫mero uno </h4><br>  Imagine la tarjeta del sitio de la planta de laminaci√≥n de tuber√≠as No. 1 de la ciudad N. Est√° escrita con letras grandes: PLANTA DE TUBER√çAS No. 1.  Un poco m√°s abajo - el eslogan: "Nuestras tuber√≠as son las tuber√≠as m√°s redondas en N".  Y debajo del n√∫mero de tel√©fono del CEO y su nombre.  Entendemos que debe reservar, ¬°esto es algo muy importante!  Comenzamos a entender en qu√© consiste.  Html-statics, es decir, un par de im√°genes en las que el general, de hecho, en la mesa en el ba√±o con su compa√±ero est√° discutiendo el pr√≥ximo trato.  Comenzamos a pensar en el tiempo de inactividad.  Me viene a la mente: debes permanecer acostado all√≠ durante cinco minutos, no m√°s.  Y luego la pregunta es: ¬øcu√°ntas ventas de este sitio fueron en general?  Cuanto cuanto  ¬øQu√© significa cero?  Y eso significa: porque el general hizo las cuatro transacciones durante el a√±o pasado en la misma mesa, con las mismas personas con las que van a la casa de ba√±os a sentarse a la mesa.  Y entendemos que incluso si el sitio permanece inactivo por un d√≠a, no habr√° nada terrible. <br><br>  Seg√∫n la introducci√≥n, hay un d√≠a para plantear esta historia.  Comenzamos a pensar en el esquema de respaldo.  Y seleccionamos el esquema de copia de seguridad m√°s ideal para este ejemplo: no utilizamos redundancia.  Todo esto se eleva por cualquier administrador durante media hora con pausas de humo.  Poner un servidor web, poner archivos es todo.  Funcionar√°  No tiene que seguir nada, no necesita prestar especial atenci√≥n a nada.  Es decir, la conclusi√≥n del ejemplo n√∫mero uno es bastante obvia: los servicios que no necesita reservar no son necesarios. <br><br><img src="https://habrastorage.org/webt/em/ho/dj/emhodjmsvznkfjdzlc2chs4goow.jpeg"><br><br><h4>  Ejemplo n√∫mero dos </h4><br>  Blog de la empresa: hay personas especialmente capacitadas que escriben noticias all√≠, por lo que participamos en tal o cual exposici√≥n, pero aqu√≠ lanzamos otro producto nuevo y as√≠ sucesivamente.  Digamos que esto es PHP est√°ndar con WordPress, una peque√±a base de datos y un poco de est√°tica.  Por supuesto, me viene a la mente otra vez que nunca debes mentir: "¬°no m√°s de cinco minutos!", Eso es todo.  Pero pensemos m√°s.  ¬øQu√© est√° haciendo este blog?  Vienen all√≠ desde Yandex, desde Google en algunas solicitudes, en productos org√°nicos.  Wow  ¬øY las ventas est√°n de alguna manera relacionadas con √©l?  Insight: en realidad no.  El tr√°fico publicitario va al sitio principal, que est√° en otra m√°quina.  Comenzamos a pensar en el esquema de reserva de folletos.  En el buen sentido, debe levantarse en un par de horas, y ser√≠a bueno prepararse para esto.  Ser√≠a razonable llevar una m√°quina a otro centro de datos, dirigir el entorno hacia ella, es decir, un servidor web, PHP, WordPress, MySQL, y dejarla acostada.  En el momento en que entendemos que todo est√° roto, hay que hacer dos cosas: rodar el volcado de mysql a 50 metros, volar√° all√≠ en un minuto y rodar√° algunas im√°genes de la copia de seguridad all√≠.  Esto tampoco es una buena noticia.  Por lo tanto, en media hora todo esto se levanta.  No hay repeticiones, o Dios me perdone, la conmutaci√≥n por error autom√°tica.  Conclusi√≥n: lo que podemos implementar r√°pidamente de la copia de seguridad no es necesario reservar. <br><br><img src="https://habrastorage.org/webt/hd/h-/s6/hdh-s6csoog6vc1peorwrxkwaw0.jpeg"><br><br><h4>  Ejemplo n√∫mero tres, m√°s complicado. </h4><br>  Tienda en linea.  PhP con coraz√≥n abierto est√° un poco archivado, mysql con una base s√≥lida.  Bastante est√°tica (despu√©s de todo, la tienda en l√≠nea tiene hermosas im√°genes en HD y todo ese jazz), Redis para la sesi√≥n y Elasticsearch para la b√∫squeda.  Comenzamos a pensar en el tiempo de inactividad.  Y aqu√≠, por supuesto, es obvio que una tienda en l√≠nea no puede revolcarse el d√≠a sin dolor.  Despu√©s de todo, cuanto m√°s tiempo mienta, m√°s dinero perderemos.  Vale la pena acelerar.  Cuanto?  Creo que si nos acostamos durante una hora, nadie se volver√° loco.  S√≠, perderemos algo, pero si empezamos a hacer celo, solo empeorar√°.  Determinamos el tiempo de inactividad permitido por hora. <br><br>  ¬øC√≥mo se puede reservar todo esto?  En cualquier caso, se necesita un autom√≥vil: una hora de tiempo es bastante.  Mysql: replicaci√≥n, la replicaci√≥n en vivo ya es necesaria aqu√≠, porque en una hora 100 GB en un volcado, lo m√°s probable es que no se vierta.  Est√°tica, im√°genes: nuevamente, en una hora, 500 GB pueden no tener tiempo para fusionarse.  Por lo tanto, es mejor copiar im√°genes de inmediato.  Redis: m√°s interesante aqu√≠.  Las sesiones son en Redis, simplemente no podemos tomarlo y enterrarlo.  Porque no ser√° muy bueno: se cerrar√° la sesi√≥n de todos los usuarios, se vaciar√°n las cestas, etc.  Las personas se ver√°n obligadas a volver a ingresar su nombre de usuario y contrase√±a, y muchas personas pueden separarse y no completar la compra.  Nuevamente, la conversi√≥n caer√°.  Por otro lado, Redis es directamente uno a uno relevante, con los √∫ltimos usuarios registrados, probablemente, tampoco es necesario.  Y un buen compromiso es tomar Redis y restaurarlo desde la copia de seguridad ayer, o, si lo hace cada hora, hace una hora.  El beneficio de restaurarlo desde la copia de seguridad es copiar un archivo.  Y la historia m√°s interesante es Elasticsearch.  ¬øQui√©n ha planteado la replicaci√≥n MySQL?  ¬øQui√©n ha planteado la replicaci√≥n Elasticsearch?  ¬øY con qui√©n trabajaba normalmente despu√©s?  Qu√© estoy haciendo: vemos una cierta entidad en nuestro sistema.  Parece ser √∫til, pero es complicado. <br>  Complejo en el sentido de que nuestros compa√±eros ingenieros no tienen experiencia trabajando con √©l.  O hay una experiencia negativa.  O entendemos que hasta ahora esta es una tecnolog√≠a bastante nueva con matices o humedad.  Creemos ... Maldici√≥n, el el√°stico tambi√©n es saludable, tambi√©n lleva mucho tiempo restaurarlo desde la copia de seguridad, ¬øqu√© debo hacer?  Entendemos que el el√°stico en nuestro caso se utiliza para la b√∫squeda.  ¬øY c√≥mo se vende nuestra tienda en l√≠nea?  Vamos a los vendedores, preguntamos, ¬øde d√≥nde viene la gente?  Responden: "El 90% del mercado Yandex viene directamente a la tarjeta del producto".  Y ya sea comprar o no.  Por lo tanto, el 10% de los usuarios necesitan una b√∫squeda.  Y para mantener una r√©plica el√°stica, especialmente entre diferentes centros de datos en diferentes zonas, realmente hay muchos matices.  ¬øCu√°l es la salida?  Tomamos el√°stico en un sitio reservado y no hacemos nada con √©l.  Si el caso se prolonga, alg√∫n d√≠a probablemente lo plantearemos, pero esto no es seguro.  En realidad, la conclusi√≥n m√°s o menos es la misma: nuevamente, no reservamos servicios que no afecten el dinero.  Para mantener el circuito m√°s simple. <br><br><img src="https://habrastorage.org/webt/xo/eu/z8/xoeuz8bhw_hpg4lwinkn1zjorhy.jpeg"><br><br><h4>  Ejemplo n√∫mero cuatro, a√∫n m√°s dif√≠cil </h4><br>  Integrador: vender flores, llamar a un taxi, vender productos, en general, cualquier cosa.  Una cosa seria que funciona 24/7 para una gran cantidad de usuarios.  Con una pila interesante completa, donde hay bases interesantes, soluciones, una gran carga, y lo m√°s importante, le duele mentir m√°s de 5 minutos.  No solo y no tanto porque la gente no comprar√°, sino porque la gente ver√° que esto no est√° funcionando, se enojar√°n y es posible que no vuelvan por segunda vez. <br><br>  Esta bien  Cinco minutos  ¬øQu√© haremos con esto?  En este caso, estamos en una forma adulta, con todo el dinero estamos construyendo un sitio de respaldo real, con replicaci√≥n de todo y de todo, y tal vez incluso automaticemos el cambio m√°ximo a este sitio.  Y adem√°s de esto, uno no debe olvidar hacer una cosa importante: de hecho, escriba el horario de cambio.  Las regulaciones, incluso si tiene todo automatizado, pueden ser muy simples.  De la serie "ejecutar tal y tal secuencia de comandos ansible", "haga clic en tal o cual amanece en la ruta 53" y as√≠ sucesivamente, pero esta deber√≠a ser una lista exacta de acciones. <br><br>  Y todo parece estar claro.  Cambiar la replicaci√≥n es una tarea trivial, o se cambiar√° a s√≠ mismo.  Reescribe un nombre de dominio en dns, de la misma serie.  El problema es que cuando un proyecto similar se bloquea, comienza el p√°nico e incluso los administradores barbudos m√°s poderosos pueden ser propensos a ello.  Sin una instrucci√≥n clara "abra una terminal, vaya aqu√≠, la direcci√≥n en nuestro servidor sigue siendo as√≠", el plazo de 5 minutos asignado para la reanimaci√≥n es dif√≠cil de mantener.  Bueno, adem√°s, cuando usamos estas regulaciones, es f√°cil corregir algunos cambios en la infraestructura, por ejemplo, y cambiar las regulaciones en consecuencia. <br>  Bueno, si el sistema de respaldo es muy complejo y en alg√∫n momento cometimos un error, entonces tambi√©n podemos poner nuestro sitio de reserva y, adem√°s, convertir los datos en una calabaza en ambos sitios, ser√° realmente triste. <br><br><img src="https://habrastorage.org/webt/xa/3t/zr/xa3tzr7mykypd7fsmkvtyumf1o4.jpeg"><br><br><h4>  Ejemplo n√∫mero cinco, hardcore completo </h4><br>  Un servicio internacional con cientos de millones de usuarios en todo el mundo.  Todas las zonas horarias, que solo existen, de alta carga a la velocidad m√°xima, no debe mentir en absoluto.  Un minuto, y ser√° triste.  Que hacer  Reserva, de nuevo, en su totalidad.  Hicieron todo lo que se mencion√≥ en el ejemplo anterior, y un poco m√°s.  Un mundo ideal y nuestra infraestructura: es, seg√∫n todos los conceptos de IaaC devopa.  Es decir, todo en general en git, y solo haga clic en el bot√≥n. <br><br>  Lo que falta  Una son las ense√±anzas.  No puedes prescindir de ellos.  Parece que todo es perfecto con nosotros, todo est√° bajo control en general.  Presionamos el bot√≥n, todo sucede.  Incluso si esto es as√≠, y entendemos que esto no sucede, nuestro sistema interact√∫a con otros sistemas.  Por ejemplo, estos son dns de la ruta 53, almacenamiento s3, integraci√≥n con alguna api.  No podremos prever todo en este experimento especulativo.  Y hasta que realmente hagamos el cambio, no sabremos si funcionar√° o no. <br><br><img src="https://habrastorage.org/webt/6q/v-/jk/6qv-jkxmxhmvzrwuocwtx6gfhu8.jpeg"><br><br>  Eso es probablemente todo.  No seas perezoso y no te excedas.  ¬°Y que el tiempo de actividad est√© contigo! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/460611/">https://habr.com/ru/post/460611/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../460597/index.html">C√≥mo diagnosticar problemas de integraci√≥n de SDK. La experiencia del equipo de desarrollo de Yandex Mobile Ads SDK</a></li>
<li><a href="../460599/index.html">Noticias del mundo de OpenStreetMap No. 468 (07/02/2019 - 08/07/2019)</a></li>
<li><a href="../460603/index.html">V2G. Los autos el√©ctricos ayudar√°n a equilibrar la producci√≥n y el consumo de electricidad.</a></li>
<li><a href="../460605/index.html">Estudio fotogr√°fico autom√°tico, parte 1</a></li>
<li><a href="../460607/index.html">Tienda de aplicaciones de seguridad ofensiva con herramientas de hackeo de Android</a></li>
<li><a href="../460615/index.html">A ra√≠z de Industrial Ninja: c√≥mo se pirate√≥ PLC en Positive Hack Days 9</a></li>
<li><a href="../460617/index.html">Toda la verdad sobre RTOS. Art√≠culo # 30. Inicializaci√≥n de Nucleus SE y procedimientos de inicio</a></li>
<li><a href="../460621/index.html">Tic Tac Toe Parte 4: Interactuar con el backend de Flask usando HTTP</a></li>
<li><a href="../460623/index.html">Sobre la tortura de Julian Assange</a></li>
<li><a href="../460625/index.html">Como no ocup√© el primer lugar en la competencia para desarrolladores de JavaScript de Telegram</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>