<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üïö üë©üèª‚Äçüç≥ üñïüèæ Detalhes do GraphQL: O que, como e por que ü•´ üë©üèª‚Äçü§ù‚Äçüë®üèø üôáüèø</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Agora, o GraphQL √©, sem exagero, o √∫ltimo pio do modo de TI. E se voc√™ ainda n√£o sabe que tipo de tecnologia √©, como us√°-la e por que pode ser √∫til pa...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Detalhes do GraphQL: O que, como e por que</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ruvds/blog/445268/">  Agora, o GraphQL √©, sem exagero, o √∫ltimo pio do modo de TI.  E se voc√™ ainda n√£o sabe que tipo de tecnologia √©, como us√°-la e por que pode ser √∫til para voc√™, o artigo que estamos publicando hoje foi escrito para voc√™.  Aqui, abordaremos os conceitos b√°sicos do GraphQL usando um exemplo de implementa√ß√£o de esquema de dados para a API de uma empresa de pipoca.  Em particular, vamos falar sobre tipos de dados, consultas e muta√ß√µes. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/c7/oq/a1/c7oqa1w2b00akzatd2womwb_daw.png"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">O que √© o GraphQL?</font> </h2><br>  GraphQL √© uma linguagem de consulta usada por aplicativos clientes para trabalhar com dados.  O GraphQL est√° associado a um conceito como "esquema" - √© isso que permite organizar a cria√ß√£o, leitura, atualiza√ß√£o e exclus√£o de dados em sua aplica√ß√£o (ou seja, temos quatro fun√ß√µes b√°sicas usadas ao trabalhar com data warehouses, que geralmente s√£o chamadas pelo acr√¥nimo CRUD - criar, ler, atualizar, excluir). <br><br>  Foi dito acima que o GraphQL √© usado para trabalhar com dados em "sua aplica√ß√£o" e n√£o "em seu banco de dados".  O fato √© que o GraphQL √© um sistema independente das fontes de dados, ou seja, n√£o importa onde est√° organizado para organizar seu trabalho. <br><br>  Se voc√™ procurar, sem saber nada sobre o GraphQL, o nome dessa tecnologia, pode parecer que estamos diante de algo muito complicado e confuso.  O nome da tecnologia tem a palavra "Gr√°fico".  Isso significa que, para domin√°-lo, voc√™ precisa aprender a trabalhar com bancos de dados de gr√°ficos?  E o fato de o nome conter "QL" (que pode significar "linguagem de consulta", ou seja, "linguagem de consulta"), significa que aqueles que desejam usar o GraphQL ter√£o que aprender uma linguagem de programa√ß√£o completamente nova? <br><br>  Esses medos n√£o s√£o inteiramente justificados.  Para tranquiliz√°-lo - esta √© a verdade cruel sobre essa tecnologia: s√£o apenas solicita√ß√µes <code>GET</code> ou <code>POST</code> embelezadas.  Embora o GraphQL, em geral, introduz alguns novos conceitos relacionados √† organiza√ß√£o e intera√ß√£o de dados, os mecanismos internos dessa tecnologia se baseiam nas boas e antigas solicita√ß√µes HTTP. <br><br><h2>  <font color="#3AC1EF">Repensando a tecnologia REST</font> </h2><br>  A flexibilidade √© o que diferencia a tecnologia GraphQL da conhecida tecnologia REST.  Ao usar o REST, se tudo for feito corretamente, os terminais geralmente s√£o criados levando em considera√ß√£o as caracter√≠sticas de um determinado tipo de dado de aplicativo ou recurso. <br><br>  Por exemplo, ao executar uma solicita√ß√£o <code>GET</code> para o terminal <code>/api/v1/flavors</code> espera-se que ele envie uma resposta parecida com esta: <br><br><pre> <code class="plaintext hljs">[ {  "id": 1,   "name": "The Lazy Person's Movie Theater",   "description": "That elusive flavor that you begrudgingly carted yourself to the theater for, now in the comfort of your own home, you slob!" }, {   "id": 2,   "name": "What's Wrong With You Caramel",   "description": "You're a crazy person that likes sweet popcorn. Congratulations." }, {   "id": 3,   "name": "Gnarly Chili Lime",   "description": "The kind of popcorn you make when you need a good smack in the face."} ]</code> </pre> <br>  N√£o h√° nada de catastroficamente errado com essa resposta, mas vamos pensar na interface do usu√°rio, ou melhor, em como pretendemos consumir esses dados. <br><br>  Se quisermos exibir uma lista simples na interface que contenha apenas os nomes dos tipos dispon√≠veis de pipoca (e nada mais), essa lista poder√° se parecer com a mostrada abaixo. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a89/0fd/c56/a890fdc56389815233584327e76011c1.png"></div><br>  <i><font color="#999999">Lista de tipos de pipoca</font></i> <br><br>  Pode-se ver que aqui estamos em uma situa√ß√£o dif√≠cil.  Podemos decidir n√£o usar o campo de <code>description</code> , mas vamos nos sentar e fingir que n√£o enviamos esse campo para o cliente?  O que mais podemos fazer?  E quando, depois de alguns meses, eles nos perguntarem por que o aplicativo √© t√£o lento para os usu√°rios, basta deixar o cara e n√£o encontrar mais a ger√™ncia da empresa para a qual fizemos esse aplicativo. <br><br>  De fato, o fato de o servidor enviar dados desnecess√°rios em resposta a uma solicita√ß√£o do cliente n√£o √© totalmente nossa culpa.  O REST √© um mecanismo de aquisi√ß√£o de dados que pode ser comparado a um restaurante no qual o gar√ßom pergunta ao visitante: ‚ÄúO que voc√™ quer?‚Äù. E, n√£o prestando aten√ß√£o especial a seus desejos, ele diz: ‚ÄúTrarei o que temos‚Äù . <br><br>  Se deixarmos de lado as piadas, em aplica√ß√µes reais isso pode levar a situa√ß√µes problem√°ticas.  Por exemplo, podemos exibir v√°rias informa√ß√µes adicionais sobre cada tipo de pipoca, como informa√ß√µes de pre√ßo, informa√ß√µes sobre o fabricante ou informa√ß√µes nutricionais (‚ÄúVegan Popcorn!‚Äù).  Ao mesmo tempo, pontos de extremidade REST inflex√≠veis dificultam a obten√ß√£o de dados espec√≠ficos sobre tipos espec√≠ficos de pipoca, o que leva a uma carga excessivamente alta nos sistemas e ao fato de que as solu√ß√µes resultantes est√£o longe daquelas pelas quais os desenvolvedores podem se orgulhar. <br><br><h2>  <font color="#3AC1EF">Como a tecnologia GraphQL melhora para que a tecnologia REST foi usada</font> </h2><br>  Uma an√°lise superficial da situa√ß√£o descrita acima pode parecer que somos apenas um problema menor.  "O que h√° de errado em enviar dados desnecess√°rios ao cliente?"  Para entender at√© que ponto ‚Äúdados desnecess√°rios‚Äù podem ser um grande problema, lembre-se de que o GraphQL foi desenvolvido pelo Facebook.  Essa empresa precisa atender a milh√µes de solicita√ß√µes por segundo. <br><br>  O que isso significa?  E o fato de que, com esses volumes, tudo √© importante. <br><br>  O GraphQL, se continuarmos a analogia com um restaurante, em vez de "carregar" para o visitante "o que √©", traz exatamente o que o visitante pede. <br><br>  Podemos obter uma resposta do GraphQL que se concentra no contexto em que os dados s√£o usados.  Nesse caso, n√£o precisamos adicionar pontos de acesso "√∫nicos" ao sistema, executar muitas solicita√ß√µes ou escrever estruturas condicionais de v√°rios andares. <br><br><h2>  <font color="#3AC1EF">Como o GraphQL funciona?</font> </h2><br>  Como j√° dissemos, o GraphQL conta com solicita√ß√µes simples de <code>GET</code> ou <code>POST</code> para transmitir dados ao cliente e receb√™-los.  Se considerarmos essa id√©ia em mais detalhes, verifica-se que existem dois tipos de consultas no GraphQL.  O primeiro tipo inclui solicita√ß√µes de leitura de dados, que na terminologia do GraphQL s√£o chamadas simplesmente de consultas e se referem √† letra R (leitura, leitura) da sigla CRUD.  As consultas do segundo tipo s√£o solicita√ß√µes de modifica√ß√£o de dados, chamadas muta√ß√µes no GraphQL.  Eles se relacionam com as caixas de eixo C, U e D da sigla CRUD, ou seja, elas s√£o usadas para criar, criar, atualizar e excluir registros. <br><br>  Todos esses pedidos e muta√ß√µes s√£o enviados para o URL do servidor GraphQL, que, por exemplo, pode parecer <code>https://myapp.com/graphql</code> , na forma de pedidos <code>GET</code> ou <code>POST</code> .  Falaremos mais sobre isso abaixo. <br><br><h2>  <font color="#3AC1EF">Consultas GraphQL</font> </h2><br>  As consultas do GraphQL s√£o entidades que representam uma solicita√ß√£o ao servidor para receber determinados dados.  Por exemplo, temos uma certa interface de usu√°rio que queremos preencher com dados.  Para esses dados, recorremos ao servidor, executando a solicita√ß√£o.  Ao usar APIs REST tradicionais, nossa solicita√ß√£o assume a forma de uma solicita√ß√£o GET.  Ao trabalhar com o GraphQL, uma nova sintaxe de consulta √© usada: <br><br><pre> <code class="plaintext hljs">{ flavors {   name } }</code> </pre> <br>  Isso √© JSON?  Ou um objeto JavaScript?  Nem um nem o outro.  Como j√° dissemos, em nome da tecnologia GraphQL, as duas √∫ltimas letras, QL, significam "linguagem de consulta", ou seja, a linguagem de consulta.  Este √©, literalmente, um novo idioma para escrever solicita√ß√µes de dados.  Tudo isso soa como uma descri√ß√£o de algo bastante complicado, mas na verdade n√£o h√° nada complicado aqui.  Vamos analisar a consulta acima: <br><br><pre> <code class="plaintext hljs">{ //    ,   . }</code> </pre> <br>  Todas as solicita√ß√µes come√ßam com uma "solicita√ß√£o raiz" e o que voc√™ precisa obter durante a execu√ß√£o da solicita√ß√£o √© chamado de campo.  Para evitar confus√£o, √© melhor chamar essas entidades de "campos de consulta no esquema".  Se esse nome lhe parecer incompreens√≠vel - espere um pouco - abaixo, falaremos mais sobre o esquema.  Aqui, na consulta raiz, solicitamos o campo <code>flavors</code> . <br><br><pre> <code class="plaintext hljs">{ flavors {   //  ,        flavor. } }</code> </pre> <br>  Ao solicitar um determinado campo, tamb√©m devemos indicar os campos aninhados que precisam ser recebidos para cada objeto que vem em resposta √† solicita√ß√£o (mesmo que se espere que apenas um objeto venha em resposta √† solicita√ß√£o). <br><br><pre> <code class="plaintext hljs">{ flavors {   name } }</code> </pre> <br>  Qual ser√° o resultado?  Depois de enviarmos essa solicita√ß√£o ao servidor GraphQL, obteremos uma resposta organizada e bem-formada, como a seguir: <br><br><pre> <code class="plaintext hljs">{ "data": {   "flavors": [     { "name": "The Lazy Person's Movie Theater" },     { "name": "What's Wrong With You Caramel" },     { "name": "Gnarly Chili Lime" }   ] } }</code> </pre> <br>  Observe que n√£o h√° nada sup√©rfluo.  Para esclarecer, aqui est√° outra solicita√ß√£o que √© executada para obter dados em outra p√°gina do aplicativo: <br><br><pre> <code class="plaintext hljs">{ flavors {   id   name   description } }</code> </pre> <br>  Em resposta a esta solicita√ß√£o, obtemos o seguinte: <br><br><pre> <code class="plaintext hljs">{ "data": {   "flavors": [     { "id": 1, "name": "The Lazy Person's Movie Theater", description: "That elusive flavor that you begrudgingly carted yourself to the theater for, now in the comfort of your own home, you slob!" },     { "id": 2, "name": "What's Wrong With You Caramel", description: "You're a crazy person that likes sweet popcorn. Congratulations." },     { "id": 3, "name": "Gnarly Chili Lime", description: "A friend told me this would taste good. It didn't. It burned my kernels. I haven't had the heart to tell him." }   ] } }</code> </pre> <br>  Como voc√™ pode ver, o GraphQL √© uma tecnologia muito poderosa.  Voltamos para o mesmo terminal e as respostas para os pedidos correspondem exatamente ao que √© necess√°rio para preencher a p√°gina a partir da qual esses pedidos s√£o executados. <br><br>  Se precisarmos obter apenas um objeto de <code>flavor</code> , podemos tirar vantagem do fato de o GraphQL poder trabalhar com argumentos: <br><br><pre> <code class="plaintext hljs">{ flavors(id: "1") {   id   name   description } }</code> </pre> <br>  Aqui, definimos rigidamente o identificador espec√≠fico ( <code>id</code> ) do objeto no c√≥digo, as informa√ß√µes sobre as quais precisamos, mas, nesses casos, podemos usar identificadores din√¢micos: <br><br><pre> <code class="plaintext hljs">query getFlavor($id: ID) { flavors(id: $id) {   id   name   description } }</code> </pre> <br>  Aqui, na primeira linha, <code>getFlavor</code> um nome √† solicita√ß√£o (o nome √© escolhido arbitrariamente, <code>getFlavor</code> pode ser substitu√≠do por algo como <code>pizza</code> e a solicita√ß√£o permanecer√° operacional) e declaramos as vari√°veis ‚Äã‚Äãque a solicita√ß√£o espera.  Nesse caso, sup√µe-se que o identificador ( <code>id</code> ) do <code>ID</code> tipo escalar seja passado para a solicita√ß√£o (falaremos sobre os tipos abaixo). <br><br>  Independentemente de um <code>id</code> est√°tico ou din√¢mico <code>id</code> usado ao executar uma solicita√ß√£o, veja como ser√° a resposta a uma solicita√ß√£o semelhante: <br><br><pre> <code class="plaintext hljs">{ "data": {   "flavors": [     { "id": 1, "name": "The Lazy Person's Movie Theater", description: "That elusive flavor that you begrudgingly carted yourself to the theater for, now in the comfort of your own home, you slob!" }   ] } }</code> </pre> <br>  Como voc√™ pode ver, tudo √© organizado de maneira muito conveniente.  Voc√™ provavelmente est√° come√ßando a pensar em usar o GraphQL em seu pr√≥prio projeto.  E, embora o que j√° falamos pare√ßa maravilhoso, a beleza do GraphQL realmente se manifesta onde funciona com campos aninhados.  Suponha que em nosso esquema haja outro campo chamado <code>nutrition</code> que contenha informa√ß√µes sobre o valor nutricional de diferentes tipos de pipoca: <br><br><pre> <code class="plaintext hljs">{ flavors {   id   name   nutrition {     calories     fat     sodium   } } }</code> </pre> <br>  Pode parecer que em nosso data warehouse, cada objeto de <code>flavor</code> contenha um objeto de <code>nutrition</code> aninhado.  Mas isso n√£o √© inteiramente verdade.  Usando o GraphQL, voc√™ pode combinar chamadas para fontes de dados independentes, mas conectadas, em uma consulta, o que permite obter respostas que oferecem a conveni√™ncia de trabalhar com dados incorporados sem a necessidade de desnormalizar o banco de dados: <br><br><pre> <code class="plaintext hljs">{ "data": {   "flavors": [     {       "id": 1,       "name": "The Lazy Person's Movie Theater",       "nutrition": {         "calories": 500,         "fat": 12,         "sodium": 1000       }     },     ...   ] } }</code> </pre> <br>  Isso pode aumentar significativamente a produtividade do programador e a velocidade do sistema. <br><br>  At√© agora, falamos sobre pedidos de leitura.  E as solicita√ß√µes de atualiza√ß√£o de dados?  Us√°-los nos d√° a mesma conveni√™ncia? <br><br><h2>  <font color="#3AC1EF">Muta√ß√µes GraphQL</font> </h2><br>  Enquanto as consultas do GraphQL carregam dados, as muta√ß√µes s√£o respons√°veis ‚Äã‚Äãpor fazer altera√ß√µes nos dados.  Muta√ß√µes podem ser usadas na forma do mecanismo RPC (Remote Procedure Call) b√°sico para resolver v√°rias tarefas, como enviar dados do usu√°rio para uma API de terceiros. <br><br>  Ao descrever muta√ß√µes, √© usada uma sintaxe semelhante √† que usamos ao gerar consultas: <br><br><pre> <code class="plaintext hljs">mutation updateFlavor($id: ID!, $name: String, $description: String) { updateFlavor(id: $id, name: $name, description: $description) {   id   name   description } }</code> </pre> <br>  Aqui declaramos a muta√ß√£o <code>updateFlavor</code> , especificando algumas vari√°veis ‚Äã‚Äã- <code>id</code> , <code>name</code> e <code>description</code> .  Agindo de acordo com o mesmo esquema usado para descrever as consultas, "elaboramos" campos vari√°veis ‚Äã‚Äã(muta√ß√£o raiz) usando a palavra-chave <code>mutation</code> , seguida por um nome descrevendo a muta√ß√£o e um conjunto de vari√°veis ‚Äã‚Äãnecess√°rias para formar a solicita√ß√£o de altera√ß√£o de dados correspondente. <br><br>  Essas vari√°veis ‚Äã‚Äãincluem o que estamos tentando mudar ou que muta√ß√£o queremos causar.  Observe tamb√©m que ap√≥s a muta√ß√£o, podemos solicitar o retorno de alguns campos. <br><br>  Nesse caso, precisamos obter, ap√≥s alterar o registro, os campos <code>id</code> , <code>name</code> e <code>description</code> .  Isso pode ser √∫til ao desenvolver algo como interfaces otimistas, eliminando a necessidade de atender a uma solicita√ß√£o para receber dados alterados ap√≥s alter√°-los. <br><br><h2>  <font color="#3AC1EF">Projetando um esquema e conectando-o a um servidor GraphQL</font> </h2><br>  At√© agora, falamos sobre como o GraphQL funciona no cliente e como eles executam consultas.  Agora vamos falar sobre como responder a esses pedidos. <br><br><h3>  <font color="#3AC1EF">Servidor GraphQL</font> </h3><br>  Para executar uma consulta GraphQL, voc√™ precisa de um servidor GraphQL para o qual possa enviar essa consulta.  Um servidor GraphQL √© um servidor HTTP comum (se voc√™ escreve em JavaScript, pode ser um servidor criado usando Express ou Hapi), ao qual um diagrama GraphQL est√° anexado. <br><br><pre> <code class="plaintext hljs">import express from 'express' import graphqlHTTP from 'express-graphql' import schema from './schema' const app = express() app.use('/graphql', graphqlHTTP({ schema: schema, graphiql: true })) app.listen(4000)</code> </pre> <br>  Ao ‚Äúingressar‚Äù em um esquema, queremos dizer um mecanismo que transmite solicita√ß√µes recebidas do cliente pelo esquema e retorna respostas a ele.  √â como um filtro de ar atrav√©s do qual o ar entra na sala. <br><br>  O processo de "filtragem" est√° associado a solicita√ß√µes ou muta√ß√µes enviadas pelo cliente ao servidor.  As consultas e muta√ß√µes s√£o resolvidas usando fun√ß√µes relacionadas aos campos definidos na consulta raiz ou na muta√ß√£o raiz do esquema. <br><br>  A descri√ß√£o acima √© um exemplo de estrutura de servidor HTTP criada usando a biblioteca Express JavaScript.  Usando a fun√ß√£o <code>express-graphql</code> do Facebook, "anexamos" o esquema (presume-se que ele esteja descrito em um arquivo separado) e executamos o servidor na porta 4000. Ou seja, os clientes, falando sobre o uso local desse servidor, poder√£o enviar solicita√ß√µes via endere√ßo <code>http://localhost:4000/graphql</code> . <br><br><h3>  <font color="#3AC1EF">‚ñç Tipos e resolvedores de dados</font> </h3><br>  Para garantir a opera√ß√£o do servidor GraphQL, voc√™ precisa preparar o esquema e anex√°-lo a ele. <br><br>  Lembre-se de que falamos sobre declarar campos em uma consulta raiz ou em uma muta√ß√£o raiz acima. <br><br><pre> <code class="plaintext hljs">import gql from 'graphql-tag' import mongodb from '/path/to/mongodb' //  -  . ,  `mongodb`     MongoDB. const schema = { typeDefs: gql`   type Nutrition {     flavorId: ID     calories: Int     fat: Int     sodium: Int   }   type Flavor {     id: ID     name: String     description: String     nutrition: Nutrition   }   type Query {     flavors(id: ID): [Flavor]   }   type Mutation {     updateFlavor(id: ID!, name: String, description: String): Flavor   } `, resolvers: {   Query: {     flavors: (parent, args) =&gt; {       // ,  args  ,  { id: '1' }       return mongodb.collection('flavors').find(args).toArray()     },   },   Mutation: {     updateFlavor: (parent, args) =&gt; {       // ,  args    { id: '1', name: 'Movie Theater Clone', description: 'Bring the movie theater taste home!' }       //  .       mongodb.collection('flavors').update(args)       //  flavor  .       return mongodb.collection('flavors').findOne(args.id)     },   },   Flavor: {     nutrition: (parent) =&gt; {       return mongodb.collection('nutrition').findOne({         flavorId: parent.id,       })     }   }, }, } export default schema</code> </pre> <br>  A defini√ß√£o de campos em um esquema GraphQL consiste em duas partes - de declara√ß√µes de tipo ( <code>typeDefs</code> ) e <code>resolver</code> .  A <code>typeDefs</code> cont√©m declara√ß√µes de tipo para os dados usados ‚Äã‚Äãno aplicativo.  Por exemplo, falamos anteriormente sobre uma solicita√ß√£o para obter uma lista de objetos de <code>flavor</code> do servidor.  Para fazer uma solicita√ß√£o semelhante ao nosso servidor, voc√™ deve executar as tr√™s etapas a seguir: <br><br><ol><li>  Informe ao esquema a apar√™ncia dos dados do objeto de <code>flavor</code> (no exemplo acima, ele se parece com um an√∫ncio do <code>type Flavor</code> ). </li><li>  Declare o campo no campo raiz do <code>type Query</code> (esta √© a propriedade <code>flavors</code> do <code>type Query</code> Valor da <code>type Query</code> ). </li><li>  Declare uma fun√ß√£o do reconhecedor de objeto <code>resolvers.Query</code> gravada de acordo com os campos declarados no campo raiz do <code>type Query</code> . </li></ol><br>  Agora vamos prestar aten√ß√£o ao <code>typeDefs</code> .  Aqui, fornecemos as informa√ß√µes do esquema sobre a forma dos nossos dados.  Em outras palavras, informamos ao GraphQL as v√°rias propriedades que podem estar contidas nas entidades do tipo correspondente. <br><br><pre> <code class="plaintext hljs">type Flavor { id: ID name: String description: String nutrition: Nutrition }</code> </pre> <br>  Uma declara√ß√£o de <code>type Flavor</code> indica que um objeto de <code>flavor</code> pode conter um campo de <code>ID</code> do tipo <code>ID</code> , um campo de <code>name</code> do tipo <code>String</code> , um campo de <code>description</code> do tipo <code>String</code> e um campo de <code>nutrition</code> do tipo <code>Nutrition</code> . <br><br>  No caso da <code>nutrition</code> usamos aqui o nome de um tipo diferente declarado em <code>typeDefs</code> .  Aqui, o <code>type Nutrition</code> constru√ß√£o <code>type Nutrition</code> descreve a forma de dados nutricionais da pipoca. <br><br>  Preste aten√ß√£o ao fato de que aqui, como no in√≠cio deste material, estamos falando de um "aplicativo" e n√£o de um "banco de dados".  No exemplo acima, sup√µe-se que tenhamos um banco de dados, mas os dados no aplicativo podem vir de qualquer fonte.  Pode at√© ser uma API de terceiros ou um arquivo est√°tico. <br><br>  Assim como fizemos na declara√ß√£o de <code>type Flavor</code> , aqui indicamos os nomes dos campos que estar√£o contidos nos objetos de <code>nutrition</code> , usando, como os tipos de dados desses campos (propriedades), o que no GraphQL √© chamado de tipos de dados escalares.  No momento da reda√ß√£o deste artigo, o GraphQL suportava <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">5 tipos de dados escalares integrados</a> : <br><br><ul><li>  <code>Int</code> : n√∫mero inteiro de 32 bits assinado. </li><li>  <code>Float</code> : um n√∫mero de ponto flutuante de precis√£o dupla com um sinal. </li><li>  <code>String</code> : uma sequ√™ncia de caracteres codificados em UTF-8. </li><li>  <code>Boolean</code> : Booleano <code>true</code> ou <code>false</code> . </li><li>  <code>ID</code> : um identificador exclusivo usado frequentemente para carregar objetos repetidamente ou como uma chave no cache.  Os valores do tipo <code>ID</code> serializados da mesma maneira que as cadeias, no entanto, uma indica√ß√£o de que um tipo de <code>ID</code> possui um valor √© enfatizada pelo fato de que esse valor n√£o se destina a ser mostrado √†s pessoas, mas para uso em programas. </li></ul><br>  Al√©m desses tipos escalares, tamb√©m podemos atribuir propriedades aos tipos que nos definimos.  Foi exatamente isso que fizemos ao atribuir a propriedade <code>nutrition</code> descrita no <code>type Flavor</code> , tipo de constru√ß√£o <code>Nutrition</code> . <br><br><pre> <code class="plaintext hljs">type Query { flavors(id: ID): [Flavor] }</code> </pre> <br>  No <code>type Query</code> constru√ß√£o <code>type Query</code> , que descreve o tipo raiz de <code>Query</code> (a "consulta raiz" de que falamos anteriormente), declaramos o nome do campo que pode ser solicitado.  Ao declarar esse campo, al√©m disso, juntamente com o tipo de dados que esperamos retornar, especificamos os argumentos que podem surgir na solicita√ß√£o. <br><br>  Neste exemplo, esperamos um poss√≠vel recebimento do argumento <code>id</code> de um <code>ID</code> tipo escalar.  Em resposta a essa solicita√ß√£o, espera-se uma matriz de objetos cujo dispositivo se assemelha a um dispositivo do tipo <code>Flavor</code> . <br><br><h3>  <font color="#3AC1EF">‚ñçConectando o reconhecedor de consultas</font> </h3><br> ,    <code>type Query</code>    <code>field</code> ,    ,   -. <br><br>  ‚Äî  ,  GraphQL,   , ¬´¬ª.      <code>resolvers</code> ,     <code>Query</code> ,   ,      <code>flavors</code> ,   .        <code>flavors</code> ,     <code>type Query</code> . <br><br><pre> <code class="plaintext hljs">typeDefs: gql`‚Ä¶`, resolvers: { Query: {   flavors: (parent, args) =&gt; {     // ,  args    { id: '1' }     return mongodb.collection('flavors').find(args).toArray()   }, }, ‚Ä¶ },</code> </pre> <br>  -   .  <code>parent</code> ‚Äî   ,   ,  <code>args</code>      ,   .      <code>context</code> ,      .       ¬´¬ª  ( ‚Äî        ,       ). <br><br>     ,    ,   .   GraphQL ¬´ ¬ª          . , ,      . <br><br>  GraphQL      ,      ,    .    JSON-,  JSON-,  (  GraphQL   ). <br><br>    -   <code>flavors</code>   MongoDB,  <code>args</code> (    )   <code>.find()</code>   ,        ,   . <br><br><h3> <font color="#3AC1EF">‚ñç    </font> </h3><br>     -,   GraphQL,  , ,   ,      <code>nutrition</code> .   ,  ,   <code>Nutrition</code> , ,   ,      ,   <code>flavor</code> .      ,       /  . <br><br>    GraphQL  ,  <code>type Flavor</code>      <code>nutrition</code>   <code>type Nutrition</code> ,          .  ,    ,      <code>flavor</code> . <br><br><pre> <code class="plaintext hljs">typeDefs: gql`   type Nutrition {     flavorId: ID     calories: Int     fat: Int     sodium: Int   }   type Flavor {     [‚Ä¶]     nutrition: Nutrition   }   type Query {‚Ä¶}   type Mutation {‚Ä¶} `, resolvers: {   Query: {     flavors: (parent, args) =&gt; {‚Ä¶},   },   Mutation: {‚Ä¶},   Flavor: {     nutrition: (parent) =&gt; {       return mongodb.collection('nutrition').findOne({         flavorId: parent.id,       })     }   }, },</code> </pre> <br>      <code>resolvers</code>  ,   ,      <code>Query</code> , <code>Mutation</code>  <code>Flavor</code> .   ,      <code>typeDefs</code> . <br><br>     <code>Flavors</code> ,  ,   <code>nutrition</code>     -.       ,        <code>Flavor</code> .  ,   : ¬´ ,     <code>nutrition</code>     ,  <code>type Flavor</code> ¬ª. <br><br>         MongoDB,      ,     <code>parent</code> ,  -. ,     <code>parent</code> ,   ,    ,   <code>flavors</code> . ,      <code>flavor</code> ,    : <br><br><pre> <code class="plaintext hljs">{ flavors {   id   name   nutrition {     calories   } } }</code> </pre> <br>   <code>flavor</code> ,   <code>flavors</code> ,     <code>nutrition</code> ,        <code>parent</code> .     ,  ,  ,    MongoDB,   <code>parent.id</code> ,    <code>id</code>  <code>flavor</code> ,       . <br><br>  <code>parent.id</code>      ,     <code>nutrition</code>   <code>flavorId</code> ,     <code>flavor</code> . <br><br><h3> <font color="#3AC1EF">‚ñç </font> </h3><br> ,      ,     .   ,          .      <code>type Mutation</code> ,   ,       <code>updateFlavor</code> ,  ,   . <br><br><pre> <code class="plaintext hljs">type Mutation { updateFlavor(id: ID!, name: String, description: String): Flavor }</code> </pre> <br>     : ¬´ ,   <code>updateFlavor</code>  <code>id</code>  <code>ID</code> ( , <code>!</code> ,  GraphQL  ,    ), <code>name</code>  <code>String</code>  <code>description</code>  <code>String</code> ¬ª.  ,         ,     <code>Flavor</code> (  ‚Äî ,    <code>id</code> , <code>name</code> , <code>description</code> , , , <code>nutrition</code> ). <br><br><pre> <code class="plaintext hljs">{ typeDefs: gql`‚Ä¶`, resolvers: {   Mutation: {     updateFlavor: (parent, args) =&gt; {       // ,  args    { id: '1', name: 'Movie Theater Clone', description: 'Bring the movie theater taste home!' }       //  .       mongodb.collection('flavors').update(         { id: args.id },         {           $set: {             ...args,           },         },       )       //  flavor  .       return mongodb.collection('flavors').findOne(args.id)     },   }, }, }</code> </pre> <br>  -   <code>updateFlavor</code>    ,      :       ,    ,   ‚Äî ,      <code>flavor</code> . <br><br>    ,               ,       <code>flavor</code>     .   ? <br><br>   ,          ,        .     ,     <code>flavor</code> ,     . <br><br>      <code>args</code> ? , . ,          ,   ,      100%   ,         .       ,    ,  ,     ,      ,    . <br><br><h2> <font color="#3AC1EF">    GraphQL?</font> </h2><br>  ,      ,    ,     ,   , GraphQL-API. <br><br>        ,     GraphQL      ,      .  ,         .        ,    .  , ,   ,   GraphQL      REST      .  ,   ,           ,     GraphQL. <br><br><h3> <font color="#3AC1EF">‚ñç    ,   </font> </h3><br>     ,       HTTP-,  ,      ,   ,   ‚Äî  .       GraphQL       ,  ,    ,     ,     (            ). <br><br>        ,  ,     ( ‚Äî         ),  GraphQL      . <br><br><h3> <font color="#3AC1EF">‚ñç    ,    ,       </font> </h3><br>  ,       ,    ¬´ ¬ª.      , ,   ,   .        .   GraphQL         . <br><br><h3> <font color="#3AC1EF">‚ñç     ,       </font> </h3><br>          REST API,          :  ,    . ,      -,   iOS  Android,   API  .    ,  , ,   , ¬´   ¬ª    . <br><br>    ,   ,   ,   HTTP,              API (, ,   ). <br><br><h3> <font color="#3AC1EF">‚ñç   GraphQL ‚Äî   ?        REST API    GraphQL?</font> </h3><br> , .   . ,  ,   GraphQL     .       GraphQL,     .       ,      ,      ,           .     ,      ,     . <br><br> ,  GraphQL  ,  ,      ,  .    GraphQL    ,      Apollo  Relay,       . <br><br> GraphQL ‚Äî ,  ,   .   <code>graphql</code> (     <code>express-graphql</code> ,    ) ‚Äî      .  ,   GraphQL      -  .      ,     -,   ,  ,     ,    . <br><br><h2>  <font color="#3AC1EF">Sum√°rio</font> </h2><br>   ,   GraphQL    ,           . GraphQL      ,    , ,  .  , ,       ,        ,       GraphQL. <br><br> ,       : GraphQL   .              GraphQL  . ,     GraphQL,      ,  , ,  ,  ,  ,  . <br><br>  ‚Äî   ,  GraphQL ‚Äî ,   ,   .  GraphQL       ,   .    ,  GraphQL ‚Äî  ,  , ,  .           .  ,       ,      ,   ,     ,      ,      GraphQL. <br><br>  <b>Caros leitores!</b>        GraphQL ‚Äî     ,         . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt445268/">https://habr.com/ru/post/pt445268/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt445258/index.html">Como excluir com seguran√ßa seus dados do seu smartphone Android antes de vend√™-los</a></li>
<li><a href="../pt445260/index.html">Os rob√¥s se reconhecer√£o verdadeiramente? Os cientistas est√£o caminhando nessa dire√ß√£o.</a></li>
<li><a href="../pt445262/index.html">GeekUniversity Abre Recrutamento no Departamento de Big Data Analytics</a></li>
<li><a href="../pt445264/index.html">Pr√©-carregamento, pr√©-busca e outras tags</a></li>
<li><a href="../pt445266/index.html">GeekBrains e Rostelecom conduzir√£o IoT Hackathon</a></li>
<li><a href="../pt445270/index.html">[marcador] Bash para iniciantes: 21 comandos √∫teis</a></li>
<li><a href="../pt445272/index.html">JavaScript √© a melhor linguagem de programa√ß√£o para iniciantes. Ent√£o √© ou n√£o?</a></li>
<li><a href="../pt445274/index.html">Quando "Zo√´"! == "Zo√´", ou por que voc√™ precisa normalizar seq√º√™ncias de caracteres Unicode</a></li>
<li><a href="../pt445276/index.html">Guia completo de UseEffect</a></li>
<li><a href="../pt445278/index.html">Como criar um jogo se voc√™ nunca √© um artista</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>