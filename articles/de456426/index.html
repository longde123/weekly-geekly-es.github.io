<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🤶🏽 👆🏾 👨‍👩‍👧 BASS - ein Framework für die automatische Synthese von Antivirensignaturen 🗞️ 🐴 🧔🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo an alle. Bis zum Beginn des Kurses „Reverse Engineering“ verbleiben weniger als zehn Tage. In diesem Zusammenhang möchten wir eine weitere inter...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>BASS - ein Framework für die automatische Synthese von Antivirensignaturen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/456426/">  Hallo an alle.  Bis zum Beginn des Kurses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">„Reverse Engineering“</a> verbleiben weniger als zehn Tage. In diesem Zusammenhang möchten wir eine weitere interessante Übersetzung zu diesem Thema veröffentlichen.  Lass uns gehen! <br><br><img src="https://habrastorage.org/webt/ff/sk/na/ffsknagvtnwxc02g9xpjlu-0p1i.png"><br><br><h2>  Kurzer Rückblick </h2><br><img src="https://habrastorage.org/webt/hi/fs/gs/hifsgsy2jdczl7lk9n3zj1luisy.png"><br><br>  Das Bild der Bedrohungen ändert sich rasant - es treten ständig neue Cyber-Angriffe auf, und die alten werden immer ausgefeilter.  Unter diesen Umständen stehen Sicherheitsexperten vor immer komplexeren Herausforderungen.  Jeden Tag müssen sie Millionen von Proben bisher unbekannter und völlig neuer Malware verarbeiten und analysieren, wirksame Antivirensignaturen entwickeln, um ganze Familien von Schadprogrammen zu beschreiben, und die Skalierbarkeit von Tools sicherstellen, wenn die Anzahl der zu analysierenden Proben zunimmt.  Gleichzeitig müssen die begrenzten Ressourcen für Automatisierungstools für die Malware-Analyse berücksichtigt werden.  Um IT-Experten bei der Bewältigung dieser vielfältigen Herausforderungen zu unterstützen, bietet Talos eine neue Open Source-Plattform namens BASS an. <a name="habracut"></a><br><br>  BASS (als „Bass“ gelesen) ist ein Framework zum automatischen Generieren von Antivirensignaturen basierend auf Beispielen aus zuvor gebildeten Clustern von Schadcode.  Ziel ist es, den Ressourcenverbrauch des ClamAV-Kerns zu reduzieren, indem der Anteil vorlagenbasierter Signaturen im Vergleich zu Hash-Signaturen erhöht wird, und die Arbeit von Analysten bei der Entwicklung vorlagenbasierter Signaturen zu vereinfachen.  Mit der Unterstützung von Docker-Containern lässt sich das Framework gut skalieren. <br><br>  Es ist erwähnenswert, dass bisher nur die Alpha-Version von BASS verfügbar ist und noch viel zu finalisieren ist.  Dieses Projekt verfügt über Open Source Code und wir arbeiten aktiv daran. Daher freuen wir uns über Feedback von der Community und Empfehlungen zur Verbesserung.  Den Quellcode für BASS finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br>  Das BASS-Projekt wurde 2017 auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">REcon-</a> Konferenz in Montreal, Kanada, angekündigt. <br><br><h2>  Relevanz </h2><br>  Talos-Spezialisten erhalten täglich mehr als 1,5 Millionen Einzelproben.  Sie beziehen sich größtenteils auf bekannte Bedrohungen und werden von einem Malware-Scanner (ClamAV) sofort beseitigt.  Nach dem Scannen müssen jedoch noch viele Dateien weiter analysiert werden.  Wir führen sie in der Sandbox aus und führen dynamische Analysen durch, die es uns ermöglichen, sie in böswillige und sichere zu unterteilen.  Wir verarbeiten die in dieser Phase ausgewählten Malware-Beispiele, um darauf basierende ClamAV-Signaturen zu erstellen, mit deren Hilfe diese Bedrohungen zu einem früheren Zeitpunkt während des Scannens weiter gefiltert werden können. <br><br><img src="https://habrastorage.org/webt/5f/oh/6o/5foh6op04xmtrj7-7wuhy0ifkfm.jpeg"><br><br>  Für drei Monate, von Februar bis April 2017, wurden der ClamAV-Datenbank 560.000 neue Signaturen hinzugefügt, was einer Zunahme von 9.500 Signaturen pro Tag entspricht.  Ein wesentlicher Teil davon haben wir automatisch in Form von Hash-Signaturen erhalten.  Solche Signaturen haben einen signifikanten Nachteil im Vergleich zu Vorlagen- oder Bytecode-Signaturen (dies sind zwei andere Typen, die vom ClamAV-Kern unterstützt werden): Eine Hash-Signatur entspricht nur einer Datei.  Darüber hinaus führt eine Erhöhung der Anzahl der Hash-Signaturen dazu, dass die ClamAV-Datenbank mehr Speicherplatz beansprucht.  Deshalb bevorzugen wir musterbasierte Signaturen.  Sie sind viel einfacher und schneller zu verwalten als Bytecode und ermöglichen es Ihnen gleichzeitig, ganze Cluster von Dateien zu beschreiben. <br><br><h2>  Bass </h2><br>  Das BASS-Framework soll die Erstellung von ClamAV-signaturbasierten Vorlagen erleichtern.  Es generiert sie automatisch und verarbeitet Segmente von ausführbarem Binärcode. <br><br><img src="https://habrastorage.org/webt/ce/jt/ew/cejtew2tpxdzibmmqztxp88tija.jpeg"><br><br>  BASS basiert auf Clustern von Schadcode, enthält jedoch nicht die Mittel zu deren Erstellung.  Aufgrund dessen bleibt die Technologie bequem und flexibel.  Wir haben die Eingabeschnittstelle absichtlich universell gestaltet, damit sie leicht an neue Clusterquellen angepasst werden kann.  Jetzt verwenden wir mehrere solcher Quellen, einschließlich Cluster, die auf Kompromissindikatoren (IoC) aus unserer Sandbox basieren, strukturelles Hashing (wenn wir eine wissentlich bösartige ausführbare Datei haben und nach zusätzlichen Beispielen suchen, deren Struktur ähnlich ist) und empfangene Malware von Spam-Kampagnen. <br><br>  In der ersten Phase passieren böswillige Instanzen die ClamAV-Kernel-Entpacker.  Es kann Archive verschiedener Formate und komprimierte ausführbare Dateien (z. B. UPX) entpacken und eingebettete Objekte (z. B. EXE-Dateien in Word-Dokumenten) extrahieren.  Die empfangenen Artefakte werden sorgfältig analysiert, Informationen werden gesammelt.  Für die nächste Stufe, das Filtern, verwenden wir ihre Größen und die magische UNIX-Zeichenfolge. <br><br>  Dann wird der Cluster von Schadcode gefiltert.  Wenn die Dateien nicht den BASS-Anforderungen entsprechen (während die Plattform nur mit ausführbaren PE-Dateien funktioniert, es jedoch nicht schwierig ist, Unterstützung für die ELF- und MACH-O-Binärdateien hinzuzufügen), werden sie aus dem Cluster gelöscht, oder wenn zu wenige Objekte übrig sind, wird der Cluster vollständig abgelehnt. <br><br>  Der gefilterte Cluster fährt mit der Signaturgenerierungsphase fort.  Zunächst werden Binärdateien zerlegt.  Zu diesem Zweck verwenden wir IDA Pro, das jedoch problemlos durch einen anderen Disassembler mit ähnlichen Funktionen ersetzt werden kann, z. B. radare2. <br><br><img src="https://habrastorage.org/webt/cz/ah/gl/czahglwn1x_oflib8pokrduqeso.jpeg"><br><br>  Nach dem Zerlegen muss ein gemeinsamer Code in den Beispielen identifiziert werden, um auf dieser Basis Signaturen zu generieren.  Dieser Schritt ist aus zwei Gründen wichtig.  Erstens erfordert der Signaturgenerierungsalgorithmus erhebliche Rechenressourcen und funktioniert besser mit Kurzcodesegmenten.  Zweitens ist es vorzuziehen, Signaturen von Codebeispielen zu erhalten, die nicht nur syntaktisch, sondern auch semantisch ähnlich sind.  Zum Vergleichen des Codes verwenden wir das Dienstprogramm BinDiff.  Auch hier ist es leicht zu ersetzen, und in Zukunft können wir andere Dienstprogramme zum Vergleich in das Framework integrieren. <br><br>  Wenn der Cluster klein ist, vergleicht BinDiff jede ausführbare Datei mit allen anderen.  Andernfalls wird der Umfang des Vergleichs verringert, andernfalls kann der Prozess zu lang sein.  Basierend auf den erhaltenen Ergebnissen wird ein Graph erstellt, in dem die Eckpunkte die Funktionen bezeichnen und die Kanten ihre Ähnlichkeit anzeigen.  Um eine gute allgemeine Funktion zu finden, reicht es aus, einen verbundenen Untergraphen mit einem hohen Gesamtähnlichkeitsindex zu finden. <br><br><img src="https://habrastorage.org/webt/uz/tk/nt/uztkntwexposekzfrzoskpmfotq.jpeg"><br><br>  Der Untergraph ƒ1, ƒ2, ƒ4, ƒ6 mit Indikatoren für hohe Scheitelpunktähnlichkeit (siehe Abbildung oben) ist ein hervorragender Kandidat für die Rolle einer gemeinsamen Funktion. <br><br>  Sobald mehrere solcher Kandidaten eingestellt sind, vergleichen wir sie mit der weißen Liste, um zu vermeiden, dass Signaturen erstellt werden, die auf den normalen Funktionen der Bibliotheken basieren, die statisch mit der Stichprobe verknüpft sind.  Dazu werden die Funktionen an die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kam1n0-</a> Instanz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gesendet</a> , deren Datenbank wir zuvor mit Funktionen aus offensichtlich reinen Samples gefüllt haben.  Wenn ein Klon einer Funktion erkannt wird, wird das Subgraph-Auswahlverfahren wiederholt, um den am besten geeigneten der verbleibenden auszuwählen.  Wenn die Überprüfung nichts ergibt, wird der Funktionssatz an die nächste Stufe übergeben. <br><br>  Dann beginnt die Erzeugung der Signatur direkt.  Vorlagenbasierte ClamAV-Signaturen dienen zum Erkennen von Teilsequenzen in Binärdaten.  Daher wenden wir auf alle extrahierten Funktionen den Suchalgorithmus für die größte gemeinsame Teilsequenz (LCS, Longest Common Subsequence) an. <br><br>  Aus rechnerischer Sicht ist dieser Algorithmus selbst für zwei Stichproben ziemlich teuer und für mehrere deutlich schwieriger. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Daher verwenden</a> wir seine von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Christian Blichmann</a> beschriebene heuristische Variante.  Das Ergebnis könnte ungefähr so ​​aussehen: <br><br><img src="https://habrastorage.org/webt/zb/9_/il/zb9_ilfd2g0rcqw1nw1h5iblsi4.jpeg"><br><br>  Schließlich müssen Sie es testen, bevor Sie die Signatur veröffentlichen.  Wir überprüfen die Signatur mithilfe unserer Testsuite automatisch auf falsch positive Ergebnisse.  Für eine höhere Zuverlässigkeit verwenden wir Sigalyzer, eine neue Funktion unseres <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CASC IDA Pro ClamAV-</a> Plug-Ins <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zum Generieren und Analysieren von Signaturen</a> (wird später aktualisiert).  Sigalyzer markiert Abschnitte der Binärdatei, die mit der ClamAV-Signatur übereinstimmen, die für sie funktioniert hat.  Somit wird eine visuelle visuelle Darstellung der Signatur gebildet. <br><br><h2>  Architektur </h2><br>  BASS ist als Cluster von Docker-Containern implementiert.  Das Framework ist in Python geschrieben und interagiert über Webdienste mit allen erforderlichen Tools.  Die Architektur wurde in Analogie zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VxClass-</a> Projekt erstellt, das auch ClamAV-Signaturen mit IDA Pro und BinDiff generierte, später jedoch geschlossen und im Gegensatz zu BASS nicht für die breite Öffentlichkeit zugänglich war. <br><br><img src="https://habrastorage.org/webt/wg/ma/x2/wgmax2n6nevnscpmjx_lijw9kmq.jpeg"><br><br><h2>  Einschränkungen </h2><br>  BASS arbeitet ausschließlich mit ausführbaren Binärdateien, da die Signatur aus dem Beispielcode generiert wird.  Außerdem werden nur ausführbare x86- und x86_64-Dateien analysiert.  Unterstützung für andere Architekturen wird möglicherweise in Zukunft angezeigt. <br><br>  Bisher kommt BASS nicht gut mit Dateiviren zurecht, die kleine und sehr unterschiedliche Codefragmente in infizierte Objekte einbetten, und mit Hintertüren, die hauptsächlich aus harmlosem Binärcode bestehen (oft gestohlen), der durch böswillige Funktionen ergänzt wird.  Wir kämpfen mit diesen Mängeln, indem wir daran arbeiten, die Clustering-Phase zu optimieren. <br><br>  Und noch einmal möchten wir Sie daran erinnern, dass sich BASS in der Alpha-Testphase befindet und bisher nicht alles reibungslos funktioniert.  Wir hoffen jedoch, dass wir der Community durch die Entwicklung dieses Frameworks als Open-Source-Projekt zugute kommen, und freuen uns über Ideen und Kritik. <br><br><h2>  App </h2><br>  <i>Der Unterschied zwischen der größten gemeinsamen Teilzeichenfolge und der größten gemeinsamen Teilfolge</i> <br><br>  Die folgende Abbildung zeigt den Unterschied zwischen dem größten gemeinsamen Teilstring und der größten gemeinsamen Teilsequenz.  Die größte häufige Folge wird in unserer Veröffentlichung durch das englische Akronym LCS angegeben. <br><br><img src="https://habrastorage.org/webt/ul/ww/a8/ulwwa8nqjhgoblgtzgq_kkaygfc.jpeg"><br><br>  Das ist alles.  Und bereits am 20. Juni wird es möglich sein, das Kursprogramm beim Tag <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der offenen Tür</a> , das im Webinar-Modus stattfindet, detailliert kennenzulernen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456426/">https://habr.com/ru/post/de456426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456414/index.html">Schutz vor Feuer in Rechenzentren oder wie Daten gespeichert werden</a></li>
<li><a href="../de456416/index.html">Agil für alle Bücher</a></li>
<li><a href="../de456418/index.html">Eine kurze Geschichte des Betrugs von Videospielen</a></li>
<li><a href="../de456422/index.html">Ankündigung einer neuen Version von Styled Components v5: Animal Grin</a></li>
<li><a href="../de456424/index.html">Utreexo: viel UTXO Bitcoin komprimieren</a></li>
<li><a href="../de456428/index.html">Implementierung eines BI-Ansatzes zur Datenanalyse: praktische Empfehlungen</a></li>
<li><a href="../de456430/index.html">Das ewige Problem der technischen Verschuldung</a></li>
<li><a href="../de456432/index.html">Sicherheitswoche 25: Evernote-Sicherheitslücke und Hunderte von gehackten Online-Shops</a></li>
<li><a href="../de456434/index.html">Berufe der Zukunft: „Mit wem werden Sie auf dem Mars arbeiten?“</a></li>
<li><a href="../de456436/index.html">Kurze JS-Aufgabe für Montag</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>