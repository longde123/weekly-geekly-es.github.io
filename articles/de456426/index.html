<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§∂üèΩ üëÜüèæ üë®‚Äçüë©‚Äçüëß BASS - ein Framework f√ºr die automatische Synthese von Antivirensignaturen üóûÔ∏è üê¥ üßîüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo an alle. Bis zum Beginn des Kurses ‚ÄûReverse Engineering‚Äú verbleiben weniger als zehn Tage. In diesem Zusammenhang m√∂chten wir eine weitere inter...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>BASS - ein Framework f√ºr die automatische Synthese von Antivirensignaturen</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/otus/blog/456426/">  Hallo an alle.  Bis zum Beginn des Kurses <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚ÄûReverse Engineering‚Äú</a> verbleiben weniger als zehn Tage. In diesem Zusammenhang m√∂chten wir eine weitere interessante √úbersetzung zu diesem Thema ver√∂ffentlichen.  Lass uns gehen! <br><br><img src="https://habrastorage.org/webt/ff/sk/na/ffsknagvtnwxc02g9xpjlu-0p1i.png"><br><br><h2>  Kurzer R√ºckblick </h2><br><img src="https://habrastorage.org/webt/hi/fs/gs/hifsgsy2jdczl7lk9n3zj1luisy.png"><br><br>  Das Bild der Bedrohungen √§ndert sich rasant - es treten st√§ndig neue Cyber-Angriffe auf, und die alten werden immer ausgefeilter.  Unter diesen Umst√§nden stehen Sicherheitsexperten vor immer komplexeren Herausforderungen.  Jeden Tag m√ºssen sie Millionen von Proben bisher unbekannter und v√∂llig neuer Malware verarbeiten und analysieren, wirksame Antivirensignaturen entwickeln, um ganze Familien von Schadprogrammen zu beschreiben, und die Skalierbarkeit von Tools sicherstellen, wenn die Anzahl der zu analysierenden Proben zunimmt.  Gleichzeitig m√ºssen die begrenzten Ressourcen f√ºr Automatisierungstools f√ºr die Malware-Analyse ber√ºcksichtigt werden.  Um IT-Experten bei der Bew√§ltigung dieser vielf√§ltigen Herausforderungen zu unterst√ºtzen, bietet Talos eine neue Open Source-Plattform namens BASS an. <a name="habracut"></a><br><br>  BASS (als ‚ÄûBass‚Äú gelesen) ist ein Framework zum automatischen Generieren von Antivirensignaturen basierend auf Beispielen aus zuvor gebildeten Clustern von Schadcode.  Ziel ist es, den Ressourcenverbrauch des ClamAV-Kerns zu reduzieren, indem der Anteil vorlagenbasierter Signaturen im Vergleich zu Hash-Signaturen erh√∂ht wird, und die Arbeit von Analysten bei der Entwicklung vorlagenbasierter Signaturen zu vereinfachen.  Mit der Unterst√ºtzung von Docker-Containern l√§sst sich das Framework gut skalieren. <br><br>  Es ist erw√§hnenswert, dass bisher nur die Alpha-Version von BASS verf√ºgbar ist und noch viel zu finalisieren ist.  Dieses Projekt verf√ºgt √ºber Open Source Code und wir arbeiten aktiv daran. Daher freuen wir uns √ºber Feedback von der Community und Empfehlungen zur Verbesserung.  Den Quellcode f√ºr BASS finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> . <br><br>  Das BASS-Projekt wurde 2017 auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">REcon-</a> Konferenz in Montreal, Kanada, angek√ºndigt. <br><br><h2>  Relevanz </h2><br>  Talos-Spezialisten erhalten t√§glich mehr als 1,5 Millionen Einzelproben.  Sie beziehen sich gr√∂√ütenteils auf bekannte Bedrohungen und werden von einem Malware-Scanner (ClamAV) sofort beseitigt.  Nach dem Scannen m√ºssen jedoch noch viele Dateien weiter analysiert werden.  Wir f√ºhren sie in der Sandbox aus und f√ºhren dynamische Analysen durch, die es uns erm√∂glichen, sie in b√∂swillige und sichere zu unterteilen.  Wir verarbeiten die in dieser Phase ausgew√§hlten Malware-Beispiele, um darauf basierende ClamAV-Signaturen zu erstellen, mit deren Hilfe diese Bedrohungen zu einem fr√ºheren Zeitpunkt w√§hrend des Scannens weiter gefiltert werden k√∂nnen. <br><br><img src="https://habrastorage.org/webt/5f/oh/6o/5foh6op04xmtrj7-7wuhy0ifkfm.jpeg"><br><br>  F√ºr drei Monate, von Februar bis April 2017, wurden der ClamAV-Datenbank 560.000 neue Signaturen hinzugef√ºgt, was einer Zunahme von 9.500 Signaturen pro Tag entspricht.  Ein wesentlicher Teil davon haben wir automatisch in Form von Hash-Signaturen erhalten.  Solche Signaturen haben einen signifikanten Nachteil im Vergleich zu Vorlagen- oder Bytecode-Signaturen (dies sind zwei andere Typen, die vom ClamAV-Kern unterst√ºtzt werden): Eine Hash-Signatur entspricht nur einer Datei.  Dar√ºber hinaus f√ºhrt eine Erh√∂hung der Anzahl der Hash-Signaturen dazu, dass die ClamAV-Datenbank mehr Speicherplatz beansprucht.  Deshalb bevorzugen wir musterbasierte Signaturen.  Sie sind viel einfacher und schneller zu verwalten als Bytecode und erm√∂glichen es Ihnen gleichzeitig, ganze Cluster von Dateien zu beschreiben. <br><br><h2>  Bass </h2><br>  Das BASS-Framework soll die Erstellung von ClamAV-signaturbasierten Vorlagen erleichtern.  Es generiert sie automatisch und verarbeitet Segmente von ausf√ºhrbarem Bin√§rcode. <br><br><img src="https://habrastorage.org/webt/ce/jt/ew/cejtew2tpxdzibmmqztxp88tija.jpeg"><br><br>  BASS basiert auf Clustern von Schadcode, enth√§lt jedoch nicht die Mittel zu deren Erstellung.  Aufgrund dessen bleibt die Technologie bequem und flexibel.  Wir haben die Eingabeschnittstelle absichtlich universell gestaltet, damit sie leicht an neue Clusterquellen angepasst werden kann.  Jetzt verwenden wir mehrere solcher Quellen, einschlie√ülich Cluster, die auf Kompromissindikatoren (IoC) aus unserer Sandbox basieren, strukturelles Hashing (wenn wir eine wissentlich b√∂sartige ausf√ºhrbare Datei haben und nach zus√§tzlichen Beispielen suchen, deren Struktur √§hnlich ist) und empfangene Malware von Spam-Kampagnen. <br><br>  In der ersten Phase passieren b√∂swillige Instanzen die ClamAV-Kernel-Entpacker.  Es kann Archive verschiedener Formate und komprimierte ausf√ºhrbare Dateien (z. B. UPX) entpacken und eingebettete Objekte (z. B. EXE-Dateien in Word-Dokumenten) extrahieren.  Die empfangenen Artefakte werden sorgf√§ltig analysiert, Informationen werden gesammelt.  F√ºr die n√§chste Stufe, das Filtern, verwenden wir ihre Gr√∂√üen und die magische UNIX-Zeichenfolge. <br><br>  Dann wird der Cluster von Schadcode gefiltert.  Wenn die Dateien nicht den BASS-Anforderungen entsprechen (w√§hrend die Plattform nur mit ausf√ºhrbaren PE-Dateien funktioniert, es jedoch nicht schwierig ist, Unterst√ºtzung f√ºr die ELF- und MACH-O-Bin√§rdateien hinzuzuf√ºgen), werden sie aus dem Cluster gel√∂scht, oder wenn zu wenige Objekte √ºbrig sind, wird der Cluster vollst√§ndig abgelehnt. <br><br>  Der gefilterte Cluster f√§hrt mit der Signaturgenerierungsphase fort.  Zun√§chst werden Bin√§rdateien zerlegt.  Zu diesem Zweck verwenden wir IDA Pro, das jedoch problemlos durch einen anderen Disassembler mit √§hnlichen Funktionen ersetzt werden kann, z. B. radare2. <br><br><img src="https://habrastorage.org/webt/cz/ah/gl/czahglwn1x_oflib8pokrduqeso.jpeg"><br><br>  Nach dem Zerlegen muss ein gemeinsamer Code in den Beispielen identifiziert werden, um auf dieser Basis Signaturen zu generieren.  Dieser Schritt ist aus zwei Gr√ºnden wichtig.  Erstens erfordert der Signaturgenerierungsalgorithmus erhebliche Rechenressourcen und funktioniert besser mit Kurzcodesegmenten.  Zweitens ist es vorzuziehen, Signaturen von Codebeispielen zu erhalten, die nicht nur syntaktisch, sondern auch semantisch √§hnlich sind.  Zum Vergleichen des Codes verwenden wir das Dienstprogramm BinDiff.  Auch hier ist es leicht zu ersetzen, und in Zukunft k√∂nnen wir andere Dienstprogramme zum Vergleich in das Framework integrieren. <br><br>  Wenn der Cluster klein ist, vergleicht BinDiff jede ausf√ºhrbare Datei mit allen anderen.  Andernfalls wird der Umfang des Vergleichs verringert, andernfalls kann der Prozess zu lang sein.  Basierend auf den erhaltenen Ergebnissen wird ein Graph erstellt, in dem die Eckpunkte die Funktionen bezeichnen und die Kanten ihre √Ñhnlichkeit anzeigen.  Um eine gute allgemeine Funktion zu finden, reicht es aus, einen verbundenen Untergraphen mit einem hohen Gesamt√§hnlichkeitsindex zu finden. <br><br><img src="https://habrastorage.org/webt/uz/tk/nt/uztkntwexposekzfrzoskpmfotq.jpeg"><br><br>  Der Untergraph ∆í1, ∆í2, ∆í4, ∆í6 mit Indikatoren f√ºr hohe Scheitelpunkt√§hnlichkeit (siehe Abbildung oben) ist ein hervorragender Kandidat f√ºr die Rolle einer gemeinsamen Funktion. <br><br>  Sobald mehrere solcher Kandidaten eingestellt sind, vergleichen wir sie mit der wei√üen Liste, um zu vermeiden, dass Signaturen erstellt werden, die auf den normalen Funktionen der Bibliotheken basieren, die statisch mit der Stichprobe verkn√ºpft sind.  Dazu werden die Funktionen an die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kam1n0-</a> Instanz <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">gesendet</a> , deren Datenbank wir zuvor mit Funktionen aus offensichtlich reinen Samples gef√ºllt haben.  Wenn ein Klon einer Funktion erkannt wird, wird das Subgraph-Auswahlverfahren wiederholt, um den am besten geeigneten der verbleibenden auszuw√§hlen.  Wenn die √úberpr√ºfung nichts ergibt, wird der Funktionssatz an die n√§chste Stufe √ºbergeben. <br><br>  Dann beginnt die Erzeugung der Signatur direkt.  Vorlagenbasierte ClamAV-Signaturen dienen zum Erkennen von Teilsequenzen in Bin√§rdaten.  Daher wenden wir auf alle extrahierten Funktionen den Suchalgorithmus f√ºr die gr√∂√üte gemeinsame Teilsequenz (LCS, Longest Common Subsequence) an. <br><br>  Aus rechnerischer Sicht ist dieser Algorithmus selbst f√ºr zwei Stichproben ziemlich teuer und f√ºr mehrere deutlich schwieriger. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Daher verwenden</a> wir seine von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Christian Blichmann</a> beschriebene heuristische Variante.  Das Ergebnis k√∂nnte ungef√§hr so ‚Äã‚Äãaussehen: <br><br><img src="https://habrastorage.org/webt/zb/9_/il/zb9_ilfd2g0rcqw1nw1h5iblsi4.jpeg"><br><br>  Schlie√ülich m√ºssen Sie es testen, bevor Sie die Signatur ver√∂ffentlichen.  Wir √ºberpr√ºfen die Signatur mithilfe unserer Testsuite automatisch auf falsch positive Ergebnisse.  F√ºr eine h√∂here Zuverl√§ssigkeit verwenden wir Sigalyzer, eine neue Funktion unseres <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CASC IDA Pro ClamAV-</a> Plug-Ins <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">zum Generieren und Analysieren von Signaturen</a> (wird sp√§ter aktualisiert).  Sigalyzer markiert Abschnitte der Bin√§rdatei, die mit der ClamAV-Signatur √ºbereinstimmen, die f√ºr sie funktioniert hat.  Somit wird eine visuelle visuelle Darstellung der Signatur gebildet. <br><br><h2>  Architektur </h2><br>  BASS ist als Cluster von Docker-Containern implementiert.  Das Framework ist in Python geschrieben und interagiert √ºber Webdienste mit allen erforderlichen Tools.  Die Architektur wurde in Analogie zum <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">VxClass-</a> Projekt erstellt, das auch ClamAV-Signaturen mit IDA Pro und BinDiff generierte, sp√§ter jedoch geschlossen und im Gegensatz zu BASS nicht f√ºr die breite √ñffentlichkeit zug√§nglich war. <br><br><img src="https://habrastorage.org/webt/wg/ma/x2/wgmax2n6nevnscpmjx_lijw9kmq.jpeg"><br><br><h2>  Einschr√§nkungen </h2><br>  BASS arbeitet ausschlie√ülich mit ausf√ºhrbaren Bin√§rdateien, da die Signatur aus dem Beispielcode generiert wird.  Au√üerdem werden nur ausf√ºhrbare x86- und x86_64-Dateien analysiert.  Unterst√ºtzung f√ºr andere Architekturen wird m√∂glicherweise in Zukunft angezeigt. <br><br>  Bisher kommt BASS nicht gut mit Dateiviren zurecht, die kleine und sehr unterschiedliche Codefragmente in infizierte Objekte einbetten, und mit Hintert√ºren, die haupts√§chlich aus harmlosem Bin√§rcode bestehen (oft gestohlen), der durch b√∂swillige Funktionen erg√§nzt wird.  Wir k√§mpfen mit diesen M√§ngeln, indem wir daran arbeiten, die Clustering-Phase zu optimieren. <br><br>  Und noch einmal m√∂chten wir Sie daran erinnern, dass sich BASS in der Alpha-Testphase befindet und bisher nicht alles reibungslos funktioniert.  Wir hoffen jedoch, dass wir der Community durch die Entwicklung dieses Frameworks als Open-Source-Projekt zugute kommen, und freuen uns √ºber Ideen und Kritik. <br><br><h2>  App </h2><br>  <i>Der Unterschied zwischen der gr√∂√üten gemeinsamen Teilzeichenfolge und der gr√∂√üten gemeinsamen Teilfolge</i> <br><br>  Die folgende Abbildung zeigt den Unterschied zwischen dem gr√∂√üten gemeinsamen Teilstring und der gr√∂√üten gemeinsamen Teilsequenz.  Die gr√∂√üte h√§ufige Folge wird in unserer Ver√∂ffentlichung durch das englische Akronym LCS angegeben. <br><br><img src="https://habrastorage.org/webt/ul/ww/a8/ulwwa8nqjhgoblgtzgq_kkaygfc.jpeg"><br><br>  Das ist alles.  Und bereits am 20. Juni wird es m√∂glich sein, das Kursprogramm beim Tag <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der offenen T√ºr</a> , das im Webinar-Modus stattfindet, detailliert kennenzulernen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de456426/">https://habr.com/ru/post/de456426/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de456414/index.html">Schutz vor Feuer in Rechenzentren oder wie Daten gespeichert werden</a></li>
<li><a href="../de456416/index.html">Agil f√ºr alle B√ºcher</a></li>
<li><a href="../de456418/index.html">Eine kurze Geschichte des Betrugs von Videospielen</a></li>
<li><a href="../de456422/index.html">Ank√ºndigung einer neuen Version von Styled Components v5: Animal Grin</a></li>
<li><a href="../de456424/index.html">Utreexo: viel UTXO Bitcoin komprimieren</a></li>
<li><a href="../de456428/index.html">Implementierung eines BI-Ansatzes zur Datenanalyse: praktische Empfehlungen</a></li>
<li><a href="../de456430/index.html">Das ewige Problem der technischen Verschuldung</a></li>
<li><a href="../de456432/index.html">Sicherheitswoche 25: Evernote-Sicherheitsl√ºcke und Hunderte von gehackten Online-Shops</a></li>
<li><a href="../de456434/index.html">Berufe der Zukunft: ‚ÄûMit wem werden Sie auf dem Mars arbeiten?‚Äú</a></li>
<li><a href="../de456436/index.html">Kurze JS-Aufgabe f√ºr Montag</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>