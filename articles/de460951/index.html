<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🦍 🎗️ 🧑🏿‍🤝‍🧑🏼 Erstellen Sie Android Live Wallpapers ☎️ 👨🏾‍🎓 💧</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich muss auf dem Telefonbildschirm technische Informationen über seinen Zustand anzeigen, genauer gesagt über seinen Zustand im Testpool. Ich möchte d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Erstellen Sie Android Live Wallpapers</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/460951/"><p> Ich muss auf dem Telefonbildschirm technische Informationen über seinen Zustand anzeigen, genauer gesagt über seinen Zustand im Testpool.  Ich möchte diese Informationen immer auf dem Startbildschirm und ohne zusätzliche Körperbewegungen sehen. </p><br><p>  Es gibt nur zwei Möglichkeiten, die sich nicht auf die Ausführung anderer Anwendungen auswirken: Widget oder Live Wallpaper.  Ich habe Live Wallpaper gewählt, sie sind auch "Live Wallpaper", da sie automatisch zu allen Seiten des Startbildschirms und sogar zum Sperrbildschirm gelangen.  Dieser Artikel enthält praktische Tipps zum Erstellen von Live-Hintergründen. </p><a name="habracut"></a><br><h3 id="v-poiskah-pravdy">  Auf der Suche nach der Wahrheit </h3><br><p>  Dokumentation über die "Live Wallpaper" Katze weinte.  Seit der ersten (und einzigen) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ankündigung im Blog</a> vor mehr als 9 Jahren hat Google kein einziges verständliches Beispiel oder Codelab zu diesem Thema erstellt.  Ich musste verstehen </p><br><p>  Erste Grundlagen.  Die interne Mechanik von Android ist so, dass wir die Anwendung nur auf dem Gerät installieren können und das Gerät aller Anwendungen das gleiche ist.  Da "Live Wallpaper" auch eine Anwendung ist, ist die Auswahl einer Steuerungskomponente nicht großartig, und wir sollten erwarten, dass es sich um Service handelt.  Es ist einfach zu finden: Es ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WallpaperService</a> . </p><br><p>  Es kann mehrere Fälle von "Live Wallpaper" geben, und ihr Lebenszyklus unterscheidet sich von dem von Aktivität oder Ansicht.  Dementsprechend sollte es eine weitere Basisklasse geben.  Dies ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WallpaperService.Engine</a> (und es ist notwendigerweise <em>inner</em> für <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WallpaperService</a> !).  Wenn Sie genau hinschauen, wird sich herausstellen, dass es sich um denselben Anbieter von Lebenszyklusereignissen handelt wie Activity, Service und andere ähnliche. </p><br><p>  Der Lebenszyklus von "Live Wallpaper" sieht folgendermaßen aus: </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">onCreate (SurfaceHolder surfaceHolder)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">onSurfaceCreated (SurfaceHolder-Halter)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">onSurfaceChanged (SurfaceHolder-Halter, int-Format, int-Breite, int-Höhe)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">onVisibilityChanged (Boolescher Wert sichtbar)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">onSurfaceRedrawNeeded (SurfaceHolder-Halter)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">onSurfaceDestroyed (SurfaceHolder-Halter)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">onDestroy ()</a> </p><br><p>  Aus dieser Liste wird deutlich, wann Sie das Bild neu zeichnen können / müssen (oder mit dem Neuzeichnen beginnen müssen, wenn Sie eine Animation haben) und wann es Zeit ist, alle Aktivitäten zu stoppen und keine Batterie zu verschwenden. </p><br><p> Die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">onSurfaceRedrawNeeded ()</a> -Methode hebt sich von den anderen ab <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">(siehe</a> unten).  Es gibt auch eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">isVisible ()</a> -Methode (die in Kotlin zur <code>isVisible</code> Eigenschaft wird). </p><br><p>  Jetzt können Sie diesen Konstruktor erstellen.  Ich werde am Ende beginnen. </p><br><h3 id="risuem">  Zeichnen </h3><br><p>  Wir müssen uns auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Leinwand</a> zeichnen, wir werden kein Layout und keinen Inflater haben.  Wie Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Canvas</a> von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SurfaceHolder erhalten</a> und wie Sie darauf zeichnen, geht über den Rahmen dieses Artikels hinaus. Im Folgenden finden Sie ein einfaches Beispiel. </p><br><pre> <code class="kotlin hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dummyDraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(c: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Canvas</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { c.save() c.drawColor(Color.CYAN) c.restore() } <span class="hljs-comment"><span class="hljs-comment">// surfaceHolder property is actually a call to the getSurfaceHolder() method fun drawSynchronously() = drawSynchronously(surfaceHolder) fun drawSynchronously(holder: SurfaceHolder) { if (!isVisible) return var c: Canvas? = null try { c = holder.lockCanvas() c?.let { dummyDraw(it) } } finally { c?.let { holder.unlockCanvasAndPost(it) } } }</span></span></code> </pre><br><h3 id="metody-zhiznennogo-cikla-engine">  Methoden des Motorlebenszyklus </h3><br><p>  Alle Lebenszyklusmethoden außer <code>onSurfaceRedrawNeeded</code> erfordern kein sofortiges Neuzeichnen.  Ein guter Ton wäre daher, die Warteschlange neu zu zeichnen. </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceCreated</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceCreated(holder) redrawHandler.planRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">?, format: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, width: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">, height: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Int</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceChanged(holder, format, width, height) redrawHandler.planRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onVisibilityChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(visible: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Boolean</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onVisibilityChanged(visible) redrawHandler.planRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceDestroyed</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">?)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceDestroyed(holder) redrawHandler.omitRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onDestroy</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onDestroy() redrawHandler.omitRedraw() } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSurfaceRedrawNeeded</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(holder: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">SurfaceHolder</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onSurfaceRedrawNeeded(holder) redrawHandler.omitRedraw() drawSynchronously(holder) <span class="hljs-comment"><span class="hljs-comment">// do it immediately, don't plan }</span></span></code> </pre> <br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Achten Sie</a> auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">onSurfaceRedrawNeeded</a> , mit dem wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">den gleichnamigen SurfaceHolder-Rückruf</a> aufrufen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der beim Ändern der Größe</a> und ähnlichen Ereignissen auftritt.  Mit diesem Rückruf können Sie sofort neu zeichnen, ohne dass der Benutzer das alte (und bereits falsche) Bild anzeigen kann.  Das System garantiert, dass die Ausgabe auf dem Bildschirm angehalten wird, bis eine Rückkehr von dieser Methode erfolgt ist. </p><br><h3 id="scheduler">  Scheduler </h3><br><p>  Ich mag es, Handler neu zu definieren und Runnable nicht darin auszuführen.  Meiner Meinung nach so elegant. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Wenn</a> Sie Animationen oder regelmäßige Updates haben, müssen Sie die Nachricht regelmäßig in die Warteschlange stellen ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">postAtTime ()</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">postDelayed ()</a> , um Ihnen zu helfen).  Wenn die Daten sporadisch aktualisiert werden, rufen <code>planRedraw()</code> einfach <code>planRedraw()</code> auf, um sie zu aktualisieren. </p><br><pre> <code class="kotlin hljs"><span class="hljs-keyword"><span class="hljs-keyword">val</span></span> redrawHandler = RedrawHandler() <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RedrawHandler</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Handler</span></span></span></span>(Looper.getMainLooper()) { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> redraw = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">omitRedraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { removeMessages(redraw) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">planRedraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { omitRedraw() sendEmptyMessage(redraw) } <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handleMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(msg: </span></span><span class="hljs-type"><span class="hljs-function"><span class="hljs-params"><span class="hljs-type">Message</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">when</span></span> (msg.what) { redraw -&gt; drawSynchronously() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> -&gt; <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.handleMessage(msg) } } }</code> </pre> <br><h3 id="service--engine">  Service &amp; Motor </h3><br><p>  Diese Mareshka von Service and Engine ist wie folgt zusammengebaut: </p><br><pre> <code class="kotlin hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooBarWallpaperService</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">WallpaperService</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreateEngine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> = FooBarEngine() <span class="hljs-keyword"><span class="hljs-keyword">inner</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FooBarEngine</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Engine</span></span></span></span>() { .... } }</code> </pre> <br><h3 id="androidmanifest-i-drugie-zaklinaniya">  AndroidManifest und andere Zauber </h3><br><p>  Ich nenne Zaubersprüche in der Softwareentwicklung, die nicht zu verstehen sind, aber genau wiederholt werden müssen. </p><br><p>  In <code>.../app/src/main/res/xml</code> muss eine XML-Datei mit der Beschreibung "Live Wallpaper" vorhanden sein.  Der Name dieser Datei muss in AndroidManifest angegeben werden (suchen <code>foobarwallpaper</code> im folgenden Beispiel nach dem Wort <code>foobarwallpaper</code> ). </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">wallpaper</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:thumbnail</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/some_drawable_preview"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/wallpaper_description"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><p>  Verlieren Sie nicht die <code>permission</code> , <code>meta-data</code> und <code>intent-filter</code> in der Beschreibung des Dienstes: </p><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".FooBarWallpaperService"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Wallpaper Example"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BIND_WALLPAPER"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.service.wallpaper"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@xml/foobarwallpaper"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.service.wallpaper.WallpaperService"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h3 id="kak-dobavit">  Wie man hinzufügt </h3><br><p>  "Live Wallpaper" verstecken sich, daher ein Hinweis.  Ich beschreibe, wie es auf meinem Samsung aussieht. </p><br><p>  Wenn Sie zu Beginn lange auf den Startbildschirm drücken, wechselt das Telefon in den Desktop-Einstellungsmodus. Das <em>Hintergrundbild-</em> Symbol wird angezeigt. </p><br><p>  Wir klicken auf das <em>Hintergrundbild-</em> Symbol, mehrere Abschnitte, wir benötigen <em>Meine Hintergrundbilder</em> , klicken auf die Inschrift <em>Alle</em> in der oberen rechten Ecke des Abschnitts anzeigen, die Liste wird im Vollbildmodus geöffnet. </p><br><p>  Wir drücken die "drei Punkte" des <em>Menüaufrufs</em> , darin wird der <em>Eintrag "LIve Wallpaper"</em> (ich habe einen) <em>angezeigt</em> , eine Liste der verfügbaren "Live Wallpaper" wird angezeigt. </p><br><p>  Wählen Sie unser Hintergrundbild und dann "Startbildschirm und Sperrbildschirm". </p><br><p>  Es wird eine "Vorschau" <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">angezeigt</a> , die bereits von unserer Anwendung gezeichnet wird (um diesen Punkt zu erkennen, gibt es die <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">isPreview ()</a> -Methode). Klicken <em>Sie auf Als Hintergrundbild</em> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">festlegen</a> ... Und wir sehen nichts, da wir zur Liste der verfügbaren Hintergrundbilder zurückkehren. </p><br><p>  Klicken Sie auf "Home" und genießen Sie. </p><br><h3 id="prichem-tut-android-watch">  Und dann Android Watch ?! </h3><br><p>  Eine interessante Beobachtung auf dem Weg ist, dass Gesichter in Android Watch genauso erstellt werden (mit der Genauigkeit, dass sie ihre eigenen Basisklassen mit ihrer eigenen Implementierung haben): dieselbe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Service + Engine</a> , fast dieselben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Metadaten und Absichtsfilter für Service im Manifest</a> (in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Was</a> das Wort Wallpaper viermal vorkommt :), müssen Sie auch <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ihren eigenen Sheduler basierend auf Handler schreiben</a> . </p><br><p>  In den Basisklassen von <em>Watch Faces</em> gibt es ein fertiges <code>onDraw()</code> , an das Canvas übergeben wird, und es gibt <code>invalidate()</code> zum Aufrufen.  Dies ist jedoch kein grundlegender Unterschied, sondern der implementierte Teil der Kesselplatte. </p><br><p>  Im Gegensatz zu Live Wallpaper gibt es Beispiele für Watch Faces, in die Sie sich vertiefen können (Links <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> ganz am Anfang). </p><br><h3 id="chto-poluchilos">  Was ist passiert? </h3><br><p>  Screenshots für eine Anwendung, die einen grünen Bildschirm malt, sind wenig sinnvoll.  Aber ein paar Bilder, die darauf basierten, wurden für den Kampfstand unter dem Spoiler gemacht. </p><br><div class="spoiler">  <b class="spoiler_title">Ein paar Bilder</b> <div class="spoiler_text"><p><img src="https://habrastorage.org/webt/a8/6z/jf/a86zjfmyavmfyyhpwsm6fhi6hau.jpeg"><br><img src="https://habrastorage.org/webt/h8/cu/1-/h8cu1-cyot8nvehv6srjhc03xuk.jpeg"></p><br><p>  Aufkleber sind das verbleibende Problemerkennungssystem der vorherigen Generation. </p></div></div><br><h3 id="blagodarnosti">  Danksagung </h3><br><p>  Ohne diese beiden Artikel wäre ich viel länger in der Dunkelheit gewandert.  Ich kann mir nicht vorstellen, wie sie bereits 2010 mit einer solchen Qualitätsdokumentation hätten geschrieben werden können ?! </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Kirill Grouchnikov, Live Wallpaper</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Vogella, Android Live Wallpaper - Tutorial</a> </p><br><h3 id="ishodniki">  Quellcode </h3><br><p>  → <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">GitHub</a> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de460951/">https://habr.com/ru/post/de460951/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de460941/index.html">Geschäfts-E-Mail-Kompromiss: Keine Verteidigung gegen Angriffe</a></li>
<li><a href="../de460943/index.html">So wählen Sie vielversprechende Schlüssel für SEO basierend auf Szenarioprognosen in Google Data Studio (+ Vorlage)</a></li>
<li><a href="../de460945/index.html">Erfahrung in der Verwendung eines Telegrammkanals zur Steigerung der Bekanntheit und des Umsatzwachstums eines Spielestudios</a></li>
<li><a href="../de460947/index.html">WASM Meet Up 1/08</a></li>
<li><a href="../de460949/index.html">„Und das Unmögliche ist möglich“: Wir verwandeln eine Black Box mithilfe einer binären Analyse in Weiß</a></li>
<li><a href="../de460953/index.html">Zeiger sind komplex oder was ist in einem Byte gespeichert?</a></li>
<li><a href="../de460955/index.html">Bildungsprogramm zur Übergabe von Parametern nach Wert an Konstruktoren und Setter (modernes C ++, Beispiele)</a></li>
<li><a href="../de460959/index.html">Mit der neuen Technologie von Microsoft können 3D-Kopien einer realen Person jede Sprache sprechen</a></li>
<li><a href="../de460961/index.html">Einrichten von Unit-Tests in gemischten Swift + Objective-C-Projekten</a></li>
<li><a href="../de460965/index.html">Split Controller ohne diese Ihre Storyboards</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>