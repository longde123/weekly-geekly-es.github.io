<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚õ©Ô∏è üí£ ‚å®Ô∏è So automatisieren Sie die Erfassung von KPI pro Monat und lassen Benutzer fast zufrieden sein üèåÔ∏è üõåüèº üïµüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In vielen Organisationen wird die Einheitenbewertung mithilfe von KPI (Key Performance Indicators) durchgef√ºhrt. In der Organisation, in der ich arbei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So automatisieren Sie die Erfassung von KPI pro Monat und lassen Benutzer fast zufrieden sein</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423919/"> In vielen Organisationen wird die Einheitenbewertung mithilfe von KPI (Key Performance Indicators) durchgef√ºhrt.  In der Organisation, in der ich arbeite, wird ein solches System als ‚ÄûSystem von Leistungsindikatoren‚Äú bezeichnet. In diesem Artikel m√∂chte ich dar√ºber sprechen, wie wir es geschafft haben, einen Teil der Arbeit mit Indikatoren innerhalb eines Monats zu automatisieren.  Bei alledem waren unsere Arbeitskosten nicht die gr√∂√üten, aber gleichzeitig haben wir versucht, eine langj√§hrige Wunschliste umzusetzen.  In meiner Geschichte wird es keine Hype-Technologien oder Enth√ºllungen geben (schlie√ülich ist die Provinzentwicklung hart), aber es wird einige Skizzen zu diesem Thema geben, die helfen, zu verstehen, wie wir angefangen haben, was wir getan haben und welche Gedanken wir von der Entwicklung bekommen haben.  Wenn Sie sich noch nicht gelangweilt haben, bitte ich um eine Katze. <br><a name="habracut"></a><br><h3>  Hintergrund </h3><br>  Bereits 2006 haben wir ein System von Leistungsindikatoren eingef√ºhrt: Es wurden f√ºnfzehn Bewertungskriterien entwickelt, eine Methode zu deren Berechnung erstellt und eine viertelj√§hrliche H√§ufigkeit zur Berechnung dieser Indikatoren festgelegt.  Die Bewertung wurde f√ºr 22 Zweigstellen der Organisation in allen Bereichen unserer Region durchgef√ºhrt.  Und damit Indikatoren mit gro√üer Begeisterung erreicht werden konnten, war ein Bonus an sie gebunden - je h√∂her die Summe der Indikatoren, desto h√∂her der Platz in der Bewertung, desto h√∂her der Platz in der Bewertung, desto h√∂her die Pr√§mie usw. jedes Quartal und jedes Jahr. <br><br>  Im Laufe der Zeit √§nderte sich die Zusammensetzung der Kriterien: Jedes Quartal wurden neue hinzugef√ºgt oder alte ausgeschlossen.  Auf dem H√∂hepunkt, etwa 2016, √ºberstieg die Anzahl der Indikatoren vierzig, und jetzt sind es nur noch vierzehn. <br><br>  W√§hrend dieser ganzen Zeit war der Prozess ihrer Berechnung jedoch der gleiche.  Jedes Kriterium wird von der zust√§ndigen Einheit der √ºbergeordneten Organisation nach einem speziell f√ºr dieses Kriterium genehmigten Algorithmus berechnet.  Die Berechnung kann sowohl nach einer einfachen als auch nach einer Reihe komplexer Formeln durchgef√ºhrt werden. M√∂glicherweise m√ºssen Daten von mehreren Systemen erfasst werden, w√§hrend sich der Algorithmus sehr wahrscheinlich h√§ufig √§ndert.  Und dann ist schon alles viel einfacher: Der prozentual berechnete Indikator wird mit seinem Koeffizienten multipliziert, so wird ein Punkt durch das Kriterium erhalten, dann werden die Punkte eingestuft und jede Einheit findet gem√§√ü dem Punkt statt.  Das Gleiche gilt f√ºr die Summe der Punkte zur Berechnung des endg√ºltigen Platzes. <br><br>  Excel wurde von Anfang an verwendet, um alles oben Beschriebene zu ber√ºcksichtigen und zu berechnen.  √úber viele Jahre hinweg wurde der endg√ºltige Kriteriensatz und die weitere Berechnung von Punkten und Orten in einer sch√∂nen Platte durchgef√ºhrt, von der ein Teil in der Abbildung dargestellt ist. <br><br><img src="https://habrastorage.org/webt/vg/wa/c6/vgwac6cdozzjztrpwhci_smaon4.png"><br><br>  Ich stelle nur fest, dass in diesem sch√∂nen Tablet die meisten Lautsprecher einfach versteckt sind, aber in Wirklichkeit sah es im 4. Quartal 2016 so aus <br><br><img src="https://habrastorage.org/webt/ku/8s/ah/ku8sah_m9zrjx3ozezxqvz2w9xq.png"><br><br>  Stimmen Sie zu, eine solche Anzahl von Indikatoren und ein solches Volumen der Tabelle tragen nicht zu ihrer Einfachheit bei.  Zus√§tzlich wurde jedes der Kriterien separat berechnet, und M√§dchen aus der allgemeinen Abteilung erstellten diese √úbersichtstabelle mit ihren H√§nden.  In Anbetracht der Tatsache, dass sich nicht nur die Zusammensetzung der Kriterien ge√§ndert hat, sondern auch die Berechnungen (aus vielen Gr√ºnden) mehrmals wiederholt werden konnten, waren die letzten Tage eines jeden Quartals, gelinde gesagt, nicht gl√ºcklich.  Ich musste die Daten in der Tabelle st√§ndig √§ndern, √ºberpr√ºfen und √ºberpr√ºfen: Auf diese Weise vergessen Sie, der Summe der Punkte eine neue Spalte hinzuzuf√ºgen, oder Sie aktualisieren den Koeffizienten nicht, und f√ºr einige Personen wird der Platz niedriger, und damit ist der Bonus geringer.  Daher begann nach der heldenhaften Verkleinerung der Tabelle eine nicht weniger heldenhafte √úberpr√ºfung, die von allen, die jedes Kriterium ber√ºcksichtigten, von Managern und sogar von einem organisatorisch zugewiesenen IT-Spezialisten, √ºberpr√ºft und vereinbart wurde.  Angesichts der Tatsache, dass alle Arbeiten manuell ausgef√ºhrt wurden und die Berechnung der Indikatoren f√ºr die Pivot-Tabelle an die E-Mail gesendet wurde, gab es h√§ufig Situationen, in denen die Pivot-Tabelle Fehler in Formeln und Daten irrelevanter Versionen enthielt.  Der Hauptmann der Beweise berichtet, dass der √úberpr√ºfungsprozess nach jedem festgestellten Fehler neu gestartet wurde. <br>  Wenn alle Indikatoren berechnet sind, wird das Tablet genehmigt und an die Filialen gesendet. Dort wurde es in den Filialen doppelt √ºberpr√ºft: Was ist, wenn das heimt√ºckische Excel glaubt, dass etwas nicht stimmt?  Ich denke, es ist offensichtlich, dass sich die Erstellung eines Jahresberichts √ºber die Kriterien oder die Analyse historischer Daten als nicht weniger aufregende Aufgabe herausstellte. <br><br>  Aus Managementsicht ist ein solches System jedoch sehr effektiv und erm√∂glicht es, bei Bedarf durchh√§ngende Arbeitsbereiche zu straffen, zu √ºberwachen und eine Vorstellung davon zu haben, was in den einzelnen Niederlassungen in einem bestimmten Arbeitsbereich geschieht.  Dar√ºber hinaus war der nach den Kriterien berechnete Standort der Niederlassung ein integraler Indikator. <br><br><h3>  System muss sich √§ndern </h3><br>  Die Praxis hat die Notwendigkeit und Bedeutung eines Bewertungssystems bewiesen.  Anfang 2017 wurde klar, dass die viertelj√§hrliche Berechnung der Kriterien eine Bewertung der geleisteten Arbeit erm√∂glichte, die √úberwachung jedoch eine Schw√§che zulie√ü.  Zu lange Zeitspanne.  In diesem Zusammenhang wurde beschlossen, die Berechnung der Indikatoren alle zwei Wochen durchzuf√ºhren und die Ergebnisse viertelj√§hrlich zusammenzufassen.  Die Erh√∂hung der Berechnungsh√§ufigkeit erm√∂glichte es den Filialleitern, schnell auf √Ñnderungen zu reagieren und die Kontrolle √ºber die Prozesse in ihren Einheiten zu verbessern. <br><br>  Aber nur in der Mutterorganisation waren nur wenige mit der Aussicht zufrieden, den oben beschriebenen Datenerfassungsprozess nicht viertelj√§hrlich, sondern alle zwei Wochen durchzuf√ºhren.  Da es nicht schwer zu erraten ist, haben sie beschlossen, den Prozess zu automatisieren.  Die Fristen erwiesen sich als eng: Vom Zeitpunkt der Entscheidung, auf eine neue Berechnungsh√§ufigkeit umzusteigen, bis zum eigentlichen √úbergang sollte nur ein Monat vergangen sein.  F√ºr diesen Zeitraum war es sehr w√ºnschenswert, etwas Besseres als eine Reihe von Excel f√ºr Code und Berechnung sowie E-Mails f√ºr die Erfassung und Benachrichtigung zu entwickeln. <br><br>  Anfangs gab es einige heftige Diskussionen dar√ºber, was wirklich, wirklich automatisch getan werden musste und die Berechnung der Indikatoren selbst unter Ber√ºcksichtigung aller ihrer Formeln und Datenquellen.  Angesichts der engen Fristen, der Komplexit√§t dieser Funktionen und der Notwendigkeit ihrer st√§ndigen Wartung im aktuellen Zustand konnten jedoch die folgenden Anforderungen an das System erf√ºllt werden: <br><br><ul><li>  Ein Referenzhandbuch mit Kriterien sollte aufbewahrt werden, um die Geschichte ihrer √Ñnderung zu bewahren. </li><li>  Es sollte m√∂glich sein, die berechneten Indikatoren sowie deren Umrechnung in Punkte wie auf derselben Platte einzugeben und zu speichern. </li><li>  Basierend auf den Werten der Indikatoren sollte ein Bericht erstellt werden, der allen interessierten Parteien zug√§nglich ist. </li><li>  All dies sollte nat√ºrlich mit einem Webinterface versehen sein. </li></ul><br>  Die Funktionalit√§t ist sehr klein, aber nicht viel Zeit. <br><br><h3>  Entwicklungsstart </h3><br>  Ich war immer von der schnellen Entwicklung und der automatischen Generierung von Schnittstellen angezogen.  In F√§llen, in denen die Implementierung der CRUD-Funktionalit√§t erforderlich ist, erscheint die Idee, wann die Schnittstelle und ein Teil der Gesch√§ftslogik sozusagen sofort bereitgestellt werden, sehr verlockend.  Nat√ºrlich wird die Schnittstelle eine unpr√§tenti√∂se und ungeschickte Logik sein, aber f√ºr viele Aufgaben ist dies ausreichend. <br><br>  Angetrieben von diesen Ideen beschloss ich, so etwas auszuprobieren.  Es gibt Spring Roo, Kuba und andere interessante Tools, aber die Wahl fiel auf OpenXava.  Erstens, nachdem ich bereits eine sehr einfache Anwendung darauf gemacht hatte und zufrieden war, und zweitens passte dieses Framework zu dieser Zeit recht erfolgreich in unseren technologischen Stack.  Dar√ºber hinaus ist es sehr erfreulich, ein kurzes Tutorial auf Russisch zu haben. <br><br>  Eine kurze Beschreibung der Funktionen und M√∂glichkeiten von OpenXava finden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">hier</a> .  OpenXava ist ein Framework, das den automatischen Aufbau einer Webschnittstelle implementiert, die in eine auf JPA basierende Datenbank integriert ist, und Anmerkungen zur Beschreibung von Visualisierungsregeln verwendet.  Die Anwendung basiert auf Gesch√§ftskomponenten - Java-Klassen, die die zum Erstellen von Anwendungen erforderlichen Informationen enthalten.  Zu diesen Informationen geh√∂ren Datenstruktur, Validatoren, g√ºltige Darstellungen und die Zuordnung zu Datenbanktabellen.  Vorg√§nge an Gesch√§ftskomponenten werden √ºber Controller ausgef√ºhrt, die CRUD aus einer Box erstellen, suchen, in PDF exportieren usw. k√∂nnen.  Die OpenXava-Anwendung bietet eine Reihe von Modulen.  Ein Modul ordnet eine Gesch√§ftskomponente einem oder mehreren Controllern zu.  F√ºr jede Gesch√§ftskomponente definierte Darstellungen werden zum Anzeigen der Schnittstelle verwendet.  Nichts ungew√∂hnliches, MVC mit etwas eigener Atmosph√§re. <br><br><h3>  Datenspeicherung </h3><br>  In den meisten Anwendungen verwenden wir IBM DB2 DBMS.  Es wurde eine kleine Datenbank erstellt, in der die Nachschlagewerke von Kriteriengruppen und Kriterien, anhand derer die Zweige bewertet werden, das Verzeichnis der Zweige und eine Platte gespeichert werden, in die die berechneten Werte der Kriterien eingegeben werden.  F√ºr jedes Kriterium wird zu einem bestimmten Zeitpunkt ein Koeffizient zugewiesen, der bei der Bewertung verwendet wird.  Jeder Zweig erh√§lt f√ºr jedes Kriterium eine Bewertung auch f√ºr ein bestimmtes Datum.  Daten zu den Werten der Kriterien werden historisch gespeichert, dh die f√ºr ein Datum relevanten Daten sind diejenigen, die am n√§chstgelegenen Datum in der Vergangenheit eingegeben wurden.  Dieser Ansatz, der von den Informationsregistern von 1C: Enterprise inspiriert wurde, scheint mir bequem genug zu sein: Es gibt eine Historie, und die Probleme beim Bearbeiten / L√∂schen sind nicht besonders hoch. <br><br><div class="spoiler">  <b class="spoiler_title">Datenbankstruktur</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> SUMMAR.CLS_DEPART ( <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GENERATED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>, PARENT_ID <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, IS_DELETED <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> SUMMAR.CLS_CRITERIA ( <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GENERATED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>, IS_DELETED <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> SUMMAR.CLS_GROUP_CRITERIA ( <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GENERATED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>, IS_DELETED <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">NAME</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> SUMMAR.REG_STATE_CRITERIA ( <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GENERATED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>, ID_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ID_GROUP_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, TIME_BEGIN <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, TIME_END <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'9999-12-31-23.59.59.000000000000'</span></span>, TIME_CREATE <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, KOEFFICIENT <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> FK_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (ID_CRITERIA) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> SUMMAR.CLS_CRITERIA(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> RESTRICT, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> FK_GROUP_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (ID_GROUP_CRITERIA) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> SUMMAR.CLS_GROUP_CRITERIA(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> RESTRICT ); <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> SUMMAR.REG_VALUE_CRITERIA ( <span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GENERATED</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IDENTITY</span></span>, ID_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ID_GROUP_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, ID_DEPART <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>, DATE_REG <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>(<span class="hljs-number"><span class="hljs-number">12</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, TIME_END <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-string"><span class="hljs-string">'9999-12-31-23.59.59.000000000000'</span></span>, TIME_BEGIN <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DEFAULT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CURRENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">PERCENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>), VAL <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>), PRIMARY <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>), <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> FK_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (ID_CRITERIA) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> SUMMAR.CLS_CRITERIA(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> RESTRICT, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> FK_DEPART <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (ID_DEPART) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> SUMMAR.CLS_DEPART(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> RESTRICT, <span class="hljs-keyword"><span class="hljs-keyword">CONSTRAINT</span></span> FK_GROUP_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">FOREIGN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">KEY</span></span> (ID_GROUP_CRITERIA) <span class="hljs-keyword"><span class="hljs-keyword">REFERENCES</span></span> SUMMAR.CLS_GROUP_CRITERIA(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">NO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> RESTRICT );</code> </pre> <br></div></div><br>  Um den begehrten Bericht √ºber die Leistung von Zweigen aus der Datenbank zu erhalten, wurden gespeicherte Funktionen erstellt, deren Ergebnisse bereits der Java-Klasse zugeordnet sind.  Funktionen sehen ungef√§hr so ‚Äã‚Äãaus. <br><div class="spoiler">  <b class="spoiler_title">Zuerst erhalten wir alle f√ºr das Datum g√ºltigen Kriterien sowie die f√ºr dieses Datum relevanten Kriterienkoeffizienten</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> SUMMAR.SLICE_STATE_ALL_CRITERIA ( PMAX_TIME <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">RETURNS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> ( ID_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>, ID_GROUP_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>, TIME_BEGIN <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, TIME_END <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, TIME_CREATE <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, KOEFFICIENT <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) ) <span class="hljs-keyword"><span class="hljs-keyword">LANGUAGE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SQL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> RSC.ID_CRITERIA, RSC.ID_GROUP_CRITERIA, RSC.TIME_BEGIN, RSC.TIME_END, RSC.TIME_CREATE, RSC.KOEFFICIENT <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SUMMAR.REG_STATE_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> RSC <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ID_CRITERIA, <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>(TIME_BEGIN) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> TIME_BEGIN <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> ID_CRITERIA, TIME_BEGIN <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SUMMAR.REG_STATE_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> TIME_BEGIN &lt; PMAX_TIME <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> TIME_END &gt; PMAX_TIME ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> SL <span class="hljs-keyword"><span class="hljs-keyword">GROUP</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> MAX_SLICE <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> RSC.ID_CRITERIA = MAX_SLICE.ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> RSC.TIME_BEGIN = MAX_SLICE.TIME_BEGIN ;</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Jetzt erhalten wir am selben Tag die Werte aller Kriterien f√ºr alle Branchen</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPLACE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FUNCTION</span></span> SUMMAR.SLICE_VALUE_ACTUAL_ALL_CRITERIA_ALL_DEPART_WITH_NAMES ( PMAX_TIME <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">RETURNS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> ( ID_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>, ID_GROUP_CRITERIA <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>, ID_DEPART <span class="hljs-built_in"><span class="hljs-built_in">BIGINT</span></span>, DATE_REG <span class="hljs-built_in"><span class="hljs-built_in">TIMESTAMP</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">PERCENT</span></span> <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), VAL <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), KOEFFICIENT <span class="hljs-built_in"><span class="hljs-built_in">DECIMAL</span></span>(<span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>), CRITERIA_NAME <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, CRITERIA_CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), GROUP_CRITERIA_NAME <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, GROUP_CRITERIA_CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), DEPART_NAME <span class="hljs-keyword"><span class="hljs-keyword">CLOB</span></span>, DEPART_CODE <span class="hljs-built_in"><span class="hljs-built_in">VARCHAR</span></span>(<span class="hljs-number"><span class="hljs-number">255</span></span>), DEPART_CODE_INT <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">LANGUAGE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SQL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> CDEP.ID_CRITERIA, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.ID_GROUP_CRITERIA, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ID_GROUP_CRITERIA, CDEP.ID_DEPART, VALS.DATE_REG, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.PERCENT, <span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PERCENT</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.VAL, <span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> VAL, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.KOEFFICIENT, <span class="hljs-number"><span class="hljs-number">0.0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> KOEFFICIENT, CDEP.CRITERIA_NAME, CDEP.CRITERIA_CODE, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.GROUP_CRITERIA_NAME, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> GROUP_CRITERIA_NAME, <span class="hljs-keyword"><span class="hljs-keyword">COALESCE</span></span>(VALS.GROUP_CRITERIA_CODE, <span class="hljs-string"><span class="hljs-string">''</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> GROUP_CRITERIA_CODE, CDEP.DEPART_NAME, CDEP.DEPART_CODE, CDEP.DEPART_CODE_INT <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> CCRT.ID <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ID_CRITERIA, CCRT.<span class="hljs-string"><span class="hljs-string">"NAME"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CRITERIA_NAME, CCRT.CODE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CRITERIA_CODE, CDEP.ID <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ID_DEPART, CDEP.<span class="hljs-string"><span class="hljs-string">"NAME"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DEPART_NAME, CDEP.CODE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DEPART_CODE, <span class="hljs-keyword"><span class="hljs-keyword">CAST</span></span> (CDEP.CODE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> <span class="hljs-built_in"><span class="hljs-built_in">INT</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> DEPART_CODE_INT <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SUMMAR.CLS_DEPART <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CDEP, ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> SUMMAR.CLS_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CC <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>(SUMMAR.SLICE_STATE_ALL_CRITERIA (PMAX_TIME)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ACTC <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> CC.ID = ACTC.ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> CC.IS_DELETED = <span class="hljs-number"><span class="hljs-number">0</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CCRT <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> CDEP.IS_DELETED = <span class="hljs-number"><span class="hljs-number">0</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CDEP <span class="hljs-keyword"><span class="hljs-keyword">LEFT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> ( <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> VALS.ID_CRITERIA, VALS.ID_GROUP_CRITERIA, VALS.ID_DEPART, VALS.DATE_REG, VALS.PERCENT, VALS.VAL, VALS.KOEFFICIENT, CGRT.<span class="hljs-string"><span class="hljs-string">"NAME"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> GROUP_CRITERIA_NAME, CGRT.CODE <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> GROUP_CRITERIA_CODE <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>(SUMMAR.SLICE_VALUE_ACTUAL_ALL_CRITERIA (PMAX_TIME)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> VALS <span class="hljs-keyword"><span class="hljs-keyword">INNER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">JOIN</span></span> SUMMAR.CLS_GROUP_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> CGRT <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> VALS.ID_GROUP_CRITERIA = CGRT.ID ) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> VALS <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> CDEP.ID_DEPART = VALS.ID_DEPART <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> CDEP.ID_CRITERIA = VALS.ID_CRITERIA ;</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">In der letzten Abfrage nummerieren wir die Werte der Indikatoren, ordnen sie und ermitteln das Minimum und Maximum. Dies wird ben√∂tigt, um Orte sp√§ter zu berechnen</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> ROW_NUMBER() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> ID_NUM, <span class="hljs-keyword"><span class="hljs-keyword">RANK</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VAL <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> RATING, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MAX</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">RANK</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VAL <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ) ) <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>() = <span class="hljs-keyword"><span class="hljs-keyword">RANK</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VAL <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> MAX_RATING, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">MIN</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">RANK</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VAL <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ) ) <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>() = <span class="hljs-keyword"><span class="hljs-keyword">RANK</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">OVER</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">PARTITION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> ID_CRITERIA <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VAL <span class="hljs-keyword"><span class="hljs-keyword">DESC</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ELSE</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> MIN_RATING, VALS.* <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>(SUMMAR.SLICE_VALUE_ACTUAL_ALL_CRITERIA_ALL_DEPART_WITH_NAMES (?)) <span class="hljs-keyword"><span class="hljs-keyword">AS</span></span> VALS <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> GROUP_CRITERIA_CODE, CRITERIA_CODE, DEPART_CODE_INT</code> </pre><br></div></div><br>  Die √úbertragung eines Teils der Gesch√§ftslogik in das DBMS ist durchaus gerechtfertigt, insbesondere wenn es darum geht, Daten f√ºr verschiedene Berichte vorzubereiten.  Es stellt sich heraus, dass die Operationen in einer pr√§ziseren und nat√ºrlicheren Form geschrieben werden k√∂nnen. In Java w√ºrden solche Manipulationen mit den Daten eine gr√∂√üere Menge an Code und einige Anstrengungen erfordern, um sie zu strukturieren.  Obwohl relativ komplexe oder nicht triviale Operationen in Java immer noch einfacher zu programmieren sind.  Daher wird in unserer Anwendung in Bezug auf die Datenabtastung ein Ansatz verwendet, bei dem die Verbindung von Datens√§tzen, Beschneidungsbedingungen und einige Operationen, die von Fensterfunktionen ausgef√ºhrt werden k√∂nnen, in gespeicherten Funktionen und Prozeduren ausgef√ºhrt werden und eine komplexere Logik in der Anwendung implementiert wird. <br><br><h3>  App </h3><br>  Wie gesagt, OpenXava wurde verwendet, um die Anwendung zu implementieren.  Um eine typische Schnittstelle und CRUD sofort einsatzbereit zu machen, m√ºssen Sie einige Aktionen ausf√ºhren. <br>  Zun√§chst m√ºssen Sie in web.xml den Filter und das Servlet des Addons beschreiben, das in der Anwendung navigiert: <br><br><div class="spoiler">  <b class="spoiler_title">web.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-app</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-class</span></span></span><span class="hljs-tag">&gt;</span></span>com.openxava.naviox.web.NaviOXFilter<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span>*.jsp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span>/modules/*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dispatcher</span></span></span><span class="hljs-tag">&gt;</span></span>REQUEST<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dispatcher</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dispatcher</span></span></span><span class="hljs-tag">&gt;</span></span>FORWARD<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dispatcher</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>module<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">filter-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-class</span></span></span><span class="hljs-tag">&gt;</span></span>com.openxava.naviox.web.NaviOXServlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>naviox<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span>/m/*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-app</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Als N√§chstes definieren wir in der Datei controller.xml die in der Anwendung verwendeten Controller.  In unserem Fall ist das Einfachste genug: <br><br><div class="spoiler">  <b class="spoiler_title">controller.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">controllers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">controller</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Typical_View"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extends</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">controller</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Navigation"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extends</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">controller</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CRUD"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">extends</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">controller</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ExtendedPrint"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">controller</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">controllers</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Der obige Controller kombiniert standardm√§√üig die Funktionen der in OpenXava enthaltenen Controller, deren Funktionen anhand der Namen leicht zu erraten sind. <br><br>  Und schlie√ülich verbinden wir in der Datei application.xml den erstellten Controller und das Modell.  Ungef√§hr so: <br><br><div class="spoiler">  <b class="spoiler_title">application.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"summar"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"RegValueCriteria"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">model</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"RegValueCriteria"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">controller</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Typical_View"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">module</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Wie oben erw√§hnt, basiert die Anwendung auf den Gesch√§ftskomponenten, aus denen das Anwendungsmodell besteht.  Betrachten Sie beispielsweise die RegValueCriteria-Komponente, die dem Controller in application.xml zugeordnet ist.  Diese Komponente beschreibt den Wert des Kriteriums f√ºr den Zweig (der K√ºrze halber bleibt nur die Beschreibung der Klassenfelder √ºbrig, und ich werde Methoden wie Getter und Setter weglassen): <br><br><div class="spoiler">  <b class="spoiler_title">Komponentenklasse</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Entity</span></span> <span class="hljs-meta"><span class="hljs-meta">@Table</span></span>(name = <span class="hljs-string"><span class="hljs-string">"REG_VALUE_CRITERIA"</span></span>, catalog = <span class="hljs-string"><span class="hljs-string">""</span></span>, schema = <span class="hljs-string"><span class="hljs-string">"SUMMAR"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@XmlRootElement</span></span> <span class="hljs-meta"><span class="hljs-meta">@Views</span></span>({ <span class="hljs-meta"><span class="hljs-meta">@View</span></span>(members = <span class="hljs-string"><span class="hljs-string">"idCriteria [idCriteria];"</span></span> + <span class="hljs-string"><span class="hljs-string">"idGroupCriteria [idGroupCriteria];"</span></span> + <span class="hljs-string"><span class="hljs-string">"idDepart [idDepart];"</span></span> + <span class="hljs-string"><span class="hljs-string">"data [dateReg, percent, val]"</span></span>), <span class="hljs-meta"><span class="hljs-meta">@View</span></span>(name=<span class="hljs-string"><span class="hljs-string">"massReg"</span></span>, members = <span class="hljs-string"><span class="hljs-string">"idDepart.name, percent, val"</span></span>) }) <span class="hljs-meta"><span class="hljs-meta">@Tab</span></span>(properties= <span class="hljs-string"><span class="hljs-string">"idDepart.name, idCriteria.name, idGroupCriteria.name, dateReg, percent, val"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RegValueCriteria</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Serializable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> serialVersionUID = <span class="hljs-number"><span class="hljs-number">1L</span></span>; <span class="hljs-meta"><span class="hljs-meta">@Id</span></span> <span class="hljs-meta"><span class="hljs-meta">@GeneratedValue</span></span>(strategy = GenerationType.IDENTITY) <span class="hljs-meta"><span class="hljs-meta">@Basic</span></span>(optional = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"ID"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Long id; <span class="hljs-meta"><span class="hljs-meta">@Basic</span></span>(optional = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@NotNull</span></span> <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"DATE_REG"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@Temporal</span></span>(TemporalType.TIMESTAMP) <span class="hljs-meta"><span class="hljs-meta">@DefaultValueCalculator</span></span>(CurrentDateCalculator.class) <span class="hljs-meta"><span class="hljs-meta">@Stereotype</span></span>(<span class="hljs-string"><span class="hljs-string">"DATETIME"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Date dateReg; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"PERCENT"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@OnChange</span></span>(OnChangePercentAction.class) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> BigDecimal percent; <span class="hljs-meta"><span class="hljs-meta">@Column</span></span>(name = <span class="hljs-string"><span class="hljs-string">"VAL"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> BigDecimal val; <span class="hljs-meta"><span class="hljs-meta">@JoinColumn</span></span>(name = <span class="hljs-string"><span class="hljs-string">"ID_CRITERIA"</span></span>, referencedColumnName = <span class="hljs-string"><span class="hljs-string">"ID"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@ManyToOne</span></span>(optional = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@DescriptionsList</span></span>( descriptionProperties=<span class="hljs-string"><span class="hljs-string">"name"</span></span> ) <span class="hljs-meta"><span class="hljs-meta">@OnChange</span></span>(OnChangeClsCriteriaAction.class) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ClsCriteria idCriteria; <span class="hljs-meta"><span class="hljs-meta">@JoinColumn</span></span>(name = <span class="hljs-string"><span class="hljs-string">"ID_GROUP_CRITERIA"</span></span>, referencedColumnName = <span class="hljs-string"><span class="hljs-string">"ID"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@ManyToOne</span></span>(optional = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@DescriptionsList</span></span>( descriptionProperties=<span class="hljs-string"><span class="hljs-string">"name"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ClsGroupCriteria idGroupCriteria; <span class="hljs-meta"><span class="hljs-meta">@JoinColumn</span></span>(name = <span class="hljs-string"><span class="hljs-string">"ID_DEPART"</span></span>, referencedColumnName = <span class="hljs-string"><span class="hljs-string">"ID"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@ManyToOne</span></span>(optional = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) <span class="hljs-meta"><span class="hljs-meta">@DescriptionsList</span></span>( descriptionProperties=<span class="hljs-string"><span class="hljs-string">"name"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ClsDepart idDepart; }</code> </pre> <br></div></div><br>  Zus√§tzlich zu den √ºblichen JPA-Anmerkungen.  Sie k√∂nnen auch OpenXava-Anmerkungen bemerken.  Sie sollten genauer betrachtet werden. <br><br>  Mit der <code>@View</code> k√∂nnen <code>@View</code> das Pr√§sentationsformat von Klassenfeldern steuern. Mithilfe einer speziellen Syntax in Form von eckigen Klammern k√∂nnen Felder zu Gruppen zusammengefasst und mithilfe von Symbolen horizontal und vertikal angeordnet werden <code>;</code>  .  Wenn f√ºr eine einzelne Komponente mehrere Zuordnungen angegeben werden m√ºssen, werden <code>@View</code> Annotationen mithilfe von <code>@View</code> <code>@View</code> Annotationen gruppiert.  In unserem Beispiel wurden die Eigenschaften wie folgt angeordnet: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@View</span></span>(members = <span class="hljs-string"><span class="hljs-string">"idCriteria [idCriteria];"</span></span> + <span class="hljs-string"><span class="hljs-string">"idGroupCriteria [idGroupCriteria];"</span></span> + <span class="hljs-string"><span class="hljs-string">"idDepart [idDepart];"</span></span> + <span class="hljs-string"><span class="hljs-string">"data [dateReg, percent, val]"</span></span>)</code> </pre> <br>  Und es sieht so aus: <br><br><img src="https://habrastorage.org/webt/nh/5m/ss/nh5msssvc0-xft3prl99emnw1-e.png"><br><br>  Unpr√§tenti√∂s, aber mit minimalem Aufwand.  Es gibt jedoch M√∂glichkeiten, die Form ein wenig wiederzubeleben. <br>  Damit das Registrierungsdatum beim Erstellen der Komponente <code>@DefaultValueCalculator</code> wird, wird die Annotation <code>@DefaultValueCalculator</code> , die ein spezielles <code>@DefaultValueCalculator</code> aufruft.  Hier wird ein Taschenrechner von OpenXava selbst verwendet, Sie k√∂nnen jedoch auch einen benutzerdefinierten erstellen.  Die Annotation <code>@Stereotype</code> wird verwendet, um das Datum mit dem entsprechenden Steuerelement anzuzeigen. <br><br>  Zum Konfigurieren von Dropdown-Listen mit verwandten Objekten wird die Annotation <code>@DescriptionsList</code> , in der Sie angeben k√∂nnen, welche Eigenschaft in der Liste angezeigt werden soll. <br><br>  Mithilfe von Anmerkungen k√∂nnen Sie eine Gesch√§ftslogik des Formulars selbst implementieren.  Wenn sich beispielsweise der Prozentsatz √§ndert und der Wert automatisch unter Ber√ºcksichtigung des Koeffizienten des Kriteriums berechnet wird, k√∂nnen Sie die Annotation <code>@OnChange</code> f√ºr das Feld <code>BigDecimal val</code> anwenden.  Damit die Annotation <code>@OnChange</code> funktioniert, muss sie auf die Klasse verweisen, die die <code>OnChangePropertyBaseAction</code> Schnittstelle implementiert.  In der Klasse sollte eine einzelne <code>execute()</code> -Methode implementiert werden, in der die Eingabedaten aus der Ansicht entnommen, die Berechnung durchgef√ºhrt und der berechnete Wert in die Ansicht zur√ºckgeschrieben werden: <br><br><div class="spoiler">  <b class="spoiler_title">Untergeordnete Klasse OnChangePropertyBaseAction</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnChangePercentAction</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnChangePropertyBaseAction</span></span></span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ BigDecimal percent = (BigDecimal)getNewValue(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (percent != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ Map value = (Map)getView().getValue(<span class="hljs-string"><span class="hljs-string">"idCriteria"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ Long idCriteria = (Long)value.get(<span class="hljs-string"><span class="hljs-string">"id"</span></span>); Query query = XPersistence.getManager().createNativeQuery( <span class="hljs-string"><span class="hljs-string">"SELECT KOEFFICIENT FROM SUMMAR.SLCLA_STATE_CRITERIA WHERE ID_CRITERIA = ?"</span></span>); query.setParameter(<span class="hljs-number"><span class="hljs-number">1</span></span>, idCriteria); List&lt;?&gt; list = query.getResultList(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (list != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; !list.isEmpty()){ BigDecimal koef = (BigDecimal) list.get(<span class="hljs-number"><span class="hljs-number">0</span></span>); BigDecimal vl = koef.multiply(percent); getView().setValue(<span class="hljs-string"><span class="hljs-string">"val"</span></span>, vl); } } } } }</code> </pre> <br></div></div><br>  F√ºr eine tabellarische Darstellung von Daten wird die Annotation <code>@Tab</code> , mit der Sie die Eigenschaften von Objekten <code>@Tab</code> , die in einer tabellarischen Darstellung angezeigt werden.  In unserem Beispiel wurde die Anmerkung wie folgt umrahmt: <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Tab</span></span>(properties= <span class="hljs-string"><span class="hljs-string">"idDepart.name, idCriteria.name, idGroupCriteria.name, dateReg, percent, val"</span></span> )</code> </pre> <br>  Es wird wie folgt aussehen <br><br><img src="https://habrastorage.org/webt/hb/ps/vs/hbpsvs9i46ue1abfxabexohsnni.png"><br><br>  Erfreut √ºber die Verf√ºgbarkeit von Filtern, die Paginierung und den sofortigen Export. Viele Details m√ºssen jedoch mit einer Datei verfeinert werden. <br><br>  Die Arbeit mit anderen Komponenten ist √§hnlich aufgebaut.  Durch die Verwendung von OpenXava konnten die Arbeitskosten f√ºr die Implementierung von CRUD-Funktionen und den gr√∂√üten Teil der Benutzeroberfl√§che drastisch gesenkt werden.  Die Verwendung von Aktionen von vordefinierten Controllern und Anmerkungen zum Erstellen von Formularen spart erheblich Zeit, wenn Sie nicht √ºber die Details streiten und versuchen, etwas Komplizierteres als das Eingabeformular mit mehreren Ereignissen zu implementieren.  Obwohl es in der Erfahrung der Fall sein kann. <br><br><h3>  Worum es ging </h3><br>  Erinnerst du dich, was die App vorhatte?  Ja, damit die Platte mit den Indikatoren in Excel nicht heldenhaft reduziert wird, sondern automatisch anhand der eingegebenen Daten erstellt wird.  Im Browserfenster sah die Pivot-Tabelle folgenderma√üen aus: <br><br><img src="https://habrastorage.org/webt/sm/x_/v1/smx_v17og5oi-ube78ymyhosnie.png"><br><img src="https://habrastorage.org/webt/26/sz/45/26sz45etsyy1jldlfoqff7034zg.png"><br><br>  Ich werde keine Details zur Implementierung geben, da nicht alles sehr gut damit ist und die Mischung aus JSP und HTML, die beim Anfordern von Daten generiert wird, nicht f√ºr die breite √ñffentlichkeit zug√§nglich ist.  Gleichzeitig wurde oben die Datenerfassung selbst demonstriert. <br><br>  Ich m√∂chte jedoch auf ein interessantes Detail eingehen.  Als die Anforderungen f√ºr den Antrag erfasst wurden, wollte das Management wirklich, dass zus√§tzlich zum zusammenfassenden Bericht die Werte eines einzelnen Indikators in Form einer Karte der Region angezeigt werden, die in Regionen mit Angabe des Standorts und der Punktzahl der entsprechenden Niederlassung unterteilt ist.  Wer hat die Region auf der Karte erkannt - gut gemacht =) <br><br><img src="https://habrastorage.org/webt/ip/8t/a-/ip8ta-wuufxirkycdn_kohxqqkc.png"><br><br>  Einerseits war die Anforderung optional, andererseits versprach das Bild visuell zu sein, und aus Sicht der Implementierung war es interessant, es zu versuchen.  Nach einigem √úberlegen kam die Idee auf, das Bild der Region im SVG-Format zu finden und daraus eine XSLT-Vorlage zu erstellen. <br><br>  Die resultierende Vorlage kann leicht mit Daten gef√ºllt und anschlie√üend in PNG konvertiert werden. <br>  Zun√§chst werden unter Verwendung der oben beschriebenen Abfrage Daten abgetastet und die empfangenen Daten in ein Objekt dieser Klasse konvertiert: <br><br><div class="spoiler">  <b class="spoiler_title">Klassen zur Ausgabe von Daten auf eine Karte</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@XmlRootElement</span></span> <span class="hljs-meta"><span class="hljs-meta">@XmlAccessorType</span></span>(XmlAccessType.FIELD) <span class="hljs-meta"><span class="hljs-meta">@XmlType</span></span>(name = <span class="hljs-string"><span class="hljs-string">"VisualisedValuesCriteria"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VisualisedValuesCriteria</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> XMLGregorianCalendar date; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String criteriaName; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String koefficient; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> List&lt;VisualizedValueCriteria&gt; departValues; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> XMLGregorianCalendar </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> date; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XMLGregorianCalendar date)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.date = date; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCriteriaName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> criteriaName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setCriteriaName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String criteriaName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.criteriaName = criteriaName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getKoefficient</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> koefficient; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setKoefficient</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String koefficient)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.koefficient = koefficient; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;VisualizedValueCriteria&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDepartValues</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (departValues == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ departValues = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> departValues; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDepartValues</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;VisualizedValueCriteria&gt; departValues)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.departValues = departValues; } } <span class="hljs-meta"><span class="hljs-meta">@XmlRootElement</span></span> <span class="hljs-meta"><span class="hljs-meta">@XmlAccessorType</span></span>(XmlAccessType.FIELD) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VisualizedValueCriteria</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String departName; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String departCode; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String value; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String percent; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String colorCode; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDepartName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> departName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDepartName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String departName)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.departName = departName; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDepartCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> departCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setDepartCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String departCode)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.departCode = departCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setValue</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String value)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.value = value; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPercent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> percent; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setPercent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String percent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.percent = percent; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getColorCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> colorCode; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setColorCode</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String colorCode)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.colorCode = colorCode; } } }</code> </pre> <br></div></div><br>  Konvertieren Sie als N√§chstes das Objekt in XML. <br><br><div class="spoiler">  <b class="spoiler_title">Konvertierung</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">Private String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">marshal</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(VisualisedValuesCriteria obj)</span></span></span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Marshaller marshaller = JAXBContext.newInstance(VisualisedValuesCriteria.class).createMarshaller(); marshaller.setEventHandler(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DefaultValidationEventHandler()); marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); StringWriter writer = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringWriter(); marshaller.marshal(obj, writer); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> writer.toString(); }</code> </pre> <br></div></div><br>  Nehmen wir nun das resultierende XML, die vorbereitete XSLT-Vorlage, wenden die Konvertierung an und erhalten svg in der Ausgabe: <br><br><div class="spoiler">  <b class="spoiler_title">Holen Sie sich svg</b> <div class="spoiler_text"><pre> <code class="java hljs"> String xml = marshal(obj); TransformerFactory factory = TransformerFactory.newInstance(); FileInputStream xsltFis = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileInputStream(<span class="hljs-string"><span class="hljs-string">"C:\\TEMP\\map_xsl.svg"</span></span>); InputStreamReader xsltIn = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> InputStreamReader(xsltFis, <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span>); Source xslt = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamSource(xsltIn); Transformer transformer = factory.newTransformer(xslt); InputStream xmlIn = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ByteArrayInputStream( xml.getBytes( <span class="hljs-string"><span class="hljs-string">"UTF-8"</span></span> ) ); Source text = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamSource(xmlIn); String filename = <span class="hljs-string"><span class="hljs-string">"map"</span></span> + System.currentTimeMillis() + <span class="hljs-string"><span class="hljs-string">".svg"</span></span>; String filePath = <span class="hljs-string"><span class="hljs-string">"C:\\TEMP\\"</span></span> + filename; transformer.transform(text, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StreamResult(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(filePath)));</code> </pre> <br></div></div><br>  Im Prinzip k√∂nnten wir hier aufh√∂ren, Browser zeigen SVG ohne Probleme an.  Die beschriebenen Berichte wurden jedoch auch √ºber den Telegramm-Bot abgerufen, sodass SVG in ein Format wie JPEG oder PNG konvertiert werden muss.  Verwenden Sie dazu <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Apache Batik</a> <br><br><div class="spoiler">  <b class="spoiler_title">In PNG konvertieren</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">convertToPNG</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String svg, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String filename, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String filePath)</span></span></span></span>{ String png = filePath + filename + <span class="hljs-string"><span class="hljs-string">".png"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { PNGTranscoder trancoder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PNGTranscoder(); String svgURI = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(svg).toURL().toString(); TranscoderInput input = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TranscoderInput(svgURI); OutputStream ostream = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileOutputStream(png); TranscoderOutput output = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TranscoderOutput(ostream); trancoder.transcode(input, output); ostream.flush(); ostream.close(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> filename + <span class="hljs-string"><span class="hljs-string">".png"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (MalformedURLException ex) { Logger.getLogger(ActualCriteriaValueGraphicServlet.class.getName()).log(Level.SEVERE, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ex); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (FileNotFoundException | TranscoderException ex) { Logger.getLogger(ActualCriteriaValueGraphicServlet.class.getName()).log(Level.SEVERE, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ex); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException ex) { Logger.getLogger(ActualCriteriaValueGraphicServlet.class.getName()).log(Level.SEVERE, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, ex); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }</code> </pre><br></div></div><br>  Der Bericht in Form einer Karte ist fertig.  Es kann auch √ºber den Browser angezeigt und vom Telegramm-Bot angefordert werden.  Meiner Meinung nach nicht schlecht. <br><br><h3>  Fazit </h3><br>  Zum festgelegten Zeitpunkt hatten wir Zeit und bereits im M√§rz 2017 wurden regelm√§√üig Leistungsindikatoren anstelle von Excel in das erstellte System eingegeben.  Einerseits wurde das maximale Problem nicht gel√∂st, der schwierigste Teil der Berechnung der Indikatoren erfolgt manuell.  Andererseits birgt die Durchf√ºhrung dieser Berechnungen das Risiko einer st√§ndigen Verfeinerung.  Dar√ºber hinaus hat selbst die erstellte einfache Oberfl√§che zum Sammeln von Daten eine Vielzahl von Fragen mit st√§ndigen √Ñnderungen, Versionskontrolle und einer Zusammenfassung der Excel-Tabelle entfernt.  Eine gro√üe Anzahl von manuellen Arbeiten, √úberpr√ºfungen und Gegenpr√ºfungen wurde entfernt. <br><br>  Es ist unm√∂glich nicht zu sagen, dass die Oberfl√§che von Open Xav den Benutzern nicht allzu angenehm war.  Anfangs gab es viele Fragen zu seinen Funktionen.  Irgendwann beschwerten sich die Benutzer dar√ºber, dass die Eingabe von Daten zu lange dauerte und im Allgemeinen ‚Äûwir wollen, wie in Excel, nur ein Programm‚Äú.  Ich musste sogar die Eingabegeschwindigkeit anhand von Daten zum Zeitpunkt der Erstellung von Datens√§tzen √ºberwachen.  Diese √úberwachung ergab, dass Benutzer selbst in den schwerwiegendsten F√§llen nicht mehr als 15 Minuten f√ºr die Eingabe aufgewendet haben, sondern in der Regel in 5-7 passen, obwohl sie Daten in 22 Filialen eingeben mussten.  Solche Indikatoren scheinen durchaus akzeptabel. <br><br>  Ich m√∂chte jedoch zwei Dinge beachten: <br><br><ol><li>  Open Xava erwies sich als gutes Werkzeug zum schnellen Erstellen einer Benutzeroberfl√§che.  Ich w√ºrde sogar eine Prototyp-Schnittstelle sagen.  Auch sein unbestrittener Vorteil ist die allgemeine Ordnung und Regelm√§√üigkeit.  Alle Formulare in der Anwendung werden nach einheitlichen Grunds√§tzen erstellt, sodass der Entwickler keine Fahrr√§der entwickeln kann, bei denen er sie nicht ben√∂tigt, sondern der Benutzer sich mit Standardformularen befassen muss.  Versuche, eine komplexere Logik zu implementieren oder die Steuerelemente f√ºr uns selbst zu √§ndern, f√ºhrten uns jedoch zu einer Reihe von Problemen, die wir in der vorgegebenen Zeit nicht bew√§ltigen konnten.  H√∂chstwahrscheinlich haben wir es einfach nicht verstanden und das Ziel war es, mit minimalem Aufwand eine einfache CRUD-Schnittstelle zu erstellen.  Ich komme zu dem Schluss, dass Open Xava ein interessantes Tool ist, mit dem es einfach ist, einfache Dinge zu tun. Wenn Sie jedoch etwas Kompliziertes tun m√ºssen, w√ºrde ich lieber mehr Zeit damit verbringen, den Client-Teil mit ExtJS oder React zu erstellen, aber mehr Flexibilit√§t zu haben . </li><li>  Selbst selbstbewusste Benutzer nehmen neue Schnittstellen schwer.  Das ist nat√ºrlich kein Geheimnis.  Meiner Meinung nach ist dies haupts√§chlich auf ein mangelndes Verst√§ndnis der systemischen Natur vieler Schnittstellen zur√ºckzuf√ºhren.  F√ºr viele hat jede Anwendung eine Reihe von Bildschirmen, von denen jeder einzigartig ist und nach ihren eigenen unbekannten Prinzipien arbeitet: Zum Beispiel gibt es ein Formular mit einer Liste von Objekten / Zeilen (Listenformular), aber f√ºr so viele Benutzer ist es keineswegs offensichtlich, dass jedes dieser Formulare in der Anwendung vorhanden sein kann Gleichm√§√üiges Filtern, Paginieren, Sortieren und im Allgemeinen das gleiche Verhalten, erg√§nzt durch spezifische Funktionen.  Hinzu kommt, dass eine gro√üe Anzahl von Unternehmenssoftware ein fast spontaner Stapel von Schaltfl√§chen und Formularen ist, der mit einer undeutlichen Dokumentation im Stil von "Klicken Sie auf diese Schaltfl√§che" versehen ist.  Unter diesem Gesichtspunkt sorgen die von denselben Open Xav-Benutzerbenutzern erstellten Schnittstellen f√ºr mehr Ordnung im Kopf.  Bei diesem Ansatz verschwinden die magischen Kn√∂pfe zwar nirgendwo, sondern werden ordentlich in Formen angeordnet. </li></ol><br>  Wenn wir √ºber die Vorteile f√ºr die gesamte Organisation sprechen, hat sich der Kontrollgrad nach Einf√ºhrung der Anwendung erwartungsgem√§√ü erh√∂ht.  Die Feldleiter erhielten ein Tool zur √úberwachung von Indikatoren, mit dem sie die Arbeit in einem betriebsf√§higeren Modus beeinflussen und Indikatoren f√ºr verschiedene Zeitr√§ume vergleichen k√∂nnen, ohne mit dem Fluss der gesendeten Dateien verwechselt zu werden.  Das Interesse der F√ºhrungskr√§fte an der st√§ndigen und aufmerksamen √úberwachung ihrer Niederlassung wurde von uns auf sehr interessante Weise entdeckt: Beim Durchsuchen der Telegramm-Bot-Protokolle stellten wir fest, dass einige Berichte um 4 oder 5 Uhr morgens eingingen.  Sie sehen sofort, wer sich f√ºr Arbeit interessiert. <br><br>  Das ist alles.  F√ºr das konstruktive Feedback w√§re ich dankbar! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de423919/">https://habr.com/ru/post/de423919/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de423897/index.html">N√ºtzliche Tipps zur Verwendung des HyperLynx DDR-Assistenten f√ºr die QDR4-Analyse</a></li>
<li><a href="../de423901/index.html">Wenn Geschwindigkeit und Skalierung ben√∂tigt werden: Server von verteilten iOS-Ger√§ten</a></li>
<li><a href="../de423903/index.html">Eintauchen in AD: Wir analysieren erweiterte Angriffe auf Microsoft Active Directory und wie sie erkannt werden</a></li>
<li><a href="../de423905/index.html">Die Entwickler blieben unbekannt. Yandex Vortrag</a></li>
<li><a href="../de423911/index.html">Die Siliziumphotonik stolpert √ºber den letzten Meter</a></li>
<li><a href="../de423921/index.html">10 Jahre Android: Erinnere dich an alles</a></li>
<li><a href="../de423923/index.html">SAP Leonardo Hackathon von velcom und SAP f√ºr Entwickler aus Wei√ürussland</a></li>
<li><a href="../de423925/index.html">Offenes Webinar "Seltsame rekursive Vorlage"</a></li>
<li><a href="../de423927/index.html">10 vielversprechende Suchmaschinen zur Verbesserung der SEO</a></li>
<li><a href="../de423931/index.html">Wie kann ich die SMS-Authentifizierung umgehen, wenn ich eine Verbindung zu √∂ffentlichen Wi-Fi-Netzwerken herstelle?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>