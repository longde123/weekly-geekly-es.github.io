<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üçé üõÖ ‚¨áÔ∏è Infraestructura de clave p√∫blica (continuaci√≥n): Autoridad de certificaci√≥n basada en OpenSSL y SQLite3 üë©üèæ‚Äçüåæ üëçüèº ü§ôüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Si uno de los principales objetos de la infraestructura de clave p√∫blica (PKI) son los certificados X509, entonces el tema central de la PKI son las A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Infraestructura de clave p√∫blica (continuaci√≥n): Autoridad de certificaci√≥n basada en OpenSSL y SQLite3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/413493/"><img src="https://habrastorage.org/webt/60/9k/sk/609ksklwykcs1xqbwuoyvqw7wg8.png" align="left" alt="imagen">  Si uno de los principales objetos de la infraestructura de clave p√∫blica (PKI) son los certificados X509, entonces el tema central de la PKI son las Autoridades de Certificaci√≥n (CA).  Es la entidad emisora ‚Äã‚Äãde certificados la que emite certificados, rescinde su validez (revocaci√≥n de certificados) y confirma su validez.  En las p√°ginas de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Habrahabr,</a> puede encontrar varias publicaciones sobre el tema de los certificados digitales utilizando <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">OpenSSL</a> . <a name="habracut"></a>  B√°sicamente, estos art√≠culos discuten el uso <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">de la utilidad openssl</a> , describen su interfaz de l√≠nea de comandos y trabajan con archivos que almacenan todo: claves, solicitudes, certificados, incluida la ra√≠z, etc.  Pero si desarrolla un centro de certificaci√≥n (CA) a gran escala basado en OpenSSL, entonces es natural querer deshacerse de esta variedad de archivos y trabajar con bases de datos, adem√°s de tener una interfaz gr√°fica para emitir y administrar certificados.  Y si recuerdan la Ley Federal del 6 de abril de 2011.  No. 63- En firmas electr√≥nicas, es necesario que la CA cumpla con los requisitos de esta ley, as√≠ como con los Requisitos para el Formulario de Certificado Calificado de un Certificado de Clave de Verificaci√≥n de Firma Electr√≥nica, aprobado por Orden del Servicio Federal de Seguridad de Rusia del 27 de diciembre de 2011 No. 795. <br><br>  Los ciudadanos comunes tienen la impresi√≥n de que los UT son algo enorme (bueno, el Centro, casi como el Centro de Control de la Misi√≥n). <br><br><img src="https://habrastorage.org/webt/b5/3v/g7/b53vg7cflxhkndwjyavz3ppfcuy.png" align="right" alt="imagen">  Desde el punto de vista de la responsabilidad de la AC, esto es exactamente as√≠.  Despu√©s de todo, los certificados emitidos por la CA son realmente iguales en el pasaporte de hoy. <br><br>  Desde el punto de vista de un programador, no todo es tan aterrador.  As√≠ naci√≥ el proyecto del centro de certificaci√≥n CAFL63.  La implementaci√≥n del proyecto CAFL63 se basa en tres "pilares", a saber, OpenSSL, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SQLite3</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Tcl / Tk</a> . <br><br>  Entonces, ¬øqu√© es una autoridad de certificaci√≥n hoy?  En primer lugar, es el Centro de registro, donde los representantes de las personas jur√≠dicas, las personas y los empresarios individuales obtienen certificados con un paquete de documentos necesarios, en particular, que identifican la identidad y la autoridad del solicitante.  Pueden venir con aplicaciones preparadas electr√≥nicamente.  El CR verifica los documentos, la solicitud (datos completados, la exactitud de la firma electr√≥nica, etc.), y si todo va bien, acepte la solicitud, apruebe y env√≠ela al Centro de Certificaci√≥n (CA).  Pero esto es ideal.  En la pr√°ctica, todo se ve diferente. <br><br>  Los ciudadanos, las organizaciones necesitan un certificado (para acceder al portal de Servicios del Estado, para informar impuestos, para licitar), pero no saben qu√© es y qu√© hacer con √©l.  Est√°n sinceramente convencidos de que la CA recibe una firma electr√≥nica como un facs√≠mil.  Pero estos son problemas de iluminaci√≥n.  Por lo tanto, los solicitantes acuden a la Administraci√≥n Central de la Administraci√≥n Central y presentan los documentos.  Junto con el empleado de la Oficina Central, van a un lugar de trabajo separado y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">preparan una solicitud de</a> certificado: <br><br><img src="https://habrastorage.org/webt/-i/ni/fr/-inifrinlnabszqrmm9w11vpz98.png"><br><br>  El CR recibe una solicitud preparada en medios electr√≥nicos, como ya se mencion√≥.  ¬øQu√© necesita recordar el solicitante?  En primer lugar, ¬°elija los medios con la clave privada creada! <br>  Una solicitud aprobada en medios electr√≥nicos se transmite a la CA, donde se emitir√° un certificado sobre la base. <br><br>  Este es un diagrama esquem√°tico del trabajo de la AC.  Los detalles se aclarar√°n a continuaci√≥n.  Una observaci√≥n, para la conveniencia de la demostraci√≥n, la utilidad para preparar una solicitud, CR y CA se combinan en un complejo de demostraci√≥n.  Pero no hay problemas con la diversidad funcional.  La m√°s simple de ellas es tener una instancia CAFL63 en cada lugar de trabajo y usar solo la funcionalidad requerida. <br><br>  Cuando el proyecto estaba en pleno apogeo, el proyecto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SimpleCA</a> me llam√≥ la atenci√≥n.  Estudiar este proyecto ayud√≥ mucho con la implementaci√≥n final de CAFL63 CA. <br><br>  Puede encontrar el c√≥digo fuente de la utilidad y sus distribuciones para las plataformas Linux y MS Windows <div class="spoiler">  <b class="spoiler_title">aqui:</b> <div class="spoiler_text"><ul><li>  <a href="">c√≥digo fuente</a> </li><li>  <a href="">Linux32</a> </li><li>  <a href="">Linux64</a> </li><li>  <a href="">WIN32</a> </li><li>  <a href="">WIN64</a> </li></ul><br></div></div><br>  Entonces, ejecute la utilidad CAFL63 y la p√°gina de inicio aparece en la pantalla: <br><br><img src="https://habrastorage.org/webt/ej/d4/6z/ejd46z3sdsymivi7ougryho9q-g.png"><br><br>  Comenzamos el trabajo presionando la tecla "Crear base de datos".  La base de datos de CA se crea utilizando DBMS multiplataforma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">SQLite3</a> .  La base de datos de CA contiene varias tablas.  La tabla principal mainDB contiene solo un registro, que almacena el certificado ra√≠z, la clave privada cifrada con una contrase√±a y la configuraci√≥n de CA.  Hay dos tablas relacionadas con las solicitudes de certificados: solicitudes actuales de reqDB y archivo de solicitudes de reqDBArc.  Se crean tres tablas para certificados: la tabla de nuevos certificados certDBNew, la tabla del archivo de certificados certDB y la tabla de certificados revocados certDBRev: <br><br><pre><code class="sql hljs">. . . certdb eval {<span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> certDB( ckaID <span class="hljs-built_in"><span class="hljs-built_in">text</span></span> primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> , nick <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, sernum <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, certPEM <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, subject <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, notAfter <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, notBefore <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, dateRevoke <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, state <span class="hljs-built_in"><span class="hljs-built_in">text</span></span> )} certdb eval {<span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> certDBRev( ckaID <span class="hljs-built_in"><span class="hljs-built_in">text</span></span> primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> )} certdb eval {<span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> certDBNew( ckaID <span class="hljs-built_in"><span class="hljs-built_in">text</span></span> primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> )} certdb eval {<span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> reqDB (ckaID <span class="hljs-built_in"><span class="hljs-built_in">text</span></span> primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>, nick <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, sernum <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, subject <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, datereq <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">status</span></span> <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, reqpem <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, pkcs7 <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>)} certdb eval {<span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> reqDBAr (ckaID <span class="hljs-built_in"><span class="hljs-built_in">text</span></span> primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span>, nick <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, sernum <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, subject <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, datereq <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">status</span></span> <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, reqpem <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, pkcs7 <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>)} certdb eval {<span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> crlDB(<span class="hljs-keyword"><span class="hljs-keyword">ID</span></span> <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> primary <span class="hljs-keyword"><span class="hljs-keyword">key</span></span> autoincrement, signtype <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, issuer <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, publishdate <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, nextdate <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>, crlpem <span class="hljs-built_in"><span class="hljs-built_in">text</span></span>)} . . .</code> </pre> <br>  Todas las tablas de solicitud y certificado utilizan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">el valor hash</a> (sha1) de la clave p√∫blica como clave (clave primaria).  Por conveniencia, en el futuro, el valor hash del valor de la clave p√∫blica se llamar√° CKAID (terminolog√≠a PKCS # 11).  Esto result√≥ ser muy conveniente, por ejemplo, cuando se busca un certificado a pedido o viceversa.  Hay otra tabla crlDB en la base de datos que almacena listas de certificados revocados. <br><br>  El valor de la clave p√∫blica se almacena tanto en la solicitud como en el certificado.  Por lo tanto, antes de ponerlos en la base de datos, es necesario extraerles la clave p√∫blica y calcular el CKAID.  Para extraer el valor de la clave p√∫blica, es conveniente utilizar el paquete pki (el paquete requiere pki), que contiene herramientas para trabajar con certificados y solicitudes.  Sin embargo, este paquete no est√° dise√±ado para funcionar con la criptograf√≠a rusa.  En este sentido, seg√∫n los procedimientos parse_cert y parse_csr incluidos en el paquete pki, escriba los procedimientos parce_cert_gost y parse_csr_gost: <br><br><pre> <code class="plaintext hljs">... ## Convert Pubkey type to string set pubkey_type [::pki::_oid_number_to_name $pubkey_type] # Parse public key, based on type switch -- $pubkey_type { "rsaEncryption" { set pubkey [binary format B* $pubkey] binary scan $pubkey H* ret(pubkey) ::asn::asnGetSequence pubkey pubkey_parts ::asn::asnGetBigInteger pubkey_parts ret(n) ::asn::asnGetBigInteger pubkey_parts ret(e) set ret(n) [::math::bignum::tostr $ret(n)] set ret(e) [::math::bignum::tostr $ret(e)] set ret(l) [expr {int([::pki::_bits $ret(n)] / 8.0000 + 0.5) * 8}] set ret(type) rsa } "1.2.643.2.2.19" - "1.2.643.7.1.1.1.1" - "1.2.643.7.1.1.1.2" { # gost2001, gost2012-256,gost2012-512 set pubkey [binary format B* $pubkey] binary scan $pubkey H* ret(pubkey) set ret(type) $pubkey_type ::asn::asnGetSequence pubkey_algoid pubalgost #OID -  ::asn::asnGetObjectIdentifier pubalgost oid1 #OID -   ::asn::asnGetObjectIdentifier pubalgost oid2 } default { error "Unknown algorithm" } } ...</code> </pre> <br>  A diferencia de los procedimientos "nativos", le permiten trabajar con objetos no solo en formato PEM, sino tambi√©n en formato DER.  Para trabajar con listas de revocaci√≥n de certificados CRL, se escribi√≥ el procedimiento parse_crl.  Todos estos procedimientos se pueden encontrar en el c√≥digo fuente, que se almacena con la distribuci√≥n. <br><br>  Tambi√©n en el paquete pki no hay oid-s rusos, por ejemplo, TIN, SNILS, etc.  Este problema se resuelve f√°cilmente agregando oid-s rusos a la matriz :: pki :: oids: <br><br><pre> <code class="plaintext hljs">. . . set ::pki::oids(1.2.643.100.1) "OGRN" set ::pki::oids(1.2.643.100.5) "OGRNIP" set ::pki::oids(1.2.643.3.131.1.1) "INN" set ::pki::oids(1.2.643.100.3) "SNILS" #  set ::pki::oids(1.2.643.2.2.3) "  34.10-2001" set ::pki::oids(1.2.643.7.1.1.3.2) "  34.10-2012-256" set ::pki::oids(1.2.643.7.1.1.3.3) "  34.10-2012-512" . . .</code> </pre> <br>  Teniendo las funciones parse_cert_gost y parse_csr_gost, los valores de CKAID (clave primaria para la base de datos) se calculan de la siguiente manera: <br><br><pre> <code class="plaintext hljs">. . . array set b [parse_csr_gost $req] set pem $b(pem) set subject $b(subject) set pubkey $b(pubkey) set key1 [binary format H* $pubkey] set ckaID [::sha1::sha1 $key1] . . .</code> </pre> <br>  Entonces, haga clic en el bot√≥n "Crear base de datos": <br><br><img src="https://habrastorage.org/webt/fj/uh/3q/fjuh3qvrwugzxspgjchbonu9is0.png"><br><br>  La creaci√≥n de CA comienza con la elecci√≥n del directorio en el que almacenaremos la configuraci√≥n de la base de datos y la contrase√±a para acceder a la clave privada de CA.  La utilidad CAFL63 monitorea cuidadosamente la longitud de la contrase√±a: <br><br><img src="https://habrastorage.org/webt/dw/eb/hf/dwebhfn5hqfjh8bv3jge5jxllx8.png"><br><br>  La contrase√±a se almacena en la base de datos de CA como un hash: <br><br><pre> <code class="plaintext hljs">. . . set hash256 [::sha2::sha256 $wizData(capassword)] . . .</code> </pre> <br>  Despu√©s de presionar la tecla "Trace", comienza el proceso de formar un certificado ra√≠z autofirmado de la CA implementada.  En el primer paso de este proceso, se seleccionan el tipo y los par√°metros del par de claves: <br><br><img src="https://habrastorage.org/webt/zr/e4/ag/zre4agh8ilw-tvjiy354y_o337c.png"><br><br>  Una vez decidido el par de claves para el certificado ra√≠z del centro de certificaci√≥n creado, procedemos a completar el formulario con informaci√≥n sobre el propietario (falta la primera captura de pantalla). <br><br>  Tenga en cuenta que la utilidad CAFL63 tiene una cierta "inteligencia" y, por lo tanto, controla no solo la disponibilidad de datos en los campos, sino tambi√©n la correcci√≥n (resaltado en rojo - incorrecto) de completar campos como TIN, PSRN, SNILS, PSRNIP, direcci√≥n de correo electr√≥nico, etc. <br><br><img src="https://habrastorage.org/webt/4o/pt/vr/4optvrvc8o6gfd413eh5ggshby4.png"><br><br>  Despu√©s de completar los campos con informaci√≥n sobre el propietario de la CA, se ofrecer√° para determinar la configuraci√≥n del sistema de la CA: <br><br><img src="https://habrastorage.org/webt/it/wq/nc/itwqnccdburbtmsdybckzdqf1u8.png"><br><br>  Si no va a trabajar con la criptograf√≠a rusa, puede usar el OpenSSL habitual.  Para trabajar con la criptograf√≠a rusa, debe seleccionar la versi√≥n adecuada, una modificaci√≥n de OpenSSL.  Para m√°s detalles, lea README.txt en la distribuci√≥n descargada.  Dado que se planea emitir certificados calificados, tambi√©n es necesario proporcionar informaci√≥n sobre la certificaci√≥n de la propia CA y el sistema de protecci√≥n de la informaci√≥n criptogr√°fica que utiliza (consulte "Requisitos para el formulario de certificado calificado de una clave de verificaci√≥n de firma electr√≥nica", aprobado por orden del Servicio Federal de Seguridad de Rusia con fecha 27 de diciembre de 2011 No. 795). <br><br>  Despu√©s de completar correctamente todos los campos, una vez m√°s se le ofrecer√° verificar su precisi√≥n y hacer clic en el bot√≥n "Finalizar": <br><br><img src="https://habrastorage.org/webt/zo/pd/xf/zopdxfb8rtzcvoei5xuvpt7udqe.png"><br><br>  Despu√©s de hacer clic en el bot√≥n "Finalizar", se crear√° la base de datos de CA en la que se guardar√° el certificado ra√≠z de CA, la clave privada, la configuraci√≥n del sistema y la p√°gina de inicio de la utilidad CAFL63 aparecer√° nuevamente en la pantalla.  Ahora que hemos creado la base de datos de la CA reci√©n creada, hacemos clic en el bot√≥n "Abrir DB", seleccionamos el directorio con la base de datos, vamos a la ventana principal de trabajo de la CA y hacemos clic en el bot√≥n "Ver CA CA", nos aseguramos de que el certificado ra√≠z que creamos : <br><br><img src="https://habrastorage.org/webt/c-/x_/3r/c-x_3r8rrexuvvbov7ayzay6pze.png"><br><br>  El siguiente paso es preparar plantillas / perfiles de aplicaci√≥n para entidades jur√≠dicas, individuos, empresarios individuales ( <b><i>Herramientas-&gt; Configuraci√≥n-&gt; Tipos de certificados-&gt; Nuevo</i></b> ): <br><br><img src="https://habrastorage.org/webt/hw/-o/ml/hw-omloedtpyfgtfq1vex8h3mug.png"><br><br>  Despu√©s de especificar el nombre del nuevo perfil, se propondr√° determinar su composici√≥n: <br><br><img src="https://habrastorage.org/webt/bf/yc/g_/bfycg_oxromnvlpisghe64bbuwe.png"><br><br>  La composici√≥n del perfil est√° determinada por el nombre distinguido (nombre distinguido / √∫nico del titular del certificado).  Cada perfil tiene su propia composici√≥n con campos obligatorios (obligatorios) o no.  La composici√≥n del perfil para personas jur√≠dicas, individuos, empresarios individuales est√° determinada por los requisitos de la Ley Federal 63 y los "Requisitos para el formulario de certificado calificado de un certificado de clave de verificaci√≥n de firma electr√≥nica" FSB de Rusia. <br><br>  Despu√©s de preparar los perfiles, la CA est√° lista para recibir solicitantes y solicitudes de ellos.  Como se se√±al√≥ anteriormente, el solicitante puede venir con o sin una solicitud lista para un certificado. <br>  Si el solicitante vino con una aplicaci√≥n lista, luego de verificar sus documentos, la aplicaci√≥n se importa a la base de datos de la CA.  Para hacer esto, seleccione la pesta√±a "Solicitudes de certificados" en la ventana principal de trabajo, haga clic en el bot√≥n "Importar solicitud / CSR" y seleccione el archivo con la solicitud.  Despu√©s de eso, aparecer√° una ventana con informaci√≥n sobre la solicitud: <br><br><img src="https://habrastorage.org/webt/rd/dz/ry/rddzryagss1nr3eodjcs08bwero.png"><br><br>  Despu√©s de revisar la solicitud y asegurarse de que se complete correctamente, puede hacer clic en el bot√≥n "Importar" para ingresarla en la base de datos.  Inmediatamente, notamos que cuando intente volver a hacer una solicitud en la base de datos de la CA, se mostrar√° un mensaje: <br><br><img src="https://habrastorage.org/webt/ih/dy/q_/ihdyq_rplawbuh56jkw2czs8cto.png"><br><br>  Las solicitudes a la base de datos de CA est√°n marcadas (columna "Tipo") como "Configuraci√≥n regional" creada en el centro de registro de CA o como "Importaci√≥n" creada por el propio solicitante, y tambi√©n se registra el momento de recepci√≥n de la solicitud en la CA.  Esto puede ser √∫til para resolver situaciones de conflicto.  Por lo tanto, al importar una solicitud de certificado, debe indicar qui√©n cre√≥ la solicitud (ver captura de pantalla). <br>  La aplicaci√≥n importada se encuentra en la base de datos de CA y se muestra en la ventana principal en la pesta√±a "Solicitudes de certificado".  Las solicitudes recibidas se encuentran en la etapa de "consideraci√≥n" (la columna "Estado" de las pesta√±as "Solicitudes de certificado" y "Archivos de solicitud").  Para cada solicitud reci√©n recibida, se debe tomar una decisi√≥n (men√∫ desplegable cuando hace clic con el bot√≥n derecho en la solicitud seleccionada): <br><br><img src="https://habrastorage.org/webt/2e/08/l1/2e08l1p6pmp0ebvd_l1yi1b7aiy.png"><br><br>  Cada solicitud debe ser rechazada o aprobada: <br><br><img src="https://habrastorage.org/webt/hx/al/pt/hxalptjfajymsui_5xmtpxqnemc.png"><br><br>  Si la solicitud se rechaza, se mueve de la tabla de solicitudes actuales de reqDB a la tabla del archivo de solicitud de reqDBArc y, en consecuencia, desaparece en la pesta√±a "Solicitudes de certificado" y aparece en la pesta√±a "Archivo de solicitud". <br><br>  La solicitud aprobada permanece en la tabla reqDB y en la pesta√±a "Solicitudes de certificado" hasta que se emite el certificado, y luego tambi√©n termina en el archivo. <br><br>  Antes de emitir el certificado, es necesario aclarar con el solicitante para qu√© fines (por ejemplo, para acceder al portal de Servicios del Estado) se utilizar√° el certificado ( <b><i>Herramientas-&gt; Configuraci√≥n-&gt; Tipos de certificado -&gt; Individual -&gt; Editar -&gt; Uso de clave</i></b> ): <br><br><img src="https://habrastorage.org/webt/2p/kt/jm/2pktjm2nczklrb2mime0exznj7u.png"><br><br>  Para emitir un certificado, debe seleccionar la aplicaci√≥n aprobada en la pesta√±a "Solicitud de certificados", hacer clic con el bot√≥n derecho y seleccionar "Emitir certificado" en el men√∫ desplegable.  En el widget que aparece, deber√° seleccionar el perfil al que debe corresponder el perfil de la solicitud / certificado: <br><br><img src="https://habrastorage.org/webt/tl/b6/x0/tlb6x0l6lk9i8c01qnyvqma-4si.png"><br><br>  Tenga en cuenta que en el proceso de emisi√≥n de un certificado, puede aclarar los valores de un campo en particular: <br><br><img src="https://habrastorage.org/webt/v1/07/4k/v1074kdeoyswmznoaaxx-gi7pee.png"><br><br>  El procedimiento para emitir un certificado en s√≠ mismo (elemento de men√∫ "Emitir un certificado") difiere poco del procedimiento para crear un certificado ra√≠z o emitir una aplicaci√≥n: <br><br><img src="https://habrastorage.org/webt/xc/yk/ls/xcyklse8bwkvsqwwqfakk_o0dvu.png"><br><br>  El certificado emitido aparecer√° inmediatamente en la pesta√±a Certificados.  En este caso, el certificado en s√≠ cae en la tabla certDBNew de la base de datos de CA y permanece all√≠ hasta que se publique.  Un certificado se considera publicado despu√©s de exportarse al volcado SQL de nuevos certificados, que se transfiere a un servicio p√∫blico.  La publicaci√≥n de un certificado lo mueve de la tabla certDBNew a la tabla certDB. <br><br>  Si hace clic con el bot√≥n derecho en la l√≠nea seleccionada en la pesta√±a "Certificados", aparecer√° un men√∫ con las siguientes funciones: <br><br><img src="https://habrastorage.org/webt/pz/f1/yn/pzf1ynfqhicu8ferbge-gtgyc9i.png"><br><br>  Estas funciones le permiten ver tanto el certificado en s√≠ como la solicitud en funci√≥n de la cual se emiti√≥.  Tambi√©n puede exportar el certificado a un archivo o a la unidad flash de un solicitante.  ¬°La funci√≥n m√°s importante aqu√≠ es la funci√≥n de revocaci√≥n de certificados!  Existe una caracter√≠stica tan ex√≥tica como exportar un certificado a un contenedor seguro PKCS # 12.  Se utiliza cuando el solicitante desea recibir dicho contenedor.  Para tales solicitantes, se proporciona una funci√≥n de generaci√≥n de solicitudes con guardar la clave privada en un archivo (bot√≥n "Crear solicitud / CSR" en la pesta√±a "Solicitudes de certificado"). <br><br>  Entonces, la CA comenz√≥ su vida, emiti√≥ el primer certificado.  Uno de los objetivos de la CA es la organizaci√≥n del acceso libre a los certificados emitidos.  La publicaci√≥n de certificados generalmente pasa por servicios web.  CAFL63 tambi√©n tiene este servicio: <br><br><img src="https://habrastorage.org/webt/xt/a7/6w/xta76wp2bsjapckltfuqkl0pr2y.png"><br><br>  Para publicar certificados y listas de certificados revocados en un servicio p√∫blico, la CA los carga previamente en archivos ( <b><i>Certificados-&gt; Exportar certificados</i></b> ) o realiza un volcado de SQL de toda la tabla de certificados desde la cual puede crear una base de datos de certificados y cargarlos en ella, y luego hacerlos Volcado de SQL de nuevos certificados desde los cuales se agregar√°n a la base de datos de servicio p√∫blico: <br><br><img src="https://habrastorage.org/webt/he/_d/1n/he_d1nxytwkmjwe-skvpzlzadig.png"><br><br>  La funci√≥n fundamental de una AC es publicar una lista de certificados revocados, de forma similar a como lo hace el Ministerio del Interior con respecto a los pasaportes vencidos.  El certificado puede ser revocado a solicitud del propietario.  La raz√≥n principal de la revocaci√≥n es la p√©rdida de la clave privada o la p√©rdida de confianza en ella. <br><br>  Para revocar un certificado, simplemente selecci√≥nelo en la pesta√±a "Certificados", haga clic con el bot√≥n derecho y seleccione el elemento de men√∫ "Revocaci√≥n de certificado": <br><br><img src="https://habrastorage.org/webt/ai/7p/hk/ai7phklvqrbu1a0z7yl-xi-5xxw.png"><br><br>  El procedimiento de revocaci√≥n no es diferente del procedimiento de aprobaci√≥n para una solicitud o la emisi√≥n de un certificado.  El certificado revocado cae en la tabla cerDBRev de la base de datos de CA y aparece en la pesta√±a "Certificados revocados". <br><br>  Queda por considerar la √∫ltima funci√≥n de la CA: el lanzamiento de CRL, una lista de certificados revocados.  La lista de CRL se forma en la pesta√±a "Certificados revocados" cuando hace clic en el bot√≥n "Crear SOS / CRL".  Todo lo que se requiere del administrador es ingresar la contrase√±a de CA y confirmar su intenci√≥n de emitir la CRL: <br><br><img src="https://habrastorage.org/webt/5t/db/_c/5tdb_csh_qehcmmlaws9t75pssc.png"><br><br>  La CRL emitida cae en la tabla crlDB de la base de datos y se muestra en la pesta√±a CRL / SOS. <br><br>  Para analizar la CRL antes de colocarla en la base de datos, se escribi√≥ el procedimiento parse_crl: <br><br><pre> <code class="plaintext hljs">proc parse_crl {crl} { array set ret [list] if { [string range $crl 0 9 ] == "-----BEGIN" } { array set parsed_crl [::pki::_parse_pem $crl "-----BEGIN X509 CRL-----" "-----END X509 CRL-----"] set crl $parsed_crl(data) } ::asn::asnGetSequence crl crl_seq ::asn::asnGetSequence crl_seq crl_base ::asn::asnGetSequence crl_base crl_full ::asn::asnGetObjectIdentifier crl_full ret(signtype) #puts "KEY_TYPE=$ret(signtype)" ::::asn::asnGetSequence crl_base crl_issue set ret(issue) [::pki::x509::_dn_to_string $crl_issue] #puts "ISSUE=$ret(issue)" ::asn::asnGetUTCTime crl_base ret(publishDate) ::asn::asnGetUTCTime crl_base ret(nextDate) #puts "publishDate=$ret(publishDate)" return [array get ret] }</code> </pre> <br>  Para ver la CRL o exportarla para su publicaci√≥n en un servicio p√∫blico, debe, como siempre, seleccionar la l√≠nea deseada, hacer clic con el bot√≥n derecho del mouse y seleccionar el elemento de men√∫ apropiado: <br><br><img src="https://habrastorage.org/webt/np/c7/f2/npc7f2i1qb_rvyreerzj6wrbjgc.png"><br><br>  Eso es todo, la Autoridad de Certificaci√≥n est√° lista. <br><img src="https://habrastorage.org/webt/q1/i1/vs/q1i1vspugm4raux1pq5chgyysd4.png" align="left" alt="imagen">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Descubra</a> c√≥mo ensamblar y conectar OpenSSL con la criptograf√≠a rusa <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">aqu√≠</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es413493/">https://habr.com/ru/post/es413493/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es413481/index.html">Exportar √°rbol de prueba de JMeter a texto</a></li>
<li><a href="../es413485/index.html">Lanzamiento de GitLab 10.8: duplicaci√≥n de inserci√≥n de c√≥digo abierto e implementaci√≥n incremental</a></li>
<li><a href="../es413487/index.html">¬øQu√© debe esperar un desarrollador en el campo de las finanzas: condiciones de trabajo, proyectos y habilidades necesarias?</a></li>
<li><a href="../es413489/index.html">C√≥mo elegir un mensajero verdaderamente seguro y qu√© tiene que ver la cadena de bloques con √©l</a></li>
<li><a href="../es413491/index.html">Food Design Digest, mayo de 2018</a></li>
<li><a href="../es413495/index.html">Implementaci√≥n r√°pida o c√≥mo implementar front-end en 15 minutos</a></li>
<li><a href="../es413499/index.html">Apertura de un programa conjunto de maestr√≠a en JetBrains e ITMO</a></li>
<li><a href="../es413501/index.html">El a√±o pasado con React: conclusiones y recomendaciones</a></li>
<li><a href="../es413503/index.html">Si puedes, parcheame: c√≥mo estamos depurando la producci√≥n. Parte 1</a></li>
<li><a href="../es413505/index.html">2 entradas gratis para In-Memory Computing Summit Europe</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>