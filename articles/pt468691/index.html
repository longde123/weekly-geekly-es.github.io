<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëçüèΩ üëåüèº üë®üèΩ‚Äçüè´ Drivers perigosos de terceiros em seu sistema ou LOLDrivers üçü üßëüèª ‚õîÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Voc√™ sabia que um driver completamente leg√≠timo pode dar ao invasor a oportunidade de se registrar no sistema por um longo tempo, permanecendo dentro ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Drivers perigosos de terceiros em seu sistema ou LOLDrivers</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dsec/blog/468691/"><p><img src="https://habrastorage.org/webt/jo/vj/6b/jovj6bremrnesqprdgan6fibwqu.jpeg"></p><br><p>  Voc√™ sabia que um driver completamente leg√≠timo pode dar ao invasor a oportunidade de se registrar no sistema por um longo tempo, permanecendo dentro mesmo ap√≥s a reinstala√ß√£o?  Ou transformar seu computador em um tijolo?  Por exemplo, alguns drivers aparentemente confi√°veis ‚Äã‚Äã(assinados) inofensivos s√£o ferramentas para substituir o BIOS.  Ap√≥s esse ataque, apenas o programador salvar√°. </p><br><p>  No Windows, existem <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aplicativos / scripts / bibliotecas</a> confi√°veis ‚Äã‚Äãcom <del>  interessante </del>  funcionalidade perigosa, como a execu√ß√£o de c√≥digo arbitr√°rio, o download de arquivos, o desvio do UAC etc.  Se essa funcionalidade adicional for encontrada em um componente do kernel, ela se torna ainda mais interessante. </p><a name="habracut"></a><br><p>  A partir do Windows Vista x64, aplica-se a pol√≠tica DSE (Driver Signature Enforcement) - todos os drivers no n√≠vel do kernel devem ser assinados.  Se um invasor (com direitos de usu√°rio / administrador), ap√≥s penetrar no sistema, deseja obter o n√≠vel m√°ximo de acesso (instalar rootkit / bootkit / SMM-rootkit / BIOS-rootkit), ele precisar√°, de alguma forma, ignorar o requisito de assinatura do driver.  A capacidade de chamar determinadas fun√ß√µes ou instru√ß√µes do modo kernel no modo kernel pode fornecer ao invasor uma ferramenta para elevar privil√©gios, divulgar informa√ß√µes ou causar uma nega√ß√£o de servi√ßo.  Chamamos essa funcionalidade de funcionalidade dupla (em alguns casos, isso pode ser chamado de vulnerabilidades ou backdoors, no entanto, a discuss√£o sobre a defini√ß√£o correta est√° al√©m do escopo deste artigo). </p><br><h2 id="sposoby-obhoda-dse">  <strong>Solu√ß√µes alternativas DSE</strong> </h2><br><p>  Vejamos quais op√ß√µes um invasor geralmente tem para ignorar o DSE (voc√™ deve, de alguma forma, penetrar no ring0).  A tabela abaixo resume as maneiras de ignorar o DSE com suas vantagens e desvantagens (para o atacante e os guardas de seguran√ßa, observe).  Vale ressaltar que essas informa√ß√µes se aplicam ao Windows x64, come√ßando com o Vista. </p><br><div class="scrollable-table"><table><thead><tr><th>  Caminho </th><th>  Os benef√≠cios </th><th>  Desvantagens </th></tr></thead><tbody><tr><td>  Definindo dados de configura√ß√£o de inicializa√ß√£o (modo de teste) </td><td>  Simplicidade </td><td><ul><li>  N√£o funciona para todos os aplicativos. </li><li>  Uma marca d'√°gua √© exibida na √°rea de trabalho </li><li>  √â necess√°rio reiniciar </li></ul></td></tr><tr><td>  Usando uma chave privada comprometida </td><td>  Capacidade de instalar qualquer driver </td><td><ul><li>  Se um vazamento for detectado, o certificado ser√° adicionado √† lista de revoga√ß√£o de certificados (CRL) </li></ul></td></tr><tr><td>  Usando vulnerabilidade na implementa√ß√£o do controle DSE </td><td>  N√£o detectado pelos antiv√≠rus e sistemas de seguran√ßa do Windows </td><td><ul><li>  Dificuldade em encontrar essas vulnerabilidades </li><li>  Dependente da vers√£o do SO </li></ul></td></tr><tr><td>  Modifica√ß√£o dos mecanismos de verifica√ß√£o do driver (bootmgr, winload.exe, winresume.exe, ci.dll) </td><td>  Capacidade de instalar qualquer driver sem verifica√ß√µes de OC </td><td><ul><li>  Complexidade da modifica√ß√£o </li><li>  Requer uma maneira de ignorar a Inicializa√ß√£o Segura (se ativada) </li><li>  √â necess√°rio reiniciar </li><li>  Dependente da vers√£o do SO </li><li>  Outros controles de arquivo </li></ul></td></tr><tr><td>  Usando um driver assinado com vulnerabilidade </td><td>  Dificuldade de detec√ß√£o de ataques </td><td><ul><li>  Dificuldade em encontrar essas vulnerabilidades </li><li>  Trava de seguran√ßa de detec√ß√£o </li></ul></td></tr><tr><td>  Usando um driver assinado com funcionalidade de dupla finalidade </td><td>  N√£o detectado pelos antiv√≠rus e sistemas de seguran√ßa do Windows </td><td><ul><li>  A complexidade da pesquisa (de um invasor) de um driver com a funcionalidade de dupla finalidade necess√°ria </li></ul></td></tr></tbody></table></div><br><p>  Como voc√™ pode ver na tabela, um driver assinado com funcionalidade de dupla finalidade √© a maneira mais atraente de ignorar o DSE para um invasor. </p><br><h2 id="opasnaya-funkcionalnost-ili-funkcionalnost-dvoynogo-naznacheniya">  <strong>Funcionalidade perigosa ou de dupla finalidade</strong> </h2><br><p>  Vejamos exemplos de recursos maliciosos que um invasor aparece na presen√ßa de um driver com fun√ß√µes perigosas de dupla finalidade. </p><br><ul><li> Escalonamento de privil√©gios para o n√≠vel de administrador / SISTEMA.  √â necess√°rio ler / gravar mem√≥ria f√≠sica.  Este ataque pode ser realizado, por exemplo, usando o driver ASMMAP da ASUS.  Para fazer isso, leia a mem√≥ria f√≠sica e encontre a estrutura EPROCESS (√© um elemento de uma lista vinculada) e, em seguida, percorra a lista em busca do processo cujo n√≠vel de privil√©gio queremos aumentar, al√©m de algum processo conhecido com o n√≠vel SYSTEM (por exemplo, lsass, wininit).  Em seguida, copie o valor do campo Token da estrutura do processo do sistema para a estrutura do processo de destino.  Uma descri√ß√£o mais detalhada do ataque √© dada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . </li><li>  Desabilitando o SMEP.  Para fazer isso, voc√™ precisa escrever no registro de controle cr4 (mais precisamente, redefinir seu 20¬∫ bit).  Por exemplo, o driver bandainamcoonline.sys n√£o apenas desabilita o SMEP, mas tamb√©m executa o c√≥digo de maneira √∫til de acordo com o ponteiro passado a ele pelo usu√°rio.  Para os interessados, h√° <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">um artigo</a> com uma descri√ß√£o detalhada do driver. </li><li><p>  Execu√ß√£o de c√≥digo arbitr√°rio no modo kernel.  √â necess√°rio ler / gravar mem√≥ria f√≠sica e MSR.  O significado √© substituir o endere√ßo (localizado em um dos MSRs), para o qual a transi√ß√£o ser√° feita ao fazer uma chamada do sistema, para o endere√ßo do local do c√≥digo do invasor.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui</a> voc√™ pode encontrar mais informa√ß√µes sobre isso.  O PatchGuard ir√° interferir ao longo do caminho, mas voc√™ pode descobrir se desejar. </p><br><blockquote>  Como o driver e o PatchGuard s√£o executados no anel 0, nada impede que o driver desative as verifica√ß√µes do PatchGuard (at√©, √© claro, at√© que a Microsoft ou√ßa a Intel e v√° al√©m do modelo com dois an√©is de prote√ß√£o).  Os desenvolvedores de kernel da Microsoft est√£o bem cientes desse fato e executam v√°rias a√ß√µes para ocultar a localiza√ß√£o desse c√≥digo, ofuscar suas a√ß√µes e as estruturas internas usadas.  Em outras palavras, devido √† incapacidade de impedir que voc√™ modifique o c√≥digo PatchGuard, eles tentam ao m√°ximo escond√™-lo. <br><br>  - <em>Blunden B. O arsenal Rootkit: Escape e evas√£o nos cantos escuros do sistema.</em> </blockquote><br><div class="spoiler">  <b class="spoiler_title">O original</b> <div class="spoiler_text"><blockquote>  Dado que o c√≥digo do driver e o c√≥digo do PatchGuard s√£o executados no Ring 0, n√£o h√° nada para impedir que um KMD desative as verifica√ß√µes do PatchGuard (a menos que, √© claro, a Microsoft aceite a sugest√£o da Intel e v√° al√©m de um modelo de privil√©gio de dois toques).  Os engenheiros de kernel da Microsoft est√£o cientes desse fato e realizam todos os tipos de acrobacias de programa√ß√£o para ofuscar onde reside o c√≥digo, o que faz e as estruturas de dados internas que ele manipula.  Em outras palavras, eles n√£o podem impedir que voc√™ modifique o c√≥digo do PatchGuard, ent√£o eles tentar√£o ocult√°-lo. <br><br>  - <em>Blunden B. O arsenal Rootkit: Escape e evas√£o nos cantos escuros do sistema.</em> </blockquote><br></div></div><br></li></ul><br><ul><li>  Entrada do BIOS.  Um exemplo na natureza √© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Lojax</a> .  Os invasores pegaram o conhecido RwDrv.sys e o usaram para seus prop√≥sitos sujos: leram o BIOS, modificaram e escreveram de volta.  A reinstala√ß√£o do Windows n√£o ajudar√° aqui, pois o c√≥digo malicioso fica no firmware no SPI-flash.  Se a substitui√ß√£o do BIOS n√£o for bem sucedida (ou substitu√≠da especialmente), tamb√©m ser√° desagrad√°vel.  De qualquer forma, voc√™ ter√° que dirigir ap√≥s o programador para corrigir as conseq√º√™ncias irritantes. </li><li>  Ligue para o manipulador SMI.  Em primeiro lugar, nem todos os BIOSs s√£o igualmente indefesos contra o c√≥digo no modo ring0: existem v√°rios mecanismos para prote√ß√£o de leitura / grava√ß√£o; portanto, pode haver uma situa√ß√£o em que voc√™ precise ir mais baixo - para o modo SMM (o mais privilegiado).  Uma maneira de chegar l√° do modo kernel √© puxar o manipulador SMI (geralmente existem vulner√°veis ‚Äã‚Äãentre eles).  Para chamar o manipulador SMI, voc√™ deve poder gravar na porta de E / S, e isso s√≥ pode ser feito com privil√©gios ring0.  Ou seja, um driver com capacidade de gravar em portas de E / S √© capaz de detectar um manipulador SMI vulner√°vel que pode permitir que um invasor execute c√≥digo no modo SMM.  No <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">exemplo, o</a> autor usa o driver RwDrv.sys. </li><li>  Informa√ß√µes sobre o sistema.  Lendo a mem√≥ria do kernel (atrav√©s da leitura da mem√≥ria f√≠sica), lendo o BIOS, informa√ß√µes sobre configura√ß√µes do sistema, dispositivos conectados e mecanismos de prote√ß√£o habilitados / desabilitados (atrav√©s da leitura do MSR, registros de controle, acesso √†s portas de entrada / sa√≠da), em alguns casos, um hipervisor conhecido pode ser detectado ( como o VirtualBox <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">via MSR</a> ).  Para esta tarefa, mesmo um driver que apenas pode ler, n√£o necessariamente escrever, √© mais adequado.  Por exemplo, RamCaptureDriver64.sys da Belkasoft √© adequado para leitura de mem√≥ria f√≠sica. </li></ul><br><p>  Se analisarmos v√°rios artigos e notas sobre o CVE, podemos distinguir algumas classifica√ß√µes de potencialmente perigosas ao acessar as fun√ß√µes ring3 nos drivers.  A tabela abaixo lista as fun√ß√µes perigosas e as fontes de informa√ß√µes sobre eles. </p><br><div class="scrollable-table"><table><thead><tr><th>  Recursos perigosos identificados </th><th>  Fontes de informa√ß√£o sobre pr√°ticas de seguran√ßa </th></tr></thead><tbody><tr><td>  Registros de leitura / grava√ß√£o MSR </td><td>  CVE-2018-10711, CVE-2018-18535, CVE-2018-19323, CVE-2007-5633, CVE-2007-5761 </td></tr><tr><td>  Portas de E / S de leitura / grava√ß√£o </td><td>  CVE-2018-10712, CVE-2018-18536, CVE-2018-19322 </td></tr><tr><td>  Mem√≥ria f√≠sica de leitura / grava√ß√£o </td><td>  CVE-2018-16712, CVE-2018-10710, CVE-2017-15302, CVE-2017-15303, CVE-2018-19321 </td></tr><tr><td>  Registros de controle de leitura / grava√ß√£o </td><td>  CVE-2018-10709, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Eset - explora√ß√£o do Windows em 2016</a> </td></tr><tr><td>  Acesso a contadores de desempenho / rel√≥gio </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Leif Uhsadel, Andy Georges, Ingrid Verbauwhed - Explorando contadores de desempenho de hardware</a> </td></tr><tr><td>  Registro de sinaliza√ß√£o de leitura / grava√ß√£o </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Wojtczuk R., Rutkowska J. Seguindo o coelho branco: ataques de software contra o tecnolog Intel VT-d</a> </td></tr><tr><td>  Instru√ß√µes de acesso ao cache </td><td>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Detec√ß√£o de ataques de canal lateral com base em cache atrav√©s da tecnologia de monitoramento de cache Intel e contadores de desempenho de hardware</a> </td></tr></tbody></table></div><br><p>  E esta n√£o √© a lista completa de poss√≠veis fun√ß√µes perigosas.  Voc√™ tamb√©m pode falar sobre leitura / grava√ß√£o de mem√≥ria virtual do kernel, leitura / grava√ß√£o de MMIO, acesso a dispositivos PCI, etc. </p><br><p>  As tr√™s primeiras fun√ß√µes s√£o do maior interesse e do maior perigo (e o mais prov√°vel de detectar um driver com essas fun√ß√µes): ler / gravar registros MSR, ler / gravar portas de E / S, ler / gravar mem√≥ria f√≠sica.  Usando registros de controle, voc√™ pode ignorar alguns mecanismos de prote√ß√£o, gravar no registro de sinalizador permite ativar as portas de entrada / sa√≠da de leitura / grava√ß√£o no ring3 (a prop√≥sito, √© mencionado <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">neste</a> artigo em Habr√©), o sucesso de ataques a canais de terceiros (acessando o cache, monitorando contadores) desempenho / ciclos) provavelmente n√£o √© prov√°vel. </p><br><p>  No processo de cria√ß√£o deste material na confer√™ncia DEFCON 27 em Las Vegas, os pesquisadores Jesse Michael e Mickey Shkatov apresentaram o trabalho <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"Saia do kernel se n√£o puder dirigir"</a> , que tamb√©m discute esse problema, e recomendamos que voc√™ estude esse material para concluir a imagem.  Os cen√°rios para o uso desses drivers s√£o muito simples e claros, e s√£o apresentados exemplos de se√ß√µes de c√≥digo respons√°veis ‚Äã‚Äãpela funcionalidade mais cr√≠tica.  E tamb√©m fornece <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">c√≥digo</a> para trabalhar e encontrar drivers semelhantes. </p><br><p>  Em geral, vale ressaltar que esse t√≥pico h√° muito se preocupa com os pesquisadores de seguran√ßa.  Em 2018, o pesquisador Alexander Matrosov em seu artigo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">"O que torna os drivers do SO perigosos para o BIOS?"</a>  levantou essa quest√£o e demonstrou como √© simples explorar o BIOS. </p><br><h2 id="drayvery-s-funkciyami-dvoynogo-naznacheniya">  <strong>Drivers de fun√ß√£o dupla</strong> </h2><br><p>  Abaixo est√£o os representantes mais famosos dos motoristas com fun√ß√µes de dupla finalidade. </p><br><ul><li><p>  O RwDrv.sys √© um driver muito popular (fornecido com o utilit√°rio <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">RWeverything</a> ).  L√™ e grava mem√≥ria f√≠sica, portas de E / S, MSR e registros de controle.  Foi usado repetidamente em v√°rios PoCs e, em seguida, no rootkit Lojax mencionado anteriormente.  Uma <a href="">interface √©</a> escrita <a href="">para ele</a> em C ++ e tamb√©m √© usada em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">chipsec</a> . </p><br></li><li><p>  cpuz / gpuz </p><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: absolute; visibility: hidden; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="561208359383097346"></twitter-widget><blockquote class="twitter-tweet" data-lang="en_US" data-twitter-extracted-i1582099025562150486="true"><p lang="en" dir="ltr">  Est√° fazendo [V] HW IO fuzzing?  Confira GPU-Z.sys (assinado).  Wraps in / out / MmMapIoSpace / wrmsr / etc atrav√©s de IOCTLs :) - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">http://t.co/VwCYsm97rr</a> </p>  - Kostya Kortchinsky (@ crypt0ad) <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">30 de janeiro de 2015</a> </blockquote><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br><p>  L√™ e grava mem√≥ria f√≠sica, portas e MSR.  Existem v√°rios utilit√°rios de PoC usando-o ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> ). </p><br></li><li><p>  pcdsrvc_x64 - driver da Dell, para obter mais informa√ß√µes, entre em contato com <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">este</a> post.  Permite ler / gravar mem√≥ria f√≠sica nas portas de E / S. </p><br></li><li><p>  AsIO64.sys <br><img src="https://habrastorage.org/webt/nt/lv/kt/ntlvkt0qhmrs_otokd_exel9bqw.png" alt="imagem"><br>  Ele fornece a capacidade de ler / gravar mem√≥ria f√≠sica e portas de E / S e tamb√©m vem com uma dll conveniente para executar essas solicita√ß√µes. </p><br></li><li><p>  O Asmmap64.sys √© outro driver da ASUS que permite ler / gravar mem√≥ria f√≠sica, portas de E / S e MSR.  Seria especialmente agrad√°vel para um invasor, pois o acesso ao driver pode ser feito por um usu√°rio comum sem direitos de administrador.  Pessoas curiosas podem recorrer √† <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">fonte</a> . </p><br></li><li><p>  ntiolib_x64.sys / winio64.sys - drivers da MSI, s√£o descritos em detalhes no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">artigo</a> mencionado anteriormente.  Usando o ntiolib_x64.sys, voc√™ pode ler / gravar mem√≥ria f√≠sica, portas de E / S e MSR, o winio64.sys fornece todas essas fun√ß√µes, exceto o MSR. </p><br></li></ul><br><p>  Geralmente, as fun√ß√µes perigosas descritas s√£o reconhecidas como vulnerabilidades se o driver estiver acess√≠vel ao usu√°rio sem direitos de administrador (ACL incorreta) ou quando permitir executar c√≥digo arbitr√°rio diretamente (como em bandainamcoonline.sys).  Em outros casos, isso √© apenas funcionalidade e, como o usu√°rio possui direitos de administrador, ele pode usar todas as fun√ß√µes do driver e essa √© a norma. </p><br><p>  Se voc√™ acha que n√£o h√° mais de uma d√∫zia desses drivers, est√° muito enganado.  Voc√™ pode ver <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">esta sele√ß√£o de</a> drivers interessantes.  Esta lista cont√©m drivers da ASUS, AVAST, Razer, LG, American Megatrends e outras empresas conhecidas.  Portanto, existem muitos deles, voc√™ s√≥ precisa pesquisar.  Ent√£o, eles representam uma amea√ßa real. </p><br><p>  Essa amea√ßa tamb√©m √© entendida pelos funcion√°rios da Microsoft.  E eles ser√£o gratos por informa√ß√µes sobre esses drivers;) <br><img src="https://habrastorage.org/webt/ch/cd/pt/chcdptm1b5s848omknbcd0sr-im.png" alt="imagem"></p><br><h2 id="rekomendacii">  <strong>Recomenda√ß√µes</strong> </h2><br><p>  Para usu√°rios: </p><br><ul><li>  Voc√™ n√£o deve sentar-se desnecessariamente na conta de administrador e desativar o UAC (embora n√£o seja dif√≠cil <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">contorn√°-</a> la). </li><li>  Voc√™ pode instalar o detector tentando instalar drivers (por exemplo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> ). </li><li>  Se for necess√°rio usar utilit√°rios com esses drivers (diagn√≥stico, para atualizar o BIOS etc.), remova os drivers ap√≥s o uso. </li><li>  Configure o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Device Guard</a> (se voc√™ √© um feliz propriet√°rio do Windows 10).  Usando essa tecnologia, voc√™ pode criar sua pr√≥pria pol√≠tica de integridade de c√≥digo e adicionar listas brancas de programas e certificados.  Por exemplo, adicione √† pol√≠tica o requisito de que qualquer driver no modo kernel tenha uma assinatura Microsoft WHQL.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Nesta</a> postagem, voc√™ pode se familiarizar melhor com a configura√ß√£o do Device Guard para essa finalidade. </li></ul><br><p>  √â melhor que os fabricantes n√£o assinem esses drivers.  Se o usu√°rio precisar atualizar o BIOS, verificar se h√° vulnerabilidades no sistema (ol√°, chipsec), medir o desempenho ou executar outras manipula√ß√µes que exijam a instala√ß√£o desses drivers, ele pode muito bem entrar no modo de teste, fazer tudo isso e sair.  A usabilidade cair√°, mas a seguran√ßa aumentar√°. </p><br><h2 id="vyvody">  <strong>Conclus√µes</strong> </h2><br><p>  Se algo est√° assinado, voc√™ n√£o pode confiar de qualquer maneira.  Primeiro, voc√™ pode assinar algo assim e, segundo, um invasor pode tirar proveito desse assinado (mesmo que seja de um fabricante confi√°vel). </p><br><p>  Os especialistas em seguran√ßa da informa√ß√£o n√£o devem excluir do modelo de amea√ßas situa√ß√µes em que um invasor exige que um driver com funcionalidade perigosa realize um ataque.  Existem drivers suficientes; √© bastante simples fazer isso.  Se o ataque n√£o for realizado com um driver pop como o RwEverything, mas com um menos conhecido, ser√° ainda mais dif√≠cil detect√°-lo.  Portanto, voc√™ precisa estar alerta, monitorar essas coisas e n√£o permitir que cada driver inicialize no sistema. </p><br><p>  Autor: Elizaveta Khomenko </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt468691/">https://habr.com/ru/post/pt468691/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt468677/index.html">O an√∫ncio do smartphone Xiaomi Mi Mix Alpha</a></li>
<li><a href="../pt468679/index.html">Os ABCs de seguran√ßa no Kubernetes: autentica√ß√£o, autoriza√ß√£o, auditoria</a></li>
<li><a href="../pt468683/index.html">Teoria e pr√°tica da padroniza√ß√£o de servi√ßos Docker</a></li>
<li><a href="../pt468687/index.html">Analisamos as novas iniciativas do Banco Central para regular o mercado de a√ß√µes: 3 grupos de investidores, restri√ß√µes para iniciantes</a></li>
<li><a href="../pt468689/index.html">Registrando seu neg√≥cio de TI em Cingapura: o que devo fazer?</a></li>
<li><a href="../pt468693/index.html">Como a automa√ß√£o destr√≥i os funcion√°rios do Walmart</a></li>
<li><a href="../pt468695/index.html">Meu primeiro hack: um site que permite definir qualquer senha de usu√°rio</a></li>
<li><a href="../pt468697/index.html">DB & DWH MeetUp # 5 em Raiffeisenbank</a></li>
<li><a href="../pt468703/index.html">Como um programador pode ganhar ainda mais?</a></li>
<li><a href="../pt468705/index.html">Chamada de v√≠deo no navegador no PeerJS. In√≠cio r√°pido</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>