<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>📓 👨🏽‍💻 🥩 Rekko Challenge 2019：怎么样 👩🏼‍💻 🤪 ⏏️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="不久前，Okko在线电影的推荐系统竞赛-Rekko Challenge 2019在Boosters平台上举行。 对我来说，这是参加排行榜比赛的第一次经历（以前我只是在黑客马拉松比赛中尝试过力量）。 实践中，这项任务很有趣并且对我来说很熟悉，有一笔奖金，这意味着参加是有意义的。 结果，我获得了第14名...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rekko Challenge 2019：怎么样</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/surfstudio/blog/461055/"><img src="https://habrastorage.org/webt/hb/u7/gu/hbu7guq0ic25zumfxsf5bbipkcq.png"><br><br> 不久前，Okko在线电影的推荐系统竞赛<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-Rekko Challenge 2019</a>在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Boosters</a>平台上举行。 对我来说，这是参加排行榜比赛的第一次经历（以前我只是在黑客马拉松比赛中尝试过力量）。 实践中，这项任务很有趣并且对我来说很熟悉，有一笔奖金，这意味着参加是有意义的。 结果，我获得了第14名，组织者为此颁发了纪念T恤。 好啊 谢谢啦 <br><br> 在本文中，我将简要介绍您的任务，讨论我提出的假设，以及如何在不积累经验的情况下将推荐系统中的竞争拖到前15名中，这对于那些只打算参加比赛的人特别有用。 <br><a name="habracut"></a><br><h3> 推荐系统 </h3><br> 推荐系统的主要目标是为用户提供他<s>想</s>购买的东西（不幸的是，这种商业化的观点强加给我们）。 <br> 有不同的任务陈述（排名，搜索相似任务，预测特定元素）以及相应的解决方案。 好吧，我们都喜欢选择的可变性，这是由针对每个问题的几种潜在解决方案提供的。 在“ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">推荐系统的解剖</a> ”一文中很好地描述了各种方法。 当然，没有人取消<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">NFL定理</a> ，这意味着在竞争问题中我们可以尝试不同的算法。 <br><br><h3> 问题陈述 </h3><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">在</a>组织者的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章中</a>阅读有关任务和数据的更多信息。  TL; DR在这里，我将描述理解上下文所必需的最低要求。 <br><br> 数据集包含一万多部具有匿名属性的电影。 以下选项可用作用户-项目交互矩阵： <br><br><ul><li> 交易-包含用户购买内容/租赁/按订阅观看的事实； </li><li> 评级-用户对电影的评级； </li><li> 书签-将电影添加到书签的事件。 </li></ul><br> 所有信息都是在一定时间段内获取的，以链接到实际的任意单位表示。 <br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mrow" id="MJXp-Span-6"><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> t </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-9"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-11" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l</font></font></span></span></span><span class="MJXp-mrow" id="MJXp-Span-16"><span class="MJXp-mo" id="MJXp-Span-17" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.192ex" height="2.419ex" viewBox="0 -780.1 6541.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-74" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-73" x="361" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMAIN-3D" x="1108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-66" x="2165" y="0"></use><g transform="translate(2715,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-74" x="3545" y="0"></use><g transform="translate(3907,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-61" x="918" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-6C" x="1447" y="0"></use></g></g><g transform="translate(5711,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> ts = f（ts_ {real}）</script></p><br> 内容具有以下属性集： <br><br><img src="https://habrastorage.org/webt/14/hj/uu/14hjuuoannzvkwpal7n7xwqyvyk.png"><br><br> 您可以在组织者的文章中详细了解它们，但是我想立即关注引起我注意的内容：“属性”参数。 它包含一类分类属性，基数约为36,000。 每部电影平均有15个值。 乍一看，描述这些内容的最基本属性都是按照以下值加密的：演员，导演，国家/地区，电影所属的订阅或收藏。 <br><br> 有必要预测测试用户将在未来两个月观看的20部电影。 测试用户是所有50万用户中的5万。 在排行榜上，他们分为两半：公开/私人各25,000。 <br><br><h3> 公制 </h3><br> 组织者选择了20个元素的平均归一化平均精度（MNAP @ 20）作为度量。 与通常的MAP的主要区别在于，对于在测试期间未观看20部电影的用户而言，配给率不会在k上发生，而是在观看的电影的实际价值上发生。 <br><br><img src="https://habrastorage.org/webt/tk/xt/fn/tkxtfnagqxtookssvkg8rjiicqg.png"><br><br> 在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">此处</a>阅读更多内容并查看Cython中的代码<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">。</a> <br><br><h3> 验证方式 </h3><br> 解决问题。 首先，有必要确定已验证的内容。 由于我们需要预测未来的电影，因此我们无法对用户进行简单分类。 由于时间是匿名的，因此我至少必须至少开始对其进行解密。 为此，我请了几个用户，制定了交易时间表并透露了一定的季节性。 假设它是每天，并且知道两天之间的时间差，我们就可以计算出上传数据的时间。 原来，这些都是6个月的交易。 后来在讨论比赛的电报频道中证实了这一点。 <br><br><img src="https://habrastorage.org/webt/ba/3_/67/ba3_67yp9-znxb9b_uoeummo6li.png"><br><br> 上表以一个月的数据为例，显示了每小时的交易频率。 每周三个主要高峰类似于星期五，星期六和星期日晚上。 <br><br> 因此，我们有六个月的观看时间，接下来的两个电影需要预测。 我们将训练样本时间的后三分之一用作验证数据集。 <br><br><img src="https://habrastorage.org/webt/mu/uy/cm/muuycmuqlah95etk4kqmdrbpygo.jpeg"><br><br> 接下来的几份意见书表明，该分组的选择很好，并且本地验证速度与排行榜的相关性极佳。 <br><br><h3> 尝试对数据进行匿名处理 </h3><br> 首先，我决定尝试对所有电影进行匿名处理，以便： <br><br><ul><li> 通过内容的元信息生成一堆迹象。 至少，以下人会想到：类型，演员表，订阅条目，文字说明等； </li><li> 从侧面抛出交互作用的炉子，以减少矩阵的稀疏性。 是的，竞争规则并未禁止使用外部数据。 当然，没有希望与开放数据集相匹配，但是没有人取消对俄语门户网站的解析。 </li></ul><br> 这似乎是合乎逻辑的动机，根据我的期望，这将成为功能强大的解决方案。 <br><br> 首先，我决定解析Okko网站，并提取所有电影及其属性（等级，持续时间，年龄限制等）。 好了，如何解析-事实证明一切都很简单，在这种情况下，您可以使用API​​： <br><br><img src="https://habrastorage.org/webt/c6/i8/8s/c6i88s9db6wj9nl7aqvysuappt8.png"><br><br> 进入目录并选择特定类型或订阅后，您只需进入任何元素。 响应上述要求，流派/订阅中具有所有属性的电影的整个阵列出现了问题。 很舒服:) <br><br><div class="spoiler">  <b class="spoiler_title">因此，结构中一个元素的属性看起来</b> <div class="spoiler_text"><pre><code class="json hljs"><span class="hljs-string"><span class="hljs-string">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"c2f98ef4-2eb5-4bfd-b765-b96589d4c470"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SERIAL"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"originalName"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"covers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"basicCovers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-string"><span class="hljs-string">"      ,    ..."</span></span>, <span class="hljs-attr"><span class="hljs-attr">"title"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"worldReleaseDate"</span></span>: <span class="hljs-number"><span class="hljs-number">1558731600000</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ageAccessType"</span></span>: <span class="hljs-string"><span class="hljs-string">"16"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"ageAccessDescription"</span></span>: <span class="hljs-string"><span class="hljs-string">"16+    16 "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"duration"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"trailers"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"kinopoiskRating"</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-attr"><span class="hljs-attr">"okkoRating"</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-attr"><span class="hljs-attr">"imdbRating"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"staraja-gvardija"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"has3d"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasFullHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasUltraHd"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasDolby"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasSound51"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasMultiAudio"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"hasSubtitles"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"inSubscription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"inNovelty"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"earlyWindow"</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">"releaseType"</span></span>: <span class="hljs-string"><span class="hljs-string">"RELEASE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"playbackStartDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"playbackTimeMark"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"products"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"PURCHASE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"consumptionMode"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fromConsumptionMode"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"qualities"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"Q_FULL_HD"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"fromQuality"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"price"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"value"</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-attr"><span class="hljs-attr">"currencyCode"</span></span>: <span class="hljs-string"><span class="hljs-string">"RUB"</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"priceCategory"</span></span>: <span class="hljs-string"><span class="hljs-string">"679"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"startDate"</span></span>: <span class="hljs-number"><span class="hljs-number">1554670800000</span></span>, <span class="hljs-attr"><span class="hljs-attr">"endDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"description"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscription"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"bc682dc6-c0f7-498e-9064-7d6cafd8ca66"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"119228"</span></span> } }, <span class="hljs-attr"><span class="hljs-attr">"offer"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"originalPrice"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, ... ], <span class="hljs-attr"><span class="hljs-attr">"emptyReason"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"licenses"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"assets"</span></span>: {...}, <span class="hljs-attr"><span class="hljs-attr">"genres"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"Detective"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"GENRE"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"Detective"</span></span> } }, ... ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"countries"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3b9706f4-a681-47fb-918e-182ea9dfef0b"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"COUNTRY"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"russia"</span></span> } } ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"subscriptions"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"items"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"element"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"bc682dc6-c0f7-498e-9064-7d6cafd8ca66"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"SUBSCRIPTION"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"   "</span></span>, <span class="hljs-attr"><span class="hljs-attr">"alias"</span></span>: <span class="hljs-string"><span class="hljs-string">"119228"</span></span> } }, ... ], <span class="hljs-attr"><span class="hljs-attr">"totalSize"</span></span>: <span class="hljs-number"><span class="hljs-number">7</span></span> }, <span class="hljs-attr"><span class="hljs-attr">"promoText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"innerColor"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"updateRateDescription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"contentCountDescription"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"copyright"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionStartDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionEndDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"subscriptionActivateDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"stickerText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"fullSeasonPriceText"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"purchaseDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"expireDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lastWatchedChildId"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"bookmarkDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"userRating"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"consumeDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"lastStartingDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"watchDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"startingDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-attr"><span class="hljs-attr">"earlyWatchDate"</span></span>: <span class="hljs-literal"><span class="hljs-literal">null</span></span> }</code> </pre> <br></div></div><br> 由于一部电影可以属于几种流派/订阅，因此仍然需要遍历所有流派，解析JSON，然后允许重复。 <br><br> 是的，我很幸运，在这里节省了很多时间。 如果不是您这种情况，并且您需要解析html内容，那么中心上的文章可以为您提供帮助，例如， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">here</a> 。 <br><br> 我以为，“那是帽子。我们只能把帽子退下来。” 第二天我意识到：“重点是帽子”：数据不是绝对匹配的。 关于它下面。 <br><br> 首先，目录的大小显着不同：在数据集中-10,200，是从站点收集的-8870。这是根据数据集的历史性得出的：仅下载了站点上的内容以及2018年的比赛数据。 有些电影已经不可用了。 哎呀 <br><br> 其次，比赛的潜在属性是仅以下方面的持久直觉： <br><br>  <i>Feature5-</i>年龄限制。 这很容易理解。 该属性的基数是5个唯一的浮点值和“ -1”。 在收集的数据中，发现“ ageAccessType”属性的基数仅为5。映射如下所示： <br><br><pre> <code class="python hljs">catalogue.age_rating = catalogue.age_rating.map({<span class="hljs-number"><span class="hljs-number">0</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0.4496666915</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.5927161087</span></span>: <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">0.6547073468</span></span>: <span class="hljs-number"><span class="hljs-number">16</span></span> <span class="hljs-number"><span class="hljs-number">0.6804096966000001</span></span>: <span class="hljs-number"><span class="hljs-number">18</span></span>})</code> </pre><br>  <i>Feature2-</i>通过电影搜索转换后的电影分级。 最初，在EDA阶段，我们正在处理评级的想法是通过参数与总观看次数的相关性提出的。 随后，相信此评级来自电影搜索，从而证实了站点数据中存在“ kinopoiskRating”参数。 <br><br> 离比赛更近一步！ 现在，仍然需要找到一种方法来逆转以匿名形式显示的<i>feature2</i>参数的转换。 <br><br> 这是<i>feature2</i>中值的分布<i>形式</i> ： <br><br><img src="https://habrastorage.org/webt/pq/pl/_d/pqpl_d1lpm0xed8limzxedbevfa.png"><br><br> 因此， <i>kinopoiskRating</i>参数值的分布为： <br><br><img src="https://habrastorage.org/webt/wn/6a/np/wn6anpuxtav5ghzgq4tdme0lji8.png"><br><br> 当我将这些图像展示给我的同事Sasha时，他立即看到这是3度。 不尊重三个数学家，但是Pi的个数是偶数。 结果，结果是这样的： <br><br><img src="https://habrastorage.org/webt/tw/tt/4u/twtt4uravymgxe1lhxj2d9ydqly.png"><br><br> 似乎全部，但不完全是。 我们看到了相同的分布，但标称值和数量仍未收敛。 如果我们知道一定数量的比较示例，则只需近似线性函数即可找到因子。 但是我们没有它们。 <br><br> 顺便说一下，近似不是最合适的词。 我们需要一个误差几乎为零的解决方案。 收集的数据的准确性是在分隔符后2个字符。 如果您认为有很多电影的评分为6.xx，而有些电影的评分相同，那么您应该在这里争取精度。 <br><br> 您还能尝试什么？ 您可以依赖最小值和最大值并使用MinMaxScaler，但是此方法的不可靠性立即引起怀疑。 让我提醒您，影片的数量最初并不一致，我们的数据集是历史数据，并且是网站上的当前状态。 即 我们无法保证两组中最低和最高收视率的电影是相同的（事实证明它们的年龄限制不同，并且时长未从“完全”这个词收敛），也无法确定OKKO在多长时间内更新一次API每天更改电影搜索等级。 <br><br> 因此很明显，我需要更多的属性候选者进行匹配。 <br><br>  <b>还有什么有趣的？</b> <br><br>  <i>feature1</i>是某种日期。 从理论上讲，对于日期，组织者承诺保留状态分离，这暗示着线性函数。 通常，转换应与交互矩阵的<i>ts</i>属性相同。 如果您按<i>Feature_1</i>看电影的发行... <br><br><img src="https://habrastorage.org/webt/q2/94/dn/q294dngcpjgbfdgxcpwsrsv-1lu.png"><br><br>  ...然后，电影上映日期的假说立即消失了。 直觉表明，该行业生产的电影数量应随时间增加。 确认如下。 <br><br> 我们从网站收到的数据中有14个属性。 实际上，不幸的是，这些值仅包含以下内容： <br><br><img src="https://habrastorage.org/webt/wg/bw/64/wgbw64outbnbatpbee2vt5ge8y0.png"><br><br><img src="https://habrastorage.org/webt/5t/ba/pw/5tbapwosxnjwma2wxnznoj3ntfm.png"><br><br><img src="https://habrastorage.org/webt/rj/l8/jb/rjl8jbpximeqbwahvzmrdbummm4.png"><br><br> 上面的示例均与<i>feature_1</i>相似。 好了，没有更多的可比较的想法了，看来这项任务的所有大惊小怪都是徒劳的。 当然，我听说过比赛，他们是手动标记数据的，但是当涉及成千上万的副本时却不是。 <br><br><h3> 解决方案 </h3><br>  <b>1.简单的模型</b> <br><br> 意识到并非一切都如此简单，所以我开始谦虚地研究实际情况。 首先，我想从一个简单的开始。 我尝试了几种行业中常用的解决方案，即： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">协同过滤</a> （在我们的案例中基于项目）和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">矩阵分解</a> 。 <br><br> 社区广泛使用了一些适合这些任务的python库： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">隐式</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">LightFM</a> 。 第一个能够基于ALS进行分解，并具有最近邻协作过滤功能，并具有用于预处理项目-项目矩阵的多个选项。 第二个因素有两个独特的因素： <br><br><ul><li> 分解基于SGD，这使得可以使用基于采样的损失函数，包括<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WARP</a> 。 </li><li> 它使用一种混合方法，以这种方式组合有关用户属性和模型中项目的信息，以使用户的潜矢量是其属性的潜矢量之和。 和类似的项目。 当用户/项目出现冷启动问题时，此方法变得极为方便。 </li></ul><br> 我们没有任何用户属性（除了能够根据与电影的互动来显示用户的属性），因此我仅使用项目的属性。 <br><br> 总共有6个设置用于枚举参数。 三种矩阵的组合用作交互矩阵，其中评级被转换为二进制。 下表中每种设置具有最佳超参数的比较结果。 <br><div class="scrollable-table"><table><tbody><tr><td>  <b>型号</b> </td><td>  <b>在20时测试MNAP</b> </td></tr><tr><td> 隐式ALS </td><td>  0.02646 </td></tr><tr><td> 隐式余弦kNN CF </td><td>  <b>0.03170</b> </td></tr><tr><td> 隐式TFIDF kNN CF </td><td>  0.03113 </td></tr><tr><td>  LightFM（无项目功能），BPR丢失 </td><td>  0.02567 </td></tr><tr><td>  LightFM（无项目功能），WARP丢失 </td><td>  0.02632 </td></tr><tr><td> 具有项目功能的LightFM，WARP丢失 </td><td>  0.02635 </td></tr></tbody></table></div><br> 如您所见，经典协作过滤已被证明比其他模型要好得多。 并不完美，但基线并不需要太多。 使用此配置提交在公共排行榜上给出了0.03048。 我当时不记得这个职位，但是在比赛结束时，这项参赛作品肯定会进入前80名并获得铜牌。 <br><br>  <b>2.你好助推</b> <br><br> 有什么能比一个模型更好？ 正确：几种型号。 <br><br> 因此，下一个选择是合奏，或者在建议的范围内，选择第二个等级。 作为一种方法，我从Avito的同事那里摘取了<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">这篇</a>文章。 似乎严格按照配方烹饪，并定期搅拌和调味，具有薄膜的特性。 唯一的偏差是应聘者人数：我从LightFM入围前200名，因为 拥有500,000个用户，更根本无法容纳到内存中。 <br><br> 结果，我在验证中获得的速度比在一个模型上差。 <br><br> 经过几天的试验，人们意识到没有任何事情在起作用，也没有任何东西可以单独起作用。 或我不知道该如何烹饪（剧透：正确的第二个答案）。 我做错了什么？ 我想到两个原因： <br><br><ul><li> 一方面，从生成“硬阴性”样本的角度来看，从一级模型中获取前200名是明智的。 与用户也相关但未被用户观看的电影。 另一方面，在测试期间可以观看其中一些电影，我们将这些示例作为底片展示。 接下来，我决定降低这一事实的风险，并通过以下实验重新验证该假设：我将所有阳性样本+随机样本作为训练样本。 测试样品的速度没有提高。 在这里有必要澄清一下，在测试抽样中，第一层模型也有最高的预测，因为在排行榜上没有人会告诉我所有积极的例子。 </li><li> 目录中的10200部电影中，只有8296部进行了互动。 近2,000部电影被剥夺了用户的注意力，部分原因是这些电影无法购买/租赁/作为订阅的一部分。 聊天中的人问，在考试期间是否可以放映一些难以接近的电影。 答案是肯定的。 绝对不可能将它们丢弃。 因此，我建议在接下来的2个月内再提供近2,000部电影。 否则，为什么要将它们放入数据集中？ </li></ul><br>  <b>3.神经元</b> <br><br> 在上一段中提出了一个问题：我们如何处理完全没有互动的电影？ 是的，我们还记得LightFM中的项目功能，但是正如我们所记得的，它们没有输入。 还有什么 神经元！ <br><br> 开源的阿森纳（Arsenal）有一些相当受欢迎的高级库，可与推荐系统一起使用：Maciej Kula（LightFM的作者）和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">TensorRec的Spotlight</a> 。 第一个是PyTorch，第二个是-Tensorflow。 <br><br>  Spotlight可以分解具有神经元和模型序列的隐式/显式数据集。 同时，在“开箱即用”的因式分解中，无法添加用户/项目功能，因此请将其删除。 <br><br> 相反，TensorRec只知道如何分解，并且是一个有趣的框架： <br><br><ul><li> 表示图-嵌入时转换输入数据的一种方法（可以为用户/项目设置不同的值），根据该方法将在预测图中进行计算。 该选择由具有不同激活选项的图层组成。 也可以使用抽象类并坚持进行自定义转换，该转换由一系列keras图层组成。 </li><li> 预测图可让您选择最后的运算：您最喜欢的点积，欧几里德和余弦距离。 </li><li> 损失-也有很多选择。 我们对WMRB的实施感到满意（本质上是相同的WARP，只知道如何学习批量和分布式） </li></ul><br> 最重要的是，TensorRec能够使用上下文功能，实际上作者承认他最初是受LightFM的启发。 好吧，让我们看看。 我们采用交互（仅交易）和项目功能。 <br><br> 我们发送到各种配置的搜索并等待。 与LightFM相比，培训和验证需要很长时间。 <br><br> 此外，还带来了一些不便之处： <br><br><ol><li> 从更改详细标志开始， <i>fit</i>方法没有任何更改，也没有为您提供回调。 我必须编写一个函数，使用<i>fit_partial</i>方法在内部训练一个时代，然后运行训练和测试的验证（在两种情况下，都使用样本来加快过程）。 </li><li> 总的来说，该框架的作者非常出色，并且在任何地方都使用tf.SparseTensor。 但是，值得一提的是，作为预测（包括用于验证），您会得到密集的结果（矢量），每个用户的长度为n_items。 这有两个技巧：创建一个循环，使用top-k过滤批量生成预测（库方法没有这样的参数），并使用RAM准备条带。 </li></ol><br> 最终，在最佳配置选项下，我设法将测试样本压缩为0.02869。 有一些类似于LB。 <br><br> 好吧，我希望什么？ 在项目特征上添加非线性会增加指标的两倍吗？ 天真。 <br><br>  <b>4.贝克的任务</b> <br><br> 所以等等。 看来我再次遇到了杂耍的神经元。 从事这项业务时，我想检验什么假设？ 假设是：“在延迟选择的后两个月中，排行榜上将出现近2,000部新电影。 其中一些人会占很大比例。” <br><br> 因此，您可以分两步进行检查： <br><br><ol><li> 很高兴看到我们在测试期间诚实地增加了多少部电影，涉及火车。 如果我们只看风景，那么“新”电影只有240（！）。 该假设立即动摇。 似乎购买新内容的时间间隔不大。 </li><li> 我们完成。 我们有机会训练模型以仅使用基于项目特征的表示形式（例如，在LightFM中，如果未使用身份矩阵预先填充属性矩阵，则默认情况下会完成此操作）。 此外，出于不诚实，我们只能服从该模型（！）我们无法访问且从未看过的电影。 从这些结果中，我们提交并获得0.0000136。 </li></ol><br> 宾果！ 这意味着您可以停止从电影属性中挤出语义。 顺便说一句，后来在DataFest上，OKKO的家伙说，大部分无法访问的内容只是一些老电影。 <br><br> 您需要尝试新事物，以及新事物-被遗忘的旧事物。 就我们而言，并不是完全被遗忘，而是几天前发生的事情。 协同过滤？ <br><br>  <b>5.调整基线</b> <br><br> 我如何帮助CF基线？ <br><br>  <b>主意1</b> <br><br> 在互联网上，我找到了一个关于使用似然比测试过滤掉小电影的演示。 <br><br> 在下面，我将留下我的python代码来计算LLR得分，我不得不在膝盖上写下以测试该想法。 <br><br><div class="spoiler">  <b class="spoiler_title">LLR计算</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.sparse <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> csr_matrix <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tqdm <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tqdm <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">LLR</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, interaction_matrix, interaction_matrix_2=None)</span></span></span><span class="hljs-function">:</span></span> interactions, lack_of_interactions = self.make_two_tables(interaction_matrix) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> interaction_matrix_2 <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: interactions_2, lack_of_interactions_2 = self.make_two_tables(interaction_matrix_2) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: interactions_2, lack_of_interactions_2 = interactions, lack_of_interactions self.num_items = interaction_matrix.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>] self.llr_matrix = np.zeros((self.num_items, self.num_items)) <span class="hljs-comment"><span class="hljs-comment"># k11 - item-item co-occurrence self.k_11 = np.dot(interactions, interactions_2.T) # k12 - how many times row elements was bought without column elements self.k_12 = np.dot(interactions, lack_of_interactions_2.T) # k21 - how many times column elements was bought without row elements self.k_21 = np.dot(lack_of_interactions, interactions_2.T) # k22 - how many times elements was not bought together self.k_22 = np.dot(lack_of_interactions, lack_of_interactions_2.T) def make_two_tables(self, interaction_matrix): interactions = interaction_matrix if type(interactions) == csr_matrix: interactions = interactions.todense() interactions = np.array(interactions.astype(bool).T) lack_of_interactions = ~interactions interactions = np.array(interactions, dtype=np.float32) lack_of_interactions = np.array(lack_of_interactions, dtype=np.float32) return interactions, lack_of_interactions def entropy(self, k): N = np.sum(k) return np.nansum((k / N + (k == 0)) * np.log(k / N)) def get_LLR(self, item_1, item_2): k = np.array([[self.k_11[item_1, item_2], self.k_12[item_1, item_2]], [self.k_21[item_1, item_2], self.k_22[item_1, item_2]]]) LLR = 2 * np.sum(k) * (self.entropy(k) - self.entropy(np.sum(k, axis=0)) - self.entropy(np.sum(k, axis=1))) return LLR def compute_llr_matrix(self): for item_1 in range(self.num_items): for item_2 in range(item_1, self.num_items): self.llr_matrix[item_1, item_2] = self.get_LLR(item_1, item_2) if item_1 != item_2: self.llr_matrix[item_2, item_1] = self.llr_matrix[item_1, item_2] def get_top_n(self, n=100, mask=False): filtered_matrix = self.llr_matrix.copy() for i in tqdm(range(filtered_matrix.shape[0])): ind = np.argpartition(filtered_matrix[i], -n)[-n:] filtered_matrix[i][[x for x in range(filtered_matrix.shape[0]) if x not in ind]] = 0 if mask: return filtered_matrix != 0 else: return filtered_matrix</span></span></code> </pre><br></div></div><br> 结果，所得矩阵可用作蒙版，仅保留最重要的交互作用，并且有两种选择：使用阈值或保留具有最高值的前k个元素。 同样，将对购物的几种影响的组合以一种速度进行排名，换句话说，该测试表明了它的重要性，例如，添加到有关可能转换为购买的收藏夹中。 看起来很有希望，但是使用表明，使用LLR分数进行过滤会产生很小的增加，而将多个分数组合只会使结果恶化。 显然，该方法不适用于此数据。 在优点中，我只能指出，在弄清楚如何实现此想法的同时，我不得不深入研究了内幕。 <br><br> 在猫的下方将保留一个以隐式方式应用此自定义逻辑的示例。 <br><br><div class="spoiler">  <b class="spoiler_title">隐式修改矩阵</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   LLR scores.     n_items * n_items. llr = LLR(train_csr, train_csr) llr.compute_llr_matrix() #     id, ,      llr_based_mask = llr.get_top_n(n=500, mask=True) #     ,  - CosineRecommender. model = CosineRecommender(K=10200) model.fit(train_csr.T) # model.similarity -   co-occurrence (  Cosine - ).        . masked_matrix = np.array(model.similarity.todense()) * llr_based_mask #  fit()  scorer     model.similarity. #     . model.scorer = NearestNeighboursScorer(csr_matrix(masked_matrix)) #      :   recommend   . test_predict = {} for id_ in tqdm(np.unique(test_csr.nonzero()[0])): test_predict[id_] = model.recommend(id_, train_csr, filter_already_liked_items=True, N=20) #   tuples (item_id, score),   id  . test_predict_ids = {k: [x[0] for x in v] for k, v in test_predict.items()} #       / ,     ,   Cython.</span></span></code> </pre> <br></div></div><br>  <b>想法2</b> <br><br> 提出了另一个想法，可以改善对简单协作过滤的预测。 业界通常使用某种阻尼函数来进行旧的估算，但是我们的情况并非如此简单。 可能，您需要以某种方式考虑2种可能的情况： <br><br><ol><li> 观看该服务的用户大多是新用户 </li><li>  “审查员。” 也就是说，那些来得较近并且可以观看以前很流行的电影的人。 </li></ol><br> 因此，可以将协作组件自动划分为两个不同的组。 为此，我发明了一个函数，该函数代替在用户和影片的交集处将隐式值设置为“ 1”或“ 0”，而该值显示该影片在用户观看历史中的重要性。 <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-18"><span class="MJXp-mrow" id="MJXp-Span-19"><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">置</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-21"><span class="MJXp-mo" id="MJXp-Span-22" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">信</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-23"><span class="MJXp-mo" id="MJXp-Span-24" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">度</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-25"><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-27"><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-29"><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">影</font></font></span></span><span class="MJXp-mrow" id="MJXp-Span-31"><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0.278em; margin-right: 0.278em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">）</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-33" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = </font></font></span><span class="MJXp-mrow" id="MJXp-Span-34"><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">α</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-36" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> * </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-37"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小号</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">吨</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ř </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">吨</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ť </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">米</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ê </font></font></span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mrow" id="MJXp-Span-47"><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">β</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> * </font></font></span><span class="MJXp-mrow" id="MJXp-Span-50"><span class="MJXp-mo" id="MJXp-Span-51" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Δ</font></font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> W¯¯ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">吨</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ç </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ħ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ť </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-58"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">中号</font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ë</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="51.994ex" height="2.419ex" viewBox="0 -780.1 22386.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">置</text><g transform="translate(829,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">信</text></g><g transform="translate(1659,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">度</text></g><g transform="translate(2489,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(3319,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">电</text></g><g transform="translate(4149,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">影</text></g><g transform="translate(4979,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMAIN-3D" x="6087" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-3B1" x="7143" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMAIN-2217" x="8006" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-53" x="8729" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-74" x="9374" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-61" x="9736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-72" x="10265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-74" x="10717" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-54" x="11078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-69" x="11783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-6D" x="12128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-65" x="13007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMAIN-2B" x="13696" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-3B2" x="14696" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMAIN-2217" x="15485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMAIN-394" x="16208" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-57" x="17041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-61" x="18090" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-74" x="18619" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-63" x="18981" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-68" x="19414" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-54" x="19991" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-69" x="20695" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-6D" x="21041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/company/surfstudio/blog/461055/&amp;usg=ALkJrhhglPG2aEgOvktbZfuWLJ3KfoOVdw#MJMATHI-65" x="21919" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-2">置信度（电影）=α* StartTime +β*ΔWatchTime</script></p><br> 其中<i>StartTime</i>是影片的发行日期，而<i>ΔWatchTime</i>是发行日期和用户观看日期之间的差， <i>α</i>和<i>β</i>是超参数。 <br><br> 在这里，第一个术语负责提高最近发行的电影的速度，第二个术语负责考虑用户对旧电影的沉迷。 如果电影是很久以前发行的，并且用户立即购买了电影，那么在今天，应该不考虑这个事实。 如果这是新奇的事物，那么我们必须将其推荐给更多也观看新商品的用户。 如果电影很古老，并且用户只是现在才看过，那么这对于像他这样的人也很重要。 <br><br> 仍然有一个琐碎的工作，可以对系数<i>α</i>和<i>β进行分类</i> 。 过夜，工作就完成了。 根本没有关于范围的假设，因此该范围最初很大，下面是局部最优搜索的结果。 <br><br><img src="https://habrastorage.org/webt/ej/iy/qk/ejiyqkpfmhz43nlifcd3o_zv40o.png"><br><br> 使用这个想法，在一个矩阵上建立一个简单的模型，本地验证的速度为0.03627，公共LB的速度为0.03685，与之前的结果相比，它看起来像是一个很好的提升。 当时，它使我进入了前20名。 <br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">想法3</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">最终的想法是，用户观看了很长时间的旧电影完全可以忽略。</font><font style="vertical-align: inherit;">这种CF筛选方法通常称为修剪。</font><font style="vertical-align: inherit;">我们来看几个值并检验假设：</font></font><br><br><img src="https://habrastorage.org/webt/pk/xd/uk/pkxduk8vw3eyyojevyibbesixbi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事实证明，对于拥有悠久历史的用户，仅保留最后25个交互是有意义的。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">总的来说，通过处理数据，我们在本地测试样本上获得了0.040312的速度，使用这些参数提交的结果分别在公共/私人部分给出了0.03870和0.03990的结果，并为我提供了第14名和一件T恤。</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 确认的细分 </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在jupyter Notebook中运行项目是一项不费力的工作。</font><font style="vertical-align: inherit;">您总是迷失在分散在多个笔记本中的代码中。</font><font style="vertical-align: inherit;">就可重复性而言，仅在输出单元中跟踪结果完全危险。</font><font style="vertical-align: inherit;">因此，数据专家可以尽其所能。</font><font style="vertical-align: inherit;">我和我的同事创建了我们的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cookiecutter数据科学</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">框架</font><font style="vertical-align: inherit;">-海洋。</font><font style="vertical-align: inherit;">这是用于创建结构和项目管理的工具。</font><font style="vertical-align: inherit;">您可以在我们的</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文章中</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了解其优势</font><font style="vertical-align: inherit;">。</font><font style="vertical-align: inherit;">很大程度上是由于采用了分离实验的好方法，所以在检验假设时，我没有失去理智，也没有感到困惑。</font></font><br><br><h3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 成功的秘诀（不是我的） </font></font></h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">众所周知，排行榜的私有部分被打开后，几乎所有拥有顶级解决方案的人都在第一层使用了简单模型，在第二层使用了附加功能。正如我稍后所了解的，我在此实验中的穿刺主要是在训练第二级模型时分割样本的一种方法。我尝试过：</font></font><br><br><img src="https://habrastorage.org/webt/vq/c1/ds/vqc1dsjoq63esgrlttp3v9-ky2g.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">意识到这很愚蠢，我开始寻找非常复杂的方法，例如这样的方法：</font></font><br><br><img src="https://habrastorage.org/webt/p3/im/w3/p3imw3yj1ip5bvqorv_uexldawu.jpeg"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">嗯，我从第二名的Evgeny Smirnov的演讲中找到了正确的方法。在一级模型的测试部分，这是用户的分裂。看起来微不足道，但是这个主意并没有出现在我身上。</font></font><br><br><img src="https://habrastorage.org/webt/i9/rs/gw/i9rsgwcjimnuhjbgqcpmlyaj2rk.jpeg"><br><br><h3> 结论 </h3><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">竞赛是竞赛。</font><font style="vertical-align: inherit;">重型模型确实可以提供更高的准确性，特别是如果您可以烹饪的话。</font><font style="vertical-align: inherit;">这种经验会派上用场吗？</font><font style="vertical-align: inherit;">除了回答之外，我要说的是比赛结束后，组织者抛弃了破坏者-产品模型中的功能重要性图，根据该图，很明显他们在生产中使用了相同的“成功”方法。</font><font style="vertical-align: inherit;">事实证明，它们也在产品中流动。</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事实证明，对我而言，参与的经验在专业上真的很有用。</font><font style="vertical-align: inherit;">感谢您阅读本文；</font><font style="vertical-align: inherit;">欢迎提出问题，建议，意见。</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN461055/">https://habr.com/ru/post/zh-CN461055/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN461043/index.html">团队中的冲突管理-平衡行为还是至关重要的需求？</a></li>
<li><a href="../zh-CN461045/index.html">通过FSIS USRN和python获取Rosreestr的摘录。 第一部分</a></li>
<li><a href="../zh-CN461047/index.html">写还是不写。 活动期间致当局的信</a></li>
<li><a href="../zh-CN461051/index.html">我在Go项目中遇到的10个最常见的错误</a></li>
<li><a href="../zh-CN461053/index.html">我们将在线地图连接到智能手机上的导航器。 第2部分-矢量卡</a></li>
<li><a href="../zh-CN461057/index.html">有关游戏开发的电报频道</a></li>
<li><a href="../zh-CN461059/index.html">为电影迷编写一个Android应用-第1部分（原型设计）</a></li>
<li><a href="../zh-CN461061/index.html">镁合金，双晶界和偏析</a></li>
<li><a href="../zh-CN461063/index.html">R与Microsoft SQL Server和其他DBMS上的数据库的交互</a></li>
<li><a href="../zh-CN461067/index.html">您应该在2019年准备的工作面试中的前65个SQL问题。 第一部分</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>