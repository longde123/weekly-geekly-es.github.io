<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🔛 ℹ️ 🤙🏼 Funktionen höherer Ordnung in JS: Young Fighter Course 🖐🏼 👨🏻‍🔬 🚌</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dieser Artikel richtet sich an Personen, die ihre ersten schüchternen Schritte auf dem heiklen Weg zum Erlernen von JavaScript unternehmen. Trotz der ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Funktionen höherer Ordnung in JS: Young Fighter Course</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/421537/">  <i>Dieser Artikel richtet sich an Personen, die ihre ersten schüchternen Schritte auf dem heiklen Weg zum Erlernen von JavaScript unternehmen.</i>  <i>Trotz der Tatsache, dass ich 2018 die ES5-Syntax verwende, damit der Artikel von jungen Padawanern verstanden werden kann, die den JavaScript Level 1-Kurs an der HTML Academy belegen.</i> <br><br>  Eines der Merkmale, das JS von vielen anderen Programmiersprachen unterscheidet, ist, dass in dieser Sprache eine Funktion ein „erstklassiges Objekt“ ist.  Oder auf Russisch ist eine Funktion eine Bedeutung.  Entspricht einer Zahl, einer Zeichenfolge oder einem Objekt.  Wir können eine Funktion in eine Variable schreiben, sie in ein Array oder in eine Objekteigenschaft einfügen.  Wir können sogar zwei Funktionen addieren.  Tatsächlich wird daraus nichts Sinnvolles, aber tatsächlich - wir können! <br><br><pre><code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">hello</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">world</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{}; <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(hello + world); <span class="hljs-comment"><span class="hljs-comment">//  ,  ,   //   ,    </span></span></code> </pre> <br>  Das Interessanteste ist, dass wir Funktionen erstellen können, die mit anderen Funktionen arbeiten - sie als Argumente akzeptieren oder als Wert zurückgeben.  Solche Funktionen werden Funktionen <i>höherer Ordnung genannt</i> .  Und heute werden wir, Mädchen und Jungen, darüber sprechen, wie wir diese Gelegenheit an die Bedürfnisse der Volkswirtschaft anpassen können.  Unterwegs erfahren Sie mehr über einige nützliche Funktionen von Funktionen in JS. <br><a name="habracut"></a><br><h3>  Pipeline </h3><br>  Nehmen wir an, wir haben eine Sache, mit der Sie viele Stücke machen müssen.  Angenommen, ein Benutzer hat eine Textdatei hochgeladen, in der Daten im JSON-Format gespeichert sind, und wir möchten deren Inhalt verarbeiten.  Zuerst müssen wir die zusätzlichen Leerzeichen schneiden, die aufgrund von Benutzeraktionen oder des Betriebssystems an den Rändern "wachsen" können.  Überprüfen Sie dann, ob der Text keinen Schadcode enthält (wer weiß, diese Benutzer).  <code>JSON.parse</code> mit der Methode <code>JSON.parse</code> vom Text zum Objekt.  Entfernen Sie dann die benötigten Daten von diesem Objekt.  Und am Ende - senden Sie diese Daten an den Server.  Sie bekommen so etwas: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">trim</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sanitize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">extractData</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{<span class="hljs-comment"><span class="hljs-comment">/*  */</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> textFromFile = getTextFromFile(); send(extractData(parse(sanitize(trim(testFromFile))));</code> </pre><br>  Es sieht so einverstanden aus.  Außerdem haben Sie wahrscheinlich nicht bemerkt, dass eine schließende Klammer fehlt.  Natürlich würde Ihnen die IDE dies mitteilen, aber es gibt immer noch ein Problem.  Um dies zu lösen, wurde kürzlich ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">neuer Operator |&gt;</a> vorgeschlagen.  In der Tat ist es nicht neu, aber ehrlich aus funktionalen Sprachen entlehnt, aber das ist nicht der Punkt.  Mit diesem Operator kann die letzte Zeile wie folgt umgeschrieben werden: <br><br><pre> <code class="javascript hljs">textFromFile |&gt; trim |&gt; sanitize |&gt; parse |&gt; extractData |&gt; send;</code> </pre><br>  Der Operator |&gt; nimmt seinen linken Operanden und übergibt ihn als Argument an den rechten Operanden.  Beispielsweise entspricht <code>"Hello" |&gt; console.log</code> der <code>console.log("Hello")</code> .  Dies ist gerade in Fällen sehr praktisch, in denen mehrere Funktionen entlang der Kette aufgerufen werden.  Vor der Einführung dieses Operators wird jedoch viel Zeit vergehen (wenn dieser Vorschlag überhaupt akzeptiert wird), aber Sie müssen jetzt irgendwie leben.  Daher können wir unserem <s>Fahrrad eine</s> Funktion schreiben, die dieses Verhalten simuliert: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pipe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = args.shift(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(args.length){ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = args.shift(); result = f(result); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } pipe( textFromFile, trim, sanitize, parse, extractData, send );</code> </pre><br>  Wenn Sie ein unerfahrener Javascriptist sind (Javascript? Javascript?), Kann Ihnen die erste Zeile der Funktion unverständlich erscheinen.  Es ist ganz einfach: Innerhalb der Funktion verwenden wir das Schlüsselwort <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">argument,</a> um auf ein Array-ähnliches Objekt zuzugreifen, das alle an die Funktion übergebenen Argumente enthält.  Dies ist sehr praktisch, wenn wir nicht im Voraus wissen, wie viele Argumente sie haben wird.  Ein massives Objekt ist wie ein Array, aber nicht ganz.  Daher konvertieren wir es mit der <code>Array.from</code> Methode in ein normales Array.  Ich hoffe, der weitere Code ist bereits gut lesbar: Wir beginnen von links nach rechts, um Elemente aus dem Array zu extrahieren und sie auf die gleiche Weise wie der Operator |&gt; aufeinander anzuwenden. <br><br><h3>  Protokollierung </h3><br>  Hier ist ein weiteres Beispiel, das dem wirklichen Leben nahe kommt.  Angenommen, wir haben bereits eine Funktion <code>f</code> , die ... etwas Nützliches bewirkt.  Und während wir unseren Code testen, möchten wir mehr darüber wissen, wie <code>f</code> es genau macht.  Zu welchen Zeitpunkten wird aufgerufen, welche Argumente werden an ihn übergeben, welche Werte werden zurückgegeben. <br><br>  Natürlich können wir mit jedem Funktionsaufruf Folgendes schreiben: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = f(a, b); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" f     "</span></span> + a + <span class="hljs-string"><span class="hljs-string">"  "</span></span> + b + <span class="hljs-string"><span class="hljs-string">"   "</span></span> + result); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" : "</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.now());</code> </pre><br>  Aber erstens ist es ziemlich umständlich.  Und zweitens ist es sehr leicht, es zu vergessen.  Eines Tages werden wir einfach <code>f(a, b)</code> schreiben, und seitdem wird sich die Dunkelheit der Unwissenheit in unseren Gedanken niederlassen.  Es wird sich mit jeder neuen Herausforderung <code>f</code> , von der wir nichts wissen. <br><br>  Idealerweise möchte ich, dass die Protokollierung automatisch erfolgt.  Damit jedes Mal, wenn Sie <code>f</code> aufrufen, alle benötigten Dinge in die Konsole geschrieben werden.  Und zum Glück haben wir einen Weg, dies zu tun.  Lernen Sie die neue Funktion höherer Ordnung kennen! <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addLogger</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">f</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = f.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, args); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(<span class="hljs-string"><span class="hljs-string">" "</span></span> + f.name + <span class="hljs-string"><span class="hljs-string">"     "</span></span> + args.join() + <span class="hljs-string"><span class="hljs-string">"    "</span></span> + result + <span class="hljs-string"><span class="hljs-string">"\n"</span></span> + <span class="hljs-string"><span class="hljs-string">" : "</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>.now()); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sum</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sumWithLogging = addLogger(sum); sum(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   sumWithLogging(1, 2) // </span></span></code> </pre><br>  Eine Funktion übernimmt eine Funktion und gibt eine Funktion zurück, die die Funktion aufruft, die beim Erstellen der Funktion an die Funktion übergeben wurde.  Entschuldigung, ich konnte nicht aufhören, dies zu schreiben.  Jetzt auf Russisch: Die Funktion <code>addLogger</code> erstellt einen <code>addLogger</code> um die Funktion, die als Argument an sie übergeben wird.  Das Einwickeln ist auch eine Funktion.  Beim Aufruf sammelt es ein Array seiner Argumente auf die gleiche Weise wie im vorherigen Beispiel.  Anschließend ruft es mit der Methode <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">apply</a> eine umschlossene Funktion mit denselben Argumenten auf und merkt sich das Ergebnis.  Danach schreibt der Wrapper alles in die Konsole. <br><br>  Hier haben wir den klassischen Man-in-the-Middle-Angriffsfall.  Wenn Sie einen Wrapper anstelle von <code>f</code> verwenden, gibt es aus Sicht des Codes, der ihn verwendet, praktisch keinen Unterschied.  Der Code kann davon ausgehen, dass er direkt mit <code>f</code> kommuniziert.  In der Zwischenzeit meldet der Wrapper alles an Genosse Major. <br><br><h3>  Eins, zwei, drei, vier ... </h3><br>  Und noch eine Aufgabe in der Nähe der Praxis.  Angenommen, wir müssen einige Entitäten nummerieren.  Jedes Mal, wenn eine neue Entität angezeigt wird, erhalten wir eine neue Nummer, eine mehr als die vorherige.  Dazu starten wir eine Funktion der folgenden Form: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNewNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lastNumber++; }</code> </pre><br>  Und dann haben wir eine neue Art von Einheit.  Sagen wir, vorher haben wir die Hasen nummeriert, und jetzt gibt es auch Kaninchen.  Wenn Sie eine Funktion sowohl für diese als auch für andere verwenden, macht jede an Kaninchen ausgegebene Nummer ein „Loch“ in der Reihe von Nummern, die an Hasen ausgegeben werden.  Wir brauchen also die zweite Funktion und damit die zweite Variable: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastHareNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNewHareNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lastHareNumber++; } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastRabbitNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNewRabbitNumber</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> lastRabbitNumber++; }</code> </pre><br>  Sie haben das Gefühl, dass dieser Code schlecht riecht?  Ich hätte gerne etwas Besseres.  Erstens möchte ich in der Lage sein, solche Funktionen weniger ausführlich zu deklarieren, ohne den Code zu duplizieren.  Und zweitens möchte ich die Variable, die die Funktion verwendet, irgendwie in die Funktion selbst "packen", um den Namespace nicht noch einmal zu verstopfen. <br><br><div class="spoiler">  <b class="spoiler_title">Und dann platzt ein Mann herein, der mit dem Konzept von OOP vertraut ist, und sagt:</b> <div class="spoiler_text">  "Grundstufe, Watson."  Es ist notwendig, Zahlengeneratoren nicht zu Objekten, sondern zu Objekten zu machen.  Objekte dienen nur zum Speichern von Funktionen, die mit Daten arbeiten, zusammen mit genau diesen Daten.  Dann könnten wir so etwas schreiben wie: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> numberGenerator = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NumberGenerator(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = numberGenerator.get();</code> </pre><br>  Worauf ich antworten werde: <br>  - Um ehrlich zu sein, stimme ich Ihnen voll und ganz zu.  Und im Prinzip ist dies ein korrekterer Ansatz als das, was ich jetzt anbieten werde.  Aber hier haben wir einen Artikel über Funktionen, nicht über OOP.  Könntest du also eine Weile ruhig bleiben und mich fertig machen lassen? <br></div></div><br>  Hier (Überraschung!) Die Funktion höherer Ordnung wird uns wieder helfen. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createNumberGenerator</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> n++; } } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> getNewHareNumber = createNumberGenerator(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> getNewRabbitNumber = createNumberGenerator(); <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log( getNewHareNumber(), getNewHareNumber(), getNewHareNumber(), getNewRabbitNumber(), getNewRabbitNumber(), ); <span class="hljs-comment"><span class="hljs-comment">//    0, 1, 2, 0, 1</span></span></code> </pre><br>  Und hier haben einige Leute vielleicht eine Frage, vielleicht sogar in obszöner Form: Was zur Hölle ist los?  Warum erstellen wir eine Variable, die nicht in der Funktion selbst verwendet wird?  Wie greift eine interne Funktion darauf zu, wenn eine externe Funktion ihre Ausführung vor langer Zeit abgeschlossen hat?  Warum erhalten zwei erstellte Funktionen, die sich auf dieselbe Variable beziehen, unterschiedliche Ergebnisse?  Eine Antwort auf all diese Fragen ist der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Abschluss</a> . <br><br>  Jedes Mal, <code>createNumberGenerator</code> Funktion <code>createNumberGenerator</code> , erstellt der JS-Interpreter ein magisches <code>createNumberGenerator</code> namens "Ausführungskontext".  Grob gesagt ist dies ein solches Objekt, in dem alle in dieser Funktion deklarierten Variablen gespeichert sind.  Wir können nicht als gewöhnliches Javascript-Objekt darauf zugreifen, aber es ist es trotzdem. <br><br>  Wenn die Funktion „einfach“ war (z. B. Zahlen hinzufügen), erweist sich der Ausführungskontext nach Beendigung ihrer Arbeit als nutzlos.  Wissen Sie, was mit unnötigen Daten in JS passiert?  Sie werden von einem unersättlichen Dämon namens Garbage Collector verschlungen.  Wenn die Funktion jedoch „kompliziert“ war, kann es vorkommen, dass jemand seinen Kontext auch nach Ausführung dieser Funktion noch benötigt.  In diesem Fall schont ihn der Müllsammler, und er bleibt irgendwo in seiner Erinnerung hängen, damit diejenigen, die ihn brauchen, weiterhin Zugang zu ihm haben können. <br><br>  Somit hat die von <code>createNumberGenerator</code> Funktion immer Zugriff auf eine eigene Kopie der Variablen <code>n</code> .  Sie können sich das als Bag of Holding von D &amp; D vorstellen.  Sie stecken Ihre Hand in Ihre Tasche und befinden sich in einer persönlichen interdimensionalen „Tasche“, in der Sie alles aufbewahren können, was Sie wollen. <br><br><h3>  Entprellen </h3><br>  Es gibt so etwas wie "Bounce eliminieren".  In diesem Fall möchten wir nicht, dass eine Funktion zu oft aufgerufen wird.  Angenommen, es gibt eine bestimmte Schaltfläche, auf die geklickt wird, um einen „teuren“ Prozess zu starten (lange oder viel Speicher oder das Internet zu essen oder Jungfrauen zu opfern).  Es kann vorkommen, dass ein ungeduldiger Benutzer mit einer Häufigkeit von mehr als zehn Hertz auf diese Schaltfläche klickt.  Darüber hinaus hat der oben erwähnte Prozess eine solche Natur, dass es keinen Sinn macht, ihn zehnmal hintereinander auszuführen, da sich das Endergebnis nicht ändert.  Dann wenden wir die „Chatter-Eliminierung“ an. <br><br>  Das Wesentliche ist sehr einfach: Wir führen die Funktion nicht sofort, sondern nach einiger Zeit aus.  Wenn die Funktion vor Ablauf dieser Zeit erneut aufgerufen wurde, setzen wir den Timer zurück.  Somit kann der Benutzer mindestens tausendmal auf die Schaltfläche klicken - für das Opfer wird nur eine benötigt.  Weniger Wörter, mehr Code: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">debounce</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">f, delay</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lastTimeout; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(lastTimeout){ clearTimeout(lastTimeout); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> args = <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.from(<span class="hljs-built_in"><span class="hljs-built_in">arguments</span></span>); lastTimeout = setTimeout(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ f.apply(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, args); }, delay); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrifice</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">name</span></span></span><span class="hljs-function">)</span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(name + <span class="hljs-string"><span class="hljs-string">"     * *"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">debounce</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">sacrifice, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">500</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sacrificeDebounced</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span></span><span class="hljs-function">);</span></span></code> </pre><br>  In einer halben Sekunde wird Lena geopfert und Katya und Sveta werden dank unserer magischen Funktion überleben. <br><br>  Wenn Sie die vorherigen Beispiele sorgfältig lesen, sollten Sie ein gutes Verständnis dafür haben, wie hier alles funktioniert.  Die durch <code>debounce</code> erstellte Wrapper-Funktion löst die verzögerte Ausführung der ursprünglichen Funktion mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">setTimeout aus</a> .  In diesem Fall wird die Timeout-ID in der Variablen lastTimeout gespeichert, auf die der Wrapper aufgrund des Schließens zugreifen kann.  Befindet sich die Timeout- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ID</a> bereits in dieser Variablen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">bricht</a> der Wrapper dieses Timeout mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">clearTimeout ab</a> .  Wenn das vorherige Timeout bereits abgeschlossen ist, geschieht nichts.  Wenn nicht, umso schlimmer für ihn. <br><br>  Damit werde ich vielleicht enden.  Ich hoffe, dass Sie heute viele neue Dinge gelernt haben und vor allem - Sie haben alles verstanden, was Sie gelernt haben.  Wir sehen uns wieder. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de421537/">https://habr.com/ru/post/de421537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de421527/index.html">Broadcast-Start des Projekts "Server in the Clouds"</a></li>
<li><a href="../de421529/index.html">Netflix, Uber, Google und Sie bei MBLT DEV 2018</a></li>
<li><a href="../de421531/index.html">So integrieren Sie ReactJS in 1C-Bitrix mit der automatischen Generierung von Vorlagen im Back-End am Beispiel des Globus-Netzwerks</a></li>
<li><a href="../de421533/index.html">Auswahl einer Programmiersprache: 3 Tipps von einem Programmierer von Apple</a></li>
<li><a href="../de421535/index.html">Abenteuer - Elektronik. Auf einer geflügelten Schaukel in der IT-Welt</a></li>
<li><a href="../de421543/index.html">Klonen Sie eine kontaktlose Karte mit einer mobilen Anwendung</a></li>
<li><a href="../de421545/index.html">Testbericht zum PocketBook 616 - dem preisgünstigsten Taschenbuch für 2018 mit Hintergrundbeleuchtung</a></li>
<li><a href="../de421547/index.html">Akzeptanz unabhängiger Rechenzentren</a></li>
<li><a href="../de421549/index.html">Wir schreiben technische Dokumentation: eine Anleitung für den Laien</a></li>
<li><a href="../de421551/index.html">Vuex meistern - Von Null zu Held</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>