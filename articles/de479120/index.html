<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò∞ üëå üò® Die Wahlbeteiligung ist gescheitert: Wir bringen AgentTesla zu sauberem Wasser. Teil 2 ‚ÄºÔ∏è üëêüèΩ üò´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Wir setzen eine Reihe von Artikeln zur Malware-Analyse fort. Im ersten Teil sprachen wir dar√ºber, wie Ilya Pomerantsev, Experte f√ºr Schadcode-Analyse ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Die Wahlbeteiligung ist gescheitert: Wir bringen AgentTesla zu sauberem Wasser. Teil 2</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/group-ib/blog/479120/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/vz/an/r5/vzanr5kxitvhd3zqrcdh1qhctjm.png"></div><br>  Wir setzen eine Reihe von Artikeln zur Malware-Analyse fort.  Im <a href="https://habr.com/ru/company/group-ib/blog/478176/">ersten</a> Teil sprachen wir dar√ºber, wie Ilya Pomerantsev, Experte f√ºr Schadcode-Analyse bei CERT Group-IB, eine detaillierte Analyse einer Datei durchf√ºhrte, die per E-Mail von einem der europ√§ischen Unternehmen <b>empfangen wurde</b> , und dort <b>AgentTesla-Spyware entdeckte</b> .  In diesem Artikel pr√§sentiert Ilya die Ergebnisse einer <b>Phasenanalyse</b> des <b>AgentTesla-</b> Hauptmoduls. <br><a name="habracut"></a><br><blockquote> Agent Tesla ist eine modulare Spionagesoftware, die als Malware-as-a-Service unter dem Deckmantel eines legalen Keylogger-Produkts vertrieben wird.  Agent Tesla ist in der Lage, Benutzeranmeldeinformationen von Browsern, E-Mail-Clients und FTP-Clients zu extrahieren und an den Server f√ºr Angreifer zu √ºbertragen, Daten aus der Zwischenablage zu registrieren und den Bildschirm des Ger√§ts zu erfassen.  Zum Zeitpunkt der Analyse war die offizielle Website der Entwickler nicht verf√ºgbar. <br></blockquote><br><h2>  Konfigurationsdatei </h2><br>  In der folgenden Tabelle sind die Funktionen aufgef√ºhrt, die in dem verwendeten Beispiel verwendet werden: <br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Beschreibung</strong> <br></td><td>  <strong>Wert</strong> <br></td></tr><tr><td>  KeyLogger-Verwendungsflag <br></td><td>  wahr <br></td></tr><tr><td>  Flag f√ºr die Verwendung von ScreenLogger <br></td><td>  falsch <br></td></tr><tr><td>  Sendeintervall des KeyLogger-Protokolls in Minuten <br></td><td>  20 <br></td></tr><tr><td>  Sendeintervall des ScreenLogger-Protokolls in Minuten <br></td><td>  20 <br></td></tr><tr><td>  Flag zur Bearbeitung der R√ºcktaste.  Nur falsche Protokollierung.  True - l√∂scht den vorherigen Schl√ºssel <br></td><td>  falsch <br></td></tr><tr><td>  Geben Sie CnC ein.  Optionen: SMTP, Webpanel, FTP <br></td><td>  smtp <br></td></tr><tr><td>  Aktivierungsflag des Threads zum Beenden von Prozessen aus der Liste "% filter_list%" <br></td><td>  falsch <br></td></tr><tr><td>  UAC-Deaktivierungsflag <br></td><td>  falsch <br></td></tr><tr><td>  Task-Manager-Flag deaktivieren <br></td><td>  falsch <br></td></tr><tr><td>  CMD-Deaktivierungsflag <br></td><td>  falsch <br></td></tr><tr><td>  Fenster-Deaktivierungsflag ausf√ºhren <br></td><td>  falsch <br></td></tr><tr><td>  Deaktivieren Sie das Registrierungs-Viewer-Flag <br></td><td>  falsch <br></td></tr><tr><td>  Deaktivieren Sie die Systemwiederherstellungspunkte <br></td><td>  wahr <br></td></tr><tr><td>  Control Panel Disable Flag <br></td><td>  falsch <br></td></tr><tr><td>  MSCONFIG-Deaktivierungsflag <br></td><td>  falsch <br></td></tr><tr><td>  Deaktivierungsflag im Explorer-Kontextmen√º <br></td><td>  falsch <br></td></tr><tr><td>  System-Pin-Flag <br></td><td>  falsch <br></td></tr><tr><td>  Pfad zum Kopieren des Hauptmoduls beim Andocken im System <br></td><td>  % startupfolder% \\% insfolder% \\% insname% <br></td></tr><tr><td>  Flag zum Setzen der Attribute ‚ÄûSystem‚Äú und ‚ÄûSecretive‚Äú f√ºr das im System festgelegte Hauptmodul <br></td><td>  falsch <br></td></tr><tr><td>  Starten Sie das Ausf√ºhrungsflag neu, wenn Sie das Problem am System beheben <br></td><td>  falsch <br></td></tr><tr><td>  Flag zum Verschieben des Hauptmoduls in einen tempor√§ren Ordner <br></td><td>  falsch <br></td></tr><tr><td>  UAC Bypass Run Flag <br></td><td>  falsch <br></td></tr><tr><td>  Datums- und Uhrzeitformat f√ºr die Protokollierung <br></td><td>  JJJJ-MM-TT HH: MM: SS <br></td></tr><tr><td>  Flag, um den Programmfilter f√ºr KeyLogger zu verwenden <br></td><td>  wahr <br></td></tr><tr><td>  Art der Programmfilterung. <br>  1 - Der Programmname wird in den Fensterk√∂pfen gesucht <br>  2 - Der Programmname wird im Prozessnamen des Fensters gesucht <br></td><td>  1 <br></td></tr><tr><td>  Programmfilter <br></td><td>  Facebook <br>  Twitter <br>  Google Mail <br>  Instagram <br>  "Film", <br>  Skype <br>  "Porn", <br>  Hack <br>  WhatsApp <br>  Zwietracht <br></td></tr></tbody></table></div><br><h2>  Befestigung des Hauptmoduls im System </h2><br>  Wenn das entsprechende Flag gesetzt ist, wird das Hauptmodul entlang des Pfads kopiert, der in der Konfiguration als Pfad zum Fixieren im System angegeben ist. <br><br>  Abh√§ngig vom Wert aus der Konfiguration erh√§lt die Datei die Attribute ‚ÄûVersteckt‚Äú und ‚ÄûSystem‚Äú. <br>  Autostart wird von zwei Registrierungszweigen bereitgestellt: <br><br><ul><li>  <b>HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \% insregname%</b> </li><li>  <b>HKCU \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ StartupApproved \ Run \% insregname%</b> </li></ul><br>  Da sich der Bootloader in den <b>RegAsm-</b> Prozess <b>einf√ºgt</b> , f√ºhrt das Setzen des persistenten Flags f√ºr das Hauptmodul zu interessanten Konsequenzen.  Anstatt sich selbst zu kopieren, sicherte die Malware die urspr√ºngliche <b>RegAsm.exe-</b> Datei in dem System, in dem die Injektion ausgef√ºhrt wurde. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/a8/mx/in/a8mxinpopuoixolt4r7tiwulc70.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9p/-f/ui/9p-fui42mv7y06i5ivacsyh2zqm.png"></div><br><h2>  Interaktion mit C &amp; C </h2><br>  Unabh√§ngig von der verwendeten Methode beginnt die Netzwerkinteraktion mit dem <b><a href="http://checkip/">Abrufen</a></b> der externen IP des Opfers mit dem <b><a href="http://checkip/">H√§kchen</a> [.] Amazonaws [.] Com /</b> resource. <br>  Im Folgenden werden die in der Malware enthaltenen Netzwerkmethoden beschrieben. <br><br><h3>  Webpanel </h3><br>  Die Interaktion erfolgt √ºber das HTTP-Protokoll.  Die Malware f√ºhrt eine POST-Anforderung mit den folgenden Headern aus: <br><br><ul><li>  <b>User-Agent: Mozilla / 5.0 (Windows U Windows NT 6.1 Version: 1.9.2.3) Gecko / 20100401 Firefox / 4.0 (.NET CLR 3.5.30729)</b> </li><li>  <b>Verbindung: Keep-Alive</b> </li><li>  <b>Inhaltstyp: application / x-www-form-urlencoded</b> </li></ul><br>  Die Serveradresse ist auf <b>% PostURL% festgelegt</b> .  Die verschl√ºsselte Nachricht wird im Parameter <b>"p" √ºbergeben</b> .  Der Verschl√ºsselungsmechanismus wird im Abschnitt <b>‚ÄûVerschl√ºsselungsalgorithmen‚Äú (Methode 2) beschrieben</b> . <br><br>  Die √ºbertragene Nachricht lautet wie folgt: <br><br>  <b>type = {0} \ nhwid = {1} \ ntime = {2} \ npcname = {3} \ nlogdata = {4} \ nscreen = {5} \ nipadd = {6} \ nwebcam_link = {7} \ nclient = {8} \ nlink = {9} \ nusername = {10} \ npassword = {11} \ nscreen_link = {12}</b> <br><br>  Der Parameter <b>type</b> gibt den Nachrichtentyp an: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/lc/5l/yr/lc5lyrzbeie0jr9z-6dpzpylaze.jpeg"></div><br>  <b>hwid</b> - Ein MD5-Hash wird aus den Werten der Seriennummer des Motherboards und der Prozessor-ID geschrieben.  Wird h√∂chstwahrscheinlich als Benutzer-ID verwendet. <br>  <b>Uhrzeit</b> - dient zur √úbermittlung der aktuellen Uhrzeit und des aktuellen Datums. <br>  <b>pcname</b> - definiert als <b>&lt;Benutzername&gt; / &lt;Computername&gt;</b> . <br>  <b>logdata</b> - Protokolldaten. <br><br>  Bei der √úbermittlung von Passw√∂rtern sieht die Meldung folgenderma√üen aus: <br><br>  <b>type = {0} \ nhwid = {1} \ ntime = {2} \ npcname = {3} \ nlogdata = {4} \ nscreen = {5} \ nipadd = {6} \ nwebcam_link = {7} \ nscreen_link = {8} \ n [Passw√∂rter]</b> <br><br>  Es folgen Beschreibungen der gestohlenen Daten im Format <b>\ nClient [] = {0} \ nLink [] = {1} \ nBenutzername [] = {2} \ nKennwort [] = {3}</b> . <br><br><h3>  smtp </h3><br>  Die Interaktion erfolgt √ºber das SMTP-Protokoll.  Die √ºbermittelte Nachricht liegt im HTML-Format vor.  Der Parameter <b>BODY</b> lautet: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gh/vg/np/ghvgnpycvdbcsyyakmwjvfppnw4.png"></div><br>  Der Titel des Briefes hat die allgemeine Form: <b>&lt;BENUTZERNAME&gt; / &lt;COMPUTERNAME&gt; &lt;INHALTSTYP&gt;</b> .  Der Inhalt des Briefes sowie seine Anh√§nge werden nicht verschl√ºsselt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/x5/7c/5o/x57c5ojnqhgfpnec0jnsqix931c.jpeg"></div><br>  Die Interaktion erfolgt √ºber das FTP-Protokoll.  Eine Datei mit dem Namen <b>&lt;INHALTSTYP&gt; _ &lt;BENUTZERNAME&gt; - &lt;COMPUTERNAME&gt; _ &lt;DATUM UND UHRZEIT&gt; .html</b> wird auf den angegebenen Server √ºbertragen.  Der Inhalt der Datei wird nicht verschl√ºsselt. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/r-/2n/wr/r-2nwryzwnv7voneopya8y5aazq.jpeg"></div><br><h2>  Verschl√ºsselungsalgorithmen </h2><br>  In diesem Fall werden die folgenden Verschl√ºsselungsmethoden verwendet: <br><br><h3>  Methode 1 </h3><br>  Diese Methode wird verwendet, um Zeichenfolgen im Hauptmodul zu verschl√ºsseln.  F√ºr die Verschl√ºsselung wird der <b>AES-</b> Algorithmus <b>verwendet</b> . <br><br>  Die Eingabe ist eine sechsstellige Dezimalzahl.  Die folgende Transformation wird ausgef√ºhrt: <br><br>  <b>f (x) = (((x &gt;&gt; 2 - 31059) ^ 6380) - 1363) &gt;&gt; 3</b> <br><br>  Der resultierende Wert ist der Index f√ºr das eingebettete Datenarray. <br><br>  Jedes Element des Arrays ist eine <b>DWORD-</b> Sequenz.  Beim Kombinieren von <b>DWORD wird</b> ein Array von Bytes erhalten: Die ersten 32 Bytes sind der Verschl√ºsselungsschl√ºssel, gefolgt von 16 Bytes des Initialisierungsvektors, und die verbleibenden Bytes sind die verschl√ºsselten Daten. <br><br><h3>  Methode 2 </h3><br>  Der <b>3DES-</b> Algorithmus wird im <b>ECB-Modus</b> mit Auff√ºllung in ganzen Bytes ( <b>PKCS7</b> ) verwendet. <br><br>  Der Schl√ºssel wird durch den Parameter <b>% urlkey%</b> angegeben, sein MD5-Hash wird jedoch f√ºr die Verschl√ºsselung verwendet. <br><br><h2>  Sch√§dliche Funktionalit√§t </h2><br>  Das untersuchte Beispiel verwendet die folgenden Programme, um seine sch√§dliche Funktion zu implementieren: <br><br><h3>  Keylogger </h3><br>  Wenn es ein entsprechendes VPO-Flag gibt, das die WinAPI-Funktion verwendet, weist <b>SetWindowsHookEx</b> einen eigenen Handler f√ºr Tastaturtastenereignisse zu.  Die Handlerfunktion beginnt mit dem Abrufen des Titels des aktiven Fensters. <br><br>  Wenn das Flag zum Durchf√ºhren der Anwendungsfilterung gesetzt ist, wird die Filterung abh√§ngig vom angegebenen Typ durchgef√ºhrt: <br><br><ol><li>  Der Programmname wird in den Kopfzeilen des Fensters nachgeschlagen </li><li>  Der Programmname wird im Fenster Prozessname nachgeschlagen </li></ol><br>  Als N√§chstes wird dem Protokoll ein Datensatz mit Informationen zum aktiven Fenster im folgenden Format hinzugef√ºgt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bx/r0/cj/bxr0cj1srz9us2a4il4rwjfpoqo.png"></div><br>  Dann werden Informationen √ºber die gedr√ºckte Taste aufgezeichnet: <br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Schl√ºssel</strong> <br></td><td>  <strong>Aufnehmen</strong> <br></td></tr><tr><td>  R√ºcktaste <br></td><td>  Abh√§ngig vom Flag der Verarbeitung der R√ºcktaste: False - <font color="#008000">{BACK}</font> <br>  True - l√∂scht den vorherigen Schl√ºssel <br></td></tr><tr><td>  FESTSTELLTASTE <br></td><td>  <font color="#008000">{CAPSLOCK}</font> <br></td></tr><tr><td>  Esc <br></td><td>  <font color="#008000">{ESC}</font> <br></td></tr><tr><td>  PageUp <br></td><td>  <font color="#008000">{PageUp}</font> <br></td></tr><tr><td>  Runter <br></td><td>  <font color="#008000">darr;</font> <br></td></tr><tr><td>  L√ñSCHEN <br></td><td>  <font color="#008000">{DEL}</font> <br></td></tr><tr><td>  ‚Äú <br></td><td>  &amp; quot; <br></td></tr><tr><td>  F5 <br></td><td>  <font color="#008000">{F5}</font> <br></td></tr><tr><td>  &amp; <br></td><td>  &amp; amp; <br></td></tr><tr><td>  F10 <br></td><td>  <font color="#008000">{F10}</font> <br></td></tr><tr><td>  Tab <br></td><td>  <font color="#008000">{TAB}</font> <br></td></tr><tr><td>  &lt; <br></td><td>  &amp; lt; <br></td></tr><tr><td>  &gt; <br></td><td>  &amp; gt; <br></td></tr><tr><td>  Leertaste <br></td><td></td></tr><tr><td>  F8 <br></td><td>  <font color="#008000">{F8}</font> <br></td></tr><tr><td>  F12 <br></td><td>  <font color="#008000">{F12}</font> <br></td></tr><tr><td>  F9 <br></td><td>  <font color="#008000">{F9}</font> <br></td></tr><tr><td>  ALT + TAB <br></td><td>  <font color="#008000">{ALT + TAB}</font> <br></td></tr><tr><td>  Ende <br></td><td>  <font color="#008000">{ENDE}</font> <br></td></tr><tr><td>  F4 <br></td><td>  <font color="#008000">{F4}</font> <br></td></tr><tr><td>  F2 <br></td><td>  <font color="#008000">{F2}</font> <br></td></tr><tr><td>  STRG <br></td><td>  <font color="#008000">{STRG}</font> <br></td></tr><tr><td>  F6 <br></td><td>  <font color="#008000">{F6}</font> <br></td></tr><tr><td>  Richtig <br></td><td>  <font color="#008000">rarr;</font> <br></td></tr><tr><td>  Auf <br></td><td>  <font color="#008000">&amp; uarr;</font> <br></td></tr><tr><td>  F1 <br></td><td>  <font color="#008000">{F1}</font> <br></td></tr><tr><td>  Links <br></td><td>  <font color="#008000">&amp; larr;</font> <br></td></tr><tr><td>  Pagedown <br></td><td>  <font color="#008000">{PageDown}</font> <br></td></tr><tr><td>  Einf√ºgen <br></td><td>  <font color="#008000">{Einf√ºgen}</font> <br></td></tr><tr><td>  Gewinnen <br></td><td>  <font color="#008000">{Win}</font> <br></td></tr><tr><td>  Numlock <br></td><td>  <font color="#008000">{NumLock}</font> <br></td></tr><tr><td>  F11 <br></td><td>  <font color="#008000">{F11}</font> <br></td></tr><tr><td>  F3 <br></td><td>  <font color="#008000">{F3}</font> <br></td></tr><tr><td>  Zuhause <br></td><td>  <font color="#008000">{HOME}</font> <br></td></tr><tr><td>  ENTER <br></td><td>  <font color="#008000">{ENTER}</font> <br></td></tr><tr><td>  ALT + F4 <br></td><td>  <font color="#008000">{ALT + F4}</font> <br></td></tr><tr><td>  F7 <br></td><td>  <font color="#008000">{F7}</font> <br></td></tr><tr><td>  Ein weiterer Schl√ºssel <br></td><td>  Gro√ü- oder Kleinbuchstaben, abh√§ngig von der Position der Feststelltaste und der Umschalttaste <br></td></tr></tbody></table></div><br>  Mit einer bestimmten H√§ufigkeit wird das gesammelte Protokoll an den Server gesendet.  Wenn die √úbertragung fehlgeschlagen ist, wird das Protokoll in der Datei <b>% TEMP% \\ log.tmp</b> im folgenden Format gespeichert: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xn/pz/eb/xnpzeba3_y7ulwz0wesksvlspkg.png"></div><br>  Wenn der Timer abl√§uft, wird die Datei auf den Server √ºbertragen. <br><br><h3>  Screenlogger </h3><br>  Mit der angegebenen H√§ufigkeit erstellt die Malware einen Screenshot im <b>JPEG-</b> Format mit einem <b>Qualit√§tswert</b> von 50 und speichert ihn in der Datei <b>% APPDATA% \\ &lt;beliebige Sequenz von 10 Zeichen&gt; .jpg</b> .  Nach der √úbertragung wird die Datei gel√∂scht. <br><br><h3>  Zwischenablage-Logger </h3><br>  Wenn das entsprechende Flag gesetzt ist, werden Ersetzungen im abgefangenen Text gem√§√ü der folgenden Tabelle vorgenommen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xh/wc/y7/xhwcy7r4g5duormggz-texkxemi.jpeg"></div><br>  Danach wird der Text in das Protokoll eingef√ºgt: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ft/6l/2p/ft6l2pmpzecwtkh0hhgbblet30q.png"></div><br><h3>  PasswordStealer </h3><br>  Malware kann Kennw√∂rter aus den folgenden Anwendungen herunterladen: <br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Browser</strong> <br></td><td>  <strong>E-Mail-Clients</strong> <br></td><td>  <strong>FTP-Clients</strong> <br></td></tr><tr><td>  Chrome <br></td><td>  Ausblick <br></td><td>  Filezilla <br></td></tr><tr><td>  Firefox <br></td><td>  Thunderbird <br></td><td>  WS_FTP <br></td></tr><tr><td>  IE / Edge <br></td><td>  Foxmail <br></td><td>  Winscp <br></td></tr><tr><td>  Safari <br></td><td>  Opera Mail <br></td><td>  Coreftp <br></td></tr><tr><td>  Opera-Browser <br></td><td>  IncrediMail <br></td><td>  FTP Navigator <br></td></tr><tr><td>  Yandex <br></td><td>  Pocomail <br></td><td>  Flashfxp <br></td></tr><tr><td>  Comodo <br></td><td>  Eudora <br></td><td>  Smartftp <br></td></tr><tr><td>  Chromeplus <br></td><td>  Thebat <br></td><td>  FTPCommander <br></td></tr><tr><td>  Chrom <br></td><td>  Postfach <br></td><td></td></tr><tr><td>  Fackel <br></td><td>  Klauenpost <br></td><td></td></tr><tr><td>  7Star <br></td><td></td><td></td></tr><tr><td>  Amigo <br></td><td></td><td></td></tr><tr><td>  Bravesoftware <br></td><td>  <strong>Jabber-Kunden</strong> <br></td><td>  <strong>VPN-Clients</strong> <br></td></tr><tr><td>  Centbrowser <br></td><td>  Psi / psi + <br></td><td>  √ñffnen Sie VPN <br></td></tr><tr><td>  Chedot <br></td><td></td><td></td></tr><tr><td>  Coccoc <br></td><td></td><td></td></tr><tr><td>  Elementbrowser <br></td><td>  <strong>Manager herunterladen</strong> <br></td><td></td></tr><tr><td>  Epischer Datenschutz-Browser <br></td><td>  Internet-Download-Manager <br></td><td></td></tr><tr><td>  Kometa <br></td><td>  Jdownloader <br></td><td></td></tr><tr><td>  Orbitum <br></td><td></td><td></td></tr><tr><td>  Sputnik <br></td><td></td><td></td></tr><tr><td>  uCozMedia <br></td><td></td><td></td></tr><tr><td>  Vivaldi <br></td><td></td><td></td></tr><tr><td>  Seamonkey <br></td><td></td><td></td></tr><tr><td>  Flock-Browser <br></td><td></td><td></td></tr><tr><td>  Uc-Browser <br></td><td></td><td></td></tr><tr><td>  Blackhawk <br></td><td></td><td></td></tr><tr><td>  Cyberfox <br></td><td></td><td></td></tr><tr><td>  K-Meleon <br></td><td></td><td></td></tr><tr><td>  Icecat <br></td><td></td><td></td></tr><tr><td>  Icedragon <br></td><td></td><td></td></tr><tr><td>  Palemoon <br></td><td></td><td></td></tr><tr><td>  Wasserfuchs <br></td><td></td><td></td></tr><tr><td>  Falkon-Browser <br></td><td></td><td></td></tr></tbody></table></div><br><br><h2>  Dynamischen Analysen entgegenwirken <br></h2><br><ul><li>  Verwenden der <b>Sleep-</b> Funktion.  Erm√∂glicht das Umgehen einiger Sandk√§sten nach einer Zeit√ºberschreitung </li><li>  Zerst√∂ren des <b>Zone.Identifier-</b> Streams.  Erm√∂glicht das Ausblenden des Herunterladens einer Datei aus dem Internet </li><li>  Der Parameter <b>% filter_list%</b> legt die Liste der Prozesse fest, die die Malware im Abstand von einer Sekunde abschlie√üt </li><li>  Deaktivieren der <b>Benutzerkontensteuerung</b> </li><li>  Task-Manager deaktivieren </li><li>  <b>CMD</b> deaktivieren </li><li>  <b>Run-</b> Fenster deaktivieren </li><li>  Systemsteuerung deaktivieren </li><li>  <b>RegEdit Tool deaktivieren</b> </li><li>  Deaktivieren von Systemwiederherstellungspunkten </li><li>  Kontextmen√º im Explorer deaktivieren </li><li>  <b>Msconfig deaktivieren</b> </li><li>  <b>UAC-</b> Umgehung: <br></li></ul><br><h2>  Inaktive Funktionen des Hauptmoduls </h2><br>  W√§hrend der Analyse des Hauptmoduls wurden die Funktionen identifiziert, die f√ºr die Verteilung √ºber das Netzwerk und die Verfolgung der Position der Maus verantwortlich sind. <br><br><h3>  Wurm </h3><br>  In einem separaten Stream werden Verbindungsereignisse f√ºr Wechselmedien √ºberwacht.  Wenn eine Verbindung zum Stammverzeichnis des Dateisystems besteht, wird die <b>Malware</b> mit dem Namen <b>scr.exe</b> kopiert. <b>Anschlie√üend</b> wird nach Dateien mit der Erweiterung <b>lnk gesucht</b> .  Jeder <b>lnk-Befehl</b> √§ndert sich in <b>cmd.exe / c start scr.exe &amp; start &lt;urspr√ºnglicher Befehl&gt; &amp; exit</b> . <br><br>  Jedes Verzeichnis im Stammverzeichnis des Datentr√§gers erh√§lt das Attribut <b>Hidden</b> , und eine Datei mit der Erweiterung <b>lnk</b> wird mit dem Namen des ausgeblendeten Verzeichnisses und dem Befehl <b>cmd.exe / c start scr.exe &amp; explorer / root, \ "% CD% &lt;VERZEICHNISNAME&gt; \" &amp; exit erstellt</b> . <br><br><h3>  Mousetracker </h3><br>  Die Abfangmethode √§hnelt der f√ºr die Tastatur verwendeten.  Diese Funktionalit√§t befindet sich noch in der Entwicklung. <br><br><h2>  Dateiaktivit√§t </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Der Weg</strong> <br></td><td>  <strong>Beschreibung</strong> <br></td></tr><tr><td>  % Temp% \ temp.tmp <br></td><td>  Enth√§lt den Z√§hler f√ºr Versuche, die Benutzerkontensteuerung zu umgehen <br></td></tr><tr><td>  % startupfolder% \% insfolder% \% insname% <br></td><td>  M√∂glichkeit zur Konsolidierung im HPE-System <br></td></tr><tr><td>  % Temp% \ tmpG \ {Aktuelle Zeit in Millisekunden} .tmp <br></td><td>  Der Pfad f√ºr die Sicherung des Hauptmoduls <br></td></tr><tr><td>  % Temp% \ log.tmp <br></td><td>  Protokolldatei <br></td></tr><tr><td>  % AppData% \ {Beliebige Folge von 10 Zeichen} .jpeg <br></td><td>  Screenshots <br></td></tr><tr><td>  C: \ Users \ Public \ {Beliebige Folge von 10 Zeichen} .vbs <br></td><td>  Der Pfad zur vbs-Datei, die der Bootloader zum Schlie√üen des Systems verwenden kann <br></td></tr><tr><td>  % Temp% \ {Beliebiger Ordnername} \ {Dateiname} <br></td><td>  Der Pfad, den der Bootloader zum Andocken im System verwendet <br></td></tr></tbody></table></div><br><h2>  Eindringlingsprofil </h2><br>  Dank der ‚Äûverkabelten‚Äú Authentifizierungsdaten konnten wir auf die Kommandozentrale zugreifen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/q0/eb/nqq0ebtlfljriwj4m-97hm7-aww.png"></div><br>  Dadurch konnten wir die endg√ºltige Mail der Angreifer identifizieren: <br><br>  <b>junaid [.] in *** @ gmail [.] com</b> . <br><br>  Der Domainname der Kommandozentrale ist bei <b>sg *** @ gmail [.] Com</b> registriert. <br><br><h2>  Fazit </h2><br>  Im Rahmen einer detaillierten Analyse der bei dem Angriff verwendeten Malware konnten wir deren Funktionalit√§t ermitteln und die umfassendste Liste der f√ºr diesen Fall relevanten Kompromissindikatoren erhalten.  Das Verst√§ndnis der Mechanismen der Netzwerkinteraktion von Malvari erm√∂glichte es, Empfehlungen zur Anpassung der Funktionsweise von Informationsschutz-Tools abzugeben und stabile IDS-Regeln zu schreiben. <br><br>  Die Hauptgefahr von <b>AgentTesla</b> als DataStealer besteht darin, dass es zur Ausf√ºhrung seiner Aufgaben nicht erforderlich ist, eine Fixierung im System vorzunehmen oder auf einen Steuerbefehl zu warten.  Sobald er auf der Maschine ist, beginnt er sofort mit der Erfassung privater Informationen und √ºbertr√§gt diese an CnC.  Ein solches aggressives Verhalten √§hnelt in gewisser Weise dem Verhalten von Kryptographen, mit dem einzigen Unterschied, dass diese nicht einmal eine Netzwerkverbindung ben√∂tigen.  Im Falle einer Kollision mit dieser Familie, nachdem das infizierte System von Malware selbst befreit wurde, m√ºssen alle Kennw√∂rter ge√§ndert werden, die zumindest theoretisch in einer der oben genannten Anwendungen gespeichert werden k√∂nnten. <br><br>  <b>Nehmen</b> wir an, dass Angreifer, die <b>AgentTesla</b> senden, den anf√§nglichen Bootloader sehr h√§ufig √§ndern.  Dies erm√∂glicht es Ihnen, zum Zeitpunkt des Angriffs von statischen Scannern und heuristischen Analyseger√§ten unbemerkt zu bleiben.  Und die Tendenz dieser Familie, ihre T√§tigkeit sofort aufzunehmen, macht Systemmonitore unbrauchbar.  Der beste Weg, mit AgentTesla umzugehen, ist eine vorl√§ufige Analyse in der Sandbox. <br><br>  Im dritten Artikel dieser Serie werden andere von <b>AgentTesla</b> verwendete Bootloader <b>vorgestellt</b> und der Prozess des halbautomatischen Entpackens <b>erl√§utert</b> .  Verpassen Sie es nicht! <br><br><h2>  Hash </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>SHA1</strong> <br></td></tr><tr><td>  A8C2765B3D655BA23886D663D22BDD8EF6E8E894 <br></td></tr><tr><td>  8010CC2AF398F9F951555F7D481CE13DF60BBECF <br></td></tr><tr><td>  79B445DE923C92BF378B19D12A309C0E9C5851BF <br></td></tr><tr><td>  15839B7AB0417FA35F2858722F0BD47BDF840D62 <br></td></tr><tr><td>  1C981EF3EEA8548A30E8D7BF8D0D61F9224288DD <br></td></tr></tbody></table></div><br><h2>  C &amp; C </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>URL</strong> <br></td></tr><tr><td>  sina-c0m [.] icu <br></td></tr><tr><td>  smtp [.] sina-c0m [.] icu <br></td></tr></tbody></table></div><br><br><h2>  Regkey </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Registry</strong> <br></td></tr><tr><td>  HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \ {Skriptname} <br></td></tr><tr><td>  HKCU \ Software \ Microsoft \ Windows \ CurrentVersion \ Run \% insregname% <br></td></tr><tr><td>  HKCU \ SOFTWARE \ Microsoft \ Windows \ CurrentVersion \ Explorer \ StartupApproved \ Run \% insregname% <br></td></tr></tbody></table></div><br><h3>  Mutex </h3><br>  Keine Indikatoren. <br><br><h3>  Dateien </h3><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Dateiaktivit√§t</strong> <br></td></tr><tr><td>  % Temp% \ temp.tmp <br></td></tr><tr><td>  % startupfolder% \% insfolder% \% insname% <br></td></tr><tr><td>  % Temp% \ tmpG \ {Aktuelle Zeit in Millisekunden} .tmp <br></td></tr><tr><td>  % Temp% \ log.tmp <br></td></tr><tr><td>  % AppData% \ {Beliebige Folge von 10 Zeichen} .jpeg <br></td></tr><tr><td>  C: \ Users \ Public \ {Beliebige Folge von 10 Zeichen} .vbs <br></td></tr><tr><td>  % Temp% \ {Beliebiger Ordnername} \ {Dateiname} <br></td></tr></tbody></table></div><br><h2>  Proben Info </h2><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Name</strong> <br></td><td>  Unbekannt <br></td></tr><tr><td>  <strong>MD5</strong> <br></td><td>  F7722DD8660B261EA13B710062B59C43 <br></td></tr><tr><td>  <strong>SHA1</strong> <br></td><td>  15839B7AB0417FA35F2858722F0BD47BDF840D62 <br></td></tr><tr><td>  <strong>SHA256</strong> <br></td><td>  41DC0D5459F25E2FDCF8797948A7B315D3CB0753 <br>  98D808D1772CACCC726AF6E9 <br></td></tr><tr><td>  <strong>Typ</strong> <br></td><td>  PE (.NET) <br></td></tr><tr><td>  <strong>Gr√∂√üe</strong> <br></td><td>  327680 <br></td></tr><tr><td>  <strong>Orginalname</strong> <br></td><td>  AZZRIDKGGSLTYFUBCCRRCUMRKTOXFVPDKGAGPUZI_20190701133545943.exe <br></td></tr><tr><td>  <strong>Datenstempel</strong> <br></td><td>  07/01/2019 <br></td></tr><tr><td>  <strong>Compiler</strong> <br></td><td>  Vb.net <br></td></tr></tbody></table></div><br><div class="scrollable-table"><table><tbody><tr><td>  <strong>Name</strong> <br></td><td>  IELibrary.dll <br></td></tr><tr><td>  <strong>MD5</strong> <br></td><td>  BFB160A89F4A607A60464631ED3ED9FD <br></td></tr><tr><td>  <strong>SHA1</strong> <br></td><td>  1C981EF3EEA8548A30E8D7BF8D0D61F9224288DD <br></td></tr><tr><td>  <strong>SHA256</strong> <br></td><td>  D55800A825792F55999ABDAD199DFA54F3184417 <br>  215A298910F2C12CD9CC31EE <br></td></tr><tr><td>  <strong>Typ</strong> <br></td><td>  PE (.NET DLL) <br></td></tr><tr><td>  <strong>Gr√∂√üe</strong> <br></td><td>  16896 <br></td></tr><tr><td>  <strong>Orginalname</strong> <br></td><td>  IELibrary.dll <br></td></tr><tr><td>  <strong>Datenstempel</strong> <br></td><td>  10/11/2016 <br></td></tr><tr><td>  <strong>Compiler</strong> <br></td><td>  Microsoft Linker (48.0 *) <br></td></tr></tbody></table></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de479120/">https://habr.com/ru/post/de479120/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de479100/index.html">Front-End-Dojo: Projekte zur Schulung von Entwicklerf√§higkeiten (5 neue + 43 alte)</a></li>
<li><a href="../de479102/index.html">Bekanntschaft mit Yandex.Maps oder Wie sehr ich Dokumentation liebe</a></li>
<li><a href="../de479106/index.html">Wie viel kosten Zaubertricks?</a></li>
<li><a href="../de479108/index.html">Ritterleben - Online-Arena mit RPG-Elementen</a></li>
<li><a href="../de479116/index.html">Impressionen bei der Suche Y. Direct: Warum Sie das 1,5-fache pro Klick bezahlen</a></li>
<li><a href="../de479122/index.html">So starten Sie ein Haustierprojekt und erhalten keine Vorteile</a></li>
<li><a href="../de479124/index.html">[Infografik] K√ºnstliche Intelligenz in Science Fiction</a></li>
<li><a href="../de479126/index.html">Python in der mobilen Entwicklung</a></li>
<li><a href="../de479128/index.html">Wie funktioniert der medizinische Dienst am Flughafen?</a></li>
<li><a href="../de479132/index.html">Externe Komponente f√ºr 1C Mobile-Plattform (BroadcastReceiver)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>