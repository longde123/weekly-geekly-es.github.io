<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-143967986-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-143967986-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ì ü•Å üö∂üèø Secured by Knox - Samsung Mobile Security Mechanisms üë©üèø‚Äçü§ù‚Äçüë©üèΩ üë©üèΩ‚Äçüéì üèéÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you have a Samsung phone, you may have noticed the phrase ‚ÄúSecured by Knox‚Äù on the boot screen. What does that even mean? Under the cut - a descrip...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Secured by Knox - Samsung Mobile Security Mechanisms</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/samsung/blog/479376/">  If you have a Samsung phone, you may have noticed the phrase ‚ÄúSecured by Knox‚Äù on the boot screen.  What does that even mean?  Under the cut - a description of the mobile security platform preloaded on most Samsung smartphones and tablets.  This is the first Russian-language review of what mechanisms generally exist in the Knox solution. <br><br><img src="https://habrastorage.org/webt/ji/sq/oc/jisqoc773l_lo50wzk3b1kpdru4.jpeg"><br><a name="habracut"></a><br><h1>  Introduction </h1><br>  In 2019, Samsung Electronics celebrated 50 years, and this year was also marked by another round date - 10 years since the release of the first Galaxy device - the GT-I7500.  This is what this model looked like: <br><br><img src="https://habrastorage.org/webt/lw/2v/d4/lw2vd4s1wq2xbuxr9s3dpzwte0o.png"><br><br>  By today's standards, the phone had very modest characteristics: a 3.2-inch screen and a processor with a clock speed of only 528 MHz, was running one of the first versions of the Android OS.  Strictly speaking, in 2009 the model was not unique: there were devices on the open Android OS with similar hardware characteristics on the ARM platform on the market.  It was clear that success requires a ‚Äúhighlight‚Äù that sets the company apart from the rest. <br><br>  Undoubtedly, the openness of the operating system influenced the success of the Android OS: according <a href="https://www.idc.com/promo/smartphone-market-share">to</a> IDC <a href="https://www.idc.com/promo/smartphone-market-share">estimates</a> for October 2019, it was installed on 87% of smartphones sold, and this number continues to grow.  But then, and now, the Android security issue is one of the topics that are often discussed. <br><br>  Samsung introduced the Knox platform as a response to the challenges in the field of information security of mobile devices.  The first edition of Knox (the old name is ‚ÄúSAFE‚Äù or ‚ÄúSamsung for Enterprise‚Äù) was released in 2012 along with the Galaxy S3. <br><br><img src="https://habrastorage.org/webt/cd/75/ra/cd75raxkvpgvyglnqic5ns8zy6i.png"><br><br>  The latest majority version of the platform (3.0) was released with the Galaxy S9 in 2018. The current version at the time of writing is 3.4.  The name Knox comes from Fort Knox, one of the most secure gold holdings in the world. <br><br><img src="https://habrastorage.org/webt/qa/q-/zl/qaq-zljfdmwawj52l3d-bodkbji.png"><br><br>  What is Knox?  Now under this name (or more correctly a brand) is understood everything that is connected in Samsung with mobile security.  This includes the <a href="https://www.samsung.com/ru/apps/samsung-pass/">Samsung Pass</a> password manager, <a href="https://www.samsung.com/uk/support/mobile-devices/what-is-the-secure-folder-and-how-do-i-use-it/">Secure Folder</a> , <a href="https://www.samsung.com/ru/apps/mobile/samsungpay/">Samsung Pay</a> payment service, and a whole family of <a href="https://www.samsungknox.com/en/solutions/it-solutions">enterprise solutions</a> , but this is based on the Knox platform. <br><br><img src="https://habrastorage.org/webt/pq/jh/7v/pqjh7vhgbitywodgj76qqn1vz3a.png"><br><br>  An important feature of the Samsung Knox platform is that it is based on hardware mechanisms.  Samsung, as a manufacturer of hardware components, can control the entire process of production, assembly and configuration of the device, and, therefore, design security mechanisms based on hardware capabilities. <br><br>  This includes the following principles: <br><br><ul><li>  System security is built on the hardware root of trust (HW Root of Trust). <br></li><li>  Device security monitoring should begin at boot time. <br></li><li>  Safety monitoring is mandatory and regular during device operation. <br></li><li>  The system must have a mechanism in place that allows third-party systems to prove their integrity. <br></li><li>  The main value of the device is user data.  Their protection is a system priority. <br></li></ul><br>  Particular attention in the development of the Knox platform is given to specific corporate requirements for device security.  Mobile phones have become a working tool: it‚Äôs not only the usual office work for everyone (mail, messengers, office suite), but also more exotic options: a phone as a cash register, a scanner in a warehouse, or even a guide in a museum.  For companies, the ability to manage these mobile jobs is important. <br><br>  The Knox platform also solves this problem: <br><br><ul><li>  Corporate data on the device should be conveniently managed. <br></li><li>  The corporate device must have centralized monitoring and control mechanisms. <br></li><li>  The above items should not be implemented to the detriment of the privacy of the end user. <br></li></ul><br>  Further details about the device platform Samsung Knox. <br><br><h1>  Building a trusted environment </h1><br>  Before delving into the consideration of individual mechanisms, a few words should be said about the basis of all the hardware mechanisms for protecting the Knox platform - TrustZone-based Integrity Measurement Architecture (TIMA).  It is based on the ARM TrustZone Framework. <br><br>  There are 2 ‚Äúworlds‚Äù (areas) in the TrustZone paradigm: <br><br><ul><li>  Secure <br></li><li>  Normal or Non-secure ("Normal" or "Insecure" world) <br></li></ul><br>  Their separation is carried out at the hardware level and is controlled by a separate component called Monitor.  It looks like this: <br><br><img src="https://habrastorage.org/webt/om/5p/uv/om5puvixzxq1rddx_gpcch7rym4.png"><br>  <i>Source: <a href="http://www.arm.com/">www.arm.com</a></i> <br><br>  The functionality of the phone is divided between these two areas as follows: <br><br>  Secure World: <br><ul><li>  Sensitive computing (for example, encryption). <br></li><li>  Protection of critical information. <br></li><li>  Monitoring the state of the kernel of the OS running in Normal World. <br></li><li>  Access to memory and devices marked as Secure (can only be accessed from Secure World). <br></li></ul><br>  Normal World: <br><ul><li>  Running the main OS and all user applications. <br></li><li>  Applications running on Secure World are the most privileged, and can access the resources of both environments (both Secure World and Normal World).  Under normal conditions, applications from Normal World cannot access Secure World resources directly. <br></li></ul><br>  From the basics, let's move on to the protection mechanisms themselves in the Knox platform. <br><br><h2>  Hardware Root of Trust </h2><br>  Already at the time of production at the factory, during the installation of software (software), cryptographic keys are created on the mobile device.  Consider 2 main keys: <br><br><ul><li>  Device Unique Hardware Key (DUHK) or Device Unique Hardware Key.  A symmetric key unique to each device, which is created directly on the device using a hardware random number generator.  Information encrypted with this key can only be decrypted on the same device.  DUHK is available only to the hardware encryption module and is not available to any software on the device.  Using DUHK, the remaining cryptographic keys on the device are encrypted.  When we say that a component is tied to a device, most often it is the use of this key. <br></li><li>  Device Root Key (DRK) or Device Root Key.  Unique for each device a pair of asymmetric keys (RSA), signed by the root certificate (X.509) Samsung.  DRK is protected by DUHK and is only available from Secure World.  It uniquely identifies the device and confirms that it is manufactured by Samsung. <br></li></ul><br>  With the above approach, the keys are difficult to compromise or forge, the encrypted data is firmly tied to the hardware, they cannot be transferred and read on another device. <br><br><img src="https://habrastorage.org/webt/9i/st/7q/9ist7qb8ybldgvlncddgw5woee8.png"><br>  <i>Device manufacturing at Samsung Electronics, Gumi, South Korea</i> <br><br><h2>  Download device </h2><br><h3>  Secure Boot </h3><br>  The device boot process consists of a chain of bootloaders, each of which checks the signature of the next component, and then starts it.  If the verification fails, the download process is interrupted.  This mechanism is called Secure Boot. In its work, it uses the Samsung Secure Boot Key (SSBK), an asymmetric key pair in hardware storage. <br>  Secure Boot ensures that the device boots only using trusted Samsung bootloaders.  If one of the bootloaders is compromised, then the device starts to stop, preventing potential compromise of the device. <br><br><h3>  Trusted Boot </h3><br>  Secure Boot by verifying the signature solves the problem of third-party bootloaders, but does not solve the problem of old, irrelevant versions that potentially carry a number of known vulnerabilities.  Therefore, the Trusted Boot mechanism has been developed, working on top of Secure Boot.  It checks the relevance of the bootloader version.  Test results are written to protected memory in TrustZone Secure World and can be used for future checks. <br><br><h3>  Knox Verified Boot (KVB) </h3><br>  When the OS starts loading, another mechanism called Knox Verified Boot is activated.  KVB is an extension of the <a href="https://source.android.com/security/verifiedboot">Android Verified Boot (AVB)</a> engine.  In addition to the standard metrics controlled by AVB, KVB also takes into account the results obtained by Trusted Boot and Secure Boot (i.e. bootloader integrity and relevance).  Due to the execution of all KVB operations in the bootloader, this check is reliable and safe (the procedure is carried out outside the checked object). <br><br>  The Knox Verified Boot component is fairly new and is supported by devices starting with the Samsung S10 running Android P or later. <br><br>  Graphically, the boot process of a device protected by Knox mechanisms can be represented as follows: <br><br><img src="https://habrastorage.org/webt/rc/sm/wh/rcsmwh6rv9dgqnapro-h_pw5q-i.png"><br><br><h2>  Knox Warranty Bit Hardware Flag </h2><br>  Knox Warranty Bit is a security feature that allows you to record the fact of installing an unofficial version of system software on a device.  Devices with an activated Warranty Bit cannot use some functionality, for example, Knox Workspace.  The flag cannot be returned to its original state.  It ensures that the Samsung device has previously only been launched with a trusted OS. <br><br><img src="https://habrastorage.org/webt/uz/ge/c1/uzgec1ffupxinc8dz6k__pbqc_g.png"><br>  <i>Fig.</i>  <i>Custom firmware on the left, KNOX WARRANTY VOID 0x1</i> <br><br><h2>  Hardware lock back to old software versions (Rollback Prevention) </h2><br>  Older versions of bootable components may contain vulnerabilities.  Rollback prevention - a function that blocks the return to an older version of the OS.  The minimum bootloader version possible for firmware is stored in a protected area.  The smallest possible version of the OS kernel is stored in the bootloader itself.  With a regular system update, the minimum allowable versions of the bootloader and OS are increased.  Going back to a previous or earlier version is not possible. <br><br><img src="https://habrastorage.org/webt/ud/md/7r/udmd7r9tihjxe01q4dazefde6es.png"><br><br>  <i>It is impossible to return from Android P to Android O.</i> <br><br><h1>  Trusted Environment Integrity </h1><br>  After startup, the integrity of the system must be checked regularly.  There are several mechanisms for this in Knox. <br><br><h2>  Periodic Kernel Measurement Component (PKM) </h2><br>  PKM periodically monitors the OS for modifications to its components from the time it boots.  As part of the verification, the kernel checksums and the status of the SE for Android subsystem are tracked (we'll talk about it a bit later).  PKM works for Secure World.  Thus, any abnormal modification of the OS kernel will be detected. <br><img src="https://habrastorage.org/webt/gi/2l/vp/gi2lvpl14r3ydnnnxffmjc4uccy.png"><br><h2>  Real-time Kernel Protection (RKP) component </h2><br>  Trusted Boot protects against loading the modified kernel, but the kernel may be attacked while the device is running.  Constant monitoring of code integrity and critical data is required.  RKP is a security monitoring located in an isolated environment - either in the ARM TrustZone Secure World, or in a ‚Äúthin‚Äù hypervisor protected by virtualization hardware extensions. <br><br>  RKP uses special methods to monitor memory management in Normal World, intercept critical requests and evaluate their impact before they are executed.  The real-time kernel protection mechanism complements periodic kernel integrity checks (PKMs). <br><br><img src="https://habrastorage.org/webt/or/pg/fz/orpgfzbwlrlz4ecmawonl5derwe.png"><br><br>  Thus, Real-Time Kernel Protection is a guarantee of protection against malicious code execution at the OS kernel level. <br><br><h1>  Trusted Environment Integrity Check </h1><br>  Mobile devices do not work in isolation, usually they are part of some larger system, for example, they are server clients, computing nodes, etc. And for the system to work stably and safely, it must be sure that all its components are ‚Äúhealthy‚Äù and they are who they say they are.  This is a rather difficult task; within the framework of the Knox platform, it is solved using the remote certification mechanism. <br><br><h2>  Remote device certification (Knox Attestation) </h2><br>  Remote certification allows a third-party system to make a conclusion about the state of the end device.  The following parameters are checked, in particular: <br><ul><li>  measurements collected during the Trusted Boot boot process; <br></li><li>  security breach logs from PKM and RKP mechanisms since the last reboot; <br></li><li>  Knox Warranty Bit status <br></li><li>  Various device identifiers, such as IMEI. <br></li></ul><br><img src="https://habrastorage.org/webt/jv/jx/wf/jvjxwfgzyxpkbky-jcwp45mcg-i.png"><br><br>  The certification message is generated in the ARM TrustZone Secure World.  It is correct even if the OS in Normal World is compromised. <br><br>  In addition to checking individual parameters, certification also evaluates the state of the system as a whole.  Only when the measurements collected by the Trusted Boot correspond to the reference values ‚Äã‚Äãand the Knox Warranty Bit value is not changed, the certification is considered passed. <br><br>  The certification message cannot be falsified because it is signed using the Samsung Attestation Key (SAK), derived from the Samsung root key.  The remote server can verify the integrity of the message using the Samsung root key.  The signature contains a cryptographic ‚Äúadditive‚Äù generated on the server side (a random number that is used only once) to prevent the attacker from using the old validation message on an already compromised device. <br><br>  The third-party system may decide on further actions based on the results of certification, depending on security policies.  For example, you can disconnect from the device, erase content in a secure workspace, request the location of the device, and perform many other actions. <br><br><h1>  Data protection </h1><br>  Data is the core value of a mobile device and requires separate protection mechanisms. <br><br><h2>  Internal Storage Encryption </h2><br>  Full encryption of the internal memory is a prerequisite for all devices based on Android OS from version 7. Knox develops this concept by storing the key in a secure hardware key storage. <br><br><img src="https://habrastorage.org/webt/hs/qo/qv/hsqoqvglpag0gkoxahahauopgyy.png"><br><br><h2>  Security Enhancements (SE) for Android </h2><br>  Samsung Knox uses the Security Enhancement for Android (Security Enhancement for Android, SE for Android), which adds Mandatory Access Control (MAC) to the OS. <br><br>  SE for Android provides two levels of MAC protection: <br><br><ol><li>  Kernel Protection <br></li><li>  Android middleware protection <br></li></ol><br>  SE goals for Android include isolating data and applications, restricting the rights of system processes, including those executed on behalf of a superuser. <br><img src="https://habrastorage.org/webt/b6/nw/5v/b6nw5vqnnzfhramc3jpftph7i2o.png"><br><br><h2>  Knox Containerization </h2><br>  One particular use case for the SE for Android engine is the Knox container. <br>  A container divides applications and data into two independent spaces: a regular and a protected area.  The data of the protected area is stored in encrypted form in the internal memory.  Encryption keys, in turn, are encrypted using a DUHK key, i.e.  they are tied to a specific device.  If the device is compromised (Knox Warranty Bit, Trusted Boot, etc.), access to the container is blocked. <br><br>  It is important to note that the applications installed in the container work, in fact, in a normal environment.  As a result, an application written for Android runs in a container without any adaptations or changes to the source code. <br><br>  Containerization technology is used in several Samsung products, such as Secure Folder and Knox Workspace. <br><br><img src="https://habrastorage.org/webt/w_/6y/lo/w_6ylomf7912tata00bflfuw_be.jpeg"><br><br><h1>  Business Opportunities </h1><br>  All of the above mechanisms are of particular importance when using mobile devices in a corporate environment.  This issue deserves a separate consideration, so here we restrict ourselves to the picture: <br><br><img src="https://habrastorage.org/webt/8h/6y/me/8h6yme-5xqezctqkw-2lcpeq9ou.png"><br><br>  Additional sources on the topic: <br><br><ul><li>  <a href="https://docs.samsungknox.com/admin/Content/whitepaper/kpe/samsung-knox.htm">Knox platform whitepaper</a> </li><li>  <a href="https://www.samsungknox.com/en/blog/samsung-trusted-boot-and-trustzone-integrity-management-explained">Trusted Boot and TrustZone Integrity Management explained</a> </li><li>  <a href="https://www.samsungknox.com/en/blog/real-time-kernel-protection-rkp">Real-time Kernel Protection</a> </li><li>  <a href="https://docs.samsungknox.com/dev/knox-attestation/about-attestation.htm">Knox attestation</a> </li></ul><br><br><img src="https://habrastorage.org/webt/6l/x6/gw/6lx6gw9jbzcy4jno3vq7k94brca.jpeg" align="left">  Posted by: Vladimir Karacharov, <br>  Manager, B2B Pre / Post Sales <br>  Business development team <br>  Samsung R&amp;D Institute Russia </div></div><p>Source: <a href="https://habr.com/ru/post/479376/">https://habr.com/ru/post/479376/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../479364/index.html">Rating of the best CPUs for gaming PCs in 2019</a></li>
<li><a href="../479366/index.html">Friday Mobile Survey Results</a></li>
<li><a href="../479368/index.html">How to achieve CMM Level 5 QA and Testing</a></li>
<li><a href="../479370/index.html">DIY capture of Mifare crypto keys and do-it-yourself copying of IronLogic doorphone keys</a></li>
<li><a href="../479374/index.html">Take care of your dongles: Logitech keyboard receiver security study</a></li>
<li><a href="../479378/index.html">Think SRE: look at projects through the eyes of an SRE engineer</a></li>
<li><a href="../479382/index.html">Accelerated Development with Spring Boot DevTools</a></li>
<li><a href="../479384/index.html">What does Big Data do in MegaFon and how to get there?</a></li>
<li><a href="../479388/index.html">Features of the construction of national data centers, Mikhalych</a></li>
<li><a href="../479392/index.html">Pinebook Pro: No longer Chromebook</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter54458986 = new Ya.Metrika({
                  id:54458986,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/54458986" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-143967986-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=IU0EG0jaqnehka2lu5TyzAcchrZXI4Yb1QXKQvJxpqE&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>