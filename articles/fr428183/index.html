<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚û°Ô∏è üëΩ üåì Impl√©mentation de l'algorithme de Levenberg-Marquardt pour l'optimisation des r√©seaux de neurones sur TensorFlow üë®üèº‚Äçüöí üë®üèΩ‚Äçüé® üë©üèæ‚Äçüíº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Il s'agit d'un didacticiel de la biblioth√®que TensorFlow. Consid√©rez-le un peu plus profond√©ment que dans les articles sur la reconnaissance des nombr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Impl√©mentation de l'algorithme de Levenberg-Marquardt pour l'optimisation des r√©seaux de neurones sur TensorFlow</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/428183/"><p>  Il s'agit d'un didacticiel de la biblioth√®que TensorFlow.  Consid√©rez-le un peu plus profond√©ment que dans les articles sur la reconnaissance des nombres manuscrits.  Ceci est un tutoriel sur les m√©thodes d'optimisation.  Ici, vous ne pouvez pas vous passer des math√©matiques.  Ce n'est pas grave si vous l'avez compl√®tement oubli√©.  Rappel.  Il n'y aura pas de preuves formelles et de conclusions complexes, seulement le minimum n√©cessaire pour une compr√©hension intuitive.  Pour commencer, un petit aper√ßu de la fa√ßon dont cet algorithme peut √™tre utile pour optimiser un r√©seau de neurones. </p><br><img src="https://habrastorage.org/webt/ka/vv/kh/kavvkhi2wic8-bj1_-6i4zjvkpe.jpeg"><br><br><p>  Il y a six mois, un ami m'a demand√© de montrer comment cr√©er un r√©seau neuronal en Python.  Sa soci√©t√© produit des instruments de mesures g√©ophysiques.  Plusieurs sondes diff√©rentes lors du forage mesurent un ensemble de signaux associ√©s aux param√®tres de l'environnement entourant le puits.  Dans certains cas complexes, calculez avec pr√©cision les param√®tres environnementaux √† partir de signaux pendant une longue p√©riode, m√™me sur un ordinateur puissant, et il est n√©cessaire d'interpr√©ter les r√©sultats de mesure sur le terrain.  Il y avait une id√©e de compter plusieurs centaines de milliers de cas sur un cluster, et de former un r√©seau neuronal sur eux.  Le r√©seau neuronal √©tant tr√®s rapide, il peut √™tre utilis√© pour d√©terminer des param√®tres coh√©rents avec les signaux mesur√©s, en plein processus de forage.  Les d√©tails sont dans l'article: </p><br><p>  Kushnir, D., Velker, N., Bondarenko, A., Dyatlov, G., et Dashevsky, Y. (2018, 29 octobre).  Simulation en temps r√©el de l'outil de r√©sistivit√© azimutale profonde dans un mod√®le de d√©faut 2D √† l'aide de r√©seaux de neurones (russe).  Soci√©t√© des ing√©nieurs p√©troliers.  doi: 10.2118 / 192573-RU </p><br><p>  Un soir, j'ai montr√© comment les keras pouvaient impl√©menter un r√©seau neuronal simple, et un ami au travail a commenc√© √† s'entra√Æner sur les donn√©es compt√©es.  Apr√®s quelques jours, nous avons discut√© du r√©sultat.  De mon point de vue, il avait l'air prometteur, mais un ami a dit qu'il avait besoin de calculs avec la pr√©cision de l'appareil.  Et si l' <em>erreur quadratique moyenne</em> s'est av√©r√©e √™tre d'environ 1, alors 1e-3 √©tait n√©cessaire.  3 commandes de moins.  Mille fois. </p><a name="habracut"></a><br><p>  Les exp√©riences avec l'architecture des r√©seaux de neurones, la normalisation des donn√©es et les approches d'optimisation n'ont donn√© presque rien.  Quelques semaines plus tard, un ami a appel√© et a dit qu'il avait install√© MatLab et avait r√©solu le probl√®me par la m√©thode <em>Levenberg-Marquardt</em> (ci-apr√®s nous appellerons <em>LM</em> ).  Il a √©t√© optimis√© pendant longtemps (plusieurs jours), il n'a pas fonctionn√© sur le GPU, mais le r√©sultat √©tait le bon.  Cela ressemblait √† un d√©fi. </p><br><p>  Une recherche rapide d'un optimiseur LM pr√™t √† l'emploi pour les k√©ros ou TensorFlow a √©chou√©.  Je ne suis tomb√© que sur la biblioth√®que pyrenn, mais sa fonctionnalit√© me semblait m√©diocre.  J'ai d√©cid√© de le mettre en ≈ìuvre moi-m√™me.  √Ä premi√®re vue, tout avait l'air simple et deux soir√©es auraient d√ª suffire.  Cela a pris plus de temps.  Il y avait deux probl√®mes: </p><br><ol><li>  TensorFlow.  Un tas d'articles, mais presque tous les niveaux "mais √©crivons <s>bonjour la</s> reconnaissance des chiffres manuscrits du <s>monde</s> ." </li><li>  Math  J'ai beaucoup oubli√©, et les auteurs d'articles math√©matiques ne se soucient pas du tout de gens comme moi: des formules solides sans explication, "√©videmment!"  et ainsi de suite. </li></ol><br><p>  En cons√©quence, il a √©crit un article pour ceux qui ont oubli√© les math√©matiques et veulent comprendre TensorFlow un peu plus profond√©ment, mais sans hardcore.  L'article contient beaucoup de texte et peu de code.  L'option oppos√©e, lorsqu'il y a peu de texte et beaucoup de code, est ici <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Jupyter Notebook Levenberg-Marquardt</a> . </p><br><h4>  D√©couvrez la fonction Rosenbrock </h4><br><p>  Nous g√©n√©rerons des donn√©es d'entra√Ænement <em>par la fonction Rosenbrock</em> , qui est souvent utilis√©e comme r√©f√©rence pour les algorithmes d'optimisation: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-7" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mo" id="MJXp-Span-9" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-11" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-13"><span class="MJXp-mo" id="MJXp-Span-14" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-15" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-16" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-18" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-20" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-21"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-23" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-24"><span class="MJXp-mo" id="MJXp-Span-25" style="margin-left: 0em; margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-26" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.05ex" height="3.021ex" viewBox="0 -987.6 13368.8 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMATHI-78" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-2C" x="1512" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMATHI-79" x="1957" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-29" x="2455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-3D" x="3122" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-28" x="4178" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMATHI-61" x="4568" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-2212" x="5319" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMATHI-78" x="6320" y="0"></use><g transform="translate(6893,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-2B" x="7958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMATHI-62" x="8959" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-28" x="9389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMATHI-79" x="9778" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-2212" x="10498" y="0"></use><g transform="translate(11498,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-32" x="809" y="583"></use></g><g transform="translate(12525,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/post/428183/&amp;usg=ALkJrhjSUuoINnjNbPcpDDjoq-Mnzlwiog#MJMAIN-32" x="550" y="583"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> f (x, y) = (a-x) ^ 2 + b (y-x ^ 2) ^ 2 </script></p><br><img src="https://habrastorage.org/webt/cr/by/_v/crby_vv7ldxutqj5dxfaehtfnlk.jpeg"><br><br><p>  Pourquoi est-elle bonne? </p><br><ul><li>  Beau programme.  On l'appelle la vall√©e de Rosenbrock et la <i>fonction banane de Rosenbrock</i> intraduisible. </li><li>  Le minimum global se situe √† l'int√©rieur d'une longue vall√©e plate parabolique et √©troite.  Trouver une vall√©e est trivial et un minimum global est difficile. </li><li>  Il existe une option multidimensionnelle.  Trouver une bonne fonction pour de nombreuses variables n'est pas si simple. </li></ul><br><p>  Nous allons commencer √† en √©crire du code en connectant les biblioth√®ques n√©cessaires √† la poursuite des travaux: </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> math <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rosenbrock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, y, a, b)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a - x)**<span class="hljs-number"><span class="hljs-number">2</span></span> + b*(y - x**<span class="hljs-number"><span class="hljs-number">2</span></span>)**<span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre> <br><h4>  Nous √©non√ßons le probl√®me </h4><br><p>  Puisque nous parlions d'un appareil de mesure, continuons √† utiliser l'analogie.  Notre appareil dans un monde fictif peut mesurer des coordonn√©es <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mo" id="MJXp-Span-28" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-32" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-2"> (x, y) </script>  et hauteur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-33"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-3"> z </script>  .  Les physiciens ont √©tudi√© le monde et ont dit: " <em>Oui, c'est Rosenbrock! Connaissant les coordonn√©es, vous pouvez calculer avec pr√©cision la hauteur, vous n'avez pas besoin de la mesurer.</em> ".  En d'autres termes, les scientifiques nous ont donn√© un mod√®le <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">z </font></font></span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-38"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">s </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-43"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mo" id="MJXp-Span-44" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">y </font></font></span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-50" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-4"> z = rosier (x, y, a, b) </script>  qui d√©pend des param√®tres <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-53"><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mo" id="MJXp-Span-56" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">b </font></font></span><span class="MJXp-mo" id="MJXp-Span-58" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-5"> (a, b) </script>  .  Ces param√®tres, bien que constants dans un monde fictif, sont inconnus.  Ils doivent √™tre trouv√©s. </p><br><p>  Nous avons men√© une s√©rie d'exp√©riences qui ont donn√© <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-59"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-6"> m </script>  des points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-61"><span class="MJXp-mo" id="MJXp-Span-62" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-63"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-65" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-66" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-71"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-72" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-73" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-74" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-75" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-76" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-77"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-79" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-80" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-81"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-82" style="margin-right: 0.05em;">y</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-83" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-84" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;">z</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-87" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-88" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-89" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-90" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-91" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-94" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-95"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-97" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-98" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-99"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-101" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-102" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-103"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-105" style="vertical-align: -0.4em;">m</span></span><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-7"> (x_1, y_1, z_1), (x_2, y_2, z_2), ..., (x_m, y_m, z_m) </script>  : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># (2.5, 2.5) -   ,  ,     data_points = np.array([[x, y, rosenbrock(x, y, 2.5, 2.5)] for x in np.arange(-2, 2.1, 2) for y in np.arange(-2, 2.1, 2)]) m = data_points.shape[0]</span></span></code> </pre> <br><p>  La premi√®re fa√ßon d'optimiser est d'essayer de deviner les param√®tres.  Nous utilisons la biblioth√®que Numpy: </p><br><pre> <code class="python hljs">x, y = data_points[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], data_points[:, <span class="hljs-number"><span class="hljs-number">1</span></span>] z = data_points[:, <span class="hljs-number"><span class="hljs-number">2</span></span>] <span class="hljs-comment"><span class="hljs-comment">#   =5  b=5? a_guess, b_guess = 5., 5. #  -hat   ,   , #   ,   ,   .   #     ^   - # .    hat. z_hat = rosenbrock(x, y, a_guess, b_guess)</span></span></code> </pre> <br><p>  Comment comprendre √† quel point nous avons tort?  Compter les <em>r√©sidus</em> - tailles d'erreur. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-8"> m </script>  les points donnent <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-9"> m </script>  r√©sidus - vous avez besoin d'un indicateur int√©gr√©.  Nous pla√ßons chaque r√©sidu dans un carr√© et calculons la moyenne: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">E</span><span class="MJXp-mo" id="MJXp-Span-115" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">a</span><span class="MJXp-mo" id="MJXp-Span-117" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">b</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-120" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-121">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-122">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">c</span><span class="MJXp-mrow" id="MJXp-Span-126"><span class="MJXp-mn" id="MJXp-Span-127">1</span></span><span class="MJXp-mrow" id="MJXp-Span-128"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">m</span></span><span class="MJXp-mtext" id="MJXp-Span-130">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">u</span><span class="MJXp-msubsup" id="MJXp-Span-133"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">m</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">i</span><span class="MJXp-mo" id="MJXp-Span-137">=</span><span class="MJXp-mn" id="MJXp-Span-138">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-141" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-144" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">i</span></span></span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-147">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">t</span><span class="MJXp-mrow" id="MJXp-Span-155"><span class="MJXp-msubsup" id="MJXp-Span-156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157" style="margin-right: 0.05em;">z</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-158" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-159">i</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-160"><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-162" style="vertical-align: 0.5em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> MSE (a, b) = \ frac {1} {m} \ sum_ {i = 1} ^ {m} (z_ {i} - \ widehat {z_ {i}}) ^ 2 </script></p><br><p>  Cette mesure de proximit√© est appel√©e l' <em>erreur quadratique moyenne</em> (ci-apr√®s d√©nomm√©e <em>mse</em> ): </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># r - residuals () r = z - z_hat # mse loss = np.mean(r**2) print(loss)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: 3868.2291666666665</code> </pre> <br><p>  En minimisant <em>mse</em> , nous r√©solvons le <em>probl√®me des moindres carr√©s</em> ( <em>minimisation des carr√©s non lin√©aires</em> ): </p><br><img src="https://habrastorage.org/webt/lt/qk/su/ltqksu80eo7y4h91xedhj8w0djy.png"><br><p>  On peut voir que les param√®tres ne devinaient pas du tout. </p><br><h4>  Nous formulons le probl√®me sur TensorFlow </h4><br><p>  Le mod√®le a la forme <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">z</span><span class="MJXp-mo" id="MJXp-Span-165" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">r</span><span class="MJXp-mo" id="MJXp-Span-172" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">x</span><span class="MJXp-mo" id="MJXp-Span-174" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">y</span><span class="MJXp-mo" id="MJXp-Span-176" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">a</span><span class="MJXp-mo" id="MJXp-Span-178" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">b</span><span class="MJXp-mo" id="MJXp-Span-180" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-11"> z = rosier (x, y, a, b) </script>  .  Nous le portons au formulaire <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">y</span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">f</span><span class="MJXp-mo" id="MJXp-Span-185" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">x</span><span class="MJXp-mo" id="MJXp-Span-187" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">p</span><span class="MJXp-mo" id="MJXp-Span-189" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-12"> y = f (x, p) </script>  (g√©n√©ralement les maths √©crivent <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-190"><span class="MJXp-mtext" id="MJXp-Span-191">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-13"> \ beta </script>  au lieu de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-197">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-14"> p </script>  mais les programmeurs n'utilisent pas la version b√™ta).  Maintenant, le mod√®le a la forme <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">y</span><span class="MJXp-mo" id="MJXp-Span-200" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-204">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">r</span><span class="MJXp-mo" id="MJXp-Span-207" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">x</span><span class="MJXp-mo" id="MJXp-Span-209" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">p</span><span class="MJXp-mo" id="MJXp-Span-211" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-15"> y = rosier (x, p) </script>  o√π <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-212"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-16"> y </script>  - hauteur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-214"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-17"> x </script>  Est <em>le vecteur</em> de coordonn√©es de deux √©l√©ments (composant), et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-216"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-18"> p </script>  - <em>vecteur de</em> param√®tres. </p><br><p>  Les programmeurs consid√®rent souvent les vecteurs comme des tableaux unidimensionnels.  Ce n'est pas tout √† fait correct.  Un tableau de nombres est un moyen de <em>repr√©senter un</em> vecteur.  Vous pouvez repr√©senter un vecteur comme un tableau de dimension <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-219">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-19"> N </script>  , tableau bidimensionnel <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-220"><span class="MJXp-mn" id="MJXp-Span-221">1</span><span class="MJXp-mtext" id="MJXp-Span-222">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-226">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-20"> 1 \ fois N </script>  , et m√™me un tableau <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">N</span><span class="MJXp-mtext" id="MJXp-Span-230">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">s</span><span class="MJXp-mn" id="MJXp-Span-235">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> N \ fois 1 </script>  dans les cas o√π le fait que le vecteur soit un <em>vecteur colonne</em> (par exemple, pour multiplier une matrice par lui) est important: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-236"><span class="MJXp-mtext" id="MJXp-Span-237">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">n</span><span class="MJXp-mrow" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-245">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-247">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">x</span></span><span class="MJXp-msubsup" id="MJXp-Span-251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-253" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mspace" id="MJXp-Span-254" style="width: 0em; height: 0em;"></span><span class="MJXp-mtext" id="MJXp-Span-255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">s</span><span class="MJXp-mspace" id="MJXp-Span-261" style="width: 0em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-264" style="vertical-align: -0.4em;">N</span></span><span class="MJXp-mtext" id="MJXp-Span-265">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">d</span><span class="MJXp-mrow" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-271">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-272">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-273">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">x</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-22"> \ begin {bmatrix} x_1 \\\ vdots \\ x_N \ end {bmatrix} </script></p><br><p>  TensorFlow utilise le concept de <em>tenseur</em> .  <em>Un tenseur</em> , comme un tableau, peut √™tre unidimensionnel (pour repr√©senter un <em>vecteur</em> ), bidimensionnel (pour un <em>vecteur de</em> <em>matrice</em> ou de <em>colonne</em> ) et n'importe quelle dimension plus grande. </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ('placeholder' ,    #      ) x = tf.placeholder(tf.float64, shape=[m, 2]) y = tf.placeholder(tf.float64, shape=[m]) #   ('variable' ,    ) #     (5, 5) p = tf.Variable([5., 5.], dtype=tf.float64) #  y_hat = rosenbrock(x[:, 0], x[:, 1], p[0], p[1]) #  r = y - y_hat # mse (mean squared error) loss = tf.reduce_mean(r**2)</span></span></code> </pre> <br><p>  Le code TensorFlow n'est pas diff√©rent dans sa forme du code Numpy.  Le contenu est √©norme.  Le code Numpy calcule <em>la valeur</em> mse.  Le code TensorFlow n'effectue aucun calcul, il forme <em>un</em> <em>graphique de</em> <em>flux de donn√©es</em> que mse <em>peut calculer</em> .  Un moment tr√®s <em>tol√©rant au</em> cerveau est le travail de la fonction <em>rosenbrock</em> .  Nous l'utilisons dans les deux cas.  Mais lorsque nous passons les tableaux Numpy, il effectue les calculs selon la formule et renvoie les nombres.  Et lorsque nous transf√©rons les tenseurs vers TensorFlow, il forme un <em>sous</em> - <em>graphique du flux de donn√©es</em> et renvoie son <em>bord</em> sous la forme d'un tenseur.  Miracles du polymorphisme, mais n'en abusez pas: </p><br><img src="https://habrastorage.org/webt/cw/6u/nz/cw6unzjtqsl_uvl3auasc-x46zq.jpeg"><br><p>  Gr√¢ce √† la pr√©sence d'un tel graphe de flux de donn√©es, TensorFlow en particulier est capable de calculer automatiquement des <em>d√©riv√©es</em> (en utilisant <em>la</em> technique de <em>diff√©renciation automatique en mode inverse</em> ). </p><br><p>  Un moment de maths.  Les blocs "pour ceux qui ont oubli√©" seront cach√©s dans un spoiler. </p><br><div class="spoiler">  <b class="spoiler_title">D√©riv√©e (nombre entr√© - nombre restant)</b> <div class="spoiler_text"><p>  Vous vous souvenez tr√®s probablement de la d√©finition de la d√©riv√©e d'une fonction scalaire (renvoyant un nombre) d'une variable: pour <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-278">f</span><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-280">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-281">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-282">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-283">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">b</span><span class="MJXp-mrow" id="MJXp-Span-287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">R</span></span><span class="MJXp-mtext" id="MJXp-Span-289">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">w</span><span class="MJXp-mtext" id="MJXp-Span-300">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-306">b</span><span class="MJXp-mrow" id="MJXp-Span-307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308">R</span></span></span></span><script type="math/tex" id="MathJax-Element-23"> f: \ mathbb {R} \ rightarrow \ mathbb {R} </script>  d√©riv√© <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-310">f</span></span></span><script type="math/tex" id="MathJax-Element-24"> f </script>  au point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-311"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">x</span><span class="MJXp-mtext" id="MJXp-Span-313">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">n</span><span class="MJXp-mtext" id="MJXp-Span-316">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-317">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-319">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-320">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322">b</span><span class="MJXp-mrow" id="MJXp-Span-323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-324">R</span></span></span></span><script type="math/tex" id="MathJax-Element-25"> x \ in \ mathbb {R} </script>  d√©fini comme: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-325"><span class="MJXp-msup" id="MJXp-Span-326"><span class="MJXp-mrow" id="MJXp-Span-327" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">f</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-329" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-330" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-331">x</span><span class="MJXp-mo" id="MJXp-Span-332" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-334">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-335">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">i</span><span class="MJXp-msubsup" id="MJXp-Span-337"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-339" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-340">h</span><span class="MJXp-mtext" id="MJXp-Span-341">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-342">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">o</span><span class="MJXp-mn" id="MJXp-Span-344">0</span></span></span><span class="MJXp-mtext" id="MJXp-Span-345">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-347">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-349">c</span><span class="MJXp-mrow" id="MJXp-Span-350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-351">f</span><span class="MJXp-mo" id="MJXp-Span-352" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">x</span><span class="MJXp-mo" id="MJXp-Span-354" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">h</span><span class="MJXp-mo" id="MJXp-Span-356" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">f</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-360">x</span><span class="MJXp-mo" id="MJXp-Span-361" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-362"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">h</span></span></span></span><script type="math/tex;mode=display" id="MathJax-Element-26"> {f} '(x) = \ lim_ {h \ to 0} \ frac {f (x + h) -f (x)} {h} </script></p><br><p>  Les d√©riv√©s sont un moyen de mesurer le <i>changement</i> .  Dans le cas scalaire, la d√©riv√©e montre √† quel point la fonction va changer <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">f</span></span></span><script type="math/tex" id="MathJax-Element-27"> f </script>  si <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367">x</span></span></span><script type="math/tex" id="MathJax-Element-28"> x </script>  passer √† une petite valeur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-368"><span class="MJXp-mtext" id="MJXp-Span-369">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-370">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-372">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-373">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-379">n</span></span></span><script type="math/tex" id="MathJax-Element-29"> \ varepsilon </script>  : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381">f</span><span class="MJXp-mo" id="MJXp-Span-382" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">x</span><span class="MJXp-mo" id="MJXp-Span-384" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-385">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">n</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-405">f</span><span class="MJXp-mo" id="MJXp-Span-406" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">x</span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-409" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-410">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-415">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">n</span><span class="MJXp-msup" id="MJXp-Span-421"><span class="MJXp-mrow" id="MJXp-Span-422" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">f</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-424" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-425" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426">x</span><span class="MJXp-mo" id="MJXp-Span-427" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-30"> f (x + \ varepsilon) \ environ f (x) + \ varepsilon {f} '(x) </script></p><br><p>  Pour plus de commodit√©, nous d√©signons <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">y</span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-431">f</span><span class="MJXp-mo" id="MJXp-Span-432" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">x</span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-31"> y = f (x) </script>  et le d√©riv√© <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">y</span></span></span><script type="math/tex" id="MathJax-Element-32"> y </script>  par <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-437"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-438">x</span></span></span><script type="math/tex" id="MathJax-Element-33"> x </script>  nous √©crirons comment <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-439"><span class="MJXp-mtext" id="MJXp-Span-440">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-442">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-443">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">c</span><span class="MJXp-mrow" id="MJXp-Span-445"><span class="MJXp-mtext" id="MJXp-Span-446">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-448">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-453">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">y</span></span><span class="MJXp-mrow" id="MJXp-Span-455"><span class="MJXp-mtext" id="MJXp-Span-456">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-462">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464">x</span></span></span></span><script type="math/tex" id="MathJax-Element-34"> \ frac {\ partial y} {\ partial x} </script>  .  Un tel dossier souligne que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-465"><span class="MJXp-mtext" id="MJXp-Span-466">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-468">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-469">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">c</span><span class="MJXp-mrow" id="MJXp-Span-471"><span class="MJXp-mtext" id="MJXp-Span-472">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-476">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-477">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-478">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-479">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-480">y</span></span><span class="MJXp-mrow" id="MJXp-Span-481"><span class="MJXp-mtext" id="MJXp-Span-482">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-485">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">x</span></span></span></span><script type="math/tex" id="MathJax-Element-35"> \ frac {\ partial y} {\ partial x} </script>  - <i>taux de variation</i> entre les variables <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-491"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">x</span></span></span><script type="math/tex" id="MathJax-Element-36"> x </script>  et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">y</span></span></span><script type="math/tex" id="MathJax-Element-37"> y </script>  .  Plus pr√©cis√©ment, si <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496">x</span></span></span><script type="math/tex" id="MathJax-Element-38"> x </script>  changer pour <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-497"><span class="MJXp-mtext" id="MJXp-Span-498">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-502">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-504">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">n</span></span></span><script type="math/tex" id="MathJax-Element-39"> \ varepsilon </script>  alors <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510">y</span></span></span><script type="math/tex" id="MathJax-Element-40"> y </script>  passer √† environ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-511"><span class="MJXp-mtext" id="MJXp-Span-512">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-513">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-519">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-520">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-521">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">n</span><span class="MJXp-mtext" id="MJXp-Span-523">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-525">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-526">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">c</span><span class="MJXp-mrow" id="MJXp-Span-528"><span class="MJXp-mtext" id="MJXp-Span-529">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">y</span></span><span class="MJXp-mrow" id="MJXp-Span-538"><span class="MJXp-mtext" id="MJXp-Span-539">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547">x</span></span></span></span><script type="math/tex" id="MathJax-Element-41"> \ varepsilon \ frac {\ partial y} {\ partial x} </script>  .  Vous pouvez √©galement l'√©crire comme ceci: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549">x</span><span class="MJXp-mtext" id="MJXp-Span-550">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-551">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-556">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">x</span><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-563">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-566">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-568">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">x</span><span class="MJXp-mtext" id="MJXp-Span-570">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-573">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-575">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-577">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-580">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581">y</span><span class="MJXp-mtext" id="MJXp-Span-582">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-584">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-585">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-588">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-591">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">w</span><span class="MJXp-mtext" id="MJXp-Span-593">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-594">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-595">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-596">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-597">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-598">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-599">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">y</span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-602">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-605">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-606">c</span><span class="MJXp-mrow" id="MJXp-Span-607"><span class="MJXp-mtext" id="MJXp-Span-608">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-610">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-613">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">y</span></span><span class="MJXp-mrow" id="MJXp-Span-617"><span class="MJXp-mtext" id="MJXp-Span-618">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-619">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-622">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">x</span></span><span class="MJXp-mtext" id="MJXp-Span-627">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-628">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-629">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-42"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \ approx y + \ frac {\ partial y} {\ partial x} \ Delta x </script></p><br><p>  Lit comme: "changer <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">x</span></span></span><script type="math/tex" id="MathJax-Element-43"> x </script>  sur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637">x</span><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-639">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-641">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">x</span></span></span><script type="math/tex" id="MathJax-Element-44"> x + \ Delta x </script>  changer <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-646"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-647">y</span></span></span><script type="math/tex" id="MathJax-Element-45"> y </script>  √† environ <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-648"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">y</span><span class="MJXp-mo" id="MJXp-Span-650" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-651">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-652">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-653">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-655">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">x</span><span class="MJXp-mtext" id="MJXp-Span-658">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-659">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-661">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">c</span><span class="MJXp-mrow" id="MJXp-Span-663"><span class="MJXp-mtext" id="MJXp-Span-664">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-669">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-670">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">y</span></span><span class="MJXp-mrow" id="MJXp-Span-673"><span class="MJXp-mtext" id="MJXp-Span-674">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-680">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">x</span></span></span></span><script type="math/tex" id="MathJax-Element-46"> y + \ Delta x \ frac {\ partial y} {\ partial x} </script>  ". Un tel record met clairement en √©vidence le lien entre le changement <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">x</span></span></span><script type="math/tex" id="MathJax-Element-47"> x </script>  et changer <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-685"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">y</span></span></span><script type="math/tex" id="MathJax-Element-48"> y </script>  . </p></div></div><br><p>  Nous avons construit un graphique de flux de donn√©es, ex√©cutons le calcul mse: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        #      placeholder (  ) feed_dict = {x: data_points[:,0:2], y: data_points[:,2]} #       TensorFlow session = tf.Session() #     session.run(tf.global_variables_initializer()) #   ()  loss (mse) current_loss = session.run(loss, feed_dict) print(current_loss)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: 3868.2291666666665</code> </pre> <br><p>  Le r√©sultat est le m√™me qu'avec Numpy.  Ils ne se sont donc pas tromp√©s. </p><br><h4 id="nachnyom-optimizirovat">  Commencez √† optimiser </h4><br><p>  Malheureusement, il n'a pas √©t√© possible de deviner les param√®tres.  Mais alors nous: </p><br><ol><li>  Nous fixons le crit√®re d'optimalit√© - la valeur minimale de mse. </li><li>  Des param√®tres variables ont √©t√© d√©termin√©s: vecteur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-687"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> p </script>  avec composants <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> a </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-691"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> b </script>  Fonctions de Rosenbrock. </li><li>  Nous n'avons pas encore pens√© aux limitations, mais elles ne sont pas l√†. </li></ol><br><p>  Dans la derni√®re √©tape, nous avons construit un graphe de flux de donn√©es avec un tenseur de <em>perte</em> finie ( <em>fonction de</em> <em>perte</em> ).  Le but de l'optimisation est de trouver la valeur du vecteur param√®tre <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-693"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-694">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> p </script>  √† laquelle la valeur de la fonction de perte est minimale.  Nous avons eu de la chance, le graphe de cette fonction est tr√®s simple (concave et sans minima local): </p><br><img src="https://habrastorage.org/webt/vf/do/hr/vfdohrpseaocd_vpe6e7sp_6f0u.png"><br><p>  D√©buter avec l'optimisation.  Pour commencer, nous √©crivons un cycle g√©n√©ralis√©: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># :   mse,   ,  #   mse,        placeholder def train(target_loss, max_steps, loss_tensor, train_step_op, inputs): step = 0 current_loss = session.run(loss_tensor, inputs) #           while current_loss &gt; target_loss and step &lt; max_steps: step += 1 #    1, 2, 4, 8, 16...  if math.log(step, 2).is_integer(): print(f'step: {step}, current loss: {current_loss}') #    session.run(train_step_op, inputs) current_loss = session.run(loss_tensor, inputs) print(f'ENDED ON STEP: {step}, FINAL LOSS: {current_loss}')</span></span></code> </pre> <br><h4 id="optimiziruem-metodom-naiskoreyshego-gradientnogo-spuska-sgd">  Nous optimisons par la m√©thode de la descente de gradient la plus rapide (SGD) </h4><br><p>  Les actions de cette m√©thode peuvent √™tre compar√©es √† la conduite d'un skieur audacieux, qui descend toujours la pente (dans la direction la plus raide).  Dans ce cas, seule la pente au point de localisation est prise en compte.  Et si la pente est forte, le skieur vole sur une longue distance avant le prochain changement.  Avec une faible pente, il se d√©place par petites √©tapes.  Peut-√™tre comment s'envoler <del>  dans un arbre </del>  (l' <em>algorithme diverge</em> ), et se coincer dans une fosse ( <em>minimum local</em> ). </p><br><img src="https://habrastorage.org/webt/oe/et/ij/oeetijkwervilr42jsjl9wsgsey.jpeg"><br><p>  Vous pouvez √©crire comme suit (changer <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-695"><span class="MJXp-mtext" id="MJXp-Span-696">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-700">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-706">l</span><span class="MJXp-mrow" id="MJXp-Span-707"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-708">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> \ boldsymbol {p} </script>  sur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-709"><span class="MJXp-mtext" id="MJXp-Span-710">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-712">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-713">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-720">l</span><span class="MJXp-mrow" id="MJXp-Span-721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">p</span></span><span class="MJXp-mo" id="MJXp-Span-723" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-724" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-725" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-726" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> \ boldsymbol {p} - ... </script>  ): </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-727"><span class="MJXp-mtext" id="MJXp-Span-728">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-732">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-733">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">l</span><span class="MJXp-mrow" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740">p</span></span><span class="MJXp-mtext" id="MJXp-Span-741">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-742">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-747">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-748">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">w</span><span class="MJXp-mtext" id="MJXp-Span-752">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-759">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">l</span><span class="MJXp-mrow" id="MJXp-Span-763"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">p</span></span><span class="MJXp-mo" id="MJXp-Span-765" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-766">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">a</span><span class="MJXp-mo" id="MJXp-Span-772" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-773">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-774">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-775">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">l</span><span class="MJXp-msubsup" id="MJXp-Span-778"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-780" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-781">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-782">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">e</span><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-788">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-793">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-794">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-798">l</span><span class="MJXp-mrow" id="MJXp-Span-799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">p</span></span><span class="MJXp-mo" id="MJXp-Span-801" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-802" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-55"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p} - \ alpha [\ nabla_ {p} perte (\ boldsymbol {p})] </script></p><br><p>  Grasse <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-803"><span class="MJXp-mtext" id="MJXp-Span-804">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">l</span><span class="MJXp-mrow" id="MJXp-Span-815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> \ boldsymbol {p} </script>  souligne qu'il s'agit du point de localisation r√©el - la valeur du vecteur de param√®tre √† l'√©tape actuelle.  √Ä la premi√®re √©tape, c'est notre supposition (5, 5).  Il y a deux points int√©ressants dans la formule: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-817"><span class="MJXp-mtext" id="MJXp-Span-818">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-819">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ alpha </script>  - <em>taux d'apprentissage</em> ( <em>taux d'apprentissage</em> ), <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-824"><span class="MJXp-mtext" id="MJXp-Span-825">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">l</span><span class="MJXp-msubsup" id="MJXp-Span-830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-831" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-832" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-838">e</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> \ nabla_ {p} perte </script>  - <em>gradient</em> ( <em>gradient</em> ) de la fonction de perte par le vecteur de param√®tres. </p><br><img src="https://habrastorage.org/webt/qx/1h/em/qx1hem1cns_udmg0gucq1h9vs9k.jpeg"><br><div class="spoiler">  <b class="spoiler_title">D√©grad√© (vecteur entr√© - nombre √† gauche)</b> <div class="spoiler_text"><p>  Consid√©rons une fonction qui prend un vecteur en entr√©e et produit un scalaire: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">f</span><span class="MJXp-mo" id="MJXp-Span-841" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-842">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-847">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">b</span><span class="MJXp-msubsup" id="MJXp-Span-849"><span class="MJXp-mrow" id="MJXp-Span-850" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-851">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-852" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">N</span></span></span><span class="MJXp-mtext" id="MJXp-Span-854">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">w</span><span class="MJXp-mtext" id="MJXp-Span-865">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-869">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">b</span><span class="MJXp-mrow" id="MJXp-Span-872"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">R</span></span></span></span><script type="math/tex" id="MathJax-Element-59"> f: \ mathbb {R} ^ {N} \ rightarrow \ mathbb {R} </script>  .  D√©riv√© <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">f</span></span></span><script type="math/tex" id="MathJax-Element-60"> f </script>  au point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-877">x</span><span class="MJXp-mtext" id="MJXp-Span-878">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">n</span><span class="MJXp-mtext" id="MJXp-Span-881">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">b</span><span class="MJXp-msubsup" id="MJXp-Span-888"><span class="MJXp-mrow" id="MJXp-Span-889" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-891" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-61"> x \ in \ mathbb {R} ^ {N} </script>  maintenant appel√© <i>gradient</i> et est un vecteur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-893"><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-895">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">l</span><span class="MJXp-msubsup" id="MJXp-Span-900"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-901" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-902" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">f</span><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">x</span><span class="MJXp-mo" id="MJXp-Span-907" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-908" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mtext" id="MJXp-Span-909">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">n</span><span class="MJXp-mtext" id="MJXp-Span-912">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-917">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-918">b</span><span class="MJXp-msubsup" id="MJXp-Span-919"><span class="MJXp-mrow" id="MJXp-Span-920" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-922" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-62"> [\ nabla_ {x} f (x)] \ in \ mathbb {R} ^ {N} </script>  (lu comme "nabla") compos√© de <em>d√©riv√©es partielles</em> : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-924"><span class="MJXp-mtext" id="MJXp-Span-925">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">l</span><span class="MJXp-msubsup" id="MJXp-Span-930"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-932" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-934">y</span><span class="MJXp-mo" id="MJXp-Span-935" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-936" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-937">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">c</span><span class="MJXp-mrow" id="MJXp-Span-942"><span class="MJXp-mtext" id="MJXp-Span-943">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">y</span></span><span class="MJXp-mrow" id="MJXp-Span-952"><span class="MJXp-mtext" id="MJXp-Span-953">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-958">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-959">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">l</span><span class="MJXp-msubsup" id="MJXp-Span-961"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-963" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-964">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-965" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-966">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-968">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">c</span><span class="MJXp-mrow" id="MJXp-Span-971"><span class="MJXp-mtext" id="MJXp-Span-972">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-974">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-976">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-977">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">y</span></span><span class="MJXp-mrow" id="MJXp-Span-981"><span class="MJXp-mtext" id="MJXp-Span-982">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-983">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-987">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">l</span><span class="MJXp-msubsup" id="MJXp-Span-990"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-992" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-993">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-994" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-995" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-996" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-997" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-998" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-999">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1003">c</span><span class="MJXp-mrow" id="MJXp-Span-1004"><span class="MJXp-mtext" id="MJXp-Span-1005">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1014"><span class="MJXp-mtext" id="MJXp-Span-1015">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">l</span><span class="MJXp-msubsup" id="MJXp-Span-1023"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1024" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1025" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">N</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1027" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-63"> \ nabla_ {x} y = (\ frac {\ partial y} {\ partial x_ {1}}, \ frac {\ partial y} {\ partial x_ {2}}, ..., \ frac {\ partial y} {\ partiel x_ {N}}) </script></p><br><p>  Pour ce cas, l'enregistrement de la d√©pendance du changement de fonction sur le changement d'argument a la forme suivante: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1028"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">x</span><span class="MJXp-mtext" id="MJXp-Span-1030">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1040">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">x</span><span class="MJXp-mo" id="MJXp-Span-1042" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1043">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1048">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">x</span><span class="MJXp-mtext" id="MJXp-Span-1050">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1051">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1052">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">y</span><span class="MJXp-mtext" id="MJXp-Span-1062">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1064">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072">w</span><span class="MJXp-mtext" id="MJXp-Span-1073">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1074">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1076">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1078">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">y</span><span class="MJXp-mo" id="MJXp-Span-1081" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1082">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1085">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1086">l</span><span class="MJXp-msubsup" id="MJXp-Span-1087"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1089" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091">y</span><span class="MJXp-mtext" id="MJXp-Span-1092">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1093">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">t</span><span class="MJXp-mtext" id="MJXp-Span-1097">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1101">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1102">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-64"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \ approx y + \ nabla_ {x} y \ cdot \ Delta x </script></p><br><p>  Le dossier a beaucoup chang√© pour tenir compte du fait que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">x</span></span></span><script type="math/tex" id="MathJax-Element-65"> x </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1106"><span class="MJXp-mtext" id="MJXp-Span-1107">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1112">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">x</span></span></span><script type="math/tex" id="MathJax-Element-66"> \ Delta x </script>  et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1114"><span class="MJXp-mtext" id="MJXp-Span-1115">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">l</span><span class="MJXp-msubsup" id="MJXp-Span-1120"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1121" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1122" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1123">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1124">y</span></span></span><script type="math/tex" id="MathJax-Element-67"> \ nabla_ {x} y </script>  - vecteurs en <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1125"><span class="MJXp-mtext" id="MJXp-Span-1126">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1129">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1131">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1132">b</span><span class="MJXp-msubsup" id="MJXp-Span-1133"><span class="MJXp-mrow" id="MJXp-Span-1134" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1136" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1137">N</span></span></span></span></span><script type="math/tex" id="MathJax-Element-68"> \ mathbb {R} ^ {N} </script>  et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1138"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">y</span></span></span><script type="math/tex" id="MathJax-Element-69"> y </script>  - scalaire.  Lors de la multiplication des vecteurs <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1140"><span class="MJXp-mtext" id="MJXp-Span-1141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1142">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1143">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145">l</span><span class="MJXp-msubsup" id="MJXp-Span-1146"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1148" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1150">y</span></span></span><script type="math/tex" id="MathJax-Element-70"> \ nabla_ {x} y </script>  et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1151"><span class="MJXp-mtext" id="MJXp-Span-1152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1155">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">x</span></span></span><script type="math/tex" id="MathJax-Element-71"> \ Delta x </script>  le <i>produit scalaire est utilis√©</i> (la somme des produits des composants). </p></div></div><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        grad = tf.gradients(loss, p)[0] #   learning_rate = 0.0005 #   ,     apply_gradients - #         opt = tf.train.GradientDescentOptimizer(learning_rate=1) #           sgd = opt.apply_gradients([(learning_rate*grad, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, sgd, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 1381.5379689135807 [...] ENDED ON STEP: 582, FINAL LOSS: 9.698531012270816e-11 PARAMETERS: [2.50000205 2.49999959]</code> </pre> <br><p>  Il a fallu 582 √©tapes: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/b2/j3/jb/b2j3jbxzfk6_ll66vpr83vklwjs.jpeg"></div><br><div class="spoiler">  <b class="spoiler_title">Mouvement dans le sens de l'anti-gradient</b> <div class="spoiler_text"><p>  Pourquoi allons-nous dans la direction oppos√©e au gradient?  Rappelez l'entr√©e avec le produit scalaire: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1159"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1160">x</span><span class="MJXp-mtext" id="MJXp-Span-1161">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1164">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1166">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1167">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1168">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1170">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1171">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1172">x</span><span class="MJXp-mo" id="MJXp-Span-1173" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1174">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1178">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1180">x</span><span class="MJXp-mtext" id="MJXp-Span-1181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1185">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1186">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1187">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1188">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1189">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1191">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">y</span><span class="MJXp-mtext" id="MJXp-Span-1193">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1195">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1196">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1197">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1198">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1200">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1201">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1203">w</span><span class="MJXp-mtext" id="MJXp-Span-1204">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1205">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1207">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">y</span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1214">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1215">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1216">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1217">l</span><span class="MJXp-msubsup" id="MJXp-Span-1218"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1219" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1220" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">y</span><span class="MJXp-mtext" id="MJXp-Span-1223">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">t</span><span class="MJXp-mtext" id="MJXp-Span-1228">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1230">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1234">x</span></span></span><script type="math/tex" id="MathJax-Element-72"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \ approx y + \ nabla_ {x} y \ cdot \ Delta x </script>  .  Minimiser <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1236">y</span></span></span><script type="math/tex" id="MathJax-Element-73"> y </script>  .  √âtant donn√© que le comportement de la fonction n'est connu que dans un petit voisinage √† travers la d√©riv√©e, il est n√©cessaire de se d√©placer par petites √©tapes, mais optimales, en minimisant le produit <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1237"><span class="MJXp-mtext" id="MJXp-Span-1238">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1240">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1242">l</span><span class="MJXp-msubsup" id="MJXp-Span-1243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1244" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1245" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1247">y</span><span class="MJXp-mtext" id="MJXp-Span-1248">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1249">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1250">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1251">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">t</span><span class="MJXp-mtext" id="MJXp-Span-1253">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1256">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1259">x</span></span></span><script type="math/tex" id="MathJax-Element-74"> \ nabla_ {x} y \ cdot \ Delta x </script>  .  Par d√©finition scolaire, le <i>produit scalaire de deux vecteurs est le nombre √©gal au produit des longueurs de ces vecteurs par le cosinus de l'angle entre eux</i> : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">a</span><span class="MJXp-mtext" id="MJXp-Span-1262">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1266">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1267">b</span><span class="MJXp-mo" id="MJXp-Span-1268" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1269">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1271">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1272">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1274">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">e</span><span class="MJXp-mrow" id="MJXp-Span-1276"><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1278">a</span><span class="MJXp-mtext" id="MJXp-Span-1279">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1280">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1281">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1283">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1285">e</span><span class="MJXp-mrow" id="MJXp-Span-1286"><span class="MJXp-mo" id="MJXp-Span-1287" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-1288">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1291">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1292">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1293">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">e</span><span class="MJXp-mrow" id="MJXp-Span-1295"><span class="MJXp-mo" id="MJXp-Span-1296" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297">b</span><span class="MJXp-mtext" id="MJXp-Span-1298">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1299">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1301">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1304">e</span><span class="MJXp-mrow" id="MJXp-Span-1305"><span class="MJXp-mo" id="MJXp-Span-1306" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1307">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1309">s</span><span class="MJXp-mtext" id="MJXp-Span-1310">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1311">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1312">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1314">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">e</span><span class="MJXp-mo" id="MJXp-Span-1316" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">a</span><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1319">b</span><span class="MJXp-mo" id="MJXp-Span-1320" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-75"> a \ cdot b = \ gauche | a \ droite | \ gauche | b \ droite | cos \ angle (a, b) </script>  .  Pour une longueur fixe de vecteurs, ce produit atteint un minimum avec un cosinus de -1, c'est-√†-dire  √† un angle de 180 degr√©s, lorsque les vecteurs sont dirig√©s dans des directions oppos√©es.  En cons√©quence, le produit scalaire minimum <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1321"><span class="MJXp-mtext" id="MJXp-Span-1322">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1323">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1326">l</span><span class="MJXp-msubsup" id="MJXp-Span-1327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1329" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">y</span><span class="MJXp-mtext" id="MJXp-Span-1332">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1333">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1334">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">t</span><span class="MJXp-mtext" id="MJXp-Span-1337">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1339">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1340">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1341">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1343">x</span></span></span><script type="math/tex" id="MathJax-Element-76"> \ nabla_ {x} y \ cdot \ Delta x </script>  atteint lorsque <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1344"><span class="MJXp-mtext" id="MJXp-Span-1345">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1348">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1350">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">x</span></span></span><script type="math/tex" id="MathJax-Element-77"> \ Delta x </script>  dans le sens de l' <i>anti-gradient</i> . </p></div></div><br><h4 id="optimiziruem-metodom-adam">  Nous optimisons par la m√©thode Adam </h4><br><p>  Nous n'irons pas plus loin dans les m√©thodes de gradient, mais il existe de nombreuses variantes.  Vous pouvez les lire dans l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">M√©thodes d'optimisation des r√©seaux de neurones</a> .  Dans TensorFlow, de nombreux optimiseurs sont d√©j√† impl√©ment√©s.  Par exemple, Adam: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       , #      adm = tf.train.AdamOptimizer(15).minimize(loss) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, adm, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 34205.72916492336 [...] ENDED ON STEP: 317, FINAL LOSS: 2.424142714263483e-12 PARAMETERS: [2.49999969 2.50000008]</code> </pre> <br><p>  G√©r√© en 317 √©tapes.  Beaucoup plus vite. </p><br><h4 id="optimiziruem-metodom-nyutona">  Nous optimisons par la m√©thode de Newton </h4><br><p>  Les actions des m√©thodes de second ordre peuvent √™tre compar√©es √† la conduite d'un snowboarder rationnel de freeride qui r√©fl√©chit longuement au prochain point de son itin√©raire et prend en compte non seulement la pente √† l'emplacement, mais aussi la courbure. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p_/iu/kf/p_iukfzoa0idjm_cbycfmlye4mw.jpeg"></div><br><p>  En fait, les m√©thodes de descente de gradient et les m√©thodes de second ordre tentent de deviner ( <em>approximer</em> ) la fonction au point courant.  Les m√©thodes de gradient se concentrent uniquement sur la <em>pente du</em> graphique de la fonction au point - la d√©riv√©e premi√®re.  Les m√©thodes du second ordre, en plus du biais, prennent en compte la <em>courbure</em> , la d√©riv√©e seconde: "si la courbure persiste, alors o√π sera le minimum?"  Nous calculons et y allons: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xb/sn/nb/xbsnnb1o5cui4x10wspkrgjinaw.jpeg"></div><br><p>  Pour construire une telle approximation et calculer le point minimum estim√©, vous pouvez utiliser la <em>s√©rie Taylor</em> .  Pour le cas unidimensionnel, l'approximation par un polyn√¥me de second ordre au point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> a </script>  ressemble √† ceci: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">f</span><span class="MJXp-mo" id="MJXp-Span-1403" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">x</span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1406">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1408">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1409">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1410">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1411">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1413">f</span><span class="MJXp-mo" id="MJXp-Span-1414" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">a</span><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1417" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1418">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1420">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422">c</span><span class="MJXp-mrow" id="MJXp-Span-1423"><span class="MJXp-msup" id="MJXp-Span-1424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1426" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1428">a</span><span class="MJXp-mo" id="MJXp-Span-1429" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">x</span><span class="MJXp-mo" id="MJXp-Span-1432" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">a</span><span class="MJXp-mo" id="MJXp-Span-1434" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1435"><span class="MJXp-mn" id="MJXp-Span-1436">1</span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0.111em; margin-right: 0em;">!</span></span><span class="MJXp-mo" id="MJXp-Span-1438" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1439">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1441">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1443">c</span><span class="MJXp-mrow" id="MJXp-Span-1444"><span class="MJXp-msup" id="MJXp-Span-1445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1447" style="vertical-align: 0.5em;">‚Ä≥</span></span><span class="MJXp-mo" id="MJXp-Span-1448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1449">a</span><span class="MJXp-mo" id="MJXp-Span-1450" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1451" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">x</span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">a</span><span class="MJXp-msubsup" id="MJXp-Span-1455"><span class="MJXp-mo" id="MJXp-Span-1456" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1457" style="vertical-align: 0.5em;">2</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1458"><span class="MJXp-mn" id="MJXp-Span-1459">2</span><span class="MJXp-mo" id="MJXp-Span-1460" style="margin-left: 0.111em; margin-right: 0em;">!</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-79"> f (x) \ approx f (a) + \ frac {f '(a) (x-a)} {1!} + \ frac {f' '(a) (x-a) ^ 2} {2!} </script></p><br><p>  Le minimum est atteint √† <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1462">x</span><span class="MJXp-mo" id="MJXp-Span-1463" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">a</span><span class="MJXp-mo" id="MJXp-Span-1465" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1466">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1467">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1469">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">c</span><span class="MJXp-mrow" id="MJXp-Span-1471"><span class="MJXp-msup" id="MJXp-Span-1472"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1474" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-1475" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1476">a</span><span class="MJXp-mo" id="MJXp-Span-1477" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1478"><span class="MJXp-msup" id="MJXp-Span-1479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480" style="margin-right: 0.05em;">f</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-1481" style="vertical-align: 0.5em;">‚Ä≥</span></span><span class="MJXp-mo" id="MJXp-Span-1482" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">a</span><span class="MJXp-mo" id="MJXp-Span-1484" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> x = a - \ frac {f '(a)} {f' '(a)} </script>  .  Le cas multidimensionnel semble plus s√©rieux: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/dv/pd/31/dvpd31r1vt2cbts_a5oamiiwgoc.jpeg"></div><br><div class="spoiler">  <b class="spoiler_title">Matrice de Hesse (vecteur entr√© - nombre √† gauche)</b> <div class="spoiler_text"><p>  <em>La</em> <em>matrice de Hesse</em> est une matrice carr√©e compos√©e de d√©riv√©es secondes: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1485"><span class="noError" id="MJXp-Span-1486" style="display: inline-block;">\&nbsp;boldsymbol&nbsp;{H}&nbsp;y_&nbsp;{x}&nbsp;=&nbsp;\&nbsp;begin&nbsp;{bmatrix}&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_1&nbsp;^&nbsp;2}&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_1&nbsp;\&nbsp;partial&nbsp;x_2}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_1&nbsp;\&nbsp;partial&nbsp;x_N}&nbsp;\\&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_2&nbsp;\&nbsp;partial&nbsp;x_1}&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_2&nbsp;^&nbsp;2}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_2&nbsp;\&nbsp;partial&nbsp;x_N}&nbsp;\\&nbsp;\&nbsp;vdots&nbsp;&amp;&nbsp;\&nbsp;vdots&nbsp;&amp;&nbsp;\&nbsp;ddots&nbsp;&amp;&nbsp;\&nbsp;vdots&nbsp;\\&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partial&nbsp;x_N&nbsp;\&nbsp;partiel&nbsp;x_1}&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partiel&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partiel&nbsp;x_N&nbsp;\&nbsp;partiel&nbsp;x_2}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partiel&nbsp;^&nbsp;2y}&nbsp;{\&nbsp;partiel&nbsp;x_N&nbsp;^&nbsp;2}&nbsp;\&nbsp;end&nbsp;{bmatrix}</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-81"> \ boldsymbol {H} y_ {x} = \ begin {bmatrix} \ frac {\ partial ^ 2y} {\ partial x_1 ^ 2} & \ frac {\ partial ^ 2y} {\ partial x_1 \ partial x_2} & \ cdots & \ frac {\ partial ^ 2y} {\ partial x_1 \ partial x_N} \\ \ frac {\ partial ^ 2y} {\ partial x_2 \ partial x_1} & \ frac {\ partial ^ 2y} {\ partial x_2 ^ 2} & \ cdots & \ frac {\ partial ^ 2y} {\ partial x_2 \ partial x_N} \\ \ vdots & \ vdots & \ ddots & \ vdots \\ \ frac {\ partial ^ 2y} {\ partial x_N \ partiel x_1} & \ frac {\ partiel ^ 2y} {\ partiel x_N \ partiel x_2} & \ cdots & \ frac {\ partiel ^ 2y} {\ partiel x_N ^ 2} \ end {bmatrix} </script></p></div></div><br><p>  Approximation d'un polyn√¥me de second ordre pour une fonction d'un vecteur √† travers un gradient et une matrice de Hesse en un point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82"> a </script>  ressemble √† ceci: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1489"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1490">f</span><span class="MJXp-mo" id="MJXp-Span-1491" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1492">x</span><span class="MJXp-mo" id="MJXp-Span-1493" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mtext" id="MJXp-Span-1494">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1496">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1499">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1501">f</span><span class="MJXp-mo" id="MJXp-Span-1502" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1503">a</span><span class="MJXp-mo" id="MJXp-Span-1504" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1505" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-1506" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1507">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">a</span><span class="MJXp-msubsup" id="MJXp-Span-1509"><span class="MJXp-mo" id="MJXp-Span-1510" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1511" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1515">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1518">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1519">l</span><span class="MJXp-mo" id="MJXp-Span-1520" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1521">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1522">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1524">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">l</span><span class="MJXp-msubsup" id="MJXp-Span-1526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1528" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">f</span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">a</span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1534" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1535" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1536">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1538">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1540">c</span><span class="MJXp-mrow" id="MJXp-Span-1541"><span class="MJXp-mn" id="MJXp-Span-1542">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1543"><span class="MJXp-mn" id="MJXp-Span-1544">2</span><span class="MJXp-mo" id="MJXp-Span-1545" style="margin-left: 0.111em; margin-right: 0em;">!</span></span><span class="MJXp-mo" id="MJXp-Span-1546" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1548">a</span><span class="MJXp-msubsup" id="MJXp-Span-1549"><span class="MJXp-mo" id="MJXp-Span-1550" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1551" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1553">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1554">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1556">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1558">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1559">l</span><span class="MJXp-mo" id="MJXp-Span-1560" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1561">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1562">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1563">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1565">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1567">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1569">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1571">l</span><span class="MJXp-mrow" id="MJXp-Span-1572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">H</span></span><span class="MJXp-msubsup" id="MJXp-Span-1574"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1576" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1579">a</span><span class="MJXp-mo" id="MJXp-Span-1580" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1581" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1582" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1583">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">a</span><span class="MJXp-mo" id="MJXp-Span-1585" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-83"> f (x) \ approx f (a) + (xa) ^ \ intercal [\ nabla_ {x} f (a)] + \ frac {1} {2!} (xa) ^ \ intercal [\ boldsymbol {H } f_ {x} (a)] (xa) </script></p><br><p>  Le minimum est atteint √† <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">x</span><span class="MJXp-mo" id="MJXp-Span-1588" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1589">a</span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-1591" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1592">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1595">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1597">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1600">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1602">l</span><span class="MJXp-mrow" id="MJXp-Span-1603"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1604">H</span></span><span class="MJXp-msubsup" id="MJXp-Span-1605"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1607" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1608">x</span></span></span><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">a</span><span class="MJXp-mo" id="MJXp-Span-1611" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1612"><span class="MJXp-mo" id="MJXp-Span-1613" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1614" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1615">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1616">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1617" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1618">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1619">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1621">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622">l</span><span class="MJXp-msubsup" id="MJXp-Span-1623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1625" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1626">x</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1627">f</span><span class="MJXp-mo" id="MJXp-Span-1628" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1629">a</span><span class="MJXp-mo" id="MJXp-Span-1630" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1631" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> x = a - [\ boldsymbol {H} f_ {x} (a)] ^ {- 1} [\ nabla_ {x} f (a)] </script>  .  La forme co√Øncide pratiquement avec le cas unidimensionnel: nous avons remplac√© la premi√®re d√©riv√©e par un gradient, la seconde par une matrice de Hesse et fait une correction pour travailler avec des vecteurs.  Il est impossible de diviser un vecteur par une matrice, par cons√©quent, la multiplication par la matrice <em>inverse</em> est utilis√©e.  <em>T</em> signifie <em>transposer</em> .  La formule implique que par d√©faut un vecteur est une colonne.  Transposer transforme <em>un</em> <em>vecteur de</em> <em>colonne en</em> <em>vecteur de ligne</em> .  Lors de l'impl√©mentation sur TensorFlow, cela doit √™tre pris en compte, mais en sens inverse: par d√©faut, le vecteur est une cha√Æne (tenseur unidimensionnel).  Juste au cas o√π: la transposition n'est pas une rotation de 90 degr√©s, c'est la transformation de lignes en colonnes dans le m√™me ordre. </p><br><p>  Ainsi, l'√©tape de la m√©thode Newton a la forme suivante: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1632"><span class="MJXp-mtext" id="MJXp-Span-1633">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1634">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1638">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1641">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1642">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1643">l</span><span class="MJXp-mrow" id="MJXp-Span-1644"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">p</span></span><span class="MJXp-mtext" id="MJXp-Span-1646">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1647">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1648">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1649">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1650">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1651">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1652">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1653">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1654">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1656">w</span><span class="MJXp-mtext" id="MJXp-Span-1657">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1658">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1659">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1661">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1662">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1663">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1665">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1667">l</span><span class="MJXp-mrow" id="MJXp-Span-1668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669">p</span></span><span class="MJXp-mo" id="MJXp-Span-1670" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-1671" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1672">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1673">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1674">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1675">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1676">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1678">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1679">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1682">l</span><span class="MJXp-mrow" id="MJXp-Span-1683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1684">H</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1685">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1686">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">s</span><span class="MJXp-msubsup" id="MJXp-Span-1688"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1689" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1690" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-1692" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1693">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1695">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1697">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1699">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1702">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1703">l</span><span class="MJXp-mrow" id="MJXp-Span-1704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">p</span></span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1707"><span class="MJXp-mo" id="MJXp-Span-1708" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1709" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1710">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1711">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1712" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-1713">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1714">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1715">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717">l</span><span class="MJXp-msubsup" id="MJXp-Span-1718"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1720" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1721">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1722">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1724">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">s</span><span class="MJXp-mo" id="MJXp-Span-1726" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-1727">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1732">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1733">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1735">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">l</span><span class="MJXp-mrow" id="MJXp-Span-1738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">p</span></span><span class="MJXp-mo" id="MJXp-Span-1740" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1741" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-85"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p} - [\ boldsymbol {H} loss_ {p} (\ boldsymbol {p})] ^ {- 1} [\ nabla_ {p} loss (\ boldsymbol {p} )] </script></p><br><p>  TensorFlow a tout pour impl√©menter cette m√©thode: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#        hess = tf.hessians(loss, p)[0] #    - grad_col = tf.expand_dims(grad, -1) # ,      dp = tf.matmul(tf.linalg.inv(hess), grad_col) #  -  - dp = tf.squeeze(dp) #  p  dp    newton = opt.apply_gradients([(dp, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, newton, feed_dict) print('PARAMETERS:', session.run(p))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 105.04357496954218 step: 4, current loss: 9.96663526704236 ENDED ON STEP: 6, FINAL LOSS: 5.882202372519996e-20 PARAMETERS: [2.5 2.5]</code> </pre> <br><p>  Assez 6 √©tapes: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/to/4-/eo/to4-eorewt5uoh_sdhokzqx0kuq.jpeg"></div><br><h4 id="optimiziruem-algoritmom-gaussa-nyutona">  Optimis√© par l'algorithme de Gauss-Newton </h4><br><p>  La m√©thode de Newton a un inconv√©nient - la matrice de Hesse.  Gr√¢ce √† TensorFlow, nous pouvons le compter dans une seule ligne de code.  Selon le wiki, <em>Johann Karl Friedrich Gauss a</em> fait la premi√®re mention de sa m√©thode en 1809.  Le calcul de la matrice de Hesse pour plusieurs param√®tres pour la m√©thode des moindres carr√©s pourrait alors prendre beaucoup de temps.  Nous pouvons maintenant supposer que l'algorithme de Gauss-Newton utilise l'approximation de <em>la</em> <em>matrice de</em> <em>Hesse √†</em> travers <em>la matrice de Jacobi</em> pour simplifier les calculs.  Mais du point de vue de l'histoire, ce n'est pas le cas: <em>Ludwig Otto Hesse</em> (qui a d√©velopp√© la matrice qui porte son nom) est n√© en 1811 - 2 ans apr√®s la premi√®re mention de l'algorithme.  Et <em>Carl Gustav Jacobi</em> avait 5 ans. </p><br><p>  L'algorithme de Gauss-Newton ne fonctionne pas avec la fonction de perte.  Il fonctionne avec la <em>fonction r√©siduelle</em> <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">r</span><span class="MJXp-mo" id="MJXp-Span-1744" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">p</span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86"> r (p) </script>  .  Cette fonction prend un vecteur d'entr√©e de param√®tres <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1747"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87"> p </script>  et renvoie <em>un vecteur r√©siduel</em> .  Dans notre cas, le vecteur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1749"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> p </script>  se compose de 2 composants (param√®tres <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1751"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1752">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89"> a </script>  et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-90"> b </script>  Fonctions de Rosenbrock) et le vecteur r√©siduel de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91"> m </script>  (selon le nombre d'exp√©riences).  La fonction vectorielle de l'argument vecteur est obtenue.  Sa d√©riv√©e: </p><br><div class="spoiler">  <b class="spoiler_title">Matrice de Jacobi (vecteur entr√© - vecteur lib√©r√©)</b> <div class="spoiler_text"><p>  Consid√©rons une fonction qui prend un vecteur en entr√©e et produit √©galement un vecteur: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">f</span><span class="MJXp-mo" id="MJXp-Span-1759" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mtext" id="MJXp-Span-1760">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1761">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1765">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1766">b</span><span class="MJXp-msubsup" id="MJXp-Span-1767"><span class="MJXp-mrow" id="MJXp-Span-1768" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1770" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771">N</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1772">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1775">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1778">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1779">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1780">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1781">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782">w</span><span class="MJXp-mtext" id="MJXp-Span-1783">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1787">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">b</span><span class="MJXp-msubsup" id="MJXp-Span-1790"><span class="MJXp-mrow" id="MJXp-Span-1791" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1793" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">M</span></span></span></span></span><script type="math/tex" id="MathJax-Element-92"> f: \ mathbb {R} ^ {N} \ rightarrow \ mathbb {R} ^ {M} </script>  .  D√©riv√© <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">f</span></span></span><script type="math/tex" id="MathJax-Element-93"> f </script>  au point <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1797"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1798">x</span></span></span><script type="math/tex" id="MathJax-Element-94"> x </script>  a maintenant la taille <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1799"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1800">N</span><span class="MJXp-mtext" id="MJXp-Span-1801">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1802">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1803">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1806">M</span></span></span><script type="math/tex" id="MathJax-Element-95"> N \ fois M </script>  , appel√©e <i>matrice de Jacobi</i> , et se compose de toutes les combinaisons de d√©riv√©es partielles: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1807"><span class="noError" id="MJXp-Span-1808" style="display: inline-block;">\&nbsp;boldsymbol&nbsp;{J}&nbsp;y_&nbsp;{x}&nbsp;=&nbsp;\&nbsp;begin&nbsp;{pmatrix}&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;y_&nbsp;{1}}&nbsp;{\&nbsp;partial&nbsp;x_&nbsp;{1}}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;y_&nbsp;{1}}&nbsp;{\&nbsp;partiel&nbsp;x_&nbsp;{N}}&nbsp;\\&nbsp;\&nbsp;vdots&nbsp;&amp;&nbsp;\&nbsp;ddots&nbsp;&amp;&nbsp;\&nbsp;vdots&nbsp;\\&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;y_&nbsp;{M}}&nbsp;{\&nbsp;partial&nbsp;x_&nbsp;{1}}&nbsp;&amp;&nbsp;\&nbsp;cdots&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{\&nbsp;partial&nbsp;y_&nbsp;{M}}&nbsp;{\&nbsp;partial&nbsp;x_&nbsp;{N}}&nbsp;\&nbsp;end&nbsp;{pmatrix}</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-96"> \ boldsymbol {J} y_ {x} = \ begin {pmatrix} \ frac {\ partial y_ {1}} {\ partial x_ {1}} & \ cdots & \ frac {\ partial y_ {1}} {\ partiel x_ {N}} \\ \ vdots & \ ddots & \ vdots \\ \ frac {\ partial y_ {M}} {\ partial x_ {1}} & \ cdots & \ frac {\ partial y_ {M}} {\ partial x_ {N}} \ end {pmatrix} </script></p><br><p>  Vous remarquerez peut-√™tre que les lignes de <i>la matrice de Jacobi</i> sont les <i>gradients des</i> composants <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1809"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1810">y</span></span></span><script type="math/tex" id="MathJax-Element-97"> y </script>  .  Objet <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1811"><span class="MJXp-mo" id="MJXp-Span-1812" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">i</span><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815">j</span><span class="MJXp-mo" id="MJXp-Span-1816" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><script type="math/tex" id="MathJax-Element-98"> (i, j) </script>  matrices <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1817"><span class="MJXp-mtext" id="MJXp-Span-1818">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1820">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1822">c</span><span class="MJXp-mrow" id="MJXp-Span-1823"><span class="MJXp-mtext" id="MJXp-Span-1824">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1825">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1829">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1830">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1832">y</span></span><span class="MJXp-mrow" id="MJXp-Span-1833"><span class="MJXp-mtext" id="MJXp-Span-1834">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1835">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1836">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1838">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1839">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1842">x</span></span></span></span><script type="math/tex" id="MathJax-Element-99"> \ frac {\ partial y} {\ partial x} </script>  est √©gal √† <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1843"><span class="MJXp-mtext" id="MJXp-Span-1844">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1848">c</span><span class="MJXp-mrow" id="MJXp-Span-1849"><span class="MJXp-mtext" id="MJXp-Span-1850">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1851">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1853">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1855">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1857">l</span><span class="MJXp-msubsup" id="MJXp-Span-1858"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1859" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1860" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1861">i</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1862"><span class="MJXp-mtext" id="MJXp-Span-1863">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1864">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1865">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1867">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1869">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1870">l</span><span class="MJXp-msubsup" id="MJXp-Span-1871"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1872" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1873" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1874">j</span></span></span></span></span></span><script type="math/tex" id="MathJax-Element-100"> \ frac {\ partial y_ {i}} {\ partial x_ {j}} </script>  et nous dit combien va changer <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1875"><span class="MJXp-msubsup" id="MJXp-Span-1876"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1877" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1878" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1879">i</span></span></span></span></span><script type="math/tex" id="MathJax-Element-101"> y_ {i} </script>  lors du changement <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1880"><span class="MJXp-msubsup" id="MJXp-Span-1881"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1883" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1884">j</span></span></span></span></span><script type="math/tex" id="MathJax-Element-102"> x_ {j} </script>  sur une petite valeur.  Comme dans les cas pr√©c√©dents, vous pouvez √©crire: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1885"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1886">x</span><span class="MJXp-mtext" id="MJXp-Span-1887">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1888">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1889">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1890">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1892">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1894">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1896">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1898">x</span><span class="MJXp-mo" id="MJXp-Span-1899" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1900">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1901">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1902">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1903">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1904">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1905">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1906">x</span><span class="MJXp-mtext" id="MJXp-Span-1907">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1908">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1909">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1910">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1911">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1912">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1913">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1914">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1915">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1916">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1917">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1918">y</span><span class="MJXp-mtext" id="MJXp-Span-1919">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1920">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1921">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1922">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1923">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1924">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1925">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1926">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1927">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1928">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1929">w</span><span class="MJXp-mtext" id="MJXp-Span-1930">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1931">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1932">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1933">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1934">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1935">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1936">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1937">y</span><span class="MJXp-mo" id="MJXp-Span-1938" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-1939">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1940">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1941">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1942">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1943">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1944">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1945">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1946">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1947">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1948">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1949">l</span><span class="MJXp-mrow" id="MJXp-Span-1950"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1951">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-1952"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1953" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1954" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1955">x</span></span></span><span class="MJXp-mtext" id="MJXp-Span-1956">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1957">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1958">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1959">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1960">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1961">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1962">x</span></span></span><script type="math/tex;mode=display" id="MathJax-Element-103"> x \ rightarrow x + \ Delta x \ Rightarrow y \ rightarrow \ approx y + \ boldsymbol {J} y_ {x} \ Delta x </script></p><br><p>  Ici <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1963"><span class="MJXp-mtext" id="MJXp-Span-1964">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1965">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1966">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1967">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1968">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1969">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1970">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1971">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1972">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1973">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1974">l</span><span class="MJXp-mrow" id="MJXp-Span-1975"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1976">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-1977"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1978" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1979" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1980">x</span></span></span></span></span><script type="math/tex" id="MathJax-Element-104"> \ boldsymbol {J} y_ {x} </script>  matrice <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1981"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1982">N</span><span class="MJXp-mtext" id="MJXp-Span-1983">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1984">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1985">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1986">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1987">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1988">M</span></span></span><script type="math/tex" id="MathJax-Element-105"> N \ fois M </script>  et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1989"><span class="MJXp-mtext" id="MJXp-Span-1990">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1991">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1992">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1993">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1994">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1995">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1996">x</span></span></span><script type="math/tex" id="MathJax-Element-106"> \ Delta x </script>  vecteur de taille <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1997"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1998">N</span></span></span><script type="math/tex" id="MathJax-Element-107"> N </script>  ainsi le produit <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1999"><span class="MJXp-mtext" id="MJXp-Span-2000">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2001">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2002">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2003">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2004">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2005">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2006">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2007">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2008">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2009">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2010">l</span><span class="MJXp-mrow" id="MJXp-Span-2011"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2012">J</span></span><span class="MJXp-msubsup" id="MJXp-Span-2013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2014" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2015" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2016">x</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2017">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2018">D</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2019">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2020">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2021">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2022">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2023">x</span></span></span><script type="math/tex" id="MathJax-Element-108"> \ boldsymbol {J} y_ {x} \ Delta x </script>  Est le produit de la matrice par le vecteur, r√©sultant en un vecteur de taille <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2025">M</span></span></span><script type="math/tex" id="MathJax-Element-109"> M </script>  . </p></div></div><br><p>  Afin de ne pas se confondre dans l'abondance des personnages, nous supposons que <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2026"><span class="MJXp-mtext" id="MJXp-Span-2027">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2028">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2029">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2030">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2031">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2032">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2033">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2034">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2035">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2036">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2037">l</span><span class="MJXp-msubsup" id="MJXp-Span-2038"><span class="MJXp-mrow" id="MJXp-Span-2039" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2040">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2041" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2042">r</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110"> \ boldsymbol {J} _ {r} </script>  - Matrice de Jacobi des fonctions r√©siduelles au point courant <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2043"><span class="MJXp-mtext" id="MJXp-Span-2044">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2045">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2046">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2047">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2048">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2049">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2050">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2051">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2052">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2053">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2054">l</span><span class="MJXp-mrow" id="MJXp-Span-2055"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2056">p</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111"> \ boldsymbol {p} </script>  .  L'algorithme de Gauss-Newton peut alors s'√©crire comme suit: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2057"><span class="MJXp-mtext" id="MJXp-Span-2058">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2059">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2060">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2061">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2062">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2063">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2064">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2065">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2066">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2067">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2068">l</span><span class="MJXp-mrow" id="MJXp-Span-2069"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2070">p</span></span><span class="MJXp-mtext" id="MJXp-Span-2071">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2072">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2073">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2074">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2075">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2076">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2077">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2078">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2079">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2080">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2081">w</span><span class="MJXp-mtext" id="MJXp-Span-2082">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2083">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2084">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2085">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2086">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2087">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2088">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2089">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2090">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2091">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2092">l</span><span class="MJXp-mrow" id="MJXp-Span-2093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2094">p</span></span><span class="MJXp-mo" id="MJXp-Span-2095" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-2096" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-2097">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2098">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2099">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2100">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2101">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2102">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2103">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2104">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2105">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2106">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2107">l</span><span class="MJXp-msubsup" id="MJXp-Span-2108"><span class="MJXp-mrow" id="MJXp-Span-2109" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2110">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2113">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2112">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2114">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2115">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2116">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2117">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2118">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2119">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2120">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2121">l</span><span class="MJXp-mtext" id="MJXp-Span-2122">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2123">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2124">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2125">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2126">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2127">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2128">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2129">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2130">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2131">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2132">l</span><span class="MJXp-msubsup" id="MJXp-Span-2133"><span class="MJXp-mrow" id="MJXp-Span-2134" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2135">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2136" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2137">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2138"><span class="MJXp-mo" id="MJXp-Span-2139" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2140" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-2141">‚àí</span><span class="MJXp-mn" id="MJXp-Span-2142">1</span></span></span><span class="MJXp-mtext" id="MJXp-Span-2143">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2144">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2145">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2146">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2147">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2148">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2149">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2150">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2151">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2152">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2153">l</span><span class="MJXp-msubsup" id="MJXp-Span-2154"><span class="MJXp-mrow" id="MJXp-Span-2155" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2156">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2159">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2157"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2158">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2160">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2161">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2162">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2163">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2164">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2165">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2166">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2167">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2168">r</span><span class="MJXp-mo" id="MJXp-Span-2169" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2170">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2171">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2172">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2173">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2174">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2175">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2176">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2177">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2178">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2179">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2180">l</span><span class="MJXp-mrow" id="MJXp-Span-2181"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2182">p</span></span><span class="MJXp-mo" id="MJXp-Span-2183" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-112"> \ boldsymbol {p} \ rightarrow \ boldsymbol {p} - [\ boldsymbol {J} _ {r} ^ \ intercal \ boldsymbol {J} _ {r}] ^ {- 1} \ boldsymbol {J} _ {r } ^ \ intercal r (\ boldsymbol {p}) </script></p><br><p>  L'enregistrement sous la forme co√Øncide compl√®tement avec l'enregistrement de la m√©thode de Newton.  Seulement au lieu de la matrice de Hesse est utilis√©e <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2184"><span class="MJXp-mtext" id="MJXp-Span-2185">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2186">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2187">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2188">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2189">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2190">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2191">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2192">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2193">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2194">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2195">l</span><span class="MJXp-msubsup" id="MJXp-Span-2196"><span class="MJXp-mrow" id="MJXp-Span-2197" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2198">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2201">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2199"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2200">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2202">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2203">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2204">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2205">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2206">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2207">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2208">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2209">l</span><span class="MJXp-mtext" id="MJXp-Span-2210">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2211">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2212">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2213">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2214">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2215">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2216">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2217">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2218">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2219">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2220">l</span><span class="MJXp-msubsup" id="MJXp-Span-2221"><span class="MJXp-mrow" id="MJXp-Span-2222" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2223">J</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2224" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2225">r</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113"> \ boldsymbol {J} _ {r} ^ \ intercal \ boldsymbol {J} _ {r} </script>  au lieu du gradient <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2226"><span class="MJXp-mtext" id="MJXp-Span-2227">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2228">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2229">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2230">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2231">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2232">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2233">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2234">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2235">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2236">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2237">l</span><span class="MJXp-msubsup" id="MJXp-Span-2238"><span class="MJXp-mrow" id="MJXp-Span-2239" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2240">J</span></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mtext" id="MJXp-Span-2243">&nbsp;</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2241"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2242">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2244">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2245">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2246">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2247">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2248">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2249">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2250">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2251">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2252">r</span><span class="MJXp-mo" id="MJXp-Span-2253" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-2254">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2255">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2256">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2257">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2258">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2259">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2260">y</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2261">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2262">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2263">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2264">l</span><span class="MJXp-mrow" id="MJXp-Span-2265"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2266">p</span></span><span class="MJXp-mo" id="MJXp-Span-2267" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114"> \ boldsymbol {J} _ {r} ^ \ intercal r (\ boldsymbol {p}) </script>  .  Ensuite, nous verrons pourquoi une telle approximation peut √™tre utilis√©e.  En attendant, passons √† l'impl√©mentation sur TensorFlow: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  ,  TensorFlow     , #   ,        #  .  ,   : # 1)       tf.unstack(r) # 2)      tf.gradients(r_i, p) # 3)       tf.stack #      ,     #       j = tf.stack([tf.gradients(r_i, p)[0] for r_i in tf.unstack(r)]) jT = tf.transpose(j) #     - r_col = tf.expand_dims(r, -1) #      hess_approx = tf.matmul(jT, j) grad_approx = tf.matmul(jT, r_col) # ,      dp = tf.matmul(tf.linalg.inv(hess_approx), grad_approx) #  -  - dp = tf.squeeze(dp) #  p  dp    ng = opt.apply_gradients([(dp, p)]) #   ,    40000  session.run(tf.global_variables_initializer()) train(1e-10, 40000, loss, ng, feed_dict)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 3868.2291666666665 step: 2, current loss: 14.653025157673625 step: 4, current loss: 4.3918079172783016e-07 ENDED ON STEP: 4, FINAL LOSS: 3.374364957618591e-17 PARAMETERS: [2.5 2.5]</code> </pre> <br><p>  Assez 4 √©tapes.  Moins que pour la m√©thode de Newton. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/iq/ns/5l/iqns5lhcfqamjgy_f6isppnaxo4.jpeg"></div><br><p>  Comme le montre le code, la fonction de perte n'est pas utilis√©e dans l'optimisation, uniquement pour les crit√®res d'arr√™t et de journalisation.  Comment l'algorithme d'optimisation sait-il quelle fonction minimiser?  La r√©ponse est surprenante: pas question!  Gauss-Newton minimise uniquement l' <em>erreur quadratique moyenne</em> . </p><br><h4 id="zakrepim-matematicheskuyu-chast-stati">  Correction de la partie math√©matique de l'article </h4><br><p>  Nous avons r√©p√©t√© tous les calculs dont nous avions besoin.  Corrigeons-le un peu afin de nous concentrer davantage uniquement sur la programmation et TensorFlow.  Vous aurez peut-√™tre besoin d'un crayon pour tracer la s√©quence d'actions math√©matiques. </p><br><p>  Il y a un mod√®le <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2268"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2269">y</span><span class="MJXp-mo" id="MJXp-Span-2270" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2271">f</span><span class="MJXp-mo" id="MJXp-Span-2272" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2273">x</span><span class="MJXp-mo" id="MJXp-Span-2274" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2275">p</span><span class="MJXp-mo" id="MJXp-Span-2276" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115"> y = f (x, p) </script>  o√π <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2277"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2278">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116"> x </script>  - vecteur <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2280">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117"> p </script>  - vecteur de param√®tres de dimension <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2281"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2282">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118"> n </script>  et <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2283"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2284">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-119-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-119"> y </script>  - scalaire.  Des exp√©riences re√ßues <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2285"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2286">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-120-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-120"> m </script>  des points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2287"><span class="MJXp-mo" id="MJXp-Span-2288" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2289"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2290" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2291" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2292">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2293" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2295" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2296" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2297">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2298" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2299" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2300" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2301" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2302" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2303" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2304" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2305"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2306" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2307" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2308">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2309" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2311" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2312" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2313">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2314" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-121-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-121"> (x_ {1}, y_ {1}), ..., (x_ {m}, y_ {m}) </script>  ( <em>paires de donn√©es</em> ).  La fonction r√©siduelle du vecteur d√©pend uniquement du vecteur de param√®tre: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2315"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2316">r</span><span class="MJXp-mo" id="MJXp-Span-2317" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2318">p</span><span class="MJXp-mo" id="MJXp-Span-2319" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2320" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2321" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2322"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2323" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2324" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2325">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2326" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2327">p</span><span class="MJXp-mo" id="MJXp-Span-2328" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2329" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2330" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2331" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2332" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-msubsup" id="MJXp-Span-2333"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2334" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2335" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2336">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2337" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2338">p</span><span class="MJXp-mo" id="MJXp-Span-2339" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2340" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-122-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-122"> r (p) = (r_ {1} (p), ... r_ {m} (p)) </script>  o√π <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2341"><span class="MJXp-msubsup" id="MJXp-Span-2342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2343" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2344" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2345">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2346" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2347">p</span><span class="MJXp-mo" id="MJXp-Span-2348" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2349" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2350"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2351" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2352" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2353">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2354" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-2355">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2356">w</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2357">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2358">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2359">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2360">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2361">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2362">t</span><span class="MJXp-mrow" id="MJXp-Span-2363"><span class="MJXp-msubsup" id="MJXp-Span-2364"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2365" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2366" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2367">k</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2368" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2370" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2371" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2372">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2373" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2374">f</span><span class="MJXp-mo" id="MJXp-Span-2375" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2377" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2378" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2379">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2380" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2381">p</span><span class="MJXp-mo" id="MJXp-Span-2382" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-123-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-123"> r_ {k} (p) = y_ {k} - \ widehat {y_ {k}} = y_ {k} - f (x_ {k}, p) </script>  .   ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2384">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-124-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-124">p</script> ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2385"><span class="MJXp-msubsup" id="MJXp-Span-2386"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2387" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2388" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2389">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2390" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2391"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2392" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2393" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2394">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-125-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-125">x_{k}, y_{k}</script>  ?   ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2395"><span class="MJXp-msubsup" id="MJXp-Span-2396"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2397" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2398" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2399">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-2400" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2401"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2402" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2403" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2404">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-126-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-126">x_{k}, y_{k}</script>      ,      . </p><br><p>       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2405"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2406">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-127-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-127">p</script> ,  <em>  </em> ( <em>sum of squared error</em> ‚Äî <em>sse</em>  <em>residual sum-of-squares</em> ‚Äî <em>rss</em> )  .    <em>mse</em>    <em>sse</em> ,       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2407"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2408">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-128-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-128"> m </script>  .             .     : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2410">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2411">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2412">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2413">s</span><span class="MJXp-mo" id="MJXp-Span-2414" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2415">p</span><span class="MJXp-mo" id="MJXp-Span-2416" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2417" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2418"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2419" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2422">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2420"><span class="MJXp-mn" id="MJXp-Span-2421">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2423" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2424">p</span><span class="MJXp-mo" id="MJXp-Span-2425" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2426" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-2427" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span><span class="MJXp-mo" id="MJXp-Span-2428" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2429"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2430" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2433">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2432">m</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2434" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2435">p</span><span class="MJXp-mo" id="MJXp-Span-2436" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2437" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2438"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2444" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2445">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2439" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2440" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2441">k</span><span class="MJXp-mo" id="MJXp-Span-2442">=</span><span class="MJXp-mn" id="MJXp-Span-2443">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2447" style="margin-right: 0.05em;">r</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-2450">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2448"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2449">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2451" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2452">p</span><span class="MJXp-mo" id="MJXp-Span-2453" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-129-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-129">loss(p) = r_{1}^2(p) + \cdots + r_{m}^2(p) = \sum_{k=1}^{m} r_{k}^2(p)</script></p><br><p>        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2454"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2455">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-130-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-130">p</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2456"><span class="MJXp-mo" id="MJXp-Span-2457" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2458">p</span><span class="MJXp-mo" id="MJXp-Span-2459" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-131-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-131">(p)</script>  . </p><br><p>    ,        .  ‚Äî    .   ‚Äî   ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2460"><span class="MJXp-msubsup" id="MJXp-Span-2461"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2462" style="margin-right: 0.05em;">r</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2463" style="vertical-align: 0.5em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-132-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-132">r^2</script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2464"><span class="MJXp-mn" id="MJXp-Span-2465">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2466">r</span><span class="MJXp-mfrac" id="MJXp-Span-2467" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2468">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2469">r</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2470">‚àÇ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2471">p</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-133-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-133">2r \frac{\partial r}{\partial p}</script>  .   : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2472"><span class="MJXp-msubsup" id="MJXp-Span-2473"><span class="MJXp-mi" id="MJXp-Span-2474" style="margin-right: 0.05em;">‚àá</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2475" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2476">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2477">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2478">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2479">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2480">s</span><span class="MJXp-mo" id="MJXp-Span-2481" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-2482" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-munderover" id="MJXp-Span-2483"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2489" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2490">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2484" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2485" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2486">k</span><span class="MJXp-mo" id="MJXp-Span-2487">=</span><span class="MJXp-mn" id="MJXp-Span-2488">1</span></span></span></span><span class="MJXp-mn" id="MJXp-Span-2491">2</span><span class="MJXp-msubsup" id="MJXp-Span-2492"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2493" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2494" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2495">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2496" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2497">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2499" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2500" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2501">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2502">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2503"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2504" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2505" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2506">1</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2507" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2508" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span><span class="MJXp-mo" id="MJXp-Span-2509" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-munderover" id="MJXp-Span-2510"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2516" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2517">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2511" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2512" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2513">k</span><span class="MJXp-mo" id="MJXp-Span-2514">=</span><span class="MJXp-mn" id="MJXp-Span-2515">1</span></span></span></span><span class="MJXp-mn" id="MJXp-Span-2518">2</span><span class="MJXp-msubsup" id="MJXp-Span-2519"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2520" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2521" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2522">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2523" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2524">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2526" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2527" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2528">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2529">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2530"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2531" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2532" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2533">n</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2534" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-134-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-134">\nabla_{p}loss = (\sum_{k=1}^{m}2r_{k}\frac{\partial r_{k}}{\partial p_{1}}, \cdots, \sum_{k=1}^{m}2r_{k}\frac{\partial r_{k}}{\partial p_{n}}) </script></p><br><p>        .      : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2535"><span class="MJXp-mo" id="MJXp-Span-2536" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2537">H</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2538">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2539">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2540">s</span><span class="MJXp-msubsup" id="MJXp-Span-2541"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2542" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2543" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2544">p</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2545"><span class="MJXp-mo" id="MJXp-Span-2546" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2547" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2548">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2549">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-2550" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-2551" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2552"><span class="MJXp-mi" id="MJXp-Span-2553" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2554" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2555">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2556">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2557">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2558">s</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2559">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2561" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2562" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2563">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2564">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2566" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2567" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2568">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2569" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-2570"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2576" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2577">m</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-2571" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-2572" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2573">k</span><span class="MJXp-mo" id="MJXp-Span-2574">=</span><span class="MJXp-mn" id="MJXp-Span-2575">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2578" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-2579">2</span><span class="MJXp-mfrac" id="MJXp-Span-2580" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2581">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2583" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2584" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2585">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2586">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2588" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2589" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2590">i</span></span></span></span></span></span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2591" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2592">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2593"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2594" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2595" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2596">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2597">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2598"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2599" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2600" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2601">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2602" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-2603">2</span><span class="MJXp-msubsup" id="MJXp-Span-2604"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2605" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2606" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2607">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2608" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-2609"><span class="MJXp-mi" id="MJXp-Span-2610" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2611" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-2612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2613" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2614" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2615">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi" id="MJXp-Span-2616">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2618" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2619" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2620">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2621">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2623" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2624" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2625">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2626" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-135-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-135">[\boldsymbol{H}loss_{p}]_{ij} = \frac{\partial^2 loss}{\partial p_{i} \partial p_{j}} = \sum_{k=1}^{m}(2\frac{\partial r_{k}}{\partial p_{i}}\frac{\partial r_{k}}{\partial p_{j}} + 2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}})</script></p><br><p>    .        ,     ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2627"><span class="MJXp-msup" id="MJXp-Span-2628"><span class="MJXp-mrow" id="MJXp-Span-2629" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-2630" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2631">u</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2632">v</span><span class="MJXp-mo" id="MJXp-Span-2633" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2634" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-2635" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msup" id="MJXp-Span-2636"><span class="MJXp-mrow" id="MJXp-Span-2637" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2638">u</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2639" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2640">v</span><span class="MJXp-mo" id="MJXp-Span-2641" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2642">u</span><span class="MJXp-msup" id="MJXp-Span-2643"><span class="MJXp-mrow" id="MJXp-Span-2644" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2645">v</span></span><span class="MJXp-mo MJXp-script" id="MJXp-Span-2646" style="vertical-align: 0.5em;">‚Ä≤</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-136-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-136">{(uv)}'={u}'v+u{v}'</script>  . <br>  Super!     . </p><br><p> ,        ,       , ‚Äî  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2647"><span class="MJXp-mn" id="MJXp-Span-2648">2</span><span class="MJXp-msubsup" id="MJXp-Span-2649"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2650" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2651" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2652">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2653" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2654"><span class="MJXp-mi" id="MJXp-Span-2655" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2656" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-2657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2658" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2659" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2660">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2661">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2662"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2663" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2664" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2665">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2666">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2668" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2669" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2670">j</span></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-137-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-137">2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}}</script>  .    ,   ,   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2671"><span class="MJXp-msubsup" id="MJXp-Span-2672"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2673" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2674" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2675">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-138-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-138">r_{k}</script> ,     .          ‚Äî     .   ,    ?    -. </p><br><p>     : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2676"><span class="MJXp-msubsup" id="MJXp-Span-2677"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2678" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2679" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2680">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-2681" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-2682"><span class="MJXp-mo" id="MJXp-Span-2683" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.183em;"><span class="MJXp-right MJXp-scale2" style="font-size: 9.733em; margin-left: -0.25em;">(</span></span><span class="MJXp-mtable" id="MJXp-Span-2684"><span><span class="MJXp-mtr" id="MJXp-Span-2685" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2686" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2687" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2688">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2689"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2690" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2691" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2692">1</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2693">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2695" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2696" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2697">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2698" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2699" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-2700" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2701" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2702">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2703"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2704" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2705" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2706">1</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2707">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2709" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2710" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2711">n</span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-2712" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2713" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2714" style="margin-left: 0.333em; margin-right: 0.333em;">‚ãÆ</span></span><span class="MJXp-mtd" id="MJXp-Span-2715" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2716" style="margin-left: 0.333em; margin-right: 0.333em;">‚ã±</span></span><span class="MJXp-mtd" id="MJXp-Span-2717" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2718" style="margin-left: 0.333em; margin-right: 0.333em;">‚ãÆ</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2719" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2720" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2721" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2722">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2723"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2724" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2725" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2726">m</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2727">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2729" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2730" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2731">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2732" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2733" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-2734" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-2735" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2736">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2737"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2738" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2739" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2740">m</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2741">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2743" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2744" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2745">n</span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2746" style="margin-left: 0em; margin-right: 0em; vertical-align: -2.183em;"><span class="MJXp-right MJXp-scale2" style="font-size: 9.733em; margin-left: -0.25em;">)</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-139-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-139">\boldsymbol{J}_{r} = \begin{pmatrix} \frac{\partial r_{1}}{\partial p_{1}} & \cdots & \frac{\partial r_{1}}{\partial p_{n}}\\ \vdots & \ddots & \vdots \\ \frac{\partial r_{m}}{\partial p_{1}} & \cdots & \frac{\partial p_{m}}{\partial p_{n}} \end{pmatrix}</script></p><br><p> ,    ,     .  Notez que: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2754"><span class="MJXp-mn" id="MJXp-Span-2755">2</span><span class="MJXp-msubsup" id="MJXp-Span-2756"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2757" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-2760">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2758"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2759">r</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2761"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2762" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2763" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2764">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-2765" style="margin-left: 0.333em; margin-right: 0.333em;">‚âà</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2766">H</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2767">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2768">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2769">s</span><span class="MJXp-msubsup" id="MJXp-Span-2770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2771" style="margin-right: 0.05em;">s</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2772" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2773">p</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-140-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-140">2\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r} \approx \boldsymbol{H}loss_{p}</script></p><br><p>   ""     .         (   ).    ,   ‚Äî        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2774"><span class="MJXp-mn" id="MJXp-Span-2775">2</span><span class="MJXp-msubsup" id="MJXp-Span-2776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2777" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2778" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2779">k</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-2780" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-2781"><span class="MJXp-mi" id="MJXp-Span-2782" style="margin-right: 0.05em;">‚àÇ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2783" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-msubsup" id="MJXp-Span-2784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2785" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2786" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2787">k</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-2788">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2789"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2790" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2791" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2792">i</span></span></span><span class="MJXp-mi" id="MJXp-Span-2793">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-2794"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2795" style="margin-right: 0.05em;">p</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2796" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2797">j</span></span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-141-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-141">2r_{k}\frac{\partial^2 r_{k}}{\partial p_{i}\partial p_{j}}</script> ,     . <br>     (    ): </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2798"><span class="MJXp-mn" id="MJXp-Span-2799">2</span><span class="MJXp-msubsup" id="MJXp-Span-2800"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-2801" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-2804">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2802"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2803">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2805">r</span><span class="MJXp-mo" id="MJXp-Span-2806" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2807"><span class="MJXp-mi" id="MJXp-Span-2808" style="margin-right: 0.05em;">‚àá</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2809" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2810">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2811">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2812">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2813">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2814">s</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-142-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-142">2\boldsymbol{J}_{r}^\intercal r = \nabla_{p}loss</script></p><br><p>  ,    ,   - ‚Äî          ,       <em>mse</em> . </p><br><h4 id="pereformuliruem-i-uslozhnim-zadachu">     </h4><br><p>      .    ,   ,   .  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2816">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-143-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-143"> m </script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2817"><span class="MJXp-mo" id="MJXp-Span-2818" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2819"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2820" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2821" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2822">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2823" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2824"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2825" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2826" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2827">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2828" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-2829" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2830" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2831" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2832" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-2833" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-2834" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-2835"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2836" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2837" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2838">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2839" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-2840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2841" style="margin-right: 0.05em;">y</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2842" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2843">m</span></span></span><span class="MJXp-mo" id="MJXp-Span-2844" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-144-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-144">(x_{1}, y_{1}), ..., (x_{m}, y_{m})</script> ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2845"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2846">y</span><span class="MJXp-mo" id="MJXp-Span-2847" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2848">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2849">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2850">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2851">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2852">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2853">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2854">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2855">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2856">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2857">k</span><span class="MJXp-mo" id="MJXp-Span-2858" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2859">x</span><span class="MJXp-mo" id="MJXp-Span-2860" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2861">p</span><span class="MJXp-mo" id="MJXp-Span-2862" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-145-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-145">y = rosenbrock(x, p)</script>  .          <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2864">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-146-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-146">p</script> ,      . </p><br><p>   ,     : " <em>       .  - !</em> ".  ,      ,     ,        ( <em>supervised learning</em> ). ,    .     :  ( <em>training set</em> ) ‚Äî   ;   ‚Äî      ( <em>prediction model</em> )    ;   ‚Äî          ,    . </p><br><p>     <em> </em> ( <em>multi-layer perceptron neural network</em>  <em>mlp</em> ).  ,      ,       : </p><br><ul><li> <em> </em> ( <em>starting values</em> ) .     Xavier'a,       . </li><li> <em></em> ( <em>overfitting</em> ).   ‚Äî  .     ,    .    ‚Äî   . </li><li> <em>  </em> ( <em>scaling of the input</em> ).   ,      . </li></ul><br><p>     9 .     500: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    def get_random_rosenbrock_data_points(m): result = np.zeros((m, 3)) result[:, 0] = np.random.uniform(-2, 2, m) result[:, 1] = np.random.uniform(-2, 2, m) result[:, 2] = rosenbrock(result[:, 0], result[:, 1], 2.5, 2.5) return result m = 500 data_points = get_random_rosenbrock_data_points(m) # overfitting   ,      validation_data_points = get_random_rosenbrock_data_points(m)</span></span></code> </pre> <br><p>    500 .   ‚Äî         ( <em>learner</em> ),     ( <em>outcome measurement</em> )   ( <em>features</em> )     . </p><br><h4 id="realizuem-odnosloynyy-perceptron">    </h4><br><p>          ( <em>network diagram</em> ).        MatLab: </p><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/np/nt/xk/npntxk7brhnpkk7p5v1p4bjur-a.png"></div><br><p>        ( <em>input</em> ).      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2866">W</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-147-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-147">W</script> ( <em>weights</em> )  2x10,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2867"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2868">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-148-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-148">b</script> ( <em>bias</em> )  10,       ( <em>activation</em> ).    ()   ( <em>hidden layer</em> )  10 .         ,   ,         ( <em>output</em> ). </p><br><p>   ,   ,  (  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-2869"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2870">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2871">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2872">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2873">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-149-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-149">tanh</script>  ): </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2874"><span class="MJXp-mtable" id="MJXp-Span-2875"><span><span class="MJXp-mtr" id="MJXp-Span-2876" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2877" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2878"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2879" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2880" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2881">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2882" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2883">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2884">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2885">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2886">h</span><span class="MJXp-mo" id="MJXp-Span-2887" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2888">x</span><span class="MJXp-msubsup" id="MJXp-Span-2889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2890" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2891" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2892">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2893" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2894"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2895" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2896" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2897">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-2898" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-2899" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2900" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mrow" id="MJXp-Span-2901"><span class="MJXp-munderover" id="MJXp-Span-2902"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-2904" style="margin-left: 0px; margin-right: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2903">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2905" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-2906"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2907" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2908" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2909">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-2910"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2911" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2912" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2913">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-2914" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-2915"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2916" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-2917" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-2918">2</span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-150-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-150">\begin{matrix} h_{1} = tanh(xW_{1} + b_{1})\\ \widehat{y} = h_{1}W_{2} + b_{2} \end{matrix} </script></p><br><p>  : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-2919"><span class="MJXp-msubsup" id="MJXp-Span-2920"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2921" style="margin-right: 0.05em;">h</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2922" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-2923" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2924">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2925">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2926">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2927">h</span><span class="MJXp-mo" id="MJXp-Span-2928" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mrow" id="MJXp-Span-2929"><span class="MJXp-mo" id="MJXp-Span-2930" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-2931"><span><span class="MJXp-mtr" id="MJXp-Span-2932" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2933" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2934"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2935" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2936" style="vertical-align: -0.4em;">1</span></span></span><span class="MJXp-mtd" id="MJXp-Span-2937" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2938"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2939" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-2940" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2941" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">]</span></span></span><span class="MJXp-mrow" id="MJXp-Span-2942"><span class="MJXp-mo" id="MJXp-Span-2943" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-2944"><span><span class="MJXp-mtr" id="MJXp-Span-2945" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2946" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2947"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2948" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2953"><span class="MJXp-mo" id="MJXp-Span-2954">(</span><span class="MJXp-mn" id="MJXp-Span-2955">1</span><span class="MJXp-mo" id="MJXp-Span-2956">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2949"><span class="MJXp-mn" id="MJXp-Span-2950">1</span><span class="MJXp-mo" id="MJXp-Span-2951">,</span><span class="MJXp-mn" id="MJXp-Span-2952">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2957" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2958" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-2959" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2960"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2961" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2966"><span class="MJXp-mo" id="MJXp-Span-2967">(</span><span class="MJXp-mn" id="MJXp-Span-2968">1</span><span class="MJXp-mo" id="MJXp-Span-2969">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2962"><span class="MJXp-mn" id="MJXp-Span-2963">1</span><span class="MJXp-mo" id="MJXp-Span-2964">,</span><span class="MJXp-mn" id="MJXp-Span-2965">10</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-2970" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-2971" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2972"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2973" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2978"><span class="MJXp-mo" id="MJXp-Span-2979">(</span><span class="MJXp-mn" id="MJXp-Span-2980">1</span><span class="MJXp-mo" id="MJXp-Span-2981">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2974"><span class="MJXp-mn" id="MJXp-Span-2975">2</span><span class="MJXp-mo" id="MJXp-Span-2976">,</span><span class="MJXp-mn" id="MJXp-Span-2977">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-2982" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-2983" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-2984" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-2985"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2986" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-2991"><span class="MJXp-mo" id="MJXp-Span-2992">(</span><span class="MJXp-mn" id="MJXp-Span-2993">1</span><span class="MJXp-mo" id="MJXp-Span-2994">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-2987"><span class="MJXp-mn" id="MJXp-Span-2988">2</span><span class="MJXp-mo" id="MJXp-Span-2989">,</span><span class="MJXp-mn" id="MJXp-Span-2990">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-2995" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-2996" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mrow" id="MJXp-Span-2997"><span class="MJXp-mo" id="MJXp-Span-2998" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-2999"><span><span class="MJXp-mtr" id="MJXp-Span-3000" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3001" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3002"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3003" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3005"><span class="MJXp-mo" id="MJXp-Span-3006">(</span><span class="MJXp-mn" id="MJXp-Span-3007">1</span><span class="MJXp-mo" id="MJXp-Span-3008">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3004">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3009" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3010" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3011" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3012"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3013" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3016"><span class="MJXp-mo" id="MJXp-Span-3017">(</span><span class="MJXp-mn" id="MJXp-Span-3018">1</span><span class="MJXp-mo" id="MJXp-Span-3019">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3014"><span class="MJXp-mn" id="MJXp-Span-3015">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3020" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-3021" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-3022" style="width: 0em; height: 0em;"></span><span class="MJXp-mrow" id="MJXp-Span-3023"><span class="MJXp-munderover" id="MJXp-Span-3024"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3026" style="margin-left: 0px; margin-right: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3025">y</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3027" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3028"><span class="MJXp-mo" id="MJXp-Span-3029" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3030"><span><span class="MJXp-mtr" id="MJXp-Span-3031" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3032" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3033"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3034" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3036"><span class="MJXp-mo" id="MJXp-Span-3037">(</span><span class="MJXp-mn" id="MJXp-Span-3038">1</span><span class="MJXp-mo" id="MJXp-Span-3039">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3035">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3040" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3041" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3042" style="padding-left: 1em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3043"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3044" style="margin-right: 0.05em;">h</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3047"><span class="MJXp-mo" id="MJXp-Span-3048">(</span><span class="MJXp-mn" id="MJXp-Span-3049">1</span><span class="MJXp-mo" id="MJXp-Span-3050">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3045"><span class="MJXp-mn" id="MJXp-Span-3046">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3051" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span><span class="MJXp-mrow" id="MJXp-Span-3052"><span class="MJXp-mo" id="MJXp-Span-3053" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3054"><span><span class="MJXp-mtr" id="MJXp-Span-3055" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3056" style="text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3058" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3063"><span class="MJXp-mo" id="MJXp-Span-3064">(</span><span class="MJXp-mn" id="MJXp-Span-3065">2</span><span class="MJXp-mo" id="MJXp-Span-3066">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3059"><span class="MJXp-mn" id="MJXp-Span-3060">1</span><span class="MJXp-mo" id="MJXp-Span-3061">,</span><span class="MJXp-mn" id="MJXp-Span-3062">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3067" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3068" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3069" style="margin-left: 0.333em; margin-right: 0.333em;">‚ãÆ</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3070" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3071" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-msubsup" id="MJXp-Span-3072"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3073" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3078"><span class="MJXp-mo" id="MJXp-Span-3079">(</span><span class="MJXp-mn" id="MJXp-Span-3080">2</span><span class="MJXp-mo" id="MJXp-Span-3081">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3074"><span class="MJXp-mn" id="MJXp-Span-3075">1</span><span class="MJXp-mo" id="MJXp-Span-3076">,</span><span class="MJXp-mn" id="MJXp-Span-3077">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3082" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-3083" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-msubsup" id="MJXp-Span-3084"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3085" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3086" style="vertical-align: -0.4em;">2</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-151-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-151">h_1 = tanh(\begin{bmatrix} x_1 & x_2 \end{bmatrix}\begin{bmatrix} w^{(1)}_{1,1} & \cdots& w^{(1)}_{1,10} \\ w^{(1)}_{2,1} &\cdots& w^{(1)}_{2,10} \end{bmatrix} + \begin{bmatrix} b^{(1)}_1 & \cdots & b^{(1)}_{10} \end{bmatrix}) \\ \widehat{y} = \begin{bmatrix}h^{(1)}_1 & \cdots & h^{(1)}_{10}\end{bmatrix} \begin{bmatrix} w^{(2)}_{1,1} \\ \vdots \\ w^{(2)}_{1,10} \\ \end{bmatrix} + b_2 </script></p><br><p>    .  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3087"><span class="MJXp-msubsup" id="MJXp-Span-3088"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3089" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3090" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3091">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-152-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-152">W_{1}</script>        ""   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3092"><span class="MJXp-msubsup" id="MJXp-Span-3093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3094" style="margin-right: 0.05em;">h</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3095" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3096">1</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-153-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-153">h_{1}</script> ,       - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3097"><span class="MJXp-msubsup" id="MJXp-Span-3098"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3099" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3100" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3101">2</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-154-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-154">W_{2}</script>  .  41 .       ,    . </p><br><p>       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3102"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3103">m</span><span class="MJXp-mo" id="MJXp-Span-3104" style="margin-left: 0.267em; margin-right: 0.267em;">√ó</span><span class="MJXp-mn" id="MJXp-Span-3105">2</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-155-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-155">m \times 2</script> ,          .   - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3106"><span class="MJXp-mrow" id="MJXp-Span-3107"><span class="MJXp-munderover" id="MJXp-Span-3108"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-3110" style="margin-left: 0px; margin-right: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3109">y</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-156-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-156">\widehat{y}</script>  de <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3111"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3112">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-157-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-157"> m </script> : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     10 "" n_hidden = 10 #      Xavier'a initializer = tf.contrib.layers.xavier_initializer() #    x = tf.placeholder(tf.float64, shape=[m, 2]) y = tf.placeholder(tf.float64, shape=[m, 1]) #         W1 = tf.Variable(initializer([2, n_hidden], dtype=tf.float64)) b1 = tf.Variable(initializer([1, n_hidden], dtype=tf.float64)) #   ,  tanh   h1 = tf.nn.tanh(tf.matmul(x, W1) + b1) #        W2 = tf.Variable(initializer([n_hidden, 1], dtype=tf.float64)) b2 = tf.Variable(initializer([1], dtype=tf.float64)) #   y_hat = tf.matmul(h1, W2) + b2 #  r = y - y_hat #   mse     loss = tf.reduce_mean(tf.square(r)) #      placeholder feed_dict = {x: data_points[:,0:2], y: data_points[:,2:3]} validation_feed_dict = {x: validation_data_points[:,0:2], y: validation_data_points[:,2:3]}</span></span></code> </pre> <br><h4 id="obuchim-neyroset-metodom-adam">    Adam </h4><br><p>     Adam         <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3113"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3114">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3115">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3116">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3117">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3118">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3119">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3120">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3121">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3122">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3123">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-158-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-158">rosenbrock</script>  .   mse     : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    adm = tf.train.AdamOptimizer(1e-2).minimize(loss) session.run(tf.global_variables_initializer()) #   ,    40000  train(1e-10, 40000, loss, adm, feed_dict) print('VALIDATION LOSS: '+str(session.run(loss, validation_feed_dict)))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 671.4242576535694 [...] ENDED ON STEP: 40000, FINAL LOSS: 0.22862158574440725 VALIDATION LOSS: 0.29000289644978866</code> </pre> <br><p>       .      :   ,  ,   . </p><br><h4 id="vychislim-matricu-yakobi-dlya-neyronnoy-seti">       </h4><br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3125">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3126">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3127">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3128">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3129">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3130">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3131">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3132">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3133">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3134">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-159-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-159">rosenbrock</script>     2  .    : </p><br><ul><li> .   9 ,  500.        . </li><li> .   -  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3136">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-160-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-160">p</script> ,        . </li></ul><br><p>    : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#      y   x def jacobian(y, x): loop_vars = [ tf.constant(0, tf.int32), tf.TensorArray(tf.float64, size=m), ] #  -   #      _, jacobian = tf.while_loop( lambda i, _: i &lt; m, #           #   (-),   x     lambda i, res: (i+1, res.write(i, tf.reshape(tf.gradients(y[i], x), (-1,)))), loop_vars) #       return jacobian.stack() #       r_flat = tf.squeeze(r) #        #       parms = [W1, b1, W2, b2] parms_sizes = [tf.size(p) for p in parms] j = tf.concat([jacobian(r_flat, p) for p in parms], 1) jT = tf.transpose(j) #           hess_approx = tf.matmul(jT, j) grad_approx = tf.matmul(jT, r)</span></span></code> </pre> <br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3137"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3138">J</span><span class="MJXp-msubsup" id="MJXp-Span-3139"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3140" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3141" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3142">p</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-161-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-161">\boldsymbol{J}r_{p}</script>       .       ,   4  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3143"><span class="MJXp-msubsup" id="MJXp-Span-3144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3145" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3146" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3147" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3148"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3149" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3150" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3151" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3152"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3153" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3154" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3155" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3156"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3157" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3158" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-162-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-162">W_1, b_1, W_2, b_2</script>  .  4  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3159"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3160">J</span><span class="MJXp-msubsup" id="MJXp-Span-3161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3162" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3163" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3164"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3165" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3166" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3167" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3168">J</span><span class="MJXp-msubsup" id="MJXp-Span-3169"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3170" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3171" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3172"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3173" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3174" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3175" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3176">J</span><span class="MJXp-msubsup" id="MJXp-Span-3177"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3178" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3179" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3181" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3182" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3183" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3184">J</span><span class="MJXp-msubsup" id="MJXp-Span-3185"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3186" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3187" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-3188"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3189" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3190" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-163-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-163">\boldsymbol{J}r_{W_1}, \boldsymbol{J}r_{b_1}, \boldsymbol{J}r_{W_2}, \boldsymbol{J}r_{b_2}</script>      <em>tf.concat</em> . </p><br><p>         . <em>tf.while_loop</em>    ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3191"><span class="MJXp-msubsup" id="MJXp-Span-3192"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3193" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3194" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-164-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-164">r_i</script> ,        ,       <em>stack</em> . </p><br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3195"><span class="MJXp-msubsup" id="MJXp-Span-3196"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3197" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3198" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-165-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-165">r_i</script>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3199"><span class="MJXp-msubsup" id="MJXp-Span-3200"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3201" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3202" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-166-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-166">W_1</script>  : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3203"><span class="MJXp-mrow" id="MJXp-Span-3204"><span class="MJXp-mo" id="MJXp-Span-3205" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.917em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.667em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3206"><span><span class="MJXp-mtr" id="MJXp-Span-3207" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3208" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3209" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3210">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3211"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3212" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3213" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3214">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3215"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3216" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3221"><span class="MJXp-mo" id="MJXp-Span-3222">(</span><span class="MJXp-mn" id="MJXp-Span-3223">1</span><span class="MJXp-mo" id="MJXp-Span-3224">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3217"><span class="MJXp-mn" id="MJXp-Span-3218">1</span><span class="MJXp-mo" id="MJXp-Span-3219">,</span><span class="MJXp-mn" id="MJXp-Span-3220">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3225" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3226" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3227" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3228" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3229">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3231" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3232" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3233">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3235" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3240"><span class="MJXp-mo" id="MJXp-Span-3241">(</span><span class="MJXp-mn" id="MJXp-Span-3242">1</span><span class="MJXp-mo" id="MJXp-Span-3243">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3236"><span class="MJXp-mn" id="MJXp-Span-3237">1</span><span class="MJXp-mo" id="MJXp-Span-3238">,</span><span class="MJXp-mn" id="MJXp-Span-3239">10</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3244" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3245" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3246" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3247">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3248"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3249" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3250" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3251">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3252"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3253" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3258"><span class="MJXp-mo" id="MJXp-Span-3259">(</span><span class="MJXp-mn" id="MJXp-Span-3260">1</span><span class="MJXp-mo" id="MJXp-Span-3261">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3254"><span class="MJXp-mn" id="MJXp-Span-3255">2</span><span class="MJXp-mo" id="MJXp-Span-3256">,</span><span class="MJXp-mn" id="MJXp-Span-3257">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3262" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3263" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3264" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3265" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3266">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3267"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3268" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3269" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3270">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3271"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3272" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3277"><span class="MJXp-mo" id="MJXp-Span-3278">(</span><span class="MJXp-mn" id="MJXp-Span-3279">1</span><span class="MJXp-mo" id="MJXp-Span-3280">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3273"><span class="MJXp-mn" id="MJXp-Span-3274">2</span><span class="MJXp-mo" id="MJXp-Span-3275">,</span><span class="MJXp-mn" id="MJXp-Span-3276">10</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3281" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.917em;"><span class="MJXp-right MJXp-scale2" style="font-size: 8.667em; margin-left: -0.25em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-167-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-167">\begin{bmatrix} \frac{\partial r_i}{\partial w^{(1)}_{1,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{1,10}} \\ \frac{\partial r_i}{\partial w^{(1)}_{2,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{2,10}} \end{bmatrix}</script>  .  <em>tf.reshape</em>   <em>(-1,)</em>     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3282"><span class="MJXp-mrow" id="MJXp-Span-3283"><span class="MJXp-mo" id="MJXp-Span-3284" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.778em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.111em; margin-left: -0.17em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3285"><span><span class="MJXp-mtr" id="MJXp-Span-3286" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3287" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3288" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3289">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3290"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3291" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3292" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3293">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3294"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3295" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3300"><span class="MJXp-mo" id="MJXp-Span-3301">(</span><span class="MJXp-mn" id="MJXp-Span-3302">1</span><span class="MJXp-mo" id="MJXp-Span-3303">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3296"><span class="MJXp-mn" id="MJXp-Span-3297">1</span><span class="MJXp-mo" id="MJXp-Span-3298">,</span><span class="MJXp-mn" id="MJXp-Span-3299">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3304" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3305" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3306" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3307" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3308">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3309"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3310" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3311" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3312">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3313"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3314" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3319"><span class="MJXp-mo" id="MJXp-Span-3320">(</span><span class="MJXp-mn" id="MJXp-Span-3321">1</span><span class="MJXp-mo" id="MJXp-Span-3322">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3315"><span class="MJXp-mn" id="MJXp-Span-3316">1</span><span class="MJXp-mo" id="MJXp-Span-3317">,</span><span class="MJXp-mn" id="MJXp-Span-3318">10</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3323" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3324" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3325">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3326"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3327" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3328" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3329">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3330"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3331" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3336"><span class="MJXp-mo" id="MJXp-Span-3337">(</span><span class="MJXp-mn" id="MJXp-Span-3338">1</span><span class="MJXp-mo" id="MJXp-Span-3339">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3332"><span class="MJXp-mn" id="MJXp-Span-3333">2</span><span class="MJXp-mo" id="MJXp-Span-3334">,</span><span class="MJXp-mn" id="MJXp-Span-3335">1</span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3340" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3341" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3342" style="padding-left: 1em; text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-3343" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3344">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3346" style="margin-right: 0.05em;">r</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3347" style="vertical-align: -0.4em;">i</span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi" id="MJXp-Span-3348">‚àÇ</span><span class="MJXp-msubsup" id="MJXp-Span-3349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3350" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3355"><span class="MJXp-mo" id="MJXp-Span-3356">(</span><span class="MJXp-mn" id="MJXp-Span-3357">1</span><span class="MJXp-mo" id="MJXp-Span-3358">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3351"><span class="MJXp-mn" id="MJXp-Span-3352">2</span><span class="MJXp-mo" id="MJXp-Span-3353">,</span><span class="MJXp-mn" id="MJXp-Span-3354">10</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3359" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.778em;"><span class="MJXp-right MJXp-scale4" style="font-size: 4.111em; margin-left: -0.17em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-168-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-168">\begin{bmatrix} \frac{\partial r_i}{\partial w^{(1)}_{1,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{1,10}} & \frac{\partial r_i}{\partial w^{(1)}_{2,1}} & \cdots& \frac{\partial r_i}{\partial w^{(1)}_{2,10}} \end{bmatrix}</script>  . </p><br><p>        .           -     .    ‚Äî TensorFlow             .   ‚Äî  -    -     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3360"><span class="MJXp-msubsup" id="MJXp-Span-3361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3362" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3363" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3364" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3366" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3367" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3368" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3370" style="margin-right: 0.05em;">W</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3371" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3372" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-3373"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3374" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3375" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-169-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-169">W_1, b_1, W_2, b_2</script>  .        -.     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Levenberg-Marquardt Jupyter Notebook</a>   <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rosenbrock_train.py</a> .       ,   TensorFlow       .  - ,      ( ) , , . </p><br><h4 id="obuchim-neyroset-metodom-gaussa-nyutona">    - </h4><br><p>  <em>hess_approx</em>  <em>grad_approx</em>       -.      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3377">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3378">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3379">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3380">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3381">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3382">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3383">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3384">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3385">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3386">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-170-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-170">rosenbrock</script>   ,               .   : </p><br><ol><li>    : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3387"><span class="MJXp-mi" id="MJXp-Span-3388">Œî</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3389">p</span><span class="MJXp-mo" id="MJXp-Span-3390" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3391"><span class="MJXp-mo" id="MJXp-Span-3392" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3393"><span><span class="MJXp-mtr" id="MJXp-Span-3394" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3395" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3396">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3397"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3398" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3403"><span class="MJXp-mo" id="MJXp-Span-3404">(</span><span class="MJXp-mn" id="MJXp-Span-3405">1</span><span class="MJXp-mo" id="MJXp-Span-3406">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3399"><span class="MJXp-mn" id="MJXp-Span-3400">1</span><span class="MJXp-mo" id="MJXp-Span-3401">,</span><span class="MJXp-mn" id="MJXp-Span-3402">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3407" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3408" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3409" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3410">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3412" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3417"><span class="MJXp-mo" id="MJXp-Span-3418">(</span><span class="MJXp-mn" id="MJXp-Span-3419">1</span><span class="MJXp-mo" id="MJXp-Span-3420">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3413"><span class="MJXp-mn" id="MJXp-Span-3414">2</span><span class="MJXp-mo" id="MJXp-Span-3415">,</span><span class="MJXp-mn" id="MJXp-Span-3416">10</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3421" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3422">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3423"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3424" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3426"><span class="MJXp-mo" id="MJXp-Span-3427">(</span><span class="MJXp-mn" id="MJXp-Span-3428">1</span><span class="MJXp-mo" id="MJXp-Span-3429">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3425">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3430" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3431" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3432" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3433">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3434"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3435" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3438"><span class="MJXp-mo" id="MJXp-Span-3439">(</span><span class="MJXp-mn" id="MJXp-Span-3440">1</span><span class="MJXp-mo" id="MJXp-Span-3441">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3436"><span class="MJXp-mn" id="MJXp-Span-3437">10</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3442" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3443">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3444"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3445" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3450"><span class="MJXp-mo" id="MJXp-Span-3451">(</span><span class="MJXp-mn" id="MJXp-Span-3452">2</span><span class="MJXp-mo" id="MJXp-Span-3453">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3446"><span class="MJXp-mn" id="MJXp-Span-3447">1</span><span class="MJXp-mo" id="MJXp-Span-3448">,</span><span class="MJXp-mn" id="MJXp-Span-3449">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3454" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3455" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3456" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3457">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3458"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3459" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3464"><span class="MJXp-mo" id="MJXp-Span-3465">(</span><span class="MJXp-mn" id="MJXp-Span-3466">2</span><span class="MJXp-mo" id="MJXp-Span-3467">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3460"><span class="MJXp-mn" id="MJXp-Span-3461">1</span><span class="MJXp-mo" id="MJXp-Span-3462">,</span><span class="MJXp-mn" id="MJXp-Span-3463">10</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3468" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3469">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3470"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3471" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3472" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3473" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-171-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-171">\Delta \boldsymbol{p} = \begin{bmatrix}\Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{2,10} & \Delta b^{(1)}_1 & \cdots & \Delta b^{(1)}_{10} & \Delta w^{(2)}_{1,1} & \cdots & \Delta w^{(2)}_{1,10} & \Delta b_2\end{bmatrix}</script></li><li>        : <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3474"><span class="MJXp-mi" id="MJXp-Span-3475">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3476"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3477" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3478" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3479">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3480" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3481"><span class="MJXp-mo" id="MJXp-Span-3482" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3483"><span><span class="MJXp-mtr" id="MJXp-Span-3484" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3485" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3486">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3488" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3493"><span class="MJXp-mo" id="MJXp-Span-3494">(</span><span class="MJXp-mn" id="MJXp-Span-3495">1</span><span class="MJXp-mo" id="MJXp-Span-3496">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3489"><span class="MJXp-mn" id="MJXp-Span-3490">1</span><span class="MJXp-mo" id="MJXp-Span-3491">,</span><span class="MJXp-mn" id="MJXp-Span-3492">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3497" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3498" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3499" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3500">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3501"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3502" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3507"><span class="MJXp-mo" id="MJXp-Span-3508">(</span><span class="MJXp-mn" id="MJXp-Span-3509">1</span><span class="MJXp-mo" id="MJXp-Span-3510">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3503"><span class="MJXp-mn" id="MJXp-Span-3504">2</span><span class="MJXp-mo" id="MJXp-Span-3505">,</span><span class="MJXp-mn" id="MJXp-Span-3506">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3511" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-172-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-172">\Delta W_{1} = \begin{bmatrix}\Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{2,10} \end{bmatrix}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3512"><span class="MJXp-mi" id="MJXp-Span-3513">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3514"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3515" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3516" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3517">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3518" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3519"><span class="MJXp-mo" id="MJXp-Span-3520" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3521"><span><span class="MJXp-mtr" id="MJXp-Span-3522" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3523" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3524">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3525"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3526" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3528"><span class="MJXp-mo" id="MJXp-Span-3529">(</span><span class="MJXp-mn" id="MJXp-Span-3530">1</span><span class="MJXp-mo" id="MJXp-Span-3531">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-3527">1</span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3532" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3533" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3534" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3535">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3536"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3537" style="margin-right: 0.05em;">b</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3540"><span class="MJXp-mo" id="MJXp-Span-3541">(</span><span class="MJXp-mn" id="MJXp-Span-3542">1</span><span class="MJXp-mo" id="MJXp-Span-3543">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3538"><span class="MJXp-mn" id="MJXp-Span-3539">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3544" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-173-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-173">\Delta b_{1} = \begin{bmatrix} \Delta b^{(1)}_1 & \cdots & \Delta b^{(1)}_{10} \end{bmatrix}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3545"><span class="MJXp-mi" id="MJXp-Span-3546">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3547"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3548" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3549" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3550">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-3551" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3552"><span class="MJXp-mo" id="MJXp-Span-3553" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3554"><span><span class="MJXp-mtr" id="MJXp-Span-3555" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3556" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3557">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3558"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3559" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3564"><span class="MJXp-mo" id="MJXp-Span-3565">(</span><span class="MJXp-mn" id="MJXp-Span-3566">2</span><span class="MJXp-mo" id="MJXp-Span-3567">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3560"><span class="MJXp-mn" id="MJXp-Span-3561">1</span><span class="MJXp-mo" id="MJXp-Span-3562">,</span><span class="MJXp-mn" id="MJXp-Span-3563">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3568" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3569" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3570" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3571">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3572"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3573" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3578"><span class="MJXp-mo" id="MJXp-Span-3579">(</span><span class="MJXp-mn" id="MJXp-Span-3580">2</span><span class="MJXp-mo" id="MJXp-Span-3581">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3574"><span class="MJXp-mn" id="MJXp-Span-3575">1</span><span class="MJXp-mo" id="MJXp-Span-3576">,</span><span class="MJXp-mn" id="MJXp-Span-3577">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3582" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.267em;"><span class="MJXp-right MJXp-scale7" style="font-size: 2.067em; margin-left: -0.05em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-174-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-174">\Delta W_{2} = \begin{bmatrix} \Delta w^{(2)}_{1,1} & \cdots & \Delta w^{(2)}_{1,10} \end{bmatrix}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3583"><span class="MJXp-mi" id="MJXp-Span-3584">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3586" style="margin-right: 0.05em;">b</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3587" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3588">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-3589" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3590"><span class="MJXp-mo" id="MJXp-Span-3591" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3592"><span><span class="MJXp-mtr" id="MJXp-Span-3593" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3594" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3595">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3596"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3597" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3598" style="vertical-align: -0.4em;">2</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3599" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.178em;"><span class="MJXp-right MJXp-scale8" style="font-size: 1.711em; margin-left: -0.01em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-175-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-175">\Delta b_{2} = \begin{bmatrix} \Delta b_2\end{bmatrix}</script>  . </li><li>   ,      : <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3600"><span class="MJXp-mi" id="MJXp-Span-3601">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3603" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3604" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3605">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3606" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3607"><span class="MJXp-mo" id="MJXp-Span-3608" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3609"><span><span class="MJXp-mtr" id="MJXp-Span-3610" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3611" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3612">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3614" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3619"><span class="MJXp-mo" id="MJXp-Span-3620">(</span><span class="MJXp-mn" id="MJXp-Span-3621">1</span><span class="MJXp-mo" id="MJXp-Span-3622">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3615"><span class="MJXp-mn" id="MJXp-Span-3616">1</span><span class="MJXp-mo" id="MJXp-Span-3617">,</span><span class="MJXp-mn" id="MJXp-Span-3618">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3623" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3624" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3625" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3626">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3628" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3633"><span class="MJXp-mo" id="MJXp-Span-3634">(</span><span class="MJXp-mn" id="MJXp-Span-3635">1</span><span class="MJXp-mo" id="MJXp-Span-3636">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3629"><span class="MJXp-mn" id="MJXp-Span-3630">1</span><span class="MJXp-mo" id="MJXp-Span-3631">,</span><span class="MJXp-mn" id="MJXp-Span-3632">10</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3637" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3638" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3639">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3640"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3641" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3646"><span class="MJXp-mo" id="MJXp-Span-3647">(</span><span class="MJXp-mn" id="MJXp-Span-3648">1</span><span class="MJXp-mo" id="MJXp-Span-3649">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3642"><span class="MJXp-mn" id="MJXp-Span-3643">2</span><span class="MJXp-mo" id="MJXp-Span-3644">,</span><span class="MJXp-mn" id="MJXp-Span-3645">1</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-3650" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3651" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span></span><span class="MJXp-mtd" id="MJXp-Span-3652" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3653">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3654"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3655" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3660"><span class="MJXp-mo" id="MJXp-Span-3661">(</span><span class="MJXp-mn" id="MJXp-Span-3662">1</span><span class="MJXp-mo" id="MJXp-Span-3663">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3656"><span class="MJXp-mn" id="MJXp-Span-3657">2</span><span class="MJXp-mo" id="MJXp-Span-3658">,</span><span class="MJXp-mn" id="MJXp-Span-3659">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3664" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.894em;"><span class="MJXp-right MJXp-scale3" style="font-size: 4.578em; margin-left: -0.21em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-176-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-176">\Delta W_{1} = \begin{bmatrix} \Delta w^{(1)}_{1,1} & \cdots & \Delta w^{(1)}_{1,10} \\ \Delta w^{(1)}_{2,1} &\cdots & \Delta w^{(1)}_{2,10} \end{bmatrix}</script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3665"><span class="MJXp-mi" id="MJXp-Span-3666">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3668" style="margin-right: 0.05em;">W</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3669" style="vertical-align: -0.4em;"><span class="MJXp-mn" id="MJXp-Span-3670">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-3671" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-3672"><span class="MJXp-mo" id="MJXp-Span-3673" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">[</span></span><span class="MJXp-mtable" id="MJXp-Span-3674"><span><span class="MJXp-mtr" id="MJXp-Span-3675" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3676" style="text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3677">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3679" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3684"><span class="MJXp-mo" id="MJXp-Span-3685">(</span><span class="MJXp-mn" id="MJXp-Span-3686">2</span><span class="MJXp-mo" id="MJXp-Span-3687">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3680"><span class="MJXp-mn" id="MJXp-Span-3681">1</span><span class="MJXp-mo" id="MJXp-Span-3682">,</span><span class="MJXp-mn" id="MJXp-Span-3683">1</span></span></span></span></span></span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-3688" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3689" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-3690" style="margin-left: 0.333em; margin-right: 0.333em;">‚ãÆ</span></span></span><span class="MJXp-mtr" id="MJXp-Span-3691" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-3692" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-3693">Œî</span><span class="MJXp-msubsup" id="MJXp-Span-3694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3695" style="margin-right: 0.05em;">w</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-3700"><span class="MJXp-mo" id="MJXp-Span-3701">(</span><span class="MJXp-mn" id="MJXp-Span-3702">2</span><span class="MJXp-mo" id="MJXp-Span-3703">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3696"><span class="MJXp-mn" id="MJXp-Span-3697">1</span><span class="MJXp-mo" id="MJXp-Span-3698">,</span><span class="MJXp-mn" id="MJXp-Span-3699">10</span></span></span></span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-3704" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.339em;"><span class="MJXp-right MJXp-scale2" style="font-size: 6.356em; margin-left: -0.25em;">]</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-177-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-177">\Delta W_{2} = \begin{bmatrix} \Delta w^{(2)}_{1,1} \\ \vdots \\ \Delta w^{(2)}_{1,10} \\ \end{bmatrix}</script></li><li>  . </li></ol><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># 1.     dp_flat = tf.matmul(tf.linalg.inv(hess_approx), grad_approx) # 2.     dps = tf.split(dp_flat, parms_sizes, 0) # 3.     for i in range(len(dps)): dps[i] = tf.reshape(dps[i], parms[i].shape) # 4.  :       gn = opt.apply_gradients(zip(dps, parms)) #   session.run(tf.global_variables_initializer()) train(1e-10, 100, loss, gn, feed_dict)</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, current loss: 548.8468777701685 step: 2, current loss: 49648941.340197295 InvalidArgumentError: Input is not invertible.</code> </pre> <br><p> -   .      ,       .  -  ,      . </p><br><p>      ,        . </p><br><h4 id="obuchim-neyroset-metodom-levenberga-markvadta">    - </h4><br><p>     .          Matlab <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">   trainlm</a> .       .     MathWorks. </p><br><p>    - : <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3705"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3706">p</span><span class="MJXp-mo" id="MJXp-Span-3707" style="margin-left: 0.333em; margin-right: 0.333em;">‚Üí</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3708">p</span><span class="MJXp-mo" id="MJXp-Span-3709" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-3710" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3711"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3712" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-3715">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3713"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3714">r</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3716"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3717" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3718" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3719">r</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3720"><span class="MJXp-mo" id="MJXp-Span-3721" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3722" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3723">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3724">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3725"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3726" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-3729">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3727"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3728">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3730">r</span><span class="MJXp-mo" id="MJXp-Span-3731" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3732">p</span><span class="MJXp-mo" id="MJXp-Span-3733" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-178-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-178">\boldsymbol{p} \rightarrow \boldsymbol{p}-[\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r}]^{-1}\boldsymbol{J}_{r}^\intercal r(\boldsymbol{p})</script>  .  -    : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3734"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3735">p</span><span class="MJXp-mo" id="MJXp-Span-3736" style="margin-left: 0.333em; margin-right: 0.333em;">‚Üí</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3737">p</span><span class="MJXp-mo" id="MJXp-Span-3738" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mo" id="MJXp-Span-3739" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3740"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3741" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-3744">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3742"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3743">r</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3745"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3746" style="margin-right: 0.05em;">J</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3747" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3748">r</span></span></span><span class="MJXp-mo" id="MJXp-Span-3749" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3750">Œº</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3751">I</span><span class="MJXp-msubsup" id="MJXp-Span-3752"><span class="MJXp-mo" id="MJXp-Span-3753" style="margin-left: 0em; margin-right: 0.05em;">]</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3754" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-3755">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3756">1</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3757"><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3758" style="margin-right: 0.05em;">J</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-3761">‚ä∫</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3760">r</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3762">r</span><span class="MJXp-mo" id="MJXp-Span-3763" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3764">p</span><span class="MJXp-mo" id="MJXp-Span-3765" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-179-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-179">\boldsymbol{p} \rightarrow \boldsymbol{p}-[\boldsymbol{J}_{r}^\intercal\boldsymbol{J}_{r}+\mu \boldsymbol{I}]^{-1}\boldsymbol{J}_{r}^\intercal r(\boldsymbol{p})</script></p><br><p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3766"><span class="MJXp-mtext" id="MJXp-Span-3767">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3768">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3769">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-180-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-180"> \ mu </script>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3770"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3771">I</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-181-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-181"> I </script>  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3773">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-182-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-182"> n </script> (  ).   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3774"><span class="MJXp-mtext" id="MJXp-Span-3775">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3776">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3777">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-183-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-183"> \ mu </script>  ,       -.   ,    .  ,  LM       -. </p><br><p>        : </p><br><pre> <code class="python hljs">mu = tf.placeholder(tf.float64, shape=[<span class="hljs-number"><span class="hljs-number">1</span></span>]) n = tf.add_n(parms_sizes) I = tf.eye(n, dtype=tf.float64) <span class="hljs-comment"><span class="hljs-comment"># 1.     dp_flat = tf.matmul(tf.linalg.inv(hess_approx + tf.multiply(mu, I)), grad_approx) # 2.     dps = tf.split(dp_flat, parms_sizes, 0) # 3.     for i in range(len(dps)): dps[i] = tf.reshape(dps[i], parms[i].shape) # 4.  :       lm = opt.apply_gradients(zip(dps, parms))</span></span></code> </pre> <br><p>      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3778"><span class="MJXp-mtext" id="MJXp-Span-3779">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3780">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3781">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-184-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-184"> \ mu </script>  ?  LM     -   .   ,     . ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3782"><span class="MJXp-mtext" id="MJXp-Span-3783">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3784">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3785">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-185-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-185"> \ mu </script> ,     .     ‚Äî   ,     <em>mse</em> .       ,   : </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       store = [tf.Variable(tf.zeros(p.shape, dtype=tf.float64)) for p in parms] #  TensorFlow       save_parms = [tf.assign(s, p) for s, p in zip(store, parms)] restore_parms = [tf.assign(p, s) for s, p in zip(store, parms)] #   mu    3. feed_dict[mu] = np.array([3.]) step = 0 session.run(tf.global_variables_initializer()) #    mse current_loss = session.run(loss, feed_dict) #    100   while current_loss &gt; 1e-10 and step &lt; 100: step += 1 #  1, 2, 4...   if math.log(step, 2).is_integer(): print(f'step: {step}, mu: {feed_dict[mu][0]} current loss: {current_loss}') #    session.run(save_parms) # ,     mse while True: #    session.run(lm, feed_dict) new_loss = session.run(loss, feed_dict) if new_loss &gt; current_loss: #  -  mu  10     feed_dict[mu] *= 10 session.run(restore_parms) else: #  -  mu  10     feed_dict[mu] /= 10 current_loss = new_loss break print(f'ENDED ON STEP: {step}, FINAL LOSS: {current_loss}') print('VALIDATION LOSS: '+str(session.run(loss, validation_feed_dict)))</span></span></code> </pre> <br><pre> <code class="plaintext hljs">[Out]: step: 1, mu: 3.0 current loss: 692.6211687622557 [...] ENDED ON STEP: 100, FINAL LOSS: 0.012346989371823602 VALIDATION LOSS: 0.01859463694102034</code> </pre> <br><p>  100  LM  mse    10  ,   40  . </p><br><p>       .   ,         .  ,        <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rosenbrock_train.py</a> . </p><br><h4 id="poznakomimsya-s-mnogomernym-variantom-funkcii-rozenbroka">       </h4><br><p>    2D   .         .      .          ,     " " ( <em>curse of dimentionality</em> , Bellman, 1961).     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="> .      </a> . </p><br><p>      : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-3786"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3787">f</span><span class="MJXp-mo" id="MJXp-Span-3788" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3789">x</span><span class="MJXp-mo" id="MJXp-Span-3790" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-3791" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-3792"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3798" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3799">N</span><span class="MJXp-mo" id="MJXp-Span-3800">‚àí</span><span class="MJXp-mn" id="MJXp-Span-3801">1</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-3793" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-3794" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3795">i</span><span class="MJXp-mo" id="MJXp-Span-3796">=</span><span class="MJXp-mn" id="MJXp-Span-3797">1</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-3802"><span class="MJXp-mo" id="MJXp-Span-3803" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">[</span></span><span class="MJXp-mn" id="MJXp-Span-3804">100</span><span class="MJXp-mo" id="MJXp-Span-3805" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-3806"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3807" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3808" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3809">i</span><span class="MJXp-mo" id="MJXp-Span-3810">+</span><span class="MJXp-mn" id="MJXp-Span-3811">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-3812" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-3813"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3814" style="margin-right: 0.05em;">x</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-3817">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-3815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3816">i</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3818"><span class="MJXp-mo" id="MJXp-Span-3819" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3820" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3821" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mo" id="MJXp-Span-3822" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-3823">1</span><span class="MJXp-mo" id="MJXp-Span-3824" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-3825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3826" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3827" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3828">i</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-3829"><span class="MJXp-mo" id="MJXp-Span-3830" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3831" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-3832" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.289em;"><span class="MJXp-right MJXp-scale6" style="font-size: 2.156em; margin-left: -0.09em;">]</span></span></span><span class="MJXp-mo" id="MJXp-Span-3833" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-bold MJXp-italic" id="MJXp-Span-3834">x</span><span class="MJXp-mo" id="MJXp-Span-3835" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-3836" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-3837"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3838" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-3839" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-3840" style="margin-left: 0em; margin-right: 0em;">‚ãØ</span><span class="MJXp-msubsup" id="MJXp-Span-3841"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3842" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-3843" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3844">N</span></span></span><span class="MJXp-mo" id="MJXp-Span-3845" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-3846" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-3847"><span class="MJXp-mrow" id="MJXp-Span-3848" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-3849">R</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-3850" style="vertical-align: 0.5em;">N</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-186-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-186">f(\boldsymbol{x}) = \sum_{i=1}^{N-1}\left [ 100(x_{i+1} - x_{i}^2)^2 + (1-x_{i})^2 \right ], \boldsymbol{x}=[x_1 \cdots x_{N}]\in \mathbb{R}^N</script></p><br><p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rosenbrock_train.py</a>   <em>get_rand_rosenbrock_points</em> . </p><br><h4 id="polnocenno-proverim-algoritm-levenberga-markvadta">    - </h4><br><p>     - : " <em>!    4 ,     300!</em> ".   ,   ( <em></em> )    -. , ,  .  -   .  .  :       ?  ,          .   .          ,      - : </p><br><ol><li> 10 000  6D  . </li><li>    3   12, 10, 8 (311 ). </li><li>   . </li><li> 3.5    . </li></ol><br><p>              .     -   2 .      LM       .      20 . </p><br><img src="https://habrastorage.org/webt/nl/b1/-u/nlb1-ut2rftvgoleqzsl4o1e2ze.jpeg"><br><p>    <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rosenbrock_train.py</a> .   .         ,      . </p><br><h4 id="zaklyuchenie">  Conclusion </h4><br><p>  ,        .  " ",    ,     .      ,      .   ,    273 .  - ,        . </p><br><p>   ,   : </p><br><ol><li>    . </li><li>    (   )  -: <br> [1] Petros Drineas, Ravi Kannan, and Michael W. Mahoney. 2006. Fast Monte Carlo Algorithms for Matrices I: Approximating Matrix Multiplication. SIAM J. Comput. 36, 1 (July 2006), 132-157. DOI= <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">http://dx.doi.org/10.1137/S0097539704442684</a> <br> [2] Adelman, M., &amp; Silberstein, M. (2018). Faster Neural Network Training with Approximate Tensor Operations. CoRR, abs/1805.08079. </li></ol><br><p> ,  -     .      ,      .      "". </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr428183/">https://habr.com/ru/post/fr428183/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr428173/index.html">Prettier, ESLint, Husky, Lint-Staged et EditorConfig: outils pour √©crire du code ordonn√©</a></li>
<li><a href="../fr428175/index.html">Impl√©mentation de l'arbre C de pr√©fixe C</a></li>
<li><a href="../fr428177/index.html">Alors, quel est le probl√®me avec la recherche d'emploi / les travailleurs en informatique?</a></li>
<li><a href="../fr428179/index.html">Lors d'une vente aux ench√®res japonaise, un prototype de manette Wii, d√©velopp√© pour le GameCube</a></li>
<li><a href="../fr428181/index.html">Machine morale: impitoyable ou vide de sens?</a></li>
<li><a href="../fr428187/index.html">Comment √©crire une extension pour GNOME Shell: mode Ne pas d√©ranger</a></li>
<li><a href="../fr428189/index.html">Qu'est-ce qu'un paladin?</a></li>
<li><a href="../fr428191/index.html">Que devrions-nous organiser un hackathon, ou comment nous avons men√© un hackathon interne</a></li>
<li><a href="../fr428193/index.html">√Ä propos des tourn√©es</a></li>
<li><a href="../fr428197/index.html">Finances personnelles efficaces. Niveau 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>