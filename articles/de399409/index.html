<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò∂ üë©üèª‚Äçü§ù‚Äçüë®üèΩ üç¶ Jedes Wetter ist gut: ein Wetterindikator, der cosplay üëÅ‚Äçüó® üòΩ üïå</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Stellen wir uns vor, dass nach einem Gefecht mit Dave Bowman die √úberreste der einst m√§chtigen Intelligenz von HAL 9000 ausreichten, um Discovery One ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Jedes Wetter ist gut: ein Wetterindikator, der cosplay</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/399409/"><img src="https://habrastorage.org/files/4ce/918/71b/4ce91871b01040ecb8a968131e3c4f32.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Stellen wir uns vor, dass nach einem Gefecht mit Dave Bowman die √úberreste der einst m√§chtigen Intelligenz von </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HAL 9000</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ausreichten, um Discovery One zur√ºck auf die Erde zu bringen und es unter dem Motto ‚ÄûTod allen Menschen‚Äú auf dem Planeten zu zerschlagen, damit es nicht mehr falsch w√§re, dies mit Computern zu tun. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Katastrophe, die ausbrach, zerst√∂rte nat√ºrlich die gesamte rationale Menschheit, und nur Individuen wie ich blieben mit einem Hammer in der einen und einem Arduino in der anderen Hand zur√ºck. Daher ist es nicht verwunderlich, dass das mysteri√∂se Ger√§t, das von den immer noch mysteri√∂sen √úberresten des im Berg gefundenen Raumfahrzeugs gefunden wird, nur in einer Wetterstation verwendet werden kann. Nun, zu Recht!</font></font><br>
<a name="habracut"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wenn wir die Romantik verwerfen, war die harte Wahrheit des Lebens, dass der ber√ºchtigte ITEAD das </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nextion HMI NX4832T035-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Display </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">zum Testen</font></a><font style="vertical-align: inherit;"> anbot </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Da Nextion-Produkte hier wiederholt beschrieben wurden, sind die Funktionen kurz gefasst. Dies ist ein Bildschirm mit einer eigenen einfachen API und einem Touchpanel, mit dem Sie Steuerger√§te mit grafischen Men√ºs ohne gro√üen Aufwand erstellen k√∂nnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zu diesem Zweck verf√ºgt Nextion √ºber ein einfaches Befehlssystem zum Anzeigen von Bildern (und deren Teilen), Textelementen, Eingabefeldern und Grafiken. Au√üerdem gibt es eine Art Skriptsprache zum Ausf√ºhren von Aktionen, z. B. durch Dr√ºcken der Bildschirmtasten oder durch Timer. Gleichzeitig ein Anschluss zum Empfangen externer Befehle von Mikrocontrollern oder dergleichen und zum Zur√ºckgeben von Daten √ºber das Ber√ºhren des Bildschirms, um zu wissen, welche Tasten die spielerischen H√§nde des Besitzers haben und in welchem ‚Äã‚ÄãZustand sich diese Taste gerade befindet (gedr√ºckt, losgelassen). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Grob gesagt besteht keine Notwendigkeit, zu leiden und Punktanordnungen zu sammeln oder eine Wolke aller Arten von Bibliotheken zu verbinden. Eine Zeile - und der Hintergrund auf dem Bildschirm hat sich ge√§ndert. Klicken Sie auf - ein Men√º wird ge√∂ffnet. Wir haben Arduino angeschlossen - wir erstellen Diagramme anhand der Daten, die √ºber die serielle Schnittstelle empfangen werden.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Das hei√üt, nach der Beschreibung zu urteilen, ist das Display so intelligent, dass es alles anzeigen und darauf reagieren kann (es gibt ein Touchpanel). Aber ich habe nichts zu Hause, aber Klimadaten fliegen regelm√§√üig durch die Luft. </font><font style="vertical-align: inherit;">Zum Beispiel vom </font><font style="vertical-align: inherit;">selben </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BDS-M</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> oder vom </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PI-TV-2-</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wettersensor </font><font style="vertical-align: inherit;">. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich werden sie alle letztendlich an </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">People's Monitoring √ºbertragen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , von wo aus ich das Gl√ºck habe, sie √ºber einen Browser oder eine App auf meinem Smartphone anzusehen. Aber ich konnte der Idee nicht widerstehen, ‚Äûeine weitere Wetterstation auf dem Arduino‚Äú zu bauen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und um ehrlich zu sein, ging es nicht so sehr um Technologie als solche, sondern darum, dass ich mich hartn√§ckig f√ºr das Entwerfen von Schnittstellen interessierte. Wahrscheinlich zieht er mit der gleichen Kraft, mit der er zieht, um alle zu singen, denen der B√§r auf sein Ohr getreten ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deshalb entschuldige ich mich sofort daf√ºr, dass es weniger Ausr√ºstung und mehr Fantasy-Fantasien geben wird. </font><font style="vertical-align: inherit;">Aber zuerst eine kleine Demonstration des fertigen Produkts, anhand derer Sie entscheiden, weiterlesen oder mit dem n√§chsten Material fortfahren k√∂nnen.</font></font><br>
<br>
<iframe width="560" height="315" src="https://www.youtube.com/embed/8A02d27uJ9U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich hatte also 3,5 Zoll, 480 x 320 Pixel, was eine ziemlich einfache API zu sein schien, und sieben Parameter, die angezeigt werden mussten (in Klammern sind die daran angebrachten Sensoren): </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
1) Die Temperatur innen und au√üen (BMP085 / DHT22) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
2) Die Luftfeuchtigkeit innen und au√üen (DHT22 / DHT22) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
4) Atmosph√§rendruck (BMP085) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
5) Die Konzentration von nicht sehr n√ºtzlichen Gasen im Raum, insbesondere CO2 (MQ135) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
6) Die Konzentration von </font><font style="vertical-align: inherit;">Feststoffen </font><font style="vertical-align: inherit;">in der Raumluft, insbesondere PM2.5 (Sharp GP2Y1010AU0F)</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hierbei ist zu beachten, dass Genossen, die sich mit den Eigenschaften der letzten beiden Sensoren vertraut gemacht haben, zu dem Schluss kommen, dass die gr√∂√üte Reaktion nur im Bereich CO2 bzw. PM2,5 erzielt wird. Dies erkl√§rt in der Tat meine Wahl: Es ist nicht schade, zwei Cent auszugeben und zu sehen, was passiert, w√§hrend spezialisierte Sensoren viel teurer sind und die Kr√∂te im Fehlerfall immer etwas zu zeigen hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist klar, dass ich von billigen Sensoren nicht viel Genauigkeit erwartet hatte - vielmehr erwartete ich, meine eigenen Gef√ºhle mit ihren Messwerten zu korrelieren. √úbrigens ist alles ganz offensichtlich: Es lohnt sich, das Fenster zu schlie√üen, da gleichzeitig mit steigender Temperatur und Verstopfung die Gaskonzentrationswerte von MQ135 zu steigen beginnen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Allerdings zu den Parametern. Es schien mir langweilig, nur sieben Ziffern anzuzeigen, daher wurde die technische Aufgabe f√ºr das Ger√§t erweitert: Ich habe f√ºr jeden Parameter eine grafische Darstellung der √Ñnderungen im Zeitverlauf erstellt. Und so konnten auf einem Bildschirm bis zu vier Kurven gleichzeitig angezeigt werden, um Muster (falls vorhanden) in den √Ñnderungen verschiedener Indikatoren visuell wahrzunehmen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ein aufmerksamer Leser und Besitzer eines tragbaren Ger√§ts mit einer Diagonale von 3,5 Zoll oder mehr wird wahrscheinlich sagen, dass dies nichts Kompliziertes ist. Wie auf einem solchen Bildschirm und mehr Daten passen leicht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber es gibt einen Trick: Bei einem Haushaltsger√§t sollten Zahlen und Unterschriften so gro√ü wie m√∂glich sein, damit sie nicht lange in einer Lupe auf den Bildschirm schauen m√ºssen, um den Geist des Sch√∂pfers zu durchdringen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen wollte ich die gr√∂√üte und nicht zu √ºberf√ºllte Schnittstelle, deren Logik ohne eine h√∂here Ausbildung verstanden werden k√∂nnte. </font><font style="vertical-align: inherit;">Mit einem solchen Bild im Kopf habe ich es in den Nextion-Editor √ºbertragen und zwei Hauptbildschirmtypen erhalten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hauptbildschirm mit aktuellen Messwerten der Sensoren:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/5d2/51b/d5c/5d251bd5c5614232b44b219ff0bde021.jpg"></div><br>
<img src="https://habrastorage.org/files/c85/8f5/487/c858f548742546128af66272d59c3775.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zus√§tzlich zu den tats√§chlichen Messwerten sehen Sie auch einen Hinweis auf den √Ñnderungstrend (nach oben / unten) und Markierungen von Parametern, die f√ºr die Anzeige im Diagramm ausgew√§hlt wurden. </font><font style="vertical-align: inherit;">Durchscheinende Vierecke sind die sensorischen Bereiche, die in der Arbeit unsichtbar sind. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bildschirm mit Grafiken. </font><font style="vertical-align: inherit;">Tats√§chlich gibt es vier davon, die von einem bis vier Graphen angezeigt werden k√∂nnen, aber tats√§chlich sind sie alle identisch. </font><font style="vertical-align: inherit;">Zum Beispiel ein Bildschirm mit einem und vier Diagrammen:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/f68/cbf/014/f68cbf01497145c2a70f830c67c203d2.jpg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/355/835/edf/355835edf53d4e4fbbed68c1d8a3b56d.jpg"></div><br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/09c/940/2a5/09c9402a56164373aadbf7e5a22e85e4.JPG"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hier werden f√ºr jeden Parameter auch dessen Maximum und Minimum angezeigt, um die Grenzen zu verstehen. Aber es gibt keine Zeitleiste: Erstens hat das Ger√§t keine Uhr, und zweitens gibt es einfach keinen Platz f√ºr die Waage. Zumindest habe ich nicht gefunden, wo ich es anh√§ngen soll, da ich maximal vier Grafiken anzeigen wollte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
In diesem Fall sieht der Code vor, dass die erhaltenen Indikatoren alle halbe Stunde mit einer Gesamtarchivtiefe von 48 Werten, d. H. f√ºr etwa einen Tag. Ungef√§hr - weil die Daten √ºber den 433-MHz-Funkkanal √ºbertragen werden, der nicht vor St√∂rungen gesch√ºtzt ist, sind L√ºcken m√∂glich. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und bei diesen L√ºcken ist auch die Lebensdauer der Sensoren in derselben halben Stunde vorgesehen. Und wenn innerhalb einer halben Stunde kein Datenempfang stattgefunden hat, werden die Sensorwerte nicht angezeigt und nicht in das Archiv eingegeben.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Trends bei Indikatoren werden </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">durch den ersten Algorithmus berechnet, der</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> auf die letzten sechs Punkte in der Geschichte </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">st√∂√üt</font></a><font style="vertical-align: inherit;"> , d. H. nach den sechs neuesten Angaben. Und da die Messungen in halbst√ºndigen Intervallen durchgef√ºhrt werden, stellt sich heraus, dass der Trend √Ñnderungen in den letzten drei Stunden widerspiegelt. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Wie jeder Designer musste ich "mit Schriftarten spielen". Beim Zeichnen der Optionen stellte sich heraus, dass meine Lieblingssymmetrie nicht nur durch die Kombination von Feuchtigkeitsindikatoren in der oberen rechten Ecke, sondern auch durch ein viel entt√§uschenderes Ph√§nomen in Form von negativen Temperaturen gebrochen werden musste.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Minuspunkte verdarben n√§mlich das ganze Bild. Deshalb habe ich auf meine eigene Weise gehandelt: Setzen Sie ein Minus √ºber den Wert. F√ºr Mathematiker wird dies nat√ºrlich wie eine barbarische L√∂sung erscheinen, und die Beteiligten werden nat√ºrlich unwillk√ºrlich zur√ºckschrecken und dar√ºber nachdenken, warum Wetterstationen modulo bewertet werden sollten. Aber es stellte sich ziemlich ordentlich heraus und die Zahlen tanzen nicht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Logik der Schnittstelle ist wie folgt. Die Hauptbetriebsart ist der Standby-Modus mit einer Bildschirmhelligkeit von 15% des Nennwerts und einer regelm√§√üigen Aktualisierung der Messwerte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
√úberall ber√ºhren - mit 100% Helligkeit online gehen. Wenn Sie danach auf die Messwerte klicken, w√§hlen Sie sie f√ºr die nachfolgende Anzeige in der Grafik aus, und klicken Sie auf das "Auge". HAL wechselt zum Bildschirm mit den Grafiken.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daf√ºr gibt es genau f√ºnf Sekunden. </font><font style="vertical-align: inherit;">Dann werden die Markierungen gel√∂scht und nach weiteren f√ºnf Minuten Inaktivit√§t wechselt das Ger√§t zur√ºck in den Standby-Modus. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Auf dem Diagrammbildschirm ist der linke Teil ein Schritt zur√ºck (der Hauptbildschirm oder der Bildschirm mit Diagrammen), und der rechte Teil ist eine Vergr√∂√üerung des ausgew√§hlten Diagramms im Vollbildmodus oder wiederum der √úbergang zum Hauptbildschirm, wenn nur ein Diagramm vorhanden ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es schien mir, dass dieses Schema einfach genug ist, um keine zus√§tzlichen Schaltfl√§chen hinzuzuf√ºgen, die ich hier nicht wirklich sehen m√∂chte. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hintergrundbilder k√∂nnen √ºbrigens bei Bedarf ge√§ndert werden. </font><font style="vertical-align: inherit;">Ich habe sogar einige zus√§tzliche Optionen vorbereitet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr Kolonisten:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/7f5/ca7/c80/7f5ca7c80d444ade864e1213b7a85e60.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr Hobbits:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/941/05e/ed4/94105eed4f554e5286788bfeab3df7c6.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr Romantiker:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/aed/804/3da/aed8043da8794986a150611ef7e21b6c.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
F√ºr Kaffeeliebhaber:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/6d4/0be/56f/6d40be56f89445c1aca705da660063ae.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Konzept ist das gesamte Ger√§t weniger eine Wetterstation als vielmehr ein spezielles drahtloses Display. Daher ist das Design √§u√üerst einfach: Nur der Bildschirm, der Arduino Pro Mini und der 433-MHz-Empf√§nger mit Amplitudenmodulation befinden sich im Inneren. Die Baugruppe enth√§lt √ºberhaupt keine Funktionen: Der Bildschirm ist f√ºr die Stromversorgung und die serielle Schnittstelle vorgesehen, der Empf√§nger f√ºr die Stromversorgung und Pin 2 des Controllers. Abgesehen von der Notwendigkeit kompatibler externer Sensoren - das ist alles. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Um die Einfachheit zu verstehen, zeige ich eine der Geh√§useoptionen mit einer fast installierten F√ºllung: </font></font><br>
<br>
<img src="https://habrastorage.org/files/700/2b8/086/7002b80861af43d5a87296066f825fb3.JPG"><br>
<br>
<img src="https://habrastorage.org/files/41d/4a0/ec6/41d4a0ec62ea4d57b458d40625b8a966.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nat√ºrlich bestehe ich nicht auf einer solchen Konfiguration, aber in meinem Fall war sie sowohl hinsichtlich der M√ºhsal als auch der Kompatibilit√§t mit anderen Komponenten der Hausautomation optimal.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Durch die Trennung von Display und Sensoren k√∂nnen Sie dasselbe Display an der bequemsten Stelle platzieren - wie bei jeder Wetterstation mit externen Sensoren. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Damit all dies funktioniert und beim Anblick von Drahtklumpen, einer Reihe von Sensoren und Mikrocontrollern, die in der Luft h√§ngen, kein tierisches Entsetzen hervorruft, sollten Sie die F√§lle herausfinden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die harte Wahrheit des Lebens war, dass die Box, in der BDS-M bisher gelebt hatte, drei zus√§tzliche Sensoren nicht aufnehmen konnte. Deshalb habe ich den Gef√ºhlen </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">freien Lauf gelassen</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> und eine atemberaubende </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;">Lampe von Markellov</font></a><font style="vertical-align: inherit;"> gedruckt </font><font style="vertical-align: inherit;">.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aus Sicht des Wettersensors ist es ideal, da es von allen Winden geblasen wird und gleichzeitig das Chaos im Inneren effektiv und effektiv verbirgt. Nach solchen Metamorphen gab es kein BDS-M mehr: Jetzt ist es glamour√∂s (wenn Sie nicht in die N√§he kommen). Multisensor: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Shell: </font></font><br>
<br>
<img src="https://habrastorage.org/files/a8b/afb/02d/a8bafb02d48a400fa5c15fd021572114.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Zusammengebaut und an Ort und Stelle: </font></font><br>
<br>
<img src="https://habrastorage.org/files/65e/4be/cf8/65e4becf853f44a786b39e7e741d38ae.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es stellte sich heraus, dass es mit der Anzeigeeinheit schwieriger war. Im Allgemeinen wollte ich ihn ziemlich massiv und brutal sehen. Nat√ºrlich, als ob der Ureinwohner, der einen Teil des Raumschiffs gefunden hatte, ihn in Stein gemei√üelt h√§tte. Daher passte der Rahmen, dessen Modell bereits in Nextion angeboten wurde, in keiner Weise. Erstens war es be√§ngstigend, und zweitens befand sich das Display dort in einer Aussparung, die mir kategorisch nicht zusagte - ich wollte mit der Oberfl√§che sp√ºlen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich habe aber trotzdem mit Plastik angefangen - nur um die Form zu brechen. Die Zwischenoptionen sahen ungef√§hr so ‚Äã‚Äãaus: </font></font><br>
<br>
<img src="https://habrastorage.org/files/688/8ba/7e5/6888ba7e5fb04821813a4f0cc8028b75.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Im Allgemeinen hat es mir gefallen (ich habe beschlossen, ein wenig Unzufriedenheit nicht zu bemerken), aber das Gewicht ist nat√ºrlich ziemlich l√§cherlich, kein Stein. Daher wird eines der Geb√§ude als Innenschalung f√ºr die Herstellung von Beton "Rahmen" verwendet. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Der Prozess schockierte mich bis ins Mark - ich habe zu Hause selten so viel Schmutz gez√ºchtet. Das Ergebnis ist das gleiche. Obwohl sich stellenweise herausstellte, dass es gar nichts war, stellte sich heraus, dass die verst√§rkte Reparaturmischung f√ºr solche Produkte nicht sehr geeignet ist.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vielleicht w√§re reiner Sandbeton ideal, aber zu diesem Zeitpunkt war ich bereits von meinen eigenen Bauk√ºnsten entt√§uscht und machte mich wie mein Kollege auf den Weg. Und nachdem er ein wenig nachgedacht hatte, sagte er, dass er das Gl√ºck in seinem Leben hatte, mit Spr√ºhfarbe unter dem Stein zu arbeiten. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Bingo, dachte ich mir und fing sofort an, die Details herauszufinden. Schlie√ülich ist das Drucken und Malen eines Koffers viel √§sthetischer als das Verwandeln eines Hauses in eine Baustelle in voller Gr√∂√üe. Im Allgemeinen war die Farbe unmenschlich teuer, aber sehr cool (f√ºr Interessierte - Rust-Oleum American Accents Stone). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Unterwegs kam ich auch zu dem Schluss, dass mir das Korps mit nichts gefiel (h√∂chstwahrscheinlich mit dicken Rahmen um den gesamten Umfang), also riss ich mich zusammen und kam nach einem Verh√∂r mit einer Sucht zu einer endg√ºltigen Form. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es war: </font></font><br>
<br>
<img src="https://habrastorage.org/files/ff2/ef2/20a/ff2ef220a1534983a766a1a8367e0224.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es wurde:</font></font><br>
<br>
<img src="https://habrastorage.org/files/dfa/fd7/496/dfafd749673e4d5fa288916efc429e6a.JPG"><br>
<br>
<img src="https://habrastorage.org/files/f7b/341/41a/f7b34141a71f4b88a2f412087c6f1b7e.JPG"><br>
<br>
<img src="https://habrastorage.org/files/4e3/882/4dc/4e38824dcdb54b879398271bd16834a6.JPG"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es ist leicht zu erkennen, dass es keine Spur von Massivit√§t gibt, aber aus irgendeinem Grund gef√§llt mir diese Form am besten. Ich werde darauf eingehen. Tsch√ºss. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Die Ansicht ist nat√ºrlich ein Amateur, da einige Innereien des Bildschirms (dieselbe Schleife des Touchpanels) in Sicht sind und damit auf vern√ºnftige Weise nichts getan werden kann. Meiner Meinung nach unvern√ºnftig - √úberz√ºge, Farbe, Klebeb√§nder. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Und da ich mit transparentem Kunststoff gedruckt habe, nachts im allgemeinen Raum:</font></font><br>
<br>
<img src="https://habrastorage.org/files/c7e/c9f/222/c7ec9f222f2745d2bf3213d045ffd4d8.jpg"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun zu einigen, sagen wir, den Nuancen des Designs. Ich werde vielleicht vom selben Geb√§ude aus starten. Das Verlangen nach Sch√∂nheit war ein schlechter Scherz: Da ich wollte, dass der Bildschirm b√ºndig mit der Oberfl√§che abschlie√üt, wurde der Ausschnitt so weit wie m√∂glich entsprechend den Au√üenabmessungen des Displays hergestellt. Und nach ungef√§hr einem Dutzend Armaturen hat er seine Arbeit erledigt - entweder das Touchpanel-Kabel gebrochen oder den Kontakt mit der Platine unterbrochen, aber jetzt ist es sehr schwierig, den Sensor zum Laufen zu bringen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Daher kann ich ein solches Design wahrscheinlich nicht empfehlen. Nun, oder ich empfehle, aber denken Sie daran, dass dies eine der einfachsten und sch√∂nsten (ja, ich schmeichle mir dreist) M√∂glichkeiten ist, den Bildschirm zu brechen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au√üerdem musste ich einige Funktionen des Bildschirms selbst durchgehen, deren Beschreibung ich pers√∂nlich als "Sie k√∂nnen es nicht einfach nehmen und ..." bezeichnen kann.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Man kann also nicht einfach irgendeine Schriftart aufnehmen und anzeigen. Das hei√üt theoretisch - ja. Jede Windows-Schriftart kann in den in die Nextion-Umgebung integrierten Konverter heruntergeladen werden. Die Ausgabe ist ein ziemlich zahniges Raster, das nicht optimal aussieht. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Vergleichen Sie beispielsweise die konvertierte Schriftart mit dem Original:</font></font><br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/files/fbd/832/99d/fbd83299db274e43bfab9f7e5ffc5adf.jpg"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deshalb musste ich den trostlosen Weg gehen. N√§mlich - um Zahlen und Signaturen aus grafischen Elementen zu erstellen, die zuvor in GIMP erstellt wurden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dann bin ich √ºber die Charts gestolpert. Es stellte sich heraus, dass Sie nicht einfach einen beliebigen Datensatz aufnehmen und dem Wellenformelement zuf√ºhren k√∂nnen, das zum Zeichnen von Kurven bestimmt ist. Zuerst m√ºssen Sie alles auf das gew√ºnschte Format bringen - von 0 bis 255 - und die Zwischenpunkte beenden, wenn die Bildschirmbreite geringer ist. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Nun, dann habe ich herausgefunden, dass das nicht alles ist. Es stellt sich heraus, dass 255 logische Punkte von der Anzeige nicht skaliert werden, wenn sich die H√∂he des Wellenform-Diagrammelements √§ndert. Daher ist es beim √Ñndern der H√∂he des Wellenform-Diagrammelements erforderlich, die Skalierung der Werte proportional zu √§ndern, da sonst das Diagramm "abgeschnitten" wird.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sie k√∂nnen jedoch keine Bilder mit transparentem Hintergrund verwenden, wodurch die n√ºtzliche Breite der Informationsfelder etwas eingeschr√§nkt wurde, sodass im Verlaufsbereich des Hintergrundbilds keine h√§ssliche √úberlappung auftritt. Meiner Meinung nach hat das Nextion-Forum dies diskutiert, und es scheint, dass ITEAD versprochen hat, die M√∂glichkeit zur Arbeit mit transparenten Bildern hinzuzuf√ºgen, dies jedoch noch nicht getan hat. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dies wird, wie meine Qual beim Umschalten der Portgeschwindigkeit (die f√ºr das schnelle Zeichnen von Grafiken erforderlich ist), erfahrenen Kameraden zweifellos l√§cherlich erscheinen. Ich kann jedoch nicht schweigen - ich habe anst√§ndig die Kr√§fte aufgewendet, um sie zu √ºberwinden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Aber insgesamt f√ºhle ich mich wie ein Gewinner. Was ich wollte - ich tat es und die Sammlung von Haushaltsger√§ten wurde mit einem anderen aufgef√ºllt. Dar√ºber hinaus ist es nicht v√∂llig nutzlos: Es ist praktisch, sofort zu sehen, was Heimsensoren anzeigen, ohne nach einem Smartphone zu greifen und keinen Computer einzuschalten.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Au√üerdem h√§ngt dieses Ding nicht vom Internet ab und sieht in diesem Zusammenhang wie ein Anti-IoT-Ger√§t aus, da es alles in sich selbst speichert. </font><font style="vertical-align: inherit;">Und dann stelle ich mir vor, als w√ºrde ein Hacker mit einem absurden Sinn f√ºr Humor meine Wetterstation abschneiden und sie die T√ºr abschlie√üen lassen. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ich w√ºrde dann drau√üen herumkratzen mit Anfragen wie: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
 - √ñffne die T√ºren der Pod-Bucht, HAL </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
True, w√§re es lustig? </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PS Bei der Herstellung des Ger√§tes wurde von den Handb√ºchern geleitet: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Nextion HMI Solution</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FLProg + Nextion HMI. </font><font style="vertical-align: inherit;">Lektion 1</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
¬ª </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FLProg + Nextion HMI. </font><font style="vertical-align: inherit;">Lektion 2</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
¬ª </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FLProg + Nextion HMI. </font><font style="vertical-align: inherit;">Lektion 3</font></font></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
kann ich auch anbieten: </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
" </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Das Layout der Oberfl√§che zum Bearbeiten im Nextion Editor</font></font></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
"</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Download-Schnittstellendatei anzeigen</font></font></a><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Teilecode f√ºr Arduino anzeigen</font></font></b><div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// v5:     Serial - Arduino, Serial1 - Nextion</span></span>
<span class="hljs-comment"><span class="hljs-comment">// v6:  </span></span>
<span class="hljs-comment"><span class="hljs-comment">// v7:     </span></span>
<span class="hljs-comment"><span class="hljs-comment">// v8:      ( ,    ,  )</span></span>
<span class="hljs-comment"><span class="hljs-comment">// v9:       DHT.h Adafruit</span></span>
<span class="hljs-comment"><span class="hljs-comment">// v10:     ,      </span></span>
<span class="hljs-comment"><span class="hljs-comment">// v11:    CO2/PM2.5</span></span>
<span class="hljs-comment"><span class="hljs-comment">// v12:     , reDraw   statusBoolean = true</span></span>
<span class="hljs-comment"><span class="hljs-comment">// ToDo:   40 ,     ,     (  )</span></span><font></font>
<font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;DHT.h&gt;</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;RCSwitch.h&gt; //   http://code.google.com/p/rc-switch/</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;MQ135.h&gt; //    CO2</span></span></span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> measurePin  A1  </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// analog</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ledPower  12 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// digital</span></span></span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> samplingTime 280</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> deltaTime 40</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> sleepTime 9680</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> voMeasured = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> calcVoltage = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> dustDensity = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ppm = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> analogPin A0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//   MQ135    A0 Arduino</span></span></span></span><font></font>
<font></font>
MQ135 gasSensor = MQ135(analogPin); <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tempInX 10</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> tempOutX 380 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// 415</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> humidityInX 320 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//325</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> humidityOutX 410</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> pressureX 20 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// 10</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> ppmX 20</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> pmX 370</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Y0 0 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Y1 5 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// , </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Y2 125 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> Y3 230 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// ppm&amp;pm</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> dotY 125 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusY 115</span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">// </span></span></span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusXOut 380</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusXIn 10</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusH 3 </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusPicID 2 </span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> symbolID 1 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//     </span></span></span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> statusTimeOut 2200000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//  ""   (,       ) 900000</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> updateTimeOut 300000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//      60000 (300000)</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> historyTimeOut 1800000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//      (1800000)</span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> selectionTimeOut 5000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//      </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> backLightTimeOut 300000 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//      </span></span></span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> waveLimit 254</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> parameterS[<span class="hljs-number"><span class="hljs-number">7</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//  . : tempIn, tempOut, humidityIn, humidityOut, pressure, ppm, pm</span></span>
byte statusS[<span class="hljs-number"><span class="hljs-number">7</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//         ( /  )</span></span>
boolean statusBoolean[<span class="hljs-number"><span class="hljs-number">7</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">/*
//      
int coordinateX[7] = {tempInX, tempOutX, humidityInX, humidityOutX, pressureX, ppmX, pmX};
int coordinateY[7] = {Y2, Y2, Y1, Y1, Y1, Y3, Y3};
*/</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-comment"><span class="hljs-comment">//  : tempIn, tempOut, humidityIn, humidityOut, pressure, ppm, pm</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> historyArray[<span class="hljs-number"><span class="hljs-number">7</span></span>][<span class="hljs-number"><span class="hljs-number">48</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// 7   48 </span></span>
boolean drawArray[<span class="hljs-number"><span class="hljs-number">7</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> arrayMax; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> arrayMin;<font></font>
byte waveShift; <span class="hljs-comment"><span class="hljs-comment">//        waveform 0 - 255</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">float</span></span> arrayNorm; <span class="hljs-comment"><span class="hljs-comment">//        </span></span><font></font>
<font></font>
byte count=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
byte arrayCounter; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
byte waveCount; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> splitData[<span class="hljs-number"><span class="hljs-number">4</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//       [, , , ]</span></span>
byte thousands, hundreds, tens, ones; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tempIn, tempOut, humidityIn, humidityOut, pressure;
<span class="hljs-comment"><span class="hljs-comment">// int tempIn, tempOut, humidityIn, humidityOut, pressure, ppm, pm;</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> symbolX0;
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> posX; <span class="hljs-comment"><span class="hljs-comment">//    X  </span></span>
byte tempInStatus, tempOutStatus, humidityInStatus, humidityOutStatus, pressureStatus, ppmStatus, pmStatus; <span class="hljs-comment"><span class="hljs-comment">//       StatusTimeOut</span></span><font></font>
byte symbolCount, symbolWidth;<font></font>
boolean minusIn = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
boolean minusOut = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
byte i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">unsigned</span></span> <span class="hljs-keyword"><span class="hljs-keyword">long</span></span> statusTime, updateTime, historyTime, selectionTime, backLightTime;<font></font>
String stringToNextion;<font></font>
byte historyCount;<font></font>
boolean backLight; <span class="hljs-comment"><span class="hljs-comment">//           </span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> weatherData = <span class="hljs-number"><span class="hljs-number">0</span></span>;
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> dht22Humidity = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//CLICKER VARIABLE SECTION</span></span>
byte buffer[<span class="hljs-number"><span class="hljs-number">30</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// buffer for bytes coming from HMI.</span></span>
byte waveCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-comment"><span class="hljs-comment">// boolean drawArray[7]; //     </span></span><font></font>
boolean allClear;<font></font>
byte currentPage = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
byte searchTarget, searchNumber, searchCounter, pageNum, drawCounter, channelToDraw;<font></font>
<span class="hljs-comment"><span class="hljs-comment">// int historyArray[7][48]; // 7   48 </span></span>
<span class="hljs-comment"><span class="hljs-comment">// int arrayMax; //       </span></span>
<span class="hljs-comment"><span class="hljs-comment">// int arrayMin;</span></span>
<span class="hljs-comment"><span class="hljs-comment">// byte waveShift; //        waveform 0 - 255</span></span>
<span class="hljs-comment"><span class="hljs-comment">// float arrayNorm; //        </span></span>
byte iconCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// int splitData[4]; //       [, , , ]</span></span>
<span class="hljs-comment"><span class="hljs-comment">// int posX; //    X  </span></span>
<span class="hljs-comment"><span class="hljs-comment">// byte count = 0; //    </span></span>
<span class="hljs-comment"><span class="hljs-comment">// String stringToNextion;</span></span>
<span class="hljs-comment"><span class="hljs-comment">// int symbolX0;</span></span>
<span class="hljs-comment"><span class="hljs-comment">// byte symbolCount;</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusH 3 </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> minusPicID 2 </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//       </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> axisX[<span class="hljs-number"><span class="hljs-number">5</span></span>][<span class="hljs-number"><span class="hljs-number">7</span></span>] = {{<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">380</span></span>, <span class="hljs-number"><span class="hljs-number">320</span></span>, <span class="hljs-number"><span class="hljs-number">410</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">370</span></span>}, <span class="hljs-comment"><span class="hljs-comment">//  0</span></span>
               {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>},<font></font>
               {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>},<font></font>
               {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>},<font></font>
               {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}}; <span class="hljs-comment"><span class="hljs-comment">//  1-4</span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> axisY[<span class="hljs-number"><span class="hljs-number">5</span></span>][<span class="hljs-number"><span class="hljs-number">7</span></span>] = {{<span class="hljs-number"><span class="hljs-number">115</span></span>, <span class="hljs-number"><span class="hljs-number">115</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">230</span></span>, <span class="hljs-number"><span class="hljs-number">230</span></span>}, <span class="hljs-comment"><span class="hljs-comment">//  0</span></span>
               {<span class="hljs-number"><span class="hljs-number">145</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, <span class="hljs-comment"><span class="hljs-comment">//  1</span></span>
               {<span class="hljs-number"><span class="hljs-number">63</span></span>, <span class="hljs-number"><span class="hljs-number">226</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, <span class="hljs-comment"><span class="hljs-comment">//  2 </span></span>
               {<span class="hljs-number"><span class="hljs-number">37</span></span>, <span class="hljs-number"><span class="hljs-number">145</span></span>, <span class="hljs-number"><span class="hljs-number">253</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span> }, <span class="hljs-comment"><span class="hljs-comment">//  3</span></span>
               {<span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">105</span></span>, <span class="hljs-number"><span class="hljs-number">185</span></span>, <span class="hljs-number"><span class="hljs-number">265</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}}; <span class="hljs-comment"><span class="hljs-comment">//  4</span></span><font></font>
<font></font>
<font></font>
byte symbolW[<span class="hljs-number"><span class="hljs-number">5</span></span>][<span class="hljs-number"><span class="hljs-number">11</span></span>] = {{<span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">15</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">25</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>},<font></font>
                       {<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>},<font></font>
                       {<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>},<font></font>
                       {<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>},<font></font>
                       {<span class="hljs-number"><span class="hljs-number">11</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">14</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">13</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">12</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>}};<span class="hljs-comment"><span class="hljs-comment">//   0, 1, 2, 3, 4, 5, 6, 7, 8, 9</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// {13, 7, 15, 13, 17, 15, 13, 14, 14, 14, 5}   25 Comfortaa Light</span></span><font></font>
<font></font>
byte numberPic[<span class="hljs-number"><span class="hljs-number">5</span></span>] = {<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>}; <span class="hljs-comment"><span class="hljs-comment">// ID   </span></span><font></font>
<font></font>
byte symbolH[<span class="hljs-number"><span class="hljs-number">5</span></span>] = {<span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-number"><span class="hljs-number">18</span></span>}; <span class="hljs-comment"><span class="hljs-comment">//     25   25 Comfortaa Light</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// CLICKER VARIABLE SECTION ENDS    </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// TREND VARIABLE SECTION</span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> x2 70 </span><span class="hljs-comment"><span class="hljs-meta"><span class="hljs-comment">//    </span></span></span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> trendArray[<span class="hljs-number"><span class="hljs-number">3</span></span>][<span class="hljs-number"><span class="hljs-number">6</span></span>] = {{<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}, <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
                        {<span class="hljs-number"><span class="hljs-number">-5</span></span>, <span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>},<font></font>
                        {<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>}};<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> sumY, sumXY;<font></font>
byte trendCount;<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> trend; <font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// TREND VARIABLE SECTION ENDS                  </span></span><font></font>
<font></font>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DHTPIN 7</span></span>
<span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> DHTTYPE DHT22</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// Setup a DHT22 instance</span></span>
<span class="hljs-function"><span class="hljs-function">DHT </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dht</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DHTPIN, DHTTYPE)</span></span></span></span>;<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// Setup RC-Switch</span></span><font></font>
RCSwitch mySwitch = RCSwitch();<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sendToNextion</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  Serial.write(<span class="hljs-number"><span class="hljs-number">0xff</span></span>);<font></font>
  Serial.write(<span class="hljs-number"><span class="hljs-number">0xff</span></span>);<font></font>
  Serial.write(<span class="hljs-number"><span class="hljs-number">0xff</span></span>);<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//      </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawMark</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte mark, byte markNum)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> markX;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//        </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (allClear == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
  allClear = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
}<font></font>
<font></font>
markX = axisX[<span class="hljs-number"><span class="hljs-number">0</span></span>][markNum];<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (markNum == <span class="hljs-number"><span class="hljs-number">1</span></span> || markNum == <span class="hljs-number"><span class="hljs-number">3</span></span> || markNum == <span class="hljs-number"><span class="hljs-number">6</span></span>) {<font></font>
  markX = <span class="hljs-number"><span class="hljs-number">475</span></span>;<font></font>
} <font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (markNum == <span class="hljs-number"><span class="hljs-number">0</span></span> || markNum == <span class="hljs-number"><span class="hljs-number">4</span></span> || markNum == <span class="hljs-number"><span class="hljs-number">5</span></span>) {<font></font>
  markX = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (markNum == <span class="hljs-number"><span class="hljs-number">2</span></span>) {<font></font>
  markX = markX - <span class="hljs-number"><span class="hljs-number">15</span></span>;<font></font>
}<font></font>
<font></font>
    stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"fill "</span></span>);<font></font>
    stringToNextion = stringToNextion + String(markX); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(axisY[<span class="hljs-number"><span class="hljs-number">0</span></span>][markNum]+<span class="hljs-number"><span class="hljs-number">30</span></span>); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"5"</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"30"</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mark == <span class="hljs-number"><span class="hljs-number">1</span></span>) {<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"RED"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Mark set");</span></span><font></font>
<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mark == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"BLACK"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Mark clear");</span></span><font></font>
<font></font>
}<font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println(stringToNextion);</span></span><font></font>
    Serial.print(stringToNextion);<font></font>
    sendToNextion();<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  :     </span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clearSelection</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (byte jj = <span class="hljs-number"><span class="hljs-number">0</span></span>; jj &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; jj++) {
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[jj] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
    drawArray[jj] = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
    drawMark(<span class="hljs-number"><span class="hljs-number">0</span></span>, jj);<font></font>
   }<font></font>
  }<font></font>
<font></font>
  allClear = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
  waveCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">updateHistory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
mySwitch.disableReceive();<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   ,       -   ,       </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (arrayCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; arrayCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; arrayCounter++) {
  <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("StatusBoolean for array #");// Serial2.print(arrayCounter);// Serial2.print(" = "); // Serial2.println(statusBoolean[arrayCounter]);</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (statusBoolean[arrayCounter] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">47</span></span>; i &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; i--) {<font></font>
      historyArray[arrayCounter][i] = historyArray[arrayCounter][i<span class="hljs-number"><span class="hljs-number">-1</span></span>]; <span class="hljs-comment"><span class="hljs-comment">// </span></span><font></font>
    }<font></font>
    historyArray[arrayCounter][<span class="hljs-number"><span class="hljs-number">0</span></span>] = parameterS[arrayCounter]; <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
  }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// statusBoolean[arrayCounter] = false; // ,       </span></span><font></font>
<font></font>
  }<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (arrayCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; arrayCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; arrayCounter++) {
 <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">47</span></span>; i++) {
   <span class="hljs-comment"><span class="hljs-comment">// Serial2.print(historyArray[arrayCounter][i]);// Serial2.print(", ");</span></span><font></font>
  }<font></font>
 <span class="hljs-comment"><span class="hljs-comment">// Serial2.println();</span></span><font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// Serial2.println();  </span></span><font></font>
<font></font>
mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
  <font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawTrend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte arrayToTrend)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> markX;<font></font>
<font></font>
markX = axisX[<span class="hljs-number"><span class="hljs-number">0</span></span>][arrayToTrend];<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   X   </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayToTrend == <span class="hljs-number"><span class="hljs-number">1</span></span> || arrayToTrend == <span class="hljs-number"><span class="hljs-number">3</span></span> || arrayToTrend == <span class="hljs-number"><span class="hljs-number">6</span></span>) {<font></font>
  markX = <span class="hljs-number"><span class="hljs-number">472</span></span>;<font></font>
} <font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayToTrend == <span class="hljs-number"><span class="hljs-number">0</span></span> || arrayToTrend == <span class="hljs-number"><span class="hljs-number">4</span></span> || arrayToTrend == <span class="hljs-number"><span class="hljs-number">5</span></span>) {<font></font>
  markX = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayToTrend == <span class="hljs-number"><span class="hljs-number">2</span></span>) {<font></font>
  markX = markX - <span class="hljs-number"><span class="hljs-number">15</span></span>;<font></font>
}<font></font>
<font></font>
    stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
    stringToNextion = stringToNextion + String(markX); <span class="hljs-comment"><span class="hljs-comment">//   X</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(axisY[<span class="hljs-number"><span class="hljs-number">0</span></span>][arrayToTrend]); <span class="hljs-comment"><span class="hljs-comment">//   Y</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"8"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    7x18</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"18"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (trend &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  Y    0</span></span><font></font>
<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (trend &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"8"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    5</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  Y    0</span></span><font></font>
    <font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (trend == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"16"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     10</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  Y    0</span></span><font></font>
 <font></font>
}<font></font>
<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"5"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ID    </span></span>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println(stringToNextion);    </span></span><font></font>
    Serial.print(stringToNextion);<font></font>
    sendToNextion();<font></font>
 <font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">splitRoutine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> input)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<font></font>
<font></font>
input = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(input); <span class="hljs-comment"><span class="hljs-comment">//      ,   </span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (count = <span class="hljs-number"><span class="hljs-number">0</span></span>; count &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; count++) {<font></font>
  splitData[count] = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
}<font></font>
<font></font>
count = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input &gt; <span class="hljs-number"><span class="hljs-number">9999</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
  count = <span class="hljs-number"><span class="hljs-number">5</span></span>;<font></font>
} <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input &gt; <span class="hljs-number"><span class="hljs-number">999</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  9999</span></span>
  splitData[<span class="hljs-number"><span class="hljs-number">3</span></span>] = input/<span class="hljs-number"><span class="hljs-number">1000</span></span>;<font></font>
  input = input - splitData[<span class="hljs-number"><span class="hljs-number">3</span></span>]*<span class="hljs-number"><span class="hljs-number">1000</span></span>;<font></font>
  count = <span class="hljs-number"><span class="hljs-number">4</span></span>;
<span class="hljs-comment"><span class="hljs-comment">/*
  Serial.print("SplitData Count 4:");
  Serial.println(splitData[3]);
*/</span></span><font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input &gt; <span class="hljs-number"><span class="hljs-number">99</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  999</span></span>
  splitData[<span class="hljs-number"><span class="hljs-number">2</span></span>] = input/<span class="hljs-number"><span class="hljs-number">100</span></span>;<font></font>
  input = input - splitData[<span class="hljs-number"><span class="hljs-number">2</span></span>]*<span class="hljs-number"><span class="hljs-number">100</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
    count = <span class="hljs-number"><span class="hljs-number">3</span></span>;
<span class="hljs-comment"><span class="hljs-comment">/*
  Serial.print("SplitData Count 3:");
  Serial.println(splitData[2]);
*/</span></span>  <font></font>
  }<font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input &gt; <span class="hljs-number"><span class="hljs-number">9</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  99</span></span>
  splitData[<span class="hljs-number"><span class="hljs-number">1</span></span>] = input/<span class="hljs-number"><span class="hljs-number">10</span></span>;<font></font>
  input = input - splitData[<span class="hljs-number"><span class="hljs-number">1</span></span>]*<span class="hljs-number"><span class="hljs-number">10</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
    count = <span class="hljs-number"><span class="hljs-number">2</span></span>;
<span class="hljs-comment"><span class="hljs-comment">/*
  Serial.print("SplitData Count 2:");
  Serial.println(splitData[1]);
*/</span></span>  <font></font>
  }<font></font>
} <font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (input &lt; <span class="hljs-number"><span class="hljs-number">10</span></span>) {<font></font>
  splitData[<span class="hljs-number"><span class="hljs-number">0</span></span>] = input;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
    count = <span class="hljs-number"><span class="hljs-number">1</span></span>;
<span class="hljs-comment"><span class="hljs-comment">/*
  Serial.print("SplitData Count 1:");
  Serial.println(splitData[0]);
*/</span></span>  <font></font>
  }<font></font>
}<font></font>
<font></font>
}<font></font>
<span class="hljs-comment"><span class="hljs-comment">/*
  Serial.print("Input = ");
  Serial.println(input);
  Serial.print("Count = ");
  Serial.println(count);
*/</span></span><font></font>
<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawRoutine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte page, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value, byte type, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> drawX, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> drawY)</span></span></span><span class="hljs-function"> </span></span>{ <font></font>
<font></font>
mySwitch.disableReceive();  <font></font>
<span class="hljs-comment"><span class="hljs-comment">// page -  ; value = ; type =       ; drawX    X, drawY -  Y</span></span><font></font>
  <font></font>
  boolean minusSign = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
<font></font>
  splitRoutine(value);  <font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (page == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-comment"><span class="hljs-comment">//   (  pm25)         ( 470 = 480 - 10)</span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
    drawX = <span class="hljs-number"><span class="hljs-number">470</span></span> - count*<span class="hljs-number"><span class="hljs-number">30</span></span> - <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       10      ,  30    + 5  </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">1</span></span>) {<font></font>
      drawX = drawX - <span class="hljs-number"><span class="hljs-number">30</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   0,        </span></span><font></font>
    }<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type == <span class="hljs-number"><span class="hljs-number">6</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  pm25</span></span>
    drawX = <span class="hljs-number"><span class="hljs-number">470</span></span> - count*<span class="hljs-number"><span class="hljs-number">30</span></span> - <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       20      ,  30   </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">1</span></span>) {<font></font>
      drawX = drawX - <span class="hljs-number"><span class="hljs-number">30</span></span>;<font></font>
    }<font></font>
  }<font></font>
}<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> posX = drawX;<font></font>
<font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
  minusSign = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
 }<font></font>
<font></font>
 <font></font>
<font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count &lt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    9999</span></span><font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((count == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; ((type == <span class="hljs-number"><span class="hljs-number">0</span></span>) || (type  == <span class="hljs-number"><span class="hljs-number">1</span></span>) || (type  == <span class="hljs-number"><span class="hljs-number">6</span></span>))) { <span class="hljs-comment"><span class="hljs-comment">//    pm2.5     0,  0   </span></span>
  <span class="hljs-comment"><span class="hljs-comment">// xpic X, Y, , , X, Y, </span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// </span></span>
    stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawX); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawY); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(symbolW[page][<span class="hljs-number"><span class="hljs-number">0</span></span>]);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(symbolH[page]);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(numberPic[page]);<font></font>
   <span class="hljs-comment"><span class="hljs-comment">// // Serial2.println("Temp leading zero");</span></span>
   <span class="hljs-comment"><span class="hljs-comment">// // Serial2.println(stringToNextion);</span></span><font></font>
    Serial.print(stringToNextion);<font></font>
    sendToNextion();<font></font>
    drawX = drawX + symbolW[page][<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//     0</span></span><font></font>
      <font></font>
   } <span class="hljs-comment"><span class="hljs-comment">// count = 1</span></span><font></font>
<font></font>
   <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (byte ii = count; ii &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>; ii--) { <span class="hljs-comment"><span class="hljs-comment">//   ,    </span></span><font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((ii == <span class="hljs-number"><span class="hljs-number">1</span></span>) &amp;&amp; ((type == <span class="hljs-number"><span class="hljs-number">0</span></span>) || (type == <span class="hljs-number"><span class="hljs-number">1</span></span>) || (type == <span class="hljs-number"><span class="hljs-number">6</span></span>))) { <span class="hljs-comment"><span class="hljs-comment">//  ,     </span></span>
      stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
      stringToNextion = stringToNextion + String(drawX); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
      stringToNextion = stringToNextion + String(drawY); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
      stringToNextion = stringToNextion + String(symbolW[page][<span class="hljs-number"><span class="hljs-number">10</span></span>]);<font></font>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
      stringToNextion = stringToNextion + String(symbolH[page]);<font></font>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (page == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
        stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"265"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//        265</span></span>
      } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
        stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"118"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//       135  Comfortaa Light 25</span></span><font></font>
      }<font></font>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    Y    0</span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
      stringToNextion = stringToNextion + String(numberPic[page]); <font></font>
     <span class="hljs-comment"><span class="hljs-comment">// // Serial2.println("Temp decimal dot");</span></span>
     <span class="hljs-comment"><span class="hljs-comment">// // Serial2.println(stringToNextion);      </span></span><font></font>
      Serial.print(stringToNextion);<font></font>
      sendToNextion();<font></font>
      drawX = drawX + symbolW[page][<span class="hljs-number"><span class="hljs-number">10</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
    } <span class="hljs-comment"><span class="hljs-comment">// ii == 1 &amp;&amp; type == 0 || type == 1</span></span><font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
    symbolX0 = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (symbolCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; symbolCount &lt; (splitData[ii<span class="hljs-number"><span class="hljs-number">-1</span></span>]);symbolCount++) { <span class="hljs-comment"><span class="hljs-comment">//     X    (   )</span></span><font></font>
      symbolX0 = symbolX0 + symbolW[page][symbolCount];<font></font>
    }<font></font>
<font></font>
    stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawX); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawY); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(symbolW[page][splitData[ii<span class="hljs-number"><span class="hljs-number">-1</span></span>]]);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(symbolH[page]);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(symbolX0); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(numberPic[page]);<font></font>
   <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("Symbol: "); // Serial2.println(splitData[ii-1]);</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//  // Serial2.println(stringToNextion);    </span></span><font></font>
    Serial.print(stringToNextion);<font></font>
    sendToNextion();<font></font>
    drawX = drawX + symbolW[page][splitData[ii<span class="hljs-number"><span class="hljs-number">-1</span></span>]];<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (minusSign == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">/*
    symbolX0 = 0; //    
    for (byte ii = count; ii &gt; 0; ii--) { 
      symbolX0 = symbolX0 + symbolW[page][splitData[ii-1]];
    }

    */</span></span><font></font>
    <font></font>
    stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
    stringToNextion = stringToNextion + String(posX); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawY<span class="hljs-number"><span class="hljs-number">-8</span></span>); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(drawX - posX);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(minusH); <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(<span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     0, 0</span></span>
    stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
    stringToNextion = stringToNextion + String(minusPicID);<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    // Serial2.print("Symbol: "); // Serial2.println(splitData[ii-1]);</span></span>
 <span class="hljs-comment"><span class="hljs-comment">//   // Serial2.println(stringToNextion);    </span></span><font></font>
    Serial.print(stringToNextion);<font></font>
    sendToNextion();<font></font>
    <font></font>
  }<font></font>
  <font></font>
 } <span class="hljs-comment"><span class="hljs-comment">// if count &lt; 5    9999</span></span>
  mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
}         <font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//     ( )</span></span>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMinMax</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte arrayToMax, byte maxCount)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
  <font></font>
byte getMaxCount = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
arrayMax = historyArray[arrayToMax][getMaxCount]; <span class="hljs-comment"><span class="hljs-comment">//      </span></span>
arrayMin = historyArray[arrayToMax][getMaxCount]; <span class="hljs-comment"><span class="hljs-comment">//      </span></span><font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (byte getMaxCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; getMaxCount &lt; maxCount; getMaxCount++) { <span class="hljs-comment"><span class="hljs-comment">// maxCount 47   , 6  </span></span><font></font>
  <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (historyArray[arrayToMax][getMaxCount+<span class="hljs-number"><span class="hljs-number">1</span></span>] &gt; arrayMax){ <font></font>
    arrayMax = historyArray[arrayToMax][getMaxCount+<span class="hljs-number"><span class="hljs-number">1</span></span>];<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayMin &gt; historyArray[arrayToMax][getMaxCount+<span class="hljs-number"><span class="hljs-number">1</span></span>]){ <font></font>
    arrayMin = historyArray[arrayToMax][getMaxCount+<span class="hljs-number"><span class="hljs-number">1</span></span>];<font></font>
  }<font></font>
  <font></font>
}<font></font>
 <font></font>
}      <font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTrend</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte arrayToTrend)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
mySwitch.disableReceive();<font></font>
getMinMax(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span>); <span class="hljs-comment"><span class="hljs-comment">//        </span></span><font></font>
<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (trendCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; trendCount &lt; <span class="hljs-number"><span class="hljs-number">6</span></span>; trendCount++) {
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayMin &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
    trendArray[<span class="hljs-number"><span class="hljs-number">0</span></span>][trendCount] = historyArray[arrayToTrend][<span class="hljs-number"><span class="hljs-number">5</span></span>-trendCount] + <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(arrayMin); <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
  } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
    trendArray[<span class="hljs-number"><span class="hljs-number">0</span></span>][trendCount] = historyArray[arrayToTrend][<span class="hljs-number"><span class="hljs-number">5</span></span>-trendCount];<font></font>
  }<font></font>
}<font></font>
<font></font>
sumY = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
sumXY = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   ,   XY</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (trendCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; trendCount &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; trendCount++) {<font></font>
  sumY = sumY + trendArray[<span class="hljs-number"><span class="hljs-number">0</span></span>][trendCount];<font></font>
  sumXY = sumXY + trendArray[<span class="hljs-number"><span class="hljs-number">0</span></span>][trendCount]*trendArray[<span class="hljs-number"><span class="hljs-number">1</span></span>][trendCount];<font></font>
}<font></font>
<font></font>
trend = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (sumY/<span class="hljs-number"><span class="hljs-number">10</span></span> + (sumXY/x2)*trendArray[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">5</span></span>]) - (sumY/<span class="hljs-number"><span class="hljs-number">10</span></span> + (sumXY/x2)*trendArray[<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>])+<span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// Serial2.print("Trend: "); // Serial2.println(trend);</span></span><font></font>
<font></font>
drawTrend(arrayToTrend);<font></font>
mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reDraw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
 mySwitch.disableReceive();<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Redraw main page");</span></span>
<span class="hljs-comment"><span class="hljs-comment">/*    
 for (i = 0; i &lt; 7; i++) {
  parameterS[i] = random(255);
  statusS[i] = 1;
 }
    */</span></span> <font></font>
<font></font>
 Serial.print(<span class="hljs-string"><span class="hljs-string">"page 0"</span></span>);<font></font>
 sendToNextion();<font></font>
 <span class="hljs-comment"><span class="hljs-comment">// Serial.print("pic 0,0,6");</span></span>
 <span class="hljs-comment"><span class="hljs-comment">// sendToNextion();</span></span><font></font>
 <font></font>
 <font></font>
 <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; i++) {
   <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("StatusBoolean on reDraw for item "); // Serial2.print(i); // Serial2.print(" is "); // Serial2.println(statusBoolean[i]);</span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (statusBoolean[i] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//     " "</span></span><font></font>
    drawRoutine(currentPage, parameterS[i], i, axisX[currentPage][i], axisY[currentPage][i]);<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("Redraw, ");// Serial2.print(i); // Serial2.print(": "); // Serial2.println(parameterS[i]);</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (historyCount &gt; <span class="hljs-number"><span class="hljs-number">5</span></span>) {<font></font>
      getTrend(i);<font></font>
    }<font></font>
<font></font>
   }<font></font>
    <font></font>
  }<font></font>
<font></font>
 mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getNorm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
arrayNorm = <span class="hljs-number"><span class="hljs-number">1.00</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  1:1</span></span><font></font>
<font></font>
  arrayNorm = <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(arrayMax - arrayMin);<font></font>
  <font></font>
    arrayNorm = waveLimit/arrayNorm; <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
  <font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawHistory</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte arrayCounter, byte waveCount)</span></span></span></span>{<font></font>
mySwitch.disableReceive();<font></font>
byte tC01 = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
byte tC02 = <span class="hljs-number"><span class="hljs-number">0</span></span>; 
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> interPoint, lineMulti;
<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> justPoint;<font></font>
<font></font>
  byte channelCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   ,   (ID = 0),           </span></span><font></font>
<font></font>
      getMinMax(arrayCounter, <span class="hljs-number"><span class="hljs-number">47</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  47   ,  39,        ,   </span></span>
 <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("arrayMax: "); // Serial2.println(arrayMax);</span></span>
 <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("arrayMin: "); // Serial2.println(arrayMin);</span></span><font></font>
      getNorm();<font></font>
      <font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">2</span></span>) {<font></font>
         arrayNorm = arrayNorm*<span class="hljs-number"><span class="hljs-number">0.5</span></span>;      <font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">3</span></span>) {<font></font>
         arrayNorm = arrayNorm*<span class="hljs-number"><span class="hljs-number">0.3</span></span>;      <font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">4</span></span>) {<font></font>
         arrayNorm = arrayNorm*<span class="hljs-number"><span class="hljs-number">0.2</span></span>;<font></font>
      }<font></font>
<font></font>
 <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("arrayNorm: "); // Serial2.println(arrayNorm);   </span></span><font></font>
<font></font>
     <font></font>
     <font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  </span></span>
      stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"add "</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
      stringToNextion = stringToNextion + String(waveCount); <span class="hljs-comment"><span class="hljs-comment">//    ID</span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
      stringToNextion = stringToNextion + String(channelCount); <span class="hljs-comment"><span class="hljs-comment">//   0, 1, 2  3</span></span>
      stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayMin &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
        justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (historyArray[arrayCounter][tC01] + <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(arrayMin))*arrayNorm + <span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
        stringToNextion = stringToNextion + String(justPoint); <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
      } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
        justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) historyArray[arrayCounter][tC01]*arrayNorm + <span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
        stringToNextion = stringToNextion + String(justPoint); <span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
      }<font></font>
      Serial.print(stringToNextion);<font></font>
      <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("First point, original");// Serial2.println(historyArray[arrayCounter][tC01]);</span></span>
      <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("First point: "); // Serial2.println(stringToNextion);          </span></span><font></font>
      sendToNextion(); <font></font>
                <font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (tC01 = <span class="hljs-number"><span class="hljs-number">0</span></span>; tC01 &lt; <span class="hljs-number"><span class="hljs-number">46</span></span>; tC01++) { <span class="hljs-comment"><span class="hljs-comment">//   37  46</span></span><font></font>
          <font></font>
          lineMulti = (historyArray[arrayCounter][tC01+<span class="hljs-number"><span class="hljs-number">1</span></span>] - historyArray[arrayCounter][tC01])/<span class="hljs-number"><span class="hljs-number">9</span></span>; <span class="hljs-comment"><span class="hljs-comment">//         </span></span><font></font>
          <font></font>
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayMin &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
            justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) historyArray[arrayCounter][tC01] + <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(arrayMin) + lineMulti+<span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
            interPoint = justPoint;<font></font>
          } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
            justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) historyArray[arrayCounter][tC01] + lineMulti + <span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
            interPoint = justPoint;<font></font>
          }<font></font>
          <font></font>
          <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (tC02 = <span class="hljs-number"><span class="hljs-number">0</span></span>; tC02 &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; tC02++) { <span class="hljs-comment"><span class="hljs-comment">//   ,  ,    9</span></span>
            stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"add "</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
            stringToNextion = stringToNextion + String(waveCount); <span class="hljs-comment"><span class="hljs-comment">//     (1, 2, 3  4 )</span></span>
            stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
            stringToNextion = stringToNextion + String(channelCount); <span class="hljs-comment"><span class="hljs-comment">//   0, 1, 2  3</span></span>
            stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
            justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) interPoint*arrayNorm;<font></font>
            stringToNextion = stringToNextion + String(justPoint);<font></font>
            interPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) interPoint + lineMulti;<font></font>
            Serial.print(stringToNextion);   <font></font>
           <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("Connecting point: "); // Serial2.println(stringToNextion);                               </span></span><font></font>
            sendToNextion();                      <font></font>
          }<font></font>
          stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"add "</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
          stringToNextion = stringToNextion + String(waveCount); <span class="hljs-comment"><span class="hljs-comment">//     (1, 2, 3  4 )</span></span>
          stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
          stringToNextion = stringToNextion + String(channelCount); <span class="hljs-comment"><span class="hljs-comment">//   0, 1, 2  3</span></span>
          stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (arrayMin &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
            justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) (historyArray[arrayCounter][tC01+<span class="hljs-number"><span class="hljs-number">1</span></span>] + <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>(arrayMin))*arrayNorm + <span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
            stringToNextion = stringToNextion + String(justPoint); <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
          } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
            justPoint = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) historyArray[arrayCounter][tC01+<span class="hljs-number"><span class="hljs-number">1</span></span>]*arrayNorm + <span class="hljs-number"><span class="hljs-number">0.5</span></span>;<font></font>
            stringToNextion = stringToNextion + String(justPoint); <span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
          }<font></font>
          <font></font>
          Serial.print(stringToNextion);<font></font>
         <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("Next/Last point, original: ");// Serial2.println(historyArray[arrayCounter][tC01+1]);               </span></span>
          <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("Next/Last point: "); // Serial2.println(stringToNextion);               </span></span><font></font>
          sendToNextion();                                  <font></font>
        }<font></font>
    <font></font>
 mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);   <font></font>
  }<font></font>
  <font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawIcon</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> where, byte what)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//// Serial2.print("Where: "); // Serial2.println(where);</span></span>
<span class="hljs-comment"><span class="hljs-comment">//// Serial2.print("What: "); // Serial2.println(what);</span></span><font></font>
<font></font>
stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"xpic "</span></span>);<font></font>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">// String(axisX[page, type]);</span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
stringToNextion = stringToNextion + String(where<span class="hljs-number"><span class="hljs-number">-3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// String(axisY[page, type]);</span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
stringToNextion = stringToNextion + String(<span class="hljs-number"><span class="hljs-number">80</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
stringToNextion = stringToNextion + String(<span class="hljs-number"><span class="hljs-number">30</span></span>);<font></font>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
stringToNextion = stringToNextion + String(what*<span class="hljs-number"><span class="hljs-number">80</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     X = 80*  </span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">"0"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   Y  0</span></span>
stringToNextion = stringToNextion + String(<span class="hljs-string"><span class="hljs-string">","</span></span>);<font></font>
stringToNextion = stringToNextion + String(<span class="hljs-number"><span class="hljs-number">4</span></span>);
<span class="hljs-comment"><span class="hljs-comment">//// Serial2.println(stringToNextion);</span></span><font></font>
Serial.print(stringToNextion);<font></font>
sendToNextion();<font></font>
  <font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">toPage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(byte pageNum)</span></span></span><span class="hljs-function"> </span></span>{<font></font>
mySwitch.disableReceive();<font></font>
currentPage = pageNum;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">/*
//    
stringToNextion = String("ref page");
stringToNextion = stringToNextion + String(pageNum);
Serial.print(stringToNextion);
sendToNextion();
*/</span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
  String stringToNextion = String(<span class="hljs-string"><span class="hljs-string">"page "</span></span>);<font></font>
  stringToNextion = stringToNextion + String(pageNum);<font></font>
 <span class="hljs-comment"><span class="hljs-comment">// // Serial2.print("Switch to: "); // Serial2.println(stringToNextion);</span></span><font></font>
  Serial.print(stringToNextion);<font></font>
  sendToNextion();<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pageNum == <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
  clearSelection();<font></font>
  reDraw();<font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//        </span></span>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pageNum &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
<font></font>
    <font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pageNum == <span class="hljs-number"><span class="hljs-number">1</span></span> &amp;&amp; waveCounter &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//           </span></span>
 <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Draw single, searchCounter-1: "); // Serial2.println(searchCounter-1);</span></span>
      getMinMax(searchCounter<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">47</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      </span></span>
  <span class="hljs-comment"><span class="hljs-comment">//    // Serial2.print("arrayMax: "); // Serial2.println(arrayMax);</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//    // Serial2.print("arrayMin: "); // Serial2.println(arrayMin);</span></span>
      drawRoutine(pageNum, arrayMax, searchCounter<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">117</span></span>); <span class="hljs-comment"><span class="hljs-comment">// 115</span></span>
      drawIcon(<span class="hljs-number"><span class="hljs-number">145</span></span>, searchCounter<span class="hljs-number"><span class="hljs-number">-1</span></span>);<font></font>
      drawRoutine(pageNum, arrayMin, searchCounter<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">185</span></span>); <span class="hljs-comment"><span class="hljs-comment">// 175</span></span>
      drawHistory(searchCounter<span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  :     </span></span>
     } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
<font></font>
              <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
              iconCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>;
              <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (drawCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; drawCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; drawCounter++) {
                <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[drawCounter] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {
        <span class="hljs-comment"><span class="hljs-comment">//          // Serial2.print("pageNum: "); // Serial2.println(pageNum);</span></span>
       <span class="hljs-comment"><span class="hljs-comment">//           // Serial2.print("iconCounter: "); // Serial2.println(iconCounter);</span></span>
      <span class="hljs-comment"><span class="hljs-comment">//            // Serial2.print("drawCounter: "); // Serial2.println(drawCounter);</span></span>
                  getMinMax(drawCounter, <span class="hljs-number"><span class="hljs-number">39</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   39  47</span></span>
      <span class="hljs-comment"><span class="hljs-comment">//            // Serial2.print("arrayMax: "); // Serial2.println(arrayMax);</span></span>
     <span class="hljs-comment"><span class="hljs-comment">//             // Serial2.print("arrayMin: "); // Serial2.println(arrayMin);</span></span>
                  drawRoutine(pageNum, arrayMax, drawCounter, <span class="hljs-number"><span class="hljs-number">0</span></span>, axisY[pageNum][iconCounter]<span class="hljs-number"><span class="hljs-number">-22</span></span>);   <span class="hljs-comment"><span class="hljs-comment">// -30               </span></span><font></font>
                  drawIcon(axisY[pageNum][iconCounter], drawCounter);<font></font>
                  drawRoutine(pageNum, arrayMin, drawCounter, <span class="hljs-number"><span class="hljs-number">0</span></span>, axisY[pageNum][iconCounter]+<span class="hljs-number"><span class="hljs-number">35</span></span>); <span class="hljs-comment"><span class="hljs-comment">// +30</span></span><font></font>
                  iconCounter++;<font></font>
                }<font></font>
            }      <font></font>
              channelToDraw = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      ,    ,   - </span></span>
              <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (drawCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; drawCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; drawCounter++) { <span class="hljs-comment"><span class="hljs-comment">//   " "</span></span>
                <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[drawCounter] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
                  drawHistory(drawCounter, channelToDraw);<font></font>
           <span class="hljs-comment"><span class="hljs-comment">//       // Serial2.print("drawCounter / channelToDraw "); // Serial2.print(drawCounter); // Serial2.print(" | "); // Serial2.println(channelToDraw);</span></span><font></font>
                  channelToDraw++;<font></font>
                 }<font></font>
              }<font></font>
      }<font></font>
    }<font></font>
    <font></font>
  mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
  pinMode(ledPower,OUTPUT);<font></font>
 <span class="hljs-comment"><span class="hljs-comment">// pinMode(measurePin, INPUT);</span></span><font></font>
<font></font>
 pinMode(<span class="hljs-number"><span class="hljs-number">4</span></span>, OUTPUT);<font></font>
 digitalWrite(<span class="hljs-number"><span class="hljs-number">4</span></span>, HIGH);<font></font>
<font></font>
<font></font>
<font></font>
 <font></font>
  currentPage = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  allClear = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
  historyCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
  backLight = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//          ,   false</span></span><font></font>
  <font></font>
<span class="hljs-comment"><span class="hljs-comment">//     </span></span>
<span class="hljs-comment"><span class="hljs-comment">//  . : tempIn, tempOut, humidityIn, humidityOut, pressure, ppm, pm</span></span>
 <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; i++) {<font></font>
  parameterS[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  statusS[i] = <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
 }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (arrayCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>; arrayCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; arrayCounter++) {
 <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;<span class="hljs-number"><span class="hljs-number">48</span></span>; i++) {<font></font>
  historyArray[arrayCounter][i]=<span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
 }<font></font>
}<font></font>
 <font></font>
 statusTime = millis();<font></font>
 updateTime = millis();<font></font>
 historyTime = millis();<font></font>
 backLightTime = millis();<font></font>
<font></font>
 Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>);<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">"baud=57600"</span></span>);<font></font>
  sendToNextion();<font></font>
 Serial.end();<font></font>
<font></font>
 Serial.begin(<span class="hljs-number"><span class="hljs-number">57600</span></span>);<font></font>
 Serial.print(<span class="hljs-string"><span class="hljs-string">"baud=57600"</span></span>);<font></font>
 sendToNextion();<font></font>
 <font></font>
 <span class="hljs-comment"><span class="hljs-comment">// Serial2.begin(115200);</span></span><font></font>
 dht.begin();<font></font>
 mySwitch.enableReceive(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
 delay(<span class="hljs-number"><span class="hljs-number">2000</span></span>);<font></font>
 Serial.print(<span class="hljs-string"><span class="hljs-string">"page 0"</span></span>);<font></font>
 sendToNextion();<font></font>
 <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Ready");</span></span><font></font>
 <font></font>
 reDraw();<font></font>
}<font></font>
<font></font>
<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{<font></font>
<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
<font></font>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.available()) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> value = mySwitch.getReceivedValue();
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (value != <span class="hljs-number"><span class="hljs-number">0</span></span>) {
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("RC-Switch: "); // Serial2.println(mySwitch.getReceivedValue());</span></span>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">100000</span></span> == <span class="hljs-number"><span class="hljs-number">161</span></span>) {<font></font>
<font></font>
        weatherData = mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">16100000</span></span>;
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (weatherData &gt; <span class="hljs-number"><span class="hljs-number">10000</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
          parameterS[<span class="hljs-number"><span class="hljs-number">3</span></span>] = (weatherData - <span class="hljs-number"><span class="hljs-number">10000</span></span>)/<span class="hljs-number"><span class="hljs-number">10</span></span>;<font></font>
          statusS[<span class="hljs-number"><span class="hljs-number">3</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">3</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;   <font></font>
          statusBoolean[<span class="hljs-number"><span class="hljs-number">3</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;  <font></font>
        }<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (weatherData &gt; <span class="hljs-number"><span class="hljs-number">1000</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
            parameterS[<span class="hljs-number"><span class="hljs-number">1</span></span>] = -(weatherData - <span class="hljs-number"><span class="hljs-number">1000</span></span>);<font></font>
            minusOut = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
          }<font></font>
          <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
            parameterS[<span class="hljs-number"><span class="hljs-number">1</span></span>] = weatherData;<font></font>
            minusOut = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
          }<font></font>
        }<font></font>
          statusS[<span class="hljs-number"><span class="hljs-number">1</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">1</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
          statusBoolean[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
      }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">10000</span></span> == <span class="hljs-number"><span class="hljs-number">1210</span></span>) {<font></font>
        parameterS[<span class="hljs-number"><span class="hljs-number">4</span></span>] = (mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">12100000</span></span>) / <span class="hljs-number"><span class="hljs-number">1.33</span></span>; <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
        statusS[<span class="hljs-number"><span class="hljs-number">4</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">4</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;   <font></font>
        statusBoolean[<span class="hljs-number"><span class="hljs-number">4</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;   
        <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("Pressure: "); // Serial2.println(parameterS[4]);     </span></span><font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">100000</span></span> == <span class="hljs-number"><span class="hljs-number">131</span></span>) {<font></font>
        weatherData = mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">13100000</span></span>;
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (weatherData &gt; <span class="hljs-number"><span class="hljs-number">1000</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
          parameterS[<span class="hljs-number"><span class="hljs-number">0</span></span>] = -(weatherData - <span class="hljs-number"><span class="hljs-number">1000</span></span>);<font></font>
          minusIn = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
        }<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  </span></span>
          parameterS[<span class="hljs-number"><span class="hljs-number">0</span></span>] = weatherData;<font></font>
          minusIn = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;<font></font>
        }<font></font>
          statusS[<span class="hljs-number"><span class="hljs-number">0</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">0</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
          statusBoolean[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;<font></font>
      }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//        </span></span><font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">10000</span></span> == <span class="hljs-number"><span class="hljs-number">1212</span></span>) {<font></font>
        parameterS[<span class="hljs-number"><span class="hljs-number">2</span></span>] = (mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">12120000</span></span>); <span class="hljs-comment"><span class="hljs-comment">// </span></span>
        statusS[<span class="hljs-number"><span class="hljs-number">2</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">2</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;   <font></font>
        statusBoolean[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;   
        <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("HumidityIn: "); // Serial2.println(parameterS[2]);     </span></span><font></font>
      }<font></font>
<span class="hljs-comment"><span class="hljs-comment">// CO2 PPM</span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">10000</span></span> == <span class="hljs-number"><span class="hljs-number">1213</span></span>) {<font></font>
        parameterS[<span class="hljs-number"><span class="hljs-number">5</span></span>] = (mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">12130000</span></span>); <span class="hljs-comment"><span class="hljs-comment">// CO2</span></span>
        statusS[<span class="hljs-number"><span class="hljs-number">5</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">5</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;   <font></font>
        statusBoolean[<span class="hljs-number"><span class="hljs-number">5</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;   
        <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("CO2 PPM: "); // Serial2.println(parameterS[5]);     </span></span><font></font>
      }      <font></font>
<span class="hljs-comment"><span class="hljs-comment">// PM2.5</span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mySwitch.getReceivedValue() / <span class="hljs-number"><span class="hljs-number">10000</span></span> == <span class="hljs-number"><span class="hljs-number">1214</span></span>) {<font></font>
        parameterS[<span class="hljs-number"><span class="hljs-number">6</span></span>] = (mySwitch.getReceivedValue() - <span class="hljs-number"><span class="hljs-number">12140000</span></span>); <span class="hljs-comment"><span class="hljs-comment">// PM2.5</span></span>
        statusS[<span class="hljs-number"><span class="hljs-number">6</span></span>] = statusS[<span class="hljs-number"><span class="hljs-number">6</span></span>]+<span class="hljs-number"><span class="hljs-number">1</span></span>;   <font></font>
        statusBoolean[<span class="hljs-number"><span class="hljs-number">6</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;   
        <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("PM2.5: "); // Serial2.println(parameterS[6]);     </span></span><font></font>
      } <font></font>
<font></font>
    }<font></font>
    mySwitch.resetAvailable();<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//    mySwitch.enableReceive(0); //  RC Switch</span></span><font></font>
  }   <font></font>
<font></font>
  <font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">0</span></span>) {
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - selectionTime) &gt; selectionTimeOut) { 
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (allClear == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) {<font></font>
      clearSelection();<font></font>
    }<font></font>
  }<font></font>
 }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Serial.available())<font></font>
  {<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> moretocome = <span class="hljs-literal"><span class="hljs-literal">true</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> endcount = <span class="hljs-number"><span class="hljs-number">0</span></span>;
    <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> bytesread = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
    byte inbyte;<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//bool isascii = false;</span></span><font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (moretocome)<font></font>
    {<font></font>
      inbyte = Serial.read();<font></font>
<font></font>
        delay(<span class="hljs-number"><span class="hljs-number">2</span></span>);<font></font>
        <font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inbyte == <span class="hljs-number"><span class="hljs-number">0xFF</span></span>)<font></font>
      {<font></font>
        endcount++;<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (endcount == <span class="hljs-number"><span class="hljs-number">3</span></span>)<font></font>
        {<font></font>
          moretocome = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
          <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("");</span></span><font></font>
        }<font></font>
      }<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">else</span></span><font></font>
      {<font></font>
        endcount = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
      }<font></font>
      buffer[bytesread] = inbyte;<font></font>
      bytesread++;<font></font>
<font></font>
    }<font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> x = <span class="hljs-number"><span class="hljs-number">0</span></span>; x &lt; bytesread; x++)<font></font>
    {<font></font>
      <span class="hljs-comment"><span class="hljs-comment">// Serial2.print(buffer[x], HEX);</span></span>
      <span class="hljs-comment"><span class="hljs-comment">// Serial2.print(" ");</span></span><font></font>
    }<font></font>
<font></font>
    <span class="hljs-comment"><span class="hljs-comment">//// Serial2.println(bytesread, DEC);</span></span>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("");</span></span><font></font>
<font></font>
  }<font></font>
<font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-number"><span class="hljs-number">101</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
   backLightTime = millis(); <span class="hljs-comment"><span class="hljs-comment">//        </span></span>
   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (backLight == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    ,   </span></span>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Backlight 50%");</span></span>
    Serial.print(<span class="hljs-string"><span class="hljs-string">"dim=100"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//  </span></span><font></font>
    sendToNextion();<font></font>
    backLight = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
   } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     </span></span><font></font>
    <font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
      selectionTime = millis();<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waveCounter &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    4 </span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>] == <span class="hljs-literal"><span class="hljs-literal">false</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    </span></span>
          drawArray[buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>] = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    ,   </span></span>
          drawMark(<span class="hljs-number"><span class="hljs-number">1</span></span>, buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>);<font></font>
          waveCounter = waveCounter + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       </span></span>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Set button: "); // Serial2.println(buffer[2]);          </span></span>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Total buttons: "); // Serial2.println(waveCounter);</span></span>
        } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
          drawArray[buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>] = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
          drawMark(<span class="hljs-number"><span class="hljs-number">0</span></span>, buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>);
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waveCounter &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) {<font></font>
            waveCounter = waveCounter - <span class="hljs-number"><span class="hljs-number">1</span></span>;<font></font>
          }<font></font>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Clear button: "); // Serial2.println(buffer[2]);          </span></span>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Total buttons: "); // Serial2.println(waveCounter);          </span></span><font></font>
        }<font></font>
      } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    ,  </span></span>
          drawArray[buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>] = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     </span></span>
          drawMark(<span class="hljs-number"><span class="hljs-number">0</span></span>, buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>]<span class="hljs-number"><span class="hljs-number">-1</span></span>);<font></font>
          waveCounter = waveCounter - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Clear button: "); // Serial2.println(buffer[2]);          </span></span>
     <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Total buttons: "); // Serial2.println(waveCounter);          </span></span><font></font>
        }<font></font>
      }<font></font>
    } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">//      </span></span><font></font>
        currentPage = waveCounter;<font></font>
        toPage(waveCounter);    <font></font>
      }<font></font>
    }<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { 
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//      ,    ID = 5    0</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">5</span></span>) {<font></font>
          toPage(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
        }<font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//   1   ,    ID = 5    0</span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">5</span></span>) {
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (waveCounter == <span class="hljs-number"><span class="hljs-number">1</span></span>) {<font></font>
            toPage(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
          } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> {<font></font>
            toPage(waveCounter); <span class="hljs-comment"><span class="hljs-comment">//       </span></span><font></font>
          }<font></font>
        }<font></font>
      }<font></font>
<font></font>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    1     ID = 6 -          </span></span>
        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">6</span></span>) {<font></font>
          toPage(<span class="hljs-number"><span class="hljs-number">0</span></span>);<font></font>
        }<font></font>
      }      <font></font>
      <font></font>
      <span class="hljs-comment"><span class="hljs-comment">//   </span></span><font></font>
<font></font>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//    1, .   1</span></span>
      <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">5</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//     ID &gt; 2, ..  </span></span>
   <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Buffer[2]: ");</span></span>
   <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.println(buffer[2]);</span></span>
   <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("Normalized button: ");</span></span>
        searchTarget = buffer[<span class="hljs-number"><span class="hljs-number">2</span></span>] - <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">// ""  ,     ,   :  1 -   -  true   drawarray   1</span></span>
        searchNumber = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
        searchCounter = <span class="hljs-number"><span class="hljs-number">0</span></span>;
   <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.println(searchTarget);</span></span><font></font>
<font></font>
        <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> ((searchCounter &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>) &amp;&amp; (searchNumber &lt; searchTarget)) {
          <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (drawArray[searchCounter] == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
            searchNumber++;<font></font>
          }<font></font>
          searchCounter++;<font></font>
        }<font></font>
        <font></font>
   <span class="hljs-comment"><span class="hljs-comment">//     // Serial2.print("searchCounter: "); // Serial2.println(searchCounter);</span></span>
        toPage(<span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">//      </span></span><font></font>
      }<font></font>
    }<font></font>
<font></font>
<font></font>
      <font></font>
     }<font></font>
    }<font></font>
  } <font></font>
<font></font>
buffer[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//    *Status   1   </span></span>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//  :       ,    9</span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - statusTime) &gt; statusTimeOut) {<font></font>
<font></font>
 <font></font>
 <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">7</span></span>; i++) { <span class="hljs-comment"><span class="hljs-comment">//   </span></span>
  <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("Status of "); // Serial2.print(i); // Serial2.print(" is: "); // Serial2.println(statusS[i]);</span></span>
    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (statusS[i] == <span class="hljs-number"><span class="hljs-number">0</span></span>) {statusBoolean[i] = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("As StatusS "); // Serial2.print(i); // Serial2.print(" is "); // Serial2.print(statusS[i]); // Serial2.println(" StatusBoolean set to false");</span></span><font></font>
    }<font></font>
    statusS[i] = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    </span></span><font></font>
 }<font></font>
  statusTime = millis();<font></font>
  <font></font>
}<font></font>
<font></font>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (currentPage == <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//       </span></span><font></font>
<font></font>
 <font></font>
<span class="hljs-comment"><span class="hljs-comment">//    </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - updateTime) &gt; updateTimeOut) {<font></font>
<font></font>
  reDraw();<font></font>
  updateTime = millis();<font></font>
 }<font></font>
<font></font>
 <font></font>
 <font></font>
}<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//         </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - backLightTime) &gt; backLightTimeOut) {
 <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (backLight == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) {<font></font>
  backLight = <span class="hljs-literal"><span class="hljs-literal">false</span></span>;
  <span class="hljs-comment"><span class="hljs-comment">// Serial2.println("Backlight 15%");</span></span>
  <span class="hljs-comment"><span class="hljs-comment">//Serial.print("page 0");</span></span>
  <span class="hljs-comment"><span class="hljs-comment">// sendToNextion();</span></span>
  currentPage = <span class="hljs-number"><span class="hljs-number">0</span></span>;<font></font>
  clearSelection();<font></font>
  reDraw();<font></font>
  Serial.print(<span class="hljs-string"><span class="hljs-string">"dim=15"</span></span>);<font></font>
  sendToNextion();<font></font>
 }<font></font>
  <font></font>
 }<font></font>
<font></font>
<span class="hljs-comment"><span class="hljs-comment">//   </span></span>
<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((millis() - historyTime) &gt; historyTimeOut) {<font></font>
  updateHistory();<font></font>
<font></font>
    historyCount++;<font></font>
    <span class="hljs-comment"><span class="hljs-comment">// Serial2.print("History Q: "); // Serial2.println(historyCount);</span></span><font></font>
 <font></font>
  historyTime = millis();<font></font>
  }<font></font>
<font></font>
}  </code></pre><br>
<br>
</div></div><br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fallmodell (vorsichtig - Sie k√∂nnen den Bildschirm brechen)</font></font></a></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de399409/">https://habr.com/ru/post/de399409/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de399399/index.html">HIV-Durchbruch: Neuer Antik√∂rper blockiert 98% aller bekannten Virusst√§mme</a></li>
<li><a href="../de399401/index.html">Fragen Sie Ethan Nr. 108: Gibt es sofort Sonnenlicht?</a></li>
<li><a href="../de399403/index.html">Schmerzen in den H√§nden bei der Arbeit am Computer. Teil 2. Wir lassen Schultern und Nacken los</a></li>
<li><a href="../de399405/index.html">Geburtstag des Nintendo-Gr√ºnders</a></li>
<li><a href="../de399407/index.html">Warum k√∂nnen Sie noch keine drahtlosen Kopfh√∂rer kaufen?</a></li>
<li><a href="../de399411/index.html">Der dornige Weg der Synthesizer-Evolution: Die vergessene Geschichte revolution√§rer Erfindungen</a></li>
<li><a href="../de399413/index.html">Ein Albtraum: USB-C und Thunderbolt 3</a></li>
<li><a href="../de399415/index.html">Wie Atlas sich auf den Black Friday vorbereitete</a></li>
<li><a href="../de399417/index.html">Xiaomi neue Produkte mit solchen Rabatten</a></li>
<li><a href="../de399419/index.html">Test des gebogenen Gaming-Monitors Lenovo Y27g Razer Edition</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>