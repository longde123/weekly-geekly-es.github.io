<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåì ü§ë „Ä∞Ô∏è Introducci√≥n a las pol√≠ticas de red de Kubernetes para profesionales de la seguridad ‚ö±Ô∏è üö¥üèª üîë</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Nota perev. : El autor del art√≠culo, Reuven Harrison, tiene m√°s de 20 a√±os de experiencia en desarrollo de software, y hoy es el director t√©cnico y co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introducci√≥n a las pol√≠ticas de red de Kubernetes para profesionales de la seguridad</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/443190/"><img src="https://habrastorage.org/webt/dt/ya/kp/dtyakpb8umg8hkfvtfcrll8kc9y.png"><br><br>  <i><b>Nota</b></i>  <i><b>perev.</b></i>  <i>: El autor del art√≠culo, Reuven Harrison, tiene m√°s de 20 a√±os de experiencia en desarrollo de software, y hoy es el director t√©cnico y cofundador de Tufin, una empresa que crea soluciones de gesti√≥n de pol√≠ticas de seguridad.</i>  <i>Considerando las pol√≠ticas de red de Kubernetes como una herramienta lo suficientemente poderosa para la segmentaci√≥n de red en un cl√∫ster, cree que no son tan f√°ciles de aplicar en la pr√°ctica.</i>  <i>Este material (bastante voluminoso) est√° dise√±ado para mejorar el conocimiento de los especialistas en este tema y ayudarlos a crear las configuraciones necesarias.</i> <a name="habracut"></a><br><br>  Hoy en d√≠a, muchas empresas eligen cada vez m√°s a Kubernetes para ejecutar sus aplicaciones.  El inter√©s en este software es tan alto que algunos llaman a Kubernetes "el nuevo sistema operativo del centro de datos".  Gradualmente, Kubernetes (o k8s) comienza a ser percibido como una parte cr√≠tica del negocio, lo que requiere la organizaci√≥n de procesos comerciales maduros, incluida la seguridad de la red. <br><br>  Para los profesionales de seguridad que est√°n desconcertados al trabajar con Kubernetes, la pol√≠tica predeterminada de esta plataforma puede ser un verdadero descubrimiento: permitirlo todo. <br><br>  Esta gu√≠a lo ayudar√° a comprender la estructura interna de las pol√≠ticas de red;  Comprenda c√≥mo difieren de las reglas para los firewalls normales.  Tambi√©n se describir√°n algunas dificultades y se dar√°n recomendaciones que ayudar√°n a proteger las aplicaciones en Kubernetes. <br><br><h2>  Pol√≠ticas de red de Kubernetes </h2><br>  El mecanismo de pol√≠tica de red de Kubernetes le permite controlar la interacci√≥n de las aplicaciones implementadas en la plataforma a nivel de red (la tercera en el modelo OSI).  Las pol√≠ticas de red carecen de algunas de las caracter√≠sticas avanzadas de los firewalls modernos, como el monitoreo de nivel 7 de OSI y la detecci√≥n de amenazas, pero proporcionan un nivel b√°sico de seguridad de red, que es un buen punto de partida. <br><br><h2>  Las pol√≠ticas de red controlan las comunicaciones entre pods </h2><br>  Las cargas de trabajo de Kubernetes se distribuyen entre pods que consisten en uno o m√°s contenedores desplegados juntos.  Kubernetes asigna a cada pod una direcci√≥n IP accesible desde otros pods.  Las pol√≠ticas de red de Kubernetes establecen permisos para grupos de pods de la misma manera que los grupos de seguridad en la nube se usan para controlar el acceso a las instancias de m√°quinas virtuales. <br><br><h2>  Definici√≥n de pol√≠ticas de red </h2><br>  Al igual que otros recursos de Kubernetes, las pol√≠ticas de red se establecen en YAML.  En el siguiente ejemplo, el <code>balance</code> tiene acceso a <code>postgres</code> : <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres namespace: default spec: podSelector: matchLabels: app: postgres ingress: - from: - podSelector: matchLabels: app: balance policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/ee/d3/wf/eed3wfhzcdtuhobly7r3wdhyvhk.png"><br><br>  <i>( <b>Nota</b> : esta captura de pantalla, como todas las posteriores similares, no se cre√≥ con las herramientas nativas de Kubernetes, sino con la herramienta Tufin Orca, desarrollada por el autor del art√≠culo original y mencionada al final del art√≠culo).</i> <br><br>  La definici√≥n de su propia pol√≠tica de red requerir√° conocimientos b√°sicos de YAML.  Este lenguaje se basa en la sangr√≠a (especificada por espacios, no por pesta√±as).  Un elemento sangrado pertenece al elemento sangrado m√°s cercano sobre √©l.  Un nuevo elemento de la lista comienza con un gui√≥n, todos los dem√°s elementos son <i>clave-valor</i> . <br><br>  Habiendo descrito la pol√≠tica en YAML, use <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">kubectl</a> para crearla en el cl√∫ster: <br><br><pre> <code class="bash hljs">kubectl create -f policy.yaml</code> </pre> <br><h2>  Especificaci√≥n de pol√≠tica de red </h2><br>  La especificaci√≥n de pol√≠tica de red de Kubernetes incluye cuatro elementos: <br><br><ol><li>  <code>podSelector</code> : define los pods afectados por esta pol√≠tica (objetivos) - obligatorio; </li><li>  <code>policyTypes</code> : indica qu√© tipos de pol√≠ticas se incluyen en esto: ingreso y / o salida - opcional, sin embargo, le recomiendo que lo registre expl√≠citamente en todos los casos; </li><li>  <code>ingress</code> : define el tr√°fico <b>entrante</b> permitido a los pods de destino - opcional; </li><li>  <code>egress</code> : define el tr√°fico <b>saliente</b> permitido desde los pods de destino - opcional. </li></ol><br>  Un ejemplo prestado del sitio web de Kubernetes (reemplac√© el <code>role</code> con la <code>app</code> ) muestra c√≥mo se usan los cuatro elementos: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: test-network-policy namespace: default spec: podSelector: # &lt;&lt;&lt; matchLabels: app: db policyTypes: # &lt;&lt;&lt; - Ingress - Egress ingress: # &lt;&lt;&lt; - from: - ipBlock: cidr: 172.17.0.0/16 except: - 172.17.1.0/24 - namespaceSelector: matchLabels: project: myproject - podSelector: matchLabels: role: frontend ports: - protocol: TCP port: 6379 egress: # &lt;&lt;&lt; - to: - ipBlock: cidr: 10.0.0.0/24 ports: - protocol: TCP port: 5978</code> </pre> <br><img src="https://habrastorage.org/webt/ln/sa/ni/lnsanisggaar5tf3lbda8njxaau.png"><br><img src="https://habrastorage.org/webt/bo/re/in/borein4ll_4hoovj6vdhlo_zfee.png"><br><br>  Tenga en cuenta que los cuatro elementos son opcionales.  Solo se <code>podSelector</code> , se pueden usar otros par√°metros seg√∫n se desee. <br><br>  Si omite <code>policyTypes</code> , la pol√≠tica se interpretar√° de la siguiente manera: <br><br><ul><li>  Por defecto, se supone que define el lado de ingreso.  Si la pol√≠tica no indica expl√≠citamente esto, el sistema considerar√° que todo el tr√°fico est√° prohibido. </li><li>  El comportamiento en el lado de salida estar√° determinado por la presencia o ausencia del par√°metro de salida correspondiente. </li></ul><br>  Para evitar errores, recomiendo <b>siempre especificar expl√≠citamente <code>policyTypes</code></b> . <br><br>  De acuerdo con la l√≥gica anterior, si se omiten los <code>egress</code> <code>ingress</code> y / o <code>egress</code> , la pol√≠tica prohibir√° todo el tr√°fico (ver "Regla de eliminaci√≥n" a continuaci√≥n). <br><br><h2>  La pol√≠tica predeterminada es permitir </h2><br>  Si no se definen pol√≠ticas, Kubernetes permite de forma predeterminada todo el tr√°fico.  Todos los pods son libres de intercambiar informaci√≥n entre ellos.  Desde el punto de vista de la seguridad, esto puede parecer contradictorio, pero recuerde que Kubernetes fue creado originalmente por los desarrolladores para garantizar la interoperabilidad de las aplicaciones.  Las pol√≠ticas de red se agregaron m√°s tarde. <br><br><h2>  Espacios de nombres </h2><br>  Los espacios de nombres son un mecanismo colaborativo de Kubernetes.  Est√°n dise√±ados para aislar entornos l√≥gicos entre s√≠, mientras que el intercambio de datos entre espacios est√° permitido de forma predeterminada. <br><br>  Como la mayor√≠a de los componentes de Kubernetes, las pol√≠ticas de red residen en un espacio de nombres espec√≠fico.  En el bloque de <code>metadata</code> , puede especificar a qu√© espacio pertenece la pol√≠tica: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: test-network-policy namespace: my-namespace # &lt;&lt;&lt; spec: ...</code> </pre> <br>  Si el espacio de nombres no est√° escrito expl√≠citamente en los metadatos, el sistema usar√° el espacio de nombres especificado en kubectl (por defecto, <code>namespace=default</code> ): <br><br><pre> <code class="bash hljs">kubectl apply -n my-namespace -f namespace.yaml</code> </pre> <br>  Recomiendo <b>especificar expl√≠citamente un espacio de nombres a</b> menos que est√© escribiendo una pol√≠tica destinada a m√∫ltiples espacios de nombres a la vez. <br><br>  <b>El</b> elemento <b>principal</b> <code>podSelector</code> en una pol√≠tica seleccionar√° pods del espacio de nombres al que pertenece la pol√≠tica (se le niega el acceso a pods de otro espacio de nombres). <br><br>  Del mismo modo, podSelectors <b>en</b> bloques <b>de entrada y salida</b> pueden seleccionar pods solo de su espacio de nombres, a menos que, por supuesto, los combine con <code>namespaceSelector</code> (esto se discutir√° en la secci√≥n "Filtrado por espacio de nombres y pods") . <br><br><h2>  Reglas de nomenclatura de pol√≠ticas </h2><br>  Los nombres de pol√≠ticas son √∫nicos dentro de un √∫nico espacio de nombres.  No puede haber dos pol√≠ticas con el mismo nombre en un espacio, pero puede haber pol√≠ticas con el mismo nombre en espacios diferentes.  Esto es √∫til cuando desea volver a aplicar la misma pol√≠tica en varios espacios. <br><br>  Me gusta especialmente una forma de nombrar.  Consiste en combinar el nombre del espacio de nombres con los pods de destino.  Por ejemplo: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres # &lt;&lt;&lt; namespace: default spec: podSelector: matchLabels: app: postgres ingress: - from: - podSelector: matchLabels: app: admin policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/pp/rf/6a/pprf6aa0w2bysbuw6_-lbt926mi.png"><br><br><h2>  Etiquetas </h2><br>  Se pueden adjuntar etiquetas personalizadas a objetos de Kubernetes, como pods y espacios de nombres.  Las etiquetas son el equivalente de las etiquetas en la nube.  Las pol√≠ticas de red de Kubernetes usan etiquetas para seleccionar los <b>pods</b> a los que se aplican: <br><br><pre> <code class="plaintext hljs">podSelector: matchLabels: role: db</code> </pre> <br>  ... o <b>los espacios</b> de <b>nombres</b> a los que se aplican.  En este ejemplo, se seleccionan todos los pods en los espacios de nombres con las etiquetas correspondientes: <br><br><pre> <code class="plaintext hljs">namespaceSelector: matchLabels: project: myproject</code> </pre> <br>  Una advertencia: cuando use <code>namespaceSelector</code> <b>aseg√∫rese de que los</b> <code>namespaceSelector</code> <b>que seleccione contengan la etiqueta que desea</b> .  Tenga en cuenta que los espacios de nombres integrados como <code>default</code> y <code>kube-system</code> no contienen etiquetas por defecto. <br><br>  Puede agregar una etiqueta al espacio de la siguiente manera: <br><br><pre> <code class="bash hljs">kubectl label namespace default namespace=default</code> </pre> <br>  En este caso, el espacio de nombres en la secci√≥n de <code>metadata</code> debe referirse al nombre real del espacio y no a la etiqueta: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: test-network-policy namespace: default # &lt;&lt;&lt; spec: ...</code> </pre> <br><h2>  Origen y Destino </h2><br>  Las pol√≠ticas para firewalls consisten en reglas con or√≠genes y destinos.  Las pol√≠ticas de red de Kubernetes se definen para este prop√≥sito: un conjunto de pods a los que se aplican, y luego establecen reglas para el tr√°fico entrante (entrada) y / o saliente (salida).  En nuestro ejemplo, el objetivo de la pol√≠tica ser√° todos los pods en el espacio de nombres <code>default</code> con una etiqueta con la clave de la <code>app</code> y el valor <code>db</code> : <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: test-network-policy namespace: default spec: podSelector: matchLabels: app: db # &lt;&lt;&lt; policyTypes: - Ingress - Egress ingress: - from: - ipBlock: cidr: 172.17.0.0/16 except: - 172.17.1.0/24 - namespaceSelector: matchLabels: project: myproject - podSelector: matchLabels: role: frontend ports: - protocol: TCP port: 6379 egress: - to: - ipBlock: cidr: 10.0.0.0/24 ports: - protocol: TCP port: 5978</code> </pre> <br><img src="https://habrastorage.org/webt/zd/un/wi/zdunwi6xxqfdkvd7tj0qqpmjxly.png"><br><img src="https://habrastorage.org/webt/se/dj/wp/sedjwp5-arw7sxn7hm4dblgqhku.png"><br><br>  La subsecci√≥n de <code>ingress</code> en esta pol√≠tica abre el tr√°fico entrante a los pods de destino.  En otras palabras, el ingreso es la fuente, y el objetivo es el destinatario apropiado.  Del mismo modo, la salida es el objetivo, y el objetivo es su fuente. <br><br><img src="https://habrastorage.org/webt/rs/nf/u9/rsnfu97eapuetrrhbwejb-awnas.png"><br><br>  <i>Esto es equivalente a dos reglas para el firewall: Ingress ‚Üí Target;</i>  <i>Objetivo ‚Üí Egreso.</i> <br><br><h2>  Egress y DNS (¬°importante!) </h2><br>  Al limitar el tr√°fico saliente, <b>preste especial atenci√≥n al DNS</b> : Kubernetes utiliza este servicio para asignar servicios a direcciones IP.  Por ejemplo, la siguiente pol√≠tica no funcionar√° porque no permiti√≥ que la aplicaci√≥n de <code>balance</code> acceda a DNS: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.balance namespace: default spec: podSelector: matchLabels: app: balance egress: - to: - podSelector: matchLabels: app: postgres policyTypes: - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/6w/dy/jf/6wdyjftwhfiynlxrx22vivumtli.png"><br><br>  Puede solucionarlo abriendo el acceso al servicio DNS: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.balance namespace: default spec: podSelector: matchLabels: app: balance egress: - to: - podSelector: matchLabels: app: postgres - to: # &lt;&lt;&lt; ports: # &lt;&lt;&lt; - protocol: UDP # &lt;&lt;&lt; port: 53 # &lt;&lt;&lt; policyTypes: - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/z4/np/5m/z4np5m-afkmcbkqlgoxufjgc4fm.png"><br><br>  El √∫ltimo elemento to est√° vac√≠o y, por lo tanto, selecciona indirectamente <b>todos los pods en todos los espacios de nombres</b> , lo que permite que el <code>balance</code> env√≠e consultas DNS al servicio Kubernetes correspondiente (generalmente funciona en el espacio del <code>kube-system</code> ). <br><br>  Este enfoque funciona, pero es <b>demasiado permisivo e inseguro</b> , ya que le permite dirigir consultas DNS fuera del cl√∫ster. <br><br>  Puedes mejorarlo en tres pasos consecutivos. <br><br>  1. Permita consultas DNS solo <b>dentro del</b> cl√∫ster agregando <code>namespaceSelector</code> : <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.balance namespace: default spec: podSelector: matchLabels: app: balance egress: - to: - podSelector: matchLabels: app: postgres - to: - namespaceSelector: {} # &lt;&lt;&lt; ports: - protocol: UDP port: 53 policyTypes: - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/a1/hk/8v/a1hk8vmrton9izmj1jwhxtz-q1e.png"><br><br>  2. Permitir consultas DNS solo en el espacio de nombres del <code>kube-system</code> . <br><br>  Para hacer esto, agregue una etiqueta al <code>kubectl label namespace kube-system namespace=kube-system</code> <code>kube-system</code> : <code>kubectl label namespace kube-system namespace=kube-system</code> - y reg√≠strelo en la pol√≠tica usando <code>namespaceSelector</code> : <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.balance namespace: default spec: podSelector: matchLabels: app: balance egress: - to: - podSelector: matchLabels: app: postgres - to: - namespaceSelector: # &lt;&lt;&lt; matchLabels: # &lt;&lt;&lt; namespace: kube-system # &lt;&lt;&lt; ports: - protocol: UDP port: 53 policyTypes: - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/q6/e2/ed/q6e2edqwfz63nbamlvk2v5zpjhy.png"><br><br>  3. Los paranoides pueden ir m√°s all√° y limitar las consultas DNS a un servicio DNS espec√≠fico en <code>kube-system</code> .  En la secci√≥n "Filtrar por espacios de nombres y pods", explicaremos c√≥mo lograr esto. <br><br>  Otra opci√≥n es resolver DNS a nivel de espacio de nombres.  En este caso, no ser√° necesario abrirlo para cada servicio: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.dns namespace: default spec: podSelector: {} # &lt;&lt;&lt; egress: - to: - namespaceSelector: {} ports: - protocol: UDP port: 53 policyTypes: - Egress</code> </pre> <br>  Un <code>podSelector</code> vac√≠o selecciona todos los pods en el espacio de nombres. <br><br><img src="https://habrastorage.org/webt/ua/hn/7t/uahn7tgfus08_yt1u-rsilqoi90.png"><br><br><h2>  Primer partido y orden de reglas </h2><br>  En los firewalls comunes, la acci√≥n ("Permitir" o "Denegar") para un paquete est√° determinada por la primera regla que cumple.  <b>En Kubernetes, el orden de las pol√≠ticas es irrelevante.</b> <br><br>  De manera predeterminada, cuando no se establecen pol√≠ticas, se permiten las comunicaciones entre pods y pueden intercambiar informaci√≥n libremente.  Tan pronto como comience a formular pol√≠ticas, cada grupo afectado por al menos una de ellas se aisla de acuerdo con la disyunci√≥n (OR l√≥gico) de todas las pol√≠ticas que lo han elegido.  Las c√°psulas no afectadas por ninguna pol√≠tica permanecen abiertas. <br><br>  Puede cambiar este comportamiento utilizando la regla de eliminaci√≥n. <br><br><h2>  Regla de pelado (denegar) </h2><br>  Las pol√≠ticas de firewall generalmente proh√≠ben cualquier tr√°fico expl√≠citamente no autorizado. <br><br>  <b>Kubernetes no tiene una acci√≥n de denegaci√≥n</b> , sin embargo, se puede lograr un efecto similar con una pol√≠tica regular (permitida) seleccionando un grupo vac√≠o de pods de origen (ingreso): <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: deny-all namespace: default spec: podSelector: {} policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/65/-s/au/65-sauxptvceaqgedw9xvsadlso.png"><br><br>  Esta pol√≠tica selecciona todos los pods en el espacio de nombres y deja la entrada indefinida, bloqueando todo el tr√°fico entrante. <br><br>  Del mismo modo, puede limitar todo el tr√°fico saliente desde el espacio de nombres: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: deny-all-egress namespace: default spec: podSelector: {} policyTypes: - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/bn/fg/vq/bnfgvqcfwsgaj-jyompezzmhz6q.png"><br><br>  Tenga en cuenta que <b>cualquier pol√≠tica adicional que permita el tr√°fico a los pods en el espacio de nombres tendr√° prioridad sobre esta regla</b> (similar a agregar una regla de permiso sobre una regla de denegaci√≥n en la configuraci√≥n del firewall). <br><br><h2>  Permitir todo (Any-Any-Any-Allow) </h2><br>  Para crear una pol√≠tica Permitir todo, debe agregar la pol√≠tica prohibitiva anterior con un elemento de <code>ingress</code> vac√≠o: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: allow-all namespace: default spec: podSelector: {} ingress: # &lt;&lt;&lt; - {} # &lt;&lt;&lt; policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/bl/x6/ed/blx6edy0ez8h-yrkil5vb0yeb5g.png"><br><br>  Permite el acceso desde <b>todos los pods en todos los espacios de nombres (y todas las IP) a cualquier pod en el espacio de nombres <code>default</code></b> .  Este comportamiento est√° habilitado de forma predeterminada, por lo que generalmente no es necesario definirlo adicionalmente.  Sin embargo, a veces puede ser necesario desactivar temporalmente algunos permisos espec√≠ficos para diagnosticar el problema. <br><br>  La regla se puede restringir y permitir el acceso solo a un <b>conjunto espec√≠fico de pods</b> ( <code>app:balance</code> ) en el espacio de nombres <code>default</code> : <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: allow-all-to-balance namespace: default spec: podSelector: matchLabels: app: balance ingress: - {} policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/ji/jn/ki/jijnkiy1fzkligxx9b2okk8arm8.png"><br><br>  La siguiente pol√≠tica permite todo el tr√°fico de entrada y salida, incluido el acceso a cualquier IP fuera del cl√∫ster: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: allow-all spec: podSelector: {} ingress: - {} egress: - {} policyTypes: - Ingress - Egress</code> </pre> <br><img src="https://habrastorage.org/webt/yx/eq/c4/yxeqc4hamtqwvirrodsrym7y4iy.png"><br><img src="https://habrastorage.org/webt/bi/nu/ob/binuob-mafzfz6w_r-2fmdseu2c.png"><br><br><h2>  Combinando m√∫ltiples pol√≠ticas </h2><br>  Las pol√≠ticas se combinan utilizando OR l√≥gico en tres niveles;  Los permisos de cada pod se establecen de acuerdo con la disyunci√≥n de todas las pol√≠ticas que lo afectan: <br><br>  1. En los campos <code>from</code> y <code>to</code> , puede definir tres tipos de elementos (todos se combinan mediante OR): <br><br><ul><li>  <code>namespaceSelector</code> : selecciona todo el espacio de nombres; </li><li>  <code>podSelector</code> : selecciona pods; </li><li>  <code>ipBlock</code> : selecciona una subred. </li></ul><br>  Al mismo tiempo, el n√∫mero de elementos (incluso el mismo) en las subsecciones <code>from</code> / <code>to</code> no est√° limitado.  Todos ellos se combinar√°n por OR l√≥gico. <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres namespace: default spec: ingress: - from: - podSelector: matchLabels: app: indexer - podSelector: matchLabels: app: admin podSelector: matchLabels: app: postgres policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/_y/pu/xy/_ypuxynlq6wslkjk65yyj5_zwsi.png"><br><br>  2. Dentro de la pol√≠tica, la secci√≥n de <code>ingress</code> puede tener muchos elementos (combinados por OR l√≥gico).  Del mismo modo, la secci√≥n de <code>egress</code> puede incluir muchos elementos (tambi√©n unidos por una cl√°usula): <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres namespace: default spec: ingress: - from: - podSelector: matchLabels: app: indexer - from: - podSelector: matchLabels: app: admin podSelector: matchLabels: app: postgres policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/4t/-l/f9/4t-lf9a8fm1f4whkitifyhgyfee.png"><br><br>  3. Varias pol√≠ticas tambi√©n se combinan mediante OR l√≥gico <br><br>  Pero cuando se combinan, hay una limitaci√≥n que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Chris Cooney</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">se√±al√≥</a> : Kubernetes solo puede combinar pol√≠ticas con diferentes <code>policyTypes</code> pol√≠ticas ( <code>Ingress</code> o <code>Egress</code> ).  Las pol√≠ticas que definen la entrada (o salida) se sobrescribir√°n entre s√≠. <br><br><h2>  La relaci√≥n entre espacios de nombres </h2><br>  Por defecto, se permite el intercambio de informaci√≥n entre espacios de nombres.  Esto se puede cambiar utilizando una pol√≠tica prohibitiva que restringe el tr√°fico saliente y / o entrante en el espacio de nombres (consulte "Regla de eliminaci√≥n" arriba). <br><br>  Al bloquear el acceso al espacio de nombres (consulte "Regla de eliminaci√≥n" m√°s arriba), puede hacer excepciones a la pol√≠tica restrictiva permitiendo conexiones desde un espacio de nombres espec√≠fico usando <code>namespaceSelector</code> : <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: database.postgres namespace: database spec: podSelector: matchLabels: app: postgres ingress: - from: - namespaceSelector: # &lt;&lt;&lt; matchLabels: namespace: default policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/gh/-0/ed/gh-0edsyfhl5st5_8nngwadmoai.png"><br><br>  Como resultado, todos los pods en el espacio de nombres <code>default</code> tendr√°n acceso a los pods <code>postgres</code> en el espacio de nombres de la <code>database</code> .  Pero, ¬øqu√© <code>postgres</code> si desea abrir el acceso a <code>postgres</code> solo a pods espec√≠ficos en el espacio de nombres <code>default</code> ? <br><br><h2>  Filtrar por espacios de nombres y pods </h2><br>  Kubernetes versi√≥n 1.11 y superior le permite combinar los operadores <code>namespaceSelector</code> y <code>podSelector</code> utilizando el I. l√≥gico. Se ve as√≠: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: database.postgres namespace: database spec: podSelector: matchLabels: app: postgres ingress: - from: - namespaceSelector: matchLabels: namespace: default podSelector: # &lt;&lt;&lt; matchLabels: app: admin policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/47/_b/op/47_bopr6mjii5-qkujgiwgs2bku.png"><br><br>  ¬øPor qu√© se interpreta como AND en lugar del OR habitual? <br><br>  Tenga en cuenta que <code>podSelector</code> no comienza con un gui√≥n.  En YAML, esto significa que <code>podSelector</code> y el <code>namespaceSelector</code> delante de √©l hacen referencia al mismo elemento de la lista.  Por lo tanto, se combinan por el yo l√≥gico. <br><br>  Agregar un gui√≥n delante de <code>podSelector</code> dar√° como resultado un nuevo elemento de lista que se combinar√° con el anterior <code>namespaceSelector</code> utilizando un OR l√≥gico. <br><br>  Para seleccionar pods con una etiqueta espec√≠fica <b>en todos los espacios de nombres</b> , ingrese un <code>namespaceSelector</code> vac√≠o. <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: database.postgres namespace: database spec: podSelector: matchLabels: app: postgres ingress: - from: - namespaceSelector: {} podSelector: matchLabels: app: admin policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/t9/lc/vn/t9lcvnyl17u39krw9vn1nc-5xmk.png"><br><br><h2>  M√∫ltiples etiquetas se combinan con AND </h2><br>  Las reglas para un firewall con muchos objetos (hosts, redes, grupos) se combinan mediante un OR l√≥gico.  La siguiente regla funcionar√° si la fuente del paquete coincide con <code>Host_1</code> O <code>Host_2</code> : <br><br><pre> <code class="plaintext hljs">| Source | Destination | Service | Action | | ----------------------------------------| | Host_1 | Subnet_A | HTTPS | Allow | | Host_2 | | | | | ----------------------------------------|</code> </pre> <br>  Por el contrario, en Kubernetes, varias etiquetas en <code>podSelector</code> o <code>namespaceSelector</code> se combinan por l√≥gica I. Por ejemplo, la siguiente regla seleccionar√° pods que tengan ambas etiquetas, <code>role=db</code> AND <code>version=v2</code> : <br><br><pre> <code class="plaintext hljs">podSelector: matchLabels: role: db version: v2</code> </pre> <br>  La misma l√≥gica se aplica a todos los tipos de operadores: selectores de objetivos de pol√≠ticas, selectores de pod y selectores de espacio de nombres. <br><br><h2>  Subredes y direcciones IP (IPBlocks) </h2><br>  Los cortafuegos utilizan VLAN, direcciones IP y subredes para segmentar una red. <br><br>  En Kubernetes, las direcciones IP se asignan a los pods autom√°ticamente y pueden cambiar con frecuencia, por lo que las etiquetas se utilizan para seleccionar pods y espacios de nombres en las pol√≠ticas de red. <br><br>  <code>ipBlocks</code> ( <code>ipBlocks</code> ) se utilizan para controlar las conexiones externas (norte-sur) de entrada (entrada) o de salida (salida).  Por ejemplo, esta pol√≠tica da acceso a todos los pods del espacio de nombres <code>default</code> al servicio DNS de Google: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: egress-dns namespace: default spec: podSelector: {} policyTypes: - Egress egress: - to: - ipBlock: cidr: 8.8.8.8/32 ports: - protocol: UDP port: 53</code> </pre> <br><img src="https://habrastorage.org/webt/fm/uc/oa/fmucoaptwhse0i5yx-hsize1d0e.png"><br><br>  El selector de pod vac√≠o en este ejemplo significa "seleccionar todos los pod en el espacio de nombres". <br><br>  Esta pol√≠tica proporciona acceso solo a 8.8.8.8;  se deniega el acceso a cualquier otra IP.  Por lo tanto, en esencia, bloque√≥ el acceso al servicio DNS interno de Kubernetes.  Si a√∫n desea abrirlo, especif√≠quelo expl√≠citamente. <br><br>  Por <code>ipBlocks</code> general, <code>ipBlocks</code> y <code>podSelectors</code> son mutuamente excluyentes, ya que las direcciones IP internas de los pods no se usan en <code>ipBlocks</code> .  <b>Al</b> especificar <b>pods IP internos</b> , en realidad permitir√° conexiones a / desde pods con estas direcciones.  En la pr√°ctica, no sabr√° qu√© direcci√≥n IP usar, raz√≥n por la cual no deben usarse para seleccionar pods. <br><br>  Como contraejemplo, la siguiente pol√≠tica incluye todas las IP y, por lo tanto, permite el acceso a todos los dem√°s pods: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: egress-any namespace: default spec: podSelector: {} policyTypes: - Egress egress: - to: - ipBlock: cidr: 0.0.0.0/0</code> </pre> <br><img src="https://habrastorage.org/webt/yt/dt/ow/ytdtowaueimdgmppg5x9mp7y2ec.png"><br><br>  Puede abrir el acceso solo a IP externas excluyendo las direcciones IP internas de los pods.  Por ejemplo, si la subred de su pod es 10.16.0.0/14: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: egress-any namespace: default spec: podSelector: {} policyTypes: - Egress egress: - to: - ipBlock: cidr: 0.0.0.0/0 except: - 10.16.0.0/14</code> </pre> <br><img src="https://habrastorage.org/webt/9a/iz/c4/9aizc4r0bjzljsl0smkwaagpgfm.png"><br><br><h2>  Puertos y Protocolos </h2><br>  Por lo general, los pods escuchan en un puerto.  Esto significa que simplemente puede omitir los n√∫meros de puerto en las pol√≠ticas y dejar todo como predeterminado.  Sin embargo, se recomienda que las pol√≠ticas se hagan lo m√°s restrictivas posible, por lo que en algunos casos a√∫n puede especificar puertos: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres namespace: default spec: ingress: - from: - podSelector: matchLabels: app: indexer - podSelector: matchLabels: app: admin ports: # &lt;&lt;&lt; - port: 443 # &lt;&lt;&lt; protocol: TCP # &lt;&lt;&lt; - port: 80 # &lt;&lt;&lt; protocol: TCP # &lt;&lt;&lt; podSelector: matchLabels: app: postgres policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/ie/yo/og/ieyoogygmsewwwxtg0ncvsapxmw.png"><br><br>  Observe que el selector de <code>ports</code> aplica a todos los elementos en el bloque <code>to</code> o <code>from</code> que contiene.  Para especificar diferentes puertos para diferentes conjuntos de elementos, divida la <code>ingress</code> o la <code>egress</code> en varias subsecciones con ay <code>from</code> y enumere sus puertos en cada uno: <br><br><pre> <code class="plaintext hljs">apiVersion: networking.k8s.io/v1 kind: NetworkPolicy metadata: name: default.postgres namespace: default spec: ingress: - from: - podSelector: matchLabels: app: indexer ports: # &lt;&lt;&lt; - port: 443 # &lt;&lt;&lt; protocol: TCP # &lt;&lt;&lt; - from: - podSelector: matchLabels: app: admin ports: # &lt;&lt;&lt; - port: 80 # &lt;&lt;&lt; protocol: TCP # &lt;&lt;&lt; podSelector: matchLabels: app: postgres policyTypes: - Ingress</code> </pre> <br><img src="https://habrastorage.org/webt/bw/_a/8p/bw_a8p4luekpljv4c9zh6p4hw_y.png"><br><br>  Los puertos predeterminados funcionan: <br><br><ul><li>  Si omite por completo la definici√≥n de puertos, esto significa todos los protocolos y todos los puertos; </li><li>  Si omite la definici√≥n del protocolo, significa TCP; </li><li>  Si omite la definici√≥n de un puerto, esto significa todos los puertos. </li></ul><br>  Pr√°ctica recomendada: no conf√≠e en los valores predeterminados, especifique lo que necesita expl√≠citamente. <br><br>  Tenga en cuenta que es necesario usar puertos de pod, no servicios (m√°s sobre esto en el siguiente p√°rrafo). <br><br><h2>  ¬øSe definen pol√≠ticas para pods o servicios? </h2><br>  Por lo general, los pods en Kubernetes se contactan entre s√≠ a trav√©s de un servicio: un equilibrador de carga virtual que redirige el tr√°fico a los pods que implementan el servicio.  Puede pensar que las pol√≠ticas de red controlan el acceso a los servicios, pero esto no es as√≠.  <b>Las pol√≠ticas de red de Kubernetes funcionan con puertos de pod, no con servicios.</b> <br><br> ,    80- ,      8080  pod',       8080. <br><br>     :      (   pod')    . <br><br>      Service Mesh <i>(, .  Istio  ‚Äî . .)</i>     . <br><br><h2>     Ingress,   Egress? </h2><br>   ‚Äî ,  pod     pod' ,       (    egress-),  pod        ( , ,  ingress-). <br><br>         ,       . <br><br>   pod- <b></b>      <b>egress</b> -,        .         pod'- <b></b> .  pod   - ,   (egress)    . <br><br>    pod'- <b></b> ,     <b>ingress</b> -,    .           pod'-.  pod   - ,   (ingress)      . <br><br> .  ¬´Stateful  Stateless¬ª . <br><br><h2>  </h2><br>   Kubernetes    .    ,     ,       . <br><br><h2>       </h2><br>   Kubernetes       (DNS)   egress.             ,   IP- (  aws.com). <br><br><h2>   </h2><br>         . Kubernetes    .      kubectl Kubernetes  ,   ,    .    Kubernetes       .      : <br><br><pre> <code class="plaintext hljs">kubernetes get networkpolicy &lt;policy-name&gt; -o yaml</code> </pre> <br>   ,    Kubernetes        . <br><br><h2>  </h2><br> Kubernetes      ,    API-,        ,  Container Networking Interface (CNI).     Kubernetes    CNI             .        CNI ,    Kubernetes,    <i>(     <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="></a> ‚Äî . .)</i> ,   ,   CNI  . <br><br>  ,  Kubernetes   ,         CNI. <br><br><h3> Stateful  Stateless? </h3><br>  CNI Kubernetes,     ,   (, Calico  Linux conntrack).   pod'      TCP-     .       Kubernetes,      (statefulness). <br><br><h2>     </h2><br>          Kubernetes: <br><br><ol><li>   Service Mesh  sidecar-           .      <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Istio</a> . </li><li>    CNI   ,        Kubernetes. </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Tufin Orca</a>       Kubernetes. </li></ol><br>  Tufin Orca    Kubernetes (   ,  ). <br><br><h2>   </h2><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">  ,  Ahmet Alp Balkan'  GKE</a> ; </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">    Kubernetes</a> ; </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">    Kubernetes</a> ; </li><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">    </a> . </li></ul><br><h2>  Conclusi√≥n </h2><br>   Kubernetes       ,        .  ,  -        .             . <br><br> ,          ,     . <br><br><h2>  PD del traductor </h2><br>  Lea tambi√©n en nuestro blog: <br><br><ul><li> ¬´     Istio¬ª: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> 1 (   )</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> 2 (,  )</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> 3 ()</a> ; </li><li> ¬´      Kubernetes¬ª: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> 1  2 ( ,  )</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="> 3 (   )</a> ; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">Docker  Kubernetes     </a> ¬ª; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">9       Kubernetes</a> ¬ª; </li><li> ¬´ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">11  ()     Kubernetes</a> ¬ª. </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/443190/">https://habr.com/ru/post/443190/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../443180/index.html">Crew Dragon aterrizaje y video de asteroides</a></li>
<li><a href="../443182/index.html">Extraiga YPbPr de Commodore 64</a></li>
<li><a href="../443184/index.html">Del amor para controlar un paso</a></li>
<li><a href="../443186/index.html">El soporte t√©cnico de 3CX responde: 5 reglas de seguridad de IP PBX</a></li>
<li><a href="../443188/index.html">Tres ojos cuelgan de un pilar, o la historia de que cinco patas de ATtiny13 son suficientes</a></li>
<li><a href="../443192/index.html">M√©todos privados sin guiones bajos e interfaces en Python</a></li>
<li><a href="../443194/index.html">Los ingenieros de WFIRM inventaron una bioimpresora que imprime la piel directamente sobre una herida</a></li>
<li><a href="../443196/index.html">Sin un minuto sin conexi√≥n: elegir un enrutador LTE industrial</a></li>
<li><a href="../443198/index.html">Mark Zuckerberg dice que Facebook est√° trabajando en una interfaz neuronal para leer pensamientos</a></li>
<li><a href="../443200/index.html">Los piratas inform√°ticos iran√≠es roban terabytes de datos de Citrix</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>