<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>⏪ 👩🏽‍💻 🏙️ Comment jouer à un colocataire 📌 🍠 🤰🏿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Du traducteur 
 Un étudiant de l'Université Tufts raconte comment taquiner son colocataire. Il m'a même épinglé quand il a commencé son histoire avec ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment jouer à un colocataire</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/417915/"><h4>  Du traducteur </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Un</a> étudiant de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">l'Université Tufts</a> raconte comment taquiner son colocataire.  Il m'a même épinglé quand il a commencé son histoire avec le fait qu'ils ont un téléviseur 4K dans l'auberge. <br><a name="habracut"></a><br><h2>  Présentation </h2><br>  Avant de parler de la façon dont j'ai amené le malheureux Logan, je dois expliquer le système médiatique dans notre chambre.  Bientôt, vous comprendrez pourquoi. <br><br>  Logan, si tu lis ça, j'espère que tu t'es plus amusé qu'autrement. <br><br><h2>  Disposition </h2><br>  Nous avons un ordinateur avec un bureau Ubunt connecté à un téléviseur.  Il agit comme un serveur multimédia.  Puisqu'il a toujours besoin d'une connexion Internet permanente, un serveur Web avec quelques pages, un serveur SSH et un certain nombre d'autres services y tournent toujours. <br><br>  En raison du fait que la télé est 4K, et l'ordinateur est assemblé à partir de ce qui était à portée de main, sa carte vidéo ne tire pas.  Logan a décidé d'acheter l'ancien vidyuha NVIDIA, sorti il ​​y a quelques générations (ce qui est encore beaucoup mieux que ce qu'il était) afin de lire normalement la vidéo 4K. <br><br><h2>  La naissance d'une idée </h2><br>  Peu de temps après l'installation, nous avons eu quelques problèmes avec les pilotes.  À ce moment, j'ai pensé qu'il serait amusant de pouvoir afficher manuellement les messages d'erreur. <br><br>  Après quelques recherches sur Internet, il est devenu clair que l'invocation à distance d'un message sur un téléviseur est aussi simple que: <br><br><ol><li>  Connectez-vous via SSH à l'ordinateur en tant qu'utilisateur exécutant la diffusion </li><li><code>DISPLAY=:0 zenity --info --text '!'</code> </li> </ol><br>  <code>DISPLAY=:0</code> nécessaire, car dans ma session il n'y a pas d'affichage, mais je veux afficher le message sur l'écran principal. <br><br>  Comme nous avons eu des problèmes avec NVIDIA vidyuha, j'ai décidé de m'attarder sur quelque chose comme: <br><br><pre> <code class="bash hljs">DISPLAY=:0 zenity --warning --text <span class="hljs-string"><span class="hljs-string">'     .'</span></span></code> </pre> <br>  Cela a fonctionné, mais chaque fois que vous vous connectez au serveur à l'aide du client SSH pour arrêter Logan, c'est un plaisir.  J'ai donc décidé de tricher.  J'ai pensé à la tâche de la couronne de le faire enrager selon un calendrier, mais il y avait quelques problèmes: <br><br><ol><li>  En fait, la régularité </li><li>  Nous avions d'autres tâches dans la couronne, ce qui augmentait le risque de divulguer ma tâche insidieuse </li></ol><br>  D'autres options comme le script SysVInit ont été supprimées pour les mêmes raisons.  J'ai donc décidé de créer une page Web publique avec le bouton «Have a Logan». <br><br><h2>  Préparation du tirage </h2><br>  J'ai pensé que j'aurais besoin de quelques choses pour commencer: <br><br><ol><li>  Quelque chose qui gère l'entrée utilisateur </li><li>  Quelque chose exécutant des commandes arbitraires en tant qu'utilisateur Web </li></ol><br>  Je suis donc venu à: <br><br><ol><li>  Nginx </li><li>  Extension FPM pour NGINX </li><li>  Php </li><li>  Package FPM pour PHP </li></ol><br>  En conséquence, j'ai créé un site avec la page de <code>logan.html</code> logan.html et la «page d'action» <code>zenity.php</code> : <br><br><div class="spoiler">  <b class="spoiler_title">logan.html</b> <div class="spoiler_text"><pre> <code class="html hljs xml"><span class="hljs-comment"><span class="hljs-comment">&lt;!-- logan.html --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">form</span></span></span><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">button</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">font-size</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">20px</span></span></span><span class="css">; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">div</span></span></span><span class="hljs-selector-class"><span class="css"><span class="hljs-selector-class">.explanation</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">400px</span></span></span><span class="css">; } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"viewport"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"X-UA-Compatible"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"IE=edge,chrome=1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HandheldFriendly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"POST"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/zenity.php"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br>  Il y a un petit non-sens dans les balises META pour adapter la page pour les téléphones mobiles (rappelez-vous que je la rend facile à utiliser en déplacement?) Pour ceux qui ne savent pas comment rendre le HTML dans ma tête, je vous montre à quoi il ressemble: <br><br><img src="https://habrastorage.org/webt/by/zg/er/byzgerhzhkqsvgweyxlu6-qyjig.png"><br><br>  Lorsque le bouton est enfoncé, la demande POST vole vers une autre page, qui fait tout le sale boulot: <br><br><div class="spoiler">  <b class="spoiler_title">zenity.php</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/* zenity.php */</span></span> $messages = <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>( <span class="hljs-string"><span class="hljs-string">" ."</span></span>, <span class="hljs-string"><span class="hljs-string">" ."</span></span>, <span class="hljs-string"><span class="hljs-string">" ."</span></span>, <span class="hljs-string"><span class="hljs-string">" ."</span></span>, <span class="hljs-string"><span class="hljs-string">" ."</span></span>, <span class="hljs-string"><span class="hljs-string">" ."</span></span>, <span class="hljs-string"><span class="hljs-string">"       ."</span></span>, <span class="hljs-string"><span class="hljs-string">"   ."</span></span>, <span class="hljs-string"><span class="hljs-string">"   ."</span></span>, <span class="hljs-string"><span class="hljs-string">"   ."</span></span>, <span class="hljs-string"><span class="hljs-string">"    and has recovered."</span></span>, <span class="hljs-string"><span class="hljs-string">"     ."</span></span>, <span class="hljs-string"><span class="hljs-string">"     ."</span></span>, <span class="hljs-string"><span class="hljs-string">"     ."</span></span>, <span class="hljs-string"><span class="hljs-string">"     ."</span></span>, <span class="hljs-string"><span class="hljs-string">"     ."</span></span>, <span class="hljs-string"><span class="hljs-string">"     ."</span></span>, <span class="hljs-string"><span class="hljs-string">" NVIDIA  ."</span></span>, <span class="hljs-string"><span class="hljs-string">"NVIDIA    - . ( 43)"</span></span>, <span class="hljs-string"><span class="hljs-string">"    wlx10bef54d395c."</span></span> ); $statuses = <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>(<span class="hljs-string"><span class="hljs-string">"error"</span></span>, <span class="hljs-string"><span class="hljs-string">"warning"</span></span>); $msg = $messages[array_rand($messages)]; $status = $statuses[array_rand($statuses)]; $timeout = <span class="hljs-string"><span class="hljs-string">"--timeout 10"</span></span>; exec(<span class="hljs-string"><span class="hljs-string">"sudo -u thedisplayuser /usr/sbin/zenity --$status --display=:0 --text ': $msg' $timeout &gt; /dev/null &amp;"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">include</span></span> <span class="hljs-string"><span class="hljs-string">'logan.html'</span></span>; <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span> &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">explanation</span></span></span><span class="hljs-class">"&gt;                ,       .   ,        // .. &lt;/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">div</span></span></span><span class="hljs-class">&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">br</span></span></span><span class="hljs-class"> /&gt; &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">img</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">src</span></span></span><span class="hljs-class">='/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">logan</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">jpg</span></span></span><span class="hljs-class">' /&gt;</span></span></code> </pre> </div></div><br>  Cette page fait un certain nombre de choses: <br><br><ol><li>  Sélectionne un message d'erreur aléatoire </li><li>  Sélectionne le type de boîte de dialogue. </li><li>  Montre un message pendant une période de temps spécifiée (10 secondes) </li><li>  Il dessine un bouton et explique ce qui se passe - le tout accompagné de la drôle d'image de Logan en personne </li></ol><br>  Pour ceux qui ne peuvent toujours pas rendre HTML dans leur tête (encore une fois, espérons-le, la plupart des gens), la page ressemble à ceci: <br><br><img src="https://habrastorage.org/webt/9d/5o/nd/9d5onds7a2wambsvfplh_fsah20.jpeg"><br><br>  Si vous vous demandez pourquoi la page Web est autorisée à exécuter du code de cette manière, et pourquoi le propriétaire de la session du serveur Web ( <code>www-data</code> ) peut exécuter des commandes en tant qu'utilisateur d'affichage ( <code>thedisplayuser</code> ), vous serez peut-être heureux de savoir que j'ai strictement limité cela à fichier <code>sudoers</code> : <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># /etc/sudoers www-data ALL=(thedisplayuser) NOPASSWD: /usr/bin/zenity</span></span></code> </pre> <br>  Cette partie spécifique de la configuration permet à www-data d'exécuter uniquement / usr / bin / zenity en tant qu'utilisateur d'affichage sans mot de passe.  Je l'ai fait après avoir commis des erreurs stupides dans les paramètres PHP et NGINX.  J'ai ensuite envoyé l'URL à quelques amis sur le campus qui connaissent Logan. <br><br><h2>  Résultat du tirage </h2><br>  Louez le ciel, Logan a réagi aussi violemment que possible.  S'il avait été légèrement agacé, la pensée que mes efforts avaient été vains m'aurait énervé.  Mais non!  Il a perdu son sang-froid.  Je ne peux pas compter le nombre de redémarrages, de réinstallations de pilotes et de modifications du noyau.  Je regrette seulement de n'avoir pas tourné de vidéo sur la façon dont il est devenu fou après avoir démarré VLC, quand quelqu'un a jeté un tas de fenêtres avec des messages sur les erreurs de la carte vidéo. <br><br>  Mais je me suis trop emporté et Chris, notre autre colocataire, a décidé d'intervenir ... <br><br><h2>  Chasse au chasseur </h2><br><h3>  Première étape </h3><br>  Un beau jour, alors que Logan dormait, j'ai remarqué un message d'erreur qui disait: "Max est derrière tout ça."  Choooo?  J'ai une blague!  J'ai donc commencé à comprendre et à découvrir que quelqu'un (Chris) avait introduit cette phrase dans un ensemble de messages aléatoires dans <code>zenity.php</code> .  Je l'ai rapidement supprimé (jusqu'à ce que Logan apprenne qu'ils le jouaient) et j'ai décidé que le plaisir était terminé.  Ça y était. <br><br><h3>  Deuxième étape </h3><br>  Après environ une semaine, le message est apparu à nouveau.  Je pensais que Chris m'a brûlé et l'a rajouté à la liste.  Pas une putain de chose.  Il n'était pas là.  Après une étude approfondie du fichier, j'ai remarqué qu'il s'appelle maintenant <code>/usr/sbin/zenity</code> au lieu de <code>/usr/bin/zenity</code> (la valeur par défaut du système), et <code>sudoers</code> avait une entrée permissive correspondante.  Alors, qu'est-ce que <code>/usr/sbin/zenity</code> ?  Script shell: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash echo '.' &gt;&gt; /tmp/log.txt if [ 0 -eq $((RANDOM % 100)) ]; then /usr/bin/zenity --error --display=:0 --text "   ." --timeout 10 &gt; /dev/null &amp; else /usr/bin/zenity "$@" fi</span></span></code> </pre> <br>  Eh bien, c'était le prochain niveau de merde, si jamais je rencontrais quelque chose comme ça.  99% du temps, tout fonctionnait comme il se doit, et dans le 1% restant, le message «Max se tient derrière» est apparu.  J'ai supprimé le fichier (je sais, cela n'en valait pas la peine) et écrire aux <code>sudoers</code> ramené <code>zenity.php</code> à sa forme d'origine.  Les messages ont cessé d'apparaître.  Mais ils sont revenus. <br><br><h3>  Troisième étape </h3><br>  J'ai vérifié <code>zenity.php</code> .  Rien de nouveau.  <code>/usr/sbin/zenity</code> ?  Disparu.  Je suis découragé.  J'ai alors décidé de regarder à l'intérieur de <code>/usr/bin/zenity</code> : <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # ---    --- # ---    --- # ---    --- # ---    --- # ---    --- if [ 0 -eq $((RANDOM % 70)) ]; then /usr/bin/rpmdb-client --error --display=:0 --text """"" """""" """""""""""" """"""""." --timeout 10 &gt; /dev/null &amp; else /usr/bin/rpmdb-client "$@" fi</span></span></code> </pre> <br>  Petit bâtard rusé.  Il a corrigé le binaire zenity, ce qui en fait un script bash qui fonctionne une fois et 70. Que diable?  Et quel genre de <code>rpmdb-client</code> ?  J'ai donc riposté en le changeant: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># &lt;&gt; if [ 0 -eq $((RANDOM % 70)) ]; then /usr/sbin/rpmdb-client --error --display=:0 --text """"" """""" """""""""""" """"""""." --timeout 10 &gt; /dev/null &amp; else /usr/bin/rpmdb-client "$@" fi</span></span></code> </pre> <br>  Avez-vous compris la différence?  Sinon, <code>/usr/sbin/rpmdb-client</code> est appelé à la place de <code>/usr/bin/rpmdb-client</code> , qui lance un script bash qui ne fait rien.  Avec assez de chance, il ne remarquera pas de personnage supplémentaire et son message n'apparaîtra jamais. <br><br>  TODO: Comprenez la différence entre les exécutables ELF <code>/usr/sbin/zenity</code> et le <code>/usr/bin/rpmdb-client</code> que Chris a créé.  Il y a une étrange différence dans les binaires que je n'ai pas encore compris. <br><br><h3>  Quatrième étape </h3><br>  J'ai décidé de renforcer la défense, jusqu'à ce que Chris remarque la différence dans une lettre décrite ci-dessus.  J'ai annulé toutes mes modifications et décidé de corriger la <code>zenity</code> place.  Une profonde gratitude à Tom Hebb (comme dans tous mes articles techniques) pour son aide.  Voici ce que j'ai fait: <br><br><ol><li>  Configuré <code>apt</code> pour télécharger les sources (dans ce cas, ajouter <code>deb-src</code> à <code>/etc/apt/sources.list</code> ) </li><li> <code>apt-get source zenity</code> </li> <li>  Fabriqué un patch avec <code>quilt</code> : <br><ol><li> <code>quilt new myPatch.diff</code> </li> <li>  Un patch pour <code>src/msg.c</code> qui détermine la présence du mot «Max» dans le corps du message: <br><br><div class="spoiler">  <b class="spoiler_title">msg.c</b> <div class="spoiler_text"><pre> <code class="diff hljs"><span class="hljs-comment"><span class="hljs-comment">Index: zenity-3.18.1.1/src/msg.c =================================================================== --- zenity-3.18.1.1.orig/src/msg.c +++ zenity-3.18.1.1/src/msg.c @@ -21,6 +21,8 @@ * Authors: Glynn Foster &lt;glynn.foster@sun.com&gt; */ +#include &lt;string.h&gt; + #include "config.h" #include "zenity.h" @@ -85,6 +87,11 @@ zenity_msg (ZenityData *data, ZenityMsgD GObject *text; GObject *image; + if (strstr(msg_data-&gt;dialog_text, "Max") + || strstr(msg_data-&gt;dialog_text, "max")) { + return; + } + switch (msg_data-&gt;mode) { case ZENITY_MSG_WARNING: builder = zenity_util_load_ui_file ("zenity_warning_dialog", NULL);</span></span></code> </pre> </div></div></li><li> <code>quilt add src/msg.c</code> </li> <li> <code>quilt pop</code> </li> </ol></li><li> <code>dpkg-source --commit</code> </li> <li> <code>dpkg-buildpackage -us -uc</code> </li> <li>  Je me suis rendu compte que créer et installer un nouveau paquet est plus pâle que de remplacer un binaire </li><li>  Remplacé tranquillement le <code>rpmdb-client</code> (sa <code>zenity</code> ) par ma version </li><li>  Lui tapota le dos </li></ol><br>  Ce correctif modifie le comportement de la <code>zenity</code> de telle manière que dès que le mot «Max» apparaît dans le texte du message, l'application ne fait rien en silence. <br><br><h2>  Conclusion </h2><br>  Jusqu'à la fin du mois de mars, Chris n'a jamais découvert que j'avais corrigé le binaire.  En conséquence, Logan n'a pas vu un seul message avec mon nom.  J'ai donc décidé de continuer le rallye jusqu'à ce que je lui dise tout après la fin du parcours.  Mais à la fin des cours, nous nous sommes séparés.  Bien que Logan et moi vivrons à nouveau ensemble l'année prochaine, nous ne passerons probablement pas autant de temps dans la salle pour que le rallye ait du sens.  J'ai donc décidé de publier ce post avant de commencer de nouveaux trucs. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr417915/">https://habr.com/ru/post/fr417915/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr417903/index.html">Cas de révision de code 1</a></li>
<li><a href="../fr417905/index.html">11 façons (de ne pas) devenir victime de piratage à Kubernetes</a></li>
<li><a href="../fr417909/index.html">Pourquoi avez-vous besoin de Splunk? Analyse d'application</a></li>
<li><a href="../fr417911/index.html">Conception continue en développement: méthodologie et principe</a></li>
<li><a href="../fr417913/index.html">Optimisation du rendu d'une scène du dessin animé Disney "Moana". 3e partie</a></li>
<li><a href="../fr417917/index.html">ASC'18: Persévérance et entraînement régulier comme moyen d'atteindre l'objectif</a></li>
<li><a href="../fr417919/index.html">Modélisation des vibrations et du bruit dans une boîte de vitesses de voiture</a></li>
<li><a href="../fr417927/index.html">Cyber ​​Battle les PHDays, ou comment pirater une infrastructure urbaine en 30 heures</a></li>
<li><a href="../fr417929/index.html">Extrait du livre «Un jour dans la vie du cerveau. Neurobiologie de la conscience de l'aube au crépuscule »</a></li>
<li><a href="../fr417931/index.html">Techniques de rétention des joueurs: exemples de jeux de différents genres</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>