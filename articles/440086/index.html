<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§™ üíé üë®üèø‚Äçüéì Mundo de virus MS-DOS ‚õπüèº üßëüèΩ üë®üèæ‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Esta publicaci√≥n es una versi√≥n de texto de mi charla en el 35 ¬∞ Congreso de Computaci√≥n del Caos a fines de 2018. 

 De modo que debo admitir que MS-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mundo de virus MS-DOS</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/edison/blog/440086/"><img src="https://habrastorage.org/getpro/habr/post_images/b72/62e/c62/b7262ec62c4ef1c84e30a166db2801ed.gif" alt="imagen"><br><br>  Esta publicaci√≥n es una versi√≥n de texto de mi <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">charla</a> en el 35 ¬∞ Congreso de Computaci√≥n del Caos a fines de 2018. <br><br>  De modo que debo admitir que MS-DOS est√° un poco indignado, a pesar de que el malware MS-DOS siempre me ha fascinado hasta cierto punto, pero primero debemos preguntarnos: "¬øQu√© es DOS?" <br><br><ul><li>  DOS es una versi√≥n de CP / M, otro sistema operativo muy antiguo. </li><li>  La familia DOS abarca una amplia gama de proveedores, simplemente porque sea DOS no significa que se ejecutar√° en una CPU 8086 o mejor </li><li>  ¬°Algunos de estos proveedores de DOS tienen compatibilidad API, lo que significa que algunos de ellos usan malware! </li></ul><br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/xr/et/uz/xretuzunpjloadbgzif-gsekqo4.jpeg" alt="imagen"><br><br>  <b>Video de rendimiento:</b> <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/xgS1M4e_9_E" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><blockquote> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" title="Software EDISON - desarrollo web"><img align="left" width="153" height="75" src="https://habrastorage.org/webt/w0/zl/to/w0zltoxvysbr0yeinstkfvw1wbg.png" alt="Software EDISON - desarrollo web"></a> <br clear="right">  La publicaci√≥n fue escrita con el apoyo de EDISON Software, que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desarrolla una aplicaci√≥n para un operador m√≥vil virtual</a> y se dedica al <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">desarrollo y mantenimiento de sitios en Python</a> . </blockquote><br><img src="https://habrastorage.org/getpro/habr/post_images/328/83d/c0d/32883dc0d675c3b77af3bfe1f550ebcc.png" alt="imagen"><br><br>  Pero, de hecho, la mayor√≠a de nuestros recuerdos de la era de DOS son la est√©tica de c√≥mo se ve√≠an las computadoras de esa √©poca: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fbf/8c9/ebd/fbf8c9ebdbfe3b6061d80745c60dc7e5.jpg" alt="imagen"><br><br>  Esta es la era de la "computaci√≥n beige" y el teclado Modelo M, que puede ser famoso o infame dependiendo de si te gusta el teclado ruidoso o no. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9ef/c07/8a6/9efc078a6a2e5848807a3d2b3611096a.png" alt="imagen"><br><br>  ¬°Algunos de nosotros podemos tener recuerdos de usar DOS, y algunos a√∫n pueden usar DOS! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a36/117/004/a36117004fac6d309590fe6cd6a81be0.png" alt="imagen"><br><br>  Por ejemplo, se rumorea que George R. Martin, quien escribi√≥ The Game of Thrones, us√≥ Wordstar en DOS para escribir un libro. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/796/730/bf8/796730bf815f1e8d6b47f7f464648017.png" alt="imagen"><br><br>  Tampoco podemos perdernos QBASIC, ¬°para muchos este ser√≠a su primer conocimiento de la programaci√≥n! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ca5/6cc/58a/ca56cc58aa88ca31d21e23e4e9d7e4e0.gif" alt="imagen"><br><br>  Pero a veces la vida usando DOS no era tan buena, a veces usabas DOS, y cosas as√≠ sucedieron de repente.  En este ejemplo, se reproduce una peque√±a melod√≠a durante la impresi√≥n, por lo que puede ser una situaci√≥n muy inc√≥moda en un entorno de oficina. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bf3/d02/d61/bf3d02d61b4ee6dd7a6d9bd3598e0942.gif" alt="imagen"><br><br>  Algunos de ellos son m√°s "lindos", en este caso, por ejemplo, pasa una ambulancia dibujada con s√≠mbolos ascii, y luego el programa que desea abrir se inicia, en el peor de los casos, con peque√±os inconvenientes. <br><br>  Gracias a un grupo de archiveros de malware que se ejecutan bajo el nombre de VX Heavens, tenemos un buen archivo hist√≥rico de malware de DOS, o al menos hasta que la polic√≠a ucraniana asalte el sitio: <br><blockquote>  El viernes 23 de marzo, la polic√≠a incaut√≥ el servidor en relaci√≥n con una investigaci√≥n criminal (art√≠culo 361-1 del C√≥digo Penal de Ucrania - creaci√≥n de malware con el prop√≥sito de venderlo o distribuirlo) en base a las indicaciones de alguien.  sobre "poner en acceso libre software malicioso dise√±ado para el pirateo no autorizado de computadoras, sistemas automatizados, redes de computadoras". </blockquote><br>  Afortunadamente, los sitios populares de torrents todav√≠a tienen copias de la base de datos del sitio que nos pueden proporcionar un excelente conjunto de datos: <br><br><pre><code class="plaintext hljs">$ tar -tvf viruses-20070914.tar | wc -l 66714 $ ls -alh viruses-20070914.tar 6.6G viruses-20070914.tar</code> </pre> <br>  Sin embargo, para comenzar a estudiar estas muestras, primero debemos comprender el flujo de distribuci√≥n t√≠pico de estas muestras, dado que estos programas funcionaron en la era previa a Internet: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8b9/968/2ad/8b99682ad85c8c3b236952ae835869aa.png" alt="imagen"><br><br>  Despu√©s de recibir un archivo infectado en su sistema y ejecutarlo, el programa malicioso buscar√° activamente o instalar√° interceptores de llamadas del sistema para los programas que ejecuta.  A menudo hace esto de una manera sutil e invisible para evitar ser detectado.  La importancia de la sutileza es importante porque para distribuir este programa malicioso debe transferirlo a otro sistema utilizando un medio (disquete) o descargarlo a otro punto de distribuci√≥n, como BBS. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7a8/bf9/57d/7a8bf957dcced5f67116861d7aa87460.png" alt="imagen"><br><br>  En tiempo de ejecuci√≥n, el malware tiene dos opciones;  puede permanecer oculto e infectar nuevos archivos o mostrar una carga √∫til. <br><br>  ¬°Algunas cargas √∫tiles son bastante bonitas!  El siguiente ejemplo utiliza funciones inusuales, como 256 colores: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f60/ca9/f79/f60ca9f7987b2e5204fb08a0fbf8c32e.gif" alt="imagen"><br><br>  O este que juega con tu b√∫fer de pantalla: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b72/62e/c62/b7262ec62c4ef1c84e30a166db2801ed.gif" alt="imagen"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/898/f25/b51/898f25b5140151ecebe8494e39c6797d.png" alt="imagen"><br><br>  Sin embargo, en su mayor parte, el malware permanecer√° en silencio e intentar√° encontrar archivos para la infecci√≥n.  La infecci√≥n de la mayor√≠a de los archivos es muy simple, por ejemplo, si ve el archivo COM como una larga cinta de c√≥digo de m√°quina: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4eb/b47/cde/4ebb47cde9f6329fdaf04dd6c648056d.png" alt="imagen"><br><br>  Entonces "todo lo que tiene que hacer" es insertar JMP al comienzo del programa y agregar datos al final del programa.  Se ver√° m√°s o menos as√≠: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c6a/eee/16b/c6aeee16b8813e731be734b0c81bdb5d.png" alt="imagen"><br><br>  Algunos c√≥digos fueron m√°s inteligentes y encontraron "espacio vac√≠o" en el archivo binario y se escribieron all√≠, lo que evit√≥ que el archivo binario aumentara de tama√±o, lo que, posiblemente, significaba que el antivirus pod√≠a usar la bandera roja. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/898/f25/b51/898f25b5140151ecebe8494e39c6797d.png" alt="imagen"><br><br>  Sin embargo, antes, tambi√©n mencion√© las llamadas del sistema interceptor.  A pesar de que el tiempo de ejecuci√≥n de MS-DOS es muy simple y pr√°cticamente desprotegido (puede cargar Linux de manera trivial desde un archivo COM).  Todav√≠a contiene la API completa para que las aplicaciones no necesiten tener su propia implementaci√≥n del sistema de archivos.  Estas son algunas caracter√≠sticas de syscalls: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/503/b94/031/503b94031afdf70ab966327bb6a83ef5.png" alt="imagen"><br><br>  Funcionan causando una interrupci√≥n de software, en la que el programa le pide al procesador que se mueva a otra secci√≥n de la memoria del sistema para procesar algo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db8/424/17c/db842417cb90c6059bfeb0e92cf7bdf9.png" alt="imagen"><br><br>  Sin embargo, MS-DOS tambi√©n ofrece la capacidad de agregar / modificar estas llamadas (usando otra llamada), lo que le permite expandir el sistema para que los nuevos controladores puedan cargarse en tiempo de ejecuci√≥n.  Sin embargo, tambi√©n es un lugar ideal para agregar intercepciones de malware: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7e5/051/5f4/7e50515f49434bd39a96c29be41aa253.png" alt="imagen"><br><br>  Fue un truco bien utilizado, porque pod√≠a interceptar la llamada "Abrir archivo" y luego usarla para detectar nuevos archivos ejecutables en el sistema ... e infectarlos. <br><br>  Como un ejemplo r√°pido de c√≥mo se usan, veamos un simple programa Hello World: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/07e/ee5/abb/07eee5abbb7f150ad322aca95a1491b0.png" alt="imagen"><br><br>  Como podemos ver, hay dos llamadas de tipo <code>int</code> .  Usamos <code>21h</code> (h = hexadecimal) como el n√∫mero de llamada del sistema principal, y podemos especificar qu√© acci√≥n queremos que realice MS-DOS en funci√≥n del valor de <code>Ah</code> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2b3/e30/ea8/2b3e30ea8878b81233d5387df02d3cf5.png" alt="imagen"><br><br>  En este caso, el programa realiza una llamada para imprimir la l√≠nea y luego sale con el c√≥digo de retorno 0 (indefinido). <br><br>  Como se mencion√≥ anteriormente.  Cuando llame a int 21h, el procesador central buscar√° en la tabla IVT d√≥nde ir, dentro de este controlador a menudo hay un segmento como un enrutador que enruta varias llamadas principales, en el caso de Int 21h dirige a varias funciones basadas en el valor ah.  Tan pronto como lleguemos al lugar, el administrador de llamadas real se encargar√° de la tarea, luego ejecutar√° iret para volver al programa principal, a menudo dejando registros de los resultados de la llamada: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b22/a7c/b66/b22a7cb66a3449cb811537c121b96db2.gif" alt="imagen"><br><br>  Entonces  Si queremos ver todas las llamadas del sistema que inici√≥ el programa, podemos establecer un punto de interrupci√≥n al comienzo del controlador de interrupciones y verificar qu√© es ah: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/437/8a0/dab/4378a0dabeddb413b66d3985f7a07ae4.png" alt="imagen"><br><br>  Hacemos esto porque el controlador de interrupciones siempre est√° en un lugar fijo en MS-DOS (esto es mucho antes que la era ASLR y ASLR de Kernel), y la ubicaci√≥n del programa no lo est√°. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c56/630/3df/c566303dfe33c0822630fdd2a7e6e4e5.png" alt="imagen"><br><br>  Una vez que lo lancemos, podemos ver los desaf√≠os que plantea este patr√≥n.  Si bien podemos ver en la pantalla que acaba de imprimir una notificaci√≥n sobre el archivo Goat (Goat es un archivo dise√±ado para infectar, como una cabra sacrificada).  Tambi√©n vemos que este programa hace m√°s que simplemente imprimir una l√≠nea.  ¬°Comprueba la versi√≥n de DOS (probablemente para verificar la compatibilidad) y luego abre, lee y escribe datos! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fc8/e68/30d/fc8e6830de63466825df85f1e98be417.png" alt="imagen"><br><br>  Esto es interesante!  Pero nos gustar√≠a saber m√°s sobre lo que el sistema llama resaltado en rojo, ya que deben tener entrada para cosas como nombres de archivos y datos para escribir en archivos / resultados en la pantalla. <br><br>  Para hacer esto, necesitamos mirar otros registros durante syscall: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f55/e53/9a4/f55e539a4af8d544409dadf05f181005.png" alt="imagen"><br><br>  Usando "Cadena de impresi√≥n" como un ejemplo simple, podemos ver c√≥mo se ve el uso: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/223/3cf/9f5/2233cf9f5a0fe096b71c9f7e38d81602.png" alt="imagen"><br><br>  ¬øQu√© es DS: DX?  ¬øPor qu√© hay dos registros aqu√≠ y c√≥mo obtenemos datos de ellos? <br><br>  Para hacer esto, necesitamos entender un poco m√°s sobre el procesador 8086. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e61/fc6/160/e61fc6160d49dcee4568635340b860dd.png" alt="imagen"><br><br>  El procesador 8086 es una CPU de 16 bits, pero con direccionamiento de memoria de 20 bits.  Esto significa que el procesador solo puede almacenar valores que indican 64 KB, esto es un problema cuando la capacidad de memoria es de hasta 1 MB. <br><br>  Para evitar esto, necesitamos comprender los registros de segmentaci√≥n: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0d5/6e0/263/0d56e02639206a885d4899036a1bbf6e.png" alt="imagen"><br><br>  El procesador 8086 tiene 4 registros de segmentaci√≥n que debemos cuidar: <br><br><ul><li>  CS - segmento de c√≥digo </li><li>  DS - segmento de datos </li><li>  SS - segmento de pila </li><li>  ES: un segmento adicional (en caso de que necesite uno m√°s para sortear diferentes situaciones) </li></ul><br>  Hay una serie de otros registros de uso general que lo salvan del uso excesivo de memoria y le permiten pasar par√°metros a otras funciones. <br>  La segmentaci√≥n registra el trabajo cambiando el bloque en la RAM: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5cd/ff2/bca/5cdff2bca72f3d038fb3830bb38ff6c2.gif" alt="imagen"><br><br>  Esto permite que la CPU de 16 bits vea los 20 bits de RAM, asegurando que para cada valor DS el bloque est√© compensado por 16 bytes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/84a/9d8/7be/84a9d87be1242165bd3aa45cd06c6039.png" alt="imagen"><br><br>  En este caso, la llamada DS se usa como un puntero dentro de la ventana de 16 bits con respecto a d√≥nde est√° el comienzo de la l√≠nea.  Luego, la impresora de l√≠neas escanear√° hasta encontrar el car√°cter $ y luego se detendr√°.  Esto es similar a otros sistemas que usan bytes nulos en lugar de $. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4e2/5a9/f0b/4e25a9f0b1b0d7cfaab1d6795eaaf6ed.gif" alt="imagen"><br><br>  Con la edad de ISA x86, poco ha cambiado, en lugar del hecho de que el tama√±o de bits del procesador ha aumentado, los mismos registros se han ampliado. <br><br>  Entonces, con este conocimiento, podemos crear una lista de "tareas" para rastrear estos programas: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/832/a32/910/832a329105d030ee51a56a372d671302.png" alt="imagen"><br><br>  Con esta configuraci√≥n, ¬°podemos lanzar varias computadoras grandes al problema durante varias horas y obtener los resultados! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ddd/6c3/5c2/ddd6c35c2e4bab73fd088dde763ee470.png" alt="imagen"><br><br>  Y tenemos ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f4/3b4/0f9/1f43b40f9e7f8b1bffff55bc8fc6ab70.png" alt="imagen"><br><br>  Nada de eso. <br><br>  Esto es decepcionante. <br><br>  ¬°Quemamos al menos un valor de poder de h√°msters y casi no obtuvimos activaciones geniales!  <i>(Xs c√≥mo traducir esto)</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d69/69d/be2/d6969dbe2ff5f0c7629b1f9e594e6c3a.png" alt="imagen"><br><br>  Si miramos algunas muestras, veremos una pistola humeante aqu√≠.  Una muestra decente verifica la fecha o la hora. <br><br>  Si miramos la documentaci√≥n de estas llamadas, veremos que la llamada del sistema devuelve valores en forma de registros para el programa: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/265/186/a75/265186a7562b336b45e194bf82e3b02a.png" alt="imagen"><br><br>  ¬°Entonces podemos forzarlos con fuerza bruta!  Todo lo que necesitamos hacer es algo como esto: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0aa/556/5fe/0aa5565fe29e9008f8607305f53bf28b.png" alt="imagen"><br><br>  Pero hay un problema con este m√©todo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce5/bf3/7b6/ce5bf37b6d1c0aaccbed58e064c4ece5.png" alt="imagen"><br><br>  El paso de probar el ejemplo lleva unos 15 segundos, ya que utiliza el proceso completo de emulaci√≥n qemu, y puede llevar hasta 15 segundos ejecutar completamente el programa en la m√°quina virtual.  Dado que DOS no tiene caracter√≠sticas de ahorro de energ√≠a, esto significa que cuando DOS est√° en modo de espera, est√° en un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">ciclo ocupado</a> <br><br>  Por lo tanto, podr√≠amos ver este problema de manera diferente al ver qu√© c√≥digo se ejecutar√° despu√©s de la solicitud de fecha / hora. <br><br>  Como nuestro rastreador est√° en el controlador de interrupciones, no sabemos desde el cuadro d√≥nde se encuentra el programa: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/435/1eb/4cf/4351eb4cfd0effcf312e0f8154e5a29b.png" alt="imagen"><br><br>  Para hacer esto, debemos mirar la pila donde nos esperan los registros CS e IP. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0f8/a73/a94/0f8a73a9432e23d64675fefd7f504e5e.png" alt="imagen"><br><br>  Tan pronto como tomemos estos dos registros de la pila, podemos usarlos para obtener el c√≥digo de retorno para que nuestra lista de verificaci√≥n se vea as√≠: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/837/d44/cdf/837d44cdf7fbb940b4428cd2e2871f54.png" alt="imagen"><br><br>  Una vez que hayamos hecho esto y hayamos probado repetidamente el conjunto de datos, ¬°veremos c√≥mo se ve la parte del c√≥digo de retorno! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/45a/ee0/71e/45aee071eb023929029044227939d0d7.png" alt="imagen"><br><br>  Aqu√≠ hay una muestra de uno.  Aqu√≠ vemos que se hace una comparaci√≥n para DL y 0x1e. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/265/186/a75/265186a7562b336b45e194bf82e3b02a.png" alt="imagen"><br><br>  Si miramos nuestra documentaci√≥n, veremos que DL es el d√≠a del mes, es decir, podemos analizar los tres c√≥digos de operaci√≥n principales de la siguiente manera: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4fc/12f/220/4fc12f220ff2d17566087e726398e728.png" alt="imagen"><br><br>  Podr√≠amos revisar todo esto manualmente, pero hay muchas de estas muestras que verifican la hora, alrededor de 4700: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b1/25f/720/1b125f720508620f525c3d3535ca8cbb.png" alt="imagen"><br><br>  Entonces, en cambio, necesitamos hacer otra cosa.  Necesitamos escribir algo ... Necesitamos escribir ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/22c/383/5a1/22c3835a1387f950080cee18fb0da8ef.png" alt="imagen"><br><br>  El peor emulador x86 del mundo, llamado BenX86, es un emulador dise√±ado espec√≠ficamente para nuestras necesidades, y nada m√°s: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/561/58b/66c/56158b66ca09d37e7dc64194df98d623.png" alt="imagen"><br><br>  Pero tiene algunas ventajas en su velocidad. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d05/4e9/540/d054e954038188ec32e684b3a6ccad95.png" alt="imagen"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/77c/1e8/dd6/77c1e8dd6527f6105236b2e5b6d61fa0.png" alt="imagen"><br><br>  Agregamos 10,000 pruebas de ejecuci√≥n diferentes basadas en las rutas que encontramos usando la fuerza bruta con BenX86.  Por lo tanto, terminar√© con algunos de mis descubrimientos favoritos que se activan con el tiempo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b9/308/b5d/1b9308b5d968a59433bff7c9448e1ed2.gif" alt="imagen"><br><br>  Este patr√≥n se activa el d√≠a de A√±o Nuevo y cuelga su sistema despu√©s de que se muestra un saludo.  Puede ser bueno si est√° atrapado en la oficina para el a√±o nuevo, o puede ser malo si realmente necesita hacer algo el d√≠a de A√±o Nuevo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/40d/b3a/0be/40db3a0be86fb2dd6891c9836001343b.png" alt="imagen"><br><br>  Este ejemplo me sorprendi√≥ mucho.  Se activa a principios de 1995 e informa al usuario sobre todos los archivos infectados que infect√≥, y luego elimina el virus (eliminando la transici√≥n al principio) y luego no hace nada m√°s.  Aunque por alguna raz√≥n dice que debe comprar McAfee, este mensaje obviamente no est√° desactualizado. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/201/094/384/20109438477e51765809aa938551d027.png" alt="imagen"><br><br>  Esto, francamente, realmente me confunde, el 8 de noviembre de cualquier a√±o, convertir√° todos los ceros del sistema en peque√±os glifos de "odio".  Realmente me molesta si sabes por qu√© lo necesitas, h√°zmelo saber ... <br><br><img src="https://habrastorage.org/getpro/habr/post_images/802/2ba/081/8022ba0819bf2177c6a856a626fb4976.gif" alt="imagen"><br><br>  Esta es probablemente mi pesadilla cuando, despu√©s de iniciar cualquier programa, muestra un mensaje de que no pudo comer su disco principal.  Ser√≠a incre√≠blemente perturbador ver de la nada. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/381/f69/768/381f697681914f2412955bb3c73d46a0.png" alt="imagen"><br><br>  En conclusi√≥n, tenemos cu√°l es la versi√≥n Navy Seal Copypasta del malware DOS.  No estoy seguro de que a este autor no le guste Aladdin, pero hagas lo que hagas, eres una persona. <br><br>  Si est√° interesado en el c√≥digo que se ejecut√≥ en este art√≠culo, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">lanc√© mi kit de herramientas en github</a> , sin ninguna garant√≠a.  Si desea crear este c√≥digo usted mismo, deber√° trabajar para asegurarse de que funciona con su instalaci√≥n de MS-DOS (arreglar un punto de interrupci√≥n del controlador) <br><br>  Sin embargo, si solo mira para ver lo que vi mientras miraba este proyecto, he archivado la interfaz web aqu√≠: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">dosv.benjojo.co.uk</a> <br><br>  Hasta pronto! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/440086/">https://habr.com/ru/post/440086/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../440072/index.html">Demostraci√≥n de AresDB: herramienta de an√°lisis en tiempo real de c√≥digo abierto basada en GPU de Uber</a></li>
<li><a href="../440074/index.html">Roskomos considera incorrecto comparar los motores Raptor Ilona Mask y RD-180</a></li>
<li><a href="../440076/index.html">Traducci√≥n e interpretaci√≥n de publicidad del ingl√©s al ruso</a></li>
<li><a href="../440078/index.html">Dispositivo compilador r√°pido. Parte 4</a></li>
<li><a href="../440084/index.html">10 mil millones de exportaciones de software son insignificantes</a></li>
<li><a href="../440088/index.html">bobaflu - accesorios de programaci√≥n en flutter</a></li>
<li><a href="../440090/index.html">¬øC√≥mo funcionan realmente los indicadores t√©cnicos en el mercado de valores?</a></li>
<li><a href="../440092/index.html">Una investigaci√≥n matem√°tica de c√≥mo fingi√≥ las elecciones de gobernador en Primorye el 16 de septiembre de 2018</a></li>
<li><a href="../440094/index.html">Los jardines en flor en Marte siguen siendo un sue√±o: el proyecto Mars One se declar√≥ en quiebra</a></li>
<li><a href="../440096/index.html">Vulnerabilidad de RunC que afecta a Kubernetes, Docker y containerd</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>