<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§šğŸ» ğŸ˜ï¸ ğŸ‘©ğŸ½ ROSåœ¨Raspberry Piä¸Šçš„å®é™…ä½¿ç”¨-ç¬¬2éƒ¨åˆ† ğŸ‘µğŸ¿ ğŸ ğŸš</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ä¸‹åˆå¥½ï¼Œäº²çˆ±çš„å“ˆå¸ƒå°”è¯»è€…ï¼è¿™æ˜¯æœ‰å…³Raspberry Piä¸ŠROSå®é™…ä½¿ç”¨çš„ç³»åˆ—æ–‡ç« ä¸­çš„ç¬¬äºŒç¯‡ã€‚åœ¨è¯¥ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘æè¿°äº†å®‰è£…å¿…è¦çš„ROSç»„ä»¶å¹¶è®¾ç½®å·¥ä½œç¯å¢ƒã€‚
 åœ¨æœ¬ç³»åˆ—çš„ç¬¬äºŒéƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†å¼€å§‹åœ¨Raspberry Piå¹³å°ä¸Šå®é™…ä½¿ç”¨ROSåŠŸèƒ½ã€‚å…·ä½“æ¥è¯´ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºå°†Raspberry...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ROSåœ¨Raspberry Piä¸Šçš„å®é™…ä½¿ç”¨-ç¬¬2éƒ¨åˆ†</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/388927/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹åˆå¥½ï¼Œäº²çˆ±çš„å“ˆå¸ƒå°”è¯»è€…ï¼</font><font style="vertical-align: inherit;">è¿™æ˜¯æœ‰å…³Raspberry Piä¸ŠROSå®é™…ä½¿ç”¨çš„ç³»åˆ—æ–‡ç« ä¸­çš„ç¬¬äºŒç¯‡ã€‚</font><font style="vertical-align: inherit;">åœ¨è¯¥</font><font style="vertical-align: inherit;">ç³»åˆ—</font><font style="vertical-align: inherit;">çš„</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç¬¬ä¸€ç¯‡æ–‡ç« ä¸­</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼Œæˆ‘æè¿°äº†å®‰è£…å¿…è¦çš„ROSç»„ä»¶å¹¶è®¾ç½®å·¥ä½œç¯å¢ƒã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æœ¬ç³»åˆ—çš„ç¬¬äºŒéƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†å¼€å§‹åœ¨Raspberry Piå¹³å°ä¸Šå®é™…ä½¿ç”¨ROSåŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">å…·ä½“æ¥è¯´ï¼Œåœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºå°†Raspberry Piä¸Šçš„Raspberry Piæ‘„åƒå¤´æ¿ä¸ROSç»“åˆä½¿ç”¨æ¥è§£å†³è®¡ç®—æœºè§†è§‰é—®é¢˜ã€‚</font><font style="vertical-align: inherit;">è°æœ‰å…´è¶£ï¼Œè¯·ç…§é¡¾ä¸‹ã€‚</font></font><br>
<a name="habracut"></a><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç›¸æœºRPiç›¸æœºæ¿</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºäº†å·¥ä½œï¼Œæˆ‘ä»¬å°†éœ€è¦ä¸€å°Raspberry Piç›¸æœºæ¿</font></font><br>
<img src="https://habrastorage.org/files/f91/582/efb/f91582efbd9a4e059f001e08484ae71c.jpg" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç›¸æœº</font><font style="vertical-align: inherit;">ï¼š</font><font style="vertical-align: inherit;">è¯¥ç›¸æœºé€šè¿‡æ¿ä¸Šçš„CSiè¿æ¥å™¨ç›´æ¥è¿æ¥åˆ°GPUï¼Œè¿™ä½¿æ‚¨æ— éœ€ä½¿ç”¨å¤„ç†å™¨æ—¶é—´å³å¯è®°å½•å’Œç¼–ç ç›¸æœºä¸­çš„å›¾åƒã€‚</font><font style="vertical-align: inherit;">ZIFç”µç¼†ç”¨äºè¿æ¥ç›¸æœºã€‚</font><font style="vertical-align: inherit;">æ¿ä¸Šçš„ç”µç¼†è¿æ¥å™¨ä½äºä»¥å¤ªç½‘å’ŒHDMIç«¯å£ä¹‹é—´ï¼š</font></font><br>
<br>
<img src="https://habrastorage.org/files/a3d/d1e/ede/a3dd1eede9394ebca71b766a3712f0ec.JPG" alt="å›¾ç‰‡"><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">åº“å®‰è£…</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œè®©æˆ‘ä»¬ç»§ç»­å®‰è£…å¿…è¦çš„åº“ã€‚</font><font style="vertical-align: inherit;">é¦–å…ˆï¼Œå®‰è£…OpenCVï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo apt-get install libopencv-dev
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦ä½¿ç”¨Raspberry Piç›¸æœºï¼Œæˆ‘ä»¬å°†éœ€è¦raspicamåº“ã€‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹è½½æ¡£æ¡ˆ</font><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œå®‰è£…åº“ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ tar xvzf raspicamxx.tgz<font></font>
$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> raspicamxx<font></font>
$ mkdir build<font></font>
$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> build<font></font>
$ cmake ..<font></font>
$ make<font></font>
$ sudo make install<font></font>
$ sudo ldconfig<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨éœ€è¦é€šè¿‡raspi-configç¨‹åºåœ¨Raspbianä¸­å¯ç”¨ç›¸æœºæ”¯æŒï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo raspi-config
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€‰æ‹©é€‰é¡¹5-å¯ç”¨æ‘„åƒæœºï¼Œä¿å­˜é€‰æ‹©å¹¶é‡æ–°å¯åŠ¨ç³»ç»Ÿã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ROSå…¥é—¨</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºæ–¹ä¾¿èµ·è§ï¼Œè¯·ä¸ºæˆ‘ä»¬çš„åŒ…è£…åˆ›å»ºä¸€ä¸ªæ–°çš„æŸ³çµ®è½¦é—´ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ mkdir -p ~/driverobot_ws/src<font></font>
$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/driverobot_ws/src<font></font>
$ catkin_init_workspace<font></font>
$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/driverobot_ws<font></font>
$ catkin_make<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ›å»ºä¸€ä¸ªæ–°çš„ROSåŒ…ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> src/<font></font>
$ catkin_create_pkg raspi_cam_ros image_transport cv_bridge roscpp std_msgs sensor_msgs compressed_image_transport opencv2<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
catkin_create_pkgå‘½ä»¤çš„è§„èŒƒå¦‚ä¸‹ï¼šcatkin_create_pkg &lt;package_name&gt; [depend1] [depend2]ï¼Œ</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥åœ¨å…¶ä¸­æŒ‡å®šåº“ï¼ˆç¨‹åºåŒ…å°†ä½¿ç”¨çš„åº“ï¼‰ä¸‹çš„ä»»ä½•ä¾èµ–é¡¹ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å‘½ä»¤åˆ›å»ºROSé¡¹ç›®çš„æ¡†æ¶ï¼šä¸€ä¸ªç©ºçš„srcç›®å½•ï¼Œç”¨äºå­˜æ”¾èŠ‚ç‚¹è„šæœ¬ä»¥åŠCMakeLists.txtå’Œpackage.xmlé…ç½®æ–‡ä»¶ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘æ‰¾åˆ°äº†ä¸€ä¸ªç®€å•çš„è„šæœ¬ï¼Œè¯¥è„šæœ¬å¯ä»¥æ¥æ”¶æ¥è‡ªç›¸æœºçš„å¸§å¹¶ä½¿ç”¨â€œå‘å¸ƒè€…â€ï¼ˆpublisherï¼‰å‘å¸ƒè¿™äº›å¸§ï¼Œå¹¶å°†å…¶æ”¹ç¼–ä¸ºROS Indigoã€‚</font><font style="vertical-align: inherit;">æ‚¨å¯ä»¥</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»è¿™é‡Œ</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹è½½</font><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦ä½¿ç”¨å®ƒï¼Œæ‚¨éœ€è¦å®‰è£…Raspberry Pi UV4Læ‘„åƒæœºé©±åŠ¨ç¨‹åºï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ curl http://www.linux-projects.org/listing/uv4l_repo/lrkey.asc | sudo apt-key add -
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°†ä»¥ä¸‹è¡Œæ·»åŠ åˆ°/etc/apt/sources.listæ–‡ä»¶ä¸­</font></font><br>
<br>
<pre><code class="bash hljs">deb http://www.linux-projects.org/listing/uv4l_repo/raspbian/ wheezy main
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ›´æ–°è½¯ä»¶åŒ…å¹¶å®‰è£…ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo apt-get update<font></font>
$ sudo apt-get install uv4l uv4l-raspicam<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¦ä¸‹è½½é©±åŠ¨ç¨‹åºï¼Œåœ¨æ¯æ¬¡ç³»ç»Ÿå¼•å¯¼æ—¶ï¼Œæˆ‘ä»¬è¿˜å®‰è£…ä¸€ä¸ªå¯é€‰è½¯ä»¶åŒ…ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ sudo apt-get install uv4l-raspicam-extras
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è®©æˆ‘ä»¬ç»§ç»­ç¼–è¾‘åŒ…ã€‚</font><font style="vertical-align: inherit;">å°†</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">çš„è¡Œç²˜è´´åˆ°CMakeLists.txtæ–‡ä»¶ä¸­</font><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
CMakeLists.txtæ–‡ä»¶ä¸­æœ€é‡è¦çš„å‡ è¡Œï¼š</font></font><br>
<br>
<pre><code class="bash hljs">link_directories(/usr/lib/uv4l/uv4lext/armv6l/)<font></font>
â€¦<font></font>
target_link_libraries(capture <span class="hljs-variable"><span class="hljs-variable">${catkin_LIBRARIES}</span></span> uv4lext)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å› æ­¤ï¼Œæˆ‘ä»¬å‘uv4lé©±åŠ¨ç¨‹åºæ·»åŠ äº†é“¾æ¥ï¼Œè¿™å¯¹äºç¼–è¯‘è½¯ä»¶åŒ…æ˜¯å¿…éœ€çš„ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨æ–‡ä»¶æœ«å°¾ï¼Œæˆ‘ä»¬ä¸ºèŠ‚ç‚¹è®¾ç½®ç‰¹æ®Šè¡Œï¼š</font></font><br>
<br>
<pre><code class="bash hljs">add_executable(capture src/capturer.cpp)<font></font>
target_link_libraries(capture <span class="hljs-variable"><span class="hljs-variable">${catkin_LIBRARIES}</span></span> uv4lext)
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
add_executableè¡Œåˆ›å»ºç”¨äºå¯åŠ¨çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œtarget_link_lbrariesé“¾æ¥ç”¨äºæ•è·äºŒè¿›åˆ¶æ–‡ä»¶çš„å…¶ä»–åº“ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°†ç¼ºå°‘çš„è¡Œ</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç²˜è´´</font><font style="vertical-align: inherit;">åˆ°package.xmlæ–‡ä»¶ä¸­ï¼Œä½¿å…¶çœ‹èµ·æ¥åƒè¿™æ ·ï¼š</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span>                                                                                            
<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">package</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                                                        
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>raspi_cam_ros<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                                      
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>0.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                                       
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>The raspi_cam_ros package<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>                                                            <font></font>
                                                                                                                 <font></font>
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maintainer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">email</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pi@todo.todo"</span></span></span><span class="hljs-tag">&gt;</span></span>pi<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maintainer</span></span></span><span class="hljs-tag">&gt;</span></span>                                                               <font></font>
                                                                                                                 <font></font>
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">license</span></span></span><span class="hljs-tag">&gt;</span></span>TODO<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">license</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                                        
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">buildtool_depend</span></span></span><span class="hljs-tag">&gt;</span></span>catkin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">buildtool_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                    
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>cv_bridge<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                         
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>image_transport<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                   
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>roscpp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                            
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>std_msgs<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                          
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>sensor_msgs<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                       
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>opencv2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                           
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>compressed_image_transport<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                        
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>cv_bridge<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                             
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>image_transport<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                       
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>roscpp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                                
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>std_msgs<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                              
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>sensor_msgs<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                           
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>opencv2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                               
  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>compressed_image_transport<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">run_depend</span></span></span><span class="hljs-tag">&gt;</span></span>                                                                                                                                                                    
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">package</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨ç¬¬ä¸€è¡Œä¸­ï¼Œè®¾ç½®äº†èŠ‚ç‚¹çš„åŸºæœ¬å‚æ•°-åç§°ï¼Œç‰ˆæœ¬ï¼Œæè¿°ï¼Œæœ‰å…³ä½œè€…çš„ä¿¡æ¯ã€‚</font><font style="vertical-align: inherit;">build_dependè¡Œç¡®å®šç¼–è¯‘åŒ…æ‰€éœ€çš„åº“ä¾èµ–å…³ç³»ï¼Œrun_dependè¡Œç¡®å®šè¿è¡ŒåŒ…ä¸­çš„ä»£ç æ‰€éœ€çš„ä¾èµ–å…³ç³»ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨srcæ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªcapturer.cppæ–‡ä»¶ï¼Œç„¶å</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ç²˜è´´è¡Œ</font><font style="vertical-align: inherit;">ã€‚</font><font style="vertical-align: inherit;">åœ¨mainï¼ˆï¼‰æ–¹æ³•ä¸­ï¼Œæ­¤èŠ‚ç‚¹è¢«åˆå§‹åŒ–å¹¶åœ¨å¾ªç¯ä¸­å¯åŠ¨ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">ros::init(argc, argv,<span class="hljs-string"><span class="hljs-string">"raspi_cam_ros"</span></span>);<font></font>
ros::NodeHandle n;<font></font>
<span class="hljs-function"><span class="hljs-function">UsbCamNode </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(n)</span></span></span></span>;<font></font>
a.spin();<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è„šæœ¬çš„æ•´ä¸ªé€»è¾‘æ˜¯ï¼Œæˆ‘ä»¬ä½¿ç”¨OpenCVä»æ‘„åƒæœºè·å–å›¾ç‰‡ï¼Œå°†å…¶åŒ…è£…åœ¨fillImageæ–¹æ³•ä¸­çš„ROSæ¶ˆæ¯ä¸­ï¼Œå¹¶å°†å…¶å‘å¸ƒåˆ°ä¸»é¢˜ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™é‡Œï¼Œimage_transportåŒ…ç”¨äºåˆ›å»ºâ€œå‘å¸ƒè€…â€å›¾ç‰‡ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨uv4lé©±åŠ¨ç¨‹åºï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ uv4l --driver raspicam --auto-video_nr --width 640 --height 480 --nopreview
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä»€ä¹ˆå°†åˆ›å»ºMJPEGæµã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¼–è¯‘æˆ‘ä»¬çš„ROSèŠ‚ç‚¹ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ roscore<font></font>
$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/driverobot_ws<font></font>
$ catkin_make<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ£€æŸ¥ROS_PACKAGE_PATHå˜é‡çš„å€¼ï¼š</font></font><br>
<br>
<pre><code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$ROS_PACKAGE_PATH</span></span><font></font>
/opt/ros/indigo/share:/opt/ros/indigo/stacks<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ROS_PACKAGE_PATHå˜é‡çš„å€¼åº”åŒ…æ‹¬å·¥ä½œç©ºé—´çš„è·¯å¾„ã€‚</font><font style="vertical-align: inherit;">åœ¨è·¯å¾„ä¸­æ·»åŠ æˆ‘ä»¬çš„å·¥ä½œå®¤ç©ºé—´ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> devel/setup.bash
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨å†æ¬¡è¿è¡Œecho $ ROS_PACKAGE_PATHå‘½ä»¤ï¼Œæˆ‘ä»¬åº”è¯¥çœ‹åˆ°ç±»ä¼¼çš„è¾“å‡ºï¼š</font></font><br>
<br>
<pre><code class="bash hljs">/home/youruser/catkin_ws/src:/opt/ros/indigo/share:/opt/ros/indigo/stacks
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ï¼Œå…¶ä¸­/ home / &lt;ç”¨æˆ·å&gt; / catkin_ws / srcæ˜¯å·¥ä½œç©ºé—´çš„è·¯å¾„ã€‚</font><font style="vertical-align: inherit;">è¿™æ„å‘³ç€ROSå¯ä»¥â€œçœ‹åˆ°â€æˆ‘ä»¬åœ¨catkin_wsä¸­åˆ›å»ºçš„èŠ‚ç‚¹ï¼Œå¹¶ä¸”å¯ä»¥é€šè¿‡rosrunè¿è¡Œå®ƒä»¬ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿è¡Œæˆ‘ä»¬çš„ROSèŠ‚ç‚¹ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ rosrun raspi_cam_ros capture
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
è¿è¡Œå›¾å½¢ç¨‹åºrqt_image_viewä»¥æ˜¾ç¤ºè¯¥ä¸»é¢˜çš„è§†é¢‘æµï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ rosrun rqt_image_view rqt_image_view
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨rqt_image_viewçª—å£ä¸­é€‰æ‹©image_rawä¸»é¢˜ã€‚</font></font><br>
<br>
<img src="https://habrastorage.org/files/3bf/79d/e52/3bf79de524f34444973352af07b121ed.png" alt="å›¾ç‰‡"><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯åŠ¨èŠ‚ç‚¹æ—¶ï¼Œé€šè¿‡sshæˆ–â€œ GdkGLExt-WARNING **ï¼šçª—å£ç³»ç»Ÿä¸æ”¯æŒOpenGLâ€æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°é”™è¯¯â€œ Gtk-WARNING **ï¼šæ— æ³•æ‰“å¼€æ˜¾ç¤ºï¼š-1â€ã€‚</font><font style="vertical-align: inherit;">åœ¨VNCè¿œç¨‹æ¡Œé¢æ¨¡å¼ä¸‹è¿è¡Œæ—¶ã€‚</font><font style="vertical-align: inherit;">è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨X11è½¬å‘é€šè¿‡SSHè¿æ¥åˆ°Raspberry Piï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ ssh -X pi@&lt;host_pi&gt;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥ä½¿ç”¨rostopicå‘½ä»¤æ‰¾å‡ºå‘å¸ƒåˆ°ä¸»é¢˜çš„é¢‘ç‡ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">rostopic hz image_raw
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ­¤å‘½ä»¤è®¡ç®—æ¯ç§’æ¯ä¸ªä¸»é¢˜æ¥æ”¶æ¶ˆæ¯çš„é¢‘ç‡ï¼Œå¹¶å°†å…¶æ˜¾ç¤ºåœ¨æ§åˆ¶å°ä¸­ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯¹äºæ¨¡å‹B +ï¼Œæˆ‘æœ‰è¿™æ ·çš„ç»“è®ºï¼š</font></font><br>
<br>
<pre><code class="bash hljs">average rate: 7.905<font></font>
              min: 0.075s max: 0.249s std dev: 0.02756s <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¦‚æ‚¨æ‰€è§ï¼Œå‘å¸ƒé¢‘ç‡ä¸º8 Hzã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘è¿˜æ£€æŸ¥äº†åœ¨RPi 2æ¨¡å‹ä¸Šä»æ‘„åƒæœºå‘å¸ƒå›¾åƒçš„é¢‘ç‡ï¼Œè¿™é‡Œçš„ç»“æœè¦å¥½å¾ˆå¤šå€ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">average rate: 30.005<font></font>
              min: 0.024s max: 0.043s std dev: 0.00272s <font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¶ˆæ¯å·²ç»ä»¥30 Hzçš„é¢‘ç‡å‘å¸ƒï¼Œä¸B +æ¨¡å‹ç›¸æ¯”ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“ä¸é”™çš„é€Ÿåº¦æé«˜ã€‚</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä½¿ç”¨OpenCVå’ŒROSçš„åŸºäºè§†è§‰çš„æœºå™¨äººæ§åˆ¶</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬å°†ç¼–å†™ä¸€ä¸ªå°çš„ROSç¨‹åºåŒ…ï¼Œä»¥ä¾¿åœ¨å…·æœ‰Raspberry Piçš„æœºå™¨äººä¸Šä½¿ç”¨è®¡ç®—æœºè§†è§‰ï¼Œå®ƒå°†æ‰§è¡Œè¯†åˆ«ç®—æ³•ï¼ˆåœ¨æˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨è¡Œè·Ÿéšæ–¹æ³•è¿›è¡Œè§†è§‰å®šå‘ï¼‰å¹¶å°†æ‰€éœ€çš„æœºå™¨äººåç§»é‡çš„å€¼å‘å¸ƒåˆ°ä¸»é¢˜ä¸­ã€‚</font><font style="vertical-align: inherit;">å¦ä¸€æ–¹é¢ï¼Œæœºå™¨äººè¿åŠ¨æ§åˆ¶èŠ‚ç‚¹å°†è®¢é˜…è¯¥ä¸»é¢˜å¹¶å°†è¿åŠ¨æ§åˆ¶å‘½ä»¤å‘é€åˆ°Arduinoã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæˆ‘ä»¬å°†ä¸€ä¸ªâ€œå‘å¸ƒè€…â€æ·»åŠ åˆ°capturer.cppè„šæœ¬ä¸­ï¼Œè¯¥è„šæœ¬å°†å‘å¸ƒshiftå€¼ã€‚</font><font style="vertical-align: inherit;">é¦–å…ˆï¼Œä¸ºç§»ä½å€¼å¯ç”¨æ¶ˆæ¯ç±»å‹çš„å®šä¹‰-std_msgs / Int16ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;std_msgs/Int16.h&gt;</span></span></span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
rosserialéœ€è¦ç‰¹æ®Šçš„msgæ¶ˆæ¯æ–‡ä»¶å¹¶ä¸ºå…¶ç”Ÿæˆæºä»£ç ã€‚</font><font style="vertical-align: inherit;">ä½¿ç”¨æ­¤æ¨¡æ¿ï¼š</font><font style="vertical-align: inherit;">
æ ‡å‡†rosserialæ¶ˆæ¯çš„æºä»£ç å­˜å‚¨åœ¨ros_libç›®å½•å†…çš„package_nameæ–‡ä»¶å¤¹ä¸­ã€‚</font><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åˆå§‹åŒ–æ­¤ç±»å‹çš„æ¶ˆæ¯ï¼š</font></font><br>
<code>package_name/msg/Foo.msg â†’ package_name::Foo<br>
</code><br>
<br><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"></font><br>
<br>
<pre><code class="cpp hljs">std_msgs::Int16 shift_msg;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åˆ›å»ºä¸€ä¸ªâ€œå‘å¸ƒè€…â€ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">ros::Publisher shift_pub;
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨UsbCamNodeæ„é€ å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä¸ºå…¶å®šä¹‰ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs">shift_pub = nh.advertise&lt;std_msgs/Int16&gt;(â€œline_shiftâ€, <span class="hljs-number"><span class="hljs-number">1</span></span>);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è®¾ç½®æ¶ˆæ¯çš„ç±»å‹å’Œå‘å¸ƒä¸»é¢˜çš„åç§°ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥ï¼Œåœ¨#ifdef OUTPUT_ENABLEDè¡Œä¹‹å‰ï¼Œæ·»åŠ ä½¿ç”¨OpenCVè®¡ç®—æ¢è¡Œå€¼å¹¶å°†å…¶å‘å¸ƒåˆ°take_and_send_imageï¼ˆï¼‰æ–¹æ³•ä¸­çš„line_shiftä¸»é¢˜çš„é€»è¾‘ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// Some logic for the calculation of offest</span></span><font></font>
shift_msg.data = offset;<font></font>
shift_pub.publish(shift_msg);<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘æ²¡æœ‰ç°æˆçš„è¡Œè·Ÿéšç®—æ³•ï¼Œå› æ­¤è¯»è€…å¯ä»¥åœ¨æ­¤å¤„è‡ªç”±ç¼–å†™è‡ªå·±çš„é€»è¾‘ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å®é™…ä¸Šï¼Œæ¶ˆæ¯ä¸­çš„æ•°æ®å­˜å‚¨åœ¨æ•°æ®å­—æ®µä¸­ã€‚</font><font style="vertical-align: inherit;">å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ¶ˆæ¯ç»“æ„ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ rosmsg show std_msgs/Int16
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨è¿è¡ŒèŠ‚ç‚¹ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ rosrun raspi_cam_ros capturer
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬ä½¿ç”¨rostopic echoå‘½ä»¤æ¥è¾“å‡ºå‘å¸ƒåˆ°ä¸»é¢˜line_shiftçš„æ•°æ®ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ rostopic <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> line_shift
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œå°†â€œè®¢æˆ·â€æ·»åŠ åˆ°æœºæ¢°æ‰‹æ§åˆ¶èŠ‚ç‚¹ã€‚</font><font style="vertical-align: inherit;">å¯ç”¨æ¶ˆæ¯ç±»å‹çš„å®šä¹‰ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;std_msgs/UInt16.h&gt;</span></span></span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç„¶åï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œè¯¥å›è°ƒå‡½æ•°åœ¨ä»ä¸»é¢˜æ¥æ”¶åˆ°æ¶ˆæ¯æ—¶æ‰§è¡Œã€‚</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">messageCb</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> std_msgs::UInt16&amp; message)</span></span></span><span class="hljs-function"> 
</span></span>{
  <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> shift_val = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(message.data);<font></font>
  <font></font>
  <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>* log_msg;
  <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(shift_val &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) log_msg = <span class="hljs-string"><span class="hljs-string">"Left"</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(shift_val &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> ) log_msg = <span class="hljs-string"><span class="hljs-string">"Right"</span></span>;
  <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> log_msg = <span class="hljs-string"><span class="hljs-string">"Forward"</span></span>;<font></font>
  <font></font>
  nh.loginfo(log_msg);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å›è°ƒå‡½æ•°çš„ç±»å‹å¿…é¡»ä¸ºvoidï¼Œå¹¶å°†æ¶ˆæ¯ç±»å‹çš„constå¼•ç”¨ä½œä¸ºå‚æ•°ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºç®€å•èµ·è§ï¼Œæˆ‘è®°å½•äº†æœ‰å…³è¡Œåç§»æ–¹å‘çš„æ¶ˆæ¯ã€‚</font><font style="vertical-align: inherit;">åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥ä¸ºè‡ªå·±çš„åœºæ™¯æ·»åŠ è‡ªå·±çš„æœºå™¨äººè¿åŠ¨é€»è¾‘ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸ºä¸»é¢˜line_shiftåˆ›å»ºæ¶ˆæ¯çš„è®¢é˜…è€…ã€‚</font></font><br>
<br>
<pre><code class="cpp hljs">ros::Subscriber&lt;std_msgs::UInt16&gt; sub(<span class="hljs-string"><span class="hljs-string">"line_shift"</span></span>, &amp;messageCb);
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è®¾ç½®ä¸»é¢˜çš„åç§°ä»¥åŠæŒ‡å‘å›è°ƒå‡½æ•°çš„é“¾æ¥ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ¥ä¸‹æ¥æ˜¯rosserial_arduinoçš„æ ‡å‡†ç´ ææ–¹æ³•ï¼š</font></font><br>
<br>
<pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setup</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{<font></font>
  nh.initNode();<font></font>
  nh.subscribe(sub);<font></font>
  <font></font>
  Serial.begin(<span class="hljs-number"><span class="hljs-number">57600</span></span>);<font></font>
}<font></font>
<font></font>
<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">
</span></span>{<font></font>
  nh.spinOnce();<font></font>
  delay(<span class="hljs-number"><span class="hljs-number">100</span></span>);<font></font>
}<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼Œæˆ‘ä»¬æ·»åŠ nh.subscribeï¼ˆsubï¼‰æ¥ä¸ºä¸»é¢˜åˆ›å»ºç«™ç‚¹çš„å®é™…â€œè®¢é˜…â€ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å¯ä»¥</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹è½½ç”¨äºæ§åˆ¶æœºå™¨äººçš„è‰å›¾</font><font style="vertical-align: inherit;">ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
å°æŠŠæˆï¼</font><font style="vertical-align: inherit;">åœ¨ROSä¸­ï¼Œæœ‰ä¸€äº›ç‰¹æ®Šçš„å¯åŠ¨æ–‡ä»¶ï¼Œä½¿æ‚¨å¯ä»¥ä½¿ç”¨æŸäº›å‚æ•°å°†èŠ‚ç‚¹ä½œä¸ºç‹¬ç«‹çš„è¿›ç¨‹è‡ªåŠ¨å¯åŠ¨ã€‚</font><font style="vertical-align: inherit;">å¯åŠ¨æ–‡ä»¶ä»¥xmlæ ¼å¼åˆ›å»ºï¼Œå…¶è¯­æ³•å…è®¸æ‚¨ä¸€æ¬¡è¿è¡Œå¤šä¸ªèŠ‚ç‚¹ã€‚</font><font style="vertical-align: inherit;">ä½†æ˜¯ï¼Œå¯åŠ¨æ–‡ä»¶ä¸èƒ½ä¿è¯å°†æŒ‰ç…§æŒ‡å®šçš„ç¡®åˆ‡é¡ºåºå¯åŠ¨èŠ‚ç‚¹ã€‚</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æ‚¨å¯ä»¥åˆ›å»ºå¯åŠ¨æ–‡ä»¶ä»¥ä½¿rosserial_pythonæœåŠ¡å™¨æ›´æ˜“äºå¯åŠ¨ã€‚</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> &lt;catkin_ws&gt;/src<font></font>
$ catkin_create_pkg rosserial_controller<font></font>
$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> src/rosserial_controller<font></font>
$ vim rosserial_controller.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬ç¼–å†™å…·æœ‰ä»¥ä¸‹å†…å®¹çš„å¯åŠ¨æ–‡ä»¶ï¼š</font></font><br>
<br>
<pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">launch</span></span></span><span class="hljs-tag">&gt;</span></span>
 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">node</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">pkg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rosserial_python"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"serial_node.py"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"arduino_serial"</span></span></span><span class="hljs-tag">&gt;</span></span>
       <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"port"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/dev/ttyACM0"</span></span></span><span class="hljs-tag">/&gt;</span></span>       
 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">node</span></span></span><span class="hljs-tag">&gt;</span></span>
<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">launch</span></span></span><span class="hljs-tag">&gt;</span></span>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç¼–è¯‘å¹¶è¿è¡Œå®ƒï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/&lt;catkin_ws&gt;<font></font>
$ catkin_make<font></font>
$ <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> devel/setup.bash<font></font>
$ roslaunch rosserial_controller rosserial_controller.launch<font></font>
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨rqt_plotå®ç”¨å·¥å…·å¯è§†åŒ–line_shiftä¸»é¢˜ä¸­å‘å¸ƒçš„å€¼ï¼Œå¦‚</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">æœ¬æ–‡æ‰€è¿°</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ï¼š</font></font><br>
<br>
<pre><code class="bash hljs">$ rqt_plot line_shift
</code></pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ç°åœ¨ï¼Œæ‚¨å¯ä»¥åœ¨æ–¹æ¡ˆä¸­å……åˆ†åˆ©ç”¨Raspberry Piç›¸æœºå’ŒOpenCVåº“ï¼Œä»¥å®ç°æœºå™¨äººçš„è§†è§‰å®šå‘ï¼Œå¯¹è±¡è¯†åˆ«ï¼Œè·Ÿè¸ªä»¥åŠè®¸å¤šå…¶ä»–åŠŸèƒ½ã€‚</font><font style="vertical-align: inherit;">é‡Šæ”¾æ‚¨çš„æƒ³è±¡åŠ›ï¼</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
ä¸‹æ¬¡ï¼Œæˆ‘ä»¬å°†è®¨è®ºé€šè¿‡æŒ‰é”®ç›˜ä¸Šçš„é”®åœ¨é¥æ§æ¨¡å¼ä¸‹æ§åˆ¶æœºå™¨äººã€‚</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
PSã€‚</font><font style="vertical-align: inherit;">è¯¥ç½‘ç»œå…·æœ‰æœ‰ç”¨çš„å¤‡å¿˜å•-ROSå¤‡å¿˜å•ã€‚</font><font style="vertical-align: inherit;">å¯¹äºROS Indigoç‰ˆæœ¬ï¼Œå¯ä»¥</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä»æ­¤å¤„</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ä¸‹è½½</font><font style="vertical-align: inherit;">ã€‚</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN388927/">https://habr.com/ru/post/zh-CN388927/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN388913/index.html">å¾®è½¯æ­£å‡†å¤‡å‘å¸ƒè‡ªå·±çš„SIMå¡</a></li>
<li><a href="../zh-CN388917/index.html">åœ¨é€šå¾€å¤ªç©ºçš„è·¯ä¸Šã€‚å±‚æµå™¨</a></li>
<li><a href="../zh-CN388921/index.html">è¶Šå—å†›æ–¹æ¢ç´¢ä»å¤©ä¸Šæ‰ä¸‹æ¥çš„ç¥ç§˜å®‡å®™çƒ</a></li>
<li><a href="../zh-CN388923/index.html">ä¸å¯æ­ç©¿çš„ç§‘å­¦ç¥è¯</a></li>
<li><a href="../zh-CN388925/index.html">è°çš„ä¸‰è§’å½¢æ›´ç²—</a></li>
<li><a href="../zh-CN388929/index.html">SpaceXå°†å†æ¬¡å°†Falcon 9ç™»é™†ç¦»å²¸å¹³å°</a></li>
<li><a href="../zh-CN388931/index.html">2015å¹´å…¨ä¸–ç•Œå¦‚ä½•è§‚çœ‹è‰²æƒ…ç‰‡-PornHubå¨±ä¹æ€§å›¾è¡¨</a></li>
<li><a href="../zh-CN388933/index.html">OCZ RevoDrive-é€Ÿåº¦ä¸º2.4 GB / sçš„NVMe SSD</a></li>
<li><a href="../zh-CN388937/index.html">å®¶åº­ä¸»å¦‡çš„å°é—­å®‡å®™</a></li>
<li><a href="../zh-CN388939/index.html">æ¨å‡ºé¦–æ¬¾å¯åœ¨4åˆ†é’Ÿå†…ä¸‹è½½4Kç”µå½±çš„WiGigè·¯ç”±å™¨</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>