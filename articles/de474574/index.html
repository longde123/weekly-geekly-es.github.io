<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üêç ü§∂üèº üé≥ Wir identifizieren den Angriff des Verschl√ºsselungsvirus, erhalten Zugriff auf den Dom√§nencontroller und versuchen, diesen Angriffen zu widerstehen. üßíüèΩ üßìüèæ üë©üèª‚Äçüíª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="WannaCry, NotPetya, BadRabbit und andere sind Ransomware-Viren, die vor ein oder zwei Jahren die ganze Welt ersch√ºtterten. Angriffe dieser Art von Vir...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir identifizieren den Angriff des Verschl√ºsselungsvirus, erhalten Zugriff auf den Dom√§nencontroller und versuchen, diesen Angriffen zu widerstehen.</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/galssoftware/blog/474574/"><img src="https://habrastorage.org/webt/ol/w0/dw/olw0dwca4jcb1xs3dod5nhtwfdo.gif"><br><br>  WannaCry, NotPetya, BadRabbit und andere sind Ransomware-Viren, die vor ein oder zwei Jahren die ganze Welt ersch√ºtterten.  Angriffe dieser Art von Viren sind heute weniger laut, aber es gibt immer noch Geschichten mit Angriffen.  In diesem Artikel werde ich eines der Tools zeigen, mit denen der Angriff eines solchen Virus gestoppt werden kann: schnelles Erkennen eines Eindringlings und Lokalisieren des Problems.  All dies mit Hilfe eines Protokollanalyse- und Intrusion Protection- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Tools Quest InTrust</a> .  Unter der Katze befinden sich Screenshots und ein Link zu den Repositories sch√§dlicher Skripte.  Lass uns gehen! <br><a name="habracut"></a><br>  Quest InTrust ist eine integrierte L√∂sung, die die Erfassung verschiedener Arten von Protokollen, Syslog-Daten und vorgefertigten Parsern f√ºr verschiedene Arten von Ger√§ten umfasst.  Es gibt vordefinierte Regeln f√ºr Ma√ünahmen zur Verhinderung von Angriffen.  Jetzt werden wir uns all diese Beispiele f√ºr das Parsen eines Verschl√ºsselungsvirus-Angriffs und den Zugriff auf einen Dom√§nencontroller genauer ansehen <br><br><h1>  Ransomware-Angriff </h1><br>  Das Prinzip des Angriffs besteht darin, neue verschl√ºsselte Dateien oder Ordner zu erstellen und die urspr√ºnglichen zu l√∂schen.  Na dann eine L√∂segeldanfrage in Bitcoins oder auf andere Art und Weise.  Die Definition dieser Art von Angriff basiert auf der Erkennung von Massenl√∂schvorg√§ngen und der Erstellung von Dateien.  Vor allem, wenn dies nach der Schule passiert. <br><br><div class="spoiler">  <b class="spoiler_title">Einige Repositorys mit Beispielen f√ºr Verschl√ºsselungsskripten</b> <div class="spoiler_text">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Powershell-Ransomware</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ansomware-Verschl√ºsseler-Entschl√ºsseler</a> <br></div></div><br>  Um √Ñnderungsereignisse zu erfassen, verwenden wir die Integration mit der Pr√ºfungsl√∂sung Quest Change Auditor (wir haben bereits <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">im vorherigen Artikel dar√ºber geschrieben</a> und es sogar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">mit einem Produkt eines Mitbewerbers verglichen</a> ).  F√ºr Ereignisse aus dieser Quelle hat InTrust vordefinierte Regeln zum Erkennen von Anomalien festgelegt.  Nat√ºrlich k√∂nnen Sie hier eine beliebige Ereignisverarbeitungslogik hinzuf√ºgen.  In meinem Beispiel wird festgelegt, dass beim Erstellen von Dateien in gro√üen Mengen (mehr als 5 Teile in 1 Minute) das Benutzerkonto gesperrt und der Zugriff auf freigegebene Verzeichnisse verweigert wird. <br><br><img src="https://habrastorage.org/webt/t3/s3/17/t3s317ynfhnygdue6ehjvy5gadi.png"><br><br>  Die Richtlinieneinstellungen geben das Verzeichnis an, f√ºr das die Regel gilt, sowie die Liste der Benachrichtigungen.  Wenn der AD Informationen zur Unterordnung von Mitarbeitern enth√§lt, k√∂nnen Sie einen Brief an seinen Vorgesetzten senden.  Ein n√ºtzlicher Fall ist die Identifizierung von Versuchen, auf Dateien zuzugreifen, die f√ºr die Erf√ºllung der Aufgaben dieses bestimmten Mitarbeiters anscheinend nicht erforderlich sind.  Es kann vor der Entlassung besonders relevant sein, wenn Sie vorgefertigte Entwicklungen mitnehmen m√∂chten. <br><br><img src="https://habrastorage.org/webt/a5/xy/wy/a5xywya_veqwkqljbbrtzqsfyla.png"><br><br>  Nachdem Sie alle Einstellungen √ºberpr√ºft haben, fahren Sie mit dem vorbereiteten Skriptverschl√ºsseler fort.  Und lass es laufen. <br><br><img src="https://habrastorage.org/webt/qd/f5/h-/qdf5h-zk24kdq47biltyggzgavg.png"><br><br>  In den Einstellungen zum Erkennen eines Angriffs wurden "mehr als 5 Dateien" angezeigt, wie Sie sehen k√∂nnen, nachdem der Virus nach 7 Dateien gestoppt wurde (der Benutzer wurde blockiert und der Zugriff auf das Verzeichnis wurde deaktiviert).  Einfach auszusteigen.  Gleichzeitig erhielten verantwortliche Mitarbeiter Benachrichtigungen. <br><br><h1>  Angriff auf einen Dom√§nencontroller </h1><br>  Im Folgenden finden Sie das Angriffsszenario, mit dem Sie auf das Administratorkonto und damit auf den Dom√§nencontroller zugreifen k√∂nnen.  Die Erkennung der Ausf√ºhrung spezialisierter <s>b√∂swilliger</s> Cmdlets (z. B. das Entladen von Dom√§nenkonten) ist ebenfalls in der Liste der vordefinierten Quest InTrust-Regeln enthalten (die erste Zeile in der Auswahl in der Abbildung unten).  Au√üerdem werden in meinem Beispiel Benutzer aus dem "wei√üen Blatt" angegeben, f√ºr die die Regeln nicht gelten (die zweite Zeile in der Auswahl im Bild unten). <br><br><img src="https://habrastorage.org/webt/bk/6j/eg/bk6jegg3lxxw_avksd2etqkhttg.png"><br><br>  Mit dem Skript " <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">invoke-mimikatz" kann ein Speicherauszug mit Kontodetails erstellt werden</a> .  Gleichzeitig werden keine Dateien im Dateisystem erstellt.  √úberpr√ºfen Sie zun√§chst den Namen des Kontos, unter dem Sie angemeldet sind.  Wie Sie sehen, ist dieser Benutzer von der "wei√üen Liste", der beliebige Cmdlets frei ausf√ºhren kann. <br><br><img src="https://habrastorage.org/webt/mz/ge/wu/mzgewuwguxg1kc8vssgbddrgfxy.png"><br><br>  Dann f√ºhren wir das vorbereitete Skript aus.  Am Ausgang erhalten wir eine Schlussfolgerung, in der wir die Details unseres Testbenutzers finden. <br><br><img src="https://habrastorage.org/webt/b4/l6/oi/b4l6oioub43m6dnl1b2dhs9one0.png"><br><br>  Im n√§chsten Schritt ermitteln wir, zu welchen Gruppen dieser Benutzer geh√∂rt.  Administratorgruppen sind vorhanden. <br><br><img src="https://habrastorage.org/webt/-j/vy/92/-jvy928mvqdn7kjtgoquyhdvwqo.png"><br><br>  Jetzt lernen wir die Namen der Dom√§nencontroller.  In meinem Beispiel ist er allein. <br><br><img src="https://habrastorage.org/webt/k2/v2/4z/k2v24z02-4bpvkudt703fpke5jc.png"><br><br>  Der n√§chste Schritt bei einem m√∂glichen Angriff ist die Anmeldung bei einem Dom√§nencontroller.  Es bleibt die Eingabe des bereits markierten Passworts. <br><br><img src="https://habrastorage.org/webt/ip/8u/d5/ip8ud53rjhhvejbjyf98u-4hbqo.png"><br><br>  Und erhalten Sie Zugriff auf die Ausf√ºhrung von Befehlen auf dem Dom√§nencontroller. <br><br><img src="https://habrastorage.org/webt/w7/uo/cu/w7uocu-xypu2qh9nd0ycdlxn2du.png"><br><br>  Versuchen wir nun, den gleichen Algorithmus f√ºr Aktionen auszuf√ºhren, jedoch im Namen eines Benutzers, der nicht zur ‚Äûwei√üen Liste‚Äú in InTrust hinzugef√ºgt wurde.  F√ºr die Reinheit des Experiments √ºberpr√ºfen wir den Benutzernamen.  Dann f√ºhren wir das invoke-mimikatz-Skript aus. <br><br><img src="https://habrastorage.org/webt/x-/8h/yp/x-8hypkn4uu8e4q8jhouok6rlvu.png"><br><br>  Zu den in InTrust erw√§hnten Aktionen geh√∂rten das Beenden der Terminalzugriffssitzung und das Blockieren des Benutzers.  Welches ist passiert. <br><br><img src="https://habrastorage.org/webt/fo/iu/sx/foiusxs7rjzlxzjomeows2ambus.png"><br><br>  √úberpr√ºfen Sie nun dieses Konto erneut. <br><br><img src="https://habrastorage.org/webt/-h/fo/vj/-hfovjzipni1-kbpno0qlmmxxyc.png"><br><br>  Der Angriff wird verhindert, der Benutzer wird blockiert, die Welt wird gerettet. <br><br>  Wenn Sie √ºber eigene Richtlinien zur Bek√§mpfung verschiedener Arten von Eindringlingen verf√ºgen, k√∂nnen Sie diese auch in InTrust angeben.  Zusammen mit anderen Quest-Produkten ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Change Auditor</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Enterprise Reporter</a> ), die auf InTrust basieren, k√∂nnen Sie ein vollwertiges SIEM-System erstellen, um die schwerwiegenden Folgen digitaler Angriffe auf Unternehmen zu identifizieren und zu verhindern. <br><br>  InTrust und andere Quest-Produkte k√∂nnen im Rahmen eines Pilotprojekts in Ihrer Umgebung getestet werden.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Hinterlassen Sie eine Anfrage</a> , um mehr zu erfahren. <br><br>  Unsere anderen Artikel √ºber die Tag <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Gals Software</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de474574/">https://habr.com/ru/post/de474574/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de474562/index.html">LEGO MINDSTORMS Education EV3 + MicroPython: Wir programmieren einen Kinderkonstruktor in einer Sprache f√ºr Erwachsene</a></li>
<li><a href="../de474564/index.html">Autosampler - Leben nach Leben</a></li>
<li><a href="../de474566/index.html">Diese Stadt braucht einen neuen Helden: eine √úberpr√ºfung der diebstahlsicheren Rucks√§cke von Bobby Hero</a></li>
<li><a href="../de474568/index.html">Milch von den Z√§hnen: ein Berufswechsel f√ºr Zellen</a></li>
<li><a href="../de474572/index.html">Ist das √ºberhaupt normal? Das Normproblem in der Psychologie</a></li>
<li><a href="../de474576/index.html">Sound Vision VOICe Vision. Schau aus der Dunkelheit</a></li>
<li><a href="../de474578/index.html">Warum E-Mail-Marketing-Service tats√§chlich gegen Spam k√§mpft und wie es funktioniert</a></li>
<li><a href="../de474580/index.html">Zugriff auf die Anwendung mithilfe der ax Availability Testing Library</a></li>
<li><a href="../de474582/index.html">(Ohne) gef√§hrliches Online-Banking: Eine Studie √ºber die Webressourcen von Banken in Russland und der Welt</a></li>
<li><a href="../de474584/index.html">Installieren Sie Kali Linux mit einer grafischen Oberfl√§che auf einem virtuellen Server</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>