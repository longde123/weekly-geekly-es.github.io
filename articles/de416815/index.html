<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👨‍👩‍👧‍👦 ✔️ 👼🏻 Wie wir aufgehört haben, eine Woche lang einen Dev-Stand herauszugeben 😙 🕵🏻 🧖🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Jeder Entwickler möchte seinen eigenen Entwicklerstand. Jeder Tester möchte seinen eigenen Prüfstand. Und jeder Spezialist für Vorproduktion will sein...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie wir aufgehört haben, eine Woche lang einen Dev-Stand herauszugeben</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/rencredit/blog/416815/">  Jeder Entwickler möchte seinen eigenen Entwicklerstand.  Jeder Tester möchte seinen eigenen Prüfstand.  Und jeder Spezialist für Vorproduktion will seinen eigenen Stand - um endlich alles zu überprüfen und den Start im Produkt zu proben.  Wenn all diese Wunschliste in der Verarbeitung zusammenlaufen - eines der größten und aktivsten Systeme der Bank -, kratzen Sie sich aufgrund der Infrastrukturkosten am Kopf und suchen nach „Optionen“.  Wir werden erzählen, was wir in diesem Beitrag gefunden haben. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/a0e/f74/1d0/a0ef741d02ea7e944c115e6f0a34f1b0.png"></div><a name="habracut"></a><br>  Das Volumen der Verarbeitungsdatenbanken in unserem Unternehmen beträgt ca. 6 TB.  Bei einer Kopie der Datenbanken stören sich die Entwickler gegenseitig, sodass der tatsächliche Platzbedarf der Basen schnell und proportional zunimmt.  Obwohl wie schnell ... zu schnell für den Escortservice und nicht schnell genug für diejenigen, die Kopien der Datenbanken benötigen.  Und hier ist warum. <br><br>  Zum Testen ist es erforderlich, dass der Prüfstand vollständig mit der aktuellen Produktionsversion übereinstimmt (dies gilt auch für den Vorproduktionsstand).  Die Hauptsicherung des Systems wird den ganzen Tag kopiert und dann auf dem Stand bereitgestellt.  Während dieser längeren Vorgänge sind keine Stände verfügbar, sodass das Kopieren auf Wochenenden und Feiertage übertragen wird, an denen niemand mit Ständen arbeitet.  Wir bekommen eine Verzögerung von 1 bis 5 Tagen.  Um sich vorab auf den Kopiervorgang selbst zu einigen, braucht es auch Zeit - wir haben mehrere Prüfstände, normalerweise von drei bis sechs.  Wir fügen 2-3 Tage hinzu, um die Standleerlaufzeit zu koordinieren.  Bevor Sie sich zur Genehmigung an den Administrator wenden, befindet sich die Anwendung noch in der Warteschlange.  Insgesamt bekommen wir eine sehr große Verzögerung. <br><br><h2>  Was hat Delphix geholfen? </h2><br>  Was kann den Prozess beschleunigen und Platz sparen?  Datenbankvirtualisierung.  Wir haben verschiedene Optionen in Betracht gezogen: Oracle SnapClone, NetApp + Oracle Cloud, nur Snapshots auf Arrays.  Alles erfordert eine komplexe Einrichtung.  Oracle-Lösungen funktionieren außerdem nur mit Oracle-Datenbanken. <br><br>  Dann sah ich Delphix an.  Es ist einfach zu implementieren und unterstützt verschiedene Datenbanken - Oracle, SQL Server, DB2, Sybase ASE.  Für alle Operationen wird eine Schnittstelle bereitgestellt.  Dadurch können Entwickler und Tester ihre Kopien unabhängig voneinander verwalten - aktualisieren, speichern / wiederherstellen, stoppen / starten usw.  Es gibt auch eine API und eine CLI für die Integration in CI / CD-Systeme oder deren Prozesse. <br><br>  Die Bereitstellung von Delphix selbst dauert nicht lange - mehrere Stunden.  Die Quelle kann viel länger angeschlossen werden, hier ist die Zeit proportional zur Größe.  In unserem Fall war die Quelle eine Verkaufskopie der Datenbank, und die Verbindung dauerte fast einen Tag.  Das Vorbereiten der Quelle und der Server für Datenbankklone erfordert keine besonderen Arbeiten.  Auf dem Zielserver müssen Sie das entsprechende ORACLE_HOME installieren und einen speziellen Benutzer für die Verbindung erstellen.  Für virtuelle Testkopien verwenden wir dieselben Server, auf denen zuvor physische Kopien vorhanden waren. <br><br>  Mit Delphix können Sie Prüfstände in nahezu Echtzeit ohne Koordination erstellen, da die Prüfstände vollständig voneinander isoliert sind.  Einige Zeit wird nur für die Aktualisierung der Datenbank auf den aktuellen Status aufgewendet - von 20 Minuten bis zu mehreren Stunden gibt es keine Frage von Tagen. <br><br>  Wir versuchen, Stresstests unter möglichst produktnahen Bedingungen durchzuführen.  Wenn der Stoß auf physischen Festplatten - dann steht auch die Last.  In diesem Fall hilft die Schaltfläche Delphix V2P, mit der Sie aus einer virtuellen Datenbank eine „ehrliche“ Datenbank erstellen können. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ebc/e68/e50/ebce68e5021b33c29f67bffc947c2f3f.png"><br><br>  Um Speicherplatz zu sparen, täuschen natürlich die Messwerte unseres Delphix-Dashboards - eine 73-fache Reduzierung des Volumens ist zu fabelhaft.  In unserer Verarbeitung belegt eine Kopie des Verkaufs mit täglichen Snapshots und archivierten Transaktionsprotokollen für 2 Wochen (200 GB pro Tag) 4,5 TB Speicherplatz.  Weitere 1,5 TB - neun Klone mit einer Größe von 50 bis 500 GB, in denen jeweils auch die täglichen Schnappschüsse gespeichert sind.  Insgesamt werden 6 TB erhalten. <br><br>  Wir fügen weitere 15% des freien Speicherplatzes (900 GB) hinzu, damit Delphix normal funktioniert.  Wenn wir also nur etwa 7 TB ausgeben, können wir eine Testkopie mit Daten erhalten, die zu jedem Zeitpunkt in den letzten zwei Wochen relevant sind. <br><br>  Zuvor benötigten wir 54 TB (oder ~ 20 TB unter Berücksichtigung der 2-3-fachen Komprimierung des Speichers), um neun physische Kopien der Datenbank in 6 TB zu speichern.  Und im Gegensatz zum neuen System konnten die Entwickler diese Kopien hier nicht verwalten und frühere Zustände wiederherstellen - als die Daten zerstört wurden, war es nur möglich, eine Kopie des Verkaufs neu zu laden. <br><br>  Mit Delphix können Sie auch schnell verschiedene Zweige desselben Containers für verschiedene Projekte erstellen - und das alles in minimaler Zeit.  Entwickler haben keine Angst davor, Daten zu beschädigen. Sie können einen Rollback durchführen und ihren vorherigen Status wiederherstellen.  Dies gibt einen Leistungsschub. <br><br><h2>  Aber es gibt Nuancen ... </h2><br>  Die Eindrücke von Delphix sind überwiegend positiv, obwohl nicht alles perfekt ist.  Das größte Problem ist die Verwendung von Festplatten.  Jeder Datenblock wird nur einmal für alle virtuellen Kopien gespeichert. Bis alle virtuellen Kopien den Block nicht mehr verwenden, kann er nicht gelöscht werden.  Hier können organisatorische Probleme auftreten - nicht alle Benutzer sind bereit, den kurzen Lebenszyklus ihrer Stände zu unterstützen.  Wenn der Prüfstand auf einer alten Kopie lebt, werde ich ihn verkaufen.  Wir lösen dieses Problem umfassend, indem wir die Festplatten erweitern, ohne den Dienst zu unterbrechen.  Wir sorgen dafür, dass immer 15% des freien Speicherplatzes gespart werden.  Wenn es kleiner ist, beendet das System einfach die Ausführung von Vorgängen mit virtuellen Kopien.  Obwohl die Basen selbst verfügbar bleiben. <br><br>  Bei Systemen mit intensiver Festplatten-E / A ist die Netzwerkbandbreite wahrscheinlich ein begrenzender Faktor.  Abhängig vom spezifischen Lastprofil arbeitet das System möglicherweise besser mit der Virtualisierung.  Abhängig von der Auslastung beträgt die durchschnittliche sequentielle Leselatenz der DB-Datei 5-10 ms, was selbst für industrielle Systeme ziemlich gut ist. <br><br>  Delphix "klassische" Laufwerke sind auf eine Weise verbunden, die ESX unterstützt, und der Anbieter hat eine Liste mit Empfehlungen, wie dies mit maximaler Leistung durchgeführt werden kann.  Wir verwenden SAN.  Das System selbst präsentiert die Datenträger, auf denen sich die virtuellen Datenbankdateien befinden, nur über das NFS-Protokoll.  Aus diesem Grund müssen Sie auf die Bandbreite des Kanals und seine Überlastung achten.  In unserem Fall ist es sinnvoll, nur Datendateien für Delphix auf Festplatten-Arrays zu platzieren, damit keine Aktivität in der Bank die E / A-Geschwindigkeit für virtuelle Datenbanken beeinflusst. <br><br>  Jetzt arbeiten wir an Delphix 5.1.9, aber schauen Sie sich Version 5.2 an - darin hat die Benutzeroberfläche den Flash verlassen und ist laut Hersteller viel praktischer geworden.  Delphix hat unsere Kollegen beeindruckt, und nach der Verarbeitung erwägen wir, Profil, CRM und Internetbanking auf dieses Entwicklersystem zu übertragen. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de416815/">https://habr.com/ru/post/de416815/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de416801/index.html">Die Staatsduma hat in erster Lesung einen Gesetzentwurf zur Absage des Roamings verabschiedet</a></li>
<li><a href="../de416805/index.html">Wie verbringe ich Zeit auf einer Geschäftskonferenz, um sie sinnvoll zu nutzen? Tipps von ISPsystem bizdedev</a></li>
<li><a href="../de416807/index.html">Jeffrey Richter kommt in Russland an: Ankündigung der DotNext 2018 Moskauer Konferenz</a></li>
<li><a href="../de416809/index.html">Snooker-Modelle von Elo und EloBet</a></li>
<li><a href="../de416813/index.html">Wenn 2 x 3 = 2 oder noch einmal über Datenvirtualisierung</a></li>
<li><a href="../de416817/index.html">3. Platz in der Qualifikationsphase von DataScienceGame 2018</a></li>
<li><a href="../de416819/index.html">Leb wohl, Microservices: von hundert Problemkindern bis zu einem Superstar</a></li>
<li><a href="../de416821/index.html">Funktionsweise von JS: WebRTC- und P2P-Kommunikation</a></li>
<li><a href="../de416823/index.html">Blut, Schweiß und Pixel: Worum geht es in Jason Schreiers Buch?</a></li>
<li><a href="../de416825/index.html">Wie man NICHT ein mittelmäßiger Entwickler ist</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>