<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ì üï¥üèΩ üë∂üèæ Escrevendo um carregador wasm para Ghidra. Parte 1: Declara√ß√£o do Problema e Configura√ß√£o do Ambiente üèáüèº üë®‚Äçüåæ üî±</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Esta semana, a NSA ( Ag√™ncia de Seguran√ßa Nacional ) de repente fez um presente para a humanidade, abrindo fontes de sua estrutura de engenharia rever...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Escrevendo um carregador wasm para Ghidra. Parte 1: Declara√ß√£o do Problema e Configura√ß√£o do Ambiente</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443318/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/xy/1q/jm/xy1qjmpn0nactzdrq1laun9brhm.png"></div><br>  Esta semana, a NSA ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Ag√™ncia de Seguran√ßa Nacional</a> ) de repente fez um presente para a humanidade, abrindo fontes de sua estrutura de engenharia reversa de software.  Comunidade de engenheiros reversos e especialistas em seguran√ßa com grande entusiasmo come√ßou a explorar o novo brinquedo.  De acordo com o feedback, √© uma ferramenta realmente incr√≠vel, capaz de competir com solu√ß√µes existentes, como IDA Pro, R2 e JEB.  A ferramenta √© chamada Ghidra e os recursos profissionais est√£o cheios de impress√µes dos pesquisadores.  Na verdade, eles tinham um bom motivo: nem todos os dias as organiza√ß√µes governamentais fornecem acesso a suas ferramentas internas.  Eu, como engenheiro reverso profissional e analista de malware, tamb√©m n√£o podia passar.  Decidi passar um fim de semana ou dois e ter uma primeira impress√£o da ferramenta.  Eu havia brincado um pouco com a desmontagem e decidi verificar a extensibilidade da ferramenta.  Nesta s√©rie de artigos, explicarei o desenvolvimento do complemento Ghidra, que carrega um formato personalizado, usado para resolver a tarefa CTF.  Como √© uma estrutura grande e eu escolhi uma tarefa bastante complicada, dividirei o artigo em v√°rias partes. <br><br>  No final desta parte, espero configurar o ambiente de desenvolvimento e criar um m√≥dulo m√≠nimo, capaz de reconhecer o formato do arquivo WebAssembly e sugerir o desmontador correto para process√°-lo. <br><a name="habracut"></a><br>  Vamos come√ßar com a descri√ß√£o da tarefa.  No ano passado, a empresa de seguran√ßa FireEye sediou o concurso CTF, chamado flare-on.  Durante o concurso, os pesquisadores tiveram que resolver doze tarefas, relacionadas √† engenharia reversa.  Uma das tarefas foi pesquisar o aplicativo da Web, constru√≠do com o WebAssembly.  √â um formato execut√°vel relativamente novo e, at√© onde eu sei, n√£o h√° ferramentas perfeitas para lidar com isso.  Durante o desafio, tentei v√°rias ferramentas para derrot√°-lo.  Esses eram scripts simples do github e descompiladores conhecidos, como IDA pro e JEB.  Surpreendentemente, parei no chrome, que fornece um bom desmontador e depurador para o WebAssembly.  Meu objetivo √© resolver o desafio com o ghidra.  Vou descrever o estudo da maneira mais completa poss√≠vel e fornecer todas as informa√ß√µes poss√≠veis para reproduzir meus passos.  Talvez, como pessoa que n√£o tenha muita experi√™ncia com o instrumento, eu possa entrar em alguns detalhes desnecess√°rios, mas √© assim que √©. <br><br>  A tarefa que vou usar para estudo pode ser baixada do <a href="">site de</a> desafio do flareon5.  H√° o arquivo 05_web2point0.7z: arquivo criptografado com uma palavra assustadora <b>infectada</b> .  Existem tr√™s arquivos no arquivo morto: index.html, main.js e test.wasm.  Vamos abrir o arquivo index.html em um navegador e verificar o resultado: <br><br><img src="https://habrastorage.org/webt/5z/o2/fd/5zo2fdf7jjndo2tmhesju4go7io.png"><br><br>  Bem, √© com isso que vou trabalhar.  Vamos come√ßar com o estudo html, especialmente porque √© a parte mais f√°cil do desafio.  O c√≥digo html n√£o cont√©m nada, exceto o carregamento do script main.js. <br><br><pre><code class="javascript hljs">&lt;!DOCTYPE html&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"container"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">span</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"./main.js"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  O script tamb√©m n√£o faz nada complicado, apesar de parecer um pouco mais detalhado.  Ele apenas carrega o arquivo test.wasm e o usa para criar uma inst√¢ncia do WebAssembly.  Em seguida, ele l√™ o par√¢metro "q" do URL e o passa para a correspond√™ncia de m√©todo, exportada pela inst√¢ncia.  Se a string no par√¢metro estiver incorreta, o script mostra a imagem que vimos acima, em termos de desenvolvedores do FireEye chamados "Pile of coc√¥". <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> b = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Uint8Array</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TextEncoder().encode(getParameterByName(<span class="hljs-string"><span class="hljs-string">"q"</span></span>))); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pa = wasm_alloc(instance, <span class="hljs-number"><span class="hljs-number">0x200</span></span>); wasm_write(instance, pa, a); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> pb = wasm_alloc(instance, <span class="hljs-number"><span class="hljs-number">0x200</span></span>); wasm_write(instance, pb, b); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (instance.exports.Match(pa, a.byteLength, pb, b.byteLength) == <span class="hljs-number"><span class="hljs-number">1</span></span>) { <span class="hljs-comment"><span class="hljs-comment">// PARTY POPPER document.getElementById("container").innerText = "√∞≈∏≈Ω‚Ä∞"; } else { // PILE OF POO document.getElementById("container").innerText = "√∞≈∏'"; }</span></span></code> </pre><br>  A solu√ß√£o da tarefa √© encontrar o valor do par√¢metro q que faz a fun√ß√£o "combinar" retornar "Verdadeiro".  Para fazer isso, vou desmontar o arquivo test.wasm e analisar o algoritmo da fun√ß√£o Match. <br><br>  N√£o h√° surpresas, e tentarei fazer isso em Ghidra.  Mas primeiro tenho que instal√°-lo.  A instala√ß√£o pode (e deve) ser baixada em <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">https://ghidra-sre.org/</a> .  Como est√° escrito em Java, quase n√£o h√° requisitos especiais para instala√ß√£o, n√£o requer nenhum esfor√ßo especial para instalar.  Tudo o que voc√™ precisa √© descompactar o arquivo morto e executar o aplicativo.  A √∫nica coisa necess√°ria √© atualizar o JDK e o JRE para a vers√£o 11. <br><br>  Vamos criar um novo projeto ghidra ( <b>Arquivo-&gt; Novo Projeto</b> ) e cham√°-lo de ‚Äúwasm‚Äù / <br><br><img src="https://habrastorage.org/webt/yt/1j/2s/yt1j2sgpytbsoyhsschjdit4v7m.png"><br><br>  Em seguida, adicione ao projeto o arquivo test.wasm ( <b>Arquivo ‚Üí Importar arquivo</b> ) e veja como o ghidra pode lidar com isso. <br><br><img src="https://habrastorage.org/webt/up/wq/jq/upwqjqan-5cooznznqw5pcks-pw.png"><br><br>  Bem, isso n√£o pode fazer nada.  Ele n√£o reconhece o formato e n√£o pode desmontar nada, portanto, √© absolutamente impotente para lidar com esta tarefa.  Finalmente chegamos ao assunto do artigo.  N√£o h√° mais nada a fazer, mas escrever um m√≥dulo, capaz de carregar o arquivo wasm, analis√°-lo e desmontar seu c√≥digo. <br><br>  Antes de tudo, estudei toda a documenta√ß√£o dispon√≠vel.  Na verdade, existe apenas um documento adequado, mostrando o processo de desenvolvimento de complementos: slides GhidraAdvancedDevelopment.  Vou seguir o documento, dando uma descri√ß√£o detalhada. <br><br>  Infelizmente, o desenvolvimento de complementos requer o uso de eclipse.  Toda a minha experi√™ncia com o eclipse √© o desenvolvimento de dois jogos de gdx para o Android em 2012. Foram duas semanas cheias de dor e sofrimento, depois das quais eu o apaguei da minha mente.  Espero que ap√≥s 7 anos de desenvolvimento seja melhor do que costumava ser. <br><br>  Vamos baixar e instalar o eclipse no <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">site</a> oficial. <br><br>  Em seguida, instale a extens√£o para o desenvolvimento ghidra: <br><br>  Ir para o eclipse <b>Ajuda ‚Üí</b> menu <b>Instalar Novo Software</b> , clique no bot√£o <b>Adicionar</b> e escolha GhidraDev.zip em / Extensions / Eclipse / GhidraDev /.  Instale e reinicie a extens√£o.  A extens√£o, adiciona modelos ao novo menu do projeto, permite depurar m√≥dulos do eclipse e compilar o m√≥dulo no pacote de distribui√ß√£o. <br><br>  Conforme segue nos documentos dos desenvolvedores, as seguintes etapas devem ser executadas para adicionar o m√≥dulo ao processamento do novo formato bin√°rio: <br><br><ul><li>  Crie classes, descrevendo estruturas de dados </li><li>  Desenvolva o carregador.  O carregador deve ser herdado da classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AbstractLibrarySupportLoader</a> .  Ele l√™ todos os dados necess√°rios do arquivo, verifica a integridade dos dados e converte os dados bin√°rios em representa√ß√£o interna, preparando-os para an√°lise <br></li><li>  Desenvolva o analisador.  O analisador √© herdado da classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">AbstractAnalyzer</a> .  Ele pega as estruturas de dados preparadas pelo carregador e as anota (n√£o tenho muita certeza do que isso significa, mas espero entender durante o desenvolvimento) <br></li><li>  Adicione processador.  Ghidra tem uma abstra√ß√£o: Processador.  Ele foi escrito em linguagem declarativa interna e descreve o conjunto de instru√ß√µes, o layout da mem√≥ria e outros recursos arquitet√¥nicos.  Vou abordar este t√≥pico, escrevendo o desmontador. <br></li></ul><br>  Agora, quando tivermos toda a teoria necess√°ria, √© hora de criar o projeto do m√≥dulo.  Gra√ßas √† extens√£o eclipse GhidraDev instalada anteriormente, temos o modelo do m√≥dulo no menu <b>Arquivo-&gt; Novo projeto</b> . <br><br><img src="https://habrastorage.org/webt/ir/z3/77/irz377yf_rcsginnfb-e8-ee-ga.png"><br><br>  O Assistente pergunta quais componentes s√£o necess√°rios.  Como foi descrito anteriormente, precisar√≠amos de dois deles: carregador e analisador. <br><br><img src="https://habrastorage.org/webt/vf/cc/j1/vfccj1djknkxefjuc1bg9pysycs.png"><br><br>  O assistente cria o esqueleto do projeto com todas as partes necess√°rias: analisador em branco no arquivo WasmAnalyzer.java, carregador em branco no arquivo WasmLoader.java e esqueleto do idioma no diret√≥rio / data / languages. <br><br><img src="https://habrastorage.org/webt/bu/3q/uw/bu3quwuupe-0heogbta81hrub7c.png"><br><br>  Vamos come√ßar com o carregador.  Como foi mencionado, ele deve ser herdado da classe AbstractLibrarySupportLoader e possui tr√™s m√©todos a serem sobrecarregados: <br><br><ul><li>  getName - este m√©todo deve ser o nome interno do carregador.  O Ghidra usa-o em v√°rios lugares, por exemplo, para ligar o carregador ao processador </li><li>  findSupportedLoadSpecs - retorno de chamada, executado, quando o usu√°rio escolhe o arquivo a ser importado.  Nesse carregador de retorno de chamada, voc√™ deve decidir se √© capaz de processar o arquivo e retornar a inst√¢ncia da classe LoadSpec, informando ao usu√°rio como o arquivo pode ser processado. </li><li>  load - retorno de chamada, executado, ap√≥s o arquivo carregado pelo usu√°rio.  Nesse m√©todo, o carregador analisa a estrutura do arquivo e carrega no ghidra.  O descrever√° em mais detalhes no pr√≥ximo artigo </li></ul><br>  O primeiro e o m√©todo mais simples √© getName, apenas retorna o nome do carregador <br><br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"WebAssembly"</span></span>; }</code> </pre><br>  O segundo m√©todo a ser implementado √© o findSupportedLoadSpecs.  √â chamado por ferramenta durante a importa√ß√£o do arquivo e deve verificar se o carregador √© capaz de processar o arquivo.  Se seu m√©todo puder retornar o objeto da classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">LoadSpec</a> , informando qual objeto √© usado para carregar o arquivo e qual processador desmontar√° seu c√≥digo. <br><br>  O m√©todo come√ßa na verifica√ß√£o do formato.  Conforme segue a <a href="">especifica√ß√£o</a> , os primeiros oito bytes do arquivo wasm devem ser a assinatura ‚Äú\ 0asm‚Äù e a vers√£o. <br><br>  Para analisar o cabe√ßalho, criei a classe WasmHeader, implementando a interface <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">StructConverter</a> , que √© a interface base para descrever dados estruturados.  O construtor do WasmHeader recebe o objeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BinaryReader</a> - abstra√ß√£o, usado para ler dados da fonte bin√°ria sendo analisada.  O construtor usa para ler o cabe√ßalho do arquivo de entrada <br><br><pre> <code class="java hljs"> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] magic; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span> [] version; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WasmHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BinaryReader reader)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ magic = reader.readNextByteArray(WASM_MAGIC_BASE.length()); version = reader.readNextByteArray(WASM_VERSION_LENGTH); }</code> </pre><br>  O Loader usa esse objeto para verificar a assinatura do arquivo.  Em seguida, em caso de sucesso, procure o processador apropriado.  Ele chama a consulta de m√©todo da classe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">QueryOpinionService</a> e passa o nome do carregador ("Webassembly").  O OpinionService est√° procurando pelo processador associado a esse carregador e o devolve. <br><br><pre> <code class="java hljs">List&lt;QueryResult&gt; queries = QueryOpinionService.query(getName(), MACHINE, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>);</code> </pre><br>  Certamente, ele n√£o retorna nada, porque o ghidra n√£o conhece o processador, chamado WebAssembly, e √© necess√°rio defini-lo.  Como eu disse antes, o assistente criou o esqueleto do idioma no diret√≥rio data / languages. <br><br><img src="https://habrastorage.org/webt/ck/hq/0d/ckhq0d4gena4dbalhjufpwv9kbs.png"><br><br>  No est√°gio atual, existem dois arquivos que podem ser interessantes: Webassembly.opinion e Wbassembly.ldefs.  O arquivo .opinon define a correspond√™ncia entre o carregador e o processador. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">opinions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">loader</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"WebAssembly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">compilerSpecID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">primary</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">constraint</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">opinions</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Ele cont√©m xml simples com poucos atributos.  √â necess√°rio definir o nome do carregador para atribuir "carregador" e o nome do processador no atributo "processador", ambos s√£o "Webassembly".  Nesta etapa, preencherei outros par√¢metros com os valores aleat√≥rios.  Assim que souber mais sobre a arquitetura do processador Webassembly, vou alter√°-los para corrigir os valores. <br><br>  O arquivo .ldefs descreve os recursos do processador, que devem executar o c√≥digo do arquivo. <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language_definitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">endian</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"little"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"16"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">variant</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">slafile</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly.sla"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">processorspec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly.pspec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wasm:LE:16:default"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Webassembly Language Module<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">compiler</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">spec</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Webassembly.cspec"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"default"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">language_definitions</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  O atributo "processador" deve ser o mesmo que o processador de atributo do arquivo .opinion.  Vamos deixar outros campos intocados.  Mas lembre-se da pr√≥xima vez que √© poss√≠vel definir a densidade do registro (atributo "tamanho"), arquivo que descreve a arquitetura do processador "processorspec" e o arquivo, contendo a descri√ß√£o do c√≥digo na linguagem declarativa especial "slafile".  Ser√° √∫til trabalhar na desmontagem. <br><br>  Agora, √© hora de voltar ao carregador e retornar as especifica√ß√µes do carregador. <br><br>  Est√° tudo pronto para o teste.  O plug-in para GhidraDev adicionou a op√ß√£o de execu√ß√£o " <b>Executar ‚Üí Executar como ‚Üí Ghidra</b> " ao eclipse: <br><br><img src="https://habrastorage.org/webt/j5/z-/ft/j5z-ft7xxiy1equy99ahzrt6d7a.png"><br><br>  Ele executa o ghidra no modo de depura√ß√£o e implanta o m√≥dulo, oferecendo uma grande oportunidade de trabalhar com a ferramenta e, ao mesmo tempo, usar o depurador para corrigir erros no m√≥dulo que est√° sendo desenvolvido.  Mas, neste est√°gio simples, n√£o h√° raz√£o para usar um depurador.  Como antes, vou criar um novo projeto, importar arquivo e ver se meus esfor√ßos valeram a pena.  Diferentemente da √∫ltima vez, o arquivo √© reconhecido como WebAssembly e o carregador prop√µe o processador correspondente para ele.  Isso significa que tudo funciona e meu m√≥dulo √© capaz de reconhecer o formato. <br><br><img src="https://habrastorage.org/webt/zs/np/vd/zsnpvdvzqx5ecg7xdlz86dzres0.png"><br><br>  No pr√≥ximo artigo, estenderei o carregador e o farei n√£o apenas reconhecer, mas tamb√©m descrever a estrutura do arquivo wasm.  Acho que, nesta fase, depois que o ambiente for configurado, ser√° f√°cil fazer isso. <br><br>  O c√≥digo do m√≥dulo est√° dispon√≠vel no reposit√≥rio do <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">github</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt443318/">https://habr.com/ru/post/pt443318/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt443306/index.html">Oito leis de nomenclatura no design de UX (parte 1)</a></li>
<li><a href="../pt443308/index.html">Mitos da f√≠sica moderna. Leis de conserva√ß√£o</a></li>
<li><a href="../pt443310/index.html">Revis√£o do gadget de bem-estar feminino Bellabeat</a></li>
<li><a href="../pt443312/index.html">Gerenciamento de mem√≥ria Python</a></li>
<li><a href="../pt443314/index.html">O que √© cordentidade? [Tradu√ß√£o do artigo]</a></li>
<li><a href="../pt443320/index.html">Sistema de gerenciamento eletr√¥nico de documentos "Vizier"</a></li>
<li><a href="../pt443322/index.html">GitLab 11.8 lan√ßado com SAST para JavaScript, p√°ginas GitLab para subgrupos e rastreamento de erros</a></li>
<li><a href="../pt443324/index.html">Python vs. Scala para Apache Spark - benchmark esperado com resultado inesperado</a></li>
<li><a href="../pt443326/index.html">Python e Arduino. Simples, r√°pido e bonito</a></li>
<li><a href="../pt443330/index.html">Semana da Seguran√ßa 11: RSA 2019 e um futuro melhor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>