<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯжБ ЁЯзШ ЁЯМУ Kubernetes рдореЗрдВ Seccomp: 7 рдЪреАрдЬреЗрдВ рдЬреЛ рдЖрдкрдХреЛ рд╢реБрд░реБрдЖрдд рд╕реЗ рдЬрд╛рдирдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИрдВ ЁЯЪЗ ЁЯО╗ ЁЯУЗ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рд▓рдЧрднрдЧред рдЯреНрд░рд╛рдВрд╕ред : рдмреНрд░рд┐рдЯрд┐рд╢ рдХрдВрдкрдиреА ASOS.com рдореЗрдВ рдПрдХ рд╡рд░рд┐рд╖реНрда рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╕реБрд░рдХреНрд╖рд╛ рдЗрдВрдЬреАрдирд┐рдпрд░ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдкреНрд░рд╕реНрддреБрдд рдХрд░рдирд╛ред рдЙрд╕рдХреЗ рд╕рд╛рде, рд╡рд╣ рд╕реЗрдХрдВрдбрдкреИрдХ рдХреЗ рдЙрдкрдпреЛрдЧ ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kubernetes рдореЗрдВ Seccomp: 7 рдЪреАрдЬреЗрдВ рдЬреЛ рдЖрдкрдХреЛ рд╢реБрд░реБрдЖрдд рд╕реЗ рдЬрд╛рдирдиреЗ рдХреА рдЬрд░реВрд░рдд рд╣реИрдВ</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/flant/blog/481114/"> <i><b>рд▓рдЧрднрдЧред</b></i>  <i><b>рдЯреНрд░рд╛рдВрд╕ред</b></i>  <i>: рдмреНрд░рд┐рдЯрд┐рд╢ рдХрдВрдкрдиреА ASOS.com рдореЗрдВ рдПрдХ рд╡рд░рд┐рд╖реНрда рдЕрдиреБрдкреНрд░рдпреЛрдЧ рд╕реБрд░рдХреНрд╖рд╛ рдЗрдВрдЬреАрдирд┐рдпрд░ рджреНрд╡рд╛рд░рд╛ рдПрдХ рд▓реЗрдЦ рдХрд╛ рдЕрдиреБрд╡рд╛рдж рдкреНрд░рд╕реНрддреБрдд рдХрд░рдирд╛ред</i>  <i>рдЙрд╕рдХреЗ рд╕рд╛рде, рд╡рд╣ рд╕реЗрдХрдВрдбрдкреИрдХ рдХреЗ рдЙрдкрдпреЛрдЧ рдХреЗ рдорд╛рдзреНрдпрдо рд╕реЗ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рд╕реБрдзрд╛рд░ рдкрд░ рдкреНрд░рдХрд╛рд╢рдиреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╢реБрд░реВ рдХрд░рддрд╛ рд╣реИред</i>  <i>рдЕрдЧрд░ рдкрд╛рдардХреЛрдВ рдХреЛ рдкрд░рд┐рдЪрдп рдкрд╕рдВрдж рд╣реИ, рддреЛ рд╣рдо рд▓реЗрдЦрдХ рдХрд╛ рдЕрдиреБрд╕рд░рдг рдХрд░реЗрдВрдЧреЗ рдФрд░ рдЗрд╕ рд╡рд┐рд╖рдп рдкрд░ рдЕрдкрдиреА рднрд╡рд┐рд╖реНрдп рдХреА рд╕рд╛рдордЧреНрд░реА рдЬрд╛рд░реА рд░рдЦреЗрдВрдЧреЗред</i> <br><br><img src="https://habrastorage.org/webt/-u/nv/vk/-unvvkiylrs9ucbym-l4bsobtr8.png"><br><br>  рдпрд╣ рд▓реЗрдЦ рдЬрд╛рджреВ рдФрд░ рдЬрд╛рджреВ рдЯреЛрдирд╛ рдХрд╛ рд╕рд╣рд╛рд░рд╛ рд▓рд┐рдП рдмрд┐рдирд╛ SecDevOps рдХреА рднрд╛рд╡рдирд╛ рдореЗрдВ рд╕реЗрдХрдВрдб рдкреНрд░реЛрдлрд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдкреНрд░рдХрд╛рд╢рдиреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рд╣реИред  рдкрд╣рд▓реЗ рднрд╛рдЧ рдореЗрдВ, рдореИрдВ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ seccomp рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреА рдореВрд▓ рдмрд╛рддреЗрдВ рдФрд░ рдЖрдВрддрд░рд┐рдХ рд╡рд┐рд╡рд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░реВрдВрдЧрд╛ред <br><br>  рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдкрд╛рд░рд┐рд╕реНрдерд┐рддрд┐рдХреА рддрдВрддреНрд░ рдХрдВрдЯреЗрдирд░ рд╕реБрд░рдХреНрд╖рд╛ рдФрд░ рдЕрд▓рдЧрд╛рд╡ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрдИ рддрд░рд╣ рдХреЗ рддрд░реАрдХреЗ рдкреНрд░рджрд╛рди рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рд▓реЗрдЦ рд╕рд┐рдХреНрдпреЛрд░ рдХрдореНрдкреНрдпреВрдЯрд┐рдВрдЧ рдореЛрдб рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╣реИ, рдЬрд┐рд╕реЗ <b>seccomp рдХреЗ</b> рд░реВрдк рдореЗрдВ рднреА рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред  рдЗрд╕рдХрд╛ рд╕рд╛рд░ рдХрдВрдЯреЗрдирд░ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рдлрд╝рд┐рд▓реНрдЯрд░рд┐рдВрдЧ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдореЗрдВ рдирд┐рд╣рд┐рдд рд╣реИред <a name="habracut"></a><br><br>  рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рдХреНрдпреЛрдВ рд╣реИ?  рдПрдХ рдХрдВрдЯреЗрдирд░ рдПрдХ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдорд╢реАрди рдкрд░ рдЪрд▓рдиреЗ рд╡рд╛рд▓реА рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╣реИред  рдФрд░ рдпрд╣ рдХрд░реНрдиреЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЕрдиреНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдмрд░рд╛рдмрд░ рдХрд░рддрд╛ рд╣реИред  рдпрджрд┐ рдХрдВрдЯреЗрдирд░ рдХреЛрдИ рднреА рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рддреЛ рдмрд╣реБрдд рдЬрд▓реНрдж рдорд╛рд▓рд╡реЗрдпрд░ рдЗрд╕рдХрд╛ рдлрд╛рдпрджрд╛ рдЙрдард╛рдХрд░ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрд▓рдЧрд╛рд╡ рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░ рджреЗрдЧрд╛ рдФрд░ рдЕрдиреНрдп рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдХрд░реЗрдЧрд╛: рдЗрдВрдЯрд░рд╕реЗрдкреНрдЯ рдЬрд╛рдирдХрд╛рд░реА, рд╕рд┐рд╕реНрдЯрдо рд╕реЗрдЯрд┐рдВрдЧреНрд╕ рдХреЛ рдмрджрд▓рдирд╛ рдЖрджрд┐ред <br><br>  Seccomp рдкреНрд░реЛрдлрд╛рдЗрд▓ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддреА рд╣реИ рдХрд┐ рдХрд┐рд╕ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреА рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдП рдпрд╛ рдЙрд╕реЗ рдЕрд╕реНрд╡реАрдХреГрдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред  рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рд▓реЙрдиреНрдЪ рдХреЗ рджреМрд░рд╛рди рдЙрдиреНрд╣реЗрдВ рд╕рдХреНрд░рд┐рдп рдХрд░рддрд╛ рд╣реИ, рддрд╛рдХрд┐ рдХрд░реНрдиреЗрд▓ рдЙрдирдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рдирд┐рдпрдВрддреНрд░рд┐рдд рдХрд░ рд╕рдХреЗред  рдРрд╕реЗ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдЖрдкрдХреЛ рд╣рдорд▓реЗ рдХреЗ рд╡реЗрдХреНрдЯрд░ рдХреЛ рд╕реАрдорд┐рдд рдХрд░рдиреЗ рдФрд░ рдХреНрд╖рддрд┐ рдХреЛ рдХрдо рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдпрджрд┐ рдХрдВрдЯреЗрдирд░ рдХреЗ рдЕрдВрджрд░ рдХреЛрдИ рднреА рдХрд╛рд░реНрдпрдХреНрд░рдо (рдпрд╛рдиреА, рдЖрдкрдХреА рдирд┐рд░реНрднрд░рддрд╛рдПрдВ, рдпрд╛ рдЙрдирдХреА рдирд┐рд░реНрднрд░рддрд╛рдПрдВ) рдРрд╕рд╛ рдХрд░рдиреЗ рд▓рдЧрддреА рд╣реИрдВ рдЬреЛ рдЗрд╕реЗ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рд╣реИред <br><br><h2>  рдореВрд▓ рдмрд╛рддреЗрдВ рд╕рдордЭрдирд╛ </h2><br>  Seccomp рдмреЗрд╕ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдореЗрдВ рддреАрди рддрддреНрд╡ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ: <code>defaultAction</code> , <code>architectures</code> (рдпрд╛ <code>archMap</code> ) рдФрд░ <code>syscalls</code> : <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"defaultAction"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCMP_ACT_ERRNO"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"architectures"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"SCMP_ARCH_X86_64"</span></span>, <span class="hljs-string"><span class="hljs-string">"SCMP_ARCH_X86"</span></span>, <span class="hljs-string"><span class="hljs-string">"SCMP_ARCH_X32"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"syscalls"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"names"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"arch_prctl"</span></span>, <span class="hljs-string"><span class="hljs-string">"sched_yield"</span></span>, <span class="hljs-string"><span class="hljs-string">"futex"</span></span>, <span class="hljs-string"><span class="hljs-string">"write"</span></span>, <span class="hljs-string"><span class="hljs-string">"mmap"</span></span>, <span class="hljs-string"><span class="hljs-string">"exit_group"</span></span>, <span class="hljs-string"><span class="hljs-string">"madvise"</span></span>, <span class="hljs-string"><span class="hljs-string">"rt_sigprocmask"</span></span>, <span class="hljs-string"><span class="hljs-string">"getpid"</span></span>, <span class="hljs-string"><span class="hljs-string">"gettid"</span></span>, <span class="hljs-string"><span class="hljs-string">"tgkill"</span></span>, <span class="hljs-string"><span class="hljs-string">"rt_sigaction"</span></span>, <span class="hljs-string"><span class="hljs-string">"read"</span></span>, <span class="hljs-string"><span class="hljs-string">"getpgrp"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"action"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCMP_ACT_ALLOW"</span></span> } ] }</code> </pre> <br>  <i>( <a href="https://gist.github.com/pjbgf/ef974f57693bb193f39e8add8a7040d7">рдордзреНрдпрдо-рдореВрд▓- seccomp.json</a> )</i> <br><br>  <code>defaultAction</code> <code>syscalls</code> рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд┐рд╕реА рднреА рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреЗ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рднрд╛рдЧреНрдп рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рддрд╛ рд╣реИред  рдХрд╛рд░реНрдп рдХреЛ рд╕рд░рд▓ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП, рд╣рдо рджреЛ рдореБрдЦреНрдп рдореВрд▓реНрдпреЛрдВ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рддреЗ рд╣реИрдВ рдЬрд┐рдирдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛: <br><br><ul><li>  <code>SCMP_ACT_ERRNO</code> - рдПрдХ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреЗ рдирд┐рд╖реНрдкрд╛рджрди рдХреЛ рд░реЛрдХрддрд╛ рд╣реИ, </li><li>  <code>SCMP_ACT_ALLOW</code> - рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИред </li></ul><br>  <code>architectures</code> рдЕрдиреБрднрд╛рдЧ рд▓рдХреНрд╖реНрдп рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИред  рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ, рдЪреВрдВрдХрд┐ рдХрд░реНрдиреЗрд▓ рд╕реНрддрд░ рдкрд░ рд▓рд╛рдЧреВ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдлрд╝рд┐рд▓реНрдЯрд░ рд╕реНрд╡рдпрдВ, рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреЗ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛рдУрдВ рдкрд░ рдирд┐рд░реНрднрд░ рдХрд░рддрд╛ рд╣реИ, рди рдХрд┐ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдкрдВрдЬреАрдХреГрдд рдЙрдирдХреЗ рдирд╛рдореЛрдВ рдкрд░ред  рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ, рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдЙрдиреНрд╣реЗрдВ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛рдУрдВ рдХреЛ рдореИрдк рдХрд░рддрд╛ рд╣реИред  рдореБрджреНрджрд╛ рдпрд╣ рд╣реИ рдХрд┐ рд╕рд┐рд╕реНрдЯрдо рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдореЗрдВ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдЕрд▓рдЧ рдЖрдИрдбреА рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>recvfrom</code> рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ (рд╕реЙрдХреЗрдЯ рд╕реЗ рдЬрд╛рдирдХрд╛рд░реА рдкреНрд░рд╛рдкреНрдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ) рдореЗрдВ x64 рд╕рд┐рд╕реНрдЯрдо рдкрд░ ID = 64 рдФрд░ x86 рдкрд░ ID = 517 рд╣реИред  <a href="">рдпрд╣рд╛рдВ</a> рдЖрдк x86-x64 рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░ рдХреЗ рд▓рд┐рдП рд╕рднреА рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреА рд╕реВрдЪреА рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  <code>syscalls</code> рдЕрдиреБрднрд╛рдЧ рд╕рднреА рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреЛ рд╕реВрдЪреАрдмрджреНрдз рдХрд░рддрд╛ рд╣реИ рдФрд░ рдЗрдВрдЧрд┐рдд рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЙрдирдХреЗ рд╕рд╛рде рдХреНрдпрд╛ рдХрд░рдирд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЖрдк <code>defaultAction</code> рдкрд░ <code>SCMP_ACT_ERRNO</code> рдХреЛ рд╕реЗрдЯ рдХрд░рдХреЗ рдПрдХ рд╢реНрд╡реЗрддрд╕реВрдЪреА рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ <code>syscalls</code> рдХреЛ <code>syscalls</code> рдЕрдиреБрднрд╛рдЧ рдкрд░ рдХреЙрд▓ рдЕрд╕рд╛рдЗрди рдХрд░ <code>SCMP_ACT_ALLOW</code> ред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рдЖрдк рдХреЗрд╡рд▓ <code>syscalls</code> рдЕрдиреБрднрд╛рдЧ рдореЗрдВ рдкрдВрдЬреАрдХреГрдд рдХреЙрд▓ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддреЗ рд╣реИрдВ рдФрд░ рдЕрдиреНрдп рд╕рднреА рдХреЛ рдкреНрд░рддрд┐рдмрдВрдзрд┐рдд рдХрд░рддреЗ рд╣реИрдВред  рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ <code>defaultAction</code> рдорд╛рди рдФрд░ рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╡рд┐рдкрд░реАрдд рдореЗрдВ рдмрджрд▓рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br>  рдЕрдм рдХреБрдЫ рд╢рдмреНрджреЛрдВ рдХреЛ рдмрд╛рд░реАрдХрд┐рдпреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХрд╣рд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдП рдЬреЛ рдЗрддрдиреЗ рд╕реНрдкрд╖реНрдЯ рдирд╣реАрдВ рд╣реИрдВред  рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдиреАрдЪреЗ рджреА рдЧрдИ рд╕рд┐рдлрд╛рд░рд┐рд╢реЗрдВ рдЗрд╕ рддрдереНрдп рд╕реЗ рдЖрддреА рд╣реИрдВ рдХрд┐ рдЖрдк рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреА рдПрдХ рдкрдВрдХреНрддрд┐ рдХреЛ рддреИрдирд╛рдд рдХрд░ рд░рд╣реЗ рд╣реИрдВ рдФрд░ рдЖрдкрдХреЗ рд▓рд┐рдП рдпрд╣ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдХрд┐ рд╡реЗ рдХрдо рд╕реЗ рдХрдо рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░реЗрдВред <br><br><h2>  1. AllowPrivilegeEscalation = false </h2><br>  рдХрдВрдЯреЗрдирд░ рдХреЗ <code>securityContext</code> рдореЗрдВ <code>AllowPrivilegeEscalation</code> рдкреИрд░рд╛рдореАрдЯрд░ рд╣реИред  рдпрджрд┐ рдЗрд╕реЗ <code>false</code> рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ <code>false</code> , рддреЛ рдХрдВрдЯреЗрдирд░ <a href="https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt"><code>no_new_priv</code></a> рдмрд┐рдЯ рд╕реЗ ( <code>on</code> ) рд╕реЗрдЯ рд╣реЛ <a href="https://www.kernel.org/doc/Documentation/prctl/no_new_privs.txt"><code>no_new_priv</code></a> ред  рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЕрд░реНрде рдирд╛рдо рд╕реЗ рд╕реНрдкрд╖реНрдЯ рд╣реИ: рдпрд╣ рдХрдВрдЯреЗрдирд░ рдХреЛ рдЙрди рд╡рд┐рд╢реЗрд╖рд╛рдзрд┐рдХрд╛рд░реЛрдВ рдХреЗ рд╕рд╛рде рдирдИ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рдирд╣реАрдВ рджреЗрддрд╛ рд╣реИ рдЬреЛ рдЗрд╕рдХреЗ рдкрд╛рд╕ рд╣реИред <br><br>  <code>true</code> (рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдорд╛рди) рдХреЗ рд▓рд┐рдП рд╕реЗрдЯ рдХрд┐рдП рдЧрдП рдЗрд╕ рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдПрдХ рд╕рд╛рдЗрдб рдЗрдлреЗрдХреНрдЯ рдпрд╣ рд╣реИ рдХрд┐ рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рд╕реНрдЯрд╛рд░реНрдЯрдЕрдк рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреА рд╢реБрд░реБрдЖрдд рдореЗрдВ seccomp рдкреНрд░реЛрдлрд╛рдЗрд▓ рдкрд░ рд▓рд╛рдЧреВ рд╣реЛрддрд╛ рд╣реИред  рдЗрд╕ рдкреНрд░рдХрд╛рд░, рд╕рднреА рд╕рд┐рд╕реНрдЯрдо рд░рдирдЯрд╛рдЗрдо рдХреА рдЖрдВрддрд░рд┐рдХ рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рд╢реБрд░реВ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛ / рд╕рдореВрд╣ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреЗ рд╡рд╛рд▓реЗ, рдХреБрдЫ рдХреНрд╖рдорддрд╛рдУрдВ рдХреЛ рдЫреЛрдбрд╝рдиреЗ) рдХреЛ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЕрдиреБрдорддрд┐ рджреА рдЬрд╛рдиреА рдЪрд╛рд╣рд┐рдПред <br><br>  рдХрдВрдЯреЗрдирд░ рдЬреЛ рдмреИрдВрдХреЛ <code>echo hi</code> рдХрд░рддрд╛ рд╣реИ рдЙрд╕реЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЕрдиреБрдорддрд┐рдпреЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"defaultAction"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCMP_ACT_ERRNO"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"architectures"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"SCMP_ARCH_X86_64"</span></span>, <span class="hljs-string"><span class="hljs-string">"SCMP_ARCH_X86"</span></span>, <span class="hljs-string"><span class="hljs-string">"SCMP_ARCH_X32"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"syscalls"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"names"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"arch_prctl"</span></span>, <span class="hljs-string"><span class="hljs-string">"brk"</span></span>, <span class="hljs-string"><span class="hljs-string">"capget"</span></span>, <span class="hljs-string"><span class="hljs-string">"capset"</span></span>, <span class="hljs-string"><span class="hljs-string">"chdir"</span></span>, <span class="hljs-string"><span class="hljs-string">"close"</span></span>, <span class="hljs-string"><span class="hljs-string">"execve"</span></span>, <span class="hljs-string"><span class="hljs-string">"exit_group"</span></span>, <span class="hljs-string"><span class="hljs-string">"fstat"</span></span>, <span class="hljs-string"><span class="hljs-string">"fstatfs"</span></span>, <span class="hljs-string"><span class="hljs-string">"futex"</span></span>, <span class="hljs-string"><span class="hljs-string">"getdents64"</span></span>, <span class="hljs-string"><span class="hljs-string">"getppid"</span></span>, <span class="hljs-string"><span class="hljs-string">"lstat"</span></span>, <span class="hljs-string"><span class="hljs-string">"mprotect"</span></span>, <span class="hljs-string"><span class="hljs-string">"nanosleep"</span></span>, <span class="hljs-string"><span class="hljs-string">"newfstatat"</span></span>, <span class="hljs-string"><span class="hljs-string">"openat"</span></span>, <span class="hljs-string"><span class="hljs-string">"prctl"</span></span>, <span class="hljs-string"><span class="hljs-string">"read"</span></span>, <span class="hljs-string"><span class="hljs-string">"rt_sigaction"</span></span>, <span class="hljs-string"><span class="hljs-string">"statfs"</span></span>, <span class="hljs-string"><span class="hljs-string">"setgid"</span></span>, <span class="hljs-string"><span class="hljs-string">"setgroups"</span></span>, <span class="hljs-string"><span class="hljs-string">"setuid"</span></span>, <span class="hljs-string"><span class="hljs-string">"stat"</span></span>, <span class="hljs-string"><span class="hljs-string">"uname"</span></span>, <span class="hljs-string"><span class="hljs-string">"write"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"action"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCMP_ACT_ALLOW"</span></span> } ] }</code> </pre> <br>  <i>( <a href="https://gist.github.com/pjbgf/018658f1aeea1ef696b451bde8c33a8f">рд╣рд╛рдп-рдкреЙрдб- seccomp.json</a> )</i> <br><br>  ... рдЗрдирдХреЗ рдмрдЬрд╛рдп: <br><br><pre> <code class="json hljs">{ <span class="hljs-attr"><span class="hljs-attr">"defaultAction"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCMP_ACT_ERRNO"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"architectures"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"SCMP_ARCH_X86_64"</span></span>, <span class="hljs-string"><span class="hljs-string">"SCMP_ARCH_X86"</span></span>, <span class="hljs-string"><span class="hljs-string">"SCMP_ARCH_X32"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"syscalls"</span></span>: [ { <span class="hljs-attr"><span class="hljs-attr">"names"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"arch_prctl"</span></span>, <span class="hljs-string"><span class="hljs-string">"brk"</span></span>, <span class="hljs-string"><span class="hljs-string">"close"</span></span>, <span class="hljs-string"><span class="hljs-string">"execve"</span></span>, <span class="hljs-string"><span class="hljs-string">"exit_group"</span></span>, <span class="hljs-string"><span class="hljs-string">"futex"</span></span>, <span class="hljs-string"><span class="hljs-string">"mprotect"</span></span>, <span class="hljs-string"><span class="hljs-string">"nanosleep"</span></span>, <span class="hljs-string"><span class="hljs-string">"stat"</span></span>, <span class="hljs-string"><span class="hljs-string">"write"</span></span> ], <span class="hljs-attr"><span class="hljs-attr">"action"</span></span>: <span class="hljs-string"><span class="hljs-string">"SCMP_ACT_ALLOW"</span></span> } ] }</code> </pre> <br>  <i>( <a href="https://gist.github.com/pjbgf/7c860ad818e3724d65a96ffdae5da808">рд╣рд╛рдп-рдХрдВрдЯреЗрдирд░- seccomp.json</a> )</i> <br><br>  рд▓реЗрдХрд┐рди рдлрд┐рд░, рдпрд╣ рдПрдХ рд╕рдорд╕реНрдпрд╛ рдХреНрдпреЛрдВ рд╣реИ?  рд╡реНрдпрдХреНрддрд┐рдЧрдд рд░реВрдк рд╕реЗ, рдореИрдВ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреЛ <code>capset</code> (рдпрджрд┐ рдЙрдиреНрд╣реЗрдВ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЬрд╝рд░реВрд░рдд рдирд╣реАрдВ рд╣реИ): <code>capset</code> , <code>set_tid_address</code> , <code>setgid</code> , <code>setgroups</code> рдФрд░ <code>setuid</code> ред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдХрдард┐рдирд╛рдИ рдпрд╣ рд╣реИ рдХрд┐ рдРрд╕реА рдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдиреЗ рд╕реЗ рдЬрд┐рдирдХрд╛ рдЖрдк рдкрд░ рдХреЛрдИ рдирд┐рдпрдВрддреНрд░рдг рдирд╣реАрдВ рд╣реИ, рдЖрдк рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдХреЗ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХреЛ рдмрд╛рдВрдзрддреЗ рд╣реИрдВред  рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдПрдХ рджрд┐рди рдЖрдк рдкрд╛ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдХрдВрдЯреЗрдирд░ рдХреЗ рд░рдирдЯрд╛рдЗрдо рд╡рд╛рддрд╛рд╡рд░рдг (рдЖрдкрдХреЗ рджреНрд╡рд╛рд░рд╛ рдпрд╛ рдЕрдзрд┐рдХ рд╕рдВрднрд╛рд╡рдирд╛, рдХреНрд▓рд╛рдЙрдб рд╕реЗрд╡рд╛ рдкреНрд░рджрд╛рддрд╛ рджреНрд╡рд╛рд░рд╛) рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдХрдВрдЯреЗрдирд░ рдЕрдЪрд╛рдирдХ рдмрдВрдж рдХрд░рдирд╛ рд╢реБрд░реВ рдХрд░ рджреЗрддреЗ рд╣реИрдВред <br><br>  <b>рдЯрд┐рдк # 1</b> : <code>AllowPrivilegeEscaltion=false</code> рд╕рд╛рде рдХрдВрдЯреЗрдирд░ рдЪрд▓рд╛рдПрдБред  рдпрд╣ seccomp рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рдХрдо рдХрд░реЗрдЧрд╛ рдФрд░ рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рдореЗрдВ рдмрджрд▓рд╛рд╡ рдХреЗ рд▓рд┐рдП рдЙрдиреНрд╣реЗрдВ рдХрдо рд╕рдВрд╡реЗрджрдирд╢реАрд▓ рдмрдирд╛ рджреЗрдЧрд╛ред <br><br><h2>  2. рдХрдВрдЯреЗрдирд░-рд╕реНрддрд░ рд╕реЗрдХрдВрдб рдкреНрд░реЛрдлрд╛рдЗрд▓ рд╕реНрдерд╛рдкрд┐рдд рдХрд░рдирд╛ </h2><br>  Seccomp рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЛ рдкреЙрдб рд╕реНрддрд░ рдкрд░ рд╕реЗрдЯ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИ: <br><br><pre> <code class="plaintext hljs">annotations: seccomp.security.alpha.kubernetes.io/pod: "localhost/profile.json"</code> </pre> <br>  ... рдпрд╛ рдХрдВрдЯреЗрдирд░ рд╕реНрддрд░ рдкрд░: <br><br><pre> <code class="plaintext hljs">annotations: container.security.alpha.kubernetes.io/&lt;container-name&gt;: "localhost/profile.json"</code> </pre> <br>  <i>рдХреГрдкрдпрд╛ рдзреНрдпрд╛рди рджреЗрдВ рдХрд┐ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рд╕реЗрдХреИрдо <a href="https://github.com/kubernetes/enhancements/pull/1148">GA рд╣реЛ</a> рдЬрд╛рдиреЗ рдкрд░ рдЙрдкрд░реЛрдХреНрдд рд╕рд┐рдВрдЯреИрдХреНрд╕ рдмрджрд▓ рдЬрд╛рдПрдЧрд╛ (рдЕрдЧрд▓реЗ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рд░рд┐рд▓реАрдЬрд╝ рдореЗрдВ рдпрд╣ рдШрдЯрдирд╛ рдЕрдкреЗрдХреНрд╖рд┐рдд рд╣реИ - 1.18 - рд▓рдЧрднрдЧред рдЕрдиреБрд╡рд╛рджред)ред</i> <br><br>  рдХреБрдЫ рд▓реЛрдЧреЛрдВ рдХреЛ рдкрддрд╛ рд╣реИ рдХрд┐ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдХреЗ рдкрд╛рд╕ рд╣рдореЗрд╢рд╛ рдПрдХ <a href="https://github.com/kubernetes/kubernetes/issues/84623">рдмрдЧ</a> рд╣реЛрддрд╛ рдерд╛, рдЬрд┐рд╕рд╕реЗ <a href="https://www.ianlewis.org/en/almighty-pause-container">рдкреЙрдЬ рдХрдВрдЯреЗрдирд░ рдореЗрдВ</a> рд╕реЗрдХреНрдпреБрд▓рд░ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХреЛ рд▓рдЧрд╛рдпрд╛ рдЬрд╛рддрд╛ рдерд╛ред  рд░рдирдЯрд╛рдЗрдо рдЖрдВрд╢рд┐рдХ рд░реВрдк рд╕реЗ рдЗрд╕ рдЦрд╛рдореА рдХреА рднрд░рдкрд╛рдИ рдХрд░рддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдХрдВрдЯреЗрдирд░ рдлрд▓реА рд╕реЗ рдЧрд╛рдпрдм рдирд╣реАрдВ рд╣реЛрддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдЙрдирдХреЗ рдмреБрдирд┐рдпрд╛рджреА рдврд╛рдВрдЪреЗ рдХреЛ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред <br><br>  рд╕рдорд╕реНрдпрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдпрд╣ рдХрдВрдЯреЗрдирд░ рд╣рдореЗрд╢рд╛ <code>AllowPrivilegeEscalation=true</code> рд╕рд╛рде рд╢реБрд░реВ рд╣реЛрддрд╛ <code>AllowPrivilegeEscalation=true</code> , рдЬрд┐рд╕рд╕реЗ рдкреИрд░рд╛рдЧреНрд░рд╛рдл 1 рдореЗрдВ <code>AllowPrivilegeEscalation=true</code> рд╕рдорд╕реНрдпрд╛рдУрдВ рдХрд╛ рдХрд╛рд░рдг <code>AllowPrivilegeEscalation=true</code> , рдФрд░ рдЗрд╕реЗ рдмрджрд▓рд╛ рдирд╣реАрдВ рдЬрд╛ рд╕рдХрддрд╛ред <br><br>  рдХрдВрдЯреЗрдирд░ рд╕реНрддрд░ рдкрд░ seccomp рдкреНрд░реЛрдлрд╛рдЗрд▓ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рд╕реЗ рдЖрдк рдЗрд╕ рдЬрд╛рд▓ рд╕реЗ рдмрдЪ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдПрдХ рдРрд╕рд╛ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдХрдВрдЯреЗрдирд░ рдХреЗ рд▓рд┐рдП "рд╢рд╛рд░реНрдк" рд╣реЛрдЧрд╛ред  рдпрд╣ рддрдм рддрдХ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ рдЬрдм рддрдХ рдХрд┐ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдмрдЧ рдХреЛ рдареАрдХ рди рдХрд░реЗрдВ рдФрд░ рдирдпрд╛ рд╕рдВрд╕реНрдХрд░рдг (рд╢рд╛рдпрдж 1.18?) рд╕рднреА рдХреЗ рд▓рд┐рдП рдЙрдкрд▓рдмреНрдз рд╣реЛ рдЬрд╛рдПред <br><br>  <b>рдЯрд┐рдк # 2</b> : рдХрдВрдЯреЗрдирд░ рд╕реНрддрд░ рдкрд░ seccomp рдкреНрд░реЛрдлрд╛рдЗрд▓ рд╕реЗрдЯ рдХрд░реЗрдВред <br><br>  рд╡реНрдпрд╛рд╡рд╣рд╛рд░рд┐рдХ рдЕрд░реНрде рдореЗрдВ, рдпрд╣ рдирд┐рдпрдо рдЖрдо рддреМрд░ рдкрд░ рдЗрд╕ рд╕рд╡рд╛рд▓ рдХрд╛ рдПрдХ рд╕рд╛рд░реНрд╡рднреМрдорд┐рдХ рдЙрддреНрддрд░ рдХреЗ рд░реВрдк рдореЗрдВ рдХрд╛рд░реНрдп рдХрд░рддрд╛ рд╣реИ: "рдореЗрд░реА рд╕реЗрдХрдВрдб рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдбреЙрдХ <code>docker run</code> рд╕рд╛рде рдХреНрдпреЛрдВ рдХрд╛рдо рдХрд░рддреА рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдХреБрдмреЗрд░рдиреЗрдЯ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рддреИрдирд╛рддреА рдХреЗ рдмрд╛рдж рдХрд╛рдо рдирд╣реАрдВ рдХрд░рддреА рд╣реИ?" <br><br><h2>  3. рдПрдХ рдЕрдВрддрд┐рдо рдЙрдкрд╛рдп рдХреЗ рд░реВрдк рдореЗрдВ рд░рдирдЯрд╛рдЗрдо / рдбрд┐рдлреЙрд▓реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ </h2><br>  рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ рдЕрдВрддрд░реНрдирд┐рд╣рд┐рдд рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рджреЛ рд╡рд┐рдХрд▓реНрдк рд╣реИрдВ: <code>runtime/default</code> рдФрд░ <code>docker/default</code> ред  рджреЛрдиреЛрдВ рдХрдВрдЯреЗрдирд░ рд░рдирдЯрд╛рдЗрдо рджреНрд╡рд╛рд░рд╛ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рд┐рдд рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВ, рди рдХрд┐ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ред  рдЗрд╕рд▓рд┐рдП, рд╡реЗ рдЙрдкрдпреЛрдЧ рдХрд┐рдП рдЧрдП рд░рдирдЯрд╛рдЗрдо рдФрд░ рдЗрд╕рдХреЗ рд╕рдВрд╕реНрдХрд░рдг рдХреЗ рдЖрдзрд╛рд░ рдкрд░ рднрд┐рдиреНрди рд╣реЛ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рд░рдирдЯрд╛рдЗрдо рдмрджрд▓рдиреЗ рдХреЗ рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдХрдВрдЯреЗрдирд░ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреЗ рджреВрд╕рд░реЗ рд╕реЗрдЯ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдХрддрд╛ рд╣реИ рдЬреЛ рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ рдпрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдЕрдзрд┐рдХрд╛рдВрд╢ рд░рдирдЯрд╛рдЗрдо <a href="">рдПрдХ рдбреЙрдХрд░ рдХрд╛рд░реНрдпрд╛рдиреНрд╡рдпрди рдХрд╛</a> рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред  рдпрджрд┐ рдЖрдк рдЗрд╕ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ, рддреЛ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдпрд╣ рдЖрдкрдХреЗ рдЕрдиреБрд░реВрдк рд╣реИред <br><br>  рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ 1.11 рдХреЗ рдмрд╛рдж рд╕реЗ рдбреЙрдХрдЯрд░ <code>docker/default</code> рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХреЛ рд╣рдЯрд╛ рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рд╕реЗ рдмрдЪреЗрдВред <br><br>  рдореЗрд░реА рд░рд╛рдп рдореЗрдВ, <code>runtime/default</code> рдкреНрд░реЛрдлрд╛рдЗрд▓ рдЙрд╕ рдЙрджреНрджреЗрд╢реНрдп рдХреЗ рд▓рд┐рдП рдПрдХрджрдо рд╕рд╣реА рд╣реИ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдЗрд╕реЗ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛: рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЛ рдЕрдкрдиреА рдорд╢реАрдиреЛрдВ рдкрд░ <code>docker run</code> рдЬреБрдбрд╝реЗ рдЬреЛрдЦрд┐рдореЛрдВ рд╕реЗ рдмрдЪрд╛рдиреЗ рдХреЗ рд▓рд┐рдПред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЕрдЧрд░ рд╣рдо рдХреБрдмреЗрд░рдиреЗрдЯ рд╕рдореВрд╣реЛрдВ рдореЗрдВ рдЪрд▓ рд░рд╣реЗ рд╡реНрдпрд╛рд╡рд╕рд╛рдпрд┐рдХ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдореИрдВ рдпрд╣ рджрд╛рд╡рд╛ рдХрд░рдиреЗ рдХреА рд╣рд┐рдореНрдордд рдХрд░реВрдВрдЧрд╛ рдХрд┐ рдРрд╕реА рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдмрд╣реБрдд рдЦреБрд▓реА рд╣реИ рдФрд░ рдбреЗрд╡рд▓рдкрд░реНрд╕ рдХреЛ рдЕрдкрдиреЗ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ (рдпрд╛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдкреНрд░рдХрд╛рд░реЛрдВ) рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдиреЗ рдкрд░ рдзреНрдпрд╛рди рдХреЗрдВрджреНрд░рд┐рдд рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br>  <b>рдЯрд┐рдк # 3</b> : рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рд╕реЗрдХрдВрдб рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВред  рдпрджрд┐ рдпрд╣ рд╕рдВрднрд╡ рдирд╣реАрдВ рд╣реИ, рддреЛ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рдкреНрд░рдХрд╛рд░реЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдлрд╛рдЗрд▓ рд╕реЗ рдирд┐рдкрдЯреЗрдВ, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдПрдХ рдЙрдиреНрдирдд рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдмрдирд╛рдПрдВ рдЬрд┐рд╕рдореЗрдВ рд╕рднреА рдЧреЛрд▓рд╛рдВрдЧ рд╡реЗрдм рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдПрдкреАрдЖрдИ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред  рдХреЗрд╡рд▓ рдЕрдВрддрд┐рдо рдЙрдкрд╛рдп рдХреЗ рд░реВрдк рдореЗрдВ рд░рдирдЯрд╛рдЗрдо / рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВред <br><br>  рднрд╡рд┐рд╖реНрдп рдХреЗ рдкреНрд░рдХрд╛рд╢рдиреЛрдВ рдореЗрдВ, рдореИрдВ рдЖрдкрдХреЛ рдмрддрд╛рдКрдВрдЧрд╛ рдХрд┐ рдХреИрд╕реЗ SecDevOps рдХреА рднрд╛рд╡рдирд╛ рдореЗрдВ secccomp рдкреНрд░реЛрдлрд╛рдЗрд▓ рддреИрдпрд╛рд░ рдХрд░реЗрдВ, рдЙрдиреНрд╣реЗрдВ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░реЗрдВ рдФрд░ рдЙрдиреНрд╣реЗрдВ рдкрд╛рдЗрдкрд▓рд╛рдЗрдиреЛрдВ рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░реЗрдВред  рджреВрд╕рд░реЗ рд╢рдмреНрджреЛрдВ рдореЗрдВ, рдЖрдкрдХреЗ рдкрд╛рд╕ рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЕрдиреБрдкреНрд░рдпреЛрдЧреЛрдВ рдХреЗ рд▓рд┐рдП рдкреНрд░реЛрдлрд╛рдЗрд▓ рдкрд░ рд╕реНрд╡рд┐рдЪ рдирд╣реАрдВ рдХрд░рдиреЗ рдХрд╛ рдХреЛрдИ рдмрд╣рд╛рдирд╛ рдирд╣реАрдВ рд╣реЛрдЧрд╛ред <br><br><h2>  4. рдЕрдкреБрд╖реНрдЯ рдПрдХ рд╡рд┐рдХрд▓реНрдк рдирд╣реАрдВ рд╣реИ </h2><br>  <a href="https://www.cncf.io/blog/2019/08/06/open-sourcing-the-kubernetes-security-audit/">рдкрд╣рд▓реЗ рдХреБрдмреЗрд░рдиреЗрдЯ рд╕реБрд░рдХреНрд╖рд╛ рдСрдбрд┐рдЯ рд╕реЗ,</a> рдпрд╣ рдкрддрд╛ рдЪрд▓рд╛ рдХрд┐ <a href="https://github.com/kubernetes/kubernetes/issues/81115">рд╕реЗрдХреНрдпреБрд▓рдХ</a> рдбрд┐рдлрд╝реЙрд▓реНрдЯ рд░реВрдк рд╕реЗ <a href="https://github.com/kubernetes/kubernetes/issues/81115">рдЕрдХреНрд╖рдо рдерд╛</a> ред  рдЗрд╕рдХрд╛ рдорддрд▓рдм рдпрд╣ рд╣реИ рдХрд┐ рдпрджрд┐ рдЖрдк рдПрдХ <code>PodSecurityPolicy</code> рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдирд╣реАрдВ рдХрд░рддреЗ рд╣реИрдВ рдЬреЛ рдЗрд╕реЗ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рд╕рдХреНрд╖рдо рдХрд░реЗрдЧрд╛, рддреЛ рд╕рднреА рдкреЙрдбреНрд╕ рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП seccomp рдкреНрд░реЛрдлрд╛рдЗрд▓ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдирд╣реАрдВ рд╣реИ, <code>seccomp=unconfined</code> рдореЗрдВ рдХрд╛рдо рдХрд░реЗрдЧрд╛ред <br><br>  рдЗрд╕ рдореЛрдб рдореЗрдВ рдХрд╛рдо рдХрд░рдиреЗ рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдЕрд▓рдЧрд╛рд╡ рдХреА рдПрдХ рдкреВрд░реА рдкрд░рдд рдЦреЛ рдЬрд╛рддреА рд╣реИ, рдЬреЛ рдХреНрд▓рд╕реНрдЯрд░ рд╕реБрд░рдХреНрд╖рд╛ рдкреНрд░рджрд╛рди рдХрд░рддреА рд╣реИред  рдпрд╣ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реБрд░рдХреНрд╖рд╛ рдкреЗрд╢реЗрд╡рд░реЛрдВ рджреНрд╡рд╛рд░рд╛ рдЕрдиреБрд╢рдВрд╕рд┐рдд рдирд╣реАрдВ рд╣реИред <br><br>  <b>рдЯрд┐рдк # 4</b> : рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдХреЛрдИ рднреА рдХрдВрдЯреЗрдирд░ <code>seccomp=unconfined</code> рдореЗрдВ рдХрд╛рдо рдирд╣реАрдВ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ рдЙрддреНрдкрд╛рджрди рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВред <br><br><h2>  5. "рдСрдбрд┐рдЯ рдореЛрдб" </h2><br>  рдпрд╣ рдмрд┐рдВрджреБ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдХреЗ рд▓рд┐рдП рдЕрджреНрд╡рд┐рддреАрдп рдирд╣реАрдВ рд╣реИ, рд▓реЗрдХрд┐рди рдпрд╣ рдЕрднреА рднреА "рд╢реБрд░реВ рд╣реЛрдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдЖрдкрдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛ рдЬрд╛рдирдирд╛ рдЪрд╛рд╣рд┐рдП" рдХреА рд╢реНрд░реЗрдгреА рдореЗрдВ рдЖрддрд╛ рд╣реИред <br><br>  рдпрд╣ рдРрд╕рд╛ рд╣реБрдЖ рдХрд┐ seccomp рдкреНрд░реЛрдлрд╛рдЗрд▓ рдмрдирд╛рдирд╛ рд╣рдореЗрд╢рд╛ рдПрдХ рдореБрд╢реНрдХрд┐рд▓ рдХрд╛рдо рдерд╛ рдФрд░ рдпрд╣ рдХрд╛рдлреА рд╣рдж рддрдХ рдкрд░реАрдХреНрд╖рдг рдФрд░ рддреНрд░реБрдЯрд┐ рдкрд░ рдЖрдзрд╛рд░рд┐рдд рдерд╛ред  рддрдереНрдп рдпрд╣ рд╣реИ рдХрд┐ рдЙрдкрдпреЛрдЧрдХрд░реНрддрд╛рдУрдВ рдХреЗ рдкрд╛рд╕ рдЖрд╡реЗрджрди рдЫреЛрдбрд╝рдиреЗ рдХреЗ рдмрд┐рдирд╛ рдЙрддреНрдкрд╛рджрди рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдЙрдиреНрд╣реЗрдВ рдкрд░реАрдХреНрд╖рдг рдХрд░рдиреЗ рдХрд╛ рдЕрд╡рд╕рд░ рдирд╣реАрдВ рд╣реИред <br><br>  рд▓рд┐рдирдХреНрд╕ 4.14 рдХрд░реНрдиреЗрд▓ рдХреЗ рдЖрдЧрдорди рдХреЗ рдмрд╛рдж, рдСрдбрд┐рдЯ рдореЛрдб рдореЗрдВ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдХреЗ рдХреБрдЫ рд╣рд┐рд╕реНрд╕реЛрдВ рдХреЛ рдЪрд▓рд╛рдирд╛ рд╕рдВрднрд╡ рд╣реЛ рдЧрдпрд╛, рд╕рд┐рд╕рд▓реЙрдЧ рдореЗрдВ рд╕рднреА рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рджрд░реНрдЬ рдХреА, рд▓реЗрдХрд┐рди рдЙрдиреНрд╣реЗрдВ рдЕрд╡рд░реБрджреНрдз рдирд╣реАрдВ рдХрд┐рдпрд╛ред  рдЖрдк <code>SCMT_ACT_LOG</code> рдкреИрд░рд╛рдореАрдЯрд░ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕ рдореЛрдб рдХреЛ рд╕рдХреНрд░рд┐рдп рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ: <br><br>  <i><b>SCMP_ACT_LOG</b> : seccomp рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХрд░рдиреЗ рд╡рд╛рд▓реЗ рдереНрд░реЗрдб рдХреЗ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рдкреНрд░рднрд╛рд╡рд┐рдд рдирд╣реАрдВ рдХрд░реЗрдЧрд╛ рдпрджрд┐ рдпрд╣ рдлрд╝рд┐рд▓реНрдЯрд░ рд╕реЗ рдХрд┐рд╕реА рдирд┐рдпрдо рдХреЗ рдЕрдВрддрд░реНрдЧрдд рдирд╣реАрдВ рдЖрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд▓реЙрдЧ рдХреА рдЬрд╛рдПрдЧреАред</i> <br><br>  рдпрд╣рд╛рдБ рдЗрд╕ рд╕реБрд╡рд┐рдзрд╛ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдПрдХ рдирдореВрдирд╛ рд░рдгрдиреАрддрд┐ рд╣реИ: <br><br><ol><li>  рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдХрд┐ рдЕрдиреБрдорддрд┐ рджреЗрдВред </li><li>  рдмреНрд▓реЙрдХ рдХреЙрд▓ рд╕рд┐рд╕реНрдЯрдо рдЬрд┐рдиреНрд╣реЗрдВ рдЙрдкрдпреЛрдЧреА рдирд╣реАрдВ рдЬрд╛рдирд╛ рдЬрд╛рддрд╛ рд╣реИред </li><li>  рд▓реЙрдЧ рдореЗрдВ рдЕрдиреНрдп рд╕рднреА рдХреЙрд▓ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдЬрд╛рдирдХрд╛рд░реА рд░рд┐рдХреЙрд░реНрдб рдХрд░реЗрдВред </li></ol><br>  рдПрдХ рд╕рд░рд▓ рдЙрджрд╛рд╣рд░рдг рдЗрд╕ рдкреНрд░рдХрд╛рд░ рд╣реИ: <br><br><pre> <code class="plaintext hljs">{ "defaultAction": "SCMP_ACT_LOG", "architectures": [ "SCMP_ARCH_X86_64", "SCMP_ARCH_X86", "SCMP_ARCH_X32" ], "syscalls": [ { "names": [ "arch_prctl", "sched_yield", "futex", "write", "mmap", "exit_group", "madvise", "rt_sigprocmask", "getpid", "gettid", "tgkill", "rt_sigaction", "read", "getpgrp" ], "action": "SCMP_ACT_ALLOW" }, { "names": [ "add_key", "keyctl", "ptrace" ], "action": "SCMP_ACT_ERRNO" } ] }</code> </pre> <br>  <i>( <a href="https://gist.github.com/pjbgf/fa4f7a89937c486d940ac8ccf48379c9">рдордзреНрдпрдо-рдорд┐рд╢реНрд░рд┐рдд- seccomp.json</a> )</i> <br><br>  рд▓реЗрдХрд┐рди рдпрд╛рдж рд░рдЦреЗрдВ рдХрд┐ рдЖрдкрдХреЛ рдЙрди рд╕рднреА рдХреЙрд▓ рдХреЛ рдмреНрд▓реЙрдХ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдЬреЛ рдЕрдкреНрд░рдпреБрдХреНрдд рд╣реЛрдиреЗ рдХреЗ рд▓рд┐рдП рдЬрд╛рдиреА рдЬрд╛рддреА рд╣реИрдВ рдФрд░ рдЬреЛ рд╕рдВрднрд╡рддрдГ рдХреНрд▓рд╕реНрдЯрд░ рдХреЛ рдиреБрдХрд╕рд╛рди рдкрд╣реБрдВрдЪрд╛ рд╕рдХрддреА рд╣реИрдВред  рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдХрд╛ рдПрдХ рдЕрдЪреНрдЫрд╛ рдЖрдзрд╛рд░ рдЖрдзрд┐рдХрд╛рд░рд┐рдХ <a href="https://docs.docker.com/engine/security/seccomp/">рдбреЙрдХреНрдпреВрдореЗрдВрдЯ рдбреЙрдХреНрдпреВрдореЗрдВрдЯреЗрд╢рди рд╣реИ</a> ред  рдпрд╣ рд╡рд┐рд╕реНрддрд╛рд░ рд╕реЗ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдХреМрди рд╕реЗ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рдбрд┐рдлрд╝реЙрд▓реНрдЯ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдореЗрдВ рдЕрд╡рд░реБрджреНрдз рд╣реИрдВ рдФрд░ рдХреНрдпреЛрдВред <br><br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдПрдХ рдХреИрдЪ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐ <code>SCMT_ACT_LOG</code> 2017 рдХреЗ рдЕрдВрдд рд╕реЗ рд▓рд┐рдирдХреНрд╕ рдХрд░реНрдиреЗрд▓ рджреНрд╡рд╛рд░рд╛ рд╕рдорд░реНрдерд┐рдд <code>SCMT_ACT_LOG</code> , рдпрд╣ рдХреЗрд╡рд▓ рд╣рд╛рд▓ рд╣реА рдореЗрдВ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдкрд╛рд░рд┐рд╕реНрдерд┐рддрд┐рдХреА рддрдВрддреНрд░ рдореЗрдВ рдкреНрд░рд╡реЗрд╢ рдХрд┐рдпрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдЗрд╕ рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдкрдХреЛ рд▓рд┐рдирдХреНрд╕ 4.14 рдХрд░реНрдиреЗрд▓ рдФрд░ рд░рдирдХ рд╕рдВрд╕реНрдХрд░рдг рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрдЧреА рдЬреЛ v1.0.0-рдЖрд░рд╕реА 9 рд╕реЗ рдХрдо рдирд╣реАрдВ рд╣реИред <br><br>  <b>рдЯрд┐рдк # 5</b> : рдЖрдк рдмреНрд▓реИрдХ рдПрдВрдб рд╡реНрд╣рд╛рдЗрдЯ рд╕реВрдЪрд┐рдпреЛрдВ рдХреЗ рд╕рдВрдпреЛрдЬрди рджреНрд╡рд╛рд░рд╛ рдЙрддреНрдкрд╛рджрди рдореЗрдВ рдкрд░реАрдХреНрд╖рдг рдХреЗ рд▓рд┐рдП рдПрдХ рдСрдбрд┐рдЯ рдореЛрдб рдкреНрд░реЛрдлрд╛рдЗрд▓ рдмрдирд╛ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рд╕рднреА рдЕрдкрд╡рд╛рджреЛрдВ рдХреЛ рд▓реЙрдЧ рдЗрди рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br><h2>  6. рд╢реНрд╡реЗрддрд╕реВрдЪреА рдХрд╛ рдкреНрд░рдпреЛрдЧ рдХрд░реЗрдВ </h2><br>  рд╢реНрд╡реЗрддрд╕реВрдЪреА рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрддрд┐рд░рд┐рдХреНрдд рдкреНрд░рдпрд╛рд╕реЛрдВ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдЖрдкрдХреЛ рд╣рд░ рдЙрд╕ рдХреЙрд▓ рдХреА рдкрд╣рдЪрд╛рди рдХрд░рдиреА рд╣реЛрддреА рд╣реИ, рдЬрд┐рд╕рдХреЗ рд▓рд┐рдП рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ, рд▓реЗрдХрд┐рди рдЗрд╕ рджреГрд╖реНрдЯрд┐рдХреЛрдг рд╕реЗ рд╕реБрд░рдХреНрд╖рд╛ рдореЗрдВ рдХрд╛рдлреА рд╕реБрдзрд╛рд░ рд╣реЛрддрд╛ рд╣реИ: <br><br><blockquote>  <i>рдпрд╣ рджреГрдврд╝рддрд╛ рд╕реЗ рдЕрдиреБрд╢рдВрд╕рд╛ рдХреА рдЬрд╛рддреА рд╣реИ рдХрд┐ рдЖрдк рд╢реНрд╡реЗрддрд╕реВрдЪреА рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░реЗрдВ рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕рд░рд▓ рдФрд░ рдЕрдзрд┐рдХ рд╡рд┐рд╢реНрд╡рд╕рдиреАрдп рд╣реИред</i>  <i>рдЬрдм рднреА рд╕рдВрднрд╛рд╡рд┐рдд рдЦрддрд░рдирд╛рдХ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ (рдпрд╛ рдЦрддрд░рдирд╛рдХ рдзреНрд╡рдЬ / рд╡рд┐рдХрд▓реНрдк рдпрджрд┐ рд╡реЗ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдореЗрдВ рд╣реИрдВ) рдХреЛ рдЬреЛрдбрд╝рд╛ рдЬрд╛рддрд╛ рд╣реИ рддреЛ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдХреЛ рдЕрдкрдбреЗрдЯ рдХрд░рдирд╛ рд╣реЛрдЧрд╛ред</i>  <i>рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рдЖрдк рдЕрдХреНрд╕рд░ рдЗрд╕рдХреЗ рд╕рд╛рд░ рдХреЛ рдмрджрд▓реЗ рдмрд┐рдирд╛ рдПрдХ рдкреИрд░рд╛рдореАрдЯрд░ рдХреА рдкреНрд░рд╕реНрддреБрддрд┐ рдХреЛ рдмрджрд▓ рд╕рдХрддреЗ рд╣реИрдВ рдФрд░ рдЗрд╕ рддрд░рд╣ рдмреНрд▓реИрдХрд▓рд┐рд╕реНрдЯ рдХреА рд╕реАрдорд╛рдУрдВ рдХреЛ рджрд░рдХрд┐рдирд╛рд░ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред</i> </blockquote><br>  рдЧреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдПрдХ рд╡рд┐рд╢реЗрд╖ рдЯреВрд▓ рд╡рд┐рдХрд╕рд┐рдд рдХрд┐рдпрд╛ рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЗ рд╕рд╛рде рдЪрд▓рддрд╛ рд╣реИ рдФрд░ рд░рдирдЯрд╛рдЗрдо рдкрд░ рдХрд┐рдП рдЧрдП рд╕рднреА рдХреЙрд▓ рдХреЛ рдЗрдХрдЯреНрдард╛ рдХрд░рддрд╛ рд╣реИред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдЖрд╡реЗрджрди рдХреЗ рд▓рд┐рдП: <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { fmt.Println(<span class="hljs-string"><span class="hljs-string">"test"</span></span>) }</code> </pre> <br>  ... рдЗрд╕ рддрд░рд╣ рд╕реЗ рдЪрд▓рд╛рдПрдВ: <br><br><pre> <code class="bash hljs">go install https://github.com/pjbgf/gosystract gosystract --template=<span class="hljs-string"><span class="hljs-string">'{{- range . }}{{printf "\"%s\",\n" .Name}}{{- end}}'</span></span> application-path</code> </pre> <br>  ... рдФрд░ рдирд┐рдореНрди рдкрд░рд┐рдгрд╛рдо рдкреНрд░рд╛рдкреНрдд рдХрд░реЗрдВ: <br><br><pre> <code class="plaintext hljs">"sched_yield", "futex", "write", "mmap", "exit_group", "madvise", "rt_sigprocmask", "getpid", "gettid", "tgkill", "rt_sigaction", "read", "getpgrp", "arch_prctl",</code> </pre> <br>  рдЕрдм рддрдХ рдпрд╣ рд╕рд┐рд░реНрдл рдПрдХ рдЙрджрд╛рд╣рд░рдг рд╣реИ - рдЙрдкрдХрд░рдг рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд╡рд┐рд╡рд░рдг рдЖрдЧреЗ рд╣реЛрдЧрд╛ред <br><br>  <b>рдЯрд┐рдк # 6</b> : рдХреЗрд╡рд▓ рдЙрди рдХреЙрд▓ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВ рдЬрд┐рдирдХреА рдЖрдкрдХреЛ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИ рдФрд░ рдмрд╛рдХреА рд╕рднреА рдХреЛ рдмреНрд▓реЙрдХ рдХрд░реЗрдВред <br><br><h2>  7. рдиреАрдВрд╡ рд░рдЦрдирд╛ (рдпрд╛ рдЕрдкреНрд░рддреНрдпрд╛рд╢рд┐рдд рд╡реНрдпрд╡рд╣рд╛рд░ рдХреЗ рд▓рд┐рдП рддреИрдпрд╛рд░ рдХрд░рдирд╛) </h2><br>  рдХрд░реНрдиреЗрд▓ рдкреНрд░реЛрдлрд╝рд╛рдЗрд▓ рдХреЗ рдЕрдиреБрдкрд╛рд▓рди рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░реЗрдЧрд╛, рдЪрд╛рд╣реЗ рдЖрдкрдиреЗ рдЙрд╕рдореЗрдВ рдЬреЛ рднреА рджрд░реНрдЬ рдХрд┐рдпрд╛ рд╣реЛред  рднрд▓реЗ рд╣реА рдпрд╣ рд╡рд╣ рдирд╣реАрдВ рд╣реИ рдЬреЛ рдореИрдВ рдЪрд╛рд╣рддрд╛ рдерд╛ред  рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, рдпрджрд┐ рдЖрдк <code>exit</code> рдпрд╛ <code>exit_group</code> рдЬреИрд╕реА рдХреЙрд▓реНрд╕ рддрдХ рдкрд╣реБрдВрдЪ рдХреЛ <code>exit_group</code> , рддреЛ рдХрдВрдЯреЗрдирд░ рд╕рд╣реА рддрд░реАрдХреЗ рд╕реЗ рдХрд╛рдо рдкреВрд░рд╛ рдирд╣реАрдВ рдХрд░ рдкрд╛рдПрдЧрд╛ рдФрд░ <code>echo hi</code> рдЬреИрд╕реА рдПрдХ рд╕рд╛рдзрд╛рд░рдг рдХрдорд╛рдВрдб рднреА рдЗрд╕реЗ рдЕрдирд┐рд╢реНрдЪрд┐рдд рдЕрд╡рдзрд┐ рдХреЗ рд▓рд┐рдП <a href="https://github.com/kubernetes/kubernetes/issues/85191">рдирд┐рд▓рдВрдмрд┐рдд рдХрд░</a> <code>echo hi</code> ред  рдкрд░рд┐рдгрд╛рдорд╕реНрд╡рд░реВрдк, рдЖрдкрдХреЛ рдХреНрд▓рд╕реНрдЯрд░ рдореЗрдВ рдЙрдЪреНрдЪ CPU рдЙрдкрдпреЛрдЧ рдорд┐рд▓реЗрдЧрд╛: <br><br><img src="https://habrastorage.org/webt/32/no/rt/32nortxic_d8czgqc5jnbzrb-ps.png"><br><br>  рдРрд╕реЗ рдорд╛рдорд▓реЛрдВ рдореЗрдВ, <code>strace</code> рдпреВрдЯрд┐рд▓рд┐рдЯреА рдмрдЪрд╛рд╡ рдореЗрдВ рдЖ рд╕рдХрддреА рд╣реИ - рдпрд╣ рджрд┐рдЦрд╛рдПрдЧрд╛ рдХрд┐ рд╕рдорд╕реНрдпрд╛ рдХреНрдпрд╛ рд╣реЛ рд╕рдХрддреА рд╣реИ: <br><br><img src="https://habrastorage.org/webt/hg/l3/eh/hgl3ehuqz8a6eprrsycubq_n6hu.png"><br> <i><code>sudo strace -c -p 9331</code></i> <br> <br>  рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рдкреНрд░реЛрдлрд╛рдЗрд▓ рдореЗрдВ рд╕рднреА рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рд╢рд╛рдорд┐рд▓ рд╣реИрдВ рдЬреЛ рдПрдкреНрд▓рд┐рдХреЗрд╢рди рдХреЛ рдЪрд▓рдиреЗ рдХреЗ рджреМрд░рд╛рди рдЪрд╛рд╣рд┐рдПред <br><br>  <b>рдЯрд┐рдк # 7</b> : рдЫреЛрдЯреА рдЪреАрдЬрд╝реЛрдВ рдкрд░ рдзреНрдпрд╛рди рджреЗрдВ рдФрд░ рд╕реБрдирд┐рд╢реНрдЪрд┐рдд рдХрд░реЗрдВ рдХрд┐ рд╕рднреА рдЖрд╡рд╢реНрдпрдХ рд╕рд┐рд╕реНрдЯрдо рдХреЙрд▓ рд╕рдлреЗрдж рд╕реВрдЪреА рдореЗрдВ рд╢рд╛рдорд┐рд▓ рд╣реИрдВред <br><br>  рдЗрд╕рдХреЗ рд╕рд╛рде, SecDevOps рдХреА рднрд╛рд╡рдирд╛ рдореЗрдВ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рдореЗрдВ seccomp рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдиреЗ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рд▓реЗрдЦреЛрдВ рдХреА рдПрдХ рд╢реНрд░реГрдВрдЦрд▓рд╛ рдХрд╛ рдкрд╣рд▓рд╛ рднрд╛рдЧ рд╕рдорд╛рдкреНрдд рд╣реЛ рдЬрд╛рддрд╛ рд╣реИред  рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рднрд╛рдЧреЛрдВ рдореЗрдВ рд╣рдо рдЗрд╕ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░реЗрдВрдЧреЗ рдХрд┐ рдпрд╣ рдХреНрдпреЛрдВ рдорд╣рддреНрд╡рдкреВрд░реНрдг рд╣реИ рдФрд░ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХреИрд╕реЗ рдХрд┐рдпрд╛ рдЬрд╛рдПред <br><br><h2>  рдЕрдиреБрд╡рд╛рджрдХ рд╕реЗ рдкреА.рдПрд╕. </h2><br>  рд╣рдорд╛рд░реЗ рдмреНрд▓реЙрдЧ рдореЗрдВ рднреА рдкрдврд╝реЗрдВ: <br><br><ul><li>  " <a href="https://habr.com/ru/company/flant/blog/474012/">рдбреЙрдХрдЯрд░ рдХрдВрдЯреЗрдирд░реЛрдВ рдХреА рд╕реБрд░рдХреНрд╖рд╛</a> "; </li><li>  " <a href="https://habr.com/ru/company/flant/blog/465141/">33+ рдХреБрдмреЗрд░рдиреЗрдЯ рд╕реБрд░рдХреНрд╖рд╛ рдЙрдкрдХрд░рдг</a> "; </li><li>  " <a href="https://habr.com/ru/company/flant/blog/440504/">рд╕реБрд░рдХреНрд╖рд╛-рдорд╛рдВрдЧ рд╡рд╛рд▓реЗ рд╡рд╛рддрд╛рд╡рд░рдг рдореЗрдВ рдбреЛрдХрд░ рдФрд░ рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕</a> "; </li><li>  " <a href="https://habr.com/ru/company/flant/blog/436300/">9 рдХреБрдмреЗрд░рдиреЗрдЯреНрд╕ рд╕реБрд░рдХреНрд╖рд╛ рд╕рд░реНрд╡реЛрддреНрддрдо рдЕрднреНрдпрд╛рд╕</a> ред" </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi481114/">https://habr.com/ru/post/hi481114/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi481102/index.html">рдХреНрд░реЙрд╕-рдкреНрд▓реЗрдЯрдлрд╝реЙрд░реНрдо .NET UI рдЯреВрд▓рдХрд┐рдЯ AvaloniaUI 0.9</a></li>
<li><a href="../hi481104/index.html">рд╕рдореНрдорд┐рд╢реНрд░рдг OpenJDK рдФрд░ NodeJS: рдХреНрд░реЙрд╕-рднрд╛рд╖рд╛ рдЗрдВрдЯрд░реИрдХреНрд╢рди рдФрд░ рд╡рд░реНрдЯрд┐рдХрд▓ рдЖрд░реНрдХрд┐рдЯреЗрдХреНрдЪрд░</a></li>
<li><a href="../hi481106/index.html">рдХреИрд╕реЗ LANIT рдиреЗ рдЕрдкрдиреЗ рдХрд╛рд░реНрдпрд╛рд▓рдп рдореЗрдВ DIY-рд╕рд┐рдЯрдХреЙрдо рдХреА рд╢реВрдЯрд┐рдВрдЧ рдХреА</a></li>
<li><a href="../hi481110/index.html">Playme рд╡реЗрдЧрд╛ рд╕рдореАрдХреНрд╖рд╛: рдЯрдЪ рд╕реНрдХреНрд░реАрди рдФрд░ рдорд┐рд░рд░ рдорд╛рдЙрдВрдЯ рдХреЗ рд╕рд╛рде рдХреЙрдореНрдмреЛ рд░рд┐рдХреЙрд░реНрдбрд░</a></li>
<li><a href="../hi481112/index.html">"рдЪрдмрд╛рдиреЗ рд╡рд╛рд▓реА рдЧрдо" рдЙрдореНрд░ 5700 рд╕рд╛рд▓ рдЙрд╕ рд╡реНрдпрдХреНрддрд┐ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдХреНрдпрд╛ рдмрддрд╛рдПрдЧреА рдЬрд┐рд╕рдиреЗ рдЗрд╕реЗ рдЪрдмрд╛рдпрд╛ рдерд╛?</a></li>
<li><a href="../hi481116/index.html">рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рд░реВрдк рд╕реЗ VKontakte рд╕рдореБрджрд╛рдп рд╕реЗ рдбрд┐рд╕реНрдХреЙрд░реНрдб рддрдХ рдкреЛрд╕реНрдЯ рдкреНрд░рдХрд╛рд╢рд┐рдд рдХрд░реЗрдВ</a></li>
<li><a href="../hi481118/index.html">рдмреЗрдирд╛рдореА рд╕рд╛рдВрддрд╛ рдХреНрд▓реЙрдЬ 2019-2020: рдирдП рд╕рд╛рд▓ рдХреЗ рдЙрдкрд╣рд╛рд░реЛрдВ рдХрд╛ рджрд╛рд╡рд╛ рдХрд░рддреЗ рд╣реБрдП</a></li>
<li><a href="../hi481120/index.html">рдПрдЬ рд╕рд░реНрд╡рд░ рдХрд╣рд╛рдВ рдФрд░ рдХреИрд╕реЗ рд▓рдЧрд╛рдП рдЬрд╛рддреЗ рд╣реИрдВ?</a></li>
<li><a href="../hi481122/index.html">PostgreSQL Antipatterns: рдПрд╕рдХреНрдпреВрдПрд▓ рдХреЗ рдкрд╛рд╕ рд╕реЗрдЯ рдФрд░ рдЪрдпрди</a></li>
<li><a href="../hi481124/index.html">рд╕реНрд╡-рджрд╕реНрддрд╛рд╡реЗрдЬ рдХреЛрдб рд▓рд┐рдЦрдиреЗ рдХреЗ рд▓рд┐рдП рдЯрд┐рдкреНрд╕</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>