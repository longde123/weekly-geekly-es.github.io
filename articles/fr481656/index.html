<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐶 🔽 👚 PagerDuty, ou pourquoi le service des opérations peut ne pas dormir la nuit 👨‍❤️‍💋‍👨 🙌🏾 💚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Plus le système est complexe, plus il grandit avec toutes sortes d'alertes. Et il faut répondre à ces alertes, les agréger et les visualiser. Je pense...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>PagerDuty, ou pourquoi le service des opérations peut ne pas dormir la nuit</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/funcorp/blog/481656/">  Plus le système est complexe, plus il grandit avec toutes sortes d'alertes.  Et il faut répondre à ces alertes, les agréger et les visualiser.  Je pense à une situation familière à beaucoup avant une tique nerveuse. <br><br>  La décision qui sera discutée n'est pas la plus inattendue, mais la recherche ne produit pas un article complet sur ce sujet. <br><br>  Par conséquent, j'ai décidé de partager l'expérience de FunCorp et de parler de la façon dont le processus de devoir est construit, qui appelle, pourquoi et comment vous pouvez regarder tout cela. <br><br><img src="https://habrastorage.org/webt/uo/be/fh/uobefhsiue_mt_swg86e3utvspa.jpeg"><br><a name="habracut"></a><br><h3>  Qu'est-ce que PagerDuty? </h3><br>  Donc, pour résoudre tous ces problèmes, nous avons commencé à chercher un outil pratique.  Après une courte recherche, nous avons opté pour PagerDuty.  PD nous a semblé une solution assez complète et concise avec beaucoup d'intégrations et de paramètres.  Comment est-elle? <br><br>  En bref, PagerDuty est une plate-forme de traitement des incidents qui peut gérer les incidents entrants via diverses intégrations, ajuster l'ordre des tâches puis alerter l'ingénieur de service en fonction du niveau de l'incident (à haut niveau - appel, à faible - push depuis l'application / sms) . <br><br><h3>  Qui est la personne en service? </h3><br>  C'est probablement la première chose à commencer à configurer un PD. <br><br>  FunCorp, comme d'autres sociétés, a un poste honorifique en service.  Il est transmis d'ingénieur en ingénieur une fois par jour.  Il existe ce qu'on appelle la première et la deuxième ligne de réponse aux alertes de PagerDuty.  Supposons qu'une alerte de priorité élevée arrive, et si 10 minutes après l'appel à l'opératrice de la première ligne, il n'y a aucune réaction à son égard (c'est-à-dire qu'il n'est pas transféré à l'état d'acquittement ou de résolution), l'appel est dirigé vers le deuxième ingénieur de garde.  Ceci est configuré dans PagerDuty lui-même via des stratégies d'escalade. <br><br><img src="https://habrastorage.org/webt/92/8l/fm/928lfmtz8x2qizk8lqbl2nhxo8m.png"><br><br>  Si le deuxième standardiste ne répond pas, la notification revient au standardiste <em>principal</em> . <br><br>  Ainsi, aucune alerte entrante de haute priorité ne peut rester non traitée. <br><br>  Voyons maintenant d'où peuvent provenir les incidents. <br><br><h3>  Quelles intégrations utilisons-nous? </h3><br>  Un grand nombre d'incidents divers provenant de divers services sont versés dans PD.  Nous avons maintenant environ 25 de ces services, et pour leur traitement, nous utilisons des intégrations toutes faites. <br><br><ul><li>  Prométhée <br></li></ul><br>  Le principal système de collecte métrique est Prométhée.  Beaucoup a été écrit à ce sujet dans Habré, je dirai simplement que nous en avons plusieurs pour des environnements différents: l'un collecte les métriques des machines virtuelles et des dockers, l'autre des services Amazon, le troisième des «machines à repasser».  Telegraf est principalement utilisé comme exportateur de métriques. <br><br><ul><li>  Courriel <br></li></ul><br>  Ici aussi, je pense que tout est clair d'après le nom.  Cette intégration est utilisée pour envoyer des notifications à partir de certains scripts exécutés sur la couronne.  PD vous donne une certaine adresse à laquelle vous envoyez des lettres.  Lors de la création d'un service avec cette intégration, vous pouvez définir des priorités dans quel ordre les incidents entrants seront traités, comment créer une alerte (pour chaque lettre entrante, pour une lettre entrante + une certaine règle, etc.). <br><br><img src="https://habrastorage.org/webt/uf/m4/oy/ufm4oy_rnmfwjqycf1pusdovjli.png"><br><br><ul><li>  Mou <br></li></ul><br>  À mon avis, une intégration très intéressante.  Il y a des moments où quelque chose se produit, mais n'est pas couvert par des incidents.  Par conséquent, nous avons ajouté l'intégration de Slack pour créer l'incident.  Autrement dit, dans Slack d'entreprise, vous pouvez écrire <b>/ callofduty tout ralentit et bientôt il se casse</b> et PD traite cela et envoie l'incident à l'ingénieur de service. <br><br>  Nous faisons: <br><br><img src="https://habrastorage.org/webt/nh/kf/re/nhkfre_6z0ttieniuawwicimmns.png"><br><br>  On voit: <br><br><img src="https://habrastorage.org/webt/0_/z2/qr/0_z2qrbmpxts_ifrm7pocr2p3nm.jpeg"><br><br><ul><li>  API <br></li></ul><br>  Intégration HTTP.  Ici, en fait, il n'y a rien de particulièrement intéressant, juste une requête POST avec un corps au format JSON.  Par exemple, d'un point intéressant: nous l'utilisons pour la surveillance externe en utilisant <a href="https://www.statuscake.com/">https://www.statuscake.com/</a> .  Ce service vérifie la disponibilité de nos sites du monde entier.  Dans le cas où nous obtenons un code de réponse inacceptable (par exemple, 502), un incident est créé, puis tout suit la chaîne décrite ci-dessus.  StatusCake lui-même a la capacité de surveiller les URL internes, l'expiration d'un certificat ou d'un domaine SSL. <br><br><ul><li>  Librenms <br></li></ul><br>  Il s'agit d'un autre système de surveillance, plus d'informations à ce sujet peuvent être trouvées sur leur site Web <a href="https://www.librenms.org/">https://www.librenms.org/</a> .  Avec son aide, nous surveillons les interfaces réseau et iDRAC à partir des serveurs. <br><br><img src="https://habrastorage.org/webt/np/s1/w6/nps1w6rdvqei3g8xjisl14gkpra.png"><br><br>  Il y avait également des intégrations telles que Datadog, CloudWatch.  Pour en savoir plus sur ce qu'ils sont devenus, <a href="https://habr.com/ru/company/funcorp/blog/425431/">cliquez ici</a> . <br><br><h3>  Visualisation </h3><br>  Le principal système de signalement des incidents est Slack.  Tous les incidents qui arrivent sur PD sont écrits dans un chat spécial, et si leur statut change, cela est également affiché dans le chat. <br><br><img src="https://habrastorage.org/webt/n8/tc/vv/n8tcvvpb-yge19fvkex6czlqzfw.png"><br><br>  Quand il est devenu possible d'afficher des données utiles sur les écrans de moniteurs suspendus sous le plafond, nous avons soudain réalisé que nous (dans la section devops) n'avons rien à afficher sur eux.  Il y a un merveilleux Grafana, mais il ne peut tout simplement pas être couvert, et les employés répondent aux alertes, pas aux graphiques. <br><br>  Après une recherche approfondie mais infructueuse sur GitHub pour un «tableau» concis et informatif pour PD, nous avons décidé d'écrire le nôtre - uniquement avec ce dont nous avions besoin.  Bien qu'au départ, il y avait une idée d'afficher l'interface PD elle-même, cela semblait encore plus gênant. <br><br>  Pour l'écrire, il vous suffit d'obtenir la clé de PD avec des droits en lecture seule. <br>  Et voici ce que nous avons obtenu: <br><br><img src="https://habrastorage.org/webt/5e/fw/8w/5efw8w15hhnzulhg0gebjeis_8w.png"><br><br>  L'écran affiche les incidents ouverts actuels, le nom de l'ingénieur de service actuel du programme sélectionné et le temps sans incident de haute priorité (le panneau avec l'incident de haute priorité sera mis en surbrillance en rouge). <br><br>  <a href="https://github.com/suknark/pdviewer">Voir le code source de cette implémentation ici</a> . <br><br>  En conséquence, nous avons obtenu un tableau de bord pratique pour visualiser tous nos incidents.  Je serais heureux si l'un d'entre vous bénéficierait de notre expérience. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr481656/">https://habr.com/ru/post/fr481656/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr481640/index.html">Sortie de la nouvelle version du plugin DevOpsProdigy KubeGraf</a></li>
<li><a href="../fr481644/index.html">Comment survivre à une base de données SQL au 21e siècle: Cloud, Kubernetes et PostgreSQL multimaster</a></li>
<li><a href="../fr481648/index.html">Junos PyEZ sur l'exemple de la tâche de trouver des sous-réseaux ipv4 gratuits</a></li>
<li><a href="../fr481652/index.html">Backdoor (?) Sur les smartphones BlackBerry Android</a></li>
<li><a href="../fr481654/index.html">L'histoire de la façon dont l'ingénieur QA vous a simplifié la vie avec l'aide de Test IT, en utilisant le Bot Framework</a></li>
<li><a href="../fr481662/index.html">Essayer de nouveaux outils pour créer et automatiser le déploiement dans Kubernetes</a></li>
<li><a href="../fr481664/index.html">Prix ​​et coûts sans serveur: AWS Lambda</a></li>
<li><a href="../fr481666/index.html">Règles SwiftLint personnalisées</a></li>
<li><a href="../fr481668/index.html">Le premier problème de visionneuse ou les difficultés de conversion des flux vidéo WebRTC en HLS</a></li>
<li><a href="../fr481670/index.html">Créer un plan d'action à l'aide de AWS Cloud Adoption Framework</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>