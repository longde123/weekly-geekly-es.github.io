<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧖🏼 👨🏽‍⚖️ 👷🏼 Comment fonctionnent les tests A / B dans Avito? 👨🏽‍🚀 ♾ 👨🏿‍💻</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bonjour à tous. Je m'appelle Danila, je travaille dans une équipe qui développe une infrastructure analytique à Avito. Les tests A / B sont au cœur de...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment fonctionnent les tests A / B dans Avito?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/avito/blog/454164/"><p>  Bonjour à tous.  Je m'appelle Danila, je travaille dans une équipe qui développe une infrastructure analytique à Avito.  Les tests A / B sont au cœur de cette infrastructure. </p><br><p>  Les expériences A / B sont un outil décisionnel clé dans Avito.  Dans notre cycle de développement de produits, un test A / B est indispensable.  Nous testons chaque hypothèse et déployons uniquement des changements positifs. </p><br><p>  Nous collectons des centaines de métriques et sommes en mesure de les explorer jusqu'aux sections commerciales: verticales, régions, utilisateurs autorisés, etc. Nous le faisons automatiquement en utilisant une seule plate-forme pour les expériences.  Dans l'article, je vais vous expliquer en détail comment la plateforme est organisée et nous allons plonger dans quelques détails techniques intéressants. </p><br><p><img src="https://habrastorage.org/webt/ts/r_/qw/tsr_qwh3l7qfw2kob14z0lsaiya.png"></p><a name="habracut"></a><br><p>  Les principales fonctions de la plateforme A / B sont formulées comme suit. </p><br><ol><li>  Vous aide à exécuter rapidement des expériences </li><li>  Contrôle les intersections d'expériences indésirables </li><li>  Compte les métriques, stat.  teste, visualise les résultats </li></ol><br><p>  En d'autres termes, la plateforme permet de prendre des décisions sans erreur plus rapidement. </p><br><p>  Si nous omettons le processus de développement des fonctionnalités qui sont envoyées pour les tests, le cycle complet de l'expérience ressemble à ceci: </p><br><p><img src="https://habrastorage.org/webt/ve/wd/by/vewdbye97eexzetbj3riubs-i1w.png"></p><br><ul><li>  Le client (analyste ou chef de produit) configure les paramètres de l'expérience via le panneau d'administration. </li><li>  Le service divisé, en fonction de ces paramètres, distribue le groupe A / B nécessaire à l'appareil client. </li><li>  Les actions des utilisateurs sont collectées dans des journaux bruts qui passent par l'agrégation et se transforment en métriques. </li><li>  Les métriques sont exécutées à travers des tests statistiques. </li><li>  Les résultats sont visualisés sur le portail interne le lendemain du lancement. </li></ul><br><p>  Tout le transport de données dans un cycle prend une journée.  En règle générale, les expériences durent une semaine, mais le client reçoit chaque jour un incrément de résultats. </p><br><p>  Plongeons-nous maintenant dans les détails. </p><br><h1 id="upravlenie-eksperimentom">  Gestion des expériences </h1><br><p>  Le panneau d'administration utilise le format YAML pour configurer les expériences. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/lb/ko/k_/lbkok_pnexw8kzvdlkoq1jteuzy.png"></a> </p><br><p>  C'est une solution pratique pour une petite équipe: finaliser les capacités de la configuration se fait sans front.  L'utilisation de configurations de texte simplifie le travail de l'utilisateur: vous devez effectuer moins de clics avec la souris.  Une solution similaire est utilisée par le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">framework Airbnb A / B.</a> </p><br><p>  Pour diviser le trafic en groupes, nous utilisons la technique courante de hachage du sel. </p><br><p><img src="https://habrastorage.org/webt/fs/ar/r_/fsarr_kezrgckfiuvf1w1uyuqfs.png"></p><br><p>  Pour éliminer l'effet de "mémoire" des utilisateurs, lors du démarrage d'une nouvelle expérience, nous effectuons un mélange supplémentaire avec le second sel: </p><br><p><img src="https://habrastorage.org/webt/3-/qd/w0/3-qdw0xc2l0swwonorrgkfd_lpg.png"></p><br><p>  Le même principe est décrit dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">présentation de Yandex</a> . </p><br><p>  Afin d'éviter les intersections potentiellement dangereuses d'expériences, nous utilisons une logique <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">similaire aux «couches» dans Google</a> . </p><br><h1 id="sbor-metrik">  Collection de métriques </h1><br><p>  Nous plaçons les journaux bruts dans Vertica et les agrégons dans des tableaux de préparation avec la structure: </p><br><p><img src="https://habrastorage.org/webt/v6/tw/bv/v6twbvgj-togpdbylpqq21gfbz0.png"></p><br><p>  Les observations sont généralement de simples compteurs d'événements.  Les observations sont utilisées comme composants dans la formule de calcul métrique. </p><br><p>  La formule de calcul de toute métrique est une fraction, au numérateur et au dénominateur, qui est la somme des observations: </p><br><p><img src="https://habrastorage.org/webt/me/sb/or/mesbordzixv0yrcl4oo5nho5aa4.png"></p><br><p>  Dans l'un des <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapports</a> de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Yandex, les</a> mesures étaient divisées en deux types: par utilisateurs et par rapport.  Cela a un sens commercial, mais dans l'infrastructure, il est plus pratique de considérer toutes les mesures de la même manière que Ratio.  Cette généralisation est valable, car la métrique "posyuzerny" est évidemment représentable comme une fraction: </p><br><p><img src="https://habrastorage.org/webt/d_/ih/l5/d_ihl5vdcvdguaohaytz5xkfepy.png"></p><br><p>  Nous résumons les observations au numérateur et au dénominateur de la métrique de deux manières. <br>  Simple: </p><br><p><img src="https://habrastorage.org/webt/q9/fk/vc/q9fkvc6qsmj6dzwqknqnqwpgrts.png"></p><br><p>  C'est le montant habituel de tout ensemble d'observations: le nombre de recherches, les clics sur les publicités, etc. <br>  Et plus compliqué: </p><br><p><img src="https://habrastorage.org/webt/iu/_s/ru/iu_srukdm2pyxrvoizc68butlx8.png"></p><br><p>  Un nombre unique de clés, dans le groupe par lequel le total des observations est supérieur à un seuil donné. </p><br><p>  Ces formules sont facilement définies à l'aide de la configuration YAML: </p><br><p><img src="https://habrastorage.org/webt/ga/i3/qj/gai3qjape-xmwg2pyfg0snj6lao.png"></p><br><p>  Les paramètres groupby et seuil sont facultatifs.  Ils déterminent simplement la deuxième méthode de sommation. </p><br><p>  Les normes décrites vous permettent de configurer presque toutes les mesures en ligne auxquelles vous pouvez penser.  En même temps, une logique simple est préservée qui n'impose pas une charge excessive à l'infrastructure. </p><br><h1 id="statisticheskiy-kriteriy">  Critère statistique </h1><br><p>  Nous mesurons l'importance des écarts par des métriques en utilisant les méthodes classiques: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">test T</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">test</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">U de Mann-Whitney</a> .  La principale condition nécessaire à l'application de ces critères est que les observations de l'échantillon ne doivent pas dépendre les unes des autres.  Dans presque toutes nos expériences, nous pensons que les utilisateurs (Uid) remplissent cette condition. </p><br><p><img src="https://habrastorage.org/webt/v-/ya/nz/v-yanzyx8c--fqqgnzkhlkg4j0c.png"></p><br><p>  Maintenant, la question se pose: comment effectuer le test T et le test MW pour les métriques Ratio?  Pour le test T, vous devez être en mesure de lire la variance de l'échantillon, et pour MW, l'échantillon doit être «défini par l'utilisateur». </p><br><p><img src="https://habrastorage.org/webt/d-/7j/p2/d-7jp2xfsktkjajzki-wrp8sugw.png"></p><br><p>  Réponse: vous devez étendre le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapport d'une série Taylor au premier ordre à un moment donné</a> <math> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u="></a></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>E</mi></mrow><mtext>&amp;#xA0;</mtext><mi>g</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy=&quot;false&quot;>[</mo><mi>X</mi><mtext>&amp;#xA0;</mtext><mi>d</mi><mi>r</mi><mi>o</mi><mi>i</mi><mi>t</mi><mi>e</mi><mo stretchy=&quot;false&quot;>]</mo><mo>,</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>E</mi></mrow><mtext>&amp;#xA0;</mtext><mi>g</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy=&quot;false&quot;>[</mo><mi>Y</mi><mtext>&amp;#xA0;</mtext><mi>d</mi><mi>r</mi><mi>o</mi><mi>i</mi><mi>t</mi><mi>e</mi><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.503ex" height="2.66ex" viewBox="0 -832 17869.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-45" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-67" x="1404" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-61" x="1884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-75" x="2414" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-63" x="2986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-68" x="3420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-65" x="3996" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMAIN-5B" x="4463" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-58" x="4741" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-64" x="5844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-72" x="6367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-6F" x="6819" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-69" x="7304" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-74" x="7650" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-65" x="8011" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMAIN-5D" x="8478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMAIN-2C" x="8756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-45" x="9201" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-67" x="10216" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-61" x="10696" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-75" x="11226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-63" x="11798" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-68" x="12232" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-65" x="12808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMAIN-5B" x="13275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-59" x="13553" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-64" x="14567" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-72" x="15090" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-6F" x="15542" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-69" x="16027" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-74" x="16373" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMATHI-65" x="16734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMAIN-5D" x="17201" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/avito/blog/454164/&amp;usg=ALkJrhi_GL4_hDXPkAHX2AdRRcJkP33B8Q#MJMAIN-29" x="17479" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi>E</mi></mrow><mtext>&nbsp;</mtext><mi>g</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>X</mi><mtext>&nbsp;</mtext><mi>d</mi><mi>r</mi><mi>o</mi><mi>i</mi><mi>t</mi><mi>e</mi><mo stretchy="false">]</mo><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi>E</mi></mrow><mtext>&nbsp;</mtext><mi>g</mi><mi>a</mi><mi>u</mi><mi>c</mi><mi>h</mi><mi>e</mi><mo stretchy="false">[</mo><mi>Y</mi><mtext>&nbsp;</mtext><mi>d</mi><mi>r</mi><mi>o</mi><mi>i</mi><mi>t</mi><mi>e</mi><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-1"> ({E} \ gauche [X \ droite], {E} \ gauche [Y \ droite]) </script>   : </p><br><p><img src="https://habrastorage.org/webt/ky/im/td/kyimtdhnynvygcu_r867uzeoubu.png"></p><br><p>  Cette formule convertit deux échantillons (numérateur et dénominateur) en un seul, en préservant la moyenne et la variance (asymptotiquement), ce qui permet d'utiliser des statistiques classiques.  tests. </p><br><p><img src="https://habrastorage.org/webt/il/h3/ac/ilh3acbdbdjnszyjezba85ee4ku.png"></p><br><p>  Une idée similaire est appelée par les collègues de Yandex la méthode de linéarisation Ratio (apparitions <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">uniques</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">doubles</a> ). </p><br><h1 id="proizvoditelnost-pri-masshtabirovanii">  Mise à l'échelle des performances </h1><br><p>  Utilisation rapide pour les statistiques du processeur.  critères permet de réaliser des millions d'itérations (comparaisons traitement vs contrôle) en quelques minutes sur un serveur tout à fait ordinaire à 56 cœurs.  Mais dans le cas de gros volumes de données, les performances reposent tout d'abord sur le stockage et le temps de lecture à partir du disque. </p><br><p>  Le calcul des métriques Uid génère quotidiennement des échantillons d'une taille totale de centaines de milliards de valeurs (en raison du grand nombre d'expériences simultanées, de centaines de métriques et d'une accumulation cumulée).  Il est trop problématique d'extraire de tels volumes du disque tous les jours (malgré le grand cluster de la base de colonne Vertica).  Par conséquent, nous sommes obligés de réduire la cardinalité des données.  Mais nous le faisons presque sans perte d'informations sur la variance en utilisant une technique appelée «Bucket». </p><br><p>  L'idée est simple: on hache les Uid et, selon le reste de la division, on les "disperse" en plusieurs seaux (on note leur nombre par B): </p><br><p><img src="https://habrastorage.org/webt/cd/1h/x-/cd1hx-k8rgilkmwxafotz3-tgok.png"></p><br><p>  Nous passons maintenant à la nouvelle unité expérimentale - le seau.  Nous résumons les observations dans le seau (le numérateur et le dénominateur sont indépendants): </p><br><p><img src="https://habrastorage.org/webt/yv/jq/bz/yvjqbz34yd8yswtoff50zpgj3g0.png"></p><br><p>  Avec cette transformation, la condition d'indépendance des observations est remplie, la valeur métrique ne change pas et il est facile de vérifier que la variance de la métrique (moyenne sur l'échantillon d'observations) est préservée: </p><br><p><img src="https://habrastorage.org/webt/df/ku/6p/dfku6pb74plagc0doxg62blhdly.png"></p><br><p>  Plus il y a de bucket, moins les informations sont perdues et plus l'erreur d'égalité est petite.  Dans Avito, nous prenons B = 200. </p><br><p>  La densité de distribution métrique après la conversion du compartiment devient toujours similaire à la normale. </p><br><p><img src="https://habrastorage.org/webt/fk/sa/rf/fksarfomowkwdzzhwveb10vbtr0.png"></p><br><p>  Autant de grands échantillons que vous le souhaitez peuvent être réduits à une taille fixe.  La croissance de la quantité de données stockées dans ce cas ne dépend que linéairement du nombre d'expériences et de métriques. </p><br><h1 id="vizualizaciya-rezultatov">  Visualisation des résultats </h1><br><p>  En tant qu'outil de visualisation, nous utilisons Tableau et la vue Web sur Tableau Server.  Chaque employé Avito y a accès.  Il convient de noter que Tableau fait bien le travail.  Mettre en œuvre une solution similaire en utilisant un développement arrière / frontal complet serait une tâche beaucoup plus gourmande en ressources. </p><br><p>  Les résultats de chaque expérience sont une feuille de plusieurs milliers de nombres.  La visualisation doit être de nature à minimiser les conclusions incorrectes dans le cas de la mise en œuvre d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">erreurs du premier et du deuxième type</a> , et en même temps à ne pas «manquer» les changements dans les métriques et sections importantes. </p><br><p>  Tout d'abord, nous surveillons les mesures de «santé» des expériences.  Autrement dit, nous répondons aux questions: "Est-il vrai que les participants ont été" déversés "dans chacun des groupes?", "Est-ce égal aux utilisateurs autorisés ou nouveaux?" </p><br><p> <a href=""><img src="https://habrastorage.org/webt/k1/-r/-x/k1-r-xrjn1gyeg8-o6-9eolq-qe.png"></a> </p><br><p>  En cas d'écarts statistiquement significatifs, les cellules correspondantes sont mises en évidence.  Lorsque vous survolez un nombre quelconque, la dynamique cumulée de la journée s'affiche. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/ju/ke/z0/jukez0yfvsmoyu_gmpy384rsmzc.png" width="600"></a> </p><br><p>  Le tableau de bord principal avec des mesures ressemble à ceci: </p><br><p> <a href=""><img src="https://habrastorage.org/webt/ng/mb/ju/ngmbjufio9wsbf0mnpld0ldqajq.png"></a> </p><br><p>  Chaque ligne est une comparaison de groupes par une métrique spécifique dans une section spécifique.  À droite, un panneau avec des filtres pour les expériences et les mesures.  Panneau filtrant de section inférieure. </p><br><p>  Chaque comparaison de métriques se compose de plusieurs métriques.  Analysons leurs valeurs de gauche à droite: </p><br><p>  <strong>1. MDE.</strong>  <strong>Effet détectable minimum</strong> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/sy/xw/gk/syxwgkaimg-pgsqtnrriv8ybf5e.png"></a> </p><br><p>  ⍺ et β sont des probabilités d'erreur présélectionnées du premier et du deuxième type.  MDE est très important si le changement n'est pas statistiquement significatif.  Lors de la prise de décision, le client doit se rappeler que le manque de stat.  la signification n'est pas sans effet.  De manière assez fiable, nous pouvons seulement dire que l'effet possible n'est rien de plus que MDE. </p><br><p>  <strong>2. MW |</strong>  <strong>Résultats des tests U et T de T. Mann-Whitney</strong> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/za/vs/j8/zavsj8pnzmrazz-maz_lucwjrti.png"></a> </p><br><p>  Le panneau affiche la valeur des statistiques z et t (pour MW et T, respectivement).  Dans une info-bulle - dynamique de la valeur p.  Si le changement est significatif, la cellule est surlignée en rouge ou vert, selon le signe de la différence entre les groupes.  Dans ce cas, nous disons que la métrique est «colorée». </p><br><p>  <strong>3. Soulevez.</strong>  <strong>Différence en pourcentage entre les groupes</strong> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/cr/db/fk/crdbfkcytwrjdzez3l-v1gu1c8e.png"></a> </p><br><p>  <strong>4. Moyenne |</strong>  <strong>Num |</strong>  <strong>Den</strong>  <strong>Valeur métrique, ainsi que numérateur et dénominateur séparément</strong> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/8d/kc/wp/8dkcwpugkmf6f6qqdrmnksp-rda.png"></a> </p><br><p>  Nous appliquons un autre test T au numérateur et au dénominateur, ce qui aide à comprendre dont la contribution est décisive. </p><br><p>  <strong>5. Std.</strong>  <strong>Écart type sélectif</strong> <br>  <strong>6. Hist.</strong>  <strong>Test de Shapiro-Wilk pour la normalité de la distribution «bucket».</strong> </p><br><p> <a href=""><img src="https://habrastorage.org/webt/0d/dh/h6/0ddhh68_mdhgjpb6dyufnucnmfc.png"></a> </p><br><p>  Si l'indicateur est rouge, alors l'échantillon peut avoir des valeurs aberrantes ou une queue anormalement longue.  Dans ce cas, vous devez prendre le résultat selon cette métrique avec soin, ou pas du tout.  Un clic sur l'indicateur ouvre l'histogramme de la métrique par groupe.  L'histogramme montre clairement des anomalies - il est plus facile de tirer des conclusions. </p><br><h1 id="zaklyuchenie">  Conclusion </h1><br><p>  L'émergence de la plateforme A / B à Avito est un tournant décisif lorsque notre produit a commencé à croître plus rapidement.  Chaque jour, nous faisons des expériences vertes qui font payer l'équipe;  et les «rouges», qui donnent matière à réflexion. </p><br><p>  Nous avons réussi à construire un système efficace de tests et de métriques A / B.  Souvent, nous avons résolu des problèmes complexes avec des méthodes simples.  En raison de cette simplicité, l'infrastructure a une bonne marge de sécurité. </p><br><p>  Je suis sûr que ceux qui vont construire la plate-forme A / B dans leur entreprise ont trouvé des informations intéressantes dans l'article.  Je suis heureux de partager notre expérience avec vous. </p><br><p>  Écrivez vos questions et commentaires - nous essaierons d'y répondre. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr454164/">https://habr.com/ru/post/fr454164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr454144/index.html">Dans Java 13, ils veulent ajouter des «blocs de texte»</a></li>
<li><a href="../fr454148/index.html">Vérification des performances SOC</a></li>
<li><a href="../fr454154/index.html">"Branches de l'enfer": contrôle des nuages ​​des décharges illégales et des décharges dangereuses</a></li>
<li><a href="../fr454156/index.html">Pneus et protocoles en automatisation industrielle: comment tout cela fonctionne</a></li>
<li><a href="../fr454160/index.html">Utilisation de PowerShell pour augmenter les privilèges des comptes locaux</a></li>
<li><a href="../fr454166/index.html">6 juin - VeeamON Forum à Moscou</a></li>
<li><a href="../fr454168/index.html">L'arène principale du pays. Comment Luzhniki a-t-il été mis à jour avant la Coupe du monde</a></li>
<li><a href="../fr454170/index.html">Bienvenue au Meetup DroidHeads le 8 juin</a></li>
<li><a href="../fr454172/index.html">Envoi de statistiques d'un DataFrame à BigQuery en utilisant les statistiques Yandex.Direct comme exemple</a></li>
<li><a href="../fr454176/index.html">Uibook - un outil de test visuel pour les composants React avec des requêtes de médias</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>