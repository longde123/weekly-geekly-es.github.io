<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕐 🐵 🧛🏿 Apa yang dapat dilakukan dengan anotasi kontrak layanan mikro? 👩🏼‍🌾 👩🏿‍✈️ 🤜</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dalam posting sebelumnya , kami berbicara tentang bagaimana dan mengapa kami di Ancronis membuat anotasi untuk layanan microser, dan berjanji untuk be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Apa yang dapat dilakukan dengan anotasi kontrak layanan mikro?</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/acronis/blog/470910/">  Dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">posting</a> sebelumnya <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">,</a> kami berbicara tentang bagaimana dan mengapa kami di Ancronis membuat anotasi untuk layanan microser, dan berjanji untuk berbagi praktik kami menggunakan format API tunggal untuk seluruh Acronis Cyber ​​Platform.  Hari ini kami akan menceritakan tentang pengalaman kami tentang pemeriksaan anotasi statis - alias langkah pertama untuk memperkenalkan anotasi di perusahaan. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u="><img src="https://habrastorage.org/webt/hm/0k/un/hm0kunnfzs9fvcgleqiyumvqny8.jpeg"></a> <br><a name="habracut"></a><br>  Jadi, misalkan Anda sudah memiliki anotasi untuk semua atau sebagian besar API.  Sebuah pertanyaan masuk akal yang juga ditanyakan oleh rekan kerja kami: "Apa yang bisa dilakukan dengan benda-benda ajaib ini?" <br><br>  Bahkan, ada dua jenis pemeriksaan yang dapat dilakukan secara langsung oleh anotasi.  Pemeriksaan statis langsung ke teks penjelasan Swagger atau RAML.  Mereka tidak membutuhkan hal lain, dan mereka dapat dianggap sebagai keuntungan pertama dari menggunakan kontrak layanan mikro yang diformalkan. <br><br>  Pemeriksaan dinamis hanya dapat dimulai jika Anda memiliki layanan yang berfungsi.  Mereka agak lebih rumit, karena mereka memungkinkan Anda untuk menyelam lebih dalam dan memeriksa seberapa valid anotasi sama sekali, menguji stabilitas layanan, dan juga melakukan lebih banyak lagi.  Tapi ini adalah topik postingan berikutnya, dan hari ini kita akan fokus pada statika. <br><br><h3>  Hidupkan Panduan API! </h3><br>  Agar tidak membingungkan diri sendiri atau orang lain, perlu segera disebutkan bahwa pemeriksaan anotasi statis dibuat untuk mengontrol kesesuaian anotasi API (dan, semoga, API sendiri) dengan persyaratan perusahaan.  Ini bisa berupa praktik yang diadopsi oleh perusahaan, atau API Pedoman yang lengkap, yang memformalkan aturan untuk menyiapkan API untuk layanan Anda. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/084/f24/61b/084f2461b8fa9d944fbcf83ce4618ab7.jpg" alt="gambar"><br><br>  Ketika kita berbicara tentang dunia penuh warna dari layanan mikro, ini sangat penting, karena setiap tim dapat memiliki kerangka kerja sendiri, bahasa pemrogramannya sendiri, tumpukan unik, atau beberapa perpustakaan khusus.  Di bawah pengaruh praktik khusus untuk layanan mikro, penyajian API untuk pengamat eksternal berubah.  Ini menciptakan variasi yang tidak perlu.  Untuk interaksi elemen-elemen ekosistem (atau platform) yang efektif, perlu untuk "menyelaraskan" API sebanyak mungkin. <br><br>  Berikut ini sebuah contoh: 404 kode dikembalikan ke API dari satu komponen hanya jika sumber daya tidak ada.  Dan tim lain mengikat kesalahan ini ke logika aplikasi dan API akan mengembalikan 404 ketika pengguna ingin membeli produk yang telah berakhir di gudang.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=" class="user_link">Atygaev</a> menggambarkan masalah ini dengan sangat jelas di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> .  Ketidakkonsistenan dalam memahami kode 404 ini akan memperlambat pengembangan dan mengarah pada kesalahan, yang berarti panggilan untuk dukungan atau jam kerja debug yang tidak perlu, tetapi dalam hal apa pun, masalah diukur dalam istilah moneter. <br><br>  Spesifikasi sintaksis dan penamaan yang diadopsi oleh perusahaan dilengkapi dengan berbagai aspek khusus untuk REST itu sendiri.  Pengembang harus menjawab pertanyaan seperti: <br><br><ul><li>  Akankah POST idempoten atau tidak? </li><li>  Kode kesalahan apa yang kami gunakan dan apa artinya? </li><li>  Bisakah saya menambahkan logika bisnis ke kode kesalahan? </li></ul><br>  Sekarang bayangkan bahwa masing-masing tim secara individual harus memikirkan jawaban-jawaban ini. <br><br>  Format permintaan pencarian juga bisa sangat berbeda.  Misalnya, ada sekitar selusin cara untuk membuat sampel di mana hanya pengguna yang memiliki MacBookPro dan serangan virus yang sering akan terdaftar.  Ketika mengerjakan sebuah proyek besar yang terdiri dari puluhan layanan microser, perlu bahwa sintaks dari kueri pencarian adalah umum untuk semua versi dan produk perusahaan.  Dan jika seseorang terbiasa merujuk ke salah satu produk / layanan pengembangan Anda, ia mengharapkan untuk menemukan permintaan dan struktur respons yang sama di yang lain.  Kalau tidak, keheranan (dan kesedihan) tidak akan terhindarkan. <br><br>  Banyak perusahaan, terutama raksasa, seperti <a href="">Microsoft</a> , <a href="">PayPal</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Google</a> , memiliki pedoman sendiri, dan mereka dipikirkan dengan sangat baik.  Tetapi menggunakan pedoman orang lain tidak selalu memungkinkan, karena mereka sebagian besar terikat pada spesifikasi perusahaan.  Selain itu, pemikiran setiap orang memiliki struktur yang berbeda, dan aturan mungkin berbeda hanya karena lebih nyaman bagi orang untuk bekerja dengan cara ini dan bukan sebaliknya. <br><br>  Pemahaman bahwa Acronis membutuhkan Pedoman APInya sendiri tidak datang dengan segera, tetapi dengan semakin banyaknya pengembang, layanan mikro, dan sebenarnya klien eksternal dan integrasi.  Pada titik tertentu, tim arsitek harus menetapkan aturan yang seragam untuk menyatakan API, dengan mempertimbangkan pengalaman para raksasa TI yang disebutkan di atas dan sudah menetapkan praktik de facto di tim pengembangan. <br><br>  Salah satu masalah dengan keterlambatan implementasi API Pedoman ini adalah API yang telah diterbitkan yang tidak memenuhi persyaratan, yang pada gilirannya menyebabkan biaya tambahan untuk mendesain ulang antarmuka dan menjaga kompatibilitas ke belakang.  Karena itu, jika model bisnis Anda melibatkan integrasi dan publikasi API di masa mendatang, maka Anda perlu memikirkan aturan yang seragam sedini mungkin. <br><br><img src="https://habrastorage.org/webt/qt/yf/gz/qtyfgz3v0rojzm0dubyojcwl6hw.png"><br><br>  Tentu saja, penerapan API Pedoman tidak secara otomatis membuat semua API bersifat konstitutif.  Setiap API harus dianalisis, setiap devlid harus memahami persyaratan baru.  Oleh karena itu, kami melakukan otomatisasi pemeriksaan RAML terhadap API Pedoman yang kami kembangkan. <br>  Analisis statis <br><br>  Pertama, Anda perlu memutuskan apa yang akan kami analisis secara statis.  Tidak semua poin API Pedoman dapat diformalkan, jadi pertama-tama Anda harus menyoroti serangkaian aturan yang dapat dengan mudah dipahami dari anotasi API. <br><br>  Dalam versi pertama, kami mengidentifikasi aturan berikut: <br><br><ol><li>  Periksa deskripsi API.  Seperti yang kami katakan di artikel kami sebelumnya, Anda dapat membuat dokumentasi yang indah berdasarkan anotasi API.  Ini berarti bahwa setiap sumber daya, parameter kueri, dan respons harus memiliki deskripsi yang akan memberikan semua informasi yang diperlukan kepada pengguna API kami.  Tampaknya hal itu sepele, tetapi betapa mudahnya menunjukkan kepada pengembang bahwa penjelasan mereka tidak kaya akan deskripsi! </li><li>  Memeriksa keberadaan dan kebenaran contoh.  Bahasa anotasi API juga memungkinkan Anda untuk menjelaskan contoh.  Misalnya, sebagai respons kita dapat menambahkan contoh respons layanan nyata, sesuatu dari kehidupan nyata.  Menggunakan contoh memberi tahu bagaimana titik akhir harus digunakan dan berfungsi, dan kami memeriksa contoh melalui analisis statis anotasi. </li><li>  Validasi kode respons HTTP.  Standar HTTP mendefinisikan sejumlah besar kode, tetapi mereka dapat ditafsirkan dengan cara yang berbeda.  Pedoman kami meresmikan penggunaan kode.  Kami juga membatasi penerapan kode yang berbeda sesuai dengan metode HTTP.  Misalnya, kode 201, sesuai dengan spesifikasi HTTP, dikembalikan ketika sumber daya dibuat.  Oleh karena itu, GET yang mengembalikan 201 akan berupa panggilan pengaktifan (kode salah digunakan, atau GET membuat sumber daya).  Oleh karena itu, API Pedoman kami melarang penggunaan tersebut.  Selain itu, arsitek telah menetapkan set kode untuk setiap metode, dan sekarang kami memeriksanya dalam mode statis di tingkat anotasi. </li><li>  Memeriksa metode HTTP.  Semua orang tahu bahwa protokol HTTP memiliki seperangkat metode standar (GET, POST, PUT, dll.), Dan juga memungkinkan untuk menggunakan metode khusus.  API Pedoman kami menjelaskan metode yang diizinkan yang diizinkan, tetapi tidak diinginkan (PILIHAN), serta sepenuhnya dilarang (hanya dapat digunakan dengan restu dari arsitek).  Dilarang menyertakan metode KEPALA standar, serta metode kustom apa pun.  Semua ini juga mudah diverifikasi dalam anotasi kontrak. </li><li>  Verifikasi hak akses.  Kami berharap bahwa pada 2019 kebutuhan akan dukungan otorisasi tidak memerlukan penjelasan tambahan.  Dokumentasi yang baik harus mencakup informasi tentang peran yang didukung oleh API dan metode API apa yang tersedia untuk setiap peran.  Selain mendokumentasikan informasi tentang panutan, yang direkam pada tingkat anotasi, memungkinkan Anda untuk melakukan hal-hal yang jauh lebih menarik dalam dinamika, namun, kami akan membicarakan hal ini di artikel berikutnya. </li><li>  Validasi penamaan.  Meredakan sakit kepala karena menggunakan berbagai pendekatan untuk memberi nama entitas.  Secara umum, ada dua "kamp" - pendukung CamelCase dan snake_case.Camelcase - ketika setiap kata dimulai dengan huruf kapital, dan snake_case - ketika kata-kata dipisahkan oleh garis bawah dan semuanya ditulis dalam huruf kecil.  Dalam bahasa yang berbeda, biasanya memberi nama dengan cara yang berbeda.  Misalnya, snake_case diterima dengan Python, dan CamelCase diadopsi di Go atau Java.  Kami membuat pilihan sendiri universal untuk semua proyek dan diperbaiki dalam Pedoman API.  Oleh karena itu, melalui anotasi, kami memeriksa nama sumber daya dan parameter secara statis; </li><li>  Validasi header khusus.  Ini adalah contoh lain dari pemeriksaan penamaan, tetapi terkait khusus dengan kepala.  Pada kami di Acronis, sudah biasa menggunakan format formulir X-Custom-Header-Name (terlepas dari kenyataan bahwa format ini sudah usang).  Dan kami mengontrol kepatuhannya pada tingkat anotasi. </li><li>  Verifikasi dukungan HTTPS.  Setiap layanan modern harus mendukung HTTPS, dan beberapa percaya bahwa bekerja dengan HTTP hari ini umumnya berita buruk.  Karena itu, anotasi RAML atau Swagger harus diindikasikan.  bahwa layanan mikro mendukung HTTPS tanpa HTTP. </li><li>  Verifikasi struktur URI.  Pada masa prasejarah, yaitu, sebelum dirilisnya Guideline API, permintaan URI tampak berbeda di berbagai layanan: tempat / api / 2, tempat / api / service_name / v2, dan seterusnya.  Sekarang dalam pedoman kami, struktur URI standar didefinisikan untuk semua API kami.  Manual ini menjelaskan bagaimana mereka harus terlihat agar tidak menimbulkan kebingungan. </li><li>  Memeriksa kompatibilitas versi baru.  Faktor lain yang harus diingat oleh setiap pembuat API adalah kompatibilitas ke belakang.  Penting untuk memeriksa apakah kode yang dibangun berdasarkan API lama dapat berfungsi dengan versi yang baru.  Berdasarkan perubahan ini dapat dibagi menjadi dua kategori: melanggar kompatibilitas mundur dan kompatibel.  Semua orang tahu bahwa melanggar perubahan tidak dapat diterima, dan jika Anda ingin secara dramatis "meningkatkan" sesuatu, pengembang harus merilis versi baru dari API. Tetapi semua orang bisa salah, jadi tujuan kami yang lain pada tahap pemeriksaan statis adalah untuk melewati hanya perubahan yang kompatibel dan bersumpah pada yang tidak kompatibel.  Diasumsikan bahwa anotasi, seperti kode, disimpan dalam repositori dan, oleh karena itu, ia memiliki seluruh sejarah perubahan.  Oleh karena itu, kami dapat memeriksa REST HTTP kami untuk kompatibilitas ke belakang.  Misalnya, penambahan kompatibilitas (metode, parameter, kode respons) tidak melanggar, dan penghapusan mungkin menyebabkan hilangnya kompatibilitas.  Dan ini sudah dapat diperiksa di tingkat anotasi. </li></ol><br><br> <i><img src="https://habrastorage.org/webt/kt/vo/wc/ktvowckxsyc4hujr2owbwmvy2qe.png"><br></i>  <i>Ketika tidak ada deskripsi</i> <i><br><img src="https://habrastorage.org/webt/po/dv/k6/podvk6eqjgnydciv-jzbbw7-nm4.png"><br></i>  <i>Ketika ada deskripsi</i> <i><br></i> <br><h3>  Kesimpulan </h3><br>  Analisis statis anotasi diperlukan untuk memeriksa (tidak, bukan kualitas layanan), tetapi kualitas API.  Tahap ini memungkinkan Anda untuk menyelaraskan antarmuka program satu sama lain sehingga orang-orang bekerja di lingkungan yang jelas dan mudah dimengerti di mana semuanya bisa diprediksi. <br><br>  Tentu saja, itu hanya perlu untuk berurusan dengan formalisme seperti itu di perusahaan yang cukup besar, ketika memeriksa semua korespondensi "secara manual" sangat panjang, mahal dan tidak dapat diandalkan.  Sebuah startup kecil tidak membutuhkannya.  Setidaknya untuk saat ini.  Tetapi jika di masa depan Anda ada rencana untuk menjadi unicorn, seperti Akronis, maka pemeriksaan statis dan API Pedoman akan membantu Anda. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id470910/">https://habr.com/ru/post/id470910/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id470892/index.html">Implementasi sederhana dari CAM kecil pada FPGA</a></li>
<li><a href="../id470894/index.html">Peluru</a></li>
<li><a href="../id470902/index.html">Kinerja tinggi dan partisi asli: Zabbix dengan dukungan TimescaleDB</a></li>
<li><a href="../id470904/index.html">Jalur terlembut dan paling berbulu di Machine Learning dan Deep Neural Networks</a></li>
<li><a href="../id470908/index.html">Untuk pertama kalinya di dunia dengan bantuan teknologi aditif, perakitan mesin pesawat terbang berukuran besar diperoleh</a></li>
<li><a href="../id470916/index.html">Pos pemeriksaan elektronik "termurah" di Rusia dikendalikan dari smartphone</a></li>
<li><a href="../id470918/index.html">F # 9: Opsi Opsi</a></li>
<li><a href="../id470920/index.html">5+ Cara Menghubungkan ke DataLine Cloud</a></li>
<li><a href="../id470922/index.html">Pengumuman mitap ThinkJava # 10 di Kharkov</a></li>
<li><a href="../id470924/index.html">Mengapa untuk proyek baru saya mengambil Robot Framework</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>