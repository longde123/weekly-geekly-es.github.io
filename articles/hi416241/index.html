<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ЁЯжН ЁЯХ║ЁЯП╗ ЁЯФГ рдкрд╛рдпрдерди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдкрд░ рдорд╛рд░рд┐рдпреЛ рдмреНрд░реЛрд╕ рд╕реЗ рд╕реНрддрд░реЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛ ЁЯСзЁЯП╝ ЁЯС┐ ЁЯзХЁЯП╝</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="рдкрд░рд┐рдЪрдп 
 рдПрдХ рдирдП рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП, рдореБрдЭреЗ 1985 рдХреЗ рдХреНрд▓рд╛рд╕рд┐рдХ рд╡реАрдбрд┐рдпреЛ рдЧреЗрдо рд╕реБрдкрд░ рдорд╛рд░рд┐рдпреЛ рдмреНрд░реЛрд╕ (рдПрд╕рдПрдордмреА) рд╕реЗ рд╕реНрддрд░реАрдп рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереАред рдЕрдзрд┐рдХ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдо...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>рдкрд╛рдпрдерди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕реБрдкрд░ рдорд╛рд░рд┐рдпреЛ рдмреНрд░реЛрд╕ рд╕реЗ рд╕реНрддрд░реЛрдВ рдХреЛ рдкреБрдирдГ рдкреНрд░рд╛рдкреНрдд рдХрд░рдирд╛</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/416241/"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/707/a7a/80a/707a7a80afb88c419beb17be9e108272.png"></div><br><h2>  рдкрд░рд┐рдЪрдп </h2><br>  рдПрдХ рдирдП рдкреНрд░реЛрдЬреЗрдХреНрдЯ рдХреЗ рд▓рд┐рдП, рдореБрдЭреЗ 1985 рдХреЗ рдХреНрд▓рд╛рд╕рд┐рдХ рд╡реАрдбрд┐рдпреЛ рдЧреЗрдо <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╕реБрдкрд░ рдорд╛рд░рд┐рдпреЛ рдмреНрд░реЛрд╕ (рдПрд╕рдПрдордмреА)</a> рд╕реЗ рд╕реНрддрд░реАрдп рдбреЗрдЯрд╛ рдирд┐рдХрд╛рд▓рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереАред  рдЕрдзрд┐рдХ рд╡рд┐рд╢реЗрд╖ рд░реВрдк рд╕реЗ, рдореИрдВ рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕, рдЪрд▓рддреА рд╕реНрдкреНрд░рд╛рдЗрдЯреНрд╕ рдЖрджрд┐ рдХреЗ рдмрд┐рдирд╛ рдЦреЗрд▓ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрддрд░ рдХреЗ рдкреГрд╖реНрдарднреВрдорд┐ рдЧреНрд░рд╛рдлрд┐рдХреНрд╕ рдХреЛ рдирд┐рдХрд╛рд▓рдирд╛ рдЪрд╛рд╣рддрд╛ рдерд╛ред <br><br>  рдмреЗрд╢рдХ, рдореИрдВ рдмрд╕ рдЦреЗрд▓ рд╕реЗ рдЫрд╡рд┐рдпреЛрдВ рдХреЛ рдЧреЛрдВрдж рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВ рдФрд░ рд╕рдВрднрд╡рддрдГ, рдорд╢реАрди рд╡рд┐рдЬрди рддрдХрдиреАрдХреЛрдВ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░ рд╕рдХрддрд╛ рд╣реВрдВред  рд▓реЗрдХрд┐рди рдпрд╣ рдореБрдЭреЗ рдиреАрдЪреЗ рд╡рд░реНрдгрд┐рдд рд╡рд┐рдзрд┐ рд╕реЗ рдЕрдзрд┐рдХ рджрд┐рд▓рдЪрд╕реНрдк рд▓рдЧ рд░рд╣рд╛ рдерд╛, рдЬреЛ рдЖрдкрдХреЛ рдЙрди рд╕реНрддрд░ рддрддреНрд╡реЛрдВ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрддрд╛ рд╣реИ рдЬреЛ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рдкрд░рд┐рдпреЛрдЬрдирд╛ рдХреЗ рдкрд╣рд▓реЗ рдЪрд░рдг рдореЗрдВ, рд╣рдо 6502 рдХреЛрдбрд╛рдВрддрд░рдХ рднрд╛рд╖рд╛ рдФрд░ рдкрд╛рдпрдерди рдореЗрдВ рд▓рд┐рдЦрд┐рдд рдПрдХ рдПрдореБрд▓реЗрдЯрд░ рд╕реАрдЦреЗрдВрдЧреЗред  рдкреВрд░реНрдг рд╕реНрд░реЛрдд рдХреЛрдб <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдпрд╣рд╛рдВ</a> рдЙрдкрд▓рдмреНрдз <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╣реИ</a> ред <br><a name="habracut"></a><br><h2>  рд╕реНрд░реЛрдд рдХреЛрдб рд╡рд┐рд╢реНрд▓реЗрд╖рдг </h2><br>  рдХрд┐рд╕реА рднреА рдХрд╛рд░реНрдпрдХреНрд░рдо рдХрд╛ рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдмрд╣реБрдд рд╕рд░рд▓ рд╣реИ рдпрджрд┐ рдЖрдкрдХреЗ рдкрд╛рд╕ рдЗрд╕рдХрд╛ рд╕реНрд░реЛрдд рдХреЛрдб рд╣реИ, рдФрд░ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдбреЙрдкреЗрд▓рдЧреИрдВрдЧрд░ рджреНрд╡рд╛рд░рд╛ рдкреНрд░рдХрд╛рд╢рд┐рдд <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдХреЛрдбрд╛рдВрддрд░рдХ рдХреЛрдб 6502 (рдПрдирдИрдПрд╕ рдкреНрд░реЛрд╕реЗрд╕рд░)</a> рдХреА <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">17 рд╣рдЬрд╛рд░ рд▓рд╛рдЗрдиреЛрдВ рдХреЗ</a> рд░реВрдк рдореЗрдВ рдПрд╕рдПрдордмреА рд╕реНрд░реЛрдд рд╣реИрдВред  рдЪреВрдВрдХрд┐ рдирд┐рдВрдЯреЗрдВрдбреЛ рдиреЗ рдХрднреА рдЖрдзрд┐рдХрд╛рд░рд┐рдХ рд╕реНрд░реЛрдд рдЬрд╛рд░реА рдирд╣реАрдВ рдХрд┐рдпрд╛, рдЗрд╕рд▓рд┐рдП рдПрд╕рдПрдордмреА рдорд╢реАрди рдХреЛрдб рдХреЛ рдЕрд▓рдЧ рдХрд░рдХреЗ, рдкреНрд░рддреНрдпреЗрдХ рднрд╛рдЧ рдХреЗ рдЕрд░реНрде рдХреЛ рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдкрд░рд┐рднрд╛рд╖рд┐рдд рдХрд░рддреЗ рд╣реБрдП, рдЯрд┐рдкреНрдкрдгрд┐рдпреЛрдВ рдФрд░ рд╕рд╛рд░реНрдердХ рдкреНрд░рддреАрдХрд╛рддреНрдордХ рдирд╛рдореЛрдВ рдХреЛ рдЬреЛрдбрд╝рдХрд░ рдХреЛрдб рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br>  рдлрд╝рд╛рдЗрд▓ рдкрд░ рддреНрд╡рд░рд┐рдд рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдореБрдЭреЗ рдЙрд╕ рд╕реНрддрд░ рдХреЗ рдбреЗрдЯрд╛ рдХреЗ рд╕рдорд╛рди рдХреБрдЫ рдорд┐рд▓рд╛ рдЬрд┐рд╕рдХреА рд╣рдореЗрдВ рдЖрд╡рд╢реНрдпрдХрддрд╛ рдереА: <br><br> <code>;level 1-1 <br> L_GroundArea6: <br> .db $50, $21 <br> .db $07, $81, $47, $24, $57, $00, $63, $01, $77, $01 <br> .db $c9, $71, $68, $f2, $e7, $73, $97, $fb, $06, $83 <br> .db $5c, $01, $d7, $22, $e7, $00, $03, $a7, $6c, $02 <br> .db $b3, $22, $e3, $01, $e7, $07, $47, $a0, $57, $06 <br> .db $a7, $01, $d3, $00, $d7, $01, $07, $81, $67, $20 <br> .db $93, $22, $03, $a3, $1c, $61, $17, $21, $6f, $33 <br> .db $c7, $63, $d8, $62, $e9, $61, $fa, $60, $4f, $b3 <br> .db $87, $63, $9c, $01, $b7, $63, $c8, $62, $d9, $61 <br> .db $ea, $60, $39, $f1, $87, $21, $a7, $01, $b7, $20 <br> .db $39, $f1, $5f, $38, $6d, $c1, $af, $26 <br> .db $fd</code> <br> <br>  рдпрджрд┐ рдЖрдк рдЕрд╕реЗрдВрдмрд▓рд░ рд╕реЗ рдЕрдкрд░рд┐рдЪрд┐рдд рд╣реИрдВ, рддреЛ рдореИрдВ рд╕рдордЭрд╛рддрд╛ рд╣реВрдБ: рдпрд╣ рд╕рдм рдмрд╕ рдЗрд╕рдХрд╛ рдЕрд░реНрде рд╣реИ "рд╕рдВрдХрд▓рд┐рдд рдкреНрд░реЛрдЧреНрд░рд╛рдо рдореЗрдВ рдЗрд╕ рддрд░рд╣ рдХреЗ рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рд╕рдореНрдорд┐рд▓рд┐рдд рдХрд░реЗрдВ, рдФрд░ рдлрд┐рд░ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рдЕрдиреНрдп рднрд╛рдЧреЛрдВ рдХреЛ <code>L_GroundArea6</code> рдкреНрд░рддреАрдХ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдЗрд╕реЗ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рдиреЗ рдХреА рдЕрдиреБрдорддрд┐ рджреЗрдВ"ред  рдЖрдк рдЗрд╕ рдЯреБрдХрдбрд╝реЗ рдХреЛ рдПрдХ рд╕рд░рдгреА рдХреЗ рд░реВрдк рдореЗрдВ рд▓реЗ рд╕рдХрддреЗ рд╣реИрдВ рдЬрд┐рд╕рдореЗрдВ рдкреНрд░рддреНрдпреЗрдХ рддрддреНрд╡ рдПрдХ рдмрд╛рдЗрдЯ рд╣реИред <br><br>  рдкрд╣рд▓реА рдЪреАрдЬрд╝ рдЬреЛ рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдбреЗрдЯрд╛ рдХреА рдорд╛рддреНрд░рд╛ рдмрд╣реБрдд рдХрдо (рд▓рдЧрднрдЧ 100 рдмрд╛рдЗрдЯреНрд╕) рд╣реИред  рдЗрд╕рд▓рд┐рдП, рд╣рдо рд╕рднреА рдкреНрд░рдХрд╛рд░ рдХреЗ рдХреЛрдбрд┐рдВрдЧ рдХреЛ рдмрд╛рд╣рд░ рдХрд░рддреЗ рд╣реИрдВ, рдЬрд┐рд╕рд╕реЗ рдЖрдк рдордирдорд╛рдиреЗ рдврдВрдЧ рд╕реЗ рдмреНрд▓реЙрдХ рд╕реНрддрд░ рдкрд░ рд░рдЦ рд╕рдХрддреЗ рд╣реИрдВред  рдереЛрдбрд╝рд╛ рдЦреЛрдЬ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рдореИрдВрдиреЗ рдкрд╛рдпрд╛ рдХрд┐ рдпрд╣ рдбреЗрдЯрд╛ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдПрд░рд┐рдпрд╛рдкрд╛рд░реНрд╕рд░рдХреЛрд░</a> рдореЗрдВ рдкрдврд╝рд╛ (рдХрдИ рдЕрдкреНрд░рддреНрдпрдХреНрд╖ рд░реВрдк рд╕реЗ рд╕рдВрдмреЛрдзрд┐рдд рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж) рд╣реИред  рдпрд╣ рдЙрдкрдкреНрд░рдХреНрд░рд┐рдпрд╛, рдмрджрд▓реЗ рдореЗрдВ, рдХрдИ рдЕрдиреНрдп рдЙрдкрдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреЛ рдХреЙрд▓ рдХрд░рддреА рд╣реИ, рдЕрдВрддрддрдГ рдкреНрд░рддреНрдпреЗрдХ рдкреНрд░рдХрд╛рд░ рдХреА рд╡рд╕реНрддреБ рдХреЗ рд▓рд┐рдП рд╡рд┐рд╢рд┐рд╖реНрдЯ рдЙрдкрдкреНрд░рдХреНрд░рдореЛрдВ рдХреЛ рдмреБрд▓рд╛рддреА рд╣реИ рдЬреЛ рджреГрд╢реНрдп рдореЗрдВ рдорд╛рдиреНрдп рд╣реЛрддреА рд╣реИрдВ (рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, <code>StaircaseObject</code> , <code>VerticalPipe</code> , <code>RowOfBricks</code> ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e5/385/954/4e538595409be651da11d5166c97b130.png"></div><br>  <i><code>AreaParserCore</code> рд▓рд┐рдП <code>AreaParserCore</code> рдХреЙрд▓ рдЧреНрд░рд╛рдлрд╝</i> <br><br>  рдпрд╣ рдкреНрд░рдХреНрд░рд┐рдпрд╛ <code>MetatileBuffer</code> рдХреЛ <code>MetatileBuffer</code> : рдПрдХ 13-рдмрд╛рдЗрдЯ рдореЗрдореЛрд░реА рдЕрдиреБрднрд╛рдЧ, рдЬреЛ рдПрдХ рд╕реНрддрд░ рдореЗрдВ рдмреНрд▓реЙрдХ рдХрд╛ рдПрдХ рдХреЙрд▓рдо рд╣реИ, рдЬрд┐рд╕рдореЗрдВ рд╕реЗ рдкреНрд░рддреНрдпреЗрдХ рдмрд╛рдЗрдЯ рдПрдХ рдЕрд▓рдЧ рдмреНрд▓реЙрдХ рдХрд╛ рдкреНрд░рддрд┐рдирд┐рдзрд┐рддреНрд╡ рдХрд░рддрд╛ рд╣реИред  рдПрдХ рдореЗрдЯрд╛рд╕реНрдЯрд╛рдЗрд▓ рдПрдХ 16x16 рдмреНрд▓реЙрдХ рд╣реИ рдЬрд┐рд╕рдореЗрдВ рд╕реЗ SMB рдЧреЗрдо рдХреА рдкреГрд╖реНрдарднреВрдорд┐ рдмрдирд╛рдИ рдЬрд╛рддреА рд╣реИ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c27/d0b/bd9/c27d0bbd9fdce9bf86b56ce181b2747d.png"></div><br>  <i>рдЖрдпрддреЛрдВ рдХреЗ рд╕рд╛рде рд╕реНрддрд░ рдореЗрдЯрд╛рдЯрд╛рдЗрд▓реНрд╕ рдХреЗ рдЪрд╛рд░реЛрдВ рдУрд░ рдШреВрдорддрд╛ рд╣реИ</i> <br><br>  рдЙрдиреНрд╣реЗрдВ рдореЗрдЯрд╛-рдлрд╛рдЗрд▓реЗрдВ рдХрд╣рд╛ рдЬрд╛рддрд╛ рд╣реИ, рдХреНрдпреЛрдВрдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдореЗрдВ рдЪрд╛рд░ 8x8-рдкрд┐рдХреНрд╕реЗрд▓ рдЯрд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВ, рд▓реЗрдХрд┐рди рдЗрд╕рдХреЗ рдиреАрдЪреЗ рдФрд░ рднреА рдмрд╣реБрдд рдХреБрдЫред <br><br>  рдпрд╣ рддрдереНрдп рдХрд┐ рдбрд┐рдХреЛрдбрд░ рдкреВрд░реНрд╡рдирд┐рд░реНрдзрд╛рд░рд┐рдд рд╡рд╕реНрддреБрдУрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рддрд╛ рд╣реИ, рд╕реНрддрд░ рдХреЗ рдЫреЛрдЯреЗ рдЖрдХрд╛рд░ рдХреА рд╡реНрдпрд╛рдЦреНрдпрд╛ рдХрд░рддрд╛ рд╣реИ: рд╕реНрддрд░ рдбреЗрдЯрд╛ рдХреЛ рдХреЗрд╡рд▓ рд╡рд╕реНрддреБрдУрдВ рдХреЗ рдкреНрд░рдХрд╛рд░ рдФрд░ рдЙрдирдХреЗ рд╕реНрдерд╛рди рдХрд╛ рдЙрд▓реНрд▓реЗрдЦ рдХрд░рдирд╛ рдЪрд╛рд╣рд┐рдП, рдЙрджрд╛рд╣рд░рдг рдХреЗ рд▓рд┐рдП, "рдмрд┐рдВрджреБ рдкрд░ рдкрд╛рдЗрдк (20, 16), рдмрд┐рдВрджреБ рдкрд░ рдмреНрд▓реЙрдХ рдХреА рд╕рдВрдЦреНрдпрд╛ (10, 5), ... "ред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдЗрд╕рдХрд╛ рдорддрд▓рдм рд╣реИ рдХрд┐ рдХрдЪреНрдЪреЗ рд╕реНрддрд░ рдХреЗ рдбреЗрдЯрд╛ рдХреЛ рдореЗрдЯрд╛ рдлрд╝рд╛рдЗрд▓реЛрдВ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдмрд╣реБрдд рд╕рд╛рд░реЗ рдХреЛрдб рд▓рдЧрддреЗ рд╣реИрдВред <br><br>  рдЕрдкрдиреЗ рд╕реНрддрд░ рдХреЗ рдЕрдирдкреИрдХрд░ рдХреЛ рдмрдирд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреЛрдб рдХреА рдЗрд╕ рд░рд╛рд╢рд┐ рдХреЛ рдкреЛрд░реНрдЯ рдХрд░рдиреЗ рдореЗрдВ рдмрд╣реБрдд рдЕрдзрд┐рдХ рд╕рдордп рд▓рдЧреЗрдЧрд╛, рдЗрд╕рд▓рд┐рдП рдЖрдЗрдП рдПрдХ рдЕрд▓рдЧ рджреГрд╖реНрдЯрд┐рдХреЛрдг рдХрд╛ рдкреНрд░рдпрд╛рд╕ рдХрд░реЗрдВред <br><br><h2>  py65emu </h2><br>  рдпрджрд┐ рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрд╛рдпрдерди рдФрд░ 6502 рдЕрд╕реЗрдВрдмрд▓рд░ рднрд╛рд╖рд╛ рдХреЗ рдмреАрдЪ рдПрдХ рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдерд╛, рддреЛ рд╣рдо рдкреНрд░рддреНрдпреЗрдХ рд╕реНрддрд░ рдХреЗ рдХреЙрд▓рдо рдХреЗ рд▓рд┐рдП <code>AreaParserCore</code> рдХреЛ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдФрд░ рдлрд┐рд░ рдмреНрд▓реЙрдХ рдХреА рдЬрд╛рдирдХрд╛рд░реА рдХреЛ рд╡рд╛рдВрдЫрд┐рдд рдЫрд╡рд┐ рдореЗрдВ рдмрджрд▓рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдзрд┐рдХ рд╕рдордЭрдиреЗ рдпреЛрдЧреНрдп рдкрд╛рдпрдерди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рддрдм <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">py65emu</a> рджреГрд╢реНрдп рдкрд░ рджрд┐рдЦрд╛рдИ рджреЗрддрд╛ рд╣реИ - рдкрд╛рдпрдерди рдЗрдВрдЯрд░рдлрд╝реЗрд╕ рдХреЗ рд╕рд╛рде рдПрдХ рд╕рдВрдХреНрд╖рд┐рдкреНрдд 6502 рдПрдореБрд▓реЗрдЯрд░ред  рдпрд╣рд╛рдБ рдмрддрд╛рдпрд╛ рдЧрдпрд╛ рд╣реИ рдХрд┐ NES рдХреЗ рдЕрдиреБрд╕рд╛рд░ py65emu рдореЗрдВ рд╕рдорд╛рди рдореЗрдореЛрд░реА рдХреЙрдиреНрдлрд╝рд┐рдЧрд░реЗрд╢рди рдХреИрд╕реЗ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ: <br><br><pre> <code class="python hljs"> <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> py65emu.cpu <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> CPU <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> py65emu.mmu <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> MMU <span class="hljs-comment"><span class="hljs-comment">#  ROM  (..  ) with open("program.bin", "rb") as f: prg_rom = f.read() #   . mmu = MMU([ #  2K ,    0x0. (0x0, 2048, False, []), #  ROM   0x8000. (0x8000, len(prg_rom), True, list(prg_rom)) ]) #     ,       0x8000 cpu = CPU(mmu, 0x8000)</span></span></code> </pre> <br>  рдЙрд╕рдХреЗ рдмрд╛рдж, рд╣рдо <code>cpu.step()</code> рд╡рд┐рдзрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╡реНрдпрдХреНрддрд┐рдЧрдд рдирд┐рд░реНрджреЗрд╢реЛрдВ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, <code>cpu.step()</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЗрдореЛрд░реА рдХреА рдЬрд╛рдВрдЪ рдХрд░ <code>cpu.ra</code> , <code>cpu.r.pc</code> , <code>cpu.r.pc</code> , рдЖрджрд┐ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдорд╢реАрди рд░рдЬрд┐рд╕реНрдЯрд░реЛрдВ рдХрд╛ рдЕрдзреНрдпрдпрди рдХрд░ <code>cpu.ra</code> ред  рдЗрд╕рдХреЗ рдЕрд▓рд╛рд╡рд╛, рд╣рдо <code>mmu.write()</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдореЗрдореЛрд░реА рдореЗрдВ рд▓рд┐рдЦ рд╕рдХрддреЗ рд╣реИрдВред <br><br>  рдпрд╣ рдзреНрдпрд╛рди рджреЗрдиреЗ рдпреЛрдЧреНрдп рд╣реИ рдХрд┐ рдпрд╣ рд╕рд┐рд░реНрдл рдПрдХ рдПрдирдИрдПрд╕ рдкреНрд░реЛрд╕реЗрд╕рд░ рдПрдореБрд▓реЗрдЯрд░ рд╣реИ: рдпрд╣ рдЕрдиреНрдп рд╣рд╛рд░реНрдбрд╡реЗрдпрд░, рдЬреИрд╕реЗ рдХрд┐ рдкреАрдкреАрдпреВ (рдкрд┐рдХреНрдЪрд░ рдкреНрд░реЛрд╕реЗрд╕рд┐рдВрдЧ рдпреВрдирд┐рдЯ) рдХрд╛ рдЕрдиреБрдХрд░рдг рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рдЗрд╕рдХрд╛ рдЙрдкрдпреЛрдЧ рдкреВрд░реЗ рдЧреЗрдо рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдирд╣реАрдВ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред  рд╣рд╛рд▓рд╛рдВрдХрд┐, рдкрд╛рд░реНрд╕рд┐рдВрдЧ рд╕рдмрдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЛ рдХреЙрд▓ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд░реНрдпрд╛рдкреНрдд рд╣реЛрдирд╛ рдЪрд╛рд╣рд┐рдП, рдХреНрдпреЛрдВрдХрд┐ рдпрд╣ рд╕реАрдкреАрдпреВ рдФрд░ рдореЗрдореЛрд░реА рдХреЗ рдЕрд▓рд╛рд╡рд╛ рдХрд┐рд╕реА рдЕрдиреНрдп рд╣рд╛рд░реНрдбрд╡реЗрдпрд░ рдбрд┐рд╡рд╛рдЗрд╕ рдХрд╛ рдЙрдкрдпреЛрдЧ рдирд╣реАрдВ рдХрд░рддрд╛ рд╣реИред <br><br>  рд╕реАрдкреАрдпреВ рдХреЛ рдКрдкрд░ рджрд┐рдЦрд╛рдП рдЕрдиреБрд╕рд╛рд░ рдХреЙрдиреНрдлрд╝рд┐рдЧрд░ рдХрд░рдиреЗ рдХреА рдпреЛрдЬрдирд╛ рд╣реИ, рдФрд░ рдлрд┐рд░ рдкреНрд░рддреНрдпреЗрдХ рд╕реНрддрд░ рдХреЗ рдХреЙрд▓рдо рдХреЗ рд▓рд┐рдП, рдореЗрдореЛрд░реА рдкрд╛рд░реНрдЯрд┐рд╢рди рдХреЛ <code>AreaParserCore</code> рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЗрдирдкреБрдЯ рд╡реИрд▓реНрдпреВ рдХреЗ рд╕рд╛рде рдЖрд░рдВрднреАрдХреГрдд рдХрд░реЗрдВ, <code>AreaParserCore</code> рдХреЛ рдХреЙрд▓ рдХрд░реЗрдВ, рдФрд░ рдлрд┐рд░ рдХреЙрд▓рдо рдбреЗрдЯрд╛ рдХреЛ рд╡рд╛рдкрд╕ рдкрдврд╝реЗрдВред  рдЗрди рдСрдкрд░реЗрд╢рдиреЛрдВ рдХреЛ рдкреВрд░рд╛ рдХрд░рдиреЗ рдХреЗ рдмрд╛рдж, рд╣рдо рдкрд░рд┐рдгрд╛рдо рдХреЛ рддреИрдпрд╛рд░ рдЫрд╡рд┐ рдореЗрдВ рдЗрдХрдЯреНрдард╛ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдкрд╛рдпрдерди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддреЗ рд╣реИрдВред <br><br>  рд▓реЗрдХрд┐рди рдЗрд╕рд╕реЗ рдкрд╣рд▓реЗ, рд╣рдореЗрдВ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рднрд╛рд╖рд╛ рдореЗрдВ рдорд╢реАрди рдХреЛрдб рдореЗрдВ рд▓рд┐рд╕реНрдЯрд┐рдВрдЧ рдХреЛ рд╕рдВрдХрд▓рд┐рдд рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br><h2>  x816 </h2><br>  рдЬреИрд╕рд╛ рдХрд┐ рд╕реНрд░реЛрдд рдХреЛрдб рдореЗрдВ рд╕рдВрдХреЗрдд рджрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИ, рдХреЛрдбрд╛рдВрддрд░рдХ x816 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рд╕рдВрдХрд▓рд┐рдд рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╣реИред  x816 рдПрдХ MS-DOS рдЕрд╕реЗрдВрдмрд▓рд░ 6502 рд╣реИ рдЬреЛ NES рдФрд░ ROM рд╣реИрдХрд░реНрд╕ рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">homebrew</a> рд╕рдореБрджрд╛рдп рджреНрд╡рд╛рд░рд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИред  рдпрд╣ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдбреЙрд╕рдмреЙрдХреНрд╕</a> рдкрд░ рдмрд╣реБрдд рдЕрдЪреНрдЫрд╛ рдХрд╛рдо рдХрд░рддрд╛ рд╣реИред <br><br>  рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЗ рд░реЛрдо рдХреЗ рд╕рд╛рде, рдЬреЛ py65emu рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рд╣реИ, x816 рдХреЛрдбрд╛рдВрддрд░рдХ рдПрдХ рдЪрд░рд┐рддреНрд░ рдлрд╝рд╛рдЗрд▓ рдмрдирд╛рддрд╛ рд╣реИ рдЬреЛ рд╕реАрдкреАрдпреВ рдХреЗ рдПрдбреНрд░реЗрд╕ рд╕реНрдкреЗрд╕ рдореЗрдВ рд╕реНрдореГрддрд┐ рдореЗрдВ рдЙрдирдХреЗ рд╕реНрдерд╛рди рдХреЗ рд▓рд┐рдП рдкрд╛рддреНрд░реЛрдВ рдХреЛ рдореИрдк рдХрд░рддрд╛ рд╣реИред  рдпрд╣рд╛рдБ рдлрд╝рд╛рдЗрд▓ рдХрд╛ рдПрдХ рдЯреБрдХрдбрд╝рд╛ рд╣реИ: <br><br> <code>AREAPARSERCORE = $0093FC ; &lt;&gt; 37884, statement #3154 <br> AREAPARSERTASKCONTROL = $0086E6 ; &lt;&gt; 34534, statement #1570 <br> AREAPARSERTASKHANDLER = $0092B0 ; &lt;&gt; 37552, statement #3035 <br> AREAPARSERTASKNUM = $00071F ; &lt;&gt; 1823, statement #141 <br> AREAPARSERTASKS = $0092C8 ; &lt;&gt; 37576, statement #3048</code> <br> <br>  рдпрд╣рд╛рдБ рд╣рдо рджреЗрдЦрддреЗ рд╣реИрдВ рдХрд┐ рд╕реЛрд░реНрд╕ рдХреЛрдб рдореЗрдВ <code>AreaParserCore</code> рдлрд╝рдВрдХреНрд╢рди рдХреЛ <code>0x93fc</code> рдкрд░ рдПрдХреНрд╕реЗрд╕ рдХрд┐рдпрд╛ рдЬрд╛ рд╕рдХрддрд╛ рд╣реИред <br><br>  рд╕реБрд╡рд┐рдзрд╛ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдПрдХ рдкреНрд░рддреАрдХ рдлрд╝рд╛рдЗрд▓ рдкрд╛рд░реНрд╕рд░ рд▓рд┐рдЦрд╛ рдЬреЛ рдкреНрд░рддреАрдХ рдирд╛рдореЛрдВ рдФрд░ рдкрддреЗ рд╕реЗ рдореЗрд▓ рдЦрд╛рддрд╛ рд╣реИ: <br><br><pre> <code class="python hljs">sym_file = SymbolFile(<span class="hljs-string"><span class="hljs-string">'SMBDIS.SYM'</span></span>) print(<span class="hljs-string"><span class="hljs-string">"0x{:x}"</span></span>.format(sym_file[<span class="hljs-string"><span class="hljs-string">'AREAPARSERCORE'</span></span>])) <span class="hljs-comment"><span class="hljs-comment">#  0x93fc print(sym_file.lookup_address(0x93fc)) #  "AREAPARSERCORE"</span></span></code> </pre> <br><h2>  рд╕рдмрд░реВрдЯреАрди </h2><br>  рдЬреИрд╕рд╛ рдХрд┐ рдКрдкрд░ рдХреА рдпреЛрдЬрдирд╛ рдореЗрдВ рдХрд╣рд╛ рдЧрдпрд╛ рд╣реИ, рд╣рдо рд╕реАрдЦрдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдХрд┐ рдкрд╛рдпрдерди рд╕реЗ <code>AreaParserCore</code> рдХреЛ рдХреИрд╕реЗ рдХреЙрд▓ рдХрд┐рдпрд╛ <code>AreaParserCore</code> ред <br><br>  рдПрдХ рдЙрдк-рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЗ рдпрд╛рдВрддреНрд░рд┐рдХреА рдХреЛ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдЗрдП рдПрдХ рдЫреЛрдЯреА рдЙрдк-рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдФрд░ рдЙрд╕рдХреА рд╕рдВрдмрдВрдзрд┐рдд рдЪреБрдиреМрддреА рдХреА рдЬрд╛рдБрдЪ рдХрд░реЗрдВ: <br><br><pre> <code class="python hljs">WritePPUReg1: sta PPU_CTRL_REG1 ;  A   <span class="hljs-number"><span class="hljs-number">1</span></span> PPU sta Mirror_PPU_CTRL_REG1 ;    rts ... jsr WritePPUReg1</code> </pre> <br>  <code>jsr</code> (рд╕рдмрд░реВрдЯреАрди рдкрд░ рдЬрд╛рдПрдВ, "рд╕рдмрд░реВрдЯреАрди рдкрд░ рдЬрд╛рдПрдВ") рдирд┐рд░реНрджреЗрд╢ рдкреАрд╕реА рд░рдЬрд┐рд╕реНрдЯрд░ рдХреЛ рд╕реНрдЯреИрдХ рдкрд░ <code>jsr</code> рдФрд░ рдЗрд╕реЗ рдкрддрд╛ рдорд╛рди <code>WritePPUReg1</code> рдЬрд┐рд╕реЗ <code>WritePPUReg1</code> рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ <code>WritePPUReg1</code> ред  рдкреАрд╕реА рд░рдЬрд┐рд╕реНрдЯрд░ рдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЛ рд▓реЛрдб рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЕрдЧрд▓реЗ рдирд┐рд░реНрджреЗрд╢ рдХрд╛ рдкрддрд╛ рдмрддрд╛рддрд╛ рд╣реИ, рддрд╛рдХрд┐ <code>jsr</code> рдирд┐рд░реНрджреЗрд╢ рдХреЗ рдмрд╛рдж рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдЕрдЧрд▓рд╛ рдирд┐рд░реНрджреЗрд╢ <code>jsr</code> рдХреА рдкрд╣рд▓реА рдкрдВрдХреНрддрд┐ рд╣реЛред <br><br>  рд╕рдмрд░реВрдЯреАрди рдХреЗ рдЕрдВрдд рдореЗрдВ, <code>rts</code> рд╕реНрдЯреЗрдЯрдореЗрдВрдЯ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ (рд╕рдмрд░реВрдЯреАрди рд╕реЗ рд╡рд╛рдкрд╕реА, "рд╕рдмрд░реВрдЯреАрди рд╕реЗ рд╡рд╛рдкрд╕реА")ред  рдпрд╣ рдХрдорд╛рдВрдб рд╕реНрдЯреИрдХ рд╕реЗ рд╕рдВрдЧреНрд░рд╣реАрдд рдореВрд▓реНрдп рдХреЛ рдирд┐рдХрд╛рд▓рддрд╛ рд╣реИ рдФрд░ рдЗрд╕реЗ рдкреАрд╕реА рд░рдЬрд┐рд╕реНрдЯрд░ рдореЗрдВ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рд╕реАрдкреАрдпреВ рдХреЛ <code>jsr</code> рдХреЙрд▓ рдХреЗ рдмрд╛рдж рдирд┐рд░реНрджреЗрд╢ рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдордЬрдмреВрд░ рдХрд░рддрд╛ рд╣реИред <br><br>  рдЙрдкрдкреНрд░рдХреНрд░рд┐рдпрд╛рдУрдВ рдХреА рдПрдХ рдмрдбрд╝реА рд╡рд┐рд╢реЗрд╖рддрд╛ рдпрд╣ рд╣реИ рдХрд┐ рдЖрдк рдЗрдирд▓рд╛рдЗрди рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВ, рдпрд╛рдиреА рдЙрдкрдкреНрд░реЛрд╕реЗрд╕ рдХреЗ рднреАрддрд░ рдЙрдкрдкреНрд░рдХрд╛рд░рдХ рдХреЙрд▓ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рд░рд┐рдЯрд░реНрди рдкрддреЗ рдХреЛ рд╕реНрдЯреИрдХ рдкрд░ рдзрдХреЗрд▓ рджрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛ рдФрд░ рд╕рд╣реА рдХреНрд░рдо рдореЗрдВ рдкреЙрдкрдЕрдк рдХрд┐рдпрд╛ рдЬрд╛рдПрдЧрд╛, рдЙрд╕реА рддрд░рд╣ рдЬреИрд╕реЗ рдЙрдЪреНрдЪ-рд╕реНрддрд░реАрдп рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдлрд╝рдВрдХреНрд╢рди рдХреЙрд▓ рдХреЗ рд╕рд╛рдеред <br><br>  рдпрд╣рд╛рдБ рдкрд╛рдпрдерди рд╕реЗ рд╕рдмрд░реВрдЯрд┐рди рдХреЛ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рдиреЗ рдХрд╛ рдХреЛрдб рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute_subroutine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(cpu, addr)</span></span></span><span class="hljs-function">:</span></span> s_before = cpu.rs cpu.JSR(addr) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> cpu.rs != s_before: cpu.step() execute_subroutine(cpu, sym_file[<span class="hljs-string"><span class="hljs-string">'AREAPARSERCORE'</span></span>])</code> </pre> <br>  рдХреЛрдб рд╕реНрдЯреИрдХ рдкреЙрдЗрдВрдЯрд░ рд░рдЬрд┐рд╕реНрдЯрд░ ( <code>s</code> ) рдХреЗ рд╡рд░реНрддрдорд╛рди рдореВрд▓реНрдп рдХреЛ рдмрдЪрд╛рддрд╛ рд╣реИ, рдПрдХ <code>jsr</code> рдХреЙрд▓ рдХрд╛ рдЕрдиреБрдХрд░рдг рдХрд░рддрд╛ рд╣реИ, рдФрд░ рддрдм рдирд┐рд░реНрджреЗрд╢ рдирд┐рд╖реНрдкрд╛рджрд┐рдд рдХрд░рддрд╛ рд╣реИ рдЬрдм рддрдХ рдХрд┐ рд╕реНрдЯреИрдХ рдЕрдкрдиреА рдореВрд▓ рдКрдВрдЪрд╛рдИ рдкрд░ рд╡рд╛рдкрд╕ рдирд╣реАрдВ рдЖрддрд╛ рд╣реИ, рдЬреЛ рдкрд╣рд▓реЗ рдЙрдкрдкреНрд░рдХрд╛рд░ рдХреА рд╡рд╛рдкрд╕реА рдХреЗ рдмрд╛рдж рд╣реА рд╣реЛрддрд╛ рд╣реИред  рдпрд╣ рдЙрдкрдпреЛрдЧреА рд╣реЛрдЧрд╛, рдХреНрдпреЛрдВрдХрд┐ рдЕрдм рд╣рдорд╛рд░реЗ рдкрд╛рд╕ рдкрд╛рдпрдерди рд╕реЗ 6502 рд╕рдмрд░реВрдЯреАрдиреНрд╕ рдХреЛ рд╕реАрдзреЗ рдХреЙрд▓ рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рд╣реИред <br><br>  рд╣рд╛рд▓рд╛рдВрдХрд┐, рд╣рдо рдХреБрдЫ рднреВрд▓ рдЧрдП: рдЗрд╕ рдЙрдкрдкреНрд░рдХрд╛рд░ рдХреЗ рд▓рд┐рдП рдЗрдирдкреБрдЯ рдорд╛рди рдХреИрд╕реЗ рдкрд╛рд░рд┐рдд рдХрд░реЗрдВ?  рд╣рдореЗрдВ рдЙрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рдмрддрд╛рдирд╛ рд╣реЛрдЧрд╛ рдЬрд┐рд╕ рд╕реНрддрд░ рдкрд░ рд╣рдо рд░реЗрдВрдбрд░ рдХрд░рдирд╛ рдЪрд╛рд╣рддреЗ рд╣реИрдВ рдФрд░ рд╣рдореЗрдВ рдХрд┐рд╕ рдХреЙрд▓рдо рдХреЛ рдкрд╛рд░реНрд╕ рдХрд░рдирд╛ рд╣реИред <br><br>  рдЙрдЪреНрдЪ-рд╕реНрддрд░реАрдп рднрд╛рд╖рд╛рдУрдВ рдореЗрдВ рдХрд╛рд░реНрдпреЛрдВ рдХреЗ рд╡рд┐рдкрд░реАрдд, рд╡рд┐рдзрд╛рдирд╕рднрд╛ рднрд╛рд╖рд╛ 6502 рдХреЗ рдЙрдк-рд╕рдВрд╕реНрдХрд░рдг рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдЗрдирдкреБрдЯ рдбреЗрдЯрд╛ рдкреНрд░рд╛рдкреНрдд рдирд╣реАрдВ рдХрд░ рд╕рдХрддреЗ рд╣реИрдВред  рдЗрд╕рдХреЗ рдмрдЬрд╛рдп, рдЗрдирдкреБрдЯ рдХреЛ рдХреЙрд▓ рд╕реЗ рдкрд╣рд▓реЗ рдореЗрдореЛрд░реА рд╕реНрдерд╛рдиреЛрдВ рдХреЛ рдирд┐рд░реНрджрд┐рд╖реНрдЯ рдХрд░рдХреЗ рдкреНрд░реЗрд╖рд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рддрдм рдЙрдкрдкреНрд░реЛрд╕реЗрд╕рд░ рдХреЙрд▓ рдХреЗ рдЕрдВрджрд░ рдкрдврд╝реЗ рдЬрд╛рддреЗ рд╣реИрдВред  <code>AreaParserCore</code> рдХреЗ рдЖрдХрд╛рд░ рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП, рд░рд┐рд╡рд░реНрд╕ рдЗрдВрдЬреАрдирд┐рдпрд░рд┐рдВрдЧ рдХреЛ рд╕реНрд░реЛрдд рдХреЛрдб рдХреЛ рджреЗрдЦрддреЗ рд╣реБрдП рдЖрд╡рд╢реНрдпрдХ рдЗрдирдкреБрдЯ рдХрд░рдирд╛ рдмрд╣реБрдд рдЬрдЯрд┐рд▓ рдФрд░ рддреНрд░реБрдЯрд┐ рдкреНрд░рд╡рдг рд╣реЛрдЧрд╛ред <br><br><h2>  рдПрдирдИрдПрд╕ рдХреЗ рд▓рд┐рдП рдорд╛рдиреНрдп? </h2><br>  <code>AreaParserCore</code> рдХреЗ рдЗрдирдкреБрдЯ рдореВрд▓реНрдпреЛрдВ рдХреЛ рдирд┐рд░реНрдзрд╛рд░рд┐рдд рдХрд░рдиреЗ рдХрд╛ рдПрдХ рддрд░реАрдХрд╛ рдЦреЛрдЬрдиреЗ рдХреЗ рд▓рд┐рдП, рдореИрдВрдиреЗ рдПрдХ рдЙрджрд╛рд╣рд░рдг рдХреЗ рд░реВрдк рдореЗрдВ Valgrind рдХреЗ рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдореЗрдордЪреЗрдХ</a> рдЯреВрд▓ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд┐рдпрд╛ред  рдореЗрдордЪреЗрдХ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЖрд╡рдВрдЯрд┐рдд рд╕реНрдореГрддрд┐ рдХреЗ рдкреНрд░рддреНрдпреЗрдХ рдЯреБрдХрдбрд╝реЗ рдХреЗ рд╕рд╛рде рд╕рдорд╛рдирд╛рдВрддрд░ рдореЗрдВ рдЫрд╛рдпрд╛ рд╕реНрдореГрддрд┐ рдХреЛ рд╕рдВрдЧреНрд░рд╣реАрдд рдХрд░рдХреЗ рдПрдХрддрд░рдлрд╛ рд╕реНрдореГрддрд┐ рддрдХ рдкрд╣реБрдВрдЪ рд╕рдВрдЪрд╛рд▓рди рдХреЛ рдкрд╣рдЪрд╛рдирддрд╛ рд╣реИред  рдЫрд╛рдпрд╛ рд╕реНрдореГрддрд┐ рд░рд┐рдХреЙрд░реНрдб рдХрд░рддреА рд╣реИ рдХрд┐ рд░рд┐рдХреЙрд░реНрдбрд┐рдВрдЧ рдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдореЗрдореЛрд░реА рдореЗрдВ рдмрдирд╛рдпрд╛ рдЧрдпрд╛ рдерд╛ рдпрд╛ рдирд╣реАрдВред  рдпрджрд┐ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдЙрд╕ рдкрддреЗ рдкрд░ рдкрдврд╝рддрд╛ рд╣реИ, рдЬрд┐рд╕ рдкрд░ рдЙрд╕рдиреЗ рдХрднреА рдирд╣реАрдВ рд▓рд┐рдЦрд╛ рд╣реИ, рддреЛ рдПрдХ рдЕрд╕рдВрдХреНрд░рдорд┐рдд рдореЗрдореЛрд░реА рддреНрд░реБрдЯрд┐ рдЖрдЙрдЯрдкреБрдЯ рд╣реИред  рд╣рдо рдПрдХ рдЙрдкрдХрд░рдг рдХреЗ рд╕рд╛рде <code>AreaParserCore</code> рдЪрд▓рд╛ рд╕рдХрддреЗ рд╣реИрдВ рдЬреЛ рд╣рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдЙрдкрдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рд▓рд╛рдЧреВ рдХрд░рдиреЗ рд╕реЗ рдкрд╣рд▓реЗ рдХреНрдпрд╛ рдЗрдирдкреБрдЯ рд╕реЗрдЯ рдХрд░рдиреЗ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реИред <br><br>  рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ, py65emu рдХреЗ рд▓рд┐рдП рдПрдХ рд╕рд░рд▓ рдореЗрдордЪреЗрдХ рд╕рдВрд╕реНрдХрд░рдг рд▓рд┐рдЦрдирд╛ рдмрд╣реБрдд рдЖрд╕рд╛рди рд╣реИ: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">format_addr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(addr)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: symbol_name = sym_file.lookup_address(addr) s = <span class="hljs-string"><span class="hljs-string">"0x{:04x} ({}):"</span></span>.format(addr, symbol_name) <span class="hljs-keyword"><span class="hljs-keyword">except</span></span> KeyError: s = <span class="hljs-string"><span class="hljs-string">"0x{:04x}:"</span></span>.format(addr) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> s <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MemCheckMMU</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(MMU)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> super().__init__(*args, **kwargs) self._uninitialized = array.array(<span class="hljs-string"><span class="hljs-string">'B'</span></span>, [<span class="hljs-number"><span class="hljs-number">1</span></span>] * <span class="hljs-number"><span class="hljs-number">2048</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">read</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, addr)</span></span></span><span class="hljs-function">:</span></span> val = super().read(addr) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> addr &lt; <span class="hljs-number"><span class="hljs-number">2048</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self._uninitialized[addr]: print(<span class="hljs-string"><span class="hljs-string">"Uninitialized read! {}"</span></span>.format(format_addr(addr))) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> val <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">write</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, addr, val)</span></span></span><span class="hljs-function">:</span></span> super().write(addr, val) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> addr &lt; <span class="hljs-number"><span class="hljs-number">2048</span></span>: self._uninitialized[addr] = <span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  рдпрд╣рд╛рдВ рд╣рдордиреЗ py65emu рдХреА рдореЗрдореЛрд░реА рдореИрдиреЗрдЬрдореЗрдВрдЯ рдпреВрдирд┐рдЯ (MMU) рдХреЛ рд▓рдкреЗрдЯрд╛ред  рдЗрд╕ рд╡рд░реНрдЧ рдореЗрдВ <code>_uninitialized</code> рд╕рд░рдгреА рд╣реЛрддреА рд╣реИ, рдЬрд┐рдирдореЗрдВ рд╕реЗ рддрддреНрд╡ рд╣рдореЗрдВ рдмрддрд╛рддреЗ рд╣реИрдВ рдХрд┐ рдХреНрдпрд╛ рдпрд╣ рдХрднреА рднреА рд╕рдВрдмрдВрдзрд┐рдд RAM рдХреЗ рд╕рдВрдмрдВрдзрд┐рдд рдмрд╛рдЗрдЯ рдХреЛ рд▓рд┐рдЦрд╛ рдЧрдпрд╛ рд╣реИред  рдПрдХ рдЧреИрд░-рдкрдврд╝реЗ рдЬрд╛рдиреЗ рдХреА рд╕реНрдерд┐рддрд┐ рдореЗрдВ, рдЕрдорд╛рдиреНрдп рд░реАрдб рдСрдкрд░реЗрд╢рди рдХрд╛ рдкрддрд╛ рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рд╡рд░реНрдг рдХрд╛ рдирд╛рдо рдкреНрд░рджрд░реНрд╢рд┐рдд рд╣реЛрддрд╛ рд╣реИред <br><br>  <code>execute_subroutine(sym_file['AREAPARSERCORE'])</code> : <br><br> <code>Uninitialized read! 0x0728 (BACKLOADINGFLAG): <br> Uninitialized read! 0x0742 (BACKGROUNDSCENERY): <br> Uninitialized read! 0x0741 (FOREGROUNDSCENERY): <br> Uninitialized read! 0x074e (AREATYPE): <br> Uninitialized read! 0x075f (WORLDNUMBER): <br> Uninitialized read! 0x0743 (CLOUDTYPEOVERRIDE): <br> Uninitialized read! 0x0727 (TERRAINCONTROL): <br> Uninitialized read! 0x0743 (CLOUDTYPEOVERRIDE): <br> Uninitialized read! 0x074e (AREATYPE): <br> ...</code> <br> <br>  рдХреЛрдб рдХреЛ рджреЗрдЦрдХрд░, рдЖрдк рджреЗрдЦ рд╕рдХрддреЗ рд╣реИрдВ рдХрд┐ рдЗрдирдореЗрдВ рд╕реЗ рдХрдИ рдорд╛рди <code>InitializeArea</code> рд╕рдмрдкреНрд░реЛрдбреЗрдХреНрдЯ рджреНрд╡рд╛рд░рд╛ рд╕реЗрдЯ рдХрд┐рдП рдЧрдП рд╣реИрдВ, рдЗрд╕рд▓рд┐рдП рдкрд╣рд▓реЗ рдЗрд╕ рдлрд╝рдВрдХреНрд╢рди рдХреЛ рдХреЙрд▓ рдХрд░рддреЗ рд╣реБрдП рд╕реНрдХреНрд░рд┐рдкреНрдЯ рдХреЛ рдлрд┐рд░ рд╕реЗ рдЪрд▓рд╛рдПрдВред  рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рджреЛрд╣рд░рд╛рддреЗ рд╣реБрдП, рд╣рдо рдХреЙрд▓ рдХреЗ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рдХреНрд░рдо рдореЗрдВ рдЖрддреЗ рд╣реИрдВ, рдЬрд┐рд╕рдореЗрдВ рдХреЗрд╡рд▓ рд╡рд┐рд╢реНрд╡ рд╕рдВрдЦреНрдпрд╛ рдФрд░ рдХреНрд╖реЗрддреНрд░ рд╕рдВрдЦреНрдпрд╛ рдХреА рдЖрд╡рд╢реНрдпрдХрддрд╛ рд╣реЛрддреА рд╣реИ: <br><br><pre> <code class="python hljs">mmu.write(sym_file[<span class="hljs-string"><span class="hljs-string">'WORLDNUMBER'</span></span>], <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-comment"><span class="hljs-comment">#    1 mmu.write(sym_file['AREANUMBER'], 0) #    1 execute_subroutine(sym_file['LOADAREAPOINTER']) execute_subroutine(sym_file['INITIALIZEAREA']) metatile_data = [] for column_pos in range(48): execute_subroutine(sym_file['AREAPARSERCORE']) metatile_data.append([mmu.read_no_debug(sym_file['METATILEBUFFER'] + i) for i in range(13)]) execute_subroutine(sym_file['INCREMENTCOLUMNPOS'])</span></span></code> </pre> <br>  рдХреЛрдб рджреБрдирд┐рдпрд╛ рдХрд╛ рдкрд╣рд▓рд╛ 48 рдХреЙрд▓рдо 1-1 рд╕реНрддрд░ рдХреЛ <code>metatile_data</code> рдХреЛ <code>metatile_data</code> , рд╡рд░реНрддрдорд╛рди рдХреЙрд▓рдо рдХреЛ рдЯреНрд░реИрдХ рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП рдЖрд╡рд╢реНрдпрдХ рдЖрдВрддрд░рд┐рдХ рдЪрд░ рдХреЛ рдмрдврд╝рд╛рдиреЗ рдХреЗ рд▓рд┐рдП <code>IncrementColumnPos</code> <code>metatile_data</code> рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рддрд╛ рд╣реИред <br><br>  рдФрд░ рдпрд╣рд╛рдВ рдЦреЗрд▓ рд╕реЗ рд╕реНрдХреНрд░реАрдирд╢реЙрдЯ рдкрд░ <code>metatile_data</code> рдХреА рд╕рд╛рдордЧреНрд░реА рд╣реИ (0 рдХреЗ рдорд╛рди рдХреЗ рд╕рд╛рде рдмрд╛рдЗрдЯреНрд╕ рджрд┐рдЦрд╛рдП рдЧрдП рд╣реИрдВ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/707/a7a/80a/707a7a80afb88c419beb17be9e108272.png"></div><br>  рдЬрд╛рд╣рд┐рд░ рд╣реИ, <code>metatile_data</code> рд╕реНрдкрд╖реНрдЯ рд░реВрдк рд╕реЗ рдкреГрд╖реНрдарднреВрдорд┐ рдЬрд╛рдирдХрд╛рд░реА рд╕реЗ рдореЗрд▓ рдЦрд╛рддреА рд╣реИред <br><br><h2>  рдореЗрдЯрд╛ рдЧреНрд░рд╛рдлрд┐рдХреНрд╕ </h2><br>  (рдЕрдВрддрд┐рдо рдкрд░рд┐рдгрд╛рдо рджреЗрдЦрдиреЗ рдХреЗ рд▓рд┐рдП, рдЖрдк рддреБрд░рдВрдд "рд╕рдм рдХреБрдЫ рдПрдХ рд╕рд╛рде рдЬреЛрдбрд╝рдиреЗ" рдЕрдиреБрднрд╛рдЧ рдкрд░ рдЖрдЧреЗ рдмрдврд╝ рд╕рдХрддреЗ рд╣реИрдВред) <br><br>  рдЕрдм рдЖрдЗрдП рдЬрд╛рдиреЗрдВ рдХрд┐ рдкреНрд░рд╛рдкреНрдд рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рдореЗрдЯрд╛ рдлрд╛рдЗрд▓реЛрдВ рдХреЛ рд╡рд╛рд╕реНрддрд╡рд┐рдХ рдЪрд┐рддреНрд░реЛрдВ рдореЗрдВ рдХреИрд╕реЗ рдмрджрд▓рдирд╛ рд╣реИред  рдиреАрдЪреЗ рд╡рд░реНрдгрд┐рдд рдЪрд░рдгреЛрдВ рдХрд╛ рдЖрд╡рд┐рд╖реНрдХрд╛рд░ рд╕реНрд░реЛрддреЛрдВ рдХрд╛ рд╡рд┐рд╢реНрд▓реЗрд╖рдг рдХрд░рдХреЗ рдФрд░ рдЕрджреНрднреБрдд <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рдиреЗрд╕рджреЗрд╡ рд╡рд┐рдХреА рдХреЗ</a> рд╕рд╛рде рдкреНрд░рд▓реЗрдЦрди рдкрдврд╝рдиреЗ рдХреЗ рджреНрд╡рд╛рд░рд╛ рдХрд┐рдпрд╛ рдЧрдпрд╛ рдерд╛ред <br><br>  рдпрд╣ рд╕рдордЭрдиреЗ рдХреЗ рд▓рд┐рдП рдХрд┐ рдкреНрд░рддреНрдпреЗрдХ рдореЗрдЯреИрд▓рд┐рдХ рдХреЛ рдХреИрд╕реЗ рд░реЗрдВрдбрд░ рдХрд┐рдпрд╛ рдЬрд╛рдП, рд╣рдореЗрдВ рд╕рдмрд╕реЗ рдкрд╣рд▓реЗ NES рдХрд▓рд░ рдкреИрд▓реЗрдЯ рдХреЗ рдмрд╛рд░реЗ рдореЗрдВ рдмрд╛рдд рдХрд░рдиреА рд╣реЛрдЧреАред  NES рдХрдВрд╕реЛрд▓ PPU рдЖрдо рддреМрд░ рдкрд░ 64 рдЕрд▓рдЧ-рдЕрд▓рдЧ рд░рдВрдЧреЛрдВ рдХреЛ рдкреНрд░рд╕реНрддреБрдд рдХрд░ рд╕рдХрддрд╛ рд╣реИ, рд▓реЗрдХрд┐рди рдХрд╛рд▓реЗ рдХреЛ рдХрдИ рдмрд╛рд░ рджреЛрд╣рд░рд╛рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">рд╡рд┐рд╡рд░рдг рдХреЗ</a> рд▓рд┐рдП <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=hi&amp;u=">Nesdev рджреЗрдЦреЗрдВ</a> ): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cdf/997/328/cdf9973289e05f09899c36ca04cb6a4d.png"></div><br>  рдкреНрд░рддреНрдпреЗрдХ рдорд╛рд░рд┐рдпреЛ рд╕реНрддрд░ рдкреГрд╖реНрдарднреВрдорд┐ рдХреЗ рд▓рд┐рдП рдЗрди 64 рд░рдВрдЧреЛрдВ рдореЗрдВ рд╕реЗ рдХреЗрд╡рд▓ 10 рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░ рд╕рдХрддрд╛ рд╣реИ, 4 рдЪрд╛рд░-рд░рдВрдЧ рдкрдЯреНрдЯрд┐рдпреЛрдВ рдореЗрдВ рд╡рд┐рднрд╛рдЬрд┐рдд;  рдкрд╣рд▓рд╛ рд░рдВрдЧ рд╣рдореЗрд╢рд╛ рд╕рдорд╛рди рд╣реЛрддрд╛ рд╣реИред  рдпрд╣рд╛рдБ 1-1 рд╡рд┐рд╢реНрд╡ рдХреЗ рд▓рд┐рдП рдЪрд╛рд░ рдкреИрд▓реЗрдЯ рд╣реИрдВ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/699/15d/821/69915d821a10f3e7c668abe2894bc7a3.png"></div><br>  рдЖрдЗрдП рдЕрдм рдореЗрдЯрд╛ рдлрд╛рдЗрд▓ рдирдВрдмрд░ рдХреЗ рдПрдХ рджреНрд╡рд┐рдЖрдзрд╛рд░реА рдЙрджрд╛рд╣рд░рдг рдХреЛ рджреЗрдЦреЗрдВред  рдпрд╣рд╛рдБ рдЦреБрд░рджрд╛рд░ рдкрддреНрдерд░ рдХреА рдЯрд╛рдЗрд▓ рдореЗрдЯреИрд▓рд┐рдХ рд╕рдВрдЦреНрдпрд╛ рд╣реИ, рдЬреЛ рдХрд┐ рд╡рд┐рд╢реНрд╡ 1-1 рд╕реНрддрд░ рдХреА рднреВрдорд┐ рд╣реИ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/85f/1a1/9ae/85f1a19aea1e39a511dc2bfe31e72d05.png"></div><br>  рдкреИрд▓реЗрдЯ рдЗрдВрдбреЗрдХреНрд╕ рд╣рдореЗрдВ рдмрддрд╛рддрд╛ рд╣реИ рдХрд┐ рдореЗрдЯреИрд▓рд┐рдХ (рд╣рдорд╛рд░реЗ рдорд╛рдорд▓реЗ рдореЗрдВ, рдкреИрд▓реЗрдЯ 1) рдХрд╛ рдкреНрд░рддрд┐рдкрд╛рджрди рдХрд░рддреЗ рд╕рдордп рдХрд┐рд╕ рдкреИрд▓реЗрдЯ рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдирд╛ рд╣реИред  рдкреИрд▓реЗрдЯ рдЗрдВрдбреЗрдХреНрд╕ рдирд┐рдореНрдирд▓рд┐рдЦрд┐рдд рджреЛ рд╕рд░рдгрд┐рдпреЛрдВ рдХрд╛ рд╕реВрдЪрдХрд╛рдВрдХ рднреА рд╣реИ: <br><br> <code>MetatileGraphics_Low: <br> .db &lt;Palette0_MTiles, &lt;Palette1_MTiles, &lt;Palette2_MTiles, &lt;Palette3_MTiles <br> <br> MetatileGraphics_High: <br> .db &gt;Palette0_MTiles, &gt;Palette1_MTiles, &gt;Palette2_MTiles, &gt;Palette3_MTiles</code> <br> <br>  рдЗрди рджреЛ рд╕рд░рдгрд┐рдпреЛрдВ рдХреЗ рд╕рдВрдпреЛрдЬрди рд╕реЗ рд╣рдореЗрдВ 16-рдмрд┐рдЯ рдкрддрд╛ рдорд┐рд▓рддрд╛ рд╣реИ, рдЬреЛ рд╣рдорд╛рд░реЗ рдЙрджрд╛рд╣рд░рдг рдореЗрдВ <code>Palette1_Mtiles</code> рдУрд░ <code>Palette1_Mtiles</code> : <br><br> <code>Palette1_MTiles: <br> .db $a2, $a2, $a3, $a3 ;vertical rope <br> .db $99, $24, $99, $24 ;horizontal rope <br> .db $24, $a2, $3e, $3f ;left pulley <br> .db $5b, $5c, $24, $a3 ;right pulley <br> .db $24, $24, $24, $24 ;blank used for balance rope <br> .db $9d, $47, $9e, $47 ;castle top <br> .db $47, $47, $27, $27 ;castle window left <br> .db $47, $47, $47, $47 ;castle brick wall <br> .db $27, $27, $47, $47 ;castle window right <br> .db $a9, $47, $aa, $47 ;castle top w/ brick <br> .db $9b, $27, $9c, $27 ;entrance top <br> .db $27, $27, $27, $27 ;entrance bottom <br> .db $52, $52, $52, $52 ;green ledge stump <br> .db $80, $a0, $81, $a1 ;fence <br> .db $be, $be, $bf, $bf ;tree trunk <br> .db $75, $ba, $76, $bb ;mushroom stump top <br> .db $ba, $ba, $bb, $bb ;mushroom stump bottom <br> .db $45, $47, $45, $47 ;breakable brick w/ line <br> .db $47, $47, $47, $47 ;breakable brick <br> .db $45, $47, $45, $47 ;breakable brick (not used) <br> .db $b4, $b6, $b5, $b7 ;cracked rock terrain &lt;--- This is the 20th line <br> .db $45, $47, $45, $47 ;brick with line (power-up) <br> .db $45, $47, $45, $47 ;brick with line (vine) <br> .db $45, $47, $45, $47 ;brick with line (star) <br> .db $45, $47, $45, $47 ;brick with line (coins) <br> ...</code> <br> <br>  рдЬрдм рдЖрдк рдореЗрдЯрд╛рд╕реНрдЯрд╛рдЗрд▓ рдЗрдВрдбреЗрдХреНрд╕ рдХреЛ 4 рд╕реЗ рдЧреБрдгрд╛ рдХрд░рддреЗ рд╣реИрдВ, рддреЛ рдпрд╣ рдЗрд╕ рдРрд░реЗ рдХрд╛ рдЗрдВрдбреЗрдХреНрд╕ рдмрди рдЬрд╛рддрд╛ рд╣реИред  рдбреЗрдЯрд╛ рдХреЛ 4 рд░рд┐рдХреЙрд░реНрдб рдкреНрд░рддрд┐ рдкрдВрдХреНрддрд┐ рдореЗрдВ рд╕реНрд╡рд░реВрдкрд┐рдд рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЗрд╕рд▓рд┐рдП рд╣рдорд╛рд░рд╛ рдЙрджрд╛рд╣рд░рдг рдореЗрдЯрд┐рдЕрдиреЗрдЯ рдмреАрд╕рд╡реАрдВ рдкрдВрдХреНрддрд┐ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдЬреЛ рдПрдХ <code>cracked rock terrain</code> рдЯрд┐рдкреНрдкрдгреА рдХреЗ рд╕рд╛рде рдЪрд┐рд╣реНрдирд┐рдд рд╣реИред <br><br>  рдЗрд╕ рдкрдВрдХреНрддрд┐ рдХреА рдЪрд╛рд░ рдкреНрд░рд╡рд┐рд╖реНрдЯрд┐рдпрд╛рдБ рд╡рд╛рд╕реНрддрд╡ рдореЗрдВ рдЯрд╛рдЗрд▓ рдЖрдЗрдбреЗрдВрдЯрд┐рдлрд╝рд╛рдпрд░ рд╣реИрдВ: рдкреНрд░рддреНрдпреЗрдХ рдореЗрдЯрд╛рд╕реНрдЯрд╛рдЗрд▓ рдореЗрдВ рдЪрд╛рд░ 8x8-рдкрд┐рдХреНрд╕реЗрд▓ рдЯрд╛рдЗрд▓реЗрдВ рд╣реЛрддреА рд╣реИрдВ рдЬреЛ рдирд┐рдореНрди рдХреНрд░рдо рдореЗрдВ рд╡реНрдпрд╡рд╕реНрдерд┐рдд рд╣реЛрддреА рд╣реИрдВ - рдКрдкрд░реА рдмрд╛рдПрдБ, рдирд┐рдЪрд▓реЗ рдмрд╛рдПрдБ, рдКрдкрд░реА рджрд╛рдПрдБ рдФрд░ рдирд┐рдЪрд▓реЗ рджрд╛рдПрдБред  рдпреЗ рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ рд╕реАрдзреЗ рдПрдирдИрдПрд╕ рдкреАрдкреАрдпреВ рдХрдВрд╕реЛрд▓ рдХреЛ рдкрд╛рд╕ рдХрд┐рдП рдЬрд╛рддреЗ рд╣реИрдВред  рдкрд╣рдЪрд╛рдирдХрд░реНрддрд╛ CHR-ROM рдХрдВрд╕реЛрд▓ рдореЗрдВ рдбреЗрдЯрд╛ рдХреЗ 16 рдмрд╛рдЗрдЯреНрд╕ рдХреЛ рд╕рдВрджрд░реНрднрд┐рдд рдХрд░рддрд╛ рд╣реИ, рдФрд░ рдкреНрд░рддреНрдпреЗрдХ рд░рд┐рдХреЙрд░реНрдб <code>0x1000 + 16 * &lt; &gt;</code> рдкрддреЗ рд╕реЗ рд╢реБрд░реВ рд╣реЛрддрд╛ рд╣реИ: <br><br> <code>0x1000 + 16 * 0xb4: 0b01111111 0x1000 + 16 * 0xb5: 0b11011110 <br> 0x1001 + 16 * 0xb4: 0b10000000 0x1001 + 16 * 0xb5: 0b01100001 <br> 0x1002 + 16 * 0xb4: 0b10000000 0x1002 + 16 * 0xb5: 0b01100001 <br> 0x1003 + 16 * 0xb4: 0b10000000 0x1003 + 16 * 0xb5: 0b01100001 <br> 0x1004 + 16 * 0xb4: 0b10000000 0x1004 + 16 * 0xb5: 0b01110001 <br> 0x1005 + 16 * 0xb4: 0b10000000 0x1005 + 16 * 0xb5: 0b01011110 <br> 0x1006 + 16 * 0xb4: 0b10000000 0x1006 + 16 * 0xb5: 0b01111111 <br> 0x1007 + 16 * 0xb4: 0b10000000 0x1007 + 16 * 0xb5: 0b01100001 <br> 0x1008 + 16 * 0xb4: 0b10000000 0x1008 + 16 * 0xb5: 0b01100001 <br> 0x1009 + 16 * 0xb4: 0b01111111 0x1009 + 16 * 0xb5: 0b11011111 <br> 0x100a + 16 * 0xb4: 0b01111111 0x100a + 16 * 0xb5: 0b11011111 <br> 0x100b + 16 * 0xb4: 0b01111111 0x100b + 16 * 0xb5: 0b11011111 <br> 0x100c + 16 * 0xb4: 0b01111111 0x100c + 16 * 0xb5: 0b11011111 <br> 0x100d + 16 * 0xb4: 0b01111111 0x100d + 16 * 0xb5: 0b11111111 <br> 0x100e + 16 * 0xb4: 0b01111111 0x100e + 16 * 0xb5: 0b11000001 <br> 0x100f + 16 * 0xb4: 0b01111111 0x100f + 16 * 0xb5: 0b11011111 <br> <br> 0x1000 + 16 * 0xb6: 0b10000000 0x1000 + 16 * 0xb7: 0b01100001 <br> 0x1001 + 16 * 0xb6: 0b10000000 0x1001 + 16 * 0xb7: 0b01100001 <br> 0x1002 + 16 * 0xb6: 0b11000000 0x1002 + 16 * 0xb7: 0b11000001 <br> 0x1003 + 16 * 0xb6: 0b11110000 0x1003 + 16 * 0xb7: 0b11000001 <br> 0x1004 + 16 * 0xb6: 0b10111111 0x1004 + 16 * 0xb7: 0b10000001 <br> 0x1005 + 16 * 0xb6: 0b10001111 0x1005 + 16 * 0xb7: 0b10000001 <br> 0x1006 + 16 * 0xb6: 0b10000001 0x1006 + 16 * 0xb7: 0b10000011 <br> 0x1007 + 16 * 0xb6: 0b01111110 0x1007 + 16 * 0xb7: 0b11111110 <br> 0x1008 + 16 * 0xb6: 0b01111111 0x1008 + 16 * 0xb7: 0b11011111 <br> 0x1009 + 16 * 0xb6: 0b01111111 0x1009 + 16 * 0xb7: 0b11011111 <br> 0x100a + 16 * 0xb6: 0b11111111 0x100a + 16 * 0xb7: 0b10111111 <br> 0x100b + 16 * 0xb6: 0b00111111 0x100b + 16 * 0xb7: 0b10111111 <br> 0x100c + 16 * 0xb6: 0b01001111 0x100c + 16 * 0xb7: 0b01111111 <br> 0x100d + 16 * 0xb6: 0b01110001 0x100d + 16 * 0xb7: 0b01111111 <br> 0x100e + 16 * 0xb6: 0b01111111 0x100e + 16 * 0xb7: 0b01111111 <br> 0x100f + 16 * 0xb6: 0b11111111 0x100f + 16 * 0xb7: 0b01111111</code> <br> <br>  CHR-ROM рдореЗрдореЛрд░реА рдХрд╛ рдХреЗрд╡рд▓ рдкрдврд╝рдиреЗ рд╡рд╛рд▓рд╛ рдЯреБрдХрдбрд╝рд╛ рд╣реИ рдЬрд┐рд╕реЗ рдХреЗрд╡рд▓ PPU рд╣реА рдПрдХреНрд╕реЗрд╕ рдХрд░ рд╕рдХрддрд╛ рд╣реИред  рдЗрд╕реЗ PRG-ROM рд╕реЗ рдЕрд▓рдЧ рдХрд┐рдпрд╛ рдЬрд╛рддрд╛ рд╣реИ, рдЬреЛ рдкреНрд░реЛрдЧреНрд░рд╛рдо рдХреЛрдб рдХреЛ рд╕реНрдЯреЛрд░ рдХрд░рддрд╛ рд╣реИред  рдЗрд╕рд▓рд┐рдП, рдЙрдкрд░реЛрдХреНрдд рдбреЗрдЯрд╛ рд╕реНрд░реЛрдд рдХреЛрдб рдореЗрдВ рдЙрдкрд▓рдмреНрдз рдирд╣реАрдВ рд╣реИрдВ рдФрд░ рдЗрд╕реЗ рдЧреЗрдо рдХреЗ рд░реЛрдо рдХреЗ рдбрдВрдк рд╕реЗ рдкреНрд░рд╛рдкреНрдд рдХрд┐рдпрд╛ рдЬрд╛рдирд╛ рдЪрд╛рд╣рд┐рдПред <br><br>  рдкреНрд░рддреНрдпреЗрдХ рдЯрд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП 16 рдмрд╛рдЗрдЯреНрд╕ 2-рдмрд┐рдЯ 8x8 рдЯрд╛рдЗрд▓ рдмрдирд╛рддреЗ рд╣реИрдВ: рдкрд╣рд▓рд╛ рдмрд┐рдЯ рдкрд╣рд▓реЗ 8 рдмрд╛рдЗрдЯреНрд╕ рд╣реИ, рдФрд░ рджреВрд╕рд░рд╛ рджреВрд╕рд░рд╛ 8 рдмрд╛рдЗрдЯреНрд╕ рд╣реИ: <br><br> <code>21111111 13211112 <br> 12222222 23122223 <br> 12222222 23122223 <br> 12222222 23122223 <br> 12222222 23132223 <br> 12222222 23233332 <br> 12222222 23111113 <br> 12222222 23122223 <br> <br> 12222222 23122223 <br> 12222222 23122223 <br> 33222222 31222223 <br> 11332222 31222223 <br> 12113333 12222223 <br> 12221113 12222223 <br> 12222223 12222233 <br> 23333332 13333332</code> <br> <br>  рдЗрд╕ рдбреЗрдЯрд╛ рдХреЛ рдкреИрд▓реЗрдЯ 1 рдореЗрдВ рдмрд╛рдБрдзреЗрдВ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/02e/32a/ad5/02e32aad5717393bd296dd35983e294b.png"></div><br>  ... рдФрд░ рдЯреБрдХрдбрд╝реЛрдВ рдХреЛ рдорд┐рд▓рд╛рдПрдВ: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/950/86a/103/95086a103b16d361c72c0250781ebfd5.png"></div><br>  рдЕрдВрдд рдореЗрдВ рд╣рдореЗрдВ рдПрдХ рдкреНрд░рджрд╛рди рдХреА рдЧрдИ рдЯрд╛рдЗрд▓ рдорд┐рд▓реАред <br><br><h2>  рдпрд╣ рд╕рдм рдПрдХ рд╕рд╛рде рд░рдЦрдирд╛ </h2><br>  рдкреНрд░рддреНрдпреЗрдХ рдореЗрдЯрд╛ рдлрд╝рд╛рдЗрд▓ рдХреЗ рд▓рд┐рдП рдЗрд╕ рдкреНрд░рдХреНрд░рд┐рдпрд╛ рдХреЛ рджреЛрд╣рд░рд╛рддреЗ рд╣реБрдП, рд╣рдореЗрдВ рдкреВрд░реА рддрд░рд╣ рд╕реЗ рдкреНрд░рджрд╛рди рдХрд┐рдпрд╛ рдЧрдпрд╛ рд╕реНрддрд░ рдорд┐рд▓рддрд╛ рд╣реИред <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/322/45d/a3b/32245da3b8b4707764cef5231e040474.png"></div><br>  рдФрд░ рдЗрд╕рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рдж, рд╣рдо рдкрд╛рдпрдерди рдХрд╛ рдЙрдкрдпреЛрдЧ рдХрд░рдХреЗ рдПрд╕рдПрдордмреА рд╕реНрддрд░ рдХреЗ рдЧреНрд░рд╛рдлрд┐рдХреНрд╕ рдирд┐рдХрд╛рд▓рдиреЗ рдореЗрдВ рд╕рдХреНрд╖рдо рдереЗ! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/hi416241/">https://habr.com/ru/post/hi416241/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../hi416229/index.html">рд╡рд┐рдкрдгрди рдФрд░ рд╕рдВрдмрдВрдзрд┐рдд рд╡рд┐рд╖рдпреЛрдВ рдкрд░ 10 рдкреБрд╕реНрддрдХреЗрдВ рдЬрд┐рдиреНрд╣реЗрдВ рдПрдХ рдбрд┐рдЬрд╛рдЗрдирд░ рдХреЛ рдкрдврд╝рдирд╛ рдЪрд╛рд╣рд┐рдП</a></li>
<li><a href="../hi416231/index.html">рдЬрд╝рд╛рджрд░реНрдорд╛ рдЬрд╝реИрдмрд┐рдХреНрд╕ рдХрдорд░реЛрдВ рдХреА рдирд┐рдЧрд░рд╛рдиреА рдХрд░рдирд╛</a></li>
<li><a href="../hi416235/index.html">рдмреВрдЯрд╕реНрдЯреНрд░реИрдк 4 рдХреЗ рд▓рд┐рдП рдХрд╕реНрдЯрдо рдШрдЯрдХ рдмрдирд╛рдирд╛</a></li>
<li><a href="../hi416237/index.html">рдПрдХ рдбрд┐рдЬрд╛рдЗрдирд░ рдмрдирдирд╛: рдПрдХ рдЫрд╛рддреНрд░рд╛рд╡рд╛рд╕ рд╕реЗ рдлреНрд░реАрд▓рд╛рдВрд╕ рд╕реЗ рд▓реЗрдХрд░ рд╢реАрд░реНрд╖ рдХрдВрдкрдирд┐рдпреЛрдВ рдХреЗ рд╕рд╛рде рдХрд╛рдо рдХрд░рдирд╛ рдФрд░ рдЕрдкрдирд╛ рдЙрддреНрдкрд╛рдж рд▓реЙрдиреНрдЪ рдХрд░рдирд╛</a></li>
<li><a href="../hi416239/index.html">рдбрд┐рдЬрд╛рдЗрди рдХрдВрдкрдирд┐рдпреЛрдВ рдореЗрдВ рдкреАрдПрдордУ рдХреА рднреВрдорд┐рдХрд╛ рдФрд░ рдХрд╛рд░реНрдп</a></li>
<li><a href="../hi416243/index.html">рдХреЛрдмрд╛рд▓реНрдЯ рдХреЗ рд╡рд┐рдХрд▓реНрдк, рдмреИрдЯрд░рд┐рдпреЛрдВ рд╕реЗ рдпрд╣ рдЦреВрдиреА рд╣реАрд░рд╛</a></li>
<li><a href="../hi416245/index.html">рд╣рдо рдСрдирд▓рд╛рдЗрди рд╕реНрдЯреЛрд░ рдХреЛ рд╕реНрд╡рдЪрд╛рд▓рд┐рдд рдХрд░рдиреЗ рдХреЗ рд▓рд┐рдП Aimylogic рдкрд░ рдПрдХ рдмреЙрдЯ рдмрдирд╛рддреЗ рд╣реИрдВ</a></li>
<li><a href="../hi416247/index.html">рдмрд┐рдЬрдиреЗрд╕ рдЯреНрд░рд┐рдк рдХреА рддреИрдпрд╛рд░реА рдХреИрд╕реЗ рдХрд░реЗрдВ? ISPsystem bizdedev рд╕реЗ рд╕реБрдЭрд╛рд╡</a></li>
<li><a href="../hi416251/index.html">рдЯреА-рд╢рд░реНрдЯ рдкрд░ 3 рдбреА рдкреНрд░рд┐рдВрдЯрд┐рдВрдЧ</a></li>
<li><a href="../hi416253/index.html">рд╕реНрдХреЗрдЪрдлреИрдм, рдпреВрдирд┐рдЯреА, рдмреНрд▓реЗрдВрдб 4рд╡реЗрдм, рдкреНрд▓реЗрдХреЗрдирд╡рд╛рд╕, рдФрд░ рдЕрдм рд╡рд░реНрдЧреЗ 3 рдбреА</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>