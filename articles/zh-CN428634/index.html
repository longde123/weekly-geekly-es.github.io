<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸŒ‚ ğŸ¤¦ğŸ» ğŸ’› ç§»æ¤Quake3 ğŸ‘©â€âš•ï¸ ğŸ¦ ğŸ‘¨ğŸ¿â€ğŸ¤â€ğŸ‘¨ğŸ½</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="åœ¨Emboxæ“ä½œç³»ç»Ÿï¼ˆæˆ‘æ˜¯æˆ‘çš„å¼€å‘è€…ï¼‰ä¸­ï¼Œå¯¹OpenGLçš„æ”¯æŒæ—©åœ¨ä¸€æ®µæ—¶é—´å‰å°±å‡ºç°äº†ï¼Œä½†æ˜¯æ²¡æœ‰æ˜æ™ºçš„æ€§èƒ½æ£€æŸ¥ï¼Œä»…æ¸²æŸ“å…·æœ‰å¤šä¸ªå›¾å½¢åŸºå…ƒçš„åœºæ™¯ã€‚ 


 æˆ‘å¯¹gamedevä»æ¥æ²¡æœ‰ç‰¹åˆ«æ„Ÿå…´è¶£ï¼Œå°½ç®¡æˆ‘å½“ç„¶å–œæ¬¢æ¸¸æˆï¼Œå¹¶å†³å®š-è¿™æ˜¯ä¸€ç§è·å¾—ä¹è¶£çš„å¥½æ–¹æ³•ï¼Œä½†åŒæ—¶æ£€æŸ¥OpenGLå¹¶æŸ¥çœ‹æ¸¸æˆå¦‚ä½•ä¸OSäº¤äº’ã€‚ 


 ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ç§»æ¤Quake3</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/embox/blog/428634/"><img src="https://habrastorage.org/webt/or/0q/lb/or0qlb1hvs2q5j4-xfsfv5uofys.png" align="right" width="320"><br><p> åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Embox</a>æ“ä½œç³»ç»Ÿï¼ˆæˆ‘æ˜¯æˆ‘çš„å¼€å‘è€…ï¼‰ä¸­ï¼Œå¯¹OpenGLçš„æ”¯æŒæ—©åœ¨ä¸€æ®µæ—¶é—´å‰å°±å‡ºç°äº†ï¼Œä½†æ˜¯æ²¡æœ‰æ˜æ™ºçš„æ€§èƒ½æ£€æŸ¥ï¼Œä»…æ¸²æŸ“å…·æœ‰å¤šä¸ªå›¾å½¢åŸºå…ƒçš„åœºæ™¯ã€‚ </p><br><p> æˆ‘å¯¹gamedevä»æ¥æ²¡æœ‰ç‰¹åˆ«æ„Ÿå…´è¶£ï¼Œå°½ç®¡æˆ‘å½“ç„¶å–œæ¬¢æ¸¸æˆï¼Œå¹¶å†³å®š-è¿™æ˜¯ä¸€ç§è·å¾—ä¹è¶£çš„å¥½æ–¹æ³•ï¼Œä½†åŒæ—¶æ£€æŸ¥OpenGLå¹¶æŸ¥çœ‹æ¸¸æˆå¦‚ä½•ä¸OSäº¤äº’ã€‚ </p><br><p> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºå¦‚ä½•åœ¨Emboxä¸Šæ„å»ºå’Œè¿è¡ŒQuake3ã€‚ </p><a name="habracut"></a><br><p> æ›´ç¡®åˆ‡åœ°è¯´ï¼Œæˆ‘ä»¬ä¸ä¼šè¿è¡Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Quake3</a>æœ¬èº«ï¼Œè€Œæ˜¯è¿è¡ŒåŸºäºå®ƒçš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ioquake3</a> ï¼Œå®ƒä¹Ÿå…·æœ‰å¼€æºä»£ç ã€‚ ä¸ºäº†ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†ioquake3ç§°ä¸ºåœ°éœ‡ï¼š) </p><br><p> æˆ‘å°†ç«‹å³ä¿ç•™ä¸€ç‚¹ï¼Œå³æœ¬æ–‡ä¸ä¼šåˆ†æQuakeæºä»£ç åŠå…¶ä½“ç³»ç»“æ„ï¼ˆæ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨æ­¤å¤„</a>é˜…è¯»æœ‰å…³å†…å®¹ï¼Œå¹¶<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨HabrÃ©ä¸Š</a>è¿›è¡Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç¿»è¯‘</a> ï¼‰ï¼Œè€Œæœ¬æ–‡å°†é‡ç‚¹ä»‹ç»å¦‚ä½•ç¡®ä¿åœ¨æ–°æ“ä½œç³»ç»Ÿä¸Šå¯åŠ¨æ¸¸æˆã€‚ </p><br><p> ä¸ºäº†æ›´å¥½åœ°ç†è§£ï¼Œç®€åŒ–äº†æœ¬æ–‡ä¸­æä¾›çš„ä»£ç ç‰‡æ®µï¼šçœç•¥äº†é”™è¯¯æ£€æŸ¥ï¼Œä½¿ç”¨äº†ä¼ªä»£ç ï¼Œä¾æ­¤ç±»æ¨ã€‚ åŸå§‹èµ„æºå¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æˆ‘ä»¬çš„èµ„æºåº“ä¸­</a>æ‰¾åˆ°ã€‚ </p><br><h2 id="zavisimosti"> ä¾å­˜å…³ç³» </h2><br><p> å¥‡æ€ªçš„æ˜¯ï¼Œæ„å»ºQuake3å¹¶ä¸éœ€è¦å¾ˆå¤šåº“ã€‚ æˆ‘ä»¬å°†éœ€è¦ï¼š </p><br><ul><li> POSIX + LibC- <code>malloc()</code> / <code>memcpy()</code> / <code>printf()</code>ç­‰ç­‰ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">libcurl-</a>ç½‘ç»œ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Mesa3D</a> -OpenGLæ”¯æŒ </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SDL-</a>è¾“å…¥å’ŒéŸ³é¢‘è®¾å¤‡æ”¯æŒ </li></ul><br><p> åœ¨ç¬¬ä¸€æ®µä¸­ï¼Œæ‰€æœ‰å†…å®¹éƒ½å¾ˆæ¸…æ¥š-å¦‚æœæ²¡æœ‰è¿™äº›åŠŸèƒ½ï¼Œä½¿ç”¨Cè¿›è¡Œå¼€å‘æ—¶å°†å¾ˆéš¾åšåˆ°è¿™ä¸€ç‚¹ï¼Œå¹¶ä¸”æœŸæœ›ä½¿ç”¨è¿™äº›è°ƒç”¨ã€‚ å› æ­¤ï¼Œå‡ ä¹æ‰€æœ‰æ“ä½œç³»ç»Ÿéƒ½å¯ä»¥æŸç§æ–¹å¼è·å¾—å¯¹è¿™äº›æ¥å£çš„æ”¯æŒï¼Œå¹¶ä¸”åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®é™…ä¸Šä¸éœ€è¦æ·»åŠ åŠŸèƒ½ã€‚ æˆ‘ä¸å¾—ä¸å¤„ç†å…¶ä½™çš„äº‹æƒ…ã€‚ </p><br><h3 id="libcurl">  libcurl </h3><br><p> è¿™æ˜¯æœ€ç®€å•çš„ã€‚  Libcè¶³ä»¥æ„å»ºlibcurlï¼ˆå½“ç„¶ï¼ŒæŸäº›åŠŸèƒ½å°†ä¸å¯ç”¨ï¼Œä½†ä¸éœ€è¦ï¼‰ã€‚ é…ç½®å’Œæ„å»ºè¯¥åº“åœ¨é™æ€ä¸Šéå¸¸ç®€å•ã€‚ </p><br><p> é€šå¸¸ï¼Œåº”ç”¨ç¨‹åºå’Œåº“éƒ½æ˜¯åŠ¨æ€é“¾æ¥çš„ï¼Œä½†æ˜¯å› ä¸º åœ¨Emboxä¸­ï¼Œä¸»è¦æ¨¡å¼æ˜¯é“¾æ¥ä¸€å¼ å›¾ç‰‡ï¼Œæˆ‘ä»¬å°†é™æ€é“¾æ¥æ‰€æœ‰å†…å®¹ã€‚ </p><br><p> æ ¹æ®ä½¿ç”¨çš„æ„å»ºç³»ç»Ÿï¼Œå…·ä½“æ­¥éª¤ä¼šæœ‰æ‰€ä¸åŒï¼Œä½†æ˜¯å«ä¹‰æ˜¯è¿™æ ·çš„ï¼š </p><br><pre> <code class="hljs powershell">wget https://curl.haxx.se/download/curl<span class="hljs-literal"><span class="hljs-literal">-7</span></span>.<span class="hljs-number"><span class="hljs-number">61.1</span></span>.tar.gz tar <span class="hljs-literal"><span class="hljs-literal">-xf</span></span> curl<span class="hljs-literal"><span class="hljs-literal">-7</span></span>.<span class="hljs-number"><span class="hljs-number">61.1</span></span>.tar.gz cd curl<span class="hljs-literal"><span class="hljs-literal">-7</span></span>.<span class="hljs-number"><span class="hljs-number">61.1</span></span> ./configure -<span class="hljs-literal"><span class="hljs-literal">-enable</span></span><span class="hljs-literal"><span class="hljs-literal">-static</span></span> -<span class="hljs-literal"><span class="hljs-literal">-host</span></span>=i386<span class="hljs-literal"><span class="hljs-literal">-unknown</span></span><span class="hljs-literal"><span class="hljs-literal">-none</span></span> <span class="hljs-literal"><span class="hljs-literal">-disable</span></span><span class="hljs-literal"><span class="hljs-literal">-shared</span></span> make ls ./lib/.libs/libcurl.a <span class="hljs-comment"><span class="hljs-comment">#      </span></span></code> </pre> <br><h3 id="mesaopengl"> å°é¢/ OpenGL </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Mesa</a>æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†å›¾å½¢çš„å¼€æºæ¡†æ¶ï¼Œå®ƒæ”¯æŒè®¸å¤šæ¥å£ï¼ˆOpenCLï¼ŒVulkanç­‰ï¼‰ï¼Œä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯¹OpenGLæ„Ÿå…´è¶£ã€‚ ç§»æ¤å¦‚æ­¤å¤§çš„æ¡†æ¶æ˜¯å¦ä¸€ç¯‡æ–‡ç« çš„ä¸»é¢˜ã€‚ æˆ‘åªé™äºEmbox Mesa3Då·²ç»å…·å¤‡çš„åŠŸèƒ½ï¼š)å½“ç„¶ï¼Œä»»ä½•OpenGLå®ç°éƒ½é€‚ç”¨äºæ­¤ã€‚ </p><br><h3 id="sdl">  Sdl </h3><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SDL</a>æ˜¯ç”¨äºå¤„ç†è¾“å…¥è®¾å¤‡ï¼ŒéŸ³é¢‘å’Œå›¾å½¢çš„è·¨å¹³å°æ¡†æ¶ã€‚ </p><br><p> ç°åœ¨ï¼Œæˆ‘ä»¬å°†é”¤é™¤å›¾å½¢ä¹‹å¤–çš„æ‰€æœ‰å†…å®¹ï¼Œå¹¶ç»˜åˆ¶æ¡†æ¶ï¼Œå¹¶ç¼–å†™å­˜æ ¹å‡½æ•°ä»¥æŸ¥çœ‹ä½•æ—¶å¼€å§‹è°ƒç”¨å®ƒä»¬ã€‚ </p><br><p> åœ¨<code>SDL2-2.0.8/src/video/SDL_video.c</code>ä¸­è®¾ç½®äº†ç”¨äºå¤„ç†å›¾å½¢çš„åç«¯ã€‚ </p><br><p> çœ‹èµ·æ¥åƒè¿™æ ·ï¼š </p><br><pre> <code class="hljs cs"><span class="hljs-comment"><span class="hljs-comment">/* Available video drivers */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> VideoBootStrap *bootstrap[] = { <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> SDL_VIDEO_DRIVER_COCOA &amp;COCOA_bootstrap, #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> SDL_VIDEO_DRIVER_X11 &amp;X11_bootstrap, #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> ... }</span></span></code> </pre> <br><p> ä¸ºäº†ä¸æ‰“æ‰°æ–°å¹³å°çš„â€œæ­£å¸¸â€æ”¯æŒï¼Œåªéœ€æ·»åŠ æ‚¨çš„<code>VideoBootStrap</code> </p><br><p> ä¸ºç®€å•èµ·è§ï¼Œæ‚¨å¯ä»¥ä»¥<code>src/video/qnx/video.c</code>æˆ–<code>src/video/raspberry/SDL_rpivideo.c</code> <code>src/video/qnx/video.c</code>ä¸ºåŸºç¡€ï¼Œä½†æ˜¯é¦–å…ˆæˆ‘ä»¬å°†å®ç°å‡ ä¹ä¸ºç©ºï¼š </p><br><pre> <code class="hljs cpp"><span class="hljs-comment"><span class="hljs-comment">/* SDL_sysvideo.h */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">typedef</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VideoBootStrap</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *name; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *desc;``` <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> (*available) (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>); SDL_VideoDevice *(*create) (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> devindex); } VideoBootStrap; <span class="hljs-comment"><span class="hljs-comment">/* embox_video.c */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> SDL_VideoDevice *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createDevice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> devindex)</span></span></span><span class="hljs-function"> </span></span>{ SDL_VideoDevice *device; device = (SDL_VideoDevice *)SDL_calloc(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(SDL_VideoDevice)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (device == <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> device; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">available</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>; } VideoBootStrap EMBOX_bootstrap = { <span class="hljs-string"><span class="hljs-string">"embox"</span></span>, <span class="hljs-string"><span class="hljs-string">"EMBOX Screen"</span></span>, available, createDevice };</code> </pre><br><p> å°†æ‚¨çš„<code>VideoBootStrap</code>æ·»åŠ åˆ°é˜µåˆ—ï¼š </p><br><pre> <code class="hljs cs"><span class="hljs-comment"><span class="hljs-comment">/* Available video drivers */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> VideoBootStrap *bootstrap[] = { &amp;EMBOX_bootstrap, <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> SDL_VIDEO_DRIVER_COCOA &amp;COCOA_bootstrap, #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">if</span></span></span><span class="hljs-meta"> SDL_VIDEO_DRIVER_X11 &amp;X11_bootstrap, #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">endif</span></span></span><span class="hljs-meta"> ... }</span></span></code> </pre> <br><p> åŸºæœ¬ä¸Šï¼Œè¿™æ—¶æ‚¨å·²ç»å¯ä»¥ç¼–è¯‘SDLã€‚ ä¸libcurlä¸€æ ·ï¼Œç¼–è¯‘ç»†èŠ‚å°†å–å†³äºç‰¹å®šçš„æ„å»ºç³»ç»Ÿï¼Œä½†æ˜¯æ‚¨éœ€è¦ä»¥æŸç§æ–¹å¼æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š </p><br><pre> <code class="hljs powershell">./configure -<span class="hljs-literal"><span class="hljs-literal">-host</span></span>=i386<span class="hljs-literal"><span class="hljs-literal">-unknown</span></span><span class="hljs-literal"><span class="hljs-literal">-none</span></span> \ -<span class="hljs-literal"><span class="hljs-literal">-enable</span></span><span class="hljs-literal"><span class="hljs-literal">-static</span></span> \ -<span class="hljs-literal"><span class="hljs-literal">-enable</span></span><span class="hljs-literal"><span class="hljs-literal">-audio</span></span>=no \ -<span class="hljs-literal"><span class="hljs-literal">-enable</span></span><span class="hljs-literal"><span class="hljs-literal">-video</span></span><span class="hljs-literal"><span class="hljs-literal">-directfb</span></span>=no \ -<span class="hljs-literal"><span class="hljs-literal">-enable</span></span><span class="hljs-literal"><span class="hljs-literal">-directfb</span></span><span class="hljs-literal"><span class="hljs-literal">-shared</span></span>=no \ -<span class="hljs-literal"><span class="hljs-literal">-enable</span></span><span class="hljs-literal"><span class="hljs-literal">-video</span></span><span class="hljs-literal"><span class="hljs-literal">-vulkan</span></span>=no \ -<span class="hljs-literal"><span class="hljs-literal">-enable</span></span><span class="hljs-literal"><span class="hljs-literal">-video</span></span><span class="hljs-literal"><span class="hljs-literal">-dummy</span></span>=no \ -<span class="hljs-literal"><span class="hljs-literal">-with</span></span><span class="hljs-literal"><span class="hljs-literal">-x</span></span>=no make ls build/.libs/libSDL2.a <span class="hljs-comment"><span class="hljs-comment">#     </span></span></code> </pre> <br><h2 id="sobiraem-sam-quake"> æˆ‘ä»¬æ”¶é›†åœ°éœ‡æœ¬èº« </h2><br><p>  Quake3æ¶‰åŠåŠ¨æ€åº“çš„ä½¿ç”¨ï¼Œä½†æˆ‘ä»¬å°†åƒå…¶ä»–æ‰€æœ‰å†…å®¹ä¸€æ ·å°†å…¶é™æ€é“¾æ¥ã€‚ </p><br><p> ä¸ºæ­¤ï¼Œè¯·åœ¨Makefileä¸­è®¾ç½®ä¸€äº›å˜é‡ </p><br><pre> <code class="hljs objectivec">CROSS_COMPILING=<span class="hljs-number"><span class="hljs-number">1</span></span> USE_OPENAL=<span class="hljs-number"><span class="hljs-number">0</span></span> USE_OPENAL_DLOPEN=<span class="hljs-number"><span class="hljs-number">0</span></span> USE_RENDERER_DLOPEN=<span class="hljs-number"><span class="hljs-number">0</span></span> SHLIBLDFLAGS=-<span class="hljs-keyword"><span class="hljs-keyword">static</span></span></code> </pre> <br><h2 id="pervyy-zapusk"> é¦–æ¬¡å‘å°„ </h2><br><p> ä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬å°†åœ¨qemu / x86ä¸Šè¿è¡Œã€‚ ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦å®‰è£…å®ƒï¼ˆè¿™é‡Œå’Œä¸‹é¢å°†æœ‰Debiançš„å‘½ä»¤ï¼Œå› ä¸ºå…¶ä»–å‘è¡Œç‰ˆè½¯ä»¶åŒ…çš„åç§°å¯èƒ½æœ‰æ‰€ä¸åŒï¼‰ã€‚ </p><br><pre> <code class="hljs sql">sudo apt <span class="hljs-keyword"><span class="hljs-keyword">install</span></span> qemu-<span class="hljs-keyword"><span class="hljs-keyword">system</span></span>-i386</code> </pre> <br><p> å‘å°„æœ¬èº«ï¼š </p><br><pre> <code class="hljs powershell">qemu<span class="hljs-literal"><span class="hljs-literal">-system</span></span><span class="hljs-literal"><span class="hljs-literal">-i386</span></span> <span class="hljs-literal"><span class="hljs-literal">-kernel</span></span> build/base/bin/embox <span class="hljs-literal"><span class="hljs-literal">-m</span></span> <span class="hljs-number"><span class="hljs-number">1024</span></span> <span class="hljs-literal"><span class="hljs-literal">-vga</span></span> std <span class="hljs-literal"><span class="hljs-literal">-serial</span></span> stdio</code> </pre> <br><p> ä½†æ˜¯ï¼Œå¯åŠ¨Quakeæ—¶ï¼Œæˆ‘ä»¬ç«‹å³æ”¶åˆ°é”™è¯¯æ¶ˆæ¯ </p><br><pre> <code class="hljs go">&gt; quake3 EXCEPTION [<span class="hljs-number"><span class="hljs-number">0x6</span></span>]: error = <span class="hljs-number"><span class="hljs-number">00000000</span></span> EAX=<span class="hljs-number"><span class="hljs-number">00000001</span></span> EBX=<span class="hljs-number"><span class="hljs-number">00d</span></span>56370 ECX=<span class="hljs-number"><span class="hljs-number">80200001</span></span> EDX=<span class="hljs-number"><span class="hljs-number">0781</span></span>abfd GS=<span class="hljs-number"><span class="hljs-number">00000010</span></span> FS=<span class="hljs-number"><span class="hljs-number">00000010</span></span> ES=<span class="hljs-number"><span class="hljs-number">00000010</span></span> DS=<span class="hljs-number"><span class="hljs-number">00000010</span></span> EDI=<span class="hljs-number"><span class="hljs-number">007</span></span>b5740 ESI=<span class="hljs-number"><span class="hljs-number">007</span></span>b5740 EBP=<span class="hljs-number"><span class="hljs-number">338968</span></span>ec EIP=<span class="hljs-number"><span class="hljs-number">0081d</span></span>370 CS=<span class="hljs-number"><span class="hljs-number">00000008</span></span> EFLAGS=<span class="hljs-number"><span class="hljs-number">00210202</span></span> ESP=<span class="hljs-number"><span class="hljs-number">37895d</span></span>6d SS=<span class="hljs-number"><span class="hljs-number">53535353</span></span></code> </pre><br><p> è¯¥é”™è¯¯ä¸æ˜¯ç”±æ¸¸æˆæ˜¾ç¤ºï¼Œè€Œæ˜¯ç”±æ“ä½œç³»ç»Ÿæ˜¾ç¤ºã€‚ <del>  DebagæŒ‡å‡ºæ­¤é”™è¯¯æ˜¯ç”±äºQEMUä¸­å¯¹x86çš„SIMDæ”¯æŒä¸å®Œå…¨å¼•èµ·çš„ï¼šä¸æ”¯æŒéƒ¨åˆ†æŒ‡ä»¤ï¼Œå¹¶æŠ›å‡ºæœªçŸ¥çš„å‘½ä»¤å¼‚å¸¸ï¼ˆæ— æ•ˆæ“ä½œç ï¼‰ã€‚ </del>  <em>updï¼šæ­£å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WGH</a>åœ¨è¯„è®ºä¸­æ‰€å»ºè®®çš„é‚£æ ·ï¼ŒçœŸæ­£çš„é—®é¢˜æ˜¯æˆ‘å¿˜è®°äº†åœ¨cr0 / cr4ä¸­æ˜ç¡®å¯ç”¨SSEæ”¯æŒï¼Œå› æ­¤QEMUä¸€åˆ‡æ­£å¸¸ã€‚</em> </p><br><p> è¿™ä¸æ˜¯åœ¨Quakeæœ¬èº«ä¸­å‘ç”Ÿçš„ï¼Œè€Œæ˜¯åœ¨OpenLibMä¸­å‘ç”Ÿçš„ï¼ˆè¿™æ˜¯æˆ‘ä»¬ç”¨æ¥å®ç°æ•°å­¦åŠŸèƒ½çš„åº“<code>sin()</code> ï¼Œ <code>expf()</code>ç­‰ï¼‰ã€‚ ä¿®è¡¥OpenLibmï¼Œä»¥ä¾¿<code>__test_sse()</code>ä¸ä¼šå¯¹SSEè¿›è¡ŒçœŸæ­£çš„æ£€æŸ¥ï¼Œè€Œåªæ˜¯è®¤ä¸ºæ²¡æœ‰æ”¯æŒã€‚ </p><br><p> ä»¥ä¸Šæ­¥éª¤è¶³ä»¥è¿è¡Œï¼Œæ§åˆ¶å°ä¸­å°†æ˜¾ç¤ºä»¥ä¸‹è¾“å‡ºï¼š </p><br><pre> <code class="hljs coffeescript">&gt; quake3 ioq3 <span class="hljs-number"><span class="hljs-number">1.36</span></span> linux-x86_64 Nov <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2018</span></span> SSE instruction set <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> available ----- FS_Startup ----- We are looking <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the current search path: <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>.q3a/baseq3 ./baseq3 ---------------------- <span class="hljs-number"><span class="hljs-number">0</span></span> files <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> pk3 files <span class="hljs-string"><span class="hljs-string">"pak0.pk3"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> missing. Please copy it <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> your legitimate Q3 CDROM. Point Release files are missing. Please re-install the <span class="hljs-number"><span class="hljs-number">1.32</span></span> point release. Also check that your ioq3 executable <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the correct place <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> that every file <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the <span class="hljs-string"><span class="hljs-string">"baseq3 "</span></span> directory <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> present <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> readable ERROR: couldn<span class="hljs-string"><span class="hljs-string">'t open crashlog.txt</span></span></code> </pre> <br><p> å·²ç»ä¸é”™ï¼ŒQuake3å°è¯•å¯åŠ¨ï¼Œç”šè‡³æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ï¼ å¦‚æ‚¨æ‰€è§ï¼Œä»–ç¼ºå°‘<code>baseq3</code>ç›®å½•ä¸­çš„æ–‡ä»¶ã€‚ å®ƒåŒ…å«å£°éŸ³ï¼Œçº¹ç†ç­‰ç­‰ã€‚ è¯·æ³¨æ„ï¼Œ <code>pak0.pk3</code>åº”è¯¥ä»è®¸å¯çš„CD-ROMä¸­è·å–ï¼ˆæ˜¯çš„ï¼Œå¼€æ”¾æºä»£ç å¹¶ä¸æ„å‘³ç€å¯ä»¥å…è´¹ä½¿ç”¨ï¼‰ã€‚ </p><br><h3 id="podgotovka-diska"> ç£ç›˜å‡†å¤‡ </h3><br><pre> <code class="hljs pgsql">sudo apt install qemu-utils #  qcow2- qemu-img <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> -f qcow2 quake.img <span class="hljs-number"><span class="hljs-number">1</span></span>G #   nbd sudo modprobe nbd max_part=<span class="hljs-number"><span class="hljs-number">63</span></span> #  qcow2-      sudo qemu-nbd -c /dev/nbd0 quake.img sudo mkfs.ext4 /dev/nbd0 sudo mount /dev/nbd0 /mnt cp -r <span class="hljs-type"><span class="hljs-type">path</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">to</span></span>/q3/baseq3 /mnt sync sudo umount /mnt sudo qemu-nbd -d /dev/nbd0</code> </pre> <br><p> ç°åœ¨æ‚¨å¯ä»¥å°†å—è®¾å¤‡è½¬ç§»åˆ°qemu </p><br><pre> <code class="hljs powershell">qemu<span class="hljs-literal"><span class="hljs-literal">-system</span></span><span class="hljs-literal"><span class="hljs-literal">-i386</span></span> <span class="hljs-literal"><span class="hljs-literal">-kernel</span></span> build/base/bin/embox <span class="hljs-literal"><span class="hljs-literal">-m</span></span> <span class="hljs-number"><span class="hljs-number">1024</span></span> <span class="hljs-literal"><span class="hljs-literal">-vga</span></span> std <span class="hljs-literal"><span class="hljs-literal">-serial</span></span> stdio <span class="hljs-literal"><span class="hljs-literal">-hda</span></span> quake.img</code> </pre> <br><p> å½“ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œå°†ç£ç›˜æŒ‚è½½åœ¨<code>/mnt</code>å¹¶åœ¨æ­¤ç›®å½•ä¸­è¿è¡Œquake3ï¼Œè¿™ä¸€æ¬¡å®ƒç¨åå´©æºƒ </p><br><pre> <code class="hljs dos">&gt; mount -t ext4 /dev/hda1 /mnt &gt; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /mnt &gt; quake3 ioq3 <span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">36</span></span> linux-x86_64 Nov <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2018</span></span> SSE instruction <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> available ----- FS_Startup ----- We are looking <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> the current search <span class="hljs-built_in"><span class="hljs-built_in">path</span></span>: //.q3a/baseq3 ./baseq3 ./baseq3/pak8.pk3 (<span class="hljs-number"><span class="hljs-number">9</span></span> files) ./baseq3/pak7.pk3 (<span class="hljs-number"><span class="hljs-number">4</span></span> files) ./baseq3/pak6.pk3 (<span class="hljs-number"><span class="hljs-number">64</span></span> files) ./baseq3/pak5.pk3 (<span class="hljs-number"><span class="hljs-number">7</span></span> files) ./baseq3/pak4.pk3 (<span class="hljs-number"><span class="hljs-number">272</span></span> files) ./baseq3/pak3.pk3 (<span class="hljs-number"><span class="hljs-number">4</span></span> files) ./baseq3/pak2.pk3 (<span class="hljs-number"><span class="hljs-number">148</span></span> files) ./baseq3/pak1.pk3 (<span class="hljs-number"><span class="hljs-number">26</span></span> files) ./baseq3/pak0.pk3 (<span class="hljs-number"><span class="hljs-number">3539</span></span> files) ---------------------- <span class="hljs-number"><span class="hljs-number">4073</span></span> files <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> pk3 files execing default.cfg couldn't exec q3config.cfg couldn't exec autoexec.cfg Hunk_Clear: reset the hunk ok Com_RandomBytes: using weak randomization ----- Client Initialization ----- Couldn't read q3history. ----- Initializing Renderer ---- ------------------------------- QKEY building random string Com_RandomBytes: using weak randomization QKEY generated ----- Client Initialization Complete ----- ----- R_Init ----- tty]EXCEPTION [<span class="hljs-number"><span class="hljs-number">0</span></span>xe]: error = <span class="hljs-number"><span class="hljs-number">00000000</span></span> EAX=<span class="hljs-number"><span class="hljs-number">00000000</span></span> EBX=<span class="hljs-number"><span class="hljs-number">00</span></span>d2a2d4 ECX=<span class="hljs-number"><span class="hljs-number">00000000</span></span> EDX=<span class="hljs-number"><span class="hljs-number">111011</span></span>e0 GS=<span class="hljs-number"><span class="hljs-number">00000010</span></span> <span class="hljs-built_in"><span class="hljs-built_in">FS</span></span>=<span class="hljs-number"><span class="hljs-number">00000010</span></span> ES=<span class="hljs-number"><span class="hljs-number">00000010</span></span> DS=<span class="hljs-number"><span class="hljs-number">00000010</span></span> EDI=<span class="hljs-number"><span class="hljs-number">0366</span></span>d158 ESI=<span class="hljs-number"><span class="hljs-number">111011</span></span>e0 EBP=<span class="hljs-number"><span class="hljs-number">37869918</span></span> EIP=<span class="hljs-number"><span class="hljs-number">00000000</span></span> CS=<span class="hljs-number"><span class="hljs-number">00000008</span></span> EFLAGS=<span class="hljs-number"><span class="hljs-number">00010212</span></span> ESP=<span class="hljs-number"><span class="hljs-number">006</span></span>ef6ca SS=<span class="hljs-number"><span class="hljs-number">111011</span></span>e0 EXCEPTION [<span class="hljs-number"><span class="hljs-number">0</span></span>xe]: error = <span class="hljs-number"><span class="hljs-number">00000000</span></span></code> </pre> <br><p><del>  Qemuä¸­çš„SIMDå†æ¬¡å‡ºç°æ­¤é”™è¯¯ã€‚ </del>  <em>updï¼šæ­£å¦‚<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">WGH</a>åœ¨è¯„è®ºä¸­æ‰€å»ºè®®çš„é‚£æ ·ï¼ŒçœŸæ­£çš„é—®é¢˜æ˜¯æˆ‘å¿˜è®°äº†åœ¨cr0 / cr4ä¸­æ˜ç¡®å¯ç”¨SSEæ”¯æŒï¼Œå› æ­¤QEMUä¸€åˆ‡æ­£å¸¸ã€‚</em> è¿™æ¬¡ï¼Œè¿™äº›æŒ‡ä»¤åœ¨Quake3 x86è™šæ‹Ÿæœºä¸­ä½¿ç”¨ã€‚ é€šè¿‡ç”¨è§£é‡Šåçš„VMæ›¿æ¢x86çš„å®ç°è§£å†³äº†è¯¥é—®é¢˜ï¼ˆæœ‰å…³Quake3è™šæ‹Ÿæœºçš„æ›´å¤šä¿¡æ¯ä»¥åŠä»åŸåˆ™ä¸Šè®²ï¼Œä½“ç³»ç»“æ„çš„åŠŸèƒ½ï¼Œæ‚¨å¯ä»¥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åœ¨åŒä¸€ç¯‡æ–‡ç« ä¸­</a>é˜…è¯»æ‰€æœ‰<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å†…å®¹</a> ï¼‰ã€‚ ä¹‹åï¼Œæˆ‘ä»¬çš„SDLå‡½æ•°å¼€å§‹è¢«è°ƒç”¨ï¼Œä½†æ˜¯ï¼Œå½“ç„¶ä»€ä¹ˆä¹Ÿæ²¡æœ‰å‘ç”Ÿï¼Œå› ä¸º è¿™äº›åŠŸèƒ½ä»€ä¹ˆä¹Ÿæ²¡åšã€‚ </p><br><h2 id="dobavlyaem-podderzhku-grafiki"> æ·»åŠ å›¾å½¢æ”¯æŒ </h2><br><pre> <code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> SDL_VideoDevice *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createDevice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> devindex)</span></span></span><span class="hljs-function"> </span></span>{ ... device-&gt;GL_GetProcAddress = glGetProcAddress; device-&gt;GL_CreateContext = glCreateContext; ... } <span class="hljs-comment"><span class="hljs-comment">/*   OpenGL- */</span></span> <span class="hljs-function"><span class="hljs-function">SDL_GLContext </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">glCreateContext</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_THIS, SDL_Window *window)</span></span></span><span class="hljs-function"> </span></span>{ OSMesaContext ctx; <span class="hljs-comment"><span class="hljs-comment">/*   -  --    .. */</span></span> sdl_init_buffers(); <span class="hljs-comment"><span class="hljs-comment">/*    Mesa */</span></span> ctx = OSMesaCreateContextExt(OSMESA_BGRA, <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); OSMesaMakeCurrent(ctx, fb_base, GL_UNSIGNED_BYTE, fb_width, fb_height); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ctx; }</code> </pre> <br><p> éœ€è¦ç¬¬äºŒä¸ªå¤„ç†ç¨‹åºæ¥å‘Šè¯‰SDLä½¿ç”¨OpenGLæ—¶è¦è°ƒç”¨å“ªäº›å‡½æ•°ã€‚ </p><br><p> ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯åŠ¨ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åä»å¤´åˆ°å°¾æ£€æŸ¥ç¼ºå°‘çš„è°ƒç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š </p><br><pre> <code class="hljs cpp"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> *proc; <span class="hljs-keyword"><span class="hljs-keyword">void</span></span> *fn; } embox_sdl_tbl[] = { { <span class="hljs-string"><span class="hljs-string">"glClear"</span></span>, glClear }, { <span class="hljs-string"><span class="hljs-string">"glClearColor"</span></span>, glClearColor }, { <span class="hljs-string"><span class="hljs-string">"glColor4f"</span></span>, glColor4f }, { <span class="hljs-string"><span class="hljs-string">"glColor4ubv"</span></span>, glColor4ubv }, { <span class="hljs-number"><span class="hljs-number">0</span></span> }, }; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">glGetProcAddress</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_THIS, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *proc)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; embox_sdl_tbl[i].proc != <span class="hljs-number"><span class="hljs-number">0</span></span>; i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-built_in"><span class="hljs-built_in">strcmp</span></span>(embox_sdl_tbl[i].proc, proc)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> embox_sdl_tbl[i].fn; } } <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"embox/sdl: Failed to find %s\n"</span></span>, proc); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><p> åœ¨å‡ æ¬¡é‡æ–°å¯åŠ¨åï¼Œåˆ—è¡¨å˜å¾—è¶³å¤Ÿå®Œæ•´ï¼Œå¯ä»¥ç»˜åˆ¶åˆå§‹å±å¹•å’Œèœå•ã€‚ å¹¸è¿çš„æ˜¯ï¼ŒMesaå…·æœ‰æ‰€æœ‰å¿…éœ€çš„åŠŸèƒ½ã€‚ å”¯ä¸€çš„åŸå› æ˜¯ç”±äºæŸç§åŸå› æ²¡æœ‰<code>glGetString()</code>å‡½æ•°ï¼Œ <code>glGetString()</code>å¿…é¡»ä½¿ç”¨<code>glGetString()</code> ã€‚ </p><br><p> ç°åœ¨ï¼Œå½“åº”ç”¨ç¨‹åºå¯åŠ¨æ—¶ï¼Œä¼šå‡ºç°ä¸€ä¸ªåˆå§‹å±å¹•ï¼Œæ¬¢å‘¼ï¼ </p><br><img src="https://habrastorage.org/webt/_o/te/pv/_otepvhrhcyqp1aotjvgcylm4fs.png"><br><br><h2 id="dobavlyaem-ustroystva-vvoda"> æ·»åŠ è¾“å…¥è®¾å¤‡ </h2><br><p> å°†é”®ç›˜å’Œé¼ æ ‡æ”¯æŒæ·»åŠ åˆ°SDLã€‚ </p><br><p> è¦å¤„ç†äº‹ä»¶ï¼Œæ‚¨éœ€è¦æ·»åŠ ä¸€ä¸ªå¤„ç†ç¨‹åº </p><br><pre> <code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> SDL_VideoDevice *</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createDevice</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> devindex)</span></span></span><span class="hljs-function"> </span></span>{ ... device-&gt;PumpEvents = pumpEvents; ... }</code> </pre> <br><p> è®©æˆ‘ä»¬ä»é”®ç›˜å¼€å§‹ã€‚ æˆ‘ä»¬æŒ‚æ–­äº†ä¸€ä¸ªä¸­æ–­æŒ‰é”®çš„åŠŸèƒ½ã€‚ è¿™ä¸ªå‡½æ•°åº”è¯¥è®°ä½äº‹ä»¶ï¼ˆåœ¨æœ€ç®€å•çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªå†™ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œå¦‚æœéœ€è¦çš„è¯å¯ä»¥ä½¿ç”¨é˜Ÿåˆ—ï¼‰ï¼Œä¸ºç®€å•èµ·è§ï¼Œæˆ‘ä»¬åªå­˜å‚¨æœ€åä¸€ä¸ªäº‹ä»¶ã€‚ </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> input_event last_event; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sdl_indev_eventhnd</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">struct</span></span></span></span><span class="hljs-function"><span class="hljs-params"> input_dev *indev</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">/*    ,   last_event */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-number"><span class="hljs-number">0</span></span> == input_dev_event(indev, &amp;last_event)) { } }</code> </pre><br><p> ç„¶åï¼Œåœ¨<code>pumpEvents()</code>å¤„ç†äº‹ä»¶å¹¶å°†å…¶ä¼ é€’ç»™SDLï¼š </p><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pumpEvents</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_THIS</span></span></span><span class="hljs-function">)</span></span> { SDL_Scancode scancode; <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> pressed; scancode = scancode_from_event(&amp;last_event); pressed = is_press(last_event); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pressed) { SDL_SendKeyboardKey(SDL_PRESSED, scancode); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { SDL_SendKeyboardKey(SDL_RELEASED, scancode); } }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">æœ‰å…³å¯†é’¥ä»£ç å’ŒSDL_Scancodeçš„æ›´å¤šä¿¡æ¯</b> <div class="spoiler_text"><p>  SDLå¯¹å¯†é’¥ä»£ç ä½¿ç”¨å…¶è‡ªå·±çš„æšä¸¾ï¼Œå› æ­¤æ‚¨å¿…é¡»å°†OSå¯†é’¥ä»£ç è½¬æ¢ä¸ºSDLä»£ç ã€‚ </p><br><p> è¿™äº›ä»£ç çš„åˆ—è¡¨åœ¨<code>SDL_scancode.h</code>æ–‡ä»¶ä¸­å®šä¹‰ </p><br><p> ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥åƒè¿™æ ·è½¬æ¢ASCIIä»£ç ï¼ˆä¸æ˜¯æ‰€æœ‰çš„ASCIIå­—ç¬¦éƒ½åœ¨è¿™é‡Œï¼Œä½†æ˜¯å·²ç»è¶³å¤Ÿäº†ï¼‰ï¼š </p><br><pre> <code class="hljs powershell"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> int key_to_sdl[] = { [<span class="hljs-string"><span class="hljs-string">' '</span></span>] = SDL_SCANCODE_SPACE, [<span class="hljs-string"><span class="hljs-string">'\r'</span></span>] = SDL_SCANCODE_RETURN, [<span class="hljs-number"><span class="hljs-number">27</span></span>] = SDL_SCANCODE_ESCAPE, [<span class="hljs-string"><span class="hljs-string">'0'</span></span>] = SDL_SCANCODE_0, [<span class="hljs-string"><span class="hljs-string">'1'</span></span>] = SDL_SCANCODE_1, ... [<span class="hljs-string"><span class="hljs-string">'8'</span></span>] = SDL_SCANCODE_8, [<span class="hljs-string"><span class="hljs-string">'9'</span></span>] = SDL_SCANCODE_9, [<span class="hljs-string"><span class="hljs-string">'a'</span></span>] = SDL_SCANCODE_A, [<span class="hljs-string"><span class="hljs-string">'b'</span></span>] = SDL_SCANCODE_B, [<span class="hljs-string"><span class="hljs-string">'c'</span></span>] = SDL_SCANCODE_C, ... [<span class="hljs-string"><span class="hljs-string">'x'</span></span>] = SDL_SCANCODE_X, [<span class="hljs-string"><span class="hljs-string">'y'</span></span>] = SDL_SCANCODE_Y, [<span class="hljs-string"><span class="hljs-string">'z'</span></span>] = SDL_SCANCODE_Z, };</code> </pre></div></div><br><p> é”®ç›˜å°±è¿™äº›äº†ï¼Œå…¶ä½™çš„å°†ç”±SDLå’ŒQuakeæœ¬èº«å¤„ç†ã€‚ é¡ºä¾¿è¯´ä¸€å¥ï¼Œè¿™é‡Œçš„ç»“æœæ˜¯ï¼Œåœ¨å¤„ç†é”®å‡»æ—¶ï¼Œquakeä½¿ç”¨äº†QEMUä¸æ”¯æŒçš„æŒ‡ä»¤ï¼Œæ‚¨å¿…é¡»ä»x86è™šæ‹Ÿæœºåˆ‡æ¢åˆ°è§£é‡Šçš„è™šæ‹Ÿæœºï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬åœ¨<code>BASE_CFLAGS += -DNO_VM_COMPILED</code>æ·»åŠ äº†<code>BASE_CFLAGS += -DNO_VM_COMPILED</code> ã€‚ </p><br><p> ä¹‹åï¼Œæœ€åï¼Œæ‚¨å¯ä»¥éƒ‘é‡åœ°â€œè·³è¿‡â€å±å¹•ä¿æŠ¤ç¨‹åºï¼Œç”šè‡³å¼€å§‹æ¸¸æˆï¼ˆç ´è§£ä¸€äº›é”™è¯¯:)ï¼‰ã€‚ ä»¤äººæƒŠè®¶çš„æ˜¯ï¼Œå°½ç®¡å¸§é€Ÿç‡å¾ˆä½ï¼Œä½†ä¸€åˆ‡éƒ½æŒ‰åŸæ ·å‘ˆç°ã€‚ </p><br><p><img src="https://habrastorage.org/webt/fk/rx/cj/fkrxcjn_k-kheteoo4ak1tdwb2q.png"></p><br><p> ç°åœ¨ï¼Œæ‚¨å¯ä»¥å¼€å§‹é¼ æ ‡æ”¯æŒã€‚ å¯¹äºé¼ æ ‡ä¸­æ–­ï¼Œæ‚¨éœ€è¦ä¸€ä¸ªå¤„ç†ç¨‹åºï¼Œå¹¶ä¸”äº‹ä»¶å¤„ç†å°†å˜å¾—æœ‰äº›å¤æ‚ã€‚ æˆ‘ä»¬åªé™äºé¼ æ ‡å·¦é”®ã€‚ æ˜¾ç„¶ï¼Œæ‚¨å¯ä»¥ä»¥ç›¸åŒçš„æ–¹å¼æ·»åŠ å³é”®ï¼Œæ»šè½®ç­‰ã€‚ </p><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pumpEvents</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_THIS</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (from_keyboard(&amp;last_event)) { <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> ... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is_left_click(&amp;last_event)) { <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> SDL_SendMouseButton(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, SDL_PRESSED, SDL_BUTTON_LEFT); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (is_left_release(&amp;last_event)) { <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> SDL_SendMouseButton(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, SDL_RELEASED, SDL_BUTTON_LEFT); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> SDL_SendMouseMotion(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, mouse_diff_x(), <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> mouse_diff_y()); <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> } } }</code> </pre> <br><p> ä¹‹åï¼Œå°±å¯ä»¥æ§åˆ¶ç›¸æœºæ‹æ‘„ï¼ŒåŠ æ²¹ï¼ å®é™…ä¸Šï¼Œè¿™å·²ç»è¶³å¤Ÿç©äº†:) </p><br><p><img src="https://habrastorage.org/webt/q5/pz/lb/q5pzlbtkbrinpcmgdggt4e5vfma.png"></p><br><h2 id="optimizaciya"> æœ€ä½³åŒ– </h2><br><p> å½“ç„¶ï¼Œæœ‰æ§ä»¶å’ŒæŸç§å›¾å½¢å¾ˆé…·ï¼Œä½†æ˜¯è¿™æ ·çš„FPSç»å¯¹æ¯«æ— ä»·å€¼ã€‚ æœ€æœ‰å¯èƒ½çš„æ˜¯ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½èŠ±åœ¨äº†OpenGLä¸Šï¼ˆè¿™æ˜¯è½¯ä»¶ï¼Œè€Œä¸”ä¸ä½¿ç”¨SIMDï¼‰ï¼Œå¹¶ä¸”ç¡¬ä»¶æ”¯æŒçš„å®ç°æ—¶é—´å¤ªé•¿ä¸”ä»»åŠ¡å¤æ‚ã€‚ </p><br><p> è®©æˆ‘ä»¬å°è¯•ä¸€ç‚¹ç‚¹åŠ é€Ÿæ¸¸æˆã€‚ </p><br><h3 id="optimizaciya-kompilyatora-i-snizhenie-razresheniya"> ç¼–è¯‘å™¨ä¼˜åŒ–å’Œè¾ƒä½çš„åˆ†è¾¨ç‡ </h3><br><p> æˆ‘ä»¬æ­£åœ¨ä½¿ç”¨<code>-O3</code>æ„å»ºæ¸¸æˆï¼Œæ‰€æœ‰åº“ä»¥åŠOSæœ¬èº«ï¼ˆå¦‚æœçªç„¶ä¹‹é—´æœ‰äººè¯»åˆ°äº†è¿™ä¸ªåœ°æ–¹ï¼Œä½†ä¸çŸ¥é“è¿™ä¸ªæ ‡å¿—æ˜¯ä»€ä¹ˆï¼Œå¯ä»¥åœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ­¤å¤„</a>æ‰¾åˆ°æœ‰å…³GCCä¼˜åŒ–æ ‡å¿—çš„æ›´å¤šä¿¡æ¯ï¼‰ã€‚ </p><br><p> æ­¤å¤–ï¼Œæˆ‘ä»¬ä½¿ç”¨æœ€ä½åˆ†è¾¨ç‡-320x240æ¥ä¿ƒè¿›å¤„ç†å™¨çš„å·¥ä½œã€‚ </p><br><h3 id="kvm"> è™šæ‹Ÿæœº </h3><br><p>  KVMï¼ˆåŸºäºå†…æ ¸çš„è™šæ‹Ÿæœºï¼‰ä½¿æ‚¨å¯ä»¥ä½¿ç”¨ç¡¬ä»¶è™šæ‹ŸåŒ–ï¼ˆIntel VTå’ŒAMD-Vï¼‰æ¥æé«˜æ€§èƒ½ã€‚  Qemuæ”¯æŒæ­¤æœºåˆ¶ï¼Œè¦ä½¿ç”¨å®ƒï¼Œæ‚¨éœ€è¦æ‰§è¡Œä»¥ä¸‹æ“ä½œã€‚ </p><br><p> é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨BIOSä¸­å¯ç”¨è™šæ‹ŸåŒ–æ”¯æŒã€‚ æˆ‘æœ‰ä¸€ä¸ªæŠ€å˜‰B450M DS3Hä¸»æ¿ï¼Œå¹¶ä¸”é€šè¿‡MIT-&gt;é«˜çº§é¢‘ç‡è®¾ç½®-&gt;é«˜çº§CPUæ ¸å¿ƒè®¾ç½®-&gt; SVMæ¨¡å¼-&gt;å¯ç”¨ï¼ˆæŠ€å˜‰ï¼Œæ‚¨æ€ä¹ˆäº†ï¼Ÿï¼‰æ‰“å¼€äº†AMD-Vã€‚ </p><br><p> ç„¶åæˆ‘ä»¬æ”¾å…¥å¿…è¦çš„åŒ…å¹¶æ·»åŠ é€‚å½“çš„æ¨¡å— </p><br><pre> <code class="hljs powershell">sudo apt install qemu<span class="hljs-literal"><span class="hljs-literal">-kvm</span></span> sudo modprobe kvm<span class="hljs-literal"><span class="hljs-literal">-amd</span></span> <span class="hljs-comment"><span class="hljs-comment">#  kvm-intel</span></span></code> </pre> <br><p> å°±æ˜¯è¿™æ ·ï¼Œç°åœ¨æ‚¨å¯ä»¥å°†<code>-enable-kvm</code>æ ‡å¿—ï¼ˆæˆ–<code>-no-kvm</code>æ ‡å¿—ï¼‰ä¼ é€’ç»™qemuï¼Œä»¥å…ä½¿ç”¨ç¡¬ä»¶åŠ é€Ÿã€‚ </p><br><h2 id="itog"> æ€»ç»“ </h2><br><iframe width="560" height="315" src="https://www.youtube.com/embed/t6k_FSF-py0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p> æ¸¸æˆå¼€å§‹ï¼Œæ ¹æ®éœ€è¦æ˜¾ç¤ºå›¾å½¢ï¼Œæ§ä»¶æ­£åœ¨å·¥ä½œã€‚ ä¸å¹¸çš„æ˜¯ï¼Œç”±äºå¸§é€Ÿç‡ä½ï¼ˆæ¯ç§’2-3å¸§ï¼‰ï¼Œå› æ­¤æ§åˆ¶èµ·æ¥éå¸¸ä¸æ–¹ä¾¿ï¼Œå› æ­¤å›¾å½¢æ˜¯åœ¨CPUä¸Šä»¥ä¸€ä¸ªæµï¼ˆä¹Ÿæ²¡æœ‰SIMDï¼‰çš„æ–¹å¼ç»˜åˆ¶çš„ã€‚ </p><br><p> ç§»æ¤è¿‡ç¨‹å¾ˆæœ‰è¶£ã€‚ ä¹Ÿè®¸å°†æ¥æœ‰å¯èƒ½åœ¨å…·æœ‰ç¡¬ä»¶å›¾å½¢åŠ é€ŸåŠŸèƒ½çš„å¹³å°ä¸Šå¯åŠ¨quakeï¼Œä½†ç°åœ¨æˆ‘å°†é‡ç‚¹å…³æ³¨ä»€ä¹ˆã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN428634/">https://habr.com/ru/post/zh-CN428634/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN428624/index.html">Jeffrey Richterï¼ŒPavel Yosifovichï¼ŒGreg Youngå’Œæ‰€æœ‰äººã€‚ DotNext 2018è«æ–¯ç§‘çš„ç¡¬æ ¸å’Œå»ºç­‘</a></li>
<li><a href="../zh-CN428626/index.html">å¦‚ä½•ä½¿PHP7ä¸­çš„æ‰©å±•æ¯”â€œ helloï¼Œworldâ€æ›´å›°éš¾ï¼Œå¹¶ä¸”ä¸è‡´äºçœ¼èŠ±redä¹±ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN428628/index.html">ä½¿ç”¨æŠ½è±¡çš„JavaScriptè¯­æ³•æ ‘</a></li>
<li><a href="../zh-CN428630/index.html">ä¸ï¼Œåˆ°2033å¹´ï¼Œæ¯”ç‰¹å¸ä¸ä¼šç ´åæˆ‘ä»¬çš„æ°”å€™ã€‚</a></li>
<li><a href="../zh-CN428632/index.html">åœ¨Reactä¸­å¤„ç†æ‹¦æˆªå™¨</a></li>
<li><a href="../zh-CN428636/index.html">Roskomnadzorå°†å‘Googleå¤„ä»¥ç½šæ¬¾</a></li>
<li><a href="../zh-CN428638/index.html">Hearts Flame Motorï¼šQardioCoreå¿ƒè„ç›‘æŠ¤ä»ªè¯„è®º</a></li>
<li><a href="../zh-CN428640/index.html">å°†æ‰‹æœºæ”¾åœ¨å£è¢‹é‡Œï¼šç”¨äºæ— çº¿ç”µè¯ç½‘ç»œçš„Snom DECTè®¾å¤‡</a></li>
<li><a href="../zh-CN428644/index.html">ä½çº§è„‘æ“</a></li>
<li><a href="../zh-CN428646/index.html">å»å¹´çš„iPhoneå‹å·ä¹Ÿå› ç”µæ± ç£¨æŸè€Œå‡æ…¢äº†é€Ÿåº¦</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>