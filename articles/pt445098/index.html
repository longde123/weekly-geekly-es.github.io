<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>‚ú°Ô∏è üèµÔ∏è üé´ DynamicData: alterando cole√ß√µes, padr√£o de design MVVM e extens√µes reativas üò¶ üó≥Ô∏è üï∫üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Em fevereiro de 2019, foi lan√ßado o ReactiveUI 9 , uma estrutura de plataforma cruzada para a cria√ß√£o de aplicativos GUI na plataforma Microsoft .NET....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>DynamicData: alterando cole√ß√µes, padr√£o de design MVVM e extens√µes reativas</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/445098/">  Em fevereiro de 2019, foi lan√ßado o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ReactiveUI 9</a> , uma estrutura de plataforma cruzada para a cria√ß√£o de aplicativos GUI na plataforma Microsoft .NET.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O ReactiveUI</a> √© uma ferramenta para integrar firmemente extens√µes reativas ao padr√£o de design do MVVM.  O conhecimento da estrutura pode ser iniciado com uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">s√©rie de artigos sobre Habr√©</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">na primeira p√°gina da documenta√ß√£o</a> .  A atualiza√ß√£o do ReactiveUI 9 inclui muitas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">corre√ß√µes e melhorias</a> , mas talvez a mudan√ßa mais interessante e significativa seja a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">forte integra√ß√£o com a estrutura DynamicData</a> , que permite trabalhar com a altera√ß√£o de cole√ß√µes em um estilo reativo.  Vamos tentar descobrir em que casos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData</a> pode ser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">√∫til</a> e como essa poderosa estrutura reativa √© organizada por dentro! <br><a name="habracut"></a><br><h3>  Antecedentes </h3><br>  Primeiro, definimos o intervalo de tarefas que o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData resolve</a> e descobrimos por que as ferramentas padr√£o para trabalhar com a altera√ß√£o de conjuntos de dados no namespace <code>System.Collections.ObjectModel</code> n√£o nos conv√©m. <br><br>  O modelo MVVM, como voc√™ sabe, envolve a divis√£o de responsabilidade entre as camadas do modelo, apresenta√ß√£o e modelo de apresenta√ß√£o do aplicativo.  A camada de modelo √© representada por entidades e servi√ßos de dom√≠nio e n√£o sabe nada sobre o modelo de apresenta√ß√£o.  A camada do modelo encapsula toda a l√≥gica complexa do aplicativo e o modelo de apresenta√ß√£o delega as opera√ß√µes do modelo, fornecendo √† visualiza√ß√£o acesso a informa√ß√µes sobre o estado atual do aplicativo por meio de propriedades, comandos e cole√ß√µes observ√°veis.  A ferramenta padr√£o para trabalhar com propriedades alteradas √© a interface <code>INotifyPropertyChanged</code> , <code>INotifyPropertyChanged</code> para trabalhar com a√ß√µes do usu√°rio e <code>INotifyCollectionChanged</code> implementar cole√ß√µes e implementar <code>ObservableCollection</code> e <code>ReadOnlyObservableCollection</code> . <br><br><img width="500" src="https://habrastorage.org/getpro/habr/post_images/504/c83/ab0/504c83ab04fe2e2d1eed037317b8aa2c.jpg"><br><br>  A implementa√ß√£o de <code>INotifyPropertyChanged</code> e <code>ICommand</code> geralmente permanece na consci√™ncia do desenvolvedor e da estrutura MVVM usada, mas o uso de <code>ObservableCollection</code> imp√µe v√°rias restri√ß√µes!  Por exemplo, n√£o podemos alterar uma cole√ß√£o de um encadeamento em segundo plano sem <code>Dispatcher.Invoke</code> ou uma chamada semelhante, e isso pode ser √∫til no caso de trabalhar com matrizes de dados que alguma opera√ß√£o em segundo plano sincronize com o servidor.  Deve-se notar que, no MVVM idiom√°tico, a camada de modelo n√£o precisa conhecer a arquitetura do aplicativo GUI usado e ser compat√≠vel com o modelo do MVC ou MVP, e √© por isso que v√°rios <code>Dispatcher.Invoke</code> permitem acesso ao controle da interface do usu√°rio a partir do encadeamento em execu√ß√£o em um servi√ßo de dom√≠nio, viole o princ√≠pio de compartilhar responsabilidades entre as camadas de aplicativos. <br><br>  Obviamente, em um servi√ßo de dom√≠nio, seria poss√≠vel declarar um evento e, como argumento de um evento, transmitir um peda√ßo com dados alterados.  Em seguida, inscreva-se no evento, envolva a chamada <code>Dispatcher.Invoke</code> em uma interface para que ela n√£o dependa da estrutura da GUI usada, mova <code>Dispatcher.Invoke</code> para o modelo de apresenta√ß√£o e altere a <code>ObservableCollection</code> necess√°rio, no entanto, existe uma maneira muito mais simples e elegante de resolver o intervalo de tarefas indicado sem precisar escrever uma bicicleta .  Vamos come√ßar o estudo! <br><br><h2>  Extens√µes reativas.  Gerenciar fluxos de dados </h2><br>  Para um entendimento completo das abstra√ß√µes introduzidas pelo <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData</a> e dos princ√≠pios de trabalhar com a altera√ß√£o de conjuntos de dados reativos, lembremos o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">que √© programa√ß√£o reativa e como aplic√°-la no contexto da plataforma Microsoft .NET e do padr√£o de design MVVM</a> .  Uma maneira de organizar a intera√ß√£o entre os componentes do programa pode ser interativa e reativa.  Na intera√ß√£o interativa, a fun√ß√£o do consumidor recebe dados de forma s√≠ncrona da fun√ß√£o do provedor (abordagem baseada em pull, <code>T</code> , <code>IEnumerable</code> ) e, na intera√ß√£o reativa, a fun√ß√£o do consumidor entrega assincronamente dados para a fun√ß√£o do consumidor (abordagem baseada em push, <code>Task</code> , <code>IObservable</code> ). <br><br><img width="500" src="https://habrastorage.org/webt/mb/ts/mj/mbtsmjfyhjqeeb4tv8ynotvkdms.png"><br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">A programa√ß√£o reativa</a> √© a programa√ß√£o usando fluxos de dados ass√≠ncronos, e as extens√µes reativas s√£o um caso especial de sua implementa√ß√£o, com base nas <code>IObserver</code> <code>IObservable</code> e <code>IObserver</code> do namespace System, que define v√°rias opera√ß√µes semelhantes a LINQ na interface <code>IObservable</code> , denominadas LINQ over Observable.  As extens√µes reativas suportam o .NET Standard e funcionam onde quer que a plataforma Microsoft .NET funcione. <br><br><img src="https://habrastorage.org/webt/ue/qe/80/ueqe80neq0ufivj-bq5hipdrldo.gif"><br><br>  A estrutura ReactiveUI convida os desenvolvedores de aplicativos a aproveitar a implementa√ß√£o reativa de <code>ICommand</code> e <code>INotifyPropertyChanged</code> , fornecendo ferramentas poderosas como <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>ReactiveCommand&lt;TIn, TOut&gt;</code></a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>WhenAnyValue</code></a> .  <code>WhenAnyValue</code> permite converter uma propriedade de uma classe que implementa INotifyPropertyChanged em um fluxo de eventos do tipo <code>IObservable&lt;T&gt;</code> , que simplifica a implementa√ß√£o de propriedades dependentes. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">ExampleViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveObject</span></span> { [Reactive] <span class="hljs-comment"><span class="hljs-comment">//  ReactiveUI.Fody,  // -  // OnPropertyChanged   Name. public string Name { get; set; } public ExampleViewModel() { //  OnPropertyChanged("Name"). this.WhenAnyValue(x =&gt; x.Name) //   IObservable&lt;string&gt; .Subscribe(Console.WriteLine); } }</span></span></code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>ReactiveCommand&lt;TIn, TOut&gt;</code></a> permite que voc√™ trabalhe com o comando, como em um evento do tipo <code>IObservable&lt;TOut&gt;</code> , publicado sempre que o comando concluir a execu√ß√£o.  Al√©m disso, qualquer comando possui uma propriedade <code>ThrownExceptions</code> do tipo <code>IObservable&lt;Exception&gt;</code> . <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">// ReactiveCommand&lt;Unit, int&gt; var command = ReactiveCommand.Create(() =&gt; 42); command //   IObservable&lt;int&gt; .Subscribe(Console.WriteLine); command .ThrownExceptions //   IObservable&lt;Exception&gt; .Select(exception =&gt; exception.Message) //   IObservable&lt;string&gt; .Subscribe(Console.WriteLine); command.Execute().Subscribe(); // : 42</span></span></code> </pre><br>  Todo esse tempo trabalhamos com <code>IObservable&lt;T&gt;</code> , como em um evento que publica um novo valor do tipo <code>T</code> sempre que o estado do objeto que est√° sendo monitorado √© alterado.  Simplificando, <code>IObservable&lt;T&gt;</code> √© um fluxo de eventos, uma sequ√™ncia estendida ao longo do tempo. <br><br>  Obviamente, poder√≠amos trabalhar de maneira t√£o f√°cil e natural com as cole√ß√µes - sempre que uma cole√ß√£o for alterada, publique uma nova cole√ß√£o com elementos alterados.  Nesse caso, o valor publicado seria do tipo <code>IEnumerable&lt;T&gt;</code> ou mais especializado, e o pr√≥prio evento seria do tipo <code>IObservable&lt;IEnumerable&lt;T&gt;&gt;</code> .  Mas, como o leitor que pensa criticamente corretamente aponta, isso est√° repleto de s√©rios problemas com o desempenho do aplicativo, especialmente se n√£o houver uma d√∫zia de elementos em nossa cole√ß√£o, mas uma centena ou at√© v√°rios milhares! <br><br><h2>  Introdu√ß√£o ao DynamicData </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData</a> √© uma biblioteca que permite que voc√™ use toda a pot√™ncia de extens√µes reativas ao trabalhar com cole√ß√µes.  As extens√µes reativas prontas para uso n√£o oferecem maneiras ideais de trabalhar com conjuntos de dados alterados, e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">o trabalho da DynamicData</a> √© corrigi-lo.  Na maioria dos aplicativos, √© necess√°rio atualizar dinamicamente as cole√ß√µes - geralmente, uma cole√ß√£o √© preenchida com alguns elementos quando o aplicativo √© iniciado e, em seguida, √© atualizada de forma ass√≠ncrona, sincronizando informa√ß√µes com um servidor ou banco de dados.  As aplica√ß√µes modernas s√£o bastante complexas e, muitas vezes, √© necess√°rio criar proje√ß√µes de cole√ß√µes - filtrar, transformar ou classificar elementos.  O DynamicData foi projetado apenas para se livrar do c√≥digo incrivelmente complexo que precisar√≠amos para gerenciar conjuntos de dados dinamicamente alterados.  A ferramenta √© ativamente desenvolvida e finalizada, e agora s√£o suportados mais de 60 operadores para trabalhar com cole√ß√µes. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/hn/7j/v3/hn7jv3fv1qgfxlhqrd9g6dokkao.gif"></a> <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData</a> n√£o √© uma implementa√ß√£o alternativa de <code>ObservableCollection&lt;T&gt;</code> .  A arquitetura <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData √©</a> baseada principalmente nos conceitos de programa√ß√£o espec√≠fica de dom√≠nio.  A ideologia de uso √© baseada no fato de voc√™ gerenciar algumas fontes de dados, uma cole√ß√£o √† qual o c√≥digo respons√°vel pela sincroniza√ß√£o e altera√ß√£o de dados tem acesso.  Em seguida, voc√™ aplica v√°rios operadores √† origem, com os quais √© poss√≠vel transformar declarativamente os dados, sem a necessidade de criar e modificar manualmente outras cole√ß√µes.  De fato, com o <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData,</a> voc√™ separa as opera√ß√µes de leitura e grava√ß√£o e s√≥ pode ler de maneira reativa - portanto, as cole√ß√µes herdadas sempre ser√£o sincronizadas com a fonte. <br><br>  Em vez do <code>IObservable&lt;T&gt;</code> cl√°ssico <code>IObservable&lt;T&gt;</code> , DynamicData define opera√ß√µes em <code>IObservable&lt;IChangeSet&lt;T&gt;&gt;&gt;</code> e <code>IObservable&lt;IChangeSet&lt;TValue, TKey&gt;&gt;</code> , em que <code>IChangeSet</code> √© um bloco contendo informa√ß√µes sobre a altera√ß√£o da cole√ß√£o - o tipo de altera√ß√£o e os elementos afetados.  Essa abordagem pode melhorar significativamente o desempenho do c√≥digo para trabalhar com cole√ß√µes gravadas em um estilo reativo.  Ao mesmo tempo, <code>IObservable&lt;IChangeSet&lt;T&gt;&gt;</code> sempre pode ser transformado em um <code>IObservable&lt;IEnumerable&lt;T&gt;&gt;</code> regular, se for necess√°rio processar todos os elementos da cole√ß√£o de uma s√≥ vez.  Se parecer complicado - n√£o se assuste, a partir dos exemplos de c√≥digo tudo ficar√° claro e transparente! <br><br><h2>  Exemplo de DynamicData </h2><br>  Vejamos uma s√©rie de exemplos para entender melhor como o DynamicData funciona, como ele difere do <code>System.Reactive</code> e quais tarefas os desenvolvedores comuns de software de aplicativo com uma GUI podem resolver.  Vamos come√ßar com um exemplo abrangente <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">publicado por DynamicData no GitHub</a> .  No exemplo, a fonte de dados √© <code>SourceCache&lt;Trade, long&gt;</code> , que cont√©m uma cole√ß√£o de transa√ß√µes.  A tarefa √© mostrar apenas transa√ß√µes ativas, transformar modelos em objetos proxy, classificar a cole√ß√£o. <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//    System.Collections.ObjectModel, //       . ReadOnlyObservableCollection&lt;TradeProxy&gt; list; //   ,   . //   Add, Remove, Insert   . var source = new SourceCache&lt;Trade, long&gt;(trade =&gt; trade.Id); var cancellation = source //      . //   IObservable&lt;IChangeSet&lt;Trade, long&gt;&gt; .Connect() //       . .Filter(trade =&gt; trade.Status == TradeStatus.Live) //    -. //   IObservable&lt;IChangeSet&lt;TrandeProxy, long&gt;&gt; .Transform(trade =&gt; new TradeProxy(trade)) //    . .Sort(SortExpressionComparer&lt;TradeProxy&gt; .Descending(trade =&gt; trade.Timestamp)) //  GUI    . .ObserveOnDispatcher() //    - //    System.Collections.ObjectModel. .Bind(out list) // ,       //    . .DisposeMany() .Subscribe();</span></span></code> </pre><br>  No exemplo acima, quando voc√™ altera o <code>SourceCache</code> , que √© a fonte de dados, o <code>ReadOnlyObservableCollection</code> tamb√©m muda de acordo.  Nesse caso, ao excluir elementos da cole√ß√£o, o m√©todo <code>Dispose</code> ser√° chamado, a cole√ß√£o sempre ser√° atualizada apenas no fluxo da GUI e permanecer√° classificada e filtrada.  Legal, n√£o <code>Dispatcher.Invoke</code> e c√≥digo complicado! <br><br><h2>  Fontes de dados SourceList e SourceCache </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O DynamicData</a> fornece duas cole√ß√µes especializadas que podem ser usadas como uma fonte de dados mut√°vel.  Essas cole√ß√µes s√£o dos tipos <code>SourceList</code> e <code>SourceCache&lt;TObject, TKey&gt;</code> .  √â recomend√°vel usar o <code>SourceCache</code> sempre que o <code>TObject</code> tiver uma chave exclusiva; caso contr√°rio, use o <code>SourceList</code> .  Esses objetos fornecem a familiar API de desenvolvedores .NET para modificar dados - <code>Add</code> , <code>Remove</code> , <code>Insert</code> e similares.  Para converter fontes de dados em <code>IObservable&lt;IChangeSet&lt;T&gt;&gt;</code> ou <code>IObservable&lt;IChangeSet&lt;T, TKey&gt;&gt;</code> , use o operador <code>.Connect()</code> .  Por exemplo, se voc√™ tiver um servi√ßo que atualize a cole√ß√£o de elementos em segundo plano, poder√° sincronizar facilmente a lista desses elementos com a GUI, sem <code>Dispatcher.Invoke</code> Invoque excessos arquitet√¥nicos e: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">BackgroundService</span></span> : <span class="hljs-title"><span class="hljs-title">IBackgroundService</span></span> { <span class="hljs-comment"><span class="hljs-comment">//    . private readonly SourceList&lt;Trade&gt; _trades; //     . //  ,     , //    Publish()  Rx. public IObservable&lt;IChangeSet&lt;Trade&gt;&gt; Connect() =&gt; _trades.Connect(); public BackgroundService() { _trades = new SourceList&lt;Trade&gt;(); _trades.Add(new Trade()); //    ! //    . } }</span></span></code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O DynamicData</a> usa tipos .NET internos para mapear dados para o mundo externo.  Usando os poderosos operadores DynamicData, podemos transformar o <code>IObservable&lt;IChangeSet&lt;Trade&gt;&gt;</code> em <code>ReadOnlyObservableCollection</code> nosso modelo de exibi√ß√£o. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">TradesViewModel</span></span> : <span class="hljs-title"><span class="hljs-title">ReactiveObject</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">readonly</span></span> ReadOnlyObservableCollection&lt;TradeVm&gt; _trades; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> ReadOnlyObservableCollection&lt;TradeVm&gt; Trades =&gt; _trades; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">TradesViewModel</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IBackgroundService background</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   ,  ,  //     System.Collections.ObjectModel. background.Connect() .Transform(x =&gt; new TradeVm(x)) .ObserveOn(RxApp.MainThreadScheduler) .Bind(out _trades) .DisposeMany() .Subscribe(); } }</span></span></code> </pre><br>  Al√©m de <code>Transform</code> , <code>Filter</code> and <code>Sort</code> , o DynamicData inclui uma s√©rie de outros operadores, suporta opera√ß√µes l√≥gicas de agrupamento, suaviza uma cole√ß√£o, utiliza fun√ß√µes agregadas, excluindo elementos id√™nticos, contando elementos e at√© virtualizando no n√≠vel do modelo de representa√ß√£o.  Leia mais sobre todos os operadores no <a href="">projeto README no GitHub</a> . <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/jy/6-/4a/jy6-4azw__6rou9alucffpjhkrq.gif"></a> <br><br><h2>  Cole√ß√µes √∫nicas e rastreamento de altera√ß√µes </h2><br>  Al√©m de <code>SourceList</code> e <code>SourceCache</code> , a biblioteca DynamicData tamb√©m inclui uma implementa√ß√£o de thread √∫nico de uma cole√ß√£o mut√°vel - <code>ObservableCollectionExtended</code> .  Para sincronizar duas cole√ß√µes no seu modelo de exibi√ß√£o, declare uma como <code>ObservableCollectionExtended</code> e a outra como <code>ReadOnlyObservableCollection</code> e use o operador <code>ToObservableChangeSet</code> , que se comporta da mesma forma que o <code>Connect</code> mas foi projetado para funcionar com o <code>ObservableCollection</code> . <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//   . ReadOnlyObservableCollection&lt;TradeVm&gt; _derived; //    -. var source = new ObservableCollectionExtended&lt;Trade&gt;(); source.ToObservableChangeSet(trade =&gt; trade.Key) .Transform(trade =&gt; new TradeProxy(trade)) .Filter(proxy =&gt; proxy.IsChecked) .Bind(out _derived) .Subscribe();</span></span></code> </pre><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O DynamicData</a> tamb√©m oferece suporte ao rastreamento de altera√ß√µes nas classes que implementam a interface <code>INotifyPropertyChanged</code> .  Por exemplo, se voc√™ deseja ser notificado de uma altera√ß√£o na cole√ß√£o sempre que a propriedade de um item for alterada, use a <code>AutoRefresh</code> e passe o seletor da propriedade desejada com o argumento  <code>AutoRefesh</code> e outros operadores DynamicData permitir√£o que voc√™ valide f√°cil e naturalmente o grande n√∫mero de formul√°rios e subformul√°rios exibidos na tela! <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//  IObservable&lt;bool&gt; var isValid = databases .ToObservableChangeSet() //      IsValid. .AutoRefresh(database =&gt; database.IsValid) //       . .ToCollection() // ,    . .Select(x =&gt; x.All(y =&gt; y.IsValid)); //   ReactiveUI, IObservable&lt;bool&gt; //     ObservableAsProperty. _isValid = isValid .ObserveOn(RxApp.MainThreadScheduler) .ToProperty(this, x =&gt; x.IsValid);</span></span></code> </pre><br>  Com base na funcionalidade DynamicData, voc√™ pode criar rapidamente interfaces bastante complexas - isso √© especialmente verdadeiro para sistemas que exibem uma grande quantidade de dados em tempo real, sistemas de mensagens instant√¢neas e sistemas de monitoramento. <br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><img src="https://habrastorage.org/webt/98/nh/ws/98nhws7gl4yzk8kgcovbpvvozoi.gif"></a> <br><br><h2>  Conclus√£o </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">As extens√µes reativas</a> s√£o uma ferramenta poderosa que permite trabalhar declarativamente com dados e a interface do usu√°rio, escrever c√≥digos port√°teis e compat√≠veis e resolver problemas complexos de uma maneira simples e elegante.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">O ReactiveUI</a> permite que os desenvolvedores .NET integrem estreitamente extens√µes reativas em seus projetos usando a arquitetura MVVM, fornecendo implementa√ß√µes reativas de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>INotifyPropertyChanged</code></a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><code>ICommand</code></a> , enquanto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData</a> cuida da sincroniza√ß√£o de cole√ß√µes implementando <code>INotifyCollectionChanged</code> , expandindo os recursos de extens√µes reativas e cuidando do desempenho. <br><br>  As <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">bibliotecas</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">ReactiveUI</a> e <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData s√£o</a> compat√≠veis com as estruturas de GUI mais populares da plataforma .NET, incluindo o Windows Presentation Foundation, Universal Windows Platform, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Avalonia</a> , Xamarin.Android, Xamarin Forms, Xamarin.iOS.  Voc√™ pode come√ßar a aprender DynamicData na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">p√°gina de documenta√ß√£o correspondente do ReactiveUI</a> .  Verifique tamb√©m o projeto <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">DynamicData Snippets</a> , que cont√©m exemplos de uso do DynamicData para todas as ocasi√µes. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt445098/">https://habr.com/ru/post/pt445098/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt445086/index.html">Miss√£o lunar "Bereshit" - o primeiro v√≠deo da c√¢mera de bordo e novas fotos no espa√ßo sideral</a></li>
<li><a href="../pt445088/index.html">As aventuras em sua vida foram mais interessantes do que nos jogos de computador?</a></li>
<li><a href="../pt445090/index.html">O YouTube permanecer√° como o conhecemos?</a></li>
<li><a href="../pt445092/index.html">HATEOAS Deep Link Problem</a></li>
<li><a href="../pt445094/index.html">Acesso centralizado a assinaturas digitais e outras chaves de prote√ß√£o eletr√¥nica usando hardware USB sobre IP</a></li>
<li><a href="../pt445100/index.html">Anycubic: Photon S, 4Max Pro e grande renomea√ß√£o</a></li>
<li><a href="../pt445102/index.html">Anima√ß√£o em Flash no Unity3D do zero. Parte um, l√≠rica</a></li>
<li><a href="../pt445104/index.html">Uma breve hist√≥ria da marca de √°udio Klipsch</a></li>
<li><a href="../pt445106/index.html">Mesa-redonda: Tecnologia aditiva como alternativa √† fabrica√ß√£o tradicional</a></li>
<li><a href="../pt445108/index.html">Nem um Falcon - projetos ESA e ULA reutiliz√°veis ‚Äã‚Äãfundamentalmente diferentes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>