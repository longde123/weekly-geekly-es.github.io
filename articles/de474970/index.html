<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍❤️‍💋‍👩 🧑🏻 👍🏻 Wie schreibe ich einen Smart Contract mit Python on Ontology? Teil 5: Native API 🍝 🤜🏿 🔣</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In den vorherigen Python-Tutorialbeiträgen habe ich den Ontology Smart Contract in eingeführt 
 Teil 1: Blockchain & Block API und 
 Teil 2: Speicher-...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie schreibe ich einen Smart Contract mit Python on Ontology? Teil 5: Native API</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474970/"><img src="https://habrastorage.org/getpro/habr/post_images/a4a/df3/d06/a4adf3d06081f8a1b01c79140d5474f9.png" alt="Bild"><br><br>  In den vorherigen Python-Tutorialbeiträgen habe ich den Ontology Smart Contract in eingeführt <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 1: Blockchain &amp; Block API</a> und <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 2: Speicher-API</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 3: Laufzeit-API</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Teil 4: Native API</a> und Beschreibung der Verwendung intelligenter Verträge für den ONT / ONG-Transfer. <br><br>  Heute werden wir über die Verwendung der <b>Upgrade-API</b> zum Upgrade von Smart Contract sprechen.  Es gibt 2 APIs: <b>Destroy</b> und <b>Migrate</b> . <br><a name="habracut"></a><br>  Sie werden wie folgt verwendet: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/692/e4a/eca/692e4aeca613e998625704e765b92e83.png" alt="Bild"><br><br>  Gehen wir nun näher auf die Verwendung dieser beiden APIs ein.  Zuvor können Sie im Ontology Smart Contract Development Tool <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SmartX</a> einen neuen Vertrag <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">erstellen</a> und die folgenden Anweisungen befolgen.  Wie üblich werde ich am Ende des Artikels den Link zum Quellcode anhängen. <br><br><h2>  Verwendung der Upgrade-API </h2><br>  Wie gewohnt müssen Sie die 2 Funktionen wie folgt importieren, bevor Sie sie verwenden können. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.interop.Ontology.Contract <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Migrate <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.interop.System.Contract <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Destroy</code> </pre> <br><h3>  API zerstören </h3><br>  Die Destroy-API wird zum Löschen und Löschen eines Smart-Vertrags in der Kette verwendet.  Unten finden Sie ein Codebeispiel der API. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.interop.System.Contract <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Destroy <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.interop.System.Runtime <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Notify <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(operation, args)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> operation == <span class="hljs-string"><span class="hljs-string">"destroy_contract"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> destroy_contract() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">destroy_contract</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> Destroy() Notify([<span class="hljs-string"><span class="hljs-string">"The contract has been destoryed"</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br><h3>  API migrieren </h3><br>  Die Migrate-API wird zum Migrieren intelligenter Verträge verwendet.  Der bestehende Vertrag wird durch den neu migrierten Vertrag ersetzt.  Die durch den alten Vertrag gespeicherten Daten werden ebenfalls in den neuen Vertrag migriert.  Der alte Vertrag wird nach der Migration gelöscht. <br><blockquote>  Bitte beachten Sie, dass die Assets im Smart-Vertrag nicht automatisch migriert werden, sodass Sie sie im Voraus übertragen müssen.  Andernfalls können Sie Ihre Vermögenswerte nicht abrufen. </blockquote><br>  Die Parameterliste der Migrate-Funktion lautet wie folgt: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/91f/821/2b8/91f8212b879e93f4dc2eaa01f95fe985.png" alt="Bild"><br><br>  Siehe unten das Codebeispiel der Migrate-Funktion: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.interop.Ontology.Contract <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Migrate <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.interop.System.Runtime <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Notify <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> ontology.libont <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> AddressFromVmCode <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(operation, args)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> operation == <span class="hljs-string"><span class="hljs-string">"migrate_contract"</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(args) != <span class="hljs-number"><span class="hljs-number">7</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> avm_code = args[<span class="hljs-number"><span class="hljs-number">0</span></span>] need_storage = args[<span class="hljs-number"><span class="hljs-number">1</span></span>] name = args[<span class="hljs-number"><span class="hljs-number">2</span></span>] version = args[<span class="hljs-number"><span class="hljs-number">3</span></span>] author = args[<span class="hljs-number"><span class="hljs-number">4</span></span>] email = args[<span class="hljs-number"><span class="hljs-number">5</span></span>] description = args[<span class="hljs-number"><span class="hljs-number">6</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> migrate_contract(avm_code, need_storage, name, version, author, email, description) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">migrate_contract</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(avm_code, need_storage, name, version, author, email, description)</span></span></span><span class="hljs-function">:</span></span> res = Migrate(avm_code, need_storage, name, version, author, email, description) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> res: Notify([<span class="hljs-string"><span class="hljs-string">"Migrate successfully"</span></span>]) new_contract_hash=AddressFromVmCode(avm_code) Notify(new_contract_hash) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">False</span></span></code> </pre> <br>  <u>Sie können die folgenden Schritte ausführen, um das Ausführungsergebnis des Codebeispiels unter SmartX anzuzeigen:</u> <br><br>  <b>1.</b> Kopieren Sie den obigen Code, fügen Sie ihn in SmartX ein und kompilieren Sie ihn, bevor Sie die Parameter eingeben.  Achten Sie bei der Eingabe von Parametern besonders auf zwei Punkte: <br><br><ul><li>  Stellen Sie sicher, dass avm_code in der Kette nicht vorhanden ist. Andernfalls wird ein Fehler zurückgegeben. </li><li>  Für die Migration ist ein hohes Gaslimit erforderlich, daher müssen Sie das Gaslimit anpassen, wenn Sie die Funktion ausführen. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/9d6/3a8/5d8/9d63a85d82d31e63da2085c5b46ee041.png" alt="Bild"><br><br>  <b>2.</b> Nach der Bereitstellung können Sie den neuen Vertrags-Hash über das Dashboard abrufen.  In diesem Beispiel lautet der neue Vertragshash be4606c4663081b70f745ed9fc64d4c3b0d9c183. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/03d/2f4/b4f/03d2f4b4fb3eebae4d6165bec3cd7239.png" alt="Bild"><br><br><h2>  Zusammenfassung </h2><br>  In diesem Artikel haben wir die Upgrade-API der Ontology-Blockchain vorgestellt.  Entwickler können diese API verwenden, um intelligente Verträge zu aktualisieren.  Die Destroy-API wird zum Löschen intelligenter Verträge in der Kette und die Migrate-API zum Migrieren intelligenter Verträge verwendet.  Im nächsten Artikel werden wir die statische und dynamische API vorstellen, um zu untersuchen, wie der statische und dynamische Aufruf von Ontology-Smart-Verträgen mit Python implementiert wird. <br><br>  Das Tutorial zu GitHub finden Sie <a href="">hier</a> . <br><br>  Sind Sie Entwickler?  Stellen Sie sicher, dass Sie unserer Tech-Community auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Discord</a> beigetreten sind.  Schauen Sie sich auch das <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Developer Center</a> auf unserer Website an. Dort finden Sie Entwicklertools, Dokumentation und mehr. <br><br><hr><br><h4>  Finden Sie Ontologie woanders </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Ontologie-Website</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Github</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Zwietracht</a> <br>  Telegramm <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Englisch</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Russisch</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Twitter</a> / <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reddit</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de474970/">https://habr.com/ru/post/de474970/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de474960/index.html">Entwicklungsdemo für NES - HEOHdemo</a></li>
<li><a href="../de474962/index.html">Plattformentwickler Conf von Miro: Live-Stream</a></li>
<li><a href="../de474964/index.html">Mock-Synchronisation mit realen Implementierungen</a></li>
<li><a href="../de474966/index.html">So erstellen Sie einen Smart Python-Vertrag im Ontology-Netzwerk. Teil 1: Blockchain & Block API</a></li>
<li><a href="../de474968/index.html">RxDart für die kleinsten ... Projekte</a></li>
<li><a href="../de474976/index.html">Bootsstadt: Wie Venedig ohne Autos existiert</a></li>
<li><a href="../de474978/index.html">IBM Watson Visual Recognition: Objekterkennung jetzt in IBM Cloud verfügbar</a></li>
<li><a href="../de474982/index.html">JavaFX Tutorial: FXML und SceneBuilder</a></li>
<li><a href="../de474984/index.html">RabbitMQ vs. Kafka: Failover und Hochverfügbarkeit</a></li>
<li><a href="../de474988/index.html">Willkommen bei Mitap: Karriere bei Data Science für Einsteiger</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>