<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>💲 🙏🏾 👩‍🎤 质量保证自动化生命中的一天 🤷🏾 ⚓️ 🚫</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="我如何变得有点儿qa自动化：通过开发人员的眼光，我的感觉，幸存下来以及自动测试的出色架构和基础架构。 
 引言 


 正如他们所说，我不是妇科医生，我只是路过而决定看一下。 因此，对于初学者，我会说一下写作的原因。 在我看来，专家可以更快地解决该问题，并且在途中不会收集到太多耙子。 但是他不会像我...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>质量保证自动化生命中的一天</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451558/"><p> 我如何变得有点儿qa自动化：通过开发人员的眼光，我的感觉，幸存下来以及自动测试的出色架构和基础架构。 </p><a name="habracut"></a><br><h2 id="vvedenie"> 引言 </h2><br><p> 正如他们所说，我不是妇科医生，我只是路过而决定看一下。 因此，对于初学者，我会说一下写作的原因。 在我看来，专家可以更快地解决该问题，并且在途中不会收集到太多耙子。 但是他不会像我那样感兴趣，您将一无所有。 </p><br><p> 导致我写书的另一个原因是：很长一段时间以来，我都不了解自动测试基础结构的特殊之处。 此外，许多PM或更高级别的经理还不完全理解那里的宇宙是什么，以及为什么开发人员自己为一两个进行单元测试，而对于phycestests，则采取了个人的方式，他们编写测试的速度较慢，不断修复某些东西，只要样本足够大，通过所有财务指标的机会就严格小于100％。 </p><br><h2 id="problema"> 问题所在 </h2><br><p>第三天，铁路项目的发行规格下降。 一周前的某个地方，我们唯一的自动化工程师决定去芝加哥工作，但我们尚未找到新的专家。 因此，我不得不袖手旁观，假装自己是质量检查人员。 关于它的情况，并尝试告诉。 </p><br><p> 这个问题看起来很无害。 但是，对于初学者来说，需要一些环境背景和描述。 我们的平台中有许多地址选择器。 老实说，这是平台的主要实体之一。 选择器转到Google API获取数据。 在自动测试中，所有请求都将暂停以节省成本并加快测试速度。 另外，还添加了一些逻辑以提供几乎与所请求的地址线相同的地址线，而无需使用外部服务。 </p><br><p> 坏了：我们在地址栏中输入所需的地址，出现一个带有多个选项的下拉框，我们选择所需的地址，然后...将相邻元素的值插入到输入中。 总是 </p><br><h2 id="dolgiy-put-k-istine"> 通往真相的路很长 </h2><br><h3 id="pervye-gipotezy-i-naivnyy-podhod"> 最初的假设和幼稚的方法 </h3><br><p>事不宜迟，我接受了最近的跌落测试，找到了选择地址的那一行，并开始仔细检查它和邻居。 该行看起来是无害的： <code>new_order_page.destination_address.select(baker_street)</code> 。 但是我们知道，在漂亮的代码后面总会有一堆奇怪的小设计和令人讨厌的内脏。 </p><br><p> 我很快回想起，所有这些经济因素都可以在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">SitePrism</a>上<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">运行</a> 。 这个东西可以将页面和页面上的元素分别包装在class和class方法中。 对于点击和其他操作， <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Capybara</a>和<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RSpec</a>负责。 但是毫无疑问，它们像整个民用舰队一样可靠。 如果是这样的话，第一个假设立即表明了这一点：要么有人为棱镜编写的选择器写得不好，要么有人扭曲了前面的布局。 </p><br><p> 假设的第一部分很快消失了，选择器被完美地编写了。 在那里没有找到可以选择第三个<code>li</code> <code>xpath</code> ，并且代码本身去年没有变化。 </p><br><p> 但是，在<code>select</code>方法的区域中，堆积了带有regexps的逻辑以从下拉列表中选择所需的选项。 当然，我对正则表达式很生气，然后去检查它们。 我花了半个小时，我知道一切正常。 正是选择了所需的行。  <code>click</code>就可以了。 一切都应该工作。 也就是说，布局假设的第二部分也消失了。 但是这种想法出现在<code>js</code>曲线上。 毕竟，我们页面上的元素是自定义的， <code>js</code>依序排列在该元素周围，此外，在此<code>js</code>最近一直在对其进行修改。 </p><br><h3 id="vo-vsyom-vinovat-js">  js是罪魁祸首 </h3><br><p> 这是所有晦涩问题的标准原因。 诸如“去<code>js</code> ，因为他已经被震惊了”之类的东西。 而且，就我而言，似乎也离不开<code>js</code> 。 通常，我会三思而后行，奔向前端团队，将手指指向下降测试，并说“一切都对我们有利，请对您有利。” </p><br><p> 但是，来自花花公子的家伙们不容错过，他们在那儿闲逛了几个小时，发现了几个与叙述无关的错误，并说不要怪<code>js</code> ！ 同时，他们抛出了一个有趣的信息，一个选择的请求是不够的，他提出了另一个选择，答案与输入的错误内容完全匹配。 </p><br><p> 我没想到会这样。 我们必须回过头来弄清楚模拟请求如何为我们工作。 </p><br><h3 id="obstoyatelnyy-podhod"> 综合方法 </h3><br><p> 因此，没有其他地方可以等待帮助，莫斯科就在我们身后。 </p><br><p> 首先，我们看一下Moka向Google请求的方式。 更准确地说，首先我们寻找发生这种情况的地方。 这不是一件简单的任务。 事实证明，我们有一个完整的模块<code>MockServices::Base</code> ，它负责使用<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">VCR</a>模拟不同的请求。 他狡猾地跪在基本控制器上，仅由于负责外部请求的服务名称而找不到他。 </p><br><p> 好的，找到了moki。 现在我们来看一下它们的实现。 第一个请求很简单：从<code>params</code>中获取信息，并将其替换为答案的模板。 以防万一，我检查了<code>params</code>的内容，并且按预期的方式进行了准备。 </p><br><p> 下一个请求的moka方法更有趣。 某种<code>mock_data</code>出现在此处。 这些不是<code>params</code> ，我们需要弄清楚这个日期是哪里来的。 深入<code>x_mock_data</code>五次后，发现该数据是使用键<code>x_mock_data</code>从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RequestStore中</a> <code>x_mock_data</code> 。 已经更有趣了。 </p><br><p> 我们返回到原始测试，并注意到有一个<code>set_mock_header</code>东西，在仔细检查后，会将一些数据添加到同一<code>RequestStore</code> 。 更有趣！ </p><br><p> 此时此刻，某个地方的大脑出现了认知失调：一方面，这可能是问题的原因，附带要求给我们的全局变量中断了。 但是有一个细微差别：财务规格服务器和财务规格本身是两个独立的流程（实际上，服务器至少是3个流程），因此，借方借方不能以任何方式收敛，因为流程之间的全局变量尚未带入这个世界。 而对于多线程的Web服务器来说，这将是一场激烈的比赛，实际上将无法正常工作。 意味着我掏空了一些东西，有必要进行搜索。 </p><br><p> 我们进一步查找并找到标头放到的特定<code>bm</code> 。 继续了解<code>bm</code>是<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">BrowserMob</a> 。 然后我有点费劲了，因为它是在Ruby封装中的Java代理。 只是灌木丛中的钢琴。 </p><br><p> 我们开始进行进一步的选择，并且了解到，对于具有<code>rspec</code>的客户端和具有应用程序的服务器（例如<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">puma</a> ）之间的“全局”变量，将使用请求中的<code>X-Mock-Data</code>标头。 问题在于应用程序对这些读者一无所知。 为此，您需要一个代理，所有请求都将通过该代理运行，并负责设置标头。 狡猾的你什么也不会说。 </p><br><p> 我们去测试，发现只是这个东西不起作用。 标头无处可见：无论是在请求中还是在响应中。 但是RequestStore在<code>rspec</code>端填充，在Web服务器端为空。 这肯定意味着-它在代理中。 </p><br><p> 然后，在两者之间，事实证明，我们不仅测试了<code>set_mock_header</code>地址，而且还测试了使用以上<code>set_mock_header</code> 。 </p><br><p> 太好了 有待了解如何解决此问题。 </p><br><h3 id="razbiraemsya-s-proksikom"> 我们与代理打交道 </h3><br><p> 我们忽略了启动<code>jar</code>文件的区域中的挖掘点，然后通过Ruby对其进行控制。 最好注意指定浏览器代理的方式。 我们使用Chrome，并在启动时在命令行的众多参数之一中传递代理信息。 代理功能是我们使用从模板生成的<code>pac</code>文件，以防止来自Web套接字的流量通过代理。 </p><br><p> 在这里的某个地方，人们渴望去使用代理配置在chrome上搜索谷歌。 事实证明，您不必走得太远，在72+版本中，这些家伙“完成”了他的工作。 在这种情况下，他们甚至<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">带来了一个单独的错误</a> 。 我最喜欢的评论： </p><br><blockquote>  “您能停止删除功能吗？” </blockquote><p> 令人遗憾的是，它被认为是一种功能，将来，它们在“保密性”方面承诺会提供更多锡。 </p><br><p> 简而言之，Chrome不再在<code>proxy-pac-url</code>参数中支持<code>file:</code>协议。 这些解决方案比另一种更好： </p><br><ul><li> 传入参数<code>js</code> ，该参数将读取<code>pac</code>文件并将其转换为base64：-- <code>--proxy-pac-url='data:application/x-javascript-config;base64,'$(base64 -w0 /path/to/pac/script)</code> ； </li><li> 用python提升您的Web服务器，以便根据更“正确”的协议分发一个文件，这在<code>pac</code> proxy的参数中受支持； </li><li> 关闭<code>NetworkService</code> ，然后关闭<code>file:</code>协议，但他们保证将来也会对其进行“修复”。 </li></ul><br><p> 前两个选项肯定没有启发我，而第三个选项很奇怪地帮助了我。 </p><br><h2 id="nedolgaya-radost"> 短暂的喜悦 </h2><br><p> 很高兴在空闲的下拉列表和更新的chrome之间发现了一个棘手的连接，我很不高兴很久了。 事实证明，我们的CI不仅更新了chrome，还更新了所有相邻的软件包，现在由于未知错误<code>Selenium::WebDriver::Error::NoSuchDriverError</code> ，我们有更多的测试<code>Selenium::WebDriver::Error::NoSuchDriverError</code>了，奇怪的是，它与<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">chromedriver</a>不相关，但是相关带有chrome配置，库版本和并行规范执行。 </p><br><p> 但这是下一个工作日的任务... </p><br><p> 展望未来： <code>disable-dev-shm-usage</code>参数在这里有所帮助。 </p><br><h2 id="vyvody"> 结论 </h2><br><p> 不要责骂自动化。 他似乎受与他无关的外部环境的影响最大。 </p><br><p> 最好让自动化工程师和开发人员成为朋友，以便他们组织自己的基础架构 <del> 有礼貌和礼貌 </del> 具有固定版本和受控的测试环境。 对我而言，这比遭受专有的CI更好，后者拥有各自非常复杂的拐杖和水下凳子，只有在将应用程序和测试与其他人的环境紧密集成后，您才能了解这些知识。 </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN451558/">https://habr.com/ru/post/zh-CN451558/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN451538/index.html">Amazon Redshift并行扩展指南和测试结果</a></li>
<li><a href="../zh-CN451540/index.html">有多少开发人员需要创建像Airbnb这样的服务</a></li>
<li><a href="../zh-CN451542/index.html">我们如何以及为什么在Mail.ru Cloud中进行地标识别</a></li>
<li><a href="../zh-CN451552/index.html">我们建立了小工具DO-RA的网络销售渠道</a></li>
<li><a href="../zh-CN451556/index.html">Flutter：使用Android Studio进行应用程序本地化</a></li>
<li><a href="../zh-CN451560/index.html">尊敬的客户，这就是为什么这项更改花了这么长时间的原因。</a></li>
<li><a href="../zh-CN451562/index.html">如何逃离一个教派？</a></li>
<li><a href="../zh-CN451566/index.html">Operation TaskMaster：我们如何揭露俄罗斯和独联体的网络集团攻击组织</a></li>
<li><a href="../zh-CN451570/index.html">前往法国工作：薪金，签证和简历</a></li>
<li><a href="../zh-CN451572/index.html">Web开发技术趋势2019</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>