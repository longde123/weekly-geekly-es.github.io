<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¨ğŸ¾â€ğŸ“ ğŸ‘©ğŸ½â€ğŸ“ ğŸ§™ğŸ¿ Golang WebæœåŠ¡å™¨å¼€å‘-ä»ç®€å•åˆ°å¤æ‚ ğŸ§– âŒšï¸ ğŸ¤·ğŸ¿</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="äº”å¹´å‰ï¼Œæˆ‘å¼€å§‹å¼€å‘Gophish ï¼Œè¿™ä½¿å¾—å­¦ä¹ Golangæˆä¸ºå¯èƒ½ã€‚ æˆ‘æ„è¯†åˆ°Goæ˜¯ä¸€ç§å¼ºå¤§çš„è¯­è¨€ï¼Œè®¸å¤šåº“éƒ½å¯¹Goçš„åŠŸèƒ½è¿›è¡Œäº†è¡¥å……ã€‚ Goæ˜¯é€šç”¨çš„ï¼šç‰¹åˆ«æ˜¯åœ¨å®ƒçš„å¸®åŠ©ä¸‹ï¼Œå¯ä»¥æ¯«æ— é—®é¢˜åœ°å¼€å‘æœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚ 

 æœ¬æ–‡æ˜¯å…³äºåœ¨Goä¸­ç¼–å†™æœåŠ¡å™¨ã€‚ è®©æˆ‘ä»¬ä»ç®€å•çš„äº‹ç‰©å¼€å§‹ï¼Œä¾‹å¦‚â€œ Hello worldï¼â€...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Golang WebæœåŠ¡å™¨å¼€å‘-ä»ç®€å•åˆ°å¤æ‚</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/skillbox/blog/446454/"><img src="https://habrastorage.org/getpro/habr/post_images/da7/244/1d8/da72441d8fc6c0c8b5a7e735b4d0b506.png"><br><br> äº”å¹´å‰ï¼Œæˆ‘å¼€å§‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¼€å‘Gophish</a> ï¼Œè¿™ä½¿å¾—å­¦ä¹ Golangæˆä¸ºå¯èƒ½ã€‚ æˆ‘æ„è¯†åˆ°Goæ˜¯ä¸€ç§å¼ºå¤§çš„è¯­è¨€ï¼Œè®¸å¤šåº“éƒ½å¯¹Goçš„åŠŸèƒ½è¿›è¡Œäº†è¡¥å……ã€‚  Goæ˜¯é€šç”¨çš„ï¼šç‰¹åˆ«æ˜¯åœ¨å®ƒçš„å¸®åŠ©ä¸‹ï¼Œå¯ä»¥æ¯«æ— é—®é¢˜åœ°å¼€å‘æœåŠ¡å™¨åº”ç”¨ç¨‹åºã€‚ <br><br> æœ¬æ–‡æ˜¯å…³äºåœ¨Goä¸­ç¼–å†™æœåŠ¡å™¨ã€‚ è®©æˆ‘ä»¬ä»ç®€å•çš„äº‹ç‰©å¼€å§‹ï¼Œä¾‹å¦‚â€œ Hello worldï¼â€ï¼Œç„¶åä»¥å…·æœ‰ä»¥ä¸‹åŠŸèƒ½çš„åº”ç”¨ç¨‹åºç»“æŸï¼š <br><br>  -ä½¿ç”¨â€œè®©æˆ‘ä»¬åŠ å¯†HTTPSâ€ã€‚ <br>  -ç”¨ä½œAPIè·¯ç”±å™¨ã€‚ <br>  -ä½¿ç”¨ä¸­é—´ä»¶ã€‚ <br>  -å¤„ç†é™æ€æ–‡ä»¶ã€‚ <br>  -æ­£ç¡®å…³æœºã€‚ <br><a name="habracut"></a><br><blockquote>  <b>Skillboxå»ºè®®ï¼š</b> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Pythonå¼€å‘äººå‘˜ä»å¤´å¼€å§‹</a> <b>å®è·µ</b>è¯¾ç¨‹ã€‚ <br><br>  <b>æˆ‘ä»¬æé†’æ‚¨ï¼š</b> <i>å¯¹äºæ‰€æœ‰â€œ Habrâ€è¯»è€…æ¥è¯´ï¼Œä½¿ç”¨â€œ Habrâ€ä¿ƒé”€ä»£ç æ³¨å†Œä»»ä½•Skillboxè¯¾ç¨‹æ—¶å‡å¯äº«å—10,000å¢å¸ƒçš„æŠ˜æ‰£ã€‚</i> <br></blockquote><h3> ä¸–ç•Œï¼Œæ‚¨å¥½ï¼ </h3><br> åœ¨Goä¸Šåˆ›å»ºWebæœåŠ¡å™¨éå¸¸å¿«ã€‚ è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨è¿”å›ä¸Šé¢çš„â€œ Helloï¼Œworldï¼â€çš„å¤„ç†ç¨‹åºçš„ç¤ºä¾‹ã€‚ <br><br><pre><code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> main <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ( <span class="hljs-string"><span class="hljs-string">"fmt"</span></span> <span class="hljs-string"><span class="hljs-string">"net/http"</span></span> ) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { http.HandleFunc(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { fmt.Fprintf(w, <span class="hljs-string"><span class="hljs-string">"Hello World!"</span></span>) }) http.ListenAndServe(<span class="hljs-string"><span class="hljs-string">":80"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) }</code> </pre> <br> ä¹‹åï¼Œå¦‚æœå¯åŠ¨åº”ç”¨ç¨‹åºå¹¶æ‰“å¼€<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">localhost</a>é¡µé¢ï¼Œæ‚¨å°†ç«‹å³çœ‹åˆ°æ–‡æœ¬â€œ Helloï¼Œworldï¼â€ã€‚  ï¼ˆå½“ç„¶ï¼Œå¦‚æœä¸€åˆ‡æ­£å¸¸ï¼‰ã€‚ <br><br> æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†é‡å¤ä½¿ç”¨è¯¥å¤„ç†ç¨‹åºï¼Œä½†é¦–å…ˆï¼Œè®©æˆ‘ä»¬äº†è§£ä¸€åˆ‡çš„å·¥ä½œåŸç†ã€‚ <br><br><h4> ç½‘ç»œ/ HTTP </h4><br> è¯¥ç¤ºä¾‹ä½¿ç”¨äº†<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://golang.org/pkg/net/"><code>net/http</code></a>åŒ…ï¼Œè¿™æ˜¯Goä¸­ç”¨äºå¼€å‘æœåŠ¡å™¨å’ŒHTTPå®¢æˆ·ç«¯çš„ä¸»è¦å·¥å…·ã€‚ ä¸ºäº†ç†è§£ä»£ç ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‰ä¸ªé‡è¦å…ƒç´ çš„å«ä¹‰ï¼šhttp.Handlerï¼Œhttp.ServeMuxå’Œhttp.Serverã€‚ <br><br><h4>  HTTPå¤„ç†ç¨‹åº </h4><br> å½“æˆ‘ä»¬æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œå¤„ç†ç¨‹åºå°†å¯¹å…¶è¿›è¡Œåˆ†æå¹¶å½¢æˆå“åº”ã€‚  Goå¤„ç†ç¨‹åºçš„å®ç°å¦‚ä¸‹ï¼š <br><br><pre> <code class="go hljs"><span class="hljs-keyword"><span class="hljs-keyword">type</span></span> Handler <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> { ServeHTTP(ResponseWriter, *Request) }</code> </pre> <br> ç¬¬ä¸€ä¸ªç¤ºä¾‹ä½¿ç”¨http.HandleFuncå¸®åŠ©å‡½æ•°ã€‚ å®ƒåŒ…è£…äº†å¦ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°åˆåœ¨ServeHTTPä¸­æ¥å—http.ResponseWriterå’Œhttp.Requestã€‚ <br><br> æ¢å¥è¯è¯´ï¼ŒGolangå¤„ç†ç¨‹åºç”±å•ä¸ªæ¥å£è¡¨ç¤ºï¼Œè¿™ä¸ºç¨‹åºå‘˜æä¾›äº†å¾ˆå¤šæœºä¼šã€‚ å› æ­¤ï¼Œä¾‹å¦‚ï¼Œä¸­é—´ä»¶æ˜¯ä½¿ç”¨å¤„ç†ç¨‹åºå®ç°çš„ï¼Œå…¶ä¸­ServeHTTPé¦–å…ˆæ‰§è¡ŒæŸé¡¹æ“ä½œï¼Œç„¶åè°ƒç”¨å¦ä¸€ä¸ªå¤„ç†ç¨‹åºçš„ServeHTTPæ–¹æ³•ã€‚ <br><br> å¦‚ä¸Šæ‰€è¿°ï¼Œå¤„ç†ç¨‹åºä»…ç”Ÿæˆå¯¹è¯·æ±‚çš„å“åº”ã€‚ ä½†æ˜¯ï¼Œåº”è¯¥åœ¨ç‰¹å®šæ—¶é—´ä½¿ç”¨å“ªä¸ªç‰¹å®šå¤„ç†ç¨‹åºï¼Ÿ <br><br><h4> è¯·æ±‚è·¯ç”± </h4><br> ä¸ºäº†åšå‡ºæ­£ç¡®çš„é€‰æ‹©ï¼Œè¯·ä½¿ç”¨HTTPå¤šè·¯å¤ç”¨å™¨ã€‚ åœ¨è®¸å¤šåº“ä¸­ï¼Œå®ƒè¢«ç§°ä¸ºå¤šè·¯å¤ç”¨å™¨æˆ–è·¯ç”±å™¨ï¼Œä½†å®ƒä»¬éƒ½æ˜¯ä¸€æ ·çš„ã€‚ å¤šè·¯å¤ç”¨å™¨åŠŸèƒ½æ˜¯åˆ†æè¯·æ±‚è·¯å¾„å¹¶é€‰æ‹©é€‚å½“çš„å¤„ç†ç¨‹åºã€‚ <br><br> å¦‚æœæ‚¨éœ€è¦å¯¹å¤æ‚è·¯ç”±çš„æ”¯æŒï¼Œé‚£ä¹ˆæœ€å¥½ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“ã€‚ æœ€å…ˆè¿›çš„è½¯ä»¶ä¹‹ä¸€æ˜¯<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¤§çŒ©çŒ©/æ··åˆ</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">go-chi / chi</a> ï¼Œè¿™äº›åº“å¯ä»¥å®ç°ä¸­é—´å¤„ç†è€Œä¸ä¼šå‡ºç°ä»»ä½•é—®é¢˜ã€‚ åœ¨ä»–ä»¬çš„å¸®åŠ©ä¸‹ï¼Œæ‚¨å¯ä»¥é…ç½®é€šé…ç¬¦è·¯ç”±å¹¶æ‰§è¡Œè®¸å¤šå…¶ä»–ä»»åŠ¡ã€‚ å®ƒä»¬çš„ä¼˜ç‚¹æ˜¯ä¸æ ‡å‡†HTTPå¤„ç†ç¨‹åºå…¼å®¹ã€‚ å› æ­¤ï¼Œæ‚¨å¯ä»¥ç¼–å†™ç®€å•çš„ä»£ç ï¼Œå°†æ¥æœ‰å¯èƒ½å¯¹å…¶è¿›è¡Œä¿®æ”¹ã€‚ <br><br> åœ¨æ­£å¸¸æƒ…å†µä¸‹ä½¿ç”¨å¤æ‚çš„æ¡†æ¶å°†ä¸éœ€è¦éå¸¸æ ‡å‡†çš„è§£å†³æ–¹æ¡ˆï¼Œè¿™å¤§å¤§å¢åŠ äº†é»˜è®¤å¤„ç†ç¨‹åºçš„ä½¿ç”¨ã€‚ è¦åˆ›å»ºç»å¤§å¤šæ•°åº”ç”¨ç¨‹åºï¼Œåªéœ€å°†é»˜è®¤åº“å’Œä¸€ä¸ªç®€å•çš„è·¯ç”±å™¨ç»„åˆå³å¯ã€‚ <br><br><h4> è¦æ±‚å¤„ç† </h4><br> æ­¤å¤–ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªç»„ä»¶æ¥â€œç›‘å¬â€ä¼ å…¥çš„è¿æ¥å¹¶å°†æ‰€æœ‰è¯·æ±‚é‡å®šå‘åˆ°æ­£ç¡®çš„å¤„ç†ç¨‹åºã€‚ æ­¤ä»»åŠ¡å¯ä»¥é€šè¿‡http.Serverè½»æ¾å®Œæˆã€‚ <br><br> ä¸‹é¢æ˜¾ç¤ºäº†æœåŠ¡å™¨è´Ÿè´£ä¸è¿æ¥å¤„ç†æœ‰å…³çš„æ‰€æœ‰ä»»åŠ¡ã€‚ ä¾‹å¦‚ï¼Œè¿™é€‚ç”¨äºTLSåè®®ã€‚ ä¸ºäº†å®ç°http.ListenAndServerè°ƒç”¨ï¼Œä½¿ç”¨äº†æ ‡å‡†çš„HTTPæœåŠ¡å™¨ã€‚ <br><br> ç°åœ¨è®©æˆ‘ä»¬çœ‹ä¸€äº›æ›´å¤æ‚çš„ä¾‹å­ã€‚ <br><br><h3> æ·»åŠ è®©æˆ‘ä»¬åŠ å¯† </h3><br> é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºé€šè¿‡HTTPåè®®è¿è¡Œï¼Œä½†å»ºè®®ä½¿ç”¨HTTPSåè®®ã€‚ åœ¨Goä¸­ï¼Œè¿™å¯ä»¥æ¯«æ— é—®é¢˜åœ°å®Œæˆã€‚ å¦‚æœæ‚¨æ”¶åˆ°äº†è¯ä¹¦å’Œç§é’¥ï¼Œåˆ™åªéœ€ä½¿ç”¨æ­£ç¡®çš„è¯ä¹¦å’Œå¯†é’¥æ–‡ä»¶æ³¨å†ŒListenAndServeTLSã€‚ <br><br><pre> <code class="go hljs">http.ListenAndServeTLS(<span class="hljs-string"><span class="hljs-string">":443"</span></span>, <span class="hljs-string"><span class="hljs-string">"cert.pem"</span></span>, <span class="hljs-string"><span class="hljs-string">"key.pem"</span></span>, <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)</code> </pre> <br> æ‚¨æ€»æ˜¯å¯ä»¥åšå¾—æ›´å¥½ã€‚ <br><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŠ å¯†</a>è®©æˆ‘ä»¬å…è´¹æä¾›å…·æœ‰è‡ªåŠ¨ç»­è®¢åŠŸèƒ½çš„è¯ä¹¦ã€‚ ä¸ºäº†ä½¿ç”¨è¯¥æœåŠ¡ï¼Œæ‚¨éœ€è¦<code>autocert</code>è½¯ä»¶åŒ…ã€‚ <br><br> é…ç½®å®ƒçš„æœ€ç®€å•æ–¹æ³•æ˜¯å°†autocert.NewListeneræ–¹æ³•ä¸http.Serveç»“åˆä½¿ç”¨ã€‚ è¯¥æ–¹æ³•å…è®¸æ‚¨åœ¨HTTPæœåŠ¡å™¨å¤„ç†è¯·æ±‚æ—¶æ¥æ”¶å’Œç»­è®¢TLSè¯ä¹¦ï¼š <br><br><pre> <code class="go hljs">http.Serve(autocert.NewListener(<span class="hljs-string"><span class="hljs-string">"example.com"</span></span>), <span class="hljs-literal"><span class="hljs-literal">nil</span></span>)</code> </pre> <br> å¦‚æœåœ¨æµè§ˆå™¨ä¸­æ‰“å¼€<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">example.com</a> ï¼Œ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ™ä¼š</a>æ”¶åˆ°HTTPSå“åº”â€œ Helloï¼Œworldï¼â€ã€‚ <br><br> å¦‚æœéœ€è¦æ›´å…¨é¢çš„é…ç½®ï¼Œåˆ™åº”ä½¿ç”¨autocert.Managerç®¡ç†å™¨ã€‚ ç„¶åï¼Œæˆ‘ä»¬åˆ›å»ºè‡ªå·±çš„http.Serverå®ä¾‹ï¼ˆç›´åˆ°ç°åœ¨é»˜è®¤ä½¿ç”¨å®ƒï¼‰å¹¶å°†ç®¡ç†å™¨æ·»åŠ åˆ°TLSConfigæœåŠ¡å™¨ï¼š <br><br><pre> <code class="go hljs">m := &amp;autocert.Manager{ Cache: autocert.DirCache(<span class="hljs-string"><span class="hljs-string">"golang-autocert"</span></span>), Prompt: autocert.AcceptTOS, HostPolicy: autocert.HostWhitelist(<span class="hljs-string"><span class="hljs-string">"example.org"</span></span>, <span class="hljs-string"><span class="hljs-string">"www.example.org"</span></span>), } server := &amp;http.Server{ Addr: <span class="hljs-string"><span class="hljs-string">":443"</span></span>, TLSConfig: m.TLSConfig(), } server.ListenAndServeTLS(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre> <br> è¿™æ˜¯é€šè¿‡è‡ªåŠ¨è¯ä¹¦æ›´æ–°å®ç°å®Œå…¨HTTPSæ”¯æŒçš„ç®€ä¾¿æ–¹æ³•ã€‚ <br><br><h3> æ·»åŠ è‡ªå®šä¹‰è·¯çº¿ </h3><br> æ ‡å‡†åº“ä¸­åŒ…å«çš„é»˜è®¤è·¯ç”±å™¨æ˜¯å¥½çš„ï¼Œä½†æ˜¯éå¸¸ç®€å•ã€‚ å¤§å¤šæ•°åº”ç”¨ç¨‹åºéœ€è¦æ›´å¤æ‚çš„è·¯ç”±ï¼ŒåŒ…æ‹¬åµŒå¥—å’Œé€šé…ç¬¦è·¯ç”±ï¼Œæˆ–è€…è®¾ç½®æ¨¡å¼å’Œè·¯å¾„å‚æ•°çš„è¿‡ç¨‹ã€‚ <br><br> åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨åº”è¯¥ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow noopener noreferrer">å¤§çŒ©çŒ©/ mux</a>å’Œ<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=" rel="nofollow noopener noreferrer">go-chi / chi</a>è½¯ä»¶åŒ…ã€‚ æˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨åè€…-ä¸‹é¢æ˜¾ç¤ºäº†ä¸€ä¸ªç¤ºä¾‹ã€‚ <br><br> ç»™å‡ºçš„æ˜¯api / v1 / api.goæ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬APIçš„è·¯ç”±ï¼š <br><br><pre> <code class="go hljs">/ HelloResponse is the JSON representation <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a customized message <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> HelloResponse <span class="hljs-keyword"><span class="hljs-keyword">struct</span></span> { Message <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> <span class="hljs-string"><span class="hljs-string">`json:"message"`</span></span> } <span class="hljs-comment"><span class="hljs-comment">// HelloName returns a personalized JSON message func HelloName(w http.ResponseWriter, r *http.Request) { name := chi.URLParam(r, "name") response := HelloResponse{ Message: fmt.Sprintf("Hello %s!", name), } jsonResponse(w, response, http.StatusOK) } // NewRouter returns an HTTP handler that implements the routes for the API func NewRouter() http.Handler { r := chi.NewRouter() r.Get("/{name}", HelloName) return r }</span></span></code> </pre> <br> æˆ‘ä»¬åœ¨ä¸»æ–‡ä»¶ä¸­ä¸ºè·¯ç”±è®¾ç½®api / vqå‰ç¼€ã€‚ <br><br> ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶æŒ‚è½½åˆ°ä¸»åº”ç”¨ç¨‹åºä¸­api / v1 / /å‰ç¼€ä¸‹çš„ä¸»è·¯ç”±å™¨ä¸­ï¼š <br><br><pre> <code class="go hljs"><span class="hljs-comment"><span class="hljs-comment">// NewRouter returns a new HTTP handler that implements the main server routes func NewRouter() http.Handler { router := chi.NewRouter() router.Mount("/api/v1/", v1.NewRouter()) return router } http.Serve(autocert.NewListener("example.com"), NewRouter())</span></span></code> </pre> <br> åœ¨Goä¸­ä½¿ç”¨å¤æ‚è·¯ç”±çš„ç®€å•æ€§ä½¿å¾—å¯ä»¥é€šè¿‡ä¸ºå¤§å‹å¤æ‚åº”ç”¨ç¨‹åºæä¾›æœåŠ¡æ¥ç®€åŒ–ç»“æ„ã€‚ <br><br><h3> ä½¿ç”¨ä¸­é—´ä»¶ </h3><br> åœ¨ä¸­é—´å¤„ç†çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä¸€ä¸ªHTTPå¤„ç†ç¨‹åºä¸å¦ä¸€ä¸ªå¤„ç†ç¨‹åºåŒ…è£…åœ¨ä¸€èµ·ï¼Œè¿™ä½¿å¾—å¯ä»¥å¿«é€Ÿè¿›è¡Œèº«ä»½éªŒè¯ï¼Œå‹ç¼©ï¼Œæ—¥è®°å’Œå…¶ä»–ä¸€äº›åŠŸèƒ½ã€‚ <br><br> ä¾‹å¦‚ï¼Œè€ƒè™‘æ¥å£http.Handlerï¼Œåœ¨å®ƒçš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬ç¼–å†™äº†ä¸€ä¸ªå¯¹æœåŠ¡ç”¨æˆ·è¿›è¡Œèº«ä»½éªŒè¯çš„å¤„ç†ç¨‹åºã€‚ <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RequireAuthentication</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(next http.Handler)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">http</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Handler</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> http.HandlerFunc(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(w http.ResponseWriter, r *http.Request)</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> !isAuthenticated(r) { http.Redirect(w, r, <span class="hljs-string"><span class="hljs-string">"/login"</span></span>, http.StatusTemporaryRedirect) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> } <span class="hljs-comment"><span class="hljs-comment">// Assuming authentication passed, run the original handler next.ServeHTTP(w, r) }) }</span></span></code> </pre> <br> æœ‰ç¬¬ä¸‰æ–¹è·¯ç”±å™¨ï¼ˆä¾‹å¦‚chiï¼‰ï¼Œå¯ç”¨äºæ‰©å±•ä¸­é—´å¤„ç†çš„åŠŸèƒ½ã€‚ <br><br><h3> å¤„ç†é™æ€æ–‡ä»¶ </h3><br>  Goæ ‡å‡†åº“åŒ…å«ç”¨äºå¤„ç†é™æ€å†…å®¹ï¼ˆåŒ…æ‹¬å›¾åƒï¼‰ä»¥åŠJavaScriptå’ŒCSSæ–‡ä»¶çš„åŠŸèƒ½ã€‚ å¯ä»¥é€šè¿‡http.FileServerå‡½æ•°è®¿é—®å®ƒä»¬ã€‚ å®ƒè¿”å›ä¸€ä¸ªå¤„ç†ç¨‹åºï¼Œè¯¥å¤„ç†ç¨‹åºä»ç‰¹å®šç›®å½•åˆ†å‘æ–‡ä»¶ã€‚ <br><br><pre> <code class="go hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NewRouter</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">http</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Handler</span></span></span></span> { router := chi.NewRouter() r.Get(<span class="hljs-string"><span class="hljs-string">"/{name}"</span></span>, HelloName) <span class="hljs-comment"><span class="hljs-comment">//     staticPath, _ := filepath.Abs("../../static/") fs := http.FileServer(http.Dir(staticPath)) router.Handle("/*", fs) return r</span></span></code> </pre> <br> å€¼å¾—è®°ä½çš„æ˜¯ï¼Œå¦‚æœhttp.Diræ²¡æœ‰ä¸»index.htmlæ–‡ä»¶ï¼Œå®ƒå°†æ˜¾ç¤ºç›®å½•çš„å†…å®¹ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºé˜²æ­¢ç›®å½•é­åˆ°ç ´åï¼Œå€¼å¾—ä½¿ç”¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u="><code>unindexed</code></a>ç¨‹åºåŒ…ã€‚ <br><br><h3> æ­£ç¡®å…³æœº </h3><br>  Goè¿˜å…·æœ‰è¯¸å¦‚æ­£ç¡®å…³é—­HTTPæœåŠ¡å™¨ä¹‹ç±»çš„åŠŸèƒ½ã€‚ è¿™å¯ä»¥ä½¿ç”¨Shutdownï¼ˆï¼‰æ–¹æ³•å®Œæˆã€‚ æœåŠ¡å™¨ä»¥goroutineå¯åŠ¨ï¼Œç„¶åä¾¦å¬è¯¥é€šé“ä»¥æ¥æ”¶ä¸­æ–­ä¿¡å·ã€‚ æ”¶åˆ°ä¿¡å·åï¼ŒæœåŠ¡å™¨å°†ç«‹å³å…³é—­ï¼Œä½†ä¸ä¼šç«‹å³å…³é—­ï¼Œè€Œæ˜¯ä¼šåœ¨å‡ ç§’é’Ÿåå…³é—­ã€‚ <br><br><pre> <code class="go hljs">handler := server.NewRouter() srv := &amp;http.Server{ Handler: handler, } <span class="hljs-keyword"><span class="hljs-keyword">go</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { srv.Serve(autocert.NewListener(domains...)) }() <span class="hljs-comment"><span class="hljs-comment">// Wait for an interrupt c := make(chan os.Signal, 1) signal.Notify(c, os.Interrupt) &lt;-c // Attempt a graceful shutdown ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second) defer cancel() srv.Shutdown(ctx)</span></span></code> </pre> <br><h3> æ€»ç»“ </h3><br>  Goæ˜¯ä¸€ç§åŠŸèƒ½å¼ºå¤§çš„è¯­è¨€ï¼Œå…·æœ‰å‡ ä¹é€šç”¨çš„æ ‡å‡†åº“ã€‚ å®ƒçš„é»˜è®¤åŠŸèƒ½éå¸¸å¹¿æ³›ï¼Œæ‚¨å¯ä»¥åœ¨ç•Œé¢çš„å¸®åŠ©ä¸‹åŠ ä»¥å¢å¼º-è¿™ä½¿æ‚¨å¯ä»¥å¼€å‘çœŸæ­£å¯é çš„HTTPæœåŠ¡å™¨ã€‚ <br><blockquote>  <b>Skillboxå»ºè®®ï¼š</b> <br><br><ul><li> ä¸¤å¹´å®è·µè¯¾ç¨‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œæˆ‘æ˜¯PRO Webå¼€å‘äººå‘˜</a> ã€‚ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€</a> </li><li> åœ¨çº¿æ•™è‚²è¯¾ç¨‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œä¸“ä¸šJavaå¼€å‘äººå‘˜â€</a> ã€‚ </li><li> å¹´åº¦å®è·µè¯¾ç¨‹<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">â€œ PHPå¼€å‘äººå‘˜ä»0åˆ°PROâ€</a> ã€‚ <br></li></ul></blockquote></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN446454/">https://habr.com/ru/post/zh-CN446454/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN446440/index.html">ã€Šå¿«é€Ÿååº”ã€‹ä¸€ä¹¦ã€‚ Reactï¼ŒJSXï¼ŒReduxå’ŒGraphQLä¸­çš„Webåº”ç”¨ç¨‹åºÂ»</a></li>
<li><a href="../zh-CN446444/index.html">ä»Skypeåˆ°WebRTCï¼šæˆ‘ä»¬å¦‚ä½•ç»„ç»‡ç½‘ç»œè§†é¢‘é€šä¿¡</a></li>
<li><a href="../zh-CN446446/index.html">JavaScriptå¼•æ“åŸºç¡€çŸ¥è¯†ï¼šå¸¸è§„å½¢å¼å’Œå†…è”ç¼“å­˜ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN446448/index.html">è¿›è¡Œé—®é¢˜è®¿è°ˆä»¥è¯†åˆ«æ¶ˆè´¹è€…éœ€æ±‚çš„5æ¡åŸºæœ¬è§„åˆ™</a></li>
<li><a href="../zh-CN446452/index.html">æœˆçƒé£è¡Œä»»åŠ¡â€œ Bereshitâ€-2019å¹´4æœˆ4æ—¥ï¼Œå®Œæˆå‘æœˆçƒè½¨é“çš„è¿‡æ¸¡ï¼Œæå‰7å¤©é£è¡Œï¼Œè¿›è¡Œäº†6æ¬¡æœºåŠ¨å’Œ1æ¬¡ç€é™†</a></li>
<li><a href="../zh-CN446458/index.html">åŸºäºArduino Nanoçš„é€šç”¨DRO-shDROã€‚ ç¬¬äºŒéƒ¨åˆ†</a></li>
<li><a href="../zh-CN446460/index.html">é£Ÿå“è®¾è®¡æ–‡æ‘˜2019å¹´3æœˆ</a></li>
<li><a href="../zh-CN446462/index.html">æ²‰æµ¸åœ¨é©±åŠ¨ç¨‹åºä¸­ï¼šä½¿ç”¨NeoQUEST-2019ä»»åŠ¡ç¤ºä¾‹è¿›è¡Œåå‘çš„ä¸€èˆ¬åŸç†</a></li>
<li><a href="../zh-CN446464/index.html">15åªé¹¦é¹‰ï¼šé€‰æ‹©VPS / VDSæœåŠ¡å™¨çš„æ‰˜ç®¡æœåŠ¡æä¾›å•†</a></li>
<li><a href="../zh-CN446466/index.html">å•†ä¸šå†…å®¹è¥é”€ï¼šHabraseminarï¼ƒ6åŠå…¶è¦ç‚¹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>