<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘©â€ğŸ¤ ğŸ‘©ğŸ½â€ğŸŒ¾ ğŸ•˜ æœ‰é™æˆ˜äº‰ ğŸ§–ğŸ» ğŸ‡ ğŸ¥‚</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="æˆ‘ä»¬æœ‰é—®é¢˜ã€‚ æµ‹è¯•çš„é—®é¢˜ã€‚ æµ‹è¯•Reactç»„ä»¶çš„é—®é¢˜ï¼Œè¿™æ˜¯éå¸¸åŸºæœ¬çš„ã€‚ è¿™æ˜¯å…³äºunit testingå’Œintegration testingä¹‹é—´çš„åŒºåˆ«ã€‚ è¿™æ˜¯å…³äºæˆ‘ä»¬æ‰€è°“çš„å•å…ƒæµ‹è¯•å’Œæˆ‘ä»¬æ‰€è°“çš„é›†æˆæµ‹è¯•ï¼Œå¤§å°å’ŒèŒƒå›´ä¹‹é—´çš„åŒºåˆ«ã€‚ 


 è¿™ä¸æµ‹è¯•æœ¬èº«æ— å…³ï¼Œè€Œä¸ç»„ä»¶ä½“ç³»ç»“æ„æœ‰å…³ã€‚ å…³äºæµ‹è¯•ç»„ä»¶ ï¼Œç‹¬ç«‹...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>æœ‰é™æˆ˜äº‰</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/436692/"><p><img src="https://habrastorage.org/webt/4w/m4/cc/4wm4ccdyq2tqs2giqspeys3e9sa.jpeg" alt="æ®‹é…·çš„æˆ˜äº‰"></p><br><p>æˆ‘ä»¬æœ‰é—®é¢˜ã€‚ æµ‹è¯•çš„é—®é¢˜ã€‚ æµ‹è¯•Reactç»„ä»¶çš„é—®é¢˜ï¼Œè¿™æ˜¯éå¸¸åŸºæœ¬çš„ã€‚ è¿™æ˜¯å…³äº<code>unit testing</code>å’Œ<code>integration testing</code>ä¹‹é—´çš„åŒºåˆ«ã€‚ è¿™æ˜¯å…³äºæˆ‘ä»¬æ‰€è°“çš„å•å…ƒæµ‹è¯•å’Œæˆ‘ä»¬æ‰€è°“çš„é›†æˆæµ‹è¯•ï¼Œå¤§å°å’ŒèŒƒå›´ä¹‹é—´çš„åŒºåˆ«ã€‚ </p><br><p> è¿™ä¸æµ‹è¯•æœ¬èº«æ— å…³ï¼Œè€Œä¸ç»„ä»¶ä½“ç³»ç»“æ„æœ‰å…³ã€‚ å…³äºæµ‹è¯•<strong>ç»„ä»¶</strong> ï¼Œç‹¬ç«‹åº“å’Œæœ€ç»ˆ<strong>åº”ç”¨ç¨‹åº</strong>ä¹‹é—´çš„åŒºåˆ«ã€‚ </p><br><p> æ¯ä¸ªäººéƒ½çŸ¥é“å¦‚ä½•æµ‹è¯•ç®€å•çš„ç»„ä»¶ï¼ˆå®ƒä»¬å¾ˆç®€å•ï¼‰ï¼Œå¯èƒ½çŸ¥é“å¦‚ä½•æµ‹è¯•åº”ç”¨ç¨‹åºï¼ˆE2Eï¼‰ã€‚ å¦‚ä½•æµ‹è¯•<em>æœ‰é™</em>å’Œ<em>æ— é™çš„</em>äº‹ç‰©... </p><a name="habracut"></a><br><h2 id="define-the-problem"> å®šä¹‰é—®é¢˜ </h2><br><p> æœ‰2ç§ä¸åŒçš„æ–¹æ³•æ¥æµ‹è¯•Reactç»„ä»¶- <code>shallow</code>ä»¥åŠå…¶ä»–æ‰€æœ‰æ–¹æ³•ï¼ŒåŒ…æ‹¬<code>mount</code> ï¼Œ <code>react-testing-library</code> ï¼Œ <code>webdriver</code>ç­‰ã€‚ åªæœ‰<code>shallow</code>æ˜¯ç‰¹æ®Šçš„-å…¶ä½™çš„è¡Œä¸ºç›¸åŒã€‚ </p><br><p> è€Œè¿™ç§åŒºåˆ«åœ¨äº<em>å¤§å°å’ŒèŒƒå›´</em> -å…³äºå°†è¦æµ‹è¯•çš„å†…å®¹ï¼Œä»¥åŠéƒ¨åˆ†<em>å¦‚ä½•</em>è¿›è¡Œæµ‹è¯•ã€‚ </p><br><p> ç®€è€Œè¨€ä¹‹- <code>shallow</code>å°†ä»…è®°å½•å¯¹React.createElementçš„è°ƒç”¨ï¼Œè€Œä¸ä¼šè¿è¡Œä»»ä½•å‰¯ä½œç”¨ï¼ŒåŒ…æ‹¬æ¸²æŸ“DOMå…ƒç´ -è¿™æ˜¯React.createElementçš„å‰¯ä½œç”¨ï¼ˆä»£æ•°ï¼‰ã€‚ </p><br><p> ä»»ä½•å…¶ä»–å‘½ä»¤éƒ½å°†è¿è¡Œæ‚¨æä¾›çš„é™„å¸¦å‰¯ä½œç”¨çš„ä»£ç ã€‚ æ­£å¦‚ç°å®ä¸­é‚£æ ·ï¼Œè¿™å°±æ˜¯ç›®æ ‡ã€‚ </p><br><p>  <strong>é—®é¢˜å‡º</strong>åœ¨ä¸‹é¢ï¼š <code>you can NOT run each and every side effect</code> ã€‚ </p><br><h3 id="why-not"> ä¸ºä»€ä¹ˆä¸å‘¢ </h3><br><p> åŠŸèƒ½çº¯åº¦ï¼Ÿ çº¯åº¦å’Œä¸å˜æ€§-ä»Šå¤©çš„åœ£ç‰›ã€‚ è€Œæ‚¨æ­£åœ¨å± æ€å…¶ä¸­ä¹‹ä¸€ã€‚ å•å…ƒæµ‹è¯•çš„å…¬ç†-æ²¡æœ‰å‰¯ä½œç”¨ï¼Œéš”ç¦»ï¼Œå˜²ç¬‘ï¼Œä¸€åˆ‡éƒ½åœ¨æ§åˆ¶ä¹‹ä¸‹ã€‚ </p><br><ul><li><p> ä½†è¿™å¯¹äº... <code>dumb components</code> <em>ä¸æ˜¯é—®é¢˜</em> ã€‚ å®ƒä»¬å¾ˆç¬¨ï¼Œä»…åŒ…å«è¡¨ç¤ºå±‚ï¼Œè€Œæ²¡æœ‰â€œå‰¯ä½œç”¨â€ã€‚ </p><br></li><li><p> ä½†è¿™å¯¹<code>Containers</code>æ¥è¯´æ˜¯<em>ä¸ªé—®é¢˜</em> ã€‚ åªè¦å®ƒä»¬ä¸ç¬¨ï¼Œå°±åŒ…å«å®ƒä»¬æƒ³è¦çš„ä»»ä½•ä¸œè¥¿ï¼Œå¹¶ä¸”å®Œå…¨å…·æœ‰å‰¯ä½œç”¨ã€‚ ä»–ä»¬æ˜¯é—®é¢˜ï¼ </p><br></li></ul><br><p> ä¹Ÿè®¸ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰â€œæ­£ç¡®ç»„ä»¶â€çš„è§„åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ¾åœ°è¿›è¡Œæµ‹è¯•-å®ƒä¼šæŒ‡å¯¼æˆ‘ä»¬å¹¶ä¸ºæˆ‘ä»¬æä¾›å¸®åŠ©ã€‚ </p><br><blockquote>  TRDLï¼šæœ‰é™åˆ†é‡ </blockquote><br><h2 id="smart-and-dumb-components"> æ™ºèƒ½å’Œå“‘å·´ç»„ä»¶ </h2><br><p> æ ¹æ®<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Dan Abramovçš„æ–‡ç« </a>ä»‹ç»ï¼Œç»„ä»¶åŒ…æ‹¬ï¼š </p><br><ul><li> å…³æ³¨äº‹ç‰©çš„å¤–è§‚ã€‚ </li><li> å¯èƒ½åŒæ—¶åŒ…å«è¡¨ç¤ºæ€§ç»„ä»¶å’Œå®¹å™¨ç»„ä»¶<code>**</code> ï¼Œå¹¶ä¸”é€šå¸¸å…·æœ‰ä¸€äº›è‡ªå·±çš„DOMæ ‡è®°å’Œæ ·å¼ã€‚ </li><li> é€šå¸¸å…è®¸é€šè¿‡this.props.childrenè¿›è¡Œéåˆ¶ã€‚ </li><li> ä¸å…¶ä»–åº”ç”¨ç¨‹åºæ— å…³ï¼Œä¾‹å¦‚Fluxæ“ä½œæˆ–å•†åº—ã€‚ </li><li> ä¸è¦æŒ‡å®šå¦‚ä½•åŠ è½½æˆ–æ›´æ”¹æ•°æ®ã€‚ </li><li> ä»…é€šè¿‡é“å…·æ¥æ”¶æ•°æ®å’Œå›è°ƒã€‚ </li><li> å¾ˆå°‘æœ‰è‡ªå·±çš„çŠ¶æ€ï¼ˆå½“è¿™æ ·åšæ—¶ï¼Œå®ƒæ˜¯UIçŠ¶æ€è€Œä¸æ˜¯æ•°æ®çŠ¶æ€ï¼‰ã€‚ </li><li> é™¤ééœ€è¦çŠ¶æ€ï¼Œç”Ÿå‘½å‘¨æœŸæŒ‚é’©æˆ–æ€§èƒ½ä¼˜åŒ–ï¼Œå¦åˆ™å®ƒä»¬è¢«ç¼–å†™ä¸ºåŠŸèƒ½ç»„ä»¶ã€‚ </li><li> ç¤ºä¾‹ï¼šé¡µé¢ï¼Œè¾¹æ ï¼Œæ•…äº‹ï¼Œç”¨æˆ·ä¿¡æ¯ï¼Œåˆ—è¡¨ã€‚ </li><li>  .... </li><li> å®¹å™¨åªæ˜¯è¿™äº›ç»„ä»¶çš„æ•°æ®/é“å…·æä¾›è€…ã€‚ </li></ul><br><p> æ ¹æ®èµ·æºï¼š <strong>åœ¨ç†æƒ³çš„åº”ç”¨ä¸­...</strong> <strong><br></strong>  <strong>å®¹å™¨å°±æ˜¯æ ‘ã€‚</strong>  <strong>ç»„ä»¶æ˜¯æ ‘å¶ã€‚</strong> </p><br><h4 id="find-the-black-cat-in-the-dark-room"> åœ¨é»‘æš—çš„æˆ¿é—´é‡Œæ‰¾åˆ°é»‘çŒ« </h4><br><p> è¿™é‡Œçš„ç§˜å¯†ä¹‹å¤„æ˜¯æˆ‘ä»¬å¿…é¡»å¯¹æ­¤å®šä¹‰è¿›è¡Œä¿®æ”¹çš„ä¸€é¡¹æ›´æ”¹ï¼Œéšè—åœ¨<em>â€œå¯ä»¥åŒ…å«è¡¨ç¤ºæ€§å’Œå®¹å™¨æ€§ç»„ä»¶<code>**</code> â€ä¸­</em> ï¼Œè®©æˆ‘å¼•ç”¨åŸå§‹æ–‡ç« ï¼š </p><br><blockquote> åœ¨æœ¬æ–‡çš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œæˆ‘å£°ç§°å‘ˆç°ç»„ä»¶åº”ä»…åŒ…å«å…¶ä»–å‘ˆç°ç»„ä»¶ã€‚ æˆ‘ä¸å†è®¤ä¸ºæ˜¯è¿™ç§æƒ…å†µã€‚ ç»„ä»¶æ˜¯è¡¨ç¤ºç»„ä»¶è¿˜æ˜¯å®¹å™¨æ˜¯å…¶å®ç°ç»†èŠ‚ã€‚ æ‚¨åº”è¯¥èƒ½å¤Ÿç”¨å®¹å™¨æ›¿æ¢æ¼”ç¤ºç»„ä»¶ï¼Œè€Œæ— éœ€ä¿®æ”¹ä»»ä½•å‘¼å«ç«™ç‚¹ã€‚ å› æ­¤ï¼Œå¤–è§‚ç»„ä»¶å’Œå®¹å™¨ç»„ä»¶éƒ½å¯ä»¥åŒ…å«å…¶ä»–å¤–è§‚ç»„ä»¶æˆ–å®¹å™¨ç»„ä»¶ã€‚ </blockquote><p> å¥½çš„ï¼Œä½†æ˜¯è§„åˆ™ä½¿æ¼”ç¤ºç»„ä»¶å¯ä»¥æµ‹è¯•çš„è§„åˆ™åˆå¦‚ä½•- <em>â€œå¯¹åº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†æ²¡æœ‰ä¾èµ–æ€§â€</em> ï¼Ÿ </p><br><p> ä¸å¹¸çš„æ˜¯ï¼Œé€šè¿‡å°†å®¹å™¨åŒ…æ‹¬åˆ°æ¼”ç¤ºç»„ä»¶ä¸­ï¼Œæ‚¨ä½¿ç¬¬äºŒä¸ªå®¹å™¨æˆä¸º<strong>æ— é™</strong> ï¼Œå¹¶å‘åº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†æ³¨å…¥äº†ä¾èµ–æ€§ã€‚ </p><br><p> å¯èƒ½é‚£ä¸æ˜¯æ‚¨æ‰“ç®—è¦åšçš„ã€‚ å› æ­¤ï¼Œæˆ‘åˆ«æ— é€‰æ‹©ï¼Œåªèƒ½ä½¿å“‘ç»„ä»¶å˜å¾—æœ‰é™ï¼š </p><br><p>  <strong>è¡¨ç¤ºç»„ä»¶åº”ä»…åŒ…å«å…¶ä»–è¡¨ç¤ºç»„ä»¶</strong> </p><br><p> å”¯ä¸€çš„é—®é¢˜æ˜¯ï¼Œæ‚¨åº”è¯¥é—®ï¼ˆè°ƒæŸ¥å½“å‰çš„ä»£ç åº“ï¼‰ï¼š <em>å¦‚ä½•ï¼Ÿ</em>  ï¼štableflipï¼šï¼Ÿï¼ </p><br><p> å¦‚ä»Šï¼ŒPresentation Presentation Componentså’ŒContainerä¸ä»…çº ç¼ åœ¨ä¸€èµ·ï¼Œè€Œä¸”æœ‰æ—¶è¿˜æ²¡æœ‰æå–ä¸ºâ€œçº¯â€å®ä½“ï¼ˆæ‚¨å¥½GraphQLï¼‰ã€‚ </p><br><h4 id="solution-1---di"> è§£å†³æ–¹æ¡ˆ1-DI </h4><br><p> è§£å†³æ–¹æ¡ˆ1å¾ˆç®€å•-ä¸è¦åœ¨å“‘ç»„ä»¶ä¸­åŒ…å«åµŒå¥—å®¹å™¨-åŒ…å«<code>slots</code> ã€‚ åªéœ€æ¥å—â€œå†…å®¹â€ï¼ˆå­©å­ä»¬ï¼‰ä½œä¸ºé“å…·ï¼Œå°±å¯ä»¥è§£å†³é—®é¢˜ï¼š </p><br><ul><li> æ‚¨æ— éœ€â€œåº”ç”¨ç¨‹åºçš„å…¶ä½™éƒ¨åˆ†â€å°±å¯ä»¥æµ‹è¯•å“‘å·´ç»„ä»¶ </li><li> æ‚¨å¯ä»¥ä½¿ç”¨Smoke / Integration / e2eæµ‹è¯•è€Œä¸æ˜¯æµ‹è¯•æ¥æµ‹è¯•é›†æˆã€‚ </li></ul><br><pre> <code class="plaintext hljs">// Test me with mount, with "slots emty". const PageChrome = ({children, aside}) =&gt; ( &lt;section&gt; &lt;aside&gt;{aside}&lt;/aside&gt; {children} &lt;/section&gt; ); // test me with shallow, or real integration test const PageChromeContainer = () =&gt; ( &lt;PageChrome aside={&lt;ASideContainer /&gt;}&gt; &lt;Page /&gt; &lt;/PageChrome&gt; );</code> </pre> <br><p> ä¸¹æœ¬äººæ‰¹å‡†ï¼š <br>  {ï¼…twitter 1021850499618955272ï¼…} </p><br><p>  DIï¼ˆä¾èµ–æ³¨å…¥å’Œä¾èµ–å€’ç½®ï¼‰å¯èƒ½æ˜¯è¿™é‡Œæœ€å¯é‡å¤ä½¿ç”¨çš„æŠ€æœ¯ï¼Œå®ƒå¯ä»¥ä½¿æ‚¨çš„ç”Ÿæ´»å˜å¾—è½»æ¾å¾—å¤šã€‚ </p><br><blockquote> æŒ‡å‘æ­¤å¤„-æ„šè ¢çš„ç»„ä»¶å˜å¾—æ„šè ¢ï¼ </blockquote><br><h4 id="solution-2---boundaries"> è§£å†³æ–¹æ¡ˆ2-è¾¹ç•Œ </h4><br><p> è¿™æ˜¯ä¸€ä¸ªè¯´æ˜æ€§çš„è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥æ‰©å±•<code>Solution 1</code>ä»…å£°æ˜æ‰€æœ‰<em>æ‰©å±•</em>ç‚¹ã€‚ åªæ˜¯ç”¨...åŒ…è£¹å®ƒä»¬<code>Boundary</code> </p><br><pre> <code class="plaintext hljs">const Boundary = ({children}) =&gt; ( process.env.NODE_ENV === 'test' ? null : children // or `jest.mock` ); const PageChrome = () =&gt; ( &lt;section&gt; &lt;aside&gt;&lt;Boundary&gt;&lt;ASideContainer /&gt;&lt;/Boundary&gt;&lt;/aside&gt; &lt;Boundary&gt;&lt;Page /&gt;&lt;/Boundary&gt; &lt;/section&gt; );</code> </pre> <br><p> ç„¶å-æ‚¨å¯ä»¥å°†<code>Boundary</code>ç¦ç”¨ä¸ºé›¶ï¼Œä»¥å‡å°ComponentèŒƒå›´å¹¶å°†å…¶è®¾ä¸º<em>finite</em> ã€‚ </p><br><blockquote> æŒ‡å‘æ­¤å¤„-è¾¹ç•Œåœ¨â€œå“‘â€ç»„ä»¶å±‚ä¸Šã€‚ å“‘å·´ç»„ä»¶æ§åˆ¶ç€å“‘å·´çš„ç¨‹åº¦ã€‚ </blockquote><br><h3 id="solution-3---tier"> è§£å†³æ–¹æ¡ˆ3-å±‚ </h3><br><p> ä¸è§£å†³æ–¹æ¡ˆ2ç›¸åŒï¼Œä½†å…·æœ‰æ›´æ™ºèƒ½çš„è¾¹ç•Œï¼Œèƒ½å¤Ÿæ¨¡æ‹Ÿ<em>layer</em>æˆ–<em>tier</em>æˆ–æ‚¨æ‰€è¯´çš„ä»»ä½•å†…å®¹ï¼š </p><br><pre> <code class="plaintext hljs">const checkTier = tier =&gt; tier === currentTier; const withTier = tier =&gt; WrapperComponent =&gt; (props) =&gt; ( (process.env.NODE_ENV !== 'test' || checkTier(tier)) &amp;&amp; &lt;WrapperComponent{...props} /&gt; ); const PageChrome = () =&gt; ( &lt;section&gt; &lt;aside&gt;&lt;ASideContainer /&gt;&lt;/aside&gt; &lt;Page /&gt; &lt;/section&gt; ); const ASideContainer = withTier('UI')(...) const Page = withTier('Page')(...) const PageChromeContainer = withTier('UI')(PageChrome);</code> </pre> <br><blockquote> å³ä½¿è¿™å‡ ä¹ä¸â€œè¾¹ç•Œâ€ç¤ºä¾‹ç±»ä¼¼ï¼Œä½†â€œå“‘å·´â€ç»„ä»¶æ˜¯â€œå“‘å·´â€ï¼Œè€Œâ€œå®¹å™¨â€æ§åˆ¶ç€å…¶ä»–â€œå®¹å™¨â€çš„å¯è§æ€§ã€‚ </blockquote><br><h4 id="solution-4---separate-concerns"> è§£å†³æ–¹æ¡ˆ4-å•ç‹¬çš„é—®é¢˜ </h4><br><p> å¦ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯å•ç‹¬å…³æ³¨ï¼ æˆ‘çš„æ„æ€æ˜¯-æ‚¨å·²ç»åšåˆ°äº†ï¼Œå¯èƒ½æ˜¯æ—¶å€™åˆ©ç”¨å®ƒäº†ã€‚ </p><br><blockquote> é€šè¿‡<code>connect</code>ç»„ä»¶<code>connect</code>åˆ°Reduxæˆ–GQLï¼Œæ‚¨å°†ç”Ÿäº§å‡º<em>ä¼—æ‰€å‘¨çŸ¥çš„</em>å®¹å™¨ã€‚ æˆ‘çš„æ„æ€æ˜¯- <em>ä¼—æ‰€å‘¨çŸ¥çš„</em>åç§°<code>Container(WrapperComponent)</code> ã€‚ æ‚¨å¯ä»¥å˜²ç¬‘ä»–ä»¬çš„åå­— </blockquote><br><pre> <code class="plaintext hljs">const PageChrome = () =&gt; ( &lt;section&gt; &lt;aside&gt;&lt;ASideContainer /&gt;&lt;/aside&gt; &lt;Page /&gt; &lt;/section&gt; ); // remove all components matching react-redux pattern reactRemock.mock(/Connect\(\w\)/) // all any other container reactRemock.mock(/Container/)</code> </pre> <br><p> è¿™ç§æ–¹æ³•æœ‰ç‚¹ç²—é²-ä¼šæŠ¹æ‰<em>æ‰€æœ‰å†…å®¹</em> ï¼Œä½¿è‡ªå·±éš¾ä»¥æµ‹è¯•Contaiersï¼Œå¹¶ä¸”æ‚¨å¯ä»¥ä½¿ç”¨æ›´å¤æ‚çš„æ¨¡æ‹Ÿæ¥ä¿ç•™â€œç¬¬ä¸€ä¸ªâ€ï¼š </p><br><pre> <code class="plaintext hljs">import {createElement, remock} from 'react-remock'; // initially "open" const ContainerCondition = React.createContext(true); reactRemock.mock(/Connect\(\w\)/, (type, props, children) =&gt; ( &lt;ContainerCondition.Consumer&gt; { opened =&gt; ( opened ? ( // "close" and render real component &lt;ContainerCondition.Provider value={false}&gt; {createElement(type, props, ...children)} &lt;ContainerCondition.Provider&gt; ) // it's "closed" : null )} &lt;/ContainerCondition.Consumer&gt; )</code> </pre> <br><blockquote> æŒ‡å‘æ­¤å¤„ï¼šæ²¡æœ‰é€»è¾‘ä¹Ÿæ²¡æœ‰Presentationï¼Œä¹Ÿæ²¡æœ‰å®¹å™¨-æ‰€æœ‰é€»è¾‘éƒ½åœ¨å¤–éƒ¨ã€‚ </blockquote><br><h4 id="bonus-solution---separate-concerns"> é¢å¤–è§£å†³æ–¹æ¡ˆ-å•ç‹¬çš„é—®é¢˜ </h4><br><p> æ‚¨å¯ä»¥ä½¿ç”¨<code>defaultProps</code>ä¿æŒ<em>ç´§å¯†è€¦åˆ</em> ï¼Œå¹¶åœ¨æµ‹è¯•ä¸­ä½¿è¿™äº›é“å…·æ— æ•ˆã€‚ </p><br><pre> <code class="plaintext hljs">const PageChrome = ({Content = Page, Aside = ASideContainer}) =&gt; ( &lt;section&gt; &lt;aside&gt;&lt;Aside/&gt;&lt;/aside&gt; &lt;Content/&gt; &lt;/section&gt; );</code> </pre> <br><h2 id="so"> é‚£å‘¢ </h2><br><p> å› æ­¤ï¼Œæˆ‘åˆšåˆšå‘å¸ƒäº†ä¸€äº›æ–¹æ³•æ¥ç¼©å°ä»»ä½•ç»„ä»¶çš„èŒƒå›´ï¼Œå¹¶ä½¿å®ƒä»¬æ›´å…·å¯æµ‹è¯•æ€§ã€‚ ä»<code>gearbox</code>å–å‡ºä¸€ä¸ª<code>gear</code>çš„ç®€å•æ–¹æ³•ã€‚ ä¸€ä¸ªç®€å•çš„æ¨¡å¼ï¼Œä½¿æ‚¨çš„ç”Ÿæ´»æ›´è½»æ¾ã€‚ </p><br><p> ç«¯åˆ°ç«¯æµ‹è¯•éå¸¸æ£’ï¼Œä½†æ˜¯å¾ˆéš¾æ¨¡æ‹ŸæŸäº›æ¡ä»¶ï¼Œè¿™äº›æ¡ä»¶å¯èƒ½å‘ç”Ÿåœ¨æ·±å±‚åµŒå¥—çš„è¦ç´ ä¸­å¹¶ä¸ºå®ƒä»¬åšå¥½äº†å‡†å¤‡ã€‚ æ‚¨å¿…é¡»å…·æœ‰å•å…ƒæµ‹è¯•æ‰èƒ½æ¨¡æ‹Ÿä¸åŒçš„åœºæ™¯ã€‚ æ‚¨å¿…é¡»è¿›è¡Œé›†æˆæµ‹è¯•ï¼Œä»¥ç¡®ä¿æ‰€æœ‰æ¥çº¿æ­£ç¡®ã€‚ </p><br><p> æ‚¨çŸ¥é“ï¼Œæ­£å¦‚Danåœ¨<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¦ä¸€ç¯‡æ–‡ç« ä¸­</a>æ‰€å†™ï¼š </p><br><blockquote> ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªæŒ‰é’®å¯ä»¥å¤„äº5ç§ä¸åŒçŠ¶æ€ä¹‹ä¸€ï¼ˆæ­£å¸¸ï¼Œæ´»åŠ¨ï¼Œæ‚¬åœï¼Œå±é™©ï¼Œç¦ç”¨ï¼‰ï¼Œåˆ™æ›´æ–°è¯¥æŒ‰é’®çš„ä»£ç å¿…é¡»å¯¹5Ã—4 = 20ç§å¯èƒ½çš„è¿‡æ¸¡æ˜¯æ­£ç¡®çš„-æˆ–ç¦æ­¢å…¶ä¸­æŸäº›è¿‡æ¸¡ã€‚ æˆ‘ä»¬å¦‚ä½•é©¯æœå¯èƒ½çŠ¶æ€çš„ç»„åˆçˆ†ç‚¸å¹¶ä½¿è§†è§‰è¾“å‡ºå¯é¢„æµ‹ï¼Ÿ </blockquote><p> è™½ç„¶è¿™é‡Œæ­£ç¡®çš„è§£å†³æ–¹æ¡ˆæ˜¯çŠ¶æ€æœºï¼Œä½†åŸºæœ¬çš„è¦æ±‚æ˜¯èƒ½å¤ŸæŒ‘é€‰å•ä¸ªåŸå­æˆ–åˆ†å­å¹¶å¯¹å…¶è¿›è¡Œæ“ä½œ-ã€‚ </p><br><h3 id="the-main-points-of-this-article"> æœ¬æ–‡çš„è¦ç‚¹ </h3><br><ol><li> æ¼”ç¤ºç»„ä»¶åº”ä»…åŒ…å«å…¶ä»–æ¼”ç¤ºç»„ä»¶ã€‚ </li><li> å®¹å™¨å°±æ˜¯æ ‘ã€‚ ç»„ä»¶æ˜¯æ ‘å¶ã€‚ </li><li> æ‚¨ä¸å¿…<em>æ€»æ˜¯</em>ä¸åœ¨Presentationalå®¹å™¨ä¸­åŒ…å«å®¹å™¨ï¼Œè€Œ<em>ä¸å¿…</em>ä»…åœ¨æµ‹è¯•ä¸­åŒ…å«å®¹å™¨ã€‚ </li></ol><br><blockquote> é€šè¿‡é˜…è¯»<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä¸­çº§æ–‡ç« </a> ï¼Œæ‚¨å¯èƒ½ä¼šæ›´æ·±å…¥åœ°ç ”ç©¶é—®é¢˜ï¼Œä½†æ˜¯åœ¨è¿™é‡Œè®©æˆ‘ä»¬è·³è¿‡æ‰€æœ‰çš„å›°éš¾ã€‚ </blockquote><p>  PSï¼šè¿™æ˜¯<em>ru-habr</em>æ–‡ç« <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">habrç‰ˆæœ¬çš„ç¿»è¯‘</a> ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN436692/">https://habr.com/ru/post/zh-CN436692/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN436682/index.html">ä¸è¦åˆ›å»ºè‡ªå·±çš„JLï¼ˆDSLï¼‰æ¥æ‰©å±•åº”ç”¨ç¨‹åºçš„åŠŸèƒ½</a></li>
<li><a href="../zh-CN436684/index.html">å‘¨å¹´çºªå¿µç‰ˆAndroid 10ï¼ˆQï¼‰ã€‚ ç°åœ¨çŸ¥é“ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="../zh-CN436686/index.html">æ¥è‡ª3Dä¸–ç•Œçš„JPEGã€‚ ä»€ä¹ˆæ˜¯glTFï¼Ÿ</a></li>
<li><a href="../zh-CN436688/index.html">è¿™å®¶ITå·¨å¤´ç¦»å¼€äº†æ•°æ®ä¸­å¿ƒèŠ¯ç‰‡å¸‚åœº-å‘Šè¯‰æˆ‘ä»¬è¿™å¯¹è¡Œä¸šæ„å‘³ç€ä»€ä¹ˆ</a></li>
<li><a href="../zh-CN436690/index.html">[é—®-ç­”æ¡ˆ]å…³äºçŸ¥è¯†äº§æƒå’Œæ•°æ®ä¿æŠ¤</a></li>
<li><a href="../zh-CN436694/index.html">æˆ‘çš„Pascalç¼–è¯‘å™¨å’Œæ³¢å…°å½“ä»£è‰ºæœ¯</a></li>
<li><a href="../zh-CN436696/index.html">å¦‚ä½•åœ¨å•å£°é“éŸ³è½¨ä¸Šäº§ç”ŸåŒè€³å£°éŸ³-è§†é¢‘å°†æœ‰æ‰€å¸®åŠ©</a></li>
<li><a href="../zh-CN436698/index.html">æˆ‘å¯ä»¥é€šè¿‡å‡ ç§æ–¹å¼å‘Schemeå†™é˜¶ä¹˜ï¼Ÿ</a></li>
<li><a href="../zh-CN436700/index.html">åæ¬ºéª—ï¼šäººè„¸è¯†åˆ«ç³»ç»Ÿå¦‚ä½•æŠµæŠ—éª—å­ï¼Ÿ</a></li>
<li><a href="../zh-CN436704/index.html">æˆ‘ä»¬å¦‚ä½•é€‰æ‹©æ”¶é“¶æœºè‡ªåŠ¨åŒ–ç§¤çš„æ•…äº‹</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>