<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üëéüèº üòó üåé Automatisation des processus m√©tier dans Excel ou comment sauver une fille du traitement ‚úâÔ∏è üßíüèª üë®üèº‚Äçü§ù‚Äçüë®üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ma copine est engag√©e dans des achats dans le r√©seau de distribution. R√©cemment, l'entreprise a subi une forte r√©duction, de sorte que la quantit√© de ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Automatisation des processus m√©tier dans Excel ou comment sauver une fille du traitement</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/447346/">  Ma copine est engag√©e dans des achats dans le r√©seau de distribution.  R√©cemment, l'entreprise a subi une forte r√©duction, de sorte que la quantit√© de travail par employ√© a consid√©rablement augment√©.  Par cons√©quent, elle devait rester r√©guli√®rement au travail, parfois m√™me sortir le samedi.  Ses coll√®gues avaient le m√™me probl√®me. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/725/1cf/243/7251cf24339c88fbb1448a17850bb254.jpg" alt="image"><br><br>  √Ä propos de la d√©cision qui a permis √† ma petite amie de rentrer chez elle √† l'heure, vous pouvez lire sous la coupe. <br><a name="habracut"></a><br>  De plus, une partie importante de ce qu'ils ont fait peut √™tre automatis√©e: recevoir des donn√©es du front, remplir des documents Excel, mettre √† jour les donn√©es du front, etc. <br><br>  La chose la plus raisonnable qui pourrait √™tre faite dans cette situation est d'√©crire un √©nonc√© des travaux sur le d√©veloppement des fonctionnalit√©s n√©cessaires et de le transmettre aux d√©veloppeurs par le biais des autorit√©s.  Cependant, la r√©duction a touch√© tout le monde, y compris les d√©veloppeurs.  Par cons√©quent, ils ne disposaient pas de suffisamment de ressources pour mettre en ≈ìuvre cette automatisation.  Et la soci√©t√© n'a pas pr√©vu d'acheter des syst√®mes RPA sp√©cialis√©s dans un avenir pr√©visible. <br><br>  En outre, une surveillance accrue de ce que les employ√©s font au travail et dans quelles applications ils travaillent. <br><br>  Sur la base du r√©sultat de toutes ces circonstances d√©favorables et de mon d√©sir d√©sesp√©r√© d'aider, j'ai d√©cid√© d'√©crire des fonctions pour Excel en VBA, gr√¢ce auxquelles il serait possible d'automatiser les op√©rations de routine de ma petite amie et de ses coll√®gues. <br><br><h3>  Exigences du produit </h3><br>  Comme point de d√©part, j'ai choisi la t√¢che pour laquelle la fille passait le plus de temps en fonction de ses sentiments.  Dans le cadre de cette t√¢che, la fille avait besoin de: <br><br><ul><li>  Transf√©rez le num√©ro d'article du fichier Excel vers la barre de recherche du syst√®me de front-office; </li><li>  Pour cet article, √† partir des r√©sultats de recherche, obtenez l'achat, le prix de vente, un certain nombre de valeurs suppl√©mentaires; </li><li>  Traiter les donn√©es collect√©es dans Excel pour cr√©er le prix final du produit; </li><li>  Transf√©rez les prix dans le syst√®me. </li><li>  Le d√©chargement et le chargement de donn√©es ult√©rieur par jour ont pris environ 3 heures. </li></ul><br>  √âtant donn√© que ma copine n'avait pas de connaissances en programmation, il fallait faire un outil avec une interface simple et famili√®re sous forme de fonctions dans Excel.  Les s√©quences d'actions doivent √™tre d√©finies simplement comme une s√©quence de fonctions.  En un mot, <b>KISS</b> . <br><br>  Sur la base de ce cas, j'ai form√© les exigences fonctionnelles suivantes: <br><br><ul><li>  Contr√¥lez la souris (d√©placement, frappe) pour mettre en surbrillance les √©l√©ments correspondants √† l'√©cran; </li><li>  Simulez une frappe sur le clavier pour saisir des donn√©es; </li><li>  Transf√©rer des donn√©es d'Excel vers des applications tierces; </li><li>  R√©cup√©ration des donn√©es d'une application dans Excel; </li><li>  Effectuer les m√™mes op√©rations lors de l'extraction d'une formule dans Excel. </li></ul><br><h3>  La souris et les premi√®res difficult√©s </h3><br>  Avant de d√©placer le curseur n'importe o√π, vous devez savoir exactement o√π le d√©placer.  Il me semble le plus appropri√© dans cette situation de se souvenir simplement de la position du curseur lorsqu'il se trouve sur un certain √©l√©ment.  Afin de m√©moriser les coordonn√©es, j'ai utilis√© la fonction GetCursorPos de la biblioth√®que user32. <br><br>  Eh bien, nous avons obtenu les coordonn√©es, maintenant ce serait bien de s'en souvenir.  Eh bien, il n'y a rien de compliqu√©, je pensais, il suffit de compter une ou deux cellules de la cellule active et d'√©crire les coordonn√©es X et Y. Cependant, ActiveCell.Offset (0, 1) .Value = x n'a pas fonctionn√©.  La valeur n'a pas chang√©.  Et √† la suite de l'ex√©cution, une erreur.  Apr√®s avoir v√©rifi√© diverses hypoth√®ses, il s'est av√©r√© que la modification de la valeur sur la feuille entra√Æne un recomptage de la feuille enti√®re, et donc la formule qui provoque ce recomptage.  Afin de contourner cette restriction, au lieu d'appeler directement √† partir de la fonction de certaines actions, il a fallu remplacer ces appels par Evaluer, ce qui nous a permis d'obtenir le r√©sultat souhait√©. <br><br>  Le r√©sultat a √©t√© la fonction PrintCursorPosition (), qui a enregistr√© dans deux cellules √† droite la position du curseur au moment o√π la fonction a √©t√© ex√©cut√©e.  Il √©tait n√©cessaire de taper PrintCursorPosition () dans la zone de saisie des formules, de d√©placer le curseur et d'appuyer sur Entr√©e sur le clavier. <br><br>  Pour d√©placer la souris, j'ai utilis√© SetCursorPos de la m√™me biblioth√®que user32.  Pour utiliser cette fonction, il lui fallait passer la valeur des coordonn√©es x et y qui lui √©taient pr√©c√©demment stock√©es en entr√©e.  En utilisant SetCursorPosition (x, y), j'ai pu d√©placer le curseur sur les coordonn√©es pr√©c√©demment enregistr√©es.  Le premier r√©sultat visible.  Hourra! <br><br>  Pour simuler les actions de la souris, j'ai utilis√© mouse_event de la m√™me biblioth√®que user32.  En passant les drapeaux des touches √† l'entr√©e, j'ai pu simuler les frappes des touches correspondantes.  Initialement, j'avais pr√©vu d'√©crire une fonction MouseButtonPrees (flag), o√π flag est la d√©signation de la touche enfonc√©e, mais apr√®s la premi√®re d√©monstration, la fille s'est rendu compte qu'il valait mieux remplacer le groupe de fonctions LeftClick (), RightClick () et DoubleClick ().  Cette approche facilite la lecture de la fonction r√©sultante. <br><br><h3>  Clavier </h3><br>  Dans VBA, il existe une instruction SendKeys qui effectue toutes les actions n√©cessaires.  Le texte est facilement transmis √† la fonction par r√©f√©rence √† la cellule et s'ex√©cute sans probl√®me.  Cependant, le fait d'appuyer sur des touches sp√©ciales (Entr√©e, Tabulation, Alt, Ctrl, fl√®ches du clavier, etc.) provoquait un rejet (pour les appuyer, il fallait les √©crire entre accolades {ENTREE}).  Par cons√©quent, pour les plus utilis√©es, j'ai √©crit des fonctions comme PressEnter ().  Pour ceux rarement utilis√©s, j'ai cr√©√© une feuille de triche dans le m√™me document. <br><br>  Les informations ont √©t√© transf√©r√©es entre le syst√®me et Excel via une copie dans le tampon et un collage √† partir du tampon.  La copie dans le tampon a √©t√© essentiellement r√©alis√©e en simulant en appuyant sur Control + C, apr√®s quoi les donn√©es du tampon ont √©t√© transf√©r√©es vers MSForms.DataObject et transf√©r√©es vers une cellule sp√©cifique. <br><br><h3>  Probl√®mes de test et de performances </h3><br>  Les probl√®mes ont commenc√© tout de suite. <br><br>  Le processus d'√©criture d'une s√©quence de scripts d'actions consiste √† √©laborer de petits groupes d'actions et √† les combiner en un seul.  Mais lors du passage √† une cellule libre, la s√©quence enti√®re a √©t√© imm√©diatement √©labor√©e, ce qui √©tait extr√™mement ennuyeux, surtout si le temps n√©cessaire au groupe d'actions prenait plus de 10 secondes.  Pour r√©soudre ce probl√®me, j'ai v√©rifi√© la pr√©sence dans le texte de la formule de la cellule active du nom de la fonction.  √áa a aid√©. <br><br>  De plus, pendant les tests, il a ajout√© la fonction d'attente WaitS (secondes) et WaitMS (millisecondes), afin de garder une trace de ce qui fonctionnait et de ce qui ne fonctionnait pas.  Il est bas√© sur Sleep de la biblioth√®que kernel32.  La diff√©rence entre WaitS et WaitMS est qu'en WaitMS, le temps est en millisecondes et en WaitS en secondes. <br><br>  Un autre probl√®me √©tait l'ex√©cution incoh√©rente des fonctions lors de leur insertion dans les cellules.  Cela √©tait d√ª au calcul asynchrone d'Excel.  Il a distribu√© le calcul de chaque cellule √† diff√©rents processeurs.  En cons√©quence, la s√©quence est d'abord ex√©cut√©e dans la cellule deux, puis dans la cinqui√®me, puis dans la troisi√®me, etc.  De plus, les s√©quences elles-m√™mes ont √©t√© r√©alis√©es du d√©but √† la fin sans aucun probl√®me.  Afin de se d√©barrasser de ce comportement, j'ai d√©sactiv√© les calculs multithread dans les param√®tres Excel (Param√®tres Excel -&gt; Avanc√© -&gt; Formules). <br><br><h3>  R√©sultats </h3><br>  Apr√®s avoir expliqu√© comment travailler avec tout cela et appris √† l'utiliser, il a lib√©r√© sa petite amie pour automatiser les processus de l'entreprise d'une mani√®re si ingrate. <br><br>  Gr√¢ce √† une telle automatisation, il s'est av√©r√© r√©duire le temps de trois heures √† 30 minutes.  Dans le m√™me temps, l'automatisation a permis de modifier l√©g√®rement l'approche du processus de t√©l√©chargement et de t√©l√©chargement des donn√©es.  Maintenant, le d√©chargement a lieu au moment o√π ma copine part pour le d√©jeuner et le chargement la nuit.  Ainsi, nous pouvons dire que la charge a diminu√© de pr√®s de la moiti√© de la journ√©e de travail, ce qui a permis √† ma petite amie de rentrer chez elle √† l'heure et nous pouvons faire des choses plus int√©ressantes que l'automatisation. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr447346/">https://habr.com/ru/post/fr447346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr447334/index.html">Un exemple de strat√©gie de contenu pour la promotion d'un magasin de pi√®ces d'armes en ligne</a></li>
<li><a href="../fr447336/index.html">Surveillance des ressources du cluster Kubernetes</a></li>
<li><a href="../fr447338/index.html">Stage d'√©t√© Intel 0x7E3 en attente des √©tudiants</a></li>
<li><a href="../fr447342/index.html">Pyramides non-Mars: √©tude de la forme des amas nanocristallins sous une couche de graph√®ne</a></li>
<li><a href="../fr447344/index.html">Nouvelles fonctionnalit√©s dans Webmaster</a></li>
<li><a href="../fr447348/index.html">Une √©tude de la connectivit√© des monnaies mondiales √† travers la corr√©lation des taux absolus</a></li>
<li><a href="../fr447350/index.html">Meetup Robot Operating System Russian 2019</a></li>
<li><a href="../fr447352/index.html">Analyse: quelles sont les expressions redondantes en anglais</a></li>
<li><a href="../fr447354/index.html">Une m√©thode universelle pour r√©soudre les probl√®mes sur l'exemple du puzzle "12 pi√®ces, 3 pes√©es"</a></li>
<li><a href="../fr447356/index.html">Top 3D Expo: Impression 3D en auto-r√©glage, Artem Solomnikov, Mentions l√©gales</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>