<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ú üëÉüèæ ‚ùî Greenplum 6: revue des nouvelles fonctionnalit√©s üê∑ üë±üèø üë©üèΩ‚ÄçüöÄ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Au cours des 16 derni√®res ann√©es, Greenplum, un SGBD ouvert et massivement parall√®le, a aid√© diverses entreprises √† prendre des d√©cisions bas√©es sur l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Greenplum 6: revue des nouvelles fonctionnalit√©s</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/474008/"><img src="https://habrastorage.org/webt/or/nu/hq/ornuhqed9rwdzvwmfwgodnf7kia.png" alt="image" width="150" align="left">  Au cours des 16 derni√®res ann√©es, Greenplum, un SGBD ouvert et massivement parall√®le, a aid√© diverses entreprises √† prendre des d√©cisions bas√©es sur l'analyse des donn√©es. <br><br>  Pendant ce temps, Greenplum a p√©n√©tr√© dans divers domaines d'activit√©, notamment: la vente au d√©tail, la fintech, les t√©l√©communications, l'industrie, le commerce √©lectronique.  Mise √† l'√©chelle horizontale de centaines de n≈ìuds, tol√©rance aux pannes, code open source, compatibilit√© totale avec PostgreSQL, transactionnalit√© et ANSI SQL - il est difficile d'imaginer une meilleure combinaison de propri√©t√©s pour un SGBD analytique.  Partant d'√©normes grappes dans des soci√©t√©s g√©antes mondiales, telles que Morgan Stanley (200 n≈ìuds, 25 Pb de donn√©es) ou Tinkoff (&gt; 70 n≈ìuds), et se terminant par de petites installations √† deux n≈ìuds dans des startups confortables, de plus en plus d'entreprises choisissent Greenplum.  Il est particuli√®rement agr√©able d'observer cette tendance en Russie - au cours des deux derni√®res ann√©es, le nombre de grandes entreprises nationales utilisant Greenplum a tripl√©. <br><br>  √Ä l'automne 2019, une autre version majeure du SGBD a √©t√© publi√©e.  Dans cet article, je parlerai bri√®vement des principales nouvelles fonctionnalit√©s de GP 6. <br><a name="habracut"></a><br>  La pr√©c√©dente version majeure de Greenplum version 5 a √©t√© publi√©e en septembre 2017, les d√©tails peuvent √™tre trouv√©s dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet article</a> .  Si vous ne savez toujours pas ce qu'est Greenplum, une br√®ve introduction peut √™tre obtenue √† partir de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cet article</a> .  Il est ancien, mais l'architecture du SGBD se refl√®te correctement. <br><br>  La version actuelle, de droit, peut √™tre qualifi√©e d'id√©e collective: plusieurs soci√©t√©s du monde entier ont particip√© au d√©veloppement - parmi lesquelles Pivotal, Arenadata (o√π travaille l'auteur de cet article), Alibaba. <br><br>  Alors quoi de neuf dans Greenplum 6? <br><br><h4>  Tables r√©pliqu√©es </h4><br>  Permettez-moi de vous rappeler que dans Greenplum, il y avait deux types de distribution de tables √† travers un cluster: <br><br><ul><li>  Distribution uniforme al√©atoire </li><li>  Distribution sur un ou plusieurs domaines </li></ul><br>  Dans la plupart des cas, la jonction de deux tables (JOIN) a √©t√© effectu√©e avec une redistribution des donn√©es entre les segments de cluster pendant l'ex√©cution de la requ√™te, et uniquement si les deux tables ont √©t√© initialement distribu√©es par la cl√© de jointure JOIN s'est produite localement sur les segments sans transf√©rer de donn√©es entre les segments. <br><br>  GP 6 offre aux architectes un nouvel outil d'optimisation des sch√©mas de stockage - des tables r√©pliqu√©es.  Ces tables sont dupliqu√©es en totalit√© sur tous les segments du cluster.  Toute connexion √† une telle table sur le c√¥t√© droit sera effectu√©e localement, sans redistribution des donn√©es.  Fondamentalement, la fonctionnalit√© est destin√©e au stockage de r√©pertoires volumineux. <br><br><div class="spoiler">  <b class="spoiler_title">Exemple de requ√™te avec table r√©pliqu√©e</b> <div class="spoiler_text"><pre><code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> expand_replicated ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">DISTRIBUTED</span></span> REPLICATED; <span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> expand_random ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">DISTRIBUTED</span></span> RANDOMLY; <span class="hljs-keyword"><span class="hljs-keyword">explain</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> expand_rnd a2 <span class="hljs-keyword"><span class="hljs-keyword">left</span></span> <span class="hljs-keyword"><span class="hljs-keyword">join</span></span> expand_replicated a3 <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> a2.gen = a3.gen <span class="hljs-comment"><span class="hljs-comment">#  ,    redistribute/broadcast Limit (cost=0.00..1680.04 rows=1 width=22) -&gt; Gather Motion 144:1 (slice1; segments: 144) (cost=0.00..1680.04 rows=2 width=22) -&gt; Hash Left Join (cost=0.00..1680.04 rows=1 width=22) Hash Cond: (expand_rnd.gen = expand_replicated.gen) -&gt; Seq Scan on expand_rnd (cost=0.00..431.00 rows=1 width=10) -&gt; Hash (cost=459.60..459.60 rows=2000000 width=12) -&gt; Seq Scan on expand_replicated (cost=0.00..459.60 rows=2000000 width=12)</span></span></code> </pre> <br></div></div><br><h4>  Algorithme de compression Zstandard (ZSTD) </h4><br>  Pr√©sent√© en 2016 par les d√©veloppeurs de Facebook, l'algorithme de compression sans perte a presque imm√©diatement touch√© le c≈ìur de notre √©quipe Arenadata, car compar√© √† Zlib (utilis√© par d√©faut dans Greenplum), il a des taux de compression plus √©lev√©s avec moins de temps requis pour la compression et la d√©compression: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/q4/kv/bf/q4kvbf5hnif4yay7khzxcl2q0hu.png" width="500"></div><br>  <i>Source: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">cnx-software.com</a></i> <br><br>  L'efficacit√© de la compression est l'un des param√®tres les plus importants du SGBD analytique moderne.  En fait, cela vous permet de r√©duire la charge sur le sous-syst√®me de disques relativement cher du cluster en chargeant des CPU relativement bon march√©.  Lors de la lecture et de l'√©criture s√©quentielles de grandes quantit√©s de donn√©es, cela donne une forte r√©duction du TCO du syst√®me. <br><br>  En 2017, notre √©quipe a ajout√© la prise en charge ZSTD pour les tables de colonnes dans Greenplum, cependant, selon la politique de publication, cette r√©vision n'a pas √©t√© introduite dans les versions mineures officielles de Greenplum.  Jusqu'√† aujourd'hui, il n'√©tait disponible que pour les clients commerciaux d'Arenadata, et avec la version 6.0, tout le monde peut l'utiliser. <br><br><h4>  Optimisation de l'expansion du cluster (d√©velopper) </h4><br>  Dans les versions pr√©c√©dentes de GP, l'expansion de cluster horizontale (ajout de nouveaux n≈ìuds) avait certaines limites: <br><br><ul><li>  M√™me si la redistribution des donn√©es s'est produite en arri√®re-plan sans interruption, un red√©marrage du syst√®me √©tait n√©cessaire lors de l'ajout de nouveaux n≈ìuds </li><li>  L'algorithme de hachage et de distribution des donn√©es n√©cessitait une redistribution compl√®te de toutes les tables pendant l'expansion - le processus de distribution des donn√©es en arri√®re-plan pouvait prendre des heures, voire des jours, pour des clusters particuli√®rement importants. </li><li>  Lors de la distribution en arri√®re-plan des tables, toute jointure √©tait uniquement distribu√©e </li></ul><br>  Greenplum 6 a introduit un tout nouvel algorithme d'extension de cluster, gr√¢ce auquel: <br><br><ul><li>  L'extension se produit maintenant sans red√©marrer le syst√®me - aucun temps d'arr√™t n'est n√©cessaire </li><li>  L'algorithme de hachage coh√©rent vous permet de redistribuer uniquement une partie des blocs lors de l'ajout de n≈ìuds, c'est-√†-dire que la redistribution en arri√®re-plan des tables fonctionne beaucoup plus rapidement </li><li>  La logique de changement des r√©pertoires syst√®me a chang√© - maintenant, m√™me pendant le processus d'expansion, toutes les connexions (JOIN) fonctionnent comme d'habitude - √† la fois localement et distribu√©es </li></ul><br>  Maintenant, l'extension Greenplum est une question de minutes, pas d'heures, cela permettra aux clusters de suivre l'app√©tit toujours croissant des unit√©s commerciales. <br><br><h4>  S√©curit√© au niveau des colonnes </h4><br>  Il est maintenant possible de distribuer des droits sur des colonnes sp√©cifiques dans les tables (la fonctionnalit√© est venue de PostgreSQL): <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">grant</span></span> all (column_name) <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> public.table_name <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> gpadmin;</code> </pre> <br><h4>  Jsonb </h4><br>  Le stockage binaire et optimal des objets de type JSON est d√©sormais disponible dans le GP.  En savoir plus sur le format <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h4>  Explication automatique </h4><br>  Une autre grande extension qui est venue au GP de PostgreSQL.  Il a √©t√© modifi√© pour fonctionner en mode distribu√© sur le cluster Greenplum par l'√©quipe d'Arenadata. <br><br>  Permet automatiquement √† chaque demande (ou prise s√©par√©ment) dans le SGBD d'enregistrer des informations sur: <br><br><ul><li>  plan de demande; </li><li>  les ressources consomm√©es √† chaque √©tape de l'ex√©cution de la requ√™te sur chaque segment (n≈ìud); </li><li>  le temps pass√©; </li><li>  le nombre de lignes trait√©es √† chaque √©tape de la requ√™te sur chaque segment (n≈ìud). </li></ul><br><h4>  Diskquota </h4><br>  Extension PostgreSQL qui vous permet de limiter le stockage sur disque disponible pour les utilisateurs individuels et les sch√©mas: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">select</span></span> diskquota.set_schema_quota(<span class="hljs-string"><span class="hljs-string">'schema_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'1 MB'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> diskquota.set_role_quota(<span class="hljs-string"><span class="hljs-string">'user_name'</span></span>, <span class="hljs-string"><span class="hljs-string">'1 MB'</span></span>);</code> </pre> <br><h3>  Nouvelles fonctionnalit√©s de distribution Arenadata DB </h3><br>  <i>Avis de non-responsabilit√© - il y aura quelques lignes de publicit√© √† c√¥t√©</i> :) <br><br>  Permettez-moi de vous rappeler que nous, Arenadata, d√©veloppons, impl√©mentons et soutenons notre plate-forme de stockage de donn√©es bas√©e sur des technologies open source - Greenplum, Kafka, Hadoop, Clickhouse.  Nos clients sont les plus grandes entreprises russes dans les domaines de la vente au d√©tail, des t√©l√©communications, des technologies financi√®res et autres.  D'une part, nous contribuons eux-m√™mes aux projets open source (en apportant des modifications au noyau), d'autre part, nous d√©veloppons des fonctionnalit√©s suppl√©mentaires qui ne sont disponibles que pour nos clients commerciaux.  Plus loin, nous parlerons des principales caract√©ristiques. <br><br><h4>  Tkhemali Connector aka Connector Greenplum -&gt; Clickhouse </h4><br>  Dans les projets, nous utilisons souvent le bouquet Greenplum + Clickhouse - d'une part, cela nous permet d'utiliser les meilleurs mod√®les classiques de construction d'entrep√¥ts de donn√©es (des sources aux data marts) qui n√©cessitent de nombreuses connexions, une syntaxe SQL ANSI d√©velopp√©e, la transactionnalit√© et d'autres puces que Greenplum poss√®de, d'autre part, pour donner acc√®s √† de grandes vitrines int√©gr√©es avec une vitesse maximale √† un nombre important d'utilisateurs - et Clickhouse n'a pas de concurrents dans ce domaine. <br><br>  Pour utiliser efficacement un tel bundle, nous avons d√©velopp√© un connecteur parall√®le sp√©cial qui, de mani√®re transactionnelle (c'est-√†-dire coh√©rent m√™me dans le cas d'une transaction de restauration) vous permet de transf√©rer des donn√©es du GP vers KH.  En g√©n√©ral, l'architecture de ce connecteur m√©rite un article purement technique distinct - en fait, √† l'int√©rieur, nous avons d√ª impl√©menter des files d'attente asynchrones parall√®les avec un syst√®me pour s√©lectionner dynamiquement le nombre de threads par insert et le flux de donn√©es. <br><br>  Le r√©sultat est une vitesse d'interaction fantastique: dans nos tests sur des disques SATA typiques, nous obtenons jusqu'√† 1 Gb / s par insert sur une paire de serveurs Greenplum - Clickhouse.  √âtant donn√© que le cluster GP moyen de nos clients comprend plus de 20 serveurs, la vitesse d'interaction est plus que suffisante. <br><br><h4>  Connecteur Kafka </h4><br>  Nous avons fait de m√™me avec l'int√©gration avec le courtier de messages Kafka - nous rencontrons souvent la t√¢che de surcharger les donn√©es de Kafka vers Greenplum en mode quasi-temps r√©el (secondes ou dizaines de secondes).  Cependant, l'architecture du connecteur pour Kafka est diff√©rente.  Un connecteur est un cluster de processus synchronis√©s s√©par√©s (lanc√©s dans Docker) avec d√©tection automatique, qui, d'une part, sont des consommateurs Kafka, et d'autre part, ins√®rent des donn√©es directement dans les segments Greenplum.  Le connecteur peut fonctionner avec Kafka Registry et garantit la coh√©rence compl√®te des donn√©es transf√©r√©es m√™me en cas de panne mat√©rielle. <br><br><h4>  Syst√®me de gestion et de suivi </h4><br>  Le fonctionnement du syst√®me en production impose des exigences √©lev√©es sur le d√©ploiement, la mise √† jour et la surveillance du cluster.  Il est important que tout ce qui se passe dans le SGBD soit transparent pour les op√©rations et les sp√©cialistes DBA. <br><br>  Notre syst√®me de gestion et de surveillance Arenadata Cluster Manager (ADCM) offre aux professionnels de l'exploitation tous les outils dont ils ont besoin.  En fait, le d√©ploiement et la mise √† jour du cluster Greenplum se fait en un clic sur un bouton de l'interface graphique (tous les OS, services, montage de disque et param√®tres r√©seau se font automatiquement), en plus, vous obtenez une pile de surveillance enti√®rement configur√©e, pr√™te √† s'int√©grer √† vos syst√®mes d'entreprise.  Soit dit en passant, Arenadata Cluster Manager peut g√©rer non seulement Greenplum, mais aussi Hadoop, Kafka, Clickhouse (nos assemblages de ces services sont requis. Leurs versions gratuites, comme ADCM lui-m√™me, peuvent √™tre t√©l√©charg√©es gratuitement sur notre <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">site Web</a> , simplement en remplissant une fen√™tre contextuelle). <br><br><h4>  Conclusion </h4><br>  Si vous utilisez Greenplum 5.X, je vous recommande d'envisager la mise √† niveau de votre cluster vers la version actuelle 6.X dans les 2-3 prochains mois. <br><br>  Si vous n'utilisez pas encore Greenplum, rejoignez-nous!  Nous, Arenadata, sommes toujours pr√™ts √† vous aider. <br><br><h4>  Les r√©f√©rences </h4><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Greenplum sur github</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Greenplum Russia Telegram channel</a> - posez vos questions directement aux utilisateurs de Greenplum <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Documentation de Greenplum 6</a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr474008/">https://habr.com/ru/post/fr474008/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr473992/index.html">Aper√ßu des protocoles modernes dans les syst√®mes d'automatisation industrielle</a></li>
<li><a href="../fr473994/index.html">Chargement de script moderne</a></li>
<li><a href="../fr473998/index.html">Pays-Bas, ou aller-retour</a></li>
<li><a href="../fr474000/index.html">IQBX - concepteur √©lectrom√©canique pour les cercles et les amateurs de bricolage [id√©e conceptuelle]</a></li>
<li><a href="../fr474004/index.html">De Norilsk √† Riyad: un vrai cas pour les cartes m√©moire microSD UHS-I √† temp√©rature industrielle de Kingston</a></li>
<li><a href="../fr474012/index.html">S√©curit√© pour les conteneurs Docker</a></li>
<li><a href="../fr474014/index.html">Comment les procurations aident dans la promotion de sites Web: cas d'utilisation r√©els, probl√®mes et solutions</a></li>
<li><a href="../fr474016/index.html">√âcrivains sur ... √âcrivains sur ... √âcrivains, prod, ou comment la science-fiction a disparu et rena√Æt en Russie</a></li>
<li><a href="../fr474018/index.html">Fatigue de l'asphalte: comment la sant√© des infrastructures routi√®res est surveill√©e</a></li>
<li><a href="../fr474020/index.html">Comment Methodius est devenue Anna: l'exp√©rience du d√©veloppement et du lancement de classificateurs de messages vocaux. 3e partie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>