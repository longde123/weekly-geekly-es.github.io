<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‹ ğŸ‘©ğŸ¾â€ğŸŒ¾ ğŸ†™ TÃ©lÃ©commande Web UART ğŸ§˜ğŸ¿ ğŸ‘¨â€âœˆï¸ âš’ï¸</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="CommenÃ§ons par le fer 
 J'ai travaillÃ© une fois dans une usine, oÃ¹ ils ont sculptÃ© toutes sortes d'appareils Ã©lectroniques, pas trÃ¨s compliquÃ©s, et to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>TÃ©lÃ©commande Web UART</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/440466/"><h2>  CommenÃ§ons par le fer </h2><br><img src="https://www.dataweek.co.za/articles/Dataweek%20-%20Published%20by%20Technews/18EMPESG21.jpg" alt="image" align="left">  J'ai travaillÃ© une fois dans une usine, oÃ¹ ils ont sculptÃ© toutes sortes d'appareils Ã©lectroniques, pas trÃ¨s compliquÃ©s, et tombant parfois sous la dÃ©finition d 'Â«Internet des objetsÂ».  Pour la plupart, toutes sortes de capteurs pour les systÃ¨mes de sÃ©curitÃ©: fumÃ©e, bruit, pÃ©nÃ©tration, incendie, etc.  L'assortiment de produits Ã©tait large, les lots Ã©taient parfois infÃ©rieurs Ã  500 piÃ¨ces, et presque pour chaque produit, je devais faire un dispositif de test sÃ©parÃ© - en fait, juste une boÃ®te en fer blanc dans laquelle le produit a Ã©tÃ© testÃ©, pressÃ© par un couvercle et, par en dessous, des aiguilles de contact ont Ã©tÃ© pressÃ©es contre des points de contact sur une carte de circuit imprimÃ©, quelque chose comme ceci: <br><a name="habracut"></a><br>  Ainsi, il Ã©tait possible de communiquer physiquement avec l'appareil.  Le protocole de communication que nous avions Ã©tait assez courant dans l'industrie - RS232 (port COM, un type d'UART).  Toutes sortes de dispositifs contrÃ´lÃ©s simples pour tester le produit final ont Ã©galement Ã©tÃ© mis dans la boÃ®te.  Toutes ces instrumentations auxiliaires Ã©taient contrÃ´lÃ©es de la mÃªme maniÃ¨re.  Toute la structure Ã©tait trÃ¨s fragile et toutes sortes de problÃ¨mes faisaient partie de la routine quotidienne. <br><br>  La gamme de problÃ¨mes Ã©tait trÃ¨s large - mauvais contacts, inversion de la polaritÃ© lors de l'installation, problÃ¨mes avec le produit testÃ©, avec les appareils de contrÃ´le et de mesure, avec les aiguilles de contact, avec le code de test ... mais on ne sait jamais!  Mais il Ã©tait nÃ©cessaire de tester en permanence, et si les tests commenÃ§aient Ã  Â«roulerÂ» quelque part, l'un des ingÃ©nieurs devait piÃ©tiner la ligne et commencer Ã  tout vÃ©rifier manuellement. <br><br>  Tout d'abord, Docklight a Ã©tÃ© lancÃ© - un bon utilitaire pour Â«communiquerÂ» via les ports COM, mais il avait beaucoup de limitations.  Et nous approchons ici de l'essence de la question. <br><br><h2>  Pourquoi Docklight ne me convenait pas? </h2><br>  Eh bien, allons-y. <br><br><ul><li>  Le premier problÃ¨me est que Docklight <b>ne</b> fonctionne que sur Windows.  Ainsi, l'installation du "centre nerveux" sous la forme de RaspberryPi, qui connecterait tous les appareils, ou quelque chose comme Ã§a, pourrait Ãªtre oubliÃ©e.  J'ai dÃ» installer NUC - la solution la moins chÃ¨re dans cette situation.  Lourd, plutÃ´t grand et pas le moins cher.  Soit dit en passant, lorsque ces montages de test ont Ã©tÃ© traÃ®nÃ©s d'un endroit Ã  l'autre, les NUC se sont beaucoup battus (bien que j'avoue que leur conception est assez solide). <br></li><li>  Le deuxiÃ¨me - l'accÃ¨s Ã  distance ne pouvait Ãªtre effectuÃ© que par le biais du partage de bureau - il a Ã©tÃ© ralenti mÃªme par le biais du rÃ©seau local, et mÃªme par Internet, il Ã©tait complÃ¨tement boiteux. <br></li><li>  TroisiÃ¨mement, chaque appareil avait son propre ensemble de commandes, et Docklight pouvait charger un fichier avec une liste de commandes.  Si, par exemple, vous deviez partager une liste similaire avec quelqu'un du dÃ©partement, alors envoyez un e-mail avec le fichier ou ... envoyez un lien vers le fichier dans le dossier partagÃ©!  Naturellement, chaque installation Docklight nÃ©cessitait de tels fichiers localement, et tout cela devait Ãªtre fait des dizaines (voire des centaines de fois) manuellement - pour chaque NUC, chaque ingÃ©nieur faisait glisser ses listes de commandes prÃ©fÃ©rÃ©es et pratiques.  Et dans la cour 2019, permettez-moi de vous rappeler ... <br></li><li>  QuatriÃ¨mement, Docklight ne vous permet pas d'associer automatiquement un port COM Ã  un nom de pÃ©riphÃ©rique: par exemple, Windows, lorsque vous connectez l'alimentation, communiquera avec le pÃ©riphÃ©rique via COM12.  Si vous voulez Â«tirer les chaÃ®nesÂ» manuellement, alors dans Docklight vous devez ouvrir COM12.  Comment pouvons-nous savoir qu'il s'agit uniquement de l'alimentation et non, disons, de SwitchBoard?  Eh bien, vous pouvez consulter le gestionnaire de pÃ©riphÃ©riques Ã  chaque fois et essayer de ne pas oublier quel pÃ©riphÃ©rique est connectÃ© Ã  quel port.  En mÃªme temps, personne ne garantit que si vous retirez simplement l'appareil puis le rebranchez, le port prÃ©cÃ©dent restera avec cet appareil.  Bref, chaque fois que vous devez le faire manuellement.  Et croyez-moi, Ã  la fin de la journÃ©e, ma tÃªte en tournait. <br></li><li>  CinquiÃ¨mement, chaque port avait besoin d'une copie distincte du programme et, bien sÃ»r, toutes les opÃ©rations devaient Ãªtre effectuÃ©es individuellement pour chaque pÃ©riphÃ©rique, et bien que Docklight prenne en charge les scripts, il n'y a pas d'interaction entre les instances individuelles. <br><br>  Ensuite.  Aucune intÃ©gration avec aucun autre produit n'a Ã©tÃ© fournie.  Cela semble Ãªtre une bagatelle, mais voici une situation oÃ¹ il a chauffÃ© Ã  blanc: le test est tombÃ©, et nous devons comprendre pourquoi.  Tout d'abord, vous devez vous connecter aux appareils et voir s'ils sont morts du tout.  Nous allons au gestionnaire de pÃ©riphÃ©riques, regardons sur quel port se trouve notre appareil, ouvrons Docklight, initions la communication avec notre port ... Erreur.  Merde!  J'ai oubliÃ© d'arrÃªter le service installÃ© sur le NUC et conserve tous les ports.  Exclusif, vous savez.  D'accord, nous ralentissons le service, ouvrons le port, chargeons le fichier avec les commandes de l'appareil, envoyons les commandes, nous obtenons (ou n'obtenons pas) les rÃ©ponses, nous rÃ©solvons le problÃ¨me.  Nous relanÃ§ons le test, il se bloque Ã  nouveau ... Oh, bon sang, j'ai oubliÃ© de fermer Docklight et de redÃ©marrer le service.  Tout semble Ãªtre sans erreur.  Mais c'est pour les deux prochaines heures, jusqu'Ã  ce que quelque chose se passe de nouveau.  Et croyez-moi, il Ã©tait nÃ©cessaire de rÃ©soudre ces problÃ¨mes plus souvent que nous le souhaiterions. <br></li></ul><br>  Eh bien, et bien sÃ»r, Ã  propos des extensions, ajoutez.  il ne pourrait pas y avoir de fonctionnalitÃ©s ou similaires - le produit est fermÃ©, Ã©crit depuis longtemps (il semble qu'ils ne soient plus spÃ©cialement dÃ©veloppÃ©s), il n'y a pas de personnalisation. <br><br>  Eh bien, j'ai dÃ©cidÃ© de faire quelque chose de mien, mais de corriger (ou d'amÃ©liorer) la situation avec les problÃ¨mes dÃ©crits. <br>  Il s'est avÃ©rÃ© quelque chose comme Zabbix, mais avec un affÃ»tage pour une situation spÃ©cifique. <br><br><h2>  Quelle est donc la diffÃ©rence? </h2><br>  Il est peut-Ãªtre judicieux de commencer par une description gÃ©nÃ©rale de l'architecture, puis d'entrer dans les dÃ©tails. <br><br>  Le schÃ©ma ressemble Ã  ceci: <br><br><img src="https://habrastorage.org/webt/qi/hh/b-/qihhb-c1wgigm6yd1vb92vayzhm.png"><br><br>  Nous avons un agent qui fonctionne Ã  la station Ã  laquelle nos appareils sont physiquement connectÃ©s.  L'agent a Ã©tÃ© Ã©crit en Python, donc il fonctionne sans problÃ¨me sous Windows, Linux, et vous pouvez le terminer en toute sÃ©curitÃ© pour une utilisation sur RaspberryPi et appareils similaires.  Le programme est extrÃªmement peu exigeant en termes de ressources et trÃ¨s stable.  L'agent est constamment connectÃ© via le Websocket au serveur (back-end) et reÃ§oit tous les paramÃ¨tres de port et leurs paramÃ¨tres Ã  partir de lÃ , Ã  la fois pendant l'initialisation et pendant les mises Ã  jour.  L'agent a sa propre interface graphique pour les paramÃ¨tres et la surveillance dans ce cas (peut-Ãªtre que la connexion a Ã©tÃ© perdue, peut-Ãªtre que la licence a expirÃ©). <br><br><img src="https://habrastorage.org/webt/j0/-s/dl/j0-sdl9tw0wqkfltjf_btcxsr_k.png"><br><br>  Ensuite.  Le serveur (alias le back-end) provient du docker (et fonctionne donc simplement non seulement sur amazon ou Google Cloud, mais Ã©galement sur toute machine pas si puissante sur un LAN avec Linux Ã  bord).  Il est Ã©crit en Django en collaboration avec Redis (pour supporter les websockets).  Il stocke tous les paramÃ¨tres et assure la communication entre l'interface utilisateur graphique (juste une page Ã©crite en ReactJS) et via l'agent - avec nos appareils.  Communication bidirectionnelle, entiÃ¨rement asynchrone.  Tous les paramÃ¨tres sont stockÃ©s dans Postgres et Mongo. <br><br>  Eh bien, et, peut-Ãªtre, la partie la plus importante du systÃ¨me est le client lui-mÃªme (simplement, une page dans un navigateur, Ã©crite pour ReactJS pour plus de dynamisme). <br><br><img src="https://habrastorage.org/webt/ki/ck/lq/kicklqhbgajmtyevcyvh83myqxm.png"><br><br>  Oui, le design visuel est loin d'Ãªtre parfait, mais c'est rÃ©parable. <br><br>  Eh bien, cela peut Ãªtre arrondi, je n'ajouterai que quelques mots sur l'Ã©tat du projet et de la dÃ©mo. <br><br><ol><li>  Il s'agit d'un alpha assez prÃ©coce, conÃ§u pour dÃ©montrer plus probablement les Ã©quipements potentiels et vÃ©rifier le niveau d'intÃ©rÃªt. <br></li><li>  Jouez une dÃ©mo - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> <br>  Se connecter <br>  nom d'utilisateur: operator_0 <br>  mot de passe: 123456789 <br>  Nous sÃ©lectionnons QA_Test et n'importe quelle station (c'est juste une tentative de simuler la structure de l'entreprise - les ports sont connectÃ©s aux stations, ils sont divisÃ©s en dÃ©partements et chaque bureau a sa propre structure) <br></li></ol><br>  En principe, s'il y a un intÃ©rÃªt, j'ajouterai la prise en charge de https et je crÃ©erai des assemblys d'agent pour diffÃ©rentes plates-formes, ainsi que toutes les autres fonctionnalitÃ©s. <br><br>  Je me ferai un plaisir de recevoir vos commentaires et suggestions.  La critique est la bienvenue! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr440466/">https://habr.com/ru/post/fr440466/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr440454/index.html">Paul Graham: ce que j'ai appris de Hacker News</a></li>
<li><a href="../fr440458/index.html">PrÃ©diction de l'Ã©tat du rÃ©seau VoIP sur la base des fichiers journaux de texte du serveur d'applications SIP</a></li>
<li><a href="../fr440460/index.html">Comment les sept moddeurs Mount et Blade ont crÃ©Ã© un studio de jeu</a></li>
<li><a href="../fr440462/index.html">Les 7 meilleures stratÃ©gies de marketing de contenu Ã  ne pas manquer en 2019</a></li>
<li><a href="../fr440464/index.html">Travailler avec le service Digital Ocean Managed Databases dans .NET Core</a></li>
<li><a href="../fr440468/index.html">2 fois plus, 10 fois plus vite, 24 heures sur 24 - pour le bien des gens</a></li>
<li><a href="../fr440470/index.html">Incorporer un interprÃ©teur Python dans une application Java Ã  l'aide du projet Panama</a></li>
<li><a href="../fr440472/index.html">ImplÃ©mentation de modÃ¨les seq2seq dans Tensorflow</a></li>
<li><a href="../fr440474/index.html">Effets de filtrage SVG. Partie 4. Images bicolores avec feComponentTransfer</a></li>
<li><a href="../fr440476/index.html">Â«Commencez par les mitapsÂ» ou avez-vous besoin de cours de programmation?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>