<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍞 👨🏾‍🤝‍👨🏽 🐍 Kaspresso: le framework d'autotest que vous attendiez 👍🏾 🚸 🍄</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Quiconque a été ou est engagé dans des autotests Android sait à quel point c'est pénible. 
 Vous vous fatiguez du volume des tâches et des problèmes p...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Kaspresso: le framework d'autotest que vous attendiez</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/kaspersky/blog/467617/">  Quiconque a été ou est engagé dans des autotests Android sait à quel point c'est pénible. <br>  Vous vous fatiguez du volume des tâches et des problèmes pour que les vacances ne vous aident pas.  Les gens ont même arrêté à cause des autotests. <br><br>  La douleur, la souffrance et le tourment conduisent inévitablement à l'émergence de quelque chose de nouveau et de beau.  Nous avons essayé de rassembler tous les râteaux sur lesquels nous devions marcher, avons combiné nos efforts avec les gars d'Avito et de HH et avons créé quelque chose qui rendrait votre relation avec les autotests incomparablement meilleure et plus fructueuse. <br><br>  Rencontrez: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kaspresso</a> - le cadre d'autotest que vous attendiez! <br><br><img src="https://habrastorage.org/webt/dw/jh/9k/dwjh9kypjl637kxj8tiaxwjvtp0.png"><br><a name="habracut"></a><br>  Je constate tout de suite qu'il y a deux vidéos de très bonne qualité sur le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">réseau</a> dédiées à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kaspresso</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AdbServer</a> (auxiliaire pour Kaspresso, mais en même temps, un projet fort et indépendant): <br><br>  1. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Dmitry Movchan, Eugene Matsyuk - Comment commencer à écrire des autotests et ne pas devenir fou</a> <br>  2. <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Egor Kournikov - La seule chose dont vous avez besoin pour les tests d'interface utilisateur</a> <br><br>  Ils décrivent en détail l'histoire de la création de bibliothèques: comment nous sommes passés de la résolution d'un problème à la résolution d'un autre, et ce qui s'est finalement produit.  Je le recommande vivement. <br><br>  Par conséquent, dans l'article, je ne parlerai que des principaux points et puces afin que vous puissiez rapidement comprendre en quoi consiste ce cadre et quelles tâches il résout.  Et les tripes et les détails peuvent être trouvés dans la vidéo et la documentation. <br><br><h2>  Pourquoi avons-nous même besoin de notre propre cadre? </h2><br>  Chaque développeur qui commence à écrire des autotests pose inévitablement des questions: <br><br><ol><li>  Comment commencer à écrire des autotests? </li><li>  Quels outils choisir? </li><li>  Que faire s'il n'y a pas d'outil nécessaire? </li><li>  Quelles sont les meilleures pratiques? </li></ol><br>  À tout cela, ajoutez que chaque équipe essaie de résoudre ces problèmes à sa manière.  En conséquence, il n'y a pas de réponse unique, il n'y a nulle part où jeter un œil sur la façon de le faire correctement.  Par conséquent, l'écriture et la prise en charge des autotests coûtent cher aux entreprises, ce qui remet en question la faisabilité de l'automatisation en tant que telle. <br><br>  Pendant ce temps, l'automatisation des tests poursuit de bons objectifs.  Il vous permet d'avoir toujours un assistant vert et prêt à sortir.  Et cela signifie que vous pouvez déployer la version rapidement. <br>  Le seul problème est de trouver des réponses aux questions ci-dessus.  Mais ils sont presque les mêmes pour toutes les équipes.  Alors pourquoi ne pas automatiser leur solution? <br><br><h2>  Que voulons-nous du cadre? </h2><br>  Révélons un peu nos attentes du cadre. <br><br><h3>  Bonne lisibilité </h3><br>  Par défaut, seule la bibliothèque Espresso est disponible pour nous dans Android.  Il y a bien sûr Appium + Cucumber, qui en théorie vous permet d'écrire des tests sur deux plateformes à la fois.  Mais la communauté se dirige avec confiance vers le tout premier instrument.  Je ne décrirai pas tous les avantages et les inconvénients des bibliothèques ci-dessus: le réseau regorge d'informations à ce sujet.  Voici, par exemple, l'un des liens relativement récents: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Appium vs Espresso.</a>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Que choisir et comment utiliser?</a> <br><br>  Alors, Espresso.  Pas un mauvais outil, mais son api est un peu retourné.  Jetez un œil à un code simple: <br><br><pre><code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">espressoTest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { onView(allOf(allOf(withId(R.id.espresso), isDescendantOfA(withId(R.id.coffee_variates))), isDescendantOfA(withId(R.id.content)))) .check(matches(withEffectiveVisibility(View.VISIBLE))) }</code> </pre> <br>  Vous devez penser à le comprendre, non? <br><br>  Les dieux de Thaïlande et d'Australie nous ont présenté la bibliothèque <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kakao</a> , avec laquelle vous pouvez comprendre en un coup d'œil ce qui se passe dans votre test.  Voici le même code, mais avec Kakao: <br><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">kakaoTest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { mainScreen { myView.isVisible() } }</code> </pre><br>  Bien mieux.  Mais imaginez maintenant que vous avez automatisé un cas de test complet.  À quoi ressemblerait le code? <br><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith(AndroidJUnit4::class)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OpenHomeScreenTest</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TestCase</span></span></span></span>() { <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { MainScreen() { homeButton.click() } HomeScreen() { title { isVisible() hasAnyText() } } } }</code> </pre><br>  Le principal problème est que, en regardant ce test, il est difficile de le corréler avec le cas de test que vous avez automatisé.  Vous pouvez bien sûr ajouter des journaux ou quelque chose comme ça.  Ou entrez dsl, qui transforme immédiatement l'apparence de vos tests: <br><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith(AndroidJUnit4::class)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OpenHomeScreenTest</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TestCase</span></span></span></span>() { <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">fun</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { step(“<span class="hljs-number"><span class="hljs-number">1</span></span>. Open Home screen”) { MainScreen() { homeButton.click() } } step(“<span class="hljs-number"><span class="hljs-number">2</span></span>. Check Home title”) { HomeScreen() { title { isVisible() hasAnyText() } } } } }</code> </pre><br>  D'accord, ça a l'air complètement différent. <br><br><h3>  La stabilité </h3><br>  Toute bibliothèque pour ui-tests échoue.  La même action peut être effectuée 50 fois avec succès et à la 51e pause sans raison apparente.  Et à la 52e manche, tout va bien à nouveau.  Et un tel "flacking" peut décemment gâcher vos nerfs. <br><br>  Nous avons pensé, pourquoi ne pas essayer d'intercepter toutes les actions de Kakao-Espresso, et y ajouter déjà un comportement supplémentaire visant à gérer de telles erreurs aléatoires. <br><br>  C'est ainsi que la <a href="">version 2.1 de la bibliothèque Kakao est</a> née, vous permettant de vous intégrer à tous les appels Espresso. <br><br>  De plus, nous avons créé nos propres intercepteurs, avec lesquels vous pouvez modifier le comportement du cadran-pair ou, par exemple, simplement vous connecter.  De plus, ces intercepteurs sont personnalisables, vous pouvez donc les personnaliser en fonction de vos besoins.  En savoir plus dans le <a href="">dock</a> . <br><br>  Plus précisément, dans le cadre de la lutte contre les tests floconneux - si certaines de vos actions ont levé une exception, Kaspresso essaiera: <br><br><ul><li>  Faites défiler.  Peut-être que votre vue n'est tout simplement pas visible à l'écran. </li><li>  Supprimez le dialogue système qui pourrait provenir de Dieu sait où. </li><li>  Répétez un appel interrompu pendant deux secondes. </li></ul><br>  Avec ces étapes, nous résolvons complètement le problème avec des tests feuilletés! <br><br><h3>  Journalisation </h3><br>  L'un des principaux problèmes qui accompagne les autotests est le manque de journalisation intelligible, qui n'est surtout pas suffisant lorsque le test se bloque.  Asseyez-vous et demandez-vous ce qui est tombé et comment. <br><br>  Grâce à l'interception susmentionnée, nous avons pu construire un système de journalisation assez étendu. <br><br>  Prenons un exemple: <br><br><img src="https://habrastorage.org/webt/03/nn/qg/03nnqgupdqnwa_i4jwyz1uqq6r0.png"><br><br><img src="https://habrastorage.org/webt/tq/az/3v/tqaz3vjsgpw0-ivylrfbnuqyiqa.png"><br><br>  Par défaut, Kaspresso enregistre toutes vos actions, sélectionne chaque étape du test, affiche le temps d'exécution, etc. <br><br><h3>  Adb complet dans les tests Espresso </h3><br>  Initialement, adb n'est pas disponible dans les tests Espresso.  Oui, il y a <i>un shell adb</i> , mais il y a beaucoup moins de fonctions qu'en plein <i>adb</i> .  Mais il y a tellement de choses qui peuvent être utiles dans les tests. <br><br>  Nous avons créé une bibliothèque <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AdbServer</a> distincte qui retournera <i>adb</i> complet à vos tests!  La vidéo ci-dessus détaille comment nous nous sommes battus et ce que nous avons vécu pour cela ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">deux</a> ). <br><br><h3>  Travailler avec Android OS </h3><br>  Les spécificités des tests de Kaspersky Lab sont telles que nous devons beaucoup travailler avec OS Android: configurer certains paramètres, télécharger des fichiers sur le système, etc. Tout cela nous a incités à standardiser tout notre travail avec le système, à créer un ensemble d'interfaces claires, accessible via un seul <i>appareil de</i> classe point d'entrée. <br><br>  Quelles sont ces interfaces et que font-elles?  Permettez-moi de vous donner quelques diapositives de la présentation de Yegor à titre d'illustration: <br><br><img src="https://habrastorage.org/webt/ye/5w/po/ye5wpoo2z5ezglihfrlkpobobrs.png"><br><br><img src="https://habrastorage.org/webt/f-/tc/ow/f-tcowtztognmdjlaxkl9x6z9sg.png"><br><br><img src="https://habrastorage.org/webt/um/wj/te/umwjteh2qef3xv-4hw4xzkjkrh8.png"><br><br><img src="https://habrastorage.org/webt/qz/yy/qs/qzyyqsa4aeqaozts7uy367ryofw.png"><br><br>  La documentation est <a href="">ici</a> . <br><br>  Sous le capot, AdbServer et UiAutomator sont principalement utilisés. <br>  Mais!  Si vous n'êtes pas satisfait de l'implémentation d'une interface, vous pouvez définir votre implémentation via le configurateur. <br><br><h3>  Capture d'écran de DocLoc (Documentation et localisation) </h3><br>  Tous les projets où il y a une localisation, il est souvent nécessaire de prendre des captures d'écran dans différentes langues afin de les donner au traducteur comme illustrations.  Après tout, il est très difficile de faire une traduction correcte sans voir où et comment une ligne particulière est utilisée.  Par conséquent, je veux pouvoir prendre des captures d'écran rapidement et immédiatement dans toutes les langues.  Y compris des captures d'écran des boîtes de dialogue système.  Vous pouvez également avoir besoin de captures d'écran sur les écrans hérités et sans refactoring global. <br><br>  Tout cela vous permet de faire Kaspresso hors de la boîte.  En savoir plus dans la <a href="">documentation</a> . <br><br><h3>  Architecture et bonnes pratiques </h3><br>  L'une des tâches clés de Kaspresso était de créer un tel DSL qui vous pousserait vers la bonne architecture de test et leur écriture correcte. <br><br>  De nombreuses copies ont été cassées sur ce sujet, car vous ne trouverez malheureusement de telles règles nulle part.  Tout ce que vous pouvez trouver sont des articles sur l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">objet de page</a> . <br><br>  Par conséquent, nous n'avons épargné aucun effort et avons souligné ces problèmes dans la <a href="">documentation</a> , et dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vidéo une fois</a> et la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">vidéo deux</a> . <br>  De plus, Sasha Blinov a écrit un excellent <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">article sur le Kotlin DSL et les tests élégants</a> .  Les dsl décrits dans l'article sont fournis par Kaspresso. <br><br>  De retour chez Mobius, nous avons proposé une option sur la façon d'accélérer l'impact des autotests et de les intégrer rapidement dans PullRequest, en contournant les problèmes d'infrastructure inévitables.  Nous en parlons plus en détail <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> . <br><br><h3>  Comment connecter et configurer Kaspresso si vous avez déjà de nombreux tests </h3><br>  Le charme principal est que si vous avez déjà de nombreux tests écrits en Kakao et que vous souhaitez implémenter Kaspresso, vous n'avez rien à réécrire!  Héritez simplement vos classes de test de la classe spéciale TestCase.  Et c'est tout! <br><br>  C'était: <br><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith(AndroidJUnit4::class)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OpenHomeScreenTest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> mainScreen = MainScreen() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> homeScreen = HomeScreen() <span class="hljs-meta"><span class="hljs-meta">@get:Rule</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> activityTestRule = ActivityTestRule(MainActivity::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">true</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">false) @Test fun test</span></span></span></span>() { ... } }</code> </pre><br>  C'est devenu: <br><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith(AndroidJUnit4::class)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OpenHomeScreenTest</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TestCase</span></span></span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> mainScreen = MainScreen() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> homeScreen = HomeScreen() <span class="hljs-meta"><span class="hljs-meta">@get:Rule</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> activityTestRule = ActivityTestRule(MainActivity::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">true</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">false) @Test fun test</span></span></span></span>() { ... } }</code> </pre><br>  Et si vous n'aimez pas l'héritage, utilisez une classe <i>TestRule</i> similaire. <br><br>  Comme nous l'avons déjà mentionné, Kaspresso est un cadre très flexible et personnalisable.  Tous les paramètres sont disponibles via la classe <i>Kaspresso</i> du même nom. <br><br>  Le paramètre par défaut est par défaut.  Si vous souhaitez personnaliser quelque chose, cela ressemblera à ceci: <br><br><pre> <code class="kotlin hljs"><span class="hljs-meta"><span class="hljs-meta">@RunWith(AndroidJUnit4::class)</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OpenHomeScreenTest</span></span></span><span class="hljs-class"> : </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">TestCase</span></span></span></span>( Kaspresso.Builder.<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>().apply { viewBehaviorInterceptors.add(MyInterceptor()) flakySafetyParams.timeoutMs = <span class="hljs-number"><span class="hljs-number">1_000</span></span> } ) { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> mainScreen = MainScreen() <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> homeScreen = HomeScreen() <span class="hljs-meta"><span class="hljs-meta">@get:Rule</span></span> <span class="hljs-keyword"><span class="hljs-keyword">val</span></span> activityTestRule = ActivityTestRule(MainActivity::<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">java</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">true</span></span></span><span class="hljs-class">, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">false) @Test fun test</span></span></span></span>() { ... } }</code> </pre><br>  Autrement dit, <i>Kaspresso.Builder</i> est disponible via le <i>constructeur</i> <i>TestCase</i> , où vous définissez tous les paramètres dont vous avez besoin.  Les détails sur le configurateur sont écrits dans la <a href="">documentation</a> . <br><br><h2>  Plans immédiats </h2><br>  Dans un avenir très proche, nous prévoyons d'ajouter les éléments suivants: <br><br><h3>  Afficher les étapes de test dans Allure (bonjour aux gars de HeadHunter) </h3><br>  Grâce à un intercepteur spécial, nous préparons les données pour <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Marathon</a> .  Cela nous permet de voir les rapports Allure de la nature suivante: <br><br><img src="https://habrastorage.org/webt/ad/dm/ux/addmux7l65zlvxi0fxlr97wr_o0.jpeg"><br><br>  Détails dans <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">PR # 4</a> <br><br>  PS PR est déjà dans la version 1.0.1, nous préparons maintenant le PR correspondant à <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Marathon</a> . <br>  Pss.  Il y a une idée pour attacher un morceau spécifique du journal à chaque étape, et ajouter une capture d'écran à l'étape "tombée". <br><br><h3>  Test des scripts de mise à niveau </h3><br>  Il est souvent nécessaire de vérifier l'exactitude des mises à niveau des applications.  Oui, certains chèques peuvent être transférés aux tests unitaires.  Mais nous aimerions être calmes pour l'ensemble de l'application dans son ensemble. <br><br>  Malheureusement, sur un Espresso pur, il est impossible de le faire, car si nous réinstallons l'apk testé, le test échouera.  Vous pouvez en quelque sorte essayer de jouer avec le coureur, mais il m'est difficile d'imaginer à quoi ressembleront ces améliorations et à quel point elles seront stables. <br>  Par conséquent, chez Kaspresso, nous préparons une solution à ce problème, basée sur UiAutomator.  Cependant, en haut, vous aurez tout de même le même dsl familier, très similaire à Kakao et avec le même support pour l'intersection. <br><br><h2>  Liens utiles </h2><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Kaspresso</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">AdbServer</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Chat</a> , dans lequel nous serons toujours heureux de répondre à toutes vos questions <br><br><h2>  Remerciements </h2><br>  Un merci spécial à tous ceux qui ont participé à l'élaboration du projet. <br>  C'était très difficile, mais sacrément cool! <br><br><img src="https://habrastorage.org/webt/_l/vd/_u/_lvd_ux_onb1ft8uoo2eat8_5uo.png"><br><br><img src="https://habrastorage.org/webt/j2/bm/i1/j2bmi1ov0wicizc7iru0shunom0.png"><br><br><h2>  Au lieu d'une conclusion </h2><br>  Nous pensons que Kaspresso et AdbServer vous rendront la vie meilleure. <br>  Nous apprécions vos commentaires, recommandations, Yishuyam et PulRequest! <br>  Et n'oubliez pas de mettre un astérisque, s'il vous plaît! <br><br>  PS Et à la toute fin un petit sondage =) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr467617/">https://habr.com/ru/post/fr467617/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr467605/index.html">Tout ce dont vous avez besoin est une URL</a></li>
<li><a href="../fr467607/index.html">Confession de haineux docker</a></li>
<li><a href="../fr467609/index.html">Création d'une application mobile sur React Native</a></li>
<li><a href="../fr467611/index.html">Algorithmes de détection de contour d'image</a></li>
<li><a href="../fr467615/index.html">Comment créer un wrapper Python et ne pas devenir fou</a></li>
<li><a href="../fr467619/index.html">Les pichets Aquafor sont un bon exemple de la façon dont les filtres pour le traitement de l'eau ne peuvent pas être conçus</a></li>
<li><a href="../fr467621/index.html">Rencontre Elasticsearch Moscou à Ozon</a></li>
<li><a href="../fr467625/index.html">10 services pour créer une structure de site en 2020</a></li>
<li><a href="../fr467627/index.html">AZN-V comme technologie de surveillance pour drones</a></li>
<li><a href="../fr467629/index.html">Le livre «Réalité irréelle. Parcourir la boucle quantique »</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>