<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñïüèæ ü§∑üèø üëà Previs√£o do status da rede VoIP com base nos arquivos de log de texto do servidor de aplicativos SIP üöî üö£üèæ ü§≤üèº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="O monitoramento do estado da rede de sinaliza√ß√£o VoIP √© uma das condi√ß√µes importantes que permitem ao provedor UCaaS fornecer aos clientes um n√≠vel ga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Previs√£o do status da rede VoIP com base nos arquivos de log de texto do servidor de aplicativos SIP</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/dins/blog/440458/"><p>  O monitoramento do estado da rede de sinaliza√ß√£o VoIP √© uma das condi√ß√µes importantes que permitem ao provedor UCaaS fornecer aos clientes um n√≠vel garantido de qualidade de servi√ßos, como chamadas de √°udio e v√≠deo, recep√ß√£o e transmiss√£o de fax.  Normalmente, esse controle √© realizado usando v√°rios sistemas de monitoramento, coleta e an√°lise de tr√°fego, an√°lise CDR.  Alguns dos par√¢metros da rede de sinal s√£o bastante dif√≠ceis e muitas vezes imposs√≠veis de avaliar usando os m√©todos indicados. </p><a name="habracut"></a><br><p>  Uma poss√≠vel fonte de informa√ß√µes importantes sobre o estado de uma rede de sinaliza√ß√£o VoIP √© o SIP Application Server (SIP AS), um dos principais elementos envolvidos no processamento de chamadas em uma rede VoIP.  Os arquivos de log SIP AS permitem avaliar, entre outras coisas, os seguintes par√¢metros de uma rede de sinaliza√ß√£o VoIP: </p><br><ul><li>  Comprimento da caixa de di√°logo SIP </li><li>  O intervalo de tempo entre o envio de uma solicita√ß√£o e o recebimento de uma resposta final (RRT) para v√°rios tipos de solicita√ß√µes SIP </li><li>  O n√∫mero de retransmiss√µes de mensagens (retransmiss√µes, RTR) para diferentes tipos de mensagens SIP </li></ul><br><p>  N√£o apenas os valores desses par√¢metros s√£o importantes, mas tamb√©m a distribui√ß√£o desses par√¢metros, bem como suas altera√ß√µes ao longo do tempo.  As informa√ß√µes sobre a altera√ß√£o nos valores dos par√¢metros ao longo do tempo permitem prever poss√≠veis problemas em uma rede VoIP.  Essas informa√ß√µes tamb√©m podem servir como uma das fontes de dados para v√°rios algoritmos de aprendizado de m√°quina (aprendizado de m√°quina, ML), o que permitir√° prever altera√ß√µes nos par√¢metros, n√£o apenas dependendo do tempo, mas tamb√©m de outros fatores. </p><br><p>  Dependendo da carga do sinal, o SIP AS pode gerar arquivos de log em formato de texto at√© v√°rias dezenas de GB por dia.  A an√°lise de arquivos de texto desse volume √© uma tarefa que consome muitos recursos.  Como uma das op√ß√µes poss√≠veis, v√°rias ferramentas Python podem ser usadas para esta an√°lise.  Por exemplo, a biblioteca <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Pandas</a> fornece ferramentas bastante convenientes para processar e analisar v√°rios dados, em particular, quadros de dados (DF).  O c√≥digo usado neste artigo est√° dispon√≠vel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">aqui</a> . <br>  As etapas a seguir s√£o sugeridas para analisar arquivos de log SIP AS: </p><br><ol><li>  Abra o arquivo de log para leitura.  Se o SIP AS criou v√°rios arquivos de log, eles devem ser abertos na mesma ordem em que foram criados. </li><li>  Leia os dados linha por linha.  Isso √© necess√°rio para economizar RAM no caso de trabalhar com arquivos de unidades de dezenas de GB </li><li>  Real√ßar mensagens SIP localizadas entre seq√º√™ncias espec√≠ficas de caracteres - delimitadores </li><li>  Crie uma lista de dicion√°rios.  Cada um dos dicion√°rios, por sua vez, consiste em um carimbo de data / hora (chave) e a mensagem SIP (valor) real na forma de uma lista </li><li>  Salve esta lista no armazenamento em disco ou em rede como, por exemplo, um arquivo de pickle.  Este arquivo ser√° usado posteriormente para criar v√°rios DFs. </li><li>  Crie um DF a partir de um arquivo de pickle salvo contendo as informa√ß√µes necess√°rias para an√°lises adicionais (SIP DF) </li></ol><br><p>  Nesse caso espec√≠fico, um SIP DF foi criado contendo as seguintes colunas: </p><br><ul><li> Registro de data e hora - registro de data e hora adicionado por SIP AS </li><li>  Call-ID - Call-ID da conversa SIP </li><li>  CSeq_num, CSeq_meth - dados do cabe√ßalho SIP 'CSeq' </li><li>  Dire√ß√£o - mensagem recebida (Rx &lt;-) ou enviada (Tx-&gt;), SIP AS √© adicionado </li><li>  M√©todo SIP - m√©todo SIP da linha de solicita√ß√£o SIP </li><li>  Src Dst IP - endere√ßo IP do qual a mensagem foi enviada ou recebida </li></ul><br><p><img src="https://habrastorage.org/webt/9e/pq/x4/9epqx4i7nfowaxkmfuji7cqusau.png" alt="imagem"></p><br><p>  Fig.  1. Par√¢metros do SIP DF obtidos a partir de um arquivo pickle de cerca de 3 GB </p><br><p><img src="https://habrastorage.org/webt/mm/xg/fs/mmxgfsyxywnoeszied6n7tiyc6g.png" alt="imagem"></p><br><p>  Fig.  2. Conte√∫do do SIP DF </p><br><p>  Tendo um DF SIP semelhante, √© poss√≠vel avaliar v√°rios par√¢metros de uma rede VoIP de sinaliza√ß√£o.  Todos os exemplos abaixo s√£o retirados de uma rede VoIP v√°lida.  Os endere√ßos IP e outros dados que podem fornecer informa√ß√µes sobre a rede especificada foram alterados. </p><br><h4 id="1-dlina-sip-dialoga">  1. A dura√ß√£o do di√°logo SIP </h4><br><p><img src="https://habrastorage.org/webt/tg/fp/g2/tgfpg2yil79lpysldretfmpwg6g.png" alt="imagem"><br><img src="https://habrastorage.org/webt/ae/fy/i2/aefyi2ndnytapmictjqm0ifart0.png" alt="imagem"><br>  Fig.  3. Comprimento da caixa de di√°logo DF e SIP </p><br><p>  Para cada caso de um longo di√°logo SIP, √© poss√≠vel encontrar a chamada pelo valor do ID da chamada e, em logs de texto, analisar o cen√°rio dessa chamada.  Apesar do n√∫mero relativamente pequeno de chamadas para as quais a dura√ß√£o da conversa SIP √© de dezenas a centenas de mensagens, os cen√°rios dessas chamadas devem ser investigados.  O estudo de tais chamadas revelou as seguintes fontes de longas caixas de di√°logo SIP: </p><br><ul><li>  Transmiss√£o de v√°rias dezenas de grupos de uma determinada estrutura, composta por caracteres DTMF, ap√≥s o estabelecimento de uma sess√£o de voz.  Este √© um cen√°rio de chamada de voz durante o qual ocorrem autentica√ß√£o, autoriza√ß√£o e troca de informa√ß√µes entre os assinantes que est√£o chamando e os chamados. </li><li>  Videochamadas durante as quais um n√∫mero muito grande de solicita√ß√µes Intra-Frame Full ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">FIR</a> ) foi observado.  Isso, em particular, indica um problema no software do telefone ou perda de pacotes RTP durante chamadas de v√≠deo. </li></ul><br><p>  Di√°logos SIP longos tamb√©m podem aparecer devido a um mau funcionamento do equipamento VoIP, tentativas de selecionar c√≥digos PIN atrav√©s de um menu IVR (enviando um grande n√∫mero de sequ√™ncias DTMF).  De qualquer forma, √© necess√°rio monitorar o n√∫mero de longas conversas SIP, porque, com um aumento no n√∫mero de di√°logos, uma carga de sinal in√∫til adicional nos elementos da rede VoIP pode aparecer. </p><br><h4 id="2-rrt">  2. RRT </h4><br><p>  √â calculado separadamente para solicita√ß√µes INFO e INVITE recebidas e enviadas.  Lembre-se de que, ao processar um grande n√∫mero de chamadas, podem ocorrer os mesmos valores de CSeq para diferentes caixas de di√°logo.  Pode-se presumir que a distribui√ß√£o dos valores RRT deve ser aproximadamente a mesma para as solicita√ß√µes enviadas, os valores absolutos devem diferir devido ao tamanho e conte√∫do diferentes das solicita√ß√µes INFO e INVITE e, como resultado, os diferentes tempos de processamento dessas solicita√ß√µes pelos elementos da rede. </p><br><p><img src="https://habrastorage.org/webt/rd/d3/2q/rdd32qczrh2glgsxgxhqsx0g9ia.png" alt="imagem"><br>  Fig.  3. RRT para solicita√ß√µes INFO recebidas pelo SIP AS <br>  O aumento nos valores de RRT nesse caso indica poss√≠veis problemas com a virtualiza√ß√£o, um aumento na carga no SIP AS.  A identifica√ß√£o de chamada e CSeq_num permitem examinar os valores RRT para cada caso. </p><br><p><img src="https://habrastorage.org/webt/ht/a0/yw/hta0ywhl6nfznqymdgzl4eo7_fc.png" alt="imagem"><br>  Fig.  4. RRT para solicita√ß√µes INFO enviadas pelo SIP AS.  O RRT no gr√°fico √© limitado a 500 ms, que √© o valor padr√£o para o timer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">SIP T1</a> . </p><br><p><img src="https://habrastorage.org/webt/kn/d3/wf/knd3wfmcqfmwij1wk4jgqlmax24.png" alt="imagem"><br>  Fig.  5. RRT para solicita√ß√µes INVITE enviadas pelo SIP AS.  Como esperado, a distribui√ß√£o √© aproximadamente a mesma das consultas INFO. </p><br><h4 id="3-rtr">  3. RTR </h4><br><p>  Um par√¢metro importante que caracteriza o estado de uma rede de sinaliza√ß√£o VoIP. </p><br><p><img src="https://habrastorage.org/webt/yl/v3/h5/ylv3h5eqljf3prx1p9oqogs4fr0.png" alt="imagem"><br>  Fig.  6. A porcentagem de retransmiss√£o de solicita√ß√µes INFO e INVITE, respectivamente.  RTRs que ocorrem uma ou mais vezes s√£o levados em considera√ß√£o. </p><br><p>  Al√©m dos exemplos descritos, outros dados podem ser obtidos usando o DF, por exemplo: </p><br><ul><li>  Corrigir o balanceamento de carga do SIP AS para mensagens enviadas.  Para fazer isso, voc√™ precisa contar o n√∫mero de mensagens enviadas (Tx) em diferentes endere√ßos IP (SrcDst IP) usando groupby (). Count () - semelhante √† fun√ß√£o retransmits_counter_tx ().  A diferen√ßa no n√∫mero de mensagens acima de 15-20% indica um compartilhamento de carga incorreto </li><li>  O n√∫mero de transfer√™ncias de chamadas com falha.  Para fazer isso, voc√™ pode criar um DF separado contendo apenas caixas de di√°logo REFER, bem como os cabe√ßalhos e campos necess√°rios das mensagens dessas caixas de di√°logo. </li><li>  A depend√™ncia dos par√¢metros no tempo.  Se voc√™ coletar o valor m√©dio de um dos par√¢metros, por exemplo, RRT, ao longo de v√°rios meses, com base nos dados, poder√° criar uma s√©rie temporal (s√©rie temporal, TS).  Usando v√°rias bibliotecas para an√°lise de TS, por exemplo, modelos estat√≠sticos, √© poss√≠vel determinar a tend√™ncia, sazonalidade e outros par√¢metros de TS.  Os dados desta previs√£o podem ser usados ‚Äã‚Äãpara ajustar a arquitetura da rede VoIP. </li></ul><br><h4 id="zaklyuchenie">  Conclus√£o </h4><br><p>  Os arquivos de log de texto SIP AS s√£o uma fonte importante de informa√ß√µes sobre o estado atual de uma rede VoIP.  Al√©m disso, os dados obtidos ap√≥s o processamento adequado dessas informa√ß√µes podem ser utilizados na previs√£o do estado de uma rede VoIP, em particular, usando m√©todos de ML. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt440458/">https://habr.com/ru/post/pt440458/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt440444/index.html">Sistemas baseados em fila</a></li>
<li><a href="../pt440446/index.html">S√©rie de semin√°rios on-line sobre o fluxo de trabalho do TDMS</a></li>
<li><a href="../pt440448/index.html">O que terminou a hist√≥ria com o programador sem-teto</a></li>
<li><a href="../pt440450/index.html">Existe um rublo para entrada, mas n√£o h√° sa√≠da: como os arquivos de terceiros entram no blockchain e o que fazer com ele</a></li>
<li><a href="../pt440454/index.html">Paul Graham: O que aprendi com o Hacker News</a></li>
<li><a href="../pt440460/index.html">Como os sete modders Mount e Blade criaram um est√∫dio de jogos</a></li>
<li><a href="../pt440462/index.html">As 7 principais estrat√©gias de marketing de conte√∫do a n√£o perder em 2019</a></li>
<li><a href="../pt440464/index.html">Trabalhar com o servi√ßo Digital Ocean Managed Databases no .NET Core</a></li>
<li><a href="../pt440466/index.html">Controle remoto Web UART</a></li>
<li><a href="../pt440468/index.html">2 vezes mais, 10 vezes mais r√°pido, 24 horas por dia - tudo pelo bem das pessoas</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>