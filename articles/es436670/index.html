<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üï∫üèº ü§ê üêù C√≥mo transferir actualizaciones en producci√≥n autom√°ticamente üë¨ üèûÔ∏è üéÆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Lanzar la nueva versi√≥n en operaciones de combate siempre es un evento nervioso. Especialmente si el proceso involucra muchas operaciones manuales. El...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo transferir actualizaciones en producci√≥n autom√°ticamente</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/microsoft/blog/436670/">  Lanzar la nueva versi√≥n en operaciones de combate siempre es un evento nervioso.  Especialmente si el proceso involucra muchas operaciones manuales.  El factor humano es algo terrible.  "Ser√≠a bueno automatizar este proceso": esta idea es tan antigua como todo el mundo de TI.  Y hay un t√©rmino para esto: despliegue continuo.  S√≠, el problema es que no hay una forma √∫nica de configurar esta implementaci√≥n continua.  En gran medida, este proceso est√° vinculado a la pila tecnol√≥gica del proyecto y su entorno. <br><br>  En este art√≠culo quiero compartir la experiencia pr√°ctica en la configuraci√≥n de actualizaciones autom√°ticas del sistema sin interrumpir su funcionamiento para un entorno tecnol√≥gico espec√≠fico, a saber: la aplicaci√≥n web ASP.NET MVC + Azure SQL + Entity Framework en modo Code First, la aplicaci√≥n se implementa en Azure como App Service , y el ensamblaje y la implementaci√≥n se realizan a trav√©s de Azure DevOps (anteriormente Visual Studio Team Services). <br><br><img src="https://habrastorage.org/webt/ji/6o/8j/ji6o8j6s6ignpfqyorvdmaxcotk.jpeg"><a name="habracut"></a><br><br>  A primera vista, todo es muy simple, Azure App Service tiene el concepto de ranura de implementaci√≥n: descargue la nueva versi√≥n all√≠ y act√≠vela.  Pero ser√≠a simple si el proyecto se basara en un DBMS no relacional, en el que no hay un esquema de datos r√≠gido.  En este caso, s√≠, solo la nueva versi√≥n capta el tr√°fico y listo.  Pero con un DBMS relacional, todo es algo m√°s complicado. <br><br>  Los principales factores que nos impiden implementar la implementaci√≥n continua de nuestra pila de tecnolog√≠a son los siguientes: <br><br><ul><li>  La versi√≥n anterior de la aplicaci√≥n no puede funcionar con la nueva estructura de base de datos. </li><li>  La actualizaci√≥n de la estructura de la base de datos puede llevar un tiempo considerable y no siempre es posible usar la aplicaci√≥n en s√≠ a trav√©s del mecanismo de migraci√≥n autom√°tica. </li></ul><br>  Te lo explicar√©.  Supongamos que implementa una nueva versi√≥n en una ranura paralela o en un centro de datos de respaldo y comienza la aplicaci√≥n de migraciones.  Supongamos que tenemos tres migraciones y, horror, dos han rodado, y la tercera ha ca√≠do.  En este momento, no pasar√° nada a los servidores en funcionamiento, Entity Framework no verifica la versi√≥n de cada solicitud, pero lo m√°s probable es que no resuelva r√°pidamente el problema.  En este momento, la carga en la aplicaci√≥n puede aumentar, y la plataforma lanzar√° una instancia adicional de la aplicaci√≥n para usted, y ... naturalmente, no se iniciar√°, ya que la estructura de la base de datos ha cambiado.  Una parte importante de los usuarios comenzar√° a recibir errores.  Por lo tanto, el riesgo de la aplicaci√≥n autom√°tica de migraciones es grande. <br><br><img src="https://habrastorage.org/webt/zv/kf/xv/zvkfxv1rthfzrgpmduxbjkv8ods.png"><br><br>  En cuanto al segundo punto, su migraci√≥n puede contener alg√∫n tipo de comandos cuyo tiempo de ejecuci√≥n exceda los 30 segundos y el procedimiento est√°ndar expirar√°.  Bueno, adem√°s de estos puntos, personalmente no me gusta el hecho de que durante las migraciones autom√°ticas se ve obligado a actualizar parte de la infraestructura a una nueva versi√≥n.  Y si para un modo con ranuras en Azure esto no da tanto miedo, entonces para un modo con un centro de datos de respaldo, obtienes una parte de la infraestructura con una aplicaci√≥n que no funciona.  Todo es peligroso, disparar√° en el momento m√°s inoportuno. <br><br><h2>  Que hacer </h2><br>  Comencemos con lo m√°s dif√≠cil: con la base de datos.  Por lo tanto, ser√≠a bueno actualizar autom√°ticamente la estructura de la base de datos para que las versiones antiguas de la aplicaci√≥n sigan funcionando.  Adem√°s, ser√≠a bueno tener en cuenta el hecho de que existen tales actualizaciones en las que se puede ejecutar un comando separado durante un tiempo considerable, lo que significa que debemos actualizar la base de datos no utilizando los mecanismos integrados sino ejecutando un script SQL separado.  Pregunta: ¬øc√≥mo prepararlo?  Puedes hacer este manual de proceso.  Si tiene un rol de administrador de versiones separado en el equipo, puede forzarlo a ejecutar el comando en Visual Studio: <br><br><pre><code class="cpp hljs">update-database -script</code> </pre> <br>  Ella generar√° un script, y esta persona colocar√° este script en una carpeta de proyecto espec√≠fica.  Pero debe admitir que esto sigue siendo un inconveniente, en primer lugar, el factor humano y, en segundo lugar, dificultades innecesarias si hubiera m√°s de una migraci√≥n entre versiones.  O por alguna raz√≥n, se omiti√≥ una versi√≥n en el sistema de destino.  Tendremos que crear una especie de jard√≠n complicado con el seguimiento de las migraciones que ya est√°n all√≠ y las que deben iniciarse.  Es dif√≠cil y, lo m√°s importante, esta es la misma bicicleta que ya se ha hecho en el mecanismo de migraci√≥n. <br><br>  Y ser√° correcto incorporar el proceso de generaci√≥n y ejecuci√≥n del script en el proceso de c√°lculo de la versi√≥n.  Para generar un script de migraci√≥n, puede usar la utilidad migrate.exe, que se incluye con Entity Framework.  Le llamo la atenci√≥n sobre el hecho de que necesita Entity Framework versi√≥n 6.2 o superior, ya que la opci√≥n de generaci√≥n de script apareci√≥ en esta utilidad solo en abril de 2017.  La llamada de utilidad se ve as√≠: <br><br><pre> <code class="cpp hljs">migrate.exe Context.dll /connectionString=<span class="hljs-string"><span class="hljs-string">"Data Source=localhost;Initial Catalog=myDB;User Id=sa;Password=myPassword;"</span></span> /connectionProviderName=<span class="hljs-string"><span class="hljs-string">"System.Data.SqlClient"</span></span> /sc /startUpDirectory=<span class="hljs-string"><span class="hljs-string">"c:\projects\MyProject\bin\Release"</span></span> /verbose</code> </pre> <br>  El nombre del ensamblado se indica donde se encuentra su contexto, la cadena de conexi√≥n a la base de datos de destino, el proveedor y, lo m√°s importante, el directorio de inicio, que contiene tanto el ensamblaje con el contexto como el ensamblaje de Entity Framework.  No experimente con los nombres del directorio de trabajo, sea m√°s simple.  Nos topamos con el hecho de que migrate.exe no pod√≠a leer el directorio, en cuyo nombre hab√≠a espacios y caracteres que no eran letras. <br><br>  Aqu√≠ debemos hacer una digresi√≥n importante.  El hecho es que despu√©s de ejecutar el comando anterior, se generar√° un solo script SQL que contiene todos los comandos para todas las migraciones que deben aplicarse a la base de datos de destino.  Para Microsoft SQL Server, esto no es muy bueno.  El hecho es que el servidor ejecuta comandos sin el separador GO como un solo paquete, y algunas operaciones no pueden realizarse juntas en un solo paquete. <br><br>  Por ejemplo, en algunos casos, agregar un campo a una tabla e inmediatamente crear un √≠ndice en esta tabla con un nuevo campo no funciona.  Pero esto no es suficiente, algunos comandos requieren ciertas configuraciones de entorno al ejecutar el script.  Dichas configuraciones se habilitan de manera predeterminada cuando se conecta a SQL Server a trav√©s de SQL Server Management Studio, pero cuando el script se ejecuta a trav√©s de la utilidad de consola SQLCMD, deben configurarse manualmente.  Para tener todo esto en cuenta, deber√° modificar el archivo para generar el script de migraci√≥n.  Para hacer esto, cree una clase adicional al lado del contexto de la fecha, que hace todo lo que necesita: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MigrationScriptBuilder</span></span></span><span class="hljs-class"> :</span></span> SqlServerMigrationSqlGenerator { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> override IEnumerable&lt;MigrationStatement&gt; Generate(IEnumerable&lt;MigrationOperation&gt; migrationOperations, <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> providerManifestToken) { var statements = base.Generate(migrationOperations, providerManifestToken); var result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> List&lt;MigrationStatement&gt;(); result.Add(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MigrationStatement { Sql = <span class="hljs-string"><span class="hljs-string">"SET QUOTED_IDENTIFIER ON;"</span></span> }); foreach (var item in statements) { item.BatchTerminator = <span class="hljs-string"><span class="hljs-string">"GO"</span></span>; result.Add(item); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } }</code> </pre><br>  Y para que Entity Framework pueda usarlo, reg√≠strelo en la clase de Configuraci√≥n, que generalmente se encuentra en la carpeta Migraciones: <br><br><pre> <code class="cpp hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Configuration</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ SetSqlGenerator(<span class="hljs-string"><span class="hljs-string">"System.Data.SqlClient"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MigrationScriptBuilder()); ‚Ä¶. }</code> </pre><br>  Despu√©s de eso, la secuencia de comandos de migraci√≥n resultante contendr√° GO entre cada instrucci√≥n, y al comienzo del archivo contendr√° SET QUOTED_IDENTIFIER ON; <br><br>  Hurra, la preparaci√≥n est√° hecha, queda por configurar el proceso en s√≠.  En general, como parte del proceso de lanzamiento en Azure DevOps (VSTS / TFS), esto ya es bastante simple.  Necesitamos crear un script de PowerShell como este: <br><br><pre> <code class="cpp hljs">param ( [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] [Parameter(Mandatory=$<span class="hljs-literal"><span class="hljs-literal">true</span></span>)] $dbserver, [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] [Parameter(Mandatory=$<span class="hljs-literal"><span class="hljs-literal">true</span></span>)] $dbname, [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] [Parameter(Mandatory=$<span class="hljs-literal"><span class="hljs-literal">true</span></span>)] $dbserverlogin, [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] [Parameter(Mandatory=$<span class="hljs-literal"><span class="hljs-literal">true</span></span>)] $dbserverpassword, [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] [Parameter(Mandatory=$<span class="hljs-literal"><span class="hljs-literal">true</span></span>)] $rootPath, [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] [Parameter(Mandatory=$<span class="hljs-literal"><span class="hljs-literal">true</span></span>)] $buildAliasName, [<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>] [Parameter(Mandatory=$<span class="hljs-literal"><span class="hljs-literal">true</span></span>)] $contextFilesLocation, ) Write-Host <span class="hljs-string"><span class="hljs-string">"Generating migration script..."</span></span> $fullpath=<span class="hljs-string"><span class="hljs-string">"$rootPath\$buildAliasName\$contextFilesLocation"</span></span> Write-Host $fullpath &amp; <span class="hljs-string"><span class="hljs-string">"$fullpath\migrate.exe"</span></span> Context.dll /connectionProviderName=<span class="hljs-string"><span class="hljs-string">"System.Data.SqlClient"</span></span> /connectionString=<span class="hljs-string"><span class="hljs-string">"Server=tcp:$dbserver.database.windows.net,1433;Initial Catalog=$dbname;Persist Security Info=False;User ID=$dbserverlogin;Password=$dbserverpassword;MultipleActiveResultSets=False;Encrypt=True;TrustServerCertificate=False;Connection Timeout=30;"</span></span> /startUpDirectory=$fullpath /verbose /scriptFile=<span class="hljs-number"><span class="hljs-number">1.</span></span>SQL Write-Host <span class="hljs-string"><span class="hljs-string">"Running migration script..."</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"SQLCMD"</span></span> -S <span class="hljs-string"><span class="hljs-string">"$dbserver.database.windows.net"</span></span> -U $dbserverlogin@$dbserver -P $dbserverpassword -d $dbname -i <span class="hljs-number"><span class="hljs-number">1.</span></span>SQL Write-Host <span class="hljs-string"><span class="hljs-string">"====Finished with migration script===="</span></span></code> </pre><br>  Y agregue la unidad de ejecuci√≥n de script de PowerShell al proceso de c√°lculo de lanzamiento.  El bloque y su configuraci√≥n pueden verse as√≠: <br><br><img src="https://habrastorage.org/webt/2u/j4/vg/2uj4vgqd6vsvkmwpbdx2afxinho.png"><br><br>  La configuraci√≥n de PowerShell se ve as√≠: <br><br><img src="https://habrastorage.org/webt/p4/lg/47/p4lg47g_ympywrtn6ewk-wmgp8g.png"><br><br>  Es importante no olvidar agregar el archivo migrate.exe al proyecto desde la carpeta &lt;YourProject&gt; /packages/EntityFramework.6.2.0/tools/ y configurar la propiedad Copiar siempre para que esta utilidad se copie en el directorio de salida cuando se construya el proyecto y pueda acceder a √©l en Lanzamiento de Azure DevOps. <br><br>  <b>El matiz</b>  Si su proyecto tambi√©n usa WebJob cuando se implementa en Azure App Service, agregar Migrate.exe a su proyecto no es seguro.  Nos enfrentamos al hecho de que en la carpeta donde se publica su WebJob, la plataforma Azure inicia est√∫pidamente el primer archivo exe que aparece.  Y si su WebJob alfab√©ticamente cuesta m√°s tarde migrate.exe (y nosotros lo hicimos), ¬°entonces intenta ejecutar migrate.exe en lugar de su proyecto! <br><br>  Entonces, aprendimos c√≥mo actualizar la versi√≥n de la base de datos generando un script durante el proceso de lanzamiento, lo simple es: desactivar la verificaci√≥n de la versi√≥n de migraci√≥n, de modo que si hay fallas en el proceso de ejecuci√≥n del script, la versi√≥n anterior de nuestro c√≥digo contin√∫a funcionando.  Creo que no hay necesidad de decir que sus migraciones no deber√≠an ser destructivas.  Es decir  Los cambios en la estructura de la base de datos no deber√≠an interferir con el rendimiento de la versi√≥n anterior, sino mejor que las dos anteriores.  Para deshabilitar la verificaci√≥n, solo necesita agregar el siguiente bloque a Web.config: <br><br><pre> <code class="cpp hljs"> &lt;entityFramework&gt; &lt;contexts&gt; &lt;context type=<span class="hljs-string"><span class="hljs-string">"&lt;full namespace for your DataContext class&gt;, MyAssembly"</span></span> disableDatabaseInitialization=<span class="hljs-string"><span class="hljs-string">"true"</span></span>/&gt; &lt;/contexts&gt; &lt;/entityFramework&gt;</code> </pre><br>  Donde <code>full namespace for your DataContext class</code> es el espacio de nombres completo para su descendiente de DbContext, y MyAssembly es el nombre del ensamblado donde reside su contexto. <br><br>  Y finalmente, es altamente deseable que nos aseguremos de que la aplicaci√≥n se est√© calentando antes de cambiar a los usuarios a la nueva versi√≥n.  Para hacer esto, agregue un bloque especial a web.config con enlaces que su aplicaci√≥n se cierra autom√°ticamente durante el proceso de inicializaci√≥n: <br><br><pre> <code class="cpp hljs"> &lt;system.webServer&gt; &lt;applicationInitialization doAppInitAfterRestart=<span class="hljs-string"><span class="hljs-string">"true"</span></span>&gt; &lt;add initializationPage=<span class="hljs-string"><span class="hljs-string">"/"</span></span> hostName=<span class="hljs-string"><span class="hljs-string">""</span></span> /&gt; &lt;/applicationInitialization&gt; &lt;/system.webServer&gt;</code> </pre><br>  Puede agregar varios enlaces simplemente agregando <code>/&gt;</code> Se argumenta que en Azure, al cambiar de ranura, la plataforma espera a que la aplicaci√≥n se inicialice y solo luego cambia el tr√°fico a la nueva versi√≥n. <br><br><h2>  Pero, ¬øqu√© pasa con un proyecto en .NET Core? </h2><br>  Todo es mucho m√°s simple y al mismo tiempo diferente.  Se puede generar una secuencia de comandos de migraci√≥n utilizando herramientas normales, pero no se basa en el ensamblaje terminado, sino en el archivo del proyecto.  Por lo tanto, el script debe formarse como parte del proceso de ensamblaje del proyecto y debe incluirse como un artefacto de ensamblaje.  En este caso, el script contendr√° todos los comandos de todas las migraciones desde el principio de los tiempos.  No hay problemas en esto, ya que el gui√≥n es idempotente, es decir  se puede aplicar a la base objetivo repetidamente sin ninguna consecuencia.  Esto tiene otra consecuencia √∫til: no necesitamos modificar el proceso de generaci√≥n de scripts para separar los comandos en paquetes, todo ya se ha hecho para esto. <br><br>  Bueno, espec√≠ficamente, los pasos del proceso se ven as√≠.  En el proceso de compilaci√≥n, agregue la tarea: <br><br><img src="https://habrastorage.org/webt/uy/rx/xj/uyrxxj48kzjdv85qlcugbuhnhge.png"><br><br>  Lo configuramos para generar un archivo con migraciones: <br><br><img src="https://habrastorage.org/webt/hr/mu/om/hrmuom6-wjvv4xak07ewe2_bsxw.png"><br><br>  No olvide agregar un script al proyecto de PowerShell que realizar√° la migraci√≥n (descrita anteriormente) y el archivo de migraci√≥n en s√≠.  Como resultado, despu√©s de construir el proyecto, los artefactos pueden verse as√≠ (adem√°s del archivo real con el ensamblado, hay un script PS adicional y un script SQL con migraciones): <br><br><img src="https://habrastorage.org/webt/hj/m9/j4/hjm9j4emze4vu_ceybuwjkyrafe.png"><br><br>  Solo queda en el paso de lanzamiento apropiado configurar la ejecuci√≥n de este script de PowerShell de la misma manera que se describe anteriormente. <br><br><h2>  Sobre el autor </h2><br><img src="https://habrastorage.org/webt/ok/i5/ug/oki5uge-jvjl3pkerhoipjvjvyc.jpeg" align="left" width="120">  Pavel Kutakov es un experto en tecnolog√≠as en la nube, desarrollador y arquitecto de sistemas de software en diversos sectores comerciales, desde la banca IP que opera en todo el mundo desde EE. UU. Hasta Papua Nueva Guinea, hasta una soluci√≥n en la nube para el operador de loter√≠a nacional. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es436670/">https://habr.com/ru/post/es436670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es436658/index.html">El futuro del comercio minorista: tendencias digitales clave basadas en el Big Show 2019 de NRF Retail</a></li>
<li><a href="../es436660/index.html">Mapa de ruta del c√≥digo VS 2019 - BORRADOR</a></li>
<li><a href="../es436662/index.html">1 de febrero de 2019 su sitio puede dejar de funcionar</a></li>
<li><a href="../es436664/index.html">Presentamos la serie .NET Community Standup</a></li>
<li><a href="../es436668/index.html">¬øSe pueden leer las estad√≠sticas con una peque√±a cantidad de datos?</a></li>
<li><a href="../es436674/index.html">Ingenier√≠a inversa Mareo fant√°stico</a></li>
<li><a href="../es436676/index.html">C√≥mo hacer DDoS en todo el pa√≠s</a></li>
<li><a href="../es436682/index.html">No cree su propio JL (DSL) para ampliar la funcionalidad de la aplicaci√≥n</a></li>
<li><a href="../es436684/index.html">Aniversario de Android 10 (Q). ¬øQu√© se sabe ahora?</a></li>
<li><a href="../es436686/index.html">JPEG del mundo 3D. ¬øQu√© es glTF?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>