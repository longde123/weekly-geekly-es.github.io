<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩‍⚖️ 👊🏻 🧑🏽‍🤝‍🧑🏽 Wie ich fast einen Virus gefangen hätte, der versucht, Stiefel zu verkaufen 🏧 🚴🏽 🐲</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Ich gehöre zu den Menschen, die mit Beginn des Herbstes versuchen, weniger Zeit auf der Straße zu verbringen. In Moskau ist das nicht schwierig: Sie b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wie ich fast einen Virus gefangen hätte, der versucht, Stiefel zu verkaufen</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/430074/"><img src="https://habrastorage.org/webt/wf/yz/a_/wfyza_3hf3mtbnqlffsve6xijoo.png"><br><br>  Ich gehöre zu den Menschen, die mit Beginn des Herbstes versuchen, weniger Zeit auf der Straße zu verbringen.  In Moskau ist das nicht schwierig: Sie beschränken sich auf den Weg von zu Hause ins Büro und zurück.  Feuchtes Wetter kann jedoch zu Unannehmlichkeiten im Raum führen, insbesondere wenn sich Ihr Arbeitsplatz wie meiner am Fenster befindet und jeder zweite Kollege, der sich über Verstopfung beschwert, darum bittet, das Büro zu lüften.  Um nicht in die Milz zu fallen, habe ich diesen Herbst die Garderobe aktualisiert. <br><br>  Als ich über das Schicksal unnötiger Dinge nachdachte, fragte ich mich, was ich damit anfangen sollte: wegwerfen, in Lumpen schneiden, meinem jüngeren Bruder geben, um es zu tragen?  Aber zum einen war keine dieser Methoden geeignet: Es waren Lederstiefel 44 von anständiger Größe, aber sie störten mich in Ordnung.  Ich beschloss, sie auf Avito zu verkaufen.  Ich habe Fotos hochgeladen, einen falschen Namen angegeben (Informationssicherheit ist dieselbe), meine Stiefel ausgezogen, ein paar andere Dinge und bin schlafen gegangen.  Woher wusste ich, dass dies zu einer langen Analyse der Anwendung auf versteckte Bedrohungen führen würde? <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/2m/re/zj/2mrezjviqrbnbh6xwbn__ps6j4u.png"><br><br><h2>  Angenehme Überraschung </h2><br>  Am Tag nach ein paar zweifelhaften Anrufen erhielt ich eine interessante SMS mit folgendem Inhalt: <br><br><img src="https://habrastorage.org/webt/je/mo/fs/jemofsiwbf3qmf5fsslki95roz8.jpeg"><br><br>  Nach ein paar Tagen erhielt ich eine weitere ähnliche Nachricht: <br><br><img src="https://habrastorage.org/webt/ru/k3/ap/ruk3apc1cjlrzjdqinme0ucnmgc.jpeg"><br><br>  Überrascht, dass jemand im Internet irgendwie Geld an mich überweisen konnte (anscheinend bin ich der einzige, der alt ist - ich benutze immer noch Sparbücher), klickte ich auf den Link in SMS. <br><br>  Danach wurde mir angeboten, eine Android-Anwendung (apk-Datei) herunterzuladen.  Beim Herunterladen der Datei sah ich Folgendes: <br><br><img src="https://habrastorage.org/webt/ab/c7/kd/abc7kd6qq9puqe7y7mc4f_vmaks.png"><br><br>  Es ist glaubwürdig!  Ich wollte unbedingt alles schnell installieren und beenden. <br>  Aber hier, wie immer, erlaubte mir das nervige Android-Betriebssystem aus irgendeinem Grund nicht, die Datei auszuführen.  "Gib mir das Geld schon!"  Ich war empört.  Ich musste zu den Einstellungen gehen und eine Option "Unbekannte Quellen" aktivieren. Ist das Telefon 2018 wirklich so dumm?  Mein Handy ist übrigens Xiaomi Remdi mit Andoid 6.0.1 (Hinweis für Technikfreaks). <br><br><img src="https://habrastorage.org/webt/hp/jf/0z/hpjf0z2umptn_vvgxee1qiosvw8.png"><img src="https://habrastorage.org/webt/y2/-8/8o/y2-88olz-wcbay7wpanhxlwf3fw.png"><br><br>  Es folgte eine Reihe seltsamer Ereignisse.  Das Telefon meldete weiterhin unzuverlässige Quellen.  Aber Avito ist eine <b>zuverlässige Quelle</b> !  Ich musste es googeln, herausfinden, wie ich das umgehen kann, und es dann in den Einstellungen ausschalten.  Bald erschien ein bestimmtes Antivirenprogramm, das ich nicht installiert hatte. <br><br><img src="https://habrastorage.org/webt/nl/ur/6c/nlur6cxmseun_mdsyj-uzqvls8a.png" width="170"><img src="https://habrastorage.org/webt/u7/qg/gg/u7qgggolf8mjgrf29o7ldijdpty.png" width="170"><img src="https://habrastorage.org/webt/52/le/x9/52lex9ukzmeujeoxah1bbraecsi.png" width="170"><img src="https://habrastorage.org/webt/b9/st/2g/b9st2gunjymlfnui5hogoyxp074.png" width="170"><br><br>  Schließlich habe ich das begehrte Standardinstallationsfenster gesehen - <i>es macht heutzutage keinen Sinn, sich die Berechtigungen anzusehen</i> , jetzt startet sogar ein Notebook erst, wenn Sie ihm vollen Zugriff auf das Telefon gewähren.  Freudiger Moment nach Abschluss der Anwendungsinstallation und START!  Ich freute mich auf das versprochene Geld.  Darüber hinaus forderte die Anwendung Administratorrechte an, denen ich freudig zustimmte.  Leider verhielt sich die Anwendung seltsam und wollte nicht bezahlen, und bald verschwand sie vollständig aus der Liste der Anwendungen auf dem allgemeinen Bildschirm. <br><br><img src="https://habrastorage.org/webt/2l/og/wo/2logwomobffteufrjrghz6mtnme.png" width="170"><img src="https://habrastorage.org/webt/cl/qp/nl/clqpnlxzkas8ij9z1zx1beteckq.png" width="170"><br><br><img src="https://habrastorage.org/webt/3n/qw/r_/3nqwr_xdxrtrnsbdnwypzu02obo.png" width="170"><img src="https://habrastorage.org/webt/cu/oy/tk/cuoytkopc5plrkilwany_tizlpy.png" width="170"><img src="https://habrastorage.org/webt/jp/y6/b2/jpy6b2sosh_zxdtn5bbwohhnkug.png" width="170"><br><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  Später überprüfte ich ein anderes Telefon - Lenovo mit Android 4.4.2 an Bord.  Die Liste der Berechtigungen während der Installation war viel umfangreicher.  Und kein Play Protection und Anti-Virus stören nicht, Sie müssen nur die Installation aus unzuverlässigen Quellen zulassen. <br><br><img src="https://habrastorage.org/webt/j_/9i/w1/j_9iw1jlp7dtyroivluxzlhftne.png" width="170"><img src="https://habrastorage.org/webt/ku/ay/h1/kuayh1icnuip2mwccqzdsrghvci.png" width="170"><br><br><img src="https://habrastorage.org/webt/lf/lc/v8/lflcv85sqajn4ju5-7qimh14rgu.png" width="170"><img src="https://habrastorage.org/webt/pk/2w/ps/pk2wpsjo3csovecieetanlqouki.png" width="170"><img src="https://habrastorage.org/webt/nu/ka/8a/nuka8a6nsp79yjtdibadpld5huw.png" width="170"><br></div></div><br><h2>  Altruismus </h2><br><br>  Also, wozu sind wir gekommen: <br><br><ul><li>  Die Installation dauerte 20 Minuten. </li><li>  Ich habe das Geld nicht erhalten. </li></ul><br>  Ich dachte, das Problem sei ein Codefehler, wie es bei Programmierern häufig der Fall ist.  Ich habe mich entschlossen, festzustellen, welche Fehler auftreten, wenn die Anwendung auf meinem Telefon ausgeführt wird, und dem Entwickler einen Bericht darüber zu senden. <br><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text">  Jetzt sind so wenige desinteressierte Menschen übrig, einer von ihnen bin ich. <br></div></div><br>  Es ist klar, dass diese Art von Anwendung funktionieren sollte, wenn das Internet verbunden ist. Daher habe ich zunächst versucht, den Datenverkehr zwischen dem Telefon und dem Anwendungsserver zu analysieren. <br><br><div class="spoiler">  <b class="spoiler_title">Technisches Handbuch zur Proxy-Konfiguration</b> <div class="spoiler_text">  Sie können den Internetverkehr jederzeit auf dem Weg vom Telefon zum Server abhören, sei es ein Heimrouter, ein lokaler Internetanbieter, ein Internet-Backbone oder ein Anwendungsserver. <br><br>  Die Probleme: <br><br><ul><li>  Der Zugang zu diesem Gerät ist erforderlich. </li><li>  Es ist erforderlich, den Datenverkehr der gewünschten Anwendung vom Rest zu trennen. </li><li>  Bei der Verschlüsselung (und 2018 ist bereits alles verschlüsselt) ist die Kenntnis des Schlüssels erforderlich. </li></ul><br>  Ich entschied mich für eine klassischere Vorgehensweise und konfigurierte Proxys auf dem Telefon mit einem Proxyserver auf meinem eigenen Laptop.  Um das Verschlüsselungsproblem zu verringern, habe ich beschlossen, mein Zertifikat zu importieren, und keine anderen Anwendungen gestartet, um den Anwendungsverkehr zu trennen. <br>  Ich habe <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Burp Suite</a> als Proxy-Server- <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Programm gewählt</a> .  Ich habe einen Proxyserver eingerichtet und ein Zertifikat auf mein Telefon exportiert. <br><br><img src="https://habrastorage.org/webt/h6/fl/tn/h6fltnqujuaa37og8s77oejovh8.png" width="520"><br><br><img src="https://habrastorage.org/webt/xy/xz/6k/xyxz6knuzcxtjobyss5-cpvpyrg.png" width="170"><img src="https://habrastorage.org/webt/-a/4e/vd/-a4evdiy2zz3pspeaai7idntxzk.png" width="170"><img src="https://habrastorage.org/webt/ol/52/82/ol528281ja24jszgftyz_hhpyes.png" width="170"><br></div></div><br>  Nach dem Einrichten einer speziellen Software konnte ich sehen, welche Anforderungen die Anwendung an den Server sendet: <br><br> <a href=""><img src="https://habrastorage.org/webt/ar/0v/fu/ar0vfughbbfcewogzbpklk6egh0.png"></a> <br><br>  Wie Sie sehen, werden die Daten nicht gesendet (der unbekannte Hostwert wird in der IP-Spalte angegeben). Darüber hinaus können sie aufgrund der zusätzlichen Verschlüsselung auf Anwendungsebene nicht analysiert werden.  Aus Versehen konnte das Telefon die IP-Adresse des Servers und seiner Subdomains <b>https: //*.sky-sync.pw nicht</b> anhand seines Domainnamens ermitteln. <br><br>  Dies kann nur folgende Optionen bedeuten: <br><br><ul><li>  <b>Der Domainname existiert nicht mehr</b> <br><ul><li>  Es wurde vom Eigentümer selbst blockiert. </li><li>  Er wurde vom Registrar wegen der Beschwerde blockiert. </li></ul></li><li>  <b>Problem mit dem DNS-Server</b> <br><ul><li>  Der DNS-Server kennt die Adresse nicht, da der Entwickler in der Produktion die lokale DNS-Adresse eingeführt hat. </li><li>  Der DNS-Server hat diese Anfrage speziell blockiert, was im Zeitalter der Internet-Zensur nicht überraschend ist. </li></ul></li></ul><br>  Um die Annahme eines Problems mit dem DNS-Server zu überprüfen, habe ich versucht, Anforderungen von verschiedenen großen DNS-Servern zu stellen: Google, Yandex, OpenDNS (normalerweise wird lokales DNS zensiert): <br><br><img src="https://habrastorage.org/webt/8n/-q/me/8n-qmebbunqccfns6anpcdghsg8.png"><br><br>  Es ist zu sehen, dass keiner von ihnen etwas über diesen Namen weiß.  Als nächstes habe ich mir whois Informationen zur Domainregistrierung angesehen: <br><br><img src="https://habrastorage.org/webt/dd/hw/ms/ddhwmsu4lilowe1twixzng6klqs.png"><br><br>  Merkwürdig: Die Domain ist registriert, dh höchstwahrscheinlich nicht lokal. Da sich die Domain jedoch nicht auflösen lässt, wurde sie möglicherweise vom Registrar wegen Missbrauchs blockiert.  Aber wofür?  Was hat er falsch gemacht? <br><br>  Um herauszufinden, was diese Anwendung überhaupt ist und wie ich mein Geld nehmen kann, habe ich mich für die <s>Magie des</s> Reverse Engineering entschieden. <br><br><h2>  Abgrund </h2><br>  Wenn Sie ein Humanist sind und bis zu diesem Ort gelesen haben, dann ist dies gut - für die Entwicklung des folgenden sind Sie einer <s>posthumen</s> Auszeichnung würdig. <br><br><h3>  <i>Toolkit</i> </h3><br>  Um herauszufinden, was sich unter der Haube der Anwendung befindet, müssen wir spezielle Tools herunterladen.  Sie können sie einzeln herunterladen: <br><br><ul><li>  <b>Apk behälter auspacken</b> <br><ul><li>  Klassiker - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">ApkTool</a> . </li><li>  Sie können es mit einem herkömmlichen Archivierer entpacken, aber dann sind alle binären Ressourcen, einschließlich Anwendungen und der Manifest-Datei, nicht lesbar. </li></ul></li><li>  <b>Smali Code Dekompiler</b> <br><ul><li>  Der Standard ist <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dex2Jar</a> , aber lernen Sie, dass dieses Programm oft schief funktioniert. </li><li>  Sie müssen die Angelegenheit sehr sorgfältig angehen, da der Dekompiler vom Dekompiler unterschiedlich ist. Wir werden dies später betrachten. </li></ul></li><li>  <b>Als Programm zum Anzeigen von dekompiliertem Code</b> würde ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">jd-gui</a> empfehlen </li></ul><br>  Oder Sie können das normalerweise kostenpflichtige Produkt verwenden, bei dem alles auf einmal vorhanden ist.  Ich bevorzuge <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">JebDecompiler</a> : Er kann einfach eine apk-Anwendung an seine Eingabe senden und ordnet alles ordentlich in Registerkarten an. Außerdem ist es praktisch, zwischen smali und dekompiliertem Java-Code darin zu wechseln. <br><br>  Separat möchte ich beachten: <br><br><ul><li>  Wenn native Bibliotheken vorhanden wären (der Ordner / libs in der Anwendungsstruktur), wäre ein <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Disassembler</a> erforderlich. </li><li>  Möglicherweise benötigen Sie eine <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Reihe von Dienstprogrammen</a> für die Arbeit mit Smali-Code (Dex-to-Smali, Smali-to-Dex). </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Syntaxhervorhebung</a> in Notepad ++, um die Augen nicht zu brechen. </li></ul><br><h3>  <i>Nur alte Leute ziehen in die Schlacht</i> </h3><br><h4>  Rückblick </h4><br>  Wenn Sie den dekompilierten Code öffnen, wird sofort klar, dass er verschleiert ist. <br><br><img src="https://habrastorage.org/webt/jg/m4/ah/jgm4ahs5rxpts6cfz_lmq9ycp5m.png"><br><br>  Wie verstehe ich das? <br><br><ul><li> Vom Menschen lesbare Klassennamen <br> <code>isqpwcmx.isfdztgb.adscjobz.nxscomkr.jypbdxnt.utagwpym.wprtdznb.swldgrhm.yrbjpktq.wukovicq;</code> </li> <li>  Nicht erreichbarer Code <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span>) {&lt;/li&gt; String v1 = <span class="hljs-string"><span class="hljs-string">"flnwznvh"</span></span>;&lt;/li&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v1.length() != <span class="hljs-number"><span class="hljs-number">661</span></span> &amp;&amp; v1.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-number"><span class="hljs-number">104</span></span>) {&lt;/li&gt; v1.length();&lt;/li&gt; }</code> </pre> </li><li>  String-Verschlüsselung <br><pre> <code class="java hljs">vcgrnfjx.execSQL(nvhdzjfo.xipswfqb(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"f741f04a4991fc2f0a0029f610bbd1c250dfe115fb7770b892f75d8718b822d273251013991b4407e224fa3f9d4e92f6"</span></span>,<span class="hljs-string"><span class="hljs-string">"378f40211b6e32a5406cd97e85bcf9ad"</span></span>,<span class="hljs-string"><span class="hljs-string">"6378a459b1c20edf"</span></span>, <span class="hljs-string"><span class="hljs-string">"gexnfwok"</span></span>, <span class="hljs-string"><span class="hljs-string">"meazfhdp"</span></span>, <span class="hljs-string"><span class="hljs-string">"bsmotaxn"</span></span>})</code> </pre> </li></ul><br>  Es ist unwahrscheinlich, dass der Programmierer so verrückt war, den Code zunächst zu entwickeln.  Höchstwahrscheinlich benutzte er einen der öffentlich zugänglichen Verschleierer.  Dieser Schritt ist durchaus üblich, um die Code-Analyse zu komplizieren, um beispielsweise das geistige Eigentum zu schützen, aber welche Art von „Wendung“ für den Forscher. <br><br>  Achten wir auf die Hauptverschlüsselungsfunktion: <br><br><img src="https://habrastorage.org/webt/ok/y9/dz/oky9dzmhwwrdykheiepdiuzzlao.png"><br><br>  Die Verschlüsselungsfunktion selbst akzeptiert 3 Eingabezeilen (wenn mehr, macht der Rest keinen Sinn): <br><br><ol><li>  Chiffretext </li><li>  der Schlüssel </li><li>  Initialisierungsvektor für CBC - AES </li></ol><br>  Auf diese Funktion wird im Programm mindestens 213 Mal verwiesen: <br><br><img src="https://habrastorage.org/webt/ok/y9/dz/oky9dzmhwwrdykheiepdiuzzlao.png"><br><br>  Ich stelle fest, dass dies ein wichtiger Schlüssel für die normale Code-Analyse ist.  Als nächstes müssen <s><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Sie denken, dass</a></s> wir die folgenden Möglichkeiten haben, das Programm zu analysieren: <br><br><ol><li>  Stellen Sie die Logik der Funktion wieder her, sammeln Sie alle Aufrufe in der statischen Analyse und entschlüsseln Sie die Zeilen.  Es mag schwierig und lang sein, aber es wird ein 100% iges Ergebnis liefern. </li><li>  Nehmen Sie Änderungen am Smali-Code der Anwendung vor, kompilieren Sie erneut, führen Sie die Anwendung aus und fangen Sie entschlüsselte Zeilen in den Protokollen ab.  Dies ist einfach, aber das Verhalten der Anwendung bei einem bestimmten Start ist nicht bekannt, und Sie sehen möglicherweise nicht das gesamte Bild (es werden nicht alle Funktionen aufgerufen).  Darüber hinaus können Probleme bei der Selbstprüfung durch Anwendung des Zertifikats und (oder) der Integrität auftreten. </li><li>  Wenn es schwierig ist, die Logik der Funktion wiederherzustellen, können Sie alle Funktionsaufrufe sammeln und diese Funktionen mit den erforderlichen Parametern direkt in der Dynamik selbst abrufen (z. B. mithilfe der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Frida-</a> Software). </li></ol><br>  Wir werden Methode Nummer 1 als die strengste zuverlässige wählen. <br><br><h2>  Deobfuscation </h2><br>  Machen Sie sofort eine Reservierung, Deobfuscation ist oft ein langer und langwieriger Prozess, daher müssen Sie Ihren Zeitrahmen richtig einschätzen.  Für unsere Analyse reicht es aus, alle Zeilen zumindest auf irgendeine Weise zu entschlüsseln und dies in kürzester Zeit zu tun, selbst auf Krückenart, als einen Monat lang herumzuspielen, um eine vage ideale Option zu erreichen. <br><br>  Eine qualitativ hochwertige Deobfuscation ist bei vollständigem Reverse Engineering sinnvoll. Beispielsweise müssen Diebe des geistigen Eigentums dies tun, wenn sie versuchen, die Lösung eines Mitbewerbers zu kopieren, oder wenn Sie häufig Programme analysieren müssen, die von einem Obfuscator verarbeitet werden. Dies ist jedoch nicht unser Fall. <br><br>  Quellcode nach JEB Decompiler v.1.4 Decompiler <br><br><div class="spoiler">  <b class="spoiler_title">Spoiler</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">podxiwkt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v6; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v4; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v2; Cipher v1; String v10 = args[<span class="hljs-number"><span class="hljs-number">0</span></span>]; String v7 = args[<span class="hljs-number"><span class="hljs-number">1</span></span>]; String v0 = args[<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { goto label_9; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10.length() != <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_11; } goto label_9; label_11: IvParameterSpec v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IvParameterSpec(v0.getBytes()); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { v1 = Cipher.getInstance(<span class="hljs-string"><span class="hljs-string">"AES/CBC/NoPadding"</span></span>); goto label_15; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(NoSuchPaddingException v3) { } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(NoSuchAlgorithmException v3_1) { } String v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; goto label_10; label_15: SecretKeySpec v9 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SecretKeySpec(v7.getBytes(), <span class="hljs-string"><span class="hljs-string">"AES"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v11_1 = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { v1.init(v11_1, ((Key)v9), ((AlgorithmParameterSpec)v5)); v2 = Base64.decode(v1.doFinal(bwdoclkr.xkvasepi(v10)), <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v2.length &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_48; } v4 = <span class="hljs-number"><span class="hljs-number">0</span></span>; v6 = v2.length - <span class="hljs-number"><span class="hljs-number">1</span></span>; label_29: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v6 &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_38; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v2[v6] != <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_33; } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(Exception v3_2) { goto label_51; } ++v4; label_33: --v6; goto label_29; label_38: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v4 &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_48; } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v8 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[v2.length - v4]; System.arraycopy(v2, <span class="hljs-number"><span class="hljs-number">0</span></span>, v8, <span class="hljs-number"><span class="hljs-number">0</span></span>, v2.length - v4); v2 = v8; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(Exception v3_2) { label_51: v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; goto label_10; } label_48: v11 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(v2); goto label_10; label_9: v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; label_10: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v11; } }</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">Decompiler Hinweis</b> <div class="spoiler_text">  Dex2jar stürzt übrigens oft ab.  In der folgenden Abbildung ist also zu sehen, dass dex2jar Version 2.0 nicht zurechtkommt und nur einen kleinen Code ausgegeben hat. <br><br><img src="https://habrastorage.org/webt/qr/gw/wa/qrgwwazampyf69hicr0-0evyrxe.png"><br><br>  Die neueste Version, die aus den Quellen kompiliert wurde, erzeugte einen dekompilierten Code für diese Funktion, konnte jedoch nicht viele andere dekompilieren (das ist der Trick). <br><br><img src="https://habrastorage.org/webt/66/3v/kp/663vkp2d0rmiwxsbblllpyxpytm.png"><br><br><img src="https://habrastorage.org/webt/i7/n_/8p/i7n_8p01cstevantsmbaxamb7xe.png"><br><br>  Fazit: Überlegen Sie sorgfältig, welchen Dekompiler Sie wählen - dies spart Ihnen viel Zeit und ist einfacher als die Analyse des Smali-Codes. </div></div><br><br>  Wenn wir diesen Code jetzt in die IDE einfügen, funktioniert er aufgrund von Fehlern nicht. <br><br>  <b>Es ist wichtig zu beachten: Der</b> Dekompiler muss keinen gültigen Code erstellen, der vom Entwickler geschrieben wurde.  Er ist nur ein Lebensretter in der Analyse und macht Annahmen darüber, wie der Code geschrieben werden könnte.  In den meisten Fällen ist die Aufgabe, den ursprünglichen Code vollständig wiederherzustellen, nach der Optimierung durch den Compiler nicht mehr trivial. <br><br>  Beispiel für eine schlechte Dekompilierung: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { goto label_9; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10.length() != <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_11; } goto label_9; … label_9: v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v11;</code> </pre> <br>  Wir sehen, dass es schlecht und funktionsunfähig geworden ist.  Wir schreiben um: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((v10 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) || (v10.length() == <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>; }</code> </pre><br>  Jetzt ist es viel klarer, hier ist die übliche Eingabeprüfung.  In diesem Fall brauchen wir: <br><br><ul><li>  Ersetzen Sie alle "goto" durch andere Sprachkonstrukte, as  "Springen" ist seit langem ein ungültiger Operator. </li><li>  Ersetzen Sie Android-Bibliotheksaufrufe durch Java-Bibliotheksaufrufe (wenn wir versuchen, Code in der Java-IDE auszuführen). </li><li>  Fügen Sie abhängige Klassen ein, auf die unser Code verweist. </li><li>  Überlegen Sie selbst, was los ist. </li></ul><br>  Als Ergebnis erhalten wir: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.company; <span class="hljs-comment"><span class="hljs-comment">//package isqpwcmx.isfdztgb.adscjobz.nxscomkr.jypbdxnt.utagwpym.wprtdznb.swldgrhm.yrbjpktq; import java.util.Base64; //import android.util.Base64; //import bnxvhlyg.nkhoirul.zfxogwqi.mdpqejcw.srnepbly.pcbvwxrs.vixdqclm.wnuqvrhp.bnvceayd.bwdoclkr; //   import java.security.Key; import java.security.NoSuchAlgorithmException; import java.security.spec.AlgorithmParameterSpec; import javax.crypto.Cipher; import javax.crypto.NoSuchPaddingException; import javax.crypto.spec.IvParameterSpec; import javax.crypto.spec.SecretKeySpec; public abstract class Main { public Main() { super(); } //hex to ascii public static byte[] xkvasepi(String str) { byte[] v0 = null; if(str != null &amp;&amp; str.length() &gt;= 2) { int v2 = str.length() / 2; v0 = new byte[v2]; int v1; for(v1 = 0; v1 &lt; v2; ++v1) { v0[v1] = ((byte)Integer.parseInt(str.substring(v1 * 2, v1 * 2 + 2), 16)); } } return v0; } public static String podxiwkt(String[] args) { int v6; int v4; byte[] v2; Cipher v1; String v10 = args[0]; //text String v7 = args[1]; //key String v0 = args[2]; //IV //check if ((v10 == null) || (v10.length() == 0)) { return ""; } IvParameterSpec v5 = new IvParameterSpec(v0.getBytes()); try { v1 = Cipher.getInstance("AES/CBC/NoPadding"); } catch(NoSuchPaddingException v3) { return ""; } catch(NoSuchAlgorithmException v3_1) { return ""; } SecretKeySpec v9 = new SecretKeySpec(v7.getBytes(), "AES"); int v11_1 = 2; try { v1.init(v11_1, ((Key)v9), ((AlgorithmParameterSpec)v5)); //v2 = Base64.decode(v1.doFinal(bwdoclkr.xkvasepi(v10)), 0); v2=v1.doFinal(xkvasepi(v10)); //check if(v2.length &lt;= 0) { return new String(v2); } } catch(Exception v3_2) { return ""; } v4=0; for (v6=v2.length-1;v6&gt;=0;v6--){ if (v2[v6]==0) ++v4; } if(v4 &gt; 0) { try { byte[] v8 = new byte[v2.length - v4]; System.arraycopy(v2, 0, v8, 0, v2.length - v4); v2 = v8; } catch (Exception v3_2) { return ""; } } v2 = Base64.getDecoder().decode(v2); return new String(v2); } public static void main(String[] args) { // write your code here System.out.println(podxiwkt(new String[] { "b1acd584a6eae4ca6321b1f7cdf9ba9617112b4fb39e76c8def876346e3032fbd32b2d188a09715f27124c1bf9facfdc", "637904cd08aeb2d3f6a21b5c7e84f519", "8f4c796d5a3120eb", "zcmwgvdn", "mkngbsyr", "rwcdaieu" })); } }</span></span></code> { "b1acd584a6eae4ca6321b1f7cdf9ba9617112b4fb39e76c8def876346e3032fbd32b2d188a09715f27124c1bf9facfdc", "637904cd08aeb2d3f6a21b5c7e84f519", "8f4c796d5a3120eb", "zcmwgvdn", "mkngbsyr", "rwcdaieu"})); <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.company; <span class="hljs-comment"><span class="hljs-comment">//package isqpwcmx.isfdztgb.adscjobz.nxscomkr.jypbdxnt.utagwpym.wprtdznb.swldgrhm.yrbjpktq; import java.util.Base64; //import android.util.Base64; //import bnxvhlyg.nkhoirul.zfxogwqi.mdpqejcw.srnepbly.pcbvwxrs.vixdqclm.wnuqvrhp.bnvceayd.bwdoclkr; //   import java.security.Key; import java.security.NoSuchAlgorithmException; import java.security.spec.AlgorithmParameterSpec; import javax.crypto.Cipher; import javax.crypto.NoSuchPaddingException; import javax.crypto.spec.IvParameterSpec; import javax.crypto.spec.SecretKeySpec; public abstract class Main { public Main() { super(); } //hex to ascii public static byte[] xkvasepi(String str) { byte[] v0 = null; if(str != null &amp;&amp; str.length() &gt;= 2) { int v2 = str.length() / 2; v0 = new byte[v2]; int v1; for(v1 = 0; v1 &lt; v2; ++v1) { v0[v1] = ((byte)Integer.parseInt(str.substring(v1 * 2, v1 * 2 + 2), 16)); } } return v0; } public static String podxiwkt(String[] args) { int v6; int v4; byte[] v2; Cipher v1; String v10 = args[0]; //text String v7 = args[1]; //key String v0 = args[2]; //IV //check if ((v10 == null) || (v10.length() == 0)) { return ""; } IvParameterSpec v5 = new IvParameterSpec(v0.getBytes()); try { v1 = Cipher.getInstance("AES/CBC/NoPadding"); } catch(NoSuchPaddingException v3) { return ""; } catch(NoSuchAlgorithmException v3_1) { return ""; } SecretKeySpec v9 = new SecretKeySpec(v7.getBytes(), "AES"); int v11_1 = 2; try { v1.init(v11_1, ((Key)v9), ((AlgorithmParameterSpec)v5)); //v2 = Base64.decode(v1.doFinal(bwdoclkr.xkvasepi(v10)), 0); v2=v1.doFinal(xkvasepi(v10)); //check if(v2.length &lt;= 0) { return new String(v2); } } catch(Exception v3_2) { return ""; } v4=0; for (v6=v2.length-1;v6&gt;=0;v6--){ if (v2[v6]==0) ++v4; } if(v4 &gt; 0) { try { byte[] v8 = new byte[v2.length - v4]; System.arraycopy(v2, 0, v8, 0, v2.length - v4); v2 = v8; } catch (Exception v3_2) { return ""; } } v2 = Base64.getDecoder().decode(v2); return new String(v2); } public static void main(String[] args) { // write your code here System.out.println(podxiwkt(new String[] { "b1acd584a6eae4ca6321b1f7cdf9ba9617112b4fb39e76c8def876346e3032fbd32b2d188a09715f27124c1bf9facfdc", "637904cd08aeb2d3f6a21b5c7e84f519", "8f4c796d5a3120eb", "zcmwgvdn", "mkngbsyr", "rwcdaieu" })); } }</span></span></code> </pre> <br>  Dieser Code erfüllt erfolgreich.  Nachdem seine Arbeit klar geworden ist, kann sie vereinfacht und vereinfacht werden, was zu der angeblich lakonischen Art führt, die vom Programmierer geschrieben wurde (es sei denn natürlich, seine Hände waren anfangs nicht krumm). <br><br><div class="spoiler">  <b class="spoiler_title">Hinweis</b> <div class="spoiler_text">  Übrigens kann in diesem Fall die Entschlüsselung von Zeichenfolgen mithilfe einer Reihe von Online-Ressourcen demonstriert werden.  Ein Beispiel für den Aufruf einer verschlüsselten Zeichenfolge in einem Programm: <br><br><img src="https://habrastorage.org/webt/wk/0q/h4/wk0qh4-_qox9qigts4orp76gu2u.png"><br><br>  Hier muss zuerst der Initialisierungsvektor in das Hex-Format konvertiert werden: <br><br><img src="https://habrastorage.org/webt/ey/us/ob/eyusob7yodb8dkmiucxaf8mfrpi.png"><br><br>  Ersetzen Sie alle Werte: <br><br><img src="https://habrastorage.org/webt/5j/xd/fg/5jxdfg4z4xyl1qoiqxpdtjzv1hc.png"><br><br>  Und am Ende dekodieren Sie von base64: <br><br><img src="https://habrastorage.org/webt/p6/s4/oy/p6s4oyvyfxrwkoodlfqj0l8c6ii.png"><br><br>  Als Ergebnis erhalten wir die übliche Zeichenfolge, und der Aufruf erhält ein aussagekräftiges Aussehen. <br></div></div><br>  Sie müssen also den gesamten Code durchgehen und alle verschlüsselten Zeichenfolgen sammeln, jetzt können wir sie unabhängig voneinander entschlüsseln.  Der wichtige Punkt hierbei ist, dass wir in der Phase des „Änderns und Kommentierens des Codes“ sowohl auf der Smali-Ebene als auch auf der Java-Ebene (dekompilierte Smali) arbeiten können. <br><br><table><tbody><tr><td width="120"></td><td width="330">  Pluspunkte der Modifikation </td><td width="330">  Nachteile Mods </td></tr><tr><td>  Smali </td><td>  Sie können Änderungen vornehmen, in dex neu kompilieren und mit neuen Zeilen dekompilieren </td><td>  Es ist nicht immer einfach, mit dem Smali-Code zu arbeiten.  Wenn die Änderung nicht korrekt ist, wird die Anwendung nicht kompiliert </td></tr><tr><td>  Java </td><td>  Es ist oft viel einfacher, Daten aus übergeordneten Vorgängen zu extrahieren. </td><td>  Die meisten Java-Code-Viewer können nicht bearbeiten. </td></tr></tbody></table><br>  Ein weiteres Zeilenbeispiel <br><br><pre> <code class="java hljs">vcgrnfjx.execSQL(nvhdzjfo.xipswfqb(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"f741f04a4991fc2f0a0029f610bbd1c250dfe115fb7770b892f75d8718b822d273251013991b4407e224fa3f9d4e92f6"</span></span>,<span class="hljs-string"><span class="hljs-string">"378f40211b6e32a5406cd97e85bcf9ad"</span></span>,<span class="hljs-string"><span class="hljs-string">"6378a459b1c20edf"</span></span>, <span class="hljs-string"><span class="hljs-string">"gexnfwok"</span></span>, <span class="hljs-string"><span class="hljs-string">"meazfhdp"</span></span>, <span class="hljs-string"><span class="hljs-string">"bsmotaxn"</span></span>})</code> </pre> <br>  Von hier aus ist es sehr einfach, Parameter mit einem regulären Ausdruck abzurufen, als einen regulären auf den folgenden Code zu schreiben: <br><br>  <b>Smali-Codebeispiel 1</b> <br><br><pre> <code class="plaintext hljs">00000280 new-instance v13, Ljava/lang/StringBuilder; 00000284 invoke-direct {v13}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;()V 0000028A const/4 v14, 0x6 0000028C new-array v14, v14, [Ljava/lang/String; 00000290 const/4 v15, 0x0 00000292 const-string v16, "f741f04a4991fc2f0a0029f610bbd1c250dfe115fb7770b892f75d8718b822d273251013991b4407e224fa3f9d4e92f6" 00000296 aput-object v16, v14, v15 0000029A const/4 v15, 0x1 0000029C const-string v16, "378f40211b6e32a5406cd97e85bcf9ad" 000002A0 aput-object v16, v14, v15 000002A4 const/4 v15, 0x2 000002A6 const-string v16, "6378a459b1c20edf" 000002AA aput-object v16, v14, v15 000002AE const/4 v15, 0x3 000002B0 const-string v16, "gexnfwok" 000002B4 aput-object v16, v14, v15 000002B8 const/4 v15, 0x4 000002BA const-string v16, "meazfhdp" 000002BE aput-object v16, v14, v15 000002C2 const/4 v15, 0x5 000002C4 const-string v16, "bsmotaxn" 000002C8 aput-object v16, v14, v15</code> </pre> <br><br>  <b>Smali-Codebeispiel 2</b> <br><br><pre> <code class="plaintext hljs">0000008E new-array v0, v0, [Ljava/lang/String; 00000092 move-object/from16 v89, v0 00000096 const/16 v90, 0x0 0000009A const-string v91, "4500b5e2e2ad26b7545eb54d70ab360ae28c9d031e2afcc3f6a2b2ac488ea440" 0000009E aput-object v91, v89, v90 000000A2 const/16 v90, 0x1 000000A6 const-string v91, "da96f678922d4b07350b3a184ecc1f5e" 000000AA aput-object v91, v89, v90 000000AE const/16 v90, 0x2 000000B2 const-string v91, "0cf69e3d2745a1b8" 000000B6 aput-object v91, v89, v90 000000BA const/16 v90, 0x3 000000BE const-string v91, "jhiqsaoe" 000000C2 aput-object v91, v89, v90 000000C6 const/16 v90, 0x4 000000CA const-string v91, "khbqxurn" 000000CE aput-object v91, v89, v90</code> </pre> <br><br>  <b>Smali-Codebeispiel 3</b> <br><br><pre> <code class="plaintext hljs">00000D3E new-array v0, v0, [Ljava/lang/String; 00000D42 move-object/16 v298, v0 00000D48 const/4 v0, 0x0 00000D4A move/16 v299, v0 00000D50 const-string v0, "b286945744e085f4d5c19916fd261481" 00000D54 move-object/16 v300, v0 00000D5A move-object/from16 v0, v300 00000D5E move-object/from16 v1, v298 00000D62 move/from16 v2, v299 00000D66 aput-object v0, v1, v2 00000D6A const/4 v0, 0x1 00000D6C move/16 v299, v0 00000D72 const-string v0, "df6883742b2911ac5ac7b4dee065390f" 00000D76 move-object/16 v300, v0 00000D7C move-object/from16 v0, v300 00000D80 move-object/from16 v1, v298 00000D84 move/from16 v2, v299 00000D88 aput-object v0, v1, v2 00000D8C const/4 v0, 0x2 00000D8E move/16 v299, v0 00000D94 const-string v0, "90a463ce2df17b58" 00000D98 move-object/16 v300, v0 00000D9E move-object/from16 v0, v300 00000DA2 move-object/from16 v1, v298 00000DA6 move/from16 v2, v299 00000DAA aput-object v0, v1, v2 00000DAE const/4 v0, 0x3 00000DB0 move/16 v299, v0 00000DB6 const-string v0, "cupyzsgq" 00000DBA move-object/16 v300, v0 00000DC0 move-object/from16 v0, v300 00000DC4 move-object/from16 v1, v298 00000DC8 move/from16 v2, v299 00000DCC aput-object v0, v1, v2</code> </pre> <br><br>  Wie wir sehen, ändern sich die internen Variablen, die Reihenfolge der Befehle variiert, die Anzahl der Argumente variiert ebenfalls. Außerdem wird im Programm die Entschlüsselungsfunktion nicht direkt, sondern über die Funktionen der Schicht aufgerufen.  Versuchen Sie, selbst eine Regel zu schreiben, um nach diesem Konstrukt zu suchen, Fehler beim Erfassen von Zeichenfolgen aus anderen Funktionen zu vermeiden und dies alles schnell zu tun ( <s>viel Glück</s> ). <br><br>  Fallenplan: <br><br><ol><li>  Wir werden alle Werte aus dem dekompilierten Code extrahieren. </li><li>  Entschlüsseln. </li><li>  Ersetzen Sie den Chiffretext durch den offenen im Smali-Code.  Wir ersetzen zum Beispiel anstelle des ersten Operators.  (Es wäre professioneller, den gesamten Funktionsaufruf auszuschneiden und die zurückgegebene entschlüsselte Zeichenfolge zu belassen, aber andererseits besteht ein großes Risiko, dass das Programm beschädigt wird.) </li><li>  Sammeln wir den Smali-Code in einer Dex-Datei. </li><li>  Es wird zweckmäßig sein, weiter in den Code-Analysator zu schauen, in dem wir begonnen haben. </li></ol><br>  Wenn Sie den gesamten dekompilierten Code in einer einzigen Datei zusammenfassen, erhalten Sie ungefähr 20.000 Zeilen, was für die manuelle Analyse viel Zeit erfordert, was deutlich mehr kostet als die Stiefel, die ich zum Verkauf angeboten habe.  Sammeln Sie zunächst alle Zeilen mit einem regulären Ausdruck. <br><br><img src="https://habrastorage.org/webt/gq/42/ln/gq42ln2llsfpoxt2yjw0orhfr2m.png"><br><br>  Wir sehen 593 Spiele, plus ein Dutzend, die nicht unter diese Regel fallen, <s>die Familie hat ihre schwarzen Schafe</s> .  Ein Beispiel: <br><br><img src="https://habrastorage.org/webt/zw/bn/5y/zwbn5y1ghfnrf8i3auethghnzdo.png"><br><br>  Sortieren, filtern, insgesamt 422 eindeutige Zeilen: <br><br><img src="https://habrastorage.org/webt/en/c1/ji/enc1jiwqkssvsa3irluzvvxfyzu.png"><br><br>  Wir durchlaufen die zuvor wiederhergestellte Entschlüsselungsfunktion.  Ergebnis: <br><br><img src="https://habrastorage.org/webt/cv/no/op/cvnoopawvfln2h4yq-ducg3zite.png"><br><br>  Ersetzen Sie den Chiffretext mit Python durch den offenen im Smali-Code: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os words_replace=dict() words_replace[<span class="hljs-string"><span class="hljs-string">"0018aacad3d146266317d8d8c51785fd"</span></span>]=<span class="hljs-string"><span class="hljs-string">"imei"</span></span> words_replace[<span class="hljs-string"><span class="hljs-string">"016d15e4d0a72667c61428e736a6f3b8"</span></span>]=<span class="hljs-string"><span class="hljs-string">"WakeLock"</span></span> words_replace[<span class="hljs-string"><span class="hljs-string">"032c534efb6c9990cd845a08c5a08b95"</span></span>]=<span class="hljs-string"><span class="hljs-string">"inbox"</span></span> #…  .. # smali- #      <span class="hljs-function"><span class="hljs-function">def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">change</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"file="</span></span></span></span><span class="hljs-function"><span class="hljs-params">+path)</span></span></span><span class="hljs-function"> file_handle </span></span>= open(path, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) context_full = file_handle.read() file_handle.close() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i in words_replace: context_full=context_full.replace(i, words_replace[i]) #print (i+<span class="hljs-string"><span class="hljs-string">""</span></span>+words_replace[i]) file_handle = open(path, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) context_full = file_handle.write(context_full) file_handle.close() #      smali- <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> top, dirs, files in os.walk(<span class="hljs-string"><span class="hljs-string">'C:\\work\\test'</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> nm in files: path=os.path.join(top, nm) print (path) change(path)</code> </pre> <br>  Wir sammeln kleine Dateien in Dex: <br><br><img src="https://habrastorage.org/webt/dz/41/qz/dz41qzrvcue-bl2j-vb2jp4cw_w.png"><br><br>  Dies kann nun irgendwie analysiert werden (indem das erste Argument aus der gesamten Konstruktion gelesen wird): <br><br><img src="https://habrastorage.org/webt/ik/5g/ro/ik5grom-c0igb9zqgh-hzdhf6yg.png"><br><br><h2>  Analyse </h2><br>  Wir haben also 20.000 mehr oder weniger lesbare Codezeilen. Wir müssen keine vollständige Analyse durchführen.  Es ist notwendig, die Funktionalität als Ganzes zu verstehen.  Hier ist in der Tat nur die Fähigkeit erforderlich, Java-Quellcode zu lesen.  Gehen Sie durch den Code, sehen Sie sich Querverweise an, benennen Sie Variablen und Funktionen um. <br><br>  Was ist der beste Weg, um eine Android-Anwendung zu analysieren, insbesondere eine große? <br><br>  <b>Option 1: Sie können aus der Manifest-Datei wechseln</b> <br><br>  Versuchen Sie beispielsweise nacheinander von LAUNCHER, die gesamte Anrufkette abzuwickeln.  Vergessen Sie übrigens nicht, dass es immer noch "Empfänger" und "Dienst" gibt, die die lineare Ausführung des Programms ändern können. <br><br><img src="https://habrastorage.org/webt/hk/rd/j1/hkrdj1deeuxaq294dxfpgswr1pu.png"><br><br><div class="spoiler">  <b class="spoiler_title">Vollständige Manifestdatei</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8" standalone="no"?&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:installLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"internalOnly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft.permission.C2D_MESSAGE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.permission.RECEIVE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SEND_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_PHONE_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WAKE_LOCK"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SYSTEM_ALERT_WINDOW"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.MODIFY_AUDIO_SETTINGS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CHANGE_NETWORK_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_WIFI_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CHANGE_WIFI_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft.permission.C2D_MESSAGE"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:protectionLevel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"signature"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:allowBackup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/tgiwmpqy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:noHistory</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:excludeFromRecents</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/tgiwmpqy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"zemquyog.csrtmnak.xrkfygen.wkahrnjd.acnfunjh.rgipxbuf.lruiwxeg.blqndche.dcjihbou"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xbfrscou.hxrvwnoi.djvpcqri.enlnrfio.aoegxbiu.heywzmnb.znfnxcht.nazcxobq"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hcfkagds.timkagsd.oetvghzr.fcioynvl.psynofdj.slcghdjz.tapnwsdk.gzvwnban.htenafdb.qwebhzgy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:noHistory</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:excludeFromRecents</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"njfbwmre.voefarqx.ftuxvngl.wrmshxqj.zdenywgn.eiwyunlg.jysgkbam.yrijthab.vstqxpuo.iplamgxf"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483647"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gfbaznoc.asyoqtnm.kbetoqca.mqysobzu.gqwfibrv.dorxijuk.wgzkmiep.ywnnurzv.csfpqhrn"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BIND_DEVICE_ADMIN"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/pkzrlscm"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@xml/ynqukvnb"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483646"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.app.action.DEVICE_ADMIN_ENABLED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ykwbodxc.gymjhibn.kgmdfqor.hbasvmfz.yegkmaif.ortzknvm.quplincn.cuxytvhs.fqonzuts.cyuoxgqi.znumwyct"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.permission.SEND"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.intent.RECEIVE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.intent.REGISTRATION"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.intent.UNREGISTRATION"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:exported</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"kqwihjot.nvkqjloc.grjnyknm.owydvckh.mugknwdx.enhcyvja.mhvbpcue.ztbwjhfo"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483646"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.LOCKED_BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.htc.intent.action.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.USER_PRESENT"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BATTERY_OKAY"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BATTERY_LOW"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.ACTION_POWER_CONNECTED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.ACTION_POWER_DISCONNECTED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.APP_ERROR"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.HEADSET_PLUG"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PHONE_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.NEW_OUTGOING_CALL"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.TIME_TICK"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.SCREEN_ON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.SCREEN_OFF"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.net.conn.CONNECTIVITY_CHANGE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.net.wifi.WIFI_STATE_CHANGED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.DREAMING_STOPPED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.HOME"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btnsxnuz.wmjizbky.lynvjxqz.zinomjuv.yizlgcnf.qwoikgnc.wnrskjea.wfqgmeny.lcgvqrms.ocwkgblp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483646"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ltvsrezg.ehxndrat.twnnyxrf.nqynefws.dhbalcnr.ynjkuxod.nhoxmsbq.nackoyhn.voycgfek.znhwkqba.taxvnfyn"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rbnakfzo.qsreiubk.pwvlnngs.twoxnhfv.mftarcnd.pfioxcub.xjlaftqr.nxrqvlwh"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft.ugshpjvo"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  <b>Option 2: Sie können von interessanten Linien wechseln</b> <br><br><img src="https://habrastorage.org/webt/ey/vs/oe/eyvsoe_svrnkzau5dfdp4yvht7g.png"><br><br><div class="spoiler">  <b class="spoiler_title">Teil entschlüsselter Zeichenfolgen</b> <div class="spoiler_text"><pre> <code class="bash hljs">system_update.apk () () , error = , unregistered = ,  .permission.C2D_MESSAGE //sky-sync.pw/ //sms/inbox /system_update.apk ALLCONTACTS ALLMSG AUTHENTICATION_FAILED Acquiring wakelock Application BLOCKER_BANKING_START BLOCKER_EXTORTIONIST_START BLOCKER_STOP BLOCKER_UPDATE_START Banking CHANGE_GCM_ID CONTACTS CONTACTS_PRO CREATE TABLE IF NOT EXISTS END Error|No process list|No access Extortionist Foreground GCM returned invalid number of GCMBaseIntentService GCMBroadcastReceiver GCMIntentService- GCMRegistrar GCM_LIB GET MESSAGE Mobile Network NEWMSG Not retrying failed operation ONLINE PAGE POST Process finished with <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> code 0 RESTART Received deleted messages Registering receiver Releasing wakelock SERVICE_NOT_AVAILABLE SSL START STOP Saving regId on app version Scheduling registration retry, backoff = Setting registeredOnServer status as Stop System UNBLOCK UPDATE UPDATE_PATTERNS URL UTF-8 Update WakeLock Wakelock reference is null Wi-Fi WiMax _success add_msg_ok address android.intent.action.QUICKBOOT_POWERON answer_text answer_to api_url app appVersion application application/vnd.android.package-archive apps_list ask backoff_ms blocker blocker_banking blocker_banking_autolock blocker_banking_forced_access blocker_banking_success blocker_extortionist blocker_extortionist_autolock blocker_extortionist_forced_access blocker_extortionist_success blocker_update blocker_update_forced_access blocker_update_success body build callback cardSuccess check com.android.settings com.google.android.c2dm.intent.RECEIVE com.google.android.c2dm.intent.REGISTER com.google.android.c2dm.intent.REGISTRATION com.google.android.c2dm.intent.UNREGISTER com.google.android.gcm com.google.android.gcm.intent.RETRY com.google.android.gsf com.htc.intent.action.QUICKBOOT_POWERON <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> command_receive contactslist country data date delete deleted_messages device_block disableDataConnectivity enableDataConnectivity error failure file deleted. first_start force-locked gafzpjxb.cix gcm gcm_id gcm_register gcm_register_ok getITelephony get_message_list id <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> primary key autoincrement, id=? imei immunity inbox init_bootable init_imei is_admin is_awake_display is_imunnity is_locked is_network_type is_top_activity job job_date job_id komgejif.hqr locked message message_delivered message_type method model msg msg_id msglist name not nypjtinq.nvp ok onServer onServerExpirationTime onServerLifeSpan operator org.android.sys.admin.disabled org.android.sys.admin.enabled org.android.sys.admin.request org.android.sys.command.receive org.android.sys.launch.first org.android.sys.sms.pro.sent org.android.sys.sms.push org.android.sys.sms.sent outbox page params pattern patterns personal phone phone_list privet process_list protocol qwertyuiopasdfghjklzxcvbnm receive regId regex register register_ok registrationId = registration_id repeat resetting backoff <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ru save_contacts_list save_message_history sender sent sent_status sid ss status stop_blocker text text, text/html time token total_deleted <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> unknown unregistered until url useragent utf-8 value version xpls yes   !     ...                   !  ?                !</code> </pre> </div></div><br>  <b>Option 3: Sie können von interessanten Ressourcen (Assets, Bibliotheken) wechseln.</b> <br><br>  In diesem Fall war Option 3 vorzuziehen.  Es gibt drei interessante HTML-Dateien im Ordner / assets (apk container).  Hier ist ihre Ansicht im Browser: <br><br><img src="https://habrastorage.org/webt/4y/rg/ep/4yrgepcm5xja-nfzbjpcbsiuvzc.png"><img src="https://habrastorage.org/webt/y8/8q/jw/y88qjwn-fy-fikqujjbxsbq3are.png"><br><br><img src="https://habrastorage.org/webt/eo/cf/um/eocfum1acs28e-4ljvqt3yiufci.png"><br><br>  Für das offizielle Avito-Überweisungsprogramm sieht es zweifelhaft aus, scheint es Ihnen nicht so?  Verfolgen wir, was passiert, wenn Sie die Taste drücken, um Bankdaten auf der Seite mit dem Sberbank-Logo zu senden.  JavaScript ruft die Funktion <code>sendCardData()</code> : <br><br><img src="https://habrastorage.org/webt/v5/aq/sy/v5aqsyuab0lbn4clzhpk4uy4r88.png"><br><br>  Und dann wird es durch den Aufruf <code>ok.performClick()</code> in Java-Code übertragen: <br><br><img src="https://habrastorage.org/webt/p4/cv/av/p4cvavqi00ja2bdmryikgcotn34.png"><br><br>  In Java-Code wird Folgendes verarbeitet: <br><br><img src="https://habrastorage.org/webt/sq/2m/x_/sq2mx_tfwvmi0iudzgksecj6dcs.png"><br><br>  Darüber hinaus wird dies alles in der <code>mcrypt</code> Klasse verschlüsselt: <br><br><img src="https://habrastorage.org/webt/cr/aw/00/craw00nuksdczckxfxc04gclvru.png"><br><br>  Innerhalb der Funktion werden Daten auf die gleiche Weise wie zuvor betrachtet verschlüsselt: <br><br><img src="https://habrastorage.org/webt/ov/-j/vk/ov-jvkpta1b6qodmshafhthurya.png"><br><br>  Im Übrigen sind die Schlüssel fest verdrahtet: <br><br><img src="https://habrastorage.org/webt/rd/uc/2b/rduc2bigmg29xzvjmkuuetekd68.png"><br><br>  Wir versuchen, über die Online-Ressource zu entschlüsseln: <br><br><img src="https://habrastorage.org/webt/yx/uw/we/yxuwwe6fls64izf_rcxbky_0m3a.png"><br><br>  Und konvertieren Sie von base64.  Erfolg!  Wir können alle Anwendungsdaten entschlüsseln: getestet auf zuvor erfassten Datenverkehr. <br><br><div class="spoiler">  <b class="spoiler_title">Die Anwendung meldet dem Server alle Ereignisse</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">{ "sid":15, "imei":"861117030537111", "phone":"System", "message":"     22.10.2018 23:30:47", "time":"1540240247", "msg_id":1, "status":"unknown", "type":"inbox", "method":"message" }</code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Außerdem werden regelmäßig alle laufenden Anwendungen übertragen</font></font></b> <div class="spoiler_text"><pre> <code class="plaintext hljs">{ "sid": 15, "imei": "861117030537111", "country": "ru", "operator": "MTS RUS", "phone": "", "model": "Xiaomi Redmi 3X", "version": "6.0.1", "application": "", "build": "30.0.2", "process_list": [ "Background|com.android.bluetooth|com.android.bluetooth.hid.HidService", "Background|com.android.settings:remote|com.android.settings.wifi.MiuiWifiService", "Background|com.android.phone|org.codeaurora.ims.ImsService", "Background|system|com.qualcomm.location.LocationService", ..., "Background|xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft|ltvsrezg.ehxndrat.twnnyxrf.nqynefws.dhbalcnr.ynjkuxod.nhoxmsbq.nackoyhn.voycgfek.znhwkqba.taxvnfyn" ], "apps_list": [ "com.introspy.config", "com.google.android.youtube", "com.google.android.googlequicksearchbox", "org.telegram.messenger", ..., "com.google.android.inputmethod.latin", "jakhar.aseem.diva" ], "method": "register" }</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn ich ein Fenster für die Eingabe von Bankdaten in der Dynamik hätte, wären die Daten im Verkehr. </font><font style="vertical-align: inherit;">Wir können daher den Schluss ziehen, dass dies eine "Phishing" -Anwendung ist. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Diejenigen, die vorsichtig waren, bemerkten, dass die Manifest-Datei einige Berechtigungen hat und die Anwendung eine umfassendere Funktionalität aufweist. </font><font style="vertical-align: inherit;">Wir werden eine eingehende Analyse der Funktionalität in einem anderen Artikel durchführen. </font><font style="vertical-align: inherit;">In der Zwischenzeit Erfolg!</font></font><br><br><h2>  Schlussfolgerungen </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ich bin enttäuscht, dass ich keine Stiefel verkauft habe. </font><font style="vertical-align: inherit;">Und die Schlussfolgerungen lauten wie folgt:</font></font><br><br><ul><li> <s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Verkaufen Sie keine Stiefel bei Avito</font></font></s> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Klicken Sie nicht auf obskure Links (auch wenn Sie von Freunden stammen und „wenn Sie dringend 100 Rubel ausleihen müssen - eine Frage von Leben und Tod“). </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Laden Sie keine anderen Anwendungen als Google Play oder den AppStore herunter </font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Trennen Sie die Installation von "unzuverlässigen Quellen", wenn Sie wirklich nicht verstehen, was was ist. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Trennen Sie "Play Protection" nicht. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Denken Sie daran, dass Google Play </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">möglicherweise Malware enthält</font></font></a> </li></ul></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Installieren Sie Antivirus auf dem Telefon (es funktioniert wirklich). </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie ein Entwickler sind, verschleiern Sie den Code nicht, lassen Sie die Leute auf Ihre guten Absichten achten </font><i><font style="vertical-align: inherit;">(</font></i><font style="vertical-align: inherit;"> nur ein Scherz </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></i> </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wenn Sie ein Forscher sind, arbeiten Sie nicht für Lebensmittel, analysieren Sie Anwendungen in Ihrer Freizeit und veröffentlichen Sie Berichte. </font><font style="vertical-align: inherit;">Gemeinsam werden wir die Welt zu einem besseren Ort machen.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> PS Ich habe versucht, den Artikel leicht in einem humorvollen Format zu schreiben und ihn so einfach wie möglich einzureichen, weil selbst ich am Freitag wahrscheinlich keinen ernsthaften Longride namens "Reverse Engineering einer verschleierten bösartigen Android-Anwendung" lesen möchte. </font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de430074/">https://habr.com/ru/post/de430074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de430062/index.html">Microservices. Entwicklungs- und Refactoring-Muster mit Java-Beispielen</a></li>
<li><a href="../de430064/index.html">C ++: eine Sitzung der spontanen Archäologie und warum Sie keine variablen Funktionen im Stil von C verwenden sollten</a></li>
<li><a href="../de430068/index.html">Ordnung der Puppe</a></li>
<li><a href="../de430070/index.html">Stapel und Warteschlange sind zwei schlechte Paradigmen und was kann dagegen getan werden?</a></li>
<li><a href="../de430072/index.html">Serverseitig Swift Underestimated: Interview mit Paul Hudson</a></li>
<li><a href="../de430076/index.html">Kostenlose Ausstrahlung von DotNext 2018 Moskau</a></li>
<li><a href="../de430078/index.html">So steuern Sie Elektrogeräte, funkgesteuerte Modelle und motorisierte Kinderwagen mit einem Blick</a></li>
<li><a href="../de430080/index.html">Wechseln zu einem Cluster mit 1C-Bitrix: Web Environment</a></li>
<li><a href="../de430082/index.html">Travinibay: Habr und RUVDS - Russische IT-Seewölfe</a></li>
<li><a href="../de430084/index.html">Oracle JDK muss bezahlen. Was sind jetzt die Optionen?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>