<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🀄️ 🕡 👩🏿‍🤝‍👩🏻 SwiftUI: création de sections extensibles / réductibles en mode liste 🧞 🎱 🤦🏼</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Une tâche courante dans le développement iOS est les sections extensibles / pliantes dans UITableView. Aujourd'hui, nous réalisons cette tâche en util...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>SwiftUI: création de sections extensibles / réductibles en mode liste</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/475270/"><img src="https://habrastorage.org/webt/o8/r2/ph/o8r2phse6o2rfyhxcaf3vqkqm_q.gif"><br><br>  Une tâche courante dans le développement iOS est les sections extensibles / pliantes dans UITableView.  Aujourd'hui, nous réalisons cette tâche en utilisant SwiftUI.  En guise de petite torsion, ajoutez un triangle animé dans l'en-tête de la section et agrandissez également les cellules. <br><br>  Le développement a eu lieu sur Xcode 11.2 pour macOS Catalina 10.15.1 <br><a name="habracut"></a><br><h2>  Lancer le projet </h2><br>  Lancez Xcode, File - New Project - Single View App.  Dans la boîte de dialogue, spécifiez le langage de développement Swift, nous formerons l'interface utilisateur à l'aide de SwiftUI. <br><br><img src="https://habrastorage.org/webt/rj/vj/ob/rjvjobred-ljy2nnvdarmy0xjy4.png"><br><br><h2>  Les données </h2><br>  Comme données de démonstration, nous utiliserons plusieurs expressions amusantes ailées en latin avec leur traduction en russe. <br><br>  Ajoutez un nouveau fichier Swift au projet, appelez-le <b>Data.swift</b> et écrivez ce qui suit: <br><br><pre><code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QuoteDataModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Identifiable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id: <span class="hljs-type"><span class="hljs-type">String</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> latin } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> latin : <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> russian : <span class="hljs-type"><span class="hljs-type">String</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> expanded = <span class="hljs-literal"><span class="hljs-literal">false</span></span> } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SectionDataModel</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Identifiable</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id: <span class="hljs-type"><span class="hljs-type">Character</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> letter } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> letter : <span class="hljs-type"><span class="hljs-type">Character</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> quotes : [<span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> expanded = <span class="hljs-literal"><span class="hljs-literal">false</span></span> }</code> </pre> <br>  <b>QuoteDataModel</b> est un modèle d'une expression unique, à l'avenir, il deviendra le contenu de chaque cellule individuelle.  Nous y stockons le texte original de l'expression, sa traduction et le signe de la cellule «développée» (par défaut, il est «minimisé») <br><br>  <b>SectionDataModel</b> est un modèle de chaque section distincte, ici nous stockons la "lettre" de la section, un tableau de citations commençant par cette lettre et également un signe de la section "développée" (par défaut également "réduite") <br><br>  À l'avenir, nous afficherons tout cela dans une vue de liste, ce qui nécessite que les données correspondant soient conformes au protocole <b>identifiable</b> .  Pour ce faire, nous définissons la propriété <b>id</b> , qui doit être unique pour chaque élément de la liste. <br><br>  De plus, dans le même fichier Data.swift, nous formons nos données: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> latinities : [<span class="hljs-type"><span class="hljs-type">SectionDataModel</span></span>] = [ <span class="hljs-type"><span class="hljs-type">SectionDataModel</span></span>(letter: <span class="hljs-string"><span class="hljs-string">"C"</span></span>, quotes: [ <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Calvitium non est vitium, sed prudentiae indicium."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"  ,   ."</span></span>), <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Conjecturalem artem esse medicinam."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"   ."</span></span>), <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Crede firmiter et pecca fortiter!"</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"    !"</span></span>)]), <span class="hljs-type"><span class="hljs-type">SectionDataModel</span></span>(letter: <span class="hljs-string"><span class="hljs-string">"H"</span></span>, quotes: [ <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Homo sine religione sicut equus sine freno."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"      ."</span></span>), <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Habet et musca splenem."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"   ."</span></span>)]), <span class="hljs-type"><span class="hljs-type">SectionDataModel</span></span>(letter: <span class="hljs-string"><span class="hljs-string">"M"</span></span>, quotes: [ <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Malum est mulier, sed necessarium malum."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"   ,   ."</span></span>), <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Mulierem ornat silentium."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"  ."</span></span>)])]</code> </pre> <br><h2>  Traitons de l'interface </h2><br>  Nous allons maintenant déterminer à quoi ressemblera l'en-tête de section et chaque cellule. <br><br>  Choisissez Fichier - Nouveau - Fichier - Vue SwiftUI dans le menu.  Nommez le fichier <b>HeaderView.swift</b> et remplacez son contenu par ce qui suit: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SwiftUI struct HeaderView : View { var section : SectionDataModel var body: some View { HStack() { Spacer() Text(String(section.letter)) .font(.largeTitle) .foregroundColor(Color.black) Spacer() } .background(Color.yellow) } } struct HeaderView_Previews: PreviewProvider { static var previews: some View { HeaderView(section: latinities[0]) } }</code> </pre> <br><img src="https://habrastorage.org/webt/4w/os/vp/4wosvpywhjhnbqikml5w3btumoo.png"><br><br>  Maintenant à nouveau Fichier - Nouveau - Fichier - Vue SwiftUI.  Nommez le fichier <b>QuoteView.swift</b> et remplacez son contenu par ce qui suit: <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> SwiftUI struct QuoteView: View { var quote : QuoteDataModel var body: some View { VStack(alignment: .leading, spacing: 5) { Text(quote.latin) .font(.title) if quote.expanded { Group() { Divider() Text(quote.russian).font(.body) }.transition(.move(edge: .top)).animation(.default) } } } } struct QuoteView_Previews: PreviewProvider { static var previews: some View { QuoteView(quote: latinities[0].quotes[0]) } }</code> </pre><br><img src="https://habrastorage.org/webt/gv/9l/wj/gv9lwj6nbqsbzijqhktuvechcrg.png"><br><br>  Ouvrez maintenant le fichier ContentView.swift et modifiez la structure de ContentView comme suit: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ContentView</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">View</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">List</span></span> { <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(latinities) { section <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Section</span></span>(header: <span class="hljs-type"><span class="hljs-type">HeaderView</span></span>(section: section), footer: <span class="hljs-type"><span class="hljs-type">EmptyView</span></span>()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> section.expanded { <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(section.quotes) { quote <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">QuoteView</span></span>(quote: quote) } } } } } .listStyle(<span class="hljs-type"><span class="hljs-type">GroupedListStyle</span></span>()) } }</code> </pre> <br>  Félicitations, vous venez de remplir la liste avec des données à jour!  Pour chaque élément du tableau des <b>latinités,</b> nous créons une section avec un en-tête basé sur <b>HeaderView</b> et un pied de page vide.  Si la section est «développée», alors pour chaque expression dans le tableau des citations, nous formons une cellule basée sur <b>QuoteView</b> .  Dans nos données, toutes les sections et toutes les cellules sont «réduites», donc si vous rendez le canevas visible, vous ne verrez que les en-têtes de section: <br><br><img src="https://habrastorage.org/webt/4v/cp/se/4vcpseupvpjvdsezawsfyczweja.png"><br><br>  Comme vous le comprenez, l'application est maintenant complètement «morte» et encore loin de notre objectif final.  Mais bientôt nous allons le réparer! <br><br><h2>  Modifier légèrement l'en-tête de section </h2><br>  Revenez au fichier HeaderView.swift.  À l'intérieur de la structure HeaderView, immédiatement après le corps, ajoutez ceci: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Triangle</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Shape</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">path</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">in</span></span></span></span><span class="hljs-function"><span class="hljs-params"> rect: CGRect)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Path</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> path = <span class="hljs-type"><span class="hljs-type">Path</span></span>() path.move(to: <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: <span class="hljs-number"><span class="hljs-number">0</span></span>, y: <span class="hljs-number"><span class="hljs-number">0</span></span>)) path.addLine(to: <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: <span class="hljs-number"><span class="hljs-number">0</span></span>, y: rect.height - <span class="hljs-number"><span class="hljs-number">1</span></span>)) path.addLine(to: <span class="hljs-type"><span class="hljs-type">CGPoint</span></span>(x: sqrt(<span class="hljs-number"><span class="hljs-number">3</span></span>)*(rect.height)/<span class="hljs-number"><span class="hljs-number">2</span></span>, y: rect.height/<span class="hljs-number"><span class="hljs-number">2</span></span>)) path.closeSubpath() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> path } }</code> </pre> <br>  Cette structure renvoie un triangle équilatéral.  Ajoutez maintenant notre triangle à l'en-tête.  À l'intérieur du <b>HStack</b> , avant le premier <b>Spacer,</b> ajoutez ceci: <br><br><pre> <code class="swift hljs"><span class="hljs-type"><span class="hljs-type">Triangle</span></span>() .fill(<span class="hljs-type"><span class="hljs-type">Color</span></span>.black) .overlay( <span class="hljs-type"><span class="hljs-type">Triangle</span></span>() .stroke(<span class="hljs-type"><span class="hljs-type">Color</span></span>.red, lineWidth: <span class="hljs-number"><span class="hljs-number">5</span></span>) ) .frame(width : <span class="hljs-number"><span class="hljs-number">50</span></span>, height : <span class="hljs-number"><span class="hljs-number">50</span></span>) .padding() .rotationEffect(.degrees(section.expanded ? <span class="hljs-number"><span class="hljs-number">90</span></span> : <span class="hljs-number"><span class="hljs-number">0</span></span>), anchor: .<span class="hljs-keyword"><span class="hljs-keyword">init</span></span>(x: <span class="hljs-number"><span class="hljs-number">0.5</span></span>, y: <span class="hljs-number"><span class="hljs-number">0.5</span></span>)).animation(.<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>))</code> </pre> <br><img src="https://habrastorage.org/webt/5l/u6/wi/5lu6wise_clhtwxwenjrkmcpbuc.png"><br><br><h2>  Modifier les données </h2><br>  Retour à nos données.  Ouvrez Data.swift et <b>enveloppez</b> notre tableau de <b>latinités</b> dans une nouvelle classe UserData, comme ceci: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserData</span></span></span><span class="hljs-class"> : </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ObservableObject</span></span></span><span class="hljs-class"> </span></span>{ @<span class="hljs-type"><span class="hljs-type">Published</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> latinities : [<span class="hljs-type"><span class="hljs-type">SectionDataModel</span></span>] = [ <span class="hljs-type"><span class="hljs-type">SectionDataModel</span></span>(letter: <span class="hljs-string"><span class="hljs-string">"C"</span></span>, quotes: [ <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Calvitium non est vitium, sed prudentiae indicium."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"  ,   ."</span></span>), <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Conjecturalem artem esse medicinam."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"   ."</span></span>), <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Crede firmiter et pecca fortiter!"</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"    !"</span></span>)]), <span class="hljs-type"><span class="hljs-type">SectionDataModel</span></span>(letter: <span class="hljs-string"><span class="hljs-string">"H"</span></span>, quotes: [ <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Homo sine religione sicut equus sine freno."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"      ."</span></span>), <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Habet et musca splenem."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"   ."</span></span>)]), <span class="hljs-type"><span class="hljs-type">SectionDataModel</span></span>(letter: <span class="hljs-string"><span class="hljs-string">"M"</span></span>, quotes: [ <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Malum est mulier, sed necessarium malum."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"   ,   ."</span></span>), <span class="hljs-type"><span class="hljs-type">QuoteDataModel</span></span>(latin: <span class="hljs-string"><span class="hljs-string">"Mulierem ornat silentium."</span></span>, russian: <span class="hljs-string"><span class="hljs-string">"  ."</span></span>)])] }</code> </pre> <br>  N'oubliez pas de marquer également les latinités comme <b>@Published</b> . <br><br><div class="spoiler">  <b class="spoiler_title">Qu'avons-nous fait?</b> <div class="spoiler_text">  <b>ObservableObject</b> est un objet spécial pour nos données qui peut être «lié» à une vue.  SwiftUI "surveille" toutes les modifications susceptibles d'affecter la vue et, une fois les données modifiées, modifie la vue. <br></div></div><br>  Après le "wrapping" des latinités, nous avons eu beaucoup d'erreurs, nous allons les corriger.  Ouvrez <b>HeaderView.swift</b> et corrigez la structure de <b>HeaderView_Previews</b> comme suit: <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HeaderView_Previews</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PreviewProvider</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> previews: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">HeaderView</span></span>(section: <span class="hljs-type"><span class="hljs-type">UserData</span></span>().latinities[<span class="hljs-number"><span class="hljs-number">0</span></span>]) } }</code> </pre> <br>  <b>Apportez</b> maintenant des modifications similaires à <b>QuoteView.swift</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">QuoteView_Previews</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PreviewProvider</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> previews: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">QuoteView</span></span>(quote: <span class="hljs-type"><span class="hljs-type">UserData</span></span>().latinities[<span class="hljs-number"><span class="hljs-number">0</span></span>].quotes[<span class="hljs-number"><span class="hljs-number">0</span></span>]) } }</code> </pre> <br>  Ouvrez le fichier ContentView.swift et ajoutez-le avant la déclaration de <b>corps</b> <br><br><pre> <code class="swift hljs">@<span class="hljs-type"><span class="hljs-type">ObservedObject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> userData = <span class="hljs-type"><span class="hljs-type">UserData</span></span>()</code> </pre> <br><h2>  Ravivez le paysage </h2><br>  Retour au fichier ContentView.swift.  À l'intérieur de la structure ContenView, immédiatement après la définition userData, ajoutez deux fonctions: <br><br><pre> <code class="swift hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sectionIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(section : SectionDataModel)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> { userData.latinities.firstIndex(<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>: {$<span class="hljs-number"><span class="hljs-number">0</span></span>.letter == section.letter})! } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">quoteIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(section : Int, quote : QuoteDataModel)</span></span></span></span> -&gt; <span class="hljs-type"><span class="hljs-type">Int</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> userData.latinities[section].quotes.firstIndex(<span class="hljs-keyword"><span class="hljs-keyword">where</span></span>: {$<span class="hljs-number"><span class="hljs-number">0</span></span>.latin == quote.latin})! }</code> </pre> <br>  Ajoutez des modificateurs <b>onTapGesture</b> à l'en-tête de section et à la cellule que nous <b>créons</b> .  Vue finale du contenu du <b>corps</b> : <br><br><pre> <code class="swift hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> body: some <span class="hljs-type"><span class="hljs-type">View</span></span> { <span class="hljs-type"><span class="hljs-type">List</span></span> { <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(userData.latinities) { section <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">Section</span></span>(header: <span class="hljs-type"><span class="hljs-type">HeaderView</span></span>(section: section) .onTapGesture { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.userData.latinities[<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.sectionIndex(section: section)].expanded.toggle() }, footer: <span class="hljs-type"><span class="hljs-type">EmptyView</span></span>()) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> section.expanded { <span class="hljs-type"><span class="hljs-type">ForEach</span></span>(section.quotes) { quote <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-type"><span class="hljs-type">QuoteView</span></span>(quote: quote) .onTapGesture { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> sectionIndex = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.sectionIndex(section: section) <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> quoteIndex = <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.quoteIndex(section: sectionIndex, quote: quote) <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.userData.latinities[sectionIndex].quotes[quoteIndex].expanded.toggle() } } } } } } .listStyle(<span class="hljs-type"><span class="hljs-type">GroupedListStyle</span></span>()) }</code> </pre> <br>  Les fonctions <b>sectionIndex</b> et <b>quoteUndex</b> renvoient l'index des sections et des expressions qui leur sont transmises.  Après avoir reçu ces index, nous modifions les valeurs des propriétés <b>étendues</b> dans notre tableau de <b>latinités</b> , ce qui conduit au pliage / dépliage de la section ou de l'expression. <br><br><img src="https://habrastorage.org/webt/kf/mx/83/kfmx83ej3tczkbhnfxzraec6cg0.png"><br><br><h2>  Conclusion </h2><br>  Le projet terminé peut être <a href="">téléchargé ici</a> . <br><br>  Quelques liens utiles: <br><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Apple SwiftUI Essentials - Gestion des entrées utilisateur</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">SwiftUI par l'exemple</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@ObservedObject, @State, @EnvironmentObject</a> </li></ul><br><br>  J'espère que la publication vous sera utile! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr475270/">https://habr.com/ru/post/fr475270/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr475260/index.html">La différence entre une fonction asynchrone et une fonction qui renvoie une promesse</a></li>
<li><a href="../fr475262/index.html">Le condensé de matières fraîches du monde du front-end de la dernière semaine n ° 388 (4-10 novembre 2019)</a></li>
<li><a href="../fr475264/index.html">Des renifleurs qui pourraient: comment la famille FakeSecurity a infecté les boutiques en ligne</a></li>
<li><a href="../fr475266/index.html">Nous inversons les mobiles 1 sous Android. Comment ajouter un peu de fonctionnalité et abandonner quelques soirées</a></li>
<li><a href="../fr475268/index.html">Paramétrage incertain comme méthode universelle pour construire l'architecture d'application en C ++ et Java pour un minimum. le prix</a></li>
<li><a href="../fr475272/index.html">Migration vers une infrastructure d'attente asynchrone à Rust</a></li>
<li><a href="../fr475276/index.html">Comment écrire assert correctement</a></li>
<li><a href="../fr475280/index.html">Mots de passe Cisco, migration de zone DNS, zéro requête LDAP, nous collectons des paquets Ethernet. Résolution de problèmes sur un réseau avec r0ot-mi. 2e partie</a></li>
<li><a href="../fr475284/index.html">Gestionnaire et singes d'une minute, recueil</a></li>
<li><a href="../fr475286/index.html">La trigénération: une alternative à l'approvisionnement énergétique centralisé</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>