<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🌿 👩🏼‍🎓 👩‍🏫 Logiciel d'émulation de réseau Modbus RTU 🚜 👂🏻 👩🏾‍🚒</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Présentation 
 Si vous n'avez qu'un marteau comme outil, chaque problème commence à ressembler à un clou. 

 Abraham Maslow 
 Le protocole Modbus est ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Logiciel d'émulation de réseau Modbus RTU</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409111/"><h1>  Présentation </h1><br><blockquote>  Si vous n'avez qu'un marteau comme outil, chaque problème commence à ressembler à un clou. <br><br>  <i>Abraham Maslow</i> </blockquote><br>  Le protocole Modbus est bien connu des lecteurs Habr et des lecteurs hicktime.  De nombreuses publications ont été consacrées à son application, difficiles à répertorier car elles sont nombreuses et de temps en temps de nouveaux articles apparaissent ici et là. <br><br><img src="https://habrastorage.org/webt/2m/xh/ry/2mxhryo9sblm6uzcf0srfxzqkkm.png"><br><br>  La popularité de ce protocole est due à son ouverture et sa simplicité.  Le champ d'application est assez large: des systèmes d'automatisation industrielle professionnels aux projets de bricolage amateur de systèmes de contrôle distribués, de maisons «intelligentes», etc.  Ce protocole a également été choisi par moi lorsque mon équipe s'est engagée dans la création d'un logiciel pour le simulateur de train.  Le protocole Modbus RTU sur l'interface physique RS485 est utilisé sur ce simulateur pour fournir à l'ordinateur de commande des données provenant de commandes montées sur la console du conducteur (ne pensez pas que Modbus est utilisé sur du matériel roulant réel!). <br><br>  Cela ne vaut pas la peine de parler des difficultés liées à la mise en place d'un logiciel qui interagit avec un réseau de contrôleurs qui contrôlent les équipements.  Surtout quand une partie des appareils existe déjà dans le fer et que l'autre partie est en cours de développement et de fabrication.  Dans ce cas, un logiciel de niveau supérieur doit être écrit en tenant compte de son interaction avec ces matériels.  Et il est conseillé de l'écrire de manière à créer immédiatement une version de travail du système, sans utiliser de «béquilles» qui sont toujours difficiles à nettoyer du code. <br><br>  «Vous devez écrire des logiciels lorsque les prototypes de travail de tout le matériel sont prêts», dites-vous, et vous aurez raison, mais ... ha ha ha, cela arrive rarement dans le monde réel.  Et ici, les émulateurs de logiciels viennent à notre aide. <br><a name="habracut"></a><br><h1>  1. En bref sur Modbus RTU </h1><br>  Je ne parlerai pas en détail du protocole.  Ceux qui sont intéressés par les détails peuvent utiliser la recherche - le protocole est ouvert, ses spécifications officielles et beaucoup d'informations sont disponibles sur le réseau.  Je peux seulement dire que dans Modbus RTU, il décrit le format binaire des données transmises et utilise le câble à paire torsadée standard RS485 comme moyen de transmission.  RS232 peut également être utilisé si le réseau possède un émetteur et un récepteur, ou RS422 pour la transmission de données unidirectionnelle. <br><br>  Nous serons intéressés par RS485, qui est une interface semi-duplex, qui permet à un seul appareil de transmettre des données à la fois.  L'arbitrage du bus dans Modbus est effectué en raison de l'endurance de l'intervalle de silence obligatoire de 3,5 caractères à une vitesse de transmission donnée.  Chaque message doit commencer et se terminer par un intervalle de silence.  Il y a un appareil maître dans le réseau et plusieurs esclaves (jusqu'à 31 dans un segment de réseau, sans utiliser de répéteurs).  Chaque périphérique esclave a un identifiant unique (1 à 31).  La transmission de données par les esclaves n'est effectuée que si le maître a envoyé une demande de réception de données de cet appareil. <br><br>  Une demande d'assistant typique ressemble à ceci <br><br><table><tbody><tr><td>  Identifiant </td><td>  Code de fonction </td><td>  Adresse de données </td><td>  Quantité de données (2 octets) </td><td>  Les données </td><td>  CRC16 </td></tr></tbody></table><br>  CRC16 est utilisé pour contrôler l'intégrité des données transmises.  Modus utilise la notation de représentation des données Big Endian: pour les valeurs de 2 octets, l'octet le plus significatif à l'intérieur du message vient en premier).  Le protocole utilise quatre types de données: <br><br><ol><li>  Bobines - sorties discrètes (1 bit) lecture / écriture </li><li>  Entrées TOR - entrées TOR en lecture seule (1 bit) </li><li>  Registres de maintien - registres de sortie (2 octets) disponibles pour lecture / écriture </li><li>  Registres d'entrée - registres d'entrée (2 octets) disponibles pour la lecture </li></ol><br>  En réponse à la demande, l'esclave envoie des données au format suivant <br><br><table><tbody><tr><td>  Identifiant </td><td>  Code de fonction </td><td>  La quantité de données en octets </td><td>  Les données </td><td>  CRC16 </td></tr></tbody></table><br>  Un message reçu du maître entre dans le tampon de réception de tous les appareils.  Cependant, si le premier octet du tampon de réception ne correspond pas à l'ID de périphérique, il ignore les données reçues, effaçant le tampon de réception.  Si le message est destiné à cet appareil, il forme alors une réponse et, après avoir maintenu l'intervalle de silence, l'envoie au maître. <br><br>  Comme on dit, simple mais avec goût.  Vous pouvez en savoir plus sur tout cela dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">spécification officielle du protocole</a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lisez les</a> méthodes d'implémentation du protocole sur l'interface série <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Nous ne nous sommes pas réunis ici pour cela. <br><br>  Lors du développement d'un logiciel de haut niveau (maître implémenté sur la base d'un PC par exemple) pour un tel réseau, il serait bien d'avoir un ensemble d'outils logiciels permettant de mettre en œuvre un tel concept <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/89b/944/3b5/89b9443b5fb11f04536782afce19be3d.png" alt="image"></div><br>  La signification de ce schéma est la suivante.  Supposons que nous ayons une partie des appareils inclus dans le futur réseau.  Ou jusqu'à présent, il n'y a pas de tels appareils.  Mais il y a un désir ardent d'écrire des logiciels pour le plus haut niveau de gestion, de les déboguer, de sorte que lorsque le réseau est toujours implémenté en matériel, nous n'avons rien à réécrire.  Pour ce faire, vous devrez utiliser un support de transmission physique, pour lequel nous utilisons un appareil similaire à celui-ci <br><br><img src="https://habrastorage.org/webt/1x/cz/ja/1xczjafogu-dwd3qnetuijaszma.jpeg"><br><br>  L'un des adaptateurs est utilisé pour connecter le logiciel de l'assistant développé.  Un autre est de connecter un émulateur d'un futur réseau d'esclaves.  À la branche avec un connecteur blanc, nous connectons cette partie du réseau qui est déjà implémentée dans le matériel.  Ainsi, nous avons l'opportunité de travailler sereinement avec le protocole de communication standard, en introduisant progressivement de vrais équipements en fonctionnement.  De plus, en donnant l'objet au client, nous ne sommes pas privés de la possibilité de modifier son logiciel dans un environnement de laboratoire confortable sans accès à l'objet.  QSlave dans le diagramme est exactement la même partie du réseau émulée par le logiciel.  Naturellement, vous devez écrire le logiciel approprié, ce qui a été fait par l'auteur. <br><br><h1>  2. QSlave - émulation de réseau esclave </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">QSlave</a> est un émulateur de réseau modbus RTU multiplateforme ouvert.  Vous pouvez l'obtenir sous la licence GPL v2.0 sur Github au lien ci-dessus. <br><br><img src="https://habrastorage.org/webt/4n/nd/am/4nndamsmf4i7ghnfrzzbbc94vqu.png"><br><br>  L'application est développée en C ++ en utilisant le framework Qt.  Qt, de manière générale, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">possède des bibliothèques pour travailler avec Modbus</a> , mais les spécificités de la tâche - simuler un réseau d'esclaves plutôt qu'un seul esclave, ont conduit au fait que les bibliothèques Qt intégrées pour Modbus n'ont pas été utilisées ici.  Pour traiter les données reçues du port série virtuel, une bibliothèque Modbus auto-écrite a été créée.  Le code de cette bibliothèque est implémenté comme un projet séparé, est complètement indépendant de l'interface utilisateur et peut être utilisé pour la prise de conscience de simulations logicielles avec des fonctionnalités plus avancées.  Du fait que l'émulation Modbus est détachée de l'interface utilisateur, le réseau est configuré à l'aide de fichiers de configuration.  Le format XML a été choisi (nous l'utilisons souvent dans nos projets).  Un exemple de configuration <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">est disponible dans le code du projet</a> .  Un ensemble de configurations se compose d'un fichier principal avec l'extension * .net, qui ressemble à ceci <br><br>  <b>example.net</b> <br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Slave</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  ,     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Traffic light<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  XML-  (  *.xml) --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span>traffic-light<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Slave</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  et des fichiers de configuration XML pour chacun des esclaves <br><br>  <b>traffic-light.xml</b> <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>16<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Red signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>17<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Yellow signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>18<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Green signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscreteInput</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Ready<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscreteInput</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HoldingRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Signal activity time<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>15<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HoldingRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Signals count<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Le dernier fichier contient une description de toutes les données disponibles sur l'appareil.  Pour télécharger la configuration, vous devez ouvrir le fichier * .net depuis le menu du programme QSlave (Fichier → Ouvrir la configuration).  Tous les fichiers de configuration doivent se trouver dans le même répertoire.  L'exemple de configuration décrit un réseau à partir d'un périphérique esclave, un feu de circulation virtuel, dont les sorties discrètes décrivent les signaux, une entrée numérique indique un bit du périphérique prêt à fonctionner (prêt), le registre d'entrée indique le nombre de signaux de trafic et le registre de sortie définit la durée pendant laquelle il est allumé chacun des signaux. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/fea/def/3a4/feadef3a4c17567d127543ee0954b561.png" alt="image"><br><br>  Naturellement, ce simulateur ne simule pas la logique interne de l'appareil.  Il vous permet uniquement de définir les valeurs des cellules de mémoire disponibles pour le maître.  N'importe laquelle des valeurs peut être définie à votre discrétion en modifiant la cellule correspondante dans le tableau. <br><br>  Pour toute sa simplicité, ce logiciel nous aide à travailler sur le logiciel du simulateur (qui a déjà été mis en service) sans quitter le laboratoire. <br><br><img src="https://habrastorage.org/webt/qh/9j/ba/qh9jba49bbzglh5ca1t2nryin9a.png"><br><br>  Mais personne ne dit que vous ne pouvez pas créer un émulateur plus avancé qui simule le fonctionnement des périphériques réseau virtuels.  Pour le créer, vous pouvez utiliser le code de bibliothèque modbus disponible dans le package QSlave. <br><br><h1>  3. QMaster - émulation de l'appareil maître </h1><br>  Pour créer des esclaves, déboguer leur firmware, vous avez besoin d'une simulation d'assistant.  Il existe un certain nombre d'émulateurs ouverts, tels que, par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">QModbus</a> .  Nous l'avons utilisé dans notre travail, jusqu'à ce que nous décidions d'augmenter le taux de transfert de données à 250 kBit / s.  QModbus ne le permet pas.  Il a été possible de le reconstruire à partir des sources pour Linux, mais nos ingénieurs électroniques sont assis sur Windows, et où l'assemblage n'est pas allé pour plusieurs raisons.  Il s'est avéré que cette application est écrite en Qt 4, utilise une bibliothèque libmodbus tierce.  Je voulais avoir une solution multiplateforme sur Qt5, d'autant plus que Qt5 fonctionne déjà avec Modbus prêt à l'emploi.  Par conséquent, son analogue a été écrit à l'aide de la pile de bibliothèques Qt Modbus - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">QMaster</a> .  Il est également disponible sur Github dans les mêmes conditions. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a13/5fa/5b2/a135fa5b2781d646d18010960defd69d.png" alt="image"><br><br><h1>  Conclusion </h1><br>  En conclusion, je dirai que je travaille (au travail) principalement sur des projets clôturés.  Cependant, les outils décrits ont été développés par moi personnellement de ma propre initiative pendant mon temps libre.  De plus, dans la version Windows, ils sont statiquement liés au code Qt GPL, je dois donc les transmettre à la communauté dans les mêmes conditions que Qt reçues.  De plus, ces outils peuvent être utiles au lecteur. <br><br>  Merci de votre attention! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr409111/">https://habr.com/ru/post/fr409111/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr409099/index.html">Que donner pour la nouvelle année? Problème 2017</a></li>
<li><a href="../fr409101/index.html">Moyens scientifiques pour surmonter la fatigue: nootropiques, café et neurotechnologie</a></li>
<li><a href="../fr409103/index.html">Crispr Therapeutics planifie les premiers essais cliniques pour le traitement des maladies génétiques</a></li>
<li><a href="../fr409105/index.html">Les plus grandes crypto-monnaies, leur résultat et pourquoi NiceHash n'a pas volé à la maison</a></li>
<li><a href="../fr409107/index.html">Programmation et transmission de données à Arduino par voie aérienne à l'aide de l'ESP8266. Troisième partie. Bonjour, ANDROID</a></li>
<li><a href="../fr409113/index.html">Une bagatelle, mais agréable: une tasse qui régule la température de la boisson</a></li>
<li><a href="../fr409115/index.html">Bandes sonores de jeux cultes: peste, utopie et piolets</a></li>
<li><a href="../fr409119/index.html">Intel ❄ 2017. Résultats de l'année</a></li>
<li><a href="../fr409121/index.html">Qu'est-ce que c'est: le marché russe des services de streaming</a></li>
<li><a href="../fr409123/index.html">Comment créer un synthétiseur pratique de vos propres mains</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>