<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåø üë©üèº‚Äçüéì üë©‚Äçüè´ Logiciel d'√©mulation de r√©seau Modbus RTU üöú üëÇüèª üë©üèæ‚Äçüöí</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pr√©sentation 
 Si vous n'avez qu'un marteau comme outil, chaque probl√®me commence √† ressembler √† un clou. 

 Abraham Maslow 
 Le protocole Modbus est ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Logiciel d'√©mulation de r√©seau Modbus RTU</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/409111/"><h1>  Pr√©sentation </h1><br><blockquote>  Si vous n'avez qu'un marteau comme outil, chaque probl√®me commence √† ressembler √† un clou. <br><br>  <i>Abraham Maslow</i> </blockquote><br>  Le protocole Modbus est bien connu des lecteurs Habr et des lecteurs hicktime.  De nombreuses publications ont √©t√© consacr√©es √† son application, difficiles √† r√©pertorier car elles sont nombreuses et de temps en temps de nouveaux articles apparaissent ici et l√†. <br><br><img src="https://habrastorage.org/webt/2m/xh/ry/2mxhryo9sblm6uzcf0srfxzqkkm.png"><br><br>  La popularit√© de ce protocole est due √† son ouverture et sa simplicit√©.  Le champ d'application est assez large: des syst√®mes d'automatisation industrielle professionnels aux projets de bricolage amateur de syst√®mes de contr√¥le distribu√©s, de maisons ¬´intelligentes¬ª, etc.  Ce protocole a √©galement √©t√© choisi par moi lorsque mon √©quipe s'est engag√©e dans la cr√©ation d'un logiciel pour le simulateur de train.  Le protocole Modbus RTU sur l'interface physique RS485 est utilis√© sur ce simulateur pour fournir √† l'ordinateur de commande des donn√©es provenant de commandes mont√©es sur la console du conducteur (ne pensez pas que Modbus est utilis√© sur du mat√©riel roulant r√©el!). <br><br>  Cela ne vaut pas la peine de parler des difficult√©s li√©es √† la mise en place d'un logiciel qui interagit avec un r√©seau de contr√¥leurs qui contr√¥lent les √©quipements.  Surtout quand une partie des appareils existe d√©j√† dans le fer et que l'autre partie est en cours de d√©veloppement et de fabrication.  Dans ce cas, un logiciel de niveau sup√©rieur doit √™tre √©crit en tenant compte de son interaction avec ces mat√©riels.  Et il est conseill√© de l'√©crire de mani√®re √† cr√©er imm√©diatement une version de travail du syst√®me, sans utiliser de ¬´b√©quilles¬ª qui sont toujours difficiles √† nettoyer du code. <br><br>  ¬´Vous devez √©crire des logiciels lorsque les prototypes de travail de tout le mat√©riel sont pr√™ts¬ª, dites-vous, et vous aurez raison, mais ... ha ha ha, cela arrive rarement dans le monde r√©el.  Et ici, les √©mulateurs de logiciels viennent √† notre aide. <br><a name="habracut"></a><br><h1>  1. En bref sur Modbus RTU </h1><br>  Je ne parlerai pas en d√©tail du protocole.  Ceux qui sont int√©ress√©s par les d√©tails peuvent utiliser la recherche - le protocole est ouvert, ses sp√©cifications officielles et beaucoup d'informations sont disponibles sur le r√©seau.  Je peux seulement dire que dans Modbus RTU, il d√©crit le format binaire des donn√©es transmises et utilise le c√¢ble √† paire torsad√©e standard RS485 comme moyen de transmission.  RS232 peut √©galement √™tre utilis√© si le r√©seau poss√®de un √©metteur et un r√©cepteur, ou RS422 pour la transmission de donn√©es unidirectionnelle. <br><br>  Nous serons int√©ress√©s par RS485, qui est une interface semi-duplex, qui permet √† un seul appareil de transmettre des donn√©es √† la fois.  L'arbitrage du bus dans Modbus est effectu√© en raison de l'endurance de l'intervalle de silence obligatoire de 3,5 caract√®res √† une vitesse de transmission donn√©e.  Chaque message doit commencer et se terminer par un intervalle de silence.  Il y a un appareil ma√Ætre dans le r√©seau et plusieurs esclaves (jusqu'√† 31 dans un segment de r√©seau, sans utiliser de r√©p√©teurs).  Chaque p√©riph√©rique esclave a un identifiant unique (1 √† 31).  La transmission de donn√©es par les esclaves n'est effectu√©e que si le ma√Ætre a envoy√© une demande de r√©ception de donn√©es de cet appareil. <br><br>  Une demande d'assistant typique ressemble √† ceci <br><br><table><tbody><tr><td>  Identifiant </td><td>  Code de fonction </td><td>  Adresse de donn√©es </td><td>  Quantit√© de donn√©es (2 octets) </td><td>  Les donn√©es </td><td>  CRC16 </td></tr></tbody></table><br>  CRC16 est utilis√© pour contr√¥ler l'int√©grit√© des donn√©es transmises.  Modus utilise la notation de repr√©sentation des donn√©es Big Endian: pour les valeurs de 2 octets, l'octet le plus significatif √† l'int√©rieur du message vient en premier).  Le protocole utilise quatre types de donn√©es: <br><br><ol><li>  Bobines - sorties discr√®tes (1 bit) lecture / √©criture </li><li>  Entr√©es TOR - entr√©es TOR en lecture seule (1 bit) </li><li>  Registres de maintien - registres de sortie (2 octets) disponibles pour lecture / √©criture </li><li>  Registres d'entr√©e - registres d'entr√©e (2 octets) disponibles pour la lecture </li></ol><br>  En r√©ponse √† la demande, l'esclave envoie des donn√©es au format suivant <br><br><table><tbody><tr><td>  Identifiant </td><td>  Code de fonction </td><td>  La quantit√© de donn√©es en octets </td><td>  Les donn√©es </td><td>  CRC16 </td></tr></tbody></table><br>  Un message re√ßu du ma√Ætre entre dans le tampon de r√©ception de tous les appareils.  Cependant, si le premier octet du tampon de r√©ception ne correspond pas √† l'ID de p√©riph√©rique, il ignore les donn√©es re√ßues, effa√ßant le tampon de r√©ception.  Si le message est destin√© √† cet appareil, il forme alors une r√©ponse et, apr√®s avoir maintenu l'intervalle de silence, l'envoie au ma√Ætre. <br><br>  Comme on dit, simple mais avec go√ªt.  Vous pouvez en savoir plus sur tout cela dans la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sp√©cification officielle du protocole</a> .  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lisez les</a> m√©thodes d'impl√©mentation du protocole sur l'interface s√©rie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ici</a> .  Nous ne nous sommes pas r√©unis ici pour cela. <br><br>  Lors du d√©veloppement d'un logiciel de haut niveau (ma√Ætre impl√©ment√© sur la base d'un PC par exemple) pour un tel r√©seau, il serait bien d'avoir un ensemble d'outils logiciels permettant de mettre en ≈ìuvre un tel concept <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/geektimes/post_images/89b/944/3b5/89b9443b5fb11f04536782afce19be3d.png" alt="image"></div><br>  La signification de ce sch√©ma est la suivante.  Supposons que nous ayons une partie des appareils inclus dans le futur r√©seau.  Ou jusqu'√† pr√©sent, il n'y a pas de tels appareils.  Mais il y a un d√©sir ardent d'√©crire des logiciels pour le plus haut niveau de gestion, de les d√©boguer, de sorte que lorsque le r√©seau est toujours impl√©ment√© en mat√©riel, nous n'avons rien √† r√©√©crire.  Pour ce faire, vous devrez utiliser un support de transmission physique, pour lequel nous utilisons un appareil similaire √† celui-ci <br><br><img src="https://habrastorage.org/webt/1x/cz/ja/1xczjafogu-dwd3qnetuijaszma.jpeg"><br><br>  L'un des adaptateurs est utilis√© pour connecter le logiciel de l'assistant d√©velopp√©.  Un autre est de connecter un √©mulateur d'un futur r√©seau d'esclaves.  √Ä la branche avec un connecteur blanc, nous connectons cette partie du r√©seau qui est d√©j√† impl√©ment√©e dans le mat√©riel.  Ainsi, nous avons l'opportunit√© de travailler sereinement avec le protocole de communication standard, en introduisant progressivement de vrais √©quipements en fonctionnement.  De plus, en donnant l'objet au client, nous ne sommes pas priv√©s de la possibilit√© de modifier son logiciel dans un environnement de laboratoire confortable sans acc√®s √† l'objet.  QSlave dans le diagramme est exactement la m√™me partie du r√©seau √©mul√©e par le logiciel.  Naturellement, vous devez √©crire le logiciel appropri√©, ce qui a √©t√© fait par l'auteur. <br><br><h1>  2. QSlave - √©mulation de r√©seau esclave </h1><br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">QSlave</a> est un √©mulateur de r√©seau modbus RTU multiplateforme ouvert.  Vous pouvez l'obtenir sous la licence GPL v2.0 sur Github au lien ci-dessus. <br><br><img src="https://habrastorage.org/webt/4n/nd/am/4nndamsmf4i7ghnfrzzbbc94vqu.png"><br><br>  L'application est d√©velopp√©e en C ++ en utilisant le framework Qt.  Qt, de mani√®re g√©n√©rale, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">poss√®de des biblioth√®ques pour travailler avec Modbus</a> , mais les sp√©cificit√©s de la t√¢che - simuler un r√©seau d'esclaves plut√¥t qu'un seul esclave, ont conduit au fait que les biblioth√®ques Qt int√©gr√©es pour Modbus n'ont pas √©t√© utilis√©es ici.  Pour traiter les donn√©es re√ßues du port s√©rie virtuel, une biblioth√®que Modbus auto-√©crite a √©t√© cr√©√©e.  Le code de cette biblioth√®que est impl√©ment√© comme un projet s√©par√©, est compl√®tement ind√©pendant de l'interface utilisateur et peut √™tre utilis√© pour la prise de conscience de simulations logicielles avec des fonctionnalit√©s plus avanc√©es.  Du fait que l'√©mulation Modbus est d√©tach√©e de l'interface utilisateur, le r√©seau est configur√© √† l'aide de fichiers de configuration.  Le format XML a √©t√© choisi (nous l'utilisons souvent dans nos projets).  Un exemple de configuration <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">est disponible dans le code du projet</a> .  Un ensemble de configurations se compose d'un fichier principal avec l'extension * .net, qui ressemble √† ceci <br><br>  <b>example.net</b> <br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Slave</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  ,     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span>Traffic light<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  XML-  (  *.xml) --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span>traffic-light<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Slave</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  et des fichiers de configuration XML pour chacun des esclaves <br><br>  <b>traffic-light.xml</b> <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>16<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Red signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>17<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Yellow signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>18<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Green signal<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Coil</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscreteInput</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Ready<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscreteInput</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HoldingRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Signal activity time<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>15<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HoldingRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span>2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">address</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>Signals count<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">InputRegister</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Le dernier fichier contient une description de toutes les donn√©es disponibles sur l'appareil.  Pour t√©l√©charger la configuration, vous devez ouvrir le fichier * .net depuis le menu du programme QSlave (Fichier ‚Üí Ouvrir la configuration).  Tous les fichiers de configuration doivent se trouver dans le m√™me r√©pertoire.  L'exemple de configuration d√©crit un r√©seau √† partir d'un p√©riph√©rique esclave, un feu de circulation virtuel, dont les sorties discr√®tes d√©crivent les signaux, une entr√©e num√©rique indique un bit du p√©riph√©rique pr√™t √† fonctionner (pr√™t), le registre d'entr√©e indique le nombre de signaux de trafic et le registre de sortie d√©finit la dur√©e pendant laquelle il est allum√© chacun des signaux. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/fea/def/3a4/feadef3a4c17567d127543ee0954b561.png" alt="image"><br><br>  Naturellement, ce simulateur ne simule pas la logique interne de l'appareil.  Il vous permet uniquement de d√©finir les valeurs des cellules de m√©moire disponibles pour le ma√Ætre.  N'importe laquelle des valeurs peut √™tre d√©finie √† votre discr√©tion en modifiant la cellule correspondante dans le tableau. <br><br>  Pour toute sa simplicit√©, ce logiciel nous aide √† travailler sur le logiciel du simulateur (qui a d√©j√† √©t√© mis en service) sans quitter le laboratoire. <br><br><img src="https://habrastorage.org/webt/qh/9j/ba/qh9jba49bbzglh5ca1t2nryin9a.png"><br><br>  Mais personne ne dit que vous ne pouvez pas cr√©er un √©mulateur plus avanc√© qui simule le fonctionnement des p√©riph√©riques r√©seau virtuels.  Pour le cr√©er, vous pouvez utiliser le code de biblioth√®que modbus disponible dans le package QSlave. <br><br><h1>  3. QMaster - √©mulation de l'appareil ma√Ætre </h1><br>  Pour cr√©er des esclaves, d√©boguer leur firmware, vous avez besoin d'une simulation d'assistant.  Il existe un certain nombre d'√©mulateurs ouverts, tels que, par exemple, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">QModbus</a> .  Nous l'avons utilis√© dans notre travail, jusqu'√† ce que nous d√©cidions d'augmenter le taux de transfert de donn√©es √† 250 kBit / s.  QModbus ne le permet pas.  Il a √©t√© possible de le reconstruire √† partir des sources pour Linux, mais nos ing√©nieurs √©lectroniques sont assis sur Windows, et o√π l'assemblage n'est pas all√© pour plusieurs raisons.  Il s'est av√©r√© que cette application est √©crite en Qt 4, utilise une biblioth√®que libmodbus tierce.  Je voulais avoir une solution multiplateforme sur Qt5, d'autant plus que Qt5 fonctionne d√©j√† avec Modbus pr√™t √† l'emploi.  Par cons√©quent, son analogue a √©t√© √©crit √† l'aide de la pile de biblioth√®ques Qt Modbus - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">QMaster</a> .  Il est √©galement disponible sur Github dans les m√™mes conditions. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a13/5fa/5b2/a135fa5b2781d646d18010960defd69d.png" alt="image"><br><br><h1>  Conclusion </h1><br>  En conclusion, je dirai que je travaille (au travail) principalement sur des projets cl√¥tur√©s.  Cependant, les outils d√©crits ont √©t√© d√©velopp√©s par moi personnellement de ma propre initiative pendant mon temps libre.  De plus, dans la version Windows, ils sont statiquement li√©s au code Qt GPL, je dois donc les transmettre √† la communaut√© dans les m√™mes conditions que Qt re√ßues.  De plus, ces outils peuvent √™tre utiles au lecteur. <br><br>  Merci de votre attention! </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr409111/">https://habr.com/ru/post/fr409111/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr409099/index.html">Que donner pour la nouvelle ann√©e? Probl√®me 2017</a></li>
<li><a href="../fr409101/index.html">Moyens scientifiques pour surmonter la fatigue: nootropiques, caf√© et neurotechnologie</a></li>
<li><a href="../fr409103/index.html">Crispr Therapeutics planifie les premiers essais cliniques pour le traitement des maladies g√©n√©tiques</a></li>
<li><a href="../fr409105/index.html">Les plus grandes crypto-monnaies, leur r√©sultat et pourquoi NiceHash n'a pas vol√© √† la maison</a></li>
<li><a href="../fr409107/index.html">Programmation et transmission de donn√©es √† Arduino par voie a√©rienne √† l'aide de l'ESP8266. Troisi√®me partie. Bonjour, ANDROID</a></li>
<li><a href="../fr409113/index.html">Une bagatelle, mais agr√©able: une tasse qui r√©gule la temp√©rature de la boisson</a></li>
<li><a href="../fr409115/index.html">Bandes sonores de jeux cultes: peste, utopie et piolets</a></li>
<li><a href="../fr409119/index.html">Intel ‚ùÑ 2017. R√©sultats de l'ann√©e</a></li>
<li><a href="../fr409121/index.html">Qu'est-ce que c'est: le march√© russe des services de streaming</a></li>
<li><a href="../fr409123/index.html">Comment cr√©er un synth√©tiseur pratique de vos propres mains</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>