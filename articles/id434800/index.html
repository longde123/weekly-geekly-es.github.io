<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ”° â˜ ï¸ ğŸ‘¨ğŸ¾â€âš–ï¸ (5-2) Cara untuk memigrasi tabel SQL besar ğŸ‘©ğŸ½â€ğŸ“ ğŸ›€ ğŸ‘§</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pendahuluan 
 Halo semuanya! Ini adalah artikel pertama saya dan saya menulisnya atas nama seorang insinyur pengembangan junior di C #. Jadi tidak aka...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>(5-2) Cara untuk memigrasi tabel SQL besar</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/434800/"><h3>  Pendahuluan </h3><br>  Halo semuanya!  Ini adalah artikel pertama saya dan saya menulisnya atas nama seorang insinyur pengembangan junior di C #.  Jadi tidak akan ada informasi terperinci tentang SQL, hanya informasi dan pemikiran praktis untuk menyelesaikan masalah yang agak tidak jelas yang harus saya hadapi untuk pendatang baru yang sama seperti saya. <br><br>  Pertama, saya akan menggambarkan rumusan masalah saya sebagai contoh, di mana ada kebutuhan nyata untuk memindahkan meja besar. <br><br>  Jadi, katakanlah Anda memiliki layanan web dan database SQL (MS-SQL) dengan tabel huruf html yang dikirimkan layanan Anda kepada pengguna.  Surat disimpan selama beberapa tahun dan tidak dapat dihapus, karena diperlukan untuk mengumpulkan statistik dan analitik.  Namun, setiap tahun jumlah surat bertambah, basis data bertambah, dan ruang pada server SQL semakin kecil (dalam kasus kami, faktor lain memulihkan database ke situs uji, karena waktunya meningkat secara proporsional) dan sesuatu perlu dilakukan dengan ini harus dilakukan.  Untungnya, dalam kasus kami ada server gratis dengan banyak ruang kosong (pada kenyataannya mungkin tidak, dan tentu saja ini adalah solusi sementara, tetapi ini di luar ruang lingkup artikel).  Jadi masalah muncul dari memindahkan meja besar (dan mengatakan "besar", maksud saya meja yang sangat besar, semua yang saya lihat saat mencari solusi serupa berada di wilayah 60-100 GB, dalam kasus kami meja tersebut memiliki berat lebih dari 300 GB). <br><br>  Kami akan mempertimbangkan beberapa cara untuk menyelesaikan masalah ini, tetapi tidak semuanya berhubungan dengan transfer dari jenis server-server.  Terkadang mungkin perlu untuk mentransfer tabel antara database dalam server yang sama.  Juga, beberapa metode murni teoretis, saya tidak menguji semuanya dalam praktek, tetapi mereka mungkin harus bekerja. <br><a name="habracut"></a><br><h3>  Metode -1.  Data </h3><br>  Tidak peduli seberapa jelas kedengarannya, tetapi Anda harus tahu data apa yang akan Anda transfer.  Paling sering, data tidak disimpan dengan cara yang paling optimal, dan kelebihan informasi juga dapat disimpan.  Sangat mungkin bahwa dalam kasus khusus Anda, Anda dapat melakukannya tanpa mentransfer semua data. <br><br>  Pertama, menghapus kolom mungkin dapat membantu Anda, tetapi ini adalah operasi pemblokiran, dan tidak selalu mungkin untuk menghentikan layanan web.  Dan di HabrÃ© ada artikel yang menceritakan bagaimana hal itu dapat dilakukan. <br><br>  Kedua, jangan lupa tentang normalisasi.  Mungkin beberapa data dapat ditransfer ke kamus (dalam hal surat, adalah mungkin untuk tidak menyimpan isi surat, tetapi templat dengan data yang dimasukkan di sana), dan hanya id dari elemen-elemen ini yang dapat disimpan dalam tabel besar, ini dapat membebaskan banyak ruang untuk Anda. <br><br><h3>  Metode 0. PILIH KE </h3><br>  Lelucon =) Jadi Anda hanya bisa menempatkan diri Anda sebagai basis.  Namun, jika kita berbicara tentang ukuran kecil dari tabel (lalu apa yang Anda lakukan di sini), Anda dapat mencoba mentransfer database menggunakan instruksi ini.  Juga, jika Anda memiliki basis tes, Anda dapat melakukan percobaan untuk mengevaluasi total waktu transfer menggunakan metode ini "di dahi." <br><br><h3>  Metode 1. Cadangan </h3><br>  Cara yang paling "kanonik", inilah yang menjadi solusi untuk masalah saya.  Kami membuat cadangan dari database yang berisi tabel kami, dan mengembalikannya di server lain dan menghapusnya dari semua yang tidak perlu.  Lebih lanjut, jika dimungkinkan untuk menghentikan layanan web, Anda dapat memindahkannya kembali dengan mengatur catatan di tabel yang ditransfer, dan menghapus yang lama <b>* *</b> (di sini kemungkinan besar akan ada saat ketika akan diperlukan untuk menulis pertanyaan ke sana dengan bergabung, untuk ini google cara menghubungkan sql- server).  Jika ini tidak memungkinkan, kami memperbaiki id dari huruf terakhir (untuk sinkronisasi), maka kami perlu menghapus <b>*</b> semua surat yang ditransfer (kami akan terus menulis di tabel lama). <br><br>  <b>*</b> Menghapus topik terpisah untuk percakapan, mungkin terlihat lebih cepat daripada mentransfer, tetapi ini tidak begitu dan dalam kasus umum saya menyarankan menghapus sebagian. <br><br><h3>  Metode 2: Studio Manajemen MS-SQL </h3><br>  Jika Anda memiliki studio ini, Anda dapat mencoba menggunakan alat bawaan untuk mengekspor dan mengimpor data.  Secara pribadi, saya membaca tentang stack overflow bahwa hal ini tergantung pada tabel 60 manggung dan tidak mengambil risiko. <br><br><h3>  Metode 3. Partisi </h3><br>  Metode dahi ditingkatkan.  Idenya adalah untuk mentransfer data dengan cara biasa dengan timer di antara iterasi.  Anda memecah semua garis menjadi bagian-bagian (misalnya, masing-masing 100rb), mentransfer bagian tersebut (dan Anda dapat langsung menghapusnya, tetapi Anda tidak yakin seberapa amannya), lalu tertidur dan seterusnya hingga akhir yang pahit.  Lebih baik untuk mentransfer dari ujung sehingga Anda tidak perlu menyinkronkan data di akhir.  Metode ini jelas sangat lambat, tetapi dengan cara ini Anda akan mentransfer semuanya tanpa menghentikan layanan web.  Kemungkinan besar akan lebih mudah untuk mengimplementasikannya bukan dengan skrip SQL, tetapi dengan bantuan beberapa ORM. <br><br><h3>  Ringkasan </h3><br>  Proses mentransfer sejumlah besar data selalu membutuhkan waktu tertentu, dan Anda harus siap untuk ini.  Tidak ada cara ajaib untuk menyelesaikan masalah Anda secara instan.  Dalam setiap kasus, Anda perlu membangun volume dan batasan Anda.  Jika tidak ada metode yang bekerja untuk Anda, pertimbangkan apakah Anda dapat menggunakan kombinasi mereka. <br><br>  Pada akhirnya, saya ingin menambahkan 2 poin penting. <br><br>  Setiap proses pemindahan / penghapusan baris dalam SQL dicatat log transaksi untuk kemampuan memutar kembali semua jika terjadi kesalahan (sebelumnya saya berasumsi bahwa ini dilakukan hanya dalam kerangka transaksi).  Selain itu, ukuran log bahkan sedikit lebih banyak daripada jumlah data.  Pastikan Anda memiliki jumlah ruang yang diperlukan atau menonaktifkan pencatatan, tetapi ini tidak aman. <br><br>  Sebelum mentransfer, Anda perlu memastikan bahwa file data dan file log adalah ukuran yang tepat, karena  operasi ekspansi menghabiskan banyak waktu, dan mengonfigurasikannya dengan tepat. Dengan cara ini, Anda mengoptimalkan migrasi. <br>  Terima kasih untuk semua yang membaca!  Saya akan dengan senang hati menerima kritik, komentar, dan klarifikasi.  Bagikan cara dan teknik Anda untuk bekerja dengan data besar, sebagai  seringkali ini adalah informasi yang sangat penting dan perlu yang tidak mudah ditemukan. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id434800/">https://habr.com/ru/post/id434800/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id434790/index.html">Begitu banyak JDK ... Yang mana yang digunakan dan apa yang mengancamnya?</a></li>
<li><a href="../id434792/index.html">Freelansim 2018: hasil tahun ini</a></li>
<li><a href="../id434794/index.html">Ketrampilan soft-tester yang sukses</a></li>
<li><a href="../id434796/index.html">Coding the Art: bagaimana kita menghasilkan grafik dan animasi dalam proyek desain</a></li>
<li><a href="../id434798/index.html">Sombong - dokumentasi pintar API web RESTful Anda - Ulasan pengembang pemula untuk pemula</a></li>
<li><a href="../id434802/index.html">"Saya tidak akan memberikan batu" atau bagaimana sumber daya permainan "Cursed Lands" diatur</a></li>
<li><a href="../id434804/index.html">Fintech-startup Robinhood tidak dapat meluncurkan analog rekening bank</a></li>
<li><a href="../id434806/index.html">Tahun baru dibongkar dengan sampan</a></li>
<li><a href="../id434810/index.html">Pemula untuk bekerja dengan Spring Cloud</a></li>
<li><a href="../id434812/index.html">Manajemen waktu proyek</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>