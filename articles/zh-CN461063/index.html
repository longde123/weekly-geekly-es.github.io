<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ§—ğŸ¼ ğŸ¤¾ğŸ½ ğŸ‘°ğŸ¿ Rä¸Microsoft SQL Serverå’Œå…¶ä»–DBMSä¸Šçš„æ•°æ®åº“çš„äº¤äº’ ğŸª ğŸ”„ ğŸˆ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ç”±äºå¤§éƒ¨åˆ†ä¸šåŠ¡ä¿¡æ¯éƒ½å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚ æ— è®ºä½¿ç”¨å“ªç§ç¼–ç¨‹è¯­è¨€ï¼Œéƒ½å¿…é¡»å¯¹å®ƒä»¬æ‰§è¡Œå„ç§æ“ä½œã€‚ 


 åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºåœ¨Rä¸­ä½¿ç”¨æ•°æ®åº“çš„ä¸¤ä¸ªæ¥å£ã€‚å¤§å¤šæ•°ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨Microsoft SQL Serverï¼Œä½†æ˜¯ï¼Œæ‰€æœ‰ä»£ç ç¤ºä¾‹éƒ½å°†ä¸å…¶ä»–æ•°æ®åº“ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼šMySQLï¼ŒPostgreSQLï¼ŒSQLi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Rä¸Microsoft SQL Serverå’Œå…¶ä»–DBMSä¸Šçš„æ•°æ®åº“çš„äº¤äº’</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/461063/"><p> ç”±äºå¤§éƒ¨åˆ†ä¸šåŠ¡ä¿¡æ¯éƒ½å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚ æ— è®ºä½¿ç”¨å“ªç§ç¼–ç¨‹è¯­è¨€ï¼Œéƒ½å¿…é¡»å¯¹å®ƒä»¬æ‰§è¡Œå„ç§æ“ä½œã€‚ </p><br><p> åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†è®¨è®ºåœ¨Rä¸­ä½¿ç”¨æ•°æ®åº“çš„ä¸¤ä¸ªæ¥å£ã€‚å¤§å¤šæ•°ç¤ºä¾‹æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨Microsoft SQL Serverï¼Œä½†æ˜¯ï¼Œæ‰€æœ‰ä»£ç ç¤ºä¾‹éƒ½å°†ä¸å…¶ä»–æ•°æ®åº“ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼šMySQLï¼ŒPostgreSQLï¼ŒSQLiteï¼ŒClickHouse ï¼ŒGoogle BigQueryç­‰ã€‚ </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/925/a23/786/925a23786a89917d9a314a793545cbb1.jpg" alt="å›¾ç‰‡"></p><a name="habracut"></a><br><h1 id="soderzhanie"> ç›®å½•å†…å®¹ </h1><br><ul><li> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ‰€éœ€è½¯ä»¶</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DBIè½¯ä»¶åŒ…</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åŸºæœ¬DBIåŠŸèƒ½åˆ—è¡¨</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">æ•°æ®åº“è¿æ¥</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨odbcåŒ…è¿æ¥åˆ°Microsoft SQL Serverçš„ç¤ºä¾‹</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨RMSSQLåŒ…è¿æ¥åˆ°Microsoft SQL Serverçš„ç¤ºä¾‹</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¦‚ä½•åœ¨Rè„šæœ¬ä¸­éšè—æ•°æ®åº“å¯†ç </a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">åˆ›å»ºè¡¨å¹¶å†™å…¥æ•°æ®åº“</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä»DBMSè¯»å–æ•°æ®</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DBMSï¼ˆDMLï¼‰ä¸­çš„æ•°æ®å¤„ç†</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">DBMSä¸­çš„äº‹åŠ¡</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RODBCå¥—ä»¶</a> <br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RODBCè½¯ä»¶åŒ…çš„ä¸»è¦åŠŸèƒ½</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ä½¿ç”¨RODBCçš„ç¤ºä¾‹</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">äº¤æ˜“æ€§</a> </li></ul></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ç»“è®º</a> </li></ul><br><h1 id="trebuemoe-programmnoe-obespechenie"> æ‰€éœ€è½¯ä»¶ </h1><br><p> ä¸ºäº†é‡å¤ä½¿ç”¨æœ¬æ–‡ä¸­æè¿°çš„ä½¿ç”¨DBMSçš„æ‰€æœ‰ç¤ºä¾‹ï¼Œæ‚¨å°†éœ€è¦ä¸‹é¢åˆ—å‡ºçš„ä»¥ä¸‹å…è´¹è½¯ä»¶ï¼š </p><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è¯­è¨€R</a> ; </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RStudio</a>å¼€å‘ç¯å¢ƒï¼› </li><li> æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œå¯ä¾›é€‰æ‹©ï¼š <br>  3.1ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">Microsoft SQLæœåŠ¡å™¨</a> <br>  3.2ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„MySQL</a> <br>  3.3ã€‚  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PostgreSQLçš„</a> </li></ol><br><h1 id="paket-dbi">  DBIè½¯ä»¶åŒ… </h1><br><p> <code>DBI</code>è½¯ä»¶åŒ…æ˜¯ä¸Rä¸­çš„æ•°æ®åº“è¿›è¡Œäº¤äº’çš„æœ€æµè¡Œï¼Œæœ€æ–¹ä¾¿çš„æ–¹æ³•ã€‚ </p><br><p>  <code>DBI</code>ä¸ºæ‚¨æä¾›äº†ä¸€ç»„å¯ä»¥ç”¨æ¥ç®¡ç†æ•°æ®åº“çš„åŠŸèƒ½ã€‚ ä½†æ˜¯ï¼Œè¦è¿æ¥åˆ°æ•°æ®åº“ï¼Œæ‚¨éœ€è¦å®‰è£…å…¶ä»–è½¯ä»¶åŒ…ï¼Œè¿™äº›è½¯ä»¶åŒ…æ˜¯å„ç§æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMSï¼‰çš„é©±åŠ¨ç¨‹åºã€‚ </p><br><h3 id="spisok-osnovnyh-funkciy-dbi"> åŸºæœ¬DBIåŠŸèƒ½åˆ—è¡¨ </h3><br><ul><li>  <code>dbConnect</code>ä¸æ•°æ®åº“çš„è¿æ¥ï¼› </li><li>  <code>dbWriteTable</code>å°†è¡¨å†™å…¥æ•°æ®åº“ï¼› </li><li>  <code>dbReadTable</code>ä»æ•°æ®åº“åŠ è½½è¡¨ï¼› </li><li>  <code>dbGetQuery</code>åŠ è½½æŸ¥è¯¢æ‰§è¡Œçš„ç»“æœï¼› </li><li>  <code>dbSendQuery</code>å‘æ•°æ®åº“å‘é€æŸ¥è¯¢ï¼› </li><li>  <code>dbFetch</code>ä»ç»“æœé›†ä¸­æå–å…ƒç´ ï¼› </li><li>  <code>dbExecute</code>æ‰§è¡Œæ›´æ–°/åˆ é™¤/å‘è¡¨ä¸­æ’å…¥æ•°æ®çš„è¯·æ±‚ï¼› </li><li>  <code>dbGetInfo</code>è¯·æ±‚æœ‰å…³è¯·æ±‚æˆ–è¿æ¥ç»“æœçš„ä¿¡æ¯ï¼› </li><li>  <code>dbListFields</code>è¯·æ±‚è¡¨å­—æ®µåˆ—è¡¨ï¼› </li><li>  <code>dbListTables</code>æŸ¥è¯¢æ•°æ®åº“è¡¨åˆ—è¡¨ï¼› </li><li>  <code>dbExistsTable</code>æ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦å­˜åœ¨è¡¨ï¼› </li><li>  <code>dbRemoveTable</code>ä»æ•°æ®åº“ä¸­åˆ é™¤è¡¨ï¼› </li><li>  <code>dbDisconnect</code>ä¸æ•°æ®åº“æ–­å¼€è¿æ¥ã€‚ </li></ul><br><h3 id="podklyuchenie-k-bazam-dannyh"> æ•°æ®åº“è¿æ¥ </h3><br><p> è¦ä¸æ•°æ®åº“è¿›è¡Œäº¤äº’ï¼Œå¿…é¡»é¦–å…ˆè¿æ¥åˆ°å®ƒä»¬ã€‚ æ ¹æ®æ‚¨è®¡åˆ’ä½¿ç”¨çš„DBMSï¼Œæ‚¨å°†éœ€è¦ä¸€ä¸ªé¢å¤–çš„è½¯ä»¶åŒ…ï¼Œä¸‹é¢æ˜¯æœ€å¸¸ç”¨çš„è½¯ä»¶åŒ…çš„åˆ—è¡¨ã€‚ </p><br><ul><li>  <code>odbc</code>é€šè¿‡ODBCæ¥å£è¿›è¡Œè¿æ¥çš„é©±åŠ¨ç¨‹åºï¼› </li><li>  <code>RSQLite</code> -SQLiteé©±åŠ¨ç¨‹åºï¼› </li><li>  <code>RMySQL</code> / <code>RMariaDB</code> -MySQLå’ŒMariaDBçš„é©±åŠ¨ç¨‹åºï¼› </li><li>  <code>RPostgreSQL</code> - <code>RPostgreSQL</code>é©±åŠ¨ç¨‹åºï¼› </li><li>  <code>bigrquery</code> -Google BigQueryçš„é©±åŠ¨ç¨‹åºï¼› </li><li>  <code>RClickhouse</code> / <code>clickhouse</code> - <code>clickhouse</code>é©±åŠ¨ç¨‹åºï¼› </li><li>  <code>RMSSQL</code>ç”¨äºMicrosoft SQL Serverï¼ˆMS SQLï¼‰çš„é©±åŠ¨ç¨‹åºï¼Œ <em>åœ¨æ’°å†™æœ¬æ–‡æ—¶ä»…åœ¨GitHubä¸Šæä¾›</em> ã€‚ </li></ul><br><p>  <code>DBI</code>è½¯ä»¶åŒ…æ˜¯åŸºæœ¬Rè½¯ä»¶åŒ…éšé™„çš„ï¼Œä½†æ˜¯å¿…é¡»ä½¿ç”¨<code>install.packages(" ")</code>å‘½ä»¤<code>install.packages(" ")</code>å®‰è£…ä½œä¸ºæ•°æ®åº“é©±åŠ¨ç¨‹åºçš„è½¯ä»¶åŒ…ã€‚ </p><br><p> è¦ä»GitHubå®‰è£…è½¯ä»¶åŒ…ï¼Œæ‚¨è¿˜éœ€è¦å…¶ä»–è½¯ä»¶åŒ…<code>devtools</code> ã€‚ ä¾‹å¦‚ï¼Œ <code>RMSSQL</code>è½¯ä»¶åŒ…å½“å‰æœªå‘å¸ƒåœ¨ä¸»Rè½¯ä»¶åŒ…å­˜å‚¨åº“ä¸­ï¼Œè¯·ä½¿ç”¨ä»¥ä¸‹ä»£ç è¿›è¡Œå®‰è£…ï¼š </p><br><pre> <code class="plaintext hljs">install.packages("devtools") devtools::install_github("bescoto/RMSSQL")</code> </pre> <br><h4 id="primer-podklyucheniya-k-microsoft-sql-server-s-pomoschyu-paketa-odbc"> ä½¿ç”¨odbcåŒ…è¿æ¥åˆ°Microsoft SQL Serverçš„ç¤ºä¾‹ </h4><br><p> åœ¨Rä¼šè¯ä¸­ä½¿ç”¨ä»»ä½•è½¯ä»¶åŒ…ä¹‹å‰ï¼Œå¿…é¡»é¦–å…ˆä½¿ç”¨<code>library(" ")</code>å‡½æ•°<code>library(" ")</code>è¿›è¡Œè¿æ¥ã€‚ </p><br><p> æˆ‘å¹¶éæ²¡æœ‰ç†ç”±é€‰æ‹©Microsoft SQL Serverä½œä¸ºä¸»è¦çš„DBMSï¼Œå®ƒå°†æä¾›æœ¬æ–‡ä¸­çš„å¤§å¤šæ•°ç¤ºä¾‹ã€‚ äº‹å®æ˜¯ï¼Œè¿™æ˜¯ä¸€ä¸ªç›¸å½“æµè¡Œçš„æ•°æ®åº“ï¼Œä½†ä¸æ­¤åŒæ—¶ï¼Œå®ƒä»ç„¶æ²¡æœ‰ç”¨äºä»CRANä¸Šå‘å¸ƒçš„Rè¿æ¥çš„é©±åŠ¨ç¨‹åºã€‚ </p><br><p> ä½†æ˜¯å¹¸è¿çš„æ˜¯ï¼ŒSQL Serverä¸å‡ ä¹æ‰€æœ‰å…¶ä»–æ•°æ®åº“ä¸€æ ·ï¼Œéƒ½å…·æœ‰ç”¨äºè¿æ¥çš„<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">ODBC</a> ï¼ˆè‹±è¯­å¼€æ”¾æ•°æ®åº“è¿æ¥ï¼‰æ¥å£ã€‚ æœ‰è®¸å¤šè½¯ä»¶åŒ…å¯é€šè¿‡Rä¸­çš„ODBCæ¥å£è¿æ¥åˆ°DBMSã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬å°†ç ”ç©¶é€šè¿‡<code>odbc</code>åŒ…è¿›è¡Œè¿æ¥ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">é€šè¿‡odbcæ¥å£è½»æ¾è¿æ¥æ•°æ®åº“</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   odbc install.packages("odbc") #   library(odbc) #   MS SQL con &lt;- dbConnect(drv = odbc(), Driver = "SQL Server", Server = "localhost", Database = "mybase", UID = "my_username", PWD = "my_password", Port = 1433)</code> </pre> </div></div><br><p> åœ¨<code>dbConnect()</code>å‡½æ•°ä¸­ï¼Œæ‚¨éœ€è¦ä¼ é€’è¯¥å‡½æ•°ä½œä¸º<em>drv</em>çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œè¯¥å‡½æ•°æ˜¯ç”¨äºè¿æ¥åˆ°DBMSçš„é©±åŠ¨ç¨‹åºï¼ˆ <code>odbc()</code> ï¼‰ã€‚ é€šå¸¸å°†æ­¤ç±»åŠŸèƒ½ä¸DBMSç§°ä¸ºç›¸åŒåŠŸèƒ½ï¼Œå¹¶ä¸”éšé™„æœ‰ä½œä¸º<code>DBI</code>é©±åŠ¨ç¨‹åºçš„è½¯ä»¶åŒ…ã€‚ </p><br><p> æ¥ä¸‹æ¥ï¼Œæ‚¨éœ€è¦åˆ—å‡ºè¿æ¥å‚æ•°ã€‚ è¦é€šè¿‡ODBCè¿æ¥åˆ°MS SQLï¼Œå¿…é¡»æŒ‡å®šä»¥ä¸‹å‚æ•°ï¼š </p><br><ul><li> é©±åŠ¨ç¨‹åº-ODBCé©±åŠ¨ç¨‹åºçš„åç§°ï¼› </li><li> æœåŠ¡å™¨-SQLæœåŠ¡å™¨çš„IPåœ°å€ï¼› </li><li> æ•°æ®åº“-è¦è¿æ¥çš„æ•°æ®åº“çš„åç§°ï¼› </li><li>  UID-æ•°æ®åº“ç”¨æˆ·åï¼› </li><li>  PWD-å¯†ç ï¼› </li><li> ç«¯å£-ä¸SQL Serverè¿æ¥çš„ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º1433ã€‚ </li></ul><br><p>  Windowsé™„å¸¦æœ‰ç”¨äºè¿æ¥åˆ°Microsoft SQL Serverçš„ODBCé©±åŠ¨ç¨‹åºï¼Œä½†å®ƒçš„åç§°å¯èƒ½ä¸åŒã€‚ æ‚¨å¯ä»¥åœ¨ODBCæ•°æ®æºç®¡ç†å™¨ä¸­æŸ¥çœ‹å·²å®‰è£…é©±åŠ¨ç¨‹åºçš„åˆ—è¡¨ã€‚ æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼åœ¨Windows 10ä¸­å¯åŠ¨æ•°æ®æºç®¡ç†å‘˜ï¼š </p><br><ul><li>  32ä½ç‰ˆæœ¬ï¼š <code>%systemdrive%\Windows\SysWoW64\Odbcad32.exe</code> </li><li>  64ä½ç‰ˆæœ¬ï¼š <code>%systemdrive%\Windows\System32\Odbcad32.exe</code> </li></ul><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c6c/816/934/c6c816934a70e2386a4547d7626d515f.png"></p><br><p> æ‚¨è¿˜å¯ä»¥ä½¿ç”¨<code>odbcListDrivers()</code>å‡½æ•°è·å¾—PCä¸Šå®‰è£…çš„æ‰€æœ‰é©±åŠ¨ç¨‹åºçš„åˆ—è¡¨ã€‚ </p><br><pre> <code class="plaintext hljs"> name attribute value &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; 1 SQL Server APILevel 2 2 SQL Server ConnectFunctions YYY 3 SQL Server CPTimeout 60 4 SQL Server DriverODBCVer 03.50 5 SQL Server FileUsage 0 6 SQL Server SQLLevel 1 7 SQL Server UsageCount 1 8 MySQL ODBC 5.3 ANSI Driver UsageCount 1 9 MySQL ODBC 5.3 Unicode Driver UsageCount 1 10 Simba ODBC Driver for Google BigQuery Description Simba ODBC Driver for Google BigQuery2.0 # ... with 50 more rows</code> </pre> <br><p> æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹é“¾æ¥ä¸‹è½½å…¶ä»–DBMSçš„ODBCé©±åŠ¨ç¨‹åºï¼š </p><br><ul><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">çš„MySQL</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PostgreSQLçš„</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">è°·æ­Œbigquery</a> </li></ul><br><p> å¯¹äºå„ç§DBMSï¼Œç”¨äºè¿æ¥çš„å‚æ•°åç§°å¯èƒ½ä¸åŒï¼Œä¾‹å¦‚ï¼š </p><br><ul><li>  PostgreSQL / MySQL / MariaDB-ç”¨æˆ·ï¼Œå¯†ç ï¼Œä¸»æœºï¼Œç«¯å£ï¼Œdbname; </li><li>  GoogleBigQuery-é¡¹ç›®ï¼Œæ•°æ®é›†ï¼› </li><li>  ClickHouse-ç”¨æˆ·ï¼Œå¯†ç ï¼Œæ•°æ®åº“ï¼Œç«¯å£ï¼Œä¸»æœºï¼› </li></ul><br><p> ä½¿ç”¨ODBCæ•°æ®æºç®¡ç†å‘˜ï¼Œæ‚¨å¯ä»¥è¿è¡Œå‘å¯¼æ¥åˆ›å»ºODBCæ•°æ®æºã€‚ ä¸ºæ­¤ï¼Œåªéœ€æ‰“å¼€ç®¡ç†å‘˜ï¼Œè½¬åˆ°â€œè‡ªå®šä¹‰DSNâ€é€‰é¡¹å¡ï¼Œç„¶åå•å‡»â€œæ·»åŠ ...â€æŒ‰é’®ã€‚ </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9ae/e92/ba3/9aee92ba30bdc8de811623aae1fb58fa.png"></p><br><p> ä½¿ç”¨ç®¡ç†å‘˜åˆ›å»ºæ•°æ®æºæ—¶ï¼Œè¯·ç»™å®ƒå‘½åDSNï¼ˆæ•°æ®æºåç§°ï¼‰ã€‚ </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b03/a0c/a7c/b03a0ca7c90fa0d5bddccb53575563a3.png"></p><br><p> åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨DSNâ€œ my_test_sourceâ€åˆ›å»ºäº†ä¸€ä¸ªæ•°æ®æºã€‚ ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ­¤æºè¿æ¥åˆ°Microsoft SQL Serverï¼Œè€Œæ— éœ€åœ¨ä»£ç ä¸­æŒ‡å®šå…¶ä»–è¿æ¥å‚æ•°ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ä½¿ç”¨DSNé€šè¿‡odbcæ¥å£è¿æ¥åˆ°æ•°æ®åº“</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   DSN con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password")</code> </pre> </div></div><br><p> æ‚¨å¯ä»¥ä½¿ç”¨<code>odbcListDataSources()</code>å‡½æ•°æŸ¥çœ‹åœ¨PCä¸Šåˆ›å»ºçš„æ‰€æœ‰ODBCæ•°æ®æºçš„åç§°ã€‚ </p><br><pre> <code class="plaintext hljs"> name description &lt;chr&gt; &lt;chr&gt; 1 BQ Simba ODBC Driver for Google BigQuery 2 BQ_main Simba ODBC Driver for Google BigQuery 3 BQ ODBC Simba ODBC Driver for Google BigQuery 4 OLX Simba ODBC Driver for Google BigQuery 5 Multicharts Simba ODBC Driver for Google BigQuery 6 PostgreSQL35W PostgreSQL Unicode(x64) 7 hillel_bq Simba ODBC Driver for Google BigQuery 8 blog_bq Simba ODBC Driver for Google BigQuery 9 MyClientMSSQL SQL Server 10 local_mssql SQL Server 11 MSSQL_localhost SQL Server 12 my_test_source SQL Server 13 Google BigQuery Simba ODBC Driver for Google BigQuery</code> </pre> <br><h3 id="primer-podklyucheniya-k-microsoft-sql-server-s-pomoschyu-paketa-rmssql"> ä½¿ç”¨RMSSQLåŒ…è¿æ¥åˆ°Microsoft SQL Serverçš„ç¤ºä¾‹ </h3><br><p>  <code>RMSSQL</code>ä¸åœ¨CRANä¸Šå‘å¸ƒï¼Œå› æ­¤æ‚¨å¯ä»¥ä½¿ç”¨<code>devtools</code>è½¯ä»¶åŒ…ä»GitHubå®‰è£…å®ƒã€‚ </p><br><pre> <code class="plaintext hljs">install.packages("devtools") devtools::install_github("bescoto/RMSSQL")</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">ä½¿ç”¨DBI RMSSQLé©±åŠ¨ç¨‹åºçš„è¿æ¥ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#    library(RJDBC) library(RMSSQL) library(DBI) #  RMSSQL con &lt;- dbConnect(MSSQLServer(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase")</code> </pre> </div></div><br><p> åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä½¿ç”¨<code>DBI</code>åŒ…å¤„ç†æ•°æ®åº“æ—¶ï¼Œå°†ä»¥è¿™ç§æ–¹å¼è¿›è¡Œè¿æ¥ã€‚ å³ å®‰è£…æ‰€éœ€çš„é©±åŠ¨ç¨‹åºåŒ…ä¹‹ä¸€ï¼Œå°†<code>dbConnect</code>å‡½æ•°ä½œä¸º<em>drv</em>å‚æ•°çš„å€¼ä¼ é€’ï¼Œè¯¥é©±åŠ¨ç¨‹åºå‡½æ•°ç”¨äºè¿æ¥åˆ°æ‰€éœ€çš„DBMSã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">è¿æ¥åˆ°MySQLï¼ŒPostgreSQLï¼ŒSQLiteå’ŒBigQueryçš„ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   MySQL library(RMySQL) con &lt;- dbConnect(MySQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   PostrgeSQL library(RPostgreSQL) con &lt;- dbConnect(PostgreSQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   PostrgeSQL library(RPostgreSQL) con &lt;- dbConnect(PostgreSQL(), host = 'localhost', user = 'my_username', password = 'my_password', dbname = "mybase", host = "localhost") #   SQLite library(RSQLite) # connection or create base con &lt;- dbConnect(drv = SQLite(), "localhost.db") #   Google BigQuery library(bigrquery) con &lt;- dbConnect(drv = bigquery(), project = "my_proj_id", dataset = "dataset_name")</code> </pre> </div></div><br><h3 id="kak-skryt-paroli-ot-bazy-dannyh-v-r-skriptah"> å¦‚ä½•åœ¨Rè„šæœ¬ä¸­éšè—æ•°æ®åº“å¯†ç  </h3><br><p> ä¸Šé¢ï¼Œæˆ‘ç»™å‡ºäº†ä¸€äº›ç¤ºä¾‹ï¼Œå¯ç”¨äºè¿æ¥åˆ°ä»»ä½•æ•°æ®åº“ï¼Œä½†æ˜¯å®ƒä»¬æœ‰ä¸€ä¸ªç¼ºç‚¹ï¼Œè¿™ç§å½¢å¼å°†æ‰€æœ‰æ•°æ®åº“è®¿é—®ï¼ˆåŒ…æ‹¬å¯†ç ï¼‰éƒ½ä»¥æ–‡æœ¬å½¢å¼å­˜å‚¨åœ¨è„šæœ¬æœ¬èº«ä¸­ã€‚ </p><br><p> å¦‚æœæ‰€æœ‰è„šæœ¬éƒ½åœ¨PCä¸Šæœ¬åœ°éƒ¨ç½²å’Œè¿è¡Œï¼Œå¹¶ä¸”åŒæ—¶å—å¯†ç ä¿æŠ¤ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½ä¸ä¼šå‡ºç°é—®é¢˜ã€‚ ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä¸åŒä¸€å°æœåŠ¡å™¨ä¸Šçš„æŸäººä¸€èµ·å·¥ä½œï¼Œé‚£ä¹ˆå°†æ•°æ®åº“ä¸­çš„å¯†ç å­˜å‚¨åœ¨è„šæœ¬æ–‡æœ¬ä¸­å¹¶ä¸æ˜¯æœ€ä½³è§£å†³æ–¹æ¡ˆã€‚ </p><br><p> æ¯ä¸ªæ“ä½œç³»ç»Ÿéƒ½æœ‰ä¸€ä¸ªç”¨äºç®¡ç†å‡­æ®çš„å®ç”¨ç¨‹åºã€‚ ä¾‹å¦‚ï¼Œåœ¨Windowsä¸Šï¼Œè¿™æ˜¯å‡­æ®ç®¡ç†å™¨ã€‚ æ‚¨å¯ä»¥å°†ç”¨äºé€šè¿‡<code>keyring</code>åŒ…è¿æ¥åˆ°æ•°æ®åº“çš„å¯†ç æ·»åŠ åˆ°æ­¤å­˜å‚¨ä¸­ã€‚ è¯¥è½¯ä»¶åŒ…æ˜¯è·¨å¹³å°çš„ï¼Œä»¥ä¸Šç¤ºä¾‹å¯åœ¨ä»»ä½•æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œè‡³å°‘åœ¨Windowsï¼ŒMacOSå’ŒLinuxä¸Šé€‚ç”¨ã€‚ </p><br><pre> <code class="plaintext hljs"># install.packages("keyring") #   library(keyring) library(RMSSQL) #   key_set_with_value(service = "mssql", username = "my_username", password = "my_password") #   RMSSQL con &lt;- dbConnect(MSSQLServer(), host = 'localhost', user = 'my_username', password = key_get("mssql", "my_username"), dbname = "mybase")</code> </pre> <br><p> å³ ä½¿ç”¨<code>key_set_with_value()</code>å‡½æ•°ï¼Œå¯ä»¥å°†å¯†ç æ·»åŠ åˆ°å‡­æ®å­˜å‚¨ä¸­ï¼Œç„¶åä½¿ç”¨<code>key_get()</code>è¯·æ±‚å¯†ç ï¼Œåªæœ‰å°†å…¶æ·»åŠ åˆ°å­˜å‚¨ä¸­çš„ç”¨æˆ·æ‰èƒ½è¯·æ±‚å¯†ç ã€‚ ä½¿ç”¨<code>keyring</code>æ‚¨ä¸ä»…å¯ä»¥å­˜å‚¨æ•°æ®åº“ä¸­çš„å¯†ç <code>keyring</code>è¿˜å¯ä»¥å­˜å‚¨ä»»ä½•æœåŠ¡ä¸­çš„å¯†ç ä»¥åŠä½¿ç”¨APIâ€‹â€‹æ—¶çš„æˆæƒä»¤ç‰Œã€‚ </p><br><h3 id="sozdanie-tablic-i-zapis-v-bazu-dannyh"> åˆ›å»ºè¡¨å¹¶å†™å…¥æ•°æ®åº“ </h3><br><p> å†™å…¥æ•°æ®åº“æ˜¯é€šè¿‡<code>dbWriteTable()</code>å‡½æ•°æ‰§è¡Œçš„ã€‚ </p><br><p>  <code>dbWriteTable()</code>å‡½æ•°çš„å‚æ•°ï¼š </p><br><p>  <em>å¿…å¡«å‚æ•°ä¸ºç²—ä½“ï¼Œæ–œä½“ä¸ºå¯é€‰</em> </p><br><ul><li>  <code>dbConnect</code>ä½¿ç”¨<code>dbConnect</code>å‡½æ•°åˆ›å»ºçš„DBMSè¿æ¥å¯¹è±¡ï¼› </li><li>  <strong>name</strong> -DBMSä¸­è¦å†™å…¥æ•°æ®çš„è¡¨çš„åç§°ï¼› </li><li>  <strong>value</strong> -Rä¸­çš„è¡¨ï¼ˆdata.frame / data.table / tibble_frameç±»çš„å¯¹è±¡ï¼‰ï¼Œè¯¥è¡¨ä¸­çš„æ•°æ®å°†è¢«å†™å…¥DBMSï¼› </li><li>  <em>row.names-</em>å°†å…·æœ‰è¡Œå·çš„row_namesåˆ—æ·»åŠ åˆ°è¡¨ä¸­ï¼Œ <em>é»˜è®¤ä¸ºFALSE</em> ã€‚ </li><li>  <em>overwrite-</em>å¦‚æœDBMSä¸­å·²ç»å­˜åœ¨å…·æœ‰<em>name</em>å‚æ•°ä¸­æŒ‡å®šåç§°çš„è¡¨ï¼Œåˆ™è¦†ç›–è¯¥è¡¨ï¼› <em>é»˜è®¤å€¼ä¸ºFALSE</em> ï¼›å¦åˆ™<em>ä¸ºfalse</em> ã€‚ </li><li>  <em>append-</em>å¦‚æœDBMSä¸­å·²ç»å­˜åœ¨å…·æœ‰åœ¨<em>name</em>å‚æ•°ä¸­æŒ‡å®šçš„<em>åç§°</em>çš„è¡¨ï¼Œåˆ™è¿½åŠ æ•°æ®ï¼› <em>é»˜è®¤å€¼ä¸ºFALSE</em> ï¼›å¦åˆ™<em>ä¸ºfalse</em> ã€‚ </li><li>  <em>field.types-</em>æ¥å—å‘½åå‘é‡ï¼Œå¹¶åœ¨å†™å…¥DBMSæ—¶åœ¨æ¯ä¸ªå­—æ®µä¸­è®¾ç½®æ•°æ®ç±»å‹ï¼Œ <em>é»˜è®¤ä¸ºNULL</em> ï¼› </li><li>  <em>ä¸´æ—¶</em> -å…è®¸æ‚¨åœ¨DBMSä¸­åˆ›å»ºä¸´æ—¶è¡¨ï¼Œç›´åˆ°æ–­å¼€ä¸æ•°æ®åº“çš„è¿æ¥ä¸ºæ­¢ï¼Œè¿™äº›è¡¨æ‰å¯ç”¨ï¼› <em>é»˜è®¤å€¼ä¸ºFALSE</em> ã€‚ </li></ul><br><div class="spoiler">  <b class="spoiler_title">é€šè¿‡DBIå°†æ•°æ®å†™å…¥DBMSçš„ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #     DSN con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #     iris,         R  iris dbWriteTable(conn = con, name = "iris", value = iris) #     dbDisconnect(con)</code> </pre> </div></div><br><p> è¦æŸ¥çœ‹æ•°æ®åº“ä¸­çš„è¡¨ï¼Œè¯·ä½¿ç”¨<code>dbListTables()</code>å‡½æ•°ï¼Œåˆ é™¤è¡¨<code>dbRemoveTable()</code> </p><br><div class="spoiler">  <b class="spoiler_title">æŸ¥è¯¢è¡¨åˆ—è¡¨å¹¶ä»DBMSåˆ é™¤è¡¨çš„ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #    dbListTables(con) #   iris dbRemoveTable(con, "iris") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="chtenie-dannyh-iz-subd"> ä»DBMSè¯»å–æ•°æ® </h3><br><p> ä½¿ç”¨<code>DBI</code>æ‚¨å¯ä»¥æŸ¥è¯¢æ•´ä¸ªè¡¨æˆ–æ‰§è¡ŒSQLæŸ¥è¯¢çš„ç»“æœã€‚  <code>dbReadTable()</code>å’Œ<code>dbGetQuery()</code>å‡½æ•°ç”¨äºæ‰§è¡Œè¿™äº›æ“ä½œã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">ä»DBMSæŸ¥è¯¢è™¹è†œè¡¨çš„ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #   iris   iris dbiris &lt;- dbReadTable(con, "iris") #     dbDisconnect(con)</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">ä»DBMSåŠ è½½SQLæ‰§è¡Œç»“æœçš„ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #     setosa &lt;- dbGetQuery(con, "SELECT * FROM iris WHERE Species = 'setosa'") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="manipulirovanie-dannymi-v-subd-dml">  DBMSï¼ˆDMLï¼‰ä¸­çš„æ•°æ®å¤„ç† </h3><br><p> ä¸Šé¢<code>dbGetQuery()</code>çš„<code>dbGetQuery()</code>å‡½æ•°ä¸“é—¨ç”¨äºæŸ¥è¯¢æ•°æ®æ ·æœ¬ï¼ˆSELECTï¼‰ã€‚ </p><br><p> å¯¹äºè¯¸å¦‚UPDATEï¼ŒINSERTï¼ŒDELETEä¹‹ç±»çš„æ•°æ®æ“ä½œæ“ä½œï¼Œ <code>DBI</code>å­˜åœ¨<code>dbExecute()</code>å‡½æ•°ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">åœ¨DBMSä¸­å¤„ç†æ•°æ®çš„ç¤ºä¾‹ä»£ç </b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #   (INSERT) dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   (UPDATE) dbExecute(con, "UPDATE iris SET [Species] = 'old_value' WHERE row_names = 51") #     (DELETE) dbExecute(con, "DELETE FROM iris WHERE row_names = 51") #     dbDisconnect(con)</code> </pre> </div></div><br><h3 id="tranzakcii-v-subd">  DBMSä¸­çš„äº‹åŠ¡ </h3><br><blockquote> äº‹åŠ¡æ˜¯é¡ºåºçš„è¯»å†™æ“ä½œã€‚ äº‹åŠ¡çš„ç»“å°¾å¯ä»¥æ˜¯ä¿å­˜æ›´æ”¹ï¼ˆæäº¤ï¼Œæäº¤ï¼‰æˆ–å–æ¶ˆæ›´æ”¹ï¼ˆå›æ»šï¼Œå›æ»šï¼‰ã€‚ å…³äºæ•°æ®åº“ï¼Œäº‹åŠ¡æ˜¯ä¸€ç³»åˆ—æŸ¥è¯¢ï¼Œè¢«è§†ä¸ºå•ä¸ªæŸ¥è¯¢ã€‚ </blockquote><p>  <em><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">å¼•ç”¨æ–‡ç« â€œäº¤æ˜“åŠå…¶æ§åˆ¶æœºåˆ¶â€</a></em> </p><br><p> äº‹åŠ¡å°†å‡ ä¸ªSQLè¯­å¥å°è£…åœ¨ä¸€ä¸ªåŸºæœ¬å•å…ƒä¸­ã€‚ åœ¨<code>DBI</code>äº‹åŠ¡çš„å¼€å§‹ç”±<code>dbBegin()</code>å¯åŠ¨ï¼Œç„¶åç”±<code>dbCommit()</code>ç¡®è®¤æˆ–ç”±<code>dbRollback()</code>å–æ¶ˆã€‚ åœ¨ä»»ä½•æƒ…å†µä¸‹ï¼ŒDBMSéƒ½ä¿è¯ï¼šå°†æ‰€æœ‰è¯­å¥æˆ–å…¨éƒ¨è¯­å¥éƒ½ä¸åº”ç”¨äºæ•°æ®ã€‚ </p><br><p> ä¾‹å¦‚ï¼Œåœ¨äº¤æ˜“è¿‡ç¨‹ä¸­ï¼Œè®©æˆ‘ä»¬å‘è™¹è†œè¡¨æ·»åŠ 51è¡Œï¼Œç„¶åå°†<em>Sepal.Width</em>å€¼æ›´æ”¹ä¸º5è¡Œï¼Œå¹¶ä»è¡¨ä¸­åˆ é™¤43è¡Œã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">äº¤æ˜“ä»£ç ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor #    dbBegin(con) #   dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   dbExecute(con, "UPDATE iris SET [Sepal.Width] = 8 WHERE row_names = 5") #   43 dbExecute(con, "DELETE FROM iris WHERE row_names = 43") #   dbCommit(con) #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5 8.0 1.4 0.2 setosa # 2 51 7 3.2 4.7 1.4 versicolor # 3 51 5 3.3 1.7 0.3 new_values</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">äº¤æ˜“å–æ¶ˆä»£ç ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(odbc) #    con &lt;- dbConnect(odbc(), DSN = "my_test_source", UID = "my_username", PWD = "my_password") #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor #    dbBegin(con) #   dbExecute(con, "INSERT INTO iris (row_names, [Sepal.Length], [Sepal.Width], [Petal.Length], [Petal.Width], [Species]) VALUES (51, 5.0, 3.3, 1.7, 0.3, 'new_values')") #   dbExecute(con, "UPDATE iris SET [Sepal.Width] = 8 WHERE row_names = 5") #   43 dbExecute(con, "DELETE FROM iris WHERE row_names = 43") #   dbRollback(con) #      dbGetQuery(con, "SELECT * FROM iris WHERE row_names IN (5, 43, 51)") # row_names Sepal.Length Sepal.Width Petal.Length Petal.Width Species # 1 5 5.0 3.6 1.4 0.2 setosa # 2 43 4.4 3.2 1.3 0.2 setosa # 3 51 7.0 3.2 4.7 1.4 versicolor</code> </pre> </div></div><br><h1 id="paket-rodbc">  RODBCå¥—ä»¶ </h1><br><p>  <code>RODBC</code>è½¯ä»¶åŒ…æä¾›äº†ä¸€ä¸ªç‹¬ç«‹çš„æ¥å£ï¼Œç”¨äºé€šè¿‡ODBCæ¥å£è¿æ¥å’Œä½¿ç”¨DBMSã€‚ </p><br><p>  <code>RODBC</code>ä¸å…¼å®¹<code>DBI</code> ï¼Œå³ æ‚¨ä¸èƒ½åœ¨<code>DBI</code>è½¯ä»¶åŒ…æä¾›çš„å‡½æ•°ä¸­ä½¿ç”¨ä½¿ç”¨<code>RODBC</code>åˆ›å»ºçš„è¿æ¥å¯¹è±¡ã€‚ </p><br><h3 id="osnovnye-funkcii-paketa-rodbc">  RODBCè½¯ä»¶åŒ…çš„ä¸»è¦åŠŸèƒ½ </h3><br><ul><li>  <code>odbcConnect</code>é€šè¿‡DSNè¿æ¥åˆ°DBMSï¼› </li><li>  <code>odbcDriverConnect</code>é€šè¿‡è¿æ¥å­—ç¬¦ä¸²è¿æ¥åˆ°æ•°æ®åº“ï¼› </li><li>  <code>sqlQuery</code>å°†æŸ¥è¯¢å‘é€åˆ°DBMSï¼Œå¹¶è·å–å…¶æ‰§è¡Œç»“æœã€‚ æ”¯æŒä»»ä½•ç±»å‹çš„æŸ¥è¯¢ï¼šSELECTï¼ŒUPDATEï¼ŒINSERTï¼ŒDELETEã€‚ </li><li>  <code>sqlFetch</code>ä»DBMSè·å–æ•´ä¸ªè¡¨ï¼› </li><li>  <code>sqlTables</code>è·å–æ•°æ®åº“ä¸­è¡¨çš„åˆ—è¡¨ã€‚ </li><li>  <code>sqlSave</code>åœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªæ–°è¡¨ï¼Œæˆ–å‘ç°æœ‰è¡¨ä¸­æ·»åŠ æ–°æ•°æ®ï¼› </li><li>  <code>sqlUpdate</code>æ›´æ–°DBMSä¸­å·²ç»å­˜åœ¨çš„è¡¨ä¸­çš„æ•°æ®ï¼› </li><li>  <code>sqlDrop</code>åˆ é™¤DBMSä¸­çš„è¡¨ï¼› </li><li>  <code>odbcClose</code>ç»ˆæ­¢ä¸DBMSçš„è¿æ¥ã€‚ </li></ul><br><h3 id="primer-raboty-s-rodbc"> ä½¿ç”¨RODBCçš„ç¤ºä¾‹ </h3><br><p> åœ¨æˆ‘çœ‹æ¥ï¼Œ <code>RODBC</code>åŠŸèƒ½ä¸å¦‚<code>DBI</code> ï¼Œä½†å®ƒå…·æœ‰ä½¿ç”¨DBMSæ‰€éœ€çš„æ‰€æœ‰å¿…è¦åŠŸèƒ½ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">é€šè¿‡RODBCä¸DBMSäº¤äº’çš„ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(RODBC) #   con_string &lt;- odbcDriverConnect(connection = "Driver=SQL Server;Server=localhost;Database=mybase;UID=my_username;PWD=my_password;Port=1433") #   DSN con_dsn &lt;- odbcConnect(dsn = "my_test_source", uid = "my_username", pwd = "my_password") #     sqlSave(con_dsn, dat = iris, tablename = "iris") #     iris sqlSave(con_dsn, dat = iris, tablename = "iris", append = TRUE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) #      R iris[1, 5] &lt;- "virginica" #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   4     sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) #   sqlDrop(con_dsn, sqtable = "iris") #     odbcCloseAll()</code> </pre> </div></div><br><h1 id="tranzakcionnost"> äº¤æ˜“æ€§ </h1><br><p> é»˜è®¤æƒ…å†µä¸‹ï¼Œ <code>RODBC</code>äº‹åŠ¡æ€§å¤„äºå…³é—­çŠ¶æ€ã€‚ äº¤æ˜“ç®¡ç†ç”±ä¸¤ä¸ªåŠŸèƒ½æ‰§è¡Œã€‚ </p><br><ul><li>  <code>odbcSetAutoCommit</code>åœ¨æ­£å¸¸å’Œäº‹åŠ¡DBMSæ“ä½œæ¨¡å¼ä¹‹é—´åˆ‡æ¢ï¼› </li><li>  <code>odbcEndTran</code>ç¡®è®¤æˆ–å–æ¶ˆäº¤æ˜“ã€‚ </li></ul><br><p>  <code>odbcSetAutoCommit</code>å‡½æ•°ä½¿ç”¨<em>autoCommit</em>å‚æ•°æ‰“å¼€å’Œå…³é—­äº‹åŠ¡æ¨¡å¼ã€‚ </p><br><div class="spoiler">  <b class="spoiler_title">åœ¨RODBCä¸­ä»¥äº‹åŠ¡æ¨¡å¼å·¥ä½œçš„ç¤ºä¾‹</b> <div class="spoiler_text"><pre> <code class="plaintext hljs">#   library(RODBC) #   DSN con_dsn &lt;- odbcConnect(dsn = "my_test_source", uid = "my_username", pwd = "my_password") #     sqlSave(con_dsn, dat = iris, tablename = "iris") #    odbcSetAutoCommit(con_dsn, autoCommit = FALSE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 setosa # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #      R iris[1, 5] &lt;- "virginica" #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 virginica # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #   odbcEndTran(con_dsn, commit = FALSE) #   4  sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 setosa # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #     sqlUpdate(con_dsn, dat = iris, tablename = "iris") #   odbcEndTran(con_dsn, commit = TRUE) #   4     sqlFetch(con_dsn, "iris", rownames = FALSE, max = 4) # rownames SepalLength SepalWidth PetalLength PetalWidth Species # 1 1 5.1 3.5 1.4 0.2 virginica # 2 2 4.9 3.0 1.4 0.2 setosa # 3 3 4.7 3.2 1.3 0.2 setosa # 4 4 4.6 3.1 1.5 0.2 setosa #     odbcClose(con_dsn)</code> </pre> </div></div><br><h1 id="zaklyuchenie"> ç»“è®º </h1><br><p> æœ¬æ–‡ä»‹ç»çš„ä½¿ç”¨Rï¼Œ <code>DBI</code>å’Œ<code>RODBC</code>è¯­è¨€å¤„ç†æ•°æ®åº“çš„ä¸¤ç§æ–¹æ³•éå¸¸é€šç”¨ï¼Œå‡ ä¹å¯ä»¥ä¸ä»»ä½•DBMSä¸€èµ·ä½¿ç”¨ã€‚ </p><br><p> ä¸åŒDBMSä¹‹é—´çš„å”¯ä¸€æ“ä½œåŒºåˆ«æ˜¯è¿æ¥è¿‡ç¨‹ã€‚ å¯¹äºå¤§å¤šæ•°æµè¡Œçš„DBMSï¼Œæœ‰å•ç‹¬çš„ç¨‹åºåŒ…æ˜¯é©±åŠ¨ç¨‹åºã€‚ å¯¹äºå…¶ä½™çš„DBMSï¼Œå¿…é¡»ä½¿ç”¨<code>odbc</code>æˆ–<code>RODBC</code>é€šè¿‡ODBCæ¥å£é…ç½®è¿æ¥ã€‚ ä¸ç®¡æ‚¨é€‰æ‹©äº†å“ªç§DBMSï¼Œå…¶ä»–æ‰€æœ‰æ“ä½œéƒ½å°†ä¿æŒä¸å˜ã€‚ æ ¹æ®æ­£åœ¨ä½¿ç”¨çš„DBMSæ”¯æŒçš„SQLæ–¹è¨€ï¼Œå‘é€SQLæŸ¥è¯¢æ˜¯ä¸€ä¸ªä¾‹å¤–ã€‚ </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN461063/">https://habr.com/ru/post/zh-CN461063/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN461053/index.html">æˆ‘ä»¬å°†åœ¨çº¿åœ°å›¾è¿æ¥åˆ°æ™ºèƒ½æ‰‹æœºä¸Šçš„å¯¼èˆªå™¨ã€‚ ç¬¬2éƒ¨åˆ†-çŸ¢é‡å¡</a></li>
<li><a href="../zh-CN461055/index.html">Rekko Challenge 2019ï¼šæ€ä¹ˆæ ·</a></li>
<li><a href="../zh-CN461057/index.html">æœ‰å…³æ¸¸æˆå¼€å‘çš„ç”µæŠ¥é¢‘é“</a></li>
<li><a href="../zh-CN461059/index.html">ä¸ºç”µå½±è¿·ç¼–å†™ä¸€ä¸ªAndroidåº”ç”¨-ç¬¬1éƒ¨åˆ†ï¼ˆåŸå‹è®¾è®¡ï¼‰</a></li>
<li><a href="../zh-CN461061/index.html">é•åˆé‡‘ï¼ŒåŒæ™¶ç•Œå’Œåæ</a></li>
<li><a href="../zh-CN461067/index.html">æ‚¨åº”è¯¥åœ¨2019å¹´å‡†å¤‡çš„å·¥ä½œé¢è¯•ä¸­çš„å‰65ä¸ªSQLé—®é¢˜ã€‚ ç¬¬ä¸€éƒ¨åˆ†</a></li>
<li><a href="../zh-CN461069/index.html">è¯ºè´å°”æˆ·å¤–IPæ‘„åƒæœºï¼šIvideonè§†é¢‘ç›‘æ§ç³»ç»Ÿçš„æµ‹è¯•ï¼ŒæŠ€æœ¯å’ŒåŠŸèƒ½</a></li>
<li><a href="../zh-CN461071/index.html">é’ˆå¯¹å»ºç­‘å•†çš„B2BæœåŠ¡ç¤ºä¾‹ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢</a></li>
<li><a href="../zh-CN461073/index.html">æˆ‘ä»¬å°†åœ¨çº¿åœ°å›¾è¿æ¥åˆ°æ™ºèƒ½æ‰‹æœºä¸Šçš„å¯¼èˆªå™¨ã€‚ ç¬¬3éƒ¨åˆ†-å¤©æ¡¥æ¶¡è½®å¢å‹</a></li>
<li><a href="../zh-CN461075/index.html">å•†ä¸šæ™ºèƒ½ã€‚ ITå¯¹è±¡ï¼Œç»„ä»¶ï¼Œå·¥å…·</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>