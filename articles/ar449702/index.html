<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ด ๐ฆ ุนูู ุงููุณุฑุญ ูุฑุฉ ุฃุฎุฑู ุงููุงุฆุฒูู ูู ุงููุณุงุจูุงุช ุงูุฏูููุฉ SSH ู sudo. ุจุชูุฌูู ูู ุฏููู ุงููุดุท ุฏููู ุงูุดุฑู ๐๐ฝ ๐ ๐๐ผ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุชุงุฑูุฎูุงู ุ ุชู ุชูุธูู ุญููู sudo ูู ุฎูุงู ูุญุชููุงุช ุงููููุงุช ูู /etc/sudoers.d ู visudo ุ ูุชู ุฅุฌุฑุงุก ุชูููุถ ุฑุฆูุณู ุจุงุณุชุฎุฏุงู ~ / .ssh / Author_keys . ููุน ุฐูู ุ ู...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>ุนูู ุงููุณุฑุญ ูุฑุฉ ุฃุฎุฑู ุงููุงุฆุฒูู ูู ุงููุณุงุจูุงุช ุงูุฏูููุฉ SSH ู sudo. ุจุชูุฌูู ูู ุฏููู ุงููุดุท ุฏููู ุงูุดุฑู</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/449702/" style=";text-align:right;direction:rtl">  ุชุงุฑูุฎูุงู ุ ุชู ุชูุธูู ุญููู sudo ูู ุฎูุงู ูุญุชููุงุช ุงููููุงุช ูู <i>/etc/sudoers.d</i> ู <i>visudo</i> ุ ูุชู <i>ุฅุฌุฑุงุก</i> ุชูููุถ ุฑุฆูุณู ุจุงุณุชุฎุฏุงู <i>~ / .ssh / Author_keys</i> .  ููุน ุฐูู ุ ูุน ููู ุงูุจููุฉ ุงูุชุญุชูุฉ ุ ููุงู ุฑุบุจุฉ ูู ุฅุฏุงุฑุฉ ูุฐู ุงูุญููู ุจุดูู ูุฑูุฒู.  ุญุชู ุงูุขู ุ ูุฏ ูููู ููุงู ุงูุนุฏูุฏ ูู ุงูุญููู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุธุงู ุฅุฏุงุฑุฉ ุงูุชูููู - <i>ุงูุดูู</i> ุ <i>ุงูุฏููุฉ</i> ุ <i>Ansible</i> ุ <i>ุงูููุญ</i> </li><li style=";text-align:right;direction:rtl">  <i>ุงูุฏููู ุงููุดุท</i> + <i>sssd</i> </li><li style=";text-align:right;direction:rtl">  ุชุดููุงุช ูุฎุชููุฉ ูู ุดูู ูุตูุต ูุชุญุฑูุฑ ูุฏูู ูููููุงุช </li></ul><br>  ูู ุฑุฃูู ุงูุดุฎุตู ุ ูุฅู ุฃูุถู ุฎูุงุฑ ููุฅุฏุงุฑุฉ ุงููุฑูุฒูุฉ ูุง ูุฒุงู ูุฌููุนุฉ ูู <i>Active Directory</i> + <i>sssd</i> .  ูุฒุงูุง ูุฐุง ุงูููุฌ ูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุญูุง ุฏููู ูุณุชุฎุฏู ูุฑูุฒู ูุงุญุฏ. </li><li style=";text-align:right;direction:rtl">  ุชูุฒูุน ุญููู <b>sudo</b> ูุชุนูู ุจุฅุถุงูุฉ ูุณุชุฎุฏู ุฅูู ูุฌููุนุฉ ุฃูุงู ูุญุฏุฏุฉ. </li><li style=";text-align:right;direction:rtl">  ูู ุญุงูุฉ ุฃูุธูุฉ Linux ุงููุฎุชููุฉ ุ ููุงู ุญุงุฌุฉ ูุฅุฏุฎุงู ุงุฎุชุจุงุฑุงุช ุฅุถุงููุฉ ูุชุญุฏูุฏ ูุธุงู ุงูุชุดุบูู ุนูุฏ ุงุณุชุฎุฏุงู ุฃูุธูุฉ ุงูุชูููู. </li></ul><br>  ุณูุชู ุชุฎุตูุต ูุฌููุนุฉ ุงูููู ูุญุฒูุฉ <i>Active Directory</i> + <i>sssd</i> ูุฅุฏุงุฑุฉ ุญููู <b>sudo</b> ูุชุฎุฒูู ููุงุชูุญ <b>ssh</b> ูู ูุณุชูุฏุน ูุงุญุฏ. <br>  ูุฐุง ุ ุชุฌูุฏ ุงูุฌูููุฑ ุจุตูุช ูุชูุชุฑ ุ ุฑูุน ุงูููุตู ุนุตุงู ุ ุฃุนุฏุช ุงูุฃูุฑูุณุชุฑุง. <br>  ุฏุนูุง ูุฐูุจ. <br><a name="habracut"></a><br>  ูุนูู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>ุงููุฌุงู</b> ุงููุดุท <b>testopf.local</b> ุนูู ูุธุงู ุงูุชุดุบูู Windows Server 2012 R2. </li><li style=";text-align:right;direction:rtl">  ูุถูู Linux ูููู ุจุชุดุบูู Centos 7 </li><li style=";text-align:right;direction:rtl">  ุฅุฐู ุชูููู ุจุงุณุชุฎุฏุงู <b>sssd</b> </li></ul><br>  ูููู ููุง ุงูุญููู ุจุฅุฌุฑุงุก ุชุบููุฑุงุช ุนูู <i>ูุฎุทุท Active Directory</i> ุ ูุฐูู ูุญู ูุชุญูู ูู ูู ุดูุก ูู ุจูุฆุฉ ุงุฎุชุจุงุฑ ูุจุนุฏ ุฐูู ููุท ูููู ุจุฅุฌุฑุงุก ุชุบููุฑุงุช ุนูู ุงูุจููุฉ ุงูุชุญุชูุฉ ููุนูู.  ุฃุฑูุฏ ุฃู ุฃุดูุฑ - ูู ุงูุชุบููุฑุงุช ุชุณุชูุฏ ุฅูู ููุงุท ุ ููู ุงููุงูุน ุ ุชุถูู ููุท ุงูุณูุงุช ูุงููุฆุงุช ุงููุงุฒูุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุงูุฎุทูุฉ 1: ุฅุฏุงุฑุฉ ุฃุฏูุงุฑ <b>sudo ูู</b> ุฎูุงู <i>Active Directory</i> . </h3><br>  ูุชูุณูุน <i>ูุฎุทุท Active Directory ุ</i> ุชุญุชุงุฌ ุฅูู ุชูุฒูู ุฃุญุฏุซ ุฅุตุฏุงุฑ <a href="">sudo</a> - 1.8.27 ุงูููู.  ูู ุจูู <i>ุถุบุท</i> ุ ุงูุณุฎ ููู <i>schema.ActiveDirectory</i> ูู ุงูุฏููู ./doc ุฅูู ูุญุฏุฉ ุชุญูู ุงููุฌุงู.  ูู ุณุทุฑ ุงูุฃูุงูุฑ ูุน ุญููู ุงููุณุคูู ูู ุงูุฏููู ุญูุซ ููุช ุจูุณุฎ ุงูููู ุ ูู ุจุชุดุบูู: <br><br> <code>ldifde -i -f schema.ActiveDirectory -c dc=X dc=testopf,dc=local</code> <br>  (ูุง ุชูุณู ุฃู ุชุญู ูุญู ุงูููู ุงูุฎุงุตุฉ ุจู) <br><br>  ุงูุชุญ <b>adsiedit.msc ูุงุชุตู</b> ุจุงูุณูุงู ุงูุงูุชุฑุงุถู: <br><br>  ูู ุฌุฐุฑ ุงููุฌุงู ุ ูู ุจุฅูุดุงุก ูุญุฏุฉ <b>sudoers</b> .  (ูุฌุงุฏู ุงูุจุฑุฌูุงุฒููู ุจุนูุงุฏ ุฃูู ูู ูุฐุง ุงููุณู ุงููุฑุนู ูุจุญุซ ุงูุดูุทุงู <i>sssd</i> ุนู ูุงุฆูุงุช <i>sudoRole</i> . ููุน ุฐูู ุ ุจุนุฏ ุชุดุบูู ุงูุชุตุญูุญ ุงูุชูุตููู ููุญุต ุงูุณุฌูุงุช ุ ุชู ุงููุดู ุนู ุฅุฌุฑุงุก ุงูุจุญุซ ูู ุดุฌุฑุฉ ุงููุชุงููุฌ.) <br><br>  ูู <b>ุจุฅูุดุงุก</b> ุงููุงุฆู ุงูุฃูู ูู ุงููุญุฏุฉ ุงูุชู ุชูุชูู ุฅูู ูุฆุฉ <b>sudoRole</b> .  ูููู ุงุฎุชูุงุฑ ุงูุงุณู ุจุดูู ุชุนุณูู ููุบุงูุฉ ุ ูุฃูู ูุฎุฏู ููุท ูู ุชุญุฏูุฏ ุงููููุฉ ุจุณูููุฉ. <br><br>  ูู ุจูู ุงูุณูุงุช ุงููุชุงุญุฉ ุงููุญุชููุฉ ูู ุงูุชุฏุงุฏ ุงููุฎุทุท ุ ุฃูููุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>sudoCommand</b> - ูุชุญุฏูุฏ ุงูุฃูุงูุฑ ุงููุณููุญ ููุง ุจุงูุนูู ุนูู ุงููุถูู. </li><li style=";text-align:right;direction:rtl">  <b>sudoHost</b> - ูุญุฏุฏ ุงููุถูููู ุงูุฐู ููุทุจู ุนููู ูุฐุง ุงูุฏูุฑ.  ูููู ุชุนููููุง ุนูู ุฃููุง <b>ALL</b> ุ ุฃู ููุถูู ูุฑุฏู ุจุงูุงุณู.  ูู ุงููููู ุฃูุถูุง ุงุณุชุฎุฏุงู ููุงุน. </li><li style=";text-align:right;direction:rtl">  <b>sudoUser</b> - ูุดูุฑ ุฅูู ุงููุณุชุฎุฏููู ุงููุณููุญ ููู ุจุชูููุฐ <i>sudo</i> . <br>  ุฅุฐุง ุชู ุชุญุฏูุฏ ูุฌููุนุฉ ุฃูุงู ุ ูุฃุถู ุนูุงูุฉ "ูช" ูู ุจุฏุงูุฉ ุงูุงุณู.  ุฅุฐุง ูุงูุช ููุงู ูุณุงูุงุช ูู ุงุณู ุงููุฌููุนุฉ ุ ููุง ููุฌุฏ ูุง ูุฏุนู ููููู.  ุงุฐุง ุญูููุง ูู ุฎูุงู ุงูุณุฌูุงุช ุ ุชุฃุฎุฐ ุขููุฉ <i>sssd</i> ูููุฉ ุงููุฑูุจ ูู ุงููุณุงุญุงุช. </li></ul><br><img src="https://habrastorage.org/webt/2x/fo/x6/2xfox6jwkxmqxem1oehtssukimi.png"><br>  <i>ุงูุดูู 1. ูุงุฆูุงุช sudoRole ูู ูุญุฏุฉ sudoers ูู ุฌุฐุฑ ุงูุฏููู</i> <br><br><img src="https://habrastorage.org/webt/oh/2q/un/oh2qunltygcljciuwna5uaqfako.png"><br>  <i>ุงูุดูู 2. ุงูุนุถููุฉ ูู ูุฌููุนุงุช ุงูุฃูุงู ุงููุญุฏุฏุฉ ูู ูุงุฆูุงุช sudoRole.</i> <br><br>  ูุชู ุงูุชูููู ุงูุชุงูู ุนูู ุฌุงูุจ Linux. <br><br>  ูู ุงูููู <b>/etc/nsswitch.conf</b> ุ ุฃุถู ุงูุณุทุฑ ุฅูู ููุงูุฉ ุงูููู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sudoers: files sss</code> </pre> <br>  ูู ููู <b>/etc/sssd/sssd.conf</b> ูู ุงูููุทุน <b>[sssd]</b> ุ ุฃุถู <b>sudo</b> ุฅูู ุงูุฎุฏูุงุช <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cat /etc/sssd/sssd.conf | grep services services = nss, pam, sudo</code> </pre><br>  ุจุนุฏ ูู ุงูุนูููุงุช ุ ุชุญุชุงุฌ ุฅูู ูุณุญ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ุงูุฎูู sssd.  ูุชู ุฅุฌุฑุงุก ุงูุชุญุฏูุซุงุช ุงูุชููุงุฆูุฉ ูู 6 ุณุงุนุงุช ุ ูููู ููุงุฐุง ูุชุนูู ุนูููุง ุงูุงูุชุธุงุฑ ูุซูุฑูุง ุนูุฏูุง ูุฑูุฏ ุงูุขู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">sss_cache -E</code> </pre> <br>  ูุญุฏุซ ุบุงูุจูุง ุฃู ูุณุญ ุฐุงูุฑุฉ ุงูุชุฎุฒูู ุงููุคูุช ูุง ูุณุงุนุฏ.  ุซู ูููู ุงูุฎุฏูุฉ ูููุธู ุงููุงุนุฏุฉ ููุจุฏุฃ ุงูุฎุฏูุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">service sssd stop rm -rf /var/lib/sss/db/* service sssd start</code> </pre><br>  ูุชุตู ุชุญุช ุงููุณุชุฎุฏู ุงูุฃูู ููุชุญูู ูู ุฃูู ูููู ุงููุตูู ุฅููู ูู ุชุญุช sudo: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">su user1 [user1@testsshad <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>]$ id uid=1109801141(user1) gid=1109800513(domain users) groups=1109800513(domain users),1109801132(admins_) [user1@testsshad <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>]$ sudo -l [sudo] password <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> user1: Matching Defaults entries <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> user1 on testsshad: !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin, env_reset, env_keep=<span class="hljs-string"><span class="hljs-string">"COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS"</span></span>, env_keep+=<span class="hljs-string"><span class="hljs-string">"MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE"</span></span>, env_keep+=<span class="hljs-string"><span class="hljs-string">"LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES"</span></span>, env_keep+=<span class="hljs-string"><span class="hljs-string">"LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE"</span></span>, env_keep+=<span class="hljs-string"><span class="hljs-string">"LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY"</span></span>, secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin User user1 may run the following commands on testsshad: (root) /usr/bin/ls, /usr/bin/cat</code> </pre> <br>  ูุญู ููุนู ููุณ ุงูุดูุก ูุน ูุณุชุฎุฏููุง ุงูุซุงูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">su user2 [user2@testsshad <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>]$ id uid=1109801142(user2) gid=1109800513(domain users) groups=1109800513(domain users),1109801138(sudo_root) [user2@testsshad <span class="hljs-built_in"><span class="hljs-built_in">log</span></span>]$ sudo -l Matching Defaults entries <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> user2 on testsshad: !visiblepw, always_set_home, match_group_by_gid, always_query_group_plugin, env_reset, env_keep=<span class="hljs-string"><span class="hljs-string">"COLORS DISPLAY HOSTNAME HISTSIZE KDEDIR LS_COLORS"</span></span>, env_keep+=<span class="hljs-string"><span class="hljs-string">"MAIL PS1 PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE"</span></span>, env_keep+=<span class="hljs-string"><span class="hljs-string">"LC_COLLATE LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES"</span></span>, env_keep+=<span class="hljs-string"><span class="hljs-string">"LC_MONETARY LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE"</span></span>, env_keep+=<span class="hljs-string"><span class="hljs-string">"LC_TIME LC_ALL LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY"</span></span>, secure_path=/sbin\:/bin\:/usr/sbin\:/usr/bin User user2 may run the following commands on testsshad: (root) ALL</code> </pre><br>  ูุชูุญ ูู ูุฐุง ุงูููุฌ ุชุญุฏูุฏ ุฃุฏูุงุฑ sudo ูุฑูุฒููุง ููุฌููุนุงุช ุงููุณุชุฎุฏููู ุงููุฎุชููุฉ. <br><br><h3 style=";text-align:right;direction:rtl">  ุชุฎุฒูู ูุงุณุชุฎุฏุงู ููุงุชูุญ ssh ูู Active Directory </h3><br>  ูุน ุงูุชุฏุงุฏ ุตุบูุฑ ูููุฎุทุท ุ ูู ุงููููู ุชุฎุฒูู ููุงุชูุญ ssh ูู ุณูุงุช ูุณุชุฎุฏู Active Directory ูุงุณุชุฎุฏุงููุง ููุชุฑุฎูุต ุนูู ูุถููู Linux. <br><br>  ูุฌุจ ุชูููู ุงูุชูููุถ ุนุจุฑ sssd. <br><br>  ุฃุถู ุงูุณูุฉ ุงููุทููุจุฉ ุจุงุณุชุฎุฏุงู ุงูุจุฑูุงูุฌ ุงููุตู PowerShell. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">AddsshPublicKeyAttribute.ps1</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  ูุธููุฉ ุฌุฏูุฏุฉ AttributeID { <br>  ุจุงุฏุฆุฉ $ = "1.2.840.113556.1.8000.2554" <br>  GUID = [System.Guid] :: NewGuid (). ToString () <br>  ุฃุฌุฒุงุก $ = @ () <br>  $ Parts + = [UInt64] :: ุชุญููู ($ guid.SubString (0.4) ุ "AllowHexSpecifier") <br>  $ Parts + = [UInt64] :: ุชุญููู ($ guid.SubString (4ุ4) ุ "AllowHexSpecifier") <br>  $ Parts + = [UInt64] :: ุชุญููู ($ guid.SubString (9ุ4) ุ "AllowHexSpecifier") <br>  $ Parts + = [UInt64] :: ุชุญููู ($ guid.SubString (14ุ4) ุ "AllowHexSpecifier") <br>  $ Parts + = [UInt64] :: ุชุญููู ($ guid.SubString (19ุ4) ุ "AllowHexSpecifier") <br>  $ Parts + = [UInt64] :: ุชุญููู ($ guid.SubString (24.6) ุ "AllowHexSpecifier") <br>  $ Parts + = [UInt64] :: ุชุญููู ($ guid.SubString (30.6) ุ "AllowHexSpecifier") <br>  $ oid = [String] :: Format ("{0}. {1}. {2}. {3}. {4}. {5}. {6}. {6}. {7}" ุ ุจุงุฏุฆุฉ $ ุ $ Parts [ 0] <br>  $ Parts [1]ุ $ Parts [2]ุ $ Parts [3]ุ $ Parts [4]ุ $ Parts [5]ุ $ Parts [6]) <br>  OID <br>  } <br>  $ schemaPath = (Get-ADRootDSE) .schemaNamingContext <br>  $ oid = New-AttributeID <br>  ุณูุงุช $ = @ { <br>  lDAPDisplayName = 'sshPublicKey'ุ <br>  attributeId = $ oidุ <br>  oMSyntax = 22 ุ <br>  attributeSyntax = "2.5.5.5"ุ <br>  isSingleValued = $ true ุ <br>  adminDescription = 'ููุชุงุญ ุงููุณุชุฎุฏู ุงูุนูููู ูุชุณุฌูู ุงูุฏุฎูู ุฅูู SSH' ุ <br>  } <br><br>  New-ADObject -Name sshPublicKey -Type attributeSchema -Path $ schemapath -OtherAttributes ุณูุงุช $ <br>  userSchema $ = get-adobject -SearchBase $ schemapath -ููุชุฑ 'name -eq "user"' <br>  userSchema $  Set-ADObject -Add @ {mayContain = 'sshPublicKey'} <br></div></div><br>  ุจุนุฏ ุฅุถุงูุฉ ุงูุณูุฉ ุ ุฃุนุฏ ุชุดุบูู ุฎุฏูุงุช ูุฌุงู Active Directory. <br>  ููุฑุฑ ููุณุชุฎุฏูู Active Directory.  ุจุฃู ุทุฑููุฉ ููุงุณุจุฉ ูู ุ ูุฅููุง ูููู ุจุฅูุดุงุก ุฒูุฌ ููุงุชูุญ ููุงุชุตุงู ssh. <br><br>  ูู ุจุชุดุบูู PuttyGen ุ ูุงููุฑ ููู ุงูุฒุฑ "ุฅูุดุงุก" ูุงููุฑ ุจุดูู ูุญููู ุนูู ุงููุงูุณ ุฏุงุฎู ููุทูุฉ ุฎุงููุฉ. <br><br>  ุนูุฏ ุงูุงูุชูุงุก ูู ุงูุนูููุฉ ุ ูููููุง ุญูุธ ุงูููุงุชูุญ ุงูุนุงูุฉ ูุงูุฎุงุตุฉ ุ ูููุก ุงูููุชุงุญ ุงูุนุงู ูู ุณูุฉ ูุณุชุฎุฏู Active Directory ูุงูุงุณุชูุชุงุน ุจูุฐู ุงูุนูููุฉ.  ููุน ุฐูู ุ ูุฌุจ ุงุณุชุฎุฏุงู <b>ุงูููุชุงุญ ุงูุนูููู ูู</b> ูุงูุฐุฉ " <b>ุงูููุชุงุญ ุงูุนุงู ููุตูู ูู ููู OpenSSH Author_keys:</b> ". <br><br><img src="https://habrastorage.org/webt/af/bu/o5/afbuo5avt0mvyunloxwcfceygaa.png"><br><br>  ุฃุถู ุงูููุชุงุญ ุฅูู ุณูุฉ ุงููุณุชุฎุฏู. <br><br>  ุงูุฎูุงุฑ 1 - ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุฑุณูููุฉ: <br><br><img src="https://habrastorage.org/webt/cq/ak/7h/cqak7h5xn68tythynzu6fmgloeq.png"><br><br>  ุงูุฎูุงุฑ 2 - PowerShell: <br><br> <code>get-aduser user1 | set-aduser -add @{sshPublicKey = 'AAAAB...XAVnX9ZRJJ0p/Q=='}</code> <br> <br>  ูุฐูู ุ ูุฏููุง ูู ุงูููุช ุงูุญุงูู: ูุณุชุฎุฏู ุจุณูุฉ sshPublicKey ููููุก ุ ุนููู ูุนุฌูู ูููู ูุชุฎููู ุงูููุชุงุญ.  ูุง ุชุฒุงู ููุงู ููุทุฉ ูุงุญุฏุฉ ุตุบูุฑุฉ ุ ููู ููููุฉ ุฌุนู ุงูุจุฑูุงูุฌ ุงูุฎูู sshd ูุณุญุจ ุงูููุชุงุญ ุงูุนุงู ุงูุฐู ูุญุชุงุฌู ูู ุณูุงุช ุงููุณุชุฎุฏู.  ููุงู ูุต ุตุบูุฑ ููุฌูุฏ ุนูู ุงููุณุงุญุงุช ุงูููุชูุญุฉ ููุฅูุชุฑูุช ุงูุจูุฑุฌูุงุฒู ูุชููู ูุน ูุฐุง ุจูุฌุงุญ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cat /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin/fetchSSHKeysFromLDAP <span class="hljs-comment"><span class="hljs-comment">#!/bin/sh ldapsearch -h testmdt.testopf.local -xb "dc=testopf,dc=local" '(sAMAccountName='"${1%@*}"')' -D Administrator@testopf.local -w superSecretPassword 'sshPublicKey' | sed -n '/^ /{H;d};/sshPublicKey:/x;$g;s/\n *//g;s/sshPublicKey: //gp'</span></span></code> </pre> <br>  ูุถุนูุง 0500 ุฃุฐููุงุช ููุฌุฐุฑ ุนูู ุฐูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod 0500 /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin/fetchSSHKeysFromLDAP</code> </pre> <br>  ูู ูุฐุง ุงููุซุงู ุ ูุชู ุงุณุชุฎุฏุงู ุญุณุงุจ ุงููุณุคูู ูุฑุจุท ุงูุฏููู.  ูู ุธุฑูู ุงููุชุงู ูุฌุจ ุฃู ูููู ููุงู ุญุณุงุจ ูููุตู ูุน ูุฌููุนุฉ ุงูุญุฏ ุงูุฃุฏูู ูู ุงูุญููู. <br><br>  ุฃูุง ุดุฎุตูุงู ููุช ูุฑุชุจููุง ุฌุฏูุง ูู ูุญุธุฉ ูููุฉ ุงููุฑูุฑ ุจุดูููุง ุงูููู ูู ุงูุจุฑูุงูุฌ ุงููุตู ุ ุนูู ุงูุฑุบู ูู ุงูุญููู ุงูููุตูุต ุนูููุง. <br><br>  ุฎูุงุฑ ุงูุญู: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุฃุญูุธ ูููุฉ ุงููุฑูุฑ ูู ููู ูููุตู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> -n Supersecretpassword &gt; /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/etc/secretpass</code> </pre> </li><li style=";text-align:right;direction:rtl">  ููุช ุจุชุนููู ุงูุฃุฐููุงุช ุนูู ููู 0500 ููุฌุฐุฑ <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">chmod 0500 /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/etc/secretpass</code> </pre> </li><li style=";text-align:right;direction:rtl">  ุฃููู ุจุชุบููุฑ ูุนููุงุช ุจุฏุก ุงูุชุดุบูู ูู ldapsearch: ูุชู <i>ุชุบููุฑ</i> ุงููุนููุฉ <i>superSecretPassword -w</i> ุฅูู <i>-y / usr / local / etc / secretpass</i> </li></ul><br>  ุงูุฏุฑุฏุดุฉ ุงูุฌูุงุนูุฉ ุงูููุงุฆูุฉ ูู ูุฌููุนุฉ ุงูููู ูู ุชุญุฑูุฑ sshd_config <br><br><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">cat /etc/ssh/sshd_config | egrep -v -E <span class="hljs-string"><span class="hljs-string">"#|^$"</span></span> | grep -E <span class="hljs-string"><span class="hljs-string">"AuthorizedKeysCommand|PubkeyAuthe"</span></span> PubkeyAuthentication yes AuthorizedKeysCommand /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/bin/fetchSSHKeysFromLDAP AuthorizedKeysCommandUser root</code> </pre><br>  ูุชูุฌุฉ ูุฐูู ุ ุญุตููุง ุนูู ุงูุชุณูุณู ุงูุชุงูู ูู ุฎูุงู ูุตุงุฏูุฉ ุงูููุชุงุญ ุงูุชู ุชู ุชูููููุง ูู ุนููู ssh: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุชุตู ุงููุณุชุฎุฏู ุจุงูุฎุงุฏู ุ ูุจููุง ุงุณู ุงููุณุชุฎุฏู ุงูุฎุงุต ุจู. </li><li style=";text-align:right;direction:rtl">  ูุณุญุจ ุงูุจุฑูุงูุฌ ุงูุฎูู sshd ุ ูู ุฎูุงู ุจุฑูุงูุฌ ูุตู ุ ูููุฉ ุงูููุชุงุญ ุงูุนูููู ูู ุณูุฉ ุงููุณุชุฎุฏู ูู Active Directory ููุฎููู ุงูููุงุชูุญ. </li><li style=";text-align:right;direction:rtl">  ูุตุงุฏู ุงูุจุฑูุงูุฌ ุงูุฎูู sssd ุงููุณุชุฎุฏู ุนูู ุฃุณุงุณ ุนุถููุฉ ุงููุฌููุนุฉ.  ุชุญุฐูุฑ!  ุฅุฐุง ูู ูุชู ุชูููู ูุฐุง ุ ูุณูุชููู ุฃู ูุณุชุฎุฏู ูุฌุงู ูู ุงููุตูู ุฅูู ุงููุถูู. </li><li style=";text-align:right;direction:rtl">  ุนูุฏูุง ูุญุงูู sudo ุ ูุจุญุซ ุงูุจุฑูุงูุฌ ุงูุฎูู sssd ูู ุฏููู Active Directory ุนู ุงูุฃุฏูุงุฑ.  ูู ุญุงูุฉ ูุฌูุฏ ุฃุฏูุงุฑ ุ ูุชู ุงูุชุญูู ูู ุงูุณูุงุช ูุนุถููุฉ ุงููุณุชุฎุฏู ูู ุงููุฌููุนุฉ (ุฅุฐุง ุชู ุชูููู sudoRoles ูุงุณุชุฎุฏุงู ูุฌููุนุงุช ุงููุณุชุฎุฏููู) </li></ol><br><h3 style=";text-align:right;direction:rtl">  ูุคุฏู </h3><br>  ูุจุงูุชุงูู ุ ูุชู ุชุฎุฒูู ุงูููุงุชูุญ ูู ุณูุงุช ูุณุชุฎุฏู Active Directory ุ ุฃุฐููุงุช sudo - ูุจุงููุซู ุ ูุชู ุงููุตูู ุฅูู ูุถููู Linux ุนู ุทุฑูู ุญุณุงุจุงุช ุงููุฌุงู ุนู ุทุฑูู ุงูุชุญูู ูู ุงูุนุถููุฉ ูู ูุฌููุนุฉ Active Directory. <br><br>  ุงูููุฌุฉ ุงูุฃุฎูุฑุฉ ูู ุนุตุง ุงูููุตู - ูุงููุงุนุฉ ุชุชุฌูุฏ ูู ุตูุช ูุฑูุน. <br><br>  ุงูููุงุฑุฏ ุงููุณุชุฎุฏูุฉ ูู ุงููุชุงุจุฉ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณูุฏู ุนุจุฑ ุงูุฏููู ุงููุดุท</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณู ููุงุชูุญ ุนุจุฑ Active Directory</a> </li><li style=";text-align:right;direction:rtl">  <a href="">ุงูุจุฑูุงูุฌ ุงููุตู Powershell ุ ุฅุถุงูุฉ ุณูุฉ ุฅูู ูุฎุทุท Active Directory</a> </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ุณูุฏู ุงูุงูุฑุงุฌ ุนู ูุณุชูุฑ</a> </li></ul></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar449702/">https://habr.com/ru/post/ar449702/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar449686/index.html">ูุชุญุฏุซ ุนู ุฃุญุฏ ุงููุชุญุฏุซูู ุงูุฑุฆูุณููู ูู OFFZONE 2019</a></li>
<li><a href="../ar449688/index.html">ุงุฎุชุจุงุฑ ุฅุนุฏุงุฏุงุช sendBeacon ูุฅุฑุณุงู ุงูุจูุงูุงุช</a></li>
<li><a href="../ar449690/index.html">ุฏุงุฎู ุงููุฎุชุจุฑ ุงูุณุฑู ููุฏุฌุฑ</a></li>
<li><a href="../ar449696/index.html">ุงููุดุงุฑูุฉ ูู ุงููุณุงุจูุฉ ูุฑูุน ุชุฑุฏุฏ ุงูุชุดุบูู RAM - HyperX Memory OC Competition 2019</a></li>
<li><a href="../ar449700/index.html">ููุงุฐุง ูุชุญูู ุงููุฑูุฑ ูุฌุฃุฉ ุฅูู ุงุฒุฏุญุงู ุงููุฑูุฑ</a></li>
<li><a href="../ar449704/index.html">MVCC-5. ุงูุชูุธูู ูู ุงูุตูุญุฉ ูุงูุณุงุฎูุฉ</a></li>
<li><a href="../ar449706/index.html">ุงูุนูู ูุน KOMPAS-3D API โ ุงูุฏุฑุณ 15 โ ุงูุฎุทูุท ุงููุฑูุจุฉ ุจูุงุกู ุนูู ุงูููุฑุฉ</a></li>
<li><a href="../ar449708/index.html">Citymobil - ุฏููู ูุชุญุณูู ุงูุชูุงูุฑ ูุณุท ููู ุงูุฃุนูุงู ููุดุฑูุงุช ุงููุงุดุฆุฉ. ุงูุฌุฒุก 3</a></li>
<li><a href="../ar449712/index.html">ุงูุฃุฎุจุงุฑ ุงูุฃุณุจูุนูุฉ: ุงูุฎูุงุถ ุงูุทูุจ ุนูู ุงูุฃูุฑุงุต ุงูุตูุจุฉ ุ ูุงุนุชูุงุฏ ูุงููู ุงูุฅูุชุฑูุช ุงูุณูุงุฏู ุ ูุฅูุชุงุฌ ูุนุฏุงุช 5G ูู ุฑูุณูุง</a></li>
<li><a href="../ar449714/index.html">ูุง ุดูุก ููุณ ุฏุงุฆููุง</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>