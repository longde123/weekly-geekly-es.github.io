<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🎉 👩‍👦 🧜🏼 Méthodes privées sans traits de soulignement et interfaces en Python 🥗 📂 🥃</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salut, Habr. Récemment, je suis devenu fou de conception - modificateurs d'accès et interfaces, puis je l'ai porté au langage de programmation Python....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Méthodes privées sans traits de soulignement et interfaces en Python</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/443192/"><div style="text-align:center;"><img src="https://habrastorage.org/webt/o_/g4/oi/o_g4oiajcfginaa8zihikokzwau.png"></div><br><br>  Salut, Habr.  Récemment, je suis devenu fou de conception - modificateurs d'accès et interfaces, puis je l'ai porté au langage de programmation Python.  Je demande sous kat - je partage les résultats et comment cela fonctionne.  Pour ceux qui sont intéressés, à la fin de l'article, il y a un lien vers le projet sur Github. <br><a name="habracut"></a><br><h2>  Modificateurs d'accès </h2><br>  Les modificateurs d'accès restreignent l'accès aux objets - aux méthodes de leur classe ou aux classes enfants - aux méthodes de leur classe parente.  L'utilisation de modificateurs d'accès permet de masquer les données dans la classe afin que personne à l'extérieur ne puisse interférer avec le travail de cette classe. <br><br>  <b>les</b> méthodes <b>privées</b> sont disponibles uniquement à l'intérieur de la classe, <b>protégées</b> (à l'intérieur) - à l'intérieur de la classe et dans les classes enfants. <br><br><h3>  Comment les méthodes privées et protégées sont implémentées en Python </h3><br>  Spoiler - au niveau de l'accord selon lequel les adultes ne les appelleront tout simplement pas en dehors de la classe.  Avant les méthodes privées, vous devez écrire un double soulignement, avant un protégé.  Et vous pouvez toujours accéder aux méthodes, malgré leur accès "limité". <br><br><pre><code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Car</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_start_engine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Engine's sound."</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self._start_engine() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: car = Car() <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-string"><span class="hljs-string">"Engine's sound."</span></span> == car.run() <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-string"><span class="hljs-string">"Engine's sound."</span></span> == car._start_engine()</code> </pre> <br>  Les inconvénients suivants peuvent être déterminés: <br><br><ul><li>  Si la méthode <b>_start_engine mettait à</b> jour certaines variables de classe ou conservait l'état, et ne <b>renvoyait</b> pas simplement un «calcul stupide», vous auriez pu casser quelque chose pour un travail futur avec la classe.  Vous ne vous autorisez pas à réparer quelque chose dans le moteur de votre voiture, car vous n'irez nulle part, non? </li><li>  Le point coulant du précédent - pour vous assurer que vous pouvez "en toute sécurité" (appeler la méthode ne nuit pas à la classe elle-même) utiliser une méthode protégée - vous devez examiner son code et passer du temps. </li><li>  Les auteurs des bibliothèques espèrent que personne n'utilise les méthodes protégées et privées des classes que vous utilisez dans vos projets.  Par conséquent, ils peuvent changer son implémentation dans n'importe quelle version (ce qui n'affectera pas les méthodes publiques en raison de la compatibilité descendante, mais vous en souffrirez). </li><li>  L'auteur de la classe, votre collègue, s'attend à ce que vous n'augmentiez pas la dette technique du projet en utilisant une méthode protégée ou privée en dehors de la classe qu'il a créée.  Après tout, celui qui le refactorisera ou le modifiera (méthode de classe privée) devra s'assurer (par exemple par des tests) que ses modifications ne casseront pas votre code.  Et s'ils le cassent, il devra passer du temps à essayer de résoudre ce problème (avec une béquille, car il en a besoin hier). </li><li>  Peut-être vous assurez-vous que les autres programmeurs n'utilisent pas de méthodes protégées ou privées lors de la révision du code et «battent pour ça», alors passez du temps. </li></ul><br><h3>  Comment implémenter des méthodes protégées à l'aide d'une bibliothèque </h3><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> accessify <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> protected <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Car</span></span></span><span class="hljs-class">:</span></span> @protected <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_engine</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"Engine's sound."</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> self.start_engine() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: car = Car() <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span> <span class="hljs-string"><span class="hljs-string">"Engine's sound."</span></span> == car.run() car.start_engine()</code> </pre><br>  Tenter d'appeler la méthode <b>start_engine en</b> dehors de la classe entraînera l'erreur suivante (la méthode n'est pas disponible selon la stratégie d'accès): <br><br><pre> <code class="python hljs">Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"examples/access/private.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">24</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; car.start_engine() File <span class="hljs-string"><span class="hljs-string">"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/accessify/main.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">92</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> private_wrapper class_name=instance_class.__name__, method_name=method.__name__, accessify.errors.InaccessibleDueToItsProtectionLevelException: Car.start_engine() <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> inaccessible due to its protection level</code> </pre><br>  Utilisation de la bibliothèque: <br><br><ul><li>  Vous n'avez pas besoin d'utiliser de soulignements moches (subjectifs) ou de doubles soulignements. </li><li>  Vous obtenez une belle méthode (subjective) pour implémenter des modificateurs d'accès dans le code - <b>des</b> décorateurs <b>privés</b> et <b>protégés</b> . </li><li>  Transférer la responsabilité de la personne à l'interprète. </li></ul><br>  Comment ça marche: <br><br><ol><li>  Le décorateur <b>privé</b> ou <b>protégé</b> - le décorateur le plus «haut», se <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">déclenche avant la méthode class</a> , qui a été déclarée modificateur d'accès privé ou protégé. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/yn/gd/7m/yngd7mlnbovpjmmzvl4prwhrqjs.png"></div><br></li><li>  À l'aide de la bibliothèque d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">inspection</a> intégrée, le décorateur <b>récupère l'</b> objet actuel de la pile d'appels - <b>inspect.currentframe ()</b> .  Cet objet a les attributs suivants qui nous sont utiles: l'espace de noms (locaux) et le lien vers l'objet précédent de la pile d'appels (l'objet qui appelle la méthode avec le modificateur d'accès). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/h5/tp/v8/h5tpv83v549-ozspfwcbxabvh6c.png"></div><br>  <i>(Illustration très simplifiée)</i> <br></li><li>  <b>inspect.currentframe (). f_back</b> - utilisez cet attribut pour vérifier si l'objet précédent de la pile d'appels se trouve ou non dans le corps de la classe.  Pour ce faire, regardez l'espace de noms - <b>f_locals</b> .  S'il y a un <b>auto-</b> attribut dans l'espace de noms, la méthode est appelée à l'intérieur de la classe, sinon, à l'extérieur de la classe.  Si vous appelez une méthode avec un modificateur d'accès privé ou protégé en dehors de la classe, il y aura une erreur de stratégie d'accès. </li></ol><br><h2>  Interfaces </h2><br>  Les interfaces sont un contrat d'interaction avec une classe qui l'implémente.  L'interface contient les signatures de méthode (le nom des fonctions, les arguments d'entrée) et la classe qui implémente l'interface, après les signatures, implémente la logique.  En résumé, si deux classes implémentent la même interface, vous pouvez être sûr que les deux objets de ces classes ont les mêmes méthodes. <br><br><h3>  Exemple </h3><br>  Nous avons une classe <b>User</b> qui utilise l'objet de <b>stockage</b> pour créer un nouvel utilisateur. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">User</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, storage)</span></span></span><span class="hljs-function">:</span></span> self.storage = storage <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, name)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> storage.create_with_name(name=name)</code> </pre><br>  Vous pouvez enregistrer l'utilisateur dans la base de données à l'aide de <b>DatabaseStorage.create_with_name</b> . <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">DatabaseStorage</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_with_name</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, name)</span></span></span><span class="hljs-function">:</span></span> ...</code> </pre><br>  Vous pouvez enregistrer l'utilisateur dans des fichiers à l'aide de <b>FileStorage.create_with_name</b> . <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FileStorage</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_with_name</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, name)</span></span></span><span class="hljs-function">:</span></span> ...</code> </pre><br>  Étant donné que les signatures des méthodes <b>create_with_name</b> (nom, arguments) sont les mêmes pour les classes - la classe <b>User</b> n'a pas à se soucier de l'objet auquel elle a été substituée si les deux ont les mêmes méthodes.  Cela peut être réalisé si les classes <b>FileStorage</b> et <b>DatabaseStorage</b> implémentent la même interface (c'est-à-dire qu'elles sont liées par le contrat pour définir une méthode avec une logique à l'intérieur). <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> settings.config.storage = FileStorage: storage = FileStorage() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> settings.config.storage = DatabaseStorage: storage = DatabaseStorage() user = User(storage=storage) user.create_with_name(name=...)</code> </pre><br><h3>  Comment travailler avec des interfaces à l'aide de la bibliothèque </h3><br>  Si une classe implémente une interface, la classe doit contenir <b>toutes les méthodes de l'interface</b> .  Dans l'exemple ci-dessous, l'interface HumanInterface contient la méthode eat et la classe Human l'implémente, mais n'implémente pas la méthode eat. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> accessify <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> implements <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanInterface</span></span></span><span class="hljs-class">:</span></span> @staticmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(food, *args, allergy=None, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: @implements(HumanInterface) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Human</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre><br>  Le script se termine avec l'erreur suivante: <br><br><pre> <code class="python hljs">Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"examples/interfaces/single.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; @implements(HumanInterface) File <span class="hljs-string"><span class="hljs-string">"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/accessify/interfaces.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">66</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> decorator interface_method_arguments=interface_method.arguments_as_string, accessify.errors.InterfaceMemberHasNotBeenImplementedException: <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Human</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">does</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implement</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">member</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanInterface</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eat</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(food, args, allergy, kwargs)</span></span></span></span></code> </pre><br>  Si une classe implémente une interface, la classe doit contenir toutes les méthodes de l'interface, <b>y compris tous les arguments entrants</b> .  Dans l'exemple ci-dessous, l'interface HumanInterface contient la méthode eat, qui prend 4 arguments en entrée, et la classe Human l'implémente, mais implémente la méthode eat avec seulement 1 argument. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> accessify <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> implements <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanInterface</span></span></span><span class="hljs-class">:</span></span> @staticmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(food, *args, allergy=None, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: @implements(HumanInterface) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Human</span></span></span><span class="hljs-class">:</span></span> @staticmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(food)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre><br>  Le script se termine avec l'erreur suivante: <br><br><pre> <code class="python hljs">Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"examples/interfaces/single_arguments.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">16</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; @implements(HumanInterface) File <span class="hljs-string"><span class="hljs-string">"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/accessify/interfaces.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">87</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> decorator interface_method_arguments=interface_method.arguments_as_string, accessify.errors.InterfaceMemberHasNotBeenImplementedWithMismatchedArgumentsException: <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Human</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">member</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanInterface</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eat</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(food, args, allergy, kwargs)</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">mismatched</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">arguments</span></span></span></span></code> </pre><br>  Si une classe implémente une interface, la classe doit contenir toutes les méthodes de l'interface, y compris les arguments entrants et <b>les modificateurs d'accès</b> .  Dans l'exemple ci-dessous, l'interface HumanInterface contient la méthode eat privée et la classe Human l'implémente, mais n'implémente pas le modificateur d'accès privé pour la méthode eat. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> accessify <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> implements, private <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanInterface</span></span></span><span class="hljs-class">:</span></span> @private @staticmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(food, *args, allergy=None, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: @implements(HumanInterface) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Human</span></span></span><span class="hljs-class">:</span></span> @staticmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(food, *args, allergy=None, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre><br>  Le script se termine avec l'erreur suivante: <br><br><pre> <code class="python hljs">Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"examples/interfaces/single_access.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">18</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; @implements(HumanInterface) File <span class="hljs-string"><span class="hljs-string">"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/accessify/interfaces.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">77</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> decorator interface_method_name=interface_method.name, accessify.errors.ImplementedInterfaceMemberHasIncorrectAccessModifierException: Human.eat(food, args, allergy, kwargs) mismatches HumanInterface.eat() member access modifier.</code> </pre><br>  Une classe peut implémenter plusieurs interfaces (nombre illimité).  Si une classe implémente plusieurs interfaces, la classe doit contenir <b>toutes les méthodes de toutes les interfaces, y compris les arguments entrants et les modificateurs d'accès</b> .  Dans l'exemple ci-dessous, la classe Human implémente la méthode eat de l'interface HumanBasicsInterface, mais n'implémente pas la méthode love de l'interface HumanSoulInterface. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> accessify <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> implements <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanSoulInterface</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">love</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, who, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanBasicsInterface</span></span></span><span class="hljs-class">:</span></span> @staticmethod <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">eat</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(food, *args, allergy=None, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: @implements(HumanSoulInterface, HumanBasicsInterface) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Human</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">love</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, who, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span></code> </pre><br>  Le script se termine avec l'erreur suivante: <br><br><pre> <code class="python hljs">Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"examples/interfaces/multiple.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">19</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; @implements(HumanSoulInterface, HumanBasicsInterface) File <span class="hljs-string"><span class="hljs-string">"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/accessify/interfaces.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">66</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> decorator interface_method_arguments=interface_method.arguments_as_string, accessify.errors.InterfaceMemberHasNotBeenImplementedException: <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Human</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">does</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">not</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implement</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">member</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanBasicsInterface</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eat</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(food, args, allergy, kwargs)</span></span></span></span></code> </pre><br>  Fonctionnalité de tueur - une méthode d'interface peut «indiquer» quelles erreurs une méthode d'une classe qui l'implémente doit «lancer».  Dans l'exemple ci-dessous, il est «déclaré» que la méthode «love» de l'interface «HumanInterface» doit lever une exception «HumanDoesNotExistError» et <br>  «HumanAlreadyInLoveError», mais la méthode «love» de la classe «Human» n'en «jette» pas une. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> accessify <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> implements, throws <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanDoesNotExistError</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Exception)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanAlreadyInLoveError</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(Exception)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HumanInterface</span></span></span><span class="hljs-class">:</span></span> @throws(HumanDoesNotExistError, HumanAlreadyInLoveError) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">love</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, who, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pass</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: @implements(HumanInterface) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Human</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">love</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, who, *args, **kwargs)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> who <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">raise</span></span> HumanDoesNotExistError(<span class="hljs-string"><span class="hljs-string">'Human whom need to love does not exist'</span></span>)</code> </pre><br>  Le script se termine avec l'erreur suivante: <br><br><pre> <code class="python hljs">Traceback (most recent call last): File <span class="hljs-string"><span class="hljs-string">"examples/interfaces/throws.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">21</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> &lt;module&gt; @implements(HumanInterface) File <span class="hljs-string"><span class="hljs-string">"/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/accessify/interfaces.py"</span></span>, line <span class="hljs-number"><span class="hljs-number">103</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> decorator class_method_arguments=class_member.arguments_as_string, accessify.errors.DeclaredInterfaceExceptionHasNotBeenImplementedException: Declared exception HumanAlreadyInLoveError by HumanInterface.love() member has <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> been implemented by Human.love(self, who, args, kwargs)</code> </pre><br>  Pour résumer, en utilisant la bibliothèque: <br><br><ul><li>  Vous pouvez implémenter une ou plusieurs interfaces. </li><li>  Les interfaces sont combinées avec des modificateurs d'accès. </li><li>  Vous obtiendrez une séparation des interfaces et des classes abstraites ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">module abc en Python</a> ), maintenant vous n'avez plus besoin d'utiliser des classes abstraites comme interfaces si vous l'avez fait (je l'ai fait). </li><li>  Par rapport aux classes abstraites.  Si vous n'avez pas défini tous les arguments de méthode à partir de l'interface, vous obtiendrez une erreur en utilisant une classe abstraite - non. </li><li>  Par rapport aux classes abstraites.  En utilisant des interfaces, vous obtiendrez une erreur lors de la création de la classe (lorsque vous avez écrit la classe et appelé le fichier <b>* .py</b> ).  Dans les classes abstraites, vous obtiendrez déjà une erreur au stade de l'appel d'une méthode d'un objet de classe. </li></ul><br>  Comment ça marche: <br><br><ol><li>  En utilisant la bibliothèque d' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">inspection</a> intégrée dans le décorateur d' <b>implémentations</b> , toutes les méthodes de la classe et ses interfaces - <b>inspect.getmembers ()</b> sont <b>obtenues</b> .  Un index unique d'une méthode est une combinaison de son nom et de son type (méthode statique, propriété, etc.). </li><li>  Et avec <b>inspect.signature ()</b> , les arguments de la méthode. </li><li>  Nous parcourons toutes les méthodes de l'interface et voyons s'il existe une telle méthode (par un index unique) dans la classe qui implémente l'interface, si les arguments entrants sont les mêmes, si les modificateurs d'accès sont les mêmes, si la méthode implémente les erreurs déclarées dans la méthode d'interface. </li></ol><br>  Merci de votre attention sur l'article.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lien vers le projet sur Github</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr443192/">https://habr.com/ru/post/fr443192/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr443182/index.html">Tirez YPbPr de Commodore 64</a></li>
<li><a href="../fr443184/index.html">De l'amour au contrôle d'un pas</a></li>
<li><a href="../fr443186/index.html">Le support technique de 3CX répond - 5 règles de sécurité IP PBX</a></li>
<li><a href="../fr443188/index.html">Trois yeux pendent sur un pilier, ou l'histoire que cinq jambes d'ATtiny13 suffisent</a></li>
<li><a href="../fr443190/index.html">Introduction aux stratégies de réseau Kubernetes pour les professionnels de la sécurité</a></li>
<li><a href="../fr443194/index.html">Les ingénieurs de WFIRM ont inventé une bioprinter qui imprime la peau directement sur une plaie</a></li>
<li><a href="../fr443196/index.html">Pas une minute hors ligne - Choisir un routeur LTE industriel</a></li>
<li><a href="../fr443198/index.html">Mark Zuckerberg dit que Facebook travaille sur une interface neuronale pour lire les pensées</a></li>
<li><a href="../fr443200/index.html">Des pirates iraniens volent des téraoctets de données à Citrix</a></li>
<li><a href="../fr443202/index.html">Rassemblement contre l'isolement de Runet</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>