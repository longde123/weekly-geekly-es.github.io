<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßõüèº üî¢ üë©üèø‚Äçü§ù‚Äçüë©üèΩ C√≥mo hacer un informador muy notable desde un m√≥dulo LED para publicidad exterior y Arduino üßëüèæ‚Äçü§ù‚Äçüßëüèº ü§≤üèø üèß</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="C√≥mo hacer un informador muy notable desde el m√≥dulo LED P10 y Arduino. 


 Prop√≥sito : Conecte r√°pidamente una gran matriz LED P10 (16x32cm) a una PC...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>C√≥mo hacer un informador muy notable desde un m√≥dulo LED para publicidad exterior y Arduino</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/404867/"><h3>  C√≥mo hacer un informador <u>muy</u> notable desde el m√≥dulo LED P10 y Arduino. </h3><br><p> <u><strong>Prop√≥sito</strong></u> : Conecte r√°pidamente una gran matriz LED P10 (16x32cm) a una PC u otro dispositivo, convirtiendo todo esto en un informador muy notable y brillante con un cambio din√°mico de la informaci√≥n mostrada.  Hay muchas aplicaciones para tal cosa, y como muestra la pr√°ctica, llama la atenci√≥n. <del>  ¬°Imag√≠nese, ahora todos sabr√°n con certeza que su aire acondicionado est√° funcionando y se supone que la puerta est√° cerrada! </del></p><br><img src="https://habrastorage.org/web/08b/087/167/08b087167ed44505865c343263dc54df.jpg"><br><p>  <i>La luz de fondo no proviene de la ventana, sino del panel;)</i> </p><a name="habracut"></a><br><p>  Una vez que mir√© la matriz opaca de 8x8 LED para Arduino y a su costo me sent√≠ triste.  Se decidi√≥ gotear hacia l√≠neas preparadas para la publicidad exterior y cu√°l fue mi sorpresa cuando todas resultaron ser est√°ndar y todo porque uno no sab√≠a nada sobre la actualizaci√≥n din√°mica de la informaci√≥n a trav√©s de un puerto externo.  Profundizando, se descubri√≥ que en todos estos productos se utilizan m√≥dulos LED t√≠picos (matrices LED). </p><br><p>  Todos vieron las brillantes pantallas de publicidad exterior, desde simples l√≠neas rastreras hasta enormes televisores.  Estas pantallas se ensamblan a partir de una cadena de dichos m√≥dulos LED y se controlan mediante controladores especiales, cuyo precio aumenta en proporci√≥n directa al tama√±o de la pantalla. </p><br><img src="https://habrastorage.org/web/862/66c/bbf/86266cbbf39d45b5b67e1b7a3c5d0291.jpg"><br><iframe width="560" height="315" src="https://www.youtube.com/embed/PfHZn8qEVfI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Estos m√≥dulos LED son bastante baratos.  Alrededor de $ 6, el precio depende del tama√±o y el color.  Es m√°s complicado con los controladores.  Los precios m√°s simples son comparables a un solo panel LED.  Sin embargo, la mayor√≠a de ellos est√°n "adaptados" para trabajar en el modo de demostrar "presentaciones" preparadas previamente y no pueden cambiar din√°micamente la informaci√≥n mostrada.  Admito que solo me familiaric√© brevemente con la funcionalidad de los controladores m√°s simples, pero result√≥ ser suficiente para entender: es m√°s barato y m√°s r√°pido hacer las cosas necesarias en el controlador universal Arduino.  Esto le permitir√° conectar con bastante calma varios m√≥dulos.  Pero comenzaremos con uno. </p><br><p>  El m√≥dulo LED (P10) se parece a esto: </p><br><img src="https://habrastorage.org/web/22b/923/abe/22b923abee064e8aa2feef387feb16af.jpg"><br><p>  <i><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://digital-wizard.net/avr_projects/p10_led_display_panel_interface</a></i> </p><br><p>  De hecho, esto es solo una matriz de LED que est√°n soldados a las salidas de los registros de desplazamiento, no entraremos en la jungla de circuitos, los m√≥dulos son todos est√°ndar y difieren solo en tama√±o.  P10 significa que entre dos diodos adyacentes 10 mm.  Hay paneles monocrom√°ticos, bicolores e incluso RGB.  Para aquellos interesados ‚Äã‚Äãen los detalles, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><strong>ya existe</strong></a> un art√≠culo similar, pero con un sesgo a un nivel inferior. </p><br><h3>  Hardware </h3><br><p>  <b>Y para aquellos que desean obtener r√°pidamente un resultado que puedan "sentir", necesitar√°n:</b> </p><br><ol><li>  Una matriz de LED. </li><li>  Arduino  (Us√© mini, pero ser√≠a m√°s conveniente nano no usar adaptadores adicionales para la comunicaci√≥n con una PC). </li><li>  Fuente de alimentaci√≥n para 5V / 3A.  La matriz es voraz, si enciende todos los diodos, entonces necesita mucha energ√≠a. </li><li>  Cable de conexi√≥n  (Por lo general, viene con una matriz). </li><li>  El deseo de terminar el trabajo. </li></ol><br><p>  Haremos un dise√±o monol√≠tico que solo se conecta a una toma de corriente y una PC para mostrar nuestra valiosa informaci√≥n <del>  (por ejemplo, tasa de Bitcoin) </del>  . </p><br><p>  Es necesario tomar el bucle de la matriz, cort√°ndolo en media soldadura en un circuito simple al Arduino. </p><br><img src="https://habrastorage.org/web/591/8d1/e72/5918d1e72d5e448589de77a3adccffbe.jpg"><br><p>  <i>Si usa Arduino Mini o UNO, entonces necesita soldar a los pines correspondientes por analog√≠a.</i> </p><br><p>  Si por alguna raz√≥n no ten√≠a un cable, puede reemplazarlo con un cable MIDI que conecte el conector MIDI (opci√≥n para los antiguos) a la placa en las tarjetas de sonido antiguas o reemplazarlo con dos enchufes Dupont (madre) con 8 pines.  En principio, el conector es est√°ndar, se ve con bastante facilidad. </p><br><img src="https://habrastorage.org/web/753/e63/05c/753e6305c32246ef9d91f0745747ba10.jpg"><br><p>  Pero en 10 minutos obtuve el siguiente dise√±o, cuelga un adaptador USBtoUART adicional que no tendr√° si no usa el Arduino Mini. </p><br><img src="https://habrastorage.org/web/4c3/039/6df/4c30396df4804264932950e965ce1903.JPG"><br><p><br>  El hardware est√° listo, solo necesita conectar una fuente de alimentaci√≥n adicional de 5V / 3A para alimentar la matriz.  Para hacer esto, tiene un conector separado, m√°s a m√°s, menos a menos.  Por el contrario, puede, pero no funcionar√°. <del>  Aunque es extra√±o, ya que todos saben que los electrones, como siempre, fluyen de m√°s a menos.  Y si tenemos en cuenta que los electrones est√°n cargados negativamente, entonces no est√° nada claro por qu√© fluyen hacia el polo negativo ...;) Pensaron cosas m√°s cortas. </del></p><br><img src="https://habrastorage.org/web/d1d/e04/281/d1de042816ef4aa3860d54b20a28b488.JPG"><br><p>  <i>Espero que conecte la fuente de alimentaci√≥n de manera m√°s confiable, y mi m√©todo solo es adecuado si tiene muchas fuentes de alimentaci√≥n de repuesto.</i>  <i>Arduin se puede atornillar (</i> <del>  <i>¬°No es un tornillo autorroscante!</i> </del>  <i>) al panel mismo, el panel tiene orificios roscados de montaje.</i> </p><br><p>  Eso es todo, que los dioses DIY me perdonen, pero hoy no hab√≠a cinta azul. <del>  No vale la pena gastar un recurso tan valioso en cosas tan in√∫tiles. </del></p><br><h3>  Parte de software </h3><br><p>  Si pensabas que ser√≠a necesario entender c√≥mo programar esto desde tres letras (interfaz SPI), entonces puedo decepcionarte, todo es mucho m√°s simple.  Como siempre, todas las bicicletas se inventan antes que nosotros y m√°s de una vez. <del>  En realidad, como este art√≠culo </del>  .  Hay bibliotecas <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DMD</a> y <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">DMD2 listas</a> para <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">usar,</a> y el dibujo se reduce al hecho de que en el boceto solo necesita indicar qu√©, c√≥mo y d√≥nde generar, ¬°todo es ganancia! </p><br><p>  Despu√©s de jugar un poco con la <s>forma cuadrada de</s> estas bibliotecas, llegu√© a la conclusi√≥n de que el desplazamiento de texto en DMD2 parece "triste", aunque hay m√°s opciones y control de brillo all√≠.  Como resultado, se decidi√≥ por el primero y record√≥ que "usted es un programador" le agreg√≥ un control de brillo primitivo.  Aqu√≠ vale la pena mencionar que estas matrices brillan mucho.  Al final de la depuraci√≥n, quemar√° la c√≥rnea. </p><br><p>  En general, todo lo que necesita hacer es cargar el boceto en el tablero, pero es desde ese directorio donde desempaquetar√° mi archivo, ya que lo modifiqu√© un poco <del>  archivo </del>  Algunas bibliotecas que est√°n en el mismo lugar.  Control de brillo agregado y SPI ligeramente overclockeado, tal vez algo m√°s, no lo recuerdo. <del>  Rabatet?  ¬°No tocar! </del></p><br><p>  Para mayor claridad, agregu√© un sensor de temperatura de 18v20.  Si no conecta uno, la temperatura simplemente no se mostrar√°.  Seg√∫n mi idea, all√≠ se mostrar√° un cierto peso en gramos, pero puede mostrar solo un n√∫mero.  Para cambiar el texto que se desplaza desde abajo, solo necesita "cargarlo" en el puerto COM de Arduino utilizando un formato especial, una especie de secuencia ESC.  Se adjunta un script de Python que simplemente env√≠a la hora actual al panel. </p><br><p>  <b>Formato de comando:</b> </p><br><ol><li>  0x1B (ESC) + 0x40 ("@") // Identificaci√≥n, devuelve la ID de cadena del dispositivo "P10_DISPLAY_V01 \ r \ n" </li><li>  0xOC (CLR) // Borrar la pantalla. </li><li>  0x1F (EE. UU.) + 0x58 ("X") + 0x80 // Establece el brillo de la pantalla, brillo m√°ximo 0x80. </li><li>  0x1F (US) + 0x52 ("B") + Cadena // Establezca la l√≠nea inferior que se desplazar√°. </li><li>  0x1F (EE. UU.) + 0x0A ("LF") + 0x31, 0x32, 0x33, 0x34, 0x35 // Pase el n√∫mero de cinco d√≠gitos que se muestra en la parte superior "12345" </li></ol><br><p>  No encontr√© el acabado y tuve que dibujar la fuente rusa 5 * 7.  Probablemente una bicicleta, pero ¬øhacemos siempre todo racionalmente? </p><br><p>  <b>Bosquejo:</b> </p><br><div class="spoiler">  <b class="spoiler_title">C√≥digo</b> <div class="spoiler_text"><pre><code class="hljs pgsql">//====================== OneWire ==================================== #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;OneWire.h&gt; OneWire ds2 (<span class="hljs-number"><span class="hljs-number">2</span></span>); String res = ""; byte type_s; byte data[<span class="hljs-number"><span class="hljs-number">12</span></span>]; byte addr_ds2[<span class="hljs-number"><span class="hljs-number">8</span></span>]; <span class="hljs-type"><span class="hljs-type">bool</span></span> temp_sensor_2_found = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; <span class="hljs-type"><span class="hljs-type">float</span></span> temp1 = <span class="hljs-number"><span class="hljs-number">999</span></span>; //=================================================================== #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> &lt;SPI.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "DMD.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "TimerOne.h" #<span class="hljs-keyword"><span class="hljs-keyword">include</span></span> "SystemFont5x7rus.h" #define CLR <span class="hljs-number"><span class="hljs-number">0x0C</span></span> #define US <span class="hljs-number"><span class="hljs-number">0x1F</span></span> #define ESC <span class="hljs-number"><span class="hljs-number">0x1B</span></span> #define LF <span class="hljs-number"><span class="hljs-number">0x0A</span></span> static const <span class="hljs-type"><span class="hljs-type">char</span></span> ID[] = "P10_DISPLAY_V01\r\n"; // Device ID #define DISPLAYS_ACROSS <span class="hljs-number"><span class="hljs-number">1</span></span> #define DISPLAYS_DOWN <span class="hljs-number"><span class="hljs-number">1</span></span> DMD dmd(DISPLAYS_ACROSS, DISPLAYS_DOWN); //  ,     . #define max_char1 <span class="hljs-number"><span class="hljs-number">6</span></span> #define max_char2 <span class="hljs-number"><span class="hljs-number">176</span></span> unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> message1[max_char1] = {<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x30</span></span>,<span class="hljs-number"><span class="hljs-number">0x30</span></span>,<span class="hljs-number"><span class="hljs-number">0x30</span></span>,<span class="hljs-number"><span class="hljs-number">0x30</span></span>,<span class="hljs-number"><span class="hljs-number">0x00</span></span>}; // stores you message unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> message2[max_char2]; // stores you message unsigned <span class="hljs-type"><span class="hljs-type">char</span></span> r_char; byte index1 = <span class="hljs-number"><span class="hljs-number">4</span></span>; byte index2 = <span class="hljs-number"><span class="hljs-number">176</span></span>; <span class="hljs-type"><span class="hljs-type">int</span></span> i; long scrollSpeed = <span class="hljs-number"><span class="hljs-number">25</span></span>; <span class="hljs-type"><span class="hljs-type">char</span></span> test[] = { <span class="hljs-number"><span class="hljs-number">0x84</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x87</span></span>,<span class="hljs-number"><span class="hljs-number">0x84</span></span>,<span class="hljs-number"><span class="hljs-number">0x90</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x82</span></span>,<span class="hljs-number"><span class="hljs-number">0x91</span></span>,<span class="hljs-number"><span class="hljs-number">0x92</span></span>,<span class="hljs-number"><span class="hljs-number">0x82</span></span>,<span class="hljs-number"><span class="hljs-number">0x93</span></span>,<span class="hljs-number"><span class="hljs-number">0x85</span></span>,<span class="hljs-number"><span class="hljs-number">0x92</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x92</span></span>, <span class="hljs-number"><span class="hljs-number">0x8E</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x81</span></span>,<span class="hljs-number"><span class="hljs-number">0x8B</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x83</span></span>,<span class="hljs-number"><span class="hljs-number">0x8E</span></span>,<span class="hljs-number"><span class="hljs-number">0x84</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x90</span></span>,<span class="hljs-number"><span class="hljs-number">0x9F</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x97</span></span>,<span class="hljs-number"><span class="hljs-number">0x85</span></span>,<span class="hljs-number"><span class="hljs-number">0x8C</span></span>,<span class="hljs-number"><span class="hljs-number">0x93</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x8C</span></span>,<span class="hljs-number"><span class="hljs-number">0x9B</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x8D</span></span>,<span class="hljs-number"><span class="hljs-number">0x85</span></span>,<span class="hljs-number"><span class="hljs-number">0x91</span></span>,<span class="hljs-number"><span class="hljs-number">0x8C</span></span>,<span class="hljs-number"><span class="hljs-number">0x8E</span></span>,<span class="hljs-number"><span class="hljs-number">0x92</span></span>,<span class="hljs-number"><span class="hljs-number">0x90</span></span>,<span class="hljs-number"><span class="hljs-number">0x9F</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x8D</span></span>,<span class="hljs-number"><span class="hljs-number">0x88</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>, <span class="hljs-number"><span class="hljs-number">0x8D</span></span>,<span class="hljs-number"><span class="hljs-number">0x80</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x97</span></span>,<span class="hljs-number"><span class="hljs-number">0x92</span></span>,<span class="hljs-number"><span class="hljs-number">0x8E</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x88</span></span>,<span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x82</span></span>,<span class="hljs-number"><span class="hljs-number">0x8E</span></span>,<span class="hljs-number"><span class="hljs-number">0x8F</span></span>,<span class="hljs-number"><span class="hljs-number">0x90</span></span>,<span class="hljs-number"><span class="hljs-number">0x85</span></span>,<span class="hljs-number"><span class="hljs-number">0x8A</span></span>,<span class="hljs-number"><span class="hljs-number">0x88</span></span>, <span class="hljs-number"><span class="hljs-number">0x20</span></span>,<span class="hljs-number"><span class="hljs-number">0x82</span></span>,<span class="hljs-number"><span class="hljs-number">0x91</span></span>,<span class="hljs-number"><span class="hljs-number">0x85</span></span>,<span class="hljs-number"><span class="hljs-number">0x8C</span></span>,<span class="hljs-number"><span class="hljs-number">0x93</span></span>,<span class="hljs-number"><span class="hljs-number">0x21</span></span>,<span class="hljs-number"><span class="hljs-number">0x00</span></span>}; //============================================================================= <span class="hljs-type"><span class="hljs-type">bool</span></span> get_sensor(byte addr[<span class="hljs-number"><span class="hljs-number">8</span></span>], OneWire ds) { //    <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (! ds.<span class="hljs-keyword"><span class="hljs-keyword">search</span></span> (addr)) { ds.reset_search (); delay (<span class="hljs-number"><span class="hljs-number">250</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } //        <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (OneWire::crc8(addr, <span class="hljs-number"><span class="hljs-number">7</span></span>) != addr[<span class="hljs-number"><span class="hljs-number">7</span></span>]) { <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("get_sensor:CRC is not valid!"); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } //    switch (addr[<span class="hljs-number"><span class="hljs-number">0</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0x10</span></span>: //Chip = DS18S20 type_s = <span class="hljs-number"><span class="hljs-number">1</span></span>; break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0x28</span></span>: //Chip = DS18B20 type_s = <span class="hljs-number"><span class="hljs-number">0</span></span>; break; <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-number"><span class="hljs-number">0x22</span></span>: //Chip = DS1822 type_s = <span class="hljs-number"><span class="hljs-number">0</span></span>; break; <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>: <span class="hljs-type"><span class="hljs-type">Serial</span></span>.println("get_sensor:Device is not a DS18x20 family device."); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } //============================================================================= <span class="hljs-type"><span class="hljs-type">double</span></span> get_temp(byte addr[<span class="hljs-number"><span class="hljs-number">8</span></span>], OneWire ds) { <span class="hljs-type"><span class="hljs-type">double</span></span> celsius; ds.<span class="hljs-keyword"><span class="hljs-keyword">reset</span></span> (); ds.<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> (addr); //   ds.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span> (<span class="hljs-number"><span class="hljs-number">0x44</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); //  ,     delay (<span class="hljs-number"><span class="hljs-number">750</span></span>); ds.<span class="hljs-keyword"><span class="hljs-keyword">reset</span></span> (); ds.<span class="hljs-keyword"><span class="hljs-keyword">select</span></span> (addr); ds.<span class="hljs-keyword"><span class="hljs-keyword">write</span></span> (<span class="hljs-number"><span class="hljs-number">0xBE</span></span>); //     <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-type"><span class="hljs-type">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>; i++) { //     data[i] = ds.<span class="hljs-keyword"><span class="hljs-keyword">read</span></span> (); } //        ,           <span class="hljs-type"><span class="hljs-type">int</span></span> raw = (data[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span>) | data[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type_s) { raw = raw &lt;&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>; // <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-type"><span class="hljs-type">bit</span></span> resolution <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data[<span class="hljs-number"><span class="hljs-number">7</span></span>] == <span class="hljs-number"><span class="hljs-number">0x10</span></span>) { raw = (raw &amp; <span class="hljs-number"><span class="hljs-number">0xFFF0</span></span>) + <span class="hljs-number"><span class="hljs-number">12</span></span> - data[<span class="hljs-number"><span class="hljs-number">6</span></span>]; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { byte cfg = (data[<span class="hljs-number"><span class="hljs-number">4</span></span>] &amp; <span class="hljs-number"><span class="hljs-number">0x60</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cfg == <span class="hljs-number"><span class="hljs-number">0x00</span></span>) raw = raw &lt;&lt; <span class="hljs-number"><span class="hljs-number">3</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cfg == <span class="hljs-number"><span class="hljs-number">0x20</span></span>) raw = raw &lt;&lt; <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (cfg == <span class="hljs-number"><span class="hljs-number">0x40</span></span>) raw = raw &lt;&lt; <span class="hljs-number"><span class="hljs-number">1</span></span>; } celsius = (<span class="hljs-type"><span class="hljs-type">double</span></span>)raw / <span class="hljs-number"><span class="hljs-number">16.0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> celsius; }; //============================================================================= <span class="hljs-type"><span class="hljs-type">void</span></span> massage2BufClear () { <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i=<span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;max_char2; i++) { message2[i] = <span class="hljs-string"><span class="hljs-string">'\0'</span></span>; } index2=<span class="hljs-number"><span class="hljs-number">0</span></span>; } //<span class="hljs-comment"><span class="hljs-comment">-------------------------------------------------------------- void massage1BufClear () { message1[0] = 0x20; message1[1] = 0x30; message1[2] = 0x30; message1[3] = 0x30; message1[4] = 0x30; message1[5] = 0x00; index1=0; } //-------------------------------------------------------------- void massage1Normalization () { char buf[5]; buf[0] = 0x20; buf[1] = 0x30; buf[2] = 0x30; buf[3] = 0x30; buf[4] = 0x30; int char_count = index1; for(i = char_count - 1; i &gt;= 0; i--) { buf[i] = message1[i]; } massage1BufClear(); for(i = char_count - 1; i &gt;= 0; i--) { message1[i+5-char_count] = buf[i]; } } //------------------------------------------------------------------ void ScanDMD() { dmd.scanDisplayBySPI(); } //------------------------------------------------------------------ void setup(void) { Timer1.initialize( 500 ); Timer1.attachInterrupt( ScanDMD ); dmd.clearScreen( true ); Serial.begin(9600); strcpy(message2,test); dmd.brightness = 70; temp_sensor_2_found = get_sensor(addr_ds2, ds2); dmd.selectFont(SystemFont5x7); } //------------------------------------------------------------------ void loop(void) { dmd.drawMarquee(message2 ,index2,(32*DISPLAYS_ACROSS)-1 ,8); if (temp_sensor_2_found) // !!!!!!! { // !!!!!!! res = String(get_temp(addr_ds2, ds2)); // !!!!!!! res.toCharArray(message1, 5); // !!!!!!! message1[4] = 0xF8; // !!!!!!! } // !!!!!!! long start=millis(); long timer=start; boolean ret=false; while(!ret) { if ((timer + scrollSpeed) &lt; millis()) { dmd.drawFilledBox( 0,0,31,7, GRAPHICS_INVERSE); ret=dmd.stepMarquee(-1,0); timer=millis(); dmd.drawString( 1, 0, message1, 5, GRAPHICS_NORMAL ); if(Serial.available()) break; } } } //----------------------------------------------------------------------------------- void serialEvent() { delay(25); // Wait all data r_char = Serial.read(); if(r_char &lt; 0x20) { switch (r_char) { case ESC: r_char = Serial.read(); if(r_char=='@') { Serial.write(ID); } break; case CLR: massage1BufClear(); massage2BufClear(); break; case US: r_char = Serial.read(); if(r_char=='X') { dmd.brightness = Serial.read(); } if(r_char=='B'){ massage2BufClear(); while(Serial.available() &gt; 0) { r_char = Serial.read(); if(index2 &lt; (max_char2-1)) { if(r_char &gt; 0x1F) { message2[index2] = r_char; index2++; } } } } if(r_char==LF){ massage1BufClear(); while(Serial.available() &gt; 0) { r_char = Serial.read(); if(index1 &lt; (max_char1-1)) { if((r_char &gt; 0x29) and (r_char &lt; 0x3A)) { message1[index1] = r_char; index1++; } } } massage1Normalization(); } dmd.drawFilledBox( 0,8,31,15, GRAPHICS_INVERSE); break; default: break; } } while (Serial.available()) Serial.read(); dmd.writePixel(0,0,GRAPHICS_NORMAL,1); }</span></span></code> </pre> </div></div><br><p>  <strong>Operaci√≥n de brillo completo:</strong> </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/7v71YxFvSbA" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  <strong>Trabajar con brillo humano:</strong> </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/FTNCwPa2ByI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  <strong>Trabajando con carga din√°mica de tiempo desde una PC usando un script Python:</strong> </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ElJsE-d2NDI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  <strong>Todas las irregularidades con el desplazamiento se deben al disparo en la c√°mara, para el ojo desde una distancia normal, todo se ve bastante suave y legible.</strong> </p><br><p>  Vale la pena se√±alar que es completamente gratuito conectar <strong>varios m√≥dulos en</strong> serie y solo indicar esto en el boceto para obtener una pantalla m√°s grande.  Las limitaciones comienzan solo despu√©s de un <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">cierto n√∫mero de paneles</a> y est√°n asociadas con el rendimiento limitado de Arduino y su interfaz SPI.  <strong><u>¬°Gracias <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=" class="user_link">ElectricFromUfa</a> por una descripci√≥n detallada y detallada de los paneles y m√°s!</u></strong> </p><br><p>  Quiz√°s en el futuro haga lo mismo en el STM32F103C8T6 y en el ESP-12F, todo deber√≠a moverse m√°s r√°pido all√≠. </p><br><p>  <strong>Referencias</strong> </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">1. Enlace al archivo con un boceto y relacionado.</a> <br>  <a href="">2. Otro enlace a BitBucket</a> </p><br><div class="spoiler">  <b class="spoiler_title">Art√≠culos relacionados:</b> <div class="spoiler_text"><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://conture.by/post/1100</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://ediy.com.my/blog/item/116-arduino-driving-a-32x16-dot-matrix-display-panel</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://blog.vettore.org/building-a-large-led-sign-with-inexpensive-standard-modules-and-arduino/</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">http://digital-wizard.net/avr_projects/p10_led_display_panel_interface</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://geektimes.ru/post/275548/</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://forum.arduino.cc/index.php?topic=260320.0</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">https://www.youtube.com/channel/UChButpZaL5kUUl_zTyIDFkQ</a> </p></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es404867/">https://habr.com/ru/post/es404867/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es404857/index.html">An√≥telo de inmediato: 5 razones para actualizar su flota de impresoras</a></li>
<li><a href="../es404859/index.html">La queratoplastia es la √∫ltima opci√≥n para arreglar sus ojos si todo est√° mal (y algo sobre los m√©todos modernos)</a></li>
<li><a href="../es404861/index.html">El libro "El misterioso genoma humano"</a></li>
<li><a href="../es404863/index.html">Nintendo lanza otra consola retro para jugadores modernos</a></li>
<li><a href="../es404865/index.html">¬øPor qu√© hay tanta gente de Rusia entre los mejores hackers?</a></li>
<li><a href="../es404869/index.html">La historia de la medicina. Grecia antigua</a></li>
<li><a href="../es404873/index.html">Melissa y aglomerado en una c√°mara de gas con Atmotube</a></li>
<li><a href="../es404875/index.html">Programaci√≥n del sistema nervioso humano. Video del taller, parte 2</a></li>
<li><a href="../es404877/index.html">HBot polaco</a></li>
<li><a href="../es404879/index.html">Moto regresa a Rusia</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>