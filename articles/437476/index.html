<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>し  ㄢ Ok Yandex! 驴D贸nde est谩n nuestros objetivos de alcance?  锔 </title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="La historia sobre Yandex.Metrika ReachGoal, la ni帽a Lida y que no hay problemas insolubles 

 El mundo es imperfecto, la red mundial es a煤n m谩s imperf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Ok Yandex! 驴D贸nde est谩n nuestros objetivos de alcance?</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/437476/"><h4>  La historia sobre Yandex.Metrika ReachGoal, la ni帽a Lida y que no hay problemas insolubles </h4><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/cy/9m/wv/cy9mwvyyhova6jpawosn8v0pdsm.png"></div><br>  El mundo es imperfecto, la red mundial es a煤n m谩s imperfecta.  A veces, puedes cerrar los ojos a esto.  Pero no solo cuando una hermosa ni帽a llamada Lida del "departamento de marketing" est谩 de pie frente a usted, mir谩ndolo a los ojos y haciendo la pregunta: "Por alguna raz贸n, en Y. Metrica, los datos que veo en el embudo de pedidos son diferentes de esos que veo en nuestro sistema contable.  Y tenemos m谩s pedidos ". <br><br>  Dado que las ni帽as con ojos hermosos deben ser amadas y apreciadas de todas las formas posibles, se decidi贸 conectar el registro de eventos que ocurren con los clientes durante su proceso de pedido. <br><a name="habracut"></a><br>  Especialmente sin esperar ning煤n efecto interesante y, por lo tanto, no sabiamente astuto, se agreg贸 r谩pidamente un servicio que registra los eventos que ocurren en la interfaz en los navegadores de los visitantes de nuestro sitio. <br><br>  En primer lugar, est谩bamos interesados en los eventos que podr铆an ocurrir durante la ejecuci贸n del c贸digo Y. Metrica, es decir, yaCounterXXXXXX.reachGoal (). <br><br>  Entonces, configuramos todos los lugares donde necesitamos detectar la excepci贸n y enviar estos eventos al servidor: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { yaCounterXXXXXX.reachGoal(<span class="hljs-string"><span class="hljs-string">"EVENT_XXX"</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(e) { $.get(<span class="hljs-string"><span class="hljs-string">"/front/service/event"</span></span>, {<span class="hljs-attr"><span class="hljs-attr">event</span></span>: <span class="hljs-string"><span class="hljs-string">"YM-warning"</span></span>, <span class="hljs-attr"><span class="hljs-attr">goal</span></span>: <span class="hljs-string"><span class="hljs-string">" EVENT_XXX "</span></span>, <span class="hljs-attr"><span class="hljs-attr">message</span></span>: e.message}); }</code> </pre> <br>  El tiempo pasa, recordamos que arrojamos una ca帽a de pescar, pero no comprobamos la captura. <br>  Vamos a mirar los registros, y para nuestra sorpresa, vemos aproximadamente lo siguiente: <br><br><pre> <code class="plaintext hljs">[2018-04-17 09:04:51.431] [BASKET_LOAD] [yaCounterXXXXXX is not defined] [Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/65.0.3325.181 Safari/537.36] [2018-04-17 09:09:18.082] [BASKET_LOAD] [yaCounterXXXXXX is not defined] [Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:59.0) Gecko/20100101 Firefox/59.0] [2018-04-17 09:09:21.369] [BASKET_LOAD] [yaCounterXXXXXX is not defined] [Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:59.0) Gecko/20100101 Firefox/59.0] [2018-04-17 09:09:24.990] [BASKET_LOAD] [yaCounterXXXXXX is not defined] [Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:59.0) Gecko/20100101 Firefox/59.0] [2018-04-17 09:09:27.001] [] [yaCounterXXXXXX is not defined] [Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:59.0) Gecko/20100101 Firefox/59.0] [2018-04-17 09:12:44.778] [ORDER_CREATED] [yaCounterXXXXXX is not defined] [Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:59.0) Gecko/20100101 Firefox/59.0] ...   </code> </pre><br>  Un c谩lculo r谩pido mostr贸 que alrededor del 3..4..5% de los eventos en la canasta pasan por Y. Metrika.  Lida ten铆a raz贸n.  Y como la ni帽a tiene raz贸n, hay que hacer algo.  Aunque cuando la chica se equivoca, a煤n debes hacer algo. <br><br>  Comenzamos a buscar una raz贸n.  El contador est谩 configurado correctamente, la gran mayor铆a de los eventos son registrados por ellos correctamente.  Estamos tratando de buscar en Google la presencia de problemas similares entre colegas en el taller.  No se encontr贸 nada por el estilo. <br><br>  Yandex TechSupport respondi贸 con una carta que conten铆a un enlace a la documentaci贸n para instalar el contador m茅trico, por lo que, por supuesto, un agradecimiento por separado. <br><br>  No describir茅 todas las hip贸tesis que hemos probado.  La conclusi贸n es que, al momento de cargar la p谩gina, el c贸digo de contador Yandex.Metrica no se carga en el navegador del cliente y no se inicializa all铆.  Puede ser un bloqueador de anuncios y / o rastreadores de seguimiento, puede haber algunos problemas de red entre el cliente y el servidor Yandex (esto es poco probable). <br><br>  Tuve que tomar a Lida de las manos, mirarla a los ojos sin fondo y decir a rega帽adientes la cruda verdad: "Lida, tendremos que aceptar el hecho de que algunos visitantes de nuestro sitio no recibir谩n eventos de" pedido / rechazo de hacer un pedido "en Y. Metrika.  Pero definitivamente se nos ocurrir谩 algo ". <br><br>  El verano pas贸 y el oto帽o estaba llegando a su fin, cuando Lida apareci贸 nuevamente en el umbral de la oficina.  En sus ojos llenos de l谩grimas, se hizo evidente que esos porcentajes desafortunados que pasaban le imped铆an mostrar hermosos informes a sus superiores y, por lo tanto, obtener una bonificaci贸n anual, que ya inclu铆a en su presupuesto para viajes a Tailandia para las vacaciones de A帽o Nuevo. <br><br>  El coraz贸n tembl贸.  Todo el equipo del grupo de front-end se reuni贸, y <s>en una forma dif铆cil se le orden贸 "隆cavar desde aqu铆 hasta el almuerzo!"</s>  隆la tarea se estableci贸 para resolver este problema de cualquier manera!  No es eso !!!  De lo contrario, Lida no podr谩 ir a Tailandia ... <br><br>  Frontend no quiso cavar durante mucho tiempo y se ofreci贸 una soluci贸n r谩pida casi de inmediato: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     .    , //         //     var n = document.getElementsByTagName("script")[0], s = document.createElement("script"); s.src = "/js/yaScriptLocal.js"; n.parentNode.insertBefore(s, n);</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">El resultado de esta decisi贸n se puede ver en el gr谩fico, este es un an谩lisis del registro de eventos</b> <div class="spoiler_text"> <a href=""><img src="https://habrastorage.org/webt/ej/at/nj/ejatnj_q5k1_dlhebwzesjqui9c.png"><br></a> <br></div></div><br>  Como puede ver, el n煤mero de errores se redujo a casi 0 <br><br>  Si a煤n no ha verificado el 茅xito de la descarga de scripts Yandex.Metrica en su sitio, aseg煤rese de verificar.  Tambi茅n te esperan descubrimientos interesantes. <br><br>  Descargo de responsabilidad: entiendo que la soluci贸n anterior est谩 lejos de ser 贸ptima.  Me alegrar铆a escuchar pensamientos y opiniones sobre este asunto. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/437476/">https://habr.com/ru/post/437476/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../437466/index.html">Byte-machine para el fuerte (y no solo) en nativos americanos (parte 4)</a></li>
<li><a href="../437468/index.html">Retropie Dreamcast</a></li>
<li><a href="../437470/index.html">Algunas palabras simples sobre defensa antimisiles</a></li>
<li><a href="../437472/index.html">Transici贸n de la oficina a udalenka: compartir experiencias y trucos para la vida</a></li>
<li><a href="../437474/index.html">Optimice el rendimiento del juego con las opciones de importaci贸n de sonido de Unity</a></li>
<li><a href="../437478/index.html">Que debemos construir un camino. Parte 1</a></li>
<li><a href="../437480/index.html">4 novelas visuales para aprender ingl茅s</a></li>
<li><a href="../437482/index.html">Preg煤ntele a Ethan: si la luz se contrae y se expande con el espacio, 驴c贸mo podemos detectar ondas gravitacionales?</a></li>
<li><a href="../437484/index.html">C贸mo realic茅 con 茅xito seis entrevistas en Silicon Valley</a></li>
<li><a href="../437486/index.html">AlphaStar: un nuevo sistema de inteligencia artificial para StarCraft II de DeepMind (traducci贸n completa)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>