<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üê± üò° üë¥ Wir stellen die Automatisierung in wenigen Stunden bereit: TypeScript, Protractor, Jasmine üòà üîß üëº</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hallo Habr! 

 Mein Name ist Vitaliy Kotov, ich mache viel Testautomatisierung und es gef√§llt mir. Ich habe k√ºrzlich an einem Projekt zur Konfiguratio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Wir stellen die Automatisierung in wenigen Stunden bereit: TypeScript, Protractor, Jasmine</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/451522/"> Hallo Habr! <br><br>  Mein Name ist Vitaliy Kotov, ich mache viel Testautomatisierung und es gef√§llt mir.  Ich habe k√ºrzlich an einem Projekt zur Konfiguration der Automatisierung von Grund auf auf dem TypeScript + Protractor + Jasmine-Stack teilgenommen.  F√ºr mich war dieser Stapel neu und ich suchte im Internet nach den notwendigen Informationen. <br><br>  Es gelang mir, die n√ºtzlichsten und sinnvollsten Handb√ºcher nur auf Englisch zu finden.  Ich entschied, dass ich dies auch auf Russisch tun musste.  Ich m√∂chte Ihnen nur die Grundlagen erl√§utern: Warum ein solcher Stack, was Sie konfigurieren m√ºssen und wie der einfachste Test aussieht. <br><br>  Ich muss sofort sagen, dass ich selten mit NodeJS, npm und serverseitigem JavaScript im Allgemeinen arbeite (insbesondere mit TypeScript).  Wenn Sie irgendwo einen Fehler in der Terminologie finden oder einige meiner Entscheidungen verbessert werden k√∂nnen, werde ich mich freuen, dies in den Kommentaren erfahrener Leute zu erfahren. <br><br>  √úbrigens hatte ich bereits einen √§hnlichen Artikel: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">‚ÄûWir stellen die Automatisierung in ein paar Stunden bereit: PHPUnit, Selenium, Composer‚Äú</a> . <br><br><img src="https://habrastorage.org/webt/mn/rc/5t/mnrc5tzbyn3hmecryv5sj-1nuae.png"><br><a name="habracut"></a><br><h3>  Herausforderung </h3><br>  Lassen Sie uns zun√§chst herausfinden, welches Problem wir l√∂sen.  Wir haben eine Webanwendung, die mit AngularJS geschrieben wurde.  Dies ist ein JavaScript-Framework, auf dessen Grundlage h√§ufig Webprojekte geschrieben werden. <br><br>  In diesem Artikel werden die Vor- und Nachteile von AngularJS-Projekten nicht ber√ºcksichtigt.  Nur ein paar Worte zu den Merkmalen solcher Projekte beim Schreiben von e2e-Tests f√ºr sie. <br><br>  Ein ziemlich wichtiger Aspekt beim Testen der Automatisierung ist das Arbeiten mit Seitenelementen, was mithilfe von Locators geschieht.  Ein Locator ist eine Zeile, die nach bestimmten Regeln zusammengesetzt ist und ein UI-Element identifiziert: eines oder mehrere. <br><br>  F√ºr das Web werden am h√§ufigsten CSS und Xpath verwendet.  Wenn sich auf der Seite ein Element mit einer eindeutigen ID befindet, k√∂nnen Sie manchmal danach suchen.  Es scheint mir jedoch, dass WebDriver diese ID am Ende immer noch in einen CSS-Locator verwandelt und bereits damit arbeitet. <br><br>  Wenn wir uns den HTML-Code eines AngularJS-Projekts ansehen, sehen wir viele Attribute f√ºr Elemente, die nicht in klassischem HTML enthalten sind: <br><br><img src="https://habrastorage.org/webt/zg/r3/et/zgr3etoo6q7qeycuobh1tl9g1f4.png"><br><br>  Der Code stammt von der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Winkelmesser-Demo-</a> Seite. <br><br>  Alle Attribute, die mit ng- * beginnen, werden von AngularJS verwendet, um mit der Benutzeroberfl√§che zu arbeiten.  Eine ziemlich typische Situation ist, wenn die Elemente au√üer diesen Steuerattributen keine anderen Attribute haben, was den Prozess des Kompilierens von Qualit√§tslokalisatoren etwas erschwert. <br><br>  Diejenigen, die viel automatisieren, wissen um den Wert solcher Benutzeroberfl√§chen, f√ºr die Locators einfach erstellt werden k√∂nnen.  Immerhin ist dies bei gro√üen Projekten selten.  :) :) <br><br>  Tats√§chlich m√ºssen wir f√ºr ein solches Projekt auch die Testautomatisierung konfigurieren.  Lass uns gehen! <br><br><h3>  Was ist was? </h3><br>  Lassen Sie uns zun√§chst herausfinden, warum jede Komponente unseres Stapels ben√∂tigt wird. <br><br>  <b>Winkelmesser</b> ist ein Testframework, das auf WebDriverJS basiert.  Er wird unsere Browser starten, sie zwingen, die erforderlichen Seiten zu √∂ffnen und mit den erforderlichen Elementen zu interagieren. <br><br>  Dieses Framework ist speziell auf AngularJS-Projekte zugeschnitten.  Es bietet zus√§tzliche M√∂glichkeiten, Locators anzugeben: <br><br><pre><code class="javascript hljs">element(by.model(<span class="hljs-string"><span class="hljs-string">'first'</span></span>)); element(by.binding(<span class="hljs-string"><span class="hljs-string">'latest'</span></span>)); element(by.repeater(<span class="hljs-string"><span class="hljs-string">'some'</span></span>));</code> </pre> <br>  Eine vollst√§ndige Liste finden Sie auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Handbuchseite</a> . <br><br>  Diese Methoden vereinfachen die Erstellung und Unterst√ºtzung von Locators in einem Projekt.  Sie m√ºssen jedoch verstehen, dass "unter der Haube" all dies auf jeden Fall in CSS konvertiert wird.  Tatsache ist, dass das W3C-Protokoll, auf dessen Grundlage die Interaktion in WebDriver stattfindet, nur mit einer endlichen Menge von Locators arbeiten kann.  Diese Liste kann auf <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">w3.org</a> eingesehen <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">werden</a> . <br><br>  <b>TypeScript</b> ist eine von Microsoft erstellte Programmiersprache.  TypeScript unterscheidet sich von JavaScript durch die F√§higkeit, Variablen einzugeben, die Verwendung vollwertiger Klassen zu unterst√ºtzen und Module zu verbinden. <br><br>  In TS-Code geschrieben, um mit der V8-Engine zu arbeiten, wird in JS-Code √ºbersetzt, der bereits ausgef√ºhrt wird.  W√§hrend dieser Transformation wird der Code auf Konformit√§t √ºberpr√ºft.  Beispielsweise wird es nicht ‚Äûkompiliert‚Äú, wenn anstelle von int irgendwo explizit eine Zeichenfolge an die Funktion √ºbergeben wird. <br><br>  <b>Jasmine</b> ist ein Framework zum Testen von JavaScript-Code.  In der Tat ist es ihm zu verdanken, dass unser JS-Code zu dem wird, was wir fr√ºher als Test bezeichnet haben.  Er verwaltet diese Tests. <br><br>  Im Folgenden sehen wir uns die M√∂glichkeiten an. <br><br><h3>  Montage und Projekteinrichtung </h3><br>  Nun, wir haben uns f√ºr eine Reihe von Frameworks entschieden. Lassen Sie uns nun das Ganze zusammenstellen. <br><br>  Um mit dem Code zu arbeiten, habe ich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Visual Studio Code</a> von Microsoft ausgew√§hlt.  Obwohl viele in <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">WebStorm</a> oder sogar <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Intellij Idea</a> von JetBrains schreiben. <br><br>  Ich habe bereits NodeJS (v11.6.0) und NPM (6.9.0) installiert.  Wenn Sie es nicht haben, ist dies kein Problem. Die Installation ist nicht schwierig.  Alles ist auf der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">offiziellen Website</a> ausreichend detailliert beschrieben. <br><br>  Garn kann anstelle von NPM verwendet werden, obwohl dies f√ºr ein kleines Projekt nicht wichtig ist. <br><br>  In unserer IDE erstellen wir ein neues Projekt.  Wir erstellen package.json im Stammverzeichnis des Projekts - darin beschreiben wir alle Pakete, die wir f√ºr das Projekt ben√∂tigen. <br><br>  Sie k√∂nnen es mit dem Befehl <i>npm init</i> erstellen.  Oder Sie k√∂nnen den Inhalt einfach in eine Datei kopieren. <br><br>  Anfangs sieht <b>package.json folgenderma√üen</b> aus: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"protractor"</span></span>, <span class="hljs-string"><span class="hljs-string">"dependencies"</span></span>: { <span class="hljs-string"><span class="hljs-string">"@types/node"</span></span>: <span class="hljs-string"><span class="hljs-string">"^10.5.2"</span></span>, <span class="hljs-string"><span class="hljs-string">"@types/jasmine"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.3.12"</span></span>, <span class="hljs-string"><span class="hljs-string">"protractor"</span></span>: <span class="hljs-string"><span class="hljs-string">"^5.4.2"</span></span>, <span class="hljs-string"><span class="hljs-string">"typescript"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.4.1"</span></span> } }</code> </pre><br>  Danach f√ºhren wir den Befehl <i>npm install aus</i> , um alle erforderlichen Module und ihre Abh√§ngigkeiten zu installieren (Sie erinnern sich an das Bild von etwas, das schwerer als ein Schwarzes Loch ist ...). <br><br>  Daher sollten wir ein Verzeichnis node_modules haben.  Wenn sie aufgetaucht ist, l√§uft alles nach Plan.  Wenn nicht, lohnt es sich, das Ergebnis der Befehlsausf√ºhrung zu untersuchen. In der Regel wird dort alles ausf√ºhrlich beschrieben. <br><br><h3>  TypeScript und seine Konfiguration </h3><br>  Um TypeScript zu installieren, ben√∂tigen wir npm: <br><br><pre> <code class="plaintext hljs">npm install -g typescript</code> </pre><br>  Stellen Sie sicher, dass es installiert ist: <br><br><pre> <code class="plaintext hljs">$ tsc -v Version 3.4.1</code> </pre><br>  Alles scheint in Ordnung zu sein. <br><br>  Jetzt m√ºssen wir eine Konfiguration f√ºr die Arbeit mit TS erstellen.  Es sollte sich auch im Stammverzeichnis des Projekts befinden und <b>tsconfig.json</b> hei√üen <br><br>  Der Inhalt wird folgenderma√üen aussehen: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"compilerOptions"</span></span>: { <span class="hljs-string"><span class="hljs-string">"lib"</span></span>: [<span class="hljs-string"><span class="hljs-string">"es6"</span></span>], <span class="hljs-string"><span class="hljs-string">"strict"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"outDir"</span></span> : <span class="hljs-string"><span class="hljs-string">"output_js"</span></span>, <span class="hljs-string"><span class="hljs-string">"types"</span></span> : [<span class="hljs-string"><span class="hljs-string">"jasmine"</span></span>, <span class="hljs-string"><span class="hljs-string">"node"</span></span>] }, <span class="hljs-string"><span class="hljs-string">"exclude"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"node_modules/*"</span></span> ] }</code> </pre><br>  Kurz gesagt, wir haben in dieser Konfiguration Folgendes angegeben: <br><br><ul><li>  In welches Verzeichnis soll der endg√ºltige JS-Code gestellt werden (in unserem Fall ist es output_js)? </li><li>  Aktivieren Sie den strengen Modus </li><li>  Gibt an, mit welchen Frameworks wir arbeiten </li><li>  Node_modules von der Kompilierung ausgeschlossen </li></ul><br>  TS hat eine Vielzahl von Einstellungen.  Das reicht f√ºr unser Projekt.  Weitere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen finden</a> Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unter typescriptlang.org</a> . <br><br>  Nun wollen wir sehen, wie der Befehl <i>tsc funktioniert</i> , der unseren TS-Code in JS-Code verwandelt.  Erstellen Sie dazu eine einfache check_tsc.ts-Datei mit folgendem Inhalt: <br><br><pre> <code class="javascript hljs">saySomething(<span class="hljs-string"><span class="hljs-string">"Hello, world!"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">saySomething</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message: string</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(message); }</code> </pre><br>  <i>F√ºhren</i> Sie dann den Befehl <i>tsc aus</i> (dazu m√ºssen Sie sich im Projektverzeichnis befinden). <br><br>  Wir werden sehen, dass wir das Verzeichnis output_js haben und eine √§hnliche js-Datei mit dem folgenden Inhalt darin erschienen ist: <br><br><pre> <code class="javascript hljs"><span class="hljs-meta"><span class="hljs-meta">"use strict"</span></span>; saySomething(<span class="hljs-string"><span class="hljs-string">"Hello, world!"</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">saySomething</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">message</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log(message); }</code> </pre><br>  Diese Datei kann bereits mit dem Befehl node gestartet werden: <br><br><pre> <code class="plaintext hljs">$ node output_js/check_tsc.js Hello, world!</code> </pre><br>  Also haben wir unser erstes TypeScipt-Programm geschrieben, herzlichen Gl√ºckwunsch.  Schreiben wir jetzt Tests.  :) :) <br><br><h3>  Winkelmesserkonfiguration </h3><br>  F√ºr Winkelmesser ben√∂tigen wir auch eine Konfiguration.  Aber es wird nicht mehr in Form von json sein, sondern in Form einer ts-Datei.  Nennen wir es config.ts und schreiben dort den folgenden Code: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { Config } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"protractor"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> config: Config = { <span class="hljs-attr"><span class="hljs-attr">seleniumAddress</span></span>: <span class="hljs-string"><span class="hljs-string">"http://127.0.0.1:4444/wd/hub"</span></span>, <span class="hljs-attr"><span class="hljs-attr">SELENIUM_PROMISE_MANAGER</span></span>: <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-attr"><span class="hljs-attr">capabilities</span></span>: { <span class="hljs-attr"><span class="hljs-attr">browserName</span></span>: <span class="hljs-string"><span class="hljs-string">"chrome"</span></span>, <span class="hljs-comment"><span class="hljs-comment">/*chromeOptions: { args: [ "--headless", "--window-size=800,600" ] }*/</span></span> }, <span class="hljs-attr"><span class="hljs-attr">specs</span></span>: [ <span class="hljs-string"><span class="hljs-string">"Tests/*Test.js"</span></span>, ] };</code> </pre><br>  In dieser Datei haben wir Folgendes angegeben: <br><br>  Erstens der Pfad zum laufenden Selenium-Server.  Die Ausf√ºhrung ist recht einfach. Sie m√ºssen lediglich <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">die JAR-Datei des Standalone-Servers</a> und die erforderlichen Treiber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">herunterladen</a> (z. B. den Chrome-Treiber <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">f√ºr den Chrome-Browser</a> ).  Schreiben Sie als n√§chstes den folgenden Befehl: <br><br><pre> <code class="plaintext hljs">java -jar -Dwebdriver.chrome.driver=/path/to/chromedriver /path/to/selenium-server-standalone.jar</code> </pre><br>  Als Ergebnis sollten wir die folgende Schlussfolgerung sehen: <br><br><pre> <code class="plaintext hljs">23:52:41.691 INFO [GridLauncherV3.launch] - Selenium build info: version: '3.11.0', revision: 'e59cfb3' 23:52:41.693 INFO [GridLauncherV3$1.launch] - Launching a standalone Selenium Server on port 4444 2019-05-02 23:52:41.860:INFO::main: Logging initialized @555ms to org.seleniumhq.jetty9.util.log.StdErrLog 23:52:42.149 INFO [SeleniumServer.boot] - Welcome to Selenium for Workgroups.... 23:52:42.149 INFO [SeleniumServer.boot] - Selenium Server is up and running on port 4444</code> </pre><br>  Port 4444 ist voreingestellt.  Sie kann mit dem Parameter -port oder √ºber den Konfigurationsparameter "seleniumArgs" =&gt; "-port" eingestellt werden. <br><br>  Wenn Sie einfacher und schneller wollen: Sie k√∂nnen das npm-Paket <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">webdriver-manager</a> herunterladen. <br><br>  Verwalten Sie dann den Server mit den Befehlen start, shutdown usw.  Es gibt keinen gro√üen Unterschied, ich bin nur eher daran gew√∂hnt, mit einer JAR-Datei zu arbeiten.  :) :) <br><br>  <b>Zweitens</b> haben wir angegeben, dass wir den Promise-Manager nicht verwenden m√∂chten.  Dazu sp√§ter mehr. <br><br>  <b>Drittens</b> haben wir Funktionen f√ºr unseren Browser festgelegt.  Ich habe zum Beispiel einen Teil kommentiert, dass wir den Browser ganz einfach im Headless-Modus starten k√∂nnen.  Dies ist eine coole Funktion, mit der Sie unsere Tests jedoch nicht visuell beobachten k√∂nnen.  In der Zwischenzeit lernen wir nur - ich w√ºrde gerne.  :) :) <br><br>  <b>Viertens</b> haben wir eine Maske f√ºr Spezifikationen (Tests) angegeben.  Alles, was im Ordner Tests liegt und mit Test.js endet.  Warum auf js, nicht ts?  Dies liegt daran, dass Node letztendlich speziell mit JS-Dateien und nicht mit TS-Dateien arbeitet.  Es ist wichtig, nicht verwirrt zu sein, besonders zu Beginn der Arbeit. <br><br>  Erstellen Sie nun den Ordner Tests und schreiben Sie den ersten Test.  Er wird Folgendes tun: <br><br><ul><li>  Deaktiviert die √úberpr√ºfung, ob es sich um eine Winkelseite handelt.  Ohne dies erhalten wir die folgende Fehlermeldung: Fehler beim Ausf√ºhren von testForAngular.  F√ºr Angular-Seiten ist diese Pr√ºfung nat√ºrlich nicht erforderlich, um sie auszuschalten. </li><li>  Geht zur Google-Seite. </li><li>  √úberpr√ºfen Sie, ob ein Texteingabefeld vorhanden ist. </li><li>  Geben Sie den Text "Winkelmesser" ein. </li><li>  Klicken Sie auf die Schaltfl√§che "Senden" (es hat einen ziemlich komplizierten Locator, da es zwei Schaltfl√§chen gibt und die erste unsichtbar ist). </li><li>  Es wird erwartet, dass die URL das Wort "Winkelmesser" enth√§lt - dies bedeutet, dass wir alles richtig gemacht haben und die Suche begann. </li></ul><br>  Hier ist der Code, den ich bekommen habe: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> { browser, by, element, protractor } <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">"protractor"</span></span>; describe(<span class="hljs-string"><span class="hljs-string">'Search'</span></span>, () =&gt; { it(<span class="hljs-string"><span class="hljs-string">'Open google and find a text'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">async</span></span> () =&gt; { <span class="hljs-comment"><span class="hljs-comment">//       let EC = protractor.ExpectedConditions; //    AngularJS await browser.waitForAngularEnabled(false); //   Google await browser.get('https://www.google.com/'); //    css = input[role='combobox'] let input_button = element(by.css("input[role='combobox']")); //     ( presenceOf) await browser.wait(EC.presenceOf(input_button), 5000); //     ‚Äúprotractor‚Äù await input_button.sendKeys("protractor"); //      css let submit_button = element(by.css(".FPdoLc input[type='submit'][name='btnK']")); //      ( ,     input-,   ) await browser.wait(EC.presenceOf(submit_button), 5000); //     await submit_button.click(); // ,  URL    'protractor' await browser.wait(EC.urlContains('protractor'), 5000); }); });</span></span></code> </pre><br>  Im Code sehen wir, dass alles mit der Funktion description () beginnt.  Sie kam aus dem Jasmin-Framework zu uns.  Dies ist ein Wrapper f√ºr unser Skript.  Darin k√∂nnen Funktionen vorAll () und vorEach () enthalten sein, um Manipulationen vor allen Tests und vor jedem Test durchzuf√ºhren.  So viele Funktionen wie es () sind, sind in der Tat unsere Tests.  Am Ende werden, falls definiert, afterAll () und afterEach () f√ºr Manipulationen nach jedem Test und allen Tests ausgef√ºhrt. <br><br>  Ich werde nicht √ºber alle Funktionen von Jasmine sprechen, Sie k√∂nnen dar√ºber auf der Website <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">jasmine.github.io lesen</a> <br><br>  Um unseren Test auszuf√ºhren, m√ºssen Sie zuerst den TS-Code in JS-Code umwandeln und dann ausf√ºhren: <br><br><pre> <code class="plaintext hljs">$ tsc $ protractor output_js/config.js</code> </pre><br>  Unser Test hat begonnen - wir sind gro√üartig.  :) :) <br><br><img src="https://habrastorage.org/webt/0f/vu/wc/0fvuwcmgrgf-pspd7vngaweq2dy.png"><br><br>  Wenn der Test nicht gestartet wurde, lohnt es sich zu √ºberpr√ºfen: <br><br><ul><li>  Dass der Code richtig geschrieben ist.  Wenn der Code kritische Fehler enth√§lt, werden diese im Allgemeinen w√§hrend des Befehls tsc abgefangen. </li><li>  Dieser Selenium Server l√§uft.  Dazu k√∂nnen Sie die URL http: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">//127.0.0.1-00-00444/wd/hub √∂ffnen</a> - es sollte eine Schnittstelle f√ºr Selenium-Sitzungen geben. </li><li>  Das Chrome startet normalerweise mit der heruntergeladenen Version des Chrome-Treibers.  Klicken Sie dazu auf der Seite wd / hub / auf Sitzung erstellen und w√§hlen Sie Chrome aus.  Wenn es nicht gestartet wird, m√ºssen Sie entweder Chrome aktualisieren oder eine andere Version des Chrome-Treibers herunterladen. </li><li>  Wenn dies alles fehlschl√§gt, k√∂nnen Sie √ºberpr√ºfen, ob der Befehl npm install erfolgreich ausgef√ºhrt wurde. </li><li>  Wenn alles richtig geschrieben ist, aber immer noch nichts startet, versuchen Sie, den Fehler zu googeln.  Es hilft meistens.  :) :) </li></ul><br><h3>  NPM-Skripte </h3><br>  Um das Leben einfacher zu machen, k√∂nnen Sie einen Teil der Befehle npm Aliase machen.  Zum Beispiel m√∂chte ich das Verzeichnis mit fr√ºheren JS-Dateien l√∂schen und vor jedem Testlauf mit neuen neu erstellen. <br><br>  F√ºgen Sie dazu das Skriptelement zu package.json hinzu: <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"protractor"</span></span>, <span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { <span class="hljs-string"><span class="hljs-string">"test"</span></span>: <span class="hljs-string"><span class="hljs-string">"rm -rf output_js/; tsc; protractor output_js/config.js"</span></span> }, <span class="hljs-string"><span class="hljs-string">"dependencies"</span></span>: { <span class="hljs-string"><span class="hljs-string">"@types/node"</span></span>: <span class="hljs-string"><span class="hljs-string">"^10.5.2"</span></span>, <span class="hljs-string"><span class="hljs-string">"@types/jasmine"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.3.12"</span></span>, <span class="hljs-string"><span class="hljs-string">"protractor"</span></span>: <span class="hljs-string"><span class="hljs-string">"^5.4.2"</span></span>, <span class="hljs-string"><span class="hljs-string">"typescript"</span></span>: <span class="hljs-string"><span class="hljs-string">"^3.4.1"</span></span> } }</code> </pre><br>  Wenn Sie nun den Befehl <i>npm test</i> eingeben, geschieht Folgendes: Das Verzeichnis output_js mit dem alten Code wird gel√∂scht, neu erstellt und ein neuer JS-Code wird darauf geschrieben.  Danach beginnen die Tests sofort. <br><br>  Anstelle dieses Befehlssatzes k√∂nnen Sie auch andere Befehle angeben, die Sie pers√∂nlich zum Arbeiten ben√∂tigen.  Beispielsweise k√∂nnen Sie einen Selenserver zwischen Testl√§ufen starten und l√∂schen.  Dies ist nat√ºrlich einfacher im Testcode selbst zu steuern. <br><br><h3>  Ein bisschen √ºber Promise </h3><br>  Am Ende werde ich ein wenig √ºber Promise, async / await und dar√ºber sprechen, wie sich das Schreiben von Tests in NodeJS von Java oder Python unterscheidet. <br><br>  JavaScript ist eine asynchrone Sprache.  Dies bedeutet, dass der Code nicht immer in der Reihenfolge ausgef√ºhrt wird, in der er geschrieben wurde.  Dies schlie√üt HTTP-Anforderungen ein, und wir erinnern uns, dass der Code √ºber HTTP mit Selenium Server kommuniziert. <br><br>  Versprechen (normalerweise als "Versprechen" bezeichnet) bieten eine bequeme M√∂glichkeit, asynchronen Code zu organisieren.  Weitere <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Informationen finden</a> Sie unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">learn.javascript.ru</a> . <br><br>  Tats√§chlich sind dies Objekte, die einen Code von der Ausf√ºhrung eines anderen abh√§ngig machen und dadurch eine bestimmte Reihenfolge garantieren.  Winkelmesser arbeitet sehr aktiv mit diesen Objekten. <br><br>  Schauen wir uns ein Beispiel an.  Angenommen, wir f√ºhren den folgenden Code aus: <br><br><pre> <code class="java hljs">driver.findElement().getText();</code> </pre><br>  In Java erwarten wir, dass wir ein Objekt vom Typ String zur√ºckgeben.  In Protractor ist dies nicht ganz so, wir werden ein Promise-Objekt zur√ºckgeben.  Und einfach so funktioniert das Drucken mit dem Ziel des Debuggens nicht. <br><br>  Normalerweise m√ºssen wir den resultierenden Wert nicht drucken.  Wir m√ºssen es an eine andere Methode √ºbergeben, die bereits mit diesem Wert funktioniert.  Beispielsweise wird der Text mit dem erwarteten Ergebnis verglichen. <br><br>  √Ñhnliche Methoden in Protractor akzeptieren auch Promise-Objekte als Eingabe, sodass es kein Problem gibt.  Wenn Sie den Wert dennoch anzeigen m√∂chten, ist () hilfreich. <br><br>  So k√∂nnen wir den Schaltfl√§chentext auf einer Google-Seite drucken (da dies eine Schaltfl√§che ist, befindet sich der Text innerhalb des Wertattributs): <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   let submit_button = element(by.css(".FPdoLc input[type='submit'][name='btnK']")); //    await browser.wait(EC.presenceOf(submit_button), 5000); //   then()   await submit_button.getAttribute("value").then((text) =&gt; { console.log(text); });</span></span></code> </pre><br>  Bei den Schl√ºsselw√∂rtern async / await handelt es sich um einen etwas neueren Ansatz f√ºr die Arbeit mit asynchronem Code.  Es erm√∂glicht Ihnen, die Versprechen H√∂lle zu vermeiden, die zuvor im Code aufgrund der gro√üen Anzahl von Verschachtelungen gebildet wurde.  Trotzdem k√∂nnen Sie Promise nicht vollst√§ndig loswerden und m√ºssen in der Lage sein, mit ihnen zu arbeiten.  Dies ist verst√§ndlich und detailliert finden Sie im Artikel <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Design async / await in JavaScript: St√§rken, Fallstricke und Nutzungsmerkmale</a> . <br><br><h3>  Hausaufgaben </h3><br>  Als Hausaufgabe schlage ich vor, Tests f√ºr eine in AngularJS geschriebene Seite zu schreiben: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Winkelmesser-Demo</a> . <br><br>  Vergessen Sie nicht, die Zeile aus dem Code zum Deaktivieren der Seitenpr√ºfung in AngularJS zu entfernen.  Arbeiten Sie unbedingt mit Locatoren, die speziell f√ºr AngularJS entwickelt wurden.  Darin liegt keine besondere Magie, aber es ist sehr praktisch. <br><br><h3>  Zusammenfassung </h3><br>  Lassen Sie uns Bilanz ziehen.  Wir haben es geschafft, Tests zu schreiben, die mit einer Reihe von TypeScript + Protractor + Jasmine funktionieren.  Wir haben gelernt, wie man ein solches Projekt erstellt, die erforderlichen Konfigurationen erstellt und den ersten Test geschrieben. <br><br>  Unterwegs haben wir ein wenig √ºber die Arbeit mit JavaScript-Autotests gesprochen.  Es scheint f√ºr ein paar Stunden gut zu sein.  :) :) <br><br><h3>  Was zu lesen, wo zu suchen </h3><br>  <b>Winkelmesser</b> hat ein ziemlich gutes Handbuch mit JavaScript-Beispielen: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.protractortest.org/#/tutorial</a> <br>  <b>Jasmine</b> hat ein Handbuch: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://jasmine.github.io/pages/docs_home.html</a> <br>  <b>TypeScipt</b> hat einen guten Einstieg: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://www.typescriptlang.org/docs/handbook/typescript-in-5-minutes.html</a> <br><br>  Auf dem Medium gibt es einen guten Artikel in englischer Sprache √ºber TypeScript + Winkelmesser + Gurke: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://medium.com/@igniteram/e2e-testing-with-protractor-cucumber-using-typescript-564575814e4a</a> <br><br>  Und in meinem Repository habe ich den endg√ºltigen Code f√ºr das ver√∂ffentlicht, was wir in diesem Artikel besprochen haben: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">https://github.com/KotovVitaliy/HarbProtractorJasmineJasmine</a> . <br><br>  Im Internet finden Sie Beispiele f√ºr komplexere und gr√∂√üere Projekte auf diesem Stapel. <br><br>  Vielen Dank f√ºr Ihre Aufmerksamkeit!  :) :) </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de451522/">https://habr.com/ru/post/de451522/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de451512/index.html">So analysieren Sie das mobile MMORPG-Netzwerkprotokoll</a></li>
<li><a href="../de451514/index.html">CSS Subgrid News</a></li>
<li><a href="../de451516/index.html">Im Spring Framework verwendete Entwurfsmuster</a></li>
<li><a href="../de451518/index.html">Unsere abgespeckten mobilen Websites</a></li>
<li><a href="../de451520/index.html">VDI: Billig und fr√∂hlich</a></li>
<li><a href="../de451524/index.html">Die Geschichte, wie der Autoplay Media Studio 8.5.3.0-Wasserkocher kaputt ging</a></li>
<li><a href="../de451528/index.html">"Und so geht es": Cloud-Anbieter sind sich nicht √ºber personenbezogene Daten einig</a></li>
<li><a href="../de451532/index.html">Nachrichten aus der Welt von OpenStreetMap Nr. 459 (30.04.2019 - 05.06.2019)</a></li>
<li><a href="../de451534/index.html">12 Prinzipien der Animation bei der Entwicklung von Videospielen</a></li>
<li><a href="../de451538/index.html">Amazon Redshift Parallel Scaling Guide und Testergebnisse</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>