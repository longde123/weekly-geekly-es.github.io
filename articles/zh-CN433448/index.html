<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🏾 🤲🏽 🔻 二手市场比较分析 B和C部分的德国和法国汽车 👨🏾‍💻 🤦🏼 🧤</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="哈Ha！ 

 在这篇文章中，我想以德国和法国为例，分享使用几种python工具进行欧洲二手车市场比较分析的经验。 



 从实现的角度来看，一切都会变得很香草。 所使用技术的动物园有点多余，因为它本身就是目的-我想对其进行测试。 

 背景 当我浏览法国广告网站时，进行这种分析的想法一次拜访了我...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>二手市场比较分析 B和C部分的德国和法国汽车</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/433448/"> 哈Ha！ <br><br> 在这篇文章中，我想以德国和法国为例，分享使用几种python工具进行欧洲二手车市场比较分析的经验。 <br><br><img src="https://habrastorage.org/webt/tg/o9/rs/tgo9rsqjzutsw4sh0wz2od_8jim.jpeg" alt="图片"><br><a name="habracut"></a><br> 从实现的角度来看，一切都会变得很香草。 所使用技术的动物园有点多余，因为它本身就是目的-我想对其进行测试。 <br><br> 背景 当我浏览法国广告网站时，进行这种分析的想法一次拜访了我。 我清楚地感觉到雪铁龙C3是一辆非常糟糕的汽车，每年会贬值20％，但是欧宝Corsa几乎是不朽的，因此它的价格不会随着年龄的增长而改变（否则价格会上升。劳力士）。 考虑到德国人认为成年人中的Corsa是专业实施方面惨败的标志，这是一个有趣的观察。 甚至有人开玩笑说，十年之内任何汽车都可以变成欧宝。 在没有西德Trabant的情况下，Zaporozhets在德国民间传说中的角色是由该特定品牌扮演的。 据我所知，C3在俄罗斯没有特别代表，但从标题图片上可以看出，它是经典2CV的精神继承者，这是一辆传奇性的汽车，错过了几年的互联网（1989年之前投入生产），并为驾驶员提供了惊人的9马力。 <br><br> 所以，开始做生意。 为了获得统计信息，您需要一个具有足够样本的来源。 在德国，这个法国的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">autoscout24.de</a>是我所见过的最好的广播公司<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-www.lacentrale.fr</a> （存在法语版的侦察兵，但不太受欢迎）。 <br><br> 我们将根据B类选择最受欢迎的一个，并在其中提出最初的问题（只需少量进入C类）。 为了收集数据，我们将选择过去10年中有数据且两个网站上至少有1000个广告的模型。 否则，样本将非常嘈杂。 <br><br> 如果您想要健康的人进行数据挖掘-如果您注册并获取了密钥，则autoscout会提供<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">RESTful API</a> 。 <br><br> 当然，我没有这样做，而是开始通过无头浏览器挖掘吸烟者。 <br><br>  Smoker挖掘看起来像这样-基于所需的过滤器（如下所述），我们形成一个查询字符串，并将其作为地址传递给<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">PhantomJS</a>无头浏览器（自从我安装它以来，由于某种原因它已被暂停）。 <br><br> 从这个阶段的非显而易见性开始，我增加了使用特征类加载元素的期望，该元素包含有关相应请求的选项数量的数据。 <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> io.open(<span class="hljs-string"><span class="hljs-string">"dump.html"</span></span>, <span class="hljs-string"><span class="hljs-string">"w"</span></span>, encoding=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> f: f.write(html) <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>: element = WebDriverWait(browser, <span class="hljs-number"><span class="hljs-number">20</span></span>).until( EC.presence_of_element_located((By.CLASS_NAME, <span class="hljs-string"><span class="hljs-string">"cl-filters-summary-counter"</span></span>)) ) <span class="hljs-comment"><span class="hljs-comment"># wait until element with summry statistics is present or drop after 20 sec</span></span></code> </pre> <br> 在浏览器中生成的html被馈送到BeautifulSoup解析器，我们在其中查找包含所找到结果的图形的元素。 <br><br><pre> <code class="python hljs">value = bsObj.findAll(<span class="hljs-string"><span class="hljs-string">"span"</span></span>, {<span class="hljs-string"><span class="hljs-string">"class"</span></span>: <span class="hljs-string"><span class="hljs-string">"cl-filters-summary-counter"</span></span>})[<span class="hljs-number"><span class="hljs-number">0</span></span>].text value = value.replace(<span class="hljs-string"><span class="hljs-string">u'\xa0'</span></span>, <span class="hljs-string"><span class="hljs-string">u' '</span></span>) <span class="hljs-comment"><span class="hljs-comment"># removes delimeter if results exceed 1000</span></span></code> </pre> <br> 您可能会猜到，生成的请求包括模型，较小的价格和年龄范围，也就是说，存在大量请求，服务器断开连接的请求数超过500。 如果您想精美地解决问题，最好通过在过程中更改的代理来访问此类服务（并且如果您具有API密钥，则无需这样做）。 在Habré上，有<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">一篇</a>关于如何通过代理工作的精巧<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">文章</a> 。 我解决了技术含量低的问题-价格遵循年龄的线性规律，因此我确定了该范围的范围，并将请求限制为线性价格的+ .- 30-50％，并在请求之间引入了10秒的暂停时间。 这足以不被禁止。 收集一个模型的数据花了大约半个小时才在控制台中静默闪烁。 <br><br> 关于过滤器的几句话。 为了获得信息丰富的选择，我应用了以下过滤器： <br><br><ul><li> 所有汽车均采用4-5门配置（Kors，Klio和其中一些提供的车型带有3门便宜的选装件）。 </li><li> 所有汽车都带有4-5个座位-这是与前一个不同的功能，因为Clio，C3和308具有Société（企业）版本，并且市场上有很多这样的汽车-这些是所有电工和钳工的服务车，有一个盒子而不是后排座椅其他条件相同的情况下，它们的成本降低了几千欧。 </li><li> 发动机功率限制为129 hp。 因为在此细分市场中进一步收费版本开始出现，那里的价格根本不符合其适度的状态。 如果重复Achtung-地址中的自动侦察兵使用的功率不是以马力为单位，而是以千瓦为单位。 </li></ul><br> 发动机和变速箱不是专门的，但是在99％的发动机和变速箱中，它们是机械师，在法国，那里有很多柴油，仅仅是因为它是在柴油门出现前十年就被推广的。 现在，他们想把所有人都移植到他身边，从对政府道德如此善变的cha恼中解脱出来，法国人已经沉迷于他们第二受欢迎的民族消遣活动了两个星期，这是罢工和纵火。 <br><br> 数据被收集，并按模型在Excel文件中的表格中进行布局（没有Excel的数据，这是什么！谢谢<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">openpyxl-</a>为转移提供便利）。 为了可视化，所有模型上的所有数据都汇总在一个CSV文件中。 <br><br> 为了实现可视化，我想提交一个简单的Web界面。 原则上，当前版本不需要后端。 数据很少，处理是基本的，您可以将带有长JSON的所有内容与图形一起转储，然后在客户端进行处理。 但我想测试一下服务器，以便以后将其用于计算量不大的任务。 而且我不知道如何使用JS，因此我不得不用客户端来折磨自己，并且服务器也可以安装在python上，因为有工具。 <br><br> 为了实现服务器，我在以前修补过的bokeh和Plotly + Dash捆绑包之间感到痛苦。 在过去的许多任务中，我对bokeh感到非常满意，特别是因为它可以嵌入Jupyter笔记本电脑中（通过Jupyter Labs，并不是那么简单），而且无需启动bokeh服务器就可以很容易地在笔记本电脑中<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">组织</a>交互式组件（）。 对于不知道如何使用JS的人，Bokeh是d3.js世界的门户。 <br><br> 对于此任务，我决定使用Plotly + Dash捆绑包（后者是不知道如何使用JS的人通往React世界的门户）。 该选择更有可能尝试。 从<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">比较中</a>可以看出-区别不是根本 <br><br> 我们继续执行接口。 <br><br> 我们正在拉起CSV，将其推到几个数据帧上。 <br><br> 为了正确设置页面样式并使用响应式设计，我们启用了本地CSS。 <br><br><pre> <code class="python hljs">app = dash.Dash(__name__, static_folder=<span class="hljs-string"><span class="hljs-string">'assets'</span></span>) <span class="hljs-comment"><span class="hljs-comment"># resource folder app.scripts.config.serve_locally = True app.css.config.serve_locally = True</span></span></code> </pre> <br> 接下来，我们使用一张两列表格创建最简单的布局，这是自适应布局的12种标准中的6种。 <br><br><pre> <code class="python hljs">app.layout = html.Div([ <span class="hljs-comment"><span class="hljs-comment"># include custom local css to allow two-column responsive html.Link(href='/assets/twocolumns_dash.css', rel='stylesheet'), html.Div([ # row div html.Div([ # column div html.H3('Average'), dcc.Graph(id='market-app', ), html.H4('Select model'), dcc.Dropdown(id='model_pick', options=model_options, value=None, multi=True) ], className="six columns"), html.Div([ # column div html.H3('Distribution'), dcc.Graph(id='market-app2', ), html.H4('Select year'), dcc.Slider( id='year-slider', min=years.min(), max=years.max(), value=years.min(), step=None, marks={str(year): str(year) for year in years} ) ], className="six columns"), ], className="row") ])</span></span></code> </pre> <br> 控件的功能实现非常简单-可以有很多输入，并且只有一种输出方式（例如，左图接受下拉菜单和Year滑块中的数据，但是只有一个元素可以更新，这是Dash功能，需要拐杖才能绕过）。 <br><br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">@app.callback(Output('market-app2', 'figure'), [Input('model_pick', 'value'), Input('year-slider', 'value')]) def update_figure_dist(selected_models, year_picked): traces = [] for model in selected_models: traces.append(go.Bar( x=df_filtered.loc[model, year_picked, :].index.values.tolist(), y=df_filtered.loc[model, year_picked, :]['results'].values.tolist(), name=model )) return { 'data': traces, 'layout': go.Layout( xaxis={'title': 'price'}, yaxis={'title': 'offers'}, hovermode='closest', legend=dict(orientation="h", xanchor="center", y=1.2, x=0.5) ) }</span></span></code> </pre><br> 就绪界面<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">-http://eu-carmarket.herokuapp.com/</a> <br><br> 对于德国数据，括号中是法国（FR）的（DE）。 <br><br> 在左侧，我们可以看到整个时期的平均价格。 此后，根据在网站上发布的规则，所有价格均为欧元-价格包括增值税。 右边是所选年份中按价格分配的报价。 该分布对于许多模型而言都是嘈杂的，因此在构建时，它以5个元素的核心在最近的邻居上进行了平滑处理（正是通过观察，我决定不采用广告数量少于1000个的模型） <br><br> 那么我们在数据中看到了什么？ <br><br> 回答一个激励研究的问题-不，与永恒的Corsa相比，雪铁龙的贬值速度并不可怕。 <br><br><img src="https://habrastorage.org/webt/ut/zt/mg/utztmg6zgzpdenzcm-pusprltga.png" alt="图片"><br><br>  2017年的巨大价格差异并不是雪铁龙第一年的主要强劲贬值。 这实际上是他们向新一代过渡时价格的上涨。 现在，它们不再像旧的2CV雪铁龙，而是更像Mini车型，拥有时尚的十字准线用于分频器-时尚，时尚的青年。 <br><br> 如果您选择一种型号，那么德国和法国市场上的差异将是惊人的，因为它不存在，无论是价值还是折旧率都没有（尽管在法国，一辆失事的2年以上旧车只有在有锁车库的情况下才能找到）。 <br><br><img src="https://habrastorage.org/webt/is/fw/nu/isfwnu0cvpltrgn9gnkxtijm0e4.png" alt="图片"><br><br><img src="https://habrastorage.org/webt/7h/oh/7l/7hoh7l-qjws8rw793qi8awzwhco.png" alt="图片"><br><br><img src="https://habrastorage.org/webt/qx/pr/yp/qxpryphzts8sape98_hgubv6tci.png" alt="图片"><br><br> 如果您选择在俄罗斯IT人士中很受欢迎的市场来搬荷兰，那么您需要支付德国价格的20％，尽管事实上欧洲国家之间没有海关边界，但是如果不随身携带随身携带的随身物品而过境的话，仅运输已购买的汽车是行不通的。靠你 这要求您在前一个国家居住六个月以上。 否则，当您尝试对汽车进行注册时，所有预期的利益都会从您身上删除。 <br><br> 如果将一大堆模型进行比较，您会看到一些有趣的观察结果。  10年后，尽管标致，马自达或Seat的贬值比大众Polo，Opel Meriva或Skoda Fabia的贬值要大，但一切都收敛到大约一个点。 因此，是的，十年后，任何汽车都将成为欧宝，但不会成为Corsa，只有像C3这样的最爱才成为Corsa。 <br><br><img src="https://habrastorage.org/webt/tj/oj/rw/tjojrwgbwcp-a9ckhlzrtganp4a.png" alt="图片"><br><br> 折旧率与模型无关。 而来自全国。 与通用线性均匀性的偏差很小（例如Renault Megane <br>  2016年的福特嘉年华（2017年的福特嘉年华）只是对模型一代的改变。 <br><br><img src="https://habrastorage.org/webt/qz/_l/fg/qz_lfg75r2jdtn9xty5uw3l17ds.png" alt="图片"><br><br><img src="https://habrastorage.org/webt/7l/wl/vq/7lwlvqdmw1vagh2hufggtulyrqy.png" alt="图片"><br><br> 由于在这种情况下折旧不是一个物理概念，所以这并不意味着汽车将处于相同状态。 在法语中，会出现皱纹的侧面，擦伤，保险杠破裂，用透明胶带包裹的镜子以及数千公里外的跳棋游戏。 但是法国人深信折旧程度与德国人相同，并且按照他们的信念付款。 但是说服德国人购买二手车 法国司机和机械师的照顾下的汽车-他们会撒谎吗？ <br><br> 关于价格与俄罗斯相比。 有一个事实，就是所描述的许多模型都没有在俄罗斯出售。 在这两个市场的几个共同特征中，您可以在大众汽车网站上找到新的Polo（尽管在俄罗斯是轿车，在欧洲是掀背车）。 在俄罗斯，新价格为8300，​​在德国为13500，新价格为8300，​​将在2012年（在荷兰现有的价格中为16200，新价格）。 起亚里约各地都可以找到一个很好的比较：俄罗斯-9000，德国-11950（明显反对德国自卫主义的倾销），法国-13700，荷兰-19950（Ja-ja，一辆Kirusha的半喇嘛，价格是大众Tiguan / Hyundai Tussan / Nissan X -trail：拥抱，哭泣并记住如何踩踏自行车）。 </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN433448/">https://habr.com/ru/post/zh-CN433448/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN433434/index.html">“绝对不需要Pascal，尤其是Basic，”：对体育编程培训师的采访</a></li>
<li><a href="../zh-CN433436/index.html">绩效研究介绍</a></li>
<li><a href="../zh-CN433438/index.html">国家杜马将限制众筹</a></li>
<li><a href="../zh-CN433442/index.html">实体框架核心2.2发布。 最新消息 （3之3）</a></li>
<li><a href="../zh-CN433446/index.html">安全周51：WordPress 5.0和Logitech软件中的错误，Facebook照片漏洞</a></li>
<li><a href="../zh-CN433450/index.html">成长和教导。 我们如何与PEGA交朋友</a></li>
<li><a href="../zh-CN433456/index.html">如何说服客户或公司使用Flutter</a></li>
<li><a href="../zh-CN433462/index.html">运行状况检查和分布式系统的逐步降级</a></li>
<li><a href="../zh-CN433464/index.html">亚种族</a></li>
<li><a href="../zh-CN433468/index.html">故障注入：如果您未尝试破坏系统，则系统将不可靠</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>