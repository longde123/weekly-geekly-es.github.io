<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üò© ü§¶üèæ üññüèæ Introducci√≥n a Bash Shell üë®üèº‚ÄçüöÄ üë®üèø‚Äçüöí üë®üèª‚Äçüé®</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hola a todos Esta es una traducci√≥n del Libro de preparaci√≥n del examen RedHat RHCE. En mi opini√≥n, es muy accesible sobre los conceptos b√°sicos de ba...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Introducci√≥n a Bash Shell</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/471242/">  Hola a todos  Esta es una traducci√≥n del Libro de preparaci√≥n del examen RedHat RHCE.  En mi opini√≥n, es muy accesible sobre los conceptos b√°sicos de bash. <br><br>  Los scripts de Shell son una ciencia en s√≠ mismos.  Sin entrar en detalles de todo lo que sucede "bajo el cap√≥", aprender√° c√≥mo usar los elementos b√°sicos para escribir sus propios scripts y analizar lo que sucede en los scripts de shell de terceros. <br><br><img src="https://habrastorage.org/webt/8w/vx/z3/8wvxz3nzeh5uaiubay0ezgvrbwm.jpeg"><br><a name="habracut"></a><br><h2>  Comprender los elementos b√°sicos de los scripts de shell </h2><br>  De hecho, un script de shell es una lista de comandos que se ejecutan secuencialmente, as√≠ como cierta l√≥gica que permite que el c√≥digo se ejecute solo bajo ciertas condiciones. <br><br>  Para comprender los scripts de shell complejos, se recomienda comenzar con scripts b√°sicos. <br><br>  El siguiente es un script muy simple: <br><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # # #This is a script that greets the world # Usage: ./hello clear echo hello world exit 0</span></span></code> </pre> <br>  Contiene varios elementos que deben usarse en todos los scripts.  Para empezar, hay shebang: esta es la l√≠nea #! / Bin / bash.  Cuando el script se inicia desde el shell principal, abre un subshell en el que se ejecutan los comandos especificados en el script. <br><br>  Estos comandos se pueden interpretar de varias maneras.  Para entender exactamente c√≥mo deben ser interpretados, se usa shebang.  En el ejemplo anterior, shebang deja en claro que el script debe ser ejecutado por el shell bash. <br><br>  Tambi√©n se pueden indicar otras conchas.  Por ejemplo, si su script contiene c√≥digo Perl, shebang deber√≠a ser #! / Usr / bin / perl.  Comenzar un script con shebang es una buena pr√°ctica;  si se omite, el c√≥digo del script ser√° ejecutado por el mismo shell que se utiliza para ejecutar el script. <br><br>  Inmediatamente despu√©s del shebang, hay una parte que explica de qu√© trata el gui√≥n.  Algunas l√≠neas de comentarios al comienzo de cada escenario son una buena idea.  En un gui√≥n corto, a menudo es obvio lo que hace, pero a medida que el gui√≥n se alarga, y a medida que m√°s personas se involucran en escribirlo y apoyarlo, se vuelve menos claro lo que los autores intentan hacer. <br><br>  Para evitar esta situaci√≥n, aseg√∫rese de agregar l√≠neas de comentarios que comiencen con cada car√°cter #.  Los comentarios pueden estar no solo en las primeras l√≠neas, sino tambi√©n al comienzo de cada subsecci√≥n del gui√≥n.  ¬°Esto sin duda ayudar√° si lees tu gui√≥n en unos pocos meses! <br><br>  Tambi√©n puede comentar no solo las subsecciones, sino tambi√©n las l√≠neas individuales. <br><br>  No importa en qu√© posici√≥n se use, todo, desde el car√°cter # hasta el final de la l√≠nea, es un comentario. <br><br>  Despu√©s del bloque de comentarios, se encuentra el cuerpo del script.  En el ejemplo anterior, estos son varios comandos que se ejecutan secuencialmente.  El cuerpo del script de shell puede aumentar a medida que se desarrolla. <br><br>  Al final del script, inclu√≠ la declaraci√≥n de <b>salida 0</b> .  La declaraci√≥n de salida le dice al shell principal si el script fue exitoso.  El estado de salida del √∫ltimo comando en el script es el estado de salida del script en s√≠, a menos que se use la <b>salida 0</b> al final del script. <br><br>  Es √∫til saber que puede trabajar con <b>exit</b> para decirle al shell principal c√≥mo fueron las cosas. <br><blockquote>  Introducido en el shell principal, el echo $?  le permite consultar el estado de salida del √∫ltimo script en ejecuci√≥n. <br></blockquote>  Despu√©s de crear el script, aseg√∫rese de que se pueda ejecutar.  La forma m√°s com√∫n de hacer esto es aplicarle un bit de ejecuci√≥n.  Entonces, si el nombre del archivo de script es hola, use el <b>comando chmod + x ./hello</b> para hacerlo ejecutable. <br><br>  El script tambi√©n se puede ejecutar como argumento para el comando bash.  En este caso, ingrese <b>bash ./hello</b> para ejecutar el script de saludo.  Si el script se ejecuta como un argumento para el comando bash, el archivo de script no tiene que ser ejecutable. <br><br>  De hecho, puede almacenar el script en cualquier lugar, pero si lo va a almacenar en un directorio que no est√° incluido en la variable $ PATH, debe ejecutarlo con ./ delante del nombre del script. <br><br>  Escriba <b>./hello</b> para ejecutar el script o p√≥ngalo en el directorio est√°ndar que se incluye en la variable $ PATH, por ejemplo, / usr / local / bin. <br><br>  Tambi√©n puede colocar el script en el directorio / bin, luego de lo cual simplemente ingrese el nombre del archivo en cualquier parte del sistema de archivos y el script se ejecutar√°. <br><br>  <b>Ejemplo</b> <br><br>  Usando <b>vi / bin / datetime,</b> cree un archivo llamado datetime en el directorio / bin.  Pegue este contenido en el archivo creado: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash #    .     ,      date who</span></span></code> </pre><br>  Despu√©s de guardar el archivo, ingrese <b>chmod + x / bin / datetime</b> para dar permiso al archivo para que se ejecute.  Por ejemplo, cambie a su directorio de inicio usando el <b>comando cd ~</b> y simplemente ingrese <b>datetime</b> . <br><br>  Vaya, por ejemplo, al directorio de inicio cd ~ e ingrese datetime. <br><br><pre> <code class="bash hljs">[root@localhost ~]<span class="hljs-comment"><span class="hljs-comment"># datetime Sat Sep 28 00:33:41 EDT 2019 root tty1 2019-09-25 20:28 root pts/0 2019-09-27 20:07 (comp.corp.domain.ru)</span></span></code> </pre><br><h2>  Usar variables y entradas </h2><br>  los scripts de bash son mucho m√°s que una simple lista de comandos que se ejecutan secuencialmente.  Una de las cosas buenas de los scripts es que pueden trabajar con variables y entradas para hacer que el script sea flexible.  En esta secci√≥n aprender√° a trabajar con ellos. <br><br><h3>  Usando par√°metros posicionales </h3><br>  Al ejecutar el script, puede usar los argumentos.  Un argumento es todo lo que pones detr√°s de un comando de script.  Los argumentos se pueden usar para hacer que el script sea m√°s flexible.  Toma el comando <b>useradd lisa</b> .  En este ejemplo, el comando es <b>useradd</b> , y su argumento, <b>lisa</b> , indica lo que hay que hacer. <br><br>  Como resultado de dicho comando, se debe crear un usuario llamado lisa. <br><br>  En el script, el primer argumento es <b>$ 1</b> , el segundo argumento es <b>$ 2,</b> y as√≠ sucesivamente. El Listado 1 muestra c√≥mo se pueden usar los argumentos.  Intente ejecutar este c√≥digo especificando cualquier nombre de usuario como par√°metro. <br><br>  <b>Listado 1</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # run this script with a few arguments echo The first argument is $1 echo The second argument is $2 echo The third argument is $3</span></span></code> </pre><br>  Los par√°metros significan la entrada de datos antes de ejecutar el script.  En este caso, especifiqu√© <b>lisa</b> , <b>lori</b> y <b>bob</b> como par√°metros despu√©s del nombre del script de argumento: <br><br><pre> <code class="bash hljs">[root@server1 ~]<span class="hljs-comment"><span class="hljs-comment"># ./argument lisa lori bob The first argument is lisa The second argument is lori The third argument is bob [root@server1 ~]#</span></span></code> </pre><br>  Si trat√≥ de ejecutar el c√≥digo de muestra, puede notar que su contenido no es perfecto.  Si utiliza tres argumentos al ejecutar el script del Listado 1, funcionar√° bien.  Si usa solo dos argumentos, el tercero se genera sin el valor $ 3. <br><br>  Si usa cuatro argumentos, el cuarto valor (que se almacenar√° en $ 4) nunca se mostrar√°.  Por lo tanto, si desea utilizar argumentos, es mejor que utilice un enfoque m√°s flexible. <br><br>  <b>Listado 2</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # run this script with a few arguments echo you have entered $# arguments for i in $@ do echo $i done exit 0</span></span></code> </pre><br>  <b>El Listado 2 muestra dos nuevos elementos que se relacionan con los argumentos:</b> <br><br><ul><li>  $ # Es un contador que muestra cu√°ntos argumentos se usaron al ejecutar el script. </li><li>  $ @ Es una lista de todos los argumentos que se usaron al ejecutar el script. </li></ul><br>  Para enumerar los argumentos que se usaron al ejecutar este script, se usa el bucle <b>for</b> .  En <b>for</b> loops, las instrucciones se ejecutan siempre que la condici√≥n sea verdadera.  En este escenario, la condici√≥n <b>para i en $ @</b> significa "para cada argumento".  Cada vez que el script pasa por el ciclo, el valor de la variable <b>$ @ se</b> asigna a la variable <b>$ i</b> . <br><br>  Entonces, siempre que haya argumentos, el cuerpo del script se ejecuta. <br><br>  El cuerpo del bucle for siempre comienza con <b>do</b> y cierra <b>done</b> , y los comandos que se ejecutar√°n se enumeran entre estas dos palabras clave.  Por lo tanto, el script de muestra usar√° <b>echo</b> para mostrar el valor de cada argumento y se detendr√° cuando no haya m√°s argumentos disponibles. <br><br>  <b>Probemos el script en el Listado 2 en este ejemplo:</b> <br><br><ol><li>  Escriba <b>vi argumento</b> para crear el archivo de argumento y copie el contenido del script en el Listado 2 a este archivo. </li><li>  Guarde el archivo y h√°galo ejecutable. </li><li>  Ejecute el comando <b>./argument abc</b> .  Ver√° que se muestran tres l√≠neas. </li><li>  Ejecute el comando <b>./argument abcdef</b> .  Ver√° que adem√°s de abc, tambi√©n se mostrar√° de f. </li></ol><br><h2>  Variables </h2><br>  Una variable es una etiqueta que se usa para indicar un lugar espec√≠fico en la memoria que contiene un valor espec√≠fico.  Las variables pueden definirse est√°ticamente usando NAME = value o din√°micamente.  Hay dos soluciones para definir din√°micamente una variable: <br><br><ul><li>  Utilice la palabra clave <b>read</b> en un script para solicitar datos del usuario que ejecuta el script. </li><li>  Use la sustituci√≥n de comandos para usar el resultado del comando y asignarlo a una variable.  Por ejemplo, la <b>fecha</b> del comando <b>+% d-% m-% y</b> muestra la fecha actual en el formato d√≠a-mes-a√±o.  Para hacer esto en un script, puede usar <b>HOY = $ (fecha +% d-% m-% a)</b> .  Para sustituir comandos, solo necesita poner el comando cuyo resultado desea utilizar entre par√©ntesis. </li></ul><br>  En la secci√≥n anterior sobre par√°metros posicionales, aprendi√≥ c√≥mo asignar argumentos a variables cuando ejecuta un script.  En algunos casos, puede ser m√°s eficiente solicitar informaci√≥n cuando encuentra que falta algo sustancial.  El siguiente script muestra c√≥mo hacer esto. <br><br>  <b>Listado 3.</b> Script de muestra usando el comando de <b>lectura</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash if [ -z $1 ]; then echo enter a text read TEXT else TEXT=$1 fi echo you have entered the text $TEXT exit 0</span></span></code> </pre><br>  En el script del Listado 3, el operador <b>if ... then ... else ... fi</b> se usa para probar la existencia del argumento <b>$ 1</b> .  Esto se hace usando <b>test</b> (test es un comando separado).  El comando de prueba se puede escribir de dos maneras *: <b>prueba</b> o <b>[...]</b> .  En el ejemplo, la l√≠nea <b>if [-z $ 1] ...</b> se ejecuta para ver la prueba (verificar) <b>-z $ 1</b> . <br><br>  * <i>- en realidad tres <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u=">fuentes</a> (traductor aprox.)</i> <br><br>  <b>-z prueba</b> comprueba si existe <b>$ 1</b> o no.  En otras palabras, la l√≠nea <b>if [-z $ 1]</b> verifica si <b>$ 1 est√°</b> vac√≠o, lo que significa que no se proporcionaron argumentos cuando se ejecut√≥ este script.  Si es as√≠, se ejecutan los comandos despu√©s de la instrucci√≥n <b>then</b> . <br><br>  Tenga en cuenta que al escribir el comando de <b>prueba</b> entre corchetes, es importante usar espacios despu√©s del corchete de apertura y antes del corchete de cierre, sin espacios el comando no funcionar√°. <br><br>  Tenga en cuenta que la instrucci√≥n <b>then</b> sigue inmediatamente a la <b>prueba</b> .  Esto es posible porque se usa un punto y coma (;).  El punto y coma es un separador de comandos y puede reemplazar una nueva l√≠nea en un script. <br><br>  La instrucci√≥n <b>then</b> ejecuta dos comandos: el comando <b>echo</b> , que muestra el mensaje en la pantalla, y el comando de <b>lectura</b> . <br><br>  El comando de <b>lectura</b> detiene el script para que la entrada del usuario pueda procesarse y almacenarse en la variable TEXT.  Por lo tanto, <b>leer TEXTO</b> coloca todas las entradas del usuario en la variable TEXTO, que se utilizar√° m√°s adelante en el script. <br><br>  La siguiente parte est√° representada por la <b>instrucci√≥n else</b> .  Los comandos despu√©s de la <b>instrucci√≥n else</b> se ejecutan en todos los dem√°s casos, lo que en este caso significa "de lo contrario, si se proporcion√≥ el argumento".  Si es as√≠, se determina la variable TEXTO y <b>se le</b> asigna el valor actual de <b>$ 1</b> . <br><br>  Observe c√≥mo se define la variable: inmediatamente despu√©s del nombre de la variable hay un signo = seguido de $ 1.  Tenga en cuenta que nunca debe usar espacios al definir variables. <br><br>  Luego, las condiciones si se cierran utilizando el operador <b>fi</b> .  Despu√©s de que se complete la condici√≥n if, sabe con certeza que la variable TEXT est√° definida y tiene un valor.  La pen√∫ltima l√≠nea del script lee el valor de la variable TEXT y asigna este valor a STDOUT usando el comando <b>echo</b> .  Tenga en cuenta que para solicitar el valor actual de una variable, se refiere al nombre de la variable, comenzando con el signo $ delante de ella. <br><br>  <b>Puede practicar el uso de este ejemplo cuando trabaje con entrada.</b> <br><br><ol><li>  Abra el editor y cree un archivo llamado texto.  Ingrese el contenido del c√≥digo en el Listado 3 en este archivo. </li><li>  Escriba el archivo en el disco y ejecute <b>chmod + x text</b> para hacerlo ejecutable. </li><li>  Ejecute el script ejecutando <b>./text</b> y sin argumentos adicionales.  Ver√° que pide entrada. </li><li>  Ejecute el script usando " <b>hola</b> " como argumento (./text hola).  El resultado mostrar√° "ha ingresado el texto hola" en STDOUT. </li></ol><br><h2>  Usando condiciones y bucles </h2><br>  Como ya ha visto, las declaraciones condicionales se pueden usar en un script.  Estas declaraciones condicionales se ejecutan solo si se cumple una determinada condici√≥n. <br><br>  Hay varias declaraciones condicionales y bucles en bash que a menudo se usan. <br><br><ul><li>  <b>if ... then ... else</b> : se usa para ejecutar c√≥digo si se cumple una determinada condici√≥n </li><li>  <b>for</b> : se utiliza para ejecutar comandos para un rango de valores </li><li>  <b>while</b> : se usa para ejecutar c√≥digo si se cumple una determinada condici√≥n </li><li>  <b>antes</b> : se usa para ejecutar c√≥digo hasta que se cumpla una determinada condici√≥n </li><li>  <b>case</b> : se utiliza para evaluar un n√∫mero limitado de valores espec√≠ficos </li></ul><br><h3>  si entonces m√°s </h3><br>  La <b>construcci√≥n if then else</b> es com√∫n para evaluar condiciones espec√≠ficas.  Ya has visto un ejemplo con √©l.  Esta declaraci√≥n condicional a menudo se usa con el comando de <b>prueba</b> .  Este comando le permite verificar muchas cosas: por ejemplo, no solo si existe un archivo, sino tambi√©n comparar archivos, comparar enteros y mucho m√°s. <br><blockquote>  Puede obtener m√°s informaci√≥n sobre la prueba en la referencia con el comando man test. </blockquote><br>  La construcci√≥n b√°sica de <b>if</b> es <b>if ... entonces ... fi</b> . <br><br>  Compara una condici√≥n, como se muestra en el siguiente ejemplo: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> [ -z <span class="hljs-variable"><span class="hljs-variable">$1</span></span> ] <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> no value provided <span class="hljs-keyword"><span class="hljs-keyword">fi</span></span></code> </pre><br>  En el Listado 3, viste c√≥mo puedes evaluar dos condiciones, incluyendo <b>otra cosa</b> en una expresi√≥n.  El Listado 4 muestra c√≥mo evaluar varias condiciones de <b>if</b> a <b>else</b> .  Esto es √∫til si necesita verificar muchos valores diferentes. <br><br>  Tenga en cuenta que este ejemplo tambi√©n utiliza varios comandos de <b>prueba</b> . <br><br>  <b>Listado 4</b> .  Ejemplo con <b>if then else</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # run this script with one argument # the goal is to find out if the argument is a file or a directory if [ -f $1 ] then echo "$1 is a file" elif [ -d $1 ] then echo "$1 is a directory" else echo "I do not know what \$1 is" fi exit 0</span></span></code> </pre> <br><h3>  ||  y &amp;&amp; </h3><br>  En lugar de escribir <b>declaraciones</b> completas <b>if ...,</b> puede usar los operadores l√≥gicos <b>||</b>  as√≠ como <b>&amp;&amp;</b> .  <b>||</b>  es un "OR" l√≥gico y ejecutar√° la segunda parte de la declaraci√≥n solo si la primera parte no es verdadera;  <b>&amp;&amp;</b> es un "Y" l√≥gico y ejecutar√° la segunda parte de la declaraci√≥n solo si la primera parte es verdadera. <br><br>  <b>Considere estas dos l√≠neas:</b> <br><br><pre> <code class="bash hljs">[ -z <span class="hljs-variable"><span class="hljs-variable">$1</span></span> ] &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> no argument provided</code> </pre> <br><pre> <code class="bash hljs">ping -c 1 8.8.8.8 2&gt;/dev/null || <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> node is not available</code> </pre><br>  El primer ejemplo verifica si <b>$ 1 est√°</b> vac√≠o.  Si esta verificaci√≥n es correcta (lo que b√°sicamente significa que el comando termina con el c√≥digo de salida 0), se ejecuta el segundo comando. <br><br>  En el segundo ejemplo, el comando <b>ping se</b> usa para verificar la disponibilidad del host. <br>  Este ejemplo utiliza un "OR" l√≥gico para mostrar el texto "el nodo no est√° disponible" en el caso de una falla del comando <b>ping</b> . <br><br>  Encontrar√° eso a menudo, en lugar de la <b>sentencia if</b> condicional, <b>&amp;&amp;</b> y <b>||</b>  .  En el ejercicio a continuaci√≥n, puede practicar el uso de declaraciones condicionales usando <b>if ... then ... else</b> o <b>&amp;&amp;</b> y <b>||</b>  . <br><br>  <b>Ejercicio</b>  Usando <b>if ... entonces ... else</b> <br><br>  En este ejercicio, trabajar√° en un script que verifica qu√© es un archivo y qu√© es un directorio. <br><br><ol><li>  Inicie el editor y cree un script llamado filechk. </li><li>  Copie el contenido del Listado 4 en este script. </li><li>  Ejecute un par de pruebas con √©l, como <b>./filechk / etc / hosts</b> , <b>./filechck / usr</b> , <b>./filechk archivo no existente</b> . </li></ol><br><h2>  Para bucle </h2><br>  El bucle <b>for</b> es una excelente soluci√≥n para procesar rangos de datos.  En el Listado 5, puede ver el primer ejemplo con <b>for</b> , donde el rango se determina y procesa mientras hay valores sin procesar en este rango. <br><br>  <b>Listado 5</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # for (( COUNTER=100; COUNTER&gt;1; COUNTER-- )); do echo $COUNTER done exit 0</span></span></code> </pre> <br>  Un ciclo <b>for</b> siempre comienza con la palabra clave for, seguido de una condici√≥n que debe verificarse.  Esto es seguido por la palabra clave <b>do</b> , seguida de comandos que deben ejecutarse, si la condici√≥n es verdadera, el ciclo termina usando la palabra clave <b>done</b> . <br><br>  En el ejemplo del Listado 5, puede ver que la condici√≥n es un rango de n√∫meros entre par√©ntesis asignados a la variable COUNTER. <br><br>  <b>Una peque√±a explicacion</b> <br><br>  Dentro <b>((...))</b> se calculan las expresiones aritm√©ticas y se devuelve su resultado.  Por ejemplo, en el caso m√°s simple, la construcci√≥n a = $ ((5 + 3)) asignar√° a la variable ‚Äúa‚Äù el valor de la expresi√≥n ‚Äú5 + 3‚Äù u 8. Adem√°s, los par√©ntesis dobles permiten trabajar con variables en el estilo del lenguaje C. <br><br>  Primero, la variable se inicializa a 100, y siempre que el valor sea mayor que 1, se resta 1 en cada iteraci√≥n. Mientras la condici√≥n sea verdadera, el valor de la variable $ COUNTER se muestra con el comando <b>echo</b> . <br><br>  En el Listado 6, puede ver una de mis frases favoritas con <b>for</b> .  El rango se define esta vez como una secuencia de n√∫meros, comenzando desde 100 y llegando a 104. <br><br>  <b>Listado 6</b> <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> {100..104}; <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> ping ‚Äìc 1 192.168.4.<span class="hljs-variable"><span class="hljs-variable">$i</span></span> &gt;/dev/null &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> 192.168.4.<span class="hljs-variable"><span class="hljs-variable">$i</span></span> is up; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span></code> </pre><br>  Observe c√≥mo se determina el rango: primero especifique el primer n√∫mero, luego dos puntos e indique el √∫ltimo n√∫mero en el rango.  Adem√°s, con <b>for i in,</b> para cada uno de estos n√∫meros, <b>se</b> asigna la variable <b>i</b> .  Cada uno de estos n√∫meros se asigna a la variable <b>i</b> y luego se ejecuta el comando <b>ping</b> , donde la opci√≥n <b>-c 1</b> garantiza que solo se env√≠e una solicitud. <br><br>  El resultado del comando <b>ping</b> no se tiene en cuenta, por lo que su salida se redirige a / dev / null.  Seg√∫n el estado de salida del comando <b>ping</b> , se ejecuta una parte de la expresi√≥n <b>&amp;&amp;</b> .  Por lo tanto, si el host est√° disponible, se muestra una l√≠nea que indica que se est√° ejecutando. <br><br><h2>  Comprender mientras y hasta </h2><br>  Si la instrucci√≥n for de la que acaba de leer es √∫til para trabajar con rangos de elementos, entonces la instrucci√≥n <b>while</b> es √∫til cuando desea realizar un seguimiento de algo como la accesibilidad del proceso.  Tambi√©n hay una instrucci√≥n <b>hasta</b> , que se ejecuta siempre que la condici√≥n que se verifica sea falsa.  En el Listado 7, puede leer c√≥mo <b>se</b> usa <b>while</b> para monitorear la actividad del proceso. <br><blockquote>  Nota  No entend√≠ lo que hace este script.  En mi caso, se usa CentOS 7 y por defecto no hay monitor, aunque el script dice expl√≠citamente: <pre>  uso: monitor &lt;processname&gt; </pre>  En alg√∫n lugar durante media hora busqu√© en Google el programa de monitor para CetOS, pero no lo encontr√©.  Y, en general, no est√° claro qu√© monitor lateral est√° aqu√≠ si se usa ps aux.  En cualquier caso, no entend√≠ lo que hace este script.  Una gran solicitud para ayudar a resolver este problema es ajustar el texto o la secuencia de comandos. </blockquote>  <b>Listado 7</b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # # usage: monitor &lt;processname&gt; while ps aux | grep $1 | grep -v grep &gt; /dev/tty11 do sleep 5 done clear echo your process has stopped logger $1 is no longer present mail -s "process $1 has stopped" root &lt; .</span></span></code> </pre> <br>  El script en el Listado 7 consta de dos partes.  Primero, hay un <b>ciclo while</b> .  En segundo lugar, hay que hacer todo cuando el <b>ciclo while</b> ya no se eval√∫a como verdadero. <br><br>  El n√∫cleo del <b>ciclo while</b> es el comando <b>ps</b> , que tiene un valor de <b>$ 1</b> . <br><br>  Tenga en cuenta el uso de <b>grep -v grep</b> , que excluye las l√≠neas que contienen el <b>comando grep</b> del resultado.  Recuerde que el comando <b>ps</b> incluir√° todos los procesos en ejecuci√≥n, incluido el <b>comando grep</b> , al que se pasa la salida del <b>comando</b> <b>ps</b> .  Esto puede conducir a una coincidencia de falsos positivos. <br><br>  La salida del comando <b>ps aux</b> se redirige a / dev / tty11.  Esto le permite leer los resultados de tty11 m√°s adelante, si es necesario, pero no se muestran de forma predeterminada. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Las instrucciones </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">while</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> son seguidas por los comandos que deben ejecutarse si la condici√≥n que se verifica es verdadera. En este caso, es el comando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sleep 5</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que detiene la ejecuci√≥n del script durante 5 segundos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mientras la condici√≥n de la instrucci√≥n </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">while</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sea </font><font style="vertical-align: inherit;">verdadera, el bucle contin√∫a ejecut√°ndose. Si la condici√≥n es falsa (lo que en este caso significa que el proceso ya no est√° disponible), el ciclo se detiene y los comandos que siguen pueden ejecutarse. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Debe estar familiarizado con todos estos comandos, excepto el √∫ltimo. En la l√≠nea </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mail -s "proceso $ 1 ha parado" root &lt;.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> El mensaje se env√≠a al usuario root mediante el sistema de correo interno, que se ejecuta en Linux * de forma predeterminada. Comando de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">toma como primer argumento el asunto del mensaje especificado con la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">opci√≥n -s</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* - al menos en CentOS funciona por defecto. (en. traductor)</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Preste atenci√≥n a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Al final del equipo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por lo general, cuando se usa el comando de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">correo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en modo interactivo, se abre un editor en el que puede escribir el cuerpo del mensaje. Este editor est√° cerrado, proporcionando una l√≠nea que solo tiene un punto. En este comando, se proporciona un punto redirigiendo STDIN. Esto permite que el mensaje se procese sin ning√∫n requisito adicional para la actividad del usuario. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ciclo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mientras que</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - el opuesto del ciclo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hasta que</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , un ejemplo del cual se muestra en el Listado 8.</font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hasta que</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comienza una iteraci√≥n que dura hasta que la condici√≥n se vuelve verdadera. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el Listado 8, se usa para filtrar la salida del comando de los </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usuarios</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> por la aparici√≥n de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$ 1</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que ser√° el nombre de usuario. </font><font style="vertical-align: inherit;">Hasta que este comando sea correcto, la iteraci√≥n contin√∫a. </font><font style="vertical-align: inherit;">Cuando se encuentra el nombre de usuario en la salida del usuario, la iteraci√≥n se cierra y, despu√©s del ciclo </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">hasta,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se ejecuta </font><font style="vertical-align: inherit;">el </font><font style="vertical-align: inherit;">resto de los comandos. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Listado 8</font></font></b> <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#!/bin/bash # until users | grep $1 &gt; /dev/null do echo $1 is not logged in yet sleep 5 done echo $1 has just logged in mail -s "$1 has just logged in" root &lt; .</span></span></code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Entendiendo el caso </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El √∫ltimo bucle de iteraci√≥n importante es el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> *. La </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">declaraci√≥n del caso se</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usa para evaluar una serie de valores esperados. En particular, las </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">declaraciones de casos</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> son importantes en los scripts de inicio de Linux, que en versiones anteriores se usaban para iniciar servicios. </font></font><br><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">* - ¬øes un ciclo?</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> En la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">declaraci√≥n de caso,</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> usted define cada argumento concreto que espera, seguido del comando que se ejecutar√° si se utiliz√≥ ese argumento. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En el Listado 9, puede ver la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">declaraci√≥n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del </font><b><font style="vertical-align: inherit;">caso</font></b><font style="vertical-align: inherit;"> , que se utiliz√≥ en una versi√≥n anterior para ejecutar casi cualquier servicio. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Listado 9</font></font></b> <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">case</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$1</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> start) start;; stop) rm -f <span class="hljs-variable"><span class="hljs-variable">$lockfile</span></span> stop;; restart) restart;; reload) reload;; status) status ;; *) <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"Usage: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$0</span></span></span><span class="hljs-string"> (start|stop|restart|reload|status)"</span></span> ;; <span class="hljs-keyword"><span class="hljs-keyword">esac</span></span></code> </pre> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El estuche</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tiene varias caracter√≠sticas. Primero viene la l√≠nea - </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso en secuencia</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Esto es seguido por una lista de todos los valores posibles que deben evaluarse. Cada elemento est√° cerrado con un corchete </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Esto es seguido por una lista de comandos que se ejecutar√°n si se utiliz√≥ un argumento espec√≠fico. La lista de comandos se cierra con un punto y coma doble; se puede usar inmediatamente despu√©s del √∫ltimo comando y se puede usar en una l√≠nea separada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tambi√©n tenga en cuenta que </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*) se</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> aplica a todos los dem√°s par√°metros no especificados anteriormente. Este es un operador que lo abarca todo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El bucle de iteraci√≥n de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> termina con la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">instrucci√≥n esac</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tenga en cuenta que las secuencias en el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> se ejecutan en orden. </font><font style="vertical-align: inherit;">Cuando se realiza la primera coincidencia, la </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">declaraci√≥n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> del </font><b><font style="vertical-align: inherit;">caso</font></b><font style="vertical-align: inherit;"> no evaluar√° nada. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como parte de la evaluaci√≥n, se pueden usar plantillas similares a la plantilla. </font><font style="vertical-align: inherit;">Esto se muestra en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*) una</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> secuencia que coincide con todo. </font><font style="vertical-align: inherit;">Pero tambi√©n puede usar secuencias como inicio | Inicio | INICIO) para que coincidan con otro </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">caso</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Depuraci√≥n de scripts en Bash </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cuando el script no hace lo que espera, es √∫til hacer alguna depuraci√≥n. </font><font style="vertical-align: inherit;">Para comenzar, intente ejecutarlo como argumento para el comando </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bash -x</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Esto le mostrar√° l√≠nea por l√≠nea lo que el script est√° tratando de hacer, as√≠ como errores espec√≠ficos si no funciona como deber√≠a. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El Listado 10 muestra un ejemplo de uso de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bash -x</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , donde inmediatamente queda claro que el </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comando grep</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> no sabe lo que debe hacer, porque falta un argumento para su operaci√≥n.</font></font><br><br><pre> <code class="bash hljs">[root@server1 ~]<span class="hljs-comment"><span class="hljs-comment"># bash -x 319.sh + grep Usage: grep [OPTION]... PATTERN [FILE]... Try 'grep --help' for more information. + users + echo is not logged in yet is not logged in yet + sleep 5</span></span></code> </pre> <br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Para resumir </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">En este art√≠culo, aprendiste a escribir scripts de shell. </font><font style="vertical-align: inherit;">Has visto algunos ejemplos y ahora est√°s familiarizado con algunos de los elementos b√°sicos necesarios para crear un script exitoso.</font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/471242/">https://habr.com/ru/post/471242/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../471226/index.html">Linux tiene muchas caras: c√≥mo trabajar en cualquier distribuci√≥n</a></li>
<li><a href="../471228/index.html">Grokay PyTorch</a></li>
<li><a href="../471232/index.html">Mi experiencia conectando LPS331AP a Omega Onion2</a></li>
<li><a href="../471236/index.html">Dos√≠metro para Seryozha. Parte III Radi√≥metro nacional</a></li>
<li><a href="../471240/index.html">"Bitchy Betty" e interfaces de audio modernas: ¬øpor qu√© hablan con voz femenina?</a></li>
<li><a href="../471244/index.html">C√≥digo de Rosetta: mida la longitud del c√≥digo en una gran cantidad de lenguajes de programaci√≥n, estudie la proximidad de los idiomas entre s√≠</a></li>
<li><a href="../471248/index.html">Los reguladores de EE. UU. Proh√≠ben la distribuci√≥n del token Telegram Open Network</a></li>
<li><a href="../471254/index.html">ITMO University Accelerator Startups - Proyectos iniciales de visi√≥n artificial</a></li>
<li><a href="../471256/index.html">Vue.js es bueno, pero ¬øes mejor que angular o reaccionar?</a></li>
<li><a href="../471258/index.html">Almacenamiento de datos / sistema de carga</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>