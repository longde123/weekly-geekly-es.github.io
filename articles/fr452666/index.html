<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üòæ üê≤ ‚õΩÔ∏è Comment effectuer des micro-paiements possibles dans votre application üêº üë®üèº‚ÄçüöÄ üë©üèæ‚Äçüè´</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Cette semaine, j'ai pass√© √† coder ma toute premi√®re application publique pour animaux de compagnie bas√©e sur le bot de chat Telegram qui agit comme un...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment effectuer des micro-paiements possibles dans votre application</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/452666/"><p>  Cette semaine, j'ai pass√© √† coder ma toute premi√®re application publique pour animaux de compagnie bas√©e sur le bot de chat Telegram qui agit comme un portefeuille Bitcoin et permet d'envoyer et de recevoir des conseils entre les utilisateurs de Telegram et d'autres soi-disant ¬´applications Lightning¬ª.  Je suppose que vous √™tes familier avec Bitcoin &amp; Telegram en g√©n√©ral, je vais essayer de poster court et sans sauter dans les d√©tails.  Plus de <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">ressources sur Bitcoin peuvent √™tre trouv√©es ici</a> et Telegram est simplement un messager instantan√© qui vous permet de cr√©er vos applications personnalis√©es (chat-bots) en utilisant leur plate-forme. </p><br><h3>  Quels sont les points cl√©s d'une telle application? </h3><br><ul><li>  Permet d'√©valuer les id√©es et les r√©ponses des autres utilisateurs avec une valeur r√©elle au lieu de <br>  ¬´j'aime virtuel¬ª.  Cela am√®ne la conversation en ligne √† un tout nouveau niveau </li><li>  Exemple r√©el d'application de micro-paiement qui peut fonctionner avec d'autres entit√©s <br>  sur Internet en utilisant un protocole ouvert </li><li>  Tous les modules sont des projets open source et peuvent √™tre facilement r√©utilis√©s et ajust√©s <br>  pour votre propre projet.  L'application ne relaie pas les services commerciaux tiers. <br>  M√™me si elle rel√®ve du domaine du commerce √©lectronique, qui est actuellement presque ferm√©, l'application <br>  est bas√© sur des solutions ouvertes. </li></ul><br><h3>  Quels sont les cas d'utilisation? </h3><br><p>  quelque chose comme √ßa ... <br></p><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/097/02b/175/09702b1750c94616a10fc66c1275c00f.png" alt="image"></div><a name="habracut"></a><br>  ou comme √ßa .. <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/3ef/1ff/85f/3ef1ff85f1e7b77662c63a9d4d838666.png" alt="image"></div><br><p>  Que signifient les chiffres?  Ce sont des <b>unit√©s bitcoin - satoshis</b> .  √Ä la mi-2019, 1000 satoshis ont une valeur de 0,06 $.  Vous pouvez le d√©penser en ligne ou √©changer dans votre devise locale en utilisant de nombreux services disponibles.  Ce n'est donc pas juste un autre <i>"num√©ro dans une base de donn√©es"</i> ou un <i>"coupons que vous pouvez d√©penser dans notre boutique partenaire"</i> , mais un <b>v√©ritable argent sur Internet</b> . </p><br><p>  Vous pouvez demander quoi faire si vous n'avez pas de bitcoin √† utiliser dans l'application.  Vous pouvez simplement recevoir un pourboire de l'utilisateur de l'application existante ou acheter une petite quantit√© de bitcoin sur divers √©changes ou portefeuilles bitcoin pour t√©l√©phone mobile ou PC. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/883/661/461/883661461bdc686aec7d084d5d581236.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/779/716/5d9/7797165d93d292700d9a41a171d882a6.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png" alt="image"></p><br><p>  Lorsque vous avez obtenu un bitcoin, vous pouvez d√©marrer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">@atomic_tipbot</a> et effectuer un / d√©p√¥t. </p><br><p>  Vous verrez une facture, vous pouvez s√©lectionner le mode de paiement pr√©f√©r√© et envoyer de l'argent simplement en scannant le code QR ou en appuyant sur le bouton ( <i>"ouvrir dans le portefeuille"</i> ) sur la facture. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/8fe/33b/84b/8fe33b84bb127132304634363bb4af42.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/4a3/da5/f76/4a3da5f76574ac9ebb2161d56bceff62.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/54d/a43/0be/54da430be68237193dee82ade50bab37.png" alt="image"></p><br><p>  Confirmez le paiement dans votre portefeuille mobile et vous verrez un √©cran de confirmation presque instantan√©ment dans Telegram. </p><br><p>  Jusqu'√† pr√©sent, nous avons touch√© deux parties distinctes de l'application: le back-end du t√©l√©gramme et le syst√®me de traitement des paiements (en fait, plus comme son front-end). </p><br><p>  Pour cr√©er ce bot Telegram, j'ai utilis√© <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Python Telegram Bot</a> .  Et bien s√ªr, le <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">bot est open-source</a> . </p><br><p>  En tant que syst√®me de traitement des paiements pour g√©n√©rer des factures, v√©rifier l'√©tat, envoyer une notification et prendre soin de l'UX, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BTCPayServer</a> est utilis√©, dont la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">documentation peut √™tre trouv√©e ici</a> . </p><br><p>  Si vous cherchez √† traiter directement les √©v√©nements de paiement, vous pouvez consulter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">les pages de manuel Electrum CLI</a> pour les paiements en cha√Æne et d√©couvrir des solutions pour les paiements hors cha√Æne (Lightning) comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Lightning-charge</a> ou <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Sparko</a> . </p><br><h3>  Vous avez dit ¬´pas de tiers¬ª et ¬´pas de services cloud¬ª!? </h3><br><p>  Oui, c'est vrai.  Dans mon application, j'utilise l'h√©bergement partag√© gratuit de l'instance BTCPayServer - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">BTCPayJungle</a> , mais il est possible de tourner m√™me sur votre propre serveur d√©di√©.  N'oubliez pas que vous avez alors besoin d'environ ~ 500 Go d'espace pour stocker la blockchain Bitcoin et Litecoin.  BTCPayServer ne d√©tient aucune cl√© priv√©e ni information sensible pouvant permettre aux pirates de contr√¥ler les fonds sur votre portefeuille.  Pour les paiements en cha√Æne (standard), vous devez fournir la cl√© xpub de votre portefeuille √† BTCPayServer afin qu'il puisse g√©n√©rer des adresses publiques.  De cette fa√ßon, l'architecture BTCPay permet de traiter les paiements en toute confiance m√™me sur un environnement partag√©.  Il est tr√®s simple √† configurer si vous utilisez des portefeuilles √©prouv√©s comme <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Electrum</a> . </p><br><h3>  Qu'est-ce que Lightning Network? </h3><br><p>  C'est quelque chose comme un add-on √† Bitcoin qui ajoute une couche d'abstraction suppl√©mentaire et permet de faire des transactions Bitcoin instantan√©es et presque gratuites.  Tout cela est possible gr√¢ce √† la magie cryptographique multi-signatures, souvent appel√©e <em>smart-contract</em> .  Il existe plusieurs impl√©mentations du protocole LN.  J'utilise l'impl√©mentation C <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">-Lightning</a> C. </p><br><p>  La principale diff√©rence entre les paiements en cha√Æne et hors cha√Æne (Lightning) r√©side dans la fa√ßon dont les transactions sont stock√©es.  Toutes <b>les</b> transactions en <b>cha√Æne</b> sont diffus√©es sur l'ensemble du r√©seau afin que chaque n≈ìud Bitcoin en cours enregistre cette transaction dans la cha√Æne de blocs, si le bloc contenant cette transaction est <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">min√©</a> .  H√©, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=" class="user_link">BitFury</a> , ai-je raison?  ;) C'est pourquoi nous appelons de telles transactions <b>en cha√Æne</b> .  Ces transactions seront stock√©es dans la blockchain jusqu'√† la fin de son existence.  Il est possible de suivre, d'analyser et de surveiller publiquement une telle transaction sur le r√©seau. </p><br><p>  En cas de transaction <b>hors cha√Æne</b> (Lightning), les choses se passent d'une autre mani√®re.  Chaque n≈ìud Lightning a <i>(peut √™tre plusieurs)</i> une adresse en cha√Æne, √† partir de laquelle tout commence.  Lorsque des fonds sont re√ßus sur une telle adresse, l'utilisation d'un n≈ìud de techniques de cryptographie peut ouvrir ce qu'on appelle un <i>canal de foudre</i> vers un autre n≈ìud, ce qui signifie que ces deux n≈ìuds se sont mis d'accord sur la disponibilit√© des fonds entre eux.  Plus tard, toutes les transactions effectu√©es via le canal (propres transactions, ou il peut √™tre achemin√© par un autre n≈ìud) sont stock√©es uniquement sur ces deux n≈ìuds (et n≈ìud interm√©diaire s'il y en avait).  Les seules transactions qui sont stock√©es dans la blockchain des r√©seaux sont les transactions d'ouverture et de fermeture de canaux.  C'est pourquoi les transactions Lightning que nous appelons <b>hors cha√Æne</b> .  G√©n√©ralement, ils n'existent que dans le fichier de base de donn√©es de n≈ìuds. </p><br><h3>  Le tout est visualis√© sur le diagramme </h3><br><img src="https://habrastorage.org/getpro/habr/post_images/3c6/636/b8c/3c6636b8c98d52aab9bd09ff9c52afcb.png" alt="image"><br><p>  Petite histoire: </p><br><p>  1) L'utilisateur envoie un message et demande un d√©p√¥t au bot sur <b>Telegram</b> </p><br><p>  2) Telegram d√©clenche l' <b>application python</b> du bot </p><br><p>  3) L' <b>application Python</b> envoie une demande √† <b>BTCPayServer</b> </p><br><p>  4) BTCPayServer g√©n√®re des adresses entrantes pour BTC et LTC, ainsi que pour contacter <b>Lightning-Charge</b> , qui obtient les donn√©es du d√©mon <b>C-Lightning</b> .  En cons√©quence, nous obtenons un cadre HTML bien g√©r√© pour le traitement des paiements </p><br><p>  5) L'utilisateur paie la facture et verra la confirmation </p><br><p>  6) <b>BTCPayServer</b> envoie une <i>notification de paiement de</i> <b>facture</b> (IPN) √† l'URL de rappel sp√©cifi√©e, dans notre cas, il <br>  ira √† <b>callbacks.py</b> (une autre application python pour √©couter les rappels) </p><br><p>  7) Selon le d√©tail complet du paiement, le solde de l'utilisateur est modifi√© et l'utilisateur re√ßoit une notification </p><br><p>  <i>... si l'utilisateur d√©cide de retirer des fonds (pourboires qu'il a re√ßus) ...</i> </p><br><p>  8) <b>L'application python de Bot</b> √©coute le texte ou l'image de QR, lorsqu'elle obtient des donn√©es de facturation (longue cha√Æne de caract√®res) puis envoie une demande de paiement de cette facture √† une autre application python <b>paylightning.py *</b> , qui initialise les paiements √† l'aide de c-lightning RPC </p><br><img src="https://habrastorage.org/getpro/habr/post_images/518/3dc/c81/5183dcc817817f1aa676ff74d17d08bb.png" alt="image"><br><p>  <i>* Pour √™tre honn√™te, je dois mentionner que mon paylight wrapper paylightning.py est incomplet et peut retourner un faux n√©gatif dans certains cas sp√©cifiques.</i>  <i>Vous devez utiliser <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">un emballage de paiement bien test√© pour c-lightning</a> en cas d'utilisation similaire √† la production.</i> </p><br><p>  Les utilisateurs peuvent s‚Äôenvoyer des conseils lors de discussions de groupe et envoyer / recevoir de la <b>valeur</b> sans aucune limite.  Mais ce n'est pas tout.  Gr√¢ce au protocole Lightning Network, qui est dans une sorte de r√©seau de paiement unifi√© et simplifi√©, vous pouvez envoyer les m√™mes pi√®ces de solde √† des applications compl√®tement diff√©rentes.  Il existe un autre tip-bot bitcoin sur le t√©l√©gramme - @lntxbot.  L'utilisateur peut demander un d√©p√¥t √† ce bot </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/f09/c3a/ef9/f09c3aef995f7a82560987646b0d8ee0.png" alt="image"><img src="https://habrastorage.org/getpro/habr/post_images/1e2/344/82c/1e234482c56aa0df1d4b341ecfe3beb8.png" alt="image"></p><br><p>  Transf√©rez simplement les donn√©es de @lntxbot √† @atomic_tipbot et voul'a! </p><br><p>  Ce n'est plus un ¬´√©change de num√©ro dans la base de donn√©es¬ª mais un paiement entre deux ¬´bases de donn√©es¬ª distinctes et non li√©es.  Bot a d√©j√† quelques ¬´LApps¬ª int√©gr√©s: <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">sat2.io</a> et <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">lnsms.world</a> . </p><br><p>  <b>Vous pouvez vous demander ce que signifie exactement l' <i>int√©gration LApp</i> ?</b> </p><br><p>  Chaque n≈ìud du <i>r√©seau Lightning</i> agit comme un portefeuille Bitcoin.  Il a √† la fois un √©quilibre en cha√Æne et hors cha√Æne.  Le solde en cha√Æne est g√©n√©ralement utilis√© pour ouvrir des canaux et stocker des fonds √† partir de canaux ferm√©s, dans des t√¢ches de maintenance de n≈ìuds courts.  Le solde hors cha√Æne est exactement ce qui est utilis√© pour √©changer des fonds entre les n≈ìuds.  Les fonctions principales de chaque n≈ìud sont la capacit√© d'envoyer ou de recevoir des fonds, de sorte que le n≈ìud en tant que logiciel fournit des m√©thodes de <i><b>paiement</b></i> et de <i><b>facturation</b></i> .  Je vais vous montrer bri√®vement comment cela se passe: </p><br><pre><code class="bash hljs">user@ln-node:/ % lightning-cli invoice 1000000000 internal_description external_description { <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"expires_at"</span></span> : 1558709834, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6"</span></span> }</code> </pre> <br><p>  La <a href="">facture BOLT11</a> est g√©n√©r√©e dans ce cas, qui est un format unifi√© pour les demandes de paiement dans le r√©seau Bitcoin (ainsi que Litecoin).  Cette cha√Æne comprend des donn√©es sur le destinataire de la facture, le montant, l'horodatage, l'expiration, etc.  Pour d√©coder cette cha√Æne, c-lightning fournit une m√©thode de d√©codage: </p><br><pre> <code class="bash hljs">user@ln-node:/ % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 { <span class="hljs-string"><span class="hljs-string">"currency"</span></span> : <span class="hljs-string"><span class="hljs-string">"bc"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558105034, <span class="hljs-string"><span class="hljs-string">"expiry"</span></span> : 604800, <span class="hljs-string"><span class="hljs-string">"payee"</span></span> : <span class="hljs-string"><span class="hljs-string">"025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 1000000000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"1000000000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span> : <span class="hljs-string"><span class="hljs-string">"external_description"</span></span>, <span class="hljs-string"><span class="hljs-string">"min_final_cltv_expiry"</span></span> : 10, <span class="hljs-string"><span class="hljs-string">"routes"</span></span> : [ [ { <span class="hljs-string"><span class="hljs-string">"pubkey"</span></span> : <span class="hljs-string"><span class="hljs-string">"03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3"</span></span>, <span class="hljs-string"><span class="hljs-string">"short_channel_id"</span></span> : <span class="hljs-string"><span class="hljs-string">"574012x1255x1"</span></span>, <span class="hljs-string"><span class="hljs-string">"fee_base_msat"</span></span> : 1000, <span class="hljs-string"><span class="hljs-string">"fee_proportional_millionths"</span></span> : 1, <span class="hljs-string"><span class="hljs-string">"cltv_expiry_delta"</span></span> : 144 } ] ], <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"signature"</span></span> : <span class="hljs-string"><span class="hljs-string">"304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37"</span></span> }</code> √©clair cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 <code class="bash hljs">user@ln-node:/ % lightning-cli decodepay lnbc10m1pwdaj72pp5vnqv3a0c7uytppy845fhdu7j2mujejukq6v8hgu4c26pj0hauksqdpqv4u8getjdeskchmyv4ekxunfwp6xjmmwxqyjw5qcqp2rzjqw3qcrp2u3ggke56wrjlstcg76drmfw680cvjum88sl7ja7mpas7xzxz8sqqfecqqyqqqqlgqqqqqqgqjqn8e3ml733dkms2txxldnuwsllwhhkldss73268hdka3e7f083vjhjqurwqrndqd2rcd85pw7vkywnr4dq7yfd59r0g2mw4wzztwr6dcprxzej6 { <span class="hljs-string"><span class="hljs-string">"currency"</span></span> : <span class="hljs-string"><span class="hljs-string">"bc"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558105034, <span class="hljs-string"><span class="hljs-string">"expiry"</span></span> : 604800, <span class="hljs-string"><span class="hljs-string">"payee"</span></span> : <span class="hljs-string"><span class="hljs-string">"025a14b8ed40583d67aec92da19453e0b2d1fbbf75f96f85d3dd0ff61a51ee0490"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 1000000000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"1000000000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"description"</span></span> : <span class="hljs-string"><span class="hljs-string">"external_description"</span></span>, <span class="hljs-string"><span class="hljs-string">"min_final_cltv_expiry"</span></span> : 10, <span class="hljs-string"><span class="hljs-string">"routes"</span></span> : [ [ { <span class="hljs-string"><span class="hljs-string">"pubkey"</span></span> : <span class="hljs-string"><span class="hljs-string">"03a20c0c2ae4508b669a70e5f82f08f69a3da5da3bf0c973673c3fe977db0f61e3"</span></span>, <span class="hljs-string"><span class="hljs-string">"short_channel_id"</span></span> : <span class="hljs-string"><span class="hljs-string">"574012x1255x1"</span></span>, <span class="hljs-string"><span class="hljs-string">"fee_base_msat"</span></span> : 1000, <span class="hljs-string"><span class="hljs-string">"fee_proportional_millionths"</span></span> : 1, <span class="hljs-string"><span class="hljs-string">"cltv_expiry_delta"</span></span> : 144 } ] ], <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"64c0c8f5f8f708b08487ad1376f3d256f92ccb9606987ba395c2b4193efde5a0"</span></span>, <span class="hljs-string"><span class="hljs-string">"signature"</span></span> : <span class="hljs-string"><span class="hljs-string">"304502210099f31dffd18b6db8296637db3e3a1ffbaf7b7db087a2ad1eedb7639f25e78b25022079038370073681aa1e1a7a05de6588e98ead078896d0a37a15b755c212dc3d37"</span></span> }</code> </pre> <br><p>  Dans le cas o√π nous devons payer une facture, nous devons utiliser la m√©thode de paiement de c-lightning: </p><br><pre> <code class="bash hljs">user@ln-node:/ % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : 163, <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63"</span></span>, <span class="hljs-string"><span class="hljs-string">"destination"</span></span> : <span class="hljs-string"><span class="hljs-string">"03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 200000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi_sent"</span></span> : 200003, <span class="hljs-string"><span class="hljs-string">"amount_sent_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200003msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558106072, <span class="hljs-string"><span class="hljs-string">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"complete"</span></span>, <span class="hljs-string"><span class="hljs-string">"payment_preimage"</span></span> : <span class="hljs-string"><span class="hljs-string">"1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019"</span></span>, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j"</span></span> }</code> √©clair cli lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j salariale <code class="bash hljs">user@ln-node:/ % lightning-cli pay lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j { <span class="hljs-string"><span class="hljs-string">"id"</span></span> : 163, <span class="hljs-string"><span class="hljs-string">"payment_hash"</span></span> : <span class="hljs-string"><span class="hljs-string">"c3e644a005f56e33df89facbce2c9dfcabbef5d105285a98272cacc77ab2de63"</span></span>, <span class="hljs-string"><span class="hljs-string">"destination"</span></span> : <span class="hljs-string"><span class="hljs-string">"03021c5f5f57322740e4ee6936452add19dc7ea7ccf90635f95119ab82a62ae268"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi"</span></span> : 200000, <span class="hljs-string"><span class="hljs-string">"amount_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200000msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"msatoshi_sent"</span></span> : 200003, <span class="hljs-string"><span class="hljs-string">"amount_sent_msat"</span></span> : <span class="hljs-string"><span class="hljs-string">"200003msat"</span></span>, <span class="hljs-string"><span class="hljs-string">"created_at"</span></span> : 1558106072, <span class="hljs-string"><span class="hljs-string">"status"</span></span> : <span class="hljs-string"><span class="hljs-string">"complete"</span></span>, <span class="hljs-string"><span class="hljs-string">"payment_preimage"</span></span> : <span class="hljs-string"><span class="hljs-string">"1a9552b9f4e9199e26839353f870b12cc85b7674a2fb134e78aa370032611019"</span></span>, <span class="hljs-string"><span class="hljs-string">"bolt11"</span></span> : <span class="hljs-string"><span class="hljs-string">"lnbc2u1pwdana3pp5c0nyfgq974hr8huflt9uutyalj4maaw3q5594xp89jkvw74jme3sdql2pshjgr5dus8q6r0dejjqampd3kx2aqcqzpgwjgn45gy80jwjhgm3tpsxg33j6h6pehdus0mnjerrad943cz3vs83g30lyhlhfjxtqvtl76vttkuhs5jekuxpsqmf98l8265pwmm76gp4e7z6j"</span></span> }</code> </pre> <br><p>  Tous les statuts des paiements sont g√©r√©s par l'ensemble du r√©seau et votre propre n≈ìud.  Vous n'avez pas besoin (mais avez la possibilit√© de le faire) de communiquer avec les d√©veloppeurs d'applications c√¥t√© r√©ception ou leur API, un fournisseur de traitement de cartes ou toute banque pour obtenir une confirmation de votre paiement ou pour lib√©rer des fonds de votre propre compte.  Il n'y a pas de refacturation ni aucune autre influence externe sur le solde de vos comptes.  Tout ce dont vous avez besoin est un logiciel qui agit selon des r√®gles de r√©seau d√©centralis√©es.  Il s'agit d'une solution pour √©changer une valeur sur Internet, sans avoir besoin d'arbitre au milieu qui d√©cide de la compatibilit√© de votre paiement avec certaines r√®gles, parfois m√™me inconnues de toutes les parties.  Il n'y a pas de r√®gles "internes" dans le bitcoin, toutes les r√®gles que votre application doit remplir sont ouvertes et connues. </p><br><p>  Cela permet <b>un</b> √©change de valeur <b>direct</b> , <b>presque gratuit</b> et <b>instantan√©</b> sur Internet entre les personnes ou m√™me le logiciel lui-m√™me de mani√®re vraiment autonome. </p><br><p>  S'il existe un moyen d'obtenir des donn√©es de paiement √† partir d'une autre application, vous pouvez agir avec cela sur le plan financier.  Comme dans notre exemple, lnsms.world est une application Web qui vous permet d'envoyer des SMS √† n'importe quel num√©ro et de le payer avec Bitcoin.  Pour int√©grer une telle option dans notre application, nous devons simplement transmettre les donn√©es requises du formulaire Web √† lnsms.world: </p><br><pre> <code class="python hljs">payload = { <span class="hljs-string"><span class="hljs-string">'number'</span></span>: phone_number, <span class="hljs-string"><span class="hljs-string">'text'</span></span>: text, <span class="hljs-string"><span class="hljs-string">'force_unicode'</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> } send_req = requests.post(<span class="hljs-string"><span class="hljs-string">'https://lnsms.world/invoice'</span></span>, data=payload) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> send_req.status_code == <span class="hljs-number"><span class="hljs-number">201</span></span>: plain_invoice = str(send_req.text)</code> </pre> <br><p>  Je ne sais pas pour quelle raison, mais lnsms r√©pond avec 201 code de statut HTTP et renvoie la facture BOLT11.  Eh bien, cela suffit pour payer cette facture et nos utilisateurs enverront des sms peu de temps apr√®s la r√©ception du paiement.  Nous pouvons facturer des frais suppl√©mentaires ou non, c'est notre libre choix. </p><br><p>  Maintenant, imaginez que votre bot est en fait une application plus utile et ne paie pas un autre bot, mais une autre entit√©, connect√©e √† Internet.  Ou bien, il peut s'agir de paiements entre logiciels, machines, magasins, prestataires de services sur une base r√©guli√®re se r√©p√©tant toutes les quelques secondes?  Ressentez-vous la puissance des micro-paiements?  Voil√† √† quoi ressemblera l'Internet des objets.  D√©j√†, il existe des projets tels que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">https://althea.org/</a> et dans un avenir proche, nous serons confront√©s √† de grands changements dans le domaine de ce que nous appelons le commerce √©lectronique. </p><br><p>  Si vous aimez cet article et que vous essayez vous-m√™me les paiements Bitcoin, vous pouvez <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">me laisser un conseil sur ma page de pourboire</a> . </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr452666/">https://habr.com/ru/post/fr452666/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr452648/index.html">PHP: Comment analyser un fichier XML complexe et ne pas se noyer dans le code natif</a></li>
<li><a href="../fr452652/index.html">Security Week 21: un trou dans Whatsapp, une nouvelle vuln√©rabilit√© dans les processeurs Intel, Zero-Day dans Windows</a></li>
<li><a href="../fr452656/index.html">D√©veloppement du ¬´firmware¬ª le plus simple pour les FPGA install√©s dans Redd, et d√©bogage en utilisant le test de m√©moire comme exemple</a></li>
<li><a href="../fr452662/index.html">Serveurs HPE √† Selectel</a></li>
<li><a href="../fr452664/index.html">J'ai factur√© 18 000 $ pour une page Web statique ... et je m'en suis sorti</a></li>
<li><a href="../fr452668/index.html">Comment v√©rifier la conformit√© des cookies au RGPD - un nouvel outil ouvert vous aidera</a></li>
<li><a href="../fr452670/index.html">Qui sont les ing√©nieurs de donn√©es et comment deviennent-ils?</a></li>
<li><a href="../fr452672/index.html">Habr hebdomadaire. Rencontrez la version pilote Habrapodcast</a></li>
<li><a href="../fr452674/index.html">√âv√©nements num√©riques √† Moscou du 21 au 26 mai</a></li>
<li><a href="../fr452682/index.html">Pr√©visions et discussion: les syst√®mes de stockage hybrides c√©deront la place au 100% flash</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>