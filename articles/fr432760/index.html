<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèº‚Äçüåæ üíã ü§ûüèª Vues de produit vectorielles ou autre utilisation du mod√®le Word2Vec üé• ü§ô ü§ö</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Chaque jour, un million et demi de personnes recherchent Ozon pour une vari√©t√© de produits, et pour chacun d'eux, le service doit s√©lectionner des pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Vues de produit vectorielles ou autre utilisation du mod√®le Word2Vec</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/ozontech/blog/432760/"><img src="https://habrastorage.org/webt/w4/qo/hx/w4qohxd9gujf6kayzuow0bww9dc.png" alt="image"><br><br><p>  Chaque jour, un million et demi de personnes recherchent Ozon pour une vari√©t√© de produits, et pour chacun d'eux, le service doit s√©lectionner des produits similaires (si l'aspirateur en a encore besoin d'un plus puissant) ou des produits connexes (si des piles sont n√©cessaires pour le dinosaure chantant).  Lorsqu'il existe trop de types de produits, le mod√®le Word2Vec aide √† r√©soudre le probl√®me.  Nous comprenons comment cela fonctionne et comment cr√©er des repr√©sentations vectorielles pour des objets arbitraires. </p><a name="habracut"></a><br><h3>  La motivation </h3><br><p> Pour construire et former le mod√®le, nous utilisons la technique d'int√©gration, standard pour l'apprentissage automatique, lorsque chaque objet se transforme en vecteur de longueur fixe, et que les vecteurs proches correspondent aux objets proches.  Presque tous les mod√®les connus n√©cessitent que les donn√©es d'entr√©e soient d'une longueur fixe, et un ensemble de vecteurs est un moyen facile de les amener sous cette forme. </p><br><p>  Word2vec est l'une des premi√®res m√©thodes d'int√©gration.  Nous avons adapt√© cette m√©thode √† notre t√¢che, nous utilisons les produits comme mots et les sessions utilisateurs comme phrases.  Si tout est clair pour vous, n'h√©sitez pas √† parcourir les r√©sultats. </p><br><p>  Je parlerai ensuite de l'architecture du mod√®le et de son fonctionnement.  √âtant donn√© que nous traitons des marchandises, nous devons apprendre √† en construire de telles descriptions qui, d'une part, contiennent suffisamment d'informations et, d'autre part, sont compr√©hensibles pour l'algorithme d'apprentissage automatique. </p><br><img src="https://habrastorage.org/webt/y0/pj/fz/y0pjfzmvk5o-aulmjygpnjrphji.png" alt="image"><br><p>  Sur le site, chaque produit a une carte.  Il se compose d'un titre, d'une description textuelle, de sp√©cifications et de photographies.  Nous disposons √©galement de donn√©es sur l'interaction des utilisateurs avec le produit: les vues, l'ajout au panier ou les favoris sont stock√©s dans les journaux. </p><br><p>  Il existe deux fa√ßons fondamentalement diff√©rentes de construire une description vectorielle d'un produit: </p><br><p>  - utiliser le contenu - r√©seaux de neurones convolutifs pour extraire des caract√©ristiques de photos, de r√©seaux r√©currents ou d'un sac de mots pour analyser une description de texte; <br>  - utilisation des donn√©es sur les interactions des utilisateurs avec le produit: quels produits et √† quelle fr√©quence ils regardent / ajoutent au panier avec les donn√©es. </p><br><p>  Nous nous concentrerons sur la deuxi√®me m√©thode. </p><br><h3>  Donn√©es pour le mod√®le Prod2Vec </h3><br><p>  Voyons d'abord quelles donn√©es nous utilisons.  Nous avons √† notre disposition tous les clics des utilisateurs sur le site, ils peuvent √™tre divis√©s en sessions utilisateurs - s√©quences de clics avec des intervalles ne d√©passant pas 30 minutes entre les clics adjacents.  Pour former le mod√®le, nous utilisons des donn√©es d'environ 100 millions de sessions utilisateur, dans chacune desquelles nous ne sommes int√©ress√©s que par la visualisation et l'ajout de produits au panier. </p><br><p>  Un exemple d'une vraie session utilisateur: </p><br><img src="https://habrastorage.org/webt/q5/ov/fe/q5ovfeg-qfqarxgzxyzcfq5vssk.png" alt="image"><br><p>  Chaque produit de la session correspond √† son contexte - tous les produits que l'utilisateur a ajout√©s au panier dans cette session, ainsi que les produits qui sont visualis√©s avec cela.  Le mod√®le prod2vec est bas√© sur l'hypoth√®se que les produits similaires ont le plus souvent des contextes similaires. </p><br><p>  Par exemple: </p><br><img src="https://habrastorage.org/webt/ch/_m/tp/ch_mtpiawhaak2ddrks2pjxvgae.png" alt="image"><br><p>  Ainsi, si l'hypoth√®se est vraie, alors, par exemple, les cas pour le m√™me mod√®le de t√©l√©phone auront des contextes similaires (le m√™me t√©l√©phone).  Nous testerons cette hypoth√®se en construisant des vecteurs produits. </p><br><h3>  Mod√®le Prod2Vec </h3><br><p>  Lorsque nous avons introduit les concepts d'un produit et son contexte, nous d√©crivons le mod√®le lui-m√™me.  Il s'agit d'un r√©seau neuronal avec deux couches enti√®rement connect√©es.  Le nombre d'entr√©es de la premi√®re couche est √©gal au nombre de produits pour lesquels nous voulons construire des vecteurs.  Chaque produit √† l'entr√©e sera encod√© par un vecteur de z√©ros avec une seule unit√© - la place de ce produit dans le dictionnaire. </p><br><p>  Le nombre de neurones en sortie de la premi√®re couche est √©gal √† la dimension des vecteurs que nous voulons obtenir, par exemple 64. En sortie de la derni√®re couche, l√† encore, il y a un nombre de neurones √©gal au nombre de marchandises. </p><br><img src="https://habrastorage.org/webt/nf/0i/bf/nf0ibftkdqs3bkun8jn_qkwodfo.jpeg" alt="image"><br><br><p>  Nous formerons le mod√®le pour pr√©dire le contexte, connaissant le produit.  Cette architecture est appel√©e Skip-gram (son alternative est CBOW, o√π nous pr√©disons le produit en fonction de son contexte).  Pendant la formation, les marchandises sont livr√©es √† l'entr√©e, les marchandises devraient √™tre sorties de leur contexte (un vecteur de z√©ros avec une unit√© √† l'endroit correspondant). </p><br><p>  Il s'agit essentiellement d'une classification multiclasse et la perte d'entropie crois√©e peut √™tre utilis√©e pour entra√Æner le mod√®le.  Pour une paire mot-mot du contexte, il s'√©crit comme suit: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2">L</span><span class="MJXp-mo" id="MJXp-Span-3" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-4" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-5"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-7" style="vertical-align: -0.4em;">c</span></span><span class="MJXp-mo" id="MJXp-Span-8" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-9">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12">g</span><span class="MJXp-mtext" id="MJXp-Span-13">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15">u</span><span class="MJXp-msubsup" id="MJXp-Span-16"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-17" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22">V</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-18"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19">i</span><span class="MJXp-mo" id="MJXp-Span-20">=</span><span class="MJXp-mn" id="MJXp-Span-21">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25">p</span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-29" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.263ex" height="3.142ex" viewBox="0 -935.7 13030 1352.7" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-3D" x="959" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-2212" x="2015" y="0"></use><g transform="translate(2794,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-63" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-2B" x="3926" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6C" x="5177" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6F" x="5475" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-67" x="5961" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-73" x="6691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-75" x="7161" y="0"></use><g transform="translate(7733,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-56" x="1242" y="510"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-65" x="9860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-78" x="10327" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-70" x="10899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-28" x="11403" y="0"></use><g transform="translate(11792,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-69" x="712" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-29" x="12640" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> L = -p_c + \ log \ sum_ {i = 1} ^ V exp (p_i) </script></p><br><p>  o√π <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-31"><span class="MJXp-msubsup" id="MJXp-Span-32"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-34" style="vertical-align: -0.4em;">c</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.203ex" height="1.817ex" viewBox="-38.5 -520.7 948.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-63" x="712" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> p_c </script>  - pr√©diction du r√©seau du produit √† partir du contexte, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36">V</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.787ex" height="2.057ex" viewBox="0 -780.1 769.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-56" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> V </script>  - le nombre total de marchandises <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-37"><span class="MJXp-msubsup" id="MJXp-Span-38"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-40" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.059ex" height="1.817ex" viewBox="-38.5 -520.7 886.3 782.1" role="img" focusable="false" style="vertical-align: -0.607ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-69" x="712" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> p_i </script>  - pr√©diction r√©seau pour le produit <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-41"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.937ex" viewBox="0 -728.2 345.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-69" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> i </script>  . </p><br><p>  Apr√®s avoir entra√Æn√© le mod√®le, nous pouvons jeter la deuxi√®me couche - elle ne sera pas n√©cessaire pour obtenir des vecteurs.  La matrice des poids de la premi√®re couche (taille du nombre de marchandises x 64) est un dictionnaire de vecteurs de marchandises.  Chaque produit correspond √† une ligne d'une matrice de longueur 64 - c'est le vecteur correspondant au produit, qui peut √™tre utilis√© dans d'autres algorithmes. </p><br><p>  Mais cette proc√©dure ne fonctionne pas pour un grand nombre de produits.  Et nous en avons, rappelons-le, un million et demi. </p><br><p>  Pourquoi Prod2Vec ne fonctionne pas </p><br><p>  - La fonction de perte contient de nombreuses op√©rations de prise de l'exposant - il s'agit d'un calcul long et instable. <br>  - En cons√©quence, les gradients sont pris en compte pour tous les poids du r√©seau - et il peut y en avoir des dizaines de millions. </p><br><p>  Pour r√©soudre ces probl√®mes, la m√©thode d'√©chantillonnage n√©gatif est appropri√©e, en utilisant laquelle nous enseignons au r√©seau non seulement √† pr√©dire le contexte du produit, mais aussi √† ne pas pr√©dire les produits qui ne sont pas exactement dans le contexte.  Pour ce faire, nous devons g√©n√©rer des exemples n√©gatifs - pour chaque produit, s√©lectionnez ceux qui n'ont pas besoin d'√™tre pr√©dits pour lui.  Et ici, la disponibilit√© d'une √©norme quantit√© de marchandises nous aide.  Lors du choix d'une paire al√©atoire pour un produit, nous avons une tr√®s faible probabilit√© que ce soit un produit du contexte. </p><br><p>  Par cons√©quent, pour chaque produit dans le contexte, nous g√©n√©rons au hasard 5 √† 10 produits qui ne sont pas inclus dans le contexte.  De plus, les marchandises ne sont pas √©chantillonn√©es selon une distribution uniforme, mais proportionnellement √† la fr√©quence de leur occurrence. </p><br><p>  La fonction de perte est maintenant similaire √† celle utilis√©e dans la classification binaire.  Pour une paire mot-mot, du contexte, cela ressemble √† ceci: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44">L</span><span class="MJXp-mo" id="MJXp-Span-45" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-46" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-47">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-49">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50">g</span><span class="MJXp-mtext" id="MJXp-Span-51">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-52">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-53">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-54">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-56">a</span><span class="MJXp-mo" id="MJXp-Span-57" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-58"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59" style="margin-right: 0.05em;">u</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-64">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-60"><span class="MJXp-msubsup" id="MJXp-Span-61"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-63" style="vertical-align: -0.4em;">O</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-65"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-67" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-70" style="vertical-align: -0.4em;">I</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-72" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-73">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">u</span><span class="MJXp-msubsup" id="MJXp-Span-76"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-78" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-82">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-83">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">g</span><span class="MJXp-mtext" id="MJXp-Span-86">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-88">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-90">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">a</span><span class="MJXp-mo" id="MJXp-Span-92" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-93" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-94"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95" style="margin-right: 0.05em;">u</span><span class="MJXp-script-box" style="height: 2.132em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-100">T</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-96"><span class="MJXp-msubsup" id="MJXp-Span-97"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-98" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-99" style="vertical-align: -0.4em;">n</span></span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-101"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-103" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-104"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-106" style="vertical-align: -0.4em;">I</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="56.786ex" height="2.901ex" viewBox="0 -883.9 24449.5 1249" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-4C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-3D" x="959" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-2212" x="2015" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6C" x="3044" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6F" x="3342" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-67" x="3828" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-73" x="4558" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-69" x="5028" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-67" x="5373" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6D" x="5854" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-61" x="6732" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-28" x="7262" y="0"></use><g transform="translate(7651,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-54" x="809" y="488"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-4F" x="1013" y="-218"></use></g></g><g transform="translate(9283,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-76" x="0" y="0"></use><g transform="translate(485,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-49" x="1013" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-29" x="10698" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-2212" x="11309" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-73" x="12560" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-75" x="13030" y="0"></use><g transform="translate(13602,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6E" x="1013" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6C" x="15708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6F" x="16007" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-67" x="16492" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-73" x="17223" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-69" x="17692" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-67" x="18038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6D" x="18518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-61" x="19397" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-28" x="19926" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-2212" x="20316" y="0"></use><g transform="translate(21094,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-54" x="809" y="488"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6E" x="1013" y="-213"></use></g></g><g transform="translate(22644,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-76" x="0" y="0"></use><g transform="translate(485,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-49" x="1013" y="-213"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-29" x="24060" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> L = - \ log \ sigma (u_ {w_O} ^ T v_ {w_I}) - \ sum_ {w_n} \ log \ sigma (-u_ {w_n} ^ T v_ {w_I}) </script></p><br><p>  Dans ces notations <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-108"><span class="MJXp-msubsup" id="MJXp-Span-109"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-111" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-112"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-114" style="vertical-align: -0.4em;">O</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.79ex" height="2.057ex" viewBox="0 -520.7 1631.6 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-4F" x="1013" y="-218"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-7"> u_ {w_O} </script>  d√©signe une colonne de la matrice de poids de la deuxi√®me couche correspondant au produit du contexte, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-115"><span class="MJXp-msubsup" id="MJXp-Span-116"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117" style="margin-right: 0.05em;">u</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-118" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-119"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-120" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-121" style="vertical-align: -0.4em;">n</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.6ex" height="2.057ex" viewBox="0 -520.7 1550.1 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-75" x="0" y="0"></use><g transform="translate(572,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6E" x="1013" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-8"> u_ {w_n} </script>  - la m√™me chose pour un produit s√©lectionn√© au hasard, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-122"><span class="MJXp-msubsup" id="MJXp-Span-123"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124" style="margin-right: 0.05em;">v</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-125" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-128" style="vertical-align: -0.4em;">I</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.287ex" height="1.937ex" viewBox="0 -520.7 1415.1 834" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-76" x="0" y="0"></use><g transform="translate(485,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-49" x="1013" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-9"> v_ {w_I} </script>  - la ligne de la matrice de poids de la premi√®re couche correspondant au produit principal (c'est exactement le vecteur que nous construisons pour lui).  Fonction <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-129"><span class="MJXp-mtext" id="MJXp-Span-130">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-133">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-134">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">a</span><span class="MJXp-mo" id="MJXp-Span-136" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">x</span><span class="MJXp-mo" id="MJXp-Span-138" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-139" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-140">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">c</span><span class="MJXp-mrow" id="MJXp-Span-145"><span class="MJXp-mn" id="MJXp-Span-146">1</span></span><span class="MJXp-mrow" id="MJXp-Span-147"><span class="MJXp-mn" id="MJXp-Span-148">1</span><span class="MJXp-mo" id="MJXp-Span-149" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">p</span><span class="MJXp-mo" id="MJXp-Span-153" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mo" id="MJXp-Span-154" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">x</span><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.937ex" height="2.66ex" viewBox="0 -832 13750.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-61" x="2424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-28" x="2953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-78" x="3343" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-29" x="3915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-3D" x="4582" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-66" x="5889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-72" x="6439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-61" x="6891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-63" x="7420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-31" x="7854" y="0"></use><g transform="translate(8354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-31" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-2B" x="722" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-65" x="1723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-78" x="2189" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-70" x="2762" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-28" x="3265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-2212" x="3655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMATHI-78" x="4433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=https://habr.com/ru/company/ozontech/blog/432760/&amp;usg=ALkJrhhz9LPeA9jHrL2c_dS5c1ehV1Fp4w#MJMAIN-29" x="5006" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-10"> \ sigma (x) = \ frac {1} {1 + exp (-x)} </script>  . </p><br><p>  La diff√©rence avec la version pr√©c√©dente est que nous n'avons pas besoin de mettre √† jour tous les poids du r√©seau √† chaque it√©ration, nous avons seulement besoin de mettre √† jour ceux qui correspondent √† un petit nombre de produits (le premier produit est celui pour lequel nous pr√©disons, le reste est soit un produit de son contexte, soit s√©lectionn√© au hasard )  Dans le m√™me temps, nous nous sommes d√©barrass√©s d'un grand nombre de captures exponentielles √† chaque it√©ration. </p><br><p>  Une autre technique, qui √† son tour am√©liore la qualit√© du mod√®le r√©sultant, est le sous-√©chantillonnage.  Dans ce cas, nous prenons intentionnellement des biens moins fr√©quemment trouv√©s pour la formation afin d'obtenir le meilleur r√©sultat pour les biens rares. </p><br><h3>  R√©sultats </h3><br><h4>  Produits associ√©s </h4><br><p>  Nous avons donc appris √† obtenir des vecteurs pour les marchandises, nous devons maintenant v√©rifier l'ad√©quation et l'applicabilit√© de notre mod√®le. </p><br><p>  L'image suivante montre le produit et ses voisins les plus proches dans la mesure du cosinus de proximit√©. </p><br><img src="https://habrastorage.org/webt/n7/rp/ja/n7rpjaf-eyfsmq7mtmd6womojfw.jpeg" alt="image"><br><p>  Le r√©sultat semble bon, mais vous devez v√©rifier num√©riquement la qualit√© de notre mod√®le.  Pour ce faire, nous l'avons appliqu√© √† la t√¢che de recommandations de produits.  Pour chaque produit, nous avons recommand√© de venir dans un espace vectoriel construit.  Nous avons compar√© le mod√®le prod2vec avec un mod√®le beaucoup plus simple, bas√© sur des statistiques de vues conjointes et en ajoutant des articles au panier.  Pour chaque produit de la session, une liste de 7 recommandations a √©t√© prise.  La combinaison de tous les produits recommand√©s au cours de la session a √©t√© compar√©e √† ce qu'une personne a r√©ellement ajout√© au panier.  En utilisant prod2vec, dans plus de 40% des sessions, nous avons recommand√© au moins un produit, qui a ensuite √©t√© ajout√© au panier.  A titre de comparaison, un algorithme plus simple montre une qualit√© de 34%. </p><br><p>  La description vectorielle qui en r√©sulte nous permet non seulement de rechercher les plus proches (ce qui peut √™tre fait par un mod√®le plus simple, mais avec une qualit√© moindre).  Nous pouvons consid√©rer quels effets secondaires int√©ressants peuvent √™tre montr√©s en utilisant notre mod√®le. </p><br><h3>  Arithm√©tique vectorielle </h3><br><p>  Pour illustrer que les vecteurs portent la vraie signification des biens, nous pouvons essayer d'utiliser l'arithm√©tique vectorielle pour eux.  Comme dans l'exemple de manuel sur word2vec (roi - homme + femme = reine), par exemple, nous pouvons nous demander quel produit est approximativement √† la m√™me distance de l'imprimante que le sac √† poussi√®re de l'aspirateur.  Le bon sens veut qu'il s'agisse d'une sorte de consommable, √† savoir une cartouche.  Notre mod√®le est capable d'attraper de tels mod√®les: </p><br><img src="https://habrastorage.org/webt/m1/j5/ac/m1j5aca_jsyjupowx9yapcorpmo.png" alt="image"><br><br><h3>  Visualisation de l'espace produit </h3><br><p>  Pour mieux comprendre les r√©sultats, nous pouvons visualiser l'espace vectoriel des marchandises dans l'avion, en r√©duisant la dimension √† deux (dans cet exemple, nous avons utilis√© t-SNE). </p><br><img src="https://habrastorage.org/webt/_d/v8/m1/_dv8m1fmgufpknn_l1klly2wqwi.png" alt="image"><br><br>  On voit clairement que les produits connexes forment des grappes.  Par exemple, des grappes avec des textiles pour la chambre, des v√™tements masculins et f√©minins, des chaussures sont clairement visibles.  Encore une fois, nous notons que ce mod√®le est construit uniquement sur la base de l'historique des interactions des utilisateurs avec les biens; nous n'avons pas utilis√© la similitude des images ou des descriptions de texte lors de la formation. <br><p>  √Ä partir de l'illustration de l'espace, vous pouvez √©galement voir comment, √† l'aide du mod√®le, vous pouvez s√©lectionner des accessoires pour les marchandises.  Pour ce faire, vous devez prendre des marchandises du cluster le plus proche, par exemple, recommander des articles de sport pour les T-shirts et des casquettes pour les pulls chauds. </p><br><h3>  Plans </h3><br><p>  Nous introduisons maintenant le mod√®le prod2vec en production pour calculer les recommandations de produits.  De plus, les vecteurs obtenus peuvent √™tre utilis√©s comme fonctionnalit√©s pour d'autres algorithmes d'apprentissage automatique dans lesquels notre √©quipe est engag√©e (pr√©vision de la demande de produits, classement dans la recherche et les catalogues, recommandations personnelles). </p><br><p>  √Ä l'avenir, nous pr√©voyons de mettre en ≈ìuvre les int√©grations re√ßues sur le site en temps r√©el.  Pour toutes les marchandises vues, les prochaines seront dans la session, qui se refl√©teront instantan√©ment dans la livraison personnalis√©e.  Nous pr√©voyons √©galement d'int√©grer l'analyse d'images et l'analyse de similarit√© selon la description du vecteur dans notre mod√®le, ce qui am√©liorera consid√©rablement la qualit√© des vecteurs r√©sultants. </p><br><p>  Si vous savez comment le faire au mieux (ou le refaire) - venez visiter (et encore mieux travailler). </p><br><p>  <b>R√©f√©rences:</b> </p><br><ol><li>  Mikolov, Tomas et al.  "Repr√©sentations distribu√©es des mots et des phrases et leur compositionnalit√©."  Progr√®s dans les syst√®mes de traitement de l'information neuronale.  2013. </li><li>  Grbovic, Mihajlo et al.  "E-commerce dans votre bo√Æte de r√©ception: recommandations de produits √† grande √©chelle."  Actes de la 21e conf√©rence internationale ACM SIGKDD sur la d√©couverte des connaissances et l'exploration de donn√©es.  ACM, 2015. </li><li>  Grbovic, Mihajlo et Haibin Cheng.  "Personnalisation en temps r√©el √† l'aide des int√©grations pour le classement de recherche sur Airbnb."  Actes de la 24e conf√©rence internationale ACM SIGKDD sur la d√©couverte des connaissances et l'exploration de donn√©es.  ACM, 2018. </li></ol></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr432760/">https://habr.com/ru/post/fr432760/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr432748/index.html">Trucs et astuces Kubernetes: allocation de n≈ìuds et charges d'applications Web</a></li>
<li><a href="../fr432750/index.html">La joie d'Haxe. Un roman avec un langage de programmation n√©glig√©</a></li>
<li><a href="../fr432752/index.html">Colline de fourmis ou forteresse? Je construis une maison pour le prix d'un appartement. 3 parties. Alimentation</a></li>
<li><a href="../fr432754/index.html">Le stockage de donn√©es en m√©moire et sur disque rendra public</a></li>
<li><a href="../fr432756/index.html">Nous impl√©mentons la prise en charge de l'accessibilit√© sans modifier la composante visuelle de l'application mobile</a></li>
<li><a href="../fr432762/index.html">Le d√©tecteur de mensonge AI peut d√©tecter quand une personne ment</a></li>
<li><a href="../fr432764/index.html">UDB. Qu'est-ce que c'est?</a></li>
<li><a href="../fr432766/index.html">Comment encoder un message secret dans une empreinte digitale</a></li>
<li><a href="../fr432768/index.html">√âcouteurs sans fil pour les "marathons en s√©rie": dans Dolby, ils seront offerts pour 599 $</a></li>
<li><a href="../fr432770/index.html">Les botnets et leurs types: ce que l'on sait en 2018</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>