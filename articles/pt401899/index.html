<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üíÜüèª üëêüèæ üë®üèΩ‚Äç‚úàÔ∏è Logger multifuncional DIY. Parte 1 ü•ù ü§ôüèø ‚úãüèæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Eu sou o propriet√°rio de um dispositivo maravilhoso - o registrador GPS Holux M-241. A coisa √© muito conveniente e √∫til quando se viaja. Com a ajuda d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Logger multifuncional DIY. Parte 1</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/401899/"><img src="https://habrastorage.org/getpro/geektimes/post_images/65a/f4c/1c8/65af4c1c8bd4dd394b6a6d2939c6d211.jpg" alt="imagem"><br><br>  Eu sou o propriet√°rio de um dispositivo maravilhoso - o registrador GPS Holux M-241.  A coisa √© muito conveniente e √∫til quando se viaja.  Com a ajuda de um registrador, escrevo uma faixa de GPS de uma viagem, ao longo da qual voc√™ pode ver o seu caminho em detalhes, e tamb√©m anexo as fotos que voc√™ tira nas coordenadas de GPS.  Ele tamb√©m possui uma tela pequena que mostra informa√ß√µes adicionais - horas, velocidade atual, altitude e dire√ß√£o, od√¥metro e muito mais.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">Aqui</a> , escrevi uma vez uma breve resenha. <br><br>  Com todas as vantagens de um peda√ßo de ferro, comecei a crescer.  Sinto falta de alguns itens pequenos, mas √∫teis: alguns od√¥metros, mostrando velocidade vertical, medindo os par√¢metros de uma se√ß√£o de pista.  Parece pequenas coisas, mas a empresa Holux achou isso n√£o √∫til o suficiente para implementa√ß√£o no firmware.  Al√©m disso, n√£o gosto de alguns par√¢metros do hardware, e algumas coisas ficaram desatualizadas em 10 anos ... <br><br>  Em algum momento, percebi que eu pr√≥prio posso criar um logger com os recursos necess√°rios.  Felizmente, todos os componentes necess√°rios s√£o bastante baratos e acess√≠veis.  Comecei a fazer minha implementa√ß√£o baseada no Arduino.  Sob o corte, um di√°rio de constru√ß√£o onde tentei pintar minhas solu√ß√µes t√©cnicas. <br><a name="habracut"></a><br><h1>  Definindo recursos </h1><br>  Muitos perguntam por que eu preciso construir meu pr√≥prio logger, se com certeza h√° algo pronto para fabricantes eminentes.  Possivelmente.  Para ser sincero, n√£o procurei.  Mas com certeza haver√° algo faltando.  De qualquer forma, este projeto √© um f√£ para mim.  Por que n√£o come√ßamos a construir nosso dispositivo dos sonhos? <br><br>  Ent√£o, pelo que eu aprecio minha Holux M-241. <br><br><ul><li>  <b>A tela</b> cria uma "caixa preta", cujos resultados est√£o dispon√≠veis somente ap√≥s a viagem, uma ferramenta muito conveniente, cujas leituras est√£o dispon√≠veis aqui e agora.  Ter uma tela possibilita quase todos os recursos desta lista. </li><li>  <b>Um rel√≥gio</b> √© √∫til por si s√≥.  Nas viagens de GPS, o madeireiro pendurado em uma corda em volta do pesco√ßo geralmente fica mais perto do que um telefone celular no bolso ou em uma mochila.  O rel√≥gio suporta todos os fusos hor√°rios (embora com comuta√ß√£o manual) </li><li>  <b>O bot√£o POI</b> permite marcar a coordenada atual na pista.  Por exemplo, para observar um ponto de refer√™ncia que saiu da janela do √¥nibus, sobre o qual desejo pesquisar mais tarde. </li><li>  Usando o <b>od√¥metro,</b> voc√™ pode medir a dist√¢ncia percorrida a partir de algum ponto.  Por exemplo, a dist√¢ncia percorrida por dia ou o comprimento de uma pista. </li><li>  <b>A velocidade atual, altitude e dire√ß√£o</b> ajudam a encontrar-se no espa√ßo </li><li>  <b>A capacidade de sobreviv√™ncia de 12 a 14 horas</b> de uma bateria AA na maioria dos casos permite que voc√™ n√£o pense em problemas de fonte de alimenta√ß√£o.  I.e.  quase sempre cobrar o suficiente para um dia inteiro de viagem. </li><li>  <b>Compacto e f√°cil de usar</b> - as coisas no mundo moderno s√£o muito agrad√°veis </li></ul><br>  No entanto, algumas coisas poderiam ser feitas um pouco melhor: <br><br><ul><li>  O subsistema de energia das <b>baterias AA √©</b> anotado por muitos como uma vantagem definitiva - uma bateria dura muito tempo e voc√™ pode reabastecer o suprimento em qualquer regi√£o selvagem.  Voc√™ pode estocar pelo menos um m√™s de acampamento aut√¥nomo. <br><br>  Mas para mim, a vida da bateria √© pura hemorr√≥idas.  Voc√™ precisa carregar um punhado de baterias e quem sabe como elas s√£o de alta qualidade (repentinamente ficaram em uma prateleira por 5 anos e j√° se descarregavam).  Com as baterias, a hemorragia √© ainda maior.  Meu carregador s√≥ pode carregar em pares.  Temos que descarregar as baterias para que elas tenham o mesmo grau de descarga.  Como resultado, voc√™ nunca se lembra de onde j√° foi descarregado e de onde ainda n√£o. <br><br>  Por 6 anos usando o logger, acabei no deserto apenas sem eletricidade algumas vezes.  Como regra, tenho acesso √† tomada pelo menos uma vez por dia.  Nesse caso, a bateria de l√≠tio embutida seria muito mais conveniente.  Bem, em casos extremos, eu tenho um banco de paver. <br><br></li><li>  <b>A indica√ß√£o do grau de descarga √©</b> feita de maneira est√∫pida - o indicador come√ßa a piscar quando a bateria est√° prestes a descarregar.  Al√©m disso, ele pode morrer em 5 minutos e talvez funcionar mais uma hora.  √â muito f√°cil perder esse momento e perder parte do log. <br><br></li><li>  Como pessoa interessada em avia√ß√£o, seria muito interessante observar a <b>velocidade vertical atual</b> . <br><br></li><li>  <b>Alguns od√¥metros</b> - geralmente √© interessante medir mais de uma dist√¢ncia.  Por exemplo, a dist√¢ncia percorrida por dia e durante toda a viagem. <br><br></li><li>  O od√¥metro √© redefinido quando voc√™ desliga o dispositivo ou quando substitui a bateria.  Isso √© terrivelmente desconfort√°vel.  Se voc√™ parou para uma refei√ß√£o em um caf√©, o registrador GPS n√£o pode ser desligado porque o valor ser√° redefinido.  Ele precisa deix√°-lo ligado e continua a percorrer quil√¥metros e a comer a bateria.  Seria muito mais conveniente poder colocar o od√¥metro em <b>pausa</b> e <b>salvar os valores</b> entre inclus√µes. <br><br></li><li>  <b>Medi√ß√£o de par√¢metros do local</b> .  Ao esquiar, por exemplo, estou interessado no comprimento da descida, eleva√ß√£o, velocidade m√©dia e m√°xima no site, no tempo gasto.  O que voc√™ quer saber √© imediatamente, e n√£o em casa quando voc√™ baixa a faixa. <br><br></li><li>  <b>A precis√£o</b> √© fraca.  Quando voc√™ se move r√°pido - nada mais.  Mas quando a velocidade √© pequena na pista, ‚Äúbarulhos‚Äù + - 50m s√£o claramente vis√≠veis.  E por uma hora em p√©, voc√™ pode "insistir" quase um quil√¥metro.  Os benef√≠cios da tecnologia h√° 10 anos foram muito al√©m e os receptores modernos oferecem uma precis√£o muito maior. <br><br></li><li>  <b>A velocidade de fus√£o das</b> faixas √© de apenas 38.400. N√£o, bem, em 2017 n√£o √© s√©rio usar a porta COM para transferir grandes quantidades de dados.  A fus√£o de 2 megabytes de flash interno leva mais de 20 minutos. <br><br>  Al√©m disso, nem todo programa pode digerir o formato de faixas mescladas.  O utilit√°rio nativo √© muito miser√°vel.  Felizmente, existe o BT747, que pode mesclar adequadamente a faixa e convert√™-la em algum tipo de formato diger√≠vel. <br><br></li><li>  <b>O tamanho da unidade flash √© de</b> apenas 2 MB.  Por um lado, isso √© suficiente para uma viagem de duas semanas com pontos de economia a cada 5s.  Mas primeiro, o formato interno do pacote <br>  requer convers√£o e, em segundo lugar, n√£o permite aumentar o volume </li><li>  Por algum motivo, o <b>dispositivo de armazenamento em massa</b> n√£o est√° na moda.  Interfaces modernas tentam esconder o fato da presen√ßa de arquivos.  Estou com computadores h√° 25 anos e trabalhar com arquivos diretamente √© muito mais conveniente para mim do que de qualquer outra maneira. </li></ul><br>  N√£o h√° nada aqui que n√£o possa ser realizado sem esfor√ßos significativos. <br><br>  Qualquer coisa diferente.  Eu n√£o uso, mas de repente algu√©m √© √∫til: <br><br><ul><li>  Mostra coordenadas atuais (latitude, longitude) </li><li>  √çcones diferentes s√£o desenhados no lado esquerdo da tela, cuja ess√™ncia nem me lembro sem um manual. </li><li>  Existem comutadores metros / km - p√©s / milhas. </li><li>  O Bluetooth - logger pode ser conectado a telefones celulares sem GPS. </li><li>  A dist√¢ncia absoluta ao ponto. </li><li>  Registro por tempo (a cada N segundos) ou por dist√¢ncia (a cada X metros). </li><li>  Suporte para diferentes idiomas. </li></ul><br><h1>  Escolha ferro </h1><br>  Os requisitos s√£o mais ou menos definidos.  √â hora de entender como tudo isso pode ser implementado.  Os principais componentes que terei s√£o: <br><br><ul><li>  <b>Microcontrolador</b> - N√£o tenho planos para algoritmos computacionais sofisticados, portanto o poder de processamento do kernel n√£o √© particularmente importante.  Eu tamb√©m n√£o tenho requisitos especiais para o enchimento - um conjunto de perif√©ricos padr√£o servir√°. <br><br>  Havia apenas uma dispers√£o de arduinos diversos, al√©m de alguns stm32f103c8t6.  Decidi come√ßar com o AVR, que eu conhe√ßo bem no n√≠vel dos controladores / registros / perif√©ricos.  Se eu tiver restri√ß√µes - haver√° um motivo para sentir o STM32. <br><br></li><li>  <b>O receptor GPS foi</b> selecionado entre os m√≥dulos NEO6MV2, Beitan BN-800 e Beitan BN-880.  F√≥runs pesquisados ‚Äã‚Äãpor algum tempo.  Pessoas experientes disseram que o primeiro receptor √© o s√©culo passado.  Os outros dois diferem um do outro apenas na localiza√ß√£o da antena - no BN-800 ele fica pendurado no fio e no BN-880 √© colado com um sandu√≠che no m√≥dulo principal.  Tomou um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">BN-880</a> . <br><br></li><li>  <b>Tela</b> - o original usa um LCD de 128 x 32 com luz de fundo.  N√£o encontrei exatamente o mesmo.  Comprei um <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">OLED 0,91 ‚Äùno controlador SSD1306</a> e uma <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">tela LCD de 1,2‚Äù no controlador ST7565R</a> .  Eu decidi come√ßar do primeiro, porque  √© mais f√°cil conectar-se a um pente padr√£o de acordo com I2C ou SPI.  Mas √© um pouco menor em compara√ß√£o com o original e tamb√©m n√£o funcionar√° para exibir constantemente a imagem por raz√µes de efici√™ncia de combust√≠vel.  O segundo monitor deve ser menos guloso, mas voc√™ precisa soldar um conector complicado e descobrir como alimentar a luz de fundo. </li></ul><br>  Das pequenas coisas: <br><br><ul><li>  Bot√µes j√° compraram uma sacola inteira; </li><li>  Blindagem com cart√£o SD - tamb√©m √† m√£o; </li><li>  Comprei um par de controladores de carga diferentes para baterias de l√≠tio, mas ainda n√£o o entendi. </li></ul><br>  Decidi projetar a placa no final, quando o firmware estiver pronto.  A essa altura, finalmente decidirei sobre os principais componentes e o esquema para sua inclus√£o.  No primeiro est√°gio, decidi fazer a depura√ß√£o na placa de ensaio conectando os componentes usando cabos de manobra. <br><br>  Mas primeiro voc√™ precisa decidir sobre uma quest√£o muito importante - a nutri√ß√£o dos componentes.  Pareceu-me razo√°vel alimentar tudo de 3.3V: GPS e a tela apenas nele e saber trabalhar.  Essa tamb√©m √© a voltagem nativa para USB e SD.  Al√©m disso, o circuito pode ser alimentado por uma lata de l√≠tio. <br><br>  A escolha recaiu sobre o Arduino Pro Mini, que pode ser encontrado na vers√£o 8MHz / 3.3V.  Mas ela n√£o tinha USB a bordo - tive que usar um adaptador USB-UART. <br><br><h1>  Primeiros passos </h1><br>  Inicialmente, o projeto foi criado no Arduino IDE.  Mas, para ser sincero, meu idioma n√£o ousa cham√°-lo de IDE - como um editor de texto com um compilador.  De qualquer forma, depois do Visual Studio, no qual trabalho nos √∫ltimos 13 anos, n√£o posso fazer nada s√©rio no IDE do Arduino sem l√°grimas e matyuk. <br><br>  Felizmente, existe um Atmel Studio gratuito, no qual at√© o Visual Assist √© embutido imediatamente!  O programa sabe tudo o que √© necess√°rio, tudo √© familiar e em seu lugar.  Bem, quase tudo (n√£o encontrei como compilar apenas um arquivo, por exemplo, para verificar a sintaxe) <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/bfc/b08/98f/bfcb0898f136628896be3b6769eda34f.png" alt="imagem"><br><br>  Iniciado na tela - √© necess√°rio depurar o esqueleto do firmware e preench√™-lo com funcionalidade.  Ele parou na <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">primeira biblioteca dispon√≠vel para o Adafruit SSD1306</a> .  Ela sabe tudo o que √© necess√°rio e fornece uma interface muito simples. <br><br>  Jogado com fontes.  Verificou-se que uma fonte pode levar at√© 8kb (o tamanho das letras √© 24pt) - voc√™ n√£o pode usar um controlador de 32kb em especial.  Fontes grandes s√£o necess√°rias, por exemplo, para exibir o tempo. <br><br><div class="spoiler">  <b class="spoiler_title">C√≥digo de amostra da fonte</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;Adafruit_GFX.h&gt; #include &lt;Adafruit_SSD1306.h&gt; #include &lt;gfxfont.h&gt; #include &lt;fonts/FreeMono12pt7b.h&gt; #include &lt;fonts/FreeMono18pt7b.h&gt; ... #include &lt;fonts/FreeSerifItalic24pt7b.h&gt; #include &lt;fonts/FreeSerifItalic9pt7b.h&gt; #include &lt;fonts/TomThumb.h&gt; struct font_and_name { const char * PROGMEM name; GFXfont * font; }; #define FONT(name) {#name, &amp;name} const font_and_name fonts[] = { // FONT(FreeMono12pt7b), FONT(FreeMono18pt7b), /* FONT(FreeMono24pt7b), FONT(FreeMono9pt7b), FONT(FreeMonoBold12pt7b), ... FONT(FreeSerifItalic9pt7b), FONT(TomThumb)*/ }; const unsigned int fonts_count = sizeof(fonts) / sizeof(font_and_name); unsigned int current_font = 0; extern Adafruit_SSD1306 display; void RunFontTest() { display.clearDisplay(); display.setCursor(0,30); display.setFont(fonts[current_font].font); display.print("12:34:56"); display.setCursor(0,6); display.setFont(&amp;TomThumb); display.print(fonts[current_font].name); display.display(); } void SwitchToNextFont() { current_font = ++current_font % fonts_count; }</span></span></span></span></code> </pre> <br></div></div><br>  As fontes completas com a biblioteca s√£o muito desajeitadas.  A fonte monoespa√ßada mostrou-se muito ampla - a linha "12:34:56" n√£o se encaixa, Serif - todos os n√∫meros t√™m pesos diferentes.  A menos que a fonte 5x7 padr√£o da biblioteca pare√ßa comest√≠vel. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/b7a/67f/676/b7a67f676d061bdb4920985b0c46692a.jpg" alt="imagem"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/9de/e19/69f/9dee1969f16ad50138756b9dab906d4d.jpg" alt="imagem"><br><br>  Aconteceu que essas fontes foram convertidas de algumas fontes ttf de c√≥digo aberto que simplesmente n√£o s√£o otimizadas para pequenas resolu√ß√µes. <br><br>  Eu tive que desenhar minhas fontes.  Mais precisamente, primeiro, desenterre s√≠mbolos individuais dos acabados.  O s√≠mbolo ':' na tabela ASCII √© muito √∫til logo ap√≥s os n√∫meros e pode ser comprado em um bloco.  Tamb√©m √© conveniente que voc√™ possa criar uma fonte n√£o para todos os caracteres, mas apenas para um intervalo, por exemplo, de 0x30 ('0') a 0x3a (':').  T.O.  do FreeSans18pt7b, acabou produzindo uma fonte muito compacta apenas para os caracteres necess√°rios.  √â verdade que tive que ajustar levemente a largura para que o texto caiba na largura da tela. <br><br><div class="spoiler">  <b class="spoiler_title">Sub-fonte FreeSans18pt7b</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// This font consists only of digits and ':' to display current time. // The font is very based on FreeSans18pt7b.h //</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">TODO:</span></span></span><span class="hljs-comment"> 25 pixel height is too much for displaying time. Create another 22px font const uint8_t TimeFontBitmaps[] PROGMEM = { /* 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xE9, 0x20, 0x3F, 0xFC, 0xE3, 0xF1, 0xF8, 0xFC, 0x7E, 0x3F, 0x1F, 0x8E, 0x82, 0x41, 0x00, 0x01, 0xC3, 0x80, ... 0x03, 0x00, 0xC0, 0x60, 0x18, 0x06, 0x03, 0x00, 0xC0, 0x30, 0x18, 0x06, 0x01, 0x80, 0xC0, 0x30, 0x00, */0x07, 0xE0, 0x0F, 0xF8, 0x1F, 0xFC, 0x3C, 0x3C, 0x78, 0x1E, 0x70, 0x0E, 0x70, 0x0E, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x0F, 0x70, 0x0E, 0x70, 0x0E, 0x78, 0x1E, 0x3C, 0x3C, 0x1F, 0xF8, 0x1F, 0xF0, 0x07, 0xE0, 0x03, 0x03, 0x07, 0x0F, 0x3F, 0xFF, 0xFF, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0xE0, 0x1F, 0xF8, 0x3F, 0xFC, 0x7C, 0x3E, 0x70, 0x0F, 0xF0, 0x0F, 0xE0, 0x07, 0xE0, 0x07, 0x00, 0x07, 0x00, 0x07, 0x00, 0x0F, 0x00, 0x1E, 0x00, 0x3C, 0x00, 0xF8, 0x03, 0xF0, 0x07, 0xC0, 0x1F, 0x00, 0x3C, 0x00, 0x38, 0x00, 0x70, 0x00, 0x60, 0x00, 0xE0, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x07, 0xF0, 0x07, 0xFE, 0x07, 0xFF, 0x87, 0x83, 0xC3, 0x80, 0xF3, 0x80, 0x39, 0xC0, 0x1C, 0xE0, 0x0E, 0x00, 0x07, 0x00, 0x0F, 0x00, 0x7F, 0x00, 0x3F, 0x00, 0x1F, 0xE0, 0x00, 0x78, 0x00, 0x1E, 0x00, 0x07, 0x00, 0x03, 0xF0, 0x01, 0xF8, 0x00, 0xFE, 0x00, 0x77, 0x00, 0x73, 0xE0, 0xF8, 0xFF, 0xF8, 0x3F, 0xF8, 0x07, 0xF0, 0x00, 0x00, 0x38, 0x00, 0x38, 0x00, 0x78, 0x00, 0xF8, 0x00, 0xF8, 0x01, 0xF8, 0x03, 0xB8, 0x03, 0x38, 0x07, 0x38, 0x0E, 0x38, 0x1C, 0x38, 0x18, 0x38, 0x38, 0x38, 0x70, 0x38, 0x60, 0x38, 0xE0, 0x38, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x38, 0x00, 0x38, 0x00, 0x38, 0x00, 0x38, 0x00, 0x38, 0x00, 0x38, 0x1F, 0xFF, 0x0F, 0xFF, 0x8F, 0xFF, 0xC7, 0x00, 0x03, 0x80, 0x01, 0xC0, 0x00, 0xE0, 0x00, 0x70, 0x00, 0x39, 0xF0, 0x3F, 0xFE, 0x1F, 0xFF, 0x8F, 0x83, 0xE7, 0x00, 0xF0, 0x00, 0x3C, 0x00, 0x0E, 0x00, 0x07, 0x00, 0x03, 0x80, 0x01, 0xC0, 0x00, 0xFC, 0x00, 0xEF, 0x00, 0x73, 0xC0, 0xF0, 0xFF, 0xF8, 0x3F, 0xF8, 0x07, 0xE0, 0x00, 0x03, 0xE0, 0x0F, 0xF8, 0x1F, 0xFC, 0x3C, 0x1E, 0x38, 0x0E, 0x70, 0x0E, 0x70, 0x00, 0x60, 0x00, 0xE0, 0x00, 0xE3, 0xE0, 0xEF, 0xF8, 0xFF, 0xFC, 0xFC, 0x3E, 0xF0, 0x0E, 0xF0, 0x0F, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x07, 0x60, 0x07, 0x70, 0x0F, 0x70, 0x0E, 0x3C, 0x3E, 0x3F, 0xFC, 0x1F, 0xF8, 0x07, 0xE0, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x00, 0x06, 0x00, 0x0E, 0x00, 0x1C, 0x00, 0x18, 0x00, 0x38, 0x00, 0x70, 0x00, 0x60, 0x00, 0xE0, 0x00, 0xC0, 0x01, 0xC0, 0x01, 0x80, 0x03, 0x80, 0x03, 0x80, 0x07, 0x00, 0x07, 0x00, 0x07, 0x00, 0x0E, 0x00, 0x0E, 0x00, 0x0E, 0x00, 0x0C, 0x00, 0x1C, 0x00, 0x1C, 0x00, 0x07, 0xF0, 0x0F, 0xFE, 0x0F, 0xFF, 0x87, 0x83, 0xC7, 0x80, 0xF3, 0x80, 0x39, 0xC0, 0x1C, 0xE0, 0x0E, 0x78, 0x0F, 0x1E, 0x0F, 0x07, 0xFF, 0x01, 0xFF, 0x03, 0xFF, 0xE3, 0xE0, 0xF9, 0xC0, 0x1D, 0xC0, 0x0F, 0xE0, 0x03, 0xF0, 0x01, 0xF8, 0x00, 0xFC, 0x00, 0xF7, 0x00, 0x73, 0xE0, 0xF8, 0xFF, 0xF8, 0x3F, 0xF8, 0x07, 0xF0, 0x00, 0x07, 0xE0, 0x1F, 0xF8, 0x3F, 0xFC, 0x7C, 0x3C, 0x70, 0x0E, 0xF0, 0x0E, 0xE0, 0x06, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x07, 0xE0, 0x0F, 0x70, 0x0F, 0x78, 0x3F, 0x3F, 0xFF, 0x1F, 0xF7, 0x07, 0xC7, 0x00, 0x07, 0x00, 0x06, 0x00, 0x0E, 0x70, 0x0E, 0x70, 0x1C, 0x78, 0x3C, 0x3F, 0xF8, 0x1F, 0xF0, 0x07, 0xC0, 0xFF, 0xF0, 0x00, 0x00, 0x00, 0x07, 0xFF, 0x80 /*, 0xFF, 0xF0, 0x00, 0x00, 0x00, 0x07, 0xFF, 0xB6, 0xD6, 0x00, 0x00, 0x80, 0x03, 0xC0, 0x07, 0xE0, 0x0F, 0xC0, 0x3F, 0x80, 0x7E, 0x00, 0xFC, 0x01, 0xF0, 0x00, 0xE0, 0x00, ... 0x38, 0x38, 0xF8, 0xF0, 0xE0, 0x38, 0x00, 0xFC, 0x03, 0xFC, 0x1F, 0x3E, 0x3C, 0x1F, 0xE0, 0x1F, 0x80, 0x1E, 0x00 */ }; //TODO Recalc offset numbers const GFXglyph TimeFontGlyphs[] PROGMEM = { { 449-449, 16, 25, 19, 2, -24 }, // 0x30 '0' { 499-449, 8, 25, 19, 4, -24 }, // 0x31 '1' { 524-449, 16, 25, 19, 2, -24 }, // 0x32 '2' { 574-449, 17, 25, 19, 1, -24 }, // 0x33 '3' { 628-449, 16, 25, 19, 1, -24 }, // 0x34 '4' { 678-449, 17, 25, 19, 1, -24 }, // 0x35 '5' { 732-449, 16, 25, 19, 2, -24 }, // 0x36 '6' { 782-449, 16, 25, 19, 2, -24 }, // 0x37 '7' { 832-449, 17, 25, 19, 1, -24 }, // 0x38 '8' { 886-449, 16, 25, 19, 1, -24 }, // 0x39 '9' { 936-449, 3, 19, 7, 2, -20 }, // 0x3A ':' }; const GFXfont TimeFont PROGMEM = { (uint8_t *)TimeFontBitmaps, (GFXglyph *)TimeFontGlyphs, 0x30, 0x3A, 20 };</span></span></code> </pre> </div></div><br>  Descobriu-se que a fonte 18pt tem 25 pixels de altura.  Por isso, ele se encaixa levemente em outra inscri√ß√£o <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/543/aee/2e5/543aee2e5c6515307a4c969a3bfff374.jpg" alt="imagem"><br><br>  A exibi√ß√£o invertida, a prop√≥sito, ajuda a entender onde est√£o os limites da √°rea de desenho e como a linha se encontra em rela√ß√£o a essa borda - a exibi√ß√£o possui quadros muito grandes. <br><br>  Por um longo tempo, pesquisei fontes acabadas no Google, mas elas n√£o se encaixavam no tamanho, na forma ou no conte√∫do.  Por exemplo, na Internet, um eixo de fonte 8x12 (despejos de geradores de caracteres de placa VGA).  Mas, de fato, essas fontes s√£o 6x8, ou seja,  muito espa√ßo caminha - no caso de uma resolu√ß√£o e tamanho t√£o pequenos quanto os meus, √© fundamental. <br><br>  Eu tive que desenhar minhas pr√≥prias fontes, j√° que o formato da biblioteca Adafruit √© muito simples.  Preparei a imagem no Paint.net - simplesmente desenhei as letras na fonte correta e as corrigi um pouco com um l√°pis.  Salvei a imagem como png e enviei-a rapidamente para o script python escrito no meu joelho.  Esse script gerou um c√≥digo semi-acabado que j√° governa de maneira correta no IDE, diretamente nos c√≥digos hexadecimais. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/618/78f/f7e/61878ff7eff21be033fdbc56183a4f5e.png" alt="imagem"><br><br>  Por exemplo, √© assim que o processo de cria√ß√£o de uma fonte monoespa√ßada 8x12 com espa√ßamento entre letras e linhas pequenas.  No final, cada caractere era de aproximadamente 7x10 e, por padr√£o, ocupava 10 bytes.  Seria poss√≠vel compactar cada caractere em 8 a 9 bytes (a biblioteca permite isso), mas eu n√£o me incomodei.  Al√©m disso, neste formul√°rio, voc√™ pode editar pixels individuais diretamente no c√≥digo. <br><br><div class="spoiler">  <b class="spoiler_title">Fonte 8x12</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// A simple 8x12 font (slightly modifier Courier New) const uint8_t Monospace8x12Bitmaps[] PROGMEM = { 0x1e, 0x21, 0x21, 0x21, 0x21, 0x21, 0x21, 0x21, 0x21, 0x1e, //0 0x18, 0x68, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x7f, //1 0x3e, 0x41, 0x41, 0x01, 0x02, 0x0c, 0x10, 0x20, 0x41, 0x7f, //2 0x3e, 0x41, 0x01, 0x01, 0x0e, 0x02, 0x01, 0x01, 0x41, 0x3e, //3 0x02, 0x06, 0x0a, 0x12, 0x12, 0x22, 0x3f, 0x02, 0x02, 0x0f, //4 0x7f, 0x41, 0x40, 0x40, 0x7e, 0x01, 0x01, 0x01, 0x41, 0x3e, //5 0x1e, 0x21, 0x40, 0x40, 0x5e, 0x61, 0x41, 0x41, 0x41, 0x3e, //6 0x7f, 0x41, 0x01, 0x02, 0x02, 0x04, 0x04, 0x04, 0x08, 0x08, //7 0x1e, 0x21, 0x21, 0x21, 0x1e, 0x21, 0x21, 0x21, 0x21, 0x1e, //8 0x1e, 0x21, 0x21, 0x21, 0x23, 0x1d, 0x01, 0x01, 0x22, 0x1c, //9 0x00, 0x00, 0x18, 0x18, 0x00, 0x00, 0x00, 0x18, 0x18, 0x00, //: }; const GFXglyph Monospace8x12Glyphs[] PROGMEM = { { 0, 8, 10, 8, 0, -11 }, // 0x30 '0' { 10, 8, 10, 8, 0, -11 }, // 0x31 '1' { 20, 8, 10, 8, 0, -11 }, // 0x32 '2' { 30, 8, 10, 8, 0, -11 }, // 0x33 '3' { 40, 8, 10, 8, 0, -11 }, // 0x34 '4' { 50, 8, 10, 8, 0, -11 }, // 0x35 '5' { 60, 8, 10, 8, 0, -11 }, // 0x36 '6' { 70, 8, 10, 8, 0, -11 }, // 0x37 '7' { 80, 8, 10, 8, 0, -11 }, // 0x38 '8' { 90, 8, 10, 8, 0, -11 }, // 0x39 '9' { 100, 8, 10, 8, 0, -11 }, // 0x3A ':' }; const GFXfont Monospace8x12Font PROGMEM = { (uint8_t *)Monospace8x12Bitmaps, (GFXglyph *)Monospace8x12Glyphs, 0x30, 0x3A, 12 };</span></span></code> </pre><br></div></div><br><h1>  Moldura </h1><br>  O dispositivo original fornece uma interface muito simples e conveniente.  As informa√ß√µes s√£o agrupadas em categorias que s√£o exibidas em p√°ginas individuais (telas).  Usando o bot√£o, voc√™ pode percorrer as p√°ginas e usar o segundo bot√£o para selecionar o item atual ou executar a a√ß√£o indicada na assinatura abaixo do bot√£o.  Essa abordagem me parece muito conveniente e n√£o h√° necessidade de alterar nada. <br><br>  Gosto da beleza do POO, porque imediatamente ofuscou uma pequena interface, cada p√°gina implementa a interface conforme necess√°rio.  A p√°gina sabe como se desenhar e implementa a rea√ß√£o aos bot√µes. <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Screen</span></span></span><span class="hljs-class"> {</span></span> Screen * nextScreen; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: Screen(); <span class="hljs-keyword"><span class="hljs-keyword">virtual</span></span> ~Screen() {} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>= <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">drawHeader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSelButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onOkButton</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> PROGMEM </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getSelButtonText</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> PROGMEM </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">char</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getOkButtonText</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">Screen * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Screen * screen)</span></span></span></span>; };</code> </pre> <br>  Os bot√µes podem executar v√°rias a√ß√µes, dependendo da tela atual.  Portanto, na parte superior da tela, com uma altura de 8 pixels, atribuai aos r√≥tulos dos bot√µes.  O texto para as assinaturas depende da tela atual e √© retornado pelas fun√ß√µes virtuais getSelButtonText () e getOkButtonText ().  Tamb√©m no cabe√ßalho, itens de servi√ßo, como for√ßa do sinal GPS e carga da bateria, ainda ser√£o exibidos.  As restantes ¬æ telas est√£o dispon√≠veis para informa√ß√µes √∫teis. <br><br>  Como eu disse, as telas podem ser viradas, o que significa que em algum lugar deve haver uma lista de objetos para p√°ginas diferentes.  No que mais de uma tela pode ser aninhada, como um submenu.  At√© comecei a classe ScreenManager, que deveria gerenciar essas listas, mas achei a solu√ß√£o mais f√°cil. <br><br>  Portanto, cada tela simplesmente tem um ponteiro para a pr√≥xima.  Se a tela permitir que voc√™ entre no submenu, ele adicionar√° mais um ponteiro √† tela deste submenu <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Screen</span></span></span><span class="hljs-class"> {</span></span> Screen * nextScreen; ‚Ä¶ }; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ParentScreen</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Screen { Screen * childScreen; ‚Ä¶ };</code> </pre> <br>  Por padr√£o, o manipulador de bot√£o simplesmente chama a fun√ß√£o de mudan√ßa de tela, passando o ponteiro desejado.  A fun√ß√£o acabou sendo trivial - apenas mudou o ponteiro para a tela atual.  Para garantir o aninhamento das telas, fiz uma pequena pilha.  Assim, o gerenciador de tela inteiro se encaixa em 25 linhas e 4 pequenas fun√ß√µes. <br><br><pre> <code class="cpp hljs">Screen * screenStack[<span class="hljs-number"><span class="hljs-number">3</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> screenIdx = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setCurrentScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Screen * screen)</span></span></span><span class="hljs-function"> </span></span>{ screenStack[screenIdx] = screen; } <span class="hljs-function"><span class="hljs-function">Screen * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getCurrentScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> screenStack[screenIdx]; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">enterChildScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Screen * screen)</span></span></span><span class="hljs-function"> </span></span>{ screenIdx++; <span class="hljs-comment"><span class="hljs-comment">//TODO limit this screenStack[screenIdx] = screen; } void backToParentScreen() { if(screenIdx) screenIdx--; }</span></span></code> </pre> <br>  √â verdade que o c√≥digo para preencher essas estruturas n√£o parece muito bom, mas at√© agora n√£o foi melhor inventado. <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-function">Screen * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createCurrentTimeScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ TimeZoneScreen * tzScreen = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TimeZoneScreen(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>); tzScreen = tzScreen-&gt;addScreen(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TimeZoneScreen(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">45</span></span>)); tzScreen = tzScreen-&gt;addScreen(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TimeZoneScreen(<span class="hljs-number"><span class="hljs-number">-3</span></span>, <span class="hljs-number"><span class="hljs-number">30</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// TODO Add real timezones here CurrentTimeScreen * screen = new CurrentTimeScreen(); screen-&gt;addChildScreen(tzScreen); return screen; }</span></span></code> </pre> <br><div class="spoiler">  <b class="spoiler_title">O pensamento</b> <div class="spoiler_text">  Estruturar, √© claro, ficou bonito, mas receio que consuma muita mem√≥ria.  Voc√™ tem que ir contra si mesmo e zafigachit uma grande mesa est√°tica com ponteiros. <br></div></div><br>  V√° em frente.  Na minha implementa√ß√£o da interface, eu queria fazer algo como uma caixa de mensagem, uma mensagem curta que apareceria por um segundo ou dois e depois desapareceria.  Por exemplo, se voc√™ pressionar o bot√£o POI (Ponto de interesse) na tela com as coordenadas atuais, al√©m de escrever o ponto na faixa, seria bom mostrar ao usu√°rio a mensagem "Waypoint salvo" (no dispositivo original, um √≠cone adicional √© exibido apenas por um segundo).  Ou, quando a bateria estiver fraca, "anime" o usu√°rio com uma mensagem. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/aa5/dec/17b/aa5dec17b1b4b298b764fce33b8441db.jpg" alt="imagem"><br><br>  Como os dados do GPS vir√£o constantemente, n√£o se pode falar em nenhuma fun√ß√£o de bloqueio.  Portanto, tive que inventar uma m√°quina de estado simples (m√°quina de estado), que na fun√ß√£o loop () escolheria o que fazer - mostrar a tela ou caixa de mensagem atual. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> State { IDLE_DISPLAY_OFF, IDLE, MESSAGE_BOX, BUTTON_PRESSED, };</code> </pre> <br>  Tamb√©m √© conveniente manipular pressionamentos de bot√£o usando a m√°quina de estado.  Talvez fosse correto atrav√©s de interrup√ß√µes, mas acabou bem tamb√©m.  Funciona assim: se um bot√£o foi pressionado no estado IDLE, lembre-se da hora em que foi pressionado e v√° para o estado BUTTON_PRESSED.  Nesse estado, esperamos at√© o usu√°rio soltar o bot√£o.  Aqui podemos calcular a dura√ß√£o quando o bot√£o foi pressionado.  Respostas curtas (&lt;30 ms) s√£o simplesmente ignoradas - provavelmente isso √© uma rejei√ß√£o dos contatos.  Viagens longas j√° podem ser interpretadas como pressionar um bot√£o. <br><br>  Eu pretendo usar os pressionamentos breves dos bot√µes para a√ß√µes comuns e o longo (&gt; 1c) para fun√ß√µes especiais.  Por exemplo, um toque breve inicia / pausa o od√¥metro, um toque longo redefine o contador para 0. <br><br>  Talvez outros estados sejam adicionados.  Assim, por exemplo, no criador de logs original ap√≥s mudar para a p√°gina seguinte, os valores na tela mudam frequentemente e com menos frequ√™ncia ap√≥s alguns segundos - uma vez por segundo.  Isso pode ser feito adicionando outro estado. <br><br>  Quando o quadro estava pronto, eu j√° comecei a conectar o GPS.  Mas aqui havia nuances que me fizeram adiar essa tarefa. <br><br><h1>  Otimiza√ß√£o de firmware </h1><br>  Antes de seguir em frente, preciso me distrair com alguns detalhes t√©cnicos.  O fato √© que, naquele local, comecei a me intrometer com o aumento do consumo de mem√≥ria.  Verificou-se que a linha declarada de forma imprudente sem o modificador PROGMEM no in√≠cio do firmware √© copiada para a RAM e ocupa espa√ßo durante o tempo de execu√ß√£o. <br><br><div class="spoiler">  <b class="spoiler_title">V√°rias arquiteturas</b> <div class="spoiler_text">  Em poucas palavras.  Em computadores grandes, a <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">arquitetura Von Neumann √© usada</a> onde o c√≥digo e os dados est√£o localizados no mesmo espa√ßo de endere√ßo.  I.e.  os dados da RAM e da ROM ser√£o lidos da mesma maneira. <br><br>  Microcontroladores normalmente usam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u=">a arquitetura Harvard</a> , onde c√≥digo e dados s√£o separados.  T.O.  voc√™ precisa usar v√°rias fun√ß√µes para ler a mem√≥ria e o flash.  Do ponto de vista da linguagem C / C ++, os ponteiros t√™m a mesma apar√™ncia, mas ao escrever um programa, precisamos saber exatamente onde exatamente para qual mem√≥ria nosso ponteiro aponta e chama as fun√ß√µes correspondentes. </div></div><br>  Felizmente, os desenvolvedores de bibliotecas j√° cuidaram disso parcialmente.  A classe principal da biblioteca de exibi√ß√£o - Adafruit_SSD1306 √© herdada da classe Print da biblioteca padr√£o do Arduino. <br><br>  Isso nos fornece uma s√©rie completa de modifica√ß√µes diferentes no m√©todo de impress√£o - para imprimir seq√º√™ncias de caracteres, caracteres √∫nicos, n√∫meros e outras coisas.  Portanto, possui 2 fun√ß√µes separadas para linhas de impress√£o: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> print(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> __FlashStringHelper *); <span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> print(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[]);</code> </pre><br>  O primeiro sabe que voc√™ precisa imprimir uma linha de uma unidade flash e carreg√°-la caractere por caractere.  O segundo imprime caracteres da RAM.  De fato, essas duas fun√ß√µes direcionam um ponteiro para uma cadeia de caracteres, somente de diferentes espa√ßos de endere√ßo. <br><br>  Durante muito tempo, procurei no c√≥digo do arduino esse __FlashStringHelper para aprender como chamar a fun√ß√£o print () desejada.  Os caras fizeram o truque: eles simplesmente declararam esse tipo com a declara√ß√£o de encaminhamento (sem declarar o pr√≥prio tipo) e escreveram uma macro que convertia ponteiros em linhas em um flash para o tipo __FlashStringHelper.  Apenas para o compilador selecionar a fun√ß√£o sobrecarregada necess√°ria <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> __</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FlashStringHelper</span></span></span><span class="hljs-class">;</span></span> <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> F(string_literal) (reinterpret_cast</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;const __FlashStringHelper *&gt;(PSTR(string_literal)))</span></span></span></span></code> </pre><br>  Isso permite que voc√™ escreva assim: <br><br><pre> <code class="cpp hljs">display.print(F(‚ÄúString in flash memory‚Äù));</code> </pre> <br><br>  Mas n√£o permite que voc√™ escreva assim <br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span> text[] PROGMEM = <span class="hljs-string"><span class="hljs-string">"String in flash memory"</span></span>; display.print(F(text));</code> </pre> <br>  E, aparentemente, a biblioteca n√£o fornece nada que possa ser feito dessa maneira.  Sei que n√£o √© bom usar partes da biblioteca privada no meu c√≥digo, mas o que devo fazer?  Eu desenhei minha macro, que fez o que eu precisava. <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> USE_PGM_STRING(x) reinterpret_cast</span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;const __FlashStringHelper *&gt;(x)</span></span></span></span></code> </pre><br>  Ent√£o, a fun√ß√£o de desenho do chap√©u come√ßou a ficar assim: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">void</span></span> Screen::drawHeader() { display.setFont(<span class="hljs-literal"><span class="hljs-literal">NULL</span></span>); display.setCursor(<span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); display.print(<span class="hljs-string"><span class="hljs-string">'\x1e'</span></span>); display.print(USE_PGM_STRING(getSelButtonText())); display.setCursor(<span class="hljs-number"><span class="hljs-number">80</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); display.print(<span class="hljs-string"><span class="hljs-string">'\x1e'</span></span>); display.print(USE_PGM_STRING(getOkButtonText())); }</code> </pre> <br>  Bem, desde que entrei nas partes de baixo n√≠vel do firmware, decidi estudar mais profundamente como tudo funciona por dentro. <br><br>  Em geral, os caras que criaram o Arduino precisam erguer um monumento.  Eles criaram uma plataforma simples e conveniente para prototipagem e artesanato.  Um grande n√∫mero de pessoas com conhecimento m√≠nimo de eletr√¥nica e programa√ß√£o conseguiu entrar no mundo do Arduino.  Mas tudo isso √© suave e bonito ao fazer lixo, como pisca-piscas com LEDs ou ler o term√¥metro.  Assim que voc√™ discute algo s√©rio, imediatamente precisa entender mais profundamente do que queria desde o in√≠cio. <br><br>  Ent√£o, ap√≥s cada biblioteca adicionada ou mesmo classe, observei a rapidez com que o consumo de mem√≥ria est√° crescendo.  Neste ponto, eu estava ocupado com mais de 14 KB de 32 KB de flash e 1300 bytes de RAM (de 2k).  Cada movimento descuidado acrescentou outros 10% ao j√° usado.  Mas ainda n√£o conectei as bibliotecas GPS e SD / FAT32 e o gato estava chorando.  Eu tive que pegar o <s>verificador</s> desmontador e estudar o que o compilador fez. <br><br>  Eu esperava secretamente que o vinculador jogasse fora fun√ß√µes n√£o utilizadas.  Mas aconteceu que alguns deles o linker insere quase inteiramente.  No firmware, encontrei as fun√ß√µes de desenho de linha e algumas outras da biblioteca de trabalho com a tela, embora no c√≥digo eu obviamente n√£o as chamasse na √©poca.  Implicitamente, eles tamb√©m n√£o devem ser chamados - por que preciso de uma fun√ß√£o de desenho de linha se s√≥ desenhar letras de bitmaps?  Mais de 5,2kb do nada (e isso n√£o est√° contando as fontes). <br><br>  Al√©m da biblioteca de controle de exibi√ß√£o, tamb√©m encontrei: <br><br><ul><li>  2,6 kb - no SoftwareSerial (eu o puxei para o projeto em algum momento) </li><li>  1,6 kb - I2C </li><li>  1,3 kb - HardwareSerial </li><li>  2 kb - TinyGPS </li><li>  2,5 kb no arduino atual (inicializa√ß√£o, pinos, todos os tipos de tabelas, o timer principal para as fun√ß√µes millis () e delay ()), </li></ul><br>  Os n√∫meros s√£o muito indicativos, pois  o otimizador est√° misturando seriamente o c√≥digo.  Algumas fun√ß√µes podem come√ßar em um lugar e, em seguida, outra de outra biblioteca, chamada a partir da primeira, pode segui-la imediatamente.  Al√©m disso, ramifica√ß√µes separadas dessas fun√ß√µes podem ser localizadas na outra extremidade do flash. <br><br>  Tamb√©m no c√≥digo eu encontrei: <br><br><ul><li>  Controle de tela por SPI (embora eu esteja conectado via I2C) </li><li>  M√©todos de classes base que eles mesmos n√£o s√£o chamados, porque  redefinido nos herdeiros </li><li>  Destrutores que nunca s√£o chamados por design </li><li>  Fun√ß√µes de desenho (e n√£o todas - parte das fun√ß√µes que o vinculador ainda jogou) </li><li>  malloc / free enquanto no meu c√≥digo todos os objetos s√£o essencialmente est√°ticos </li></ul><br>  Mas n√£o apenas o consumo de mem√≥ria flash, mas tamb√©m a SRAM est√° crescendo aos trancos e barrancos: <br><br><ul><li>  130 bytes - I2C </li><li>  100 bytes - SoftwareSerial </li><li>  157 bytes - Serial </li><li>  558 bytes - Visor (dos quais 512 √© o buffer de quadros) </li></ul><br>  N√£o menos divertida foi a se√ß√£o .data.  Existem cerca de 700 bytes e essa coisa √© carregada de um flash para a RAM no in√≠cio.  Descobriu-se que existem lugares reservados para vari√°veis ‚Äã‚Äãna mem√≥ria e junto com os valores de inicializa√ß√£o.  Aqui vivem as vari√°veis ‚Äã‚Äãe constantes que voc√™ esqueceu de declarar como const PROGMEM. <br><br>  Entre isso, havia uma matriz robusta com uma "tela inicial" da tela - os valores iniciais do buffer de quadros.  Teoricamente, se voc√™ exibir a tela () imediatamente ap√≥s o in√≠cio, poder√° ver a flor e a inscri√ß√£o Adafruit, mas, no meu caso, n√£o faz sentido gastar mem√≥ria flash nisso. <br><br>  A se√ß√£o .data tamb√©m cont√©m vtables.  Eles s√£o copiados para a mem√≥ria de uma unidade flash, aparentemente por raz√µes de efici√™ncia no tempo de execu√ß√£o.  Mas voc√™ precisa sacrificar uma grande quantidade de RAM - mais de uma d√∫zia de classes, mais de 150 bytes.  Al√©m disso, parece que n√£o h√° chave do compilador que, sacrificando o desempenho, deixe tabelas virtuais na mem√≥ria flash. <br><br>  O que fazer sobre isso?  Ainda n√£o sei.  Vai depender de como o consumo continuar√° a crescer.  Para o bem, as ombreiras encontradas precisam ser reparadas sem piedade.  Com toda a probabilidade, terei que desenhar explicitamente todas as bibliotecas no meu projeto e depois cobri-las completamente.  E pode ser necess√°rio reescrever algumas das pe√ßas de maneira diferente para otimizar a mem√≥ria.  Ou mude para um hardware mais poderoso.  De qualquer forma, agora eu sei sobre o problema e h√° uma estrat√©gia sobre como corrigi-lo. <br><br>  <b>ATUALIZA√á√ÉO:</b> <br>  Pouco progresso na efici√™ncia de recursos.  Estou atualizando esta parte, porque  no pr√≥ximo eu quero focar em coisas completamente diferentes. <br><br>  Nos coment√°rios, h√° certa perplexidade sobre o uso de C ++.  Em particular, por que ele √© t√£o ruim e mant√©m o vtable na preciosa RAM?  Em geral, fun√ß√µes virtuais, construtores e destruidores s√£o sobrecarga.  Porque  Vamos descobrir! <br><br>  Aqui est√£o as estat√≠sticas da mem√≥ria em algum momento do projeto <br>  Tamanho do programa: 15 458 bytes (usado 50% de um m√°ximo de 30 720 bytes) (2,45 segundos) <br>  Uso m√≠nimo de mem√≥ria: 1258 bytes (61% de um m√°ximo de 2048 bytes) <br><br>  Experi√™ncia n¬∫ 1 - reescreva para C. <br><br>  Eu dei aulas, reescrevi tudo nas tabelas com ponteiros para fun√ß√µes.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Como as telas sempre t√™m a mesma estrutura, todos os membros dos dados se tornaram vari√°veis ‚Äã‚Äãglobais comuns. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Estat√≠sticas ap√≥s refatora√ß√£o </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamanho do programa: 14 568 bytes (usado 47% de um m√°ximo de 30 720 bytes) (2,35 segundos) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uso m√≠nimo de mem√≥ria: 1176 bytes (57% de um m√°ximo de 2048 bytes) </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Total. Ganhou 900 bytes de flash e 80 bytes de RAM. O que exatamente deixou o flash n√£o cavou. 80 bytes de RAM s√£o do tamanho de vtable. Todos os outros dados (alunos) permaneceram de alguma forma. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Devo dizer que n√£o estraguei tudo - s√≥ queria ver o quadro geral sem gastar muito tempo nele. Ap√≥s a refatora√ß√£o, "perdi" as capturas de tela aninhadas. Com eles, o consumo seria um pouco mais.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas o mais importante nesse experimento √© que a qualidade do c√≥digo se deteriorou significativamente. O c√≥digo de um funcional se espalhou por v√°rios arquivos. Para alguns dados, "um propriet√°rio" deixou de existir, alguns m√≥dulos come√ßaram a entrar na mem√≥ria de outros. O c√≥digo tornou-se abrangente e feio. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Experi√™ncia n¬∫ 2 - extrair bytes do C ++ </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Recuei minha experi√™ncia e decidi deixar tudo como classes. Somente dessa vez, as telas funcionam em objetos distribu√≠dos estaticamente. A estrutura das p√°ginas em minhas telas √© fixa. Voc√™ pode especific√°-lo no est√°gio de compila√ß√£o sem usar novo / excluir. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamanho do programa: 15 408 bytes (usado 50% de um m√°ximo de 30 720 bytes) (2,60 segundos) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uso m√≠nimo de mem√≥ria: 1273 bytes (62% de um m√°ximo de 2048 bytes)</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O consumo de RAM aumentou ligeiramente. </font><font style="vertical-align: inherit;">Mas isso √©, de fato, para melhor. </font><font style="vertical-align: inherit;">O aumento no consumo de RAM √© explicado pelo movimento de objetos do heap para uma √°rea de mem√≥ria distribu√≠da estaticamente.</font></font> I.e.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">de fato, os objetos foram criados antes, mas isso n√£o foi para as estat√≠sticas. </font><font style="vertical-align: inherit;">E agora esses objetos s√£o levados em conta explicitamente. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Mas para reduzir significativamente o consumo de flash n√£o funcionou. </font><font style="vertical-align: inherit;">O c√≥digo ainda cont√©m os pr√≥prios construtores, que ainda s√£o chamados na inicializa√ß√£o.</font></font> I.e.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O compilador n√£o p√¥de "execut√°-los" com anteced√™ncia e colocar todos os valores em √°reas pr√©-alocadas. E ainda havia destruidores no c√≥digo, embora seja claro para o ouri√ßo que os objetos nunca ser√£o exclu√≠dos. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na tentativa de economizar pelo menos um pouco, apaguei todos os destruidores da hierarquia e, em particular, o destruidor virtual na classe base. A id√©ia era liberar alguns bytes em cada tabela. E ent√£o uma surpresa me esperava: </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Tamanho do programa: 14 704 bytes (usado 48% de um m√°ximo de 30 720 bytes) (2,94 segundos) </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Uso m√≠nimo de mem√≥ria: 1211 bytes (59% de um m√°ximo de 2048 bytes)</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aconteceu que a tabela n√£o seguia um ponteiro, mas j√° era 2. Al√©m disso, ambos tinham a ver com o destruidor. </font><font style="vertical-align: inherit;">Apenas um destruidor est√° vazio (vis√≠vel para objetos na pilha) e o outro com uma chamada gratuita, vis√≠vel para objetos no heap (-12 bytes de RAM). </font><font style="vertical-align: inherit;">Al√©m disso, as vari√°veis ‚Äã‚Äãassociadas ao quadril (8 bytes) e os r√≥tulos dos objetos que nunca s√£o criados (Tela, Tela-pai - 40 bytes) desapareceram.O </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">consumo de flash diminuiu significativamente - em 700 bytes. </font><font style="vertical-align: inherit;">N√£o apenas os pr√≥prios destruidores, mas tamb√©m as implementa√ß√µes malloc / free / new / delete desapareceram. </font><font style="vertical-align: inherit;">700 bytes para um destruidor virtual vazio! </font><font style="vertical-align: inherit;">700 bytes, Carl! </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Isso n√£o acabaria, aqui est√£o todos os n√∫meros em um s√≥ lugar</font></font><br><br><div class="scrollable-table"><table><tbody><tr><th></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Was </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C </font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> C ++ </font></font></th></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Flash </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 15 458 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 14.568 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 14.704 </font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> RAM </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1258 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1176 </font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 1211 </font></font></td></tr></tbody></table></div><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Conclus√£o: o consumo em C ++ acabou sendo quase o mesmo que em C. Mas, ao mesmo tempo, encapsulamento, heran√ßa e polimorfismo s√£o poder. </font><font style="vertical-align: inherit;">Estou pronto para pagar a mais por isso com algum aumento no consumo. </font><font style="vertical-align: inherit;">Talvez eu simplesmente n√£o possa escrever lindamente em C, mas por que, se eu posso escrever lindamente em C ++?</font></font><br><br><h1>  Posf√°cio </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inicialmente, eu queria escrever um artigo no final do projeto. </font><font style="vertical-align: inherit;">Por√©m, como as notas se acumulam em alta velocidade √† medida que o trabalho avan√ßa, o artigo amea√ßa ser muito grande. </font><font style="vertical-align: inherit;">Ent√£o eu decidi dividi-lo em v√°rias partes. </font><font style="vertical-align: inherit;">Nesta parte, falei sobre as etapas preparat√≥rias: entender o que realmente quero, escolher uma plataforma, implementar uma estrutura de aplicativo. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Na pr√≥xima parte, pretendo avan√ßar para a implementa√ß√£o da funcionalidade b√°sica - trabalhar com GPS. </font><font style="vertical-align: inherit;">Eu j√° encontrei alguns ancinhos interessantes sobre os quais gostaria de contar.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por mais de 10 anos eu n√£o tenho programado seriamente para microcontroladores. </font><font style="vertical-align: inherit;">Aconteceu que eu estava um pouco estragado pela abund√¢ncia de recursos de computadores grandes e est√° limitado √†s realidades do ATMega32. </font><font style="vertical-align: inherit;">Portanto, tive que pensar em v√°rias op√ß√µes de backup, como aparar a funcionalidade das bibliotecas ou redesenhar o aplicativo em nome do uso eficiente da mem√≥ria. </font><font style="vertical-align: inherit;">Tamb√©m n√£o excluo a possibilidade de mudar para controladores mais poderosos - ATMega64 ou algo da linha STM32. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Por estilo, o artigo acaba sendo algo como uma revista de constru√ß√£o. </font><font style="vertical-align: inherit;">E ficarei feliz em fazer coment√°rios construtivos - n√£o √© tarde para mudar nada. </font><font style="vertical-align: inherit;">Quem quiser pode participar do meu </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">projeto no github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">O fim da primeira parte. </font></font><br><br> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=pt&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Segunda parte</font></font></a> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/pt401899/">https://habr.com/ru/post/pt401899/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../pt401889/index.html">Amplificadores lend√°rios dos anos 80 - 90: paradoxos de Lamm, o monstro de Johnson, assassino integral de "l√¢mpadas quentes"</a></li>
<li><a href="../pt401891/index.html">Digitaliza√ß√£o 3D e impress√£o 3D em a√ß√£o (dedicada aos motociclistas)</a></li>
<li><a href="../pt401893/index.html">De onde v√™m a √°gua e o oxig√™nio na ISS?</a></li>
<li><a href="../pt401895/index.html">Os invasores est√£o se tornando mais criativos na cria√ß√£o de skimmers</a></li>
<li><a href="../pt401897/index.html">Pacote de Not√≠cias para SLS e Orion</a></li>
<li><a href="../pt401901/index.html">Janela do luar para o universo</a></li>
<li><a href="../pt401903/index.html">Como os sons afetam nosso sono e produtividade</a></li>
<li><a href="../pt401905/index.html">Apple Power Mac G4 Cube e seus contempor√¢neos em uma pequena revis√£o de foto</a></li>
<li><a href="../pt401907/index.html">Os carros rob√≥ticos devem aprender a entender as pessoas.</a></li>
<li><a href="../pt401909/index.html">Sistema de seguran√ßa caseiro com base em produtos para uma casa inteligente de Nootekhnika</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>