<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🕥 👩🏻‍🚀 🔽 The Standoff: bagaimana itu 📗 🎅 ↘️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Salam! Setelah melihat cukup minat pada apa yang terjadi di The Standoff di barisan pembela di PHDays 9, kami memutuskan untuk berbicara tentang bagai...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>The Standoff: bagaimana itu</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/454298/"><img src="https://habrastorage.org/webt/ef/tx/b3/eftxb30vyae7fr5w6xkios-nl9q.jpeg"><br><br>  Salam!  Setelah melihat cukup minat pada apa yang terjadi di The Standoff di barisan pembela di PHDays 9, kami memutuskan untuk berbicara tentang bagaimana persiapan dan "kebuntuan" berlangsung melalui mata Jet CSIRT sebagai bagian dari Tim Keamanan Jet. <br><a name="habracut"></a><br><h3>  Guo Standoff, saya buat </h3><br>  Kira-kira seperti ini, para kolega melaporkan bahwa kami sekali lagi berpartisipasi dalam The Standoff, dan kami tentu saja setuju. <br><br>  Patut disebutkan bahwa bagi para pembela HAM tahun ini format kompetisi agak berubah.  Semua tim menerima infrastruktur kantor yang sangat mirip, dan ini memungkinkan bagi penyelenggara untuk memasukkan peringkat para pembela di burung beo tertentu.  Dan untuk Tim Keamanan Jet, ini adalah "Konfrontasi" pertama, di mana kantor dipertahankan, dan bukan infrastruktur industri. <br><br>  Kami mendapat akses ke infrastruktur untuk mempersiapkan pertempuran cyber pada akhir April.  Setelah audit infrastruktur, seluruh gerobak kekurangan dikumpulkan, berikut ini beberapa di antaranya.  Di seluruh infrastruktur, tidak ada tambalan yang sebenarnya.  Kata sandi semua pengguna dapat diperoleh melalui Ntds.dit di cleartext.  Selain itu, beberapa pengguna memiliki kata sandi dari daftar TOP-500 atau kata sandi dengan hash yang mudah dibalik.  Pengerasan sistem hampir tidak ada sama sekali atau tidak sama sekali.  Beberapa host di DMZ memiliki antarmuka di server subnet. <br><br>  Berdasarkan hasil audit, kami mengembangkan langkah-langkah keamanan tertentu, pada gilirannya, penyelenggara, setelah persetujuan awal, memungkinkan kami untuk menerapkan kebijakan yang kami butuhkan dan membawa serta alat dan alat keamanan yang dapat digunakan dalam lingkungan virtual.  Karena tenggat waktu yang ketat, beberapa ide tentang tindakan perlindungan jatuh pada awalnya.  Pengaturan utama dan pembuatan profil SPI dilakukan selama liburan Mei (halo untuk semua orang yang melempar gambar dari piknik, kami juga mencintaimu), dan beberapa peralatan pelindung harus disetel tepat sebelum start tepat di situs.  Juga, sejumlah layanan dilarang untuk ditambal dan sangat mengkonfigurasi ulang.  Sebagai contoh, salah satunya adalah Oracle Weblogic dengan CVE-2019-2725, yang dirilis PoC pada awal Mei 2019. <br><br>  Nah, dan daftar apa yang kami bawa: <br><br><ul><li>  Firewall (disediakan oleh penyelenggara telah diganti); </li><li>  Solusi antivirus; </li><li>  WAF; </li><li>  EDR </li><li>  Beberapa solusi penipuan; </li><li>  Sepasang pemindai kerentanan; </li><li>  Tumpukan ELK untuk analisis Netflow tambahan; </li><li>  SIEM. </li></ul><br>  Kita juga harus berbicara tentang apa yang terjadi pada SIEM.  Sebagai sumber acara, kami memiliki log Windows, Sysmon, log Auditd dan, seperti yang Anda duga, peristiwa dari SZI itu sendiri.  Jika tidak ada masalah khusus dengan dua yang pertama, dan kami dengan cepat menyetujui perubahan dalam kebijakan dan konfigurasi Sysmon, maka kami harus bergulat dengan penyelenggara untuk konfigurasi Auditd. <br><br>  Sejalan dengan ini, kami mengidentifikasi vektor serangan utama, dan berdasarkan ini kami memilih dan mengadaptasi skenario yang relevan dan aturan korelasi - total sekitar 160 aturan korelasi.  Plus, satu set dashboard beraneka ragam dirakit untuk node kritis, SZI dan apa yang membutuhkan perhatian khusus dalam infrastruktur game. <br><br><h3>  Kebuntuan </h3><br>  Untuk The Standoff, kami memutuskan untuk mematuhi konsep memisahkan insiden menjadi eksternal dan internal, karena ada pemahaman yang tepat bahwa di luar kami akan secara aktif mencoba memindai dan mengoperasikan web.  Insiden yang terkait dengan pemindaian dan upaya untuk menghindari WAF dipantau secara terpisah, dengan prioritas yang lebih rendah, ini memungkinkan kami untuk fokus pada insiden internal.  Dasbor untuk SPI didistribusikan di antara para pembela HAM di bidang tanggung jawab, dan setidaknya 2 orang ditugaskan untuk setiap alat - untuk kemungkinan rotasi dan istirahat. <br><br>  Semuanya terjadi, seperti yang kami harapkan.  Konfrontasi dimulai sekitar pukul 10 pagi, dan segera setelah dimulainya, sistem SIEM mulai mengeluarkan banyak insiden terkait dengan pemindaian eksternal dan upaya penyerang untuk mengeksploitasi web.  Dalam beberapa kasus, bahkan grup tidak menabung.  Seiring dengan ini, checker penyelenggara mulai bekerja, memeriksa status berbagai layanan di kantor, yang memaksa kami untuk kembali melakukan profiling sampai batas tertentu untuk memotong positif palsu yang terkait dengan mereka. <br><br>  Pada jam-jam pertama permainan, tim Hack.ERS berhasil menemukan kredensial standar dari administrator (admin / admin) pada CMS dari salah satu sumber daya dan mendeteksi potensi kerentanan LFI.  Upaya-upaya ini tidak luput dari perhatian, para pembela kami melakukan tanggapan operasional, dan para penyerang pada akhirnya tidak bisa maju lebih jauh. <br><br>  Sampai akhir hari pertandingan pertama, metode tidak berubah, WAF masih mengalahkan semua upaya untuk mengunggah sesuatu yang menarik ke situs web perusahaan, dan "alamat eksternal" yang sama, tanpa henti, mencoba memindai sumber daya kami. <br><br><img src="https://habrastorage.org/webt/k4/h2/je/k4h2jeeackujcdpdfydy2ci7i7s.png"><br><br>  Secara total, untuk seluruh acara, 3000 insiden yang terkait dengan upaya pemindaian dicatat, tanpa memperhitungkan pengelompokan peristiwa dalam insiden. <br><br><img src="https://habrastorage.org/webt/eo/c0/j-/eoc0j-v5ohyz-kbja5goxy9vzsi.png"><br><br>  Dan sekitar 2.500 insiden dengan upaya untuk menghindari WAF, juga tanpa memperhitungkan pengelompokan peristiwa dalam insiden. <br><br>  Menjelang malam, intensitas semua kegiatan menurun - ada beberapa alasan untuk ini.  Bagian dari para pembela dan penyerang tidak bisa menolak soundcheck dan latihan konser, yang seharusnya diadakan pada hari berikutnya.  Beberapa tim penyerang memutuskan untuk beristirahat dan melanjutkan serangan lebih dekat ke pagi hari dengan harapan bahwa para pembela dan pemantauan akan memiliki sumber daya pemantauan yang lebih sedikit dan kelelahan. <br><br>  Pada pagi hari kedua, para penyerang mengubah taktik.  Informasi tentang sebagian karyawannya diposting di salah satu situs web perusahaan.  Peretas mengambil keuntungan dari informasi ini dan mulai secara aktif mengumpulkan akun pengguna melalui Exchange (statistik upaya dalam tangkapan layar). <br><br><img src="https://habrastorage.org/webt/ud/pp/z0/udppz0drbdk_woprerkpwz3xgos.png"><br><br>  Beberapa saat kemudian, upaya tidak aman dilakukan untuk memilih kata sandi pada gateway VPN, akun yang tidak ada dalam infrastruktur kami berpartisipasi dalam brute.  Dengan probabilitas tinggi, para penyerang mencoba menggunakan akun dari infrastruktur yang sudah diretas dengan harapan bahwa penyelenggara meninggalkannya di mana-mana.  Akibatnya, seluruh situasi dengan brute force membuat kami membuat grup dasbor tentang tren dalam hal otentikasi pengguna.  Plus, kami memperketat pemantauan pada insiden yang terkait dengan brute force yang berhasil, tetapi, untungnya, tidak ada kasus seperti itu yang terdeteksi. <br><br>  Kira-kira satu jam sebelum akhir permainan, tren melihat satu upaya yang berhasil untuk mengotentikasi beberapa pengguna, termasuk yang di Exchange, analisis operasional menunjukkan bahwa sumbernya adalah mesin pengguna secara langsung, sebagian besar peristiwa menunjukkan bahwa penyelenggara login dari konsol VMware Vcenter. <br><br>  Pada saat yang sama, kami merekam pemindaian internal dari sebuah simpul yang berhasil terhubung melalui VPN.  Setelah analisis operasional dari peristiwa yang terkait dengan insiden itu, menjadi jelas bahwa penyerang mampu kompromi kredensial beberapa pengguna, dan menilai dengan tidak adanya upaya otentikasi yang gagal, ada kemungkinan bahwa data pengguna "bocor". <br><br>  Informasi disampaikan kepada para pembela HAM.  Untuk seluruh waktu respons pada komputer pribadi pengguna yang dikompromikan, solusi titik akhir dimasukkan ke dalam mode perlindungan preventif untuk memperlambat kemungkinan diperbaiki dalam sistem.  Sesi serangan pada gateway VPN secara paksa dijatuhkan, dan para penyerang ditendang keluar dari perimeter yang dilindungi.  Dalam UZ yang dikompromikan, kata sandi segera diubah. <br><br>  Pada saat itu, orang-orang dari tim True0xA3 naik panggung dan berhasil menggunakan OSINT dan melaporkan kompromi kantor Behealthy, yang berada di bawah perlindungan tim lain.  Penyerang berhasil membahayakan admin domain.  Panitia diberitahu tentang kejadian kami dan bukti diberikan. <br><br>  Jam terakhir sangat panas karena OSINT tiba-tiba, semua orang menunggu beberapa persiapan dari panitia.  Tim pemantau, pada gilirannya, memantau semua anomali yang mencurigakan dan insiden, tetapi setelah upaya yang gagal untuk menembus upaya peretasan baru, itu tidak mengikuti.  Jadi menit-menit terakhir waktu bermain berlalu, dan peretasan kantor yang berhasil dilindungi oleh Tim Keamanan Jet tidak terjadi. <br><br>  Dan statistik terakhir untuk dua hari bermain: <br><br><ul><li>  1200 EPS rata-rata dan sedikit kurang dari 3000 EPS pada puncaknya; </li><li>  Sekitar 7000 insiden; </li><li>  Lebih dari 120 juta acara. </li></ul><br><br><h3>  Faktor-Faktor Yang Membantu Kami Menang </h3><br><ul><li>  Distribusi peran yang kompeten.  Masing-masing mendirikan dan terlibat dalam sebagian besar apa yang dia lakukan dalam proyek sehari-hari.  Tidak ada yang harus mempelajari bahan dari kategori "firewall untuk boneka." </li><li>  Profil operasional aturan korelasi.  Semua positif palsu diproses dan dilakukan koreksi terkait dengan fitur infrastruktur game. </li><li>  Respons yang cepat.  Karena kenyataan bahwa beberapa orang ditugaskan untuk setiap jenis SZI dan sistem, kami tidak punya masalah dengan fakta bahwa orang yang bertanggung jawab beristirahat atau hanya berjalan kaki selama beberapa menit.  Semua informasi dari pemantauan diproses secepat mungkin. </li><li>  Pengalaman dalam pengerasan dan pemantauan berbagai infrastruktur. </li></ul><br>  PS Terima kasih khusus kepada semua orang yang datang dan mengajukan pertanyaan, dan kami meminta maaf kepada mereka yang tidak dapat menceritakan sesuatu dalam proses - tim sedang menunggu "kesalahan penanganan Cossack" dari penyerang dan tidak bisa mengungkapkan semua detail. <br><br>  <i>Dmitry Lifanov, pakar di Pusat Pemantauan dan Respons terhadap Insiden Keamanan Informasi Jet CSIRT</i> </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id454298/">https://habr.com/ru/post/id454298/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id454284/index.html">Maaf, saya tidak akan bekerja karena ini musim dingin</a></li>
<li><a href="../id454290/index.html">Prinsip Tanggung Jawab Tunggal. Tidak sesederhana kedengarannya</a></li>
<li><a href="../id454292/index.html">JS. Proksi Jebakan untuk Tahu Tentang</a></li>
<li><a href="../id454294/index.html">"Tanpa eksperimen yang tidak perlu", atau bagaimana kami meluncurkan akselerator bank</a></li>
<li><a href="../id454296/index.html">Bagaimana Sekolah di Puerto Rico Membawa Kimia ke Kehidupan dengan Minecraft: Edisi Pendidikan</a></li>
<li><a href="../id454300/index.html">Perbedaan CTT dari pipa panas konvensional dan cara mengaplikasikannya</a></li>
<li><a href="../id454302/index.html">File QVD - apa yang ada di dalamnya</a></li>
<li><a href="../id454304/index.html">Delta 3D printer do-it-yourself untuk keramik</a></li>
<li><a href="../id454306/index.html">Lima kesalahan yang saya buat sebagai pengembang utama</a></li>
<li><a href="../id454308/index.html">AMA dengan Habr. V.9.0. Podcast, Konferensi, dan Konsep</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>