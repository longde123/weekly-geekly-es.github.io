<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐖 👨‍🏭 🤳🏽 Comment nous avons créé Open Lines chez Bitrix24 👨🏽‍🔬 🐪 🔇</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, les utilisateurs ne veulent pas communiquer avec les entreprises par e-mail et par téléphone, mais via leurs messageries instantanées et ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment nous avons créé Open Lines chez Bitrix24</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/bitrix/blog/414797/">  Aujourd'hui, les utilisateurs ne veulent pas communiquer avec les entreprises par e-mail et par téléphone, mais via leurs messageries instantanées et comptes de réseaux sociaux préférés. <br><br>  En réponse, les réseaux sociaux et les messageries instantanées ont commencé à introduire de nouvelles fonctionnalités.  VKontakte et Facebook ont ​​déployé des messages privés pour les groupes et les pages publiques. <br><br>  Le télégramme avec ses chaînes et ses bots est devenu une plateforme de publication et d'interaction avec le public.  A Viber, des comptes publics sont apparus. <br><br>  Pour obtenir le profit maximum, les entreprises doivent utiliser toutes les capacités de toutes les plateformes sociales. <br><br>  Ainsi, Open Lines est né - un nouvel outil pour l'interaction des clients Bitrix24 avec les utilisateurs finaux. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/703/824/144/70382414416e170d5519600c0ee6cc58.png"><br><a name="habracut"></a><br>  Le workflow Open Lines est simple: <br><br><ol><li>  Nous recevons tous les messages des utilisateurs des messagers et des réseaux sociaux. </li><li>  Nous les acheminons à l'aide du messager «Bitrix24» intégré.  Nous distribuons par les opérateurs </li><li>  Les clients répondent aux messages et nous renvoyons les réponses aux responsables des entreprises travaillant chez Bitrix24 </li></ol><br>  La principale tâche de développement de ce projet est de simplifier autant que possible la connexion des canaux de communication.  Pour que tout gestionnaire moyen puisse le faire.  Pour ce faire, j'ai dû négocier avec les développeurs de tous les réseaux sociaux intégrables et les messageries instantanées - tout est officiel, pas de trucs. <br><br>  Et pour assurer un fonctionnement stable dans les versions cloud et en boîte de Bitrix24, nous avons créé un serveur de connecteurs centralisé.  Il traite tous les flux d'informations. <br><br><h2>  VKontakte </h2><br>  La prochaine étape, nous avons pris un duo avec les développeurs de VKontakte.  Nous avons réussi à construire le schéma optimal pour travailler avec le service - maintenant nous avons fait un tas d'actions techniques pour que les utilisateurs se connectent. <br><br>  Maintenant, cette API VKontakte peut utiliser d'autres services. <br><br>  À quoi ressemble la connexion Open Lines pour un utilisateur régulier: <br><br><ul><li>  Connectez-vous à VK. </li><li>  Dans la section de connexion, sélectionnez le groupe souhaité. </li><li>  Confirmez. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/87c/bbb/e8b/87cbbbe8b671c848012b7bcd48b05c9e.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c29/31b/fcb/c2931bfcb0c36553963f5e75d2427ad0.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b88/341/b78/b88341b78a35dc771280fbb6d8fbba43.png"><br><br>  Cela semble simple, mais seulement parce que nous avons caché toute la "cuisine" sous le capot - une dizaine d'opérations, ainsi que des demandes de clés différentes. <br><br><h2>  Skype </h2><br>  Mais avec Microsoft, c'était difficile.  Malheureusement, ils sont très concentrés sur les informaticiens de la «vieille école».  Se connecter à leur framework de bot s'est avéré difficile.  Maintenant, pour cela, vous devez passer par une quête d'horreur: <br><br><ul><li>  Installez l'appli. </li><li>  Créez un compte. </li><li>  Dans Skype, prenez une clé. </li><li>  Dans Bitrix 24, un autre. </li><li>  Pour se connecter. </li></ul><br><h2>  Viber </h2><br>  Nous avons fait de cette intégration l'une des premières.  Nous avons constamment communiqué avec les développeurs du messager.  Et en général, ils gardaient la main sur le pouls.  Maintenant, Open Lines peut être connecté depuis Bitrix24 ou depuis l'application mobile Viber. <br><br><h2>  Télégramme </h2><br>  Telegram a une API simple - la connexion est simple.  Et malgré toutes les serrures, maintenant tout fonctionne. <br><br><h2>  Instagram </h2><br>  L'intégration avec Instagram est l'une des plus populaires parmi nos clients.  Mais en raison du scandale de la propagation des données personnelles, Instagram a considérablement réduit les capacités de l'API. <br><br>  Nous devons «l'interviewer» et déterminer nous-mêmes de nouveaux messages toutes les 15 minutes.  De plus, l'API vous permet de recevoir non pas les messages eux-mêmes, mais uniquement les commentaires sur les publications.  Il y a également une limite au nombre de réponses par heure. <br><br>  Les systèmes externes sont des organismes vivants dans lesquels quelque chose change constamment.  Dans l'API des réseaux sociaux et des messageries instantanées, certains changements sont apportés, il y a souvent des erreurs de l'autre côté. <br><br>  Un exemple.  VKontakte a cassé l'encodage des noms de marchandises, ils ont résolu ce problème en un an.  Instagram n'a averti personne de désactiver un certain nombre de fonctions API - nous avons découvert après le fait que certaines fonctionnalités ne fonctionnaient plus.  Nous avons dû chercher des solutions en mode d'urgence. <br><br>  Après une intégration réussie du réseau social ou du messager, vous ne pouvez plus vous détendre.  Nous devons constamment contrôler l'exactitude du traitement des messages entrants. <br><br><h2>  Serveur de connecteur </h2><br>  L'architecture Open Lines est basée sur un serveur de connecteurs.  Il s'agit d'un point d'entrée unique dans le schéma de messagerie entre le messager interne Bitrix24 et les messagers externes et les réseaux sociaux. <br><br>  Il existe trois types de canaux entrants dans Open Lines: <br><br><ul><li>  Externe qui fonctionne via le serveur de file d'attente. </li><li>  Chat en direct qui s'exécute sur le portail client.  Nous prenons le code du widget depuis le portail client.  Et dans ce cas, il n'est pas question de non-remise de messages - si le portail "ment", le widget de chat ne sera tout simplement pas affiché. </li><li>  Réseau - un canal qui vous permet de créer une «ligne ouverte» et de trouver parmi d'autres portails Bitrix24, y compris des box.  Cela est particulièrement vrai pour nos partenaires qui souhaitent organiser des chats de support pour leurs entreprises clientes.  Ces conversations fonctionnent via la plateforme de robots Bitrix24 et n'utilisent pas le serveur de connecteurs - toutes les opérations ont lieu à l'intérieur de notre plateforme. </li></ul><br>  Il y a une nuance importante dans toutes les lignes ouvertes et les connecteurs de connexion.  On suppose que le client est toujours le premier à prendre l'initiative.  Nous ne pouvons répondre qu'aux messages des utilisateurs.  Mais ne les écrivez pas d'abord. <br><br>  Le serveur est dans le cloud et est disponible 24/7.  Il accepte les messages des utilisateurs sans vacances ni week-end.  Pour un client avec la version en boîte de Bitrix24, le portail peut être temporairement indisponible: le serveur est tombé en panne ou des problèmes avec Internet.  Dans de tels cas, les messages des utilisateurs pourraient être perdus. <br><br>  Le serveur de connecteurs cloud résout ce problème. <br><br>  Tout d'abord, il achemine les messages directement vers les portails de destination.  Si un portail n'est pas disponible, le serveur de connecteurs accumule des messages pour ce portail pendant la journée.  Et en essayant de les livrer sur le portail. <br><br>  Nous avons calculé que 24 heures suffisent pour résoudre les problèmes et redémarrer le portail de version en boîte.  Nous avons fortement insisté sur le fait que l'ordre des messages ne change pas.  Tout le contenu sera livré dans l'ordre exact dans lequel il a été rédigé.  Des messages personnalisés, quoique avec un retard, mais seront livrés. <br><br>  Tous les systèmes externes ont leurs propres formats de message, avec leurs propres ensembles de données.  Quelque part, vous pouvez échanger des emojis, des images et d'autres fichiers.  Et quelque part, seul le texte est disponible avec un ensemble très limité de fonctionnalités. <br><br>  Serveur de connecteurs: <br><br><ul><li>  Convertit tous les messages entrants dans un format universel que les portails comprennent. </li><li>  Chiffre les données et les signe avec une clé de licence. </li><li>  Les envoie aux portails. </li></ul><br>  Le cryptage est nécessaire non seulement pour protéger la correspondance elle-même, mais aussi pour confirmer l'authenticité des parties. <br><br>  Après avoir unifié le format du message, ils sont mis en file d'attente.  De là, ils se dispersent aux destinataires. <br><br>  Les réseaux sociaux peuvent générer des messages avec une fréquence impressionnante, mais tous les portails clients ne peuvent pas se vanter d'un matériel puissant.  D'autres tâches peuvent être effectuées en parallèle sur la même machine. <br><br>  Et si les messages vont "puits" - il y a une possibilité de duplication des sessions.  Pour éviter que cela ne se produise, les messages sont envoyés à chaque portail en un seul flux, en paquets et avec un léger retard. <br><br>  Maintenant, le tour tourne sur le serveur de connecteurs, mais nous avons déjà un serveur évolutif distinct.  Il prend en charge les files d'attente de différents types: <br><br><ol><li>  Parallèle dans plusieurs threads. </li><li>  Séquentielle dans un fil. </li></ol><br>  La livraison peut être: <br><br><ol><li>  Garanti.  Beaucoup de tentatives. </li><li>  Injustifié.  Un essai. </li></ol><br>  Bientôt, nous transférerons sur ce serveur les connecteurs des réseaux sociaux, des plateformes de robots et des messageries instantanées.  Hourra! <br><br><h2>  Configurer et traiter les messages </h2><br>  Nous avons essayé de rendre la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">connexion et la configuration d'</a> Open Lines aussi simples que possible. <br><br>  Bitrix24 est utilisé par une grande variété d'entreprises, des grands représentants de l'informatique aux entrepreneurs individuels vendant des pièces automobiles.  Il est encore plus facile pour un administrateur informatique de faire quelques clics.  Et n'étudiez pas la documentation, enregistrez les clés et les configurations. <br><br>  Dans "Open Lines", il existe un certain nombre de paramètres pour la file d'attente des opérateurs, les heures de travail, l'utilisation de CRM, divers suiveurs de chat et formulaires. <br><br>  Le système prend en compte si la journée de travail a commencé avec un opérateur particulier, qu'il soit en ligne ou hors ligne, et un certain nombre d'autres paramètres. <br><br>  Pour traiter les messages, les opérateurs utilisent soit l'application Bitrix24 soit le messager intégré.  Il existe des outils de gestion supplémentaires: accepter, ignorer, rejeter, terminer. <br><br>  Après avoir terminé la correspondance avec l'utilisateur, le système peut automatiquement lui demander de noter. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr414797/">https://habr.com/ru/post/fr414797/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr414779/index.html">Revue Vertex Impress Nero: métal + écran 18: 9 + batterie 3300 mAh pour 6 990 roubles</a></li>
<li><a href="../fr414785/index.html">Visualisation des données avec Angular et D3</a></li>
<li><a href="../fr414787/index.html">Le nouveau RAT Android utilise le protocole Telegram</a></li>
<li><a href="../fr414789/index.html">Tesla Model S est de nouveau sous tension et un sabotage intentionnel [selon Elon Mask] est révélé dans l'atelier de montage de Model 3</a></li>
<li><a href="../fr414793/index.html">Comment fonctionnent les canaux de paiement et le réseau Lightning dans Bitcoin?</a></li>
<li><a href="../fr414799/index.html">LLTR Partie 0: Détection automatique de la topologie du réseau et commutateurs non gérés. Mission impossible?</a></li>
<li><a href="../fr414801/index.html">Moscou Vue.js Meetup # 2 chez Mail.Ru Group</a></li>
<li><a href="../fr414803/index.html">Comment nous avons vu les paiements IoT lors d'un hackathon à Hong Kong</a></li>
<li><a href="../fr414805/index.html">Webinaire ouvert "Méthodes alternatives de recrutement"</a></li>
<li><a href="../fr414809/index.html">Swift 4.1: pourquoi Apple a renommé flatMap en compactMap</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>