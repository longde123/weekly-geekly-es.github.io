<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ– ğŸ‘¨â€ğŸ­ ğŸ¤³ğŸ½ Comment nous avons crÃ©Ã© Open Lines chez Bitrix24 ğŸ‘¨ğŸ½â€ğŸ”¬ ğŸª ğŸ”‡</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Aujourd'hui, les utilisateurs ne veulent pas communiquer avec les entreprises par e-mail et par tÃ©lÃ©phone, mais via leurs messageries instantanÃ©es et ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Comment nous avons crÃ©Ã© Open Lines chez Bitrix24</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/bitrix/blog/414797/">  Aujourd'hui, les utilisateurs ne veulent pas communiquer avec les entreprises par e-mail et par tÃ©lÃ©phone, mais via leurs messageries instantanÃ©es et comptes de rÃ©seaux sociaux prÃ©fÃ©rÃ©s. <br><br>  En rÃ©ponse, les rÃ©seaux sociaux et les messageries instantanÃ©es ont commencÃ© Ã  introduire de nouvelles fonctionnalitÃ©s.  VKontakte et Facebook ont â€‹â€‹dÃ©ployÃ© des messages privÃ©s pour les groupes et les pages publiques. <br><br>  Le tÃ©lÃ©gramme avec ses chaÃ®nes et ses bots est devenu une plateforme de publication et d'interaction avec le public.  A Viber, des comptes publics sont apparus. <br><br>  Pour obtenir le profit maximum, les entreprises doivent utiliser toutes les capacitÃ©s de toutes les plateformes sociales. <br><br>  Ainsi, Open Lines est nÃ© - un nouvel outil pour l'interaction des clients Bitrix24 avec les utilisateurs finaux. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/703/824/144/70382414416e170d5519600c0ee6cc58.png"><br><a name="habracut"></a><br>  Le workflow Open Lines est simple: <br><br><ol><li>  Nous recevons tous les messages des utilisateurs des messagers et des rÃ©seaux sociaux. </li><li>  Nous les acheminons Ã  l'aide du messager Â«Bitrix24Â» intÃ©grÃ©.  Nous distribuons par les opÃ©rateurs </li><li>  Les clients rÃ©pondent aux messages et nous renvoyons les rÃ©ponses aux responsables des entreprises travaillant chez Bitrix24 </li></ol><br>  La principale tÃ¢che de dÃ©veloppement de ce projet est de simplifier autant que possible la connexion des canaux de communication.  Pour que tout gestionnaire moyen puisse le faire.  Pour ce faire, j'ai dÃ» nÃ©gocier avec les dÃ©veloppeurs de tous les rÃ©seaux sociaux intÃ©grables et les messageries instantanÃ©es - tout est officiel, pas de trucs. <br><br>  Et pour assurer un fonctionnement stable dans les versions cloud et en boÃ®te de Bitrix24, nous avons crÃ©Ã© un serveur de connecteurs centralisÃ©.  Il traite tous les flux d'informations. <br><br><h2>  VKontakte </h2><br>  La prochaine Ã©tape, nous avons pris un duo avec les dÃ©veloppeurs de VKontakte.  Nous avons rÃ©ussi Ã  construire le schÃ©ma optimal pour travailler avec le service - maintenant nous avons fait un tas d'actions techniques pour que les utilisateurs se connectent. <br><br>  Maintenant, cette API VKontakte peut utiliser d'autres services. <br><br>  Ã€ quoi ressemble la connexion Open Lines pour un utilisateur rÃ©gulier: <br><br><ul><li>  Connectez-vous Ã  VK. </li><li>  Dans la section de connexion, sÃ©lectionnez le groupe souhaitÃ©. </li><li>  Confirmez. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/87c/bbb/e8b/87cbbbe8b671c848012b7bcd48b05c9e.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/c29/31b/fcb/c2931bfcb0c36553963f5e75d2427ad0.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b88/341/b78/b88341b78a35dc771280fbb6d8fbba43.png"><br><br>  Cela semble simple, mais seulement parce que nous avons cachÃ© toute la "cuisine" sous le capot - une dizaine d'opÃ©rations, ainsi que des demandes de clÃ©s diffÃ©rentes. <br><br><h2>  Skype </h2><br>  Mais avec Microsoft, c'Ã©tait difficile.  Malheureusement, ils sont trÃ¨s concentrÃ©s sur les informaticiens de la Â«vieille Ã©coleÂ».  Se connecter Ã  leur framework de bot s'est avÃ©rÃ© difficile.  Maintenant, pour cela, vous devez passer par une quÃªte d'horreur: <br><br><ul><li>  Installez l'appli. </li><li>  CrÃ©ez un compte. </li><li>  Dans Skype, prenez une clÃ©. </li><li>  Dans Bitrix 24, un autre. </li><li>  Pour se connecter. </li></ul><br><h2>  Viber </h2><br>  Nous avons fait de cette intÃ©gration l'une des premiÃ¨res.  Nous avons constamment communiquÃ© avec les dÃ©veloppeurs du messager.  Et en gÃ©nÃ©ral, ils gardaient la main sur le pouls.  Maintenant, Open Lines peut Ãªtre connectÃ© depuis Bitrix24 ou depuis l'application mobile Viber. <br><br><h2>  TÃ©lÃ©gramme </h2><br>  Telegram a une API simple - la connexion est simple.  Et malgrÃ© toutes les serrures, maintenant tout fonctionne. <br><br><h2>  Instagram </h2><br>  L'intÃ©gration avec Instagram est l'une des plus populaires parmi nos clients.  Mais en raison du scandale de la propagation des donnÃ©es personnelles, Instagram a considÃ©rablement rÃ©duit les capacitÃ©s de l'API. <br><br>  Nous devons Â«l'interviewerÂ» et dÃ©terminer nous-mÃªmes de nouveaux messages toutes les 15 minutes.  De plus, l'API vous permet de recevoir non pas les messages eux-mÃªmes, mais uniquement les commentaires sur les publications.  Il y a Ã©galement une limite au nombre de rÃ©ponses par heure. <br><br>  Les systÃ¨mes externes sont des organismes vivants dans lesquels quelque chose change constamment.  Dans l'API des rÃ©seaux sociaux et des messageries instantanÃ©es, certains changements sont apportÃ©s, il y a souvent des erreurs de l'autre cÃ´tÃ©. <br><br>  Un exemple.  VKontakte a cassÃ© l'encodage des noms de marchandises, ils ont rÃ©solu ce problÃ¨me en un an.  Instagram n'a averti personne de dÃ©sactiver un certain nombre de fonctions API - nous avons dÃ©couvert aprÃ¨s le fait que certaines fonctionnalitÃ©s ne fonctionnaient plus.  Nous avons dÃ» chercher des solutions en mode d'urgence. <br><br>  AprÃ¨s une intÃ©gration rÃ©ussie du rÃ©seau social ou du messager, vous ne pouvez plus vous dÃ©tendre.  Nous devons constamment contrÃ´ler l'exactitude du traitement des messages entrants. <br><br><h2>  Serveur de connecteur </h2><br>  L'architecture Open Lines est basÃ©e sur un serveur de connecteurs.  Il s'agit d'un point d'entrÃ©e unique dans le schÃ©ma de messagerie entre le messager interne Bitrix24 et les messagers externes et les rÃ©seaux sociaux. <br><br>  Il existe trois types de canaux entrants dans Open Lines: <br><br><ul><li>  Externe qui fonctionne via le serveur de file d'attente. </li><li>  Chat en direct qui s'exÃ©cute sur le portail client.  Nous prenons le code du widget depuis le portail client.  Et dans ce cas, il n'est pas question de non-remise de messages - si le portail "ment", le widget de chat ne sera tout simplement pas affichÃ©. </li><li>  RÃ©seau - un canal qui vous permet de crÃ©er une Â«ligne ouverteÂ» et de trouver parmi d'autres portails Bitrix24, y compris des box.  Cela est particuliÃ¨rement vrai pour nos partenaires qui souhaitent organiser des chats de support pour leurs entreprises clientes.  Ces conversations fonctionnent via la plateforme de robots Bitrix24 et n'utilisent pas le serveur de connecteurs - toutes les opÃ©rations ont lieu Ã  l'intÃ©rieur de notre plateforme. </li></ul><br>  Il y a une nuance importante dans toutes les lignes ouvertes et les connecteurs de connexion.  On suppose que le client est toujours le premier Ã  prendre l'initiative.  Nous ne pouvons rÃ©pondre qu'aux messages des utilisateurs.  Mais ne les Ã©crivez pas d'abord. <br><br>  Le serveur est dans le cloud et est disponible 24/7.  Il accepte les messages des utilisateurs sans vacances ni week-end.  Pour un client avec la version en boÃ®te de Bitrix24, le portail peut Ãªtre temporairement indisponible: le serveur est tombÃ© en panne ou des problÃ¨mes avec Internet.  Dans de tels cas, les messages des utilisateurs pourraient Ãªtre perdus. <br><br>  Le serveur de connecteurs cloud rÃ©sout ce problÃ¨me. <br><br>  Tout d'abord, il achemine les messages directement vers les portails de destination.  Si un portail n'est pas disponible, le serveur de connecteurs accumule des messages pour ce portail pendant la journÃ©e.  Et en essayant de les livrer sur le portail. <br><br>  Nous avons calculÃ© que 24 heures suffisent pour rÃ©soudre les problÃ¨mes et redÃ©marrer le portail de version en boÃ®te.  Nous avons fortement insistÃ© sur le fait que l'ordre des messages ne change pas.  Tout le contenu sera livrÃ© dans l'ordre exact dans lequel il a Ã©tÃ© rÃ©digÃ©.  Des messages personnalisÃ©s, quoique avec un retard, mais seront livrÃ©s. <br><br>  Tous les systÃ¨mes externes ont leurs propres formats de message, avec leurs propres ensembles de donnÃ©es.  Quelque part, vous pouvez Ã©changer des emojis, des images et d'autres fichiers.  Et quelque part, seul le texte est disponible avec un ensemble trÃ¨s limitÃ© de fonctionnalitÃ©s. <br><br>  Serveur de connecteurs: <br><br><ul><li>  Convertit tous les messages entrants dans un format universel que les portails comprennent. </li><li>  Chiffre les donnÃ©es et les signe avec une clÃ© de licence. </li><li>  Les envoie aux portails. </li></ul><br>  Le cryptage est nÃ©cessaire non seulement pour protÃ©ger la correspondance elle-mÃªme, mais aussi pour confirmer l'authenticitÃ© des parties. <br><br>  AprÃ¨s avoir unifiÃ© le format du message, ils sont mis en file d'attente.  De lÃ , ils se dispersent aux destinataires. <br><br>  Les rÃ©seaux sociaux peuvent gÃ©nÃ©rer des messages avec une frÃ©quence impressionnante, mais tous les portails clients ne peuvent pas se vanter d'un matÃ©riel puissant.  D'autres tÃ¢ches peuvent Ãªtre effectuÃ©es en parallÃ¨le sur la mÃªme machine. <br><br>  Et si les messages vont "puits" - il y a une possibilitÃ© de duplication des sessions.  Pour Ã©viter que cela ne se produise, les messages sont envoyÃ©s Ã  chaque portail en un seul flux, en paquets et avec un lÃ©ger retard. <br><br>  Maintenant, le tour tourne sur le serveur de connecteurs, mais nous avons dÃ©jÃ  un serveur Ã©volutif distinct.  Il prend en charge les files d'attente de diffÃ©rents types: <br><br><ol><li>  ParallÃ¨le dans plusieurs threads. </li><li>  SÃ©quentielle dans un fil. </li></ol><br>  La livraison peut Ãªtre: <br><br><ol><li>  Garanti.  Beaucoup de tentatives. </li><li>  InjustifiÃ©.  Un essai. </li></ol><br>  BientÃ´t, nous transfÃ©rerons sur ce serveur les connecteurs des rÃ©seaux sociaux, des plateformes de robots et des messageries instantanÃ©es.  Hourra! <br><br><h2>  Configurer et traiter les messages </h2><br>  Nous avons essayÃ© de rendre la <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">connexion et la configuration d'</a> Open Lines aussi simples que possible. <br><br>  Bitrix24 est utilisÃ© par une grande variÃ©tÃ© d'entreprises, des grands reprÃ©sentants de l'informatique aux entrepreneurs individuels vendant des piÃ¨ces automobiles.  Il est encore plus facile pour un administrateur informatique de faire quelques clics.  Et n'Ã©tudiez pas la documentation, enregistrez les clÃ©s et les configurations. <br><br>  Dans "Open Lines", il existe un certain nombre de paramÃ¨tres pour la file d'attente des opÃ©rateurs, les heures de travail, l'utilisation de CRM, divers suiveurs de chat et formulaires. <br><br>  Le systÃ¨me prend en compte si la journÃ©e de travail a commencÃ© avec un opÃ©rateur particulier, qu'il soit en ligne ou hors ligne, et un certain nombre d'autres paramÃ¨tres. <br><br>  Pour traiter les messages, les opÃ©rateurs utilisent soit l'application Bitrix24 soit le messager intÃ©grÃ©.  Il existe des outils de gestion supplÃ©mentaires: accepter, ignorer, rejeter, terminer. <br><br>  AprÃ¨s avoir terminÃ© la correspondance avec l'utilisateur, le systÃ¨me peut automatiquement lui demander de noter. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr414797/">https://habr.com/ru/post/fr414797/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr414779/index.html">Revue Vertex Impress Nero: mÃ©tal + Ã©cran 18: 9 + batterie 3300 mAh pour 6 990 roubles</a></li>
<li><a href="../fr414785/index.html">Visualisation des donnÃ©es avec Angular et D3</a></li>
<li><a href="../fr414787/index.html">Le nouveau RAT Android utilise le protocole Telegram</a></li>
<li><a href="../fr414789/index.html">Tesla Model S est de nouveau sous tension et un sabotage intentionnel [selon Elon Mask] est rÃ©vÃ©lÃ© dans l'atelier de montage de Model 3</a></li>
<li><a href="../fr414793/index.html">Comment fonctionnent les canaux de paiement et le rÃ©seau Lightning dans Bitcoin?</a></li>
<li><a href="../fr414799/index.html">LLTR Partie 0: DÃ©tection automatique de la topologie du rÃ©seau et commutateurs non gÃ©rÃ©s. Mission impossible?</a></li>
<li><a href="../fr414801/index.html">Moscou Vue.js Meetup # 2 chez Mail.Ru Group</a></li>
<li><a href="../fr414803/index.html">Comment nous avons vu les paiements IoT lors d'un hackathon Ã  Hong Kong</a></li>
<li><a href="../fr414805/index.html">Webinaire ouvert "MÃ©thodes alternatives de recrutement"</a></li>
<li><a href="../fr414809/index.html">Swift 4.1: pourquoi Apple a renommÃ© flatMap en compactMap</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>