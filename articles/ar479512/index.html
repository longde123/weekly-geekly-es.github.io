<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>๐ ๐ฆ ๐ MVCC ูู PostgreSQL-4. ููุทุงุช ๐คฌ ๐ธ ๐ค</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ุจุนุฏ ุฃู ูุงูุดูุง ูุดููุงุช ุงูุนุฒู ูุฌุนููุง ุงุณุชุทุฑุงุฏุง ูููุง ูุชุนูู ุจูููู ุงูุจูุงูุงุช ููุฎูุถ ุงููุณุชูู ุ ูู ุขุฎุฑ ูุฑุฉ ุงุณุชูุดููุง ุฅุตุฏุงุฑุงุช ุงูุตููู ููุงุญุธูุง ููู ุบูุฑุช ุงูุนูููุงุช ุงููุฎ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>MVCC ูู PostgreSQL-4. ููุทุงุช</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/postgrespro/blog/479512/" style=";text-align:right;direction:rtl">  ุจุนุฏ ุฃู ูุงูุดูุง ูุดููุงุช <a href="https://habr.com/ru/company/postgrespro/blog/467437/">ุงูุนุฒู</a> ูุฌุนููุง ุงุณุชุทุฑุงุฏุง ูููุง ูุชุนูู <a href="https://habr.com/ru/company/postgrespro/blog/469087/">ุจูููู ุงูุจูุงูุงุช ููุฎูุถ ุงููุณุชูู</a> ุ ูู ุขุฎุฑ ูุฑุฉ ุงุณุชูุดููุง <a href="https://habr.com/ru/company/postgrespro/blog/477648/">ุฅุตุฏุงุฑุงุช ุงูุตููู</a> ููุงุญุธูุง ููู ุบูุฑุช ุงูุนูููุงุช ุงููุฎุชููุฉ ุญููู ุฑุคูุณ <a href="https://habr.com/ru/company/postgrespro/blog/477648/">ุงูุตููู</a> . <br><br>  ุณูุจุญุซ ุงูุขู ูู ููููุฉ ุงูุญุตูู ุนูู ููุทุงุช ุจูุงูุงุช ูุชุณูุฉ ูู ุงููุฌููุนุงุช. <br><br><h1 style=";text-align:right;direction:rtl">  ูุง ูู ููุทุฉ ุงูุจูุงูุงุชุ </h1><br>  ูููู ุฃู ุชุญุชูู ุตูุญุงุช ุงูุจูุงูุงุช ูุนูููุง ุนูู ุนุฏุฉ ุฅุตุฏุงุฑุงุช ูู ููุณ ุงูุตู.  ูููู ูุฌุจ ุฃู ุชุฑู ูู ูุนุงููุฉ ุฅุตุฏุงุฑูุง ูุงุญุฏูุง (ุฃู ูุง ุดูุก) ูู ูู ุตู ุ ุจุญูุซ ุชุดูู ุฌููุนูุง ุตูุฑุฉ ูุชุณูุฉ ููุจูุงูุงุช (ุจูุนูู ACID) ูููุทุฉ ุฒูููุฉ ูุญุฏุฏุฉ. <br><br>  ูุนุชูุฏ ุงูุนุฒู ูู PosgreSQL ุนูู ููุทุงุช: ูู ูุนุงููุฉ ุชุนูู ูุน ููุทุฉ ุงูุจูุงูุงุช ุงูุฎุงุตุฉ ุจูุง ุ ูุงูุชู "ุชุญุชูู ุนูู" ุงูุจูุงูุงุช ุงูุชู ุชู ุงูุงูุชุฒุงู ุจูุง ูุจู ูุญุธุฉ ุฅูุดุงุก ุงูููุทุฉ ููุง "ุชุญุชูู" ุนูู ุงูุจูุงูุงุช ุงูุชู ูู ูุชู ุงูุงูุชุฒุงู ุจูุง ูู ุชูู ุงููุญุธุฉ ุญุชู ุงูุขู.  ููุฏ <a href="https://habr.com/ru/company/postgrespro/blog/467437/">ุฑุฃููุง ุจุงููุนู</a> ุฃูู ุนูู ุงูุฑุบู ูู ุฃู ุงูุนุฒูุฉ ุงููุงุชุฌุฉ ุชุจุฏู ุฃูุซุฑ ุตุฑุงูุฉ ููุง ูู ูุทููุจ ูู ูุจู ุงููุนูุงุฑ ุ ูุฅูู ูุง ูุฒุงู ูุฏูู ุงูุดุฐูุฐ. <br><a name="habracut"></a><br>  ุนูุฏ ูุณุชูู ุนุฒู ุงููุฑุงุกุฉ ุงูููุชุฒู ุจูุง ุ ูุชู ุฅูุดุงุก ููุทุฉ ูู ุจุฏุงูุฉ ูู ุนุจุงุฑุฉ ูุนุงููุฉ.  ูุฐู ุงูููุทุฉ ูุดุทุฉ ุฃุซูุงุก ุชูููุฐ ุงูุจูุงู.  ูู ุงูุดูู ุ ูุชู ุนุฑุถ ุงููุญุธุฉ ุงูุชู ุชู ูููุง ุฅูุดุงุก ุงูููุทุฉ (ูุงูุชู ุ ููุง ูุฐูุฑ ุ ุจูุนุฑู ุงููุนุงููุฉ) ุจุงูููู ุงูุฃุฒุฑู. <br><br><img src="https://habrastorage.org/webt/jy/i7/bt/jyi7btkmmha--gyzq7giozodsze.png"><br><br>  ุนูุฏ ูุณุชููุงุช ุงููุฑุงุกุฉ ุงููุงุจูุฉ ููุชูุฑุงุฑ ูุงููุงุจูุฉ ููุชุณูุณู ุ ูุชู ุฅูุดุงุก ุงูููุทุฉ ูุฑุฉ ูุงุญุฏุฉ ุ ูู ุจุฏุงูุฉ ุฃูู ุจูุงู ูููุนุงููุฉ.  ุชุจูู ูุฐู ุงูููุทุฉ ูุดุทุฉ ุญุชู ููุงูุฉ ุงููุนุงููุฉ. <br><br><img src="https://habrastorage.org/webt/i5/gq/lt/i5gqltpae5nzbrwjree45wfl8_a.png"><br><br><h1 style=";text-align:right;direction:rtl">  ุฑุคูุฉ tuples ูู ููุทุฉ </h1><br><h2 style=";text-align:right;direction:rtl">  ููุงุนุฏ ุงูุฑุคูุฉ </h2><br>  ููุทุฉ ููุณุช ุจุงูุชุฃููุฏ ูุณุฎุฉ ูุงุฏูุฉ ูู ุฌููุน tuples ุงููุงุฒูุฉ.  ูุชู ุชุญุฏูุฏ ููุทุฉ ูู ุงููุงูุน ูู ูุจู ุนุฏุฉ ุฃุฑูุงู ุ ููุชู ุชุญุฏูุฏ ูุฏู ุฑุคูุฉ tuples ูู ููุทุฉ ูู ุงูููุงุนุฏ. <br><br>  ูุนุชูุฏ ุชุญุฏูุฏ ูุง ุฅุฐุง ูุงู ุณูุชู ุธููุฑ tuple ุฃู ูุง ูู ููุทุฉ ุนูู ุญูููู ูู ุงูุฑุฃุณ ุ ูููุง <code>xmin</code> ู <code>xmax</code> ุ ุฃู ูุนุฑูุงุช ุงููุนุงููุงุช ุงูุชู ุฃูุดุฃุชูุง ูุญุฐูุชูุง.  ูุง ุชุชุฏุงุฎู ุงูููุงุตู ุงูุฒูููุฉ ูู ูุฐุง ุงููุจูู ุ ูุจุงูุชุงูู ุ ูุง ููุซู ุฃูุซุฑ ูู ุฅุตุฏุงุฑ ุตููุง ูู ูู ููุทุฉ. <br><br>  ููุงุนุฏ ุงูุฑุคูุฉ ุงูุฏูููุฉ ูุนูุฏุฉ ููุบุงูุฉ ูุชุฑุงุนู ุงููุซูุฑ ูู ุงูุญุงูุงุช ูุงูุชุทูุฑุงุช ุงููุฎุชููุฉ. <br><blockquote style=";text-align:right;direction:rtl">  ููููู ุงูุชุฃูุฏ ุจุณูููุฉ ูู ุฐูู ูู ุฎูุงู ุงูุจุญุซ ูู src / backend / utils / time / tqual.c (ูู ุงูุฅุตุฏุงุฑ 12 ุ ุชู ููู ุงูุดูู ุฅูู src / backend / access / heap / heapam_visibility.c). <br></blockquote><br>  ูุชุจุณูุท ุ ูููููุง ุฃู ูููู ุฃู tuple ูููู ูุฑุฆููุง ุนูุฏูุง ุชููู ุงูุชุบููุฑุงุช ุงูุชู ุฃุฌุฑูุช ุจูุงุณุทุฉ <code>xmin</code> ูุฑุฆูุฉ ูู ุงูููุทุฉ ุ ูู ุญูู ุฃู ุงูุชุบููุฑุงุช ุงูุชู ุชู ุฅุฌุฑุงุคูุง ุจูุงุณุทุฉ ูุนุงููุฉ <code>xmax</code> ููุณุช (ุจูุนูู ุขุฎุฑ ุ ูู ุงููุงุถุญ ุจุงููุนู ุฃู tuple ูุฏ ุชู ุฅูุดุงุคู ุ ูููู ููุณ ูู ุงููุงุถุญ ุจุนุฏ ูุง ุฅุฐุง ูุงู ูุฏ ุชู ุญุฐูู). <br><br>  ูููุง ูุชุนูู ุจุงููุนุงููุฉ ุ ุชููู ุชุบููุฑุงุชูุง ูุฑุฆูุฉ ูู ุงูููุทุฉ ุฅูุง ุฅุฐุง ูุงูุช ุชูู ุงููุนุงููุฉ ุฐุงุชูุง ูู ุงูุชู ุฃูุฌุฏุช ุงูููุทุฉ (ุชุฑู ุงูุชุบููุฑุงุช ุงูุชู ูู ุชูุชุฒู ุจูุง ุจุนุฏ) ุฃู ุชู ุงูุงูุชุฒุงู ุจุงููุนุงููุฉ ูุจู ุฅูุดุงุก ุงูููุทุฉ. <br><br>  ูููููุง ุชูุซูู ุงููุนุงููุงุช ุญุณุจ ุงููุทุงุนุงุช ุจูุงููุงู (ูู ููุช ุงูุจุฏุก ุฅูู ููุช ุงูุงูุชุฒุงู): <br><br><img src="https://habrastorage.org/webt/or/nv/ir/ornvirvfxjcpp0djg6-1e03vffw.png"><br><br>  ููุง: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุณุชููู ุชุบููุฑุงุช ุงููุนุงููุฉ 2 ูุฑุฆูุฉ ููุฐ ุงูุชูุงููุง ูุจู ุฅูุดุงุก ุงูููุทุฉ. </li><li style=";text-align:right;direction:rtl">  ูู ุชููู ุชุบููุฑุงุช ุงููุนุงููุฉ 1 ูุฑุฆูุฉ ูุฃููุง ูุงูุช ูุดุทุฉ ูู ุงููุญุธุฉ ุงูุชู ุชู ูููุง ุฅูุดุงุก ุงูููุทุฉ. </li><li style=";text-align:right;direction:rtl">  ูู ุชููู ุชุบููุฑุงุช ุงููุนุงููุฉ 3 ูุฑุฆูุฉ ููุฐ ุฃู ุจุฏุฃุช ุจุนุฏ ุฅูุดุงุก ุงูููุทุฉ (ุจุบุถ ุงููุธุฑ ุนูุง ุฅุฐุง ูุงูุช ูุฏ ุงูุชููุช ุฃู ูุง). </li></ul><br>  ูุณูุก ุงูุญุธ ุ ูุฅู ุงููุธุงู ูุง ูุฏุฑู ููุช ุงุฑุชูุงุจ ุงููุนุงููุงุช.  ููุนุฑู ููุท ููุช ุงูุจุฏุก (ุงูุฐู ูุชู ุชุญุฏูุฏู ุจูุงุณุทุฉ ูุนุฑู ุงููุนุงููุฉ ููุชู ุชูููุฒู ุจุฎุท ูุชูุทุน ูู ุงูุฃุดูุงู ุฃุนูุงู) ุ ูููู ูู ูุชู ูุชุงุจุฉ ุญุฏุซ ุงูุงูุชูุงุก ูู ุฃู ููุงู. <br><br>  ูู ูุง ูููููุง ูุนูู ูู ูุนุฑูุฉ ุงูุญุงูุฉ <em>ุงูุญุงููุฉ</em> ูููุนุงููุงุช ุนูุฏ ุฅูุดุงุก ุงูููุทุฉ.  ุชุชููุฑ ูุฐู ุงููุนูููุงุช ูู ุงูุฐุงูุฑุฉ ุงููุดุชุฑูุฉ ููุฎุงุฏู ุ ูู ุจููุฉ ProcArray ุ ูุงูุชู ุชุญุชูู ุนูู ูุงุฆูุฉ ุจุฌููุน ุงูุฌูุณุงุช ุงููุดุทุฉ ููุนุงููุงุชูุง. <br><br>  ููููุง ูู ูููู ูุงุฏุฑูู ุนูู ูุนุฑูุฉ ูุง ุจุนุฏ ุงููุงูุน ูุง ุฅุฐุง ูุงูุช ูุนุงููุฉ ูุนููุฉ ูุงูุช ูุดุทุฉ ุฃู ูุง ูู ูุญุธุฉ ุฅูุดุงุก ุงูููุทุฉ.  ูุฐูู ุ ูุฌุจ ุนูู ููุทุฉ ูุชุฎุฒูู ูุงุฆูุฉ ุจุฌููุน ุงููุนุงููุงุช ุงููุดุทุฉ ุงูุญุงููุฉ. <br><br>  ูุชุถุญ ููุง ุณุจู ุฃูู ูู PostgreSQL ุ ูุง ูููู ุฅูุดุงุก ููุทุฉ ุชุธูุฑ ุจูุงูุงุช ูุชุณูุฉ ูู ููุช ูุนูู ุฅูู ุงููุฑุงุก ุ <em>ุญุชู ูู ูุงูุช</em> ุฌููุน ุงููุฌููุนุงุช ุงูุถุฑูุฑูุฉ ูุชููุฑุฉ ูู ุตูุญุงุช ุงูุฌุฏูู.  ุบุงูุจูุง ูุง ูุทุฑุญ ุณุคุงู ุนู ุณุจุจ ุนุฏู ูุฌูุฏ PostgreSQL ูุงุณุชุนูุงูุงุช ุงุณุชุนุงุฏูุฉ (ุฃู ูุคูุชุฉ ุ ุฃู ุงุณุชุฑุฌุงุนูุฉ ุ ูุซู ุงุณุชุฏุนุงุก Oracle ููุง) - ููุฐุง ุฃุญุฏ ุงูุฃุณุจุงุจ. <br><blockquote style=";text-align:right;direction:rtl">  ููุน ูู ุงููุถุญู ูู ุฃู ูุฐู ุงููุธููุฉ ูุงูุช ูุชุงุญุฉ ูุฃูู ูุฑุฉ ุ ูููู ุจุนุฏ ุฐูู ุชู ุญุฐููุง ูู DBMS.  ููููู ุฃู ุชูุฑุฃ ุนู ูุฐุง ูู <a href="https://arxiv.org/pdf/1901.01973.pdf">ููุงู ุฌูุฒูู ู</a> . <a href="https://arxiv.org/pdf/1901.01973.pdf">ูููุฑุดุชุงูู</a> . <br></blockquote><br>  ูุฐูู ุ ูุชู ุชุญุฏูุฏ ููุทุฉ ูู ูุจู ุงูุนุฏูุฏ ูู ุงููุนููุงุช: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูู ุงููุญุธุฉ ุงูุชู ุชู ูููุง ุฅูุดุงุก ุงูููุทุฉ ุ ุจูุนูู ุฃูุซุฑ ุฏูุฉ ุ ูุนุฑู ุงููุนุงููุฉ ุงูุชุงููุฉ ุ ููููู ุบูุฑ ูุชููุฑ ูู ุงููุธุงู ( <code>snapshot.xmax</code> ). </li><li style=";text-align:right;direction:rtl">  ูุงุฆูุฉ ุงููุนุงููุงุช ุงููุดุทุฉ (ููุฏ ุงูุชูุฏู) ูู ูุญุธุฉ ุฅูุดุงุก <code>snapshot.xip</code> ( <code>snapshot.xip</code> ). </li></ul><br>  ูู ุฃุฌู ุงูุฑุงุญุฉ ูุงูุชุญุณูู ุ ูุชู ุฃูุถูุง ุชุฎุฒูู ูุนุฑูู ุฃูู ูุนุงููุฉ ูุดุทุฉ ( <code>snapshot.xmin</code> ).  ูุฐู ุงููููุฉ ููุง ูุนูู ููู ุ ูุงูุชู ุณูุชู ููุงูุดุชูุง ุฃุฏูุงู. <br><br>  ููุน ุฐูู ุ ูุฅู ุงูููุทุฉ ุชุฎุฒู ุฃูุถูุง ุจุนุถ ุงููุนููุงุช ุงูุฅุถุงููุฉ ุงูุชู ูุง ุชุนุฏ ูููุฉ ุจุงููุณุจุฉ ููุง. <br><br><img src="https://habrastorage.org/webt/5z/dx/cf/5zdxcfxgsqzukzjqgyetvvahzru.png"><br><br><h2 style=";text-align:right;direction:rtl">  ูุซุงู </h2><br>  ูููู ููููุฉ ุชุญุฏูุฏ ุงูููุทุฉ ููุฑุคูุฉ ุ ุฏุนูุง ูุนูุฏ ุฅูุชุงุฌ ุงููุซุงู ุฃุนูุงู ุจุซูุงุซ ูุนุงููุงุช.  ูุญุชูู ุงูุฌุฏูู ุนูู ุซูุงุซุฉ ุตููู ุ ุญูุซ: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ุชูุช ุฅุถุงูุฉ ุงูุฃููู ุจูุงุณุทุฉ ูุนุงููุฉ ุจุฏุฃุช ูุจู ุฅูุดุงุก ุงูููุทุฉ ูููููุง ุงูุชููุช ุจุนุฏูุง. </li><li style=";text-align:right;direction:rtl">  ุชูุช ุฅุถุงูุฉ ุงูุซุงููุฉ ุจูุนุงููุฉ ุจุฏุฃุช ูุงุณุชูููุช ูุจู ุฅูุดุงุก ุงูููุทุฉ. </li><li style=";text-align:right;direction:rtl">  ุชูุช ุฅุถุงูุฉ ุงูุซุงูุซ ุจุนุฏ ุฅูุดุงุก ููุทุฉ. </li></ul><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">TRUNCATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> accounts;</code> </pre><br>  ุงููุนุงููุฉ ุงูุฃููู (ูู ุชูุชูู ุจุนุฏ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'1001'</span></span>, <span class="hljs-string"><span class="hljs-string">'alice'</span></span>, <span class="hljs-number"><span class="hljs-number">1000.00</span></span>); =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> txid_current();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">=&gt; SELECT txid_current(); txid_current -------------- 3695 (1 row)</code> </pre><br>  ุงููุนุงููุฉ ุงูุซุงููุฉ (ุงูุชููุช ูุจู ุฅูุดุงุก ุงูููุทุฉ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-string"><span class="hljs-string">'2001'</span></span>, <span class="hljs-string"><span class="hljs-string">'bob'</span></span>, <span class="hljs-number"><span class="hljs-number">100.00</span></span>); | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> txid_current();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| txid_current | -------------- | 3696 | (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br>  ุฅูุดุงุก ููุทุฉ ูู ูุนุงููุฉ ูู ุฌูุณุฉ ุฃุฎุฑู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ISOLATION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEVEL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPEATABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">READ</span></span>; || =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> xmin, xmax, * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">|| xmin | xmax | id | number | client | amount || ------+------+----+--------+--------+-------- || 3696 | 0 | 2 | 2001 | bob | 100.00 || (1 row)</code> </pre><br>  ุชูููุฐ ุงููุนุงููุฉ ุงูุฃููู ุจุนุฏ ุฅูุดุงุก ุงูููุทุฉ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br>  ูุงููุนุงููุฉ ุงูุซุงูุซุฉ (ุธูุฑุช ุจุนุฏ ุฅูุดุงุก ุงูููุทุฉ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-string"><span class="hljs-string">'2002'</span></span>, <span class="hljs-string"><span class="hljs-string">'bob'</span></span>, <span class="hljs-number"><span class="hljs-number">900.00</span></span>); | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> txid_current();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| txid_current | -------------- | 3697 | (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br>  ูู ุงููุงุถุญ ุ ุตู ูุงุญุฏ ููุท ูุง ูุฒุงู ูุฑุฆููุง ูู ููุทุฉ ูุฏููุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> xmin, xmax, * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">|| xmin | xmax | id | number | client | amount || ------+------+----+--------+--------+-------- || 3696 | 0 | 2 | 2001 | bob | 100.00 || (1 row)</code> </pre><br>  ูุงูุณุคุงู ูู ููู ูููู ุจูุณุชุฌุฑุณ ูุฐุง. <br><br>  ูุชู ุชุญุฏูุฏ ูู ุดูุก ุนู ุทุฑูู ููุทุฉ.  ุฏุนููุง ููุธุฑ ูู ุงูุฃูุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> txid_current_snapshot();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">|| txid_current_snapshot || ----------------------- || 3695:3697:3695 || (1 row)</code> </pre><br>  ุณุชุฌุฏ ููุง <code>snapshot.xmin</code> ู <code>snapshot.xmax</code> ู <code>snapshot.xip</code> ูุฏุฑุฌุฉ ููุญุฏุฏุฉ ุจุนูุงูุฉ ุงูููุทุชูู ( <code>snapshot.xip</code> ูู ุฑูู ูุงุญุฏ ูู ูุฐู ุงูุญุงูุฉ ุ ูููู ุจุตูุฉ ุนุงูุฉ ูู ูุงุฆูุฉ). <br><br>  ููููุง ููููุงุนุฏ ุงูููุถุญุฉ ุฃุนูุงู ุ ูู ุงูููุทุฉ ุ ูุฌุจ ุฃู ุชููู ูุฐู ุงูุชุบููุฑุงุช ูุฑุฆูุฉ ุงูุชู ุฃุฌุฑุงูุง ูุนุงููุงุช ูุน ุงููุนุฑูุงุช <code>xid</code> ุจุญูุซ <code>snapshot.xmin &lt;= xid &lt; snapshot.xmax</code> ุจุงุณุชุซูุงุก ุชูู ุงููุฏุฑุฌุฉ ูู ูุงุฆูุฉ <code>snapshot.xip</code> .  ุฏุนููุง ูููู ูุธุฑุฉ ุนูู ุฌููุน ุตููู ุงูุฌุฏูู (ูู ุงูููุทุฉ ุงูุฌุฏูุฏุฉ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> xmin, xmax, * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> id;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> xmin | xmax | id | number | client | amount ------+------+----+--------+--------+--------- 3695 | 0 | 1 | 1001 | alice | 1000.00 3696 | 0 | 2 | 2001 | bob | 100.00 3697 | 0 | 3 | 2002 | bob | 900.00 (3 rows)</code> </pre><br>  ุงูุตู ุงูุฃูู ุบูุฑ ูุฑุฆู: ุชู ุฅูุดุงุคู ุจูุงุณุทุฉ ูุนุงููุฉ ูุฏุฑุฌุฉ ูู ูุงุฆูุฉ ุงููุนุงููุงุช ุงููุดุทุฉ ( <code>xip</code> ). <br>  ุงูุตู ุงูุซุงูู ูุฑุฆู: ุชู ุฅูุดุงุคู ุจูุงุณุทุฉ ูุนุงููุฉ ููุฌูุฏุฉ ูู ูุทุงู ุงูููุทุฉ. <br>  ุงูุตู ุงูุซุงูุซ ุบูุฑ ูุฑุฆู: ุชู ุฅูุดุงุคู ุจูุงุณุทุฉ ูุนุงููุฉ ุฎุงุฑุฌ ูุทุงู ุงูููุทุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">|| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br><h1 style=";text-align:right;direction:rtl">  ุงูุชุบููุฑุงุช ุงููุนุงููุฉ ุงูุฎุงุตุฉ </h1><br>  ุชุญุฏูุฏ ูุฏู ูุถูุญ ุงูุชุบููุฑุงุช ุงูุฎุงุตุฉ ุจุงููุนุงููุฉ ูุนูุฏ ุฅูู ุญุฏ ูุง ุงููููู.  ูู ูุฐู ุงูุญุงูุฉ ุ ูุฏ ุชููู ููุงู ุญุงุฌุฉ ูุฑุคูุฉ ุฌุฒุก ููุท ูู ูุฐู ุงูุชุบููุฑุงุช.  ุนูู ุณุจูู ุงููุซุงู: ูู ุฃู ูุณุชูู ูู ูุณุชููุงุช ุงูุนุฒู ุ ูุฌุจ ุฃูุง ูุฑู ุงููุคุดุฑ ุงูุฐู ุชู ูุชุญู ูู ููุช ูุนูู ุชุบููุฑุงุช ูู ููุช ูุงุญู. <br><br>  ุชุญููููุง ููุฐู ุงูุบุงูุฉ ุ ูุญุชูู ุฑุฃุณ ุงููุฌููุนุฉ ุนูู ุญูู ุฎุงุต (ูุชู ุชูุซููู ูู <code>cmin</code> ู <code>cmax</code> ุงูุฒุงุฆูุฉ) ุ ูุงูุชู ุชุนุฑุถ ุฑูู ุงูุทูุจ ุฏุงุฎู ุงููุนุงููุฉ.  <code>cmin</code> ูู ุฑูู ุงูุฅุฏุฑุงุฌ ุ ู <code>cmax</code> - ููุญุฐู ุ ูููู ูุชูููุฑ ูุณุงุญุฉ ูู ุฑุฃุณ ุงููุฌููุนุฉ ุ ูุฐุง ูู ูู ุงููุงูุน ุญูู ูุงุญุฏ ุจุฏูุงู ูู ุญูููู ูุฎุชูููู.  ูู ุงูููุชุฑุถ ุฃู ุงููุนุงููุฉ ุชููู ุจุดูู ูุชูุฑุฑ ุจุฅุฏุฑุงุฌ ูุญุฐู ููุณ ุงูุตู. <br><br>  ูููู ูู ุญุงูุฉ ุญุฏูุซ ุฐูู ุ ูุชู ุฅุฏุฑุงุฌ ูุนุฑู ุฃูุฑ combo ุฎุงุต ( <code>combocid</code> ) ูู ููุณ ุงูุญูู ุ ูุชุชุฐูุฑ ุนูููุฉ ุงููุงุฌูุฉ ุงูุฎูููุฉ <code>cmin</code> ู <code>cmin</code> ุงููุนููุฉ ููุฐุง <code>combocid</code> .  ูููู ูุฐุง ุบุฑูุจ ุชูุงูุง. <br><br>  ููุง ูุซุงู ุจุณูุท.  ููุจุฏุฃ ูุนุงููุฉ ููุถูู ุตููุง ุฅูู ุงูุฌุฏูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> txid_current();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> txid_current -------------- 3698 (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs"><span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> accounts(id, number, client, amount) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">3001</span></span>, <span class="hljs-string"><span class="hljs-string">'charlie'</span></span>, <span class="hljs-number"><span class="hljs-number">100.00</span></span>);</code> </pre><br>  ุฏุนูุง <code>cmin</code> ูุญุชููุงุช ุงูุฌุฏูู ุ ุฅูู ุฌุงูุจ ุญูู <code>cmin</code> (ูููู ููุท ููุตููู ุงูุชู ุชุถูููุง ุงููุนุงููุฉ - ุจุงููุณุจุฉ ููุขุฎุฑูู ูุง ูุนูู ููุง): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> xmin, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> xmin = <span class="hljs-number"><span class="hljs-number">3698</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> cmin <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> cmin, * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> xmin | cmin | id | number | client | amount ------+------+----+--------+---------+--------- 3695 | | 1 | 1001 | alice | 1000.00 3696 | | 2 | 2001 | bob | 100.00 3697 | | 3 | 2002 | bob | 900.00 3698 | 0 | 4 | 3001 | charlie | 100.00 (4 rows)</code> </pre><br>  ููุชุญ ุงูุขู ูุคุดุฑูุง ูุงุณุชุนูุงู ููุฑุฌุน ุนุฏุฏ ุงูุตููู ูู ุงูุฌุฏูู. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> c <span class="hljs-keyword"><span class="hljs-keyword">CURSOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><br>  ูุจุนุฏ ุฐูู ูุถูู ุตููุง ุขุฎุฑ: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">INSERT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> accounts(id, number, client, amount) <span class="hljs-keyword"><span class="hljs-keyword">VALUES</span></span> (<span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-number"><span class="hljs-number">3002</span></span>, <span class="hljs-string"><span class="hljs-string">'charlie'</span></span>, <span class="hljs-number"><span class="hljs-number">200.00</span></span>);</code> </pre><br>  ุฅุฑุฌุงุน ุงูุงุณุชุนูุงู 4 - ุงูุตู ุงูุฐู ุชูุช ุฅุถุงูุชู ุจุนุฏ ูุชุญ ุงููุคุดุฑ ูุง ูุฏุฎู ูู ููุทุฉ ุงูุจูุงูุงุช: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">FETCH</span></span> c;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> count ------- 4 (1 row)</code> </pre><br>  ููุงุฐุงุ  ูุฃู ุงูููุทุฉ ุชุฃุฎุฐ ูู ุงูุงุนุชุจุงุฑ tuples ููุท ูุน <code>cmin &lt; 1</code> . <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> xmin, <span class="hljs-keyword"><span class="hljs-keyword">CASE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">WHEN</span></span> xmin = <span class="hljs-number"><span class="hljs-number">3698</span></span> <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> cmin <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> cmin, * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> xmin | cmin | id | number | client | amount ------+------+----+--------+---------+--------- 3695 | | 1 | 1001 | alice | 1000.00 3696 | | 2 | 2001 | bob | 100.00 3697 | | 3 | 2002 | bob | 900.00 3698 | 0 | 4 | 3001 | charlie | 100.00 3698 | 1 | 5 | 3002 | charlie | 200.00 (5 rows)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">ROLLBACK</span></span>;</code> </pre><br><h1 style=";text-align:right;direction:rtl">  ุฃูู ุงูุญุฏุซ </h1><br>  ูููู ููุนุฑู ุฃูุฏู ูุนุงููุฉ ูุดุทุฉ ( <code>snapshot.xmin</code> ) ูุนููู ูุงููุง: ููู ูุญุฏุฏ "ุฃูู ุงูุญุฏุซ" ูููุนุงููุฉ.  ุฃู ุฃูู ุฎุงุฑุฌ ุงูุฃูู ุ ูุง ุชุฑู ุงููุนุงููุงุช ุฏุงุฆููุง ุณูู ุฅุตุฏุงุฑุงุช ุงูุตู ุงููุญุฏุซุฉ. <br><br>  ุญููุง ุ ูุฌุจ ุฃู ูููู ุฅุตุฏุงุฑ ุงูุตู ุงููุฏูู (ุงูููุช) ูุฑุฆููุง ููุท ุนูุฏูุง ูุชู ุฅูุดุงุก ุงูุฅุตุฏุงุฑ ุงููุญุฏูุซ ุจูุนุงููุฉ ูู ุชูุชูู ุจุนุฏ ุ ูุจุงูุชุงูู ุ ูุฅูู ุบูุฑ ูุฑุฆู ุจุนุฏ.  ูููู ุฌููุน ุงููุนุงููุงุช "ูุฑุงุก ุงูุฃูู" ููุชููุฉ ุจุงูุชุฃููุฏ. <br><br><img src="https://habrastorage.org/webt/a6/la/gb/a6lagbu1ycmf-5poirlhd0cpyt8.png"><br><br>  ููููู ุฑุคูุฉ ุฃูู ุงููุนุงููุฉ ูู ูุชุงููุฌ ุงููุธุงู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> backend_xmin <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_activity <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> pid = pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> backend_xmin -------------- 3699 (1 row)</code> </pre><br>  ูููููุง ุฃูุถุง ุชุญุฏูุฏ ุงูุฃูู ุนูู ูุณุชูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ููููุงู ุจุฐูู ุ ูุญุชุงุฌ ุฅูู ุงูุชูุงุท ุฌููุน ุงูููุทุงุช ุงููุดุทุฉ ูุงูุนุซูุฑ ุนูู ุฃูุฏู <code>xmin</code> ุจูููุง.  ูุณูุญุฏุฏ ุงูุฃูู ุ ูุงูุฐู ูู ูููู ุจุนุฏู tuples ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุฑุฆููุง ูุฃู ูุนุงููุฉ.  <em>ูููู ุชูุฑูุบ ูุซู ูุฐู ุงูุชูุงููุฐ</em> - ููุฐุง ูู ุงูุณุจุจ ูู ุฃู ููููู ุงูุฃูู ููู ููุบุงูุฉ ูู ุงููุงุญูุฉ ุงูุนูููุฉ. <br><br>  ุฅุฐุง ูุงูุช ููุงู ูุนุงููุฉ ูุนููุฉ ุชุญุชูุธ ุจููุทุฉ ููุชุฑุฉ ุทูููุฉ ุ ูุณุชุญุชูุธ ุฃูุถูุง ุจุฃูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.  ุนูุงูุฉ ุนูู ุฐูู ุ ูุฅู ูุฌุฑุฏ ูุฌูุฏ ูุนุงููุฉ ุบูุฑ ููุชููุฉ ุณูุนูุฏ ุงูุฃูู ุญุชู ูู ูุงูุช ุงููุนุงููุฉ ููุณูุง ูุง ุชููู ุงูููุทุฉ. <br><br>  ููุฐุง ูุนูู ุฃู ุงูุชูุงููุฐ ุงููุชูู ูู ุงูุฏูุณูุจู ูุง ูููู ุชูุฑูุบูุง ุจุนูุฏูุง.  ุจุงูุฅุถุงูุฉ ุฅูู ุฐูู ุ ูู ุงููููู ุฃูุง ุชุชูุงุทุน ูุนุงููุฉ "ุงูุชุดุบูู ุงูุทููู" ูุน ุงูุจูุงูุงุช ูุน ุงููุนุงููุงุช ุงูุฃุฎุฑู ุนูู ุงูุฅุทูุงู ุ ููู ูุฐุง ูุง ููู ุญููุง ูุฃู ูู ูุดุงุฑูุฉ ุฃูู ูุงุนุฏุฉ ุจูุงูุงุช ูุงุญุฏุฉ. <br><br>  ุฅุฐุง ุฌุนููุง ุงูุขู ุดุฑูุญุฉ ุชูุซู ููุทุงุช (ูู <code>snapshot.xmin</code> ุฅูู <code>snapshot.xmax</code> ) ุจุฏูุงู ูู ุงููุนุงููุงุช ุ ูููููุง ุชุตูุฑ ุงููููู ุนูู ุงููุญู ุงูุชุงูู: <br><br><img src="https://habrastorage.org/webt/lf/-k/3a/lf-k3azujmyjrddg-6whmoktujc.png"><br><br>  ูู ูุฐุง ุงูุดูู ุ ุชุชุนูู ุฃุฏูู ููุทุฉ ุจูุนุงููุฉ ุบูุฑ ููุชููุฉ ุ ููู ุงูููุทุงุช ุงูุฃุฎุฑู ุ ูุง ูููู ุฃู ูููู <code>snapshot.xmin</code> ุฃูุจุฑ ูู ูุนุฑู ุงููุนุงููุฉ. <br><br>  ูู ุงููุซุงู ุงูุฎุงุต ุจูุง ุ ุชู ุจุฏุก ุงููุนุงููุฉ ุจูุณุชูู ุนุฒู Read Committed.  ุนูู ุงูุฑุบู ูู ุฃูู ูุง ูุญุชูู ุนูู ุฃู ููุทุฉ ุจูุงูุงุช ูุดุทุฉ ุ ุฅูุง ุฃูู ูุณุชูุฑ ูู ุงูุฃูู: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">UPDATE</span></span> accounts <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> amount = amount + <span class="hljs-number"><span class="hljs-number">1.00</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> backend_xmin <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_activity <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> pid = pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> backend_xmin -------------- 3699 (1 row)</code> </pre><br>  ูููุท ุจุนุฏ ุฅุชูุงู ุงูุตููุฉ ุ ูุชุญุฑู ุงูุฃูู ููุฃูุงู ุ ููุง ูุชูุญ ุชูุฑูุบ ุงููุถุงุนูุงุช ุงูููุชุฉ ุจุนูุฏูุง: <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> backend_xmin <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> pg_stat_activity <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> pid = pg_backend_pid();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> backend_xmin -------------- 3700 (1 row)</code> </pre><br>  ูู ุงูุญุงูุฉ ุงูุชู ูุณุจุจ ูููุง ุงููููู ุงูููุตูู ูุดููุงุช ุจุงููุนู ุ ููุง ุชูุฌุฏ ุทุฑููุฉ ูุญููุง ุนูู ูุณุชูู ุงูุชุทุจูู ุ ูุชููุฑ ูุนููุชุงู ุจุฏุกูุง ูู ุงูุฅุตุฏุงุฑ 9.6: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  ูุญุฏุฏ <em><code>old_snapshot_threshold</code></em> ุงูุญุฏ ุงูุฃูุตู ูุนูุฑ ุงูููุทุฉ.  ุนูุฏูุง ูููุถู ูุฐุง ุงูููุช ุ ุณูููู ุงูุฎุงุฏู ูุคููุงู ูุชุฎููุต ุงููุฑุงุบุงุช ุงูููุชุฉ ุ ูุฅุฐุง ูุงูุช ููุงู ุญุงุฌุฉ ุฅูู ูุนุงููุฉ "ุงูุชุดุบูู ุงูุทููู" ุ ูุณูุธูุฑ ุฎุทุฃ "ููุทุฉ ูุฏููุฉ ุฌุฏูุง". </li><li style=";text-align:right;direction:rtl">  ุชุญุฏุฏ <em><code>idle_in_transaction_session_timeout</code></em> ุงูุนูุฑ ุงูุฃูุตู ููุนุงููุฉ ุงูุฎููู.  ุนูุฏูุง ูููุถู ูุฐุง ุงูููุช ุ ูุชู ุฅุญุจุงุท ุงููุนุงููุฉ. </li></ul><br><h1 style=";text-align:right;direction:rtl">  ุชุตุฏูุฑ ููุทุฉ </h1><br>  ูู ุจุนุถ ุงูุฃุญูุงู ุชูุดุฃ ุญุงูุงุช ุญูุซ ูุฌุจ ุถูุงู ุนุฏุฉ ูุนุงููุงุช ูุชุฒุงููุฉ ูุฑุคูุฉ ููุณ ุงูุจูุงูุงุช.  ูุซุงู ุนูู ุฐูู ูู ุฃุฏุงุฉ ูุณุงุนุฏุฉ <code>pg_dump</code> ุ ูุงูุชู ูููู ุฃู ุชุนูู ูู ูุถุน ูุชูุงุฒู: ูุฌุจ ุฃู ุชุฑู ุฌููุน ุงูุนูููุงุช <code>pg_dump</code> ูุงุนุฏุฉ ุงูุจูุงูุงุช ูู ููุณ ุงูุญุงูุฉ ุญุชู ุชููู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ ูุชุณูุฉ. <br><br>  ุจุงูุทุจุน ุ ูุง ูููููุง ุงูุงุนุชูุงุฏ ุนูู ุงูุงุนุชูุงุฏ ุจุฃู ุงููุนุงููุงุช ุณุชุฑู ููุณ ุงูุจูุงูุงุช ููุฌุฑุฏ ุฃููุง ุจุฏุฃุช "ูู ููุช ูุงุญุฏ".  ุชุญูููุง ููุฐู ุงูุบุงูุฉ ุ ุชุตุฏูุฑ ูุงุณุชูุฑุงุฏ ููุทุฉ ูุชุงุญุฉ. <br><br>  ุชุฑุฌุน ุงูุฏุงูุฉ <code>pg_export_snapshot</code> ูุนุฑู ุงูููุทุฉ ุ ูุงูุฐู ูููู ุชูุฑูุฑู ุฅูู ูุนุงููุฉ ุฃุฎุฑู (ุจุงุณุชุฎุฏุงู ุฃุฏูุงุช ุฎุงุฑุฌ DBMS). <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ISOLATION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEVEL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPEATABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">READ</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts; <span class="hljs-comment"><span class="hljs-comment">-- any query</span></span></code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> count ------- 3 (1 row)</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">=&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> pg_export_snapshot();</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs"> pg_export_snapshot --------------------- 00000004-00000E7B-1 (1 row)</code> </pre><br>  ูููู ูููุนุงููุฉ ุงูุฃุฎุฑู ุงุณุชูุฑุงุฏ ุงูููุทุฉ ุจุงุณุชุฎุฏุงู ุงูุฃูุฑ SET TRANSACTION SNAPSHOT ูุจู ุชูููุฐ ุงูุงุณุชุนูุงู ุงูุฃูู.  ูุฌุจ ุฃูุถูุง ุชุญุฏูุฏ ูุณุชูู ุชูุฑุงุฑ ุงููุฑุงุกุฉ ุฃู ุงูุนุฒูุฉ ุงููุงุจูุฉ ููุชุณูุณู ูู ูุจู ูุฃูู ูู ูุณุชูู ุงูุชุฒุงู ุงููุฑุงุกุฉ ุ ุณุชุณุชุฎุฏู ุงูุจูุงูุงุช ุงูููุทุงุช ุงูุฎุงุตุฉ ุจูุง. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ISOLATION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LEVEL</span></span> <span class="hljs-keyword"><span class="hljs-keyword">REPEATABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">READ</span></span>; | =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRANSACTION</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SNAPSHOT</span></span> <span class="hljs-string"><span class="hljs-string">'00000004-00000E7B-1'</span></span>;</code> </pre><br>  ุณุชุนูู ุงููุนุงููุฉ ุงูุซุงููุฉ ุงูุขู ูุน ููุทุฉ ุงูุฃููู ุ ูุจุงูุชุงูู ุ ุงูุธุฑ ุซูุงุซุฉ ุตููู (ุจุฏูุงู ูู ุงูุตูุฑ): <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> count(*) <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> accounts;</code> </pre><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">| count | ------- | 3 | (1 row)</code> </pre><br>  ุนูุฑ ุงูููุทุฉ ุงูุชู ุชู ุชุตุฏูุฑูุง ูู ููุณ ุนูุฑ ุงููุนุงููุฉ ุงููุตุฏุฑุฉ. <br><br><pre style=";text-align:right;direction:rtl"> <code class="pgsql hljs">| =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>; =&gt; <span class="hljs-keyword"><span class="hljs-keyword">COMMIT</span></span>;</code> </pre><br>  <a href="https://habr.com/ru/company/postgrespro/blog/483768/">ุงูุฑุฃ ุนูู</a> . </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar479512/">https://habr.com/ru/post/ar479512/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar479498/index.html">ููู ูุชุญูู ุงูููุช ุงูุฎุทู ุฅูู Windows ูู O (nยฒ)</a></li>
<li><a href="../ar479502/index.html">ููู ุชูุฌู ูู ุฃุดุฏ ุนุตุฑ ุฌููุฏู ูู ุชุงุฑูุฎ ุงูุฃุฑุถุ</a></li>
<li><a href="../ar479504/index.html">ุจูุงุก ุนููู RDP ุฑูููุฉ ุชุณุชูุฏ ุฅูู Raspberry Pi</a></li>
<li><a href="../ar479508/index.html">PostgreSQL Antipatterns: JOINs ู ORS ุงูุถุงุฑุฉ</a></li>
<li><a href="../ar479510/index.html">ูุฑุงุฌุนุฉ PocketBook X - ูุงุฑุฆ ุถุฎู ุจุญุฌู 10.3 ุจูุตุฉ ูุฒูุฏ ุจุดุงุดุฉ E Ink Carta Mobius ูุญุงูุฉ ูุนุฏููุฉ</a></li>
<li><a href="../ar479514/index.html">ุงูุฎุตูุตูุฉ ุญุณุจ ุงูุชุตููู ูุงูุฎุตูุตูุฉ ุงูุชุฑุงุถููุง (ุญูุงูุฉ ุงูุจูุงูุงุช ุงููุตููุฉ ูุงูุฎุตูุตูุฉ ุงูุงูุชุฑุงุถูุฉ ุญุณุจ ุฅุฌูุงูู ุงููุงุชุฌ ุงููุญูู)</a></li>
<li><a href="../ar479516/index.html">ูุง ูู ุงูุงูุชุฑูุจูุง ูู ุงูุจุฑุงูุฌ ูููููุฉ ุฅุฏุงุฑุชูุงุ</a></li>
<li><a href="../ar479518/index.html">ุงูุชูุงุตู ุฏุงุฎู ูุฑูู ุจุนูุฏ ูู ุชุฌุฑุจุชูุง</a></li>
<li><a href="../ar479522/index.html">ุงููุงุดุฑ ุจูุชุฑ. ุจูุน ุงูุดุชุงุก</a></li>
<li><a href="../ar479524/index.html">ุฎุฏูุฉ ุงูุงุณุชุนุงุฏุฉ ุงููุดุทุฉ ุฃู ุชุงุฑูุฎ ูุดุฑูุน ุตูุงุนู ูุงุญุฏ ูู Innopolis</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>