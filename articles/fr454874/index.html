<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üßùüèΩ üñïüèø üòÅ Un peu sur le multit√¢che dans les microcontr√¥leurs üéÜ ü•ì üë®üèΩ‚Äçüåæ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Un peu sur le multit√¢che 


 Quiconque, jour apr√®s jour, ou au cas par cas, est engag√© dans la programmation de microcontr√¥leurs, sera t√¥t ou tard con...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Un peu sur le multit√¢che dans les microcontr√¥leurs</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/454874/"><p>  <strong>Un peu sur le multit√¢che</strong> </p><br><p>  Quiconque, jour apr√®s jour, ou au cas par cas, est engag√© dans la programmation de microcontr√¥leurs, sera t√¥t ou tard confront√© √† la question: dois-je utiliser un syst√®me d'exploitation multit√¢che?  Il y en a beaucoup sur le r√©seau, et beaucoup d'entre eux sont gratuits (ou presque gratuits).  Choisissez simplement. </p><br><p>  Des doutes similaires surgissent lorsque vous rencontrez un projet dans lequel le microcontr√¥leur doit effectuer simultan√©ment plusieurs actions diff√©rentes.  Certains d'entre eux ne sont pas li√©s aux autres, tandis que les autres, au contraire, ne peuvent pas se passer les uns des autres.  De plus, il peut y avoir trop des deux.  Ce qui est ¬´trop¬ª d√©pend de qui √©valuera ou qui r√©alisera le d√©veloppement.  Eh bien, si c'est la m√™me personne. </p><br><p>  Il ne s'agit pas plut√¥t d'une question de quantit√©, mais d'une diff√©rence qualitative des t√¢ches par rapport √† la vitesse d'ex√©cution ou √† d'autres exigences.  De telles pens√©es peuvent survenir, par exemple, lorsque le projet doit surveiller r√©guli√®rement la tension d'alimentation (est-elle manquante?), Assez souvent lire et enregistrer les valeurs des quantit√©s d'entr√©e (elles ne donnent pas de repos), surveiller occasionnellement la temp√©rature et contr√¥ler le ventilateur (il n'y a rien √† respirer), v√©rifiez votre regarde avec quelqu'un en qui vous avez confiance (c'est bon pour vous de le commander), restez en contact avec l'op√©rateur (essayez de ne pas l'irriter), v√©rifiez la somme de contr√¥le de la m√©moire permanente du programme pour la d√©mence (lorsqu'il est activ√©, ou une fois par semaine, ou le matin). <a name="habracut"></a></p><br><p>  De telles t√¢ches h√©t√©rog√®nes peuvent √™tre programm√©es avec beaucoup de sens et avec succ√®s, en s'appuyant sur une seule t√¢che d'arri√®re-plan et des interruptions de temporisation.  Dans le gestionnaire de ces interruptions, √† chaque fois une des ¬´pi√®ces¬ª de la t√¢che suivante est ex√©cut√©e.  Selon l'importance, l'urgence ou des consid√©rations similaires, ces d√©fis sont souvent r√©p√©t√©s pour certaines t√¢ches, mais rarement pour d'autres.  Et pourtant, nous devons nous assurer que chaque t√¢che fait une partie de courte dur√©e du travail, puis se pr√©pare pour la prochaine petite partie du travail, et ainsi de suite.  Cette approche, si vous vous y habituez, ne semble pas trop compliqu√©e.  Un inconv√©nient survient lorsque vous souhaitez cr√©er un projet.  Ou, par exemple, transf√©rez soudainement √† un autre.  Il convient de noter que la seconde est souvent plus difficile et sans aucune pseudo-t√¢che multiple. </p><br><p>  Mais que faire si vous utilisez un syst√®me d'exploitation pr√™t √† l'emploi pour les microcontr√¥leurs?  Bien s√ªr, beaucoup le font.  C'est une bonne option.  Mais l'auteur de ces lignes, jusqu'√† pr√©sent, a √©t√© et continue d'√™tre arr√™t√© par l'id√©e qu'il sera n√©cessaire de comprendre cela, apr√®s avoir pass√© beaucoup de temps, √† choisir parmi ce que nous avons r√©ussi √† obtenir et √† utiliser uniquement ce qui est vraiment n√©cessaire.  Et faites tout cela, faites attention √† vous plonger dans le code de quelqu'un d'autre!  Et il n'y a aucune certitude que dans six mois cela ne devra pas √™tre r√©p√©t√©, car il sera oubli√©. </p><br><p>  En d'autres termes, pourquoi avez-vous besoin d'un garage complet d'outils et d'accessoires si un v√©lo y est entrepos√© et utilis√©? </p><br><p>  Par cons√©quent, il y avait un d√©sir de faire un simple ¬´changement¬ª de t√¢ches uniquement pour Cortex-M4 (enfin, peut-√™tre m√™me pour M3 et M7).  Mais l'ancien, bon d√©sir de ne pas trop tendre n'a pas disparu. </p><br><p>  Donc, nous faisons le plus simple.  Un petit nombre de t√¢ches partagent √©galement le temps d'ex√©cution.  Comme dans la figure 1 ci-dessous, quatre t√¢ches le font.  Soit le principal z√©ro, car il est difficile d'en imaginer un autre. </p><br><p><img src="https://habrastorage.org/webt/hz/er/47/hzer47qstbq61q9nj41xkqnquoo.jpeg"></p><br><p>  En travaillant de cette fa√ßon, ils sont assur√©s d'obtenir leur cr√©neau horaire ou dur√©e (tick) et ne sont pas tenus de conna√Ætre l'existence d'autres t√¢ches.  Chaque t√¢che exactement apr√®s 3 ticks aura √† nouveau l'occasion de faire quelque chose. </p><br><p>  Mais, d'autre part, si l'une des t√¢ches est n√©cessaire pour attendre un √©v√©nement externe, par exemple, en appuyant sur un bouton, cela passera stupidement le temps pr√©cieux de notre microcontr√¥leur.  Nous ne pouvons pas √™tre d'accord avec cela.  Et notre crapaud (conscience) - aussi.  Il faut faire quelque chose. </p><br><p>  Et laissez la t√¢che, si elle n'a rien √† faire jusqu'√† pr√©sent, donner le temps qui reste de la tique √† ses camarades, qui, tr√®s probablement, labourent de toutes leurs forces. </p><br><p>  En d'autres termes, le partage est n√©cessaire.  Laissez la t√¢che 2 faire exactement cela, comme dans la figure 2. </p><br><p><img src="https://habrastorage.org/webt/5j/dm/sv/5jdmsvttcr9cfs5ygk_giclmc5w.jpeg"></p><br><p>  Et pourquoi notre t√¢che principale ne devrait-elle pas abandonner le reste du temps, si vous devez encore attendre?  Permettons-le.  Comme le montre la figure 3. </p><br><p><img src="https://habrastorage.org/webt/jg/mh/q4/jgmhq4bmtd26vzif444qypg3c18.jpeg"></p><br><p>  Et si vous savez que certaines t√¢ches ne vous obligeront pas bient√¥t √† v√©rifier √† nouveau quelque chose ou simplement √† travailler?  Et elle pouvait se permettre un peu de sommeil, et au lieu de cela, elle perdrait du temps et se mettrait sous ses pieds.  Pas une commande, elle doit √™tre corrig√©e.  Laissez la t√¢che 3 manquer un morceau de son temps (ou mille).  Comme le montre la figure 4. </p><br><p><img src="https://habrastorage.org/webt/50/no/ma/50nomamrfalo_crb2hmf1nkalli.jpeg"></p><br><p>  Eh bien, comme nous le voyons, nous avons d√©crit une coexistence √©quitable des t√¢ches ou quelque chose comme √ßa.  Nous devons maintenant faire en sorte que nos t√¢ches individuelles se comportent comme pr√©vu.  Et si nous essayons de valoriser le temps, alors il vaut la peine de se souvenir d'un langage de bas niveau (je n'ai pas peur du mot assembleur) et de ne pas faire enti√®rement confiance au compilateur d'aucune langue, de haut niveau ou tr√®s haut.  En effet, au fond de nos c≈ìurs, nous sommes r√©solument contre toute d√©pendance.  De plus, le fait que nous n'ayons besoin d'aucun assembleur, mais uniquement de Cortex-M4, nous simplifie la vie. </p><br><p>  Pour la pile, nous s√©lectionnons une zone commune de RAM qui se remplira, c'est-√†-dire dans le sens de la diminution des adresses m√©moire.  Pourquoi?  Tout simplement parce que cela ne fonctionne pas diff√©remment.  Nous diviserons mentalement cet important domaine en sections √©gales en fonction du nombre du nombre maximum d√©clar√© de nos t√¢ches.  La figure 5 montre cela pour quatre t√¢ches. </p><br><p><img src="https://habrastorage.org/webt/tp/tz/wo/tptzwopr7htrcuhwgb6y6ydfdae.jpeg"></p><br><p>  Ensuite, nous s√©lectionnons l'endroit o√π nous allons stocker des copies des pointeurs de pile pour chaque t√¢che.  Maintenant, en interrompant la minuterie, que nous prenons comme minuterie syst√®me, nous enregistrons tous les registres de la t√¢che en cours dans sa zone de pile (le registre SP pointe maintenant l√†), puis nous enregistrons son pointeur de pile dans un endroit sp√©cial (nous enregistrons sa valeur), nous obtenons le pointeur de pile de la t√¢che suivante ( √©crire une nouvelle valeur dans le registre SP) √† partir de notre emplacement sp√©cial et restaurer tous ses registres.  Leurs copies sont d√©sormais indiqu√©es par le registre SP de notre prochaine t√¢che.  Eh bien, nous quittons l'interruption, bien s√ªr.  De plus, tout le contexte de la t√¢che suivante dans la liste appara√Æt dans les registres. </p><br><p>  Il sera probablement superflu de dire que la prochaine t√¢che suivante3 dans la file d'attente sera principale.  Et il n'est pas superflu, bien s√ªr, de rappeler que le Cortex-M4 poss√®de d√©j√† une minuterie SysTick et une interruption sp√©ciale, et de nombreux fabricants de microcontr√¥leurs le savent.  Nous allons l'utiliser et cette interruption comme pr√©vu. </p><br><p>  Pour d√©marrer cette minuterie syst√®me et effectuer toutes les pr√©parations et v√©rifications n√©cessaires, vous devez utiliser la proc√©dure pr√©vue √† cet effet. </p><br><pre><code class="plaintext hljs">U8 main_start_task_switcher(void);</code> </pre> <br><p>  Cette routine renvoie 0 si toutes les v√©rifications ont r√©ussi, ou un code d'erreur si quelque chose s'est mal pass√©.  Il est v√©rifi√©, fondamentalement, si la pile est correctement align√©e et s'il y a suffisamment d'espace pour elle, et tous nos emplacements sp√©ciaux sont √©galement remplis de valeurs initiales.  Bref, l'ennui. </p><br><p>  Si quelqu'un veut regarder le texte du programme, √† la fin de la narration, il pourra le faire facilement, par exemple, par courrier personnel. </p><br><p>  Oui, j'ai compl√®tement oubli√© quand nous sortons les registres de la prochaine t√¢che du stockage pour la premi√®re fois de sa vie, il est n√©cessaire qu'ils obtiennent des valeurs originales significatives.  Et depuis, elle les ramassera dans sa section de la pile, vous devez les y placer √† l'avance et d√©placer son pointeur de pile afin qu'il soit pratique √† prendre.  Pour cela, nous avons besoin d'une proc√©dure </p><br><pre> <code class="plaintext hljs"> U8 task_run_and_return_task_number(U32 taskAddress);</code> </pre> <br><p>  √Ä ce sous-programme, nous rapportons l'adresse 32 bits du d√©but de notre t√¢che que nous voulons ex√©cuter.  Et elle (le sous-programme) nous indique le num√©ro de la t√¢che, qui s'est av√©r√© dans une table g√©n√©rale sp√©ciale, ou 0 s'il n'y avait pas d'espace dans la table.  Ensuite, nous pouvons ex√©cuter une autre t√¢che, puis une autre et ainsi de suite, m√™me si les trois s'ajoutent √† notre t√¢che principale sans fin.  Elle ne donnera jamais son num√©ro z√©ro √† personne. </p><br><p>  Quelques mots sur les priorit√©s.  La principale priorit√© √©tait et reste de ne pas surcharger le lecteur de d√©tails inutiles. </p><br><p>  Mais s√©rieusement, nous devons nous rappeler qu'il y a des interruptions des ports s√©rie, de plusieurs connexions SPI, d'un convertisseur analogique-num√©rique, d'un autre temporisateur, apr√®s tout.  Et que se passera-t-il si nous allons passer √† une autre t√¢che (changer de contexte) lorsque nous sommes dans le gestionnaire d'une sorte d'interruption.  Apr√®s tout, ce ne sera pas une t√¢che l√©gitime, mais une opacification temporaire du programme.  Et nous garderons cet √©trange contexte comme une sorte de t√¢che.  Il y aura une confusion: le col ne se ferme pas, la casquette ne rentre pas.  Arr√™tez, non, cela vient d'une histoire diff√©rente. </p><br><p>  Dans notre cas, cela ne peut tout simplement pas √™tre autoris√©.  Nous ne devons pas nous autoriser √† changer de contexte lors du traitement d'une interruption non planifi√©e.  Voici les priorit√©s pour cela.  Il suffit d'attendre un peu, et c'est seulement √† ce moment-l√†, lorsque cette audace sans pr√©c√©dent se termine, de passer calmement √† une autre t√¢che.  En bref, la priorit√© de l'interruption de notre commutateur de t√¢ches doit √™tre plus faible que la priorit√© de l'une des autres interruptions utilis√©es.  Soit dit en passant, cela se fait √©galement dans notre proc√©dure de d√©marrage, et c'est l√† qu'il est install√©, le plus non prioritaire possible. </p><br><p>  Je ne voulais pas parler, mais je devais le faire.  Notre processeur a deux modes de fonctionnement: privil√©gi√© et non privil√©gi√©.  Et aussi deux registres pour le pointeur de pile: <br>  SP principal et processus SP.  Donc, nous n'√©changerons pas pour des bagatelles, nous n'utiliserons que le mode privil√©gi√© et uniquement le pointeur de pile principal.  De plus, tout cela a d√©j√† √©t√© donn√© au d√©but du contr√¥leur.  Donc, nous ne compliquerons tout simplement pas nos vies. </p><br><p>  Reste √† rappeler que chaque t√¢che, √† coup s√ªr, voudrait pouvoir tout jeter en enfer et comment se d√©tendre.  Et cela peut arriver √† tout moment pendant la journ√©e de travail, c'est-√†-dire pendant notre tique.  Cortex-M4 pr√©voit pour de tels cas une commande d'assembleur sp√©ciale SVC, que nous adapterons √† notre situation.  Cela conduit √† une interruption qui nous m√®nera au but.  Et nous autoriserons la t√¢che non seulement √† quitter le lieu de travail apr√®s le d√©jeuner, mais pas √† venir demain.  Laissez-le venir apr√®s les vacances.  Et si n√©cessaire, laissez-le venir une fois la r√©paration termin√©e ou ne vient pas du tout.  Pour ce faire, il existe une proc√©dure que la t√¢che elle-m√™me peut provoquer. </p><br><pre> <code class="plaintext hljs"> void release_me_and_set_sleep_period(U32 ticks);</code> </pre> <br><p>  Cette routine n'a qu'√† indiquer combien de tiques sont pr√©vues pour se reposer.  Si 0, alors vous ne pouvez reposer que le reste de la coche actuelle.  Si 0xFFFFFFFF, la t√¢che se mettra en veille jusqu'√† ce que quelqu'un se r√©veille.  Tous les autres chiffres indiquent le nombre de tiques pendant lesquelles la t√¢che sera en √©tat de sommeil. </p><br><p>  Pour que quelqu'un d'autre puisse se r√©veiller de c√¥t√© ou le faire dormir, j'ai d√ª ajouter de telles proc√©dures. </p><br><pre> <code class="plaintext hljs"> void task_wake_up_action(U8 taskNumber); void set_task_sleep_period(U8 taskNumber, U32 ticks);</code> </pre> <br><p>  Et, juste au cas o√π, m√™me un tel sous-programme. </p><br><pre> <code class="plaintext hljs"> void task_remove_action(U8 taskNumber);</code> </pre> <br><p>  En gros, elle raye une t√¢che de la liste des employ√©s.  Honn√™tement, je ne sais pas encore pourquoi je l'ai √©crit.  Vous √™tes soudainement utile? </p><br><p>  Il est temps de montrer √† quoi ressemble l'endroit o√π une t√¢che est remplac√©e par une autre, c'est-√†-dire le commutateur lui-m√™me. </p><br><p>  Juste au cas o√π, rappelons que certains des registres, lors de la saisie de l'interruption, sont enregistr√©s sur la pile sans notre participation, automatiquement (comme c'est la coutume dans Cortex-M4).  Par cons√©quent, nous avons seulement besoin de sauver le reste.  Cela peut √™tre vu ci-dessous.  Ne vous inqui√©tez pas de ce que vous voyez, ce sont les instructions de l'assembleur Cortex-M4 (M3, M7), comme indiqu√© par l'IAR Embedded Workbench. </p><br><p>  Ceux qui n'ont pas encore rencontr√© les instructions de montage, croyez-moi, ils ressemblent vraiment √† √ßa.  Ce sont les mol√©cules qui composent tout programme sous l'ARM Cortex-M4. </p><br><pre> <code class="plaintext hljs">SysTick_Handler STMDB SP!,{R4-R11} ;   LDR R0,=timersTable ;    LDR R1,=stacksTable ;    LDR R2,[R0] ;R2   ()  STR SP,[R1,R2,LSL #2] ;   SP (R2 * 4) __st_next_check ADD R2,R2,#1 ;   CMP R2,#TASKS_LIMIT ;R2-TASKS_LIMIT  BLO __st_no_border_yet ;   MOV R2,#0 ;    (main) LDR R3,[R1] ; main SP MOV SP,R3 B __st_timer_ok __st_no_border_yet ;; LDR SP,[R1,R2,LSL #2] ;    (errata Cortex M4) ;; CMP SP,#0 ; LDR R3,[R1,R2,LSL #2] ;  SP      CMP R3,#0 ; =0     BEQ __st_next_check MOV SP,R3 LDR R3,[R0,R2,LSL #2] ;  suspend timer CBZ R3,__st_timer_ok ; 0    ,   ; CMP R3,#0xFFFFFFFF ; ,   BEQ __st_next_check SUB R3,R3,#1 ;  1 STR R3,[R0,R2,LSL #2] ;  suspend timer B __st_next_check __st_timer_ok STR R2,[R0] ;     LDMIA SP!,{R4-R11} ;  R4-R11 BX LR</code> </pre> <br><p>  La gestion de l'interruption ordonn√©e par la t√¢che elle-m√™me lorsqu'elle renvoie le reste de la tique semble similaire.  La seule diff√©rence est que vous devez toujours vous soucier de dormir un peu plus tard (ou de vous endormir compl√®tement).  Il y a une subtilit√©.  Deux actions doivent √™tre effectu√©es, √©crire le nombre souhait√© dans la minuterie de mise en veille et provoquer l'interruption du SVC.  Le fait que ces deux actions ne se produisent pas atomiquement (c'est-√†-dire pas les deux en m√™me temps) m'inqui√®te un peu.  Imaginez pendant une milliseconde que nous venions d'armer la minuterie et √† ce moment-l√†, il √©tait temps de travailler sur une autre t√¢che.  L'autre a commenc√© √† d√©penser sa tique, alors que notre t√¢che sera de dormir les tiques suivantes, comme pr√©vu (car sa minuterie n'est pas nulle).  Puis, le moment venu, notre t√¢che recevra sa coche et la donnera imm√©diatement pour interrompre SVC, en raison des deux actions que celle-ci reste √† faire.  √Ä mon avis, rien de terrible ne se produira, mais les s√©diments resteront.  Nous allons donc le faire.  La future minuterie de sommeil est plac√©e √† un endroit pr√©liminaire.  Elle est prise √† partir de l√† par la routine d'interruption elle-m√™me de SVC.  L'atomicit√©, pour ainsi dire, est atteinte.  Ceci est illustr√© ci-dessous. </p><br><pre> <code class="plaintext hljs">SVC_Handler LDR R0,__sysTickAddr ; SysTick  MOV R1,#6 ;   CSR ,   STR R1,[R0] ;Stop SysTimer MOV R1,#7 ; ,   STR R1,[R0] ;Start SysTimer ; STMDB SP!,{R4-R11} ;   LDR R0,=timersTable ;    LDR R1,=stacksTable ;    LDR R2,[R0] ;R2   ()  STR SP,[R1,R2,LSL #2] ;   SP (R2 * 4) LDR R3,=tmpTimersTable ;   tmpTimers LDR R3,[R3,R2,LSL #2] ;tmpTimer    STR R3,[R0,R2,LSL #2] ; timer  __svc_next_check ADD R2,R2,#1 ;   CMP R2,#TASKS_LIMIT ;R2-TASKS_LIMIT  BLO __svc_no_border_yet ;   MOV R2,#0 ;    (main) LDR R3,[R1] ; main SP MOV SP,R3 B __svc_timer_ok __svc_no_border_yet ;; LDR SP,[R1,R2,LSL #2] ;Restore SP does not work (errata Cortex M4) ;; CMP SP,#0 ; LDR R3,[R1,R2,LSL #2] ;  SP      CMP R3,#0 ; =0     BEQ __svc_next_check MOV SP,R3 LDR R3,[R0,R2,LSL #2] ;  suspend timer CBZ R3,__svc_timer_ok ; 0    ,   B __svc_next_check __svc_timer_ok STR R2,[R0] ;     LDMIA SP!,{R4-R11} ; R4-R11 BX LR</code> </pre> <br><p>  Il convient de rappeler que tous ces sous-programmes et gestionnaires d'interruptions se r√©f√®rent √† une certaine zone de donn√©es, qui semble effectu√©e par l'auteur comme le montre la figure 7. </p><br><pre> <code class="plaintext hljs"> DATA SECTION .taskSwitcher:CODE:ROOT(2) __topStack DCD sfe(CSTACK) __botStack DCD sfb(CSTACK) __dimStack DCD sizeof(CSTACK) __sysAIRCRaddr DCD 0xE000ED0C __sysTickAddr DCD 0xE000E010 __sysSHPRaddr DCD 0xE000ED18 __sysTickReload DCD RELOAD ;******************************************************************************* ; Task table for concurrent tasks (main is number 0). ;******************************************************************************* SECTION TABLE:DATA:ROOT(2) DS32 1 ;stack shift due to FPU mainCopyCONTROL DS32 1 ;Needed to determine if FPU is used mainPSRvalue DS32 1 ;Copy from main ;*******************************************************************************</code> </pre> <br><p>  Pour s'assurer que tout ce qui pr√©c√®de est du bon sens, l'auteur a d√ª √©crire un petit projet dans le cadre de l'IAR Embedded Workbench, o√π il a r√©ussi √† examiner et √† tout toucher en d√©tail.  Tout a √©t√© test√© sur le contr√¥leur STM32F303VCT6 (ARM Cortex-M4).  Ou plut√¥t, en utilisant la carte STM32F3DISCOVERY.  Il y a suffisamment de LED pour donner √† chaque t√¢che beaucoup de clignotements avec sa propre LED s√©par√©ment. </p><br><p>  Il y a quelques autres fonctionnalit√©s que j'ai trouv√©es utiles.  Par exemple, un sous-programme qui compte dans chaque zone de pile le nombre de mots non affect√©s, c'est-√†-dire restant √©gal √† z√©ro.  Cela peut √™tre utile lors du d√©bogage, lorsque vous devez v√©rifier si le remplissage de la pile avec une t√¢che ou une autre est trop proche du niveau limite. </p><br><pre> <code class="plaintext hljs"> U32 get_task_stack_empty_space(U8 taskNum);</code> </pre> <br><p>  Je voudrais mentionner une autre fonction.  C'est l'occasion pour la t√¢che elle-m√™me de d√©couvrir votre num√©ro dans la liste.  Vous pourrez en parler √† quelqu'un plus tard. </p><br><pre> <code class="plaintext hljs">;******************************************************************************* ; Example: U8 get_my_number(void); ;     (). ..    . ;******************************************************************************* get_my_number LDR R0,=timersTable ;    (currentTaskNumber) LDR R0,[R0] ;  BX LR ;==============================================================</code> </pre> <br><p>  C'est probablement tout pour le moment. </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr454874/">https://habr.com/ru/post/fr454874/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr454856/index.html">Nous analysons les vuln√©rabilit√©s de validation de certificat SSL / TLS dans un logiciel non navigateur</a></li>
<li><a href="../fr454860/index.html">Aidons QueryProvider √† g√©rer les cha√Ænes interpol√©es</a></li>
<li><a href="../fr454864/index.html">Comment sont les processus de d√©veloppement dans diff√©rentes entreprises</a></li>
<li><a href="../fr454868/index.html">Compilation de C dans WebAssembly sans Emscripten</a></li>
<li><a href="../fr454872/index.html">Space Invaders: maintenant en 512 octets (assembleur x86)</a></li>
<li><a href="../fr454876/index.html">A propos de la conception d'un syst√®me flexible de capacit√©s de personnage dans les jeux</a></li>
<li><a href="../fr454878/index.html">Nous √©tudions MITRE ATT & CK. Matrices mobiles: acc√®s aux appareils. 3e partie</a></li>
<li><a href="../fr454880/index.html">¬´Hors saison¬ª dans la vie d'un pigiste: comment survivre et survivre?</a></li>
<li><a href="../fr454884/index.html">Nom de test lisible dans JS et le mod√®le comportemental</a></li>
<li><a href="../fr454886/index.html">Assis dans le foie. Pourquoi l'ablation des tumeurs du foie est un indicateur de la comp√©tence sup√©rieure du chirurgien</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>