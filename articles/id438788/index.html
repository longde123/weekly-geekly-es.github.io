<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ‘¸ ğŸ¡ ğŸ‘©ğŸ¼â€ğŸ¤â€ğŸ‘¨ğŸ¾ Pemantauan lingkungan di ruang server (Bolid + Zabbix) ğŸ¤¸ğŸ¼ ğŸ™ğŸ¿ ğŸ›‘</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Mungkin cara termudah bagi profesional TI untuk memecahkan masalah pemantauan lingkungan di ruang server adalah dengan menggunakan pengontrol khusus d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Pemantauan lingkungan di ruang server (Bolid + Zabbix)</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/438788/">  Mungkin cara termudah bagi profesional TI untuk memecahkan masalah pemantauan lingkungan di ruang server adalah dengan menggunakan pengontrol khusus dengan output SNMP (misalnya, NetBotz atau NetPing).  Tetapi bagi mereka yang tidak takut kesulitan dan ingin mendapatkan solusi murah dari tingkat industri (dengan produksi seri peralatan) - ada opsi menarik dengan protokol Modbus. <br><br><img src="https://habrastorage.org/webt/wu/uc/mi/wuucmi1fiyi7sglvrsekrvey0pk.png"><br><a name="habracut"></a><br>  Di bawah ini saya akan menjelaskan sistem pemantauan berdasarkan komponen buatan Rusia - NVP Bolid, dan kami akan "menggabungkan" data dalam Zabbix 4.0.  NVP "Bolid" dikenal luas di kalangan peralatan otomasi pemadam kebakaran dan solusi yang dipertimbangkan akan menghasilkan "jejak" ini.  Perangkat mereka, secara sederhana, tidak berbeda dalam desain dan perhatian kasus, tapi ... harganya lebih dari kompensasi untuk semua kekurangan ini.  Perlu dicatat dokumentasi yang sangat bagus dan lebih atau kurang dukungan teknis gratis normal. <br><br><h2>  Protokol dan Antarmuka </h2><br>  Sebelum beralih ke perangkat keras, kami akan melihat sekilas protokol dan antarmuka yang digunakan: <br><br>  <b>Modbus</b> : protokol industri yang dibangun berdasarkan prinsip "Master" - "Slave".  Hanya ada satu master di jaringan Modbus yang melakukan polling pada budak dan â€œmemberi tahuâ€ apa yang harus dilakukan.  Sebagai media transmisi, ia dapat menggunakan antarmuka RS-485 (Modbus RTU) atau Ethernet (Modbus TCP).  Secara teoritis, jumlah perangkat maksimum adalah 247. <br><br>  <b>Orion</b> : protokol milik perusahaan NVP "Bolid", dibangun di atas prinsip "Master" (Master) - "Slave" (Slave).  Rupanya, antarmuka RS-485 yang dimodifikasi digunakan sebagai media transmisi data, karena panjang jalur maksimum bisa mencapai 3 km (!).  Jumlah perangkat maksimum adalah 127. <br><br>  <b>DLS</b> (jalur komunikasi dua-kawat): protokol milik perusahaan NVP "Bolid", dibangun berdasarkan prinsip "Master" - "Slave" (Master).  Menggunakan kabel pasangan tembaga sebagai media transmisi data (disarankan kabel twisted pair).  Jumlah perangkat maksimum adalah 127 + 1.  Topologi - bus (atau cincin) dengan cabang, panjang garis maksimum dapat mencapai 1,5 km (tergantung pada jenis kabel, penampang konduktor kabel dan jumlah perangkat yang terhubung). <br><br>  <b>RS-485</b> : antarmuka lapisan fisik, menggunakan "twisted pair" (satu "2-kawat" atau dua pasangan "4-kawat" untuk transmisi data, yang kedua kurang umum).  Panjang garis maksimum yang dinyatakan adalah 1,2 km.  Topologi adalah bus. <br><br>  Seperti yang Anda lihat, cukup banyak jalur komunikasi "jarak jauh" digunakan.  Dalam semua protokol, pengalamatan perangkat diatur oleh "handle" (pra-konfigurasi). <br><br><h2>  Sensor </h2><br>  Sistem ini melibatkan menghubungkan sensor alamat "khusus" (eksklusif) (untuk membuatnya lebih ketat "detektor", yaitu, perangkat dengan sensor built-in), tetapi Anda juga dapat menghubungkan non-address "biasa" menggunakan ekspander alamat (dari 1 hingga 8 input).  Penggunaan detektor yang dapat dialamatkan memberikan dua keuntungan: hampir semua perangkat yang dapat dialamatkan menerima daya melalui saluran sinyal (mis., Tidak perlu memasok saluran listrik 12V terpisah) dan tidak perlu menempatkan expander alamat di mana saja.  Sensor terhubung ke <abbr title="jalur komunikasi dua kawat">DPS</abbr> . <br>  Kisaran peralatan "terminal" cukup lebar, tetapi saya akan memberikan yang mungkin diperlukan saat memecahkan masalah kita: <br><br><ul><li>  S2000-VT - sensor suhu dan kelembaban gabungan untuk penggunaan dalam ruangan (IP41).  Memiliki sertifikat alat ukur, kesalahannya hanya 0,5 Â° C dan harga eceran yang disarankan hanya 1.200 rubel! </li><li>  S2000-SMK (dan variasinya) - sensor "pintu terbuka" (detektor kontak magnetik, saklar buluh).  Harga eceran yang disarankan - 300 rubel; </li><li>  S2000-DZ - sensor flooding titik (dilakukan bersamaan dengan Realty, jadi case "unformat").  Harga eceran yang disarankan - 800 rubel; </li><li>  2000-1, 2000-2, 2000-8 - address extender untuk koneksi 1, 2 dan 8, dapat digunakan sebagai â€œpenerimaâ€ sinyal tipe â€œkontak keringâ€ (on / off) dari peralatan lain (misalnya, dari perangkat pemadam kebakaran) atau pompa pendingin udara); </li><li>  S2000-SP2 - blok relai (untuk 2 output), yang dengannya Anda dapat mengontrol perangkat (misalnya, lampu alarm - indikator lampu).  Harga eceran yang disarankan - 1200 rubel. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Penampilan sensor</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/wy/ff/2k/wyff2kk8bfwz0bcq5feyh-kvja4.png"><br><br></div></div><br>  Untuk daftar peralatan lengkap, lihat <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">situs web resmi pabrikan</a> . <br><br><h2>  Pengendali </h2><br>  "Garis" pengendali, jika boleh saya katakan, terdiri dari tiga model: <br><br><ul><li>  S2000-KDL - model dasar (sebutan untuk "System 2000 - Pengendali Jalur Komunikasi Dua-kawat"); </li><li>  S2000-KDL-2I - menambahkan isolasi galvanik untuk RS-485 dan DPS; </li><li>  S2000-KDL-Modbus - konverter protokol Modbus S2000-PP telah ditambahkan ke desain S2000-KDL-2I. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Munculnya pengendali</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/gw/wu/nb/gwwunbbgi8jsdrp4lirdesxxoyi.png"><br></div></div><br>  Lebih optimal menggunakan S2000-KDL-Modbus, tetapi juga dimungkinkan untuk menggunakan S2000-KDL / C2000-KDL-2I dengan konverter protokol S2000-PP yang dipasang di dekatnya, yang memiliki desain perumahan yang dipasang di panel. <br><br>  Pengontrol memainkan peran "Pemimpin" di garis <abbr title="jalur komunikasi dua kawat">DLS</abbr> (hanya satu garis DPS yang dapat dihubungkan ke satu pengontrol), dan di garis RS-485 Orion, ia telah bertindak sebagai "Budak" dan tidak mungkin mengumpulkan data darinya "secara langsung".  Untuk mengumpulkan data dalam garis RS-485 Orion, konsol yang disebut 2000 atau 2000- (termasuk versi bawaan) digunakan, yang telah memiliki antarmuka transfer data yang terstandarisasi. <br><br>  Kontroler berikut juga dapat membedakan karakteristik berikut: <br><br><ul><li>  lihat jenis yang dapat dikonfigurasi, bukan yang dapat diprogram (mis. Anda hanya perlu mengonfigurasi parameter, dan tidak mengembangkan program); </li><li>  dukungan dalam <abbr title="jalur komunikasi dua kawat">DPS</abbr> hingga 127 perangkat yang dapat dialamatkan (S2000-VT memiliki dua alamat), dan banyak komisaris tidak merekomendasikan menggunakan lebih dari 100-110; </li><li>  input ganda untuk catu daya DC 12-24V; </li><li>  desain case yang tidak terlalu nyaman (semua kabel yang terhubung tidak dapat disembunyikan dalam case perangkat dan Anda harus melepasnya dari bagian belakang perangkat). </li></ul><br>  Untuk toleransi kesalahan sistem, Anda dapat menggunakan langkah-langkah berikut (yang opsional): <br><br><ul><li>  lingkaran cincin - satu loop istirahat di satu tempat tidak mempengaruhi keberadaan sinyal dari sensor dialamatkan; </li><li>  penggunaan branch-isolating blocks (BRIZ) - memungkinkan Anda untuk membuat cabang radial, serta mengisolasi segmen loop, di mana ada hubungan pendek "DPS +" dan "DPS-". </li></ul><br>  PENTING: firmware baru terus-menerus datang ke controller yang menghilangkan kesalahan dan menambah fungsionalitas, dan firmware C2000-KDL dan C2000-KDL-2I tidak kompatibel. <br><br><h2>  Koneksi Modbus </h2><br>  Seperti dijelaskan sebelumnya, baik kontroler C2000-Modbus atau konverter C2000-PP dapat digunakan.  Kedua skema menyediakan untuk penerbitan sinyal menggunakan protokol Modbus RTU 2-kawat menggunakan RS-485 sebagai perangkat pendukung (host kami adalah Zabbix atau beberapa sistem SCADA).  Dua metode dapat digunakan untuk terhubung ke server: <br><br><ul><li>  Lebih disukai - Modbus RTU / Modbus TCP converter dengan koneksi ke jaringan lokal yang sama di mana server kami dengan perangkat lunak berada; </li><li>  Murah - RS-485 / USB converter dengan koneksi langsung ke server.  Saya perhatikan bahwa ada banyak keluhan tentang keandalan stik USB ini (Anda dapat mengambil hampir semua, saya memesan dari China seharga 100 rubel, menggunakan banyak RS-232 / RS-485 converter dan adaptor USB / RS-232 dan semuanya terus bekerja!). </li></ul><br>  Ada dua skema untuk mentransmisikan peristiwa ke protokol Modbus dimungkinkan: <br><br><ul><li>  langsung dari 2000- / C2000--Modbus, ketika perangkat ini beroperasi dalam mode "Orion-Master" (dipilih oleh jumper di papan) dan bertindak sebagai interogator sistem "Orion"; </li><li>  menggunakan remote control "S2000M", ketika ia mengumpulkan informasi dari controller dan hanya kemudian mengirimkannya ke Modbus melalui C2000- / C2000--Modbus (mode "Orion-Slave").  Skema ini bagus karena remote dapat digunakan sebagai "terminal lokal" (lihat acara di layar LCD bawaan), dan juga terus merekam acara jika terjadi kegagalan server dengan perangkat lunak pemantauan.  Minus: pengaturannya sedikit lebih rumit dan remote control memiliki tampilan yang sangat spesifik. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Contoh rangkaian sistem</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/u6/se/lr/u6selr6hievry0qlrqy77naclpm.png"><br><br><img src="https://habrastorage.org/webt/lr/mr/ny/lrmrnydyc3k7okcrwtfinacdvj8.png"><br><br><img src="https://habrastorage.org/webt/fz/hb/gf/fzhbgfqp5l5crnlkazfbvabmemg.png"><br></div></div><br><h2>  Kekuasaan dan instalasi </h2><br>  Untuk catu daya, catu daya 12V DC diperlukan, lebih disukai distabilkan dan dipasang pada rel DIN.  Kekuatannya (biasanya ditunjukkan dalam mA atau A) dapat dipilih secara kasar dari perhitungan 1 pengontrol - 500 mA.  Saya akan merekomendasikan menggunakan catu daya redundan (dengan baterai bawaan, RIP) hanya jika menggunakan remote control S2000M.  Dan pastikan untuk menghubungkan sumber daya ke catu daya tak terputus (UPS) yang sama dengan server sistem pemantauan. <br><br>  Tentu saja, Anda dapat memasang semua ini di dinding, tetapi biarkan untuk pemasangan alarm kebakaran dan keamanan, dan kami akan menggunakan rel 3U DIN untuk pemasangan di kabinet 19 "(misalnya, PSM-3U atau Cabeus CMO dengan artikel yang sama, Anda harus membuang panel depan) Dalam hal menggunakan remote control S2000-M, Anda dapat menggunakan colokan 19 "4U (lebih disukai berlubang), yang akan bertindak sebagai panel pemasangan dan ke mana rel DIN untuk terminal dan pengontrol sudah diperbaiki.  Minus keputusan - peralatan singkatan dari pemasangan 19 "pesawat. <br><br>  Untuk merakit dan memasang sistem komponen seharusnya tidak menimbulkan pertanyaan, tetapi saya menarik perhatian sebagai berikut: <br><br><ul><li>  kebanyakan sensor memiliki sepotong kecil kabel yang menonjol.  Untuk menambah kabel, Anda bisa menggunakan solder dengan heat shrink, atau dua pasang swing box KS-2 (kompak, tetapi pengerjaannya "lumpuh"), atau koneksi RJ11 (RJ45); </li><li>  Sebelum memasang sensor, alamatnya harus didaftarkan (seperti dijelaskan di bawah) dan ditandai; </li><li>  saat menghubungkan sensor, perlu untuk mengamati polaritas "DLS +" dan "DPS-" (lihat dokumentasi - warna apa yang memiliki DPS +, biasanya berwarna) - jika Anda mencampurnya, sensor tidak akan terdeteksi dalam sistem. </li></ul><br>  Bagi mereka yang tidak ingin menyolder, tetapi suka memeras "chip", Anda dapat menggunakan opsi yang dijelaskan di bawah ini (mungkin, itu masih lebih baik daripada RJ11 - agar tidak secara tidak sengaja menghubungkan jalur DPS ke server). <br><br>  Itu akan diperlukan: <br><br><ul><li>  kabel twisted pair 2 pasang, unshielded; </li><li>  "Tas" konektor RJ11 (6P4C atau 6P6C); </li><li>  Pemisah RJ11 dengan input tipe soket (ada berbagai pilihan dengan harga yang sangat wajar). </li></ul><br>  Pada satu pasangan kita memulai DPS, di sisi lain, misalnya, 12V DC.  Menghubungkan sensor melalui splitter. <br><br><div class="spoiler">  <b class="spoiler_title">Gambar penjelasan</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/xf/v-/93/xfv-93ihmj39n_uhdyhhlqidgjg.png"><br></div></div><br><h2>  Majelis berdiri </h2><br>  Untuk bagian "praktis", sebuah stan dirakit yang terdiri dari: <br><br><ul><li>  konverter protokol C2000-PP yang diproduksi oleh NVP Bolid; </li><li>  controller S2000-KDL yang diproduksi oleh NVP "Bolid"; </li><li>  thermohygrometer (sensor suhu dan kelembaban gabungan) C2000-VT diproduksi oleh NVP Bolid; </li><li>  magnetic contact detector S2000-SMK yang diproduksi oleh NVP "Bolid"; </li><li>  sensor kebocoran titik S2000-DZ yang diproduksi oleh Rielta; </li><li>  alamat extender S2000-AP1 ISP  02 produksi NVP "Bolid"; </li><li>  detektor volumetrik Photon-10M yang diproduksi oleh "Rielta" ("tumpukan"); </li><li>  Unit catu daya 12V-AT / 12 / 1.5 DIN yang diproduksi oleh AccordTec; </li><li>  Adaptor RS-485 / USB dibeli di <a rel="noreferrer noopener" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">aliexpress</a> (pada chip CH340G yang umum, linux mendefinisikannya sebagai "adaptor serial USB QinHeng Electronics HL-340").  Menjadi menarik bagaimana sistem akan bekerja dalam konfigurasi termurah; </li><li>  TONK 1811 thin client dari TONK Group of Companies (dibeli di avito seharga 500 rubel) pada prosesor Intel Atom N270 dengan grafis GMA950 terintegrasi. </li></ul><br><img src="https://habrastorage.org/webt/6b/kr/ed/6bkred606ln2axp3wlcrztumlly.png"><br><br><div class="spoiler">  <b class="spoiler_title">Menyempurnakan klien tipis dan penampilan dudukan</b> <div class="spoiler_text">  Thin client sedikit "selesai": <br><br><ul><li>  Modul DOM 2GB dengan Windows XP tertanam terpasang telah digantikan oleh 2,5 ATA 60GB HDD dari laptop lama (saya harus membeli kabel, untuk beberapa alasan SATA-HDD tidak mengambil - itu termasuk port SATA di BIOS); </li><li>  meningkatkan DDR2 SO-DIMM RAM dari 1GB menjadi 2GB; </li><li>  Linux Mint 19.1 â€œTessaâ€ Xfce Edition diinstal dan desktop jarak jauh dikonfigurasikan menggunakan TightVNC; </li><li>  Sistem pendingin "disempurnakan" - ini mengurangi heatsink sehingga HDD pas hampir "flush" dengan kasing, melepas penutup atas dan di atas "menambahkan" beberapa kipas 120 mm terhubung melalui resistor.  Segera semua "rem" menghilang, menjadi cukup masuk akal untuk bekerja. </li></ul><br><br><img src="https://habrastorage.org/webt/ct/ri/5v/ctri5vgqehkummqppp22cd3k2uw.jpeg"><br></div></div><br><h2>  Konfigurasikan peralatan Bolid </h2><br>  Semua pengaturan dibuat di lingkungan Windows, jadi sebelum mulai bekerja, Anda perlu menginstal driver pada adaptor RS-485 / USB, serta dua program "super" dari NVP "Bolid", yang dikirimkan secara gratis: <strong>Orion-prog</strong> dan <strong>Uprog</strong> .  Lebih lanjut, perangkat terhubung secara terpisah ke adaptor RS-485 / USB ke port Orion AB RS-485 (tata letak langsung digunakan, dan tidak seperti pada port COM). <br><br>  PENTING: dengan semua langkah selanjutnya pada S2000-PP, jumper XP1 di papan tulis harus dihapus. <br><br>  Langkah 1. Masukkan adaptor RS-485 / USB ke dalam konektor USB dan lihat di manajer perangkat yang nomor port COM diberikan ke adaptor.  Driver untuk adaptor harus diinstal tanpa tanda seru di "Device Manager". <br><br>  Langkah 2. Atas nama administrator, jalankan Orion-prog, pilih port COM yang diinginkan dan lakukan pencarian dan lihat versi firmware perangkat.  Kunjungi situs web resmi pabrikan dan periksa apakah ada firmware yang lebih baru dan, jika perlu (kemungkinan besar, akan diperlukan), lakukan pembaruan (pada saat penulisan: 1.32 untuk C2000-PP, 2.22 untuk C2000-KDL). <br><br><div class="spoiler">  <b class="spoiler_title">Firmware instrumen dalam gambar</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/6i/lm/py/6ilmpyshwlwgygxsep6myrt-yzm.gif"><br></div></div><br>  * Firmware 1,32 pada kenyataannya, saya telah diinstal "dengan bengkok" - dalam Uprog, konfigurasi tidak dibaca dari perangkat.  Oleh karena itu, "bergulir kembali" ke 1,31. <br><br>  Langkah 3. Mengatur alamat untuk perangkat (pertama dengan S2000-PP, misalnya, 2 dan kemudian dengan S2000-KDL - 3).  Untuk melakukan ini, jalankan Uprog - semua perangkat memiliki alamat default 127, jadi Anda perlu mengkonfigurasi perangkat di awal satu per satu.  Untuk video yang lebih detail dari pabrikan, lihat <a rel="noreferrer noopener" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">YouTube</a> . <br><br>  Langkah 4. Setelah mengatur alamat pada S2000-KDL, perlu mengatur alamat sensor di jalur komunikasi dua-kawat (DLS).  Mereka juga memiliki alamat default 127 (dan lingkaran dengan sensor di Uprog tidak disorot).  Kami membaca konfigurasi perangkat (Ctrl + F3) dan secara berurutan menghubungkan sensor ke output DLS, mengatur alamat.  Saat menunjuk sensor di menu konteks "Permintaan untuk tipe AU", Anda dapat menentukan jenis sensor atau "Permintaan untuk ADC AU" - cari tahu apakah sensor berfungsi (misalnya, untuk detektor kontak magnetis ADC saat menutup: 100, dan saat membuka: 50).  Bahkan, saya memiliki konfigurasi alamat sebagai berikut: 1 - saklar reed C2000-SMK, 2 - suhu C2000-VT, 3 - kelembaban C2000-VT, kebocoran 4 - C2000-DZ, 5 - C2000-AP1 address expander isp.  02 (dengan pendeteksi volumetrik Photon-10M terhubung). <br><br><div class="spoiler">  <b class="spoiler_title">Mengatasi sensor dalam gambar</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/j9/vo/dk/j9vodkzjmmydzvrsk377m3zinok.gif"><br></div></div><br>  Selanjutnya, buka tab "Input" dan lakukan hal berikut: <br><br><ul><li>  menunjukkan jenis sensor: untuk suhu - 10, untuk mengukur kelembaban - 15, untuk semua lainnya - 6 (teknologi); </li><li>  untuk input teknologi, kami menetapkan "Waktu pemulihan, s" - ini adalah waktu setelah loop akan kembali ke status "Normal" setelah menerima status "Pelanggaran".  Penting untuk menunjukkan jumlah setidaknya interval pemungutan suara di Zabbix (saya butuh 10 detik); </li><li>  matikan "Kontrol indikasi AU" (0), "Pemantauan sirkuit terbuka dan pendek" dan "Pemantauan status baterai cadangan" untuk menyederhanakan pengaturan. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Mengkonfigurasi input ke S2000-KDL dalam gambar</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/90/cn/68/90cn68wqswa16_nt7pqxzy830de.gif"><br></div></div><br>  Setelah semua "manipulasi" dengan C2000-KDL, kami melakukan "Catatan Konfigurasi dalam Instrumen". <br><br>  Langkah 5. Konfigurasikan S2000-PP. <br>  Pada tab "Perangkat", pengaturan ditampilkan dalam gambar (ini adalah yang paling "berjalan" dan secara default untuk sebagian besar perangkat).  COM-port adaptor RS-485 / USB dan perangkat lain yang terhubung ke jaringan Modbus harus memiliki pengaturan yang sama.  Saya memilih alamat 11 untuk perangkat S2000-PP di jaringan Modbus (alamat dalam sistem Orion adalah 2!). <br><br><img src="https://habrastorage.org/webt/ej/6y/31/ej6y31hxzfnze6nzx29rjcnsfwk.png"><br><br>  Kemudian kita pergi ke tab "Perangkat" dan mulai mengisi "Tabel Tabel": <br><br><ul><li>  kolom pertama saya menunjukkan "3" - ini adalah alamat perangkat S2000-KDL dalam sistem Orion; </li><li>  alarm loop number ("alarm loop") - ini adalah alamat sensor (sebenarnya loop alarm = alamat, kita dapat melewati beberapa alamat jika kita tidak ingin mengambil informasi dari mereka); </li><li>  Modbus Section No. - Anda dapat mengelompokkan sensor kami dalam kelompok.  Untuk menyederhanakan - saya tidak melakukan ini dan dikaitkan dengan semua orang 1 bagian; </li><li>  tipe zona adalah parameter yang sangat penting.  Kami memilihnya sesuai dengan jenis sensor. </li></ul><br><img src="https://habrastorage.org/webt/8g/bo/ea/8gboea_ibzpk6nr04myidkbgtru.png"><br><br>  Setelah mengatur S2000-PP, kami melakukan "Catatan Konfigurasi dalam Instrumen". <br><br>  Langkah 6. Gabungkan C2000-PP dan C2000-KDL ke dalam jaringan melalui RS-485 Orion, sambungkan sensor ke C2000-KDL (Anda dapat menggunakan banyak dua terminal), dan hubungkan adaptor RS-485 / USB ke output Modbus C2000-PP.  Kami mengatur jumper XP1 ke posisi tertutup (penting: setelah menginstal jumper, Anda harus memulai ulang perangkat dengan mengatur ulang tegangan suplai).  Semuanya - sistemnya "siap bertarung." <br><br>  Kami memeriksa "operabilitas" dalam program konsol gratis <a rel="noreferrer noopener" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Modpoll Modbus Master Simulator</a> (selanjutnya disebut "Modpoll"), misalnya, pada alamat firmware "S2000-PP" atau dengan mengirimkan informasi dari S2000-KDL ke "40000" - ini adalah sensor pertama: <br><br><img src="https://habrastorage.org/webt/ij/hv/go/ijhvgoynxeyxwua5abdcgvapi3u.png"><br><br>  Firmware "untuk pengenalan" dapat diunduh di <a href="">sini</a> . <br><br><h2>  Pengaturan Zabbix </h2><br>  <font color="red">Peringatan: Zabbix dikonfigurasi untuk pertama kali, seperti Linux Mint (karena tidak ada Zabbix di Windows) :)</font> <br><br>  Setelah menginstal Zabbix, Anda perlu menginstal paket <i>autoconf</i> , <i>automake</i> , <i>libtool</i> , <i>pkg-config</i> dan kemudian modul ekstensi - <i>libzbxmodbus</i> .  Ada artikel terpisah tentang dia di <a rel="noreferrer noopener" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">HabrÃ©</a> (saya akan terus merujuknya) dan baru-baru ini diperbarui, hanya untuk bekerja dengan Zabbix 4.0.  Artikel ini juga memiliki informasi lebih rinci tentang protokol Modbus.  Modul itu sendiri dan petunjuk lebih banyak atau lebih detail ada di <a rel="noreferrer noopener" href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">GitHub</a> . <br><br>  Perbedaan kecil dalam instalasi dari yang ditentukan pada GitHub: <br><br><pre><code class="plaintext hljs">... ./configure --prefix=/etc/zabbix --enable-zabbix-3.2 ... sudo make install</code> </pre> <br>  Ketika mempelajari pengoperasian modul <i>libzbxmodbus</i> , menjadi jelas bahwa tidak akan mungkin untuk menerapkan rangkaian dengan remote control C2000M, karena dalam hal ini data dari termohygrometers terlihat seperti ini: tulis jumlah zona yang diinginkan untuk mendaftar 46179 dan kemudian kumpulkan data dari register 46328 - i.e.  sangat tidak sepele (dalam sistem SCADA "besar", ini dapat diimplementasikan, misalnya, di MasterSCADA). <br><br>  Dalam file konfigurasi <i>etc / zabbix / zabbix_server.conf, kami menulis</i> tautan <i>ekstensi</i> dan menghubungkan perangkat keras ke server dengan Zabbix.  Saya tidak harus menginstal driver untuk adaptor RS-485 / USB, tetapi saya masih tidak mengerti bagaimana mencari tahu nomor USB mana yang akan digunakan, ada baiknya koneksi ke <i>/ dev / ttyUSB0</i> berfungsi (Anda dapat melihat bahwa perangkat ditemukan di sistem menggunakan perintah <i>lsusb</i> ). <br><br>  Seperti Windows, kami memeriksa menggunakan utilitas Modpoll (saya menjalankan linux i386) bahwa perangkat keras terhubung dan informasi dari mereka tersedia: <br><br><img src="https://habrastorage.org/webt/wn/8_/zz/wn8_zz98bldyf7hzc5zdkc90v80.png"><br><br>  Karena artikel tersebut menjelaskan proses konfigurasi menggunakan contoh Zabbix 2.2 - antarmuka sedikit berbeda di sana, saya akan memberikan penjelasan dan gambar pengaturan. <br><br><p>  Langkah 1. Kami membuat simpul jaringan dan grup tempat simpul kami akan dimasukkan (misalnya, simpul - "Pemantauan Lingkungan" dan grup - "Infrastruktur Rekayasa"): <br>  Pengaturan&gt; Hosts&gt; Buat host&gt; Masukkan nama kami&gt; Tambah <br><br><img src="https://habrastorage.org/webt/vj/cd/fi/vjcdfibmwzvcm7vudrfubf4nuaa.png"><br><br>  Langkah 2. Buat elemen data.  Artikel ini merekomendasikan membuat template, tetapi karena sistem kami tidak mengandung elemen duplikat, jadi saya akan melewati langkah ini.  Misalnya, jika kami memiliki beberapa AC yang terhubung melalui Modbus, maka kami dapat menggunakan fungsionalitas sistem. <br><br>  Pengaturan&gt; Node jaringan&gt; Pada baris yang berisi nama simpul kami "Pemantauan Lingkungan" klik "Elemen Data"&gt; di jendela yang muncul, klik "Buat Elemen Data". <br><br>  Kita mulai "memalu" sensor kita: <br><br><img src="https://habrastorage.org/webt/j_/ei/9n/j_ei9nphfowd7sgjp6r8u3r9xyk.png"><br><br>  Nuansa minor: <br><br></p><ul><li>  artikel menggunakan sintaks fungsi <em>modbus_read_registers</em> , dan menurut deskripsi GitHub tentang <em>modbus_read</em> , opsi kedua lebih pendek dan berfungsi; </li><li>  alih-alih makro <em>{$ MODBUS_PORT}</em> dan <em>{$ MODBUS_SLAVE},</em> Anda dapat menentukan port dalam bentuk <em>/ dev / ttyUSB0</em> dan " <em>11</em> ", tetapi ini akan merepotkan jika nanti Anda perlu mengubah port USB atau alamat S2000-PP; </li><li>  dokumentasi menyatakan bahwa untuk meminta status zona (kolom "Modbus zone No.") pada S2000-PP, Anda harus menghubungi: "register address 40000 + M, di mana M = (zone No. â€“1)" - ini adalah kemajuan: "zona No. <strong>minus</strong> 1 " </li><li>  jangan melakukan survei waktu yang sangat sering: S2000-PP mulai mengembalikan kesalahan "exception error 15" - perangkat tidak punya waktu untuk menyiapkan data (ini dinyatakan dalam cahaya konstan indikator pada perangkat); </li><li>  untuk data suhu dan kelembaban dengan register 3000 -... diambil </li><li>  di jendela "Elemen Data" ada juga tab "Pra-Pemrosesan" yang diinginkan.  Di sini Anda dapat mengedit apa yang akan ditampilkan "pada akhirnya."  Suhu dan kelembaban diperoleh dari nilai pembacaan, yang harus dibagi dengan 256: "Faktor pengguna" - 0,0039 (yaitu 1/256); </li><li>  Untuk sakelar buluh diskrit, sensor kebocoran, dll.  Anda juga perlu menggunakan "Tampilan Nilai", ini karena cara informasi disediakan. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Mengatur konversi data dalam gambar</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/pj/g1/yr/pjg1yrlg-hfu83bgzuch6rke-xg.png"><br><br><img src="https://habrastorage.org/webt/k4/7o/hu/k47ohudcuf9ycomoxbdebii6kvu.png"><br></div></div><br>  Sedikit tentang bagaimana data disediakan saat polling zona. <br>  Misalkan Anda menerima respons dalam format desimal 9148 (D).  Kami akan menerjemahkannya dalam format heksadesimal (HEX): dapatkan 23BC - sesuai dengan instruksi untuk perangkat S2000-PP, ini adalah dua peristiwa dengan kode 23 (HEX) / 35 (D) dan BC (HEX) / 188 (D).  Selanjutnya, lihat Tabel 5. "Daftar peristiwa (status AL) dari sistem Orion".  Di dalamnya kita temukan, 35 "Mengembalikan input teknologi" dan 188 "Mengembalikan komunikasi dengan input."  Tidak perlu menerjemahkan D-HEX-D, acara pertama adalah bagian integer dari pembagian nilai yang diterima dengan 256, dan sisanya adalah acara kedua ( <strong>9148</strong> = <strong>35</strong> * 256 + <strong>188</strong> ).  Saat mewawancarai input teknologi, kami hanya akan mengambil acara pertama (prioritas), yang "seharusnya" mengambil status 35 dan 36 ("Kembalikan input teknologi" dan "Pelanggaran input teknologi").  Kami akan membuang bagian fraksional (peristiwa kedua) menggunakan pengaturan Elemen Data "Jenis Informasi: Numerik (bilangan bulat positif)". <br><br>  Langkah 3. Isi makro port dan nomor perangkat: <br>  Pengaturan&gt; Node jaringan&gt; "Pemantauan lingkungan"&gt; pilih "Makro" <br><br><img src="https://habrastorage.org/webt/h1/r-/qg/h1r-qgd4rrdym-txvbmnhsqwgre.png"><br><br>  Langkah 4. Menampilkan bacaan pada panel kontrol: <br>  Mulai layar&gt; Semua panel, pilih "Buat panel"&gt; di jendela yang muncul, atur "Nama panel" dan pengguna yang panelnya tersedia&gt; Klik "Buat widget baru"&gt; Ketik "Gambaran umum data", Interval pembaruan "10 detik", Grup node dari jaringan Infrastruktur Rekayasa&gt; Tambah&gt; Sesuaikan ukuran panel dan klik "Simpan Perubahan": <br><br><img src="https://habrastorage.org/webt/wl/ge/la/wlgelajwrwuuta5phssi2b5rx38.gif"><br><br><h2>  Kesimpulan </h2><br>  Sistem yang dihasilkan, melalui penggunaan protokol "jarak jauh", dapat menjadi solusi yang sangat baik, baik untuk memantau server dan sepasang lintas, zona kantor (dalam hal memantau kondisi suhu dan kelembaban) atau bahkan pusat data kecil.  Seseorang mungkin mengatakan "fu fu fu, mobilnya masih menjijikkan, Anda perlu menggunakan XXX (menggantikan sesuatu dari otomasi industri)" juga merupakan pilihan, tetapi menurut saya itu akan sangat berlebihan dan juga lebih mahal .  Dan sedikit nuansa: seperti yang Anda lihat, sistem pada Bolid cukup sederhana (meskipun ada logika yang agak aneh), tetapi "selesaikan" keputusan pada prom.  pengendali - terkadang dia masih "smut." <br><br>  PS Artikel ini adalah adaptasi dari dua artikel di blog saya: <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pemantauan murah untuk ruang server (bagian 1 - pengantar)</a> <br>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pemantauan murah untuk ruang server (bagian 2 - praktis)</a> <br><br>  UPD  Setelah bekerja selama 3 hari, adaptor RS485-USB jatuh.  Itu diakui tidak stabil, tetapi cocok untuk commissioning.  Itu digantikan oleh konverter port tunggal MGate MB3170 yang dibuat oleh MOXA (diambil dari apa yang ada di tangan) - semuanya menjadi stabil. <br>  Anda perlu memahami bahwa artikel ini hanyalah contoh tentang bagaimana "berteman" dengan Zabbix dan Bolid.  Untuk implementasi nyata, Anda dapat menambahkan lebih banyak status DPS yang dipantau, serta, misalnya, suhu negatif (mereka diproses agak berbeda). </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id438788/">https://habr.com/ru/post/id438788/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id438774/index.html">Semua yang terbaik sekaligus. Artikel yang paling jelas dari blog LANIT di HabrÃ© - 2018</a></li>
<li><a href="../id438776/index.html">Kiat dan trik dari saluran Telegram saya @pythonetc, Januari 2019</a></li>
<li><a href="../id438778/index.html">@Pythonetc Januari 2019</a></li>
<li><a href="../id438782/index.html">FSB telah mengusulkan untuk merilis kartu SIM Rusia dan menggunakan kriptografi domestik untuk 5G</a></li>
<li><a href="../id438784/index.html">Masalah menggunakan layanan Yandex.Metrica</a></li>
<li><a href="../id438790/index.html">Pertukaran cryptocurrency QuadrigaCX tidak akan memberikan $ 137 juta. Hanya direktur yang tahu kata sandi dari toko, dan dia meninggal</a></li>
<li><a href="../id438792/index.html">Menggunakan AccelStor Semua Array Flash dalam Proyek VDI</a></li>
<li><a href="../id438794/index.html">Detail Objek JavaScript</a></li>
<li><a href="../id438796/index.html">Mempelajari Docker Bagian 1: Dasar-Dasarnya</a></li>
<li><a href="../id438798/index.html">Cara bekerja dengan data intelijen dunia maya: kami belajar mengumpulkan dan mengidentifikasi indikator kompromi sistem</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>