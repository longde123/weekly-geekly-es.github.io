<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ™ŒğŸ¾ ğŸŒ± ğŸ’¶ å‡½æ•°å¼ç¼–ç¨‹ä¸æ˜¯æˆ‘ä»¬æ‰€äº†è§£çš„ ğŸ ğŸ‘©ğŸ»â€ğŸ¤â€ğŸ‘¨ğŸ½ ğŸ“£</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ä¸ªéå¸¸æœ‰è¶£çš„èŒƒä¾‹ã€‚ ä¸€æ–¹é¢ï¼Œæ¯ä¸ªäººéƒ½çŸ¥é“è¿™ä¸€ç‚¹ï¼Œè€Œä¸”æ¯ä¸ªäººéƒ½å–œæ¬¢ä½¿ç”¨å„ç§æ¨¡å¼åŒ¹é…å’Œlambdaï¼Œå¦ä¸€æ–¹é¢ï¼Œå¾ˆå°‘æœ‰äººé€šå¸¸ä½¿ç”¨çº¯FPè¯­è¨€ç¼–å†™ã€‚ å› æ­¤ï¼Œäººä»¬è®¤ä¸ºè¿™å¾ˆå¯èƒ½ä¼šå›åˆ°ç¥è¯å’ŒåŸå¸‚ä¼ è¯´ä¸­ï¼Œè€Œè¿™ä¸äº‹å®ç›¸å»ç”šè¿œï¼Œäººä»¬è®¤ä¸ºâ€œ FPé€‚ç”¨äºæ‰€æœ‰è„±ç¦»ç”Ÿå‘½çš„åˆ†å½¢è®¡ç®—ç¨‹åºï¼Œå¹¶ä¸”åœ¨å®é™…ä»»åŠ¡ä¸­æœ‰å¯é çš„è®°å½•åœ¨...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>å‡½æ•°å¼ç¼–ç¨‹ä¸æ˜¯æˆ‘ä»¬æ‰€äº†è§£çš„</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/479238/"><p> å‡½æ•°å¼ç¼–ç¨‹æ˜¯ä¸€ä¸ªéå¸¸æœ‰è¶£çš„èŒƒä¾‹ã€‚ ä¸€æ–¹é¢ï¼Œæ¯ä¸ªäººéƒ½çŸ¥é“è¿™ä¸€ç‚¹ï¼Œè€Œä¸”æ¯ä¸ªäººéƒ½å–œæ¬¢ä½¿ç”¨å„ç§æ¨¡å¼åŒ¹é…å’Œlambdaï¼Œå¦ä¸€æ–¹é¢ï¼Œå¾ˆå°‘æœ‰äººé€šå¸¸ä½¿ç”¨çº¯FPè¯­è¨€ç¼–å†™ã€‚ å› æ­¤ï¼Œäººä»¬è®¤ä¸ºè¿™å¾ˆå¯èƒ½ä¼šå›åˆ°ç¥è¯å’ŒåŸå¸‚ä¼ è¯´ä¸­ï¼Œè€Œè¿™ä¸äº‹å®ç›¸å»ç”šè¿œï¼Œäººä»¬è®¤ä¸ºâ€œ FPé€‚ç”¨äºæ‰€æœ‰è„±ç¦»ç”Ÿå‘½çš„åˆ†å½¢è®¡ç®—ç¨‹åºï¼Œå¹¶ä¸”åœ¨å®é™…ä»»åŠ¡ä¸­æœ‰å¯é çš„è®°å½•åœ¨ç»è¿‡æ—¶é—´è€ƒéªŒçš„OOPä¸­ã€‚â€ </p><br><p><img src="https://habrastorage.org/webt/uc/pd/i9/ucpdi948cvmdtkpxzvajsrdiwoq.png"></p><br><p>å°½ç®¡äººä»¬é€šå¸¸éƒ½è®¤è¯†åˆ°FPåŠŸèƒ½çš„ä¾¿åˆ©æ€§ï¼Œä½†ç¼–å†™èµ·æ¥è¦å¥½å¾—å¤šï¼š </p><br><pre><code class="cs">int Factorial(int n)
{
    Log.Info($"Computing factorial of {n}");
    return Enumerable.Range(1, n).Aggregate((x, y) =&gt; x * y);
}</code></pre><br>
<p>    </p><br>
<pre><code class="cs">int Factorial(int n)
{
    int result = 1;
    for (int i = 2; i &lt;= n; i++)
    {
        result *= i;
    }
    return result;
}</code></pre><br>
<p> ?    .            .</p><br>
<p>  ,   ?   ,      ,        â€”  ?  , ,  . </p><a name="habracut"></a><br>
<p>,    ?   ,    ,             .   :</p><br>
<blockquote>  â€” ,    .</blockquote><p>,   ,     ?   â€” ,      . ,  :</p><br>
<blockquote> <code>f</code>     <code>f(x)</code>        <code>x</code></blockquote><p>      ,      " ".    â€”   ,    ?       ?      " " ?         ,       ,    ,     .</p><br>
<p>    ?   :</p><br>
<blockquote>  â€” ,              </blockquote><p>      -  <code>var x = foo()</code>        <code>var x = result_of_foo</code>     .       .    ( )   .    â€” ,   " ".      ,     . ,            CPU â€”       (  ,        ).                â€”      !</p><br>
<p>   .  ,       ? ,  ,      - <code>Factorial(5)</code>  <code>120</code>       â€”         (      "   ,  "       ,      . ,          ,         ,      ).</p><br>
<p>    ?       :           .</p><br>
<p> ,         ,         <code>var x = result_of_foo</code>  <code>var x = foo()</code>    .   "Equational reasoning",   "   ".      ,   â€”     ,        .</p><br>
<p>  :  <em> </em>       . ,        .        <abbr title="State transition monad">ST</abbr>,             .   â€”         : <code>ST</code>      .     ,        ,        ,  â€”    .</p><br>
<h2 id="zachem-eto-nuzhno">  </h2><br>
<p> â€”   .   ?       ,      <code>ST</code>   (  )   ,    â€¦  â€”   .    <code>goto</code>    ,                      ,      <code>goto</code>  ,            - .</p><br>
<p> Equational reasoning   ,  :        .    ,     ,             ,        .</p><br>
<p>                   .        C#,       ,       ( )</p><br>
<pre><code class="cs">var something = function();
DoStuff(this.Field, something);</code></pre><br>
<p>         ,    :</p><br>
<pre><code class="cs">DoStuff(this.Field, function());</code></pre><br>
<p>   ,     ,        .     ,    <code>function</code>   : </p><br>
<pre><code class="cs">... - 
this.Field = GetUpdatedVersion(this.Field, localData) // ! 
...     </code></pre><br>
<p>         : </p><br>
<pre><code class="cs">var something = function();
var arg1 = this.Field;      //   function -  !
var arg2 = something;
DoStuff(arg1, arg2);</code></pre><br>
<p>    :</p><br>
<pre><code class="cs">var arg1 = this.Field;      //   function -   !
var arg2 = function();
DoStuff(arg1, arg2);</code></pre><br>
<p>    <code>DoStuff</code>     ,       .</p><br>
<p>    ? "     ,   "? ,  ,          .          <abbr title="      - State,             .        ">  </abbr>    . </p><br>
<p>   ,    ,          <em> </em>.  ,   ,   - C#    ,     ,    DI ,     <code>function</code>  <code>DoStuff</code>,           .       ,    ,           .</p><br>
<p>             .       ,    .   ,   -      .   ,   .   ,                 ,            .       ,     .  ,      ,              ,    .      ,         â€”        .           â€”     ,     - .</p><br>
<h2 id="kak-eti-principy-otrazhayutsya-v-kode">     </h2><br>
<p>       ,     <a href="https://www.manning.com/books/functional-programming-in-scala" rel="nofollow">  Scala</a> (  ,       , c  ). ,          C#.</p><br>
<p>       ,     .    ,   .</p><br>
<h5 id="oop-variant"> </h5><br>
<p>,   ,   :</p><br>
<pre><code class="cs">public class Cafe
{
    public Coffee BuyCoffee(CreditCard card)
    {
        var cup = new Coffee()
        card.Charge(cup.Price)
        return cup
    }
}</code></pre><br>
<p> <code>card.Charge(cup.Price)</code>    .          â€” ,       -    - -,     .     ,           Coffee,       ""     "  ".</p><br>
<p>  -     .      "        !".  ,   :</p><br>
<pre><code class="cs">public class Cafe
{
    public Coffee BuyCoffee(CreditCard card, IPaymentProvider paymentProvider)
    {
        var cup = new Coffee()
        paymentProvider.Charge(card, cup.Price)
        return cup
    }
}</code></pre><br>
<p>          :      <code>IPaymentProvider</code>.      . </p><br>
<ul>
<li>-    <code>IPaymentProvider</code>,            . </li>
<li>-        .   â€” InMemory DB,    Insert/Save/â€¦ ,      (    )  ,     .   ,      â€”  ?  ,    -      <strong></strong>  ,   ,                .</li>
<li>  -      .     N  .                 (          ):</li>
</ul><br>
<pre><code class="cs">public class Cafe
{
    public Coffee BuyCoffee(CreditCard card, IPaymentProvider paymentProvider)
    {
        var cup = new Coffee()
        paymentProvider.Charge(card, cup.Price)
        return cup
    }

    public Coffee[] BuyCoffees(int count, CreditCard card, IPaymentProvider paymentProvider)
    {
        //      0   , 
        //       0 
        if (count == 0) return Array.Empty&lt;Coffee&gt;(); 
        var cups = Enumerable.Range(0, count).Select(_ =&gt; new Coffee()).ToArray();
        paymentProvider.Charge(card, cups[0].Price * count)
        return cups
    }
}</code></pre><br>
<p>        .        - ,           . </p><br>
<h5 id="fp-variant"> </h5><br>
<p>     ,      ?   â€”       ,      ,    .      :</p><br>
<pre><code class="cs">public class Cafe
{
    public (Coffee, Charge) BuyCoffee(CreditCard card)
    {
        var cup = new Coffee()
        return (cup, new Charge(card, cup.Price))
    }
}</code></pre><br>
<p>,   .   ,    ,      .     ,        <code>Charge</code>     .     :         . <code>Charge</code>   DTO        .  ,     .       ,     .        ,     .           , !</p><br>
<p>   N  ?       ,      N  <code>BuyCoffee</code>    ,    . </p><br>
<pre><code class="cs">public class Cafe
{
    public (Coffee, Charge) BuyCoffee(CreditCard card)
    {
        var cup = new Coffee()
        return (cup, new Charge(card, cup.Price))
    }

    public (Coffee[], Charge) BuyCoffees(int count, CreditCard card)
    {
        var (coffees, charges) = Enumerable.Range(0, count)
                                           .Select(_ =&gt; BuyCoffee(card))
                                           .Unzip();
        return (coffees, charges.Aggregate((c1, c2) =&gt; c1.ombine(c2))
    }
}</code></pre><br>
<p>   - <code>Combine</code>:</p><br>
<pre><code class="cs">public class Charge
{
    public CreditCard Card { get; set; }
    public double Amount { get; set; }

    public Charge(CreditCard card, double amount)
    {
        Card = card;
        Amount = amount;
    }

    public Charge Combine(Charge other)
    {
        if (Card != other.Card) 
            throw new ArgumentException("Can't combine charges to different cards");
        return new Charge(Card, Amount + other.Amount);
    }
}</code></pre><br>
<p>  -       . ,         ,    :</p><br>
<pre><code class="cs">IEnumerable&lt;Charge&gt; Coalesce(IEnumerable&lt;Charge&gt; charges) =&gt; 
    charges.GroupBy(x =&gt; x.Card).Select(g =&gt; g.Aggregate((c1, c2) =&gt; c1.Combine(c2))</code></pre><br>
<p>    ,    .  , ,           ,     .</p><br>
<p>,    ,  -   ,         ,     ,    -      <code>Cafe</code>.   ,   ,           ,     ,    ,    -     (        ,      ).</p><br>
<p>    ,         <code>IPaymentProvider</code>  ,      ,     :   ,  ,            ,       "" ,     ,   .  ,   ,     .</p><br>
<p>                 ,     ,   .    "     "     ,            .         RAII:   ,       .</p><br>
<h2 id="i-eto-vsyo">  ?</h2><br>
<p>      â€” ,  .     ,   ,    .   ,        ,       ,      .     (   int    )     ,      (,  goto)     ,    (Templates vs Generics)            ,   .</p><br>
<p>       ,   ,      .   ,     "" ,      ,          ,       <em></em>     .       ?    <code>void UpdateOrders()</code>  <code>void UpdateUsers()</code>       <code>() -&gt; ()</code>,    .        <code>() -&gt; OrdersUpdate</code>  <code>() -&gt; UsersUpdate</code>.  ,       (    )          ,    .</p><br>
<p>    ? ,        (  Rust)</p><br>
<pre><code class="rust">//   ,  - ,      
fn foo&lt;T&gt;(a: &amp;[T], b: T) -&gt; T { ...- ... }</code></pre><br>
<p> <em> </em>    ,     ,       ,      â€”  <code>b</code>   .    ? ,         <code>T</code>.        . ,        â€”        . </p><br>
<p>     </p><br>
<pre><code class="rust">let a = [1,2,3,4,5];
let b = foo(a, 10);
assert!(b == 10 || a.iter().any(|x| x == b))</code></pre><br>
<p>     <em></em>   ,      UB    -  (       ).    ,     ,     -        -    ,    (,        ,         ). </p><br>
<p>         :</p><br>
<pre><code class="rust">fn foo&lt;T&gt;(a: &amp;[T]) -&gt; T { ...- ... }</code></pre><br>
<p> ,        , ,        - . ,   ,  Bottom- <code>âŠ¥</code>.    ?        T,       .           <code>a</code>.     -,       .       . </p><br>
<p> ,      ,              .</p><br>
<p>     ,     ?        ,    .  ,    :</p><br>
<pre><code class="cs">T Foo&lt;T&gt;(List&lt;T&gt; list, T value) =&gt; default(T);</code></pre><br>
<p>         ,   .     .       ,     ,         â€”         .       ,      ,      ,      . </p><br>
<p>       ,        T?  :</p><br>
<pre><code class="rust">fn foo&lt;T: Default&gt;(a: &amp;[T]) -&gt; T { ...- ... }</code></pre><br>
<p>   <em></em>      ,     <em></em>       ,         .      ,     ,   -    .       â€”      .        .   ! ,               <code>default(T)</code>.</p><br>
<p>     99%         ,   .     ,   . Haskell          <a href="https://hoogle.haskell.org/" rel="nofollow">Hoogle</a>         .    . </p><br>
<p> <code>(a -&gt; Bool) -&gt; [a] -&gt; [a]</code> (,   :   ,        )     <code>filter</code>  <code>takeWhile</code>.</p><br>
<p>    . ,     ?   ,     . </p><br>
<pre><code class="plaintext">fn bar&lt;T&gt;(s: String) -&gt; T { ... } // -
bar :: String -&gt; a                // -</code></pre><br>
<div class="spoiler"><b class="spoiler_title"></b><div class="spoiler_text"><p> ,        ,       .  ,      â€”    .       ,   <code>âŠ¥</code>.  ,       .       ,       ,      :</p><br>
<pre><code class="rust">fn bar&lt;T&gt;(s: String) -&gt; T { 
    panic!(s);
}</code></pre><br>
<p>          â€”       (         ),       .    ,     .        ,     ,      ,   .</p></div></div><br>
<p>        ,           ,    ,   .    <code>foo</code>     1000 ,           ,   .   .      1000    .   <em></em>     .</p><br>
<h2 id="razve-chisto-funkcionalnyy-yazyk-mozhet-sdelat-chto-to-poleznoe">      - ?</h2><br>
<p>      ,       . "",  , "      , HTTP  ,      .      .       ". </p><br>
<p> ,         , <strong></strong>         .   ",      . ,            (      )?   ,    ,         !". </p><br>
<p>  ?      <code>IO</code>,      .    ,   <code>Charge</code>   ,        /.    IO   ,    <code>print "Hello world"</code>     .     <code>main = print "Hello world"</code>       .    ? </p><br>
<p>    ,     <em></em>  IO.       <em> </em>  <code>main</code>.           ,     .      ""  â€”   ,   ,   ,  .          .</p><br>
<p>       ,     <code></code>,       .      <code>main</code>    ,      .</p><br>
<p>  ,        ,   â€”  ,    .       ,    .         "",          .            .</p><br>
<p>,      ,     .    Rust:</p><br>
<pre><code class="rust">fn main() {
    let _ = print!("Hello ");
    println!("world!");
}</code></pre><br>
<p>   "Hello world!".        Haskell:</p><br>
<pre><code class="haskell">main :: IO ()
main = do
  let _ = print "Hello "
  print "world!"</code></pre><br>
<p>   "world!".               .       " <code>Hello</code>",     .           .    <code>main</code>      <code>world!</code>,    .        Rust  <em></em> print!      ,          - .</p><br>
<p>       (   ,    -   )   ,            .     "   "    .  ,       "     (     ),   HTTP (    ,     ),      .        ,                       .</p><br>
<h2 id="zaklyuchenie"></h2><br>
<p> ,       .     ,          ,     .    ,         .   -  ANSI C ,   .    .           ,   Scala  Haskell â€” .      ,    ,      ,       ,    .       ,       .</p><br>
<p>              .     ,        -     .      DI.        "   "/"   "/"...",           . </p><br>
<p>,     ,     ,      .            . ""    ,  ,          .    ,               â€”   .</p></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN479238/">https://habr.com/ru/post/zh-CN479238/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN479226/index.html">Habråˆ†æï¼šç”¨æˆ·ä»Habrè®¢è´­ä»€ä¹ˆä½œä¸ºç¤¼ç‰©</a></li>
<li><a href="../zh-CN479230/index.html">ä½¿ç”¨è‰ç‡çš„æ³¨é‡Šè®°å½•æ‚¨çš„Express API</a></li>
<li><a href="../zh-CN479232/index.html">Spring Bootä¸Šçš„MQ JMSåº”ç”¨ç¨‹åºå¼€å‘</a></li>
<li><a href="../zh-CN479234/index.html">æ¥è‡ªOpenStreetMap 488ä¸–ç•Œçš„æ–°é—»ï¼ˆ11/19/2019-11/25/2019ï¼‰</a></li>
<li><a href="../zh-CN479236/index.html">åŸºç»´ æ„å»ºé€‚ç”¨äºAndroidçš„ç¨‹åºåŒ…</a></li>
<li><a href="../zh-CN479240/index.html">æˆ‘ä»¬ç”Ÿæ´»çš„ä»£ç </a></li>
<li><a href="../zh-CN479242/index.html">æˆ‘ä»¬æ­£åœ¨å®ŒæˆYandexã€‚Stationçš„æ”¶çœ‹å·¥ä½œï¼Œä»¥è§‚çœ‹YouTube</a></li>
<li><a href="../zh-CN479244/index.html">å¸¦ä½å›¾ç´¢å¼•çš„å‰ç¼€æ ‘</a></li>
<li><a href="../zh-CN479246/index.html">ç¨‹åºå‘˜æˆé•¿å’Œä¸“ä¸šå‘å±•çš„11ä¸ªæ–¹å‘</a></li>
<li><a href="../zh-CN479248/index.html">Mitapâ€œ Kubernetesä»˜è¯¸å®è·µï¼â€-æ„å»ºå¯æ‰©å±•ç³»ç»Ÿçš„çœŸå®ç»éªŒ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>