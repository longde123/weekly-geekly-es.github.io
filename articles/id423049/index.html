<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ℹ️ ❌ 🧚🏻 Proses Pembelajaran di Linux 🕴🏿 🧒🏾 🌡️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Pada artikel ini, saya ingin berbicara tentang jalur kehidupan proses dalam keluarga OS Linux. Dalam teori dan contoh, saya akan melihat bagaimana pro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Proses Pembelajaran di Linux</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/423049/"><img src="https://habrastorage.org/webt/w9/tj/yz/w9tjyz5nyynb4zwy2kiikc0ckec.png"><br>  Pada artikel ini, saya ingin berbicara tentang jalur kehidupan proses dalam keluarga OS Linux.  Dalam teori dan contoh, saya akan melihat bagaimana proses dilahirkan dan mati, sedikit pembicaraan tentang mekanisme panggilan dan sinyal sistem. <br><br>  Artikel ini lebih ditujukan untuk pemula dalam pemrograman sistem dan mereka yang hanya ingin belajar lebih banyak tentang bagaimana proses bekerja di Linux. <br><a name="habracut"></a><br>  Semua yang ditulis di bawah ini berlaku untuk Debian Linux dengan kernel 4.15.0. <br><br><h2>  Isi </h2><br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Pendahuluan</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Atribut proses</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Proses siklus hidup</a> <br><ol><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Proses kelahiran</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Status siap</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Statusnya "sedang berjalan"</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Reinkarnasi di program lain</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Status tertunda</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Hentikan status</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Proses selesai</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Keadaan "zombie"</a> </li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Terlupakan</a> </li></ol></li><li>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Ucapan Terima Kasih</a> </li></ol><br><a name="intro"></a><h2>  Pendahuluan </h2><br>  Perangkat lunak sistem berinteraksi dengan inti sistem melalui fungsi khusus - panggilan sistem.  Dalam kasus yang jarang terjadi, ada API alternatif, misalnya, procfs atau sysfs, dibuat dalam bentuk sistem file virtual. <br><br><a name="definition"></a><h2>  Atribut proses </h2><br>  Proses dalam kernel disajikan hanya sebagai struktur dengan banyak bidang (definisi struktur dapat dibaca di <a href="" rel="nofollow">sini</a> ). <br>  Tetapi karena artikel ini ditujukan untuk pemrograman sistem, dan bukan pengembangan kernel, kami agak abstrak dan hanya fokus pada bidang-bidang penting dari proses bagi kami: <br><br><ul><li>  Id proses (pid) </li><li>  Buka Penjelas File (fd) </li><li>  Penangan Sinyal </li><li>  Direktori kerja saat ini (cwd) </li><li>  Variabel Lingkungan (environment) </li><li>  Kembali kode </li></ul><br><a name="lifecycle"></a><h2>  Proses siklus hidup </h2><br><img src="https://habrastorage.org/webt/dw/ru/5n/dwru5nbeoag7imroc_ki1qa9gba.png"><br><br><a name="fork"></a><h3>  Proses kelahiran </h3><br>  Hanya satu proses dalam sistem yang dilahirkan dengan cara khusus - <code>init</code> - proses ini dihasilkan langsung oleh kernel.  Semua proses lain muncul dengan menduplikasi proses saat ini menggunakan <code>fork(2)</code> system call.  Setelah <code>fork(2)</code> dieksekusi, kita mendapatkan dua proses yang hampir identik, dengan pengecualian poin-poin berikut: <br><br><ol><li>  <code>fork(2)</code> mengembalikan PID anak ke orangtua, 0 dikembalikan ke anak; </li><li>  Anak mengubah PPID (Induk Proses Id) ke PID induk. </li></ol><br>  Setelah <code>fork(2)</code> dieksekusi, semua sumber daya dari proses anak adalah salinan dari sumber daya orang tua.  Menyalin suatu proses dengan semua halaman memori yang dialokasikan mahal, sehingga kernel Linux menggunakan teknologi Copy-On-Write. <br>  Semua halaman dalam memori induk ditandai sebagai hanya-baca dan tersedia untuk orang tua dan anak.  Segera setelah salah satu proses mengubah data pada halaman tertentu, halaman ini tidak berubah, tetapi salinannya sudah disalin dan diubah.  Dalam hal ini, dokumen asli "tidak diikat" dari proses ini.  Segera setelah dokumen asli hanya baca tetap "terikat" pada satu proses tunggal, halaman tersebut dialihkan ke status baca-tulis. <br><br><div class="spoiler">  <b class="spoiler_title">Contoh program sederhana yang tidak berguna dengan fork (2)</b> <div class="spoiler_text"><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;unistd.h&gt; #include &lt;errno.h&gt; #include &lt;sys/wait.h&gt; #include &lt;sys/types.h&gt; int main() { int pid = fork(); switch(pid) { case -1: perror("fork"); return -1; case 0: // Child printf("my pid = %i, returned pid = %i\n", getpid(), pid); break; default: // Parent printf("my pid = %i, returned pid = %i\n", getpid(), pid); break; } return 0; }</span></span></span></span></code> </pre><br><br><pre> <code class="bash hljs">$ gcc test.c &amp;&amp; ./a.out my pid = 15594, returned pid = 15595 my pid = 15595, returned pid = 0</code> </pre><br></div></div><br><a name="ready"></a><h3>  Status siap </h3><br>  Segera setelah eksekusi, <code>fork(2)</code> memasuki status siap. <br>  Bahkan, proses mengantri dan menunggu scheduler di kernel untuk membiarkan proses berjalan pada prosesor. <br><br><a name="running"></a><h3>  Statusnya "sedang berjalan" </h3><br>  Segera setelah penjadwal melakukan proses eksekusi, status "running" dimulai.  Proses ini dapat menjalankan seluruh periode yang diusulkan (kuantum) waktu, atau dapat memberikan jalan kepada proses lain menggunakan ekspor sistem <code>sched_yield</code> . <br><br><a name="exec"></a><h3>  Reinkarnasi di program lain </h3><br>  Beberapa program menerapkan logika di mana proses induk menciptakan anak untuk memecahkan masalah.  Anak dalam hal ini menyelesaikan masalah tertentu, dan orang tua hanya mendelegasikan tugas kepada anak-anaknya.  Misalnya, server web dengan koneksi masuk membuat anak dan melewati pemrosesan koneksi ke sana. <br>  Namun, jika Anda perlu menjalankan program lain, Anda harus menggunakan system call <code>execve(2)</code> : <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execve</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *filename, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argv[], </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> envp[])</span></span></span></span>;</code> </pre><br>  atau pustaka panggilan <code>execl(3), execlp(3), execle(3), execv(3), execvp(3), execvpe(3)</code> : <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *path, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *arg, ... </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* (char *) NULL */</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execlp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *file, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *arg, ... </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/* (char *) NULL */</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *path, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *arg, ... </span></span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-params"><span class="hljs-comment">/*, (char *) NULL, char * const envp[] */</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execv</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *path, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argv[])</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execvp</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *file, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argv[])</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execvpe</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *file, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> argv[], </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> *</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">const</span></span></span></span><span class="hljs-function"><span class="hljs-params"> envp[])</span></span></span></span>;</code> </pre><br>  Semua panggilan di atas menjalankan program, jalur yang ditunjukkan dalam argumen pertama.  Jika berhasil, kontrol ditransfer ke program yang dimuat dan tidak dikembalikan ke yang asli.  Dalam hal ini, program yang dimuat memiliki semua bidang struktur proses, kecuali untuk deskriptor file yang ditandai sebagai <code>O_CLOEXEC</code> , mereka akan ditutup. <br><br>  Bagaimana tidak bingung dalam semua tantangan ini dan memilih yang benar?  Cukup memahami logika penamaan: <br><br><ul><li>  Semua panggilan dimulai dengan <code>exec</code> </li><li>  Huruf kelima mendefinisikan jenis argumen yang lewat: <br><ul><li>  <b>l</b> singkatan <b>daftar</b> , semua parameter dilewatkan sebagai <code>arg1, arg2, ..., NULL</code> </li><li>  <b>v</b> singkatan <b>vektor</b> , semua parameter dilewatkan dalam array null-dihentikan; </li></ul></li><li>  Huruf <b>p</b> , yang merupakan singkatan dari <b>path</b> , dapat mengikuti.  Jika argumen <code>file</code> dimulai dengan karakter selain "/", maka <code>file</code> ditentukan dicari di direktori yang tercantum dalam variabel lingkungan PATH </li><li>  Yang terakhir mungkin huruf <b>e</b> , menunjukkan <b>lingkungan</b> .  Dalam panggilan tersebut, argumen terakhir adalah array null-dihentikan string null-dihentikan dari <code>key=value</code> form <code>key=value</code> - variabel lingkungan yang akan diteruskan ke program baru. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Contoh panggilan ke / bin / cat --help via execve</b> <div class="spoiler_text"><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _GNU_SOURCE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;unistd.h&gt; int main() { char* args[] = { "/bin/cat", "--help", NULL }; execve("/bin/cat", args, environ); // Unreachable return 1; }</span></span></span></span></code> </pre><br><br><pre> <code class="bash hljs">$ gcc test.c &amp;&amp; ./a.out Usage: /bin/cat [OPTION]... [FILE]... Concatenate FILE(s) to standard output. * *</code> </pre><br></div></div><br>  Keluarga panggilan <code>exec*</code> memungkinkan Anda untuk menjalankan skrip dengan hak eksekusi dan mulai dengan urutan shebang (#!). <br><br><div class="spoiler">  <b class="spoiler_title">Contoh menjalankan skrip dengan PATH palsu menggunakan execle</b> <div class="spoiler_text"><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _GNU_SOURCE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;unistd.h&gt; int main() { char* e[] = {"PATH=/habr:/rulez", NULL}; execle("/tmp/test.sh", "test.sh", NULL, e); // Unreachable return 1; }</span></span></span></span></code> </pre><br><br><pre> <code class="bash hljs">$ cat test.sh <span class="hljs-comment"><span class="hljs-comment">#!/bin/bash echo $0 echo $PATH $ gcc test.c &amp;&amp; ./a.out /tmp/test.sh /habr:/rulez</span></span></code> </pre><br></div></div><br>  Ada konvensi yang menyiratkan bahwa argv [0] cocok dengan argumen nol untuk fungsi dalam keluarga exec *.  Namun, ini bisa dilanggar. <br><br><div class="spoiler">  <b class="spoiler_title">Contoh ketika kucing menjadi anjing menggunakan execlp</b> <div class="spoiler_text"><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> _GNU_SOURCE #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;unistd.h&gt; int main() { execlp("cat", "dog", "--help", NULL); // Unreachable return 1; }</span></span></span></span></code> </pre><br><br><pre> <code class="bash hljs">$ gcc test.c &amp;&amp; ./a.out Usage: dog [OPTION]... [FILE]... * *</code> </pre><br></div></div><br>  Pembaca yang penasaran mungkin memperhatikan bahwa ada nomor di tanda tangan dari fungsi <code>int main(int argc, char* argv[])</code> - jumlah argumen, tetapi tidak ada yang semacam itu diteruskan ke keluarga fungsi <code>exec*</code> .  Mengapa  Karena ketika program dimulai, kontrol tidak segera ditransfer ke utama.  Sebelum ini, beberapa tindakan yang didefinisikan oleh glibc dilakukan, termasuk menghitung argc. <br><br><a name="waiting"></a><h3>  Status tertunda </h3><br>  Beberapa panggilan sistem dapat berlangsung lama, seperti I / O.  Dalam kasus seperti itu, proses masuk ke status "pending".  Segera setelah panggilan sistem selesai, kernel akan menempatkan proses dalam status "siap". <br>  Di Linux, ada juga keadaan "menunggu" di mana proses tidak merespons sinyal interupsi.  Dalam keadaan ini, proses menjadi "tidak dapat dihancurkan", dan semua sinyal masuk berbaris sampai proses meninggalkan keadaan ini. <br>  Kernel itu sendiri memilih negara mana untuk mentransfer proses.  Paling sering, proses yang meminta I / O berada dalam status "menunggu (tanpa gangguan)".  Ini terutama terlihat ketika menggunakan disk jarak jauh (NFS) dengan Internet yang tidak terlalu cepat. <br><br><a name="stopped"></a><h3>  Hentikan status </h3><br>  Anda dapat menjeda proses kapan saja dengan mengirimkannya sinyal SIGSTOP.  Proses akan masuk ke status "berhenti" dan akan tetap di sana sampai menerima sinyal untuk terus bekerja (SIGCONT) atau mati (SIGKILL).  Sinyal yang tersisa akan diantrekan. <br><br><a name="exit"></a><h3>  Proses selesai </h3><br>  Tidak ada program yang dapat mematikan dirinya sendiri.  Mereka hanya dapat meminta sistem untuk ini dengan panggilan sistem <code>_exit</code> atau dihentikan oleh sistem karena kesalahan.  Bahkan ketika Anda mengembalikan nomor dari <code>main()</code> , <code>_exit</code> masih dipanggil secara implisit. <br>  Meskipun argumen untuk panggilan sistem adalah int, hanya byte rendah dari nomor tersebut yang diambil sebagai kode pengembalian. <br><br><a name="zombie"></a><h3>  Keadaan "zombie" </h3><br>  Segera setelah proses selesai (tidak peduli apakah itu benar atau tidak), kernel menulis informasi tentang bagaimana proses berakhir dan menempatkannya dalam keadaan "zombie".  Dengan kata lain, zombie adalah proses yang selesai, tetapi memori itu masih tersimpan di kernel. <br>  Selain itu, ini adalah kondisi kedua di mana proses dapat dengan aman mengabaikan sinyal SIGKILL, karena tidak dapat mati mati lagi. <br><br><a name="wait"></a><h3>  Terlupakan </h3><br>  Kode pengembalian dan alasan untuk penyelesaian proses masih disimpan dalam kernel dan harus diambil dari sana.  Untuk melakukan ini, Anda dapat menggunakan panggilan sistem yang sesuai: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">pid_t</span></span> wait(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> *wstatus); <span class="hljs-comment"><span class="hljs-comment">/*  waitpid(-1, wstatus, 0) */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">pid_t</span></span> waitpid(<span class="hljs-keyword"><span class="hljs-keyword">pid_t</span></span> pid, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> *wstatus, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> options);</code> </pre><br>  Semua informasi tentang penghentian proses cocok dengan tipe data int.  Makro yang dijelaskan dalam halaman manual <code>waitpid(2)</code> digunakan untuk mendapatkan kode pengembalian dan alasan penghentian program. <br><br><div class="spoiler">  <b class="spoiler_title">Contoh penyelesaian yang benar dan penerimaan kode pengembalian</b> <div class="spoiler_text"><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;unistd.h&gt; #include &lt;errno.h&gt; #include &lt;sys/wait.h&gt; #include &lt;sys/types.h&gt; int main() { int pid = fork(); switch(pid) { case -1: perror("fork"); return -1; case 0: // Child return 13; default: { // Parent int status; waitpid(pid, &amp;status, 0); printf("exit normally? %s\n", (WIFEXITED(status) ? "true" : "false")); printf("child exitcode = %i\n", WEXITSTATUS(status)); break; } } return 0; }</span></span></span></span></code> </pre><br><br><pre> <code class="bash hljs">$ gcc test.c &amp;&amp; ./a.out <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> normally? <span class="hljs-literal"><span class="hljs-literal">true</span></span> child exitcode = 13</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Contoh penyelesaian salah</b> <div class="spoiler_text"><br>  Melewati argv [0] sebagai NULL menyebabkan crash. <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;stdio.h&gt; #include &lt;unistd.h&gt; #include &lt;errno.h&gt; #include &lt;sys/wait.h&gt; #include &lt;sys/types.h&gt; int main() { int pid = fork(); switch(pid) { case -1: perror("fork"); return -1; case 0: // Child execl("/bin/cat", NULL); return 13; default: { // Parent int status; waitpid(pid, &amp;status, 0); if(WIFEXITED(status)) { printf("Exit normally with code %i\n", WEXITSTATUS(status)); } if(WIFSIGNALED(status)) { printf("killed with signal %i\n", WTERMSIG(status)); } break; } } return 0; }</span></span></span></span></code> </pre><br><br><pre> <code class="bash hljs">$ gcc test.c &amp;&amp; ./a.out killed with signal 6</code> </pre><br></div></div><br>  Ada kalanya orang tua berakhir lebih awal dari anak.  Dalam kasus seperti itu, <code>init</code> akan menjadi orangtua anak dan ia akan menggunakan panggilan <code>wait(2)</code> ketika saatnya tiba. <br><br>  Setelah orangtua mengambil informasi tentang kematian anak itu, kernel menghapus semua informasi tentang anak tersebut sehingga proses lain akan segera terjadi. <br><br><a name="thanks"></a><h2>  Ucapan Terima Kasih </h2><br>  Terima kasih kepada Sasha "Al" untuk pengeditan dan bantuan dalam desain; <br><br>  Terima kasih kepada Sasha "Reisse" untuk jawaban yang jelas untuk pertanyaan-pertanyaan sulit. <br><br>  Mereka menerima ilham yang menyerang saya dan rentetan pertanyaan saya yang menyerang saya. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id423049/">https://habr.com/ru/post/id423049/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id423039/index.html">Kami melakukan otentikasi web melalui blockchain</a></li>
<li><a href="../id423041/index.html">CD-ROM Super NES Cerita Aneh</a></li>
<li><a href="../id423043/index.html">Karena kerentanan dalam sistem perlindungan kendaraan listrik Tesla, sebuah mobil dapat dicuri dalam beberapa detik</a></li>
<li><a href="../id423045/index.html">Printer 3D mana yang harus dipilih? Ulasan Video 3Dtool</a></li>
<li><a href="../id423047/index.html">Kami memesan sistem TI untuk uang yang masuk akal</a></li>
<li><a href="../id423051/index.html">Perjuangan untuk Sumber Daya, Bagian 1: Dasar-Dasar Kelompok</a></li>
<li><a href="../id423053/index.html">Struct and readonly: bagaimana cara menghindari penurunan kinerja</a></li>
<li><a href="../id423055/index.html">Analis Wall Street: "Apple membuat kami makan topi kami"</a></li>
<li><a href="../id423057/index.html">Python juga menolak sebagian istilah master / slave</a></li>
<li><a href="../id423061/index.html">ref penduduk setempat dan pengembalian ref dalam C #: jebakan kinerja</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>