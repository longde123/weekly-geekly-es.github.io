<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🍻 🕎 👨🏻‍🏭 كيف اكتشفت فيروسًا يحاول بيع الأحذية 🏂🏼 🍡 ⚠️</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="أنا واحد من هؤلاء الأشخاص الذين يحاولون ، مع بداية فصل الخريف ، قضاء وقت أقل في الشارع. في موسكو ، هذا ليس صعبًا: أنت مقيد بالطريق من المنزل إلى المكت...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>كيف اكتشفت فيروسًا يحاول بيع الأحذية</h1><div class="post__body post__body_full" style=";text-align:right;direction:rtl"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/jetinfosystems/blog/430074/" style=";text-align:right;direction:rtl"><img src="https://habrastorage.org/webt/wf/yz/a_/wfyza_3hf3mtbnqlffsve6xijoo.png"><br><br>  أنا واحد من هؤلاء الأشخاص الذين يحاولون ، مع بداية فصل الخريف ، قضاء وقت أقل في الشارع.  في موسكو ، هذا ليس صعبًا: أنت مقيد بالطريق من المنزل إلى المكتب والعودة.  ومع ذلك ، يمكن أن يتسبب الطقس الرطب في عدم الراحة في الغرفة ، خاصة إذا كان مكان عملك ، مثل لي ، في النافذة ، ويطلب كل زميل آخر ، يشكو من الازدحام ، تهوية المكتب.  لكي لا تقع في الطحال ، قمت في هذا الخريف بتحديث خزانة الملابس. <br><br>  التفكير في مصير الأشياء غير الضرورية ، تساءلت ماذا أفعل بها: رميها ، قطعها إلى الخرق ، وإعطائها لأخي الأصغر لحملها؟  ولكن لسبب واحد ، لم تكن أي من هذه الطرق مناسبة: كانت أحذية جلدية 44 بحجم لائق ، لكنهم أزعجوني بالترتيب.  قررت بيعها على Avito.  لقد قمت بتحميل الصور ، وأشرت إلى اسم زائف (أمن المعلومات هو نفسه) ، ووضعت حذائي ، وبعض الأشياء الأخرى ، ونمت.  كيف أعرف أن هذا سيؤدي إلى تحليل طويل للتطبيق للتهديدات الخفية؟ <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/2m/re/zj/2mrezjviqrbnbh6xwbn__ps6j4u.png"><br><br><h2 style=";text-align:right;direction:rtl">  مفاجأة سارة </h2><br>  في اليوم التالي بعد مكالمتين مشكوك فيهما ، تلقيت رسالة SMS مثيرة للاهتمام تحتوي على المحتويات التالية: <br><br><img src="https://habrastorage.org/webt/je/mo/fs/jemofsiwbf3qmf5fsslki95roz8.jpeg"><br><br>  بعد يومين ، تلقيت رسالة أخرى مماثلة: <br><br><img src="https://habrastorage.org/webt/ru/k3/ap/ruk3apc1cjlrzjdqinme0ucnmgc.jpeg"><br><br>  فوجئت بأن شخصًا ما كان قادرًا بطريقة ما على تحويل الأموال لي على الإنترنت (على ما يبدو ، أنا الوحيد القديم - ما زلت أستخدم كتب التوفير الورقية) ، نقرت على الرابط في الرسائل القصيرة. <br><br>  بعد ذلك ، عرض علي تنزيل تطبيق Android (ملف apk).  لحسن الحظ تنزيل الملف ، رأيت ما يلي: <br><br><img src="https://habrastorage.org/webt/ab/c7/kd/abc7kd6qq9puqe7y7mc4f_vmaks.png"><br><br>  إنها ذات مصداقية!  أردت بتلهف تثبيت كل شيء بسرعة وإنهائه. <br>  ولكن هنا ، كالعادة ، لم يسمح لي نظام التشغيل Android المزعج لسبب ما بتشغيل الملف.  "أعطني المال بالفعل!"  كنت ساخط.  اضطررت للذهاب إلى الإعدادات وتشغيل بعض الخيار "مصادر غير معروفة" ، هل الهاتف غبي حقًا في 2018؟  بالمناسبة ، هاتفي هو Xiaomi Remdi مع Andoid 6.0.1 (ملاحظة للتكنولوجيا). <br><br><img src="https://habrastorage.org/webt/hp/jf/0z/hpjf0z2umptn_vvgxee1qiosvw8.png"><img src="https://habrastorage.org/webt/y2/-8/8o/y2-88olz-wcbay7wpanhxlwf3fw.png"><br><br>  تبع ذلك سلسلة من الأحداث الغريبة.  استمر الهاتف في الإبلاغ عن مصادر غير موثوقة.  لكن أفيتو <b>مصدر موثوق</b> !  اضطررت إلى البحث في Google ، ومعرفة كيفية الالتفاف حول هذا ، ثم إيقاف تشغيله في الإعدادات.  سرعان ما ظهر مضاد فيروسات معين لم أقم بتثبيته. <br><br><img src="https://habrastorage.org/webt/nl/ur/6c/nlur6cxmseun_mdsyj-uzqvls8a.png" width="170"><img src="https://habrastorage.org/webt/u7/qg/gg/u7qgggolf8mjgrf29o7ldijdpty.png" width="170"><img src="https://habrastorage.org/webt/52/le/x9/52lex9ukzmeujeoxah1bbraecsi.png" width="170"><img src="https://habrastorage.org/webt/b9/st/2g/b9st2gunjymlfnui5hogoyxp074.png" width="170"><br><br>  أخيرًا ، رأيت نافذة التثبيت القياسية المرغوبة - <i>ليس من المنطقي أن ننظر إلى الأذونات في الوقت الحاضر</i> ، والآن لن يبدأ تشغيل الكمبيوتر الدفتري حتى تمنحها حق الوصول الكامل إلى الهاتف.  لحظة سعيدة لإكمال تثبيت التطبيق وبدء!  كنت أتطلع إلى الأموال الموعودة.  بالإضافة إلى ذلك ، طلب التطبيق امتيازات المسؤول ، والتي وافقت عليها بسرور.  لسوء الحظ ، تصرف التطبيق بشكل غريب ولم يرغب في الدفع ، وسرعان ما اختفى تمامًا من قائمة التطبيقات على الشاشة المشتركة. <br><br><img src="https://habrastorage.org/webt/2l/og/wo/2logwomobffteufrjrghz6mtnme.png" width="170"><img src="https://habrastorage.org/webt/cl/qp/nl/clqpnlxzkas8ij9z1zx1beteckq.png" width="170"><br><br><img src="https://habrastorage.org/webt/3n/qw/r_/3nqwr_xdxrtrnsbdnwypzu02obo.png" width="170"><img src="https://habrastorage.org/webt/cu/oy/tk/cuoytkopc5plrkilwany_tizlpy.png" width="170"><img src="https://habrastorage.org/webt/jp/y6/b2/jpy6b2sosh_zxdtn5bbwohhnkug.png" width="170"><br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">المفسد</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  في وقت لاحق ، تحققت من هاتف آخر - Lenovo مع Android 4.4.2 على متن الطائرة.  تبين أن قائمة الأذونات أثناء التثبيت أكبر بكثير.  ولا تتدخل حماية Play و Anti-Virus ، فأنت تحتاج فقط للسماح بالتثبيت من مصادر غير موثوقة. <br><br><img src="https://habrastorage.org/webt/j_/9i/w1/j_9iw1jlp7dtyroivluxzlhftne.png" width="170"><img src="https://habrastorage.org/webt/ku/ay/h1/kuayh1icnuip2mwccqzdsrghvci.png" width="170"><br><br><img src="https://habrastorage.org/webt/lf/lc/v8/lflcv85sqajn4ju5-7qimh14rgu.png" width="170"><img src="https://habrastorage.org/webt/pk/2w/ps/pk2wpsjo3csovecieetanlqouki.png" width="170"><img src="https://habrastorage.org/webt/nu/ka/8a/nuka8a6nsp79yjtdibadpld5huw.png" width="170"><br></div></div><br><h2 style=";text-align:right;direction:rtl">  الإيثار </h2><br><br>  إذن ، ما الذي وصلنا إليه: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  استغرق التثبيت 20 دقيقة. </li><li style=";text-align:right;direction:rtl">  لم أستلم المال. </li></ul><br>  اعتقدت أن المشكلة كانت خطأ في الكود ، كما هو الحال غالبًا مع المبرمجين.  قررت تحديد الأخطاء التي تحدث عند تشغيل التطبيق على هاتفي ، وإرسال تقرير عنها إلى المطور. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">المفسد</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  الآن لم يبق سوى عدد قليل من الأشخاص المهتمين ، أحدهم هو أنا. <br></div></div><br>  من الواضح أن هذا النوع من التطبيقات يجب أن يعمل عند اتصال الإنترنت ، لذلك حاولت في البداية تحليل حركة المرور بين الهاتف وخادم التطبيق. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">الدليل الفني لتكوين الوكيل</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  يمكنك الاستماع إلى حركة مرور الإنترنت في أي وقت على طول المسار من الهاتف إلى الخادم ، سواء كان جهاز توجيه منزلي أو مزود إنترنت محلي أو العمود الفقري للإنترنت أو خادم التطبيق. <br><br>  المشاكل: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  الوصول إلى هذا الجهاز مطلوب. </li><li style=";text-align:right;direction:rtl">  مطلوب لفصل حركة مرور التطبيق المطلوب عن الباقي. </li><li style=";text-align:right;direction:rtl">  في حالة التشفير (وفي عام 2018 تم تشفير كل شيء بالفعل) - من الضروري معرفة المفتاح. </li></ul><br>  قررت أن أذهب بطريقة أكثر كلاسيكية وتهيئة الوكلاء على الهاتف باستخدام خادم وكيل على جهاز الكمبيوتر المحمول الخاص بي.  للتخفيف من مشكلة التشفير ، قررت استيراد شهادتي ، ولم أقم بتشغيل تطبيقات أخرى لفصل حركة مرور التطبيق. <br>  اخترت <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مجموعة التجشؤ</a> كبرنامج الخادم الوكيل.  لقد قمت بإعداد خادم وكيل وتصدير شهادة إلى هاتفي. <br><br><img src="https://habrastorage.org/webt/h6/fl/tn/h6fltnqujuaa37og8s77oejovh8.png" width="520"><br><br><img src="https://habrastorage.org/webt/xy/xz/6k/xyxz6knuzcxtjobyss5-cpvpyrg.png" width="170"><img src="https://habrastorage.org/webt/-a/4e/vd/-a4evdiy2zz3pspeaai7idntxzk.png" width="170"><img src="https://habrastorage.org/webt/ol/52/82/ol528281ja24jszgftyz_hhpyes.png" width="170"><br></div></div><br>  بعد إعداد برنامج متخصص ، تمكنت من رؤية الطلبات التي يرسلها التطبيق إلى الخادم: <br><br> <a href=""><img src="https://habrastorage.org/webt/ar/0v/fu/ar0vfughbbfcewogzbpklk6egh0.png"></a> <br><br>  كما ترى ، لم يتم إرسال البيانات (يشار إلى قيمة المضيف غير المعروفة في عمود IP) ، علاوة على ذلك ، لا يمكن تحليلها بسبب وجود تشفير إضافي على مستوى التطبيق.  إذا حكمنا بالخطأ ، لم يتمكن الهاتف من تحديد عنوان IP الخاص بالخادم ونطاقاته الفرعية <b>https: //*.sky-sync.pw</b> حسب اسم المجال الخاص به. <br><br>  قد يعني هذا فقط الخيارات التالية: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>لقد توقف اسم المجال من الوجود</b> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  تم حظره من قبل المالك نفسه. </li><li style=";text-align:right;direction:rtl">  وقد منعه المسجل بسبب الشكوى. </li></ul></li><li style=";text-align:right;direction:rtl">  <b>مشكلة في خادم DNS</b> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  لا يعرف خادم DNS العنوان ، لأن المطور في الإنتاج طرح عنوان DNS المحلي. </li><li style=";text-align:right;direction:rtl">  حظر خادم DNS هذا الطلب على وجه التحديد ، وهذا ليس مفاجئًا في عصر الرقابة على الإنترنت. </li></ul></li></ul><br>  للتحقق من افتراض وجود مشكلة في خادم DNS ، حاولت تقديم طلبات من خوادم DNS كبيرة مختلفة: Google و Yandex و OpenDNS (عادة ما يتم حظر DNS المحلي): <br><br><img src="https://habrastorage.org/webt/8n/-q/me/8n-qmebbunqccfns6anpcdghsg8.png"><br><br>  يمكن ملاحظة أنه لا أحد منهم يعرف أي شيء عن هذا الاسم.  بعد ذلك ، ألقيت نظرة على معلومات whois حول تسجيل النطاق: <br><br><img src="https://habrastorage.org/webt/dd/hw/ms/ddhwmsu4lilowe1twixzng6klqs.png"><br><br>  فضولي: تم تسجيل النطاق ، أي أنه على الأرجح ليس محليًا ، ولكن نظرًا لعدم حل النطاق ، فربما تم حظره من قِبل المسجل بسبب إساءة الاستخدام.  لكن لماذا؟  ما الخطأ الذي فعله؟ <br><br>  لمعرفة ما هو هذا التطبيق تمامًا وكيف يمكنني أخذ أموالي ، قررت استخدام <s>سحر</s> الهندسة العكسية. <br><br><h2 style=";text-align:right;direction:rtl">  الهاوية </h2><br>  إذا كنت إنسانيًا وقرأت في هذا المكان ، فهذا أمر جيد - لتنمية اللاحقة أنت تستحق جائزة <s>بعد وفاتها</s> . <br><br><h3 style=";text-align:right;direction:rtl">  <i>مجموعة أدوات</i> </h3><br>  لمعرفة ما "تحت غطاء" التطبيق ، نحتاج إلى تنزيل أدوات متخصصة.  يمكنك تنزيلها بشكل فردي: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  <b>فك حزمة APK</b> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  كلاسيك - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">ApkTool</a> . </li><li style=";text-align:right;direction:rtl">  يمكنك فك ضغطه باستخدام أرشيفي تقليدي ، ولكن بعد ذلك ستكون جميع الموارد الثنائية ، بما في ذلك التطبيقات وملف البيان ، غير قابلة للقراءة. </li></ul></li><li style=";text-align:right;direction:rtl">  <b>فك شفرة Smali</b> <br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  المعيار هو <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Dex2Jar</a> ، ولكن تعلم أن هذا البرنامج يعمل في كثير من الأحيان بشكل منحرف. </li><li style=";text-align:right;direction:rtl">  تحتاج إلى التعامل مع الأمر بعناية شديدة ، لأن المترجم إلى المترجم مختلف ، سننظر في ذلك لاحقًا. </li></ul></li><li style=";text-align:right;direction:rtl">  <b>برنامج لعرض التعليمات البرمجية المترجمة</b> ، أوصي بـ <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">jd-gui</a> </li></ul><br>  أو يمكنك استخدام المنتج ، المدفوع عادة ، حيث يوجد كل شيء في وقت واحد.  أنا أفضل <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">JebDecompiler</a> : يمكنه فقط تقديم تطبيق apk <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">لمدخلاته</a> ، وسوف يرتب كل شيء في علامات التبويب ، بالإضافة إلى أنه مناسب للتبديل بين كود Java smali و decompiled. <br><br>  بشكل منفصل ، أود أن أشير إلى: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  إذا كان هناك libs أصلية (المجلد / libs في بنية التطبيق) ، فستكون هناك حاجة إلى أداة <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تفكيك</a> . </li><li style=";text-align:right;direction:rtl">  قد تحتاج إلى <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">مجموعة من الأدوات المساعدة</a> للعمل مع رمز smali (dex-to-smali ، smali-to-dex). </li><li style=";text-align:right;direction:rtl">  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تسليط الضوء على بناء الجملة</a> في Notepad ++ حتى لا يكسر العيون. </li></ul><br><h3 style=";text-align:right;direction:rtl">  <i>فقط كبار السن يخوضون المعركة</i> </h3><br><h4 style=";text-align:right;direction:rtl">  مراجعة </h4><br>  عند فتح الشفرة المترجمة ، يتضح على الفور أنها مشوشة. <br><br><img src="https://habrastorage.org/webt/jg/m4/ah/jgm4ahs5rxpts6cfz_lmq9ycp5m.png"><br><br>  كيف أفهم ذلك؟ <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> أسماء الفئات التي يمكن قراءتها بواسطة الإنسان <br> <code>isqpwcmx.isfdztgb.adscjobz.nxscomkr.jypbdxnt.utagwpym.wprtdznb.swldgrhm.yrbjpktq.wukovicq;</code> </li> <li style=";text-align:right;direction:rtl">  رمز لا يمكن الوصول إليه <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span> != <span class="hljs-number"><span class="hljs-number">0</span></span>) {&lt;/li&gt; String v1 = <span class="hljs-string"><span class="hljs-string">"flnwznvh"</span></span>;&lt;/li&gt; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v1.length() != <span class="hljs-number"><span class="hljs-number">661</span></span> &amp;&amp; v1.charAt(<span class="hljs-number"><span class="hljs-number">0</span></span>) == <span class="hljs-number"><span class="hljs-number">104</span></span>) {&lt;/li&gt; v1.length();&lt;/li&gt; }</code> </pre> </li><li style=";text-align:right;direction:rtl">  تشفير السلسلة <br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">vcgrnfjx.execSQL(nvhdzjfo.xipswfqb(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"f741f04a4991fc2f0a0029f610bbd1c250dfe115fb7770b892f75d8718b822d273251013991b4407e224fa3f9d4e92f6"</span></span>,<span class="hljs-string"><span class="hljs-string">"378f40211b6e32a5406cd97e85bcf9ad"</span></span>,<span class="hljs-string"><span class="hljs-string">"6378a459b1c20edf"</span></span>, <span class="hljs-string"><span class="hljs-string">"gexnfwok"</span></span>, <span class="hljs-string"><span class="hljs-string">"meazfhdp"</span></span>, <span class="hljs-string"><span class="hljs-string">"bsmotaxn"</span></span>})</code> </pre> </li></ul><br>  من غير المحتمل أن يكون المبرمج مجنونًا لدرجة أنه طور الشفرة في البداية.  على الأرجح ، استخدم أحد الغامض المتاح للجمهور.  هذه الخطوة شائعة جدًا لتعقيد تحليل الشفرة من أجل حماية الملكية الفكرية ، على سبيل المثال ، ولكن أي نوع من "الالتواء" بالنسبة للباحث. <br><br>  دعونا ننتبه إلى وظيفة التشفير الرئيسية: <br><br><img src="https://habrastorage.org/webt/ok/y9/dz/oky9dzmhwwrdykheiepdiuzzlao.png"><br><br>  تقبل وظيفة التشفير نفسها 3 أسطر من المدخلات (إذا كان الأمر أكثر ، فإن الباقي لا معنى له): <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  نص مشفر </li><li style=";text-align:right;direction:rtl">  المفتاح </li><li style=";text-align:right;direction:rtl">  ناقل التهيئة لـ CBC - AES </li></ol><br>  تتم الإشارة إلى هذه الوظيفة في البرنامج 213 مرة على الأقل: <br><br><img src="https://habrastorage.org/webt/ok/y9/dz/oky9dzmhwwrdykheiepdiuzzlao.png"><br><br>  ألاحظ أنه مفتاح مهم لتحليل الكود العادي.  بعد ذلك ، <s><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">تحتاج إلى التفكير في أن</a></s> لدينا الطرق التالية لتحليل البرنامج: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  قم باستعادة منطق الوظيفة ، وجمع كل المكالمات في التحليل الثابت ، وفك تشفير الخطوط.  قد يكون الأمر صعبًا وطويلًا ، ولكنه سيعطي نتيجة 100 ٪. </li><li style=";text-align:right;direction:rtl">  قم بإجراء تغييرات على رمز smali للتطبيق ، وقم بالترجمة مرة أخرى ، وقم بتشغيل التطبيق والتقاط الأسطر التي تم فك تشفيرها في السجلات.  من السهل القيام بذلك ، ولكن الطريقة التي سيتصرف بها التطبيق في عملية تشغيل معينة غير معروفة ، وقد لا ترى الصورة كاملة (لا تحصل على مكالمات لجميع الوظائف).  بالإضافة إلى ذلك ، قد تكون هناك مشاكل في الفحص الذاتي من خلال تطبيق الشهادة و (أو) التكامل. </li><li style=";text-align:right;direction:rtl">  إذا كان من الصعب استعادة منطق الوظيفة ، فيمكنك حينئذٍ جمع كل استدعاءات الوظائف وسحب هذه الوظائف نفسها مع المعلمات الضرورية مباشرة في الديناميكيات (باستخدام ، على سبيل المثال ، برنامج <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u=">Frida</a> . </li></ol><br>  سنختار الطريقة رقم 1 باعتبارها الأكثر موثوقية. <br><br><h2 style=";text-align:right;direction:rtl">  التجفيف </h2><br>  قم بالحجز على الفور ، غالبًا ما تكون إزالة التعتيم عملية طويلة ومملة ، لذلك تحتاج إلى تقييم الإطار الزمني الخاص بك بشكل صحيح.  بالنسبة لتحليلنا ، يكفي فك تشفير جميع الخطوط بطريقة ما على الأقل والقيام بذلك في الحد الأدنى من الوقت ، حتى بطريقة عكسية ، من العبث لمدة شهر من أجل خيار مثالي غامض. <br><br>  يكون إلغاء التعتيم النوعي منطقيًا في حالة الهندسة العكسية الكاملة ، على سبيل المثال ، يتعين على لصوص الملكية الفكرية القيام بذلك عندما يحاولون نسخ حل منافس ، أو إذا كان عليك غالبًا تحليل البرامج التي تتم معالجتها بواسطة مظلل واحد ، ولكن هذه ليست قضيتنا. <br><br>  شفرة المصدر بعد JEB Decompiler v.1.4 decompiler <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">المفسد</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">podxiwkt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v6; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v4; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v2; Cipher v1; String v10 = args[<span class="hljs-number"><span class="hljs-number">0</span></span>]; String v7 = args[<span class="hljs-number"><span class="hljs-number">1</span></span>]; String v0 = args[<span class="hljs-number"><span class="hljs-number">2</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { goto label_9; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10.length() != <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_11; } goto label_9; label_11: IvParameterSpec v5 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> IvParameterSpec(v0.getBytes()); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { v1 = Cipher.getInstance(<span class="hljs-string"><span class="hljs-string">"AES/CBC/NoPadding"</span></span>); goto label_15; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(NoSuchPaddingException v3) { } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(NoSuchAlgorithmException v3_1) { } String v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; goto label_10; label_15: SecretKeySpec v9 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SecretKeySpec(v7.getBytes(), <span class="hljs-string"><span class="hljs-string">"AES"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v11_1 = <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { v1.init(v11_1, ((Key)v9), ((AlgorithmParameterSpec)v5)); v2 = Base64.decode(v1.doFinal(bwdoclkr.xkvasepi(v10)), <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v2.length &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_48; } v4 = <span class="hljs-number"><span class="hljs-number">0</span></span>; v6 = v2.length - <span class="hljs-number"><span class="hljs-number">1</span></span>; label_29: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v6 &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_38; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v2[v6] != <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_33; } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(Exception v3_2) { goto label_51; } ++v4; label_33: --v6; goto label_29; label_38: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v4 &lt;= <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_48; } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] v8 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[v2.length - v4]; System.arraycopy(v2, <span class="hljs-number"><span class="hljs-number">0</span></span>, v8, <span class="hljs-number"><span class="hljs-number">0</span></span>, v2.length - v4); v2 = v8; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span>(Exception v3_2) { label_51: v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; goto label_10; } label_48: v11 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(v2); goto label_10; label_9: v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; label_10: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v11; } }</code> </pre> </div></div><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ملاحظة جهاز التحليل</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  بالمناسبة ، غالبًا ما يتعطل dex2jar.  لذا ، في الشكل أدناه ، يمكن ملاحظة أن dex2jar الإصدار 2.0 لا يمكنه التأقلم وأصدر للتو رمزًا smali. <br><br><img src="https://habrastorage.org/webt/qr/gw/wa/qrgwwazampyf69hicr0-0evyrxe.png"><br><br>  أحدث إصدار لها ، تم جمعه من المصادر ، أنتج كودًا مترجمًا لهذه الوظيفة ، لكنه لم يستطع فك العديد من اللغات الأخرى (هذه هي الحيلة). <br><br><img src="https://habrastorage.org/webt/66/3v/kp/663vkp2d0rmiwxsbblllpyxpytm.png"><br><br><img src="https://habrastorage.org/webt/i7/n_/8p/i7n_8p01cstevantsmbaxamb7xe.png"><br><br>  خلاصة القول: فكر بعناية في اختيار جهاز فك الشفرة - سيوفر لك هذا الكثير من الوقت وسيكون أسهل من تحليل رمز smali. </div></div><br><br>  لذا ، إذا قمنا فقط بلصق هذا الرمز في IDE الآن ، فلن يعمل بسبب الأخطاء. <br><br>  <b>من المهم أن تتذكر:</b> لا يحتاج المترجم إلى إنتاج كود صالح يكتبه المطور.  إنه مجرد منقذ في التحليل ويضع افتراضات حول كيفية كتابة الشفرة.  في معظم الحالات ، بعد التحسين من قبل المترجم ، تتوقف مهمة استعادة الشفرة الأصلية تمامًا عن كونها تافهة. <br><br>  مثال سيء للترجمة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { goto label_9; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(v10.length() != <span class="hljs-number"><span class="hljs-number">0</span></span>) { goto label_11; } goto label_9; … label_9: v11 = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> v11;</code> </pre> <br>  نرى أنه اتضح بشكل سيئ وغير عملي.  نعيد كتابة: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((v10 == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) || (v10.length() == <span class="hljs-number"><span class="hljs-number">0</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>; }</code> </pre><br>  الآن أصبح الأمر أكثر وضوحًا ، إليك فحص الإدخال المعتاد.  في هذه الحالة ، نحتاج إلى: <br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  استبدل جميع "goto" ببنيات لغة أخرى ، مثل  لطالما كان "Goto" عامل تشغيل غير صالح. </li><li style=";text-align:right;direction:rtl">  استبدل مكالمات مكتبة Android بمكالمات مكتبة Java (إذا حاولنا تنفيذ التعليمات البرمجية في Java IDE). </li><li style=";text-align:right;direction:rtl">  إدراج الفئات التابعة المشار إليها بواسطة التعليمات البرمجية الخاصة بنا. </li><li style=";text-align:right;direction:rtl">  فكر في نفسك ما هو الخطأ. </li></ul><br>  نتيجة لذلك ، نحصل على: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.company; <span class="hljs-comment"><span class="hljs-comment">//package isqpwcmx.isfdztgb.adscjobz.nxscomkr.jypbdxnt.utagwpym.wprtdznb.swldgrhm.yrbjpktq; import java.util.Base64; //import android.util.Base64; //import bnxvhlyg.nkhoirul.zfxogwqi.mdpqejcw.srnepbly.pcbvwxrs.vixdqclm.wnuqvrhp.bnvceayd.bwdoclkr; //   import java.security.Key; import java.security.NoSuchAlgorithmException; import java.security.spec.AlgorithmParameterSpec; import javax.crypto.Cipher; import javax.crypto.NoSuchPaddingException; import javax.crypto.spec.IvParameterSpec; import javax.crypto.spec.SecretKeySpec; public abstract class Main { public Main() { super(); } //hex to ascii public static byte[] xkvasepi(String str) { byte[] v0 = null; if(str != null &amp;&amp; str.length() &gt;= 2) { int v2 = str.length() / 2; v0 = new byte[v2]; int v1; for(v1 = 0; v1 &lt; v2; ++v1) { v0[v1] = ((byte)Integer.parseInt(str.substring(v1 * 2, v1 * 2 + 2), 16)); } } return v0; } public static String podxiwkt(String[] args) { int v6; int v4; byte[] v2; Cipher v1; String v10 = args[0]; //text String v7 = args[1]; //key String v0 = args[2]; //IV //check if ((v10 == null) || (v10.length() == 0)) { return ""; } IvParameterSpec v5 = new IvParameterSpec(v0.getBytes()); try { v1 = Cipher.getInstance("AES/CBC/NoPadding"); } catch(NoSuchPaddingException v3) { return ""; } catch(NoSuchAlgorithmException v3_1) { return ""; } SecretKeySpec v9 = new SecretKeySpec(v7.getBytes(), "AES"); int v11_1 = 2; try { v1.init(v11_1, ((Key)v9), ((AlgorithmParameterSpec)v5)); //v2 = Base64.decode(v1.doFinal(bwdoclkr.xkvasepi(v10)), 0); v2=v1.doFinal(xkvasepi(v10)); //check if(v2.length &lt;= 0) { return new String(v2); } } catch(Exception v3_2) { return ""; } v4=0; for (v6=v2.length-1;v6&gt;=0;v6--){ if (v2[v6]==0) ++v4; } if(v4 &gt; 0) { try { byte[] v8 = new byte[v2.length - v4]; System.arraycopy(v2, 0, v8, 0, v2.length - v4); v2 = v8; } catch (Exception v3_2) { return ""; } } v2 = Base64.getDecoder().decode(v2); return new String(v2); } public static void main(String[] args) { // write your code here System.out.println(podxiwkt(new String[] { "b1acd584a6eae4ca6321b1f7cdf9ba9617112b4fb39e76c8def876346e3032fbd32b2d188a09715f27124c1bf9facfdc", "637904cd08aeb2d3f6a21b5c7e84f519", "8f4c796d5a3120eb", "zcmwgvdn", "mkngbsyr", "rwcdaieu" })); } }</span></span></code> { "b1acd584a6eae4ca6321b1f7cdf9ba9617112b4fb39e76c8def876346e3032fbd32b2d188a09715f27124c1bf9facfdc"، "637904cd08aeb2d3f6a21b5c7e84f519"، "8f4c796d5a3120eb"، "zcmwgvdn"، "mkngbsyr"، "rwcdaieu"}))؛ <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.company; <span class="hljs-comment"><span class="hljs-comment">//package isqpwcmx.isfdztgb.adscjobz.nxscomkr.jypbdxnt.utagwpym.wprtdznb.swldgrhm.yrbjpktq; import java.util.Base64; //import android.util.Base64; //import bnxvhlyg.nkhoirul.zfxogwqi.mdpqejcw.srnepbly.pcbvwxrs.vixdqclm.wnuqvrhp.bnvceayd.bwdoclkr; //   import java.security.Key; import java.security.NoSuchAlgorithmException; import java.security.spec.AlgorithmParameterSpec; import javax.crypto.Cipher; import javax.crypto.NoSuchPaddingException; import javax.crypto.spec.IvParameterSpec; import javax.crypto.spec.SecretKeySpec; public abstract class Main { public Main() { super(); } //hex to ascii public static byte[] xkvasepi(String str) { byte[] v0 = null; if(str != null &amp;&amp; str.length() &gt;= 2) { int v2 = str.length() / 2; v0 = new byte[v2]; int v1; for(v1 = 0; v1 &lt; v2; ++v1) { v0[v1] = ((byte)Integer.parseInt(str.substring(v1 * 2, v1 * 2 + 2), 16)); } } return v0; } public static String podxiwkt(String[] args) { int v6; int v4; byte[] v2; Cipher v1; String v10 = args[0]; //text String v7 = args[1]; //key String v0 = args[2]; //IV //check if ((v10 == null) || (v10.length() == 0)) { return ""; } IvParameterSpec v5 = new IvParameterSpec(v0.getBytes()); try { v1 = Cipher.getInstance("AES/CBC/NoPadding"); } catch(NoSuchPaddingException v3) { return ""; } catch(NoSuchAlgorithmException v3_1) { return ""; } SecretKeySpec v9 = new SecretKeySpec(v7.getBytes(), "AES"); int v11_1 = 2; try { v1.init(v11_1, ((Key)v9), ((AlgorithmParameterSpec)v5)); //v2 = Base64.decode(v1.doFinal(bwdoclkr.xkvasepi(v10)), 0); v2=v1.doFinal(xkvasepi(v10)); //check if(v2.length &lt;= 0) { return new String(v2); } } catch(Exception v3_2) { return ""; } v4=0; for (v6=v2.length-1;v6&gt;=0;v6--){ if (v2[v6]==0) ++v4; } if(v4 &gt; 0) { try { byte[] v8 = new byte[v2.length - v4]; System.arraycopy(v2, 0, v8, 0, v2.length - v4); v2 = v8; } catch (Exception v3_2) { return ""; } } v2 = Base64.getDecoder().decode(v2); return new String(v2); } public static void main(String[] args) { // write your code here System.out.println(podxiwkt(new String[] { "b1acd584a6eae4ca6321b1f7cdf9ba9617112b4fb39e76c8def876346e3032fbd32b2d188a09715f27124c1bf9facfdc", "637904cd08aeb2d3f6a21b5c7e84f519", "8f4c796d5a3120eb", "zcmwgvdn", "mkngbsyr", "rwcdaieu" })); } }</span></span></code> </pre> <br>  يفي هذا الرمز بنجاح.  بعد أن يصبح عمله واضحًا ، يمكن تبسيطه وتبسيطه ، مما يؤدي إلى النوع المقتضب المفترض الذي كتبه المبرمج (ما لم تكن يداه بالطبع ملتوية في البداية). <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ملاحظة</b> <div class="spoiler_text" style=";text-align:right;direction:rtl">  بالمناسبة ، في هذه الحالة ، يمكن إظهار فك تشفير السلاسل باستخدام مجموعة من الموارد عبر الإنترنت.  مثال على استدعاء سلسلة مشفرة داخل برنامج: <br><br><img src="https://habrastorage.org/webt/wk/0q/h4/wk0qh4-_qox9qigts4orp76gu2u.png"><br><br>  هنا ، يجب تحويل متجه التهيئة أولاً إلى تنسيق Hex: <br><br><img src="https://habrastorage.org/webt/ey/us/ob/eyusob7yodb8dkmiucxaf8mfrpi.png"><br><br>  استبدل جميع القيم: <br><br><img src="https://habrastorage.org/webt/5j/xd/fg/5jxdfg4z4xyl1qoiqxpdtjzv1hc.png"><br><br>  وفي النهاية ، فك الشفرة من base64: <br><br><img src="https://habrastorage.org/webt/p6/s4/oy/p6s4oyvyfxrwkoodlfqj0l8c6ii.png"><br><br>  ونتيجة لذلك ، نحصل على السلسلة المعتادة ، وتلقي المكالمة نظرة ذات معنى. <br></div></div><br>  وبالتالي ، تحتاج إلى مراجعة الرمز بالكامل وجمع جميع السلاسل المشفرة ، والآن يمكننا فك تشفيرها بشكل مستقل.  النقطة المهمة هنا هي أنه في مرحلة "التعديل والتعليق على الكود" يمكننا العمل على مستوى smali وعلى مستوى Java (smali decompiled). <br><br><table style=";text-align:right;direction:rtl"><tbody><tr><td width="120"></td><td width="330">  إيجابيات التعديل </td><td width="330">  سلبيات تعديل </td></tr><tr><td>  سمالي </td><td>  يمكنك إجراء تغييرات وإعادة تجميع في dex وفك مع خطوط جديدة </td><td>  ليس من السهل دائمًا العمل باستخدام رمز smali.  إذا كان التغيير غير صحيح ، فلن يتم ترجمة التطبيق </td></tr><tr><td>  جافا </td><td>  غالبًا ما يكون استخراج البيانات من عمليات المستوى الأعلى أسهل كثيرًا. </td><td>  لا يستطيع معظم مشاهدي كود Java التعديل. </td></tr></tbody></table><br>  مثال سطر آخر <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs">vcgrnfjx.execSQL(nvhdzjfo.xipswfqb(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String[]{<span class="hljs-string"><span class="hljs-string">"f741f04a4991fc2f0a0029f610bbd1c250dfe115fb7770b892f75d8718b822d273251013991b4407e224fa3f9d4e92f6"</span></span>,<span class="hljs-string"><span class="hljs-string">"378f40211b6e32a5406cd97e85bcf9ad"</span></span>,<span class="hljs-string"><span class="hljs-string">"6378a459b1c20edf"</span></span>, <span class="hljs-string"><span class="hljs-string">"gexnfwok"</span></span>, <span class="hljs-string"><span class="hljs-string">"meazfhdp"</span></span>, <span class="hljs-string"><span class="hljs-string">"bsmotaxn"</span></span>})</code> </pre> <br>  من هنا ، من السهل جدًا اختيار المعلمات باستخدام تعبير عادي ، بدلاً من كتابة حرف عادي على الكود التالي: <br><br>  <b>مثال كود سمالي 1</b> <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">00000280 new-instance v13, Ljava/lang/StringBuilder; 00000284 invoke-direct {v13}, Ljava/lang/StringBuilder;-&gt;&lt;init&gt;()V 0000028A const/4 v14, 0x6 0000028C new-array v14, v14, [Ljava/lang/String; 00000290 const/4 v15, 0x0 00000292 const-string v16, "f741f04a4991fc2f0a0029f610bbd1c250dfe115fb7770b892f75d8718b822d273251013991b4407e224fa3f9d4e92f6" 00000296 aput-object v16, v14, v15 0000029A const/4 v15, 0x1 0000029C const-string v16, "378f40211b6e32a5406cd97e85bcf9ad" 000002A0 aput-object v16, v14, v15 000002A4 const/4 v15, 0x2 000002A6 const-string v16, "6378a459b1c20edf" 000002AA aput-object v16, v14, v15 000002AE const/4 v15, 0x3 000002B0 const-string v16, "gexnfwok" 000002B4 aput-object v16, v14, v15 000002B8 const/4 v15, 0x4 000002BA const-string v16, "meazfhdp" 000002BE aput-object v16, v14, v15 000002C2 const/4 v15, 0x5 000002C4 const-string v16, "bsmotaxn" 000002C8 aput-object v16, v14, v15</code> </pre> <br><br>  <b>مثال على رمز Smali 2</b> <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">0000008E new-array v0, v0, [Ljava/lang/String; 00000092 move-object/from16 v89, v0 00000096 const/16 v90, 0x0 0000009A const-string v91, "4500b5e2e2ad26b7545eb54d70ab360ae28c9d031e2afcc3f6a2b2ac488ea440" 0000009E aput-object v91, v89, v90 000000A2 const/16 v90, 0x1 000000A6 const-string v91, "da96f678922d4b07350b3a184ecc1f5e" 000000AA aput-object v91, v89, v90 000000AE const/16 v90, 0x2 000000B2 const-string v91, "0cf69e3d2745a1b8" 000000B6 aput-object v91, v89, v90 000000BA const/16 v90, 0x3 000000BE const-string v91, "jhiqsaoe" 000000C2 aput-object v91, v89, v90 000000C6 const/16 v90, 0x4 000000CA const-string v91, "khbqxurn" 000000CE aput-object v91, v89, v90</code> </pre> <br><br>  <b>مثال على رمز سمالي 3</b> <br><br><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">00000D3E new-array v0, v0, [Ljava/lang/String; 00000D42 move-object/16 v298, v0 00000D48 const/4 v0, 0x0 00000D4A move/16 v299, v0 00000D50 const-string v0, "b286945744e085f4d5c19916fd261481" 00000D54 move-object/16 v300, v0 00000D5A move-object/from16 v0, v300 00000D5E move-object/from16 v1, v298 00000D62 move/from16 v2, v299 00000D66 aput-object v0, v1, v2 00000D6A const/4 v0, 0x1 00000D6C move/16 v299, v0 00000D72 const-string v0, "df6883742b2911ac5ac7b4dee065390f" 00000D76 move-object/16 v300, v0 00000D7C move-object/from16 v0, v300 00000D80 move-object/from16 v1, v298 00000D84 move/from16 v2, v299 00000D88 aput-object v0, v1, v2 00000D8C const/4 v0, 0x2 00000D8E move/16 v299, v0 00000D94 const-string v0, "90a463ce2df17b58" 00000D98 move-object/16 v300, v0 00000D9E move-object/from16 v0, v300 00000DA2 move-object/from16 v1, v298 00000DA6 move/from16 v2, v299 00000DAA aput-object v0, v1, v2 00000DAE const/4 v0, 0x3 00000DB0 move/16 v299, v0 00000DB6 const-string v0, "cupyzsgq" 00000DBA move-object/16 v300, v0 00000DC0 move-object/from16 v0, v300 00000DC4 move-object/from16 v1, v298 00000DC8 move/from16 v2, v299 00000DCC aput-object v0, v1, v2</code> </pre> <br><br>  كما نرى ، تتغير المتغيرات الداخلية ، ويختلف تسلسل الأوامر ، كما يختلف عدد الحجج ، بالإضافة إلى ذلك ، في البرنامج ، لا يتم استدعاء وظيفة فك التشفير بشكل مباشر ، ولكن من خلال وظائف الطبقة.  حاول كتابة قاعدة بنفسك للبحث عن هذه البنية ، وتجنب الأخطاء في التقاط السلاسل من الوظائف الأخرى ، وقم بكل ذلك بسرعة ( <s>حظًا سعيدًا</s> ). <br><br>  خطة المصيدة: <br><br><ol style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl">  سنقوم باستخراج كل القيم من الكود المتحلل. </li><li style=";text-align:right;direction:rtl">  فك تشفير. </li><li style=";text-align:right;direction:rtl">  استبدل النص المشفر بالنص المفتوح في كود smali.  نستبدل ، على سبيل المثال ، بدلاً من عامل التشغيل الأول.  (سيكون من الأكثر احترافية قطع مكالمة الوظيفة بالكامل وترك السلسلة التي تم فك تشفيرها ، ولكن مرة أخرى هناك خطر كبير لكسر البرنامج). </li><li style=";text-align:right;direction:rtl">  دعنا نجمع كود smali في ملف dex. </li><li style=";text-align:right;direction:rtl">  سيكون من الملائم النظر إلى مزيد من المعلومات في محلل الشفرة ، حيث بدأنا. </li></ol><br>  إذا جمعت كل الشفرة المترجمة في ملف واحد ، فستحصل على حوالي 20000 سطر ، وهو ما يتطلب للتحليل اليدوي الكثير من الوقت ، والذي يكلف بوضوح أكثر من الأحذية التي عرضتها للبيع.  أولاً ، اجمع كل الخطوط بتعبير عادي. <br><br><img src="https://habrastorage.org/webt/gq/42/ln/gq42ln2llsfpoxt2yjw0orhfr2m.png"><br><br>  نرى 593 مباراة ، بالإضافة إلى اثني عشر من الذين لم يندرجوا تحت هذه القاعدة ، <s>لدى الأسرة خرافها السوداء</s> .  مثال: <br><br><img src="https://habrastorage.org/webt/zw/bn/5y/zwbn5y1ghfnrf8i3auethghnzdo.png"><br><br>  ترتيب ، تصفية ، إجمالي 422 سطرًا فريدًا: <br><br><img src="https://habrastorage.org/webt/en/c1/ji/enc1jiwqkssvsa3irluzvvxfyzu.png"><br><br>  نمر من خلال وظيفة فك التشفير التي استعادناها في وقت سابق.  النتيجة: <br><br><img src="https://habrastorage.org/webt/cv/no/op/cvnoopawvfln2h4yq-ducg3zite.png"><br><br>  استبدل النص المشفر بالنص المفتوح برمز smali باستخدام Python: <br><br><pre style=";text-align:right;direction:rtl"> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> os words_replace=dict() words_replace[<span class="hljs-string"><span class="hljs-string">"0018aacad3d146266317d8d8c51785fd"</span></span>]=<span class="hljs-string"><span class="hljs-string">"imei"</span></span> words_replace[<span class="hljs-string"><span class="hljs-string">"016d15e4d0a72667c61428e736a6f3b8"</span></span>]=<span class="hljs-string"><span class="hljs-string">"WakeLock"</span></span> words_replace[<span class="hljs-string"><span class="hljs-string">"032c534efb6c9990cd845a08c5a08b95"</span></span>]=<span class="hljs-string"><span class="hljs-string">"inbox"</span></span> #…  .. # smali- #      <span class="hljs-function"><span class="hljs-function">def </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">change</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(path)</span></span></span><span class="hljs-function">: </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"file="</span></span></span></span><span class="hljs-function"><span class="hljs-params">+path)</span></span></span><span class="hljs-function"> file_handle </span></span>= open(path, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) context_full = file_handle.read() file_handle.close() <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i in words_replace: context_full=context_full.replace(i, words_replace[i]) #print (i+<span class="hljs-string"><span class="hljs-string">""</span></span>+words_replace[i]) file_handle = open(path, <span class="hljs-string"><span class="hljs-string">'w'</span></span>) context_full = file_handle.write(context_full) file_handle.close() #      smali- <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> top, dirs, files in os.walk(<span class="hljs-string"><span class="hljs-string">'C:\\work\\test'</span></span>): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> nm in files: path=os.path.join(top, nm) print (path) change(path)</code> </pre> <br>  نجمع ملفات smali في dex: <br><br><img src="https://habrastorage.org/webt/dz/41/qz/dz41qzrvcue-bl2j-vb2jp4cw_w.png"><br><br>  الآن يمكن تحليل هذا بطريقة أو بأخرى (من خلال قراءة الحجة الأولى من البناء بأكمله): <br><br><img src="https://habrastorage.org/webt/ik/5g/ro/ik5grom-c0igb9zqgh-hzdhf6yg.png"><br><br><h2 style=";text-align:right;direction:rtl">  تحليل </h2><br>  لذلك ، لدينا 20000 سطر من التعليمات البرمجية يمكن قراءتها أكثر أو أقل ، لا نحتاج إلى إجراء تحليل كامل.  من الضروري فهم الوظيفة ككل.  هنا ، في الواقع ، مطلوب فقط القدرة على قراءة شفرة مصدر جافا.  تجول في الكود ، وانظر إلى المراجع التبادلية ، وأعد تسمية المتغيرات والوظائف. <br><br>  ما هي أفضل طريقة لتحليل تطبيق Android ، وخاصة التطبيق الكبير؟ <br><br>  <b>الخيار 1: يمكنك الانتقال من ملف البيان</b> <br><br>  على سبيل المثال ، حاول بشكل تسلسلي من LAUNCHER فك سلسلة المكالمات بالكامل.  بالمناسبة ، لا تنس أنه لا يزال هناك "المتلقي" و "الخدمة" التي يمكن أن تغير التنفيذ الخطي للبرنامج. <br><br><img src="https://habrastorage.org/webt/hk/rd/j1/hkrdj1deeuxaq294dxfpgswr1pu.png"><br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">ملف البيان الكامل</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8" standalone="no"?&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:installLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"internalOnly"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft.permission.C2D_MESSAGE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.permission.RECEIVE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SEND_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.INTERNET"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_PHONE_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_NETWORK_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.WAKE_LOCK"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.SYSTEM_ALERT_WINDOW"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.MODIFY_AUDIO_SETTINGS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CHANGE_NETWORK_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.RECEIVE_BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.READ_SMS"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.ACCESS_WIFI_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.CHANGE_WIFI_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">permission</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft.permission.C2D_MESSAGE"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:protectionLevel</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"signature"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:allowBackup</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:icon</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@drawable/icon"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/tgiwmpqy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:noHistory</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:excludeFromRecents</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/tgiwmpqy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"zemquyog.csrtmnak.xrkfygen.wkahrnjd.acnfunjh.rgipxbuf.lruiwxeg.blqndche.dcjihbou"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xbfrscou.hxrvwnoi.djvpcqri.enlnrfio.aoegxbiu.heywzmnb.znfnxcht.nazcxobq"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hcfkagds.timkagsd.oetvghzr.fcioynvl.psynofdj.slcghdjz.tapnwsdk.gzvwnban.htenafdb.qwebhzgy"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:noHistory</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:configChanges</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"orientation"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:excludeFromRecents</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:launchMode</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"singleTop"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"njfbwmre.voefarqx.ftuxvngl.wrmshxqj.zdenywgn.eiwyunlg.jysgkbam.yrijthab.vstqxpuo.iplamgxf"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483647"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:screenOrientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"portrait"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"gfbaznoc.asyoqtnm.kbetoqca.mqysobzu.gqwfibrv.dorxijuk.wgzkmiep.ywnnurzv.csfpqhrn"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.permission.BIND_DEVICE_ADMIN"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta-data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@string/pkzrlscm"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:resource</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@xml/ynqukvnb"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483646"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.app.action.DEVICE_ADMIN_ENABLED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ykwbodxc.gymjhibn.kgmdfqor.hbasvmfz.yegkmaif.ortzknvm.quplincn.cuxytvhs.fqonzuts.cyuoxgqi.znumwyct"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:permission</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.permission.SEND"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.intent.RECEIVE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.intent.REGISTRATION"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.google.android.c2dm.intent.UNREGISTRATION"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:exported</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"kqwihjot.nvkqjloc.grjnyknm.owydvckh.mugknwdx.enhcyvja.mhvbpcue.ztbwjhfo"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483646"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.LOCKED_BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.htc.intent.action.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.QUICKBOOT_POWERON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BOOT_COMPLETED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.USER_PRESENT"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BATTERY_OKAY"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.BATTERY_LOW"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.ACTION_POWER_CONNECTED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.ACTION_POWER_DISCONNECTED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.APP_ERROR"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.HEADSET_PLUG"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.PHONE_STATE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.NEW_OUTGOING_CALL"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.TIME_TICK"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.SCREEN_ON"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.SCREEN_OFF"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.net.conn.CONNECTIVITY_CHANGE"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.net.wifi.WIFI_STATE_CHANGED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.DREAMING_STOPPED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.HOME"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"btnsxnuz.wmjizbky.lynvjxqz.zinomjuv.yizlgcnf.qwoikgnc.wnrskjea.wfqgmeny.lcgvqrms.ocwkgblp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:priority</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2147483646"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.provider.Telephony.SMS_RECEIVED"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">receiver</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ltvsrezg.ehxndrat.twnnyxrf.nqynefws.dhbalcnr.ynjkuxod.nhoxmsbq.nackoyhn.voycgfek.znhwkqba.taxvnfyn"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"rbnakfzo.qsreiubk.pwvlnngs.twoxnhfv.mftarcnd.pfioxcub.xjlaftqr.nxrqvlwh"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">service</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:enabled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft.ugshpjvo"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br>  <b>الخيار 2: يمكنك الانتقال من خطوط مثيرة للاهتمام</b> <br><br><img src="https://habrastorage.org/webt/ey/vs/oe/eyvsoe_svrnkzau5dfdp4yvht7g.png"><br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">جزء من سلاسل مشفرة</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="bash hljs">system_update.apk () () , error = , unregistered = ,  .permission.C2D_MESSAGE //sky-sync.pw/ //sms/inbox /system_update.apk ALLCONTACTS ALLMSG AUTHENTICATION_FAILED Acquiring wakelock Application BLOCKER_BANKING_START BLOCKER_EXTORTIONIST_START BLOCKER_STOP BLOCKER_UPDATE_START Banking CHANGE_GCM_ID CONTACTS CONTACTS_PRO CREATE TABLE IF NOT EXISTS END Error|No process list|No access Extortionist Foreground GCM returned invalid number of GCMBaseIntentService GCMBroadcastReceiver GCMIntentService- GCMRegistrar GCM_LIB GET MESSAGE Mobile Network NEWMSG Not retrying failed operation ONLINE PAGE POST Process finished with <span class="hljs-built_in"><span class="hljs-built_in">exit</span></span> code 0 RESTART Received deleted messages Registering receiver Releasing wakelock SERVICE_NOT_AVAILABLE SSL START STOP Saving regId on app version Scheduling registration retry, backoff = Setting registeredOnServer status as Stop System UNBLOCK UPDATE UPDATE_PATTERNS URL UTF-8 Update WakeLock Wakelock reference is null Wi-Fi WiMax _success add_msg_ok address android.intent.action.QUICKBOOT_POWERON answer_text answer_to api_url app appVersion application application/vnd.android.package-archive apps_list ask backoff_ms blocker blocker_banking blocker_banking_autolock blocker_banking_forced_access blocker_banking_success blocker_extortionist blocker_extortionist_autolock blocker_extortionist_forced_access blocker_extortionist_success blocker_update blocker_update_forced_access blocker_update_success body build callback cardSuccess check com.android.settings com.google.android.c2dm.intent.RECEIVE com.google.android.c2dm.intent.REGISTER com.google.android.c2dm.intent.REGISTRATION com.google.android.c2dm.intent.UNREGISTER com.google.android.gcm com.google.android.gcm.intent.RETRY com.google.android.gsf com.htc.intent.action.QUICKBOOT_POWERON <span class="hljs-built_in"><span class="hljs-built_in">command</span></span> command_receive contactslist country data date delete deleted_messages device_block disableDataConnectivity enableDataConnectivity error failure file deleted. first_start force-locked gafzpjxb.cix gcm gcm_id gcm_register gcm_register_ok getITelephony get_message_list id <span class="hljs-built_in"><span class="hljs-built_in">integer</span></span> primary key autoincrement, id=? imei immunity inbox init_bootable init_imei is_admin is_awake_display is_imunnity is_locked is_network_type is_top_activity job job_date job_id komgejif.hqr locked message message_delivered message_type method model msg msg_id msglist name not nypjtinq.nvp ok onServer onServerExpirationTime onServerLifeSpan operator org.android.sys.admin.disabled org.android.sys.admin.enabled org.android.sys.admin.request org.android.sys.command.receive org.android.sys.launch.first org.android.sys.sms.pro.sent org.android.sys.sms.push org.android.sys.sms.sent outbox page params pattern patterns personal phone phone_list privet process_list protocol qwertyuiopasdfghjklzxcvbnm receive regId regex register register_ok registrationId = registration_id repeat resetting backoff <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ru save_contacts_list save_message_history sender sent sent_status sid ss status stop_blocker text text, text/html time token total_deleted <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> unknown unregistered until url useragent utf-8 value version xpls yes   !     ...                   !  ?                !</code> </pre> </div></div><br>  <b>الخيار 3: يمكنك الانتقال من موارد مثيرة للاهتمام (الأصول ، المكتبات)</b> <br><br>  في هذه الحالة ، يفضل الخيار 3.  هناك ثلاثة ملفات html مثيرة للاهتمام في مجلد / asset (حاوية apk).  هنا وجهة نظرهم في المتصفح: <br><br><img src="https://habrastorage.org/webt/4y/rg/ep/4yrgepcm5xja-nfzbjpcbsiuvzc.png"><img src="https://habrastorage.org/webt/y8/8q/jw/y88qjwn-fy-fikqujjbxsbq3are.png"><br><br><img src="https://habrastorage.org/webt/eo/cf/um/eocfum1acs28e-4ljvqt3yiufci.png"><br><br>  يبدو الأمر مشكوكًا فيه بالنسبة لبرنامج Avito الرسمي لتحويل الدفع ، ألا يبدو لك ذلك؟  دعونا نتتبع ما يحدث عند الضغط على المفتاح لإرسال البيانات المصرفية على الصفحة مع شعار Sberbank.  تستدعي JavaScript وظيفة <code>sendCardData()</code> : <br><br><img src="https://habrastorage.org/webt/v5/aq/sy/v5aqsyuab0lbn4clzhpk4uy4r88.png"><br><br>  ثم يتم تحويلها إلى كود Java من خلال المكالمة <code>ok.performClick()</code> : <br><br><img src="https://habrastorage.org/webt/p4/cv/av/p4cvavqi00ja2bdmryikgcotn34.png"><br><br>  في كود Java ، يتم تنفيذ المعالجة: <br><br><img src="https://habrastorage.org/webt/sq/2m/x_/sq2mx_tfwvmi0iudzgksecj6dcs.png"><br><br>  علاوة على ذلك ، يتم تشفير كل هذا في فئة <code>mcrypt</code> : <br><br><img src="https://habrastorage.org/webt/cr/aw/00/craw00nuksdczckxfxc04gclvru.png"><br><br>  داخل الوظيفة ، يتم تشفير البيانات بنفس الطريقة التي تم اعتبارها سابقًا: <br><br><img src="https://habrastorage.org/webt/ov/-j/vk/ov-jvkpta1b6qodmshafhthurya.png"><br><br>  ولكن بالنسبة للباقي ، فإن المفاتيح مشدودة: <br><br><img src="https://habrastorage.org/webt/rd/uc/2b/rduc2bigmg29xzvjmkuuetekd68.png"><br><br>  نحن نحاول فك التشفير من خلال المورد عبر الإنترنت: <br><br><img src="https://habrastorage.org/webt/yx/uw/we/yxuwwe6fls64izf_rcxbky_0m3a.png"><br><br>  وتحويل من base64.  نجاح!  يمكننا فك تشفير جميع بيانات التطبيق: تم اختباره على حركة المرور التي تم التقاطها في وقت سابق. <br><br><div class="spoiler" style=";text-align:right;direction:rtl">  <b class="spoiler_title">تقارير التطبيق إلى الخادم حول جميع الأحداث</b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">{ "sid":15, "imei":"861117030537111", "phone":"System", "message":"     22.10.2018 23:30:47", "time":"1540240247", "msg_id":1, "status":"unknown", "type":"inbox", "method":"message" }</code> </pre> </div></div><br><div class="spoiler" style=";text-align:right;direction:rtl"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">كما أنه ينقل بشكل دوري جميع التطبيقات قيد التشغيل</font></font></b> <div class="spoiler_text" style=";text-align:right;direction:rtl"><pre style=";text-align:right;direction:rtl"> <code class="plaintext hljs">{ "sid": 15, "imei": "861117030537111", "country": "ru", "operator": "MTS RUS", "phone": "", "model": "Xiaomi Redmi 3X", "version": "6.0.1", "application": "", "build": "30.0.2", "process_list": [ "Background|com.android.bluetooth|com.android.bluetooth.hid.HidService", "Background|com.android.settings:remote|com.android.settings.wifi.MiuiWifiService", "Background|com.android.phone|org.codeaurora.ims.ImsService", "Background|system|com.qualcomm.location.LocationService", ..., "Background|xfmpuwon.mtnbupnc.ihqdgjal.ndgmqawx.bjunzerq.cznfpnoq.fzevcuym.jmpdiqft|ltvsrezg.ehxndrat.twnnyxrf.nqynefws.dhbalcnr.ynjkuxod.nhoxmsbq.nackoyhn.voycgfek.znhwkqba.taxvnfyn" ], "apps_list": [ "com.introspy.config", "com.google.android.youtube", "com.google.android.googlequicksearchbox", "org.telegram.messenger", ..., "com.google.android.inputmethod.latin", "jakhar.aseem.diva" ], "method": "register" }</code> </pre> </div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إذا كانت لدي نافذة لإدخال البيانات المصرفية في الديناميكيات ، فستكون البيانات في حركة المرور. </font><font style="vertical-align: inherit;">وهكذا ، يمكننا أن نستنتج أن هذا هو تطبيق "التصيد". </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أولئك الذين كانوا حذرين لاحظوا أن ملف Manifest لديه عدد غير قليل من الأذونات ، وأن التطبيق يحتوي على وظائف أكثر ثراء. </font><font style="vertical-align: inherit;">سنقوم بإجراء تحليل عميق للوظيفة في مقال آخر. </font><font style="vertical-align: inherit;">في هذه الأثناء ، النجاح!</font></font><br><br><h2 style=";text-align:right;direction:rtl">  الاستنتاجات </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">أشعر بخيبة أمل لأنني لم أبيع الأحذية. </font><font style="vertical-align: inherit;">وكانت الاستنتاجات كما يلي:</font></font><br><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> <s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">لا تبيع الأحذية على Avito</font></font></s> </li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لا تنقر على الروابط الغامضة (حتى لو كان من الأصدقاء وحتى إذا كنت "بحاجة إلى اقتراض 100 روبل بشكل عاجل - مسألة حياة أو موت") </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لا تقم بتنزيل تطبيقات بخلاف Google Play أو AppStore </font></font><br><ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> افصل التثبيت من "مصادر غير موثوقة" إذا كنت لا تفهم حقًا ما هو. </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> لا تفصل "حماية التشغيل". </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">تذكر أنه </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">قد يكون</font></a><font style="vertical-align: inherit;"> هناك </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;">برامج ضارة</font></a><font style="vertical-align: inherit;"> على Google Play</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=ar&amp;u="><font style="vertical-align: inherit;"></font></a> </li></ul></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> قم بتثبيت برنامج مكافحة الفيروسات على الهاتف (إنه يعمل حقًا). </font></font></li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إذا كنت مطورًا ، لا تشوه الرمز ، دع الناس يتأكدون من حسن نواياك </font><i><font style="vertical-align: inherit;">(</font></i><font style="vertical-align: inherit;"> مجرد مزاح </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></i> </li><li style=";text-align:right;direction:rtl"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">إذا كنت باحثًا ، فلا تعمل من أجل الطعام ، وقم بتحليل التطبيقات في وقت فراغك ونشر التقارير. </font><font style="vertical-align: inherit;">معًا سنجعل العالم مكانًا أفضل.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ملاحظة: حاولت كتابة المقالة قليلاً بتنسيق فكاهي وإرسالها بأبسط ما يمكن ، لأنني حتى لا أريد أن أقرأ على الأرجح يوم الجمعة رحلة طويلة خطيرة تسمى "الهندسة العكسية لتطبيق Android الخبيث المشوش". </font></font></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/ar430074/">https://habr.com/ru/post/ar430074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../ar430062/index.html">الخدمات الدقيقة. تطوير وإعادة بناء الأنماط باستخدام أمثلة جافا</a></li>
<li><a href="../ar430064/index.html">C ++: جلسة علم الآثار العفوي ولماذا لا يجب استخدام الوظائف المتغيرة بأسلوب C</a></li>
<li><a href="../ar430068/index.html">وسام الكريساليس</a></li>
<li><a href="../ar430070/index.html">المكدس والطابور هما نموذجان سيئان وما يمكن القيام به حيال ذلك</a></li>
<li><a href="../ar430072/index.html">التقليل من أهمية Swift من جانب الخادم: مقابلة مع Paul Hudson</a></li>
<li><a href="../ar430076/index.html">البث المجاني لـ DotNext 2018 Moscow</a></li>
<li><a href="../ar430078/index.html">كيفية التحكم في الأجهزة الكهربائية ، ونماذج التحكم عن بعد ، وعربات بمحركات مع لمحة</a></li>
<li><a href="../ar430080/index.html">الانتقال إلى نظام مجموعة 1C-Bitrix: بيئة الويب</a></li>
<li><a href="../ar430082/index.html">Travinibay: Habr و RUVDS - الذئاب البحرية لتكنولوجيا المعلومات الروسية</a></li>
<li><a href="../ar430084/index.html">سيتعين على Oracle JDK الدفع. ما هي الخيارات الآن؟</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>