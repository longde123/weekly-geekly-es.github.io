<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üñçÔ∏è üîò üë° Der vollst√§ndige Leitfaden zu Prometheus im Jahr 2019 ü§Ω üêã üë®üèª</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Die Ingenieure von DevOps und SRE haben wahrscheinlich mehr als einmal von Prometheus geh√∂rt . 


 Prometheus wurde 2012 bei SoundCloud entwickelt und...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Der vollst√§ndige Leitfaden zu Prometheus im Jahr 2019</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/company/southbridge/blog/455290/"><p><img src="https://habrastorage.org/webt/sw/aw/et/swawetpfrgxw6k0m4bb960d3q2c.jpeg"></p><br><p>  <strong>Die Ingenieure von DevOps und SRE</strong> haben wahrscheinlich mehr als einmal von <strong>Prometheus geh√∂rt</strong> . </p><br><p>  Prometheus wurde 2012 bei SoundCloud entwickelt und ist seitdem zum Standard f√ºr <strong>√úberwachungssysteme geworden</strong> .  Es verf√ºgt √ºber vollst√§ndig Open Source-Code und bietet Dutzende verschiedener Exporteure, mit denen Sie die <strong>√úberwachung der gesamten Infrastruktur in</strong> <strong>wenigen Minuten</strong> einrichten k√∂nnen. </p><br><p>  Prometheus hat einen offensichtlichen Wert und wird bereits von Brancheninnovatoren wie DigitalOcean oder Docker als Teil eines vollst√§ndigen √úberwachungssystems verwendet. </p><br><p>  <em>Was ist Prometheus?</em> <em><br></em>  <em>Warum wird es ben√∂tigt?</em> <em><br></em>  <em>Wie unterscheidet es sich von anderen Systemen?</em> </p><br><p> Wenn Sie √ºberhaupt nichts √ºber Prometheus wissen oder es, sein √ñkosystem und alle Interaktionen besser verstehen m√∂chten, ist <strong>dieser Artikel nur f√ºr Sie</strong> . </p><a name="habracut"></a><br><p>  Wir haben diesen Leitfaden <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">wie bei InfluxDB</a> in drei Teile <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">unterteilt</a> . </p><br><ul><li>  Zun√§chst erhalten Sie einen vollst√§ndigen √úberblick √ºber <strong>Prometheus</strong> , sein √ñkosystem und die wichtigsten Aspekte der schnelllebigen Technologie. </li><li>  Anschlie√üend werden <strong>Erl√§uterungen zu den technischen Begriffen von Prometheus</strong> gegeben.  Wenn Sie nicht wissen, was Metriken, Labels, Instanzen oder Exporteure sind, sind Sie hier. </li><li>  Abschlie√üend beschreiben wir verschiedene <strong>reale Szenarien f√ºr die Verwendung von Prometheus</strong> .  Hier lassen Sie sich von Beispielen erfolgreicher Unternehmen inspirieren. </li></ul><br><h2 id="chast-i-chto-takoe-prometheus">  Teil I. Was ist Prometheus? </h2><br><p>  Prometheus ist eine Zeitreihendatenbank.  Wenn Sie nicht wissen, was eine Zeitreihendatenbank ist, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lesen Sie den ersten Teil des InfluxDB-Handbuchs</a> . </p><br><p>  Prometheus ist jedoch nicht nur eine Zeitreihendatenbank. </p><br><p>  Sie k√∂nnen ein <strong>ganzes √ñkosystem von Tools</strong> daran anh√§ngen, um die Funktionalit√§t zu erweitern. </p><br><p>  Prometheus <strong>√ºberwacht eine Vielzahl von Systemen</strong> : Server, Datenbanken, einzelne virtuelle Maschinen und fast alles. </p><br><p>  Zu diesem <strong>Zweck kratzt Prometheus regelm√§√üig seine Ziele</strong> . </p><br><p>  <em>Was ist Schaben?</em> </p><br><p>  Prometheus <strong>ruft Metriken √ºber HTTP-Aufrufe</strong> an bestimmte Endpunkte ab, die in der Prometheus-Konfiguration angegeben sind. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/bu/li/99/buli99giwtpiuq88n9e3xc1b6ng.png"></a> </p><br><p>  Nehmen Sie zum Beispiel die Webanwendung unter <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http: // localhost: 3000</a> .  Die Anwendung √ºbertr√§gt Metriken im Textformat an eine URL.  Sagen wir <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">http: // localhost: 3000 /metrics</a> . </p><br><p>  An dieser Adresse <strong>ruft</strong> Prometheus in bestimmten Intervallen <strong>Daten</strong> vom Ziel ab. </p><br><h3 id="1-kak-rabotaet-prometheus">  1. Wie funktioniert Prometheus? </h3><br><p>  Wie gesagt, Prometheus besteht aus einer Vielzahl von Komponenten. </p><br><p>  Zun√§chst ben√∂tigen Sie es, um Metriken aus Ihren Systemen zu extrahieren.  Es gibt verschiedene M√∂glichkeiten: </p><br><ul><li>  <strong>Instrumentierung der</strong> Anwendung, dh Ihre Anwendung stellt Prometheus-kompatible Metriken unter der angegebenen URL bereit.  Prometheus identifiziert es als Ziel und verschrottet es im angegebenen Intervall. </li><li>  Verwendung von <strong>vorgefertigten Exporteuren</strong> .  Prometheus verf√ºgt √ºber eine Sammlung von Exporteuren f√ºr vorhandene Technologien.  Zum Beispiel vorgefertigte Exporteure zur √úberwachung von Linux-Computern ( <em>Node Exporter</em> ), f√ºr g√§ngige Datenbanken ( <em>SQL Exporter</em> oder <em>MongoDB Exporter</em> ) und sogar f√ºr HTTP-Load Balancer (z. B. <em>HAProxy Exporter</em> ). </li><li>  <strong>Pushgateway verwenden</strong> .  Manchmal stellen Anwendungen oder Aufgaben keine Metriken direkt bereit.  Sie sind m√∂glicherweise nicht daf√ºr ausgelegt (z. B. Stapeljobs), oder Sie haben selbst entschieden, keine Metriken direkt √ºber die Anwendung bereitzustellen. </li></ul><br><p>  Wie Sie bereits verstanden haben, <strong>sammelt Prometheus Daten selbst</strong> (mit Ausnahme der seltenen F√§lle, in denen wir Pushgateway verwenden). </p><br><p> <a href=""><img src="https://habrastorage.org/webt/x8/x5/xl/x8x5xlzryccoxhuk0ly10m4z0ky.png"></a> </p><br><p>  <em>Was bedeutet das?</em> <em><br></em>  <em>Warum wird das ben√∂tigt?</em> </p><br><h3 id="2-sbor-vs-otpravka">  2. Sammlung vs.  Senden </h3><br><p>  Prometheus unterscheidet sich deutlich von anderen Zeitreihendatenbanken: <strong>Es scannt Ziele aktiv, um Metriken von ihnen zu erhalten</strong> . </p><br><p>  InfluxDB funktioniert beispielsweise anders: Sie <strong>senden Daten</strong> direkt selbst <strong>an sie</strong> . </p><br><p> <a href=""><img src="https://habrastorage.org/webt/hp/f5/of/hpf5ofsciuwl0z2jjymkfh9dbi0.png"></a> </p><br><p>  Beide Ans√§tze haben ihre Vor- und Nachteile.  Basierend auf der verf√ºgbaren Dokumentation haben wir eine Liste der Gr√ºnde zusammengestellt, warum sich die Macher von Prometheus f√ºr diese Architektur entschieden haben: </p><br><ul><li>  <strong>Zentrale Steuerung</strong> .  Wenn Prometheus Anforderungen an Ziele sendet, f√ºhren wir die gesamte Konfiguration auf der Prometheus-Seite durch, nicht auf den einzelnen Systemen. </li></ul><br><p>  Prometheus entscheidet, <strong>wo</strong> und <strong>wie oft</strong> er kratzen soll. </p><br><p>  Wenn die Objekte selbst Daten senden, besteht das Risiko, dass zu viele dieser Daten vorhanden sind und der Server abst√ºrzt.  Wenn das System Daten sammelt, k√∂nnen Sie <strong>die H√§ufigkeit der Erfassung steuern</strong> und mehrere Scraping-Konfigurationen erstellen, um eine <strong>unterschiedliche H√§ufigkeit f√ºr verschiedene Objekte</strong> auszuw√§hlen. </p><br><ul><li>  Prometheus speichert <strong>aggregierte Metriken</strong> . </li></ul><br><p>  Dies ist eine Erg√§nzung zum ersten Teil, in dem wir die Rolle des Prometheus besprochen haben. </p><br><p>  Prometheus ist nicht ereignisbasiert und unterscheidet sich stark von anderen Zeitreihendatenbanken.  Es werden keine einzelnen Ereignisse mit Bezug auf die Zeit abgefangen (z. B. Dienstausf√§lle), <strong>sondern voraggregierte Metriken zu Ihren Diensten erfasst</strong> . </p><br><p>  Insbesondere sendet der Webdienst keine 404-Fehlermeldung und keine Nachricht mit der Fehlerursache.  Es wird eine Nachricht gesendet, dass der Dienst in den letzten f√ºnf Minuten eine 404-Fehlermeldung erhalten hat. </p><br><p>  Dies ist der Hauptunterschied zwischen Zeitreihendatenbanken, die aggregierte Metriken erfassen, und solchen, die Rohmetriken erfassen. </p><br><h3 id="3-razvitaya-ekosistema-prometheus">  3. Entwickeltes Prometheus-√ñkosystem </h3><br><p>  Prometheus ist im Wesentlichen eine Zeitreihendatenbank. </p><br><p>  Wenn Sie jedoch mit solchen Datenbanken arbeiten, m√ºssen Sie <strong>die</strong> Daten h√§ufig <strong>visualisieren</strong> , <strong>analysieren</strong> und <strong>Warnungen</strong> f√ºr sie konfigurieren. </p><br><p>  Prometheus unterst√ºtzt die folgenden Tools, die seine Funktionalit√§t erweitern: </p><br><ul><li>  <strong>Alertmanager</strong> .  Prometheus sendet Warnungen an Alertmanager basierend auf benutzerdefinierten Regeln, die in Konfigurationsdateien definiert sind.  Von dort k√∂nnen sie an verschiedene Endpunkte exportiert werden (z. B. Pagerduty oder Slack). </li><li>  <strong>Datenvisualisierung</strong> .  Wie bei Grafana k√∂nnen Sie Zeitreihen direkt in der Prometheus-Webbenutzeroberfl√§che visualisieren.  Sie k√∂nnen die Daten filtern und spezifische √úberpr√ºfungen der Vorg√§nge in verschiedenen Zielen erstellen. </li><li>  <strong>Serviceerkennung</strong> .  Prometheus erkennt Ziele dynamisch und kratzt auf Anfrage automatisch neue Ziele.  Dies ist besonders praktisch, wenn Sie mit Containern arbeiten, die Adressen je nach Bedarf dynamisch √§ndern. </li></ul><br><p> <a href=""><img src="https://habrastorage.org/webt/vn/v8/hw/vnv8hwhdgfwge_zr4fpijo-dw6w.png"></a> </p><br><p><img src="https://habrastorage.org/webt/c0/i6/9g/c0i69gzbicfmvsaangv6g5-4jpa.png"></p><br><h2 id="chast-ii-koncepcii-prometheus">  Teil II  Prometheus-Konzepte </h2><br><p>  Wie im InfluxDB-Handbuch werden wir die <strong>technischen Begriffe</strong> zu Prometheus ausf√ºhrlich erl√§utern. </p><br><h3 id="1-model-dannyh-klyuch-znachenie">  1. Schl√ºsselwertdatenmodell </h3><br><p>  Bevor Sie mit den Prometheus-Tools fortfahren, ist es wichtig, dieses Datenmodell vollst√§ndig zu verstehen. </p><br><p>  Prometheus arbeitet mit <strong>Schl√ºssel-Wert-Paaren</strong> .  Der Schl√ºssel beschreibt, was wir messen, und der Wert speichert den tats√§chlichen Wert als Zahl. </p><br><blockquote>  Denken Sie daran: Prometheus ist nicht zum Speichern von Rohdaten wie einfachem Text vorgesehen.  Es speichert √ºber einen bestimmten Zeitraum aggregierte Metriken. </blockquote><p>  Der Schl√ºssel wird in diesem Fall als <strong>Metrik bezeichnet</strong> .  Dies ist beispielsweise die Prozessorgeschwindigkeit oder die Speichernutzung. </p><br><p>  <em>Aber was ist, wenn Sie weitere Details zur Metrik ben√∂tigen?</em> <em><br></em>  <em>Zum Beispiel hat der Prozessor 4 Kerne und wir brauchen 4 separate Metriken?</em> </p><br><p>  Und hier kommen Abk√ºrzungen zur Rettung.  Verkn√ºpfungen bieten weitere Informationen zu Metriken, indem Sie zus√§tzliche Felder hinzuf√ºgen.  Beispielsweise beschreiben Sie nicht nur die Geschwindigkeit des Prozessors, sondern auch die Geschwindigkeit eines Kerns √ºber eine bestimmte IP. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/k3/an/wz/k3anwzmbgecefriltntgwfkge3o.png"></a> </p><br><p>  Anschlie√üend k√∂nnen Sie die Metriken nach Beschriftungen filtern und nur die ben√∂tigten Informationen anzeigen. </p><br><h3 id="2-tipy-metrik">  2. Arten von Metriken </h3><br><p>  Bei der √úberwachung mit Prometheus k√∂nnen Metriken auf vier Arten beschrieben werden.  Es ist besser, es bis zum Ende zu lesen, da es hier <strong>Fallstricke</strong> gibt. </p><br><h3 id="schetchik">  Z√§hler </h3><br><p>  Dies ist wahrscheinlich die einfachste Art von Metrik.  Der Z√§hler z√§hlt, wie der Name schon sagt, <strong>die Elemente f√ºr einen bestimmten Zeitraum</strong> . </p><br><p>  Wenn Sie beispielsweise HTTP-Fehler auf Servern z√§hlen oder eine Website besuchen m√∂chten, verwenden Sie einen <strong>Z√§hler</strong> . </p><br><p>  Und logischerweise kann der <strong>Z√§hler</strong> nat√ºrlich <strong>nur die Zahl erh√∂hen oder auf Null setzen</strong> , daher ist er nicht f√ºr Werte geeignet, die abnehmen k√∂nnen, oder f√ºr negative Werte. </p><br><p>  Mit seiner Hilfe ist es besonders zweckm√§√üig, die <strong>Anzahl des Auftretens eines</strong> bestimmten Ereignisses √ºber einen Zeitraum zu ber√ºcksichtigen, d. H. Die √Ñnderungsrate der Metrik √ºber die Zeit. </p><br><p>  <em>Und wenn Sie beispielsweise den verwendeten Speicher f√ºr einen bestimmten Zeitraum messen m√ºssen?</em> <em><br></em>  <em>Dieser Wert kann abnehmen.</em>  <em>Wie z√§hlt man es mit Prometheus?</em> </p><br><h3 id="izmeriteli">  Meter </h3><br><p>  <strong>Treffen Sie die Meter!</strong> </p><br><p>  Z√§hler behandeln Werte, <strong>die mit der Zeit abnehmen k√∂nnen</strong> .  Sie k√∂nnen mit Thermometern verglichen werden. Wenn Sie sich das Thermometer ansehen, sehen wir die aktuelle Temperatur. </p><br><p>  <em>Aber wenn die Z√§hler zunehmen und abnehmen und positive und negative Werte annehmen k√∂nnen, stellt sich heraus, dass sie besser sind als Z√§hler?</em> <em><br></em>  <em>Also sind die Z√§hler nutzlos?</em> </p><br><p>  Zuerst dachte ich es mir.  Da sie alles k√∂nnen, verwenden wir sie √ºberall.  Ist es logisch? </p><br><h3 id="a-vot-i-net">  Aber nein. </h3><br><p>  Messger√§te sind ideal zum Messen des aktuellen Metrikwerts, der mit der Zeit abnehmen kann. </p><br><p>  Hier liegen die Fallstricke: Der Z√§hler zeigt nicht die Entwicklung der Metrik √ºber einen bestimmten Zeitraum an.  Mithilfe von Messger√§ten k√∂nnen <strong>Sie unregelm√§√üige √Ñnderungen der Metrik im Laufe der Zeit verpassen</strong> . </p><br><p>  Warum?  <em>Folgendes sagt / u / justinDavidow</em> : </p><br><blockquote>  ‚ÄûDas Messger√§t zeigt den Durchschnittswert des Z√§hlerdeltas f√ºr eine Einheit √ºber einen bestimmten Zeitraum an. <br><br>  Der Z√§hler ber√ºcksichtigt jede verwendete Einheit (wenn es sich um einen Prozessor handelt, dann Operationen, Zyklen oder Ticks), und Sie k√∂nnen dann ausw√§hlen, welche Indikatoren f√ºr welchen Zeitraum Sie ben√∂tigen. <br><br>  Wenn Sie ein Messger√§t verwenden, muss die Abtastrate genau sein.  Wenn sich die Frequenz um mindestens einige Mikrosekunden unterscheidet, ist der Wert unzuverl√§ssig.  "Dies macht sich unter starker Last noch deutlicher bemerkbar, wenn die Zeit zwischen den Messungen exponentiell zunimmt, da der Systemplaner keine Zeit hat, auf die √úberwachungsanwendung zu achten." </blockquote><p>  Wenn das System alle 5 Sekunden Metriken sendet und Prometheus das Ziel alle 15 Sekunden abkratzt, gehen m√∂glicherweise einige Metriken verloren.  Wenn Sie mit diesen Metriken zus√§tzliche Berechnungen durchf√ºhren, ist die Genauigkeit der Ergebnisse sogar noch geringer. </p><br><p>  Am Z√§hler wird jeder Wert aggregiert.  Wenn Prometheus es sammelt, stellt er fest, dass der Wert in einem bestimmten Intervall gesendet wurde. </p><br><p>  Jetzt nicht verwirren. </p><br><h3 id="gistogramma">  Balkendiagramm </h3><br><p>  Ein Histogramm ist eine komplexere Art von Metrik.  Es bietet zus√§tzliche Informationen.  Zum Beispiel die Summe der Messungen und ihre Anzahl. </p><br><p>  Die Werte werden in einem Bereich mit einer benutzerdefinierten Obergrenze erfasst.  Daher kann ein Histogramm: </p><br><ul><li>  <strong>Berechnen Sie Durchschnittswerte</strong> , d. H. Die Summe der Werte geteilt durch die Anzahl der Werte. </li><li>  <strong>Berechnen Sie relative Wertemessungen.</strong> Dies ist sehr praktisch, wenn Sie herausfinden m√∂chten, wie viele Werte in einem bestimmten Bereich den angegebenen Kriterien entsprechen.  Dies ist besonders n√ºtzlich, wenn Sie Proportionen verfolgen oder Qualit√§tsindikatoren festlegen m√ºssen. </li></ul><br><p>  In der realen Welt m√∂chte ich eine Warnung erhalten, wenn 20% meiner Server in mehr als 20% der F√§lle eine Antwort von mehr als 300 ms oder eine Serverantwort von mehr als 300 ms haben. </p><br><p>  Wenn Sie mit Proportionen zu tun haben, <strong>ben√∂tigen Sie Histogramme</strong> . </p><br><h3 id="svodki">  Zusammenfassung </h3><br><p>  Dashboards <strong>sind erweiterte Histogramme</strong> .  Sie zeigen auch die Summe und Anzahl der Messungen sowie <strong>Quantile f√ºr die Bewegungsperiode</strong> . </p><br><p>  Quantile teilen, wenn √ºberhaupt, die Wahrscheinlichkeitsdichte in Segmente gleicher Wahrscheinlichkeit. </p><br><p>  <em>Also: Balkendiagramme oder Zusammenfassungen?</em> </p><br><p>  Es h√§ngt alles von der <strong>Absicht ab</strong> . </p><br><p>  Histogramme kombinieren Werte √ºber einen bestimmten Zeitraum und geben die Menge und Menge an, anhand derer Sie die Entwicklung einer bestimmten Metrik verfolgen k√∂nnen. </p><br><p>  Die Zusammenfassungen zeigen andererseits Quantile √ºber einen sich bewegenden Zeitraum (d. H. Kontinuierliche Entwicklung √ºber die Zeit). </p><br><p>  Dies ist besonders praktisch, wenn Sie einen Wert kennen m√ºssen, der 95% der √ºber einen Zeitraum aufgezeichneten Werte darstellt. </p><br><h3 id="3-zadaniya-i-ekzemplyary">  3. Aufgaben und Instanzen </h3><br><p>  Angesichts der j√ºngsten Fortschritte bei verteilten Architekturen und der Beliebtheit von Cloud-basierten L√∂sungen ist es unwahrscheinlich, dass Sie einen einzelnen Server verwenden, der alleine ausgef√ºhrt wird. </p><br><p>  <strong>Server werden weltweit repliziert und verteilt.</strong> </p><br><p>  Schauen wir uns zur Veranschaulichung die klassische Architektur von zwei HAProxy-Servern an, die die Last auf neun Backend-Webserver verteilen ( <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nein, Nein, keine Stackoverflow-Stapel</a> ). </p><br><p>  In diesem Beispiel aus der Praxis verfolgen wir die <strong>Anzahl der von Webservern zur√ºckgegebenen HTTP-Fehler</strong> . </p><br><p>  In Prometheus wird ein Webserver als <strong>Instanz bezeichnet</strong> .  <strong>Die Aufgabe besteht</strong> darin, dass Sie die Anzahl der HTTP-Fehler in allen Instanzen messen. </p><br><p> <a href=""><img src="https://habrastorage.org/webt/3x/s4/n9/3xs4n94kpfhqg3igmcrlfjatube.png"></a> </p><br><p>  Das Sch√∂ne ist, dass Aufgaben und Instanzen Felder in Beschriftungen sind und Sie die Ergebnisse nach einer bestimmten Instanz oder Aufgabe filtern k√∂nnen. </p><br><h3 id="udobno-zhe">  Ist es bequem? </h3><br><h3 id="4-promql">  4. PromQL </h3><br><p>  Wenn Sie auf InfluxDB basierende Datenbanken verwenden, sind Sie wahrscheinlich bereits mit <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">InfluxQL</a> vertraut.  Oder verwenden Sie <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">SQL in TimescaleDB</a> . </p><br><p>  Prometheus hat auch eine eigene Sprache zum Abfragen und Abrufen von Daten von Servern: <strong>PromQL</strong> . </p><br><p>  Wie wir bereits wissen, werden Daten in Form von Schl√ºssel-Wert-Paaren dargestellt.  PromQL verwendet dieselbe Syntax und gibt Ergebnisse als Vektoren zur√ºck. </p><br><p>  <em>Welche Art von Vektoren?</em> </p><br><p>  Es gibt zwei Arten von Vektoren in Prometheus und PromQL: </p><br><ul><li>  <strong>Sofortvektoren</strong> , die alle Metriken nach dem letzten Zeitstempel darstellen. </li><li>  <strong>Vektoren mit einem Zeitbereich</strong> : Wenn Sie die Entwicklung einer Metrik im Zeitverlauf betrachten m√ºssen, k√∂nnen Sie in einer Anfrage an Prometheus einen Zeitbereich angeben.  Als Ergebnis erhalten Sie einen Vektor, der alle f√ºr den ausgew√§hlten Zeitraum aufgezeichneten Werte kombiniert. </li></ul><br><p> <a href=""><img src="https://habrastorage.org/webt/gs/ih/1_/gsih1_1lvftmhzgzuze3ctrlhci.png"></a> </p><br><p>  Die PromQL-API bietet eine Reihe von Funktionen f√ºr Operationen mit Daten in Abfragen. </p><br><p>  Sie k√∂nnen Werte sortieren, mathematische Funktionen auf sie anwenden (z. B. Ableitungen oder Exponenten berechnen) und sogar Vorhersagen treffen (z. B. mithilfe des Holt-Winters-Modells). </p><br><h3 id="5-instrumentirovanie">  5. Instrumentierung </h3><br><p>  <strong>Instrumentierung</strong> ist ein weiterer wichtiger Bestandteil von Prometheus.  Sie instrumentieren Anwendungen, bevor Sie Daten daraus extrahieren. </p><br><p>  In Prometheus bedeutet Instrumentierung das Hinzuf√ºgen von Clientbibliotheken zur Anwendung, um Prometheus-Metriken bereitzustellen. </p><br><p>  Die Instrumentierung ist f√ºr die meisten g√§ngigen Programmiersprachen verf√ºgbar: z. B. <strong>Python, Java, Ruby, Go und sogar Node oder C #</strong> . </p><br><p>  Im Wesentlichen erstellen Sie Speicherobjekte (z. B. Z√§hler oder Z√§hler), die den Wert dynamisch erh√∂hen oder verringern. </p><br><p>  Anschlie√üend w√§hlen Sie aus, wo die Metriken bereitgestellt werden sollen.  Prometheus holt sie von dort ab und speichert sie in ihrer Zeitreihendatenbank. </p><br><p><img src="https://habrastorage.org/webt/xi/-u/xk/xi-uxkqvgontz2729o5rmroyxkk.png"></p><br><h3 id="6-eksportery">  6. Exporteure </h3><br><p>  In den von Ihnen geschriebenen Anwendungen ist es sehr praktisch, die bereitgestellten Metriken anzupassen und sie mithilfe von Instrumenten im Laufe der Zeit zu √§ndern. </p><br><p>  F√ºr bekannte Anwendungen, Server und Datenbanken <strong>bietet Prometheus Exporteure, mit denen Sie Ziele √ºberwachen k√∂nnen</strong> . </p><br><p>  Diese Exporteure werden normalerweise als Docker-Images dargestellt und k√∂nnen einfach angepasst werden.  Sie bieten einen vorgefertigten Satz von Metriken und h√§ufig vorgefertigte Dashboards, mit denen Sie die √úberwachung in wenigen Minuten konfigurieren k√∂nnen. </p><br><p>  Beispiele f√ºr Exporteure: </p><br><ul><li>  <strong>Datenbankexporteure</strong> : f√ºr MongoDB-Datenbanken, SQL- und MySQL-Server. </li><li>  <strong>HTTP-Exporteure</strong> : f√ºr HAProxy-, Apache- oder NGINX-Server. </li><li>  <strong>Unix-Exporteure</strong> : Die Systemleistung kann mithilfe der integrierten Knotenexporteure √ºberwacht werden, die alle Systemmetriken ohne zus√§tzliche Konfiguration bereitstellen. </li></ul><br><p><img src="https://habrastorage.org/webt/7q/fm/uh/7qfmuhfszdwxa-k21na-hpko3tk.png"></p><br><h3 id="para-slov-o-vzaimnoy-sovmestimosti">  Ein paar Worte zur gegenseitigen Kompatibilit√§t </h3><br><p>  Die meisten Zeitreihendatenbanken unterst√ºtzen die Interoperabilit√§t ihrer Systeme. </p><br><p>  Prometheus ist nicht das einzige √úberwachungssystem mit seinen metrischen Anforderungen.  Zum Beispiel haben <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">InfluxDB</a> (√ºber Telegraf), <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">CollectD</a> , <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">StatsD</a> und <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Nagios</a> auch ihre eigenen Standards. </p><br><p>  Daher werden f√ºr das Zusammenspiel verschiedener Systeme Exporteure geschaffen.  Selbst wenn Telegraf keine Metriken in dem von Prometheus akzeptierten Format sendet, kann Telegraf diese Metriken an den InfluxDB-Exporter senden, von dem Prometheus sie dann abholt. </p><br><h3 id="7-opovescheniya">  7. Warnungen </h3><br><p>  Wenn Sie mit Zeitreihendatenbanken arbeiten, ben√∂tigen Sie Feedback von den Daten, und Alert Manager sind daf√ºr verantwortlich. </p><br><p>  In Grafana sind Warnungen h√§ufig, sie sind jedoch auch in Prometheus √ºber den Warnungsmanager verf√ºgbar. </p><br><p>  <strong>Alert Manager ist ein separates Tool, das Prometheus beitritt und benutzerdefinierte Sirenen startet</strong> . </p><br><p>  Warnungen werden in der <strong>Konfigurationsdatei</strong> definiert und definieren eine Reihe von Regeln f√ºr Metriken.  Wenn die Regel in der Zeitreihe eingehalten wird, wird eine Warnung ausgel√∂st und an die angegebenen Empf√§nger gesendet. </p><br><p>  Wie in Grafana k√∂nnen Sie die E-Mail-Adresse, den <strong>Slack-Webhook, PagerDuty und benutzerdefinierte HTTP-Objekte</strong> als Empf√§nger angeben. </p><br><p><img src="https://habrastorage.org/webt/0x/xz/gf/0xxzgfpfufej_ro_ztjded5lbys.png"></p><br><h2 id="chast-iii-primery-ispolzovaniya-prometheus">  Teil III.  Prometheus Beispiele </h2><br><p><img src="https://habrastorage.org/webt/rq/6r/zk/rq6rzkeqnwe2xhzpukzx-hjdgi0.png"></p><br><p>  Und nat√ºrlich sollte jeder Leitfaden <strong>praktische Beispiele haben</strong> .  Wie ich gerne sagen m√∂chte, ist Technologie kein Selbstzweck und sollte eine bestimmte Aufgabe erf√ºllen. </p><br><p>  Wir werden dar√ºber reden. </p><br><h2 id="1-devops">  1. DevOps </h2><br><p>  Bei all diesen Exporteuren f√ºr verschiedene Systeme, Datenbanken und Server ist es offensichtlich, dass Prometheus haupts√§chlich f√ºr die <strong>DevOps-Industrie bestimmt ist</strong> . </p><br><p>  Wir wissen, dass es in diesem Bereich viele konkurrierende Lieferanten und personalisierte L√∂sungen gibt. </p><br><p>  <strong>Prometheus ist perfekt f√ºr DevOps.</strong> </p><br><p>  Das Einrichten und Ausf√ºhren von Instanzen ist nahezu m√ºhelos und Sie k√∂nnen jedes Hilfstool einfach aktivieren und konfigurieren. </p><br><p>  Durch die <strong>Erkennung von Zielen</strong> - <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">beispielsweise √ºber einen Dateiexporter</a> - ist dies eine hervorragende L√∂sung f√ºr Stapel, in denen Container und verteilte Architekturen weit verbreitet sind. </p><br><p>  In einer Umgebung, in der st√§ndig Instanzen erstellt und gel√∂scht werden, kann kein einziger DevOps-Stack auf die <strong>Serviceerkennung verzichten</strong> . </p><br><h3 id="2-zdravoohranenie">  2. Gesundheit </h3><br><p>  √úberwachungsl√∂sungen werden heute nicht nur in der IT ben√∂tigt.  Sie werden auch in gro√üen Branchen eingesetzt, die flexible und skalierbare Gesundheitsarchitekturen bereitstellen. </p><br><p>  Die Nachfrage w√§chst und IT-Architekturen m√ºssen diese erf√ºllen.  Wenn Sie nicht √ºber ein zuverl√§ssiges Tool zur √úberwachung der gesamten Infrastruktur verf√ºgen, besteht <strong>die Gefahr schwerwiegender Betriebsunterbrechungen</strong> .  Bereits im Gesundheitsbereich muss eine solche Gefahr unbedingt minimiert werden. </p><br><p>  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dieses Beispiel wurde im folgenden Artikel unter opensource.com erl√§utert</a> . </p><br><h3 id="3-finansovye-uslugi">  3. Finanzdienstleistungen </h3><br><p>  Das j√ºngste Beispiel wurde auf der InfoQ-Konferenz gegeben, auf der die Verwendung von Prometheus in Finanzinstituten er√∂rtert wurde. </p><br><p>  Jamie Christian und Alan Strader zeigen, wie sie Prometheus verwenden, um ihre Infrastruktur bei Northern Trust zu √ºberwachen.  Sehr informativ, ich rate Ihnen zu schauen. </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/_WQ9DSanFdw" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h2 id="chast-x-chto-dalshe">  Teil X. Wie geht es weiter? </h2><br><p><img src="https://habrastorage.org/webt/mt/c6/ox/mtc6oxvnw8qk4fijh1ihciosuwy.png"></p><br><p>  Es ist Zeit, von der <strong>Theorie</strong> zur <strong>Praxis √ºberzugehen</strong> . </p><br><p>  Heute haben Sie die Grundlagen von Prometheus kennengelernt, gelernt, welche Funktionen es ausf√ºhrt, mit welchen Tools und Systemen es arbeitet und welche Begriffe es verwendet. </p><br><p>  Jetzt haben <strong>Sie alles, was Sie zum Erstellen Ihrer √úberwachungsl√∂sung ben√∂tigen</strong> . </p><br><p>  Um mit Prometheus zu beginnen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">studieren Sie alle verf√ºgbaren Exporteure</a> . </p><br><p>  Installieren Sie dann die erforderlichen Tools, erstellen Sie Ihr erstes Dashboard - und los geht's! </p><br><p>  Wenn Sie Inspiration ben√∂tigen, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">lesen Sie meinen Artikel √ºber die √úberwachung eines Linux-Computers mit Prometheus und Grafana</a> .  Es gibt Anweisungen zum Einrichten von Tools und des ersten Dashboards. </p><br><p>  Ich hoffe du hast etwas Neues gelernt. </p><br><p>  Wenn Sie ein Thema f√ºr meinen n√§chsten Artikel haben, teilen Sie es. </p><br><p>  <strong>Gerne bleiben!</strong> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de455290/">https://habr.com/ru/post/de455290/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de455272/index.html">TheOutloud - Sprechen Sie und teilen Sie Ihre Lieblingsartikel und -geschichten.</a></li>
<li><a href="../de455280/index.html">Antwort des Psychiaters auf den Artikel "Krank-gesund"</a></li>
<li><a href="../de455284/index.html">Alexey Savvateev und die Spieltheorie: "Wie hoch ist die Wahrscheinlichkeit, dass eine Atombombe in den n√§chsten f√ºnf Jahren abgeworfen wird?"</a></li>
<li><a href="../de455286/index.html">Z√§hne der Weisheit: k√∂nnen nicht entfernt werden</a></li>
<li><a href="../de455288/index.html">Nachrichten der Woche: Werbeblocker f√ºr Unternehmen mit Chrome-, FSB- und Yandex-Verschl√ºsselungsschl√ºsseln, Kommunikation wird immer teurer</a></li>
<li><a href="../de455292/index.html">So erh√∂hen Sie die Laufzeit von Ger√§ten mit eigener Stromversorgung um das Vierfache</a></li>
<li><a href="../de455302/index.html">Golang API Framework</a></li>
<li><a href="../de455306/index.html">Antworten auf Ihre Fragen, warum Sie einen Verlag ben√∂tigen, um ein Buch zu ver√∂ffentlichen</a></li>
<li><a href="../de455308/index.html">Vielversprechender Ort</a></li>
<li><a href="../de455310/index.html">Angriffe auf Bypass-Kan√§le: Jetzt werden nicht nur PCs, sondern auch Smartphones angegriffen (analytische √úberpr√ºfung)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>