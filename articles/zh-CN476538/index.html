<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>👩🏽 🥥 👐🏿 非对称密码密钥分发协议：Denning — Sacco，DASS，Wu Lama 🕎 👩🏻‍✈️ 💶</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="前言  该文本将是无线电工程和控制系统部信息保护手册以及此培训代码中MIPT（GU）信息保护手册的重写章节之一。 完整的教程可在github上找到 （另请参阅草稿发行版 ）。 我计划在Habrir上载新的“大型”文章，首先，收集有用的评论和意见，其次，为社区提供更多有关有用和有趣主题的概述材料。 “...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>非对称密码密钥分发协议：Denning — Sacco，DASS，Wu Lama</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476538/"><div class="spoiler">  <b class="spoiler_title">前言</b> <div class="spoiler_text"><blockquote> 该文本将是无线电工程和控制系统部信息保护手册以及此培训代码中MIPT（GU）信息保护手册的重写章节之一。 完整的教程可在<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">github上找到</a> （另请参阅<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">草稿发行版</a> ）。 我计划在Habrir上载新的“大型”文章，首先，收集有用的评论和意见，其次，为社区提供更多有关有用和有趣主题的概述材料。  “加密协议”一章的前面各节： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">1、2、3、4、5</a> ； 接下来的顺序： <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">7</a> 。 </blockquote></div></div><br> 非对称协议或基于具有公共密钥的密码系统的协议可能会削弱对协议初始阶段的要求。 在下面考虑的协议中，代替双方必须具有的共享密钥（双方和受信任的中心），双方必须首先（在彼此之间或与受信任的中心之间）交换公共密钥。 在密码分析者在此阶段不能影响通信信道的内容的假设下，这种初步交换可以在开放的通信信道上进行。 <br><a name="habracut"></a><br><h3> 加密协议— Sacco </h3><br> 该协议由Dorothy Denning和Giovanni Sacco在1981年提出（英语： <i>Dorothy E. Denning，Giovanni Maria Sacco</i> ）。 在此协议中，发起方（Alice）立即向受信任中心（Trent）寻求双方参与者的证书。 同一参与者还负责新会话密钥的形成。 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> K </script>  。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/p0/rf/tw/p0rftwtvnoyulp-t2tzp9ss5dre.png" alt="    —" title="Denning – Sacco协议中的参与者交互"></div><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>&amp;#x7231;&amp;#x4E3D;&amp;#x4E1D;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{A&amp;#xFF0C;B&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">爱丽丝\到\左\&nbsp;{A，B&nbsp;\右\}&nbsp;\到Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>爱丽丝\到\左\&nbsp;{A，B&nbsp;\右\}&nbsp;\到Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-2">爱丽丝\到\左\ {A，B \右\} \到Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{S_T&amp;#xFF08;A&amp;#xFF0C;K_A&amp;#xFF0C;T_T&amp;#xFF09;&amp;#xFF0C;S_T&amp;#xFF08;B&amp;#xFF0C;K_B&amp;#xFF0C;T_T&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\到\左\&nbsp;{S_T（A，K_A，T_T），S_T（B，K_B，T_T）\右\}&nbsp;\到Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\到\左\&nbsp;{S_T（A，K_A，T_T），S_T（B，K_B，T_T）\右\}&nbsp;\到Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-3"> Trent \到\左\ {S_T（A，K_A，T_T），S_T（B，K_B，T_T）\右\} \到Alice </script></li><li> 爱丽丝产生一个新的会话密钥 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> K </script><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>\&amp;#xA0;begin&amp;#xA0;{array}&amp;#xA0;{lll}&amp;#xA0;Alice&amp;#xA0;\&amp;#x5230;\&amp;#xA0;{&amp;#xFF06;E_B&amp;#xFF08;S_A&amp;#xFF08;K&amp;#xFF0C;T_A&amp;#xFF09;&amp;#xFF09;&amp;#xFF0C;&amp;#xFF06;\\&amp;#xFF06;S_T&amp;#xFF08;A&amp;#xFF0C;K_A&amp;#xFF0C;T_T&amp;#xFF09;&amp;#xFF0C;&amp;#xFF06;\\&amp;#xFF06;S_T&amp;#xFF08;B&amp;#xFF0C;K_B&amp;#xFF0C;T_T&amp;#xFF09;&amp;#xA0;&amp;#xFF06;\}&amp;#xA0;\&amp;#x5230;Bob&amp;#xA0;\&amp;#xA0;end&amp;#xA0;{array}</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">\&nbsp;begin&nbsp;{array}&nbsp;{lll}&nbsp;Alice&nbsp;\到\&nbsp;{＆E_B（S_A（K，T_A）），＆\\＆S_T（A，K_A，T_T），＆\\＆S_T（B，K_B，T_T）&nbsp;＆\}&nbsp;\到Bob&nbsp;\&nbsp;end&nbsp;{array}</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>\&nbsp;begin&nbsp;{array}&nbsp;{lll}&nbsp;Alice&nbsp;\到\&nbsp;{＆E_B（S_A（K，T_A）），＆\\＆S_T（A，K_A，T_T），＆\\＆S_T（B，K_B，T_T）&nbsp;＆\}&nbsp;\到Bob&nbsp;\&nbsp;end&nbsp;{array}</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-5"> \ begin {array} {lll} Alice \到\ {＆E_B（S_A（K，T_A）），＆\\＆S_T（A，K_A，T_T），＆\\＆S_T（B，K_B，T_T） ＆\} \到Bob \ end {array} </script></li><li>  Bob验证证书上的信任中心签名 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>S</mi><mi>T</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mi>K</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mi>T</mi><mi>T</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.453ex" height="2.419ex" viewBox="0 -780.1 7944.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="867" y="-213"></use><g transform="translate(1211,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="2041" y="0"></use><g transform="translate(2792,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(3622,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="1201" y="-230"></use></g><g transform="translate(5102,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(5932,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="826" y="-213"></use></g><g transform="translate(7114,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>T</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mi>K</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mi>T</mi><mi>T</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-6"> S_T（A，K_A，T_T）</script> 解密会话密钥 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> K </script> 并验证爱丽丝的签名。 </li></ol><br> 遗失讯息 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>B</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><msub><mi>S</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mi>T</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.611ex" height="2.419ex" viewBox="0 -780.1 8874.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-42" x="1044" y="-213"></use><g transform="translate(1375,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(2205,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="867" y="-230"></use></g><g transform="translate(3449,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="4279" y="0"></use><g transform="translate(5169,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(5999,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="826" y="-230"></use></g><g transform="translate(7214,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(8044,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>B</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><msub><mi>S</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mi>T</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-8"> E_B（S_A（K，T_A））</script> 任何标识符都会使协议容易受到已知会话密钥的攻击，并允许第二方（Bob）在与第三方（Clara）的会话中模拟发起方（Alice）。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/-c/g3/1g/-cg31g6tvdvr_xju_y_lpdrdove.png" alt="    —" title="Denning – Sacco协议中的参与者交互"></div><br><ol><li> 爱丽丝和鲍勃进行了协议会话，生成了新的会话密钥 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> K </script>  。 </li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{B&amp;#xFF0C;C&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\到\左\&nbsp;{B，C&nbsp;\右\}&nbsp;\到Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\到\左\&nbsp;{B，C&nbsp;\右\}&nbsp;\到Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-10"> Bob \到\左\ {B，C \右\} \到Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{S_T&amp;#xFF08;B&amp;#xFF0C;K_B&amp;#xFF0C;T_T&amp;#xFF09;&amp;#xFF0C;S_T&amp;#xFF08;C&amp;#xFF0C;K_C&amp;#xFF0C;T_T&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\到\左\&nbsp;{S_T（B，K_B，T_T），S_T（C，K_C，T_T）\右\}&nbsp;\到Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\到\左\&nbsp;{S_T（B，K_B，T_T），S_T（C，K_C，T_T）\右\}&nbsp;\到Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-11"> Trent \到\左\ {S_T（B，K_B，T_T），S_T（C，K_C，T_T）\右\} \到Bob </script></li><li> 鲍勃播放消息 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>S</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mi>T</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.561ex" height="2.419ex" viewBox="0 -780.1 5838.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="867" y="-230"></use><g transform="translate(1244,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="2074" y="0"></use><g transform="translate(2963,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(3793,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="826" y="-230"></use></g><g transform="translate(5008,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mi>T</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-12"> S_A（K，T_A）</script> 和 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>S</mi><mi>T</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mi>K</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mi>T</mi><mi>T</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.453ex" height="2.419ex" viewBox="0 -780.1 7944.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="867" y="-213"></use><g transform="translate(1211,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="2041" y="0"></use><g transform="translate(2792,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(3622,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="1201" y="-230"></use></g><g transform="translate(5102,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(5932,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="826" y="-213"></use></g><g transform="translate(7114,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>T</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mi>K</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mi>T</mi><mi>T</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-13"> S_T（A，K_A，T_T）</script> 爱丽丝与克拉拉的一次对话中： <br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>\&amp;#x5F00;&amp;#x59CB;{array}&amp;#xA0;{lll}&amp;#xA0;Bob&amp;#x301C;&amp;#xFF08;Alice&amp;#xFF09;\&amp;#x5230;\&amp;#xA0;{&amp;#xFF06;E_C&amp;#xFF08;S_A&amp;#xFF08;K&amp;#xFF0C;T_A&amp;#xFF09;&amp;#xFF09;&amp;#xFF0C;&amp;#xFF06;\\&amp;#xFF06;S_T&amp;#xFF08;A&amp;#xFF0C;K_A&amp;#xFF0C;T_T&amp;#xFF09;&amp;#xFF0C;&amp;#xFF06;\\&amp;#xFF06;S_T&amp;#xFF08;C&amp;#xFF0C;&amp;#xA0;K_C&amp;#xFF0C;T_T&amp;#xFF09;&amp;#xFF06;\}&amp;#xA0;\&amp;#x5230;Clara&amp;#xA0;\&amp;#x7ED3;&amp;#x5C3E;{array}</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">\开始{array}&nbsp;{lll}&nbsp;Bob〜（Alice）\到\&nbsp;{＆E_C（S_A（K，T_A）），＆\\＆S_T（A，K_A，T_T），＆\\＆S_T（C，&nbsp;K_C，T_T）＆\}&nbsp;\到Clara&nbsp;\结尾{array}</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>\开始{array}&nbsp;{lll}&nbsp;Bob〜（Alice）\到\&nbsp;{＆E_C（S_A（K，T_A）），＆\\＆S_T（A，K_A，T_T），＆\\＆S_T（C，&nbsp;K_C，T_T）＆\}&nbsp;\到Clara&nbsp;\结尾{array}</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-14"> \开始{array} {lll} Bob〜（Alice）\到\ {＆E_C（S_A（K，T_A）），＆\\＆S_T（A，K_A，T_T），＆\\＆S_T（C， K_C，T_T）＆\} \到Clara \结尾{array} </script></li><li>  Clara成功验证了证书上受信任中心的签名 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>S</mi><mi>T</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mi>K</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mi>T</mi><mi>T</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.453ex" height="2.419ex" viewBox="0 -780.1 7944.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="867" y="-213"></use><g transform="translate(1211,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="2041" y="0"></use><g transform="translate(2792,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(3622,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="1201" y="-230"></use></g><g transform="translate(5102,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(5932,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="826" y="-213"></use></g><g transform="translate(7114,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>T</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mi>K</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mi>T</mi><mi>T</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-15"> S_T（A，K_A，T_T）</script> 解密会话密钥 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-16"> K </script> 并验证爱丽丝的签名。 </li></ol><br> 结果，Clara确保她从Alice那里收到了新的会话密钥。 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-17"> K </script>  。 <br><br><h3>  DASS协议 </h3><br>  DASS协议是DEC开发并在1993年9月的RFC 1507中描述的<i>分布式身份验证安全服务</i> （DASS）的组成部分。 <br><br> 在DASS协议中，类似于“广口蛙”和“ Denning – Sacco”协议，发起者（Alice）会生成一个新的会话密钥，并为每个协议会话生成一对新的发送者公钥和私钥。 可信中心（Trent）用作参与者的公共密钥证书的存储库。 但是与Denning-Sacco不同，两个参与者都依次转到受信任的中心。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/gq/xx/2_/gqxx2_osmgsg2pojlar2asvjnwm.png" alt="    DASS" title="DASS协议中参与者的交互"></div><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>&amp;#x7231;&amp;#x4E3D;&amp;#x4E1D;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{B&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">爱丽丝\到\左\&nbsp;{B&nbsp;\右\}&nbsp;\到Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>爱丽丝\到\左\&nbsp;{B&nbsp;\右\}&nbsp;\到Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-18">爱丽丝\到\左\ {B \右\} \到Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{S_T&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;B&amp;#xFF0C;K_B&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\到\左\&nbsp;{S_T&nbsp;\左（B，K_B&nbsp;\右）\右\}&nbsp;\到Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\到\左\&nbsp;{S_T&nbsp;\左（B，K_B&nbsp;\右）\右\}&nbsp;\到Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-19"> Trent \到\左\ {S_T \左（B，K_B \右）\右\} \到Alice </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>&amp;#x7231;&amp;#x4E3D;&amp;#x4E1D;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;T_A&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;&amp;#xFF0C;S_A&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;L&amp;#xFF0C;A&amp;#xFF0C;K_P&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;&amp;#xFF0C;S_&amp;#xA0;{K_P}&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;E_B&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;K&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;\&amp;#x53F3;&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x7ED9;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">爱丽丝\到\左\&nbsp;{E_K&nbsp;\左（T_A&nbsp;\右），S_A&nbsp;\左（L，A，K_P&nbsp;\右），S_&nbsp;{K_P}&nbsp;\左（E_B&nbsp;\左（K&nbsp;\右）\右）\右\}&nbsp;\给Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>爱丽丝\到\左\&nbsp;{E_K&nbsp;\左（T_A&nbsp;\右），S_A&nbsp;\左（L，A，K_P&nbsp;\右），S_&nbsp;{K_P}&nbsp;\左（E_B&nbsp;\左（K&nbsp;\右）\右）\右\}&nbsp;\给Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-20">爱丽丝\到\左\ {E_K \左（T_A \右），S_A \左（L，A，K_P \右），S_ {K_P} \左（E_B \左（K \右）\右）\右\} \给Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{A&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\到\左\&nbsp;{A&nbsp;\右\}&nbsp;\到Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\到\左\&nbsp;{A&nbsp;\右\}&nbsp;\到Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-21"> Bob \到\左\ {A \右\} \到Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{S_T&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;A&amp;#xFF0C;K_A&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\到\左\&nbsp;{S_T&nbsp;\左（A，K_A&nbsp;\右）\右\}&nbsp;\到Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\到\左\&nbsp;{S_T&nbsp;\左（A，K_A&nbsp;\右）\右\}&nbsp;\到Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-22"> Trent \到\左\ {S_T \左（A，K_A \右）\右\} \到Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#x81F3;\&amp;#x5DE6;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#x5DE6;\&amp;#xA0;{T_B&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x81F3;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\至\左\&nbsp;{E_K&nbsp;\左\&nbsp;{T_B&nbsp;\右\}&nbsp;\右\}&nbsp;\至Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\至\左\&nbsp;{E_K&nbsp;\左\&nbsp;{T_B&nbsp;\右\}&nbsp;\右\}&nbsp;\至Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-23"> Bob \至\左\ {E_K \左\ {T_B \右\} \右\} \至Alice </script></li></ol><br> 使用公钥证书 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>\&amp;#x5DE6;\&amp;#xA0;{S_T&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;B&amp;#xFF0C;K_B&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;\&amp;#x53F3;\}</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">\左\&nbsp;{S_T&nbsp;\左（B，K_B&nbsp;\右）\右\}</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>\左\&nbsp;{S_T&nbsp;\左（B，K_B&nbsp;\右）\右\}</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-24"> \左\ {S_T \左（B，K_B \右）\右\} </script> 和 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>\&amp;#x5DE6;\&amp;#xA0;{S_T&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;A&amp;#xFF0C;K_A&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;\&amp;#x53F3;\}</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">\左\&nbsp;{S_T&nbsp;\左（A，K_A&nbsp;\右）\右\}</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>\左\&nbsp;{S_T&nbsp;\左（A，K_A&nbsp;\右）\右\}</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-25"> \左\ {S_T \左（A，K_A \右）\右\} </script>  Trent发送，并进一步确认相应密钥的所有权，参与者可以彼此进行身份验证。 成功解密消息中的时间戳 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>K</mi></msub><mtext mathcolor=&quot;red&quot;>\&amp;#x5DE6;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><msub><mi>T</mi><mi>A</mi></msub><mtext mathcolor=&quot;red&quot;>\&amp;#x53F3;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.266ex" height="2.66ex" viewBox="0 -832 7003.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="1044" y="-213"></use><g fill="red" stroke="red" transform="translate(1467,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">左</text></g></g><g transform="translate(2797,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(3627,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="826" y="-230"></use></g><g fill="red" stroke="red" transform="translate(4843,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">右</text></g></g><g transform="translate(6173,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>K</mi></msub><mtext mathcolor="red">\左</mtext><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><msub><mi>T</mi><mi>A</mi></msub><mtext mathcolor="red">\右</mtext><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-26"> E_K \左（T_A \右）</script> 和 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>E_K&amp;#xA0;\&amp;#x5DE6;\&amp;#xA0;{T_B&amp;#xA0;\&amp;#x53F3;\}</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">E_K&nbsp;\左\&nbsp;{T_B&nbsp;\右\}</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>E_K&nbsp;\左\&nbsp;{T_B&nbsp;\右\}</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-27"> E_K \左\ {T_B \右\} </script> 提供会话密钥的所有权证明。 <br><br> 该协议使用生存期（ <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-28"> L </script>  ）会话密钥 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>K</mi><mi>P</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.44ex" height="2.298ex" viewBox="0 -780.1 1480.9 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-50" x="1201" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>P</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-29"> K_P </script> 但是时间戳不包括在消息中。 结果，该协议仍然容易受到具有已知会话密钥的攻击。 假设Mellory能够记录Alice和Bob之间过去的完整通信会话，然后能够访问该会话密钥 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-30"> K </script>  。 这使Mellory在Bob面前将自己认证为Alice。 <br><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Mellory&amp;#x301C;&amp;#xFF08;Alice&amp;#xFF09;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;T_M&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;&amp;#xFF0C;S_A&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;L&amp;#xFF0C;A&amp;#xFF0C;K_P&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;&amp;#xFF0C;S_&amp;#xA0;{K_P}&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;E_B&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;K&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;\&amp;#x53F3;&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Mellory〜（Alice）\到\左\&nbsp;{E_K&nbsp;\左（T_M&nbsp;\右），S_A&nbsp;\左（L，A，K_P&nbsp;\右），S_&nbsp;{K_P}&nbsp;\左（E_B&nbsp;\左（K&nbsp;\右）\右）\右\}&nbsp;\到Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Mellory〜（Alice）\到\左\&nbsp;{E_K&nbsp;\左（T_M&nbsp;\右），S_A&nbsp;\左（L，A，K_P&nbsp;\右），S_&nbsp;{K_P}&nbsp;\左（E_B&nbsp;\左（K&nbsp;\右）\右）\右\}&nbsp;\到Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-31"> Mellory〜（Alice）\到\左\ {E_K \左（T_M \右），S_A \左（L，A，K_P \右），S_ {K_P} \左（E_B \左（K \右）\右）\右\} \到Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{A&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\到\左\&nbsp;{A&nbsp;\右\}&nbsp;\到Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\到\左\&nbsp;{A&nbsp;\右\}&nbsp;\到Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-32"> Bob \到\左\ {A \右\} \到Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{S_T&amp;#xA0;\&amp;#x5DE6;&amp;#xFF08;A&amp;#xFF0C;K_A&amp;#xA0;\&amp;#x53F3;&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\到\左\&nbsp;{S_T&nbsp;\左（A，K_A&nbsp;\右）\右\}&nbsp;\到Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\到\左\&nbsp;{S_T&nbsp;\左（A，K_A&nbsp;\右）\右\}&nbsp;\到Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-33"> Trent \到\左\ {S_T \左（A，K_A \右）\右\} \到Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#x81F3;\&amp;#x5DE6;\&amp;#xA0;{E_K&amp;#xA0;\&amp;#x5DE6;\&amp;#xA0;{T_B&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x81F3;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\至\左\&nbsp;{E_K&nbsp;\左\&nbsp;{T_B&nbsp;\右\}&nbsp;\右\}&nbsp;\至Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\至\左\&nbsp;{E_K&nbsp;\左\&nbsp;{T_B&nbsp;\右\}&nbsp;\右\}&nbsp;\至Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-34"> Bob \至\左\ {E_K \左\ {T_B \右\} \右\} \至Alice </script></li></ol><br> 在第一遍中，Mellory仅更改包含时间戳的第一条消息 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>K</mi></msub><mtext mathcolor=&quot;red&quot;>\&amp;#x5DE6;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><msub><mi>T</mi><mi>M</mi></msub><mtext mathcolor=&quot;red&quot;>\&amp;#x53F3;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.761ex" height="2.66ex" viewBox="0 -832 7216.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="1044" y="-213"></use><g fill="red" stroke="red" transform="translate(1467,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">左</text></g></g><g transform="translate(2797,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(3627,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4D" x="826" y="-213"></use></g><g fill="red" stroke="red" transform="translate(5055,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">右</text></g></g><g transform="translate(6386,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>K</mi></msub><mtext mathcolor="red">\左</mtext><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><msub><mi>T</mi><mi>M</mi></msub><mtext mathcolor="red">\右</mtext><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-35"> E_K \左（T_M \右）</script>  。  Mellory从录制的会话中复制其余部分。 如果鲍勃没有记录使用的密钥，他将不会注意到欺骗。 解决此漏洞的最简单方法是在消息中包含时间戳。 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>S</mi><mi>A</mi></msub><mtext mathcolor=&quot;red&quot;>\&amp;#x5DE6;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><msub><mi>T</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>L</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mi>K</mi><mi>P</mi></msub><mtext mathcolor=&quot;red&quot;>\&amp;#x53F3;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.296ex" height="2.66ex" viewBox="0 -832 12183.1 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="867" y="-230"></use><g fill="red" stroke="red" transform="translate(1244,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">左</text></g></g><g transform="translate(2574,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(3404,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="826" y="-230"></use></g><g transform="translate(4619,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4C" x="5449" y="0"></use><g transform="translate(6131,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="6961" y="0"></use><g transform="translate(7711,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(8541,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-50" x="1201" y="-213"></use></g><g fill="red" stroke="red" transform="translate(10022,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">右</text></g></g><g transform="translate(11353,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>A</mi></msub><mtext mathcolor="red">\左</mtext><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><msub><mi>T</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>L</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mi>K</mi><mi>P</mi></msub><mtext mathcolor="red">\右</mtext><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-36"> S_A \左（T_A，L，A，K_P \右）</script>  。 <br><br> 由于会话密钥在协议中 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-37"> K </script> 通过“主”密钥Bob加密 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>K</mi><mi>B</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.453ex" height="2.298ex" viewBox="0 -780.1 1486.5 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-42" x="1201" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>B</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-38"> K_B </script>  ，那么后者的妥协将导致所有先前使用的会话密钥受到损害。 也就是说，该协议不能提供完美的直接保密性（目标G9）。 <br><br>  Trent和Bob都不参与新会话密钥的形成。 因此，爱丽丝可以像宽口蛙和Yahalom协议中一样，强迫鲍勃使用旧的会话密钥。 <br><br><h3> 吴喇嘛议定书 </h3><br> 于1992年提出的Wu-Lama协议（ <i>Thomas YC Woo，Simon S. Lam</i> ）向消息中添加了随机参与者，从而保护了该协议，包括防止重复攻击，并提供了密钥所有权的确认。 它也是本节中考虑的唯一协议，其中受信方（Trent）会生成新密钥。 <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/fs/us/qs/fsusqsxns0rpujahnfrh3l7bltm.png" alt="    —" title="Wu-Lama协议参与者的互动"></div><br><ol><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>&amp;#x7231;&amp;#x4E3D;&amp;#x4E1D;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{A&amp;#xFF0C;B&amp;#xA0;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">爱丽丝\到\左\&nbsp;{A，B&nbsp;\右\}&nbsp;\到Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>爱丽丝\到\左\&nbsp;{A，B&nbsp;\右\}&nbsp;\到Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-39">爱丽丝\到\左\ {A，B \右\} \到Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{S_T&amp;#xFF08;K_B&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\到\左\&nbsp;{S_T（K_B）\右\}&nbsp;\到Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\到\左\&nbsp;{S_T（K_B）\右\}&nbsp;\到Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-40"> Trent \到\左\ {S_T（K_B）\右\} \到Alice </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>&amp;#x7231;&amp;#x4E3D;&amp;#x4E1D;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{E_B&amp;#xFF08;A&amp;#xFF0C;R_A&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">爱丽丝\到\左\&nbsp;{E_B（A，R_A）\右\}&nbsp;\到Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>爱丽丝\到\左\&nbsp;{E_B（A，R_A）\右\}&nbsp;\到Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-41">爱丽丝\到\左\ {E_B（A，R_A）\右\} \到Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{A&amp;#xFF0C;B&amp;#xFF0C;E_T&amp;#xFF08;R_A&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Trent</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\到\左\&nbsp;{A，B，E_T（R_A）\右\}&nbsp;\到Trent</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\到\左\&nbsp;{A，B，E_T（R_A）\右\}&nbsp;\到Trent</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-42"> Bob \到\左\ {A，B，E_T（R_A）\右\} \到Trent </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Trent&amp;#xA0;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{S_T&amp;#xFF08;K_A&amp;#xFF09;&amp;#xFF0C;E_B&amp;#xFF08;S_T&amp;#xFF08;R_A&amp;#xFF0C;K&amp;#xFF0C;A&amp;#xFF0C;B&amp;#xFF09;&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Trent&nbsp;\到\左\&nbsp;{S_T（K_A），E_B（S_T（R_A，K，A，B））\右\}&nbsp;\到Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Trent&nbsp;\到\左\&nbsp;{S_T（K_A），E_B（S_T（R_A，K，A，B））\右\}&nbsp;\到Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-43"> Trent \到\左\ {S_T（K_A），E_B（S_T（R_A，K，A，B））\右\} \到Bob </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>Bob&amp;#xA0;\&amp;#xA0;to&amp;#xA0;\&amp;#xA0;left&amp;#xA0;\&amp;#xA0;{E_A&amp;#xFF08;S_T&amp;#xFF08;R_A&amp;#xFF0C;K&amp;#xFF0C;A&amp;#xFF0C;B&amp;#xFF09;&amp;#xFF0C;R_B&amp;#xFF09;\&amp;#xA0;right&amp;#xA0;\}&amp;#xA0;\&amp;#xA0;to&amp;#xA0;Alice</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">Bob&nbsp;\&nbsp;to&nbsp;\&nbsp;left&nbsp;\&nbsp;{E_A（S_T（R_A，K，A，B），R_B）\&nbsp;right&nbsp;\}&nbsp;\&nbsp;to&nbsp;Alice</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>Bob&nbsp;\&nbsp;to&nbsp;\&nbsp;left&nbsp;\&nbsp;{E_A（S_T（R_A，K，A，B），R_B）\&nbsp;right&nbsp;\}&nbsp;\&nbsp;to&nbsp;Alice</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-44"> Bob \ to \ left \ {E_A（S_T（R_A，K，A，B），R_B）\ right \} \ to Alice </script></li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>&amp;#x7231;&amp;#x4E3D;&amp;#x4E1D;\&amp;#x5230;\&amp;#x5DE6;\&amp;#xA0;{E_K&amp;#xFF08;R_B&amp;#xFF09;\&amp;#x53F3;\}&amp;#xA0;\&amp;#x5230;Bob</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">爱丽丝\到\左\&nbsp;{E_K（R_B）\右\}&nbsp;\到Bob</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>爱丽丝\到\左\&nbsp;{E_K（R_B）\右\}&nbsp;\到Bob</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-45">爱丽丝\到\左\ {E_K（R_B）\右\} \到Bob </script></li></ol><br> 由于在会话密钥证书 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>S</mi><mi>T</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><msub><mi>R</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.255ex" height="2.419ex" viewBox="0 -780.1 9151.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="867" y="-213"></use><g transform="translate(1211,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(2041,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="1074" y="-230"></use></g><g transform="translate(3431,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="4261" y="0"></use><g transform="translate(5151,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="5981" y="0"></use><g transform="translate(6731,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-42" x="7561" y="0"></use><g transform="translate(8321,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>S</mi><mi>T</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><msub><mi>R</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-46"> S_T（R_A，K，A，B）</script> 爱丽丝的随机数存在 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>A</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.229ex" height="2.419ex" viewBox="0 -780.1 1390.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="1074" y="-230"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>A</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-47"> R_A </script>  ，则攻击者将无法代表Bob在新会话中使用旧证书。 因此，该协议的第六次通过允许Alice确保Bob知道新的会话密钥。 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-48"> K </script>  ，因此拥有他的“主”密钥 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>K</mi><mi>B</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.453ex" height="2.298ex" viewBox="0 -780.1 1486.5 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-42" x="1201" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>B</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-49"> K_B </script>  （因为这是从邮件中获取证书的唯一方法 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>B</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><msub><mi>S</mi><mi>T</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><msub><mi>R</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>K</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>A</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.233ex" height="2.419ex" viewBox="0 -780.1 13016.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-42" x="1044" y="-213"></use><g transform="translate(1375,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(2205,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-54" x="867" y="-213"></use></g><g transform="translate(3417,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(4247,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="1074" y="-230"></use></g><g transform="translate(5637,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="6467" y="0"></use><g transform="translate(7356,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="8186" y="0"></use><g transform="translate(8937,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-42" x="9767" y="0"></use><g transform="translate(10526,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(11356,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g><g transform="translate(12186,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>B</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><msub><mi>S</mi><mi>T</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><msub><mi>R</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>K</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-50"> E_B（S_T（R_A，K，A，B）））</script>  ） <br><br> 留言内容 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>K</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><msub><mi>R</mi><mi>B</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.507ex" height="2.298ex" viewBox="0 -780.1 4524 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="1044" y="-213"></use><g transform="translate(1467,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g transform="translate(2297,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-42" x="1074" y="-213"></use></g><g transform="translate(3694,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>K</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><msub><mi>R</mi><mi>B</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-51"> E_K（R_B）</script> 从爱丽丝到鲍勃的第七段，我们可以同时保证爱丽丝知道她的“主”钥匙 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>K</mi><mi>A</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.438ex" height="2.419ex" viewBox="0 -780.1 1480.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="1201" y="-230"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>K</mi><mi>A</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-52"> K_A </script>  （因为它能够解密 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>E</mi><mi>A</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF08;</mo></mrow><mtext mathcolor=&quot;red&quot;>\&amp;#x70B9;</mtext><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF0C;</mo></mrow><msub><mi>R</mi><mi>B</mi></msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo>&amp;#xFF09;</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.297ex" height="2.66ex" viewBox="0 -832 6586.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-45" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-41" x="1044" y="-230"></use><g transform="translate(1369,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">（</text></g><g fill="red" stroke="red" transform="translate(2199,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMAIN-5C"></use><g transform="translate(500,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">点</text></g></g><g transform="translate(3529,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">，</text></g><g transform="translate(4359,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-42" x="1074" y="-213"></use></g><g transform="translate(5756,0)"><text font-family="STIXGeneral,'Arial Unicode MS',serif" stroke="none" transform="scale(51.874) matrix(1 0 0 -1 0 0)">）</text></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>E</mi><mi>A</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>（</mo></mrow><mtext mathcolor="red">\点</mtext><mrow class="MJX-TeXAtom-ORD"><mo>，</mo></mrow><msub><mi>R</mi><mi>B</mi></msub><mrow class="MJX-TeXAtom-ORD"><mo>）</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-53"> E_A（\点，R_B）</script>  ），以及新的会话密钥 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>K</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.066ex" height="2.057ex" viewBox="0 -780.1 889.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-4B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-54"> K </script> 因为它能够正确加密 <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>R</mi><mi>B</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.244ex" height="2.298ex" viewBox="0 -780.1 1396.5 989.6" role="img" focusable="false" style="vertical-align: -0.487ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=https://habr.com/ru/post/476538/&amp;usg=ALkJrhizC2VIZ4jXb2jvQcLpv71lLKzzbA#MJMATHI-42" x="1074" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>R</mi><mi>B</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-55"> R_B </script> 这个钥匙。 <br><br><div class="spoiler">  <b class="spoiler_title">后记</b> <div class="spoiler_text"><blockquote> 本章最后一部分是有关密钥<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">协议BB84</a>的<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=zh-CN&amp;u=">已发布材料</a> 。 因此，本文实际上完成了有关Habr加密协议的系列文章。 作者将对文本的事实和其他评论表示感谢。 </blockquote></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN476538/">https://habr.com/ru/post/zh-CN476538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN476520/index.html">上帝在遗留代码领域（一个开放式童话）销售</a></li>
<li><a href="../zh-CN476526/index.html">莫斯科的Slurm Basic。 第一天 来自SocaCola的凌空抽空，麦克风已从演示者身上拿走，正在等待支持</a></li>
<li><a href="../zh-CN476528/index.html">软件架构师 OTUS的新课程</a></li>
<li><a href="../zh-CN476532/index.html">基本的UI / UX模式</a></li>
<li><a href="../zh-CN476534/index.html">如何建立有效的管理会计并获得超额利润</a></li>
<li><a href="../zh-CN476540/index.html">智能家居-语音控制分三个步骤。 Raspberry + HomeKit</a></li>
<li><a href="../zh-CN476546/index.html">DigitalOcean的Cloud WebRTC流</a></li>
<li><a href="../zh-CN476548/index.html">超频和小型化有什么共同点？</a></li>
<li><a href="../zh-CN476550/index.html">莫斯科的Slurm Basic。 第二天 Mizaru，Kikazaru，Iwazaru和技术支持总是值班</a></li>
<li><a href="../zh-CN476554/index.html">DigitalOcean上基于云的WebRTC流</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>