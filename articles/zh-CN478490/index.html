<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ğŸ”¶ ğŸ‘¨ğŸ½â€ğŸ¤â€ğŸ‘¨ğŸ¼ ğŸ¤º Levenshteinè·ç¦»å’Œæœç´¢æ§åˆ¶å™¨ ğŸŒ ğŸ¤·ğŸ½ ğŸ™ŒğŸ»</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="å¯èƒ½åœ¨ç™½ä¿„ç½—æ–¯æ¯ä¸ªæœ‰æ— è½¨ç”µè½¦çš„åŸå¸‚ä¸­ï¼Œéƒ½æœ‰Telegramä¸Šçš„VKç»„æˆ–èŠå¤©å®¤ï¼Œäººä»¬å¯ä»¥åœ¨å…¶ä¸­è·Ÿè¸ªæ§åˆ¶å™¨çš„ä½ç½®ã€‚ è¿™æ ·åšä¸»è¦æ˜¯ä¸ºäº†ä¸æ”¯ä»˜æ—…è¡Œè´¹ç”¨å’Œå…è´¹æ—…è¡Œï¼Œå°½ç®¡å¯¹å›¢ä½“çš„æè¿°å‡ ä¹æ€»æ˜¯åŒ…å«â€œæ—…è¡Œè´¹ç”¨â€çš„é™„è¨€ã€‚ 

 åœ¨VCä¸­ï¼Œé€šå¸¸å¦‚ä¸‹æ‰€ç¤ºï¼š 



 ä¸€ä¸ªå…¸å‹çš„æ³¨é‡Šå¦‚ä¸‹ï¼š 



 ç»“æ„éå¸¸ç®€å•ã€‚ åœ¨æ³¨é‡Š...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Levenshteinè·ç¦»å’Œæœç´¢æ§åˆ¶å™¨</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/478490/"> å¯èƒ½åœ¨ç™½ä¿„ç½—æ–¯æ¯ä¸ªæœ‰æ— è½¨ç”µè½¦çš„åŸå¸‚ä¸­ï¼Œéƒ½æœ‰Telegramä¸Šçš„VKç»„æˆ–èŠå¤©å®¤ï¼Œäººä»¬å¯ä»¥åœ¨å…¶ä¸­è·Ÿè¸ªæ§åˆ¶å™¨çš„ä½ç½®ã€‚ è¿™æ ·åšä¸»è¦æ˜¯ä¸ºäº†ä¸æ”¯ä»˜æ—…è¡Œè´¹ç”¨å’Œå…è´¹æ—…è¡Œï¼Œå°½ç®¡å¯¹å›¢ä½“çš„æè¿°å‡ ä¹æ€»æ˜¯åŒ…å«â€œæ—…è¡Œè´¹ç”¨â€çš„é™„è¨€ã€‚ <br><a name="habracut"></a><br> åœ¨VCä¸­ï¼Œé€šå¸¸å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><img src="https://habrastorage.org/webt/ti/eh/cd/tiehcdyeskmccfofp3adt2ko_qe.png" alt="å›¾ç‰‡"><br><br> ä¸€ä¸ªå…¸å‹çš„æ³¨é‡Šå¦‚ä¸‹ï¼š <br><br><img src="https://habrastorage.org/webt/ki/kp/s0/kikps0wwqqptfwyro8hrf81rtzg.png" alt="å›¾ç‰‡"><br><br> ç»“æ„éå¸¸ç®€å•ã€‚ åœ¨æ³¨é‡Šä¸­ï¼Œæœ‰å½“å‰æ­£åœ¨æ³¨æ„åˆ°æ§åˆ¶å™¨çš„ç«™ç‚¹çš„åç§°ï¼Œè¿˜æœ‰å®ƒä»¬ç«™ç€çš„æ–¹å‘ï¼š <br><br><img src="https://habrastorage.org/webt/no/gy/2l/nogy2l1lrraa8gte90lcyuwsume.png" alt="å›¾ç‰‡"><br><br> ç»“æœï¼Œæ³¨é‡Šæ˜¯ä¸€ä¸ªå¸¦æœ‰åœæ­¢ï¼Œæ—¶é—´å’Œæ—¥æœŸä»¥åŠå”¯ä¸€æ ‡è¯†çš„å¯¹è±¡ï¼Œé€šè¿‡å®ƒæˆ‘ä»¬å¯ä»¥è¯†åˆ«å®ƒã€‚ è¿™æ ·ï¼Œæ‚¨å¯ä»¥è®¡ç®—å‡ºæ§åˆ¶å™¨ç°åœ¨æœ€æœ‰å¯èƒ½çš„ä½ç½®ã€‚ <br><br><h4> å‡†å¤‡å·¥ä½œ </h4><br> é¦–å…ˆï¼Œæ‚¨éœ€è¦ç¡®å®šç›®æ ‡å…¬ä¼—ï¼Œæˆ‘ä»¬å°†ä»ä¸­è§£ææ•°æ®ã€‚ è¯¥å°ç»„çš„è¯„è®ºä¸­åº”è¯¥æœ‰å¾ˆå¤šæ´»åŠ¨ï¼Œå¦åˆ™æˆ‘ä»¬å¯èƒ½ä¼šè·å¾—å¤ªå°‘çš„æ•°æ® <br><br> å°±æˆ‘è€Œè¨€ï¼Œè¿™æ˜¯â€œ Control Gomelâ€ç»„ã€‚ <br><br> æˆ‘ä»¬å°†ä½¿ç”¨å®˜æ–¹çš„VKontakte APIï¼ˆé€‚ç”¨äºPythonï¼‰è§£ææ³¨é‡Š <br><br> æˆ‘ä»¬ä¼šä½¿ç”¨ç”¨æˆ·çš„è®¿é—®å¯†é’¥è¿›è¡Œèº«ä»½éªŒè¯ï¼Œå› ä¸ºæŸäº›ç»„å¯èƒ½å·²å…³é—­ï¼Œå¹¶ä¸”åªæœ‰åœ¨æ‚¨è¢«æ¥å—åˆ°è¯¥ç»„åæ‰èƒ½è®¿é—®ä»–ä»¬çš„è¯„è®ºã€‚ <br> ä¹‹åï¼Œæ‚¨å¯ä»¥å¼€å§‹æå–æ³¨é‡Šï¼š <br><br><h4> æ¥æ”¶è¯„è®º </h4><br> é¦–å…ˆï¼Œæˆ‘ä»¬è·å¾—ç»„ä¸­æœ€åä¸€ä¸ªå¯ç”¨çš„å¸–å­ï¼Œä»¥é€šè¿‡vk.wall.getCommentsæå–æ³¨é‡Šï¼Œå¹¶åˆå§‹åŒ–DataFrameï¼Œå°†æ•°æ®ä¿å­˜åˆ°å…¶ä¸­ã€‚ <br><br> æ¯ä¸ªè¯„è®ºæ–‡ç« éƒ½æœ‰é¢˜è¯ï¼šâ€œç¥æ‚¨æœ‰ç¾å¥½çš„ä¸€å¤©ï¼Œä»˜é’±ï¼Œä¸è¦å—åˆ°æ§åˆ¶â€ï¼Œå› æ­¤è¯·ä¸‹è½½è¯„è®ºï¼Œæ£€æŸ¥æ–‡ç« å†…å®¹å¹¶è·å–è¯„è®ºæ•°ç»„ï¼Œæ‚¨å¯ä»¥ä»ä¸­è·å–æ•°æ®ã€‚ <br><br> è€ƒè™‘åˆ°æ¯å¤©å‘å¸ƒ1ä¸ªå¸–å­ï¼ˆç°åœ¨æ˜¯11æœˆåº•ï¼Œå­¦å¹´ä»9æœˆå¼€å§‹ï¼Œå¹¶ä¸”ä¸»ç®¡å¾ˆå¯èƒ½è€ƒè™‘åˆ°è¿™ä¸€ç‚¹å¹¶æ›´æ”¹äº†ä»–ä»¬çš„æ™®é€šä½ç½®ï¼‰ï¼Œæ‰€ä»¥æˆ‘åœ¨è¿‡å»3ä¸ªæœˆä¸­å¯¹è¿™äº›å¸–å­è¿›è¡Œäº†è¯„è®ºã€‚ åŸåˆ™ä¸Šï¼Œå¯ä»¥è€ƒè™‘å…¶ä»–ç¬¦å·ï¼Œä¾‹å¦‚ä¸€å¹´ä¸­çš„æ—¶é—´ã€‚ <br><br> ä¸€äº›è¯„è®ºè¢«è¯¸å¦‚â€œåœ¨Barykinä¸Šæœ‰äººå—ï¼Ÿâ€ä¹‹ç±»çš„æ¶ˆæ¯æ‰€é˜»å¡ã€‚ å¦‚æœæ‚¨æŸ¥çœ‹è¿™äº›ï¼ˆä¸å¿…è¦çš„ï¼‰æ³¨é‡Šï¼Œåˆ™å¯ä»¥çªå‡ºæ˜¾ç¤ºä¸€äº›æ ‡å¿—ï¼š <br><br><ul><li> æ¡ˆæ–‡åŒ…å«â€œå¹²å‡€â€ï¼Œâ€œå·¦â€ï¼Œâ€œæ²¡äººâ€ç­‰å­—æ ·ã€‚ </li><li>  â€œå‘Šè¯‰æˆ‘â€ï¼Œâ€œè°â€ï¼Œâ€œä»€ä¹ˆâ€ï¼Œâ€œå¦‚ä½•â€ </li><li> è¯¸å¦‚è¡¨æƒ…ç¬¦å·ä¹‹ç±»çš„ç¬¦å· </li></ul><br> ä¹‹åï¼Œæˆ‘ä»¬å°†é€šè¿‡ä¸€ç³»åˆ—æ³¨é‡Šå¹¶ä»ä¸­æå–å”¯ä¸€çš„IDï¼Œæ–‡æœ¬ï¼Œæ—¶é—´ï¼Œæ—¥æœŸå’Œæ˜ŸæœŸå‡ ï¼Œå¹¶å°†å®ƒä»¬æ”¾å…¥å·²åˆ›å»ºçš„DataFrameä¸­ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ¥æ”¶è¯„è®º</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> re <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> time <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lp <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> vk_api <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> check_correctness <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">auth</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> vk_session = vk_api.VkApi(lp.login, lp.password) vk_session.auth() vk = vk_session.get_api() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> vk <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getDataFromComments</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(vk, groupID)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#     posts = vk.wall.get(owner_id=groupID, offset=1, count=90) print("\n") data = pd.DataFrame(columns=['text', 'post_id', "date", "day_in_week", "hour","minute", "day_in_month"]) for post in posts.get("items"): # id     postID = post.get("id") if "  ,       " not in post.get("text"): continue #  commentary       comments = vk.wall.getComments(owner_id=groupID, post_id=postID, count=200) #           dataframe for comment in comments.get("items"): text = comment.get("text") text = re.sub(r"A-Za-z--0123456789 ", "", str(text)) commentaryIsNice = check_correctness.detection(text) if commentaryIsNice: print(text) date = comment.get("date") time_struct = time.gmtime(date) post_id = comment.get("post_id") data = data.append({"text": text, "post_id" : post_id, "date": date,"day_in_week" : time_struct.tm_wday, "hour": (time_struct.tm_hour+3), "minute": time_struct.tm_min, "day_in_month": time_struct.tm_mday}, ignore_index=True) # print(data[:10]) # print(data.info()) print("dataset is ready") return data</span></span></code> </pre> <br></div></div><br> å› æ­¤ï¼Œæˆ‘ä»¬æ”¶åˆ°äº†ä¸€ä¸ªå¸¦æœ‰æ³¨é‡Šæ–‡æœ¬ï¼Œå…¶IDï¼Œæ˜ŸæœŸå‡ ï¼Œå°æ—¶å’Œåˆ†é’Ÿçš„DataFrameï¼Œè¯¥æ³¨é‡Šæ˜¯åœ¨å…¶ä¸­ç¼–å†™çš„ã€‚ æˆ‘ä»¬åªéœ€è¦æ˜ŸæœŸå‡ ï¼Œå†™ä½œæ—¶é—´å’Œæ–‡å­—ã€‚ çœ‹èµ·æ¥åƒè¿™æ ·ï¼š <br><br><img src="https://habrastorage.org/webt/cd/hs/cy/cdhscyg3rx4f5kejgvjdguuscui.png" alt="å›¾ç‰‡"><br><br><h4> æ•°æ®æ¸…ç† </h4><br> ç°åœ¨æˆ‘ä»¬éœ€è¦æ¸…é™¤æ•°æ®ã€‚ åœ¨æœç´¢Levenshteinè·ç¦»æ—¶ï¼Œæœ‰å¿…è¦ä»æ³¨é‡Šä¸­åˆ é™¤æ–¹å‘ï¼Œä»¥å‡å°‘é”™è¯¯ã€‚ æˆ‘ä»¬æ‰¾åˆ°â€œåœ¨æ—è¾¹â€ï¼Œâ€œå»â€ï¼Œâ€œå¦‚ä½•â€ï¼Œâ€œé™„è¿‘â€çš„è¡¨è¾¾æ–¹å¼ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸åé¢è·Ÿç¬¬äºŒä¸ªåœé ç‚¹çš„åç§°ï¼Œæˆ‘ä»¬å°†å…¶åˆ é™¤ä»¥åŠåé¢çš„å†…å®¹ï¼Œå¹¶ç”¨å¸¸ç”¨çš„è¡Œè·æ›¿æ¢ä¸€äº›è¡Œè¯åç§°ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æ¸…é™¤èµ„æ–™</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> fuzzywuzzy <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> process <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clear_commentary</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(text)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    -     """</span></span> index = <span class="hljs-number"><span class="hljs-number">0</span></span> splitted = text.split(<span class="hljs-string"><span class="hljs-string">" "</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, s <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(splitted): <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(splitted) == <span class="hljs-number"><span class="hljs-number">1</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> np.NaN <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (((<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> (<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> ( <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> ( <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> s)) <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> s <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span>): index = i <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> index <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> index &lt; len(splitted) - <span class="hljs-number"><span class="hljs-number">2</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): splitted.remove(splitted[index]) string = <span class="hljs-string"><span class="hljs-string">" "</span></span>.join(splitted) text = (string.lower()) <span class="hljs-keyword"><span class="hljs-keyword">elif</span></span> index <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>: splitted = splitted[:index] string = <span class="hljs-string"><span class="hljs-string">" "</span></span>.join(splitted) text = string.lower() <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: text = <span class="hljs-string"><span class="hljs-string">" "</span></span>.join(splitted).lower() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> text <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">clean_data</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> data.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>] = data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>].map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: clear_commentary(s)) data.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) print(<span class="hljs-string"><span class="hljs-string">"cleaned"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data</code> </pre> <br></div></div><br><h4> ä½¿ç”¨Levenshteinè·ç¦»è¿›è¡Œè½¬æ¢ </h4><br> æˆ‘ä»¬ç›´æ¥è¿›è¡Œåˆ°Levenshaneè·ç¦»ã€‚ æœ‰ä¸€ç‚¹å¸®åŠ©ï¼šLevenshteinè·ç¦»-æ’å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œåˆ é™¤ä¸€ä¸ªå­—ç¬¦å¹¶ç”¨å¦ä¸€ä¸ªæ›¿æ¢ä¸€ä¸ªå­—ç¬¦çš„æœ€å°‘æ“ä½œæ•°ï¼Œè¿™æ˜¯å°†ä¸€è¡Œå˜æˆå¦ä¸€è¡Œæ‰€å¿…éœ€çš„ã€‚ <br><br> æˆ‘ä»¬å°†ä½¿ç”¨<a href="https://github.com/seatgeek/fuzzywuzzy">Fuzzywuzzy</a>åº“æ‰¾åˆ°å®ƒã€‚ å®ƒå¯ä»¥å¸®åŠ©æ‚¨å¿«é€Ÿè½»æ¾åœ°è®¡ç®—Levenshteinè·ç¦»ã€‚ ä¸ºäº†åŠ å¿«å·¥ä½œé€Ÿåº¦ï¼Œè¯¥åº“çš„ä½œè€…è¿˜å»ºè®®å®‰è£…python-Levenshteinåº“ã€‚ <br><br> ä¸ºäº†è·å¾—è¯„è®ºçš„åœæ­¢ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåœæ­¢åˆ—è¡¨ã€‚  GoTransåº”ç”¨ç¨‹åºçš„å¼€å‘äººå‘˜Alexander Kozlovå‘æˆ‘æä¾›äº†å®ƒã€‚ <br><br> å¿…é¡»æ‰©å±•åˆ—è¡¨ï¼Œåœ¨å…¶ä¸­æ·»åŠ ä¸€äº›ä¸å­˜åœ¨çš„ç«™ç‚¹ï¼Œå¹¶æ›´æ”¹éƒ¨åˆ†åç§°ï¼Œä»¥ä¾¿æ›´å¥½åœ°å®šä½å®ƒä»¬ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">åœæ­¢</b> <div class="spoiler_text">  Stops = ['supermarket'ï¼Œ'meadow'ï¼Œ'remybtekhnika'ï¼Œ'Leningrad'ï¼Œ'Yaroslavl'ï¼Œ'Polesskaya'ï¼Œ <br>  'Yaroslavl'ï¼Œ'timofeenko'ï¼Œ'March 8'ï¼Œ <br>  â€œ Rechitskyäº¤æ˜“æ‰€â€ï¼Œâ€œ Rechitskyå¤§è¡—â€ï¼Œâ€œé©¬æˆå›¢â€ï¼Œâ€œç™¾è´§å•†åº—â€ï¼Œâ€œ Chongarskayaâ€ï¼Œ <br>  'chongarka'ï¼Œ'ggu'ï¼Œ'skorina'ï¼Œ'university'ï¼Œ'appliance'ï¼Œ'1000ä¸ªå°ä¸œè¥¿'ï¼Œ'maya'ï¼Œ'station'ï¼Œ <br>  â€œå¤§å­¦å›­åŒºâ€ï¼Œâ€œè´¸æ˜“ä¸ç»æµâ€ï¼Œâ€œå‘¨å¹´çºªå¿µâ€ï¼Œâ€œå¾®åŒº18â€ï¼Œâ€œæœºåœºâ€ï¼Œâ€œå³å°†æ¥ä¸´â€ï¼Œ <br>  'gomelgeodezcentr'ï¼Œ'crystal'ï¼Œ'lake lyubenskoye'ï¼Œ'davydovskyå¸‚åœº'ï¼Œ'davydovka'ï¼Œ <br>  'æ²³æµsozh'ï¼Œ'gomeldrev'ï¼Œ <br>  'Sevruki'ï¼Œ'gmu 1å·'ï¼Œ'Rechitskyç­‰'ï¼Œ'æœè£…'ï¼Œ'ä¼ æŸ“ç—…åŒ»é™¢'ï¼Œ'é¸¥è¥'ï¼Œ <br> æ²ƒæ´›æ‰˜å¨ƒï¼ŒçŠç‘šï¼Œæˆˆæ¢…å°”ç‰¹æ ¼é©¬ä»€ï¼Œæˆˆæ¢…ç½—æ™®é‡Œå…‹ç‰¹ï¼Œæ¸©æ–¯æˆˆæ¢…æ–¯ç‰¹ç½—ä¼Šï¼ŒæŠ¥çº¸ï¼Œ <br>  â€œ Kalenikovaâ€ï¼Œâ€œ Ereminoâ€ï¼Œâ€œè’¸é¦â€ï¼Œâ€œç‰¹æ®Šå·¥ä¸šè‡ªåŠ¨åŒ–â€ï¼Œâ€œç¬¬äºŒå­¦æ ¡â€ï¼Œâ€œ Barykinaâ€ï¼Œ <br>  â€œæœºå™¨å•å…ƒâ€ï¼Œâ€œé’å¹´â€ï¼Œâ€œé“¸é€ ä½“â€ï¼Œâ€œåŒ–å­¦å®¶â€ï¼Œâ€œ golovatskyâ€ï¼Œâ€œ budennyâ€ï¼Œ <br>  'spu67'ï¼Œ'35th'ï¼Œ'gagarin'ï¼Œ'Gomselmashå·¥å‚50å¹´'ï¼Œ'hill'ï¼Œ'radio factory'ï¼Œ <br>  â€œç¥–æ¯â€ï¼Œâ€œç»ç’ƒå‚â€ï¼Œâ€œæ —å­â€ï¼Œâ€œå¯åŠ¨å¼•æ“â€ï¼Œâ€œå®‡èˆªå‘˜â€ï¼Œ <br>  'rtsrm initial'ï¼Œ'bykhovskaya'ï¼Œ'ç´§æ€¥æƒ…å†µéƒ¨ç ”ç©¶æ‰€'ï¼Œ'dk gomselmash'ï¼Œ'store'ï¼Œ'rechitsky'ï¼Œ <br>  'Sevruks'ï¼Œ'Osovtsy'ï¼Œ'æ¸¸å®¢'ï¼Œ'è‚‰ç±»å·¥å‚'ï¼Œ'Holy Trinity'ï¼Œ'medical town'ï¼Œ'October'ï¼Œ <br>  â€œæ²¹åº“â€ï¼Œâ€œ gomelloblavtotransâ€ï¼Œâ€œ milkavitaâ€ï¼Œâ€œ bakuninâ€ï¼Œâ€œ zipâ€ï¼Œâ€œ omaâ€ï¼Œâ€œæ ‘è„‚â€ï¼Œ <br>  â€œå»ºç­‘å¸‚åœºkskâ€ï¼Œâ€œé“è·¯å»ºè®¾è€…â€ï¼Œâ€œç°åœºâ€ï¼Œâ€œ kamenetskayaâ€ï¼Œâ€œ bolshevikâ€ï¼Œâ€œ jakubovkaâ€ï¼Œ <br>  â€œ Borodinaâ€ï¼Œâ€œæ²³é©¬å¤§å‹è¶…å¸‚â€ï¼Œâ€œåœ°ä¸‹è‹±é›„â€ï¼Œâ€œ 5æœˆ9æ—¥â€ï¼Œâ€œæ —å­â€ï¼Œâ€œå‡è‚¢â€ï¼Œ <br>  â€œ iputç«™â€ï¼Œâ€œå…±äº§å›½é™…â€ï¼Œâ€œéŸ³ä¹æ•™è‚²å­¦é™¢â€ï¼Œâ€œå†œä¸šå…¬å¸â€ï¼Œâ€œæ—è·¯â€ï¼Œâ€œèƒœåˆ©â€ï¼Œ <br>  â€œè¥¿æ–¹â€ï¼Œâ€œçç â€ï¼Œâ€œå¼—æ‹‰åŸºç±³å°”â€ï¼Œâ€œå¹²â€ï¼Œâ€œè¯æˆ¿â€ï¼Œâ€œä¼Šå‡¡è¯ºå¨ƒâ€ï¼Œ <br>  â€œæœºæ¢°åˆ¶é€ â€ï¼Œâ€œæ¡¦æœ¨â€ï¼Œâ€œ 60å¹´â€ï¼Œâ€œåŠ¨åŠ›å·¥ç¨‹å¸ˆâ€ï¼Œâ€œä¸­å¿ƒçŸ³â€ï¼Œ <br>  â€œè‚¿ç˜¤è¯Šæ‰€â€ï¼Œâ€œå°„å‡»åœºâ€ï¼Œâ€œ golovintsyâ€ï¼Œâ€œçŠç‘šâ€ï¼Œâ€œå—æ–¹â€ï¼Œâ€œæ˜¥å¤©â€ï¼Œ <br> åŸƒå¤«é›·è«å¨ƒï¼ˆEfremovaï¼‰ï¼Œè¾¹å¢ƒï¼Œè´å°”å¤ç‰¹ï¼ˆBelgutï¼‰ï¼Œæˆˆæ¢…æ–¯ç‰¹ç½—ä¼Šï¼ˆGomelstroyï¼‰ï¼Œé²é‡Œæ£®ç§‘ï¼ˆBorisenkoï¼‰ï¼Œç”°å¾„å®«ï¼Œ <br>  'Michurinsky'ï¼Œ'solar'ï¼Œ'gastello'ï¼Œ'military'ï¼Œ'auto center'ï¼Œ'plumbing'ï¼Œ'uza'ï¼Œ <br>  â€œåŒ»å­¦é™¢â€ï¼Œâ€œå¹¼å„¿å›­11â€ï¼Œâ€œå¸ƒå°”ä»€ç»´å…‹â€ï¼Œâ€œå¹¼çŠ¬â€ï¼Œâ€œè¾¾ç»´å¤šå¤«æ–¯åŸºâ€ï¼Œâ€œæµ·æ´‹â€ï¼Œâ€œè¿›æ­¥â€ï¼Œ <br>  'Dobrushskaya'ï¼Œ'ç™½è‰²'ï¼Œ'GSK'ï¼Œ'davydovka'ï¼Œ'ç”µæ°”è®¾å¤‡'ï¼Œ'å‹è°Š'ï¼Œ <br>  â€œ 70å¹´â€ï¼Œâ€œæ±½è½¦ç»´ä¿®â€ï¼Œâ€œç‘å…¸å±±â€ï¼Œâ€œèµ›é“â€ï¼Œâ€œæ°´æ¸ â€ï¼Œâ€œæœºå™¨æˆˆæ¢…åˆ©â€ï¼Œ <br> æ²ƒæ´›æ‰˜å¨ƒï¼Œå…ˆé”‹ï¼Œçš‡å®¶éª‘è­¦ï¼Œå¸Œå§†æ‰˜å°”ï¼Œç¬¬äºŒè‰åœ°å··ï¼Œåšå¸Œçº³çº³ï¼Œæµ´åœºï¼Œ <br>  â€œè‚¿ç˜¤è¯Šæ‰€â€ï¼Œâ€œå¹¿åœºâ€ï¼Œâ€œåˆ—å®â€ï¼Œâ€œç¬¬ä¸€å­¦æ ¡â€ï¼Œâ€œå—åº—â€ï¼Œ <br>  â€œ gomelagrotransâ€ï¼Œâ€œ millersâ€ï¼Œâ€œ lyubenskyâ€ï¼Œâ€œå†›äº‹å¾å‹ŸåŠå…¬å®¤â€ï¼Œâ€œåŒ»é™¢â€ï¼Œâ€œ uzaâ€ï¼Œâ€œ rtsrmâ€ï¼Œ <br>  'lysyukovyh'ï¼Œ'shop iput'ï¼Œ'raton'ï¼Œ'gas station'ï¼Œ'randovsky'ï¼Œ'farmhouse'ï¼Œ'chestnut'ï¼Œ'ropovsky'ï¼Œ <br>  â€œ Romanovichiâ€ï¼Œâ€œ Ilyichâ€ï¼Œâ€œ rowingâ€ï¼Œâ€œå»ºç­‘ä¸šâ€ï¼Œâ€œä¼ æŸ“æ€§â€ï¼Œ <br>  â€œèƒ–å·¥å‚â€ï¼Œâ€œæ±½è½¦æœåŠ¡â€ï¼Œâ€œå†œä¸šæœåŠ¡â€ï¼Œâ€œç²˜æ€§â€ï¼Œâ€œ Nikolskayaâ€ï¼Œ <br>  â€œè‡ªèµ°å¼æ”¶å‰²æœºâ€ï¼Œâ€œæ³¥ç“¦åŒ â€ï¼Œâ€œå»ºæâ€ï¼Œâ€œç»´ä¿®æœºæ¢°â€ï¼Œâ€œç®¡ç†â€ï¼Œ <br>  â€œåæœˆâ€ï¼Œâ€œæ£®æ—ç«¥è¯â€ï¼Œâ€œå¡”è’‚äºšå¨œâ€ï¼Œâ€œé²é‡Œæ–¯Â·å¯Ÿé‡Œç§‘å¤«â€ï¼Œâ€œæ‰å°”ç§‘å¤«æ–¯åŸºâ€ï¼Œâ€œæ‰ä¼Šå¡å¨ƒâ€ï¼Œ <br>  â€œæ¬è¿â€ï¼Œâ€œ Karpovichâ€ï¼Œâ€œæˆ¿å±‹å»ºç­‘å·¥å‚â€ï¼Œâ€œåŸå¸‚ç”µåŠ›è¿è¾“â€ï¼Œâ€œ zlinâ€ï¼Œ <br>  â€œä½“è‚²åœºgomselmashâ€ï¼Œâ€œ ap 6â€ï¼Œâ€œæ¶²å‹é©±åŠ¨â€ï¼Œâ€œæœºåŠ¡æ®µâ€ï¼Œâ€œæ±½è½¦å¸‚åœºosovtsyâ€ï¼Œ <br>  â€œæ–°ç”Ÿæ´»â€ï¼Œâ€œæœ±ç§‘å¨ƒâ€ï¼Œâ€œå†›äº‹éƒ¨é˜Ÿâ€ï¼Œâ€œç¬¬ä¸‰å­¦æ ¡â€ï¼Œâ€œæ£®æ—â€ï¼Œâ€œçº¢è‰²ç¯å¡”â€ï¼Œ <br>  â€œåŒºåŸŸâ€ï¼Œâ€œè¾¾ç»´å¤šå¤«æ–¯å¡äºšâ€ï¼Œâ€œå¡å°”æ¯”é›ªå¨ƒâ€ï¼Œâ€œä¸–ç•Œå«æ˜Ÿâ€ï¼Œâ€œé’å¹´â€ï¼Œâ€œä½“è‚²åœºæœºè½¦â€ï¼Œ <br>  'å¤ªé˜³èƒ½'ï¼Œ'Ladaservice'ï¼Œ'Î¼R21'ï¼Œ'Aresa'ï¼Œ'å›½é™…ä¸»ä¹‰è€…'ï¼Œ'Kosareva'ï¼Œ <br>  â€œ Bogdanovaâ€ï¼Œâ€œ Gomelé“æ··å‡åœŸâ€ï¼Œâ€œÎ¼r20aâ€ï¼Œâ€œÎ¼rRechitskyâ€ï¼Œâ€œåŒ»ç–—è®¾å¤‡â€ï¼Œâ€œ Juraevaâ€ï¼Œ <br>  â€œæ‰‹å·¥è‰ºå“å­¦é™¢â€ï¼Œâ€œå†°â€ï¼Œâ€œ dkè‰ºæœ¯èŠ‚â€ï¼Œâ€œè´­ç‰©ä¸­å¿ƒâ€ï¼Œ <br>  'Kuibyshevsky'ï¼Œ'festival'ï¼Œ'garage koop 27'ï¼Œ'åœ°éœ‡å·¥ç¨‹'ï¼Œ'milcha'ï¼Œ'tubeåŒ»é™¢'ï¼Œ <br>  â€œ ptu179â€ï¼Œâ€œåŒ–å·¥äº§å“â€ï¼Œâ€œæ¶ˆé˜²éƒ¨é—¨â€ï¼Œâ€œåŒ»é™¢â€ï¼Œâ€œå…¬äº¤ä»“åº“â€ï¼Œ <br>  'æŠ¥çº¸å¤§æ¥¼'ï¼Œ'èƒœåˆ©'ï¼Œ'klenkovsky'ï¼Œ'é’»çŸ³'ï¼Œ'å¼•æ“ç»´ä¿®'ï¼Œ'mkr 19'] <br></div></div><br> ä½¿ç”¨.mapå’ŒFuzzywuzzy.process.extractOneï¼Œæˆ‘ä»¬åœ¨åˆ—è¡¨ä¸­æ‰¾åˆ°æœ€å°Levenshteinè·ç¦»çš„åœé ç‚¹ï¼Œç„¶åç”¨åœé ç‚¹çš„åç§°æ›¿æ¢æ³¨é‡Šæ–‡æœ¬ï¼Œè¿™ä½¿æˆ‘ä»¬å¯ä»¥è·å–åœé ç‚¹åç§°çš„æ•°æ®é›†ã€‚ <br><br> ç»“æœæ•°æ®é›†å¦‚ä¸‹æ‰€ç¤ºï¼š <br><br><img src="https://habrastorage.org/webt/gd/pd/c8/gdpdc8lwdppzpastghnasxbqsbi.png"><br><br><div class="spoiler">  <b class="spoiler_title">è¯„è®ºå˜æˆåœæ­¢</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_category_from_comment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(text)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""              """</span></span> dict = process.extractOne(text.lower(), stops) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> dict[<span class="hljs-number"><span class="hljs-number">1</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">75</span></span>: text = dict[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: text = np.nan print(<span class="hljs-string"><span class="hljs-string">"wait"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> text <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_category_dataset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""      """</span></span> print(<span class="hljs-string"><span class="hljs-string">"remap started. wait"</span></span>) data.text = data.text.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> comment: get_category_from_comment(str(comment))) print(<span class="hljs-string"><span class="hljs-string">"remap ends"</span></span>) data.dropna(inplace=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>] = data.text.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s==<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s) data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>] = data.text.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s==<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s) data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>] = data.text.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: <span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s==<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s) data[<span class="hljs-string"><span class="hljs-string">"text"</span></span>] = data.text.map(<span class="hljs-keyword"><span class="hljs-keyword">lambda</span></span> s: <span class="hljs-string"><span class="hljs-string">" "</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> s==<span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> s) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data</code> </pre> <br></div></div><br><h4> æ•°æ®è¾“å‡º </h4><br> ç°åœ¨æˆ‘ä»¬å¯ä»¥å‡è®¾æ§åˆ¶å™¨åœ¨ç»™å®šçš„æ—¶é—´æœ€æœ‰å¯èƒ½åœ¨å“ªé‡Œã€‚ <br><br> æˆ‘ä»¬æ­£åœ¨æŸ¥æ‰¾ä¸€å‘¨ä¸­ç‰¹å®šæ—¶é—´å’Œæ—¥æœŸçš„ç»“æœæ•°æ®è®°å½•ã€‚ ä¾‹å¦‚ï¼Œåœ¨æ˜ŸæœŸäºŒä¸Šåˆ9ç‚¹ï¼š <br><br><pre> <code class="python hljs">&lt;code&gt;data[(data[<span class="hljs-string"><span class="hljs-string">"day_in_week"</span></span>] == day) &amp; (data[<span class="hljs-string"><span class="hljs-string">"hour"</span></span>] == hour)]&lt;/code&gt;</code> </pre> <br><img src="https://habrastorage.org/webt/t4/gg/dg/t4ggdgmwezje8lgllisorbqrqwa.png"><br>  <i>ï¼ˆè¿™ä¸æ˜¯å…¨éƒ¨æ•°æ®ï¼‰</i> <br><br> ä¹‹åï¼Œæˆ‘ä»¬æ‰¾åˆ°å”¯ä¸€åœé ç‚¹çš„æ•°é‡ï¼Œå¹¶ä»…æ˜¾ç¤ºåœé ç‚¹åŠå…¶æ•°é‡ï¼š <br><br><pre> <code class="python hljs">df[(df[<span class="hljs-string"><span class="hljs-string">"day_in_week"</span></span>] == <span class="hljs-number"><span class="hljs-number">2</span></span>) &amp; (df[<span class="hljs-string"><span class="hljs-string">"hour"</span></span>] == <span class="hljs-number"><span class="hljs-number">9</span></span>)][<span class="hljs-string"><span class="hljs-string">"text"</span></span>].value_counts()</code> </pre> <br><img src="https://habrastorage.org/webt/yq/az/if/yqazifl3gkclyqw4ifykvemsrky.png"><br><br> ç°åœ¨æˆ‘ä»¬å¯ä»¥è¯´ï¼Œåœ¨æ˜ŸæœŸäºŒæ—©ä¸Š9ç‚¹ï¼Œç®¡åˆ¶äººå‘˜å¾ˆå¯èƒ½ä¼šåœ¨ul Myasokombinatçš„è½¦ç«™è¢«å‘ç°ã€‚  Lugovayaï¼ŒBelGUTï¼ŒTDâ€œå¥¥é©¬â€ã€‚ <br><br> è¿™ç§æ–¹æ³•çš„ä¸»è¦ç¼ºé™·æ˜¯ç¼ºä¹æ•°æ®ã€‚ å¹¶éæ¯å¤©éƒ½åœ¨é«˜å³°æ—¶æ®µæä¾›æ³¨é‡Šï¼Œå› ä¸ºäººä»¬ä½¿ç”¨å…¬å…±äº¤é€šçš„æ¬¡æ•°å¤šäºä¸é‚£ä¹ˆå—æ¬¢è¿çš„æ—¶é—´ï¼Œä½†æ˜¯å¦‚æœæ‚¨æ·»åŠ æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œä¸ä»…æ¥è‡ªä¸€ç»„æ³¨é‡Šçš„æ•°æ®ï¼Œè¿˜ä¼šæ·»åŠ æ•°æ®ï¼‰æ¥è‡ªæ›¿ä»£ç»„æˆ–ç”µæŠ¥èŠå¤©ï¼Œä»¥åŠæ¡ç›®çš„æ•°é‡ï¼Œä¸€åˆ‡å°†å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ <br><br><h4> ä½¿ç”¨VK LongPoll APIè¿›è¡ŒBot </h4><br> ä¸ºäº†æœ‰æœºä¼šæ ¹æ®æ—¶é—´åœ¨ä¸ä¾èµ–è®¡ç®—æœºçš„æƒ…å†µä¸‹æ¥æ”¶æ§åˆ¶å™¨ä½ç½®çš„æ•°æ®ï¼Œæˆ‘ä¸ºVKontakteä¸Šçš„ä¸€ä¸ªå°ç»„åˆ¶ä½œäº†ä¸€ä¸ªæœºå™¨äººï¼Œè¯¥æœºå™¨äººé€šè¿‡å‘é€è®°å½•ä¸­çš„åœé ç‚¹æ•°ï¼ˆç»™å®šå½“å‰æ—¶é—´å’Œæ˜ŸæœŸå‡ ï¼‰æ¥å“åº”ä»»ä½•æ¶ˆæ¯ã€‚ <br><br><div class="spoiler">  <b class="spoiler_title">æœºå™¨äººä»£ç </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> random <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> randint <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> vk_api <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> requests <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> get_stops_from_data <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> get_stops_by_time <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start_bot</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, token)</span></span></span><span class="hljs-function">:</span></span> vk_session = vk_api.VkApi(token=token) vk = vk_session.get_api() print(<span class="hljs-string"><span class="hljs-string">"bot started"</span></span>) longPoll = vk.groups.getLongPollServer(group_id=<span class="hljs-number"><span class="hljs-number">183524419</span></span>) server, key, ts = longPoll[<span class="hljs-string"><span class="hljs-string">'server'</span></span>], longPoll[<span class="hljs-string"><span class="hljs-string">'key'</span></span>], longPoll[<span class="hljs-string"><span class="hljs-string">'ts'</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>: <span class="hljs-comment"><span class="hljs-comment">#  :   ts longPoll = post('%s' % server, data={'act': 'a_check', 'key': key, 'ts': ts, 'wait': 25}).json() if longPoll['updates'] and len(longPoll['updates']) != 0: for update in longPoll['updates']: if update['type'] == 'message_new': #        vk.messages.markAsRead(peer_id=update['object']['user_id']) user = update['object']["user_id"] text = get_stops_by_time(data) if text is None or text == {}: message = "Ã­Ã¥Ã² Ã§Ã Ã¯Ã¨Ã±Ã¥Ã©" vk.messages.send(user_id=user, random_id=randint(-2147483648, 2147483647), message=message) print(message) ts = longPoll['ts'] continue message = "   -     \n" \ "\n \n" for i in text.items(): message += i[0] + " " message += str(i[1]) message += "\n" #    vk.messages.send(user_id=user, random_id=randint(-2147483648, 2147483647), message=message) ts = longPoll['ts']</span></span></code> </pre> <br></div></div><br><h4> ç»“è®º </h4><br> åœ¨å®è·µä¸­ï¼Œæˆ‘å¤šæ¬¡éªŒè¯äº†è¿™äº›å‡è®¾çš„è´¨é‡ï¼Œå¹¶ä¸”ä¸€åˆ‡æ­£å¸¸ã€‚ äº‹å®è¯æ˜ï¼Œå°½ç®¡æ— æ³•ç»™å‡ºç»å¯¹æ­£ç¡®çš„é¢„æµ‹ï¼Œå¹¶ä¸”æ§åˆ¶æˆåŠŸçš„å¯èƒ½æ€§ä¸æ˜¯100ï¼…ï¼Œä½†æ§åˆ¶å‘˜åŸºæœ¬ä¸Šå¤„äºç›¸åŒçš„åœæ­¢ä½ç½®ã€‚  Levenshteinè·ç¦»å…·æœ‰è®¸å¤šä¸åŒçš„åº”ç”¨ï¼Œä»çº æ­£å•è¯é”™è¯¯åˆ°æ¯”è¾ƒåŸºå› ï¼ŒæŸ“è‰²ä½“å’Œè›‹ç™½è´¨ï¼Œä½†å®ƒåœ¨æ­¤ç±»åº”ç”¨é—®é¢˜ä¸­ä¹Ÿå…·æœ‰æ½œåŠ›ã€‚ <br><br> ç¥æ‚¨æœ‰ç¾å¥½çš„ä¸€å¤©ï¼Œå¹¶æ”¯ä»˜è½¦è´¹ã€‚ <br><br> æ‰€æœ‰çš„botä»£ç å’Œæ•°æ®æ“ä½œå‡<a href="https://github.com/dingdongyouarewrong/vk_controllers_bot">åœ¨æ­¤å¤„</a>å‘å¸ƒã€‚ </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/zh-CN478490/">https://habr.com/ru/post/zh-CN478490/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../zh-CN478472/index.html">Linuxå†…æ ¸åº“ï¼šsoæˆ–dllå½¢å¼çš„Linuxå†…æ ¸</a></li>
<li><a href="../zh-CN478474/index.html">å…„å¼ŸPablo Escobarä¹Ÿå‘å¸ƒäº†ä¸€æ¬¾çµæ´»çš„æ™ºèƒ½æ‰‹æœº</a></li>
<li><a href="../zh-CN478480/index.html">äººå·¥æ™ºèƒ½ï¼ŒITSMï¼Œä»¥åŠä¸€èˆ¬æ¥è¯´ï¼ŒLEANåœ¨å“ªé‡Œï¼Ÿ</a></li>
<li><a href="../zh-CN478482/index.html">å¼€å‘äººå‘˜ä¸ºå¼€å‘äººå‘˜æ‰“å¼€äº†ä¸€ä¸ªé…’å§ï¼Œå¹¶åœ¨é‚£é‡Œä¸¾è¡Œäº†æœ‰å…³Angularï¼Œå¸ƒå±€ï¼ŒPHPçš„ä¼šè®®</a></li>
<li><a href="../zh-CN478486/index.html">10çº³ç±³èŠ¯ç‰‡çš„æ—¶ä»£-è°å¼€å‘äº†è¿™ç§å¤„ç†å™¨ä»¥åŠæœªæ¥çš„è¡Œä¸šå‰æ™¯</a></li>
<li><a href="../zh-CN478492/index.html">äºŒæ°§åŒ–ç¢³é¥®é£Ÿä¸­çš„å¤§è‚ æ†èŒï¼šæŠ—å‡»å…¨çƒå˜æš–çš„æ–°å·¥å…·å—ï¼Ÿ</a></li>
<li><a href="../zh-CN478494/index.html">Winnum TRPçƒ­å¤„ç†è§£å†³æ–¹æ¡ˆï¼šè®¾ç½®å’Œä½¿ç”¨</a></li>
<li><a href="../zh-CN478496/index.html">50å¹´å‰ï¼Œäº’è”ç½‘è¯ç”Ÿäº3420å·æˆ¿é—´</a></li>
<li><a href="../zh-CN478498/index.html">1. Fortinetå…¥é—¨v 6.0ã€‚ å¼•è¨€</a></li>
<li><a href="../zh-CN478500/index.html">ä¸ºä»€ä¹ˆå¤å¤©çš„ä¼šè®®è¿™ä¹ˆå°‘ï¼Ÿ</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>