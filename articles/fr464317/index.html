<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🧜🏾 🕥 👶 Projet Konbanwa 🈴 👩🏻‍🍳 🧑🏿‍🤝‍🧑🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="KONBANWA («Bonsoir» - こ ん ば ん は). 

 Il s'agit d'une bande LED montée sur le haut de la fenêtre et utilisée pour allonger les heures de clarté. Étant ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Projet Konbanwa</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/464317/">  KONBANWA («Bonsoir» - こ ん ば ん は). <br><br>  Il s'agit d'une bande LED montée sur le haut de la fenêtre et utilisée pour allonger les heures de clarté.  Étant donné que la source de lumière du jour et supplémentaire ne change pas sa position, un éclairage confortable est obtenu dans la pièce.  De plus, en fait, les rideaux d'éclairage public ne vous permettent pas de voir ce qui se passe à l'intérieur de la pièce. <br><a name="habracut"></a><br>  Le projet konbanwa prend en compte le crépuscule astronomique en transmettant la latitude et la longitude de l'appareil.  En déplaçant la latitude vers le sud ou le nord, vous pouvez contrôler l'heure et la durée de l'aube / coucher du soleil. <br><br>  Pour chaque crépuscule astronomique, vous pouvez définir votre couleur et luminosité de l'éclairage. <br>  Du coucher du soleil au coucher du soleil civil, la période de travail la plus lumineuse.  À ce moment, la personne ne dort généralement pas.  Vous pouvez choisir une couleur proche du soleil couchant (nuances de rouge), et la luminosité est aussi confortable que possible.  C'est très inhabituel quand il y a de la neige fondante, de la pluie dans la rue et les rayons du soleil couchant sur les murs.  La nuit, le mode nuit est activé.  A ce moment, la luminosité est minimale, il vaut mieux choisir des nuances de bleu ou de vert.  Avec l'aube, des teintes jaune orangé avec une luminosité minimale.  Dans l'après-midi - off. <br><br>  Tout cela fonctionne en mode automatique, ajustez simplement la luminosité et la couleur une fois.  La seule condition est que le wifi fonctionne.  En tant que «cerveau» appliqué, le nœud rouge, qui peut être installé sur le Raspberry PI à l'intérieur du réseau local, ou sur des serveurs externes.  Le moustique mqtt broker est utilisé pour le transport de données.  La géolocalisation n'est pas détectée automatiquement.  Cette fonction est affectée au serveur nœud rouge, où elle est enregistrée manuellement. <br><br><div class="spoiler">  <b class="spoiler_title">rouge nœud</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/mn/wc/el/mnwcel-_401fam6lnwk4oto4lny.png" alt="image"><br></div></div><br>  Portée: des territoires du nord, où il fait sombre tôt en hiver, aux territoires du sud, où l'obscurité vient presque immédiatement après le coucher du soleil.  L'application principale est l'installation de fenêtres.  Il peut également être installé sur la porte d'entrée pour éclairer automatiquement l'entrée afin de ne pas chercher le trou de serrure dans l'obscurité. <br><br>  Un peu d'histoire: <br>  En 2018, le premier prototype a été assemblé, ce qui s'est avéré réalisable.  Il a été assemblé sur la base de l'esp01 et des LED d'adresse ws2812b.  Degré de protection IP30.  La lumière s'est allumée à temps et l'inclusion avait constamment besoin d'être corrigée.  L'appareil est installé dans la pépinière et est toujours utilisé comme veilleuse. <br><br>  Le deuxième prototype sur esp01 a été assemblé pour la porte d'entrée, mais le degré de protection IP30 ne permettait pas de travailler dans la rue et après l'hiver les LED sont devenues inutilisables. <br><br>  Début 2019, une refonte a eu lieu et le projet a reçu une continuation de konbanwa 2.0, qui tenait compte du crépuscule astronomique.  De plus, la luminosité de l'aube est presque réduite au mode veilleuse. <br><br>  Konbanwa 3.0 est assemblé sur esp12e avec un capteur de température et d'humidité DHT22 en option et une bande LED de 60 LED par mètre.  C'est à cette époque qu'il est devenu clair que les bandes dépendent beaucoup du fabricant.  Et ils ont un rendu des couleurs différent. <br><br>  Konbanwa 4.0 s'est poursuivi au milieu de l'été 2019.  Le DHT22 a été remplacé par un capteur de température, d'humidité et de pression atmosphérique BME280.  Connecté 2 canaux pour bande LED.  De plus, deux relais avec isolation optique contrôlés par un interrupteur à clé unique sans verrouillage sont connectés.  Le micrologiciel a été réécrit, la carte de circuit imprimé a été divorcée et la production de cartes a été commandée sur JLCPCB.  Le module esp12e a été remplacé par NodeMCU v3. <br><br><div class="spoiler">  <b class="spoiler_title">Circuit et PCB</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/jt/ff/zd/jtffzdne1hyxaywqdbjppatsen4.png" alt="image"><br><img src="https://habrastorage.org/webt/vv/jt/71/vvjt71rpxuxixp0_wbpcr-epj9o.png" alt="image"><br></div></div><br>  Tous ces changements à l'avenir faciliteront le montage de l'appareil au plafond sous un plafond suspendu ou suspendu ou dans un lustre.  À l'intérieur du lustre, une alimentation de 5 volts est montée, à laquelle l'alimentation est constamment fournie par un canal de l'interrupteur.  Avec un interrupteur à clé unique, il est possible de contrôler deux canaux du lustre.  Les bandes LED sont connectées par six fils fins (câble), qui peuvent être facilement collés au plafond ou retirés du plafond.  Une boucle de trois fils par canal.  +5 volts, -5 volts et données.  Bande LED montée sur la fenêtre.  Un maximum de deux dans le nombre de canaux.  La logique du disjoncteur est simple.  Cliquez sur - 1er canal, cliquez sur - 2e canal, cliquez sur - les deux canaux.  Si 10 secondes se sont écoulées entre les clics, quel que soit le mode de fonctionnement sélectionné, les relais internes sont désactivés.  Il doit y avoir au moins 500 millisecondes et pas plus d'une seconde entre les clics.  Tout le travail est contrôlé par le courtier mqtt.  Données, température, humidité, pression atmosphérique, qui se colorent pour s'allumer sur les LED et quel canal pour allumer le lustre.  Tout cela peut être contrôlé ou lu à distance.  Bme280, en envoyant des données au courtier, vous permettra en outre de contrôler le climat du système. <br><br><div class="spoiler">  <b class="spoiler_title">Rétroéclairage photo</b> <div class="spoiler_text">  Jour. <br><br><img src="https://habrastorage.org/webt/7x/tl/mo/7xtlmothd7yhawwj8rr16lyjidi.jpeg" alt="image"><br><br>  Coucher de soleil <br><br><img src="https://habrastorage.org/webt/ax/si/bc/axsibclpfsvbhtjqcqf-bmxcqr0.jpeg" alt="image"><br><br>  Crépuscule civil <br><br><img src="https://habrastorage.org/webt/i6/am/td/i6amtdwfgkecgr_lljonwvighs8.jpeg" alt="image"><br><br>  Crépuscule nautique <br><br><img src="https://habrastorage.org/webt/hi/id/r_/hiidr_ujug6e6t2e7hfzlsodgio.jpeg" alt="image"><br><br></div></div><br>  Il n'y a rien d'intéressant dans le code source.  Abonnements et publications standard dans les sujets mqtt. <br>  Le projet est à domicile, donc je le traite à mesure que l'intérêt se fait sentir. <br><br><div class="spoiler">  <b class="spoiler_title">Sources.</b>  <b class="spoiler_title">Non recommandé pour la visualisation.</b>  <b class="spoiler_title">Prenez soin de vos nerfs.</b> <div class="spoiler_text">  Une première version du code source de vscode (PlatfornIO) peut être consultée sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">github</a> <br>  Un schéma du premier appareil sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">easyeda</a> <br></div></div></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr464317/">https://habr.com/ru/post/fr464317/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr464303/index.html">Données de séries chronologiques dans un SGBD relationnel. Extensions TimescaleDB et PipelineDB pour PostgreSQL</a></li>
<li><a href="../fr464305/index.html">Petit, oui. Déballage du pétard microvirtuel</a></li>
<li><a href="../fr464307/index.html">Test d'intégration de microservices sur Scala</a></li>
<li><a href="../fr464309/index.html">Bouton d'appel bricolage. Raspberry Pi, MajorDoMo, Freeswitch et Linphonec</a></li>
<li><a href="../fr464315/index.html">Le film dans lequel il y avait de la terre. Recherche sur Yandex et bref historique de la recherche par sens</a></li>
<li><a href="../fr464325/index.html">Comment Scrumban unit le meilleur des méthodologies Kanban et Scrum</a></li>
<li><a href="../fr464327/index.html">Comparaison de l'utilisation de la mémoire des différentes interfaces graphiques de la boîte à outils</a></li>
<li><a href="../fr464331/index.html">Avantages inutiles: synthèse de produits chimiques absorbant les UV à partir de noix de cajou</a></li>
<li><a href="../fr464333/index.html">Suivi du cycle de vie des utilisateurs sans pince ni ruban électrique</a></li>
<li><a href="../fr464335/index.html">Tests unitaires dans SGBD - comment nous le faisons dans Sportmaster, première partie</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>