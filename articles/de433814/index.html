<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ü§ê üê£ üöô So skalieren Sie Datenbanken in Yandex. Cloud ohne Ausfallzeiten. Beispiel mit drei Hosts üë©üèø‚Äçüî¨ üßòüèª üîì</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Der Beitrag wurde von Yandex.Cloud-Teammitgliedern vorbereitet: Ivan Vetkasov - Architekt, Leonid Klyuyev - Herausgeber 


 K√ºrzlich haben wir √ºber di...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>So skalieren Sie Datenbanken in Yandex. Cloud ohne Ausfallzeiten. Beispiel mit drei Hosts</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/yandex/blog/433814/"><h5>  <sub><sup><i>Der Beitrag wurde von Yandex.Cloud-Teammitgliedern vorbereitet: Ivan Vetkasov - Architekt, Leonid Klyuyev - Herausgeber</i></sup></sub> </h5><br><p><img src="https://habrastorage.org/webt/2e/4l/kn/2e4lkn7th9ia7axxyt1gjbb32qg.png" align="right" width="400">  K√ºrzlich haben wir √ºber die Architektur von <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Yandex.Cloud gesprochen</a> .  Gehen wir nun von der Theorie zur Praxis.  In der Cloud gibt es mehrere Dienste f√ºr die automatisierte DBMS-Steuerung: Managed Service f√ºr ClickHouse, Managed Service f√ºr PostgreSQL und Managed Service f√ºr MongoDB.  Alle sind plattformbasiert und erm√∂glichen es Ihnen, sich auf die Aufgabe der Datenspeicherung und nicht auf die Verwaltung der Infrastruktur zu konzentrieren.  Manchmal ist es jedoch wichtig, auch die virtuellen Clustermaschinen zu steuern.  Beispielsweise kann eine Skalierungsaufgabe als Reaktion auf eine Zunahme oder Abnahme der Last entstehen.  Normalerweise ist dieses Szenario aus praktischer Sicht eines der zeitaufw√§ndigsten.  Heute erfahren Sie, wie Sie mit Yandex.Cloud komplexe Skalierungsaufgaben automatisieren und sicherstellen k√∂nnen, dass die Datenbank w√§hrend der Gr√∂√üen√§nderung des Clusters verf√ºgbar bleibt. </p><br><p><a name="habracut"></a></p><h4>  Erkl√§rung des Problems </h4><br>  Beim Erstellen eines Clusters f√ºr jeden Dienst kann der Benutzer die Anzahl der Cluster-Hosts und die Verf√ºgbarkeitszone (AZ) bestimmen, die dem physischen Rechenzentrum entspricht.  Jetzt nutzt Yandex.Cloud drei Yandex-Rechenzentren in der Zentralregion Russlands.  Daher wird als DBMS-Cluster mit drei Hosts empfohlen. Dies entspricht den Grunds√§tzen f√ºr die Erstellung einer ausfallsicheren und katastrophenresistenten Architektur. <br><br>  Stellen Sie sich also eine Situation vor, in der die Auslastung des DBMS-Clusters die Funktionen der Datenbank √ºberstieg und es an der Zeit ist, Rechenressourcen hinzuzuf√ºgen.  Dies kann sowohl horizontal - durch Hinzuf√ºgen von Hosts zum Cluster als auch vertikal - durch Hinzuf√ºgen von Ressourcen zu jedem Cluster-Computer erfolgen.  Betrachten Sie die zweite Option als die zeitaufw√§ndigste und fehleranf√§lligste.  Warum ist diese Option m√ºhsam?  Denn im allgemeinen Fall sieht das Verfahren zum Hinzuf√ºgen von Ressourcen ungef√§hr so ‚Äã‚Äãaus: Wechseln Sie die Rolle des Hosts.  Stoppen Sie gegebenenfalls das DBMS.  Schalten Sie die virtuelle Maschine aus.  √Ñndern Sie die Konfiguration.  wir fangen an;  DBMS-Parameter √§ndern;  wir starten ein DBMS;  Wir warten auf die Synchronisation der akkumulierten Daten√§nderungen.  Und so f√ºr alle drei Gastgeber der Reihe nach.  Viele Schritte - das Fehlerrisiko ist hoch.  Sie k√∂nnen diesen Prozess automatisieren - erst vor dem Start muss die ausgew√§hlte Automatisierungsl√∂sung getestet werden.  Normalerweise bleibt nicht gen√ºgend Zeit zum Testen, aber in Yandex.Cloud l√§uft es schnell und ohne unn√∂tige Aktionen von Ihrer Seite.  Fangen wir an. <br><br><h4>  Vorbereitende Schritte und Testprozess </h4><br><p>  Zur Vorbereitung ben√∂tigen wir: </p><br><ul><li>  Zugang zur Plattform.  Jetzt kann jeder auf der Website <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">der Yandex.Cloud-Website eine Testphase einrichten</a> . </li><li>  Cloud-Netzwerk (in meinem Beispiel Testvpc) und drei Subnetze in verschiedenen AZs.  Die Bereiche der Subnetzadressen sind in diesem Fall nicht wichtig. </li><li> Bastion Gastgeber.  Trotz der Tatsache, dass Sie in Yandex.Cloud den externen Zugriff auf das DBMS √ºber eine √∂ffentliche IP-Adresse √∂ffnen k√∂nnen, ist die Ver√∂ffentlichung eines DBMS im √∂ffentlichen Bereich nicht die richtige Entscheidung.  Daher f√ºgen wir dem Schema einen Bastion-Host hinzu, von dem aus wir Verbindungen zu Hosts herstellen.  Als solcher Host k√∂nnen Sie einen Computer verwenden, auf dem der Kernel teilweise (5 Prozent) verwendet wird.  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Clickhouse-Client</a> muss auf der virtuellen Maschine installiert sein.  Dar√ºber hinaus m√ºssen Sie gem√§√ü den <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Anweisungen</a> zum Herstellen einer <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Verbindung</a> zum Dienst ein SSL-Zertifikat herunterladen. </li><li>  CLI  Wir werden mit Yandex.Cloud nicht √ºber die Konsole arbeiten, sondern √ºber das Befehlszeilenprogramm, das ebenfalls gem√§√ü der <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=de&amp;u=">Dokumentation</a> installiert und initiiert werden muss. </li></ul><br><p>  Das Testszenario ist einfach: √ñffnen Sie drei Sitzungen, die den Bastion-Host mit jedem Host des Datenbankclusters verbinden, f√ºhren Sie eine SQL-Abfrage in einem Zyklus mit einer Dauer von beispielsweise 1 Sekunde aus. Anschlie√üend senden wir einen Befehl, um den Cluster zu skalieren und das Verhalten des Systems zu untersuchen. </p><br><h4>  Moment der Wahrheit </h4><br><p>  W√§hlen Sie ein DBMS aus, um die Skalierung zu demonstrieren.  In PostgreSQL werden Hosts Rollen zugewiesen, aber der Dienst hat beim Skalieren noch keine transparente Umschaltung - diese Funktionalit√§t ist in unseren Pl√§nen enthalten.  Da der Rest der Mechanismen zum Erh√∂hen und Verringern des Clusters in allen drei DBMS ungef√§hr gleich ist, nehmen Sie beispielsweise ClickHouse. </p><br><p> Erstellen wir ein Experimentobjekt - einen Cluster, der aus drei Hosts besteht, die sich in verschiedenen virtuellen Subnetzen befinden.  Geben Sie dazu den Befehl ein <br>  <code>yc managed-clickhouse cluster create</code> mit den erforderlichen Argumenten.  Die Reihenfolge der Argumente entspricht ihrer Auflistung in der Ausgabe von "yc --help".  Das Wesentliche des Befehls ist einfach: Wir erstellen einen Cluster mit Gr√∂√üen√§nderung in einer Produktionsumgebung mit testvpc im virtuellen Netzwerk, legen einen Namen und ein Kennwort, 10 Gigabyte Speicherplatz und die Mindestklasse s1.nano fest.  Die folgenden Eigenschaften entsprechen dieser Klasse: 1 CPU, 4 GB RAM.  In Zukunft werden wir zur Skalierung zur Klasse s1.micro √ºbergehen, sodass sich die Anzahl der CPUs und des Arbeitsspeichers verdoppelt.  Um herauszufinden, welche anderen Hostklassen Sie zuweisen k√∂nnen, geben Sie einfach den Befehl ein <br>  <code>yc managed-clickhouse resource-preset list</code> . </p><br><p>  Daher sollte der Befehl zum Erstellen des Clusters wie folgt lauten: </p><br><pre> <code class="plaintext hljs">yc managed-clickhouse cluster create --name ch-to-resize --environment production --network-name testvpc --host zone-id=ru-central1-a,subnet-id=e9bfnjacigdo9p6j7j2s,assign-public-ip=false,type=clickhouse --host zone-id=ru-central1-b,subnet-id=e2l8iamol3b9mrtskb8q,assign-public-ip=false,type=clickhouse --host zone-id=ru-central1-c,subnet-id=b0c6qit7u9e8r0egedvj,assign-public-ip=false,type=clickhouse --user name=test,password=test123123 --database name=testdb --clickhouse-disk-size 10 --clickhouse-resource-preset s1.nano --clickhouse-disk-type network-nvme ‚Äìasync</code> </pre> <br><p>  Als Antwort erhalten wir die Cluster-ID und eine Liste der Hostnamen der Hosts: </p><br><pre> <code class="plaintext hljs">yc managed-clickhouse cluster list +----------------------+--------------+-----------------------------+--------+---------+ | ID | NAME | CREATED AT | HEALTH | STATUS | +----------------------+--------------+-----------------------------+--------+---------+ | c9q7cr4ji2fe462qej8p | ch-to-resize | 2018-12-10T08:59:09.100272Z | ALIVE | RUNNING | +----------------------+--------------+-----------------------------+--------+---------+ yc managed-clickhouse host list --cluster-id c9q7cr4ji2fe462qej8p +-------------------------------------------+----------------------+---------+---------------+ | NAME | CLUSTER ID | HEALTH | ZONE ID | +-------------------------------------------+----------------------+---------+---------------+ | rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | ALIVE | ru-central1-a | | rc1a-sgxazra54xv6lhni.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | UNKNOWN | ru-central1-a | | rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | ALIVE | ru-central1-b | | rc1b-j1rtvsuz6t8x6ev2.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | UNKNOWN | ru-central1-b | | rc1c-emo0f2990povj7ie.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | UNKNOWN | ru-central1-c | | rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net | c9q7cr4ji2fe462qej8p | ALIVE | ru-central1-c | +-------------------------------------------+----------------------+---------+---------------+</code> </pre> <br><p>  Lassen Sie uns eine Verbindung zu jedem Host herstellen und eine Abfrage an die Datenbank ausf√ºhren: </p><br><pre> <code class="plaintext hljs">clickhouse-client --host rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net --secure --user test --password test123123 --database testdb --port 9440 -q "select concat(host_name, ' is alive\!') from system.clusters where replica_num = 1" clickhouse-client --host rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net --secure --user test --password test123123 --database testdb --port 9440 -q "select concat(host_name, ' is alive!') from system.clusters where replica_num = 2" clickhouse-client --host rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net --secure --user test --password test123123 --database testdb --port 9440 -q "select concat(host_name, ' is alive\!') from system.clusters where replica_num = 3"</code> </pre> <br><p>  Senden Sie abschlie√üend eine Anfrage zum Erh√∂hen des Clusters: </p><br><pre> <code class="plaintext hljs">yc managed-clickhouse cluster update --id c9q7cr4ji2fe462qej8p --clickhouse-resource-preset s1.micro -‚Äìasync</code> </pre> <br><div class="spoiler">  <b class="spoiler_title">Erkl√§rung zur Clusterreduzierung</b> <div class="spoiler_text"><p>  Wenn wir die Menge der Ressourcen reduzieren m√∂chten, anstatt sie zu erh√∂hen, m√ºssen wir eine kleinere Klasse angeben, die sich auf die Ausgabe bezieht <br>  <code>yc managed-clickhouse resource-preset list</code> f√ºr <code>yc managed-clickhouse resource-preset list</code> - zum Beispiel s1.nano.  Gleichzeitig bleibt die Struktur des Teams selbst gleich. </p></div></div><br><p>  Ich habe die Abfrageausgabe in eine Datei umgeleitet.  Hier ist eine abgek√ºrzte Auflistung: </p><br><pre> <code class="plaintext hljs">rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net Mon Dec 10 12:47:35 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:36 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:37 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:38 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:39 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:47:40 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.7:9440: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:47:51 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.7:9440: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:02 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.7:9440: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:11 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:12 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:13 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:14 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:15 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:16 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:17 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net:9440, 192.168.58.7) Mon Dec 10 12:48:18 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:48:19 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! Mon Dec 10 12:48:20 UTC 2018 rc1c-wcxq53lq096m0o6h.mdb.yandexcloud.net is alive! rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net: Mon Dec 10 12:50:58 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:50:59 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:00 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:01 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:12 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:23 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:34 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.6:9440: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:35 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:36 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:37 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:38 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:39 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:40 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:41 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:42 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:43 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net:9440, 192.168.58.6) Mon Dec 10 12:51:44 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:45 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! Mon Dec 10 12:51:46 UTC 2018 rc1a-qysm9t78x5ybdb78.mdb.yandexcloud.net is alive! rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net: Mon Dec 10 12:49:15 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:16 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:17 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:18 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:49:19 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:30 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:41 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:52 UTC 2018 Code: 209. DB::NetException: Timeout: connect timed out: 192.168.58.8:9440: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:56 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:57 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:58 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:49:59 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:00 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:01 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:03 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:04 UTC 2018 Code: 210. DB::NetException: Connection refused: (rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net:9440, 192.168.58.8) Mon Dec 10 12:50:05 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:50:06 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive! Mon Dec 10 12:50:07 UTC 2018 rc1b-2t82xtpscgr4gi6j.mdb.yandexcloud.net is alive!</code> </pre> <br><p>  Die Liste zeigt die Momente, in denen jeder Host des Clusters ausgeschaltet ist (wenn das Verbindungszeitlimit beginnt), die Momente, in denen der Host eingeschaltet wird und ClickHouse mit dem Laden beginnt (wenn die Verbindung abgelehnt wird) (sowie die Momente, in denen der Host wieder in Betrieb geht).  Das Wichtigste ist die Trennung von Zeitr√§umen, in denen Hosts nicht verf√ºgbar waren.  W√§hrend der Skalierung standen mindestens zwei Hosts f√ºr die Ausf√ºhrung von Abfragen zur Verf√ºgung.  Dies ist in der Grafik zu sehen: </p><br><p><img src="https://habrastorage.org/webt/xg/u4/un/xgu4unmb8rsxd5sa2qhkr8ozy4s.png" alt="Bild"></p><br><h4>  Schlussfolgerungen und Best Practices </h4><br><p>  Die Entwicklung von Projekten mit Datenbanken beinhaltet auf den ersten Blick viel Routinearbeit.  Die Datenbank muss gepflegt werden, dh um Sicherungskopien zu erstellen, den Prozess der regelm√§√üigen DBMS-Aktualisierungen einzurichten usw. Cloud-Verwaltungsdienste wurden haupts√§chlich angezeigt, um diese zeitaufw√§ndigen Funktionen von Ihnen zu entfernen.  In einer realen Produktionsumgebung ist es jedoch n√ºtzlich, dass die Systeme nicht nur aus Service-Sicht handhabbar sind, sondern auch flexibel - auf steigende und fallende Lasten reagieren.  Wir haben dar√ºber gesprochen, wie die Leistung der Datenbank in Yandex.Cloud gesteigert werden kann, w√§hrend die Arbeitskapazit√§t des Projekts f√ºr Benutzer erhalten bleibt.  Wenn die Datenbank korrekt konfiguriert ist, steigt mit zunehmendem Datenverkehr die Menge der verf√ºgbaren Ressourcen und mit abnehmendem Wert - ein mehrfacher R√ºckgang, der auch Ihre Kosten senkt. </p><br><hr><br><p>  <em>Welche Cloud-basierten Ans√§tze, Tools oder Technologien m√∂chten Sie kennenlernen?</em>  <em>Schlagen Sie Themen in den Kommentaren f√ºr die folgenden Yandex.Cloud-Beitr√§ge vor.</em> </p></div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/de433814/">https://habr.com/ru/post/de433814/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../de433802/index.html">Wie und warum wir den Big Data Track beim Urban Tech Challenge Hackathon gewonnen haben</a></li>
<li><a href="../de433804/index.html">Mixture Density Networks</a></li>
<li><a href="../de433806/index.html">Wenn das Online-Archiv vergisst</a></li>
<li><a href="../de433808/index.html">5 h√§ufigste Fehler, die Programmierer beim Interview machen</a></li>
<li><a href="../de433810/index.html">Ein problemorientierter Ansatz f√ºr Projekte im Internet-Marketing</a></li>
<li><a href="../de433816/index.html">Wo kann die mobile Anwendung ver√∂ffentlicht werden?</a></li>
<li><a href="../de433818/index.html">Kompilieren und Ausf√ºhren von C # und Blazor in einem Browser</a></li>
<li><a href="../de433820/index.html">ECMAScript-Vorschlag: Array.prototype. {Flat, flatMap}</a></li>
<li><a href="../de433822/index.html">Komplette CMake-Anleitung. Dritter Teil: Testen und Verpacken</a></li>
<li><a href="../de433824/index.html">Habro Selbstmord. Warum 1C-Programmierer die Welt retten</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>