<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üë©üèæ üöô üëåüèª Allez s√©curiser 2FA sur la blockchain üë©üèΩ‚Äç‚öïÔ∏è üï£ ü§æ</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Les messages SMS sont la m√©thode d'authentification √† deux facteurs (2FA) la plus populaire. Il est utilis√© par les banques, les portefeuilles √©lectro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Allez s√©curiser 2FA sur la blockchain</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/476090/">  Les messages SMS sont la m√©thode d'authentification √† deux facteurs (2FA) la plus populaire.  Il est utilis√© par les banques, les portefeuilles √©lectroniques et cryptographiques, les bo√Ætes aux lettres et toutes sortes de services;  <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">le nombre d'utilisateurs de la m√©thode approche les 100%</a> . <br><br>  J'ai un tel d√©clenchement d'√©v√©nements est scandaleux, car cette m√©thode n'est pas s√ªre.  R√©affecter le num√©ro d'une carte SIM √† une autre a commenc√© au d√©but de l'√®re du mobile - c'est ainsi que le num√©ro est restaur√© lorsque la carte SIM est perdue.  R√©alisation des ¬´sp√©cialistes du sevrage de l'argent num√©rique¬ª: l'option ¬´√©craser les cartes SIM¬ª peut √™tre utilis√©e dans des stratag√®mes frauduleux.  Apr√®s tout, celui qui contr√¥le la carte SIM peut g√©rer les services bancaires en ligne, les portefeuilles √©lectroniques et m√™me la crypto-monnaie d'autres personnes.  Et vous pouvez reprendre le num√©ro d'une autre personne en soudoyant un employ√© des t√©l√©communications √† l'aide de fraude ou de faux documents. <br><br><img src="https://habrastorage.org/webt/sm/lg/oh/smlgohi_vtrtginwsqvp3t2jqy8.png"><br><br>  Des milliers d'√©pisodes d'√©change de cartes SIM ont √©t√© d√©couverts - c'est ainsi que ce syst√®me de fraude a √©t√© appel√©.  L'ampleur de la catastrophe sugg√®re que le monde abandonnera bient√¥t le 2FA via SMS.  Mais cela ne se produit pas - l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©tude</a> indique que ce ne sont pas les utilisateurs qui choisissent la m√©thode 2FA, mais les propri√©taires de services. <br><br>  Nous vous sugg√©rons d'utiliser la m√©thode s√©curis√©e 2FA avec la livraison de codes uniques via la blockchain, et nous vous indiquerons comment le connecter au propri√©taire du service. <br><a name="habracut"></a><br><h2>  La facture va √† des millions </h2><br>  En 2019, la fraude par √©change de cartes SIM a augment√© de 63% selon la police de Londres, et le ¬´ch√®que moyen¬ª de l'attaquant √©tait de 4 000 GBP.  Je n'ai pas trouv√© de statistiques en Russie, mais je suppose que c'est encore pire. <br><br>  L'√©change de cartes SIM est utilis√© pour voler des comptes Twitter, Instagram, Facebook, VK, des comptes bancaires populaires et a r√©cemment atteint les crypto-monnaies, <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">rapporte le journal Times</a> de l'entrepreneur Bitcoin Joby Weeks.  Des cas tr√®s connus de vol de crypto-monnaies √† l'aide du swap SIM ont fait surface dans la presse depuis 2016;  en 2019 est venu un vrai pic. <br><br>  En mai, des procureurs am√©ricains du district oriental du Michigan ont <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">inculp√©</a> neuf jeunes √¢g√©s de 19 √† 26 ans: ils appartiendraient √† un gang de hackers appel√© The Community.  Le gang est accus√© de sept attaques de swap, √† la suite desquelles les pirates se sont appropri√©s une crypto-monnaie d'une valeur de plus de 2,4 millions de dollars.  Et en avril, un √©tudiant de Californie, Joel Ortiz, a √©t√© condamn√© √† 10 ans de prison pour √©change de carte SIM;  7,5 millions de dollars de crypto-monnaies sont devenus sa proie. <br><br><img src="https://habrastorage.org/webt/xy/b4/61/xyb4614ligd5ao0hslycslmxq3u.jpeg"><br>  <i>Photo de Joel Ortiz lors d'une conf√©rence de presse universitaire.</i>  <i>Deux ans plus tard, il sera d√©tenu pour cyber-fraude.</i> <br><br><h2>  Le principe du swap SIM </h2><br>  L'√©change signifie l'√©change.  Dans tous ces syst√®mes, les criminels attribuent le num√©ro de t√©l√©phone d'une victime, g√©n√©ralement en r√©√©mettant une carte SIM, et l'utilisent pour r√©initialiser un mot de passe.  Un √©change de carte SIM typique en th√©orie ressemble √† ceci: <br><br><ol><li>  Intelligence.  Les fraudeurs d√©couvrent les donn√©es personnelles de la victime: nom et t√©l√©phone.  Ils peuvent √™tre trouv√©s dans des sources ouvertes (r√©seaux sociaux, amis) ou obtenus aupr√®s d'un complice - un employ√© d'un op√©rateur mobile. </li><li>  Blocage.  La carte SIM de la victime est d√©sactiv√©e;  Pour ce faire, il suffit d'appeler le support technique du fournisseur, de signaler le num√©ro et de dire que le t√©l√©phone a √©t√© perdu. </li><li>  Capturez, transf√©rez des num√©ros sur votre carte SIM.  Habituellement, cela se fait √©galement par le biais d'un complice dans une entreprise de t√©l√©communications ou en falsifiant des documents. </li></ol><br>  Dans la vraie vie, c'est encore plus grave.  Les attaquants s√©lectionnent une victime, puis surveillent quotidiennement l'emplacement du t√©l√©phone - une demande d'informations que l'abonn√© est pass√© en itin√©rance co√ªte 1-2 cents.  D√®s que le propri√©taire de la carte SIM est parti √† l'√©tranger, il convient avec le responsable du salon de la communication d'√©mettre une nouvelle carte SIM.  Cela co√ªte environ 50 $ (j'ai trouv√© des informations - dans diff√©rents pays et de diff√©rents op√©rateurs de 20 $ √† 100 $), alors que le gestionnaire sera renvoy√© dans le pire des cas - il n'y a aucune responsabilit√©. <br><br>  D√©sormais, tous les intrus recevront tous les SMS et le propri√©taire du t√©l√©phone ne pourra rien y faire - il est √† l'√©tranger.  Et puis les m√©chants ont acc√®s √† tous les comptes de la victime et, si d√©sir√©, changent les mots de passe. <br><br><h2>  Chances de restituer les biens vol√©s </h2><br>  Les banques vont parfois vers les victimes et retirent les virements de leurs comptes.  Par cons√©quent, il est possible de restituer de l'argent fiduciaire, m√™me si le contrevenant n'est pas trouv√©.  Mais avec les portefeuilles de crypto-monnaie, tout est plus compliqu√© - √† la fois <i>techniquement</i> et l√©galement.  Jusqu'√† pr√©sent, aucun √©change / portefeuille n'a vers√© d'indemnisation pour √©changer les victimes. <br><br>  Si les victimes veulent d√©fendre leur argent devant les tribunaux, alors elles accusent l'op√©rateur: il a cr√©√© les conditions pour le vol d'argent sur le compte.  C'est exactement ce qu'a fait <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Michael Turpin</a> , qui a perdu 224 millions de dollars √† cause du swap. Il poursuit maintenant la soci√©t√© de t√©l√©communications AT&amp;T. <br><br><img src="https://habrastorage.org/webt/1d/bx/cp/1dbxcp8cbskbzhc8dlpwm3rqggm.png"><br><br>  Jusqu'√† pr√©sent, aucun √âtat n'a de plans de travail pour prot√©ger l√©galement les propri√©taires de crypto-monnaie.  Il est impossible d'assurer votre capital ou de recevoir une compensation pour sa perte.  Par cons√©quent, il est plus facile de pr√©venir une attaque par √©change que d'en combattre les cons√©quences.  La mani√®re la plus √©vidente est d'utiliser un ¬´deuxi√®me facteur¬ª plus fiable pour 2FA. <br><br><h2>  L'√©change de cartes SIM n'est pas le seul probl√®me 2FA via SMS </h2><br>  Les codes de confirmation dans SMS sont √©galement dangereux d'un point de vue technique.  Les messages peuvent √™tre intercept√©s en raison de vuln√©rabilit√©s fatales dans Signaling System 7 (SS7).  2FA par SMS est officiellement reconnu comme dangereux (le National Institute of Standards and Technology des √âtats-Unis en parle dans son <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">guide d'authentification num√©rique</a> ). <br><br>  De plus, la pr√©sence de 2FA inspire souvent √† l'utilisateur un sentiment de fausse s√©curit√©, et il choisit un mot de passe plus simple.  Par cons√©quent, une telle authentification ne complique pas, mais facilite l'acc√®s d'un attaquant au compte. <br><br>  Et souvent, les SMS arrivent avec un long retard ou ne viennent pas du tout. <br><br><h2>  Autres m√©thodes 2FA </h2><br>  Bien s√ªr, sur les smartphones et les SMS, la lumi√®re n'a pas converg√©.  Il existe d'autres m√©thodes 2FA.  Par exemple, codes TAN √† usage unique: la m√©thode est primitive, mais fonctionne - elle est toujours utilis√©e dans certaines banques.  Il existe des syst√®mes utilisant des donn√©es biom√©triques: empreintes digitales, scintigraphies r√©tiniennes.  Une autre option qui semble √™tre un compromis raisonnable en termes de commodit√©, de fiabilit√© et de prix est les applications sp√©ciales pour 2FA: RSA Token, Google Authenticator.  Et il y a des cl√©s physiques et d'autres m√©thodes. <br><br>  En th√©orie, tout semble logique et fiable.  Mais dans la pratique, les solutions 2FA modernes ont des probl√®mes, et √† cause d'eux, la r√©alit√© est diff√©rente des attentes. <br><br>  Selon l' <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">√©tude</a> , l'utilisation de 2FA est un inconv√©nient en principe, et la popularit√© de 2FA via SMS s'explique par ¬´moins de d√©sagr√©ments par rapport aux autres m√©thodes¬ª - la r√©ception de codes √† usage unique est compr√©hensible pour l'utilisateur. <br><br>  De nombreux utilisateurs de m√©thodes 2FA s'associent √† la crainte que l'acc√®s ne soit perdu.  Une cl√© physique ou une liste de mots de passe TAN peut √™tre perdue ou vol√©e.  J'ai personnellement une exp√©rience n√©gative en utilisant Google Authenticator.  Mon premier smartphone avec cette application est tomb√© en panne - √©valuez mes efforts pour restaurer l'acc√®s aux comptes.  Un autre probl√®me est la transition vers un nouvel appareil.  Google Authenticator n'est pas en mesure d'exporter en raison de probl√®mes de s√©curit√© (si les cl√©s peuvent √™tre export√©es, quel type de s√©curit√© existe-t-il?)  Une fois que j'ai transf√©r√© les cl√©s manuellement, j'ai d√©cid√© qu'il √©tait plus facile de laisser l'ancien smartphone dans une bo√Æte sur une √©tag√®re. <br><br>  La m√©thode 2FA doit √™tre: <br><br><ul><li>  S√ªr - vous seul devez avoir acc√®s √† votre compte, pas aux attaquants </li><li>  Fiable - vous avez acc√®s √† votre compte chaque fois que vous en avez besoin </li><li>  Pratique et abordable - l'utilisation de 2FA est claire et prend un minimum de temps </li><li>  Bon march√© </li></ul><br>  Nous pensons que la blockchain est la bonne solution. <br><br><h2>  Utilisez 2FA sur la blockchain </h2><br>  Pour un utilisateur, 2FA sur la blockchain ressemble √† la r√©ception de codes √† usage unique par SMS.  La seule diff√©rence est dans le canal de livraison.  La fa√ßon d'obtenir un code 2FA d√©pend de ce que propose la blockchain.  Dans notre projet (les informations se trouvent dans mon profil) il s'agit d'une application Web, Tor, iOS, Android, Linux, Windows, MacOS. <br><br>  Le service g√©n√®re un code unique et l'envoie au messager sur la blockchain.  De plus, selon les classiques: l'utilisateur entre le code re√ßu dans l'interface de service et se connecte. <br><br><img src="https://habrastorage.org/webt/4a/yq/ph/4ayqphaul5iozz1f_v2g0q4ziqw.png"><br><br>  Dans l'article <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">Comment fonctionne un messager d√©centralis√© sur la blockchain,</a> j'ai √©crit que la blockchain garantit la s√©curit√© et la confidentialit√© de la messagerie.  Concernant l'envoi de codes 2FA, je soulignerai: <br><br><ul><li>  Un clic pour cr√©er un compte - pas de t√©l√©phones ni de courriels. </li><li>  Tous les messages avec des codes 2FA sont chiffr√©s de la courbe de bout en bout25519xsalsa20poly1305. </li><li>  L'attaque MITM est exclue - chaque message avec un code 2FA est une transaction sur la blockchain et est sign√© par Ed25519 EdDSA. </li><li>  Un message avec un code 2FA tombe dans son bloc.  La s√©quence et l'horodatage des blocs ne peuvent pas √™tre fix√©s, et donc l'ordre des messages. </li><li>  Il n'y a pas de structure centrale qui v√©rifie ¬´l'authenticit√©¬ª d'un message.  Cela se fait par un syst√®me de n≈ìuds distribu√©s consensuel et appartient aux utilisateurs. </li><li>  Impossibilit√© de d√©sactiver - les comptes ne peuvent pas √™tre bloqu√©s et les messages peuvent √™tre supprim√©s. </li><li>  Acc√©dez √† tout moment aux codes 2FA depuis n'importe quel appareil. </li><li>  Message de confirmation de livraison avec code 2FA.  Un service qui envoie un mot de passe √† usage unique sait avec certitude qu'il a √©t√© d√©livr√©.  Aucun bouton ¬´Soumettre √† nouveau¬ª. </li></ul><br>  Pour comparaison avec d'autres m√©thodes 2FA, j'ai compil√© un tableau: <br><br><img src="https://habrastorage.org/webt/pl/am/tm/plamtmeiv5xnjmupd5bevfrpftu.png"><br><br>  L'utilisateur re√ßoit un compte dans le messager blockchain pour recevoir des codes dans une seconde - seule la phrase secr√®te est utilis√©e pour entrer.  Par cons√©quent, les m√©thodes d'application peuvent √™tre diff√©rentes: vous pouvez utiliser un compte pour obtenir des codes pour tous les services, ou vous pouvez cr√©er un compte distinct pour chaque service. <br><br>  Il y a aussi un inconv√©nient - un compte doit avoir au moins une transaction.  Pour que l'utilisateur re√ßoive un message crypt√© avec un code, vous devez conna√Ætre sa cl√© publique et il n'appara√Æt dans la blockchain qu'avec la premi√®re transaction.  Nous sommes sortis de cette fa√ßon: ils nous ont donn√© la possibilit√© d'obtenir des jetons gratuits dans notre portefeuille.  Cependant, une solution plus correcte consiste √† nommer le compte une cl√© publique.  (√Ä titre de comparaison, notre num√©ro de compte <i>U1467838112172792705</i> est un d√©riv√© de la cl√© publique <i>cc1ca549413b942029c4742a6e6ed69767c325f8d989f7e4b71ad82a164c2ada</i> . Pour le messager, c'est plus pratique et lisible, mais pour le syst√®me d'envoi de codes 2FA).  Je pense qu'√† l'avenir, quelqu'un prendra une telle d√©cision et transf√©rera ¬´Commodit√© et accessibilit√©¬ª dans la zone verte. <br><br>  L'envoi d'un code 2FA est tr√®s faible - 0,001 ADM, il est maintenant de 0,00001 USD.  Encore une fois, vous pouvez augmenter votre blockchain et rendre le prix nul. <br><br><h2>  Comment connecter 2FA sur la blockchain √† votre service </h2><br>  J'esp√®re avoir pu int√©resser quelques lecteurs √† ajouter l'autorisation blockchain √† leurs services. <br><br>  Je vais vous dire comment faire en utilisant l'exemple de notre messager, et par analogie, vous pouvez utiliser une autre blockchain.  Dans l'application de d√©monstration 2FA, nous utilisons postgresql10 pour stocker les informations de compte. <br><br>  √âtapes de connexion: <br><br><ol><li>  Cr√©ez un compte sur la blockchain √† partir de laquelle vous enverrez des codes 2FA.  Vous recevrez un passfrase, qui est utilis√© comme cl√© priv√©e pour crypter les messages avec des codes et pour signer des transactions. </li><li>  Ajoutez un script √† votre serveur pour g√©n√©rer des codes 2FA.  Si vous utilisez d√©j√† une autre m√©thode 2FA avec une remise de mot de passe unique, cette √©tape est d√©j√† termin√©e. </li><li>  Ajoutez un script √† votre serveur pour envoyer des codes √† l'utilisateur dans le messager blockchain. </li><li>  Cr√©ez une interface utilisateur pour l'envoi et la saisie du code 2FA.  Si vous utilisez d√©j√† une autre m√©thode 2FA avec une remise de mot de passe unique, cette √©tape est d√©j√† termin√©e. </li></ol><br>  <b>1 Cr√©ez un compte</b> <br><br>  La cr√©ation d'un compte dans la blockchain est la g√©n√©ration d'une cl√© priv√©e, d'une cl√© publique et d'une adresse de compte qui en d√©rive. <br><br><img src="https://habrastorage.org/webt/7o/at/vs/7oatvsalils_l9wsl8av5cjqtkc.png"><br><br>  Tout d'abord, la phrase secr√®te BIP39 est g√©n√©r√©e, √† partir de laquelle le hachage SHA-256 est pris en compte.  Le hachage est utilis√© pour g√©n√©rer la cl√© priv√©e ks et la cl√© publique kp.  De la cl√© publique avec le m√™me SHA-256 avec inversion, nous obtenons l'adresse dans la blockchain. <br><br>  Si vous souhaitez envoyer des codes 2FA √† chaque fois depuis un nouveau compte, le code de cr√©ation d'un compte devra √™tre ajout√© au serveur: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Mnemonic <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bitcore-mnemonic'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.passphrase = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Mnemonic(Mnemonic.Words.ENGLISH).toString() ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> bip39 <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'bip39'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> crypto <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'crypto'</span></span> adamant.createPassphraseHash = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">passphrase</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> seedHex = bip39.mnemonicToSeedSync(passphrase).toString(<span class="hljs-string"><span class="hljs-string">'hex'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> crypto.createHash(<span class="hljs-string"><span class="hljs-string">'sha256'</span></span>).update(seedHex, <span class="hljs-string"><span class="hljs-string">'hex'</span></span>).digest() } ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sodium <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'sodium-browserify-tweetnacl'</span></span> adamant.makeKeypair = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">hash</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> keypair = sodium.crypto_sign_seed_keypair(hash) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-attr"><span class="hljs-attr">publicKey</span></span>: keypair.publicKey, <span class="hljs-attr"><span class="hljs-attr">privateKey</span></span>: keypair.secretKey } } ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> crypto <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'crypto'</span></span> adamant.getAddressFromPublicKey = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">publicKey</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> publicKeyHash = crypto.createHash(<span class="hljs-string"><span class="hljs-string">'sha256'</span></span>).update(publicKey, <span class="hljs-string"><span class="hljs-string">'hex'</span></span>).digest() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> temp = Buffer.alloc(<span class="hljs-number"><span class="hljs-number">8</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">8</span></span>; i++) { temp[i] = publicKeyHash[<span class="hljs-number"><span class="hljs-number">7</span></span> - i] } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">'U'</span></span> + bignum.fromBuffer(temp).toString() }</code> </pre> <br>  Dans l'application de d√©monstration, nous l'avons simplifi√©e: nous avons cr√©√© un compte dans l'application Web et envoy√© les codes √† partir de celle-ci.  Dans la plupart des cas, cela est plus pratique pour l'utilisateur: il sait que le service envoie des codes 2FA √† partir d'un compte sp√©cifique et peut le nommer. <br><br><img src="https://habrastorage.org/webt/j6/0p/pi/j60ppi_a1zvkc-ifcrdxkaz8ow8.png"><br><br>  <b>2 g√©n√©ration de codes 2FA</b> <br><br>  Le code 2FA doit √™tre g√©n√©r√© pour chaque connexion utilisateur.  Nous utilisons la biblioth√®que <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">speakeasy</a> , mais vous pouvez en choisir une autre. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> hotp = speakeasy.hotp({ counter, <span class="hljs-attr"><span class="hljs-attr">secret</span></span>: account.seSecretAscii, });</code> </pre><br>  Validation du code utilisateur 2FA saisi par l'utilisateur: <br><br><pre> <code class="javascript hljs">se2faVerified = speakeasy.hotp.verify({ <span class="hljs-attr"><span class="hljs-attr">counter</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.seCounter, <span class="hljs-attr"><span class="hljs-attr">secret</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.seSecretAscii, <span class="hljs-attr"><span class="hljs-attr">token</span></span>: hotp, });</code> </pre><br>  <b>3 Soumettre le code 2FA</b> <br><br>  Vous pouvez utiliser l'API du n≈ìud de la cha√Æne de blocs, la biblioth√®que d'API JS ou la console pour envoyer du code 2FA.  Dans cet exemple, nous utilisons la console - il s'agit de l'interface de ligne de commande, un utilitaire qui simplifie l'interaction avec la blockchain.  Pour envoyer un message avec un code 2FA, vous devez utiliser la commande d' <code>send message</code> de la console. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> util = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'util'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> exec = util.promisify(<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'child_process'</span></span>).exec); ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> command = <span class="hljs-string"><span class="hljs-string">`adm send message </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${adamantAddress}</span></span></span><span class="hljs-string"> "2FA code: </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${hotp}</span></span></span><span class="hljs-string">"`</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> { error, stdout, stderr } = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> exec(command);</code> </pre><br>  Une autre fa√ßon d'envoyer des messages consiste √† utiliser la m√©thode d' <code>send</code> dans la biblioth√®que d'API JS. <br><br>  <b>4 interface utilisateur</b> <br><br>  L'utilisateur doit avoir la possibilit√© d'entrer le code 2FA, cela peut se faire de diff√©rentes mani√®res en fonction de la plate-forme de votre application.  Dans notre exemple, c'est Vue. <br><br><img src="https://habrastorage.org/webt/1g/yb/yv/1gybyvcmjucrqilrcpo74k8onoy.png"><br><br>  Le code source de l'application de d√©monstration de l'autorisation √† deux facteurs sur la blockchain peut √™tre consult√© sur <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=fr&amp;u=">GitHub</a> .  Il y a un lien sur la d√©mo Live dans le fichier Lisezmoi pour l'essayer. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr476090/">https://habr.com/ru/post/fr476090/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr476060/index.html">Nouvelles du monde d'OpenStreetMap n ¬∞ 485 (10.29.2019 - 04.11.2019)</a></li>
<li><a href="../fr476074/index.html">Voiture √©lectrique faite maison - partie 1</a></li>
<li><a href="../fr476076/index.html">Trop propre?</a></li>
<li><a href="../fr476082/index.html">Array.splice et Array.slice en JavaScript</a></li>
<li><a href="../fr476088/index.html">Conf√©rence BLACK HAT USA. Devenez riche ou mourez: gagnez de l'argent sur Internet en utilisant Black Hat. Partie 1</a></li>
<li><a href="../fr476092/index.html">√Ä propos des directions ¬´Photonique¬ª, ¬´Programmation et informatique¬ª et ¬´Information et cybers√©curit√©¬ª de l'Olympiade ¬´Je suis un professionnel¬ª</a></li>
<li><a href="../fr476094/index.html">Le retour de l'√®re des empires: tout sur l'√®re des empires IV</a></li>
<li><a href="../fr476096/index.html">Inventaire de I √† Z. Nous consid√©rons les actifs informatiques</a></li>
<li><a href="../fr476098/index.html">Structures de donn√©es en Java. M√©thodes de classe d'assistance utiles</a></li>
<li><a href="../fr476100/index.html">Architecture des syst√®mes informatiques 1 partie. Portes logiques</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>