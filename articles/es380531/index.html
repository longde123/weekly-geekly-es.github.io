<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🙏🏿 🏬 👓 Bus Blaster: interfaz universal de bits rápidos para entusiastas de los pacientes 🔻 👩🏼‍💼 🧔🏽</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hace tiempo que quería tener algún tipo de interfaz de hardware simple y universal con varias señales de entrada y salida, cuya funcionalidad está det...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Bus Blaster: interfaz universal de bits rápidos para entusiastas de los pacientes</h1><div class="post__body post__body_full">
      <div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/post/380531/"><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><img src="https://habrastorage.org/files/b33/9c7/eb4/b339c7eb476640b9b5b17baa63513427.jpg" width="500"></a><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Hace tiempo que quería tener algún tipo de interfaz de hardware simple y universal con varias señales de entrada y salida, cuya funcionalidad está determinada exclusivamente por el software, como el memorable programador </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PonyProg</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Y para que pueda usarse no solo como firmware de lectura / escritura, sino también para depurar programas a través de JTAG. </font><font style="vertical-align: inherit;">Al mismo tiempo, comprar algo industrial, con mis mimos ocasionales con la electrónica, es redundante y no rentable: requería algo de una serie de "productos semiacabados" basados ​​en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bit-bang</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<div class="spoiler"><b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">¿Qué es bit bang y por qué es necesario?</font></font></b><div class="spoiler_text">-  ,     Windows 9x            (COM)   (LPT) .         ,               ,   .      ,             ,     .      bit-bang,    — «», «»  ..<br>
<br>
   2k/XP        /,       <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b>giveio</b></a>.          NT, -        . <br>
</div></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como saben, las computadoras modernas, especialmente las computadoras portátiles, con puertos de hardware no están llenas, porque la mayoría de los usuarios no las necesitan. Los adaptadores USB para conectar dispositivos con interfaces RS232 y Centronics (coloquialmente - COM / LPT) funcionan bien solo en el marco del propósito principal, y hacerlos "sacudidos" es problemático por varias razones. En primer lugar, la mayoría de estos adaptadores solo pueden procesar señales de datos (el mismo Tx / Rx) con buena velocidad, y procesa las señales de control con grandes retrasos. En segundo lugar, los adaptadores de diferentes fabricantes son incompatibles con el hardware, y las posibilidades de control no estándar a través del controlador del fabricante son muy limitadas. En tercer lugar, casi todos los controladores usan paquetes USB separados para enviar comandos al adaptador, lo que limita la frecuencia de los cambios de estado a solo mil veces por segundo,que para muchas aplicaciones es catastróficamente pequeño.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Afortunadamente, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FTDI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ha estado ofreciendo durante mucho tiempo una gama de soluciones USB que se centran específicamente en el intercambio de señales arbitrarias a alta velocidad. </font><font style="vertical-align: inherit;">Un estudio rápido del problema mostró que los más populares a este respecto son las interfaces en los </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">microcircuitos </font></a></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FT232H</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> / </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FT2232H</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<a name="habracut"></a><br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Soluciones simples</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Inicialmente, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">FTDI</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> implementó en sus interfaces USB FT232BM, FT232R y otros dos modos adicionales: bit-bang asíncrono y síncrono. Para esto, se agregan ocho o más líneas de señal adicionales, cada una de las cuales se puede configurar para entrada o salida. Los datos almacenados en el búfer transmitidos a la interfaz desde la computadora se establecen en las líneas de salida mediante las señales del reloj, los datos de entrada se leen desde las líneas, se almacenan en el búfer y se envían a la computadora. La vinculación de E / S al reloj proporciona una buena precisión de intervalos: la aplicación ya no necesita ocuparse de mantenerlos mediante programación.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Por lo tanto, en lugar del ciclo tradicional del tipo "establezca el nivel activo en la línea de salida; </font><font style="vertical-align: inherit;">pausa; </font><font style="vertical-align: inherit;">leer el estado de la línea de entrada; </font><font style="vertical-align: inherit;">establecer el nivel pasivo en la línea de salida ", la aplicación genera una secuencia de bytes, cada uno de los cuales establece el estado de las líneas de salida para un período de reloj. </font><font style="vertical-align: inherit;">La secuencia se envía a la interfaz, y desde allí se lee la misma secuencia, lo que refleja el estado de las líneas de entrada. </font><font style="vertical-align: inherit;">En modo asíncrono, la entrada y la salida se producen de forma independiente. </font><font style="vertical-align: inherit;">La lectura sincronizada de las entradas se realiza inmediatamente antes de configurar las señales en las salidas, lo que permite un trabajo más confiable con señales que cambian rápidamente.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Controlador MPSSE</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En la versión H de los chips FTDI, </font><font style="vertical-align: inherit;">se </font><font style="vertical-align: inherit;">agrega un controlador serie síncrono </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">multiprotocolo</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">MPSSE</font></a><font style="vertical-align: inherit;"> ), que el hardware implementa varios modos de reloj y de intercambio de datos. La formación de las señales del protocolo deseado se lleva a cabo transmitiendo al controlador una serie de sus comandos internos que especifican los métodos de temporización, la temporización de las señales de configuración / lectura (en la parte frontal o inferior del pulso del reloj), el orden de transmisión de bits (LSB / MSB). El controlador devuelve una secuencia de "instantáneas" de las líneas de entrada. La velocidad de transferencia de datos puede alcanzar los 30 Mbps. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A través de MPSSE, los protocolos </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JTAG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I2C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font><b><font style="vertical-align: inherit;">SPI</font></b><font style="vertical-align: inherit;"> se implementan de forma más natural.</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sin embargo, casi cualquier "sacudida" se puede implementar fácilmente dentro de las capacidades de hardware del controlador. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
FTDI ofrece una amplia </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentación</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sobre la conexión y programación de sus interfaces, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bibliotecas y programas de muestra para trabajar a través de MPSSE para Windows, Linux y MacOS</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controladores D2XX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para la interacción directa con la interfaz. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Las interfaces FTDI son compatibles con los programas populares </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OpenOCD</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UrJTAG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flashrom</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avrdude</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">HappyJTAG2</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">zJTAG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , etc.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Problemas de conectividad</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después de descubrir todo lo anterior en detalle el año pasado, me inspiré, pero inmediatamente descubrí que el FT232H / FT2232H, con toda su versatilidad, no siempre se puede conectar directamente al dispositivo final. En primer lugar, las líneas externas de los circuitos están diseñadas para el nivel de 3.3 V, y en muchos dispositivos modernos se usan los niveles de 2.5 / 1.8 / 1.5 V. En segundo lugar, las líneas de salida no pueden cambiar al estado de alta impedancia y viceversa con alta frecuencia; esto es posible solo en el inicio establecer líneas seleccionando el modo "entrada" o "salida". Es decir, para conectar un chip con MPSSE al dispositivo de destino, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> necesita un </font><b><font style="vertical-align: inherit;">circuito buffer</font></b><font style="vertical-align: inherit;"> que coincida con los niveles de señal y proporcione un apagado operativo de algunas líneas de salida (por ejemplo, con un nivel de señal </font><b><font style="vertical-align: inherit;">TMS</font></b><font style="vertical-align: inherit;"> pasivo</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">/ </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cs</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Buscando en Google las opciones para los circuitos de buffer, descubrí que se han hecho una increíble cantidad de adaptadores en el mundo, que solo difieren en este buffer. </font><font style="vertical-align: inherit;">Algunos programas (pero no todos) permiten el uso de diferentes tipos de buffers. </font><font style="vertical-align: inherit;">Por lo tanto, al elegir un modelo de adaptador específico, al mismo tiempo limita el rango de programas que funcionarán con él. </font><font style="vertical-align: inherit;">Y para decidir el tipo de antemano, fue necesario nuevamente buscar en Google cuidadosamente y leer las discusiones en los foros, lo que no quería hacer en absoluto. </font><font style="vertical-align: inherit;">Algunos adaptadores permitieron establecer la configuración del búfer con puentes, pero esto está lleno de errores y no son baratos.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bus Blaster: reclamo de versatilidad</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
La idea masculina de los </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">prototipos peligrosos</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> fue original dos veces: la primera, como un búfer conectado al chip FT2232H </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PLD (CPLD) </font></font></a><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Xilinx XC2C32A</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que puede reprogramarse rápidamente en cualquier configuración, y la segunda, para su uso, reprogramación del segundo canal FT2232H. Además de implementar la lógica del búfer, el FPGA realiza una coincidencia de nivel: sus líneas externas operan en el rango de 1.5-3.3 V. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado, la placa </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">Bus Blaster</font></a><font style="vertical-align: inherit;"> resultó</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Desde la llegada del proyecto, se han reemplazado cuatro versiones del tablero. La versión 3 se considera la más estable y extendida, la versión 4 contiene un gran FPGA que no está completamente desarrollado y se usa con mucha menos frecuencia. Las próximas versiones, aparentemente, ya no lo serán, ya que el desarrollo del proyecto se detuvo hace un par de años. Me dio la impresión de que pocas personas realmente probaron la placa; con su alto potencial, no es demasiado fácil de usar. Se </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ha</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> creado una </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">sección del foro</font></a><font style="vertical-align: inherit;"> para la junta </font><font style="vertical-align: inherit;">, pero desde el año pasado casi nada se ha escrito allí. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Tras reflexionar, pedí en la </font><font style="vertical-align: inherit;">versión </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AliExpress </font></font></a><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3c</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , como la más desarrollada, por $ 34. Luego fueron vendidos allí por una tienda del fabricante: </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Seeed</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , y ahora solo los vendedores de $ 52 lo venden.</font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Directamente en Seeed</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (junto con el envío) costará alrededor de $ 37.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Primeras impresiones</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
El tablero se ve exactamente igual que en la imagen: hermoso, ordenado, hecho con alta calidad. En el foro, alguien se quejó de la falta de salida del microcircuito, por lo que examiné cuidadosamente debajo de una lupa; no encontré ningún defecto. </font><font style="vertical-align: inherit;">Ya tenía los </font></font><br>
<br>
<a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">controladores D2XX</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> instalados anteriormente, por lo que la placa se reconoció sobre la </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">marcha</font></a><font style="vertical-align: inherit;"> . El primer paso fue lidiar con la lógica del búfer de programación en FPGA. Esto se hace utilizando el programa </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UrJTAG</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero especialmente ajustado para Bus Blaster para un acceso adecuado al segundo canal FT2232H. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Primero debe descargar e instalar la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">versión básica de UrJTAG</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Luego debe agregar un archivo EXE modificado y una descripción de FPGA (BSDL) desde </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">este paquete</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Para programar el FPGA integrado, debe ejecutar un EXE modificado para trabajar con dispositivos externos, el principal. El procedimiento de programación FPGA se describe </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aquí</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Para mayor comodidad, puede crear scripts para UrJTAG para cada versión del búfer y archivos CMD con líneas de comando para ejecutarlos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una colección de FPGA Firmware que describe tampones compatibles con </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JTAGkey</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KT-Link,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">adaptadores PicoTap</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> está disponible </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aquí</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , pero para BBv3 sólo hay un archivo para JTAGkey con soporte para la auto-prueba (BBV3-JTAGkey-autocomprobación-v1.1.svf). La mayor parte es suficiente, pero no funcionó para mí con </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flashrom</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que se analizará a continuación.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después de escribir este firmware en el FPGA, puse puentes en el conector para la autocomprobación, como se describe en la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentación</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , cerré la línea P28 (IO09) al suelo: el LED de la placa se iluminó. </font><font style="vertical-align: inherit;">Descargué y lancé </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">el programa de prueba</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : mostró que todo está en orden. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Es extraño, por cierto, que el programa de autocomprobación se llame "BusPiratev2Test", porque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bus Pirate</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> es un proyecto completamente diferente, no compatible con </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BB</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al principio, generalmente creía que este firmware estaba destinado </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">solo</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> para autocomprobación, y para aplicaciones "militares" se necesitaba otro tipo, porque la descripción dice algo inaudible. </font><font style="vertical-align: inherit;">Luego descubrí que el firmware es universal, solo el modo de prueba está activado al </font><b><font style="vertical-align: inherit;">poner en</font></b><font style="vertical-align: inherit;"> cortocircuito </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">P28</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> al suelo.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intento de orientación</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Una vez que haya descargado </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">desde aquí</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (ahora hay, por desgracia, 404) </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">flashrom</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> v0.9.6.1-r1704 / Win32, y sellado con algún tipo de chip de placa base </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MX25L8005</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (SPI), intentó leerlo en la línea de comando " </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-p ft2232_spi: tipo = busblaster</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ". </font><font style="vertical-align: inherit;">Sin embargo, flashrom dijo que no podía encontrar el FT2232. </font><font style="vertical-align: inherit;">La lectura de la </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">documentación</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> mostró que solo funciona a través de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libusb</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , una biblioteca de interfaz universal, originalmente escrita en Linux y luego portada en Windows. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
A través de libusb, encontró la interfaz, pero tercamente afirmó que no vio el microcircuito. </font><font style="vertical-align: inherit;">Encontrado en la caja con los frutos de la necrofilia, algún otro chip SPI, que tampoco se ve. </font><font style="vertical-align: inherit;">Empujado por un osciloscopio - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">se agita, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> está, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> está encendido y </font><font style="vertical-align: inherit;">silencio </font><font style="vertical-align: inherit;">en </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . En general, ni una sola oleada. Conecté los canales del osciloscopio simultáneamente a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TDO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; las señales cambian sincrónicamente, claramente. No había ideas sobre lo que podría verificarse todavía. </font><b><font style="vertical-align: inherit;">Renunciar</font></b></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 
temporalmente a experimentos con flashrom, conectado a la interfaz </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ATTiny13</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Descargando </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aquí</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> algunas versiones diferentes de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">avrdude</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , con la versión </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5.11-Patch7610 / Win32</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y el tipo de programación </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2232HIO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finalmente obtuve una clara identificación, lectura y escritura del controlador. Después de alegrarse, volvió a conectar los chips SPI, pero flashrom se negó obstinadamente a reconocerlos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sospechando que ambos microcircuitos están muertos, sacó </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">USBASP</font></font></b></a> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 2.0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que fue </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intercambiado</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> por </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;">AsProg</font></b></a><font style="vertical-align: inherit;"> ; los </font><font style="vertical-align: inherit;">leyó a ambos </font><font style="vertical-align: inherit;">sin problemas (aunque </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">muy</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> lentamente). Por cierto, compré tres USBASP en general para el papel de placas de prototipos convenientes en ATMega8, pero el dispositivo resultó ser inesperadamente multifuncional. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conecté los microcircuitos a BB nuevamente y comencé a probar flashrom en diferentes modos (Bus Blaster y JTAGKey), con diferentes valores de divisor ( </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-p ft2232_spi: type = busblaster, divisor = n</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font><font style="vertical-align: inherit;">De repente, en una de las combinaciones, el microcircuito fue reconocido, pero ya se negó a leer. </font><font style="vertical-align: inherit;">Después de algunos intentos más, la identificación también desapareció. </font><font style="vertical-align: inherit;">Luego, varias veces fue posible obtener varias identificaciones exitosas seguidas, pero la lectura nunca se logró. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Publicado en el foro, pero no recibió nada sensible en respuesta. </font><font style="vertical-align: inherit;">Después de rebuscar en la búsqueda, encontré quejas de varias personas sobre el firmware universal FPGA (con autocomprobación), encontré tres versiones más de firmware allí, las probé en diferentes combinaciones con otros parámetros, pero no tuve éxito. </font><font style="vertical-align: inherit;">Habiendo agotado todas las opciones, abandonó los experimentos hasta que la llegada del analizador lógico ordenó un poco más tarde BB.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Probar con un analizador</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Habiendo recibido un </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clon del</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> popular </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">analizador lógico Saleae Logic 16</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , lo conectó a las cuatro líneas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">SPI</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">El programa, disponible de forma gratuita en el sitio web de Saleae</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , puede descifrar I2C, SPI y varios otros, por lo que mostró inmediatamente el descifrado de todos los paquetes, tanto enviados como recibidos. Inmediatamente se hizo evidente que los paquetes están "flotando": el programa agrupa la misma secuencia de bits en paquetes en diferentes límites una y otra vez. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al comparar los diagramas de señal en las hojas de datos de los microcircuitos con los grabados, en algún momento noté que la señal </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (conectada al pin </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) al comienzo de cada sesión de intercambio, pasa a un nivel bajo (nivel activo), en el que permanece, aunque de acuerdo con el protocolo debe volver a un nivel alto (pasivo) al final de cada operación. Cambié el firmware "oficial" del FPGA por uno alternativo: </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> comenzó a moverse más activamente, los bordes de los paquetes alineados en él, y después de seleccionar el divisor de frecuencia del reloj en la línea de comando de flashrom (se detuvo en 8), el microcircuito finalmente comenzó a responder claramente a cada solicitud, leer y sobrescribir . </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Sorprendido de que no presté la debida atención al comportamiento de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de inmediato </font><font style="vertical-align: inherit;">, me di cuenta de que estaba confundido por el trabajo exitoso con </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AVR</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en el mismo firmware FPGA. Mirando la hoja de datos ATTiny13, encontré que la señal </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">RESET</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que </font><b><font style="vertical-align: inherit;">TMS</font></b><font style="vertical-align: inherit;"> inicia</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">puede ser bajo durante todo el tiempo de intercambio; no se requiere su aumento para la sincronización. </font><font style="vertical-align: inherit;">Y los chips SPI necesitan su aumento para la sincronización. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Como resultado de las pruebas, reuní información sobre tres conocidos firmware FPGA en </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">una publicación del foro</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Límite de reescritura de FPGA</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En una de las discusiones me topé con una advertencia de que el número garantizado de ciclos para reescribir el firmware de este FPGA es solo de aproximadamente mil. </font><font style="vertical-align: inherit;">Al principio estaba molesto, porque durante los experimentos pude cambiar el firmware unas cien veces, y ya imaginaba la muerte inminente del chip. </font><font style="vertical-align: inherit;">No cuesta nada, pero no quiero meterme con la soldadura. </font><font style="vertical-align: inherit;">Luego se dio cuenta de que con un enfoque adecuado, los novecientos ciclos restantes serían suficientes para muchos años más.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Intermitente de ROM en circuito en el enrutador</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Después de un tiempo, </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">formé</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> un </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">mini enrutador</font></a><font style="vertical-align: inherit;"> recién horneado </font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;">en el RT5350F</font></a><font style="vertical-align: inherit;"> con el nombre en clave "ZLMNet H-G5 / P8201" (designaciones tomadas de la interfaz web). Casi al mismo tiempo, también llegó el clip para SOIC8 / SOP8: decidí probar el trabajo en circuito con la ROM. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Al principio, flashrom no vio la EPROM a través de BB en absoluto. El osciloscopio mostró que el procesador </font><font style="vertical-align: inherit;">siempre venció la </font><font style="vertical-align: inherit;">lucha entre el FPGA y el procesador del enrutador por los niveles de señal de </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> y </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CLK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Lo que no es sorprendente: en BB entre los terminales FPGA y el conector hay resistencias limitantes de corriente que evitan que las teclas FPGA de baja corriente se quemen.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Conecté USBASP con AsProg: este lee / escribe normalmente, pero de nuevo muy lentamente (9 minutos para leer, 25 minutos para el ciclo de borrado-escritura-verificación). Para una revitalización única de un ladrillo, todavía es aceptable, pero para experimentos con firmware inestable ya no está allí. Además, AsProg no sabe cómo trabajar con páginas individuales, solo con todo el microcircuito. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Solde entre las salidas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMS / TCK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> en BB y las entradas </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CS / CLK</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> de la </font><font style="vertical-align: inherit;">EPROM para el seguidor del emisor: las señales condujeron inmediatamente a casi los niveles correctos, reconoció el chip flashrom, comenzó a leer / escribir con confianza. Con un divisor de 8, una lectura completa lleva menos de un minuto, la reescritura dura unos dos minutos.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Resultó que la comunicación del programador con la EPROM no interfiere en absoluto con el procesador: el enrutador funciona perfectamente. </font><font style="vertical-align: inherit;">Obviamente, las líneas CS / CLK se asignan solo para la EPROM, que se lee una vez en el arranque, después de lo cual el procesador no accede a ella si no comienza a flashearla con medios regulares.</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Desventajas de los programas BB</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Los programas probados (zJTAG, flashrom, avrdude, UrJtag, OpenOCD) que pueden funcionar con MPSSE causaron una impresión muy triste. Primero, en la mayoría de estos programas, con toda la variedad de adaptadores FTDI, no hay una indicación explícita de VID / PID: los identificadores de los adaptadores conocidos están codificados en el código. Pero para JTAGkey, que emula BB, PID está configurado en CFF8, y para FT2232H "limpio" está configurado en 6010. Por supuesto, puede cambiar los identificadores en BB </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">usando FT_Prog</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , o parchear la tabla en el programa, pero ambas opciones están igualmente torcidas. Bueno, logré encontrar una versión de flashrom con soporte BB compilado para Windows (de lo contrario, tendría que instalar CygWin), y avrdude funciona bien al especificar el tipo de programador </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2232HIO</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
En segundo lugar, algunos programas funcionan con el adaptador solo a través de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">la biblioteca </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">libusb</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , que, a su vez, funciona a través de su propio controlador, que es incompatible con los controladores FTDI. </font><font style="vertical-align: inherit;">Es bueno que en Windows, para cambiar entre controladores, no necesite eliminar completamente uno e instalar el otro, solo necesita "actualizarlo" eligiendo por la fuerza el controlador adecuado para el dispositivo dado (canal A o B).</font></font><br>
<br>
<h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">recomendaciones</font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Ahora, recordando la cantidad acumulada de tiempo y nervios invertidos en todos los experimentos descritos, entiendo que el precio de la elegancia externa y la aparente universalidad de la solución resultaron prohibitivos. Paso este tiempo adicionalmente en el trabajo principal: ganaría algunos programadores y depuradores industriales serios. Pero la ventaja indudable es que tales ejercicios, al menos de alguna manera, le permiten abstenerse de la última diapositiva hacia el consumo neto de módulos personalizados listos para usar, que los chinos ofrecen en abundancia. En este sentido, es posible envidiar a los ingenieros antiguos y medievales: durante décadas pudieron resolver con entusiasmo los problemas resueltos hace mucho tiempo en un par de miles de kilómetros en el vecindario, simplemente sin saberlo.</font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Deberíamos probar OpenOCD y JTAG en algunos de los enrutadores disponibles, pero todos no lo tienen en sus manos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Dangerous Prototypes también tiene un proyecto más antiguo de </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Bus Pirate</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">Hay una placa PIC y una interfaz simple FT232BL en el modo serie tradicional. </font><font style="vertical-align: inherit;">Para comunicarse con el controlador, se utilizan un terminal regular y comandos de texto, las respuestas también se muestran en forma de texto. </font><font style="vertical-align: inherit;">avrdude, flashrom y otros programas también pueden funcionar a través de BP, sin embargo, por razones obvias, la velocidad es varias veces menor. </font><font style="vertical-align: inherit;">La baja velocidad se compensa con la amplitud de la aplicación: hay muchas opciones para usar BP para emular varios protocolos. </font></font><br>
<br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
Pensando que en esta vida necesitas probar todo, pedí </font></font><a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=aue&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=es&amp;u="><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">BP v3.6</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">con cable </font><font style="vertical-align: inherit;">Sí, sí, recuerdo los ratones del cactus y sobre "mañana iré allí de nuevo".</font></font></div>
      
    </div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/es380531/">https://habr.com/ru/post/es380531/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../es380521/index.html">Navegador para personas con movilidad reducida (con fuente)</a></li>
<li><a href="../es380523/index.html">Veinte estaciones base celulares falsas encontradas en Londres</a></li>
<li><a href="../es380525/index.html">El comodoro Amiga gestiona el sistema climático en la escuela pública de Michigan durante 30 años</a></li>
<li><a href="../es380527/index.html">Conferencia de futbolista de matemáticas al personal de la NSA</a></li>
<li><a href="../es380529/index.html">Safari Mobile Browser ha aprendido cómo bloquear anuncios</a></li>
<li><a href="../es380533/index.html">Epson invita a todos a un picnic para geeks</a></li>
<li><a href="../es380535/index.html">El aterrizaje suave de la cápsula de la Unión es más como una explosión, pero no es un problema</a></li>
<li><a href="../es380537/index.html">Lanzamiento de Unreal Engine 4.8</a></li>
<li><a href="../es380541/index.html">Viernes "Paquete": casos inusuales y curiosidades en la entrega</a></li>
<li><a href="../es380543/index.html">Tarjetas inteligentes. Parte 4. JavaCard</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>