<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>🐯 👨🏼 ☢️ Mountain Car: Memecahkan tantangan klasik dengan pelatihan penguatan 🦎 💌 🧝🏾</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sebagai aturan, modifikasi pada algoritma yang mengandalkan fitur spesifik dari tugas tertentu dianggap kurang bernilai, karena sulit untuk digenerali...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Mountain Car: Memecahkan tantangan klasik dengan pelatihan penguatan</h1><div class="post__body post__body_full"><div class="post__text post__text-html post__text_v1" id="post-content-body" data-io-article-url="https://habr.com/ru/company/hsespb/blog/444428/">  Sebagai aturan, modifikasi pada algoritma yang mengandalkan fitur spesifik dari tugas tertentu dianggap kurang bernilai, karena sulit untuk digeneralisasi ke kelas masalah yang lebih luas.  Namun, ini tidak berarti modifikasi seperti itu tidak diperlukan.  Selain itu, seringkali mereka dapat secara signifikan meningkatkan hasil bahkan untuk masalah klasik sederhana, yang sangat penting dalam aplikasi praktis algoritma.  Sebagai contoh, dalam posting ini saya akan memecahkan masalah Mobil Gunung menggunakan pelatihan penguatan dan menunjukkan bahwa menggunakan pengetahuan tentang bagaimana tugas ini diatur, itu dapat diselesaikan lebih cepat. <br><br><img src="https://habrastorage.org/webt/xy/ju/ai/xyjuaivxj9j2c5hp2o-2x3cem2y.png"><br><a name="habracut"></a><br><h2>  Tentang diri saya </h2><br>  Nama saya Oleg Svidchenko, sekarang saya belajar di Sekolah Ilmu Fisika, Matematika dan Komputer St. Petersburg HSE, sebelum itu saya belajar di Universitas St. Petersburg selama tiga tahun.  Saya juga bekerja di JetBrains Research sebagai peneliti.  Sebelum memasuki universitas, saya belajar di SSC Moscow State University dan menjadi pemenang Olimpiade All-Rusia anak sekolah dalam ilmu komputer sebagai bagian dari tim Moskow. <br><br><h2>  Apa yang kita butuhkan </h2><br>  Jika Anda tertarik untuk mencoba pelatihan penguatan, tantangan Mobil Gunung sangat bagus untuk ini.  Hari ini kita membutuhkan Python dengan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">pustaka</a> <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">Gym</a> dan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">PyTorch yang terinstal</a> , serta pengetahuan dasar jaringan saraf. <br><br><h2>  Deskripsi tugas </h2><br>  Dalam dunia dua dimensi, mobil harus memanjat dari lubang di antara dua bukit ke puncak bukit yang tepat.  Ini rumit oleh kenyataan bahwa dia tidak memiliki tenaga mesin yang cukup untuk mengatasi kekuatan gravitasi dan masuk ke sana pada upaya pertama.  Kami diundang untuk melatih agen (dalam kasus kami, jaringan saraf), yang dapat, dengan mengendalikannya, memanjat bukit kanan secepat mungkin. <br><br>  Kontrol mesin dilakukan melalui interaksi dengan lingkungan.  Ini dibagi menjadi episode independen, dan setiap episode dilakukan langkah demi langkah.  Pada setiap langkah, agen menerima keadaan dan lingkungan <i>r</i> dari lingkungan sebagai respons atas tindakan <i>a</i> .  Selain itu, kadang-kadang media juga dapat melaporkan bahwa episode telah berakhir.  Dalam masalah ini, <i>s</i> adalah sepasang angka, yang pertama adalah posisi mobil pada kurva (satu koordinat sudah cukup, karena kita tidak dapat melepaskan diri dari permukaan), dan yang kedua adalah kecepatannya di permukaan (dengan tanda).  Hadiah <i>r</i> adalah angka yang selalu sama dengan -1 untuk tugas ini.  Dengan cara ini, kami mendorong agen untuk menyelesaikan episode secepat mungkin.  Hanya ada tiga tindakan yang mungkin: dorong mobil ke kiri, jangan lakukan apa-apa dan dorong mobil ke kanan.  Tindakan ini sesuai dengan angka dari 0 hingga 2. Episode dapat berakhir jika mobil mencapai puncak bukit yang tepat atau jika agen telah mengambil 200 langkah. <br><br><h2>  Sedikit teori </h2><br>  Pada Habré sudah ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel tentang DQN</a> di mana penulis cukup baik menggambarkan semua teori yang diperlukan.  Namun demikian, untuk kemudahan membaca, saya akan mengulanginya di sini dalam bentuk yang lebih formal. <br><br>  Tugas pembelajaran penguatan didefinisikan oleh seperangkat ruang keadaan S, ruang tindakan A, koefisien <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>g</mi><mi>a</mi><mi>m</mi><mi>m</mi><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.237ex" height="1.817ex" viewBox="0 -520.7 3546.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-67" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6D" x="1260" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6D" x="2138" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="3017" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>g</mi><mi>a</mi><mi>m</mi><mi>m</mi><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ gamma </script>  , fungsi transisi T dan fungsi hadiah R. Secara umum, fungsi transisi dan fungsi hadiah bisa menjadi variabel acak, tetapi sekarang kami akan mempertimbangkan versi yang lebih sederhana di mana mereka didefinisikan secara unik.  Tujuannya adalah untuk memaksimalkan imbalan kumulatif. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>T</mi></mrow></msubsup><msub><mi>r</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msub><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>g</mi><mi>a</mi><mi>m</mi><mi>m</mi><msup><mi>a</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>t</mi></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.676ex" height="3.021ex" viewBox="0 -883.9 10193.7 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-75" x="719" y="0"></use><g transform="translate(1292,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-54" x="1242" y="488"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-74" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-3D" x="361" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-30" x="1140" y="0"></use></g></g><g transform="translate(3430,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-74" x="638" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-63" x="4487" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-64" x="4921" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6F" x="5444" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-74" x="5930" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-67" x="6541" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="7022" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6D" x="7551" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6D" x="8430" y="0"></use><g transform="translate(9308,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-74" x="748" y="513"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>=</mo><mn>0</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>T</mi></mrow></msubsup><msub><mi>r</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msub><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>g</mi><mi>a</mi><mi>m</mi><mi>m</mi><msup><mi>a</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ sum_ {t = 0} ^ {T} r_ {t} \ cdot \ gamma ^ {t} </script>  , di mana t adalah nomor langkah dalam medium, dan T adalah jumlah langkah dalam episode. <br><br>  Untuk mengatasi masalah ini, kami mendefinisikan nilai-fungsi V negara s sebagai nilai maksimum hadiah kumulatif, asalkan kita mulai dalam keadaan s.  Mengetahui fungsi seperti itu, kita dapat memecahkan masalah hanya dengan melewati di setiap langkah ke s dengan nilai maksimum yang mungkin.  Namun, tidak semuanya begitu sederhana: dalam banyak kasus kita tidak tahu tindakan apa yang akan membawa kita ke keadaan yang diinginkan.  Oleh karena itu, kami menambahkan aksi sebagai parameter kedua dari fungsi.  Fungsi yang dihasilkan disebut fungsi-Q.  Ini menunjukkan berapa banyak hadiah kumulatif maksimum yang bisa kita dapatkan dengan melakukan tindakan dalam keadaan s.  Tapi kita sudah bisa menggunakan fungsi ini untuk menyelesaikan masalah: dalam keadaan s, kita cukup memilih sedemikian rupa sehingga Q (s, a) sudah maksimal. <br><br>  Dalam praktiknya, kita tidak tahu fungsi-Q yang sebenarnya, tetapi kita dapat memperkirakannya dengan berbagai metode.  Salah satu teknik tersebut adalah Deep Q Network (DQN).  Idenya adalah bahwa untuk setiap tindakan kami memperkirakan fungsi-Q menggunakan jaringan saraf. <br><br><h2>  Lingkungan </h2><br>  Sekarang mari kita berlatih.  Pertama, kita perlu belajar bagaimana meniru lingkungan MountainCar.  Perpustakaan Gym, yang menyediakan sejumlah besar lingkungan pembelajaran penguatan standar, akan membantu kami mengatasi tugas ini.  Untuk membuat sebuah lingkungan, kita perlu memanggil metode make pada modul gym yang meneruskannya dengan nama lingkungan yang diinginkan sebagai parameter: <br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> gym env = gym.make(<span class="hljs-string"><span class="hljs-string">"MountainCar-v0"</span></span>)</code> </pre> <br>  Dokumentasi terperinci dapat ditemukan di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> , dan deskripsi lingkungan ada di <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sini</a> . <br>  Mari kita pertimbangkan secara lebih terperinci apa yang dapat kita lakukan dengan lingkungan yang kita buat: <br><br><ul><li>  <code>env.reset()</code> - mengakhiri episode saat ini dan memulai episode baru.  Mengembalikan status awal. </li><li>  <code>env.step(action)</code> - melakukan tindakan yang ditentukan.  Mengembalikan status baru, hadiah, apakah episode telah berakhir dan informasi tambahan yang dapat digunakan untuk debugging. </li><li>  <code>env.seed(seed)</code> - mengatur benih acak.  Itu tergantung pada bagaimana status awal akan dihasilkan selama env.reset (). </li><li>  <code>env.render()</code> - menampilkan kondisi lingkungan saat ini. </li></ul><br><h2>  Kami menyadari DQN </h2><br>  DQN adalah algoritma yang menggunakan jaringan saraf untuk mengevaluasi fungsi-Q.  Dalam <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">artikel aslinya,</a> DeepMind mendefinisikan arsitektur standar untuk game Atari menggunakan jaringan saraf convolutional.  Tidak seperti game ini, Mountain Car tidak menggunakan gambar sebagai keadaan, jadi kita harus menentukan arsitekturnya sendiri. <br><br>  Ambil contoh, sebuah arsitektur dengan dua lapisan tersembunyi dari 32 neuron di masing-masingnya.  Setelah setiap lapisan tersembunyi, kami akan menggunakan <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">ReLU</a> sebagai fungsi aktivasi.  Dua angka yang menggambarkan status dimasukkan ke input dari jaringan saraf, dan pada output kita mendapatkan estimasi fungsi-Q. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ae/jl/mk/aejlmktkosv-jpbne9hqi96enxw.png" alt="Arsitektur jaringan saraf"></div><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> torch.nn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> nn model = nn.Sequential( nn.Linear(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>), nn.ReLU(), nn.Linear(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>), nn.ReLU(), nn.Linear(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) ) target_model = copy.deepcopy(model) <span class="hljs-comment"><span class="hljs-comment">#    def init_weights(layer): if type(layer) == nn.Linear: nn.init.xavier_normal(layer.weight) model.apply(init_weights)</span></span></code> </pre><br>  Karena kita akan melatih jaringan saraf pada GPU, kita perlu memuat jaringan kita di sana: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#     CPU,  “cuda”    “cpu” device = torch.device("cuda") model.to(device) target_model.to(device)</span></span></code> </pre><br>  Variabel perangkat akan bersifat global, karena kita juga perlu memuat data. <br><br>  Kita juga perlu mendefinisikan optimizer yang akan memperbarui bobot model menggunakan gradient descent.  Ya, ada banyak lebih dari satu. <br><br><pre> <code class="python hljs">optimizer = optim.Adam(model.parameters(), lr=<span class="hljs-number"><span class="hljs-number">0.00003</span></span>)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Semuanya bersama</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> torch.nn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> nn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> torch device = torch.device(<span class="hljs-string"><span class="hljs-string">"cuda"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create_new_model</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> model = nn.Sequential( nn.Linear(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>), nn.ReLU(), nn.Linear(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">32</span></span>), nn.ReLU(), nn.Linear(<span class="hljs-number"><span class="hljs-number">32</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>) ) target_model = copy.deepcopy(model) <span class="hljs-comment"><span class="hljs-comment">#    def init_weights(layer): if type(layer) == nn.Linear: nn.init.xavier_normal(layer.weight) model.apply(init_weights) #   ,     (GPU  CPU) model.to(device) target_model.to(device) #  ,        optimizer = optim.Adam(model.parameters(), lr=0.00003) return model, target_model, optimizer</span></span></code> </pre><br></div></div><br>  Sekarang kita mendeklarasikan fungsi yang akan mempertimbangkan fungsi kesalahan, gradien sepanjang itu, dan menerapkan keturunan.  Tetapi sebelum itu, Anda perlu mengunduh data dari batch ke GPU: <br><br><pre> <code class="python hljs">state, action, reward, next_state, done = batch <span class="hljs-comment"><span class="hljs-comment">#       state = torch.tensor(state).to(device).float() next_state = torch.tensor(next_state).to(device).float() reward = torch.tensor(reward).to(device).float() action = torch.tensor(action).to(device) done = torch.tensor(done).to(device)</span></span></code> </pre><br>  Selanjutnya, kita perlu menghitung nilai sebenarnya dari fungsi-Q, namun, karena kita tidak mengetahuinya, kita akan mengevaluasinya melalui nilai-nilai untuk keadaan berikut: <br><br><pre> <code class="python hljs">target_q = torch.zeros(reward.size()[<span class="hljs-number"><span class="hljs-number">0</span></span>]).float().to(device) <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> torch.no_grad(): <span class="hljs-comment"><span class="hljs-comment">#     Q-function    target_q = target_model(next_state).max(1)[0].view(-1) target_q[done] = 0 target_q = reward + target_q * gamma</span></span></code> </pre><br>  Dan prediksi saat ini: <br><br><pre> <code class="python hljs">q = model(state).gather(<span class="hljs-number"><span class="hljs-number">1</span></span>, action.unsqueeze(<span class="hljs-number"><span class="hljs-number">1</span></span>))</code> </pre><br>  Menggunakan target_q dan q, kami menghitung fungsi kerugian dan memperbarui model: <br><br><pre> <code class="python hljs">loss = F.smooth_l1_loss(q, target_q.unsqueeze(<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-comment"><span class="hljs-comment">#      optimizer.zero_grad() #     loss.backward() #   . ,       for param in model.parameters(): param.grad.data.clamp_(-1, 1) #    optimizer.step()</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Semuanya bersama</b> <div class="spoiler_text"><pre> <code class="python hljs">gamma = <span class="hljs-number"><span class="hljs-number">0.99</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(batch, model, target_model, optimizer)</span></span></span><span class="hljs-function">:</span></span> state, action, reward, next_state, done = batch <span class="hljs-comment"><span class="hljs-comment">#       state = torch.tensor(state).to(device).float() next_state = torch.tensor(next_state).to(device).float() reward = torch.tensor(reward).to(device).float() action = torch.tensor(action).to(device) done = torch.tensor(done).to(device) #  ,       target_q = torch.zeros(reward.size()[0]).float().to(device) with torch.no_grad(): #     Q-function    target_q = target_model(next_state).max(1)[0].view(-1) target_q[done] = 0 target_q = reward + target_q * gamma #   q = model(state).gather(1, action.unsqueeze(1)) loss = F.smooth_l1_loss(q, target_q.unsqueeze(1)) #      optimizer.zero_grad() #     loss.backward() #   . ,       for param in model.parameters(): param.grad.data.clamp_(-1, 1) #    optimizer.step()</span></span></code> </pre><br></div></div><br>  Karena model hanya mempertimbangkan fungsi-Q, dan tidak melakukan tindakan, kita perlu menentukan fungsi yang akan memutuskan tindakan mana yang akan dilakukan agen.  Sebagai algoritma pengambilan keputusan, kami ambil <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>s</mi><mi>i</mi><mi>l</mi><mi>o</mi><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.348ex" height="2.419ex" viewBox="0 -780.1 4886 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-72" x="1265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-65" x="1716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-70" x="2183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-73" x="2686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-69" x="3156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6C" x="3501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6F" x="3800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6E" x="4285" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>s</mi><mi>i</mi><mi>l</mi><mi>o</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> \ varepsilon </script>  politik -reedy.  Idenya adalah bahwa agen biasanya melakukan tindakan dengan rakus, memilih fungsi-Q maksimum, tetapi dengan probabilitas <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>s</mi><mi>i</mi><mi>l</mi><mi>o</mi><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.348ex" height="2.419ex" viewBox="0 -780.1 4886 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-72" x="1265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-65" x="1716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-70" x="2183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-73" x="2686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-69" x="3156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6C" x="3501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6F" x="3800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6E" x="4285" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>s</mi><mi>i</mi><mi>l</mi><mi>o</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> \ varepsilon </script>  dia akan mengambil tindakan acak.  Diperlukan tindakan acak sehingga algoritme dapat memeriksa tindakan tersebut yang tidak akan dilakukan hanya dengan dipandu oleh kebijakan serakah - proses ini disebut eksplorasi. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">select_action</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(state, epsilon, model)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> random.random() &lt; epsilon: <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> random.randint(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> model(torch.tensor(state).to(device).float().unsqueeze(<span class="hljs-number"><span class="hljs-number">0</span></span>))[<span class="hljs-number"><span class="hljs-number">0</span></span>].max(<span class="hljs-number"><span class="hljs-number">0</span></span>)[<span class="hljs-number"><span class="hljs-number">1</span></span>].view(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>).item()</code> </pre><br>  Karena kami menggunakan batch untuk melatih jaringan saraf, kami membutuhkan buffer di mana kami akan menyimpan pengalaman berinteraksi dengan lingkungan dan dari mana kami akan memilih batch: <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Memory</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, capacity)</span></span></span><span class="hljs-function">:</span></span> self.capacity = capacity self.memory = [] self.position = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">push</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, element)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(self.memory) &lt; self.capacity: self.memory.append(<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>) self.memory[self.position] = element self.position = (self.position + <span class="hljs-number"><span class="hljs-number">1</span></span>) % self.capacity <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sample</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, batch_size)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">"""    """</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> list(zip(*random.sample(self.memory, batch_size))) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__len__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> len(self.memory)</code> </pre><br><h2>  Keputusan naif </h2><br>  Pertama, nyatakan konstanta yang akan kita gunakan dalam proses pembelajaran, dan buat model: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  model   target model target_update = 1000 #  ,      batch_size = 128 #   max_steps = 100001 #  exploration max_epsilon = 0.5 min_epsilon = 0.1 #    memory = Memory(5000) model, target_model, optimizer = create_new_model()</span></span></code> </pre><br>  Terlepas dari kenyataan bahwa akan logis untuk membagi proses interaksi menjadi beberapa episode, untuk menggambarkan proses pembelajaran, lebih mudah bagi kita untuk membaginya menjadi langkah-langkah terpisah, karena kami ingin membuat satu langkah penurunan gradien setelah setiap langkah lingkungan. <br><br>  Mari kita bicara lebih terinci tentang bagaimana satu langkah pembelajaran terlihat seperti di sini.  Kami berasumsi bahwa sekarang kami membuat langkah dengan jumlah langkah dari langkah max_steps dan status saat ini.  Kemudian lakukan aksinya bersama <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>s</mi><mi>i</mi><mi>l</mi><mi>o</mi><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.348ex" height="2.419ex" viewBox="0 -780.1 4886 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-72" x="1265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-65" x="1716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-70" x="2183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-73" x="2686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-69" x="3156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6C" x="3501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6F" x="3800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6E" x="4285" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>s</mi><mi>i</mi><mi>l</mi><mi>o</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> \ varepsilon </script>  Kebijakan -reedy akan terlihat seperti ini: <br><br><pre> <code class="python hljs">epsilon = max_epsilon - (max_epsilon - min_epsilon)* step / max_steps action = select_action(state, epsilon, model) new_state, reward, done, _ = env.step(action)</code> </pre><br>  Segera tambahkan pengalaman yang diperoleh ke memori dan mulai episode baru jika episode saat ini telah berakhir: <br><br><pre> <code class="python hljs">memory.push((state, action, reward, new_state, done)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> done: state = env.reset() done = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: state = new_state</code> </pre><br>  Dan kami akan mengambil langkah gradient descent (jika, tentu saja, kami sudah dapat mengumpulkan setidaknya satu batch): <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> step &gt; batch_size: fit(memory.sample(batch_size), model, target_model, optimizer)</code> </pre><br>  Sekarang tetap memperbarui target_model: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> step % target_update == <span class="hljs-number"><span class="hljs-number">0</span></span>: target_model = copy.deepcopy(model)</code> </pre><br>  Namun, kami juga ingin mengikuti proses pembelajaran.  Untuk melakukan ini, kami akan memainkan episode tambahan setelah setiap pembaruan target_model dengan epsilon = 0, menyimpan total penghargaan di buffer rewards_by_target_updates: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> step % target_update == <span class="hljs-number"><span class="hljs-number">0</span></span>: target_model = copy.deepcopy(model) state = env.reset() total_reward = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> done: action = select_action(state, <span class="hljs-number"><span class="hljs-number">0</span></span>, target_model) state, reward, done, _ = env.step(action) total_reward += reward done = <span class="hljs-keyword"><span class="hljs-keyword">False</span></span> state = env.reset() rewards_by_target_updates.append(total_reward)</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Semuanya bersama</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  model   target model target_update = 1000 #  ,      batch_size = 128 #   max_steps = 100001 #  exploration max_epsilon = 0.5 min_epsilon = 0.1 def fit(): #    memory = Memory(5000) model, target_model, optimizer = create_new_model() for step in range(max_steps): #    epsilon = max_epsilon - (max_epsilon - min_epsilon)* step / max_steps action = select_action(state, epsilon, model) new_state, reward, done, _ = env.step(action) #  ,  ,   memory.push((state, action, reward, new_state, done)) if done: state = env.reset() done = False else: state = new_state #  if step &gt; batch_size: fit(memory.sample(batch_size), model, target_model, optimizer) if step % target_update == 0: target_model = copy.deepcopy(model) #Exploitation state = env.reset() total_reward = 0 while not done: action = select_action(state, 0, target_model) state, reward, done, _ = env.step(action) total_reward += reward done = False state = env.reset() rewards_by_target_updates.append(total_reward) return rewards_by_target_updates</span></span></code> </pre><br></div></div><br>  Jalankan kode ini dan dapatkan sesuatu seperti grafik ini: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e35/952/b37/e35952b375fc831ec4bd405303440509.png" alt="Grafik dasar dalam bentuk garis lurus y = -200"><br><br><h2>  Apa yang salah? </h2><br>  Apakah ini bug?  Apakah ini algoritma yang salah?  Apakah ini parameter buruk?  Tidak juga.  Padahal, masalahnya ada di tugas, yaitu pada fungsi hadiah.  Mari kita lihat lebih dekat.  Pada setiap langkah, agen kami menerima hadiah -1, dan ini terjadi hingga episode berakhir.  Hadiah seperti itu memotivasi agen untuk menyelesaikan episode secepat mungkin, tetapi pada saat yang sama tidak memberitahunya bagaimana melakukannya.  Karena itu, satu-satunya cara untuk belajar bagaimana menyelesaikan masalah dalam formulasi untuk agen adalah dengan menyelesaikannya berkali-kali menggunakan eksplorasi. <br><br>  Tentu saja, orang dapat mencoba menggunakan algoritma yang lebih kompleks untuk mempelajari lingkungan daripada kita <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>v</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>s</mi><mi>i</mi><mi>l</mi><mi>o</mi><mi>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.348ex" height="2.419ex" viewBox="0 -780.1 4886 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-76" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-72" x="1265" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-65" x="1716" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-70" x="2183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-73" x="2686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-69" x="3156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6C" x="3501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6F" x="3800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6E" x="4285" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>v</mi><mi>a</mi><mi>r</mi><mi>e</mi><mi>p</mi><mi>s</mi><mi>i</mi><mi>l</mi><mi>o</mi><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> \ varepsilon </script>  Kebijakan -greedy.  Namun, pertama, karena penerapannya, model kami akan menjadi lebih kompleks, yang ingin kami hindari, dan kedua, bukan fakta bahwa mereka akan bekerja cukup baik untuk tugas ini.  Sebagai gantinya, kita dapat menghilangkan sumber masalah dengan memodifikasi tugas itu sendiri, yaitu dengan mengubah fungsi hadiah, yaitu  dengan menerapkan apa yang disebut reward shaping. <br><br><h2>  Mempercepat konvergensi </h2><br>  Pengetahuan intuitif kami memberi tahu kami bahwa untuk mendaki bukit, Anda harus mempercepat.  Semakin tinggi kecepatan, semakin dekat agen untuk memecahkan masalah.  Anda dapat memberitahunya tentang ini, misalnya, dengan menambahkan modul kecepatan dengan koefisien tertentu pada hadiah: <pre>  modified_reward = hadiah + 10 * abs (new_state [1]) </pre><br><br>  Dengan demikian, garis dalam fungsi tersebut pas <pre>  memory.push ((status, tindakan, hadiah, new_state, selesai)) </pre>  harus diganti oleh <pre>  memory.push ((status, aksi, modified_reward, new_state, selesai)) </pre>  Sekarang mari kita lihat pada grafik baru (ini menyajikan penghargaan <b>asli</b> tanpa modifikasi): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c19/3c2/925/c193c2925d13ba1977cf525697cba1c2.png" alt="Grafik dasar versus RS"><br>  <i>Di sini RS adalah kependekan dari Reward Shaping.</i> <br><br><h2>  Apakah baik melakukan ini? </h2><br>  Kemajuannya jelas: agen kami jelas belajar untuk mendaki bukit, karena penghargaan mulai berbeda dari -200.  Hanya ada satu pertanyaan yang tersisa: jika mengubah fungsi hadiah, kami juga mengubah tugas itu sendiri, akankah solusi untuk masalah baru yang kami temukan baik untuk masalah lama? <br><br>  Untuk memulainya, kita memahami apa artinya "kebaikan" dalam kasus kita.  Menyelesaikan masalah, kami mencoba menemukan kebijakan yang optimal - kebijakan yang memaksimalkan total hadiah untuk episode tersebut.  Dalam hal ini, kita dapat mengganti kata "baik" dengan kata "optimal", karena kita mencarinya.  Kami juga optimis berharap bahwa cepat atau lambat DQN kami akan menemukan solusi optimal untuk masalah yang dimodifikasi, dan tidak terjebak pada maksimum lokal.  Jadi, pertanyaannya dapat dirumuskan kembali sebagai berikut: jika mengubah fungsi hadiah, kami juga mengubah masalah itu sendiri, akankah solusi optimal untuk masalah baru yang kami temukan menjadi optimal untuk masalah yang lama? <br><br>  Ternyata, kami tidak dapat memberikan jaminan seperti itu dalam kasus umum.  Jawabannya tergantung pada bagaimana tepatnya kita mengubah fungsi hadiah, bagaimana itu diatur sebelumnya dan bagaimana lingkungan itu sendiri diatur.  Untungnya, ada <a href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=">sebuah artikel</a> yang penulisnya menyelidiki bagaimana mengubah fungsi hadiah mempengaruhi optimalitas solusi yang ditemukan. <br><br>  Pertama, mereka menemukan seluruh kelas perubahan "aman" yang didasarkan pada metode potensial: <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>R</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mi>R</mi><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>g</mi><mi>a</mi><mi>m</mi><mi>m</mi><mi>a</mi><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&amp;#xA0;</mtext><mi>P</mi><mi>h</mi><mi>i</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mi>e</mi><mi>w</mi><msub><mtext>&amp;#xA0;</mtext><mi>s</mi></msub><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>P</mi><mi>h</mi><mi>i</mi><mo stretchy=&quot;false&quot;>(</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>a</mi><mi>r</mi><mi>a</mi><mi>b</mi><mi>a</mi><mi>g</mi><mi>i</mi><mi>a</mi><mi>n</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="63.954ex" height="2.66ex" viewBox="0 -832 27535.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-2032" x="1074" y="513"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-3D" x="1332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-52" x="2388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-2B" x="3370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-28" x="4370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-67" x="5010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="5490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6D" x="6020" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6D" x="6898" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="7777" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-63" x="8556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-64" x="8990" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6F" x="9513" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-74" x="9999" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-50" x="10610" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-68" x="11362" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-69" x="11938" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-28" x="12284" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6E" x="12673" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-65" x="13274" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-77" x="13740" y="0"></use><g transform="translate(14457,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-73" x="353" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-74" x="15139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="15500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-74" x="16030" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-65" x="16391" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-29" x="16858" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-2212" x="17470" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-50" x="18720" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-68" x="19472" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-69" x="20048" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-28" x="20394" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6E" x="20783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-65" x="21384" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-67" x="21850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="22331" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-72" x="22860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="23312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-62" x="23841" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="24271" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-67" x="24800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-69" x="25281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="25626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-6E" x="26156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-29" x="26756" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-29" x="27146" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>R</mi><mo>′</mo></msup><mo>=</mo><mi>R</mi><mo>+</mo><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>g</mi><mi>a</mi><mi>m</mi><mi>m</mi><mi>a</mi><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mtext>&nbsp;</mtext><mi>P</mi><mi>h</mi><mi>i</mi><mo stretchy="false">(</mo><mi>n</mi><mi>e</mi><mi>w</mi><msub><mtext>&nbsp;</mtext><mi>s</mi></msub><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy="false">)</mo><mo>−</mo><mtext>&nbsp;</mtext><mi>P</mi><mi>h</mi><mi>i</mi><mo stretchy="false">(</mo><mi>n</mi><mi>e</mi><mi>g</mi><mi>a</mi><mi>r</mi><mi>a</mi><mi>b</mi><mi>a</mi><mi>g</mi><mi>i</mi><mi>a</mi><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> R ’= R + (\ gamma \ cdot \ Phi (new \ _state) - \ Phi (negara bagian)) </script>  dimana <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>P</mi><mi>h</mi><mi>i</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.468ex" height="2.057ex" viewBox="0 -780.1 1923.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-50" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-68" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-69" x="1578" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>P</mi><mi>h</mi><mi>i</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> \ Phi </script>  - potensi, yang hanya bergantung pada negara.  Untuk fungsi seperti itu, penulis dapat membuktikan bahwa jika solusi untuk masalah baru optimal, maka untuk masalah lama juga optimal. <br><br>  Kedua, penulis menunjukkan itu untuk yang lain <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup><mi>R</mi><mo>&amp;#x2032;</mo></msup><mo>=</mo><mi>R</mi><mo>+</mo><mi>F</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.056ex" height="2.66ex" viewBox="0 -832 7343.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-2032" x="1074" y="513"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-3D" x="1332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-52" x="2388" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-2B" x="3370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-46" x="4370" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-28" x="5120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-73" x="5509" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-2C" x="5979" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMATHI-61" x="6424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;pto=nl&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=id&amp;u=https://habr.com/ru/company/hsespb/blog/444428/&amp;usg=ALkJrhggu6UkX6FkNeNCgUWNUsaIXqT5qQ#MJMAIN-29" x="6953" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>R</mi><mo>′</mo></msup><mo>=</mo><mi>R</mi><mo>+</mo><mi>F</mi><mo stretchy="false">(</mo><mi>s</mi><mo>,</mo><mi>a</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9"> R ’= R + F (s, a) </script>  ada masalah seperti itu, fungsi hadiah R, dan solusi optimal untuk masalah yang diubah, bahwa solusi ini tidak optimal untuk masalah aslinya.  Ini berarti bahwa kami tidak dapat menjamin kebaikan solusi yang kami temukan jika kami menggunakan perubahan yang tidak didasarkan pada metode potensial. <br><br>  Dengan demikian, penggunaan fungsi potensial untuk memodifikasi fungsi hadiah hanya dapat mengubah tingkat konvergensi algoritma, tetapi tidak mempengaruhi solusi akhir. <br><br><h2>  Percepat konvergensi dengan benar </h2><br>  Sekarang kita tahu bagaimana cara mengubah hadiah dengan aman, mari kita coba modifikasi tugas lagi, menggunakan metode potensial alih-alih heuristik naif: <pre>  modified_reward = hadiah + 300 * (gamma * abs (new_state [1]) - abs (status [1])) </pre><br>  Mari kita lihat jadwal penghargaan asli: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6ba/a60/5dc/6baa605dc8dd5ad8e7bf154e5dde3c74.png" alt="Grafik membandingkan baseline, RS dan RS dengan potensi"><br><br>  Ternyata, selain memiliki jaminan teoretis, memodifikasi hadiah dengan bantuan fungsi potensial juga secara signifikan meningkatkan hasilnya, terutama pada tahap awal.  Tentu saja, ada kemungkinan bahwa akan mungkin untuk memilih hiperparameter yang lebih optimal (benih acak, gamma, dan koefisien lainnya) untuk melatih agen, tetapi pembentukan hadiah namun secara signifikan meningkatkan laju konvergensi model. <br><br><h2>  Kata penutup </h2><br>  Terima kasih sudah membaca sampai akhir!  Saya harap Anda menikmati perjalanan kecil berorientasi praktik ini ke dalam pembelajaran yang diperkuat.  Jelas bahwa Mountain Car adalah tugas "mainan", namun, seperti yang dapat kami perhatikan, untuk mengajar agen memecahkan bahkan tugas yang tampaknya sederhana dari sudut pandang manusia bisa sulit. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/id444428/">https://habr.com/ru/post/id444428/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../id444418/index.html">Jutaan binari kemudian. Bagaimana Linux Diperkuat</a></li>
<li><a href="../id444420/index.html">Cara mengendarai dua roda untuk bekerja</a></li>
<li><a href="../id444422/index.html">Seperti pada tahun 2018: pencetakan FDM industri di Top 3D Expo</a></li>
<li><a href="../id444424/index.html">AMD Radeon VII: Chip High-End (Bagian 2)</a></li>
<li><a href="../id444426/index.html">Lyft dan Uber go IPO publik. Mengapa berinvestasi di Lyft?</a></li>
<li><a href="../id444430/index.html">Analisis: bagaimana cara menggunakan Present Perfect dalam bahasa Inggris</a></li>
<li><a href="../id444432/index.html">Penggunaan Linux dan perangkat lunak sumber terbuka di lembaga pendidikan kita: menjadi atau tidak?</a></li>
<li><a href="../id444434/index.html">Waktunya telah tiba untuk Java 12! Ulasan JEP panas</a></li>
<li><a href="../id444436/index.html">Apa itu botnet Mirai, dan bagaimana cara melindungi perangkat saya?</a></li>
<li><a href="../id444438/index.html">Sejarah singkat sumber terbuka - bagaimana perangkat lunak bebas berperang dengan hak milik</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>