<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134228602-6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134228602-6');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>üåî üëâüèΩ üßíüèæ Stockez des ressources statiques sur votre h√©bergement üëµ üë®‚Äçüíº üèïÔ∏è</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="L'une des premi√®res choses que je recommande √† mes clients pour acc√©l√©rer les sites Web semblera d'abord un paradoxe: vous devez placer des ressources...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <link href="https://fonts.googleapis.com/css?family=Quicksand&display=swap" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script>document.write('<script src="//pagea' + 'd2.googles' + 'yndication.com/pagea' + 'd/js/a' + 'dsby' + 'google.js"><\/script>')</script>
  <script>
        var superSpecialObject = {};
        superSpecialObject['google_a' + 'd_client'] = 'ca-p' + 'ub-6974184241884155';
        superSpecialObject['enable_page_level_a' + 'ds'] = true;
       (window['a' + 'dsbygoogle'] = window['a' + 'dsbygoogle'] || []).push(superSpecialObject);
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly-es.github.io/index.html"></a>
    <div class="page-header-text">Geekly articles weekly</div>
  </header>
  <section class="page js-page"><h1>Stockez des ressources statiques sur votre h√©bergement</h1><div class="post__body post__body_full"><div class="post__text post__text-html" id="post-content-body" data-io-article-url="https://habr.com/ru/post/457210/">  L'une des premi√®res choses que je recommande √† mes clients pour acc√©l√©rer les sites Web semblera d'abord un paradoxe: vous devez placer des ressources statiques sur votre h√©bergement, abandonnant l'infrastructure CDN tierce.  Dans ce court article et, je l'esp√®re, tr√®s simple, je veux souligner les inconv√©nients du stockage de vos fichiers statiques ¬´sur le c√¥t√©¬ª et les formidables avantages de les h√©berger sur mon h√©bergement. <br><a name="habracut"></a><br><h4>  De quoi je parle? </h4><br>  Il est courant pour les d√©veloppeurs de cliquer sur le lien vers des actifs statiques, tels que des biblioth√®ques ou des plugins, qui se trouvent sur des sites et des ressources CDN.  Un exemple classique est jQuery. <br><br>  Il y a un certain nombre d'avantages √©vidents, mais mon objectif plus loin dans l'article est d'exposer cette approche et de montrer que les inconv√©nients sont beaucoup plus r√©pandus. <br><br>  (Tout d'abord, consid√©rez les avantages). <br><br><ul><li>  <b>C'est pratique.</b>  Cela n√©cessite tr√®s peu d'efforts pour connecter les fichiers.  Copiez la ligne de code HTML et vous avez termin√©.  C'est facile. </li><li>  <b>Nous avons acc√®s au CDN.</b>  code.jquery.com est fourni par StackPath, c'est un CDN.  En vous connectant au contenu de cette ressource, nous obtenons gratuitement une livraison de qualit√© CDN. </li><li> <b>Les fichiers utilisateur peuvent d√©j√† √™tre mis en cache.</b>  Si website-a.com est li√© √† <a href="">code.jquery.com/jquery-3.3.1.slim.min.js</a> et que l'utilisateur va d'ici √† website-b.com, qui est √©galement li√© √† <a href="">code.jquery.com/jquery-3.3 .1.slim.min.js</a> , alors l'utilisateur aura ce fichier dans le cache. </li></ul><br><h4>  Risque: baisse de vitesse et √©checs </h4><br>  Je n'entrerai pas dans trop de d√©tails dans ce post.  J'ai un article complet sur la viabilit√© d'un tiers et les risques li√©s aux retards et interruptions.  Qu'il suffise de dire que si vous avez des ressources critiques li√©es √† des fournisseurs tiers, et si le fournisseur souffre de plantages et d'une baisse de vitesse ou de pannes, c'est une tr√®s mauvaise nouvelle pour vous.  Vous en souffrirez aussi. <br><br>  Si vous avez des CSS bloquant le rendu ou des JS synchrones h√©berg√©s sur des ressources tierces, allez-y et transf√©rez-les imm√©diatement dans votre propre infrastructure.  Les actifs critiques sont trop pr√©cieux pour √™tre laiss√©s sur des serveurs tiers. <br><br><h4>  Risque: R√©siliation du service </h4><br>  Il s'agit d'un √©v√©nement beaucoup moins courant, mais que se passe-t-il si le fournisseur d√©cide qu'il doit arr√™ter le service?  C'est exactement ce que Rawgit a fait en octobre 2018, jusqu'√† pr√©sent (au moment de la r√©daction), une recherche brute sur le code GitHub fournit toujours plus d'un million de liens vers le service, qui est actuellement ferm√©, et pr√®s de 20000 sites actifs continuent de fonctionner. r√©f√©rez-vous-y. <br><br><h4>  Risque: vuln√©rabilit√©s de s√©curit√© </h4><br>  Une autre chose √† laquelle il faut pr√™ter attention est une simple question de confiance.  Si nous apportons du contenu √† partir de ressources tierces sur notre page, nous devons esp√©rer que les fichiers que nous recevons sont exactement ce que nous attendons de recevoir, et ils font exactement ce que nous attendons d'eux. <br><br>  Imaginez le mal qui pourrait √™tre fait si quelqu'un pouvait prendre le contr√¥le d'un fournisseur tel que code.jquery.com et commencer √† fournir du contenu compromis ou malveillant.  √áa fait peur d'y penser! <br><br><h4>  Int√©grit√© des sous-ressources </h4><br>  Nous devons rendre hommage √† tous les fournisseurs tiers mentionn√©s jusqu'ici dans cet article, ils font tout pour garantir l'int√©grit√© de la sous-ressource (Subresource Integrity - SRI).  SRI est le m√©canisme par lequel le fournisseur fournit le hachage (techniquement, un hachage suivi d'un encodage Base64) du fichier sp√©cifique que vous attendez et avez l'intention d'utiliser.  Le navigateur peut alors v√©rifier que le fichier que vous avez re√ßu correspond exactement √† ce que vous avez demand√©. <br><br><pre><code class="plaintext hljs">&lt;script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha256-pasqAKBDmFT4eHoN2ndd6lN370kFiGUFyTiUHWhU7k8=" crossorigin="anonymous"&gt;&lt;/script&gt;</code> </pre> <br>  Encore une fois, si vous devez absolument connecter du contenu statique √† une ressource tierce, assurez-vous que SRI est actif.  Vous pouvez vous connecter SRI vous-m√™me. <br><br><h4>  Reckoning: Network Negotiations </h4><br>  L'un des co√ªts les plus importants et les plus urgents que nous encourons est celui de l'ouverture de nouvelles connexions TCP.  Chaque nouvelle ressource que nous devons visiter n√©cessite d'ouvrir une connexion, ce qui peut √™tre tr√®s co√ªteux: r√©solution DNS, n√©gociation TCP, n√©gociation TLS, qui contribuent tous, et l'histoire s'aggrave √† mesure que la connexion tarde. <br><br>  Je vais donner un exemple tir√© directement de la propre page de d√©marrage de Bootstrap.  Ils demandent aux utilisateurs de joindre quatre fichiers. <br><br>  Ces quatre fichiers sont situ√©s sur trois ressources diff√©rentes, c'est-√†-dire que nous devons ouvrir trois connexions TCP.  Combien cela co√ªte-t-il?  Eh bien, avec une connexion assez rapide, le contenu de ces fichiers statiques sur le c√¥t√© est de 311 ms, soit 1,65 fois plus lent que lors de leur placement sur votre propre h√©bergement. <br><br>  En contactant trois sources diff√©rentes pour la maintenance des actifs statiques, nous perdons collectivement les 805 ms inutiles pour les approbations du r√©seau. <br><br>  D'accord, ce n'est pas si effrayant, mais Trainline, mon client, a constat√© que lorsque le retard a √©t√© r√©duit de 300 ms, les visiteurs ont pay√© 8 millions de livres suppl√©mentaires par an.  C'est un moyen assez simple de gagner 8 millions. <br><br>  En d√©pla√ßant simplement nos ressources vers votre domaine, nous √©liminons compl√®tement le co√ªt des connexions suppl√©mentaires. <br><br>  Pour une connexion plus lente, avec un d√©lai plus long, l'histoire est bien pire.  Pour la 3G, la version tierce est plus lente que 1,765 s.  Je pensais que c'√©tait destin√© √† rendre notre site plus rapide. <br><br>  Lorsque vous vous connectez avec un retard important, le co√ªt total du r√©seau est de 5,037 monstrueux.  Ce qui peut √™tre compl√®tement √©vit√©. <br><br>  Le d√©placement de fichiers vers notre propre infrastructure r√©duit le temps de t√©l√©chargement de 5,4 s √† 3,6 s. <br><br>  Si ce n'est pas une bonne raison d'h√©berger vos ressources statiques, je ne sais pas quoi apporter d'autre. <br><br><h4>  Se connecter </h4><br>  Naturellement, tout l'int√©r√™t de ma pr√©sentation ici est que vous ne devez pas publier de ressources statiques sur le c√¥t√© si vous √™tes en mesure de le faire sur votre h√©bergement.  Cependant, si vos mains sont en quelque sorte li√©es, vous pouvez utiliser la pr√©connexion de Resource Hint pour ouvrir de mani√®re proactive une connexion TCP √† une ou des sources sp√©cifiques: De plus, leur d√©ploiement en tant qu'en-t√™tes HTTP sera encore plus rapide. <br>  <b>Remarque</b>  M√™me si vous utilisez la pr√©connexion, le temps perdu ne diminuera que l√©g√®rement: vous devez toujours ouvrir les connexions appropri√©es et il est peu probable que les co√ªts soient jamais justifi√©s, en particulier pour les connexions lentes. <br><br><h4>  Reckoning: perte de priorit√© </h4><br>  Le deuxi√®me calcul se pr√©sente sous la forme d'une optimisation au niveau du protocole, ce qui nous manque lorsque nous divisons le contenu en domaines.  Si vous utilisez HTTP / 2, ce qui doit √™tre fait, vous avez acc√®s √† la priorisation. <br><br>  Tous les flux (donc les ressources) avec la m√™me connexion TCP conservent la priorit√©, et le navigateur et le serveur travaillent en tandem pour construire l'arborescence de d√©pendances de tous ces flux prioris√©s, afin que nous puissions renvoyer les ressources critiques plus rapidement et √©ventuellement retarder la livraison des moins importantes. <br><br>  <b>Remarque</b>  Techniquement, en raison de la fusion des connexions HTTP / 2, les demandes peuvent √™tre hi√©rarchis√©es les unes par rapport aux autres sur diff√©rents domaines, √† condition qu'elles partagent la m√™me adresse IP. <br><br>  Si nous distribuons nos ressources sur diff√©rents domaines, nous devons ouvrir plusieurs connexions TCP uniques.  Nous ne pouvons pas croiser les priorit√©s pour ces connexions, c'est-√†-dire que nous perdons la capacit√© de livrer des fichiers d'une mani√®re bien r√©fl√©chie. <br><br>  En h√©bergeant tout le contenu sur un seul h√©bergement, nous pouvons construire une arborescence de d√©pendances plus complexe.  Chaque thread a son propre ID, car ils appartiennent √† la m√™me arborescence.  Si nous fournissons autant de contenu que possible √† partir d'un domaine, nous pouvons laisser HTTP / 2 faire son travail et hi√©rarchiser les actifs plus compl√®tement dans l'espoir d'une r√©ponse plus rapide. <br><br><h4>  Mise en cache </h4><br>  Dans l'ensemble, les h√¥tes de ressources statiques semblent assez bien faire pour d√©finir des directives max-age √† longue dur√©e de vie.  Cela est logique car le contenu statique sur les URL versionn√©es (comme indiqu√© ci-dessus) ne changera jamais.  Cela rend tr√®s s√ªr et rationnel l'application d'une politique de cache raisonnablement agressive. <br><br>  Cependant, ce n'est pas toujours le cas et en pla√ßant ind√©pendamment vos ressources, vous pouvez d√©velopper des strat√©gies de mise en cache beaucoup plus individuelles. <br><br><h4>  Mythe: mise en cache inter-domaines </h4><br>  Plus int√©ressant est la possibilit√© de mettre en cache des actifs entre domaines.  Autrement dit, si de nombreux sites sont li√©s √† la m√™me version de jQuery, situ√©e sur le CDN, les utilisateurs ont s√ªrement d√©j√† ce fichier particulier sur leur ordinateur.  Quelque chose comme le partage de ressources d'√©gal √† √©gal.  Il s'agit de l'un des arguments les plus courants pour utiliser un fournisseur d'actifs statique tiers. <br><br>  Malheureusement, aucune preuve publi√©e ne vient √©tayer ces affirmations: il n'y a aucune raison de croire que cela est vrai.  √Ä l'inverse, une √©tude r√©cente de Paul Calvano laisse entendre que le contraire peut √™tre vrai: <br><br>  Il existe un √©cart notable entre l'√¢ge du cache de ressources CSS et les polices Web de premier et de troisi√®me niveau.  95% des polices tierces datent de plus d'une semaine, contre 50% des polices tierces de moins d'une semaine.  Cela fournit de bonnes raisons pour les polices Web auto-h√©berg√©es. <br><br>  En g√©n√©ral, il semble que le contenu tiers soit mis en cache pire que le sien. <br><br>  Plus important encore, Safari a compl√®tement d√©sactiv√© cette fonctionnalit√© en raison de probl√®mes d'abus de confidentialit√©, de sorte que la technologie de cache partag√© pourrait ne pas fonctionner au moment de la r√©daction de cet article pour 16% des utilisateurs dans le monde. <br><br>  En bref, bien que cela soit th√©oriquement bon, rien ne prouve que la mise en cache interdomaine soit en quelque sorte efficace. <br><br><h4>  Acc√®s CDN </h4><br>  Un autre avantage r√©pandu de contacter un fournisseur de ressources statiques est qu'il est susceptible d'utiliser une infrastructure puissante avec des capacit√©s CDN: distribution mondiale, √©volutivit√©, faible latence et haute disponibilit√©. <br><br>  √âtant donn√© que cela est absolument vrai, si vous vous souciez de vos performances, vous devez ex√©cuter votre propre contenu √† partir du CDN.  Avec le niveau des prix d'h√©bergement actuels, il y a tr√®s peu d'excuses pour lesquelles vous ne l'utilisez pas pour vos ressources. <br><br>  En d'autres termes: si vous pensez avoir besoin d'un CDN pour votre jQuery, vous aurez besoin d'un CDN pour tout. <br><br><h4>  H√©bergez des ressources statiques sur votre h√©bergement </h4><br>  En fait, il y a tr√®s peu de raisons de laisser vos ressources statiques dans l'infrastructure de quelqu'un d'autre.  Les avantages possibles sont souvent un mythe et m√™me si ce n'est pas le cas, les compromis n'en valent tout simplement pas la peine.  Le chargement des ressources √† partir de diff√©rentes sources est beaucoup plus lent.  Au cours des prochains jours, passez dix minutes √† auditer vos projets et prenez le contr√¥le de toutes les ressources statiques tierces. </div></div><p>Source: <a rel="nofollow" href="https://habr.com/ru/post/fr457210/">https://habr.com/ru/post/fr457210/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../fr457200/index.html">Un robot de dessin pour r√©aliser des sc√®nes de tous les jours et m√™me des histoires</a></li>
<li><a href="../fr457202/index.html">Comment nous choisissons les id√©es pour le d√©veloppement de nos produits: le vendeur doit pouvoir entendre ...</a></li>
<li><a href="../fr457204/index.html">Windows PowerShell et longs chemins</a></li>
<li><a href="../fr457206/index.html">SQL Index Manager - une longue histoire sur SQL Server, les fouilles et la maintenance des index</a></li>
<li><a href="../fr457208/index.html">G√©n√©ration dynamique de robots.txt pour les sites ASP.NET Core en fonction de l'environnement</a></li>
<li><a href="../fr457212/index.html">Pourquoi n'est-il jamais trop tard pour commencer √† apprendre Java (ou d'autres langages Java)</a></li>
<li><a href="../fr457224/index.html">Une approche moderne de la concurrence dans Android: Corotins chez Kotlin</a></li>
<li><a href="../fr457232/index.html">Abeille robot "Bumble" - le premier vol d'essai √† l'int√©rieur de l'ISS</a></li>
<li><a href="../fr457234/index.html">Biais cognitif du produit</a></li>
<li><a href="../fr457236/index.html">Comment une entreprise informatique a eu du mal √† vendre de la musique</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter57283870 = new Ya.Metrika({
                  id:57283870,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/57283870" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134228602-6', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

<footer class="page-footer">
  <div class="page-footer-legal-info-container page-footer-element">
    <p>
      Weekly-Geekly ES | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
    </p>
  </div>
  <div class="page-footer-counters-container page-footer-element">
    <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=9uU9J9pq8z7k8xEBHYSfs6DenIBAHs3vLIHcPIJW9d0&co=3a3a3a&ct=ffffff'/></a>
  </div>
</footer>
  
</body>

</html>